<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>光电扫描测量网络信号采集模块设计 | 极客快訊</title><meta property="og:title" content="光电扫描测量网络信号采集模块设计 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="http://p3.pstatp.com/large/566d000f3a0fa75f82de"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/33bf1e2.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/33bf1e2.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/33bf1e2.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/33bf1e2.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/33bf1e2.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/33bf1e2.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/33bf1e2.html><link rel=canonical href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/33bf1e2.html><meta property="article:published_time" content="2020-10-29T20:47:39+08:00"><meta property="article:modified_time" content="2020-10-29T20:47:39+08:00"><meta name=Keywords content><meta name=description content="光电扫描测量网络信号采集模块设计"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E6%B8%B8%E6%88%8F/33bf1e2.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>光电扫描测量网络信号采集模块设计</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E6%B8%B8%E6%88%8F.html>游戏</a></span></div><div class=post-content><p>花明浩，杨凌辉</p><p>（天津大学 精密仪器与光电子工程学院，天津300072）</p><p>针对工作空间测量定位系统（wMPS）等基于光电扫描的测量网络对光平面信息检测的要求，提出了一种基于可编程器件的光平面信息检测与区分的系统。该设计使用Xilinx公司的Zynq芯片，在FPGA中设计逻辑电路实现对光平面的电脉冲信息捕获与锁存，并设计符合AXI总线通信协议的IP核增加通信速度。通过仿真表明，该设计具有时间开销小、实时性强等优点，提高了系统效率，同时可应用于其他光学定位设备中，提高定位精度。</p><p>可编程器件；光电扫描；光平面检测；定位系统</p><p><strong>中图分类号：</strong>TN91；TP3</p><p><strong>文献标识码：</strong>A</p><p><strong>DOI：</strong>10.16157/j.issn.0258-7998.172527</p><p><strong>中文引用格式：</strong>花明浩，杨凌辉. 光电扫描测量网络信号采集模块设计[J].电子技术应用，2018，44(1)：45-48.</p><p><strong>英文引用格式：</strong>Hua Minghao，Yang Linghui. Design of signal acquisition module in optical scanning measurement network[J]. Application of Electronic Technique，2018，44(1)：45-48.</p><p><strong>0 引言</strong></p><p>基于光电扫描的座标定位系统是近年来新兴的一种座标测量方法，具有精确度高、不易受周围环境干扰等优点，因此在日本尼康公司生产的室内GPS（indoor GPS，iGPS）设备、天津大学精密测试技术及仪器实验室研发的工作空间测量定位系统（workspace Measuring and Positioning System，wMPS）中都得到了广泛的应用<sup>[1]</sup>。然而，基于光电扫描的定位系统对光脉冲信息处理要求的实时性极高，如何迅速并准确地将光脉冲信息转变为电脉冲信息，并从中获得相应光平面的信息，对保证系统的定位精度有着极为重要的意义。</p><p>本文基于Xilinx公司推出的Zynq-7000系列全可编程片上系统，采用ARM+FPGA架构的Zynq芯片，提出了一种新型的将光平面信息检测与区分的方法，在FPGA中设计逻辑电路来实现对光平面的电脉冲信息捕获与锁存，并设计基于AXI总线协议的IP核，以此来对光平面信息进行高效的识别、处理与传输。</p><p><strong>1 wMPS基本原理及信号采集模块架构</strong></p><p><strong>1.1 wMPS工作基本原理</strong></p><p>wMPS是一种新型的基于光电扫描的测量系统，其组成如图1所示。</p><img alt=光电扫描测量网络信号采集模块设计 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/566d000f3a0fa75f82de><p>发射站向四周发射两束扫描光以及一束同步光，接收器接收到光脉冲的信息并将其转变为电脉冲，前端处理器接收电脉冲后将其按照周期进行区分，获得其角度信息，并上传给计算机最终完成座标解算<sup>[2]</sup>。</p><img alt=光电扫描测量网络信号采集模块设计 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/567500071cc3a0f86efc><img alt=光电扫描测量网络信号采集模块设计 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/5676000716bceeb8b1ac><p>当系统由两台及以上的发射站组成时，则可以使用类似经纬仪的测量原理来测量接收器在全局座标系下的座标<sup>[3]</sup>。其测量原理如图3所示。</p><img alt=光电扫描测量网络信号采集模块设计 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/5673000f494020f81f3a><p>当空间内某一处的接收器Rx:(x，y，z)能同时接收到两发射站Tx1以及Tx2的光信息时，在计算出接收器在每个发射站座标系下的水平角α<sub>1</sub>、α<sub>2</sub>与垂直角β<sub>1</sub>、β<sub>2</sub>后，假设已知发射站的座标为Tx1:(0，0，0)与Tx2:(x，0，0)，则可通过如下公式计算接收器的座标：</p><img alt=光电扫描测量网络信号采集模块设计 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/566d000f3a10f8d34bd1><p>在大型测量网络中，接收器常常会同时接收多个发射站的光信息，其光脉冲示意图如图4所示。为了利用光平面的信息解算出接收器的全局座标，前端处理器需要记录每一个电脉冲上升沿和下降沿到来的时间，以脉冲宽度来区分出同步光信号与扫描光信号<sup>[4]</sup>，最终精确求解接收器的全局座标。</p><img alt=光电扫描测量网络信号采集模块设计 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/5673000f49417f3cf94e><p><strong>1.2 前端处理器总体架构</strong></p><p>前端处理器是wMPS测量系统的最重要的组成部分，它是系统安全、稳定、准确运转的重要保证。如何将来自大尺寸空间中发射站的光信息如实地记录与准确地区分，同时具有一定的扩容能力，对于整个wMPS系统是至关重要的。</p><p>基于Zynq芯片的wMPS前端处理器主要由两部分组成：可编程逻辑（Programmable Logic，PL）部分和作为ARM控制的处理系统（Processing System，PS）部分。它们之间通过AXI总线进行通信，PL部分擅长做逻辑运算以及并行性强的任务，而PS部分擅长做串行以及控制偏多的任务<sup>[5]</sup>。因此在PL中设计逻辑电路来实现信号的采集与存储，而PS 部分则负责后续对光平面脉冲的分类与处理，使得整个前端处理器的运算效率达到最大。基于Zynq的前端处理器架构如图5所示。</p><img alt=光电扫描测量网络信号采集模块设计 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/56770003323adc464a2e><p><strong>2 信号采集模块逻辑设计</strong></p><p>在PL部分中的信号采集模块划分如下：</p><p>(1)光平面信息检测与存储部分。当光电接收单元接收到发射站的同步光信号和扫描光信号时，将转化为相应的电脉冲传递给PL部分，PL部分通过3个状态机将相应脉冲的上升沿、下降沿以及对应的时间记录，并传给FIFO进行保存。</p><p>(2)光平面信息传输接口部分。光平面的信息存储在FIFO逻辑电路中，而PL部分与PS部分的通信基于AXI总线协议，因此需要设计相应的逻辑电路来实现信息的读取与传输。</p><p>IP核是具有知识产权的集成电路芯核，是经过反复验证的具有特定功能的模块，与芯片制造工艺无关，可移植到不同的半导体工艺中。Xilinx公司提供了许多免费且功能强大的IP核给开发人员使用。在wMPS前端处理的PL部分设计中，也采用了许多Xilinx提供的IP核，这使得开发流程简洁许多，并且正确性与可靠性得到了保证。其中测量同步控制模块采用Xilinx提供的基于AXI总线的GPIO模块，计数器采用Xilinx的二进制模块，以及与上位机交互的通信模块。因此关于这些部分本文不再进行讨论，主要讨论信号捕捉与计时存储模块以及基于AXI总线的FIFO接口模块的IP核设计。</p><p><strong>2.1 信号捕捉与计时存储模块</strong></p><p>wMPS前端处理器PL部分最核心的工作就是对来自接收器的电脉冲进行捕捉以及锁存时间值，其主要逻辑结构如图6所示。通过3个协同工作的状态机来分别完成捕捉边沿信号、产生标志位以及锁存时间值3个任务。</p><img alt=光电扫描测量网络信号采集模块设计 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/5673000f4946a4459213><p>图7所示为捕捉边沿信号的状态机状态转换图。状态机缓冲来自接收器的电脉冲信号，输出Trig与Trig_n。Trig_En初始时为0，进入IDLE状态。当开始测量时，Trig_En被置1，此时若输入为0(IN=0)，则进入REDY状态。当IN为1时，进入上升沿状态(POSEDGE_IN)，Trig置1。一个时钟周期后将Trig信号再拉低，进入等待(DELAY)状态。等到IN为0时，再进入下降沿状态(NEGEDGE_IN)，此时将Trig_n拉高一个周期。再根据输入IN的状态进行判断进入空闲状态(IDLE)还是上升沿状态(POSEDGE_IN)。</p><img alt=光电扫描测量网络信号采集模块设计 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/5674000b0afb45d39155><p>图8所示为脉冲捕捉计时状态机转换图，包含空闲(IDLE)、等待(WAIT)、捕捉(CAPT)3种状态。当脉冲捕捉状态机没有接收到PS部分指令时，处于空闲状态；当收到来自PS部分指令后，且脉冲捕捉状态机处于非复位状态时，跳转至等待状态；当Trig或者Trig_n输出有一个为1时，进行信号捕捉，将FIFO写使能信号置1，同时将30位计数器的时间值记录下来，TP_Capt为计数器捕捉瞬间的时间值，将其写入FIFO存储。在工作状态下(Trig_En=1&&Rst_n=1)，每次时钟上升沿到来时，若是Trig或Trig_n中有一个信号有输入，则捕获信号触发的时间值（30位），并写入FIFO，否则处于等待期间。</p><img alt=光电扫描测量网络信号采集模块设计 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/567500071cce7daa9691><p>图9为事件捕捉状态机转换图，包含空闲(IDLE)、等待(WAIT)、上升沿(RIS)、延迟(DELAY)、下降沿(FAL)沿5种状态。当接收到PS指令后，从空闲状态跳转至等待状态，TP_Type保持上一状态的信号。当来自边沿信号捕捉状态机的输出Trig为1时，进入RIS状态，TP_Type被标记为上升沿（01）。下一时钟周期到来时对Trig_n的信号进行判断，若为1，则TP_Type被标记为下降沿(10)；否则TP_Type保持住，直到Trig_n信号为1时再标记为下降沿。而当状态机位于下降沿状态时，若下个周期Trig信号为1，则跳转回上升沿状态，TP_Type改变相应标记；否则状态机跳转回等待状态，TP_Type继续保持上一状态。</p><img alt=光电扫描测量网络信号采集模块设计 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/567500071ccf0a687c1c><p><strong>2.2 基于AXI总线的FIFO接口模块设计</strong></p><p>为提高wMPS前端处理器的工作效率，本文基于AXI总线通信协议，定制FIFO的接口模块，利用硬件逻辑控制读取工作，缩短读取时间来提高系统的工作效率。</p><p>图10为FIFO接口模块的内部结构，它包括以下几部分：FIFO读取逻辑、AXI总线接口以及多个控制寄存器。其中AXI总线接口是Xilinx公司提供的标准通信协议，该模块在AXI总线与用户逻辑之间提供双向的接口<sup>[6]</sup>。模块中有3个寄存器，其中寄存器0用来从AXI总线上接收指令，寄存器1与寄存器2分别用来存储FIFO存储的数据与FIFO的标志位数据。使用这样的方式读取FIFO中的数据，仅需2个时钟周期即可完成，极大地提高了前端处理器的工作效率。</p><img alt=光电扫描测量网络信号采集模块设计 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/5957000325085fe03140><p><strong>3 wMPS前端处理器PL部分逻辑仿真</strong></p><p>为了验证前端处理器PL部分的逻辑功能的完整性与可靠性，分别对设计的信号捕捉与计时存储模块以及基于AXI总线的FIFO接口模块进行仿真验证。</p><p><strong>3.1 信号捕捉与计时存储模块仿真</strong></p><p>使用Vivado提供的仿真器，输入信号为随机产生的宽度随机的脉冲信号，观察dout中读出的数据以及相应的FIFO标志位，验证设计的正确性。仿真波形如图11所示。</p><img alt=光电扫描测量网络信号采集模块设计 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/567500071cd136c26c83><p>由图11可以清晰地观察到，输出的数据dout以及FIFO的标志位FIFO_Flag均在两个时钟周期后跳转，即系统的延迟仅仅为两个时钟周期，满足设计需求。</p><p><strong>3.2 FIFO接口模块仿真</strong></p><p>由于FIFO接口模块为基于AXI总线定制，若是直接仿真，不易满足时序要求，因此使用Xilinx的ISE，利用总线仿真模型(Bus Function Model，BFM)对FIFO接口模块进行仿真，通过FIFO端口写入数据， 并从寄存器中读取并观察输出信号。基于BFM的FIFO接口模块仿真如图12所示，可以观察到，用户IP可以正确输出读FIFO时序，两个周期就可以读出FIFO中的内容。因此从接收器检测到脉冲信号到PS部分读取电脉冲信息，仅需4个时钟周期，延迟极小，满足系统应用要求。</p><img alt=光电扫描测量网络信号采集模块设计 onerror=errorimg.call(this); src=http://p9.pstatp.com/large/5673000f49496a3bd1f8><p><strong>4 结论</strong></p><p>本文提出了一种新型的将电脉冲信息检测并区分的方法，基于Zynq芯片解决了室内定位系统中光脉冲信号难以区分的难题。仿真验证表明，该设计的时钟延迟极小，具有很高的精度，可以满足现有wMPS系统对测量精度的要求，同时在其余基于光电扫描的室内定位系统中应用前景极高。</p><p><strong>参考文献</strong></p><p>[1] 端木琼，杨学友，邾继贵，等.基于光电扫描的三维座标测量系统[J].红外与激光工程，2011，40(10)：23-24.</p><p>[2] 张冀，杨学友.基于物联网技术的wMPS发射站控制系统[J].计算机测量与控制，2014，22(10)：3174-3175.</p><p>[3] 李广云.非正交系座标测量系统原理及进展[J].测绘信息与工程，2003，28(1)：2097-2098.</p><p>[4] 杨凌辉.基于光电扫描的大尺度空间座标测量定位技术研究[D].天津：天津大学，2010.</p><p>[5] 韩德强，杨利平，王宗侠.基于Zynq-7000的宽幅视频处理系统设计与实现[J].电子技术应用，2016，42(6)：59- 62，66.</p><p>[6] 何斌，张艳辉.Xilinx Zynq-7000嵌入式系统设计与实现[M].北京：电子工业出版社，2016.</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'光电扫','描测量','网络'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>