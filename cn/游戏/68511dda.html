<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>ä¸€æ¬¾å¼€æºçš„ä»£ç éƒ¨ç½²å·¥å…·syncd | æå®¢å¿«è¨Š</title><meta property="og:title" content="ä¸€æ¬¾å¼€æºçš„ä»£ç éƒ¨ç½²å·¥å…·syncd - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/912bd2aacb3248e6ae345571d791df29"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/68511dda.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/68511dda.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/68511dda.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/68511dda.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/68511dda.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/68511dda.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/68511dda.html><link rel=canonical href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/68511dda.html><meta property="article:published_time" content="2020-11-14T20:54:26+08:00"><meta property="article:modified_time" content="2020-11-14T20:54:26+08:00"><meta name=Keywords content><meta name=description content="ä¸€æ¬¾å¼€æºçš„ä»£ç éƒ¨ç½²å·¥å…·syncd"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E6%B8%B8%E6%88%8F/68511dda.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>ä¸€æ¬¾å¼€æºçš„ä»£ç éƒ¨ç½²å·¥å…·syncd</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E6%B8%B8%E6%88%8F.html>æ¸¸æˆ</a></span></div><div class=post-content><div><h1>ç‰¹æ€§</h1><ul><li>Goè¯­è¨€å¼€å‘ï¼Œç¼–è¯‘ç®€å•ã€è¿è¡Œé«˜æ•ˆ</li><li>Webç•Œé¢è®¿é—®ï¼Œäº¤äº’å‹å¥½</li><li>çµæ´»çš„è§’è‰²æƒé™é…ç½®</li><li>æ”¯æŒGitä»“åº“</li><li>åˆ†æ”¯ã€tagä¸Šçº¿</li><li>éƒ¨ç½²hookæ”¯æŒ</li><li>å®Œå–„çš„ä¸Šçº¿å·¥ä½œæµ</li><li>é‚®ä»¶é€šçŸ¥æœºåˆ¶</li></ul><h1>åŸç†</h1><div class=pgc-img><img alt=ä¸€æ¬¾å¼€æºçš„ä»£ç éƒ¨ç½²å·¥å…·syncd onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/912bd2aacb3248e6ae345571d791df29><p class=pgc-img-caption></p></div><p>Git</p><p>SyncdæœåŠ¡é€šè¿‡git-ssh(æˆ–password)æ–¹å¼ä»ä»“åº“ä¸­æ‹‰å–æŒ‡å®štag(åˆ†æ”¯)ä»£ç </p><p>æ„å»º</p><p>è¿è¡Œé…ç½®å¥½çš„æ„å»ºè„šæœ¬, ç¼–è¯‘æˆå¯ä¸Šçº¿çš„è½¯ä»¶åŒ…</p><p>åœ¨è¿™ä¸€ç¯èŠ‚ä¸­ï¼Œå¯è¿è¡Œå•å…ƒæµ‹è¯• (ä¾‹å¦‚ go test php phpunit, ä¸‹è½½ä¾èµ– (å¦‚ go: glide install php: composer install), ç¼–è¯‘è½¯ä»¶åŒ… (å¦‚ js: npm build go: go build xx.go java: javac xx.java c: cc xx.c) ç­‰.</p><p>åˆ†å‘</p><p>é€šè¿‡ scp å‘½ä»¤åˆ†å‘è½¯ä»¶åŒ…åˆ°å„æœºæˆ¿ç”Ÿäº§æœåŠ¡å™¨çš„ä¸´æ—¶ç›®å½•, è¿œç¨‹æ‰§è¡Œ pre-deploy é…ç½®çš„å‘½ä»¤, æ‰§è¡Œå®Œæ¯•åè§£å‹ç¼©è½¯ä»¶åŒ…åˆ°ç›®æ ‡ç›®å½•ï¼Œç„¶åæ‰§è¡Œ post-deploy å‘½ä»¤</p><p>åˆ†å‘ä¸Šçº¿è¿‡ç¨‹æ˜¯ä¸²è¡Œæ‰§è¡Œï¼Œå¹¶ä¸”ä»»æ„æ­¥éª¤æ‰§è¡Œå¤±è´¥æ•´ä¸ªä¸Šçº¿å•ä¼šç»ˆæ­¢ä¸Šçº¿å¹¶å°†çŠ¶æ€ç½®ä¸ºä¸Šçº¿å¤±è´¥ï¼Œéœ€è¦ç‚¹å‡» <strong>å†æ¬¡ä¸Šçº¿</strong> é‡è¯•.</p><blockquote><p>å°†æ¥ä¼šæ”¯æŒåŒä¸€é›†ç¾¤æœåŠ¡å™¨å¹¶è¡Œæ‰§è¡Œ, é›†ç¾¤ä¹‹é—´ä¸²è¡Œå‘å¸ƒçš„ç‰¹æ€§</p></blockquote><p>SSHä¿¡ä»»</p><p>ç”Ÿäº§æœåŠ¡å™¨ä¸éƒ¨ç½²æœåŠ¡å™¨ä¹‹é—´é€šè¿‡ssh-keyå»ºç«‹ä¿¡ä»»</p><p>é…ç½®æ–¹æ³•è¯·å‚è€ƒ ç§˜é’¥é…ç½® ç« èŠ‚</p><h1>å®‰è£…</h1><p>å‡†å¤‡å·¥ä½œ</p><ul><li>Go</li></ul><p>æ¨èGo1.10ä»¥ä¸Šç‰ˆæœ¬, ç”¨æ¥ç¼–è¯‘æºä»£ç </p><ul><li>Nginx</li></ul><p>WebæœåŠ¡ä¾èµ–Nginx</p><ul><li>MySQL</li></ul><p>ç³»ç»Ÿä¾èµ–Mysqlå­˜å‚¨æŒä¹…åŒ–æ•°æ®, æ¨èç‰ˆæœ¬ Mysql 5.7</p><ul><li>Linux + Bash</li></ul><p>ç³»ç»Ÿä¼šä½¿ç”¨åˆ° git, ssh, scp ç­‰å‘½ä»¤ï¼Œæ‰€ä»¥ç›®å‰åªæ¨èåœ¨Linuxä¸Šä½¿ç”¨, å¹¶ä¸”éœ€è¦æå‰å®‰è£…æˆ–æ›´æ–°è¿™äº›å‘½ä»¤é“æœ€æ–°ç‰ˆæœ¬</p><ul><li>ç§˜é’¥é…ç½®</li></ul><p>ç”±äºéƒ¨ç½²æœåŠ¡å™¨(SyncdæœåŠ¡æ‰€åœ¨çš„æœåŠ¡å™¨)ä¸ç”Ÿäº§æœåŠ¡å™¨(ä»£ç éƒ¨ç½²ç›®æ ‡æœº)ä¹‹é—´é€šè¿‡sshåè®®é€šä¿¡ï¼Œæ‰€ä»¥éœ€è¦å°†éƒ¨ç½²æœºçš„å…¬é’¥ (ä¸€èˆ¬åœ¨è¿™é‡Œ: ~/.ssh/id_rsa.pub)åŠ å…¥åˆ°ç”Ÿäº§æœºçš„ä¿¡ä»»åˆ—è¡¨ä¸­(ä¸€èˆ¬åœ¨è¿™é‡Œ ~/.ssh/authorized_keys)</p><p>å¯ä½¿ç”¨ ssh-copy-id å‘½ä»¤æ·»åŠ ï¼Œæˆ–æ‰‹åŠ¨æ‹·è´. æ‹·è´åä¸è¦å¿˜è®°è¿›è¡Œæµ‹è¯•è¿é€šæ€§ ssh {ç”Ÿäº§æœºç”¨æˆ·å}@{ç”Ÿäº§æœºåœ°å€}</p><p>æœ€åå»ºè®®å°†ä»¥ä¸‹é…ç½®åŠ å…¥åˆ°éƒ¨ç½²æœåŠ¡å™¨sshé…ç½®/etc/ssh/ssh_configä¸­ï¼Œå…³é—­å…¬é’¥æ‘˜è¦çš„æ˜¾ç¤ºæç¤ºï¼Œé˜²æ­¢åå°è„šæœ¬è¿è¡Œå¤±è´¥</p><pre>Host * StrictHostKeyChecking no</pre><p>è¯·æ³¨æ„: sshç›®å½•æƒé™éœ€æŒ‰æ­¤è®¾ç½®ï¼Œå¦åˆ™ä¼šå‡ºç°æ— æ³•å…å¯†ç™»å½•çš„æƒ…å†µ</p><pre>~/.ssh 0700~/.ssh/authorized_keys 0600</pre><h1>å®‰è£…</h1><ul><li>è¿è¡Œä»¥ä¸‹å‘½ä»¤</li></ul><pre>curl https://raw.githubusercontent.com/dreamans/syncd/master/install.sh |bash</pre><p>å½“å‰è·¯å¾„ä¸­è‹¥ç”Ÿæˆ syncd-deploy æˆ–è€… syncd-deploy-xxx ç›®å½•åˆ™è¡¨æ˜å®‰è£…æˆåŠŸ</p><blockquote><p>ç”Ÿæˆçš„ syncd-deploy ç›®å½•å¯æ‹·è´æˆ–ç§»åŠ¨åˆ°ä½ æƒ³è¦çš„åœ°æ–¹ï¼Œä½†ä¸è¦è¯•å›¾å°†æ­¤ç›®å½•æ‹·è´åˆ°å…¶ä»–æœåŠ¡å™¨ä¸Šè¿è¡Œï¼Œä¼šé€ æˆä¸å¯é¢„æ–™çš„ç»“æœ.</p></blockquote><ul><li>æ•°æ®åº“ä¾èµ–</li></ul><p>ä½ éœ€è¦å°† github.com/dreamans/syncd/syncd.sql æ•°æ®è¡¨ç»“æ„å’Œæ•°æ®å¯¼å…¥åˆ°MySQLæ•°æ®åº“ä¸­</p><ul><li>ä¿®æ”¹é…ç½®æ–‡ä»¶</li></ul><p>ä¿®æ”¹ syncd-deploy/etc/syncd.ini ä¸­ç›¸å…³é…ç½®ä¿¡æ¯, å…·ä½“é…ç½®æè¿°å¯å‚è€ƒæ³¨é‡Š</p><ul><li>å¯åŠ¨æœåŠ¡</li></ul><pre>cd syncd-deployâœ syncd-deploy ./bin/syncd -c ./etc/syncd.ini __ _____ __ __ ____ _____ ____/ / / ___/ / / / / / __ \ / ___/ / __ / (__ ) / /_/ / / / / / / /__ / /_/ //____/ \__, / /_/ /_/ \___/ \__,_/ /____/Service: syncdVersion: 1.0.0Config Loaded: ./etc/syncd.iniLog: stdoutDatabase: 127.0.0.1Mail Enable: 0HTTP Service: :8868Start Running...</pre><ul><li>æ·»åŠ Nginxé…ç½®</li></ul><pre>upstream syncdServer { server 127.0.0.1:8868 weight=1;}server { listen 80; server_name deploy.syncd.cc; # æ­¤å¤„æ›¿æ¢æˆä½ çš„çœŸå®åŸŸå access_log logs/deploy.syncd.cc.log; location / { try_files $uri $uri/ /index.html; root /path/syncd-deploy/public; # æ­¤å¤„/pathè¯·æ›¿æ¢æˆçœŸå®è·¯å¾„ index index.html index.htm; } location ^~ /api/ { proxy_pass http://syncdServer; proxy_set_header X-Forwarded-Host $host:$server_port; proxy_set_header X-Real-IP $remote_addr; proxy_set_header Origin $host:$server_port; proxy_set_header Referer $host:$server_port; }}</pre><p>é‡å¯nginxæœåŠ¡</p><p>ä¿®æ”¹hosts</p><p>è‹¥åŸŸåæœªè§£æï¼Œå¯ä¿®æ”¹hostsè¿›è¡Œä¸´æ—¶è§£æ</p><pre>sudo vim /etc/hosts127.0.0.1 deploy.syncd.cc;</pre><p>å®‰è£…å®Œæˆ</p><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® http://deploy.syncd.cc</p><p>åˆå§‹è´¦å·:</p><pre>ç”¨æˆ·å: syncdé‚®ç®±: syncd@syncd.ccå¯†ç : syncd.cc</pre><p><strong>!!!ç™»å½•åè¯·å°½å¿«ä¿®æ”¹å¯†ç </strong></p><h1>ä½¿ç”¨</h1><p>ç³»ç»Ÿä½¿ç”¨æµç¨‹å›¾</p><div class=pgc-img><img alt=ä¸€æ¬¾å¼€æºçš„ä»£ç éƒ¨ç½²å·¥å…·syncd onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6e0433f774354bb0a0f57988659b6a04><p class=pgc-img-caption></p></div><h1>ä½¿ç”¨æˆªå›¾</h1><div class=pgc-img><img alt=ä¸€æ¬¾å¼€æºçš„ä»£ç éƒ¨ç½²å·¥å…·syncd onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1a37eae8962a4b3189123c5a66c58157><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=ä¸€æ¬¾å¼€æºçš„ä»£ç éƒ¨ç½²å·¥å…·syncd onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f519466330304d7688d467f32545aa72><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=ä¸€æ¬¾å¼€æºçš„ä»£ç éƒ¨ç½²å·¥å…·syncd onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2d42587c474e45f38b847a7f4e348704><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=ä¸€æ¬¾å¼€æºçš„ä»£ç éƒ¨ç½²å·¥å…·syncd onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fe2e57977a4f4be4b8eda8d061cb7d04><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=ä¸€æ¬¾å¼€æºçš„ä»£ç éƒ¨ç½²å·¥å…·syncd onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c871d116f93f4e969832dc2ea9eb05fe><p class=pgc-img-caption></p></div><h1>é¡¹ç›®åœ°å€</h1><p>https://gitee.com/dreamans/syncd</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'å¼€æº','ä»£ç ','syncd'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>