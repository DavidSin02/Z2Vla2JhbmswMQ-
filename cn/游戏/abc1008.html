<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>遗传算法和超参数 | 极客快訊</title><meta property="og:title" content="遗传算法和超参数 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="http://p3.pstatp.com/large/pgc-image/1535181061510088ebc8f85"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/abc1008.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/abc1008.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/abc1008.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/abc1008.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/abc1008.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/abc1008.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/abc1008.html><link rel=canonical href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/abc1008.html><meta property="article:published_time" content="2020-10-29T20:46:33+08:00"><meta property="article:modified_time" content="2020-10-29T20:46:33+08:00"><meta name=Keywords content><meta name=description content="遗传算法和超参数"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E6%B8%B8%E6%88%8F/abc1008.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>遗传算法和超参数</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E6%B8%B8%E6%88%8F.html>游戏</a></span></div><div class=post-content><div><div class=pgc-img><img alt=遗传算法和超参数 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/pgc-image/1535181061510088ebc8f85><p class=pgc-img-caption></p></div><h1>遗传算法是什么?</h1><p>遗传算法是优化问题的一种解决方案，例如，如果你需要找到最佳的参数集来最小化损失函数。遗传算法是进化算法的一部分。这个想法受到自然和自然选择的启发。</p><p>在自然界中，进化至少需要三个条件:</p><ul><li>遗传——生物体必须能够将某些特定的特征遗传给后代;</li><li>变异——种群内的生物必须具有不同的特征;</li><li>竞争——产生的后代数量超过了生存能力。</li></ul><p>现在想象一下，你在一个特定的编程环境中编码了一些对象，而不是生物体。例如，如果你有一个机器学习（ML）模型的种群，它会如何工作?</p><ol><li>首先生成ML模型的初始种群，随机选择超参数。</li><li>计算每个模型的损失函数，例如，对数损失。</li><li>然后选择一些误差最小的模型。</li><li>现在您需要创建后代，因此您需要基于上一代最好的模型创建一组新的机器学习（ML）模型，并稍微更改它们的超参数。您的新种群将从以前的种群中的模型和新生成的模型中以一定比例包含，例如，50/50。</li><li>计算损失函数，对模型进行排序，然后再重复整个过程。</li></ol><p>遗传算法并不完美，您仍然需要指定您的损失函数、您的种群大小、具有变化参数的后代比例等等。</p><h1>TPOT</h1><p>可能是对遗传超参数调优最友好的库。</p><p>GitHub:https://github.com/EpistasisLab/tpot</p><p>以下是我从TPOT中提取最佳超参数的方法，Python代码如下：</p><blockquote><p>#Search for best hyperparameters for XGBoost</p><p>from xgboost import XGBClassifier</p><p>from tpot import TPOTClassifier, TPOTRegressor</p><p>from deap.gp import Primitive</p><p>#Define your hyperparameters</p><p>params = {'max_depth': np.arange(1,200,1),</p><p>'learning_rate': np.arange(0.0001,0.1,0.0001),</p><p>'n_estimators': np.arange(1,200,1),</p><p>'nthread':[6],</p><p>'gamma':np.arange(0.00001,0.1,0.00001),</p><p>'subsample':np.arange(0.1,2,0.1),</p><p>'reg_lambda': np.arange(0.1,200,1),</p><p>'reg_alpha': np.arange(1,200,1),</p><p>'min_child_weight': np.arange(1,200,1),</p><p>'gamma': np.arange(0.1,2,0.1),</p><p>'colsample_bytree': np.arange(0.1,2,0.1),</p><p>'colsample_bylevel': np.arange(0.1,2,0.1)</p><p>}</p><p>#Run TPOT</p><p>tpot_classifier = TPOTClassifier(generations=20, population_size=500, offspring_size=250,</p><p>verbosity=2, early_stop=8,</p><p>config_dict={'xgboost.XGBClassifier': params}, cv = 10, scoring = 'accuracy')</p><p>tpot_classifier.fit(X, Y)</p><p>#Extract best parameters</p><p>args = {}</p><p>for arg in tpot_classifier._optimized_pipeline:</p><p>if type(arg) != Primitive:</p><p>try:</p><p>if arg.value.split('__')[1].split('=')[0] in ['max_depth', 'n_estimators', 'nthread','min_child_weigh']:</p><p>args[arg.value.split('__')[1].split('=')[0]] = int(arg.value.split('__')[1].split('=')[1])</p><p>else:</p><p>args[arg.value.split('__')[1].split('=')[0]] = float(arg.value.split('__')[1].split('=')[1])</p><p>except:</p><p>pass</p><p>params = args</p><p>#Now you can use XGBoost with best hyperparameters</p><p>xgbxgb == XGBClassifierXGBClas (**params)</p></blockquote><h1>如何调整神经网络？</h1><p>在神经网络的情况下，您还可以使用遗传算法，它们的工作速度比基于网格搜索的方法快得多。</p><p>我找到了这个GitHub存储库 - 使用遗传算法演化神经网络（https://github.com/harvitronix/neural-network-genetic-algorithm），并且非常喜欢这种方法。</p><p>用法示例：</p><blockquote><p>from evolution import NeuroEvolution</p><p>params = {</p><p>"epochs": [10, 20, 35],</p><p>"batch_size": [10, 20, 40],</p><p>"n_layers": [1, 2, 3, 4],</p><p>"n_neurons": [20, 40, 60],</p><p>"dropout": [0.1, 0.2, 0.5],</p><p>"optimizers": ["nadam", "adam"],</p><p>"activations": ["relu", "sigmoid"],</p><p>"last_layer_activations": ["sigmoid"],</p><p>"losses": ["binary_crossentropy"],</p><p>"metrics": ["accuracy"]</p><p>}</p></blockquote><p>....</p><blockquote><p># x_train, y_train, x_test, y_test - prepared data</p><p>search = NeuroEvolution(generations = 10, population = 10, params=params)</p><p>search.evolve(x_train, y_train, x_test, y_test)</p><p>100%|██████████| 10/10 [05:37&lt;00:00, 29.58s/it]</p><p>100%|██████████| 10/10 [03:55&lt;00:00, 25.55s/it]</p><p>100%|██████████| 10/10 [02:05&lt;00:00, 15.05s/it]</p><p>100%|██████████| 10/10 [01:37&lt;00:00, 14.03s/it]</p><p>100%|██████████| 10/10 [02:49&lt;00:00, 22.53s/it]</p><p>100%|██████████| 10/10 [02:37&lt;00:00, 23.14s/it]</p><p>100%|██████████| 10/10 [02:36&lt;00:00, 21.37s/it]</p><p>100%|██████████| 10/10 [01:57&lt;00:00, 18.56s/it]</p><p>100%|██████████| 10/10 [02:42&lt;00:00, 25.29s/it]</p><p>"best accuracy: 0.79, best params: {'epochs': 35, 'batch_size': 40, 'n_layers': 2, 'n_neurons': 20, 'dropout': 0.1, 'optimizers': 'nadam', 'activations': 'relu', 'last_layer_activations': 'sigmoid', 'losses': 'binary_crossentropy', 'metrics': 'accuracy'}"</p><p># or you can call it with</p><p>search.best_params</p></blockquote><p>它还可以搜索最佳数量的图层和神经元，以及您定义的超参数的位置。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'遗传','参数','算法'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>