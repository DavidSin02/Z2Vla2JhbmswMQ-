<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>小课堂：在R中使用遗传算法进行特征选择 | 极客快訊</title><meta property="og:title" content="小课堂：在R中使用遗传算法进行特征选择 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="http://p1.pstatp.com/large/pgc-image/486be95b60e7449685a416a26c047a8c"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/e085b2e.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/e085b2e.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/e085b2e.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/e085b2e.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/e085b2e.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/e085b2e.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/e085b2e.html><link rel=canonical href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/e085b2e.html><meta property="article:published_time" content="2020-10-29T20:46:33+08:00"><meta property="article:modified_time" content="2020-10-29T20:46:33+08:00"><meta name=Keywords content><meta name=description content="小课堂：在R中使用遗传算法进行特征选择"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E6%B8%B8%E6%88%8F/e085b2e.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>小课堂：在R中使用遗传算法进行特征选择</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E6%B8%B8%E6%88%8F.html>游戏</a></span></div><div class=post-content><div><blockquote><strong>点击上方关注，All in AI中国</strong></blockquote><p class=ql-align-justify>这是一篇关于在R中使用遗传算法进行特征选择的文章，我们先快速回顾一下：</p><ul><li class=ql-align-justify>什么是遗传算法？</li><li class=ql-align-justify>机器学习中的遗传算法（GA）</li><li class=ql-align-justify>解决方案是什么样的？</li><li class=ql-align-justify>GA流程及其运算符</li><li class=ql-align-justify>适应度函数</li><li class=ql-align-justify>R中的遗传算法！</li><li class=ql-align-justify>亲自尝试一下</li><li class=ql-align-justify>相关概念</li></ul><div class=pgc-img><img alt=小课堂：在R中使用遗传算法进行特征选择 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/486be95b60e7449685a416a26c047a8c><p class=pgc-img-caption>动画来源：“基于肌肉的双足生物运动” - Thomas Geijtenbeek</p></div><p class=ql-align-justify><strong>背后的秘密</strong></p><p class=ql-align-justify>想象一个黑盒子可以帮助我们产生无限多种可能性，其标准是我们可以找到一个可接受的解决方案（时间和质量）来解决我们制定的问题。</p><p class=ql-align-justify><strong>什么是遗传算法？</strong></p><p class=ql-align-justify>遗传算法（GA）是一个受著名的查尔斯达尔文自然选择思想启发的数学模型。</p><p class=ql-align-justify>自然选择仅保留了不同代人中最适合的个体。</p><p class=ql-align-justify>想象一下，1900年有100只兔子，我们会比兔子祖先更快、更熟练地找到食物。</p><p class=ql-align-justify><strong>机器学习中的GA</strong></p><p class=ql-align-justify>在机器学习中，遗传算法的一个用途是获取正确数量的变量以创建预测模型。</p><p class=ql-align-justify>选择正确的变量子集是一个组合优化的问题。</p><p class=ql-align-justify>这种技术优于其他技术的优势在于，它可以从最好的先前解决方案中获得最佳解决方案。一种进化算法，随着时间的推移可以改进选择。</p><p class=ql-align-justify>GA的想法是将一代又一代的不同解决方案结合起来，从每一个解决方案中提取最佳基因（变量）。这样就形成了更新、更适合的个体。</p><p class=ql-align-justify>我们可以找到GA的其他用途，例如超调节参数，找到函数的最大值（或最小值）或搜索正确的神经网络结构（Neuroevolution），或者其他......</p><p class=ql-align-justify><strong>特征选择中的GA</strong></p><p class=ql-align-justify>作为选定变量（单个兔子）的GA的每个可能解决方案都被视为一个整体，它不会针对目标单独对变量进行排序。</p><p class=ql-align-justify>这很重要，因为我们已经知道变量在组中是起作用的。</p><p class=ql-align-justify><strong>解决方案是什么样的？</strong></p><p class=ql-align-justify>举个简单的例子，假设我们总共有6个变量，</p><p class=ql-align-justify>一个解决方案可以是获取3个变量，比方说：var2、var4和var5。</p><p class=ql-align-justify>另一种解决方案可以是：var1和var5。</p><p class=ql-align-justify>这些解决方案是人群中所谓的个体或染色体。它们是解决问题的可能办法。</p><div class=pgc-img><img alt=小课堂：在R中使用遗传算法进行特征选择 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/pgc-image/1d492771eb1f419883bdf5c1077dc69e><p class=pgc-img-caption></p></div><p class=ql-align-justify>从图像中可以看出，解3可以表示为单热矢量：c（1,0,1,0,1,1）。每个1表示包含该变量的解决方案。在这种情况下是：var1、var3、var5、var6。</p><p class=ql-align-justify>而解决方案4是：c（1,1,0,1,1,0）。</p><p class=ql-align-justify>载体中的每个位置都是一个基因。</p><p class=ql-align-justify><strong>GA过程及其运算符</strong></p><div class=pgc-img><img alt=小课堂：在R中使用遗传算法进行特征选择 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/09fdc223b0774cebbd95e9b7bfd5fb3a><p class=pgc-img-caption></p></div><p class=ql-align-justify>遗传算法的基本思想是生成一些随机可能的解决方案（称为人口），它们代表不同的变量，然后在迭代过程中组合最佳解决方案。</p><p class=ql-align-justify>这种组合遵循基本的GA操作，即：选择、变异和交叉。</p><ul><li class=ql-align-justify>选择：在一代人中挑选最适合的人（即：提供最高ROC的解决方案）。</li><li class=ql-align-justify>交叉：基于两种解决方案的基因创建2个新个体。这些”孩子“将出现在下一代。</li><li class=ql-align-justify>突变：在个体中随机改变基因（即：将0翻转为1）</li></ul><p class=ql-align-justify>这个想法是针对每一代人，我们会找到更好的个体，就像跑得很快的兔子一样。</p><p class=ql-align-justify>我推荐Vijini Mallawaarachchi关于遗传算法如何工作的帖子。</p><p class=ql-align-justify>这些基本操作允许算法通过以最大化目标的方式组合它们来改变可能的解决方案。</p><p class=ql-align-justify><strong>适应度函数</strong></p><p class=ql-align-justify>例如，该目标最大化是为了保持与最大化ROC曲线下面积最大化的解。这是在适应度函数中定义的。</p><p class=ql-align-justify>适应度函数采用一个可能的解决方案（或染色体，如果您想要听起来更复杂的话），并以某种方式评估选择的有效性。</p><p class=ql-align-justify>通常，适应度函数采用单热矢量c（1,1,0,0,0,0），例如，创建一个具有var1和var2的随机森林模型，并返回适应值（ROC）。</p><p class=ql-align-justify>此代码中的适应度值计算为：ROC值/变量数。通过这样做，该算法利用大量变量惩罚解。类似于Akaike信息标准或AIC的想法。</p><div class=pgc-img><img alt=小课堂：在R中使用遗传算法进行特征选择 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/688bd9ab519948ec8a4c9af00d8b18e1><p class=pgc-img-caption></p></div><p class=ql-align-justify><strong>R中的遗传算法！</strong></p><p class=ql-align-justify>我的目的是为您提供一个干净的代码，以便您可以了解背后的内容，同时尝试修改适应度函数等新方法。这是至关重要的一点。</p><p class=ql-align-justify>要在您自己的数据集上使用，请确保data_x（数据框）和data_y（因子）与custom_fitness函数兼容。</p><p class=ql-align-justify>主库是由Luca Scrucca开发的GA。请看这里的示例。</p><p class=ql-align-justify>重要提示：以下代码不完整。克隆存储库以运行该示例。</p><div class=pgc-img><img alt=小课堂：在R中使用遗传算法进行特征选择 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/pgc-image/51ae3e0bd6034a09b65207083b19db39><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=小课堂：在R中使用遗传算法进行特征选择 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/pgc-image/6124ea319c4e404b94fdc34784cf9ced><p class=pgc-img-caption></p></div><ul><li class=ql-align-justify>蓝点：总体适合度平均值</li><li class=ql-align-justify>绿点：最佳适应度值</li></ul><p class=ql-align-justify>注意：不要期望那么快的结果</p><p class=ql-align-justify>现在我们根据最佳选择计算精度！</p><div class=pgc-img><img alt=小课堂：在R中使用遗传算法进行特征选择 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/ce403a9f31f443ad81a94de85513f9c9><p class=pgc-img-caption></p></div><p class=ql-align-justify>精度约为95,08％，而ROC值接近0.95（ROC =适应值*变量数，检查适应度函数）。</p><p class=ql-align-justify><strong>分析结果</strong></p><p class=ql-align-justify>我不喜欢在没有截断点的情况下分析准确度（评分数据），但是与这个Kaggle帖子的结果进行比较是有用的。</p><p class=ql-align-justify>他使用基于5个变量的递归特征消除或RFE获得了类似的精度结果，而我们的解决方案保持在4。</p><p class=ql-align-justify><strong>亲自尝试一下</strong></p><p class=ql-align-justify>尝试新的适应度函数，有些解决方案仍然提供大量变量，可以尝试平方变量的数量。</p><p class=ql-align-justify>要尝试的另一件事是获取ROC值的算法，甚至是更改度量标准的算法。</p><p class=ql-align-justify>一些配置持续很长时间。在建模之前平衡类并使用p_sampling参数。采样技术可以对模型产生重大影响。有关详细信息，请查看模型性能帖子上的样本大小和类平衡。</p><p class=ql-align-justify>如何改变基因突变率或成为精英主义的比率？或尝试其他交叉方法？</p><p class=ql-align-justify>增加popSize以同时测试更多可能的解决方案（按时间成本）。</p><p class=ql-align-justify>随意分享任何见解或想法，以改善选择。</p><p class=ql-align-justify>克隆存储库以运行该示例。</p><p class=ql-align-justify><strong>相关的概念</strong></p><p class=ql-align-justify>GA和深度学习之间存在一种并行性、迭代和改进的概念随着时间的推移是相似的。</p><p class=ql-align-justify>我添加了p_sampling参数以加快速度。它通常会实现其目标，与深度学习中使用的批处理概念类似。另一个相似之处是在GA参数运行和神经网络训练中的早期停止标准之间。</p><p class=ql-align-justify>但最大的相似之处在于两种技术都来自于对自然的观察。在这两种情况下，人类都观察神经网络和遗传学如何工作，并创建了一个模仿其行为的简化的数学模型。大自然有数百万年的进化，为什么不尝试模仿它呢？</p><div class=pgc-img><img alt=小课堂：在R中使用遗传算法进行特征选择 onerror=errorimg.call(this); src=http://p9.pstatp.com/large/pgc-image/8e119c7b841649ba9a9c448a652e93b3><p class=pgc-img-caption>编译出品</p></div></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'课堂','遗传','进行'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>