<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>ä½¿ç”¨Pythonä¼˜åŒ–ç¥ç»ç½‘ç»œå‚æ•°çš„é—ä¼ ç®—æ³• | æå®¢å¿«è¨Š</title><meta property="og:title" content="ä½¿ç”¨Pythonä¼˜åŒ–ç¥ç»ç½‘ç»œå‚æ•°çš„é—ä¼ ç®—æ³• - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="http://p9.pstatp.com/large/pgc-image/ff8157f76c514af2b80a27432ddb690c"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/e5aa1a1.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/e5aa1a1.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/e5aa1a1.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/e5aa1a1.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/e5aa1a1.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/e5aa1a1.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/e5aa1a1.html><link rel=canonical href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/e5aa1a1.html><meta property="article:published_time" content="2020-10-29T20:46:33+08:00"><meta property="article:modified_time" content="2020-10-29T20:46:33+08:00"><meta name=Keywords content><meta name=description content="ä½¿ç”¨Pythonä¼˜åŒ–ç¥ç»ç½‘ç»œå‚æ•°çš„é—ä¼ ç®—æ³•"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E6%B8%B8%E6%88%8F/e5aa1a1.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>ä½¿ç”¨Pythonä¼˜åŒ–ç¥ç»ç½‘ç»œå‚æ•°çš„é—ä¼ ç®—æ³•</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E6%B8%B8%E6%88%8F.html>æ¸¸æˆ</a></span></div><div class=post-content><div><p>äººå·¥ç¥ç»ç½‘ç»œæ˜¯ä¸€ç§ç›‘ç£æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œåœ¨è¯­éŸ³å’Œå›¾åƒè¯†åˆ«ã€æ—¶é—´åºåˆ—é¢„æµ‹ã€æœºå™¨ç¿»è¯‘è½¯ä»¶ç­‰é¢†åŸŸéƒ½æœ‰å¹¿æ³›çš„åº”ç”¨ã€‚å®ƒä»¬åœ¨ç ”ç©¶ä¸­å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬èƒ½å¤Ÿè§£å†³éšæœºé—®é¢˜ï¼Œè€Œéšæœºé—®é¢˜é€šå¸¸å…è®¸å¯¹æå…¶å¤æ‚çš„é—®é¢˜æ±‚è¿‘ä¼¼è§£ã€‚</p><p>ç„¶è€Œï¼Œå¾ˆéš¾å®šä¹‰ç†æƒ³çš„ç½‘ç»œç»“æ„ï¼Œå› ä¸ºä¸­é—´å±‚ä¸­æœ‰å¤šå°‘ç¥ç»å…ƒï¼Œä¸­é—´å±‚ä¸­æœ‰å¤šå°‘ç¥ç»å…ƒï¼Œä»¥åŠè¿™äº›ç¥ç»å…ƒä¹‹é—´çš„è¿æ¥åº”è¯¥å¦‚ä½•å®ç°éƒ½æ²¡æœ‰æ˜ç¡®çš„è§„åˆ™ã€‚ä¸ºäº†è§£å†³è¿™ç±»é—®é¢˜ï¼Œæœ¬æ–‡å°†æŒ‡å¯¼å¦‚ä½•ä½¿ç”¨é—ä¼ ç®—æ³•åœ¨Pythonä¸­è‡ªåŠ¨æŸ¥æ‰¾è‰¯å¥½çš„ç¥ç»ç½‘ç»œä½“ç³»ç»“æ„ã€‚</p><p>é¦–å…ˆï¼Œæ‚¨éœ€è¦å®‰è£…scikit-learnè½¯ä»¶åŒ…ã€‚</p><p>ä¸ºäº†è®­ç»ƒæ··åˆç®—æ³•ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Irisæœºå™¨å­¦ä¹ æ•°æ®é›†ã€‚</p><div class=pgc-img><img alt=ä½¿ç”¨Pythonä¼˜åŒ–ç¥ç»ç½‘ç»œå‚æ•°çš„é—ä¼ ç®—æ³• onerror=errorimg.call(this); src=http://p9.pstatp.com/large/pgc-image/ff8157f76c514af2b80a27432ddb690c><p class=pgc-img-caption></p></div><pre>from sklearn import datasetsimport numpy as npimport matplotlib.pyplot as pltfrom sklearn.neural_network import MLPClassifierfrom sklearn.metrics import accuracy_scorefrom sklearn.model_selection import train_test_splitfrom random import randintimport randomfrom sklearn.metrics import mean_absolute_error as maeiris = datasets.load_iris()X = iris.datay = iris.targetX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)</pre><div class=pgc-img><img alt=ä½¿ç”¨Pythonä¼˜åŒ–ç¥ç»ç½‘ç»œå‚æ•°çš„é—ä¼ ç®—æ³• onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/87593088096b42b6ada7113663e2625d><p class=pgc-img-caption></p></div><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹æ„å»ºé—ä¼ ç®—æ³•ã€‚è¿™é‡Œçš„ç¥ç»ç½‘ç»œæœ‰ä¸¤ä¸ªéšè—å±‚ã€‚ä¸‹é¢çš„Pythonä»£ç æ˜¾ç¤ºäº†ç§ç¾¤åˆå§‹åŒ–çš„ç¤ºä¾‹ã€‚ç§ç¾¤å¤§å°ç”±size_mlpå®šä¹‰ã€‚</p><pre>def inicialization_populacao_mlp(size_mlp): pop = [[]]*size_mlp activation = ['identity','logistic', 'tanh', 'relu'] solver = ['lbfgs','sgd', 'adam'] pop = [[random.choice(activation), random.choice(solver), randint(2,100), randint(2,100)] for i in range(0, size_mlp)] return pop</pre><div class=pgc-img><img alt=ä½¿ç”¨Pythonä¼˜åŒ–ç¥ç»ç½‘ç»œå‚æ•°çš„é—ä¼ ç®—æ³• onerror=errorimg.call(this); src=http://p9.pstatp.com/large/pgc-image/80b7f2fe2c724d1ba478251b164d6e02><p class=pgc-img-caption></p></div><p>äº¤å‰ç®—å­æ˜¯ä¸€ç§å°†åŒäº²çš„ä¿¡æ¯ç»“åˆèµ·æ¥äº§ç”Ÿæ–°çš„ä¸ªä½“çš„ç®—å­ã€‚ç›®æ ‡æ˜¯å¢åŠ é—ä¼ å˜å¼‚ï¼Œå¹¶æä¾›æ›´å¥½çš„é€‰æ‹©ã€‚è¿™é‡Œä½¿ç”¨å•ç‚¹äº¤å‰ã€‚</p><pre>def crossover_mlp(mother_1, mother_2): child = [mother_1[0], mother_2[1], mother_1[2], mother_2[3]]  return child</pre><div class=pgc-img><img alt=ä½¿ç”¨Pythonä¼˜åŒ–ç¥ç»ç½‘ç»œå‚æ•°çš„é—ä¼ ç®—æ³• onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/433315a2362a44fab0f300324bdc6607><p class=pgc-img-caption></p></div><p>ä¸ºäº†è¿›ä¸€æ­¥å¢åŠ é—ä¼ å˜å¼‚å’Œé¿å…å±€éƒ¨æå°å€¼ï¼Œä½¿ç”¨çš„å¦ä¸€ä¸ªç®—å­æ˜¯çªå˜ã€‚çªå˜çš„æ¦‚ç‡ç”±prob_mutå®šä¹‰ã€‚</p><pre>def mutation_mlp(child, prob_mut): for c in range(0, len(child)): if np.random.rand() &gt; prob_mut: k = randint(2,3) child[c][k] = int(child[c][k]) + randint(1, 10) return child</pre><div class=pgc-img><img alt=ä½¿ç”¨Pythonä¼˜åŒ–ç¥ç»ç½‘ç»œå‚æ•°çš„é—ä¼ ç®—æ³• onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/7884361dfdae4b49ac63f0dda3bd5870><p class=pgc-img-caption></p></div><p>å› ä¸ºæ­¤ç¤ºä¾‹æ˜¯åˆ†ç±»ä»»åŠ¡ï¼Œæ‰€ä»¥é€‚åº”åº¦å‡½æ•°æ˜¯æ ¹æ®ç¥ç»ç½‘ç»œçš„å‡†ç¡®æ€§è®¡ç®—çš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé—ä¼ ç®—æ³•çš„ç›®æ ‡æ˜¯ä½¿ç¥ç»ç½‘ç»œçš„å‡†ç¡®æ€§æœ€å¤§åŒ–ã€‚</p><pre>def function_fitness_mlp(pop, X_train, y_train, X_test, y_test, size_mlp):  fitness = [[]]*size_mlp classifiers = [[]]*size_mlp j = 0 for w in pop: clf = MLPClassifier(activation=w[0], solver=w[1], alpha=1e-5, hidden_layer_sizes=(int(w[2]), int(w[3])), random_state=1) clf.fit(X_train, y_train) fitness[j] = mae(clf.predict(X_test), y_test) classifiers[j] = clf j = j+1 return fitness, classifiers</pre><div class=pgc-img><img alt=ä½¿ç”¨Pythonä¼˜åŒ–ç¥ç»ç½‘ç»œå‚æ•°çš„é—ä¼ ç®—æ³• onerror=errorimg.call(this); src=http://p3.pstatp.com/large/pgc-image/0da0a5940b694a2d8615ebeee16c5854><p class=pgc-img-caption></p></div><p>æœ€åï¼Œé—ä¼ ç®—æ³•çš„ä¸»ä½“å¾—ä»¥æ„å»ºã€‚</p><pre>def ag_mlp(X_train, y_train, X_test, y_test, num_epochs = 10, size_mlp=10, prob_mut=0.5): pop = inicialization_populacao_mlp(size_mlp) fitness, classifiers = function_fitness_mlp(pop, X_train, y_train, X_test, y_test, size_mlp) pop_fitness = np.array(list(zip(pop, fitness, classifiers))) pop_fitness_sort = pop_fitness[pop_fitness[:,1].argsort()] # population initialization for j in range(0, num_epochs): #seleciona os pais parent_1 = pop_fitness_sort[0:int(size_mlp/2)][:,0] parent_2 = pop_fitness_sort[int(size_mlp/2)::][:,0] #cruzamento child_1 = [crossover_mlp(parent_1[i], parent_2[i]) for i in range(0, len(parent_1))] child_1 = np.array(list(map(list, child_1))) child_2 = [crossover_mlp(parent_2[i], parent_1[i]) for i in range(0, len(parent_1))] child_2 = np.array(list(map(list, child_2))) child_1 = mutation_mlp(child_1, prob_mut) child_2 = mutation_mlp(child_2, prob_mut) #calculates children's fitness to choose who will move on to the next generation fitness_child_1, classifiers_child_1 = function_fitness_mlp(child_1,X_train, y_train, X_test, y_test, size_mlp) fitness_child_2, classifiers_child_2 = function_fitness_mlp(child_2, X_train, y_train, X_test, y_test, size_mlp) fitness_child_1 = np.array(list(zip(child_1, fitness_child_1, classifiers_child_1))) fitness_child_2 = np.array(list(zip(child_2, fitness_child_2, classifiers_child_2))) #selects next generation individuals pop_all = np.concatenate((fitness_child_1, fitness_child_2, pop_fitness), axis=0) pop_all_sort = pop_all[pop_all[:,1].argsort()] best_individual = pop_all_sort[0] pop_fitness_sort = pop_all_sort[0:size_mlp] return pop_fitness_sort[0]</pre><div class=pgc-img><img alt=ä½¿ç”¨Pythonä¼˜åŒ–ç¥ç»ç½‘ç»œå‚æ•°çš„é—ä¼ ç®—æ³• onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/1daceeeef3384728b42a396352054132><p class=pgc-img-caption></p></div></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Python','ä¼˜åŒ–','ç¥ç»'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>