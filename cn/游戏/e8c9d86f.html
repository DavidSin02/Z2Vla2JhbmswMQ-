<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Bancor 危机：Token 背后潜伏的“上帝之手” | 极客快訊</title><meta property="og:title" content="Bancor 危机：Token 背后潜伏的“上帝之手” - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/1531620812222efb59d4f89"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/e8c9d86f.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/e8c9d86f.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/e8c9d86f.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/e8c9d86f.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/e8c9d86f.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/e8c9d86f.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e6%b8%b8%e6%88%8f/e8c9d86f.html><link rel=canonical href=https://geekbank.cf/tw/%e6%b8%b8%e6%88%8f/e8c9d86f.html><meta property="article:published_time" content="2020-10-29T21:13:47+08:00"><meta property="article:modified_time" content="2020-10-29T21:13:47+08:00"><meta name=Keywords content><meta name=description content="Bancor 危机：Token 背后潜伏的“上帝之手”"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E6%B8%B8%E6%88%8F/e8c9d86f.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Bancor 危机：Token 背后潜伏的“上帝之手”</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E6%B8%B8%E6%88%8F.html>游戏</a></span></div><div class=post-content><p>风险提示：包括 Status 和 FunFair 在内的部分国内外热门区块链项目，智能合约存在管理员权限过高的问题，或导致项目存在过度中心化的风险，相关 Token 生态极易发生<strong>单点失效</strong>。致命问题可能会出现在两个方面：一是项目方滥用权限，二是超级管理员身份被盗用。这两种情况一旦发生，相关 Token 生态可能会迅速崩塌。</p><p><h2>恐怖的智能合约管理员权限</h2></p><p>作为比特币和区块链爱好者，我们崇尚<strong>去中心化</strong>。然而，很多持币者可能还不太清楚，目前各类 Token 项目智能合约管理员拥有超级权限<strong>竟已逐渐成为常态</strong>。据我们不完全统计，排名前 570 名的 Token 合约中，有<strong> 342</strong>个合约存在只有管理员能调用的功能（onlyOwner），不少合约更存在管理员任意<strong>铸币、烧币、冻结账户、关停转账</strong>等过高权限 [1]。</p><p>安比（SECBIT）实验室研究了排名靠前的 Status (SNT) 和 FunFair (FUN) 项目。我们认为这两个热门项目都存在非常严重的<strong>管理员权限过高</strong>问题。</p><p>Status 合约中有名为 Controller 的管理员角色，可调用 generateTokens 往任意地址增发代币，可调用 destroyTokens 销毁任意地址上的代币 [2]。但 Status 项目的白皮书并没有相关特殊权限声明。而且，这两个超级权限函数在实现上，并没有触发 Mint 或 Burn 事件，只有普通的 Transfer 事件。</p><img alt="Bancor 危机：Token 背后潜伏的“上帝之手”" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1531620812222efb59d4f89><p>倘若有人利用管理员身份作恶，社区可能难以第一时间发现。通过扫描区块链数据我们发现，目前 Status 团队仅于 2017 年 6 月 19 日依次传入极小值成功调用了增发和销毁的函数进行测试，因此普通用户无需过分恐慌。但需要知道的是官方团队随时保留有这样的超级权限。</p><img alt="Bancor 危机：Token 背后潜伏的“上帝之手”" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1531620812282e0600e8c8e><p>此外，Status 合约还应用了可升级的代理合约机制，管理员可以通过任意设置代理合约 controller 地址的方式，在关键函数前面插入可升级的校验逻辑，来影响转账等关键操作。</p><img alt="Bancor 危机：Token 背后潜伏的“上帝之手”" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1531620812337bc3fbda450><p>知名的 FunFair (FUN) 项目也存在与 Status 类似的问题 [3]。白皮书中并未提及其 Token 合约中的特殊权限；通常原本应当在众筹后一定时间内关闭的铸币等功能，项目方依然未关闭。倘若有人作恶，增发巨额数量的 Token 至市场上抛售，后果不堪设想。</p><p>此外还有不少项目有同样的问题。我们呼吁相关项目方应立即向社区做好<strong>风险告知</strong>与<strong>特殊权限披露</strong>，社区参与者也可以积极发挥<strong>监督</strong>力量。</p><p>Token 持有者<strong>有权</strong>了解，项目方也<strong>有义务</strong>披露以下这些内容：</p><ul><li>Token 及业务合约中项目方拥有的特殊权限明细</li><li>项目方为何需要这些特殊权限</li><li>特殊权限会在哪些情况下使用</li><li>特殊权限被滥用会发生哪些后果</li><li>哪些特殊权限可以被永久关闭以及何时关闭</li><li>特殊权限动用历史记录的详细说明</li><li>特殊权限动用的监控渠道</li><li>项目方采取何种措施来保障特殊权限不被滥用和盗用</li><li>如何通过更好的智能设计提升社区治理水平</li></ul><p>此外，<strong>交易所</strong>作为区块链项目生态中的中坚力量，也应当积极<strong>督促</strong>项目方<strong>限制过高权限</strong>以及<strong>透明运营。</strong></p><p><h2>管理员权限过高造成损失的真实案例</h2></p><p>目前为止还没有热门项目团队利用超级权限作恶的证据，或许我们可以舒一口气。但即使在信任官方团队不会主动作恶的前提下，恶性安全事件依然有可能发生。</p><p>加密货币交易平台 Bancor 于 7 月 10 日称遭到攻击，丢失 24,984 个 ETH，3,236,967 个 BNT，229,356,645 个 NPXS，折算法币金额为 1250 万美金的以太坊，1000 万美金的 Bancor 代币和 100 万美金的 Pundix 代币。</p><p>初期不少媒体报道称 Bancor 智能合约存在安全漏洞。安比（SECBIT）实验室遂对此安全事件进行<strong>追溯分析</strong>。</p><p>Bancor 主要合约包括 SmartToken 和 BancorConverter，分别为 ERC20 Token 合约以及与业务相关的 Token 转换交易合约。</p><p>本次 Bancor 平台被盗事件与 BancorConverter 合约有关，攻击者（黑客/内鬼）极有可能获取了 0x009bb5e9fcf28e5e601b7d0e9e821da6365d0a9c 账户的私钥。</p><p>而此账户正是转换代币合约 BancorConverter（0x3839416bd0095d97bE9b354cBfB0F6807d4d609E）的 owner，同样拥有极高权限。owner 作为该合约的所有者和管理员，有唯一的权限通过 withdrawTokens 方法提走合约中的全部 ERC20 Token 至任意地址。</p><p>第一次攻击发生在以太坊主网区块高度 5930096，北京时间 7 月 9 日 8 时 6 分。攻击者利用 owner 身份，首先调用 withdrawTokens 转走 0.1 ERC20 ETH 进行<strong>攻击测试</strong>[4]。</p><p>三分钟后，攻击者再次转走 22000 巨额数量的 ERC20 ETH 至其控制的地址（0x33ed22f4b6b05f8a5faac4701550d52286bd735a）上 [5]。</p><p>随后，攻击者再调用 Ether Token 合约（0xc0829421C1d260BD3cB3E0F06cfE2D52db2cE315）的 withdrawTo 方法，将 ERC20 版本的以太代币兑换为真实以太币 [6]。</p><p>至此，22000 个 ETH 便完全被攻击者借用管理员身份所盗走。</p><p>攻击者还控制了以下账户，如法炮制地偷走其账户余额，以及其所管理合约中的代币。</p><p>目前，区块链浏览器网站 EtherScan 已将攻击者的地址标注为 Fake_Phishing1701 和 Fake_Phishing1702。</p><img alt="Bancor 危机：Token 背后潜伏的“上帝之手”" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153162081216021fbb99ade><p>此外，Bancor SmartToken ERC20 合约也由 owner 完全控制，目前是一个名为 MultiSigWallet 的合约，暂未被盗用。</p><p>owner 对 SmartToken 合约具有以下权限：</p><ul><li>owner 可通过 disableTransfers 任意禁用转账功能</li><li>owner 可通过 issue 任意增发代币</li><li>owner 可通过 destroy 任意销毁代币</li></ul><p>以上这些功能均通过 ownerOnly 进行限定，换句话说，owner 对 Bancor 合约拥有最高权限。</p><p><h2>Bancor 团队如何处理被盗事件</h2></p><p>Bancor 项目方在攻击发生后，识别出攻击者地址，声称冻结了攻击者偷来的 BNT 代币。</p><img alt="Bancor 危机：Token 背后潜伏的“上帝之手”" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15316208126493bdf903dda><p>经我们调查，Bancor 管理员<strong>实际</strong>动用了 destroy 方法来“销毁”用户手中的 Token。</p><img alt="Bancor 危机：Token 背后潜伏的“上帝之手”" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/153162081268046d109abff><p>管理员可以从任意账户 _from 中扣除任意金额 _amount 的 Token，同时将总供应量 totalSupply 缩减。</p><p>这就是常说的 <strong>烧币</strong>功能。由于攻击者在得手后，将偷来的币分散到若干个地址中。Bancor 的管理员不得不挨个依次调用 destroy 来销毁对应地址的代币，再调用 issue 方法将烧毁的币重新增发到自己手中。但此补救方法对于 NPXS Token 和已转走的 ETH 无效，这些被盗的币将被转至交易所抛售。</p><img alt="Bancor 危机：Token 背后潜伏的“上帝之手”" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1531620813246e7761f1aaf><p>Bancor 团队也发表声明称普通用户的钱包没有受到影响，并进一步解释铸币、烧币以及存储大量以太币是他们协议中价格发现机制的一部分。</p><p><h2>Bancor 安全事件的影响与反思</h2></p><p>除开巨额被盗事件，Bancor 团队的这一声明和处理方式，同样引起了社区的恐慌。人们纷纷质疑 Bancor 项目智能合约中 owner 管理员的超级权限，甚至称之为“<strong>后门</strong>”。</p><p>Udi Wertheimer 早在一年前就曾发文抨击 Bancor 项目无论是众筹合约还是 ERC20 Token 合约都缺乏良好的设计，称所有的 Token 都由 Bancor 团队完全掌控，管理员拥有绝对控制权，极度中心化 [7]。而 Bancor 团队则一直声称自己十分重视安全，并采用业内最佳的钱包和私钥管理方案 [8]。不过，他们并没有披露此次被盗事件的细节，如攻击者如何能<strong>控制多个管理员账户。</strong></p><p>我们把目光放至整个通证生态。社区参与者对管理员拥有的权限知之甚少，而项目方的相关披露与风险提示更少。安比(SECBIT)实验室也正在<strong>智能合约风险列表</strong>中收录<strong>各类权限过高</strong>问题 [9]，试图借此引导社区重视这些问题。</p><p>对于 Token 合约，当有账户存在超级权限时，整个 Token 生态极容易发生<strong>单点失效</strong>。致命问题可能会出现在两个方面，一是项目方作恶，二是超级管理员身份被盗用。当 Token 的价值全部依赖在某一个人或少数几个人身上时，可想而知这其中暗藏的风险会非常之高。以 Bancor 为例，在巨大的经济利益面前，即使我们信任了发行方不会滥用权限，却依然无法保证<strong>别有用心</strong>者不会借此攻击。对于发行与运营极度依赖项目方的 Token，可能我们永远无法形成类似对比特币的共识与信仰。</p><p>Bancor 危机也给我们带来很多反思：</p><ul><li>Bancor 是否是真正的去中心化交易协议</li><li>智能合约在哪些情况下需要管理员</li><li>合约管理员权限的边界在何处</li><li>如何保障钱包及私钥安全</li></ul><p>管理员权限是把双刃剑。在 Bancor 事件中，黑客利用了管理员权限盗取代币，而项目方也正利用了管理员权限来降低损失。不过我们认为，开发者依然可以通过良好的代码设计来降低Token 和 协议合约对管理员的依赖。同时，我们也号召大家，去更多地了解相关项目的智能合约（<strong>它可能跟你想象的不太一样</strong>），关注手中的 Token 到底由谁控制，利用社区力量监督项目管理员权限。</p><p><h2>参考文献</h2></p><p>[1] CoinAlpha 对 ERC20 乱象的总结 https://medium.com/finance-3/the-myth-of-the-erc-20-token-standard-ab0d76cf8532</p><p>[2] Status 合约代码 https://etherscan.io/address/0x744d70fdbe2ba4cf95131626614a1763df805b9e#code</p><p>[3] FunFair 合约代码 https://etherscan.io/address/0x419d0d8bdd9af5e606ae2232ed285aff190e711b#code</p><p>[4] 第一次攻击测试 https://etherscan.io/tx/0xf9fd6ac9bb4e632cf07d5b80b59bb6e417fe52305ea720e552ca6ca204951629</p><p>[5] 第二次攻击 https://etherscan.io/tx/0xf9fe97d642705fa016c4f8d11ea13ce581ba75c57ac455586254e15d915e9bde</p><p>[6] 兑换成 ETH https://etherscan.io/tx/0x43a964e635f31b0cc329db6f980f09096054e4e3a627c85654852fd026b92ba0</p><p>[7] 对 bancor 的质疑 https://medium.com/unchained-reports/bancor-unchained-all-your-token-are-belong-to-us-d6bb00871e86</p><p>[8] bancor 的回应 https://blog.bancor.network/response-to-bancor-unchained-cdb3bd2ba505</p><p>[9] SECBIT 智能合约风险列表 https://github.com/sec-bit/awesome-buggy-erc20-tokens/blob/master/ERC20_token_issue_list_CN.md#c-%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86%E9%97%AE%E9%A2%98%E5%88%97%E8%A1%A8</p><p>（本文作者：安比（SECBIT）实验室 & 轻信科技（LedgerGo），以上数据均由安比（SECBIT）实验室提供。）</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Bancor','危机','Token'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>