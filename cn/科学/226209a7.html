<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 | 极客快訊</title><meta property="og:title" content="「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/72730004933bf43249a6"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/226209a7.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/226209a7.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/226209a7.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/226209a7.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/226209a7.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/226209a7.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/226209a7.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/226209a7.html><meta property="article:published_time" content="2020-11-14T20:50:23+08:00"><meta property="article:modified_time" content="2020-11-14T20:50:23+08:00"><meta name=Keywords content><meta name=description content="「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/226209a7.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>科学</a></span></div><div class=post-content><p>准确定位声源是移动设备进行听觉场景分析的首要步骤，其结果对后续混合声源分离、声源辨识、语音识别有直接影响。延时求和波束形成<sup>[1]</sup>技术在进行声源定位时已被广泛使用，需要使用信号到达麦克风阵列中不同麦克风的时间差值(Time Difference Of Arrival，TDOA)。而相位变换广义互相关(Generalized Cross Correlation-Phase Transform，GCC-PHAT)算法具有很短的判决时延和较好的跟踪能力，适用于低混响环境，是常用的TDOA估计算法。</p><p>VALIN J M提出了一种使用递归方法计算权值的改进的GCC-PHAT算法<sup>[2]</sup>，即连续值频点加权GCC-PHAT算法，来提高原算法对加性噪声的鲁棒性。连续权值计算需要使用最小值控制递归平均<sup>[3]</sup>(Minimum Controlled Recursive Averaging，MCRA)算法估计噪声，但MCRA算法在噪声变化后需要适应时间调整参数<sup>[4]</sup>，因而对于加性非平稳间或噪声，使用连续权值的加权方法无法消除其干扰，最终导致TDOA估计错误。因此本文在频点加权GCC-PHAT算法的基础上，利用接收信号中风噪声与声源信号频点间相干性差异，提出一种频点离散值加权GCC-PHAT算法，以消除风噪声及背景噪声对TDOA估计的干扰。实验结果表明，相较原算法，新算法的结果可靠性和运算效率都明显提高。</p><p><strong>1</strong><strong>互相关算法估计信号时差</strong></p><p><strong>1.1 场景声学模型</strong></p><p>设声源信号在存在加性噪声的混响环境中传播，由麦克风阵列接收。加性噪声由背景噪声和风噪声组成。风噪声是一种特殊的非平稳噪声，由麦克风薄膜表面湍流产生，导致接收信号产生严重畸变。背景噪声在声学环境中近似为远场声源产生的弥漫性噪声。声源信号与风噪声及背景噪声等加性噪声不相关。</p><p>设n为信号时域采样序号，m为阵列中麦克风编号，s(n)为声源信号，h<sub>m</sub>(n)是声源到麦克风m之间的房间系统冲击响应序列，w<sub>m</sub>(n)表示风噪声，b<sub>m</sub>(n)为背景噪声信号。背景噪声不需要考虑混响，则麦克风m接收信号y<sub>m</sub>(n)表示为：</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/72730004933bf43249a6><p><strong>1.2 频点加权GCC-PHAT算法</strong></p><p>接收信号在整个时间域上非平稳。利用接收信号短时平稳特性，通过短时傅里叶变换，将分帧后信号变换到时频域分析<sup>[5]</sup>。选择长度为N的海宁窗h(n)对接收信号分帧，减小信号帧间频率截断效应。设信号帧间步进长度为ΔN个采样间隔，则接收信号第l帧表示为y<sub>m</sub>(lΔN+n)，其傅里叶变换结果为：</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/72710006783913b7b347><p><strong>2</strong><strong>离散值频点加权GCC-PHAT算法</strong></p><p><strong>2.1 离散频点权值</strong></p><p>VALIN J M等人提出的频点连续权值计算基于先验信噪比(Signal-to-Noise Ratio，SNR)估计。频点k对应的连续权值为：</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/726f000c8a149281ff31><p>式中，</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/726e000c95a773477470><p>为MCRA算法所得噪声功率谱估计。</p><p>连续权值是关于信噪比的单调函数，值域为[0，1]，用soft mask表示，取值如图1所示。</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/72710006783a045319bb><p>频点连续权值计算依赖噪声功率谱估计和信号相邻帧间信噪值连续性。比较风噪声和语音信号瞬时功率随时间的变化曲线，可以看出风噪声时域变化特性强于语音信号<sup>[6]</sup>。现有语音增强算法均默认噪声变化慢于语音，故对于包含风噪声的信号，上述方法无法得出先验信噪比。且连续权值取值为[0，1]，当声源信号受噪声严重干扰(SNR&lt;0)时，信号频点对应权值大于零，加权后信号仍然保留噪声成分，导致最终TDOA估计出错。本文在已有频点加权方法基础上提出一种使用频点离散权值的风噪声抑制算法。新权值是关于信号频点相干值的函数，不依赖噪声估计，且只取离散值0和1，完全消除含噪频点对TDOA估计结果的干扰。新权值</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/7270000875d78ecfb3bb><p>用wind mask表示。</p><p>风噪声由麦克风表面的湍流产生，不同麦克风间风噪声频点无相干性。但对于同一声源信号，阵列中麦克风的接收信号在各频点上都具有高相干性。引入相干谱值(Magnitude Squared Coherence，MSC)，对信号各频点间相干性大小进行量化：</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/726f000c8a16ce4e7496><p>式中，P<sub>m1m2</sub>、P<sub>m1m1</sub>、P<sub>m2m2</sub>分别为麦克风m1、m2信号的互功率谱密度和自功率谱密度。</p><p>MSC值反映了不同信号在频点k上的相干程度。如图2所示，对于近场平稳声源的两路信号，在信号存在频率范围内，MSC值在1附近，而在风噪声存在的低频区域，MSC值始终分布在0附近。图3为包含风噪声的1帧信号MSC取值。在风噪声存在的低频范围，信号各频点处0≤MSC≤1，且包含噪声成分越多，MSC取值越小。风噪声频率范围外信号各频点MSC接近1。但背景噪声间也具有相干性<sup>[7]</sup>，其MSC取值满足式(8)，其中d<sub>m1m2</sub>为麦克风之间距离。因此使用相干差异消除风噪声干扰前需要预先消除背景噪声。</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/7272000666e60660f784><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/726d000cab4ada60e8b6><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/726e000c95a9e80edf86><p>分析不同类型信号发现，只有无噪声干扰的近场平稳声源信号，各频点间MSC值始终接近1。其余信号频点MSC取值在[0，1]内。因此可以利用信号间频点的相干值检测噪声，并通过加权方式只保留信号中未受干扰频点。上述结论数学表达如式(9)所示，其中θ<sub>wind</sub>为相干值阈值。</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/726d000cab4bb85ee8f5><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/726d000cab4ce2f95d0d><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/72710006783ec5f4329b><p>不同于连续频点权值计算基於单路信号，新权值计算同时基于2路信号，则式(3)可以表示为：</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/726d000cab4dd789df16><p><strong>2.2 预增强信号</strong></p><p>MCRA算法避免了信号活跃性检测方法在低信噪和无声段因高误检率引起的错误估计。但MCRA算法在固定长度时间窗内搜索频带功率谱最小值，产生噪声估计滞后。本文提出一种连续时域上的当前功率谱最小值搜索方法，提高估计速度。在搜索功率谱最小值前，先做如下时域递归平滑获得平滑功率谱值：</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/726d000cab4efd2fe804><p>由于噪声先验概率比为单调函数，根据Bayes最小风险代价判决准则，MCRA算法使用信号功率谱与其局部最小值的比值S<sub>r</sub>(l，k)与固定阈值δ比较，判决频点是否包含信号分量，计算信号存在概率。但是固定阈值δ仅适用于平稳噪声情况，对包含非平稳噪声情况判决不敏感。根据信号频率分布特性：风噪声分布在中低频率区域，中高频部分为包含背景噪声的声源信号，新算法选择如下分段阈值δ(k)：</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/7270000875df48d9b853><p><strong>2.3 算法运算负载分析</strong></p><p>移动设备计算资源有限，对算法实时性也有要求，故必须考虑算法运算量。对于包含M个麦克风的阵列，使用频点加权GCC-PHAT算法估计TDOA，信号每帧均需要执行M次FFT和M(M-1)/2次IFFT操作。为简化分析，假设傅里叶正、逆变换运算量相同，则M个麦克风的阵列估计TDOA运算量记为(M<sup>2</sup>+M)/2次运算，复杂度为O(M<sup>2</sup>)，故随着阵列中麦克风个数增加，算法运算量快速上升。</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/7271000678438904d177><p><strong>3</strong><strong>实验结果分析与对比</strong></p><p><strong>3.1 实验参数</strong></p><p>本部分将在不同测试条件下比较不同频点加权GCC-PHAT算法性能。表1给出算法对应参数。为确保时频变换后获取接收信号全部频率成分，设置f<sub>s</sub>为48 000 Hz；接收信号每帧包含的采样点数N对应信号时长在20 ms~30 ms，窗序列设置为相同长度；为保持平稳信号帧间的连续性，设帧步进ΔN=N/2，即帧间50%重叠；c为20 ℃、101.1 kPa条件下声速；ε是接近0的小数，避免实际应用中式(11)结果溢出；判决阈值θ<sub>wind</sub>、θ<sub>D</sub>、θ<sub>min</sub>取值依据多次实验结果确定。根据表1中参数，算法引入延迟Δl·ΔN/f<sub>s</sub>=32 ms。在人机语音交互中，这种量级的时间延迟可以忽略。</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/7272000666ee06c58e85><p>基于IMAGE方法<sup>[9]</sup>，计算尺寸为10 m×8 m×3.5 m的混响房间模型的冲激响应序列。选择一段7 s的语音作为目标声源信号，卷积冲激序列模拟信号的混响效果。目前没有语料库提供相应的风噪声信号，需要通过实验采集。信号采集使用一对匹配全指向拜亚动力MM1麦克风，模拟气流由空气压缩机产生。以房间一角作为座标原点建立直角座标系，声源及麦克风位置见表2。i、j、k为x、y、z轴单位向量。</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/7270000875de89d6d653><p><strong>3.2 算法性能指标</strong></p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/726f000c8a19afd3e81e><p><strong>3.3 结果分析</strong></p><p>图5、图6分别为混响环境(RT60=200 ms)中的含噪(SNR=5 dB)信号的语谱图以及不同频点加权方法权值分布。图5(a)显示风噪声集中在信号低频区域，且随时间快速变化。MCRA算法不能准确估计风噪声，因此图5(b)中频点取的连续权值在低频区域值接近1，对含风噪声频点无衰减，含噪信号频点被带入相关值计算。图6(a)中噪声功率谱估计曲线显示，对于平稳噪声，因频带上的信号功率通常衰减的最小值接近噪声功率值，故基于最小值统计的算法消除平稳背景噪声效果好。但对于快速变化噪声，算法设计依据决定估计值会产生滞后，增强的信号仍包含风噪声。同时表明信号增强方法不能消除风噪声干扰。本文提出算法对应权值分布如图6(b)所示，判断并直接去除信号低频范围内受干扰频点(权值为0)，只保留强相干性频点(权值为1)。风噪声频率范围外中高频区域的信号频点则尽量保留，带入相关值计算。</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/7272000666f54e462425><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/7273000493404e2f8bca><p>图7为上述实验条件中使用不同权值的GCC-PHAT算法估计TDOA结果统计。实验结果表明，不加权和使用连续权值的GCC-PHAT算法估计值统计峰值均在τ<sub>c</sub>(Delay=-3)处，对应位置声源为麦克风表面湍流。只有使用wind mask权值加权的GCC-PHAT算法估计结果集中分布在τ<sub>t</sub>(Delay=-18)附近，对应位置为目标声源，满足应用要求。</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/726f000c8a1d8bcd257b><p>表3为不同混响、信噪比测试条件下，不同频点加权GCC-PHAT算法估计TDOA结果可靠性(T<sub>pq</sub>)及运算负载(L<sub>pq</sub>)对比。实际场景中，风噪声特殊的产生方式决定其必定对信号干扰严重。如在低混响(RT60=0)、低信噪(SNR=0 dB)环境中，使用wind mask加权算法估计结果对应T<sub>pq</sub>=54.2%，优于使用连续权值(31.2%)和不加权(20.1%)的GCC-PHAT算法。存在混响的低信噪环境(RT60=200 ms，SNR=0 dB)中，使用wind mask加权的算法结果对应T<sub>pq</sub>下降至48.6%，仍优于其他加权算法。尽管新的加权算法在混响情况下运算量有所增加，但均显著低于其他已有算法。实验证明，存在风噪声干扰的场景中，使用本文提出算法所得结果更加可靠，运算量也更小。</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/726d000cab56d39137aa><p><strong>4</strong><strong>结论</strong></p><p>通过GCC-PHAT算法估计TDOA值带入波束成形算法是定位声源的常用方法。本文针对已有GCC-PHAT算法无法消除风噪声干扰问题原因进行分析，并通过对目标信号和噪声信号时频特性研究，提出一种基于信号间频点相干性差异的频点离散值加权GCC-PHAT算法。实验表明，相较使用基于信噪比估计的连续值频点加权算法，本文提出的方法所得结果准确可靠，运算量小，具有一定的工程实用价值。</p><img alt=「学术论文」抑制风噪声的频点离散值加权GCC-PHAT时延估计算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/1bb0000c4605921847e0></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'学术','论文','风噪声'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>