<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>åŠ›æ‰£ 1519â€”â€”å­æ•°ä¸­æ ‡ç­¾ç›¸åŒçš„èŠ‚ç‚¹æ•° | æå®¢å¿«è¨Š</title><meta property="og:title" content="åŠ›æ‰£ 1519â€”â€”å­æ•°ä¸­æ ‡ç­¾ç›¸åŒçš„èŠ‚ç‚¹æ•° - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/78a5fac2213f451a89b610084a5458b8"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/2a8b0ba.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/2a8b0ba.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/2a8b0ba.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/2a8b0ba.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/2a8b0ba.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/2a8b0ba.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/2a8b0ba.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/2a8b0ba.html><meta property="article:published_time" content="2020-10-29T21:02:05+08:00"><meta property="article:modified_time" content="2020-10-29T21:02:05+08:00"><meta name=Keywords content><meta name=description content="åŠ›æ‰£ 1519â€”â€”å­æ•°ä¸­æ ‡ç­¾ç›¸åŒçš„èŠ‚ç‚¹æ•°"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/2a8b0ba.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>åŠ›æ‰£ 1519â€”â€”å­æ•°ä¸­æ ‡ç­¾ç›¸åŒçš„èŠ‚ç‚¹æ•°</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>ç§‘å­¦</a></span></div><div class=post-content><p>æœ¬é¢˜ä¸»è¦åœ¨äºå¯¹æ ‘è¿™ç§æ•°æ®ç»“æ„çš„è€ƒå¯Ÿï¼Œä»¥åŠæ·±åº¦ä¼˜å…ˆéå†çš„ä½¿ç”¨ï¼Œä¼˜åŒ–æ—¶å¯ä»¥é‡‡å–ç©ºé—´æ¢æ—¶é—´çš„ç­–ç•¥ã€‚</p><h1 class=pgc-h-arrow-right>åŸé¢˜</h1><p>ç»™ä½ ä¸€æ£µæ ‘ï¼ˆå³ï¼Œä¸€ä¸ªè¿é€šçš„æ— ç¯æ— å‘å›¾ï¼‰ï¼Œè¿™æ£µæ ‘ç”±ç¼–å·ä» 0 åˆ° n - 1 çš„ n ä¸ªèŠ‚ç‚¹ç»„æˆï¼Œä¸”æ°å¥½æœ‰ n - 1 æ¡ edges ã€‚æ ‘çš„æ ¹èŠ‚ç‚¹ä¸ºèŠ‚ç‚¹ 0 ï¼Œæ ‘ä¸Šçš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªæ ‡ç­¾ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸² labels ä¸­çš„ä¸€ä¸ªå°å†™å­—ç¬¦ï¼ˆç¼–å·ä¸º i çš„ èŠ‚ç‚¹çš„æ ‡ç­¾å°±æ˜¯ labels[i] ï¼‰</p><p>è¾¹æ•°ç»„ edges ä»¥ edges[i] = [ai, bi] çš„å½¢å¼ç»™å‡ºï¼Œè¯¥æ ¼å¼è¡¨ç¤ºèŠ‚ç‚¹ ai å’Œ bi ä¹‹é—´å­˜åœ¨ä¸€æ¡è¾¹ã€‚</p><p>è¿”å›ä¸€ä¸ªå¤§å°ä¸º n çš„æ•°ç»„ï¼Œå…¶ä¸­ ans[i] è¡¨ç¤ºç¬¬ i ä¸ªèŠ‚ç‚¹çš„å­æ ‘ä¸­ä¸èŠ‚ç‚¹ i æ ‡ç­¾ç›¸åŒçš„èŠ‚ç‚¹æ•°ã€‚</p><p>æ ‘ T ä¸­çš„å­æ ‘æ˜¯ç”± T ä¸­çš„æŸä¸ªèŠ‚ç‚¹åŠå…¶æ‰€æœ‰åä»£èŠ‚ç‚¹ç»„æˆçš„æ ‘ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><div class=pgc-img><img alt="åŠ›æ‰£ 1519â€”â€”å­æ•°ä¸­æ ‡ç­¾ç›¸åŒçš„èŠ‚ç‚¹æ•°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/78a5fac2213f451a89b610084a5458b8><p class=pgc-img-caption></p></div><pre><code>è¾“å…¥ï¼šn = 7, edges = [[0,1],[0,2],[1,4],[1,5],[2,3],[2,6]], labels = "abaedcd"è¾“å‡ºï¼š[2,1,1,1,1,1,1]è§£é‡Šï¼šèŠ‚ç‚¹ 0 çš„æ ‡ç­¾ä¸º 'a' ï¼Œä»¥ 'a' ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘ä¸­ï¼ŒèŠ‚ç‚¹ 2 çš„æ ‡ç­¾ä¹Ÿæ˜¯ 'a' ï¼Œå› æ­¤ç­”æ¡ˆä¸º 2 ã€‚æ³¨æ„æ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯è¿™æ£µå­æ ‘çš„ä¸€éƒ¨åˆ†ã€‚èŠ‚ç‚¹ 1 çš„æ ‡ç­¾ä¸º 'b' ï¼ŒèŠ‚ç‚¹ 1 çš„å­æ ‘åŒ…å«èŠ‚ç‚¹ 1ã€4 å’Œ 5ï¼Œä½†æ˜¯èŠ‚ç‚¹ 4ã€5 çš„æ ‡ç­¾ä¸èŠ‚ç‚¹ 1 ä¸åŒï¼Œæ•…è€Œç­”æ¡ˆä¸º 1ï¼ˆå³ï¼Œè¯¥èŠ‚ç‚¹æœ¬èº«ï¼‰ã€‚</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><div class=pgc-img><img alt="åŠ›æ‰£ 1519â€”â€”å­æ•°ä¸­æ ‡ç­¾ç›¸åŒçš„èŠ‚ç‚¹æ•°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8465bec7f54d47d4b0b515bc1b6152bd><p class=pgc-img-caption></p></div><pre><code>è¾“å…¥ï¼šn = 4, edges = [[0,1],[1,2],[0,3]], labels = "bbbb"è¾“å‡ºï¼š[4,2,1,1]è§£é‡Šï¼šèŠ‚ç‚¹ 2 çš„å­æ ‘ä¸­åªæœ‰èŠ‚ç‚¹ 2 ï¼Œæ‰€ä»¥ç­”æ¡ˆä¸º 1 ã€‚èŠ‚ç‚¹ 3 çš„å­æ ‘ä¸­åªæœ‰èŠ‚ç‚¹ 3 ï¼Œæ‰€ä»¥ç­”æ¡ˆä¸º 1 ã€‚èŠ‚ç‚¹ 1 çš„å­æ ‘ä¸­åŒ…å«èŠ‚ç‚¹ 1 å’Œ 2 ï¼Œæ ‡ç­¾éƒ½æ˜¯ 'b' ï¼Œå› æ­¤ç­”æ¡ˆä¸º 2 ã€‚èŠ‚ç‚¹ 0 çš„å­æ ‘ä¸­åŒ…å«èŠ‚ç‚¹ 0ã€1ã€2 å’Œ 3ï¼Œæ ‡ç­¾éƒ½æ˜¯ 'b'ï¼Œå› æ­¤ç­”æ¡ˆä¸º 4 ã€‚</code></pre><p>ç¤ºä¾‹ 3 ï¼š</p><div class=pgc-img><img alt="åŠ›æ‰£ 1519â€”â€”å­æ•°ä¸­æ ‡ç­¾ç›¸åŒçš„èŠ‚ç‚¹æ•°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/33b42c280eed46e781248a28e16d3eec><p class=pgc-img-caption></p></div><pre><code>è¾“å…¥ï¼šn = 5, edges = [[0,1],[0,2],[1,3],[0,4]], labels = "aabab"è¾“å‡ºï¼š[3,2,1,1,1]</code></pre><p>ç¤ºä¾‹ 4ï¼š</p><pre><code>è¾“å…¥ï¼šn = 6, edges = [[0,1],[0,2],[1,3],[3,4],[4,5]], labels = "cbabaa"è¾“å‡ºï¼š[1,2,1,1,2,1]</code></pre><p>ç¤ºä¾‹ 5ï¼š</p><pre><code>è¾“å…¥ï¼šn = 7, edges = [[0,1],[1,2],[2,3],[3,4],[4,5],[5,6]], labels = "aaabaaa"è¾“å‡ºï¼š[6,5,4,1,3,2,1]</code></pre><p>æç¤ºï¼š</p><ul><li>1 &lt;= n &lt;= 10^5</li><li>edges.length == n - 1</li><li>edges[i].length == 2</li><li>0 &lt;= ai, bi &lt; n</li><li>ai != bi</li><li>labels.length == n</li><li>labels ä»…ç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆ</li></ul><p>åŸé¢˜ urlï¼šhttps://leetcode-cn.com/problems/number-of-nodes-in-the-sub-tree-with-the-same-label</p><h1 class=pgc-h-arrow-right>è§£é¢˜</h1><h1 class=pgc-h-arrow-right>é¦–æ¬¡å°è¯•</h1><p>è¿™é“é¢˜æ˜¯è¦è®©æˆ‘ä»¬è®¡ç®—ï¼šåœ¨å­æ ‘ä¸­ï¼Œå’Œå½“å‰èŠ‚ç‚¹å­—ç¬¦ç›¸åŒçš„èŠ‚ç‚¹ä¸ªæ•°ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¿…ç„¶éœ€è¦æ„å»ºæ ‘ä¸­å„ä¸ªèŠ‚ç‚¹çš„å…³ç³»ï¼Œé‚£ä¹ˆå°±éœ€è¦è®°å½•çˆ¶å­èŠ‚ç‚¹çš„å…³ç³»ï¼Œå› ä¸ºæ˜¯æ™®é€šçš„æ ‘ï¼Œä¸€ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹å¯èƒ½æœ‰å¤šä¸ªï¼Œå› æ­¤æˆ‘ç”¨LinkedList&lt;Integer>[] treeè¿™æ ·ä¸€ä¸ªæ•°ç»„è¿›è¡Œå­˜å‚¨ï¼Œå…¶ä¸­tree[i]ä»£è¡¨èŠ‚ç‚¹ i çš„æ‰€æœ‰å­èŠ‚ç‚¹ã€‚</p><p>è‡³äºæ±‚ç›¸åŒèŠ‚ç‚¹çš„ä¸ªæ•°ï¼Œæˆ‘æƒ³ç€å¯ä»¥ä»æ ¹èŠ‚ç‚¹ 0 å¼€å§‹é€ä¸ªéå†ï¼Œå…ˆè·å–å…¶ç¬¬ä¸€å±‚å­èŠ‚ç‚¹ï¼Œå†æ ¹æ®ç¬¬ä¸€å±‚å­èŠ‚ç‚¹é€ä¸ªè·å–ï¼Œå¯ä»¥é‡‡ç”¨å¹¿åº¦ä¼˜å…ˆéå†çš„å½¢å¼ã€‚</p><p>è®©æˆ‘ä»¬çœ‹çœ‹ä»£ç ï¼š</p><pre><code>class Solution {    public int[] countSubTrees(int n, int[][] edges, String labels) {        // æ„é€ æ ‘        LinkedList&lt;Integer&gt;[] tree = new LinkedList[n];        for (int[] edge : edges) {            // edge[0]çš„å­èŠ‚ç‚¹            LinkedList&lt;Integer&gt; child = tree[edge[0]];            if (child == null) {                child = new LinkedList&lt;&gt;();                tree[edge[0]] = child;            }            // å¢åŠ å­èŠ‚ç‚¹            child.add(edge[1]);        }        // ç»“æœ        int[] result = new int[n];        // éå†å¹¶è®¡ç®—        for (int i = 0; i &lt; n; i++) {            // éœ€è¦éå†çš„å­—ç¬¦            char cur = labels.charAt(i);            // è¯¥èŠ‚ç‚¹çš„å­æ ‘ä¸­ä¸è¯¥å­—ç¬¦ç›¸åŒçš„èŠ‚ç‚¹æ•°            int curCount = 0;            // å¹¿åº¦ä¼˜å…ˆéå†            LinkedList&lt;Integer&gt; searchList = new LinkedList&lt;&gt;();            searchList.add(i);            while(!searchList.isEmpty()) {                int index = searchList.removeFirst();                if (cur == labels.charAt(index)) {                    curCount++;                }                // æ‰¾å‡ºè¯¥èŠ‚ç‚¹çš„å­æ ‘                if (tree[index] == null) {                    continue;                }                searchList.addAll(tree[index]);            }            result[i] = curCount;        }        return result;    }}</code></pre><p>æäº¤ä¹‹åï¼Œå‘ç°æœ‰é”™è¯¯ã€‚é”™è¯¯çš„æƒ…å†µæ˜¯ï¼š</p><pre><code>è¾“å…¥ï¼š4[[0,2],[0,3],[1,2]]"aeed"è¾“å‡ºï¼š[1,2,1,1]é¢„æœŸï¼š[1,1,2,1]</code></pre><p>æ ¹æ®è¿™æ ·è¾“å…¥ï¼Œæˆ‘æ„é€ å‡ºçš„æ ‘æ˜¯ï¼š</p><pre><code>1   0 \ / \  2   3</code></pre><p>ä½†æ ¹æ®é¢„æœŸç»“æœåæ¨å‡ºæ¥çš„æ ‘æ˜¯ï¼š</p><pre><code>    0   / \  2   3 /1</code></pre><p>é‚£ä¹ˆè¾“å…¥ä¸­æœ€åç»™å‡ºçš„[1,2]å°±ä¸æ˜¯ä»çˆ¶èŠ‚ç‚¹æŒ‡å‘å­èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¾“å…¥ä¸­ç»™å‡ºçš„è¾¹å…³è”çš„èŠ‚ç‚¹é¡ºåºï¼Œæ˜¯ä»»æ„çš„ã€‚</p><p>é‚£æˆ‘ä»¬çš„æ ‘ç©¶ç«Ÿè¯¥å¦‚ä½•æ„é€ å‘¢ï¼Ÿ</p><h1 class=pgc-h-arrow-right>åŒå‘è®°å½•æ„é€ æ ‘</h1><p>æ—¢ç„¶æˆ‘ä»¬åœ¨æ„é€ æ ‘çš„æ—¶å€™ï¼Œæ— æ³•ç›´æ¥å¾—å‡ºçˆ¶å­å…³ç³»ï¼Œé‚£ä¹ˆå°±å°†å¯¹åº”ä¸¤ä¸ªèŠ‚ç‚¹åŒæ—¶è®°å½•å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><p>æ ¹æ®é¢˜ç›®ä¸­ç»™å‡ºçš„æ¡ä»¶ï¼šæ ‘çš„æ ¹èŠ‚ç‚¹ä¸ºèŠ‚ç‚¹ 0ã€‚è¿™æ ·æˆ‘ä»¬åœ¨éå†çš„æ—¶å€™ï¼Œå°±ä» 0 å¼€å§‹ï¼Œåªè¦ 0 å…³è”çš„èŠ‚ç‚¹ï¼Œä¸€å®šæ˜¯ 0 çš„å­èŠ‚ç‚¹ã€‚å°†è¿™äº›èŠ‚ç‚¹è¿›è¡Œæ ‡è®°ï¼Œè¿™æ ·å†é€’å½’è®¿é—®æ¥ä¸‹æ¥çš„èŠ‚ç‚¹æ—¶ï¼Œå¦‚æœæ˜¯æ ‡è®°è¿‡çš„ï¼Œåˆ™è¯´æ˜æ˜¯çˆ¶èŠ‚ç‚¹ï¼Œè¿™æ ·å°±å¯ä»¥æ˜ç¡®çˆ¶å­èŠ‚ç‚¹å…³ç³»äº†ã€‚</p><p>è‡³äºéå†çš„æ—¶å€™ï¼Œå› ä¸ºè¿™æ¬¡æˆ‘ä»¬æ˜¯ä¸çŸ¥é“çˆ¶å­èŠ‚ç‚¹å…³ç³»çš„ï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥é‡‡ç”¨å¹¿åº¦ä¼˜å…ˆéå†ï¼Œæ¢æˆæ·±åº¦ä¼˜å…ˆéå†ã€‚</p><p>è®©æˆ‘ä»¬çœ‹çœ‹ä»£ç ï¼š</p><pre><code>class Solution {    // æ€»èŠ‚ç‚¹æ•°    int n;    // æ ‘    Map&lt;Integer, LinkedList&lt;Integer&gt;&gt; tree;    // å­—ç¬¦ä¸²    String labels;    // æœ€ç»ˆç»“æœ    int[] result;    public int[] countSubTrees(int n, int[][] edges, String labels) {        this.n = n;        this.labels = labels;        result = new int[n];        LinkedList&lt;Integer&gt; list;        // åŒå‘æ„é€ æ ‘çš„å…³ç³»        tree = new HashMap&lt;&gt;(n / 4 * 3 + 1);        for (int[] edge : edges) {            // æ·»åŠ æ˜ å°„å…³ç³»            list = tree.computeIfAbsent(edge[0], k -&gt; new LinkedList&lt;&gt;());            list.add(edge[1]);            list = tree.computeIfAbsent(edge[1], k -&gt; new LinkedList&lt;&gt;());            list.add(edge[0]);        }        // æ·±åº¦ä¼˜å…ˆæœç´¢        dfs(0);        return result;    }    public int[] dfs(int index) {        // å½“å‰å­æ ‘ä¸­ï¼Œæ‰€æœ‰å­—ç¬¦çš„ä¸ªæ•°        int[] charArray = new int[26];        // å¼€å§‹è®¡ç®—ï¼Œæ ‡å¿—è¯¥èŠ‚ç‚¹å·²ç»è®¡ç®—è¿‡        result[index] = 1;        // è·å¾—å…¶å…³è”çš„èŠ‚ç‚¹        List&lt;Integer&gt; nodes = tree.get(index);        // éå†        for (int node : nodes) {            // å¦‚æœè¯¥èŠ‚ç‚¹å·²ç»è®¿é—®è¿‡            if (result[node] &gt; 0) {                continue;            }            // é€’å½’éå†å­èŠ‚ç‚¹            int[] array = dfs(node);            for (int i = 0; i &lt; 26; i++) {                charArray[i] += array[i];            }        }        // å°†å½“å‰èŠ‚ç‚¹çš„å€¼è®¡ç®—ä¸€ä¸‹        charArray[labels.charAt(index) - 'a'] += 1;        result[index] = charArray[labels.charAt(index) - 'a'];        return charArray;    }}</code></pre><p>æäº¤OKï¼Œæ‰§è¡Œç”¨æ—¶136msï¼Œè¶…è¿‡36.71%ï¼Œå†…å­˜æ¶ˆè€—104.5MBï¼Œè¶…è¿‡91.38%ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ä¸Šï¼Œåº”è¯¥æ˜¯è¦ç ”ç©¶dfsæ–¹æ³•ä¸­çš„ä¸¤ä¸ªforå¾ªç¯ï¼Œå¤–å±‚è‚¯å®šæ˜¯æ¯ä¸ªèŠ‚ç‚¹éƒ½éå†ä¸€éï¼Œå†…å±‚è¿˜éœ€è¦éå†26ä¸ªè‹±æ–‡å­—æ¯ï¼Œä¹Ÿå°±æ˜¯O(n)ã€‚</p><p>ç©ºé—´å¤æ‚åº¦ä¸Šï¼Œæœ€å¤§çš„åº”è¯¥å°±æ˜¯å­˜å‚¨èŠ‚ç‚¹æ˜ å°„å…³ç³»çš„treeäº†ï¼Œé‡Œé¢å®é™…ä¸Šå°±æ˜¯ 2n ä¸ªèŠ‚ç‚¹ï¼ˆå› ä¸ºæ¯æ¡è¾¹å¯¹åº”çš„ä¸¤ä¸ªèŠ‚ç‚¹éƒ½ä¼šäº’ç›¸å­˜ä¸€æ¬¡å¯¹æ–¹ï¼‰ï¼Œå› æ­¤ä¹Ÿå°±æ˜¯O(n)ã€‚</p><p>è™½ç„¶è¿‡äº†ï¼Œä½†æ‰§è¡Œé€Ÿåº¦å¾ˆæ…¢ï¼Œå¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚</p><h1 class=pgc-h-arrow-right>ç”¨ç©ºé—´æ¢æ—¶é—´</h1><p>é’ˆå¯¹æˆ‘ä¸Šé¢çš„è§£æ³•ï¼Œå…¶ä¸­treeæˆ‘æ˜¯ç”¨çš„Mapï¼Œè™½ç„¶å…¶getæ–¹æ³•ç†è®ºä¸Šæ˜¯O(n)ï¼Œä½†æ¯•ç«Ÿæ¶‰åŠ hashï¼Œå¯ä»¥ä¼˜åŒ–æˆæ•°ç»„ã€‚</p><p>è‡³äºæ¯æ¬¡å–èŠ‚ç‚¹å¯¹åº”çš„å­—ç¬¦æ‰€ç”¨çš„charAtæ–¹æ³•ï¼Œå…·ä½“å…¶å®æ˜¯ï¼š</p><pre><code>    public char charAt(int index) {        if ((index &lt; 0) || (index &gt;= value.length)) {            throw new StringIndexOutOfBoundsException(index);        }        return value[index];    }</code></pre><p>æ¯æ¬¡éƒ½ä¼šæ£€æŸ¥ä¸€æ¬¡ indexï¼Œå…¶å®è¿™å®Œå…¨æ˜¯å¯ä»¥çœç•¥çš„ï¼Œå› æ­¤å¯ä»¥æå‰æ„é€ å¥½æ¯ä¸ªä½ç½®å¯¹åº”çš„å€¼ï¼Œä¹Ÿç”¨ä¸€ä¸ªæ•°ç»„å­˜å‚¨ã€‚</p><p>è®©æˆ‘ä»¬çœ‹çœ‹æ–°çš„ä»£ç ï¼š</p><pre><code>class Solution {    // æ€»èŠ‚ç‚¹æ•°    int n;    // æ ‘    LinkedList&lt;Integer&gt;[] tree;    // æ¯ä¸ªèŠ‚ç‚¹çš„å€¼ï¼ˆç”¨æ•°å­—è¡¨ç¤ºï¼‰    int[] nodeValueArray;    // æœ€ç»ˆç»“æœ    int[] result;    public int[] countSubTrees(int n, int[][] edges, String labels) {        this.n = n;        nodeValueArray = new int[n];        result = new int[n];        // åŒå‘æ„é€ æ ‘çš„å…³ç³»        tree = new LinkedList[n];        for (int i = 0; i &lt; n; i++) {            tree[i] = new LinkedList&lt;&gt;();        }        for (int[] edge : edges) {            // æ·»åŠ æ˜ å°„å…³ç³»            tree[edge[0]].add(edge[1]);            tree[edge[1]].add(edge[0]);        }        // ç”ŸæˆèŠ‚ç‚¹çš„å€¼        for (int i = 0; i &lt; n; i++) {            nodeValueArray[i] = labels.charAt(i) - 'a';        }        // æ·±åº¦ä¼˜å…ˆæœç´¢        dfs(0);        return result;    }    public int[] dfs(int index) {        // å½“å‰å­æ ‘ä¸­ï¼Œæ‰€æœ‰å­—ç¬¦çš„ä¸ªæ•°        int[] charArray = new int[26];        // å¼€å§‹è®¡ç®—ï¼Œæ ‡å¿—è¯¥èŠ‚ç‚¹å·²ç»è®¡ç®—è¿‡        result[index] = 1;        // è·å¾—å…¶å…³è”çš„èŠ‚ç‚¹        List&lt;Integer&gt; nodes = tree[index];        // éå†        for (int node : nodes) {            // å¦‚æœè¯¥èŠ‚ç‚¹å·²ç»è®¿é—®è¿‡            if (result[node] &gt; 0) {                continue;            }            // é€’å½’éå†å­èŠ‚ç‚¹            int[] array = dfs(node);            for (int i = 0; i &lt; 26; i++) {                charArray[i] += array[i];            }        }        // å°†å½“å‰èŠ‚ç‚¹çš„å€¼è®¡ç®—ä¸€ä¸‹        charArray[nodeValueArray[index]] += 1;        result[index] = charArray[nodeValueArray[index]];        return charArray;    }}</code></pre><p>æäº¤ä¹‹åï¼Œæ‰§è¡Œç”¨æ—¶æ˜¯96msï¼Œå†…å­˜æ¶ˆè€—æ˜¯402.2MBã€‚çœ‹æ¥ä¼˜åŒ–çš„æ•ˆæœå¹¶ä¸æ˜æ˜¾ã€‚</p><h1 class=pgc-h-arrow-right>ç ”ç©¶ä¸€ä¸‹ç›®å‰æœ€ä¼˜è§£æ³•</h1><p>è¿™ä¸ªè§£æ³•çœŸçš„æ˜¯å·§å¦™ï¼Œæ‰§è¡Œç”¨æ—¶20msï¼Œè¶…è¿‡äº†100%ï¼Œå†…å­˜æ¶ˆè€—76.3MBï¼Œè¶…è¿‡äº†100%ã€‚</p><p>æˆ‘åœ¨ä»£ç ä¸­å¢åŠ äº†æ³¨é‡Šï¼Œæ–¹ä¾¿å¤§å®¶ç†è§£ã€‚ä½†è¿™æ ·çš„å†™æ³•ï¼Œç ”ç©¶ä¸€ä¸‹æ˜¯èƒ½å¤Ÿçœ‹æ‡‚ï¼Œä½†è®©æˆ‘æƒ³ä¼°è®¡æ˜¯æ°¸è¿œä¸å¯èƒ½æƒ³å‡ºæ¥ï¼Œå¯ä»¥è®©å¤§å®¶ä¹Ÿä¸€èµ·å­¦ä¹ å’Œå€Ÿé‰´ï¼š</p><pre><code>public class Solution {  static class Next {    Next next;    Node node;    Next(Next next, Node node) {      this.next = next;      this.node = node;    }  }  static class Node {    /**     * å½“å‰èŠ‚ç‚¹çš„index     */    final int index;    /**     * å½“å‰èŠ‚ç‚¹å¯¹åº”çš„å­—ç¬¦å€¼ï¼ˆå‡å»'a'ï¼‰     */    final int ci;    /**     * æ‰€æœ‰å…³è”çš„èŠ‚ç‚¹     */    Next children;    /**     * è¯¥èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹     */    Node parent;    /**     * å­æ ‘ä¸­å’Œè¯¥èŠ‚ç‚¹å«æœ‰ç›¸åŒå­—ç¬¦çš„èŠ‚ç‚¹æ€»ä¸ªæ•°     */    int result;    /**     * æ˜¯å¦è¿˜åœ¨é˜Ÿåˆ—ä¸­ï¼Œå¯ä»¥ç†è§£ä¸ºæ˜¯å¦å·²è®¿é—®è¿‡     */    boolean inQueue;    public Node(int index, int ci) {      this.index = index;      this.ci = ci;      this.result = 1;    }    /**     * ä»åå¾€å‰ï¼Œæ‰¾åˆ°å½“å‰èŠ‚ç‚¹æ²¡æœ‰è®¿é—®è¿‡çš„ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹     */    Node popChild() {      for (; ; ) {        // å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰å…³è”èŠ‚ç‚¹        Next n = this.children;        // å¦‚æœæ²¡æœ‰ï¼Œè¯´æ˜å­èŠ‚ç‚¹éƒ½éå†å®Œäº†        if (n == null) {          return null;        }        // ä»åå¾€å‰ç§»é™¤å…³è”èŠ‚ç‚¹        this.children = n.next;        // è¿”å›ç¬¬ä¸€ä¸ªæ²¡æœ‰è®¿é—®è¿‡çš„èŠ‚ç‚¹        if (!n.node.inQueue) {          return n.node;        }      }    }    /**     * è®¿é—®äº†è¯¥èŠ‚ç‚¹     */    Node enqueue(Node[] cnodes) {      // è¯¥èŠ‚ç‚¹æ ‡è®°ä¸ºè®¿é—®è¿‡      this.inQueue = true;      // è®°å½•è¯¥èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹      this.parent = cnodes[ci];      // é‚£ä¹ˆç°åœ¨è¯¥å­—ç¬¦å€¼å¯¹åº”çš„æœ€é«˜èŠ‚ç‚¹ï¼Œå°±æ˜¯å½“å‰èŠ‚ç‚¹ã€‚      // è¿™æ ·å¦‚æœä¹‹åä¹Ÿé‡åˆ°ç›¸åŒå­—ç¬¦çš„å­èŠ‚ç‚¹ï¼Œå°±å¯ä»¥ä¸ºå­èŠ‚ç‚¹èµ‹å€¼å…¶çˆ¶èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢ä¸€è¡Œæ˜¯æœ‰æ•ˆçš„      cnodes[ci] = this;      return this;    }    /**     * é€€å‡ºè¯¥èŠ‚ç‚¹     */    void dequeue(Node[] cnodes, int[] res) {      // ä¹‹åä¼šè®¿é—®è¯¥èŠ‚ç‚¹çš„å…„å¼ŸèŠ‚ç‚¹ï¼Œå› æ­¤çˆ¶èŠ‚ç‚¹éœ€è¦é‡æ–°è®¾ç½®      cnodes[ci] = this.parent;      // è®¾ç½®å½“å‰èŠ‚ç‚¹çš„å€¼      res[index] = this.result;      // çˆ¶èŠ‚ç‚¹ä¹Ÿå¯ä»¥è¿›è¡Œç´¯åŠ       if (this.parent != null) {        this.parent.result += this.result;      }    }    void link(Node x) {      // thisèŠ‚ç‚¹å’ŒxèŠ‚ç‚¹ï¼Œäº’ç›¸ç»‘å®š      this.children = new Next(this.children, x);      x.children = new Next(x.children, this);    }  }  public int[] countSubTrees(int n, int[][] edges, String labels) {    // æ„é€ æ ‘    Node[] nodes = new Node[n];    // æ¯ä¸ªèŠ‚ç‚¹å¯¹åº”çš„å­—ç¬¦    for (int i = 0; i &lt; n; i++) {      nodes[i] = new Node(i, labels.charAt(i) - 'a');    }    // é€šè¿‡è¾¹çš„å…³ç³»ï¼Œå°†èŠ‚ç‚¹äº’ç›¸ç»‘å®š    for (int[] es : edges) {      nodes[es[0]].link(nodes[es[1]]);    }    // æœ€ç»ˆçš„ç»“æœ    int[] res = new int[n];    // å½“å‰è®¿é—®çš„èŠ‚ç‚¹ä¸‹æ ‡    int sz = 0;    // 26ä¸ªå°å†™è‹±æ–‡å­—æ¯å¯¹åº”çš„èŠ‚ç‚¹æ•°ç»„    Node[] cnodes = new Node[26];    // ä¸‹é¢ä¸‰è¡Œå¯ä»¥åˆå¹¶æˆè¿™ä¸€è¡Œï¼š    // Node node = nodes[sz++] = nodes[0].enqueue(cnodes);    nodes[sz] = nodes[0].enqueue(cnodes);    // å½“å‰è®¿é—®çš„èŠ‚ç‚¹    Node node = nodes[sz];    // å› ä¸ºå½“å‰èŠ‚ç‚¹å·²ç»è®¿é—®è¿‡ï¼Œè‡ªç„¶ä¸‹æ ‡éœ€è¦+1    sz++;    for (; ; ) {      // ä»åå¾€å‰ï¼Œæ‰¾åˆ°å½“å‰èŠ‚ç‚¹æ²¡æœ‰è®¿é—®è¿‡çš„ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹      Node child = node.popChild();      // å¦‚æœå·²ç»å…¨éƒ¨è®¿é—®è¿‡äº†      if (child == null) {        // å¼€å§‹è®¡ç®—        node.dequeue(cnodes, res);        if (--sz == 0) {          break;        }        // å›æº¯åˆ°çˆ¶èŠ‚ç‚¹        node = nodes[sz - 1];      } else {        // ä¿è¯äº†ç›¸é‚»èŠ‚ç‚¹ä¸€å®šæ˜¯çˆ¶å­èŠ‚ç‚¹        node = nodes[sz++] = child.enqueue(cnodes);      }    }    return res;  }}</code></pre><h1 class=pgc-h-arrow-right>æ€»ç»“</h1><p>ä»¥ä¸Šå°±æ˜¯è¿™é“é¢˜ç›®æˆ‘çš„è§£ç­”è¿‡ç¨‹äº†ï¼Œä¸çŸ¥é“å¤§å®¶æ˜¯å¦ç†è§£äº†ã€‚æœ¬é¢˜ä¸»è¦åœ¨äºå¯¹æ ‘è¿™ç§æ•°æ®ç»“æ„çš„è€ƒå¯Ÿï¼Œä»¥åŠæ·±åº¦ä¼˜å…ˆéå†çš„ä½¿ç”¨ï¼Œä¼˜åŒ–æ—¶å¯ä»¥é‡‡å–ç©ºé—´æ¢æ—¶é—´çš„ç­–ç•¥ã€‚</p><p>æœ‰å…´è¶£çš„è¯å¯ä»¥è®¿é—®æˆ‘çš„åšå®¢æˆ–è€…å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€å¤´æ¡å·ï¼Œè¯´ä¸å®šä¼šæœ‰æ„å¤–çš„æƒŠå–œã€‚</p><p>https://death00.github.io/</p><p>å…¬ä¼—å·ï¼šå¥ç¨‹ä¹‹é“</p><p><br></p><div class=pgc-img><img alt="åŠ›æ‰£ 1519â€”â€”å­æ•°ä¸­æ ‡ç­¾ç›¸åŒçš„èŠ‚ç‚¹æ•°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a6429e9f0946456d9a73ec2009f3fe32><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt="åŠ›æ‰£ 1519â€”â€”å­æ•°ä¸­æ ‡ç­¾ç›¸åŒçš„èŠ‚ç‚¹æ•°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/35fe6c11a72246e18a5ebe7c94b31e2c><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'åŠ›æ‰£','1519','å­æ•°'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>