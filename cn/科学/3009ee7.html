<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数 | 极客快訊</title><meta property="og:title" content="如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/516332e51ebc4f52aab50f66dd11ef1b"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/3009ee7.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/3009ee7.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/3009ee7.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/3009ee7.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/3009ee7.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/3009ee7.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/3009ee7.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/3009ee7.html><meta property="article:published_time" content="2020-10-29T20:55:19+08:00"><meta property="article:modified_time" content="2020-10-29T20:55:19+08:00"><meta name=Keywords content><meta name=description content="如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/3009ee7.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>科学</a></span></div><div class=post-content><p>我们可以通过对一系列曲目进行聚类来创建歌曲的自动播放列表，我们可以展示如何自动创建相似歌曲的子组。通过我们现有的歌曲知识，我们能够验证该聚类练习的结果。</p><p>但是，如果我们对数据没有这种先验知识怎么办？如果数据甚至都没有被标记怎么办（在许多实际的聚类案例中就是这种情况）？即使是这样，如果这些标签最初对我们没有意义，该怎么办？有很多我从未听说过的艺术家，如果我们要对数千首曲目进行分组，那么手动验证每个集群显然是不切实际的。在这些情况下，我们需要某种数学方法来衡量聚类的"成功"程度。</p><p>为了探索如何做到这一点，我们再次转向Spotify的API。假设我们从四个完全不同的播放列表中选取歌曲：</p><ul><li>Rap UK</li><li>Smooth Jazz</li><li>Classical Essentials</li><li>Essential K-Pop</li></ul><p>如果我们将它们合并到一个数据集中，则无监督的机器学习算法应该能够将其歌曲分组为四个群集，这些群集在某种程度上类似于原始的四个播放列表。</p><p>在开始之前，我们确实可能需要检查一下我们的假设，即来自这些不同播放列表的歌曲确实"与众不同"。当然，在单个图表上同时可视化两个以上的特征是一项挑战。但是，如果我们绘制所有功能的散布矩阵，并按播放列表进行颜色编码，则可以看到有很多度量组合可以证明每种流派的独特特征。</p><div class=pgc-img><img alt="如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/516332e51ebc4f52aab50f66dd11ef1b><p class=pgc-img-caption></p></div><p><br></p><div class=tt-column-card data-content='{"new_thumb_url": "http://sf3-ttcdn-tos.pstatp.com/img/mosaic-legacy/feda00000f8ebe5b9ef6", "title": "\u673a\u5668\u5b66\u4e60\u96be\u70b9\u95ee\u9898\u79d2\u61c2\u8bfe\u5802", "url": "", "price": 88, "column_id": "1623543448814605", "content": "", "author_description": "AI\u706b\u7bad\u8425", "share_price": 56.32, "thumb_url": "http://p4.pstatp.com/large/mosaic-legacy/feda00000f8ebe5b9ef6", "sold": 146}'><p class=column-placeholder></p></div><p><br></p><p>我们在上中看到，在Scikit-Learn中运行聚类算法非常简单：</p><pre><code>#We scale the data to ensure that#feature units don't impact distancesfrom sklearn.preprocessing import StandardScalersclaer = StandardScaler()X_scaled = scaler.fit_transform(X)#This scaled data can then be fed into the HAC algorithmfrom sklearn.cluster import AgglomerativeClustering#We can tell it how many clusters we're aiming foragg_clust = AgglomerativeClustering(n_clusters=4)assigned_clusters = agg_clust.fit_predict(X_scaled)</code></pre><p>我们还看到，HAC具有三个不同的"链接标准"，即该算法将群集逐渐连接在一起的方法：</p><ul><li><strong>ward</strong>（默认）：选择两个聚类，以所有聚类中的方差增加最小的方式合并。通常，这会导致大小相当相等的群集。</li></ul><ul><li><strong>complete</strong>（或最大链接）：合并两个点之间<strong>最大</strong>距离最小的两个聚类。</li></ul><ul><li>·<strong>average</strong>：合并所有点之间<strong>平均</strong>距离最小的两个聚类。</li></ul><p>让我们看看这三个链接标准如何处理类型播放列表数据集。我们用矩阵表示结果，显示每个播放列表的歌曲在每个群集中所占的百分比（群集被任意命名为" A"，" B"，" C"和" D"）。</p><p>当然，如果聚类是完美的，我们希望矩阵的每一行和每一列都恰好包含一个100％的条目（当然，它不需要成对角线，因为聚类名称的分配是任意的）。</p><div class=pgc-img><img alt="如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/acfaaf81913f44ad87261551dc9446f6><p class=pgc-img-caption></p></div><p>默认的"向后"链接试图最小化群集中的方差，尽管这四个群集都有一些泄漏，但在所有四种类型中都表现出色。</p><div class=pgc-img><img alt="如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/06519dc979eb4c2ab1409ae7e86a3e21><p class=pgc-img-caption></p></div><p>"完全"链接显然效果不佳。它已将许多数据集放入群集A。群集C由一首说唱歌曲组成。</p><div class=pgc-img><img alt="如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/d86008741b334592abd06a27467faeff><p class=pgc-img-caption></p></div><p>"平均"链接与"完全"链接具有类似的问题。许多数据点已放置在一个群集中，其中两个群集由一首歌曲组成。</p><p>值得一提的是，还有另一种常见的聚类类型，即K-Means，其工作原理略有不同。HAC通过将它们合并在一起来迭代地减少聚类的数量，而K-Means聚类保持固定数量的聚类（名义上的k），但是迭代地更改每个聚类的成员。</p><div class=pgc-img><img alt="如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b9a4703cb4f24caa9227c7fce751ee04><p class=pgc-img-caption></p></div><p><br></p><div class=tt-column-card data-content='{"new_thumb_url": "http://sf3-ttcdn-tos.pstatp.com/img/pgc-image/1553003467214368302179b", "title": "\u6df1\u5ea6\u5b66\u4e60\u5165\u95e8\u7cfb\u5217\u8bb2\u89e3", "url": "", "price": 199, "column_id": "6670106911691505928", "content": "", "author_description": "AI\u706b\u7bad\u8425", "share_price": 125.77, "thumb_url": "http://p1.pstatp.com/large/pgc-image/1553003467214368302179b", "sold": 344}'><p class=column-placeholder></p></div><p><br></p><p>每个群集的"中心"由带有黑色" +"号的"大"标记表示。所有点都分配给它们最接近中心的聚类。在此分配步骤之后，将重新计算群集中心以包括新成员，然后发生另一个重新分配步骤。如果在重新分配步骤中没有点更改聚类，则算法结束（动画：）。</p><p>K-Means很容易在Python中实现：</p><pre><code>#We scale the data to ensure that#feature units don't impact distancesfrom sklearn.preprocessing import StandardScalersclaer = StandardScaler()X_scaled = scaler.fit_transform(X)#This scaled data can then be fed into the K-Means alorithmfrom sklearn.cluster import KMeans#We can tell it how many clusters we're aiming forkm_clust = KMeans(n_clusters=4)assigned_clusters = km_clust.fit_predict(X_scaled)</code></pre><p>如果将K-Means聚类应用于播放列表数据集，则会得到以下信息：</p><div class=pgc-img><img alt="如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/401d99fdd6da4172a584a53346c70cd4><p class=pgc-img-caption></p></div><blockquote class=pgc-blockquote-quote><p>与使用"ward"链接的HAC算法一样，K-Means聚类在大多数算法中都做得很好，一些爵士乐和说唱歌曲对K-Pop来说是"错误的"。</p></blockquote><p>尽管这些矩阵可以很好地"盯住"我们的结果，但它们在数学上还不够严格。让我们考虑一些指标，这些指标实际上可以帮助我们为集群质量分配一个数字。</p><p><br></p><div class=tt-column-card data-content='{"new_thumb_url": "http://sf3-ttcdn-tos.pstatp.com/img/pgc-image/155464388134677c8e0b801", "title": "\u673a\u5668\u5b66\u4e60From Zero to All", "url": "", "price": 86, "column_id": "6677146987248222468", "content": "", "author_description": "AI\u706b\u7bad\u8425", "share_price": 55.04, "thumb_url": "http://p9.pstatp.com/large/pgc-image/155464388134677c8e0b801", "sold": 190}'><p class=column-placeholder></p></div><p><br></p><h1 class=pgc-h-arrow-right>调整后的Rand Index(兰德指数)</h1><p>该是对经典兰德指数的变化，并试图表达什么群集分配比例是"正确"。通过考虑所有样本对，并根据预测的真实聚类对分配在预测的相同或不同聚类中的对进行计数，并针对随机机会进行调整，计算出两个不同聚类之间的相似性度量。</p><p>可以使用Scikit-Learn评估此（以及我们将考虑的其他指标）。</p><pre><code>from sklearn import metricsmetrics.adjusted_rand_score(predicted_labels, actual)</code></pre><p>调整后的兰德指数限制在-1和1之间。接近1表示好，而接近-1表示差。</p><div class=pgc-img><img alt="如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dd7f8e9a55cc46b09080a132819377cb><p class=pgc-img-caption></p></div><p>我们看到K均值和Ward Linkage得分很高。基于我们先前观察到的矩阵，我们期望得到这一结果。</p><h1 class=pgc-h-arrow-right>Fowlkes Mallows Score</h1><p>该是相似的，在尽可能多的，它会告诉你哪个集群分配是"正确"的程度。特别是，它计算精度和召回率之间的几何平均值。它的范围是0到1，值越高越好。</p><pre><code>metrics.fowlkes_mallows_score（predicted_labels，actual）</code></pre><div class=pgc-img><img alt="如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f70aee83c435483fb93dd50c429544f3><p class=pgc-img-caption></p></div><p>我们的排名与调整后的兰德指数相似，这是我们期望的，因为它们是尝试回答同一问题的两种方法。</p><p>值得注意的是，我们需要了解原始标签才能计算这些指标。鉴于处理无标签数据是无监督学习的主要用例之一，因此我们需要一些其他指标来评估聚类结果，而无需引用"真实"标签。</p><p>假设我们从三个单独的聚类分析中得到以下结果。</p><div class=pgc-img><img alt="如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/89ba2d0566f9439190a695ee16250999><p class=pgc-img-caption></p></div><div class=pgc-img><img alt="如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1211d164e2c241a6b6fe2184b12f7498><p class=pgc-img-caption></p></div><div class=pgc-img><img alt="如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/361f37bc46484dd08b2fddec7f7e9a42><p class=pgc-img-caption></p></div><p>显然，我们可以使集群更加"紧密"。是否可以通过某种方式将这种"紧度"归因于数字？</p><p><br></p><div class=tt-column-card data-content='{"new_thumb_url": "http://sf6-ttcdn-tos.pstatp.com/img/pgc-image/9f789710429d4db9a0d0130940ff30d9", "title": "\u6df1\u5ea6\u5b66\u4e60\u7684\u9ad8\u7ea7\u8bae\u9898", "url": "", "price": 199, "column_id": "6819869635672801549", "content": "", "author_description": "AI\u706b\u7bad\u8425", "share_price": 0, "thumb_url": "http://p9.pstatp.com/large/pgc-image/9f789710429d4db9a0d0130940ff30d9", "sold": 3}'><p class=column-placeholder></p></div><p><br></p><h1 class=pgc-h-arrow-right>轮廓分数</h1><p>该试图描述一个数据点的相似程度在其集群的其他数据点，相对于数据点并不在其集群（这是汇聚了所有数据点来获得总体集群分数）。换句话说，它考虑了集群在空间中的"区别度"-实际上人们可以使用任何"距离"度量来计算分数。</p><p>它的范围是-1和1。接近-1表示群集不正确，而接近+1则表示每个群集都非常密集。</p><pre><code>metrics.silhouette_score（scaled_feature_data，cluster_labels）</code></pre><div class=pgc-img><img alt="如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d4df78e347544a3687bb65ca5d10b381><p class=pgc-img-caption></p></div><p>我们看到，所有聚类都没有超高的轮廓分数。有趣的是，我们看到平均链接集群的得分最高。但是请记住，该算法产生了两个群集，每个群集仅包含一个数据点，这在现实情况下不太可能是理想的结果（这是一个教训，您通常不能依靠单个指标来做出决策算法的质量！）</p><h1 class=pgc-h-arrow-right>Calinski Harabaz指数</h1><p>所述Calinski Harabaz指数是相对于点的数据点的方差相比，在其它簇的点的比率，对所述方差中的集群。由于我们希望第一部分较高，而第二部分较低，因此需要较高的CH指数。与我们看到的其他指标不同，此分数没有界限。</p><pre><code>metrics.calinski_harabasz_score（scaled_feature_data，cluster_labels）</code></pre><div class=pgc-img><img alt="如何评估聚类模型？兰德指数、轮廓系数、Calinski Harabaz指数" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/cfdce49b2f054c68b070be1aabda1bf9><p class=pgc-img-caption></p></div><p>在这里，我们看到我们的K均值和Ward Linkage算法得分很高。完全和平均链接算法因具有一个或两个较大的聚类而受到惩罚，这将具有较高水平的内部方差。</p><p><br></p><div class=tt-column-card data-content='{"new_thumb_url": "http://sf1-ttcdn-tos.pstatp.com/img/pgc-image/54b9985ef2144dc2aa7c2e315c035f63", "title": "\u57fa\u4e8e\u6df1\u5ea6\u5b66\u4e60\u7684\u76ee\u6807\u68c0\u6d4b", "url": "", "price": 299, "column_id": "6768281209177899268", "content": "", "author_description": "AI\u706b\u7bad\u8425", "share_price": 191.36, "thumb_url": "http://p5.pstatp.com/large/pgc-image/54b9985ef2144dc2aa7c2e315c035f63", "sold": 91}'><p class=column-placeholder></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'指数','评估','聚类'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>