<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>数学学习如此容易：用Python生成随机数 | 极客快訊</title><meta property="og:title" content="数学学习如此容易：用Python生成随机数 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/dfic-imagehandler/dc938752-e0c7-4e79-bfc1-ec39b5762056"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/32a28285.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/32a28285.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/32a28285.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/32a28285.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/32a28285.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/32a28285.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/32a28285.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/32a28285.html><meta property="article:published_time" content="2020-11-14T20:51:44+08:00"><meta property="article:modified_time" content="2020-11-14T20:51:44+08:00"><meta name=Keywords content><meta name=description content="数学学习如此容易：用Python生成随机数"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/32a28285.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>数学学习如此容易：用Python生成随机数</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>科学</a></span></div><div class=post-content><p><strong>还在为生成随机数而头疼吗？还为生成随机数不够随机而苦恼吗？学了二项式分布不知道在实际生活中有啥用处吗？如何用用随机数来观察正态分布？</strong></p><p><strong>读下去，下面，就是你要的答案。</strong></p><div class=pgc-img><img alt=数学学习如此容易：用Python生成随机数 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/dc938752-e0c7-4e79-bfc1-ec39b5762056><p class=pgc-img-caption></p></div><p><strong>NumPy随机数</strong></p><p>随机数常用于蒙特卡罗法、随机积分等方面。然而，真正的随机数很难获得，实际中使用的都是伪随机数。大部分情况下，伪随机数就足以满足我们的需求。当然，某些特殊情况除外，如进行高精度的模拟实验时。对于NumPy，与随机数有关的函数都在random子程序包中。</p><p>提示：</p><p>NumPy核心的随机数发生器是基于梅森旋转算法的，详见https://en.wikipedia.org/wiki/Mersenne_twister$2。</p><p>我们既可以生成连续分布的随机数，也可以生成非连续分布的随机数。分布函数有一个可选的size参数，它能通知NumPy要创建多少个数字。我们可以用整型或者元组来给这个参数赋值，这时会得到相应形状的数组，其值由随机数填充。离散分布包括几何分布、超几何分布和二项式分布。连续分布包括正态分布和对数正态分布。</p><ul><li>用二项式分布进行博弈</li></ul><p>二项式分布模拟的是在进行整数次独立实验中成功的次数，其中每次实验的成功机会是一定的。</p><p>假如我们身在17世纪的赌场，正在对8片币玩法下注。当时流行用9枚硬币来玩。如果人头朝上的硬币少于5枚，那么我们将输掉一个8分币；否则，我们就赢一个8分币。下面，我们开始模拟这个游戏，假设我们手上有一千硬币作为初始赌资。我们将使用random模块提供的binomial()函数进行模拟：</p><p>提示：</p><p>完整的代码详见本书代码包中的headortail.py文件。</p><hr><pre>import numpy as npfrom matplotlib.pyplot import plot, showcash = np.zeros(10000)cash[0] = 1000outcome = np.random.binomial(9, 0.5, size=len(cash))for i in range(1, len(cash)):　　 if outcome[i] &lt; 5:　　　　　　 cash[i] = cash[i - 1] - 1　　 elif outcome[i] &lt; 10:　　　　　　 cash[i] = cash[i - 1] + 1　　 else:　　　　　　 raise AssertionError("Unexpected outcome " + outcome)print outcome.min(), outcome.max()plot(np.arange(len(cash)), cash)show()</pre><hr><p>若要了解binomial()函数，请看下列步骤。</p><p>1．用binomial()函数。</p><p>将数组初始化为零，即现金余额为零。调用binomial()函数，将size参数设为10000，这就表示我们要掷10000次硬币。</p><hr><pre>cash = np.zeros(10000)cash[0] = 1000outcome = np.random.binomial(9, 0.5, size=len(cash))</pre><hr><p>2．更新现金余额。</p><p>利用抛郑硬币的结果来更新cash数组。显示outcome数组中的最大值和最小值，只要保证没有罕见的异常值即可。</p><hr><pre>for i in range(1, len(cash)):　　 if outcome[i] &lt; 5:　　　　 cash[i] = cash[i - 1] - 1　　 elif outcome[i] &lt; 10:　　　　　　cash[i] = cash[i - 1] + 1　　 else:　　　　　　raise AssertionError("Unexpected outcome " + outcome)print outcome.min(), outcome.max()</pre><hr><p>不出所料，其值在0～9。</p><hr><pre>0 9</pre><hr><p>3．用matplotlib绘出cash数组的图像。</p><hr><pre>plot(np.arange(len(cash)), cash)show()</pre><hr><p>从图3-1可以看出，现金余额的曲线类似于随机行走（即不按照固定模式，而是随机游走）。</p><div class=pgc-img><img alt=数学学习如此容易：用Python生成随机数 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/9557b42d544c49c88fc8883e35d69dea><p class=pgc-img-caption></p></div><p>图3-1</p><p>当然，我们每一次执行程序代码，都会得到一个不同的随机游走。若想总是得到相同的结果，需要给NumPy的随机数子程序包中的binomial()函数一个种子值。</p><ul><li>正态分布采样</li></ul><p>连续分布是通过 概率密度函数（pdf） 进行建模的。在特定区间发生某事件的可能性可以通过概率密度函数的积分运算求出。NumPy的random模块提供了许多表示连续分布的函数，如beta、chisquare、exponential、f、gamma、gumbel、laplace、<br>lognormal、logistic、multivariate_normal、noncentral_chisquare、<br>noncentral_f、normal等。</p><p>利用NumPy的random子程序包中的normal()函数，可以把正态分布以直观的形式图示出来。下面给出随机产生的数值的钟形曲线和条形图（完整的脚本详见本书代码包中的normaldist.py文件）：</p><hr><pre>import numpy as npimport matplotlib.pyplot as pltN=10000normal_values = np.random.normal(size=N)dummy, bins, dummy = plt.hist(normal_values, np.sqrt(N), normed=True, lw=1)sigma = 1mu = 0plt.plot(bins, 1/(sigma * np.sqrt(2 * np.pi)) * np.exp( - (bins - mu)**2 / (2 * sigma**2) ),lw=2)plt.show()</pre><hr><p>随机数可以按照正态分布的要求生成，它们的分布情况可以用条形图来显示。若要绘制正态分布，请执行下列步骤。</p><p>1．成数值。</p><p>借助于NumPy的random子程序包提供的normal()函数，可以创建指定数量的随机数。</p><hr><pre>N=100.00normal_values = np.random.normal(size=N)</pre><hr><p>2．画出条形图和理论上的pdf。</p><p>下面使用matplotlib来绘制条形图和理论上的pdf，这里中心值为0，标准差为1：</p><hr><pre>dummy, bins, dummy = plt.hist(normal_values,　　　　np.sqrt(N), normed=True, lw=1)sigma = 1mu = 0plt.plot(bins, 1/(sigma * np.sqrt(2 * np.pi))　　　　* np.exp( - (bins - mu)**2 / (2 * sigma**2) ),lw=2)plt.show()</pre><hr><p>图3-2展示了著名的钟形曲线。</p><div class=pgc-img><img alt=数学学习如此容易：用Python生成随机数 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/cd7bba8570904e978c3a5459e106eb91><p class=pgc-img-caption>图3-2</p></div><p></p><h1>用SciPy进行正态检验</h1><div class=pgc-img><img alt=数学学习如此容易：用Python生成随机数 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/4cc42143-7543-487b-bd5e-2b514878257a><p class=pgc-img-caption></p></div><p>正态分布被广泛用于科学和统计学领域，按照中心极限定理，随着独立观测的随机样本数量的增加，它们会趋向呈正态分布。正态分布的特性已经为大家所熟知，并且它还非常便于使用，不过，它需要满足许多必要条件，如数据点的数量要足够大，并且还要求这些数据点必须是相互独立的。工作中，我们需要养成检查数据是否符合正态分布的好习惯。正态检验的方法有很多，其中有一些已经在scipy.stats程序包中实现了。本节将用到这些检验方法，这里的样本是取自https://www.google.org/flutrends/data.txt$2的流感趋势数据。这里我们对原始文件进行了简化处理，仅留下日期和来自阿根廷的数据两列，下面给出示例行：</p><hr><pre>Date,Argentina29/12/02,05/01/03,12/01/03,19/01/03,26/01/03,02/02/03,136</pre><hr><p>这些数据还可以从本书代码包中的goog_flutrends.csv文件中找到，和前面一样，这里也按照正态分布对这些数据进行抽样。得到的数组的大小与流感趋势数组相同，如果顺利通过正态检验，就以它为金标准（the golden standard）。</p><p>提示：</p><p>这里的代码取自代码包中的normality_test.py文件。</p><hr><pre>import numpy as npfrom scipy.stats import shapirofrom scipy.stats import andersonfrom scipy.stats import normaltestflutrends = np.loadtxt("goog_flutrends.csv", delimiter=',', usecols=(1,), skiprows=1, converters = {1: lambda s: float(s or 0)}, unpack=True)N = len(flutrends)normal_values = np.random.normal(size=N)zero_values = np.zeros(N)print "Normal Values Shapiro", shapiro(normal_values)print "Zeroes Shapiro", shapiro(zero_values)print "Flu Shapiro", shapiro(flutrends)printprint "Normal Values Anderson", anderson(normal_values)print "Zeroes Anderson", anderson(zero_values)print "Flu Anderson", anderson(flutrends)printprint "Normal Values normaltest", normaltest(normal_values)print "Zeroes normaltest", normaltest(zero_values)print "Flu normaltest", normaltest(flutrends)</pre><hr><p>作为一个反面例子，下面使用的这个数组跟前面提到的填满零的数组具有同样的大小。实际上，当处理一些小概率事件（如世界性疫情的爆发）时，就可能遇到这种数据。</p><p>在这个数据文件中，一些单元是空的；当然，这种问题经常会碰到，所以必须习惯于首先清洗数据。我们假定正确的数值是0，下面使用一个转换器来填上这些0值：</p><hr><pre>flutrends = np.loadtxt("goog_flutrends.csv", delimiter=',',　　usecols=(1,), skiprows=1, converters = {1: lambda s:　　float(s or 0)}, unpack=True)</pre><hr><p>夏皮罗-威尔克检验法可以对正态性进行检验。相应的SciPy函数将返回一个元组，其中第一个元素是一个检验统计量，第二个数值是 p 值。需要注意的是，这种填满了零的数组会引发警告。事实上，本例中用到的3个函数在处理这个数组方面确实有困难，同时还引发警告。下面是得到的结果：</p><hr><pre>Normal Values Shapiro (0.9967482686042786,　　0.2774980068206787)Zeroes Shapiro (1.0, 1.0)Flu Shapiro (0.9351990818977356, 2.2945883254311397e-15) </pre><hr><p>这种用零填充的数组看起来有点怪，虽然会收到相关的警告，但是大可以忽略不计。这里得到的p值类似于本例中后面的第三个检验的结果。分析结果基本上是一样的。</p><p>Anderson-Darling检验可以用来检验正态分布以及其他分布，如指数分布、对数分布和冈贝尔（Gumbel）分布等。相关的SciPy函数涉及一个检验统计量和一个数组，该数组存放了百分之15、10、5、2.5和1等显著性水平所对应的临界值。如果该统计量大于显著性水平的临界值，就可以断定它不具有正态性。我们将得到下列数值：</p><hr><pre>Normal Values Anderson (0.31201465602225653, array([ 0.572,　　 0.652,　　0.782,　　0.912,　　1.085]), array([ 15. ,　　10. ,　　 5.　　,　　 2.5,　　 1. ]))Zeroes Anderson (nan, array([ 0.572,　　0.652,　　0.782,　　 0.912,　　1.085]), array([ 15. ,　　10. ,　　 5. ,　　 2.5,　　 1.　　]))Flu Anderson (8.258614154768793, array([ 0.572,　　0.652,　　 0.782,　　0.912,　　1.085]), array([ 15. ,　　10. ,　　 5. ,　　 2.5,　　　　1. ])) </pre><hr><p>对于这种用零填充的数组，我们没有什么好说的，因为返回的统计量根本就不是一个数值。就像我们期望的那样，这个金标准数组是符合正态分布的。然而，流感趋势数据返回的这个统计量大于所有的有关临界值，因此我们可以肯定它不符合正态分布。这3个测试函数中，这个看起来是最容易使用的一个。</p><p>SciPy的normaltest()函数还实现了D'Agostino检验和Pearson检验功能。该函数返回的元组和shapiro()函数一样，也包括一个统计量和p值。这里的p值是双边卡方概率（two-sided Chi-squared probability），卡方分布是另一种著名的分布，这种检验本身是基于偏度和峰度检验的z分数的。偏度系数用来表示分布的对称程度的，这样，由于正态分布是对称的，所以偏度系数为零。峰度系数描述的是分布的形状（尖峰，肥尾）。这种正态分布的峰度系数为3，超额峰度的系数为0。以下是本次检验获得的数值：</p><hr><pre>Normal Values normaltest (3.102791866779639, 0.21195189649335339)Zeroes normaltest (1.0095473240349975, 0.60364218712103535)Flu normaltest (99.643733363569538, 2.3048264115368721e-22) </pre><hr><p>因为这里处理的是p值的概率，所以它越大越好，最好接近1。对于这种用零填充的数组，会得到很奇怪的结果，不过，由于我们已经得到提示，所以对于这个特殊数组来说，结果是不可信的。此外，如果p值大于等于0.5，则认为它具有正态性。对于金标准数组，我们会得到一个更小的数值，这说明我们需要进行更多的观察，这一点留作作业，请读者自行练习。</p><p>觉得好，请转发。还想获取更多的信息，请点击下面连接。</p><div class=pgc-img><img alt=数学学习如此容易：用Python生成随机数 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/6b38079d-d347-4bd0-a3eb-7f3e1c4d264a><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'数学学习','Python','随机数'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>