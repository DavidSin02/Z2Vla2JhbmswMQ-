<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>频谱分析？FFT函数正确使用从零开始 | 极客快訊</title><meta property="og:title" content="频谱分析？FFT函数正确使用从零开始 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/bf18e4d0794e46bbb119b1f93c4b2ef2"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/3937c9cd.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/3937c9cd.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/3937c9cd.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/3937c9cd.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/3937c9cd.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/3937c9cd.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/3937c9cd.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/3937c9cd.html><meta property="article:published_time" content="2020-11-14T20:50:22+08:00"><meta property="article:modified_time" content="2020-11-14T20:50:22+08:00"><meta name=Keywords content><meta name=description content="频谱分析？FFT函数正确使用从零开始"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/3937c9cd.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>频谱分析？FFT函数正确使用从零开始</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>科学</a></span></div><div class=post-content><div class=pgc-img><img alt=频谱分析？FFT函数正确使用从零开始 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/bf18e4d0794e46bbb119b1f93c4b2ef2><p class=pgc-img-caption></p></div><p><strong>班长聊通信原理 | 系列文章关注"班长"→主页→"文章"查看</strong></p><p class=pgc-end-literature>肺炎疫情让年味儿多了不少焦虑，走亲访友都成了奢望。与其冒着被感染的风险出门或聚会，倒不如宅在家里最踏实。</p><p>热爱学习的同学们，宅在家里，学点通信原理吧。</p><p>本文主要介绍MATLAB中FFT函数的使用，对于FFT|DFT的原理未有提及，需要的同学去文末自取。</p><p><strong>目录</strong></p><ol start=1><li>引言</li><li>以正弦信号为例</li><li>频域表示</li><li>绘制DFT生值图</li><li>根据归一化频率轴绘制原始值</li><li>归一化频率轴、调整为正负频率</li><li>FFT求功率谱密度</li><li>结论</li></ol><hr><h1 class=pgc-h-arrow-right>01引言</h1><p>FFT是Fast Fourier Transform，快速傅里叶变换的缩写。</p><p>傅里叶变换可以让我们，由<u>时域分析</u>转入<u>变换域(频域)</u>分析。</p><p>毫无疑问，我们的实验对象是常见的标准信号。</p><p>教材中使用的标准信号有：<u>正弦、余弦、高斯脉冲、方波、孤立矩形脉冲、指数衰减、Chirp信号</u>。</p><p>在频域分析之前，我们需要思考如何在MATLAB中产生这些标准信号。</p><h1 class=pgc-h-arrow-right>02以正弦信号为例</h1><p>为了在MATLAB中产生正弦波，第一步是固定正弦波的频率<strong>f</strong>。</p><p>例如，我打算生成一个<strong>f = 10Hz</strong>的正弦波，其最小振幅和最大振幅分别为<strong>-1v</strong>和<strong>1v</strong>。</p><p>因为MATLAB是一种处理数字比特的软件，所以既然已经确定了正弦波的频率，下一步就是确定采样率。</p><p>根据Nyquist Shannon定理，为了<strong>产生/绘制</strong>平滑的正弦波，采样率必须远远高于规定的最小所需采样率，该采样率至少是频率<strong>f</strong>的两倍。</p><p>这里选择了30的过采样倍数，这是为了绘制一个平滑的连续的正弦波。</p><p>因此，采样率为<strong>f_s=30倍f=300Hz</strong>。</p><p>如果正弦波需要相移，那就单独定义一个初相位。</p><div class=pgc-img><img alt=频谱分析？FFT函数正确使用从零开始 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4ae72cbd2a91461cb56143c0c2af1002><p class=pgc-img-caption>图1 正弦信号，5个周期，频率为10Hz</p></div><pre><code>% 产生正弦波形f = 10; %正弦波频率，单位Hz | frequency of sine waveoverSampRate = 30; %采样倍率 | oversampling ratefs = overSampRate*f; %采样频率 | sampling frequencyphase = 1/3*pi; %初始相位 | desired phase shift in radiansnCyl = 5; %显示的周期个数 | to generate five cycles of sine wavet = 0:1/fs:nCyl*1/f; %时间向量 | time basex = sin(2*pi*f*t+phase); %这里也可以替换为cos函数 | replace with cos if a cosine wave is desiredplot(t,x);title(['正弦波 f=', num2str(f), 'Hz']);xlabel('时间(s)');ylabel('幅度');</code></pre><h1 class=pgc-h-arrow-right>03频域表示</h1><p>我们在频域上也可以表示给定信号。就是通过快速傅里叶变换(FFT)来实现的。</p><p>MATLAB中FFT(x,n)可以计算n点的DFT。</p><p>一般在DFT计算中的点数n取为2的幂，以方便FFT的有效计算。</p><p>这里选择n=1024的值。</p><p class=pgc-end-literature>fft - 快速傅里叶变换</p><p class=pgc-end-literature>此 MATLAB 函数 用快速傅里叶变换 (fft) 算法计算 X 的离散傅里叶变换 (DFT)。 如果 X 是向量，则 fft(X) 返回该向量的傅里叶变换。</p><p class=pgc-end-literature>如果 X 是矩阵，则 fft(X) 将 X 的各列视为向量，并返回每列的傅里叶变换。 如果 X 是一个多维数组，则 fft(X) 将沿大小不等于 1</p><p class=pgc-end-literature>的第一个数组维度的值视为向量，并返回每个向量的傅里叶变换。</p><p class=pgc-end-literature>Y = fft(X)</p><p class=pgc-end-literature>Y = fft(X,n)</p><p class=pgc-end-literature>Y = fft(X,n,dim)</p><p>由于FFT只是n点DFT的数值计算，所以有很多方法来绘制结果。</p><h1 class=pgc-h-arrow-right>04绘制DFT生值图</h1><p>所谓的生值图2，就是DFT的原始值：x轴从0到n-1，表示n个样本值。</p><p>由于DFT值是复数，所以DFT abs(X)的大小被绘制在y轴上。</p><p>从这个图2中，频率轴(X轴)就是简单的0到1023，共计1024个点。看起来和"频率"没啥关系，就是1024个点计算DFT。</p><div class=pgc-img><img alt=频谱分析？FFT函数正确使用从零开始 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e475ca358fb74787a2fa2cb67b40cef9><p class=pgc-img-caption>图2 FFT函数输出值，直接画图，注意横座标为样本点</p></div><pre><code>NFFT=1024; % NFFT点DFT | NFFT-point DFT      X=fft(x,NFFT); %使用FFT计算FFT | compute DFT using FFT        nVals=0:NFFT-1; %DFT样本点 | DFT Sample points       plot(nVals,abs(X));      title('双边FFT-无移动 | Double Sided FFT - without FFTShift');        xlabel('样本点 | Sample points (N-point DFT)')        ylabel('DFT值 | DFT Values');</code></pre><h1 class=pgc-h-arrow-right>05根据归一化频率轴绘制原始值</h1><p>将频率轴(x轴)归一化。</p><p>只需将x轴上的样本索引除以FFT的长度n，这使x轴相对于采样率<strong>f_s</strong>规范化。</p><p>然而，我们仍然不能从图3中找出正弦的频率。</p><div class=pgc-img><img alt=频谱分析？FFT函数正确使用从零开始 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/aca24d15235e455fb0626d30e2c44e3f><p class=pgc-img-caption>图3 把频率归一化，就是除以样本点总数</p></div><pre><code>NFFT=1024; %NFFT点DFT | NFFT-point DFT      X=fft(x,NFFT); %使用FFT计算FFT | compute DFT using FFT        nVals=(0:NFFT-1)/NFFT; %归一化DFT样本点 | Normalized DFT Sample points         plot(nVals,abs(X));      title('双边FFT-无移动 |Double Sided FFT - without FFTShift');        xlabel('归一化频率 | Normalized Frequency')       ylabel('DFT幅度值 | DFT Values');</code></pre><h1 class=pgc-h-arrow-right>06归一化频率轴、调整为正负频率</h1><p>在频域中，由于引入了复指数函数，所以会有正、负频率轴。</p><p>所以，为了在具有正值和负值的频率轴上绘制DFT值，样本索引0处的DFT值必须作为数组中心，然后<strong>"对称"</strong>到负频率轴。</p><p>这是通过在MATLAB中使用fftshift函数来完成的。</p><p>从-0.5到0.5的x轴。</p><p class=pgc-end-literature>fftshift - Shift zero-frequency component to center of spectrum</p><p class=pgc-end-literature>This MATLAB function rearranges a Fourier transform X by shifting the</p><p class=pgc-end-literature>zero-frequency component to the center of the array.</p><p class=pgc-end-literature>Y = fftshift(X)</p><p class=pgc-end-literature>Y = fftshift(X,dim)</p><p>fftshiftt通过将零频率分量移动到阵列的中心，这个matlab函数重新排列一个傅里叶变换X。</p><div class=pgc-img><img alt=频谱分析？FFT函数正确使用从零开始 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/cf337a5e33f541c384e636df68e364d9><p class=pgc-img-caption>图4 fftshiftt通过将零频率分量移动到阵列的中心</p></div><pre><code>figureNFFT=1024; %%NFFT点DFT | NFFT-point DFT      X=fftshift(fft(x,NFFT)); %使用FFT计算FFT | compute DFT using FFT      fVals=(-NFFT/2:NFFT/2-1)/NFFT; %归一化DFT样本点 | DFT Sample points        plot(fVals,abs(X));      title('双边FFT|Double Sided FFT - with FFTShift');       xlabel('归一化频率 | Normalized Frequency')       ylabel('DFT幅度值 | DFT Values');</code></pre><p>至此，横座标都不能算“真正”的频率，而我们恰恰想要的是频率图。</p><p>所以，我们用fs/NFFT可以得到频率间隔△f。</p><p>从图5中，我们可以确定FFT绝对值的峰值在10Hz和-10Hz处。</p><p>因此，产生的正弦波的频率为10Hz。</p><p><u>这是我们只看频谱图5得出的结论，和我们仿真的一致。</u></p><p>在10Hz和-10Hz峰值旁边的小旁瓣是由于谱泄漏造成的(后续会说这个问题)</p><div class=pgc-img><img alt=频谱分析？FFT函数正确使用从零开始 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fa5fd235e6f4434ca60af5cdeea503e1><p class=pgc-img-caption>图5 将横座标转换为频率</p></div><pre><code>figureNFFT=1024;      X=fftshift(fft(x,NFFT));         fVals=fs*(-NFFT/2:NFFT/2-1)/NFFT;        plot(fVals,abs(X),'b');      title('Double Sided FFT - with FFTShift');       xlabel('Frequency (Hz)')         ylabel('|DFT Values|');</code></pre><h1 class=pgc-h-arrow-right>07FFT求功率谱密度</h1><p>图6绘制了每个频率分量的功率。功率可以在线性标度或对数标度中绘制。</p><p>每个频率分量的能量计算为</p><p><strong class=highlight-text>P_x(f) = x(f) * x^*(f)</strong></p><p>其中x(f)是信号x(t)的频域表示，x^*(f)是其共轭。</p><div class=pgc-img><img alt=频谱分析？FFT函数正确使用从零开始 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/86beb1eb607c413493f13f088ec0e3d7><p class=pgc-img-caption>图6 功率谱密度</p></div><pre><code>% 功率谱密度，频率移动，幅度值的模figureNFFT=1024;L=length(x);         X=fftshift(fft(x,NFFT));         Px=X.*conj(X)/(NFFT*L); %计算每个频率分量的功率 | Power of each freq components       fVals=fs*(-NFFT/2:NFFT/2-1)/NFFT;        plot(fVals,Px,'r');      title('功率谱密度 | Power Spectral Density');         xlabel('频率 | Frequency (Hz)')         ylabel('功率 | Power');</code></pre><p>在对数log尺度上绘制PSD图，<u>为信号处理中产生最常见的PSD图7</u>。</p><pre><code>% 功率谱密度，LOG表示，频率移动，幅度值的模figureNFFT=1024;      L=length(x);         X=fftshift(fft(x,NFFT));         Px=X.*conj(X)/(NFFT*L); %计算每个频率分量的功率| Power of each freq components       fVals=fs*(-NFFT/2:NFFT/2-1)/NFFT;        plot(fVals,10*log10(Px),'b');        title('功率谱密度 | Power Spectral Density');         xlabel('频率 | Frequency (Hz)')         ylabel('功率 | Power');</code></pre><div class=pgc-img><img alt=频谱分析？FFT函数正确使用从零开始 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/71ad209fed6b42da997216206b395787><p class=pgc-img-caption>图7 PSD功率谱密度，对数座标</p></div><p>在图8中，省略了x轴的负频部分，只绘制了对应于n点DFT的0到n/2个样本点的FFT值。</p><p>相应地，归一化频率轴在0到0.5之间运行，绝对频率(x轴)从0到f_s/2。</p><div class=pgc-img><img alt=频谱分析？FFT函数正确使用从零开始 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/586699034a1847a6a0b1ad5510c7e891><p class=pgc-img-caption>图8 单边PSD</p></div><h1 class=pgc-h-arrow-right>结论</h1><p>关于FFT的使用，还有很多有趣的问题：比如谱泄露spectral leakage，采样点对FFT结果的影响等等。班长会在后续过程中与大家讨论，敬请期待。</p><h1 class=pgc-h-arrow-right>相关文章参考</h1><p>[1]Mathuranathan,"How to plot FFT using Matlab – FFT of basic signals : Sine and Cosine waves",July 16, 2014.</p><p>[2]<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6644130887606731272/?group_id=6644130887606731272" target=_blank>库利-图基FFT算法，4G通信系统中使用了FFT算法进行时域频域切换</a></p><p>[3]<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6674902118089884167/?group_id=6674902118089884167" target=_blank>OFDM技术：信号的产生为何与FFT算法有关？为什么要串并转换？</a></p><p>[4]<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6712417577814983179/?group_id=6712417577814983179" target=_blank>想要画出正确的频谱图，不是直接调用MATLAB FFT函数那么简单</a></p><p>[5]<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6778360265307062797/?group_id=6778360265307062797" target=_blank>傅里叶变换，是如何让我们抓狂的？</a></p><hr><p><strong>看到这里，欢迎为文章点赞，期待您在留言区的精彩评论！</strong></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'频谱','FFT','函数'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>