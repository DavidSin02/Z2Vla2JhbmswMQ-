<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>gdb实用的调试技巧：启动方式、堆栈信息、单步调试 | 极客快訊</title><meta property="og:title" content="gdb实用的调试技巧：启动方式、堆栈信息、单步调试 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/e76ccd7d8db044d28008c3bcb7dcc536"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/49aa12e.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/49aa12e.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/49aa12e.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/49aa12e.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/49aa12e.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/49aa12e.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/49aa12e.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/49aa12e.html><meta property="article:published_time" content="2020-10-29T21:02:11+08:00"><meta property="article:modified_time" content="2020-10-29T21:02:11+08:00"><meta name=Keywords content><meta name=description content="gdb实用的调试技巧：启动方式、堆栈信息、单步调试"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/49aa12e.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>gdb实用的调试技巧：启动方式、堆栈信息、单步调试</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>科学</a></span></div><div class=post-content><p>对于很多开发者来说，开发过程中难免会遇到各种各样的bug, 所以，每个开发者应该考虑如何快速高效定位问题原因，而gdb是linux上很实用的调试工具，熟练掌握其调试技巧，将有助于提高解决问题的效率，也是开发者应该掌握的基本技能。</p><p style=text-align:start>本文首先会讲解三种启动gdb的方式，然后再介绍两种查看堆栈信息的方法，最后再详细说明两种单步调试的实用技巧。</p><div class=pgc-img><img alt=gdb实用的调试技巧：启动方式、堆栈信息、单步调试 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e76ccd7d8db044d28008c3bcb7dcc536><p class=pgc-img-caption></p></div><p style=text-align:start><br></p><h1 class=pgc-h-arrow-right>三种启动</h1><p style=text-align:start>通过gdb启动程序，通常有三种方式。下面分别进行讲解说明。</p><p style=text-align:start>第一种方式是： gdb + 进程名。 编译程序的时候，需要加上-g选项，以便可执行程序中加入符号表信息，方便问题定位。</p><div class=pgc-img><img alt=gdb实用的调试技巧：启动方式、堆栈信息、单步调试 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4523a0157c724e6993f04cd28bfd551c><p class=pgc-img-caption></p></div><p style=text-align:start>第二种方式，gdb –symbols=有符号表的进程 –exec=没有符号表的进程。首先创建没有符号表的进程，然后创建带有符号表的进程，最后再启动进程。</p><div class=pgc-img><img alt=gdb实用的调试技巧：启动方式、堆栈信息、单步调试 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7ee44cf90acc43ae9631c38be7ed4ded><p class=pgc-img-caption></p></div><p style=text-align:start>第三种方式，gdb -p 进程号。 这个方式也是最多使用的。因为进程崩溃的时候，仍然可以使用该方式，附着gdb到进程中，然后查看堆栈信息。</p><p style=text-align:start>首先以后台运行的方式启动进程，然后查看进程的进程号，最后执行“gdb -p 进程号”的命令，把gdb附着到进程中，这样就可以很方便进行调试。</p><div class=pgc-img><img alt=gdb实用的调试技巧：启动方式、堆栈信息、单步调试 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1733a3671f104f6b9588d8fa59dbf3d0><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>两种堆栈</h1><p style=text-align:start>当程序突然崩溃的时候，可以使用gdb附着到程序中，然后执行bt命令来查看最新的堆栈信息，这往往能够很快定位到问题的原因。</p><div class=pgc-img><img alt=gdb实用的调试技巧：启动方式、堆栈信息、单步调试 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e73f67bcc9274f1fa8b98db8c3f85c01><p class=pgc-img-caption></p></div><p>如果进程中启动很多线程，那么如何查看每个线程的堆栈信息呢，执行命令thread apply all bt，可以查看当前进程的所有线程的堆栈信息。</p><div class=pgc-img><img alt=gdb实用的调试技巧：启动方式、堆栈信息、单步调试 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/674918bec4c64646820e9ba6501fb400><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>两种技巧</h1><p style=text-align:start>第一个技巧就是利用watch来观察某个变量的变化，当watch检测的变量发生变化的时候，gdb就会立即中断。</p><p style=text-align:start>假设想要检测Fun函数下i_sum的变化情况，那么首先在该处设置断点，然后运行程序。</p><div class=pgc-img><img alt=gdb实用的调试技巧：启动方式、堆栈信息、单步调试 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b01a5a842e7a472da0e4b440b509e532><p class=pgc-img-caption></p></div><p style=text-align:start>运行到断点位置的时候，程序停止，那么可以使用p命令打印变量的值，还可以查看变量的地址，最后还可以使用该地址来设置watch的观察点。</p><div class=pgc-img><img alt=gdb实用的调试技巧：启动方式、堆栈信息、单步调试 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/557b7e02dc4948f08638e6824ca69b10><p class=pgc-img-caption></p></div><p style=text-align:start>第二个技巧就是单步调试，它的好处就是让开发者可以轻松跟踪代码的流程，从而不需要通过添加日志的方式来确定代码的流程。</p><p style=text-align:start>假设有如下所示的代码段，我们通过单步调试的方式来跟踪代码流程。首先，通过gdb启动程序，或者程序附着上gdb之后，设置断点，然后从断点处开始跟踪代码流程。</p><div class=pgc-img><img alt=gdb实用的调试技巧：启动方式、堆栈信息、单步调试 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d8d2bbab2449408b8fbac1bd898a9843><p class=pgc-img-caption></p></div><p style=text-align:start>通过命令r启动程序，程序停止在断点处之后，使用n命令(next)进行单步运行，注意该命令不会进入函数内部跟踪。</p><div class=pgc-img><img alt=gdb实用的调试技巧：启动方式、堆栈信息、单步调试 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/bd81f4edb8de44ef87cff2ad6fab7b24><p class=pgc-img-caption></p></div><p style=text-align:start>那么如果想要进入函数，怎么办呢，可以使用s命令（step）来进入函数内部进行单步调试。</p><div class=pgc-img><img alt=gdb实用的调试技巧：启动方式、堆栈信息、单步调试 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d68c70e0c0b14798abb91d43bde09a80><p class=pgc-img-caption></p></div><p style=text-align:start>如果函数内部太长，不想要跟踪，那么可以输入命令finish， 直接跳出函数，注意该命令会执行完成函数之后，再退出。</p><div class=pgc-img><img alt=gdb实用的调试技巧：启动方式、堆栈信息、单步调试 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/016574e5976e4639af868c57cc6fdf1c><p class=pgc-img-caption></p></div><p style=text-align:start>而跳出函数，还有另一个命令return, 但是它不会执行完成函数再退出，而是直接退出。</p><div class=pgc-img><img alt=gdb实用的调试技巧：启动方式、堆栈信息、单步调试 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6d950f4234654cecb59beaa436e85882><p class=pgc-img-caption></p></div><p style=text-align:start>最后补充一个查看局部变量的命令: info locals 。在断点位置的时候，使用该命令查看局部变量，有助于提高定位问题的效率。</p><h1 class=pgc-h-arrow-right>总结</h1><p style=text-align:start>本文梳理了gdb的常用调试技巧，分别从三个方面进行说明，分别为三种启动、两种堆栈以及两种技巧。启动方式比较常用的是采用-p选项，将gdb附着到程序中。查看堆栈信息的命令bt适用于程序崩溃的问题，thread apply all bt命令则可以查看所有线程的堆栈信息。watch命令跟踪变量的变化情况。next则执行单步运行，但是不进入函数内部，step则会进入函数内部； 命令finish可以跳出函数，但是它会执行完成函数之后再退出；而命令return, 则不会执行完成函数，而是马上就退出。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'调试','gdb','实用'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>