<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>五分钟为你梳理对称加密体系 | 极客快訊</title><meta property="og:title" content="五分钟为你梳理对称加密体系 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/a84de052e01a4d628c1716f06b18842e"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/888bca57.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/888bca57.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/888bca57.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/888bca57.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/888bca57.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/888bca57.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/888bca57.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/888bca57.html><meta property="article:published_time" content="2020-11-14T20:50:52+08:00"><meta property="article:modified_time" content="2020-11-14T20:50:52+08:00"><meta name=Keywords content><meta name=description content="五分钟为你梳理对称加密体系"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/888bca57.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>五分钟为你梳理对称加密体系</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>科学</a></span></div><div class=post-content><div><div class=pgc-img><img alt=五分钟为你梳理对称加密体系 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a84de052e01a4d628c1716f06b18842e><p class=pgc-img-caption></p></div><p>数据泄露事件频繁被曝光，还有很多很多大大小小没有被公布的安全事件，都说明了数据加密和保护的重要性。只要有收集或者存储客户数据行为的产品，都需要做好安全保密工作，而且加密不仅仅是因为保护用户隐私，更是法律法规的要求，不得不做。今天就来梳理对称加密体系----一种最简单快速的加密。</p><div class=pgc-img><img alt=五分钟为你梳理对称加密体系 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f33da80831e049ebb2b071aaf6e76a5b><p class=pgc-img-caption>对称加密体系</p></div><h1><strong>什么是对称加密：</strong></h1><p>同一个密钥可以同时用来对信息进行加密和解密操作，这种加密方法称为对称加密，也称为单密钥加密。数据发送方将明文原始数据和加密密钥一起经过特殊加密算法处理后，使其变成复杂的加密密文发送出去。接收方收到密文后，若想解读，则需要使用加密用过的密钥及相同算法的逆算法对密文进行解密，才能使其恢复成可读明文。在对称加密算法中，使用的密钥只有一个，收发双方都使用这个密钥对该条数据进行加密和解密。</p><h1><strong>对称加密算法的优劣：</strong></h1><p>对称加密算法的特点是计算量小、加密速度快、加密效率高，适合对大量数据进行加密的场景。</p><p>不足之处是，交易双方都使用同样密钥，所以对称加密的安全性就不仅仅取决于加密算法本身，更取决于密钥是否被安全的保管和传输，因此加密发送方如何把密钥安全地传递到解密接收方手中，才是对称加密面临的关键问题。</p><p>此外，每对用户每次使用对称加密算法时，都需要使用其他人不知道的惟一密钥，这会使得发收信双方所拥有的钥匙数量呈几何级数增长，密钥管理成为用户的负担。</p><h1><strong>一般原理</strong></h1><p>举个生活中的简单例子来简要说明一下对称加密的工作过程。甲和乙是一对生意伙伴，他们住在不同的城市。由于生意上的需要，他们经常会相互之间邮寄重要的货物。为了保证货物的安全，他们商定为每次需要配送的货物打造一个保险箱，将货物放入保险箱中，并为保险箱打造两把相同的钥匙分别保管，这样一人可以在邮寄货物前用这把钥匙锁上保险箱，另一人在收到包裹时用这个钥匙可打开保险箱。同时如果甲有了新的生意伙伴丙，为了防止货物被盗取，他和丙会制作不同的保险箱，同时打造跟甲乙之前使用的钥匙不同的钥匙来对保险箱上锁和开锁。</p><p>在这个简单的例子中，钥匙就相当于双方用于加解密的密钥，每次配送的货物就可类比于每条消息包，这个例子同时也说明了，每队用户每次使用对称加密算法，都需要使用其他人不知道的唯一密钥，这会使得收、发双方所拥有的钥匙数量巨大，密钥管理成为双方的负担。</p><p>上面是一个将重要资源安全传递到目的地的传统方式，只要甲乙丙小心保管好钥匙，那么就算有人得到保险箱，也无法打开保险箱窃取货物。这个思想被用到了通信过程的信息加密中。在对称加密中，数据发送方将明文（原始数据）和加密密钥一起经过特殊加密算法处理后，使其变成复杂的加密密文发送出去。接收方收到密文后，若想解读原文，则需要使用相同的加密密钥及相同算法的逆算法对密文进行解密，才能使其恢复成可读明文。</p><h1><strong>对称加密算法的前世今生</strong></h1><p>按照原理不同，对称加密可以大体分成流加密和分组加密两种类型。</p><p><strong>流加密</strong></p><p>流加密是将明文按字符逐位地，对应地进行加密的一类对称密码算法。流加密中最有名的算法是RC4和GSM。流加密算法相对简单，明文和密钥按位对其做约定的运算，即可获得密文。</p><p>加密过程：首先生成一个对称秘钥，使用用户公钥加密这个对称秘钥后存储在文件头，然后用生成的对称秘钥加密文件数据存储。</p><p>解密过程：首先使用自己的私钥解密被加密的对称秘钥，再用该对称秘钥解密出数据原文。</p><p>最简单的模型是异或流加密例如：</p><div class=pgc-img><img alt=五分钟为你梳理对称加密体系 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/e82aff46e22c4c82a64a26b7f2a30b29><p class=pgc-img-caption>异或流加密</p></div><p>由于流加密原理简单，其算法结构存在弱点，如果密钥流又多次重复使用，只要泄露局部明文，攻击者很容易算出密钥。另外，由于是按位进行加密，攻击者即使对数据进行篡改，也不会破坏原有数据结构，接收者很难发现其中变化。</p><p>因此流加密虽然是一种快捷高效的加密方法，但其安全性较低，不建议用户使用流加密对关键信息进行加密。</p><p><strong>分组加密</strong></p><p>分组密码是将明文消息编码表示后的数字（简称明文数字）序列，划分成长度为n的组（可看成长度为n的矢量），每组分别在密钥的控制下变换成等长的输出数字（简称密文数字）序列。</p><p>现代分组密码的研究始于20世纪70年代中期，至今已有40余年历史，这期间人们在这一研究领域已经取得了丰硕的研究成果。</p><p>对于分组密码，在早期的研究，基本上是围绕DES进行的，推出了一些类似的算法，例如：LOKI，FEAL，GOST等。</p><p>分组加密内部实现则复杂的多，每一个加密块都会经历至少16轮运算，其代表算法有DES和AES。目前推荐使用AES，DES已经不在安全。</p><p><strong>DES</strong></p><p>DES是较早时期的对称加密标准，在当时得到了广泛的应用。随着计算机性能地不断提高，暴力破解DES变得越来越容易。所以DES已经不再安全，近十多年已逐渐被3DES和AES代替。</p><p>DES核心主要分成初始置换、轮函数、逆置换三步。</p><p><strong>初始置换：</strong>把输入的64位数据块按位重新组合，并把输出分为L0、R0两部分，每部分长32位，其置换规则为将输入的第58位换到第1位，第50位换到第2位……依此类推，最后一位是原来的第7位。L0、R0则是换位输出后的两部分，L0是输出的左32位，R0是右32位，其置换规则见下表：</p><p>58,50,42,34,26,18,10,2,60,52,44,36,28,20,12,4,</p><p>62,54,46,38,30,22,14,6,64,56,48,40,32,24,16,8,</p><p>57,49,41,33,25,17,9,1,59,51,43,35,27,19,11,3,</p><p>61,53,45,37,29,21,13,5,63,55,47,39,31,23,15,7,</p><p><strong>轮函数：</strong>DES 使用一个 56 位的密钥以及附加的 8 位奇偶校验位（每组的第8位作为奇偶校验位），产生最大 64 位的分组大小。这是一个迭代的分组密码，使用称为 Feistel 的技术，其中将加密的文本块分成两半。使用子密钥对其中一半应用循环功能，然后将输出与另一半进行“异或”运算；接着交换这两半，这一过程会继续下去，但最后一个循环不交换。</p><p><strong>逆置换：</strong>DES 使用 16 轮循环，使用异或、置换、代换、移位操作四种基本运算。最后经过16次迭代运算后，得到L16、R16，将此作为输入进行逆置换，逆置换正好是初始置换的逆运算，由此即得到密文输出，解密过程则是整套加密过程的逆运算。</p><p><strong>AES</strong></p><p>AES的诞生是为了替代原先的DES，它已经被多方分析论证，在全世界范围广泛使用，近十年，AES已然成为对称密钥加密中最流行的算法之一。不同于它的前任标准DES，AES使用的是代换-置换（SP）网络，而非Feistel架构，SP网络从理论上给出了最大差分特征概率和最佳线性逼近优势的界，证明了密码对差分密码分析和线性密码分析的安全性。</p><p>大多数AES计算是在一个特别的有限域内完成的，加密过程是在一个4×4的字节矩阵上运作，这个矩阵又称为“状态（state）”，其初值就是一个明文区块（矩阵中一个元素大小就是明文区块中的一个Byte）。加密时，各轮AES加密循环（除最后一轮外）均包含4个步骤：</p><p>AddRoundKey——矩阵中的每一个字节都与该次轮密钥（round key）做XOR运算；每个子密钥由密钥生成方案产生。</p><p>SubBytes——通过一个非线性的替换函数，用查找表的方式把每个字节替换成对应的字节。</p><p>ShiftRows——将矩阵中的每个横列进行循环式移位。</p><p>MixColumns ——为了充分混合矩阵中各个直行的操作。这个步骤使用线性转换来混合每列的四个字节。最后一个加密循环中省略MixColumns步骤，以另一个ddRoundKey取代。</p><h1><strong>国家商用密码是如何实现的</strong></h1><p>商用密码的应用领域十分广泛，主要用于对不涉及国家秘密内容但又具有敏感性的内部信息、行政事务信息、经济信息等进行加密保护。比如：商用密码可用于企业门禁管理、企业内部的各类敏感信息的传输加密、存储加密，防止非法第三方获取信息内容；也可用于各种安全认证、网上银行、数字签名等。</p><p><strong>SM4</strong></p><p>2006年我国公布了无线网络中使用的SM4密码算法。这是我国第一次公布自己的商用密码算法。</p><div class=pgc-img><img alt=五分钟为你梳理对称加密体系 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1c18a4eadb0c4d799d9cb0f9825944af><p class=pgc-img-caption>SM4算法的整体结构</p></div><p>国际的DES算法和国产的SM4算法的目的都是为了加密保护静态储存和传输信道中的数据，主要特性如下：</p><div class=pgc-img><img alt=五分钟为你梳理对称加密体系 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f815e3f892ce44f49a13d6b91cc99134><p class=pgc-img-caption>SM4算法与DES算法的对比</p></div><p>从算法上看，国产SM4算法在计算过程中增加非线性变换，理论上能大大提高其算法的安全性，并且由专业机构进行了密码分析，民间也对21轮SM4进行了差分密码分析，结论均为安全性较高。</p><p>综合以上分析，国内一款即时通信系统安司源密信就采用了高强度的对称加密算法SM4，对个人产生的数据、传输的IM消息和附件、服务器存储的数据进行有效的加密处理，有效提高了数据在网络传输过程中的安全性、终端和服务器上存储的安全性，实现了业务数据的端到端加密。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'钟为','对称','体系'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>