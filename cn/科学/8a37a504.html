<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>深度讲解支持向量机背后的数学思想 | 极客快訊</title><meta property="og:title" content="深度讲解支持向量机背后的数学思想 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/b3099f2d15b644cfa1f2c82cbfe7c5b8"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/8a37a504.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/8a37a504.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/8a37a504.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/8a37a504.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/8a37a504.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/8a37a504.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/8a37a504.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/8a37a504.html><meta property="article:published_time" content="2020-10-29T21:13:01+08:00"><meta property="article:modified_time" content="2020-10-29T21:13:01+08:00"><meta name=Keywords content><meta name=description content="深度讲解支持向量机背后的数学思想"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/8a37a504.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>深度讲解支持向量机背后的数学思想</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>科学</a></span></div><div class=post-content><div><p><strong>在支持向量机（support vector machine，SVM）算法中，有诸多数学思想。学习SVM是一个非常好的实践数学思想的过程，为我们以后创新解决问题思路提供了启发。</strong></p><blockquote><p>在卷积神经网络兴起之前，在机器学习界一直是非常受追捧的算法，不光是因为其有良好的泛化能力、很高的准确度，更是因为其完备的数学理论依据以及诸多较难理解的数学知识。这两点让人们觉得SVM是一个很精妙很酷的算法！所以在实际应用也非常多。</p></blockquote><p>本文从头到尾阐述SVM从建模到求解过程中的数学思想，我们发觉SVM建模的出发点是非常简单的，通过了解其数学思想，对其一步一步为什么、怎么应用各种数学思想方法，变得越来越复杂的整个过程就有了非常清晰的了解。更重要的，我们对科学建模过程也有了充分了解，便于我们以后进行各种创新设计。SVM主要概括为：</p><ul><li><strong>理解SVM问题是通过简单的直觉和严谨的数学来约束最小化问题。</strong></li><li><strong>SVM问题应用拉格朗日方法来解决约束优化问题。</strong></li><li><strong>为了找到不同类别点之间最宽的间隔，最大化问题仅取决于点积。</strong></li></ul><p><strong>其背后的数学思想概括有下边要讲的四点，本文详细分析之。</strong></p><h1><strong>几何思想：简单直觉的理解世界</strong></h1><p><strong>SVM出发点是非常直觉的，那就是把二分类问题放到几何上理解。</strong></p><p>SVM最初的问题是：把二分类问题转化为在二维空间中，找到最佳分隔线，如下图所示：</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b3099f2d15b644cfa1f2c82cbfe7c5b8><p class=pgc-img-caption></p></div><p><strong>这个分隔线怎么找才最好，最直觉的思想就是"不偏不倚"，与两类样本点的边界保持相等的最远的距离。</strong></p><blockquote><p>这是一个非常直觉、非常朴素的直观感觉！作为一个比较难理解的算法，SVM发点竟然如何简单！这也给我们一个启发，那就是对于现实世界问题建模，刚开始一定要追求极简原则、直觉原则，为什么呢？因为越是简单，越容易检验正确与否，类似于几何中公理一样。</p></blockquote><p><strong>接下来，我们继续演绎，那就是在几何上，怎么表达"不偏不倚"？很显然，再一次直觉感知，那就是最大化间隔。</strong></p><p>我们希望找到这样一个决策边界，这个边界距离两类数据点最远。更进一步的，是距离两类数据点的边界最远，所以定义最接近边界的数据点定义为支持向量。最后，我们的目标变为找到这样一个直线（多维叫超平面）<strong>，它与支持向量有最大的间隔。</strong></p><h1><strong>抽象思维：由实际问题建模的数学思想</strong></h1><p><strong>抽象思维，是由实际问题抽象为数学模型的非常重要的思想。</strong></p><p>刚才我们已经把问题用几何说清楚了，接下来，仍然是用几何求解。为了表达这个距离（间隔），需要把现实世界中的这类问题抽象共性表达。所以我们进行若干设定：</p><ul><li>设这个平面用g(x)=0来表示，其法向量用w表示</li><li>点与平面实际距离为r</li><li>点与平面的距离可以用g(x)的绝对值来度量（称为函数间隔）</li></ul><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5d9aae377d5c458093c074da09f44b63><p class=pgc-img-caption></p></div><p>如上图所示，点x可以表示为：</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/19acb7331c5e44f6bb428ec3a554d7e1><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2ab2a70fe8234ceca2b57918f0ed2142><p class=pgc-img-caption></p></div><p>这是g(<em>x</em>)为正的情况，点x在平面一侧。</p><p>我们的目标就是求r最大化。函数间隔的取值并不影响最优解，假设将w,b按比例扩大a倍，函数间隔变为ag(x)，分母也变为原来的a 倍，上下抵消。对目标函数没有影响 ，因此为优化方便我们设函数间隔为 1。</p><p><strong>也意味着，支持向量边界被设定为g(x)=</strong> ±<strong>1，即间隔面。最后，间隔变为：</strong></p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/173f096587ee4a7d97152c1883c2eea9><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0a83c5a9b48d4c0eb219e14ac8b030a6><p class=pgc-img-caption></p></div><p>同时我们的约束是：</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d50ec865ab194b2bbdbac1d355cb954c><p class=pgc-img-caption></p></div><p>最后抽象后的数学问题变为：</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/683ac26963ed40df98ed2947778abde8><p class=pgc-img-caption></p></div><h1><strong>惩罚函数（因子）：提升系统的鲁棒容错能力</strong></h1><p>惩罚函数亦称处罚函数，是一类制约函数。对于约束非线性规划它的制约函数称为惩罚函数，系数称为惩罚因子 。是数学中非常重要的一种处理方法。</p><p>引入惩罚因子C的SVM（软间隔支持向量机）的目标函数为：</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ff0cbff4ea5648e3b97132446c8e60e9><p class=pgc-img-caption></p></div><p>这个做法非常精妙，体现非常精妙神奇的数学思维。</p><p>为什么要引入C？要理解参数C的意义，先要理解ξ的意义。如下图所示，</p><p>当样本点越过本类样本点的边界时，</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/0c03b35a4fb54b329d32ef8c2e53001d><p class=pgc-img-caption></p></div><p>时，点在分离超平面与本侧间隔面之间;</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/48ab706d126245acade92ec263f85916><p class=pgc-img-caption></p></div><p>时，点在超平面上；</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ed6d2c85320044a1a33f46813f5226a9><p class=pgc-img-caption></p></div><p>时，点在分离超平面与另一侧间隔面之间；</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f63694a4cfee495c9aff246e6b0b10e2><p class=pgc-img-caption></p></div><p>时，点在分离超平面误分一侧。</p><p><strong>所以，设置C就是为了对这些在边界地带误分的点，而这些点在现实世界是天然存在的，如果对于他们不进行容错（对应硬间隔支持向量机），那么我们是无论如何也不能把样本分开的。而引入惩罚因子，目的就是，对这类误分的样本进行容错，相当于把点拉到正确一侧。</strong></p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/230ca0416ae54987b7e635e357c6eaf8><p class=pgc-img-caption></p></div><p>具体分析之，我们要最小化目标函数：</p><p>①当C很大时，ξ趋近于0，结合上图和上边的解释，分离超平面被边界的点朝相反类别一侧挤压，换句话说：<strong>惩罚很大，容忍度很低，错分较少</strong>，对样本的拟合性较好，但容易过拟合；</p><p>②C的变小时，ξ开始变大，结合上图和上边的解释，处于两个间隔面之间的点（甚至另一侧）变多，错分较多，对样本的拟合性下降。</p><p>所以要权衡折中。</p><h1><strong>转化思想：转化为容易解决的问题</strong></h1><p><strong>转化思想，是数学中最为灵魂、最为常用的思想。</strong></p><p>这里主要讲的对于SVM目标函数求解用到了拉格朗日对偶与KKT条件，如果不太了解拉格朗日对偶与KKT条件，可以参考本头条号文章《<strong>深入讲解强弱对偶理论与KKT条件</strong>》视频《<strong>形象直观理解KKT条件</strong>》。</p><p>我们已经得到SVM的目标函数（以硬间隔为例）：</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ede47637bdc649d28cce2331a96f6420><p class=pgc-img-caption></p></div><p>对于求解不等式约束的问题，我们转化为求其对偶问题，这个对应的对偶问题是：</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/5587a94d43e94f1881dc48a8d0ac05a3><p class=pgc-img-caption></p></div><p>其中</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/cf9a118f3347429c9a70ea7444b68041><p class=pgc-img-caption></p></div><p>最终我们得到目标函数如下，由我个变量变为只有一个变量：</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9806e9bbb8564ab88d1ba3c40ea32b54><p class=pgc-img-caption></p></div><h1><strong>核思想：升维的同时避免维度灾难带来的复杂计算</strong></h1><p><strong>目标函数中有点积：</strong></p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b3a5db92d90140a487cb3cb3027d36cb><p class=pgc-img-caption></p></div><p>不仅如此，因为决策函数还取决于支持向量和新样本的点积：</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/63fe7a544b1746f7a66d8e4b0bffdf8f><p class=pgc-img-caption></p></div><p>这意味着如果我们使用将数据映射到更高维度空间的映射函数，那么最大化和决策函数取决于不同样本的映射函数的点积，那么我们只需要知道K而不是映射函数本身。这就是<strong>核函数</strong>，它降低了寻找映射函数的复杂性。<strong>核函数定义了转换空间中的内积。</strong></p><p>对于核函数的透彻理解，请参考本头条号另一文章《透彻形象理解核函数》，本文仅以高斯核函数作为举例，推导其映射函数：</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3911c2b2647e4789ac75defbb72e55cf><p class=pgc-img-caption></p></div><p>其映射函数为：</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/cc53690d6e114248b806f89d4ac6ac2a><p class=pgc-img-caption></p></div><p>可以映射到无穷维。看核函数，注意到它取决于两点之间的欧几里德距离，即如果两个矢量更接近则该项很小。由于方差总是正的，这意味着对于更接近的向量，其值更大。当伽马参数高时，核函数的值将更小，即使对于非常靠近两个样本，这可能导致复杂的决策边界或引起过度拟合。如下图所示：</p><div class=pgc-img><img alt=深度讲解支持向量机背后的数学思想 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/bb5e8a066d394ec3919ee78780356d68><p class=pgc-img-caption></p></div></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'讲解','机背','数学'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>