<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>案例详解：理解Python中的“解析式” | 极客快訊</title><meta property="og:title" content="案例详解：理解Python中的“解析式” - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/ab562c1c1a6b4e3b9f3a87d1157fabda"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/8be1643.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/8be1643.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/8be1643.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/8be1643.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/8be1643.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/8be1643.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/8be1643.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/8be1643.html><meta property="article:published_time" content="2020-10-29T20:55:16+08:00"><meta property="article:modified_time" content="2020-10-29T20:55:16+08:00"><meta name=Keywords content><meta name=description content="案例详解：理解Python中的“解析式”"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/8be1643.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>案例详解：理解Python中的“解析式”</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>科学</a></span></div><div class=post-content><div><blockquote>全文共<strong>2568</strong>字，预计学习时长<strong>5</strong>分钟或更长</blockquote><div class=pgc-img><img alt=案例详解：理解Python中的“解析式” onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ab562c1c1a6b4e3b9f3a87d1157fabda><p class=pgc-img-caption>图片来源：Pixabay/Gerd Altmann</p></div><p class=ql-align-justify>本篇文章将详细介绍解析式的基本要素及其各种形式。</p><p class=ql-align-justify><br></p><div class=pgc-img><img alt=案例详解：理解Python中的“解析式” onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/db539eb3a9934511adfd2b521ce74d89><p class=pgc-img-caption></p></div><p class=ql-align-center><strong>Python中的解析式</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>解析式是允许在其他序列中构建序列的结构。Python 2.0介绍了列表解析式的概念，Python 3.0中进一步介绍了字典和集合解析式。</p><div class=pgc-img><img alt=案例详解：理解Python中的“解析式” onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/90088a5daf424de6817dd49b7c074393><p class=pgc-img-caption>Pyhon中的解析式类型</p></div><p class=ql-align-justify>为什么解析式如此强大？本文将通过一个例子试着理解这一点。大家都知道Python提供了各种表达列表的方法。例如：</p><p class=ql-align-justify><br></p><p class=ql-align-justify>· 可以明确地将整件事写成：</p><p class=ql-align-justify>squares = [0, 1, 4, 9, 25]</p><p class=ql-align-justify><br></p><p class=ql-align-justify>· 或者，编写for循环以创建列表:</p><p class=ql-align-justify>squares = []</p><p class=ql-align-justify>for num in range(6):</p><p class=ql-align-justify>squares.append(num*num)</p><p class=ql-align-justify><br></p><p class=ql-align-justify>· 创建列表的另一种方法是使用单行代码。</p><p class=ql-align-justify>squares = [num*num for num in range(6)]</p><p class=ql-align-justify><br></p><p class=ql-align-justify>上面的这个单行叫做列表解析式，是创建列表的便捷方式。它不再依赖循环并精简了代码。下一部分将深入探讨列表的概念以及Python 3中提供的其他类型的解析式。</p><p class=ql-align-justify><br></p><div class=pgc-img><img alt=案例详解：理解Python中的“解析式” onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/db539eb3a9934511adfd2b521ce74d89><p class=pgc-img-caption></p></div><p class=ql-align-center><strong>列表解析式</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>列表解析式是一种以简洁的方式在Python中定义和创建列表的方法。大多数情况下，列表解析式可以仅在一行代码中创建列表，无需担心初始化列表或设置循环。</p><p class=ql-align-justify><br></p><p class=ql-align-justify>列表解析式包括以下几个部分：</p><div class=pgc-img><img alt=案例详解：理解Python中的“解析式” onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/170e1c6b45e040fb816b0fb36ed62223><p class=pgc-img-caption>列表解析式的各个部分</p></div><p class=ql-align-justify>比如说，需要找到前五个偶数的平方。如上一节所示，有两种方法可以做到这一点：使用显式的for循环或使用列表解析式。两种方法都试试看吧。</p><p class=ql-align-justify><br></p><p class=ql-align-justify>· 使用循环</p><p>even_squares = []</p><p>>>> for num in range(11):</p><p>... if num%2 == 0:</p><p>... even_squares.append(num * num)>>> even_squares</p><p>[0, 4, 16, 36, 64, 100]</p><p class=ql-align-justify><br></p><p class=ql-align-justify>· 使用列表解析式</p><p>even_squares = [num * num for num in range(11) if num%2 == 0]</p><p>even_squares</p><p>[0, 4, 16, 36, 64, 100]</p><p class=ql-align-justify><br></p><p class=ql-align-justify>如果仔细观察，可以看出只需重新排列For循环就可以创建列表解析式。</p><div class=pgc-img><img alt=案例详解：理解Python中的“解析式” onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a9323b3a363c43cc827d7d6601ed0d7f><p class=pgc-img-caption></p></div><p class=ql-align-justify>列表解析式是Python中对集合应用的一种符号表示方法，就好像数学中用到的集合表示方法。</p><div class=pgc-img><img alt=案例详解：理解Python中的“解析式” onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/878d19af071146148a4b6610d35487bc><p class=pgc-img-caption>与数学中集合的相似性</p></div><p class=ql-align-justify>一起实践尝试并看一些在列表解析式帮助下创建列表的例子吧。</p><p class=ql-align-justify><br></p><p class=ql-align-justify>创造毕达哥拉斯三元数组</p><p class=ql-align-justify><br></p><p class=ql-align-justify>毕达哥拉斯三元数组由三个正整数a，b和c组成，而且a²+b²=c²。通常这样的三元数组写成（a，b，c）的形式，例如（3,4,5）。</p><p class=ql-align-justify><br></p><p>[(a,b,c) for a in range(1,30) for b in range(1,30) for c in range(1,30)if a**2 + b**2 == c**2][(3, 4, 5), (4, 3, 5), (5, 12, 13), (6, 8, 10), (7, 24, 25), (8, 6, 10), (8, 15, 17), (9, 12, 15), (10, 24, 26), (12, 5, 13), (12, 9, 15), (12, 16, 20), (15, 8, 17), (15, 20, 25),(16, 12, 20), (20, 15, 25),(20, 21, 29), (21, 20, 29), (24, 7, 25), (24, 10, 26)]</p><p class=ql-align-justify><br></p><div class=pgc-img><img alt=案例详解：理解Python中的“解析式” onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/db539eb3a9934511adfd2b521ce74d89><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-center><strong>带字符串的列表解析式</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>· 将字符串中的小写字母转换为大写字母。</p><p>colors = ["pink", "white", "blue", "black", purple"]</p><p>[color.upper() for color in colors]</p><p>['RED', 'GREEN', 'BLUE', 'PURPLE']</p><p class=ql-align-justify><br></p><p class=ql-align-justify>· 交换给定列表中的名和姓。</p><p>presidents_usa = ["George Washington", "John Adams","Thomas Jefferson","James Madison","James Monroe","John Adams","Andrew Jackson"]split_names = [name.split(" ") for name in presidents_usa]</p><p>swapped_list = [split_name[1] + " " + split_name[0] for split_name in split_names]swapped_list['Washington George', 'Adams John', 'Jefferson Thomas', 'Madison James', 'Monroe James', 'Adams John', 'Jackson Andrew']</p><p class=ql-align-justify><br></p><p class=ql-align-justify>含有元组的列表解析式</p><p class=ql-align-justify><br></p><p class=ql-align-justify>如果表达式包含元组（例如（x，y）），则必须用括号括起来。</p><p># Convert height from cms to feet using List Comprehension : 1 cm = 0.0328 feetheight_in_cms = [('Tom',183),('Daisy',171),('Margaret',179),('Michael',190),('Nick',165)]height_in_feet = [(height[0],round(height[1]*0.0328,1)) for height in height_in_cms]height_in_feet[('Tom', 6.0), ('Daisy', 5.6), ('Margaret', 5.9), ('Michael', 6.2), ('Nick', 5.4)]</p><p class=ql-align-justify><br></p><div class=pgc-img><img alt=案例详解：理解Python中的“解析式” onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/db539eb3a9934511adfd2b521ce74d89><p class=pgc-img-caption></p></div><p class=ql-align-center><strong>嵌套列表解析式</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>列表解析式也可以嵌套以创建复杂的列表。例如，可以仅使用列表解析式来构建矩阵。</p><p class=ql-align-justify><br></p><p class=ql-align-justify>· 构建一个3x3的矩阵</p><p>matrix = [[j * j+i for j in range(3)] for i in range(3)]</p><p>matrix[[0, 1, 4], [1, 2, 5], [2, 3, 6]]</p><p class=ql-align-justify><br></p><div class=pgc-img><img alt=案例详解：理解Python中的“解析式” onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/db539eb3a9934511adfd2b521ce74d89><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-center><strong>集合解析式</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>集合解析式类似于列表解析式，但返回的是集合而不是列表。意义上来说语法略有不同，创建集合解析式用花括号而不是方括号。</p><p class=ql-align-justify><br></p><p class=ql-align-justify>思考包含以下人名的列表：</p><p>names = [ 'Arnold', 'BILL', 'alice', 'arnold', 'MARY', 'J', 'BIll' ,'maRy']</p><p class=ql-align-justify>该列表包含许多重复项，并且有的名字只有一个字母。目前想要的是一个由长于一个字母且仅首字母大写的名字组成的列表。为了完成这项任务，采用了集合解析式。</p><p>{name.capitalize() for name in names if len(name) > 1}{'Alice', 'Arnold', 'Bill', 'Mary'}</p><p class=ql-align-justify><br></p><div class=pgc-img><img alt=案例详解：理解Python中的“解析式” onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/db539eb3a9934511adfd2b521ce74d89><p class=pgc-img-caption></p></div><p class=ql-align-center><strong>字典解析式 { }</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>当输入采用字典或键：值对的形式时，使用字典解析式。例如，思考这样一个字典，其中键表示字符，值表示这些字符出现在语料库中的次数。</p><p>char_dict = {'A' : 4,'z': 2, 'D' : 8, 'a': 5, 'Z' : 10 }</p><p class=ql-align-justify><br></p><p class=ql-align-justify>字典char_dict由大写和小写字母组成。在此想要计算字母的总出现次数，不管它们是大写还是小写。本文使用字典解析式来实现这个目标：</p><p>{ k.lower() : char_dict.get(k.lower(), 0) + char_dict.get(k.upper(), 0) for k in char_dict.keys()}{'a': 9, 'z': 12, 'd': 8}</p><p class=ql-align-justify><br></p><div class=pgc-img><img alt=案例详解：理解Python中的“解析式” onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/db539eb3a9934511adfd2b521ce74d89><p class=pgc-img-caption></p></div><p class=ql-align-center><strong>生成器解析式 ( )</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>列表解析是列表，因为生成器表达式是生成器。生成器函数从给定序列一次一个地输出值，而不是一次性全部输出。这是一篇很好的文章，它解释了Python中Generators的细节。</p><p class=ql-align-justify><br></p><p class=ql-align-justify>生成器解析式的语法和工作方式就像列表解析式一样，只不过它们使用圆括号而不是方括号。假设想要计算前十个自然数的平方和。</p><p class=ql-align-justify><br></p><p># Sum of first ten natural numbers using List Comprehensionssum([num**2 for num in range(11)])</p><p>385</p><p class=ql-align-justify><br></p><p class=ql-align-justify>如果我们使用任何其他可迭代而不一定是列表，结果将是相同的。</p><p>sum({num**2 for num in range(11)})</p><p>385</p><p class=ql-align-justify><br></p><p class=ql-align-justify>现在，如果使用生成器解析式来计算前十个自然数的平方，那么它将是这样的：</p><p>squares = (num**2 for num in range(11))</p><p>squaressquares</p><p>&lt;generator object &lt;genexpr> at 0x1159536d8></p><p class=ql-align-justify><br></p><p class=ql-align-justify>与列表解析式不同，生成器解析式不返回列表而是返回生成器对象。为了得到结果，可以使用上面的表达式和sum函数。</p><p>sum(n ** 2 for n in numbers)</p><p>385</p><p class=ql-align-justify><br></p><p class=ql-align-justify>看看如何摆脱上面表达式中的冗余括号，使代码更有效。</p><p class=ql-align-justify><br></p><div class=pgc-img><img alt=案例详解：理解Python中的“解析式” onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/db539eb3a9934511adfd2b521ce74d89><p class=pgc-img-caption></p></div><p class=ql-align-center><strong>最后，不要过度使用解析式</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>列表解析式是减少代码长度的有效方法。它们还使代码更具可读性。但有些情况下不用它也能轻松地达成目的。</p><p class=ql-align-justify><br></p><p class=ql-align-justify>当程序的逻辑太长时，不建议使用解析式。使用解析式的主要目的是缩短代码。但是，当开始将过多的代码打包到单个语句中时，倾向于牺牲代码的可读性。在这种情况下，for循环是更优选择。</p><p class=ql-align-justify><br></p><div class=pgc-img><img alt=案例详解：理解Python中的“解析式” onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/51a0170479ca4cce89578b7b9a29d4c6><p class=pgc-img-caption></p></div><p class=ql-align-center><strong>留言 点赞 关注</strong></p><p class=ql-align-center><strong>我们一起分享AI学习与发展的干货</strong></p><p class=ql-align-center>编译组：胡昕彤、蒋馨怡</p><p class=ql-align-center>相关链接：</p><p class=ql-align-center>https://towardsdatascience.com/comprehending-the-concept-of-comprehensions-in-python-c9dafce5111</p><p class=ql-align-center>如需转载，请后台留言，遵守转载规范</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'详解','Python','解析'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>