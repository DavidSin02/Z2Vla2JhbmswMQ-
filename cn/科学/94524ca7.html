<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>网络菜鸟笔记七 -第2层交换 | 极客快訊</title><meta property="og:title" content="网络菜鸟笔记七 -第2层交换 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/3bfc7cba68cb4160bdf3155f6a8d388e"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/94524ca7.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/94524ca7.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/94524ca7.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/94524ca7.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/94524ca7.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/94524ca7.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/94524ca7.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/94524ca7.html><meta property="article:published_time" content="2020-11-14T20:50:24+08:00"><meta property="article:modified_time" content="2020-11-14T20:50:24+08:00"><meta name=Keywords content><meta name=description content="网络菜鸟笔记七 -第2层交换"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/94524ca7.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>网络菜鸟笔记七 -第2层交换</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>科学</a></span></div><div class=post-content><div><p>小编今天和大家一起讨论一下第2层交换：</p><p><strong>交换式服务：</strong>根网桥使用软件来创建和管理过滤表不一样，交换机使用专用继承电路来创建并维护其过滤表。</p><p><strong>第二层交换提供的性能：</strong></p><p>1． 基于硬件的桥接 2． 线速率 3． 低延迟 4． 低成本</p><p><strong>第二层交换的局限性</strong></p><p>要用网桥设计出一个好的网络，就必须考虑到下面两个最重要的方面：</p><p>1． 必须绝对正确的分隔出冲突域。</p><p>2． 创建一个功能强大的侨界网络的正确方法是，确信其用户在本地网段上花费了80%的时间。</p><p>桥接的网络能够分隔冲突域，但是要记住，网络仍然是一个大的广播域。默认时，第二层交换机和网桥都不能分隔广播域-这不仅限制了网络的规模和增长潜力，还降低了他的整体性能。</p><p><strong>桥接与LAN交换的比较</strong></p><p>他们之间的区别：</p><p>1． 网桥是基于软件的，而交换机是基于硬件的，因为交换机使用ASIC芯片来帮助做出过滤得决定。</p><p>2． 交换机可以看成是多端口的网桥</p><p>3． 每个网桥只有一个省成熟实例，而交换机可以有许多生成树实例。</p><p>4． 交换机的端口数量比大多数的网桥都多。</p><p>5． 网桥和交换机都转发第二层广播。</p><p>6． 通过检查所接收的每个数据帧的源地址，网桥和交换机就学到了MAC地址。</p><p>7． 网桥和交换机都基于第二层地址做出转发的决定。</p><p><strong>第二层的三种交换功能</strong></p><p>1． 地址学习 通过查看帧的源MAC地址来加进1个叫做转发/过滤表的MAC地址数据库里</p><p>2． 转发/过滤决定 当1个接口收到1个帧的时候,switch在MAC地址数据库里查看目标MAC地址和出口接口,然后转发到符合条件的那个目标端口去</p><p>3． 避免环路 假如有冗余的连接,可能会造成循环的产生,STP就用来破坏这些循环</p><p><strong>生成树协议</strong></p><p>生成树术语</p><p>1． STP 2． 根桥（Root bridge） 3． BPDU 4． 桥ID 5． 非根桥 6． 根端口 7． 指定端口 8． 端口开销 9． 非指定端口 10． 转发端口 11． 阻塞端口</p><p><strong>生成树的操作</strong></p><p>STP的任务是找到网络中的所有链路，并关闭任何冗余的链路，这样就可以防止网络环路的产生。STP首先选举一个根桥，由根桥来负责决定网络拓扑。一旦所有的交换机都同意将某台交换机选举为根桥，其余的每台交换机就必须找到其根端口。如果在交换机之间有多条链路，就只能由唯一的一个指定端口。</p><p><strong>选举根桥</strong></p><p>在网络中，桥ID用来选举根桥，并决定根端口。</p><p>只需要记住，在选举根桥时值越低越好。</p><p><strong>选择指定端口</strong></p><p>如果有多条链路连接到根端口，那么，断口开销就变成了决定哪一个端口将成为根端口的依据。</p><p>各种Ethernet网络的典型开销</p><div class=pgc-img><img alt="网络菜鸟笔记七 -第2层交换" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3bfc7cba68cb4160bdf3155f6a8d388e><p class=pgc-img-caption></p></div><p><strong>生成树端口状态</strong></p><p>对于运行STP的网桥或交换机，其端口状态会有下列5种状态之间转变：</p><p>1． 阻塞 2． 监听 3． 学习 4． 转发 5． 禁用</p><p><strong>收敛</strong></p><p>当网桥或交换机转变到转发或阻塞状态时，就会产生收敛，再此期间，不会转发任何数据。</p><p><strong>LAN交换机的工作方式</strong></p><p>1． 直通转发 在这种工作方式下，在交换机查看MAC地址过滤表中的目的地址之间，交换机等待接收目的硬件地址。</p><p>2． 碎片丢弃 在这种方式下，交换机在转发帧之前，先检查帧的前64个字节，看它是不是碎片，由此保证不会转发可能产生冲突的帧。</p><p>3． 存储转发 在这种工作方式下，交换机接收整个数据帧，放在其缓冲区内，并运行CRC，然后查看在MAC过滤表中的目的地址。</p><p><strong>配置交换机</strong></p><p>当1900启动后,先运行POST,此时每个端口的发光二级管(LEDs)是绿色的,当POST完成后,LEDs开始闪烁然后熄灭;假如POST发现某个端口出问题了的话,系统LED和那个出问题的端口的LED开始变黄.假如你的console线缆接好了的话,POST开始显示菜单,如下:</p><p>1 user(s) now active on Management Console.</p><p>User Interface Menu</p><p>[M] Menus</p><p>[K] Command Line</p><p>[I] IP Configuration</p><p>Enter Selection:K</p><p>CLI session with the switch is open</p><p>To end the CLI session, enter [Exit].</p><p>></p><p>而2950的启动,有点像router,先进入setup模式.但是默认你可以不对其进行配置,启动如下:</p><p>--- System Configuration Dialog ---</p><p>Would you like to enter the initial configuration dialog? [yes/no]: no</p><p>Press RETURN to get started!</p><p>00:04:53: %LINK-5-CHANGED: Interface Vlan1, changed state to administratively down</p><p>00:04:54: %LINEPROTO-5-UPDOWN: Line protocol on Interface Vlan1, changed state to down</p><p>Switch></p><p>配置密码:</p><p>1.登陆密码(用户模式):防止未授权用户登陆</p><p>2.启用密码(特权模式):防止未授权用户修改配置</p><p>Setting the User Mode and Enable Mode Passwords</p><p>1900下,输入K进入CLI,输入enable进入特权模式,再输入config t进入全局配置模式,如下:</p><p>>en</p><p>#config t</p><p>(config)#</p><p>当进入全局配置模式后,使用enable password命令配置登陆密码个启用密码,如下:</p><p>(config)#enable password ?</p><p>level Set exec level password</p><p>(config)#enable password level ?</p><p><strong>&lt;1-15> Level Number</strong></p><p><strong>level1为登陆密码,level15为启用密码,密码长度范围是4到8字符之间</strong></p><p>2950下的配置和配置router有点类似,如下:</p><p>Switch>en</p><p>Switch#conf t</p><p>Switch(config)#line ?</p><p>&lt;0-16> First Line number</p><p>console Primary terminal line</p><p>vty Virtual terminal</p><p>Switch(config)#line vty ?</p><p>&lt;0-15> First Line number</p><p>Switch(config)#line vty 0 15</p><p>Switch(config-line)#login</p><p>Switch(config-line)#password noko</p><p>Switch(config-line)#line con 0</p><p>Switch(config-line)#login</p><p>Switch(config-line)#password noco</p><p>Switch(config-line)#exit</p><p>Switch(config)#exit</p><p>Switch#</p><p><strong>设置主机名</strong></p><p>给1900配置主机名,使用hostname命令,如下:</p><p>(config)#hostname SZ_Switch</p><p>SZ_Switch(config)#</p><p>给2950配置主机名,使用hostname命令,如下:</p><p>Switch(config)#hostname SZ_Switch</p><p>SZ_Switch(config)#</p><p><strong>设置IP信息</strong></p><p>你可以不配置IP信息,直接把线缆插进端口,一样可以工作.配置IP地址信息有2点原因:</p><p>1.通过telnet或其他软件方式来管理switch</p><p>2.配置VLANs和其他等网络功能</p><p>默认下,没有IP地址和默认网关信息配置,在1900下,使用show ip命令查看默认IP配置,如下:</p><p>1900#sh ip</p><p>IP Address: 0.0.0.0</p><p>Subnet Mask: 0.0.0.0</p><p>Default Gateway: 0.0.0.0</p><p>Management VLAN: 1</p><p>Domain name:</p><p>Name server 1: 0.0.0.0</p><p>Name server 2: 0.0.0.0</p><p>HTTP server: Enable</p><p>HTTP port: 80</p><p>RIP: Enable</p><p>在1900下使用ip address和ip default-gateway命令来配置IP地址信息和默认网关信息,如下:</p><p>1900(config)#ip address 172.16.10.16 255.255.255.0</p><p>1900(config)#ip default-gateway 172.16.10.1</p><p>1900(config)#</p><p>2950下的配置是在VLAN1接口下配置,VLAN1是管理VLAN,默认所有接口均是VLAN1的成员,配置如下:</p><p>2950(config)#int vlan1</p><p>2950(config-if)#ip address 172.16.10.17 255.255.255.0</p><p>2950(config-if)#no shut</p><p>2950(config-if)#exit</p><p>2950(config)#ip default-gateway 172.16.10.1</p><p>2950(config)#</p><p>注意2950的IP地址配置是在VLAN1接口下,另外要注意打开接口</p><p><strong>配置接口描述</strong></p><p>配置描述信息,在接口配置模式下使用description命令,1900下的描述信息不能使用空格键,如下:</p><p>1900(config)#int e0/1</p><p>1900(config-if)#description Cisco_VLAN</p><p>1900(config-if)#int f0/26</p><p>1900(config-if)#description trunk_to_building_4</p><p>1900(config-if)#</p><p>2950下的描述就可以使用空格键,如下:</p><p>2950(config)#int fa 0/1</p><p>2950(config-if)#description Sales Printer</p><p>2950(config-if)#^Z</p><p>可以使用show interface和show running-config命令来查看这些描述信息</p><p><strong>擦除交换机的配置</strong></p><p>1900和2950的配置文件是存储在NVRAM里的,但是1900里你不能查看NVRAM或startup-config的内容,只能查看running-config的内容,在1900里,你对配置所进行的修改自动被复制到NVRAM里,所以没有copy run start这样的命令;但是2950就有startup-config和running-config,使用copy run start来保存配置到NVRAM里,擦除2950里startup-config文件使用erase startup-config命令;擦除1900里的使用delete命令.如下:</p><p>1900#delete ?</p><p>nvram NVRAM configuration</p><p>vtp Reset VTP configuration to defaults</p><p>1900#delete nvram</p><p>2950如下:</p><p>2950#erase startup-config</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'网络','笔记','层交换'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>