<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° | æå®¢å¿«è¨Š</title><meta property="og:title" content="æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/1d9cd81ef1964685bc9d6f6ef3eba7ee"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/a9a3629.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/a9a3629.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/a9a3629.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/a9a3629.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/a9a3629.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/a9a3629.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/a9a3629.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/a9a3629.html><meta property="article:published_time" content="2020-10-29T21:03:51+08:00"><meta property="article:modified_time" content="2020-10-29T21:03:51+08:00"><meta name=Keywords content><meta name=description content="æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç°"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/a9a3629.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç°</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>ç§‘å­¦</a></span></div><div class=post-content><div><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1d9cd81ef1964685bc9d6f6ef3eba7ee><p class=pgc-img-caption></p></div><p>ä¼˜åŒ–æ˜¯æœºå™¨å­¦ä¹ é¢†åŸŸæœ€æœ‰è¶£çš„ä¸»é¢˜ä¹‹ä¸€ã€‚æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­é‡åˆ°çš„å¤§å¤šæ•°é—®é¢˜éƒ½æ˜¯é€šè¿‡æ•°å€¼ä¼˜åŒ–æ–¹æ³•è§£å†³çš„ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œè®©æˆ‘ä»¬ç ”ç©¶ä¸€äº›åŸºæœ¬çš„æ•°å€¼ä¼˜åŒ–ç®—æ³•ï¼Œä»¥æ‰¾åˆ°ä»»æ„ç»™å®šå‡½æ•°(è¿™å¯¹äºå‡¸å‡½æ•°æœ€æœ‰æ•ˆ)çš„å±€éƒ¨æœ€ä¼˜è§£ã€‚è®©æˆ‘ä»¬ä»ç®€å•çš„å‡¸å‡½æ•°å¼€å§‹ï¼Œå…¶ä¸­å±€éƒ¨å’Œå…¨å±€æœ€å°å€¼æ˜¯ç›¸åŒçš„ï¼Œç„¶åè½¬å‘å…·æœ‰å¤šä¸ªå±€éƒ¨å’Œå…¨å±€æœ€å°å€¼çš„é«˜åº¦éçº¿æ€§å‡½æ•°ã€‚</p><p>æ•´ä¸ªä¼˜åŒ–å›´ç»•çº¿æ€§ä»£æ•°å’Œå¾®ç§¯åˆ†çš„åŸºæœ¬æ¦‚å¿µå±•å¼€ã€‚æœ€è¿‘çš„æ·±åº¦å­¦ä¹ æ›´æ–°å¼•èµ·äº†æ•°å€¼å’Œéšæœºä¼˜åŒ–ç®—æ³•é¢†åŸŸçš„å·¨å¤§å…´è¶£ï¼Œä¸ºæ·±åº¦å­¦ä¹ ç½‘ç»œæ‰€å±•ç¤ºçš„æƒŠäººå®šæ€§ç»“æœæä¾›äº†ç†è®ºæ”¯æŒã€‚åœ¨è¿™äº›ç±»å‹çš„å­¦ä¹ ç®—æ³•ä¸­ï¼Œæ²¡æœ‰ä»»ä½•æ˜ç¡®å·²çŸ¥çš„ä¼˜åŒ–å‡½æ•°ï¼Œä½†æˆ‘ä»¬åªèƒ½è®¿é—®0é˜¶å’Œ1é˜¶çš„Oraclesã€‚Oraclesæ˜¯åœ¨ä»»ä½•ç»™å®šç‚¹è¿”å›å‡½æ•°å€¼ï¼ˆ0é˜¶ï¼‰ï¼Œæ¢¯åº¦ï¼ˆ1é˜¶ï¼‰æˆ–Hessianï¼ˆ2é˜¶ï¼‰çš„é»‘ç›’å­ã€‚æœ¬æœ¬æä¾›äº†å¯¹æ— çº¦æŸå’Œçº¦æŸä¼˜åŒ–å‡½æ•°çš„åŸºæœ¬ç†è®ºå’Œæ•°å€¼ç†è§£ï¼Œè¿˜åŒ…æ‹¬å®ƒä»¬çš„pythonå®ç°ã€‚</p><h1>ä¸€ä¸ªç‚¹æˆä¸ºå±€éƒ¨æœ€å°å€¼çš„å¿…è¦å’Œå……åˆ†æ¡ä»¶ï¼š</h1><p>è®¾f(.)æ˜¯ä¸€ä¸ªè¿ç»­çš„äºŒé˜¶å¯å¾®å‡½æ•°ã€‚å¯¹äºä»»ä¸€ç‚¹ä¸ºæå°å€¼ï¼Œå®ƒåº”æ»¡è¶³ä»¥ä¸‹æ¡ä»¶:</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d872da398b114a4d8b862632f9badd89><p class=pgc-img-caption></p></div><ul><li>ä¸€é˜¶å¿…è¦æ¡ä»¶:</li></ul><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d5839c3c511c44118ea985da5959f11c><p class=pgc-img-caption></p></div><ul><li>äºŒé˜¶å¿…è¦æ¡ä»¶ï¼š</li></ul><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/14874649780342a9ad41331725a80368><p class=pgc-img-caption></p></div><ul><li>äºŒé˜¶å……è¶³æ¡ä»¶ï¼š</li></ul><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5d245bec5ab84740a9e5641be27bb027><p class=pgc-img-caption></p></div><p><strong>æ¢¯åº¦ä¸‹é™ï¼š</strong></p><p>æ¢¯åº¦ä¸‹é™æ˜¯å­¦ä¹ ç®—æ³•(æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ æˆ–æ·±åº¦å¼ºåŒ–å­¦ä¹ )é¢†åŸŸæ‰€æœ‰è¿›å±•çš„æ”¯æŸ±ã€‚åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ä¸ºäº†æ›´å¿«æ›´å¥½çš„æ”¶æ•›ï¼Œæ¢¯åº¦ä¸‹é™çš„å„ç§ä¿®æ”¹ã€‚è®©æˆ‘ä»¬è€ƒè™‘çº¿æ€§å›å½’çš„æƒ…å†µï¼Œæˆ‘ä»¬ä¼°è®¡æ–¹ç¨‹çš„ç³»æ•°:</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/03ff395a68b64226bed5444b6322fab8><p class=pgc-img-caption></p></div><p>å‡è®¾è¯¥å‡½æ•°æ˜¯æ‰€æœ‰ç‰¹å¾çš„çº¿æ€§ç»„åˆã€‚é€šè¿‡æœ€å°åŒ–æŸå¤±å‡½æ•°æ¥ç¡®å®šæœ€ä½³ç³»æ•°é›†ï¼š</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/abf70615613440e1aa50fa22f84af6eb><p class=pgc-img-caption></p></div><p>è¿™æ˜¯çº¿æ€§å›å½’ä»»åŠ¡çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€‚æœ€å°äºŒä¹˜æ³•(Ordinary Least Square)æ¶‰åŠåˆ°æ±‚ç‰¹å¾çŸ©é˜µçš„é€†ï¼Œå…¶è¡¨è¾¾å¼ä¸º:</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/44b1a5f62fc24386bdf35fa13fc54db5><p class=pgc-img-caption></p></div><p>å¯¹äºå®é™…é—®é¢˜ï¼Œæ•°æ®çš„ç»´æ•°å¾ˆå¤§ï¼Œå¾ˆå®¹æ˜“é€ æˆè®¡ç®—é‡çš„æ¿€å¢ã€‚ä¾‹å¦‚,è®©æˆ‘ä»¬è€ƒè™‘é—®é¢˜çš„å›¾åƒç‰¹å¾åˆ†æ:ä¸€èˆ¬å›¾åƒçš„å¤§å°1024 x1024,è¿™æ„å‘³ç€ç‰¹å¾çš„æ•°é‡çº§ä¸º10â¶ã€‚ç”±äºå…·æœ‰å¤§é‡çš„ç‰¹å¾ï¼Œè¿™ç±»ä¼˜åŒ–é—®é¢˜åªèƒ½é€šè¿‡è¿­ä»£çš„æ–¹å¼æ¥è§£å†³ï¼Œè¿™å°±å¯¼è‡´äº†æˆ‘ä»¬æ‰€ç†ŸçŸ¥çš„æ¢¯åº¦ä¸‹é™æ³•å’Œç‰›é¡¿-æ‹‰å¼—æ£®æ³•ã€‚</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c264229e33824cbd9b1c38195c4209a3><p class=pgc-img-caption></p></div><p><strong>æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼š</strong></p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0e048247a9894de58dd3c66367e21e29><p class=pgc-img-caption></p></div><p>æ¢¯åº¦ä¸‹é™ç®—æ³•åˆ©ç”¨å…ˆå‰æŒ‡å®šçš„å­¦ä¹ ç‡ï¼ˆetaï¼‰åœ¨è´Ÿæ¢¯åº¦çš„æ–¹å‘ï¼ˆæœ€é™¡çš„ä¸‹é™æ–¹å‘ï¼‰ä¸Šæ›´æ–°è¿­ä»£ï¼ˆXï¼‰ã€‚å­¦ä¹ ç‡ç”¨äºåœ¨ä»»ä½•ç»™å®šçš„è¿­ä»£ä¸­é˜²æ­¢å±€éƒ¨æœ€å°å€¼çš„overshootã€‚</p><p>ä¸‹å›¾æ˜¾ç¤ºäº†å‡½æ•°fï¼ˆxï¼‰=xÂ²çš„æ¢¯åº¦ä¸‹é™ç®—æ³•çš„æ”¶æ•›æ€§ï¼Œå…¶ä¸­eta = 0.25</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/19a13d2437864c80b34f71cefe0c4771><p class=pgc-img-caption></p></div><p>æ‰¾å‡ºä¸€ä¸ªæœ€ä¼˜etaæ˜¯ç›®å‰çš„ä»»åŠ¡ï¼Œè¿™éœ€è¦äº‹å…ˆäº†è§£å‡½æ•°çš„ç†è§£å’Œæ“ä½œåŸŸã€‚</p><pre>import matplotlib.pyplot as pltimport numpy as np# assuming function to be x**2def get_gradient(x): return 2*xdef get_value(x): return np.sum(x**2)# python implementation of vanilla gradient descent update ruledefâ€‹ â€‹ def gradient_descent_updateâ€‹ (x, eta): """ get_gradient is 1st order oracle """ returnâ€‹ x - eta*get_gradient(x)</pre><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/3f1f8d6e5dea42c7af6b722393ffed5b><p class=pgc-img-caption></p></div><p><strong>Armijo Goldsteinæ¡ä»¶æ¢¯åº¦ä¸‹é™:</strong></p><p>ä¸ºäº†å‡å°‘æ‰‹åŠ¨è®¾ç½®çš„å·¥ä½œï¼Œåº”ç”¨Armijo Goldstein (AG)æ¡ä»¶æ¥æŸ¥æ‰¾ä¸‹ä¸€ä¸ªè¿­ä»£çš„(eta)ã€‚AGæ¡ä»¶çš„å½¢å¼æ¨å¯¼éœ€è¦çº¿æ€§é€¼è¿‘ã€Lipchitzæ¡ä»¶å’ŒåŸºæœ¬å¾®ç§¯åˆ†çš„çŸ¥è¯†ã€‚</p><p>æˆ‘ä»¬å®šä¹‰ä¸¤ä¸ªå‡½æ•°f1(x)å’Œf2(x)ä½œä¸ºä¸¤ä¸ªä¸åŒç³»æ•°å’Œçš„f(x)çš„çº¿æ€§é€¼è¿‘ï¼Œå…¶å…·æœ‰ä¸¤ä¸ªä¸åŒçš„ç³»æ•°Î±å’ŒÎ²ï¼Œç”±ä¸‹å¼ç»™å‡ºï¼š</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2e2d07d948d1407eba87d799d7cf3081><p class=pgc-img-caption></p></div><p>åœ¨AGæ¡ä»¶çš„æ¯æ¬¡è¿­ä»£ä¸­ï¼Œæ»¡è¶³ä»¥ä¸‹å…³ç³»çš„ç‰¹å®šetaï¼š</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/dfdb74e3a7cf40f79a646148d433f978><p class=pgc-img-caption></p></div><p>æ‰¾åˆ°å¹¶ä¸”ç›¸åº”åœ°æ›´æ–°å½“å‰è¿­ä»£ã€‚</p><p>ä¸‹å›¾æ˜¾ç¤ºäº†ä¸‹ä¸€æ¬¡è¿­ä»£çš„èŒƒå›´ï¼Œå¯¹äºå‡½æ•°fï¼ˆxï¼‰=xÂ²çš„æ”¶æ•›ï¼Œalpha = 0.25ï¼Œbeta = 0.5ï¼š</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/34f69404bf124ad8a9a02db8892b52d3><p class=pgc-img-caption></p></div><p>ä¸Šå›¾ä¸­çº¢è‰²ã€è“è‰²å’Œç»¿è‰²çš„çº¿å¯¹åº”äºç»¿è‰²æ˜¾ç¤ºçš„ä¸‹ä¸€ä¸ªå¯èƒ½è¿­ä»£çš„èŒƒå›´ã€‚</p><pre># python implementation of gradient descent with AG condition update ruledef gradient_descent_update_AG(x, â€‹ alphaâ€‹ =0.5, â€‹ betaâ€‹ =0.25): etaâ€‹ =0.5 max_etaâ€‹ =np.inf min_etaâ€‹ =0. value = get_value(x) grad = get_gradient(x) whileâ€‹ â€‹ Trueâ€‹ : x_cand = x - (eta)*grad f = get_value(x_cand) f1 = value - etaâ€‹ *aâ€‹ lpha*np.sum(np.abs(grad)*â€‹ *2â€‹ ) f2 = value - etaâ€‹ *beâ€‹ ta *np.sum(np.abs(grad)*â€‹ *2â€‹ ) ifâ€‹ f&lt;=f2 â€‹ andâ€‹ f&gt;=f1: return x_cand if f &lt;= f1: if eta == max_eta: eta = np.min([2.*eta, eta + max_eta/2.]) else: eta = np.min([2.*eta, (eta + max_eta)/2.]) ifâ€‹ f&gt;=f2: max_eta = eta eta = (eta+min_eta)/2.0</pre><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3ac855612f08472b934c9907d409b797><p class=pgc-img-caption></p></div><p><strong>å®Œå…¨æ¾å¼›æ¡ä»¶çš„æ¢¯åº¦ä¸‹é™ï¼š</strong></p><p>åœ¨å®Œå…¨æ¾å¼›æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œæ–°çš„å‡½æ•°gï¼ˆetaï¼‰è¢«æœ€å°åŒ–ä»¥è·å¾—éšåç”¨äºå¯»æ‰¾ä¸‹ä¸€æ¬¡è¿­ä»£çš„etaã€‚</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/711ef84ec7794dcda5b8bb85055d77c7><p class=pgc-img-caption></p></div><p>æ­¤æ–¹æ³•æ¶‰åŠè§£å†³æŸ¥æ‰¾æ¯ä¸ªä¸‹ä¸€ä¸ªè¿­ä»£çš„ä¼˜åŒ–é—®é¢˜ï¼Œå…¶æ‰§è¡Œæ–¹å¼å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8aaa174400934f5392b3f7976404067d><p class=pgc-img-caption></p></div><pre># The python implementation for FR is shown below:defâ€‹ â€‹ gradient_descent_update_FRâ€‹ (x): eta = â€‹ 0.5 thresh = â€‹ 1e-6 max_eta = np.inf min_eta = â€‹ 0. whileâ€‹ â€‹ Trueâ€‹ : x_cand = x - eta*get_gradient(x) g_diff = â€‹ -1.â€‹ *get_gradient(x)*get_gradient(x_cand) ifâ€‹ np.sum(np.abs(g_diff)) &lt; thresh â€‹ andâ€‹ eta &gt; â€‹ 0 â€‹: returnâ€‹ x_cand if g_diff &gt; 0: if eta == max_eta: eta = np.min([2.*eta, eta + max_eta/2.]) else: eta = np.min([2.*eta, (eta + max_eta)/2.]) else: max_eta = eta eta = (min_eta + eta)/2.0</pre><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1f4bcc16596f4a908271d29c68baaa7d><p class=pgc-img-caption></p></div><p><strong>éšæœºæ¢¯åº¦ä¸‹é™</strong></p><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨å®é™…è®¾ç½®ä¸­ï¼Œæ•°æ®çš„ç»´æ•°ä¼šéå¸¸å¤§ï¼Œè¿™ä½¿å¾—å¯¹æ‰€æœ‰ç‰¹å¾è¿›è¡Œè¿›ä¸€æ­¥çš„æ¢¯åº¦è®¡ç®—éå¸¸æ˜‚è´µã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéšæœºé€‰æ‹©ä¸€æ‰¹ç‚¹(ç‰¹å¾)å¹¶è®¡ç®—æœŸæœ›çš„æ¢¯åº¦ã€‚æ•´ä¸ªè¿‡ç¨‹çš„æ”¶æ•›åªæ˜¯åœ¨é¢„æœŸçš„æ„ä¹‰ä¸Šã€‚</p><p>åœ¨æ•°å­¦ä¸Šå®ƒæ„å‘³ç€ï¼šéšæœºé€‰æ‹©ä¸€ä¸ªç‚¹ï¼ˆpï¼‰æ¥ä¼°è®¡æ¢¯åº¦ã€‚</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/551f9471f42648b1a8af5c02e292178e><p class=pgc-img-caption></p></div><p>åœ¨ä¸Šé¢çš„è¿­ä»£ä¸­ï¼Œwtå¯ä»¥è¢«è§†ä¸ºå™ªå£°ã€‚åªæœ‰å½“Eï¼ˆwtï¼‰è¶‹äº0æ—¶ï¼Œè¯¥è¿­ä»£æ‰ä¼šå¯¼è‡´å±€éƒ¨æœ€ä¼˜ã€‚</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0b15e35938b44ccb984b7881424e9c15><p class=pgc-img-caption></p></div><p>åŒæ ·ï¼Œå¯ä»¥çœ‹å‡ºwtçš„æ–¹å·®ä¹Ÿæ˜¯æœ‰é™çš„ã€‚é€šè¿‡ä»¥ä¸Šè¯æ˜ï¼Œä¿è¯äº†SGDçš„æ”¶æ•›æ€§ã€‚</p><pre># SGD implementation in pythondefâ€‹ â€‹ SGDâ€‹ (self, X, Y, batch_size, thresh=â€‹ 1 â€‹ ): loss = â€‹ 100 step = â€‹ 0 ifâ€‹ self.plot: losses = [] whileâ€‹ loss &gt;= thresh: # mini_batch formation index = np.random.randint(â€‹ 0 â€‹ , len(X), size = batch_size) trainX, trainY = np.array(X)[index], np.array(Y)[index]  self.forward(trainX) loss = self.loss(trainY) self.gradients(trainY) # update self.w0 -= np.squeeze(self.alpha*self.grad_w0) self.weights -= np.squeeze(self.alpha*self.grad_w)  if self.plot: losses.append(loss) ifâ€‹ step % â€‹ 1000â€‹ == â€‹ 999â€‹ : â€‹  printâ€‹ â€‹ "Batch number: {}"â€‹ .format(step)+â€‹ " current loss: {}"â€‹ .format(loss) step += â€‹ 1 ifâ€‹ self.plot : self.visualization(X, Y, losses) pass</pre><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/bba5993dc7c640f185258a08380503c3><p class=pgc-img-caption></p></div><p><strong>AdaGrad</strong></p><p>Adagradæ˜¯ä¸€ä¸ªä¼˜åŒ–å™¨ï¼Œå¯å¸®åŠ©è‡ªåŠ¨è°ƒæ•´ä¼˜åŒ–é—®é¢˜ä¸­æ¶‰åŠçš„æ¯ä¸ªç‰¹å¾çš„å­¦ä¹ ç‡ã€‚è¿™æ˜¯é€šè¿‡è·Ÿè¸ªæ‰€æœ‰æ¢¯åº¦çš„å†å²æ¥å®ç°çš„ã€‚è¯¥æ–¹æ³•ä¹Ÿä»…åœ¨æœŸæœ›æ„ä¹‰ä¸Šæ”¶æ•›ã€‚</p><pre>defâ€‹ â€‹ AdaGradâ€‹ (self, X, Y, batch_size,thresh=0.5â€‹ ,epsilon=1e-6â€‹ ): loss = â€‹ 100 step = â€‹ 0 ifâ€‹ self.plot: losses = [] G = np.zeros((X.shape[â€‹ 1 â€‹ ], X.shape[â€‹ 1 â€‹ ])) G0 = â€‹ 0 whileâ€‹ loss &gt;= thresh: # mini_batch formation index = np.random.randint(â€‹ 0 â€‹ , len(X), size = batch_size) trainX, trainY = np.array(X)[index], np.array(Y)[index] self.forward(trainX) loss = self.loss(trainY) self.gradients(trainY) G += self.grad_w.T*self.grad_w G0 += self.grad_w0**â€‹ 2 den = np.sqrt(np.diag(G)+epsilon) delta_w = self.alpha*self.grad_w / den delta_w0 = self.alpha*self.grad_w0 / np.sqrt(G0 + epsilon) # update parameters self.w0 -= np.squeeze(delta_w0) self.weights -= np.squeeze(delta_w) if self.plot: losses.append(loss) ifâ€‹ step % â€‹ 500â€‹ == â€‹ 0 â€‹ : â€‹  printâ€‹ â€‹ "Batch number: {}".format (step)+â€‹ " current loss: {}"â€‹.format(loss)  step += â€‹ 1 ifâ€‹ self.plot : self.visualization(X, Y, losses) pass</pre><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ec15027957d6444fb83a9b21d946d598><p class=pgc-img-caption></p></div><h1>è®©æˆ‘ä»¬è½¬å‘åŸºäºHessiançš„æ–¹æ³•ï¼Œç‰›é¡¿å’Œæ‹Ÿç‰›é¡¿æ–¹æ³•ï¼š</h1><p>åŸºäºhessiançš„æ–¹æ³•æ˜¯åŸºäºæ¢¯åº¦çš„äºŒé˜¶ä¼˜åŒ–æ–¹æ³•ï¼Œå‡ ä½•ä¸Šæ¶‰åŠåˆ°æ¢¯åº¦å’Œæ›²ç‡ä¿¡æ¯æ¥æ›´æ–°æƒé‡ï¼Œå› æ­¤æ”¶æ•›é€Ÿåº¦æ¯”ä»…åŸºäºæ¢¯åº¦çš„æ–¹æ³•å¿«å¾—å¤šï¼Œç‰›é¡¿æ–¹æ³•çš„æ›´æ–°è§„åˆ™å®šä¹‰ä¸º:</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f02e0b37347e404aac353e2bd0978171><p class=pgc-img-caption></p></div><p>è¯¥ç®—æ³•çš„æ”¶æ•›é€Ÿåº¦è¿œå¿«äºåŸºäºæ¢¯åº¦çš„æ–¹æ³•ã€‚æ•°å­¦ä¸Š,æ¢¯åº¦ä¸‹é™æ³•çš„æ”¶æ•›é€Ÿåº¦æ­£æ¯”äºO (1 / t),è€Œå¯¹äºç‰›é¡¿æ³•å®ƒæ­£æ¯”äºO (1 / tÂ²)ã€‚ä½†æ˜¯å¯¹äºé«˜ç»´æ•°æ®ï¼Œä¸ºæ¯ä¸ªè¿­ä»£ä¼°è®¡äºŒé˜¶oracleçš„è®¡ç®—æˆæœ¬å¾ˆé«˜ï¼Œè¿™å¯¼è‡´ä½¿ç”¨ä¸€é˜¶oracleæ¨¡æ‹ŸäºŒé˜¶oracleã€‚è¿™å°±ç»™å‡ºäº†æ‹Ÿç‰›é¡¿ç®—æ³•ã€‚è¿™ç±»æ‹Ÿç‰›é¡¿æ³•ä¸­æœ€å¸¸ç”¨çš„ç®—æ³•æ˜¯BFGSå’ŒLMFGSç®—æ³•ã€‚åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬åªè®¨è®ºBFGSç®—æ³•ï¼Œå®ƒæ¶‰åŠåˆ°å¯¹å‡½æ•°Hessiançš„rank oneçŸ©é˜µæ›´æ–°ã€‚è¯¥æ–¹æ³•çš„æ€»ä½“æ€æƒ³æ˜¯éšæœºåˆå§‹åŒ–Hessianï¼Œå¹¶ä½¿ç”¨rank oneæ›´æ–°è§„åˆ™åœ¨æ¯æ¬¡è¿­ä»£ä¸­ä¸æ–­æ›´æ–°Hessianã€‚æ•°å­¦ä¸Šå¯ä»¥è¡¨ç¤ºä¸º:</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/89b5d6410f504bd0802357d4ba10199f><p class=pgc-img-caption></p></div><pre># python implementation for BFGSdefâ€‹ â€‹ BFGS_updateâ€‹ (H, s, y): smooth = â€‹ 1e-3 s = np.expand_dims(s, axis= â€‹ -1â€‹ ) y = np.expand_dims(y, axis= â€‹ -1â€‹ ) rho = â€‹ 1.â€‹ /(s.T.dot(y) + smooth) p = (np.eye(H.shape[â€‹ 0 â€‹ ]) - rho*s.dot(y.T)) returnâ€‹ p.dot(H.dot(p.T)) + rho*s.dot(s.T)defâ€‹ â€‹ quasi_Newtonâ€‹ (x0, H0, num_iter=â€‹ 100â€‹ , eta=â€‹ 1 â€‹ ): xo, H = x0, H0 forâ€‹ _ â€‹ inâ€‹ range(num_iter): xn = xo - eta*H.dot(get_gradient(xo)) y = get_gradient(xn) - get_gradient(xo) s = xn - xo H = BFGS_update(H, s, y) xo = xn returnâ€‹ xo</pre><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9043876e3ab745af8cc4bb1590844a21><p class=pgc-img-caption></p></div><h1>çº¦æŸä¼˜åŒ–</h1><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1fd1f56b2eb149af864a9fb932c9e853><p class=pgc-img-caption></p></div><p>ç°åœ¨ï¼Œæ˜¯æ—¶å€™è®¨è®ºä¸€äº›å›´ç»•çº¦æŸä¼˜åŒ–(åŒ…æ‹¬é—®é¢˜çš„åˆ¶å®šå’Œè§£å†³ç­–ç•¥)çš„å…³é”®æ¦‚å¿µäº†ã€‚æœ¬èŠ‚è¿˜å°†è®¨è®ºä¸€ç§ç§°ä¸ºSVM(æ”¯æŒå‘é‡æœº)çš„ç®—æ³•çš„ç†è®ºå’ŒPythonå®ç°ã€‚å½“æˆ‘ä»¬åœ¨ç°å®ç”Ÿæ´»ä¸­é‡åˆ°é—®é¢˜æ—¶ï¼Œæå‡ºä¸€ä¸ªç†æƒ³çš„ä¼˜åŒ–å‡½æ•°æ˜¯ç›¸å½“å›°éš¾çš„ï¼Œæœ‰æ—¶æ˜¯ä¸å¯è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡å¯¹é—®é¢˜æ–½åŠ é¢å¤–çš„çº¦æŸæ¥æ”¾æ¾ä¼˜åŒ–å‡½æ•°ï¼Œä¼˜åŒ–è¿™ä¸ªçº¦æŸè®¾ç½®å°†æä¾›ä¸€ä¸ªè¿‘ä¼¼ï¼Œæˆ‘ä»¬å°†å°½å¯èƒ½æ¥è¿‘é—®é¢˜çš„å®é™…è§£å†³æ–¹æ¡ˆï¼Œä½†ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚æ±‚è§£çº¦æŸä¼˜åŒ–é—®é¢˜çš„æ–¹æ³•æœ‰æ‹‰æ ¼æœ—æ—¥å…¬å¼æ³•ã€æƒ©ç½šæ³•ã€æŠ•å½±æ¢¯åº¦ä¸‹é™æ³•ã€å†…ç‚¹æ³•ç­‰ã€‚åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ æ‹‰æ ¼æœ—æ—¥å…¬å¼å’ŒæŠ•å½±æ¢¯åº¦ä¸‹é™æ³•ã€‚æœ¬èŠ‚è¿˜å°†è¯¦ç»†ä»‹ç»ç”¨äºä¼˜åŒ–CVXOPTçš„å¼€æºå·¥å…·ç®±ï¼Œå¹¶ä»‹ç»ä½¿ç”¨æ­¤å·¥å…·ç®±çš„SVMå®ç°ã€‚</p><p>çº¦æŸä¼˜åŒ–é—®é¢˜çš„ä¸€èˆ¬å½¢å¼ï¼š</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/80a0485f0a1e4530abd25bdd7ce90266><p class=pgc-img-caption></p></div><p>å…¶ä¸­f(x)ä¸ºç›®æ ‡å‡½æ•°ï¼Œg(x)ã€h(x)åˆ†åˆ«ä¸ºä¸ç­‰å¼çº¦æŸå’Œç­‰å¼çº¦æŸã€‚å¦‚æœf(x)æ˜¯å‡¸çš„çº¦æŸæ¡ä»¶å½¢æˆä¸€ä¸ªå‡¸é›†ï¼Œ(å³g(x)ä¸ºå‡¸å‡½æ•°h(x)ä¸ºä»¿å°„å‡½æ•°ï¼‰ï¼Œè¯¥ä¼˜åŒ–ç®—æ³•ä¿è¯æ”¶æ•›äºå…¨å±€æœ€å°å€¼ã€‚å¯¹äºå…¶ä»–é—®é¢˜ï¼Œå®ƒæ”¶æ•›äºå±€éƒ¨æå°å€¼ã€‚</p><p><strong>æŠ•å½±æ¢¯åº¦ä¸‹é™</strong></p><p>æ±‚è§£çº¦æŸä¼˜åŒ–è®¾ç½®çš„ç¬¬ä¸€æ­¥(ä¹Ÿæ˜¯æœ€æ˜æ˜¾çš„ä¸€æ­¥)æ˜¯å¯¹çº¦æŸé›†è¿›è¡Œè¿­ä»£æŠ•å½±ã€‚è¿™æ˜¯æ±‚è§£çº¦æŸä¼˜åŒ–é—®é¢˜ä¸­æœ€å¼ºå¤§çš„ç®—æ³•ã€‚è¿™åŒ…æ‹¬ä¸¤ä¸ªæ­¥éª¤(1)åœ¨æœ€å°åŒ–(ä¸‹é™)æ–¹å‘ä¸Šæ‰¾åˆ°ä¸‹ä¸€ä¸ªå¯èƒ½çš„è¿­ä»£ï¼Œ(2)åœ¨çº¦æŸé›†ä¸Šæ‰¾åˆ°è¿­ä»£çš„æŠ•å½±ã€‚</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/895fb1bee23441f39388472c3cde5420><p class=pgc-img-caption></p></div><pre># projected gradient descent implementationdefâ€‹ â€‹ projection_oracle_l2â€‹ (w, l2_norm): returnâ€‹ (l2_norm/np.linalg.norm(w))*wdefâ€‹ â€‹ projection_oracle_l1â€‹ (w, l1_norm): # first remember signs and store them. Modify w signs = np.sign(w) w = w*signs  # project this modified w onto the simplex in first orthant. d=len(w) ifâ€‹ np.sum(w)&lt;=l1_norm: returnâ€‹ w*signs forâ€‹ i â€‹ inâ€‹ range(d): w_next = w+â€‹ 0 w_next[w&gt;â€‹ 1e-7â€‹ ] = w[w&gt;â€‹ 1e-7â€‹ ] - np.min(w[w&gt;â€‹ 1e-7â€‹ ]) ifâ€‹ np.sum(w_next)&lt;=l1_norm: w = ((l1_norm - np.sum(w_next))*w + (np.sum(w) - l1_norm)*w_next)/(np.sum(w)-np.sum(w_next)) returnâ€‹ w*signs elseâ€‹ : w=w_nextdefâ€‹ â€‹ mainâ€‹ (): eta=â€‹ 1.0 /smoothness_coeff forâ€‹ l1_norm â€‹ inâ€‹ np.arange(â€‹ 0 â€‹ , â€‹ 10â€‹ , â€‹ 0.5â€‹ ): w=np.random.randn(data_dim) forâ€‹ i â€‹ inâ€‹ range(â€‹ 1000â€‹ ): w = w - eta*get_gradient(w) w = projection_oracle_l1(w, l1_norm) pass</pre><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/7edf28ca75794435ae74c44046c4b5b1><p class=pgc-img-caption></p></div><p><strong>äº†è§£æ‹‰æ ¼æœ—æ—¥å…¬å¼</strong></p><p>åœ¨å¤§å¤šæ•°ä¼˜åŒ–é—®é¢˜ä¸­ï¼Œæ‰¾åˆ°çº¦æŸé›†ä¸Šè¿­ä»£çš„æŠ•å½±æ˜¯ä¸€ä¸ªå›°éš¾çš„é—®é¢˜(ç‰¹åˆ«æ˜¯åœ¨å¤æ‚çº¦æŸé›†çš„æƒ…å†µä¸‹)ã€‚å®ƒç±»ä¼¼äºåœ¨æ¯æ¬¡è¿­ä»£ä¸­è§£å†³ä¼˜åŒ–é—®é¢˜ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¼˜åŒ–é—®é¢˜æ˜¯éå‡¸çš„ã€‚åœ¨ç°å®ä¸­ï¼Œäººä»¬è¯•å›¾é€šè¿‡è§£å†³å¯¹å¶é—®é¢˜è€Œä¸æ˜¯åŸå§‹é—®é¢˜æ¥æ‘†è„±çº¦æŸã€‚</p><p>åœ¨æ·±å…¥æ‹‰æ ¼æœ—æ—¥å¯¹å¶å’ŒåŸå§‹å…¬å¼ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹KKTæ¡ä»¶åŠå…¶æ„ä¹‰</p><ul><li>å¯¹äºä»»æ„ç‚¹ä¸ºå…·æœ‰ç­‰å¼çº¦æŸçš„å±€éƒ¨/å…¨å±€æœ€å°å€¼:</li></ul><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4fc7f515558843a7882a7f155482108d><p class=pgc-img-caption></p></div><ul><li>ç±»ä¼¼åœ°ï¼Œä¸ç­‰å¼çº¦æŸ:</li></ul><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7a0dc25bf3864a89b9140214dd297712><p class=pgc-img-caption></p></div><p>è¿™ä¸¤ä¸ªæ¡ä»¶å¯ä»¥å¾ˆå®¹æ˜“åœ°é€šè¿‡å°†å•ä½åœ†çœ‹ä½œä¸€ä¸ªçº¦æŸé›†æ¥è§‚å¯Ÿã€‚åœ¨ç¬¬ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬åªè€ƒè™‘ä¸€ä¸ª(\mu)ç¬¦å·ä¸é‡è¦çš„è¾¹ç•Œï¼Œè¿™æ˜¯ç­‰å¼çº¦æŸçš„ç»“æœã€‚åœ¨ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œè€ƒè™‘ä¸€ä¸ªå•ä½åœ†çš„å†…éƒ¨é›†åˆï¼Œå…¶ä¸­-veç¬¦å·è¡¨ç¤º(\lambda)ï¼Œè¡¨ç¤ºå¯è¡Œè§£åŒºåŸŸã€‚</p><p>KKT (Karush-Kuhn-Tucker)æ¡ä»¶è¢«è®¤ä¸ºæ˜¯ä¸€é˜¶å¿…è¦æ¡ä»¶ï¼Œå½“ä¸€ä¸ªç‚¹è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå¹³ç¨³ç‚¹(å±€éƒ¨æå°ç‚¹ã€å±€éƒ¨æå¤§ç‚¹ã€éç‚¹)æ—¶ï¼Œè¯¥æ¡ä»¶å¿…é¡»æ»¡è¶³ã€‚x ^ * æ˜¯å±€éƒ¨æœ€å°å€¼ï¼š</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d5deb7ddb2784994b72a8ff9b4d95263><p class=pgc-img-caption></p></div><p>LICQæ¡ä»¶:æ‰€æœ‰æ´»åŠ¨çº¦æŸ</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ba46179089304a7d9d48c42f13d15832><p class=pgc-img-caption></p></div><p>å®ƒä»¬åº”è¯¥æ˜¯çº¿æ€§æ— å…³çš„ã€‚</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/013c6c5c165b462586cfb6980f7d4f8b><p class=pgc-img-caption></p></div><p><strong>æ‹‰æ ¼æœ—æ—¥å‡½æ•°</strong></p><p>å¯¹äºä»»ä½•å‡½æ•°f (x)ä¸ä¸ç­‰å¼çº¦æŸg_i (x)â‰¤0å’Œç­‰å¼çº¦æŸh_i (x) = 0,æ‹‰æ ¼æœ—æ—¥L (x \Î»\Î¼)</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/cd3555b8fd794d0ea6fed73e79e84902><p class=pgc-img-caption></p></div><p>ä¼˜åŒ–å‡½æ•°ï¼š</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/13054fb19dbb4ac688ee541cd21e6a53><p class=pgc-img-caption></p></div><p>ä»¥ä¸Šä¼˜åŒ–ç›¸å½“äºï¼š</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a6309387c53447019d54c6f7e30a6c1b><p class=pgc-img-caption></p></div><p>ä¸Šé¢çš„å…¬å¼è¢«æ¸¸æˆç†è®ºçš„ä¸»å¼ ç§°ä¸ºåŸå§‹é—®é¢˜ï¼ˆp ^ *ï¼‰ï¼ˆå³ç¬¬äºŒä¸ªç©å®¶å°†æ€»æ˜¯æœ‰æ›´å¥½çš„ä¼˜åŒ–æœºä¼šï¼‰ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°çœ‹å‡ºï¼š</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d665aa90bde447e997c9a7005bb88126><p class=pgc-img-caption></p></div><p>è¿™ä¸ªå…¬å¼è¢«ç§°ä¸ºå¯¹å¶é—®é¢˜(d ^ *)ã€‚</p><p>å½“ä¸”ä»…å½“ç›®æ ‡å‡½æ•°ä¸ºå‡¸ä¸”çº¦æŸé›†ä¸ºå‡¸æ—¶ï¼ŒåŸå§‹å…¬å¼å’Œå¯¹å¶å…¬å¼çš„æœ€ä¼˜å€¼ç›¸åŒã€‚è¿™é¡¹è¦æ±‚çš„è¯æ˜ç†ç”±å¦‚ä¸‹:</p><p>å‡½æ•°æ˜¯å‡¸çš„ï¼Œè¿™æ„å‘³ç€</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1b12aa17ef2744a6ae3f3138ec003d26><p class=pgc-img-caption></p></div><h1>SVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰</h1><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9977d74ad95d4dd0aad4d2153cd0cd02><p class=pgc-img-caption></p></div><p>SVMå±äºç”¨äºåˆ†ç±»å’Œå›å½’é—®é¢˜çš„ç›‘ç£æœºå™¨å­¦ä¹ ç®—æ³•ç±»ã€‚SVMæ˜“äºæ‰©å±•ï¼Œå¯ä»¥è§£å†³çº¿æ€§å’Œéçº¿æ€§é—®é¢˜ï¼ˆé€šè¿‡ä½¿ç”¨åŸºäºæ ¸çš„æŠ€å·§ï¼‰ã€‚åœ¨å¤§å¤šæ•°é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬æ— æ³•å¯¹ä¸¤ç±»ä¸åŒçš„æ•°æ®è¿›è¡Œå•ç‹¬çš„åŒºåˆ†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨å†³ç­–è¾¹ç•Œçš„æ„å»ºä¸­æä¾›ä¸€ç‚¹ä½™åœ°ï¼Œè¿™å¾ˆå®¹æ˜“ç”¨SVMæ¥è¡¨ç¤ºã€‚æ”¯æŒå‘é‡æœºçš„æ€æƒ³æ˜¯åœ¨ä¸¤ç»„ä¸åŒçš„æ•°æ®ç‚¹ä¹‹é—´åˆ›å»ºåˆ†ç¦»çš„è¶…å¹³é¢ã€‚ä¸€æ—¦è·å¾—äº†åˆ†ç¦»è¶…å¹³é¢ï¼Œå¯¹å…¶ä¸­ä¸€ä¸ªç±»ä¸­çš„æ•°æ®ç‚¹(æµ‹è¯•ç”¨ä¾‹)è¿›è¡Œåˆ†ç±»å°±å˜å¾—ç›¸å¯¹å®¹æ˜“äº†ã€‚æ”¯æŒå‘é‡æœºç”šè‡³å¯ä»¥å¾ˆå¥½åœ°ç”¨äºé«˜ç»´æ•°æ®ã€‚ä¸å…¶ä»–æœºå™¨å­¦ä¹ ï¼ˆMLï¼‰æ¨¡å‹ç›¸æ¯”ï¼Œsvmçš„ä¼˜ç‚¹æ˜¯å†…å­˜æ•ˆç‡é«˜ã€å‡†ç¡®ã€å¿«é€Ÿã€‚æˆ‘ä»¬æ¥çœ‹çœ‹æ”¯æŒå‘é‡æœºçš„æ•°å­¦</p><p>SVMåŸå§‹é—®é¢˜</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ea18a226ae984fd7a8749f2e746c2f76><p class=pgc-img-caption></p></div><p>ä½¿ç”¨æ‹‰æ ¼æœ—æ—¥ç®—æ³•çš„SVMå¯¹å¶é—®é¢˜</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/acd6f4be852b45ab860174fccca257c0><p class=pgc-img-caption></p></div><p>Derivation of Dual</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e38afdcc638c4def8c5d2443f4aa8ed8><p class=pgc-img-caption></p></div><h1>CVXOPT</h1><p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºä½¿ç”¨CVXOPTåº“åœ¨pythonä¸­å®ç°ä¸Šè¿°SVMå¯¹å¶ç®—æ³•ã€‚</p><p>CVXOPTé€šç”¨æ ¼å¼çš„é—®é¢˜</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/a587e128be194c36ae2ca49586689408><p class=pgc-img-caption></p></div><pre># SVM using CVXOPTimportâ€‹ numpy â€‹ asâ€‹ npfromâ€‹ cvxopt â€‹ importâ€‹ matrix,solversdefâ€‹ â€‹ solve_SVM_dual_CVXOPTâ€‹ (x_train, y_train, x_test): """ Solves the SVM training optimisation problem (the Arguments: x_train: A numpy array with shape (n,d), denoting \R^d. y_train: numpy array with shape (n,) Each element x_train: A numpy array with shape (m,d), denoting dual) using cvxopt.  n training samples in takes +1 or -1 m test samples in \R^d. Limits: n&lt;200, d&lt;100, m&lt;1000  Returns: y_pred_test : A numpy array with shape (m,). This is the result of running the learned model on the test instances x_test. Each element is +1 or -1. """ n, d = x_train.shape c = â€‹ 10â€‹ â€‹ # let max \lambda value be 10 y_train = np.expand_dims(y_train, axis=â€‹ 1 â€‹ )*â€‹ 1. P = (y_train * x_train).dot((y_train * x_train).T) q = -1.â€‹ *np.ones((n, â€‹ 1 â€‹ )) G = np.vstack((np.eye(n)*â€‹ -1â€‹ ,np.eye(n))) h = np.hstack((np.zeros(n), np.ones(n) * c)) A = y_train.reshape(â€‹ 1 â€‹ , â€‹ -1â€‹ ) b = np.array([â€‹ 0.0â€‹ ]) P = matrix(P); q = matrix(q) G = matrix(G); h = matrix(h) A = matrix(A); b = matrix(b) sol = solvers.qp(P, q, G, h, A, b) lambdas = np.array(sol[â€‹ 'x'â€‹ ]) w = ((y_train * lambdas).T.dot(x_train)).reshape(â€‹ -1â€‹ , â€‹ 1 â€‹ ) b = y_train - np.dot(x_train, w) prediction = â€‹ lambdaâ€‹ x, w, b: np.sign(np.sum(w.T.dot(x) + b)) y_test = np.array([prediction(x_, w, b) â€‹ forâ€‹ x_ â€‹ inâ€‹ x_test]) returnâ€‹ y_testifâ€‹ __name__ == â€‹ "__main__"â€‹ : # Example format of input to the functions n=â€‹ 100 m=â€‹ 100 d=â€‹ 10 x_train = np.random.randn(n,d) x_test = np.random.randn(m,d) w = np.random.randn(d) y_train = np.sign(np.dot(x_train, w)) y_test = np.sign(np.dot(x_test, w)) y_pred_test = solve_SVM_dual_CVXOPT(x_train, y_train, x_test) check1 = np.sum(y_pred_test == y_test) printâ€‹ (â€‹ "Score: {}/{}"â€‹ .format(check1, len(y_Test)))</pre><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœº(SVM)çš„çº¦æŸå’Œæ— çº¦æŸä¼˜åŒ–ã€ç†è®ºå’Œå®ç° onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/b761e859b46a44af9c4bcc391126e11f><p class=pgc-img-caption></p></div></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'SVM','çº¦æŸ','æ— çº¦æŸ'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>