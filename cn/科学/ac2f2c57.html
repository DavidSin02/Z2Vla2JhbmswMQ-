<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>C++æ ¸å¿ƒå‡†åˆ™E4,5:è®¾è®¡å¹¶æ„å»ºä¸å˜é‡ | æå®¢å¿«è¨Š</title><meta property="og:title" content="C++æ ¸å¿ƒå‡†åˆ™E4,5:è®¾è®¡å¹¶æ„å»ºä¸å˜é‡ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/4a90fd0986b04d2a9dcd53b3120d3eda"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/ac2f2c57.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/ac2f2c57.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/ac2f2c57.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/ac2f2c57.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/ac2f2c57.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/ac2f2c57.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/ac2f2c57.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/ac2f2c57.html><meta property="article:published_time" content="2020-11-14T20:52:17+08:00"><meta property="article:modified_time" content="2020-11-14T20:52:17+08:00"><meta name=Keywords content><meta name=description content="C++æ ¸å¿ƒå‡†åˆ™E4,5:è®¾è®¡å¹¶æ„å»ºä¸å˜é‡"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/ac2f2c57.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>C++æ ¸å¿ƒå‡†åˆ™E4,5:è®¾è®¡å¹¶æ„å»ºä¸å˜é‡</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>ç§‘å­¦</a></span></div><div class=post-content><div class=pgc-img><img alt=C++æ ¸å¿ƒå‡†åˆ™E4,5:è®¾è®¡å¹¶æ„å»ºä¸å˜é‡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4a90fd0986b04d2a9dcd53b3120d3eda><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><strong>E.4: Design your error-handling strategy around invariants</strong></h1><h1 class=pgc-h-arrow-right>E.4:å›´ç»•ä¸å˜é‡è®¾è®¡é”™è¯¯å¤„ç†ç­–ç•¥</h1><p><strong>Reasonï¼ˆåŸå› ï¼‰</strong></p><p style=text-align:justify>To use an object it must be in a valid state (defined formally or informally by an invariant) and to recover from an error every object not destroyed must be in a valid state.</p><p style=text-align:justify>ä¸ºäº†ä½¿ç”¨å¯¹è±¡ï¼Œå®ƒä¸€å®šè¦å¤„äºæœ‰æ•ˆçŠ¶æ€ï¼ˆé€šè¿‡ä¸å˜é‡å½¢å¼åŒ–æˆ–éå½¢å¼åŒ–å®šä¹‰ï¼‰å¹¶ä¸”ä¸ºäº†ä»é”™è¯¯ä¸­æ¢å¤ï¼Œæ‰€æœ‰æ²¡æœ‰é”€æ¯çš„å¯¹è±¡å¿…é¡»å¤„äºæœ‰æ•ˆçŠ¶æ€ã€‚</p><p style=text-align:justify><strong>Noteï¼ˆæ³¨æ„ï¼‰</strong></p><p style=text-align:justify>An invariant is a logical condition for the members of an object that a constructor must establish for the public member functions to assume.</p><p style=text-align:justify>ä¸å˜é‡æ˜¯ä¸€ä¸ªé€‚ç”¨äºå¯¹è±¡æˆå‘˜çš„é€»è¾‘æ¡ä»¶ï¼Œè¿™ä¸ªæ¡ä»¶å¿…é¡»æœ‰æ„é€ å‡½æ•°å»ºç«‹ï¼Œå¯ä»¥ä½œä¸ºå…¬æœ‰æˆå‘˜å‡½æ•°çš„å‰ææ¡ä»¶ã€‚</p><p style=text-align:justify><strong>Enforcementï¼ˆå®æ–½å»ºè®®ï¼‰</strong></p><p style=text-align:justify>???</p><p style=text-align:justify><br></p><div class=pgc-img><img alt=C++æ ¸å¿ƒå‡†åˆ™E4,5:è®¾è®¡å¹¶æ„å»ºä¸å˜é‡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1e8d04f13d7e425895db7bf4777b4816><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>E.5: Let a constructor establish an invariant, and throw if it cannot</h1><h1 class=pgc-h-arrow-right>E.5:è®©æ„é€ å‡½æ•°å»ºç«‹ä¸å˜é‡ï¼Œå¦‚æœä¸èƒ½å°±æŠ›å¼‚å¸¸</h1><p style=text-align:justify><strong>Reasonï¼ˆåŸå› ï¼‰</strong></p><p style=text-align:justify>Leaving an object without its invariant established is asking for trouble. Not all member functions can be called.</p><p style=text-align:justify>å»ºç«‹ä¸€ä¸ªå¯¹è±¡å´æ²¡æœ‰å»ºç«‹ä¸å˜é‡æ˜¯åœ¨æ‰¾éº»çƒ¦ã€‚ä¸æ˜¯æ‰€æœ‰æˆå‘˜å‡½æ•°éƒ½æ˜¯å¯ä»¥è¢«è°ƒç”¨çš„ã€‚</p><p style=text-align:justify><strong>Exampleï¼ˆç¤ºä¾‹ï¼‰</strong></p><pre><code>class Vector {  // very simplified vector of doubles  // if elem != nullptr then elem points to sz doublespublic:    Vector() : elem{nullptr}, sz{0}{}    Vector(int s) : elem{new double[s]}, sz{s} { /* initialize elements */ }    ~Vector() { delete [] elem; }    double&amp; operator[](int s) { return elem[s]; }    // ...private:    owner&lt;double*&gt; elem;    int sz;};</code></pre><p style=text-align:justify>The class invariant - here stated as a comment - is established by the constructors. new throws if it cannot allocate the required memory. The operators, notably the subscript operator, relies on the invariant.</p><p style=text-align:justify>See also: If a constructor cannot construct a valid object, throw an exception</p><p style=text-align:justify>ç±»ä¸å˜é‡-è¿™é‡Œé€šè¿‡æ³¨é‡Šå£°æ˜-é€šè¿‡æ„é€ å‡½æ•°å»ºç«‹äº†ã€‚å¦‚æœä¸èƒ½åˆ†é…è¦æ±‚çš„å†…å­˜ï¼Œnewæ“ä½œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚è¿ç®—ç¬¦ï¼Œç‰¹åˆ«æ˜¯ä¸‹æ ‡è¿ç®—ç¬¦ä¾é ä¸å˜é‡ã€‚å¦‚æœä¸èƒ½æ„å»ºæœ‰æ•ˆçš„å¯¹è±¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚</p><p style=text-align:justify><strong>Enforcementï¼ˆå®æ–½å»ºè®®ï¼‰</strong></p><p style=text-align:justify>Flag classes with private state without a constructor (public, protected, or private).</p><p style=text-align:justify>æ ‡è®°é‚£äº›æ²¡æœ‰æ„é€ å‡½æ•°ï¼ˆå…¬æœ‰çš„ï¼Œç§æœ‰çš„æˆ–ä¿æŠ¤çš„ï¼‰å´æœ‰ç§æœ‰æˆå‘˜çš„ç±»ã€‚</p><p style=text-align:start><strong>åŸæ–‡é“¾æ¥</strong></p><p style=text-align:start>https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#e4-design-your-error-handling-strategy-around-invariants</p><p style=text-align:start><strong>æ–°ä¹¦ä»‹ç»</strong></p><p style=text-align:justify>ä»¥ä¸‹æ˜¯æœ¬äºº3æœˆä»½å‡ºç‰ˆçš„æ–°ä¹¦ï¼Œæ‹œæ‰˜å¤šå¤šå…³æ³¨ï¼</p><div class=pgc-img><img alt=C++æ ¸å¿ƒå‡†åˆ™E4,5:è®¾è®¡å¹¶æ„å»ºä¸å˜é‡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d10aceac0d1149a4be3a0392646ae8c5><p class=pgc-img-caption></p></div><p style=text-align:justify>æœ¬ä¹¦åˆ©ç”¨Python çš„æ ‡å‡†GUI å·¥å…·åŒ…tkinterï¼Œé€šè¿‡å¯æ‰§è¡Œçš„ç¤ºä¾‹å¯¹23 ä¸ªè®¾è®¡æ¨¡å¼é€ä¸ªè¿›è¡Œè¯´æ˜ã€‚è¿™æ ·ä¸€æ–¹é¢å¯ä»¥ä½¿è¯»è€…äº†è§£çœŸå®çš„è½¯ä»¶å¼€å‘å·¥ä½œä¸­æ¯ä¸ªè®¾è®¡æ¨¡å¼çš„è¿ç”¨åœºæ™¯å’Œæƒ³è¦è§£å†³çš„é—®é¢˜ï¼›å¦ä¸€æ–¹é¢é€šè¿‡å¯¹è¿™äº›é—®é¢˜çš„è§£å†³è¿‡ç¨‹è¿›è¡Œè¯´æ˜ï¼Œè®©è¯»è€…æ˜ç™½åœ¨ç¼–å†™ä»£ç æ—¶å¦‚ä½•åˆ¤æ–­ä½¿ç”¨è®¾è®¡æ¨¡å¼çš„åˆ©å¼Šï¼Œå¹¶åˆç†è¿ç”¨è®¾è®¡æ¨¡å¼ã€‚</p><p style=text-align:justify>å¯¹è®¾è®¡æ¨¡å¼æ„Ÿå…´è¶£è€Œä¸”å¸Œæœ›éšå­¦éšç”¨çš„è¯»è€…é€šè¿‡æœ¬ä¹¦å¯ä»¥å¿«é€Ÿè·¨è¶Šä»ç†è§£åˆ°è¿ç”¨çš„é—¨æ§›ï¼›å¸Œæœ›å­¦ä¹ Python GUI ç¼–ç¨‹çš„è¯»è€…å¯ä»¥å°†æœ¬ä¹¦ä¸­çš„ç¤ºä¾‹ä½œä¸ºè®¾è®¡å’Œå¼€å‘çš„å‚è€ƒï¼›ä½¿ç”¨Python è¯­è¨€è¿›è¡Œå›¾åƒåˆ†æã€æ•°æ®å¤„ç†å·¥ä½œçš„è¯»è€…å¯ä»¥ç›´æ¥ä»¥æœ¬ä¹¦ä¸­çš„ç¤ºä¾‹ä¸ºåŸºç¡€ï¼Œè¿…é€Ÿæ„å»ºè‡ªå·±çš„ç³»ç»Ÿæ¶æ„ã€‚</p><hr><p style=text-align:center>è§‰å¾—æœ¬æ–‡æœ‰å¸®åŠ©ï¼Ÿè¯·åˆ†äº«ç»™æ›´å¤šäººã€‚</p><p style=text-align:center>å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ã€é¢å‘å¯¹è±¡æ€è€ƒã€‘è½»æ¾å­¦ä¹ æ¯ä¸€å¤©ï¼</p><p style=text-align:center>é¢å‘å¯¹è±¡å¼€å‘ï¼Œé¢å‘å¯¹è±¡æ€è€ƒï¼</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'C++','å‡†åˆ™','E4'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>