<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>架构师的进化视角｜为你解析演进式架构的概念 | 极客快訊</title><meta property="og:title" content="架构师的进化视角｜为你解析演进式架构的概念 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/44ca075192984026bac9d0f99e3c8ab1"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/e07cb453.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/e07cb453.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/e07cb453.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/e07cb453.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/e07cb453.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/e07cb453.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/e07cb453.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/e07cb453.html><meta property="article:published_time" content="2020-11-14T20:51:09+08:00"><meta property="article:modified_time" content="2020-11-14T20:51:09+08:00"><meta name=Keywords content><meta name=description content="架构师的进化视角｜为你解析演进式架构的概念"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/e07cb453.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>架构师的进化视角｜为你解析演进式架构的概念</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>科学</a></span></div><div class=post-content><p><br></p><div class=pgc-img><img alt=架构师的进化视角｜为你解析演进式架构的概念 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/44ca075192984026bac9d0f99e3c8ab1><p class=pgc-img-caption></p></div><p>在构建软件时，架构师必须明确哪些特征最重要。然而，许多因素是互相矛盾的。比如，让软件具备高性能的同时还要实现极大的伸缩性就很困难，因为实现这两者需要谨慎地平衡架构、运维及其他诸多因素。因此，在为架构设计做必要分析的同时，又要处理好各个因素之间不可避免的冲突，架构师在权衡每个架构设计方案的利弊时，常常需要做出非常艰难的<strong>折中</strong>。</p><p>近年来，软件开发核心工程实践的持续发展给我们提供了条件，使我们得以重新思考架构随时间的推移要如何变化，以及当这样的演进发生时，如何保护重要的架构特征。我们想为软件架构添加一个新的标准“特征”——<strong>演进能力</strong>，以一种新的方式思考<strong>架构</strong>和<strong>时间</strong>。</p><h1><strong>1.1　演进式架构</strong></h1><p>无论我们怎么努力，软件依然变得越来越难以改变。由于各种原因，软件的组成部分不容易变更，而且随着时间推移变得愈发脆弱和难以操作。软件项目的变更通常是由于对功能或范围做了重新评估而导致的，但是还有一些变化是架构师和长期规划者无法控制的。尽管架构师喜欢为未来做战略性规划，但不断变化的软件开发环境使这一切变得困难重重。既然变化是必然的，那么我们就只能因势利导地来利用它。</p><p><strong>1.1.1　一切都在变化，如何才能长期规划</strong></p><p>软件开发体系由所有的工具、框架、库以及最佳实践（软件开发领域的技术积累）构成。和生态系统一样，软件开发体系实现了平衡，开发人员能够理解这个体系并为其添砖加瓦。然而，这种平衡是动态的，随着新事物不断出现，平衡不断被打破和重建。想象一个脚踏独轮车，手里还拿着盒子的人。他是<strong>动态的</strong>，因为他需要不断调整来保持挺立；他又是<strong>平衡的</strong>，因为他保持着身体平衡。在软件开发体系中，每一项创新或新实践都可能打破现状，迫使系统重新建立平衡。就好比我们不断地将更多的盒子抛向骑独轮车的人，迫使他不断寻求新的平衡。</p><p>架构师在很多方面都和这个倒霉的独轮车手相似，不断地平衡以适应环境变化。持续交付这项工程实践使得这个平衡过程有了结构性的转变，它将过去孤立的功能（例如运维）合并到了软件开发的生命周期中，这让我们对<strong>变化</strong>的含义有了新的认识。企业级架构师不能再依赖静态的五年计划了，因为整个软件开发体系在不断变化，任何一个长期计划都可能变得毫无意义。</p><p>即便对经验丰富的实践者来说，颠覆性的创新也是难以预测的。比如，像 Docker 这样的容器化技术的崛起就是一个不可预知的行业转变。但我们仍然可以通过一系列小的演进找到一些蛛丝马迹。以前，操作系统、应用服务器和其他基础设施都是商品，需要斥巨资购买使用许可。当时许多架构设计着重于高效利用共享资源。渐渐地，Linux 变得足以支撑企业及应用，使得购买操作系统的<strong>费用</strong>降为零。接下来，通过 Puppet 和 Chef 等工具自动配置服务器的 DevOps 实践使得 Linux <strong>运维工作</strong>也不再需要成本。一旦开发环境免费并得到广泛应用，势必朝着更加通用和便携的方向发展，于是 Docker 应运而生。但如果没有之前所有的演进过程，容器化就不会发生。</p><p>我们所使用的编程平台也在持续演进。新的编程语言提供了更好的应用编程接口（API），提高了对新问题的灵活性和适用性。新的编程语言还提供了不同的范式和概念。例如，引入 Java 替代 C++，降低了编写网络代码的难度并改善了内存管理。回顾过去的 20 年，很多语言一直在持续改进它们的 API，与此同时，新的编程语言往往用于解决新的问题。编程语言的演变如图 1-1 所示。</p><div class=pgc-img><img alt=架构师的进化视角｜为你解析演进式架构的概念 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ac24f6ac75c14ec48e6f25b72f04cad6><p class=pgc-img-caption>图 1-1：流行编程语言的演进过程</p></div><p>无论是在软件开发的哪个方面，比如编程平台、编程语言、运维环境、持久化技术等，我们都知道改变会持续发生。虽然无法预测技术或领域格局何时会改变，或哪些变化会持续下去，但我们清楚改变是不可避免的。因此，我们应该在构建系统的过程中对这一点保持清醒的认识。</p><p>如果整个体系持续地以出乎意料的方式发生变化，预测变化就变得不可能了，那么用什么来<strong>替代</strong>固定计划呢？企业架构师和开发人员必须学会适应变化。做长期计划有一个隐含的原因是财务上的考虑，因为以前软件变更的成本很高。但是，现代工程实践通过自动化和其他先进实践（例如 DevOps）降低了软件变更的成本。</p><p>多年来，一些聪明的开发人员发现系统的某些部分相对而言更难修改。这便是将<strong>软件架构</strong>定义为“将来难以变更的部分”的原因，这个省事的定义简单地区分了软件系统中真的难以修改的部分和可以轻松修改的部分。但这个定义依然不免走进了盲区，因为开发者预先假设“变更是困难的”，这变成了一个自证式的预言。</p><p>几年前，一些富有创新精神的架构师用新的视角审视了“将来难以变更”的问题。使架构具有可变性会怎样呢？换句话说，如果<strong>易于改变</strong>是架构的基本原则，那么变更将不再困难。反过来，使架构具备演进能力会导致一组全新的行为出现，进而再次打破整个体系的平衡。</p><p>即使环境不改变，架构特征出现磨损该怎么办？架构师设计出架构，将其置于纷乱的现实世界，基于架构执行各项事务。架构师要如何保护他们定义的重要部分呢？</p><p><strong>1.1.2　完成架构构建后，如何防止它逐渐退化</strong></p><p>有一种不幸的退化叫作<strong>架构比特衰减</strong>，它在很多组织中均有发生。架构师选择特定的架构模式来满足业务需求及让系统具备某些能力，但这些特征常常意外地随着时间推移而退化。例如，架构师构建了一个包含顶部展现层、底部持久层和一些中间层的分层架构。负责报表功能的开发人员出于性能上的考虑经常会要求绕过中间层，直接从展现层访问持久层。架构师通过分层来隔离变化。而后开发人员绕过这些层，不仅增加了耦合，还使得分层变得毫无价值。</p><p>定义了那些重要的架构特征后，架构师如何<strong>保护</strong>这些特征不磨损呢？答案是添加<strong>演进能力</strong>作为新的架构特征，使其在系统演进时保护其他特征。比如，架构师追求架构设计的高伸缩性，但不希望在系统演进时削弱该特征。因此，<strong>演进能力</strong>是一种元特征和保护其他所有架构特征的架构封装器。</p><p>演进式架构的另一个作用，即它是一种为架构的重要特征提供保护的机制。我们探寻<strong>持续架构</strong>背后的理念。<strong>持续架构</strong>指构建架构的过程没有最终状态，它会随着软件开发体系的不断变化而演进，并保护重要的架构特征。我们不会尝试定义整个软件架构，因为已经存在很多定义了。我们通过引入<strong>时间</strong>和<strong>变化</strong>作为头等架构元素来扩展当前的定义。</p><p>我们对演进式架构的定义如下。</p><blockquote><p>演进式架构支持跨多个维度的引导性增量变更。</p></blockquote><h1><strong>1.2　增量变更</strong></h1><p><strong>增量变更</strong>描述了软件架构的两个方面：如何增量地构建软件和如何部署软件。</p><p>在开发阶段，允许小的增量变更的架构更易于演进，因为对于开发者来说，变更范围相对更小。对部署而言，增量变更指业务功能的模块化和解耦水平，以及它们是如何映射到架构中去的。示例如下。</p><p>假设有一个小工具商家 PenultimateWidgets，该商家采用微服务架构和一些现代工程实践运营着一个产品目录页面。该页面的一个功能是让用户给出小工具的星级评分。PenultimateWidgets 的其他一些业务也需要评分，比如客服代表、物流服务商评价等，所以这些业务共享星级评分服务。某天，该服务的开发团队发布了新版本，新版本允许用户给出半星评价（一个小而重要的升级）。其他需要评分的服务不需要强制升级，而可以逐渐地在合适的时候迁移到新版本。PenultimateWidgets 的 DevOps 实践采用了架构级别的监控，不仅监控各个服务，还监控服务与服务之间的路由。当运营人员观察到在给定时间内没有请求路由至特定服务时，他们自动将该服务从体系中移除。</p><p>这是一个在架构级别进行增量变更的例子：如有需要，原服务和新服务可以并存。团队可以在适当（不太忙或必要）的时候完成迁移，当所有迁移都完成时，旧版本的服务将会作为垃圾被自动回收。</p><p>增量变更的成功需要一些持续交付实践的配合。并不是任何情况都需要所有这些实践，但通常它们会一起发生。</p><h1><strong>1.3　引导性变更</strong></h1><p>一旦架构师选择了重要的架构特征，他们会把变更引导进入架构，以保护这些重要特征。为此，我们借用演化计算中的一个概念：<strong>适应度函数</strong>。该函数是一种目标函数，用于计算潜在的解决方案与既定目标的差距。在演化计算中，适应度函数决定一个算法是否在持续提升。换句话说，随着每个算法变体的产生，基于设计者对算法“适应度”的定义，适应度函数决定每个变体的“适应程度”。</p><p>对于演进式架构，随着架构的演进，我们有着类似的需求。我们需要评估机制，来评估变化对架构重要特征的影响，并防止这些特征随着时间的推移而退化。适应度函数的隐喻涵盖多种机制，包括度量、测试和其他检验工具。我们采用这些机制来确保架构不会以不良方式变更。当架构师确定了需要保护的架构特征时，他们会定义一个或多个适应度函数来提供保护。</p><p>以往，架构往往要划出一部分作为管理活动，最近架构师才接受了通过架构实现变更的思想。架构适应度函数允许在组织需求和业务功能的上下文中制定决策，并为明晰且可测试的决策奠定了基础。演进式架构并不是毫无约束或不负责任的软件开发方式。相反，它可以在高速变迁的业务、严谨的系统需求和架构特征间找到平衡。适应度函数驱动架构设计决策，并引导架构变更适应业务和技术环境的变化。</p><h1><strong>1.4　多个架构维度</strong></h1><blockquote><p>不存在单独的系统。世界是一个整体。如何划分系统边界取决于讨论的主题。</p><p>——Donella H. Meadows</p></blockquote><p>古希腊的物理学通过固定点分析宇宙，最终发展成了经典力学。但是到了 20 世纪初，随着仪器越来越精密，现象越来越复杂，人们逐渐从经典力学转向相对论。科学家意识到之前被视为孤立的现象其实是相互影响的。自 20 世纪 90 年代起，受到启发的架构师越来越多地将软件架构视作多维的。持续交付也将运维纳入了软件架构的范畴。软件架构师往往关注技术架构，但那只是软件项目的维度之一。如果架构师想构建可演进的架构，就必须考虑系统中所有会受变化影响的部分。正如物理学所讲的，万物都是相关联的，架构师深知软件项目是多维的。</p><p>为了构建可以不断演进的软件系统，架构师不能只考虑技术架构。例如，如果项目包含一个关系型数据库，那么数据库实体之间的结构和关系也会随着时间的推移而不断变化。另外，架构师也不希望系统在演进过程中暴露安全漏洞。这些例子展示了架构的不同<strong>维度</strong>，它们通常在架构中以正交方式交织在一起。部分维度在常见的<strong>架构关注点</strong>范围之内，但是架构<strong>维度</strong>的意义其实更广泛，它囊括了很多传统意义上技术架构范畴之外的东西。每个项目都有许多维度，架构师在考虑架构演进时必须要想到。下面是一些影响现代软件架构演进能力的常见维度。</p><ul><li><strong>技术</strong>架构中的实现部分：框架、依赖的库和实现语言。</li><li><strong>数据</strong>数据库模式、表格布局、优化计划等。通常由数据库管理员（DBA）处理这类架构。</li><li><strong>安全</strong>定义安全策略、指导方针和指定工具来帮助发现缺陷。</li><li><strong>运维与系统</strong>关注架构如何映射到现有的物理或虚拟的技术设施中，包括服务器、机器集群、交换机、云等。</li></ul><p>以上每个视角构成一个架构<strong>维度</strong>——为了支持特定视角而有意进行的划分。这里架构维度的概念涵盖了传统的架构特征和其他有助于构建软件系统的因素。随着问题和周遭环境的改变，我们想保护架构不磨损，每个维度都提供给我们一个审视架构的视角。</p><p>从概念上划分架构的方法有很多，比如 IEEE 的软件架构定义中的 4+1 视图模型。它关注不同角色的不同视角，将整个系统划分成了<strong>逻辑视图</strong>、<strong>开发视图</strong>、<strong>进程视图</strong>和<strong>物理视图</strong>。在著名的《软件系统架构》一书中，作者给出了软件架构的视点目录，它涵盖了更多角色。类似地，Simon Brown 的 C4 建模符号也从概念上帮助组织区分关注点。从实用角度来看，不论如何对关注点进行分类，架构师都需要保证这些维度不磨损。不同的项目有不同的关注点，这导致每个项目都有特定的维度。</p><p>按照架构的维度思考，通过评估重要维度对变化的响应，架构师可以分析不同架构的演进能力。随着系统与互相冲突的问题（伸缩性、安全性、分布式、事务性等）关联得越来越紧密，架构师必须跟踪更多的维度。只有结合所有这些重要维度，思考系统将如何演进，才能构建出可以不断演进的系统。</p><p>项目的整个架构范围由软件需求和其他维度构成。当架构和整个体系随着时间的推移一起演进时，我们可以使用适应度函数来保护架构特征，如图 1-2 所示。</p><div class=pgc-img><img alt=架构师的进化视角｜为你解析演进式架构的概念 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/08a8016cde2946ab9e379cd3c792bf3f><p class=pgc-img-caption>图 1-2：架构由需求和其他维度构成，每个维度都受适应度函数保护</p></div><p>在图 1-2 中，架构师确定了<strong>可审计性</strong>、<strong>数据</strong>、<strong>安全性</strong>、<strong>性能</strong>、<strong>合法性</strong>和<strong>伸缩性</strong>是该应用的关键架构特征。随着业务需求不断变化，每个架构特征都通过适应度函数来保护其完整性。</p><p>我们强调架构整体的重要性，但也应意识到，技术架构模式及相关议题也是架构演进的很大一部分，比如耦合和内聚。</p><p>耦合不只和软件项目的结构元素有关。近来，很多软件公司认识到了团队结构对架构的影。</p><h1><strong>1.5　为何演进</strong></h1><p>对于演进式架构，一个常见的问题是关于其名称的：为什么叫作演进式架构而不是别的？比如<strong>增量式</strong>、<strong>持续式</strong>、<strong>敏捷式</strong>、<strong>响应式</strong>或<strong>应急式</strong>，等等。这些术语都不够准确达意。这里所说的演进式架构包含了两个关键特征：增量和引导。</p><p><strong>持续式</strong>、<strong>敏捷式</strong>和<strong>应急式</strong>都表达了随时间不断变化的概念，这确实是演进式架构的关键特征，但是这些术语都没能准确地表达出架构将如何变化，或者说期望的架构最终是什么样子的。虽然这些术语都隐含着环境变化，但是都没能涵盖架构应有的样子。而在演进式架构的定义中，<strong>引导</strong>的含义反映了我们想实现的架构，即我们的最终目标。</p><p>相比<strong>可适应</strong>这个词，我们倾向于<strong>演进式</strong>，因为我们对经历根本性演变的架构感兴趣，而不是那些经历了修修补补后变得越来越难以理解、复杂问题频发的架构。<strong>适应</strong>意味着解决方案不求优雅或长久，只要能找到方法使系统运作就行。为了构建能实实在在演进的架构，架构师必须支持真正的变化，而不是权宜之计的考虑。回到我们的生物学隐喻，演进是这样一个过程：建立一个适用的并能在其所处的不断变化的环境中持续运行的系统。系统可能存在个别的适应性，但是架构师应该关心整体可演进的系统。</p><blockquote><p>本文节选自《演进式架构》</p></blockquote><div class=pgc-img><img alt=架构师的进化视角｜为你解析演进式架构的概念 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c4b9e77468b247f0b0f40e89269e31e2><p class=pgc-img-caption></p></div><blockquote><p>在软件开发流程中，为了尽可能快地响应各种变化，理应把结构渐进改变作为设计的首要原则。本书详尽阐述了演进式架构的必要性、构建方法以及需要注意的问题。各章结合案例分别讨论了软件架构、适应度函数、开展增量变更、架构耦合、演进式数据、构建可演进的架构、演进式架构的陷阱和反模式，以及实践演进式架构。</p></blockquote></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'构师','进化','视角'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>