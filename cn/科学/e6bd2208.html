<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>分布式架构演进：从概念普及，到架构演变 | 极客快訊</title><meta property="og:title" content="分布式架构演进：从概念普及，到架构演变 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/163ba8e2b7cc4b6baab23c58418fc361"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/e6bd2208.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/e6bd2208.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/e6bd2208.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/e6bd2208.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/e6bd2208.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/e6bd2208.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/e6bd2208.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/e6bd2208.html><meta property="article:published_time" content="2020-11-14T20:51:10+08:00"><meta property="article:modified_time" content="2020-11-14T20:51:10+08:00"><meta name=Keywords content><meta name=description content="分布式架构演进：从概念普及，到架构演变"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/e6bd2208.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>分布式架构演进：从概念普及，到架构演变</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>科学</a></span></div><div class=post-content><div><p><strong>本文将从这几个方面给各位读者朋友讲述分布式架构演进：</strong></p><ul><li>概念普及</li><li>架构演变</li><li>SOA服务治理(Dubbo)</li></ul><hr><h1>概念普及</h1><ol><li>性能、并发瓶颈问题</li><li>缓存、算法、性能</li><li>监控(安全、性能)</li><li>数据库、文件服务系统、消息服务</li><li>集群、负载、容错、代理、</li><li>注册中心</li><li>持续集成、部署</li></ol><p><strong>性能、并发瓶颈问题</strong></p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/163ba8e2b7cc4b6baab23c58418fc361><p class=pgc-img-caption></p></div><p><strong>缓存、算法、锁、性能</strong></p><p><strong>缓存</strong></p><ul><li>客户端缓存、web代理(Squid) 边缘缓存(CDN)</li><li>平台缓存( EHcache, Cacheonix, Voldemort, JBoss Cache )</li><li>应用缓存(memcached、Redis)、数据库缓存</li></ul><p><strong>算法</strong></p><ul><li>线性结构与顺序表、单向链表、循环链表、栈的基本概念</li><li>链式堆栈、中缀表达式、队列、链式队列、串、MyString</li><li>矩阵类、递归算法、哈夫曼树、希尔排序、Hash算法等内容等</li></ul><p><strong>锁概念</strong></p><ul><li>数据库，共享锁、悲观所、乐观锁、排他、读写等、锁的粒度JAVA,自旋锁、悲观锁、乐观锁、对象锁等</li></ul><p><strong>性能</strong></p><p>应用划分</p><ul><li>系统层次、 算法层次、代码层次</li></ul><p>调优分层</p><ul><li>设计调优、代码调优、内存调优、数据库调优、操作系统调优</li></ul><p><strong>监控(安全、性能)</strong></p><p><strong>监控基本分网路监控、系统监控。涉及CPU、内存、磁盘、网络流量、系统进程及Swap状态的多种性能指标</strong></p><ul><li><strong>Zabbix</strong>是一-个基于WEB界面的提供分布式系统监控以及网络监控功能的企业级开源运维平台，也是目前国内互联网用户中使用最广的监控软件。</li><li><strong>Nagios</strong>是一款开 源的企业级监控系统Cache)。</li><li><strong>阿里云监控</strong>是一款免费网站监控产品，可监控站点和服务器，并提供多种告警方式:短信，旺旺，邮件。</li><li><strong>百度云观测</strong>是百度推出的一款云服务产品，类似于360云监控、阿里云监控，主要是为站长提供免费的一站式网站监测、预警服务，功能覆盖网站运行状况、安全和访问速度等多个方面。</li></ul><p><strong>数据库</strong></p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/2c501361899442799c1f9484a763b08f><p class=pgc-img-caption></p></div><p><strong>集群、负载、容错、代理、注册中心</strong></p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dbc939aa367948f48d852bf6d6915924><p class=pgc-img-caption></p></div><p><strong>持续集成、部署</strong></p><ul><li>开发流程阶段：编码 -> 构建 -> 集成 -> 测试 -> 交付 -> 部署</li><li>需要具备：自动化测试、版本控制工具（Git，CVS，SVN 等）;自动化的构建和软件发布流程（Jenkins）</li><li>持续集成的优点：快速（减少大量重复工作）、稳定、安全</li></ul><p><strong>Docker结合Jenkins的持续构建方案</strong></p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d12875c291f347589f98c0f33234e8c1><p class=pgc-img-caption></p></div><h1>架构演变</h1><p><strong>前言</strong></p><p><strong>单架构问题</strong></p><ul><li>复杂应用的开发维护成本变高，部署效率逐渐降低</li><li>团队协作效率差，部分公共功能重复开发，代码重复率居高不下</li><li>系统可靠性变差</li><li>维护和定制困难</li><li>新功能上线周期变长</li></ul><p><strong>分布式架构优势</strong></p><ul><li>廉价高效</li><li>消除单故障点</li><li>平衡负载、提高应用的性能</li><li>降低耦合度</li><li>拆分，分而治之</li></ul><p><strong>初始阶段架构</strong></p><p><strong>特征</strong>：应用程序、数据库、文件等所有的资源都在一台服务器上</p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/87a48d6293734d98abb0233c54322ddb><p class=pgc-img-caption></p></div><p><strong>应用服务和数据服务分离</strong></p><p><strong>特征：</strong>应用程序、数据库、文件分别部署在独立的资源上</p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/0bb7e04fa5924b598d6db1f0e1dc8cf7><p class=pgc-img-caption></p></div><p><strong>使用缓存改善性能</strong></p><p><strong>特征：</strong>数据库中访问较集中的一小部分数据存储在缓存服务器中，减少数据库的访问次数，降低数据库的访问压力</p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/df63e2cc2d6345cf8f22575c5176c659><p class=pgc-img-caption></p></div><p><strong>使用应用服务器集群</strong></p><p><strong>特征：</strong>多台服务器通过负载均衡同时向外部提供服务，解决单台服务器处理能力和存储空间上限的问题</p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ea37cb0b0df94aec8595190bd412df02><p class=pgc-img-caption></p></div><p><strong>数据库读写分离</strong></p><p><strong>特征：</strong>多台服务器通过负载均衡同时向外部提供服务，解决单台服务器处理能力和存储空间上限的问题，数据读写瓶颈得到缓解</p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a1e0717634944c868921c08cc81973e1><p class=pgc-img-caption></p></div><p><strong>反向代理和CDN加速</strong></p><p><strong>特征：</strong>采用CDN和反向代理加快系统的 访问速度</p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6dd3098849ad46a0bf8c742e52289fcc><p class=pgc-img-caption></p></div><p><strong>分布式文件系统和分布式数据库</strong></p><p><strong>特征：</strong>数据库采用分布式数据库，文件系统采用分布式文件系统</p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6a04772b01404b1e91f602b6c457640f><p class=pgc-img-caption></p></div><p><strong>使用NoSQL和搜索引擎</strong></p><p><strong>特征：</strong>系统引入NoSQL数据库及搜索引擎</p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c0fc36254bb842e6b9ebb36171968220><p class=pgc-img-caption></p></div><p><strong>业务拆分</strong></p><p><strong>特征：</strong>系统上按照业务进行拆分改造，应用服务器按照业务区分进行分别部署</p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b9bf578c336a426baaa3a6f6fb298238><p class=pgc-img-caption></p></div><p><strong>分布式服务</strong></p><p><strong>特征：</strong>公共的应用模块被提取出来，部署在分布式服务器上供应用服务器调用</p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/af1353f45e5a48a3b1a94f81866c00aa><p class=pgc-img-caption></p></div><p><strong>结论要点</strong></p><p>空间换时间</p><ul><li>多级缓存、静态化、索引</li></ul><p>并行与分布式计算</p><ul><li>任务切分、分而治之</li><li>多进程、多线程并行执行</li></ul><p>多维度的可用</p><ul><li>负载均衡、容灾、备份</li><li>读写分离</li><li>依赖关系</li></ul><p>伸缩</p><ul><li>拆分、无状态</li></ul><p>资源优化利用</p><ul><li>系统容量有限</li><li>原子操作与并发控制</li><li>基于逻辑的不同，采取不一样的策略</li><li>容错隔离、资源释放</li></ul><h1>SOA服务治理（Dubbo）</h1><p><strong>什么是Dubbo?</strong></p><p>Dubbo是Alibaba开源的分布式服务框架，它最大的特点是按照分层的方式来架构，使用这种方式可以使各个层之间解耦合（或者最大限度地松耦合）。从服务模型的角度来看，Dubbo采用的是一种非常简单的模型，要么是提供方提供服务，要么是消费方消费服务，所以基于这一点可以抽象出服务提供方（Provider）和服务消费方（Consumer）两个角色。Dubbox是Dubbo升级版，现当当技术团结任在维护的版本。国外比较有影响力的类似服务Spring Cloud!</p><p><strong>分布式服务框架</strong></p><p>远程服务调用</p><ul><li>Netty/Mina/Grizzly</li><li>RMI/Hessian/WebService</li></ul><p>服务动态发现</p><ul><li>Zookeeper/Redis</li></ul><p>集群软负载均衡</p><ul><li>Random/RoundRobin</li></ul><p>集群失败容错</p><ul><li>Failover/Failback</li></ul><p><strong>服务治理平台</strong></p><ul><li>依赖关系与关键路键</li><li>服务路由与动态配置</li><li>服务降级与资源劣化</li><li>权重调节与容量评估</li><li>服务授权与黑白名单</li><li>服务SLA与流程管理</li><li>服务测试与Mock</li><li>服务文档与负责人</li><li>……</li></ul><p><strong>为什么使用Dubbo</strong></p><p><strong>优点：</strong></p><ul><li>远程通讯: 提供对多种基于长连接的NIO框架抽象封装，包括多种线程模型，序列化，以及“请求-响应”模式的信息交换方式。</li><li>软负载均衡及容错机制: 提供基于接口方法的透明远程过程调用，包括多协议支持，以及软负载均衡，失败容错，地址路由，动态配置等集群支持。可在内网替代F5等硬件负载均衡器，降低成本，减少单点。</li><li>服务自动注册与发现: 基于注册中心目录服务，使服务消费方能动态的查找服务提供方，使地址透明，使服务提供方可以平滑增加或减少机器。</li><li>提供完善的管理控制台dubbo-admin与简单的控制中心dubbo-monitor 。</li><li>Dubbo提供了伸缩性很好的插件模型，很方便进行扩展。</li><li>支持多协议 。</li></ul><p><strong>使用方法</strong></p><ul><li>Dubbo采用全spring配置方式，透明化接入应用，对应用没有任何API侵入。</li><li>只需用Spring加载Dubbo的配置即可，Dubbo基于Spring的Schema扩展进行加载。</li></ul><p><strong>Dubbo服务框架</strong></p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/a2f237cf0f154dc594bfa2d7540a6c3c><p class=pgc-img-caption></p></div><p><strong>Dubbo服务框架</strong></p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e0cca1327ba54339854ff8d6e120c656><p class=pgc-img-caption></p></div><p><strong>Dubbo服务框架</strong></p><ul><li><strong>服务接口层（Service）</strong>：该层是与实际业务逻辑相关的，根据服务提供方和服务消费方的业务设计对应的接口和实现。</li><li><strong>配置层（Config）：</strong>对外配置接口，以ServiceConfig和ReferenceConfig为中心，可以直接new配置类，也可以通过spring解析配置生成配置类。</li><li><strong>服务代理层（Proxy）</strong>：服务接口透明代理，生成服务的客户端Stub和服务器端Skeleton，以ServiceProxy为中心，扩展接口为ProxyFactory。</li><li><strong>服务注册层（Registry）</strong>：封装服务地址的注册与发现，以服务URL为中心，扩展接口为RegistryFactory、Registry和RegistryService。可能没有服务注册中心，此时服务提供方直接暴露服务。</li><li><strong>集群层（Cluster）</strong>：封装多个提供者的路由及负载均衡，并桥接注册中心，以Invoker为中心，扩展接口为Cluster、Directory、Router和LoadBalance。将多个服务提供方组合为一个服务提供方，实现对服务消费方来透明，只需要与一个服务提供方进行交互。</li><li><strong>监控层（Monitor）</strong>：RPC调用次数和调用时间监控，以Statistics为中心，扩展接口为MonitorFactory、Monitor和MonitorService。</li><li><strong>远程调用层（Protocol）</strong>：封将RPC调用，以Invocation和Result为中心，扩展接口为Protocol、Invoker和Exporter。Protocol是服务域，它是Invoker暴露和引用的主功能入口，它负责Invoker的生命周期管理。Invoker是实体域，它是Dubbo的核心模型，其它模型都向它靠扰，或转换成它，它代表一个可执行体，可向它发起invoke调用，它有可能是一个本地的实现，也可能是一个远程的实现，也可能一个集群实现。</li><li><strong>信息交换层（Exchange）：</strong>封装请求响应模式，同步转异步，以Request和Response为中心，扩展接口为Exchanger、ExchangeChannel、ExchangeClient和ExchangeServer。</li><li><strong>网络传输层（Transport）</strong>：抽象mina和netty为统一接口，以Message为中心，扩展接口为Channel、Transporter、Client、Server和Codec。</li><li><strong>数据序列化层（Serialize）</strong>：可复用的一些工具，扩展接口为Serialization、 ObjectInput、ObjectOutput和ThreadPool。</li></ul><p><strong>Dubbo服务框架</strong></p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/eb686a18acbd49cabee830ef6358fc0c><p class=pgc-img-caption></p></div><p><strong>无侵入透明调用</strong></p><p><strong>暴露服务</strong></p><pre>&lt;bean id="helloService” class="com.alibaba.hello.impl.HelloServiceImpl" /&gt;</pre><pre>&lt;dubbo:service interface="com.alibaba.hello.HelloService” ref=" helloService “ /&gt;</pre><p><strong>引用服务</strong></p><pre>&lt;bean id=“xxxAction“ class=“com.alibaba.xxx.XxxAction" &gt; &lt;property name=“helloService" ref=“helloService" /&gt;&lt;/bean&gt;</pre><pre>&lt;dubbo:reference id=“helloService“ interface=“com.alibaba.hello.HelloService” /&gt;</pre><p><strong>常用配置</strong></p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5dc98e0f34eb42248cd1c31bb2373623><p class=pgc-img-caption></p></div><p><strong>谁在用Dubbo?</strong></p><p>2011年底开源</p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9b01dee58e4647a08ea7edd688275e0f><p class=pgc-img-caption></p></div><p><strong>谁在用Dubbo?</strong></p><p>1000+应用，2000+服务 10,000,000,000+调用/天</p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/127cf028022a435892bf43b6112be544><p class=pgc-img-caption></p></div><p><strong>为什么要服务化？</strong></p><p><strong>提升业务建模效率</strong></p><ul><li>统一领域模型</li><li>规范依赖关系</li><li>划分问题边界</li></ul><p><strong>提升开发部署效率</strong></p><ul><li>降低代码干扰</li><li>减少合并冲突</li><li>加速项目编译</li><li>强契约逻辑复用</li><li>方便替换实现</li></ul><p><strong>提升线上集群效率</strong></p><ul><li>缩小集群规模，小规模增加机器收益最高</li><li>分离串行因素，使多数集群并行因子增大</li><li>垂直拆分应用，减少瓶颈资源竞争</li><li>功能降级，故障隔离</li></ul><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c892e5b3664340be850992153bfa9f48><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0e9bdc0387cd4d369da9c39dac4ddf21><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/45e26131270f49cdac3499322847ccea><p class=pgc-img-caption></p></div><p><strong>服务框架设计原则</strong></p><div class=pgc-img><img alt=分布式架构演进：从概念普及，到架构演变 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f8f5bd0f08f848a2b0884b44cf1e6ea6><p class=pgc-img-caption></p></div><p><strong>看完别忘记点个关注哦！</strong></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'架构','演进','演变'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>