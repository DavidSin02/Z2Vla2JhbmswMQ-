<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>VLOOKUP说他是最强的，LOOKUP表示不服 | 极客快訊</title><meta property="og:title" content="VLOOKUP说他是最强的，LOOKUP表示不服 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/321c000324abe52b29e1"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/f7759d3.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/f7759d3.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/f7759d3.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/f7759d3.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/f7759d3.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/f7759d3.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/f7759d3.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/f7759d3.html><meta property="article:published_time" content="2020-10-29T21:03:51+08:00"><meta property="article:modified_time" content="2020-10-29T21:03:51+08:00"><meta name=Keywords content><meta name=description content="VLOOKUP说他是最强的，LOOKUP表示不服"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/f7759d3.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>VLOOKUP说他是最强的，LOOKUP表示不服</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>科学</a></span></div><div class=post-content><div><p><img alt=VLOOKUP说他是最强的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/321c000324abe52b29e1></p><p class=pgc-img-caption>图\文 | 朱莉</p><p>说起查找与引用函数，大家最熟悉的莫过于VLOOKUP了。其实它一个家族中的另一个兄弟，LOOKUP函数比它的功能更为强大，想要更好的处理数据的查找与引用，千万不要错过它！<br></p><h1><strong>01、</strong><strong>LOOKUP函数语法</strong></h1><p>LOOKUP函数的语法有两种：</p><p><strong>1、向量式：</strong></p><p>向量式是使用的更多的一种形式：</p><p>第一参数是要查找的值；</p><p>第二参数为一行或者一列，是被查找的区域。</p><p>第三参数是返回哪行或者哪列的结果，这里第三参数要求与第二参数有一样的尺寸。</p><p>比如第二参数是一列，B2到B5，第三参数是C1到C6，这样就是不可以的。</p><p><img alt=VLOOKUP说他是最强的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/321c000324ac05fbefb2></p><p><strong>2、数组式：</strong></p><p>=LOOKUP(lookup_value,array)</p><p>第二参数array, 是一个多行多列的区域。<strong>这个区域的首列须包含要查找的值，返回对应最后一列的值。</strong></p><p>这两种方式，有的时候可以实现相同的功能，区别只是写法不同； 也有的功能只能用其中一种的写法。下面用栗子来给大家详细展现。</p><h1><strong>02、</strong><strong>LOOKUP模糊查找</strong></h1><p><strong>个人所得税税率查询：</strong></p><p>（模糊匹配，类似VLOOKUP）</p><p>应纳税的工资（减去3500之后），查找应使用的税率时，没有完全一样的数值，将<strong>返回小于它的最大值</strong>。</p><p>F2单元格中的公式为（向量式）：</p><p>=LOOKUP(E2,$A$2:$A$5,$C$2:$C$5)</p><p>$A$2:$A$5 是要查找的区域；</p><p>$C$2:$C$5 是对应返回的结果。</p><p>例子中工资5000在左边的表格中找不到，将返回小于它的最大值，也就是4500对应的结果，20%（虚构数值，仅供参考）。</p><p><img alt=VLOOKUP说他是最强的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/321c00032856eeaa5dc5></p><p>这个例子中，还可以使用数组的方式，结果是一样的：</p><p>=LOOKUP(E2,$A$2:$C$5)</p><p><img alt=VLOOKUP说他是最强的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/321c000324ad7199deb2></p><p><strong>注意：在用LOOKUP进行模糊匹配的查询时，第二参数须以升序排列。</strong></p><h1><strong>03、</strong><strong>LOOKUP反向查找</strong></h1><p>由于LOOKUP函数向量式的写法中，被查找的区域，和结果返回的区域是分开写的，所以可以应用在，要返回的结果在被查找区域之前的情况。</p><p>例如，知道员工工号的情况下，要在左边的表中查找员工的姓名。</p><p><img alt=VLOOKUP说他是最强的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/32260002fdd574c0ba81></p><p>E2中的公式为：</p><p>=LOOKUP(D2,$B$2:$B$8,$A$2:$A$8)</p><p>B2至B8是要查找的区域，返回A2至A8对应的结果。</p><p>需要注意的是，LOOKUP函数默认在找不到完全一致的值时，会按模糊匹配来处理，返回一个接近的值（小于它的最大值对应的结果）。</p><p>所以，如果要查找的值，可能在被查找区域不存在，又需要精确匹配时，不要使用这种方式。</p><h1><strong>04、</strong><strong>条件查询</strong></h1><p>0/条件 其实是一大类用法的总结。</p><p>公式写作：</p><p><strong>=LOOKUP(1,0/(条件),目标区域或数组)</strong></p><p>这里的“条件”可以是多种多样的。我们可以根据不同的需求，构建不同的“条件”。利用“<strong>0除以任何数都得0</strong>”和“<strong>0除以错误值还是错误值</strong>”的原理，得到一串0和错误值组成的数组。</p><p>我们要找的是“1”，在找不到“1”时，返回最后一个“0”对应的值。（LOOKUP自动屏蔽错误值）</p><p>“条件”如何构建，决定能发挥怎样的作用。下面几种常见用法的举例。</p><p><strong>①</strong> <strong>求同一值最后一次出现的情况：</strong></p><p>我们想求某值最后一次出现的结果<strong>，可以先通过使用一个条件，将出现这个值的情况挑选出来。</strong></p><p><img alt=VLOOKUP说他是最强的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/32260002fdd74f16e44d></p><p>这个例子中用到的“条件”就是：</p><p>=FIND(E3,$B$3:$B$11)</p><p><strong>这个FIND函数的作用是，在B3到B11区域中，挨个单元格去查找，E3的值在这个单元格中的位置。</strong></p><p>E3中是“张三”，B3中“张三”是从第一个字符开始的，所以返回1.</p><p>同理，B4和B5都会返回1。在找不到我们要的结果的时候，会返回错误值：#VALUE!.</p><p>也就是，<strong>符合条件时会返回一个非零数字，不符合条件时会返回错误值。</strong></p><p>所以刚才的“条件”就会得到：</p><p>=FIND(E3,$B$3:$B$11)</p><p>={1,1,1,#VALUE!,#VALUE!,#VALUE!,#VALUE!,#VALUE!,#VALUE!}</p><p>=0/FIND(E3,$B$3:$B$11)</p><p>={0,0,0,#VALUE!,#VALUE!,#VALUE!,#VALUE!,#VALUE!,#VALUE!}</p><p>错误值会被LOOKUP函数排除掉，剩下就是在符合条件的值中进行运算。</p><p>最原始的公式就会变成：</p><p>=LOOKUP(1,0/FIND(E3,$B$3:$B$11),$C$3:$C$11)</p><p>=LOOKUP(1,{0,0,0},$C$3:$C$11)</p><p>由于我们要找1，而查找区域只有0，找不到1时，会返回最后一个0对应的结果。这个案例中就是第3个0对应的值，也就是B5单元格对应的结果C5。</p><p>总结一下0/[条件]的用法就是，通过构建一个“条件”，所有符合条件的值返回一个非零数字， 不符合条件的值返回一个错误值。</p><p>此案例中，“条件”同样可以用别的方式来构建。</p><p>比如：</p><p>=LOOKUP(1,0/<strong>($B$3:$B$11=E3)</strong>,$C$3:$C$11)</p><p>这个公式中：</p><p>$B$3:$B$11=E3，作为一个判断条件，当单元格等于E3时返回TRUE（1）,不等于时返回FALSE(0)。这些结果被0除以后，得到跟前面一样的数组。</p><p>{0,0,0,#VALUE!,#VALUE!,#VALUE!,#VALUE!,#VALUE!,#VALUE!}</p><p><strong>② 多条件查找：</strong></p><p>多条件查找其实就是上面公式的一个变种。</p><p>写作：</p><p><strong>=LOOKUP(1,0/((条件1)*(条件2)*……*(条件N)),目标区域）</strong></p><p>多个条件之间使用乘号连接，表示当列出的条件同时满足时的结果。如果有多个行出现同时满足条件，则返回最后一个。</p><p>下面这个例子中，我们需要班级和姓名两个条件同时满足时，对应的结果。</p><p><img alt=VLOOKUP说他是最强的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/321c000324af029851f6></p><p>I2中的公式为：</p><p>=LOOKUP(1,0/(($B$3:$B$8=F3)*($C$3:$C$8=G3)),$D$3:$D$8)</p><p>这两个条件分别是：</p><p>B3到B8中等于F3，和C3到C8中等于G3。</p><p>同时满足时，将返回D3到D8对应的结果。</p><p><strong>③ 某列最后一个值（非空单元格）：</strong></p><p>下面表格中，记录了顾客每个月到店的次数。现在我们要统计每个顾客最后一次到店的时间。</p><p><img alt=VLOOKUP说他是最强的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/32260003029fba6b700e></p><p>B15单元格中的公式为：</p><p>=LOOKUP(1,0/<strong>(B3:B14&lt;>"")</strong>,$A$3:$A$14)</p><p>其中，</p><p>B3:B14&lt;>"" 表示B3到B14不为空的单元格。满足条件为TRUE（1），不满足为FALSE（0）。原理跟上面的相同。</p><p>最后一个不是空的单元格是B10，对应返回结果A10，也就是2016年8月。</p><p>公式向右复制，第二参数B3:B14是相对引用，会向右跟着改变。第三参数$A$3:$A$14为绝对引用，无论公式复制到哪，都会返回这一列中的内容。</p><blockquote><p>关于LOOKUP函数的原理，到目前为止我相信已经够大家套用公式来使用了。如果想进一步了解它查找的原理，需要了解二分法的原理。</p></blockquote><p><strong>-END-</strong></p><blockquote><p><strong>作者：</strong>安伟星，微软Office认证大师，领英中国专栏作者，《竞争力：玩转职场Excel，从此不加班》图书作者。</p></blockquote></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'VLOOKUP','最强','LOOKUP'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>