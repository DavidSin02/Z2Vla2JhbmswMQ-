<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>中继器使用场景（三）：轮播图当前图放大效果 | 极客快訊</title><meta property="og:title" content="中继器使用场景（三）：轮播图当前图放大效果 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/1535944744253d20365a371"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/fc0a6cfc.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/fc0a6cfc.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/fc0a6cfc.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/fc0a6cfc.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/fc0a6cfc.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/fc0a6cfc.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/fc0a6cfc.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/fc0a6cfc.html><meta property="article:published_time" content="2020-11-14T20:53:31+08:00"><meta property="article:modified_time" content="2020-11-14T20:53:31+08:00"><meta name=Keywords content><meta name=description content="中继器使用场景（三）：轮播图当前图放大效果"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/fc0a6cfc.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>中继器使用场景（三）：轮播图当前图放大效果</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>科学</a></span></div><div class=post-content><blockquote><p>本文以“人人都是产品经理”手机app原型为例，讲解轮播过程中的，侧图留框、主图放大的功能，以及自动轮播和手动拖动的实时切换。（末尾有彩蛋）</p></blockquote><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1535944744253d20365a371><p>现在手机app中我们经常能看到有放大，并且两边有前后图片留框的轮播效果，同时支持手动拖动和自动轮播两种形式。我以“人人都是产品经理”手机app为例，做了高保真原型。</p><p><strong>具体GIF演示如下：</strong></p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15359447439700341229ee0><p>这里轮播形式是目前手机app开窗惯用的形式，具体特点：</p><p>（1）主内容图片两侧有前后图片的边框。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15359447445454ee790d587><p>（2）开窗显示的主图片尺寸会自动放大，在本原型中，主图片的高度比前后图片要增高。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15359447441336ad3c98539><p>（3）进入页面后自动轮播，支持左右拖动，拖动结束后，若无继续操作，将再次进入自动轮播状态。</p><p><h2><strong>思路</strong></h2></p><p>（1）为何不能用动态面板的轮播功能</p><p>因为两侧有前后图片留框效果，如果只是简单的用动态面板不同state之间的轮播是达不到此效果的。</p><p>（2）是否可以用动态面板，移动里面的图片的同时，改变图片座标，来达到轮播的效果</p><p>因为里面有“主图片自动放大，次图片自动缩小”的特效，如果用上述方法会非常繁琐。</p><p>（3）整体思路：</p><ol><li>两侧有前后图片留框效果——用到动态面板的遮罩功能；</li><li>手动、自动轮播切换效果——用到动态面板的“循环开关”功能；</li><li>图片循环轮转——中继器实时排序功能；</li><li>主图片放大效果——尺寸改变交互功能。</li></ol><p><h2><strong>操作步骤</strong></h2></p><p>（1）准备动态面板mask，在属性中，取消选择“自动调整为内容尺寸”选项。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1535944744454ab24c8fd13><p>（2）在mask的State1中放入五个图片元件标志，不要导入具体图片，并命名为1、2、3、4、5。因为此处只是让图片占位符确定位置，具体的图片内容靠后面讲的中继器赋值。</p><p>将五个图片排成一排，中间略有隔开，其中第二张图片（命名2）调整为样例中主图片大小（原型中主图片尺寸为宽316×高159），其他四张图片的高度比图片2矮一些（原型中其他图片尺寸为宽366×高144）。</p><p>然后编组组合为一体，摆放位置为正好第一张图片在动态面板左侧外。</p><p>具体过程看gif：</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1535944746252eb782c4c64><p>（3）准备中继器</p><p>在页面的空白处（注意不是在动态面板里），拖入一个中继器，将里面的矩形删除，不用放入任何元件，只需在数据集中，建两列，number列输入12345共计5行，img列对应导入我们需要展现的5张图片。</p><p>具体过程看GIF，这步非常重要。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153594474775469f985a8e8><p>然后在<strong>中继器中</strong>继续操作，在中继器<strong>“载入时”</strong>，加入交互，按“number列”进行升序排列。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535944747241d6733b7e82><p>接下来的交互非常重要，是我们常规对于中继器的反操作。之前我们大部分案例，是外部元件为中继器赋值，现在是中继器为外部元件赋值，具体如下：</p><p><strong>以Case1</strong>为例：</p><p><strong>条件：</strong>if “[[Item.index]]” == “1”</p><p><strong>解释：</strong>index函数的用途：获取数据行的索引编号，编号起始为1，由上至下每行递增1。是系统自动生成的，不随行数剧变化而变化，就像Excel中的表格左侧的行号。</p><p><strong>交互：</strong>设置动态面板mask里的图片组合中的图1（排在第一个的图片）==中继器中行号为1的img列里的片，即我们在中继器img导入的图片，即动态面板图1的位置显示的是中继器中index==1的里的图片内容。</p><p><strong>解释：</strong>因为之前我们制作的动态面板里的图片都是元件图标，没有导入具体的图片，现在将动态面板中的5个图片分别绑定为中继器中的5个index里的图片。后续会利用中继器的排序功能为动态面板实现循环效果。</p><p>以同样的方法设置图片2、3、4、5。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15359447453953bfcc5c353><p>（4）为动态面板mask添加交互</p><p>4.1 向左拖动结束时</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15359447455177f020392fd><p><strong>第一步：</strong>移动动态面板里的图片组合向左侧移动X座标“相对”位置-322。这个数值自己去调整，在动态面板中拖动位置，自己计算起始位置到拖动位置的差值即可。注意选择的是相对位置即“经过”，因为这样的话不用设置y座标，加上线性动画500毫秒。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535944748352fc03170f4d><p><strong>第二步：</strong>当图片组合向左挪动一格后，挪出屏幕的是动态面板图2的位置并显示的是中继器index==2的图片内容，目前就是中继器中的图片2。同理显示在主屏幕的应该是动态面板图3的位置，并显示的是中继器index==3的图片内容，目前就是中继器中的图片3，所以设置原来是大图的图片2高度变小，原来是小图的图片3变大。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1535944749497af72a15997><p><strong>第三步：</strong>等待550毫秒，这里我要重点说一下“等待”这个交互。因为我们上面几步的交互中都有线性动画500毫秒的设置，如果在后续的动作中，强调是“同步性”即在上述500毫秒的线性动画进行的同时，去做其他动作，这里可以不用加入“等待”交互。</p><p>如果强调“先后性”，即在500毫秒动画结束后，进行接下来的动作，那么必须在两个动作之间加入＞500毫秒的等待时长。因为接下来的第四步交互是要在上述动作全部完结后再进行，所以要加入550毫秒的等待。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535944748727590d220503><p><strong>第四步：</strong>烧脑时刻，我们要给中继器重新排序，造轮播效果。</p><p>为中继器更新行，更新条件为[[TargetItem.index==1]]即中继器的第一行，注意上面所说的index的含义。</p><p>更新列为：number列。</p><p>更新为：[[Item.number+TargetItem.Repeater.dataCount]]即第1行（TargetItem.index==1）的number列值为1，现在更新为1+5=6，这里的TargetItem.Repeater.dataCount是指该中继器中数据的总行数，本中继器一共5行数据，所以为1+5=6。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535944751299a37797e7fb><p>因为，中继器在载入时设置了以number数值为准，做升序排列，所以作为这一步，原图片顺序的变化为：</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535944750523f789a731af><p>上述顺序，大家静下心捋一捋就能明白，关键点：</p><ul><li>index数字是系统自带行标，不能改变的，就如同excel中左侧的一列数字。</li><li>number列的数字，是为了排序用。</li><li>动态面板里的图片占位符是为了确定位置。</li></ul><p><strong>到了这一步，我们看看效果gif：</strong></p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/15359447521476cfdb2e4e2><p><strong>第五步：</strong>大家会发现，当我们拖动动态面板时，主窗口图片由图2变为图3并放大后，很快就切入下一轮播，即直接跳到图片4，但是我们的原型是需要靠人为的主动拖动，将图片进行轮播。所以我们在完成位置重排后，将提前播放的图片4再拉回去。注意动画要选无。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153594475204360be8962a4><p><strong>第六步：</strong>重新排序后，被拉回主窗口的是动态面板中图片2的位置，所以将其改为大图显示，同理将被拉出橱窗外的动态面板中的图3位置改为小图，注意动画要选无。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1535944752259888738478f><p>到这步，向左滑动交互全部完成，图片的轮播顺序变化总结如下：</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535944751678e77bd6efb9><p>4.2 同样的方法为动态面板添加交互——向右拖动结束时</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535944751764442a526db9><p>详细步骤不再赘述，基于向左拖动，向右拖动很多数值和图片位置的计算正好相反，简单的给大家划一下重点：</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535944752943347fc78951><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1535944752777e74eb3ecbb><p><strong>下面这步条件为：[[TargetItem.index==TargetItem.Repeater.dataCount]]。</strong></p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535944753640c605bc1a94><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153594475375424f659dd64><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15359447526228e8028b17b><p>到这步，向右滑动交互全部完成。</p><p><h2>为轮播加入“自动轮播”和“取消自动轮播”以及“恢复自动轮播功能”的交互</h2></p><p><strong>第一步：</strong>我们在页面新拖入一个动态面板，命名auto，分别加入两个状态，state1和state2，每个状态里没有任何内容。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15359447552823af51c1e06><p><strong>第二步：</strong>在动态面板auto载入时，加入自动轮播的交互。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1535944754442f7a21d29f5><p><strong>第三步：</strong>在动态面板auto状态改变时，加入“触发”之前包含图片的mask动态面板向左拖动结束时的交互，即状态每改变一次，就向自动左拖动一次。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535944756325f13fbd3000><p>到这步就实现了动态面板mask自动轮播的效果，接下来，我们来实现解除和恢复自动轮播的效果，即当人工进行拖动时，自动轮播停止，当不再拖动时，自动轮播恢复。</p><p><strong>第四步（接上面）：</strong>在动态面板mask（含图片组合的大动态面板）“鼠标按下”时，加入交互。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/153594475507559fec5602a><p><strong>第五步：</strong>在动态面板mask（含图片组合的大动态面板）“鼠标移出”时，加入交互，即当不再进行操作时，重新触发auto动态面板载入时自动轮播的交互。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535944757491b79f88e5c4><p>至此，所有交互全部完成。</p><p>用上述方法可以制作很多网站流行的放大轮播效果。</p><img alt=中继器使用场景（三）：轮播图当前图放大效果 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15359447579550b3edf3f6e><p>本文由 @ bobowang 原创发布于人人都是产品经理。未经许可，禁止转载</p><p>题图来自Unsplash，基于CC0协议</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'中继器','场景','轮播'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>