<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>支持向量机是人工智能领域中的重要算法模型，如何使用？ | 极客快訊</title><meta property="og:title" content="支持向量机是人工智能领域中的重要算法模型，如何使用？ - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/0ae34f4b384148139f240ab0e2070245"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/fed6def1.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/fed6def1.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/fed6def1.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/fed6def1.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/fed6def1.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/fed6def1.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%a6/fed6def1.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%a6/fed6def1.html><meta property="article:published_time" content="2020-10-29T21:13:00+08:00"><meta property="article:modified_time" content="2020-10-29T21:13:00+08:00"><meta name=Keywords content><meta name=description content="支持向量机是人工智能领域中的重要算法模型，如何使用？"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E5%AD%A6/fed6def1.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>支持向量机是人工智能领域中的重要算法模型，如何使用？</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E5%AD%A6.html>科学</a></span></div><div class=post-content><h1>人工智能专栏推荐</h1><div class=tt-column-card data-content='{"new_thumb_url": "http://sf1-ttcdn-tos.pstatp.com/img/pgc-image/1556526677099060c5a36ff", "title": "\u6bcf\u59295\u5206\u949f\u5feb\u901f\u73a9\u8f6c\u673a\u5668\u5b66\u4e60\u7b97\u6cd5", "url": "", "price": 56.88, "column_id": "1611085938512899", "content": "", "author_description": "\u5e7b\u98ce\u7684AI\u4e4b\u8def", "share_price": 22.75, "thumb_url": "http://p0.pstatp.com/large/pgc-image/1556526677099060c5a36ff", "sold": 1710}'><p class=column-placeholder></p></div><div class=tt-column-card data-content='{"new_thumb_url": "http://sf1-ttcdn-tos.pstatp.com/img/mosaic-legacy/fe3f00002562ef2bf82e", "title": "\u6bcf\u5929\u4e94\u5206\u949fpython\u7f16\u7a0b\u548c\u6570\u636e\u5206\u6790", "url": "", "price": 46.6, "column_id": "1626154665784323", "content": "", "author_description": "\u5e7b\u98ce\u7684AI\u4e4b\u8def", "share_price": 14.91, "thumb_url": "http://p10.pstatp.com/large/mosaic-legacy/fe3f00002562ef2bf82e", "sold": 513}'><p class=column-placeholder></p></div><h1>正文</h1><h1>数据的读取和预处理</h1><p>现在有一个文件名称为：ex6data1.mat，这个文件的格式不是python的格式，它是matlib的格式，但是python也可以进行相关的读取操作。</p><pre>import scipy.io as sio</pre><pre>mat = sio.loadmat('ex6data1.mat')#读取mat数据的方式</pre><pre>print(mat.keys())#查看mat文件中的所有变量</pre><p>可以使用scipy.io方式来读取mat文件，使用loadmat方法来加载这个文件，我们输出这个文件的所有的变量，结果为：</p><p>dict_keys(['__globals__', '__version__', 'y', 'X', '__header__'])</p><p>这个表示在这个数据文件中有5个变量，其中我们只是用两个变量，分别是X和Y，X表示我们的样本，而Y表示我们的样本所对应的而标签</p><p>既然我们训练我们的svm的模型，那么我们就只获取到我们想要的样本x和标签y就可以了。</p><pre>data = pd.DataFrame(mat.get('X'), columns=['X1', 'X2'])</pre><pre>data['y'] = mat.get('y')</pre><pre>print (data)</pre><p>我们使用mat.get（X）为获取到我们数据中的X变量，但是此时的变量是&lt;class 'numpy.ndarray'>类型的我们输出它为：</p><div class=pgc-img><img alt=支持向量机是人工智能领域中的重要算法模型，如何使用？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0ae34f4b384148139f240ab0e2070245><p class=pgc-img-caption></p></div><p>我们将其进行转换转成pandas的DataFrame类型，并且指定数据的列名分别为x1和x2，此时我们data为：</p><div class=pgc-img><img alt=支持向量机是人工智能领域中的重要算法模型，如何使用？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/845c4b1be11d4c339e6a3a1dbb8c0918><p class=pgc-img-caption></p></div><p>此时的data是DataFrame类型，这就是二者的不同之处，此时我们data['y'] = mat.get('y')获取到y，直接赋值给data，其中mat.get('y')为ndarray，赋值给data['y']之后，我们的data['y']就会自动变成&lt;class 'pandas.core.series.Series'>类型，其实我们可以把Series可以理解为带索引的ndarray，DataFrame类型中的一列其实就是Serise类型，我们最终输出data，最终的结果为:</p><div class=pgc-img><img alt=支持向量机是人工智能领域中的重要算法模型，如何使用？ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/03d3bd6ca46d4c16b8166431a34c3b04><p class=pgc-img-caption></p></div><p>这个就相当于预处理好了，就是我们想要的那个数据集，有两个特征x1和x2，还有一个标签y，那么下面我们。就可以使用svm进行训练了</p><h1>模型的训练</h1><p>再训练之前我们先把我们的当前数据集的图给画出来</p><pre>fig, ax = plt.subplots(figsize=(8,6))</pre><pre>ax.scatter(data['X1'], data['X2'], s=50, c=data['y'], cmap='Reds')#c表示颜色</pre><pre>ax.set_title('Raw data')</pre><pre>ax.set_xlabel('X1')</pre><pre>ax.set_ylabel('X2')</pre><pre>plt.show()</pre><p>我们使用matplotlib画出散点图效果为:</p><div class=pgc-img><img alt=支持向量机是人工智能领域中的重要算法模型，如何使用？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/074a24c95d5148a1b8896c331bdd90f6><p class=pgc-img-caption></p></div><p>我们可以看出这就是数据的大概的一个分布的情况，下面我们使用sklearn库封装好的svm算法来对数据进行训练。</p><p>svc1 = clf = svm.SVC(C=10,kernel='linear')</p><p>svc1.fit(data[['X1', 'X2']], data['y'])</p><p>这里因为我们的数据基本线性可分，所以没有必要使用核函数来处理这个数据，至于松弛变量C是多少，我们只能去一点一点的来尝试。这里我们使用C=1，然后分类器训练时的损失函数是hinge，然后我们来拟合这个数据fit，最终得到的svc1就是我们想要的训练的svm的模型</p><p>我们可以查看我们的训练模型的训练准确率是多少</p><p>accuracy=svc1.score(data[['X1', 'X2']], data['y'])#训练集准确率</p><p>结果就是0.980392156863，这就是我们训练数据的精确度</p><p>如果要是想要查看我们的决策函数值我们可以使用decision_function方法，查看我们每个样本的正副值，正样本越大于0，表示越正，负样本越小于0表示越负，最终我们可以看到所有样本的决策函数值为：</p><div class=pgc-img><img alt=支持向量机是人工智能领域中的重要算法模型，如何使用？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4ca81db632ca400b914643fd22cb885b><p class=pgc-img-caption></p></div><p>我们可以通过查看每个类别预测的置信水平来看出这一点，这是该点与超平面距离的函数。</p><h1>每个样本的决策函数值</h1><p>我们下面再来画一幅图只不过这幅图不再按照正负样本进行画图，而是根据每个样本的决策函数值进行画图，画图的代码为：</p><p>fig, ax = plt.subplots(figsize=(8,6))</p><p>ax.scatter(data['X1'], data['X2'], s=50, c=data['SVM1 Confidence'], cmap='RdBu')</p><p>ax.set_title('SVM (C=1) Decision Confidence')</p><p>plt.show()</p><p>画图的效果为：</p><div class=pgc-img><img alt=支持向量机是人工智能领域中的重要算法模型，如何使用？ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/91a0c94b7fdd41c58afdfda768bd5e99><p class=pgc-img-caption></p></div><p>下面的任务是画出分割超平面和支撑超平面，首先我们先来分析一下这个应该怎么画比较合适，就拿这个图的数据可知，我们有两个特征x1和x2，我们的分割超平面的方程为w1x1+w2x2+b=0，我们完全可以把x1看着是自变量，x2看作是因变量，这样我们就可以在这个图中画出一条直线，所以我们的方程变成了</p><p>所以我们只需要构造出这个方程来，我们的纵座标的x2就有了，x1我们可以随机产生，然后使用画图工具画图就ok了，代码为：</p><pre>w=svc1.coef_[0]#获取W</pre><pre>b=svc1.intercept_[0]#获取b</pre><pre>w1=w[0]#获取w1</pre><pre>w2=w[1]#获取w2</pre><pre>x1=np.linspace(-5,5)#随机生成1，这可以保证x1的连续性</pre><pre>xx2=-w1/w2*x1-b/w2#按照刚才的公式获得x2</pre><p>现在x1和x2有了，下面我们使用画图工具来画出这个分割平面</p><p>plt.plot(x1,x2,'k-')</p><p>效果为：</p><div class=pgc-img><img alt=支持向量机是人工智能领域中的重要算法模型，如何使用？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/11c9c641cbf24450b5d48abce6fb09e1><p class=pgc-img-caption></p></div><p>下面我们画上支撑超平面（这里要注定一点的是支撑超平面其实就是y=w1x1+w2x2+b-1或者y=w1x1+w2x2+b+1），但是这里我们使用x2作为因变量，所以现在就不能这样思考这个问题了，因为我们现在画图没有使用因变量y。</p><p>我们知道分割超平面和支撑超平面之间是平行的关系，所以首先我们的斜率-w1/w2现在已经有了，此时我们再求出截距b就可以了（截距相差不是1，这个不要和y=。。弄混）。我们可以设支撑超平面的方程为y=-w1/w2x+b。此时b=y+w1/w2x，所以只要找到这两条支撑超平面上的任意一点带入就可以得到b了，支撑超平面上的点很好找，因为支撑向量就再支撑超平面上。</p><p>supportb = svc1.support_vectors_[0]#第一个支撑向量</p><p>yy_down = a*x1 + (supportb[1] - a*supportb[0])</p><p>supportb = svc1.support_vectors_[-1]#最后一个支撑向量</p><p>yy_up = a*x1 + (supportb[1] - a*supportb[0])</p><p>之所以支撑向量选一个0和一个-1的目的就是为了让我们选出的支撑向量恰好是两条支撑超平面上的向量（这有时也会出一些问题，所以这里要注意一下，这只是暂定的方法，这里我实际上用的是-2，效果更好），我们带入公式可以得出两条支撑超平面的d了，下面我们画图：</p><p>plt.plot(x1,yy_down,'k-')</p><p>plt.plot(x1,yy_up,'k-')</p><p>显示的效果为：</p><div class=pgc-img><img alt=支持向量机是人工智能领域中的重要算法模型，如何使用？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5695d38108d84a228639ed9bb9e9b522><p class=pgc-img-caption></p></div><h1>全部代码为：</h1><pre>import numpy as np</pre><pre>import pandas as pd</pre><pre>from sklearn import svm</pre><pre>import seaborn as sns</pre><pre>import scipy.io as sio</pre><pre>import matplotlib.pyplot as plt</pre><pre>#数据预处理</pre><pre>mat = sio.loadmat('ex6data1.mat')#读取mat数据的方式</pre><pre>print(mat.keys())#查看mat文件中的所有变量</pre><pre>data = pd.DataFrame(mat.get('X'), columns=['X1', 'X2'])</pre><pre>data['y'] = mat.get('y')</pre><pre>#画出我们所有的数据，可以看出数据的大概的分布</pre><pre>fig, ax = plt.subplots(figsize=(8,6))</pre><pre>ax.scatter(data['X1'], data['X2'], s=50, c=data['y'], cmap='Reds')</pre><pre>ax.set_title('Raw data')</pre><pre>ax.set_xlabel('X1')</pre><pre>ax.set_ylabel('X2')</pre><pre>#拟合我的数据svm</pre><pre>svc1= svm.SVC(C=10,kernel='linear')</pre><pre>svc1.fit(data[['X1', 'X2']], data['y'])</pre><pre>#训练集准确度</pre><pre>accuracy=svc1.score(data[['X1', 'X2']], data['y'])#训练集准确率</pre><pre>#构造切分超平面的直线</pre><pre>w=svc1.coef_[0]#获取W</pre><pre>b=svc1.intercept_[0]#获取b</pre><pre>w1=w[0]#获取w1</pre><pre>w2=w[1]#获取w2</pre><pre>x1=np.linspace(-5,5)#随机生成1，这可以保证x1的连续性</pre><pre>x2=-w1/w2*x1-b/w2#按照刚才的公式获得x2</pre><pre>#构造支撑超平面的直线</pre><pre>a = -w[0]/w[1]</pre><pre>supportb = svc1.support_vectors_[0]#第一个支撑向量</pre><pre>yy_down = a*x1 + (supportb[1] - a*supportb[0])</pre><pre>supportb = svc1.support_vectors_[-2]#最后一个支撑向量</pre><pre>yy_up = a*x1 + (supportb[1] - a*supportb[0])</pre><pre>#画出这三条直线</pre><pre>plt.plot(x1,x2)</pre><pre>plt.plot(x1,yy_down)</pre><pre>plt.plot(x1,yy_up)</pre><pre>plt.show()</pre><pre>#决策值</pre><pre>data['SVM1 Confidence'] = svc1.decision_function(data[['X1', 'X2']])</pre><pre>#根据决策值画图</pre><pre>fig, ax = plt.subplots(figsize=(8,6))</pre><pre>ax.scatter(data['X1'], data['X2'], s=50, c=data['SVM1 Confidence'], cmap='RdBu')</pre><pre>ax.set_title('SVM (C=1) Decision Confidence')</pre><pre>w=svc1.coef_[0]</pre><pre>b=svc1.intercept_[0]</pre><pre>w1=w[0]</pre><pre>w2=w[1]</pre><pre>xx1=np.linspace(-5,5)</pre><pre>xx2=-w1/w2*xx1-b/w2</pre><pre>plt.plot(xx1,xx2)</pre><pre>plt.show()</pre></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'机是','领域','人工智能'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>