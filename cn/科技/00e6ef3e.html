<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>R语言入门之使用函数sample进行抽样 | 极客快訊</title><meta property="og:title" content="R语言入门之使用函数sample进行抽样 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/5759e22b072d430b8aa7aa521dacd3a6"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/00e6ef3e.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/00e6ef3e.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/00e6ef3e.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/00e6ef3e.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/00e6ef3e.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/00e6ef3e.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/00e6ef3e.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/00e6ef3e.html><meta property="article:published_time" content="2020-10-29T21:09:42+08:00"><meta property="article:modified_time" content="2020-10-29T21:09:42+08:00"><meta name=Keywords content><meta name=description content="R语言入门之使用函数sample进行抽样"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/00e6ef3e.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>R语言入门之使用函数sample进行抽样</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>今天介绍一些运算函数，它们的使用很简单，没有什么难度，但是也会用的着。</p><p>在医学统计学或者流行病学里的现场调查、样本选择经常会提到一个词：随机抽样。随机抽样是为了保证各比较组之间均衡性的一个很重要的方法。那么今天介绍的第一个函数就是用于抽样的函数<strong>sample</strong>：</p><p>> x=1:10</p><p>> sample(x=x)</p><p><strong></strong>[1] 3 5 9 6 10 7 2 1 8 4</p><p>第一行代码表示给x向量赋值1~10，第二行代码表示对x向量进行随机抽样。结果输出为每次抽样抽得的结果，可以看出该抽样为无放回抽样------最多抽n次，n为x向量中元素的个数。</p><p>如果想指定在该向量中抽取元素的个数，需要加一个参数<strong>size</strong>：</p><p>> x=1:1000</p><p>> sample(x=x,size=20)</p><p>[1] 66 891 606 924 871 374 879 573 284 305 914 792 398 497 721 897 324 437</p><p>[19] 901 33</p><p>这是在1~1000的正整数中抽样，其中<strong>size</strong>指定抽样的次数，抽了20次，结果如上所示。</p><p>这些都是无放回抽样。所谓无放回抽样，也就是说某个元素一旦被选择，该总体中就不会再有该元素。如果是有放回抽样，则需添加一个参数<strong>repalce=T</strong>：</p><p>> x=1:10</p><p>> sample(x=x,size=5,replace=T)</p><p>[1] 4 7 2 4 8</p><p>“replace”就是重复的意思。即可以重复对元素进行抽样，也就是所谓的有放回抽样。我们看上面的结果，元素4在5次随机抽样的过程中被抽取了两次。</p><div class=pgc-img><img alt=R语言入门之使用函数sample进行抽样 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/5759e22b072d430b8aa7aa521dacd3a6><p class=pgc-img-caption></p></div><p>R语言代码有一个特性就是“对位性”，也许我的词不专业，但是它的意思就是：如果我们输入代码的位置与某个函数中参数的位置一一对应的话，我们可以不写该函数的参数，如：</p><p>> x=1:10</p><p>> sample(x,20,T)</p><p>[1] 1 2 2 1 5 5 5 9 9 5 2 9 8 3 4 8 8 8 1 1</p><p>在上述代码中我们省略了参数<strong>x</strong>，<strong>size</strong>和<strong>repalce</strong>，但是仍然可以运算并且表示对x向量有放回随机抽取20次。我们之所以尽量在每次编写代码时带上参数是因为我觉得这个习惯比较好，而且看起来清楚明白。另外，省略参数的前提是你非常熟悉某个函数参数的位置，否则一旦没有“对位”,那么结果肯定是错误的。而且很多函数有较多的参数，想记住它们的位置是困难的。而如果带上参数，那么即使位置不对应，也一样可以运算：</p><p>> x=1:10</p><p>> sample(size=20,replace=T,x=x)</p><p>[1] 4 9 2 6 4 5 4 7 10 5 2 2 3 4 2 4 6 8 7 8</p><p>这种优点显而易见，不仅清楚，而且无需对应。另外我们也可以看出，有放回抽样的话<strong>size</strong>可以无穷大，而无放回抽样<strong>size</strong>的大小就取决于总体的容量了。</p><p>对于掷骰子，投硬币（这可能是介绍抽样必介绍的内容），都属于有放回抽样。</p><p>这里要说明，对于<strong>sample</strong>函数，参数<strong>x</strong>可以是数值，也可以是字符，实际上参数<strong>x</strong>代表任意一个向量：</p><p>> a=c("A","B")</p><p>> sample(x=a,size=10,replace=T)</p><p>[1] "B" "A" "A" "A" "B" "A" "A" "B" "A" "A"</p><p>上述代码可以理解为掷硬币，抛了10次，其中正面（A）与反面（B）出现的次数。</p><div class=pgc-img><img alt=R语言入门之使用函数sample进行抽样 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f655a80b210847d3b395a773b2eb1bdf><p class=pgc-img-caption></p></div><p>上述抽样过程，每一个元素被抽取的概率相等，称为随机抽样。</p><p>有时候我们的抽取元素的概率未必相等（如常见的二项分布概率问题），此时我们需要添加一个参数<strong>prob</strong>，也就是“probability”（概率）的缩写。假设一名医生给患者做某手术成功的概率是80%，那么现在他给20例病人做手术，可能有哪几次是成功的呢？代码如下：</p><p>> x=c("S","F")</p><p>> sample(x,size=20,replace=T,prob=c(0.8,0.2))</p><p>[1] "F" "S" "S" "S" "S" "S" "S" "S" "S" "S" "S" "S" "F" "S" "S" "F" "S" "S"</p><p>[19] "F" "S"</p><p>其中“S”代表成功，“F”代表失败。</p><p>> x=c(1,3,5,7)</p><p>> sample(x,size=20,replace=T,prob=c(0.1,0.2,0.3,0.9))</p><p>[1] 3 5 7 3 7 3 7 5 3 7 7 7 1 5 7 5 7 7 3 7</p><p>这些代码告诉我们，对每一个元素都可以给定一个概率，且每个概率是独立的，即在参数<strong>prob</strong>中，不一定所有元素的概率加起来等于1，它只代表某元素被抽取的概率而已。</p><div class=pgc-img><img alt=R语言入门之使用函数sample进行抽样 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/81223f951fc04a59a1d1e97e6f498646><p class=pgc-img-caption></p></div><p>对于<strong>sample</strong>函数，其参数<strong>x</strong>可以是R中任意一个对象（如上述对字符的抽样）。其中还有一个功能相同的函数<strong>sample.int</strong>，“int”即“intger”的缩写，也就是“整数”。它的参数<strong>n</strong>必须是正整数：</p><p>> x=-10.5:7.5</p><p>> sample(x=x,size=3);sample.int(n=x,size=3)</p><p>[1] -5.5 -7.5 0.5</p><p>Error in sample.int(x, size = 3) : invalid first argument</p><p>第一行代码生成了-10.5到7.5的等差数列，结果输出的第一行是<strong>sample</strong>的结果；第二行是<strong>sample.int</strong>的结果，提示错误：“第一个自变量无效”，因为它不是正整数。其余的用法与<strong>sample</strong>是一样的。</p><div class=pgc-img><img alt=R语言入门之使用函数sample进行抽样 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/bb2c717ce5af4b34a7e2bd883ceb62d2><p class=pgc-img-caption></p></div><p>接下来介绍第二个函数<strong>max</strong>/<strong>min</strong>，以及<strong>pmax</strong>/<strong>pmin</strong>。</p><p>> x=sample(1:1000,size=20)</p><p>> x</p><p>[1] 514 164 107 354 719 317 204 372 714 522 900 635 441 7 230 653 420 804</p><p>[19] 817 36</p><p>> max(x);min(x)</p><p>[1] 900</p><p>[1] 7</p><p>从1:1000中随机抽取了20个数，并得出它们的最大值和最小值。如果有缺失值，那么需要一个参数<strong>na.rm=T</strong>，即移除缺失值，这在前面的<strong>mean</strong>函数中已经介绍过了：</p><p>> x=c(x,NA)</p><p>> mean(x);mean(x,na.rm=T);max(x);max(x,na.rm=T);min(x);min(x,na.rm=T)</p><p>[1] NA</p><p>[1] 446.5</p><p>[1] NA</p><p>[1] 900</p><p>[1] NA</p><p>[1] 7</p><p>第一行代码我们给原来的向量x添加了一个缺失值“NA”，第二行代码及结果分别显示了在计算x的均值、最大值、最小值时是否带参数<strong>na.rm=T</strong>的情况。</p><p>> x=sample(1:1000,size=20)</p><p>> y=sample(1:1000,size=20)</p><p>> x;y</p><p>[1] 596 333 401 746 970 121 665 831 853 741 855 99 331 275 286 370 558 373</p><p>[19] 55 786</p><p>[1] 291 360 964 173 497 553 155 34 488 29 661 736 591 602 548 527 450 416</p><p>[19] 596 965</p><p>这行代码我们对1:1000分别进行20次无放回随机性抽样得到向量x和y。</p><p>> pmax(x,700)</p><p>[1] 700 700 700 746 970 700 700 831 853 741 855 700 700 700 700 700 700 700</p><p>[19] 700 786</p><p>> pmin(y,700)</p><p>[1] 291 360 700 173 497 553 155 34 488 29 661 700 591 602 548 527 450 416</p><p>[19] 596 700</p><p>第一个代码表示用700和x向量中的每一个元素进行比较，将每次比较结果较大者输出。</p><p>第二个代码表示用700和y向量中的每一个元素进行比较，将每次比较结果较小者输出。</p><p>这就是<strong>pmax</strong>/<strong>pmin</strong>的用法，p在这里表示“parallel”，可以理解为对向量做平行比较。</p><p>> pmax(x,y)</p><p>[1] 596 360 964 746 970 553 665 831 853 741 855 736 591 602 548 527 558 416</p><p>[19] 596 965</p><p>该结果显示了将x向量与y向量中的每个元素平行比较后得出的较大值的结果。如第一个元素的比较，x为596，y为291，所以结果输出为596；第二个元素比较，x向量为333，y向量为360，因此输出结果为360。后面的结果也是一样。</p><p>因为x向量与y向量是等长的，所以我们可以对x与y每一个元素进行平行比较。因为R中向量运算时具有“循环原则”，所以在上面的例子中我们也可以用x或y向量与一个元素“700”比较（相当于包含一个元素“700”的向量重复了20次）。</p><p>如果循环完整，那么较短向量中的元素依次与较长向量中的元素进行比较</p><p>> x=c(1,3,5,7)</p><p>> y=c(4,6)</p><p>> pmax(x,y)</p><p>[1] 4 6 5 7</p><p>结果解释：第一个是1与4比较的最大值，第二个是3与6比较的最大值，第三个是5与4比较的最大值，最后一个是7与6比较的最大值。如果循环不完整，自然会出现警告，但输出结果依然是各元素依次平行比较的结果：</p><p>> x=c(1,3,5,7,9)</p><p>> y=c(4,6)</p><p>> pmax(x,y)</p><p>[1] 4 6 5 7 9</p><p>Warning message:</p><p>In pmax(x, y) : an argument will be fractionally recycled</p><p>警告的内容是：自变量将部分循环。</p><p>对于函数<strong>pmax</strong>/<strong>pmin</strong>，也有参数<strong>na.rm=T</strong>，用法是一样的。同时有对应的<strong>pmax.int</strong>/<strong>pmn.int</strong>，也就是比较向量内的元素必须是整数。</p><div class=pgc-img><img alt=R语言入门之使用函数sample进行抽样 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/36cd161b722f462b9e3c4f13466d0f90><p class=pgc-img-caption></p></div><p>接下来给大家介绍今天的最后一个函数<strong>length</strong>，即查看某一对象的长度。</p><p>> x=c(1,3,5,7,9,11)</p><p>> y=c("a","b","c")</p><p>> z=matrix(1:12,nrow=3)</p><p>> a=cbind(x,y)</p><p>> length(x);length(y);length(z);length(a)</p><p>[1] 6</p><p>[1] 3</p><p>[1] 12</p><p>[1] 12</p><p>结果告诉我们向量x的长度是6，向量y的长度是3,矩阵z的长度是12（3×4）。以列结合的对象a的长度为12（6×2）。</p><p>对于数据框，其长度为列的长度：</p><p>> x=1:5</p><p>> y=6:10</p><p>> z=7:11</p><p>> d=data.frame(x,y,z)</p><p>> length(d)</p><p>[1] 3</p><p>函数<strong>length</strong>也可以“反向使用”，即对于已知向量，先给定其长度然后输出结果：</p><p>> x=1:20</p><p>> length(x)=12</p><p>> x</p><p>[1] 1 2 3 4 5 6 7 8 9 10 11 12</p><p>X向量的真实长度为20，但我们输出长度为12的x向量。</p><p>好了，本次就介绍到这里。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'语言入门','函数','sample'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>