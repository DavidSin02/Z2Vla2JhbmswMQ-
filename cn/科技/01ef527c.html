<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>详解linux系统架构--文件系统体系 | 极客快訊</title><meta property="og:title" content="详解linux系统架构--文件系统体系 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/13183b27d114479589173ced128508b4"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/01ef527c.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/01ef527c.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/01ef527c.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/01ef527c.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/01ef527c.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/01ef527c.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/01ef527c.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/01ef527c.html><meta property="article:published_time" content="2020-11-14T21:03:22+08:00"><meta property="article:modified_time" content="2020-11-14T21:03:22+08:00"><meta name=Keywords content><meta name=description content="详解linux系统架构--文件系统体系"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/01ef527c.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>详解linux系统架构--文件系统体系</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><h1>概述</h1><p>之前已经对Linux系统架构的内核部分单独做了深入介绍，今天就拿Linux系统架构中的文件系统做一下介绍吧~先介绍下概念：</p><p>文件系统是文件存放在磁盘等存储设备上的组织方法。Linux系统能支持多种目前流行的文件系统，如EXT2、 EXT3、EXT4、 FAT、 FAT32、 VFAT和ISO9660。</p><hr><h1><strong>01</strong></h1><h1><strong>文件类型</strong></h1><p class=ql-align-justify>Linux下面的文件类型主要有：</p><p class=ql-align-justify><strong>1) 普通文件：</strong>C语言元代码、SHELL脚本、二进制的可执行文件等。分为纯文本和二进制。</p><p class=ql-align-justify><strong>2) 目录文件：</strong>目录，存储文件的唯一地方。</p><p class=ql-align-justify><strong>3) 链接文件：</strong>指向同一个文件或目录的的文件。</p><p class=ql-align-justify><strong>4) 设备文件：</strong>与系统外设相关的，通常在/dev下面。分为块设备和字符设备。</p><p class=ql-align-justify><strong>5）管道(FIFO)文件:</strong> 提供进程之间通信的一种方式</p><p class=ql-align-justify><strong>6）套接字(socket) 文件：</strong> 该文件类型与网络通信有关</p><p class=ql-align-justify>可以通过ls –l, file, stat几个命令来查看文件的类型等相关信息。</p><hr><h1><strong>02</strong></h1><h1><strong>Linux目录</strong></h1><p class=ql-align-justify>文件结构是文件存放在磁盘等存贮设备上的组织方法。主要体现在对文件和目录的组织上；</p><p class=ql-align-justify>目录提供了管理文件的一个方便而有效的途径。</p><p class=ql-align-justify>Linux使用标准的目录结构，在安装的时候，安装程序就已经为用户创建了文件系统和完整而固定的目录组成形式，并指定了每个目录的作用和其中的文件类型。</p><div class=pgc-img><img alt=详解linux系统架构--文件系统体系 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/13183b27d114479589173ced128508b4><p class=pgc-img-caption></p></div><p class=ql-align-justify>Linux采用的是树型结构。最上层是根目录，其他的所有目录都是从根目录出发而生成的。</p><p class=ql-align-justify><br></p><hr><h1><strong>03</strong></h1><h1><strong>Linux磁盘分区</strong></h1><p class=ql-align-justify><strong>1、主分区，扩展分区和逻辑分区</strong></p><p class=ql-align-justify>Linux硬盘分区一共有三种：主分区，扩展分区和逻辑分区。</p><p class=ql-align-justify>硬盘的分区主要分为主分区(Primary Partion)和扩展分区(Extension Partion)两种，主分区和扩展分区的数目之和不能大于四个。</p><p class=ql-align-justify><strong>主分区(Primary Partion)：</strong>可以马上被使用但不能再分区。</p><p class=ql-align-justify><strong>扩展分区(Extension Partion)：</strong>必须再进行分区后才能使用，也就是说它必须还要进行二次分区。</p><p class=ql-align-justify><strong>逻辑分区((Logical Partion))：</strong>由扩展分区建立起来的分区，逻辑分区没有数量上限制。</p><p class=ql-align-justify>扩展分区只不过是逻辑分区的“容器”，实际上只有主分区和逻辑分区进行数据存储。</p><p class=ql-align-justify><strong>2、Linux下硬盘分区的标识</strong></p><p class=ql-align-justify>硬盘分区的标识一般使用/dev/hd[a-z]X或者/dev/sd[a-z]X来标识，其中[a-z]代表硬盘号，X代表硬盘内的分区号。</p><p class=ql-align-justify><strong>整块硬盘分区的块号标识:</strong>Linux下用hda、hdb、sda、sdb 等来标识不同的硬盘;</p><p class=ql-align-justify>其中：</p><p class=ql-align-justify>IDE接口硬盘：表示为/dev/hda1、/dev/hdb …；</p><p class=ql-align-justify>SCSI 接口的硬盘、SATA接口的硬盘表示为/dev/sda、/dev/sdb … … ；</p><p class=ql-align-justify><strong>硬盘内的分区：</strong>如果X的值是1到4,表示硬盘的主分区（包含扩展分区）；逻辑分区从是从5开始的，比如/dev/hda5肯定是逻辑分区了；</p><p class=ql-align-justify>例如：</p><p class=ql-align-justify>用hda1、hda2、 hda5、hda6 来标识不同的分区。其中，字母a代表第一块硬盘，b代表第二块硬盘，依次类推。而数字1 代表一块硬盘的第一个分区、2 代表第二个分区，依次类推。1 到4 对应的是主分区(Primary Partition)或扩展分区(Extension Partition)。从5开始，对应的都是硬盘的逻辑分区(Logical Partition)。<strong>一块硬盘即使只有一个主分区，逻辑分区也是从5开始编号的，这点应特别注意。</strong></p><div class=pgc-img><img alt=详解linux系统架构--文件系统体系 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/917a8328eba843d590343ec56b0ecc93><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><hr><h1><strong>04</strong></h1><h1><strong>linux文件系统</strong></h1><p class=ql-align-justify>文件系统指文件存在的物理空间，linux系统中每个分区都是一个文件系统，都有自己的目录层次结构。linux会将这些分属不同分区的、单独的文件系统按一定的方式形成一个系统的总的目录层次结构。一个操作系统的运行离不开对文件的操作，因此必然要拥有并维护自己的文件系统。</p><p class=ql-align-justify><strong>1、文件系统类型：</strong></p><pre>ext2 ： 早期linux中常用的文件系统ext3 ： ext2的升级版，带日志功能ext4： 目前主流的Linux文件系统RAMFS ： 内存文件系统，速度很快NFS ： 网络文件系统，由SUN发明，主要用于远程文件共享MS-DOS ： MS-DOS文件系统VFAT ： Windows 95/98 操作系统采用的文件系统FAT ： Windows XP 操作系统采用的文件系统NTFS： Windows NT/XP 操作系统采用的文件系统HPFS ： OS/2 操作系统采用的文件系统PROC : 虚拟的进程文件系统ISO9660 ： 大部分光盘所采用的文件系统ufsSun : OS 所采用的文件系统NCPFS ： Novell 服务器所采用的文件系统SMBFS ： Samba 的共享文件系统XFS ： 由SGI开发的先进的日志文件系统，支持超大容量文件JFS ：IBM的AIX使用的日志文件系统ReiserFS : 基于平衡树结构的文件系统udf: 可擦写的数据光盘文件系统</pre><p class=ql-align-justify><strong>2、文件系统特性：</strong></p><p class=ql-align-justify>磁盘分区完毕后还需要进行格式化(format)，之后操作系统才能够使用这个分区。 格式化的目的是能使操作系统可以使用的文件系统格式（即我们上面提到文件系统类型）.</p><p class=ql-align-justify>Linux正统的文件系统(如ext4等)将硬盘分区时会划分出超级块、inode Table区块和data block数据区域。一个文件由一个超级块、inode和数据区域块组成。Inode包含文件的属性(如读写属性、owner等，以及指向数据块的指针)，数据区域块则是文件内容。当查看某个文件时，会先从inode table中查出文件属性及数据存放点，再从数据块中读取数据。</p><div class=pgc-img><img alt=详解linux系统架构--文件系统体系 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/249d8e956d09439db57faf3ace9df71e><p class=pgc-img-caption></p></div><p class=ql-align-justify>这里将 inode与block区块用图解来说明一下，如下图所示，文件系统先格式化出inode与block的区块，假设某一个文件的属性与权限数据是放置到 inode 4号(下图较小方格内)，而这个inode记录了文件数据的实际放置点为 2, 7, 13, 15 这四个 block 号码，此时我们的操作系统就能够据此来排列磁盘的阅读顺序，可以一口气将四个 block 内容读出来！ 那么数据的读取就如同下图中的箭头所指定的模样了。</p><div class=pgc-img><img alt=详解linux系统架构--文件系统体系 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/76b19cb29e584b6dae9c601a348da5c8><p class=pgc-img-caption></p></div><p class=ql-align-justify><strong>这种数据存取的方法我们称为索引式文件系统(indexed allocation)。</strong></p><hr><h1 class=ql-align-justify>05</h1><h1><strong>挂载文件系统</strong></h1><p class=ql-align-justify>linux系统中每个分区都是一个文件系统，都有自己的目录层次结构。linux会将这些分属不同分区的、单独的文件系统按一定的方式形成一个系统的总的目录层次结构。这里所说的“按一定方式”就是指的挂载。</p><p class=ql-align-justify>将一个文件系统的顶层目录挂到另一个文件系统的子目录上，使它们成为一个整体，称为挂载。把该子目录称为挂载点.</p><p class=ql-align-justify>例如要读取硬盘中的一个格式化好的分区、光盘或软件等设备时，必须先把这些设备对应到某个目录上，而这个目录就称为“挂载点（mount point）”，这样才可以读取这些设备。 挂载后将物理分区细节屏蔽掉，用户只有统一的逻辑概念。所有的东西都是文件。</p><p class=ql-align-justify><strong>注意：</strong></p><p class=ql-align-justify>1、挂载点必须是一个目录。</p><p class=ql-align-justify>2、一个分区挂载在一个已存在的目录上，这个目录可以不为空，但挂载后这个目录下以前的内容将不可用。</p><p class=ql-align-justify>对于其他操作系统建立的文件系统的挂载也是这样。但是需要理解的是：光盘、软盘、其他操作系统使用的文件系统的格式与linux使用的文件系统格式是不一样的。光盘是ISO9660；软盘是fat16或ext2；windows NT是fat16、NTFS；windows98是fat16、fat32；windows2000和windowsXP是fat16、fat32、 NTFS。挂载前要了解linux是否支持所要挂载的文件系统格式。</p><p class=ql-align-justify>挂载时使用mount命令，其格式：mount [-参数] [设备名称] [挂载点]</p><p class=ql-align-justify><strong>其中常用的参数有：</strong></p><p class=ql-align-justify>-t 指定设备的文件系统类型（什么提到的文件类型）</p><p class=ql-align-justify>-o 指定挂载文件系统时的选项。有些也可用在/etc/fstab中。常用的有</p><pre>codepage=XXX 代码页iocharset=XXX 字符集ro 以只读方式挂载rw 以读写方式挂载nouser 使一般用户无法挂载user 可以让一般用户挂载设备</pre><hr><h1>06</h1><h1><strong>软连接、硬链接</strong></h1><p class=ql-align-justify>用ln命令对一个已经存在的文件再建立一个新的连接，而不复制文件的内容。连接有软连接和硬连接之分，软连接又叫符号连接。它们各自的特点是：</p><p class=ql-align-justify>硬连接：是给文件一个副本，原文件名和连接文件名都指向相同的物理地址。目录不能有硬连接；硬连接不能跨越文件系统（不能跨越不同的分区）文件在磁盘中只有一个拷贝，节省硬盘空间；</p><p class=ql-align-justify>修改其中一个，与其连接的文件同时被修改。如果删除其中任意一个其余的文件将不受影响。</p><p class=ql-align-justify>由于删除文件要在同一个索引节点属于唯一的连接时才能成功，因此可以防止不必要的误删除。</p><p class=ql-align-justify>符号连接（软连接）：用ln -s命令建立文件的符号连接符号连接是linux特殊文件的一种，作为一个文件，它的数据是它所连接的文件的路径名。类似windows下的快捷方式。</p><p class=ql-align-justify>当然删除这个连接，也不会影响到源文件，但对连接文件的使用、引用都是直接调用源文件的。</p><p class=ql-align-justify>具体关系可以看下图：</p><div class=pgc-img><img alt=详解linux系统架构--文件系统体系 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d70c5e1a64934533861c4896641fad35><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify>从图上可以看出硬链接和软链接的区别：</p><p class=ql-align-justify>1：硬链接原文件和新文件的inode编号一致。而软链接不一样。</p><p class=ql-align-justify>2：对原文件删除，会导致软链接不可用，而硬链接不受影响。</p><p class=ql-align-justify>3：对原文件的修改，软、硬链接文件内容也一样的修改，因为都是指向同一个文件内容的。</p><hr><p>后面会分享更多devops和DBA方面内容，感兴趣的朋友可以关注下！</p><div class=pgc-img><img alt=详解linux系统架构--文件系统体系 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/da72bd51487e4918a810f2fa99945ace><p class=pgc-img-caption></p></div></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'系统','详解','linux'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>