<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>批量处理文件夹里的文件 | 极客快訊</title><meta property="og:title" content="批量处理文件夹里的文件 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/189a8e9b93bd419e8761a56e21b9f005"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/020d9c8.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/020d9c8.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/020d9c8.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/020d9c8.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/020d9c8.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/020d9c8.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/020d9c8.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/020d9c8.html><meta property="article:published_time" content="2020-10-29T20:54:10+08:00"><meta property="article:modified_time" content="2020-10-29T20:54:10+08:00"><meta name=Keywords content><meta name=description content="批量处理文件夹里的文件"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/020d9c8.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>批量处理文件夹里的文件</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>我们在工作中，一定遇到过需要对批量的excel文件进行同一种操作的情况。如果文件不多，我们当然可以一个一个文件打开，然后修改、保存、关闭。但是，如果有几十个、几百个文件，我们再这样操作就相当的浪费时间了。</p><p><strong>写这篇文章就是因为有一个网友前几天问了我一个这样的问题，希望他能够看到这篇文章。</strong></p><p>今天我们就来学习一下使用VBA代码来解决这个重复、枯燥的问题的方法。</p><p>既然要用到VBA，那我们就需要知道VBA编辑器在哪里。在Excel中，是自带了VBA编辑器的，只是通常情况下，在Excel的工具栏里是看不到的，这需要我们进行一些设置。</p><h1>调出【开发工具】选项卡</h1><p>如下图所示，我们依次点击文件--选项--自定义功能区，在“自定义功能区”下勾选“开发工具”选项，然后点击“确定”即可将“开发工具”选项卡显示在工具栏上。</p><div class=pgc-img><img alt=批量处理文件夹里的文件 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/189a8e9b93bd419e8761a56e21b9f005><p class=pgc-img-caption></p></div><p>如下图所示，<strong>VBA</strong>代码编辑器的<strong>入口</strong>就在“开发工具”选项卡下面。点击“开发工具”选项卡，我们可以看到工具栏的最左边有一个“Visual Basic”按，点击它就可以调出VBA代码编辑器。</p><div class=pgc-img><img alt=批量处理文件夹里的文件 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ebeb743b80714765b3a6970362730fa6><p class=pgc-img-caption></p></div><p>VBA代码编辑器如下图：</p><div class=pgc-img><img alt=批量处理文件夹里的文件 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/793f40bebc5b409b8298f1d2206fa97f><p class=pgc-img-caption></p></div><h1>插入一个模块</h1><p>在VBA代码编辑器中，虽然不一定要在“模块”里编辑代码，但是我习惯了，所以我们还是插入一个模块吧。</p><p>在编辑器左边的“工程”窗口下找与我们打开的Excel文件同名的项目，点击<strong>鼠标右键，</strong>在弹出的菜单栏里选择“插入”，在弹出的子菜单里点击“模块”，即可在下面插入一个模块。</p><div class=pgc-img><img alt=批量处理文件夹里的文件 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/036325ce4cc44dc9812437a60da19919><p class=pgc-img-caption></p></div><p>好了，模块插入成功后，我们“双击”刚才插入的“模块”，就可以在右边的代码编辑区域里编辑VBA代码了。</p><div class=pgc-img><img alt=批量处理文件夹里的文件 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c6929484b86148e3977ff18cb7c90273><p class=pgc-img-caption></p></div><h1>代码编辑</h1><p><strong>※ 第一步、获取文件夹里的所有Excel文件的文件名</strong></p><p>获取文件夹内所有Excel文件的文件名的代码如下：</p><pre>Sub dir_file() Dim path As String  '输入文件夹路径 path = InputBox("请输入文件夹路径：")  '读取文件名后缀为 .xlsx 的文件的文件名 filetest = Dir(path &amp; "\" &amp; "*.xlsx") If filetest &lt;&gt; "获取文件夹里所有的文件名.xlsm" Then  '把文件名写入表格 Cells(1, 1) = filetest end if i = 2  '循环读取文件夹里的文件名 Do While filetest &lt;&gt; "" filetest = Dir  '将文件名依次写入本工作簿、本工作表的A列 If filetest &lt;&gt; "获取文件夹里所有的文件名.xlsm" Then Cells(i, 1) = filetest i = i + 1 End If Loop ' 在这里插入后续代码' 在这里插入后续代码   End Sub</pre><p><strong>※ 第二步、依次打开文件、编辑文件</strong></p><p>将下面的代码插入上面的代码里面，就可以实现打开Excel文件并对文件内容进行编辑的功能了。</p><pre> '依次打开文件然后进行操作 Dim opf As Workbook j = 1 Do While Cells(j, 1) &lt;&gt; "" '从表格中获取文件名 file_name = Cells(j, 1).Value  '根据文件名打开文件 Set opf = Workbooks.Open(path &amp; "\" &amp; file_name)  '对打开的Excel文件进行编辑 opf.Worksheets(1).Cells(1, 2) = file_name   '保存文件 opf.Save '关闭文件 opf.Close  j = j + 1 Loop</pre><p>在上面的这一段代码中，如下图所示的这一段代码就是对打开的Excel文件的具体操作的代码，如果你需要对Excel文件进行其他的操作，你可以录制一段宏代码，然后用这段宏代码替换掉这一段代码就可以了。</p><div class=pgc-img><img alt=批量处理文件夹里的文件 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/bb64acde00e44245bc4a123a83bd5b23><p class=pgc-img-caption></p></div><h1>调用VBA代码</h1><p>我们可以通过插入按钮来调用VBA代码。</p><p>如下图所示，点击“开发工具”下的“插入”按钮，在弹出的选择列表下的“表单控件”下，选择“按钮（窗体控件）”，然后在下面的表格编辑区里拖动鼠标绘制一个按钮。</p><p>在弹出的“指定宏”窗口中，选择你刚刚编辑的VBA代码后点击确定。</p><p>好了，现在你点击这个按钮就可以调用刚刚编辑的VBA代码了。</p><div class=pgc-img><img alt=批量处理文件夹里的文件 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/79749f334d204f2bb68ab55ef505ad9a><p class=pgc-img-caption></p></div><p>我是<strong>Excel大白</strong>，非常感谢你能够看完这边文章，也欢迎大家访问我的头条主页。</p><p>大家有什么问题可以在下面留言或者私信我。</p><div class=tt-column-card data-content='{"new_thumb_url": "http://sf6-ttcdn-tos.pstatp.com/img/pgc-image/156258942192777b5d74e10", "title": "EXCEL\u51fd\u6570\u96f6\u57fa\u7840\u5230\u8fdb\u9636", "distribution_user_id": 1631205263961096, "price": 19, "column_id": "6711276724039975179", "author_description": "Excel\u5927\u767d", "share_price": 4.56, "thumb_url": "http://p3.pstatp.com/large/pgc-image/156258942192777b5d74e10", "sold": 3}'><p class=column-placeholder></p></div></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'文件','处理','夹里'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>