<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>产品经理也能动手实践的AI（七）- 正规化&深入卷积神经网络 | 极客快訊</title><meta property="og:title" content="产品经理也能动手实践的AI（七）- 正规化&深入卷积神经网络 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/c4717cfbf47c4426a6c37eeac5818da6"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0572573.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0572573.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0572573.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0572573.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0572573.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0572573.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0572573.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0572573.html><meta property="article:published_time" content="2020-10-29T20:59:29+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:29+08:00"><meta name=Keywords content><meta name=description content="产品经理也能动手实践的AI（七）- 正规化&深入卷积神经网络"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/0572573.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>产品经理也能动手实践的AI（七）- 正规化&深入卷积神经网络</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>正文共： 3002字 8图</p><p>预计阅读时间： 8分钟</p><div class=pgc-img><img alt="产品经理也能动手实践的AI（七）- 正规化&深入卷积神经网络" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c4717cfbf47c4426a6c37eeac5818da6><p class=pgc-img-caption></p></div><p>好久没更新了，Lesson5是个坎，也不是里面内容有多难，可能是知识点比较杂乱，所以一直没有产出，今天把Lesson6看完了，视频1遍，练习一遍，文字一遍（Transcript），算是基本都理解了，所以上一课的内容之后更新吧。</p><p>1.概览</p><p>本节主要围绕两个例子：1.根据Rossmann商店运营数据预测未来销量 2.用宠物识别的例子讲解CNN原理</p><p>讲解了正则化 Regularization 的 dropout 和卷积神经网络 CNN</p><p>2.1核心概念</p><ol><li>连续变量和非连续变量：很多看起来的连续变量作为类别效果更好，比如一周的第N天</li><li>Dropout：一种Regularization方法，可以避免过度拟合，原理是类似于随机抽一部分老师来监考，防止内外勾结，通过P值来控制挑选的概率</li><li>Batch Normalization：通过小批次的Normalization，加速训练，因为可以把问题简化到每个批次上</li><li>Transform：对图片进行亮度、饱和度、灰度、扭曲、翻转等操作，从而提高训练效果，因为相当于多了N倍的训练图像</li><li>Convolution & Kernel：类似于PS中的滤镜，通过一个N*N的kernel，将每个小块的图像重新加工成新图像上的点。最上面的这个3*3的就是Kernel，像一个过滤器，针对图像上的3*3的一个块，矩阵乘积后，生成新图像的一个点。http://setosa.io/ev/image-kernels</li></ol><div class=pgc-img><img alt="产品经理也能动手实践的AI（七）- 正规化&深入卷积神经网络" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/286b1995898441ab87a83ca809fedc0e><p class=pgc-img-caption></p></div><ol><li><br></li><li>特征点热力图：让ML变得可以解释，通过热力图，显示机器是根据图像上的哪部分的特征点判断属于哪个类别，效果如下</li></ol><div class=pgc-img><img alt="产品经理也能动手实践的AI（七）- 正规化&深入卷积神经网络" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/7117e4cbea554aa9ac720cd171d19289><p class=pgc-img-caption></p></div><p>2.2机器学习概念</p><ul><li>Normalization：将数据转换到[0,1]区间，如下图公式，还有其他变种</li></ul><div class=pgc-img><img alt="产品经理也能动手实践的AI（七）- 正规化&深入卷积神经网络" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/179e0895ec094cb286a228eeaa085b04><p class=pgc-img-caption></p></div><ul><li><br></li><li>Regularization：loss function的惩罚机制，防止overfit</li><li>Weight Decay：L2 regularization 的升级版</li><li>Model 内部结构，一个基础的block，2d就是二阶向量</li><li class=ql-indent-1>Conv2d</li><li class=ql-indent-1>BatchNorm2d</li><li class=ql-indent-1>ReLu</li><li class=ql-indent-1>Conv2d</li><li class=ql-indent-1>BatchNorm2d</li><li>Data argumentation：数据增强，通过transform把图片各种变形，以达到更好的训练效果</li><li>卷积：一个用RGB显示的图片，会存储为一个3阶张量，于是也需要把Kernel变为一个3阶张量</li></ul><div class=pgc-img><img alt="产品经理也能动手实践的AI（七）- 正规化&深入卷积神经网络" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/edd936124d794459a6acdc0d8b279c84><p class=pgc-img-caption></p></div><ul><li><br></li><li>Channel：用了多少个Kernel，就会产生多少channel，近似于feature，如图生成了16个channel，</li><li>Stride：步伐，为了降低内存占用，如果步伐为2，则每次和Kernel的运算会跳过一个，所以生成的tensor高宽会/2,channel会*2</li><li>Average pooling：相当于求纵向的平均值，比如最后生成了11*11*512的tensor，那就求11*11平面上每个点的纵向512个值的均值，这样得到的11*11的值就可以用于热力图的显示</li></ul><p>2.3 FastAI命令</p><ul><li>add_datepart：可以将日期转化成每周的第N天，每月每年的第N天，是否是月初或月末等</li><li>label class (label_cls=FloatList)：设置label值为float，因为int会被当成分类任务，本节课是要预测销量</li><li>procs=[FillMissing, Categorify, Normalize]：数据训练前的一次性处理，process设置的简写</li><li>data.one_item(x)：创建一个mini-batch的数据</li><li>data.cuda()：放到GPU上</li></ul><p>2.4 Pandas命令</p><ul><li>train_df.head().T：可以转置表格数据</li><li>small_train_df.PromoInterval.cat.categories：查看类别</li><li>small_train_df['PromoInterval'].cat.codes[:5]：查看类别对应的编号，-1就是不存在的意思</li></ul><p>2.5 PyTorch命令</p><ul><li>hook：可以调取训练过程的任意环节</li><li>hook.store()：存下来</li><li>t[None]：维度+1</li></ul><p>3.1实例详细分析</p><p>根据Rossmann商店数据，还有竞争对手数据，预测销量</p><ol><li>数据有点老，所以专门有个data_clean的文件先把数据处理一遍，主要是把需要的数据提炼出来合成一张表</li><li>先小范围测试下数据</li><li class=ql-indent-1>主要是区分类别变量和连续变量，会把类别变量都映射成数字</li><li class=ql-indent-1>空数据用类别方式标注</li><li class=ql-indent-1>数据归一化Normalization</li><li>在准备完整数据</li><li>然后用tabular_learner跑数据</li></ol><pre>data = (TabularList.from_df(df, path=path, cat_names=cat_vars, cont_names=cont_vars, procs=procs,) .split_by_idx(valid_idx) .label_from_df(cols=dep_var, label_cls=FloatList, log=True) .add_test(TabularList.from_df(test_df, path=path, cat_names=cat_vars, cont_names=cont_vars)) .databunch())</pre><pre>learn = tabular_learner(data, layers=[1000,500], ps=[0.001,0.01], emb_drop=0.04, y_range=y_range, metrics=exp_rmspe)</pre><p>3.2实例详细分析</p><p>宠物图片增强，找到cnn是通过哪部分的特征，识别了这张图，热力图</p><ol><li>创建databunch</li><li>变形transform</li><li>cnn训练模型</li><li>卷积内核</li><li>热力图</li><li>grad-cam</li></ol><pre>src = ImageList.from_folder(path).split_by_rand_pct(0.2,seed=2)def get_data(size, bs, padding_mode='reflection'): return (src.label_from_re(r'([^/]+)_\d+.jpg$') .transform(tfms, size=size, padding_mode=padding_mode) .databunch(bs=bs).normalize(imagenet_stats))</pre><pre>learn = cnn_learner(data,models.resnet34,metrics=error_rate,bn_final=True)</pre><pre>def show_heatmap(hm): _,ax = plt.subplots() xb_im.show(ax) ax.imshow(hm, alpha=0.8, extent=(0,352,352,0), interpolation='bilinear', cmap='magma');show_heatmap(avg_acts)</pre><p>4.最后</p><p>本课还讲了platform.ai和AI的伦理，platform.ai是一个快速训练未打标签的数据的网站，AI伦理讲的是很多性别偏见，以及过度满足人性的推荐系统，酿成的悲剧，号召从业者用技术将生活变得更好，而不是制造更多冲突。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'产品','经理','能动手'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>