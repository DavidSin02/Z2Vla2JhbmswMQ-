<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 | 极客快訊</title><meta property="og:title" content="实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/a1e1c6ae7fd2483ea200f0335fee5d20"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/081add3.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/081add3.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/081add3.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/081add3.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/081add3.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/081add3.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/081add3.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/081add3.html><meta property="article:published_time" content="2020-10-29T21:05:26+08:00"><meta property="article:modified_time" content="2020-10-29T21:05:26+08:00"><meta name=Keywords content><meta name=description content="实操讲解：使用Keras中的自动编码器进行极端罕见事件分类"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/081add3.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>实操讲解：使用Keras中的自动编码器进行极端罕见事件分类</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><blockquote><strong>点击上方关注，All in AI中国</strong></blockquote><p class=ql-align-justify>在这篇文章中，我们将学习如何实现用自动编码器来构建稀有事件分类器。我们将使用来自此处的真实稀有事件数据集。</p><p class=ql-align-justify><strong>背景</strong></p><p class=ql-align-justify><strong>什么是极端罕见的事件？</strong></p><p class=ql-align-justify>在一个罕见的问题中，我们有一个不平衡的数据集。意思是，我们得到的阳性标记样本少于阴性。在典型的罕见事件问题中，带正号的标记数据约占总数的5-10％。在一个极端罕见的事件问题中，我们的标记数据不到1％。例如，在这里使用的数据集中，它约为0.6％。</p><p class=ql-align-justify>这种极端罕见的事件问题在现实世界中非常普遍，例如，在制造、点击或在线行业购买时的纸张断裂和机器故障。</p><p class=ql-align-justify>对这些罕见事件进行分类非常具有挑战性，深度学习已被广泛用于分类。但是，少量阳性标记样本禁止深度学习应用。无论数据有多大，深度学习的使用都受到正面标记样本数量的限制。</p><p class=ql-align-justify><strong>我们为什么还要费心使用深度学习呢？</strong></p><p class=ql-align-justify>这是一个合理的问题。为什么我们不应该考虑使用另一种机器学习方法？</p><p class=ql-align-justify>答案是主观的。我们总是可以采用机器学习方法。为了使其工作，我们可以从负面标记的数据中取样，以获得接近平衡的数据集。由于我们有大约0.6％的正标记数据，因此欠采样将导致数据集的大小大约是原始数据大小的1％。机器学习方法，例如SVM或随机森林仍然可以适用于处理此大小的数据集。但是，它的准确性会受到限制。我们不会利用剩下的99％的数据中的信息。</p><p class=ql-align-justify>如果数据足够，则深度学习方法可能更有效。它还允许通过使用不同的体系结构灵活地进行模型改进。因此，我们将尝试使用深度学习方法。</p><p class=ql-align-justify>在这篇文章中，我们将学习如何使用简单的密集层自动编码器来构建罕见的事件分类器。这篇文章的目的是演示一个用于极端罕见事件分类的自动编码器的实现。我们将在用户身上探索自动编码器的不同架构和配置。如果您发现任何有趣的内容，请分享评论。</p><p class=ql-align-justify><strong>自动编码器用于分类</strong></p><p class=ql-align-justify>用于分类的自动编码器方法类似于异常检测。在异常检测中，我们学习了正常过程的模式。任何不遵循这种模式的东西都被归类为异常。对于罕见事件的二进制分类，我们可以使用类似的方法使用自动编码器（从此处[2]导出）。</p><p class=ql-align-justify><strong>快速修订：什么是自动编码器？</strong></p><ul><li class=ql-align-justify>自动编码器由两个模块组成：编码器和解码器。</li><li class=ql-align-justify>编码器学习过程的基本特征。这些特征通常在一个简化的维度中。</li><li class=ql-align-justify>解码器可以从这些底层特征中重建原始数据。</li></ul><div class=pgc-img><img alt=实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a1e1c6ae7fd2483ea200f0335fee5d20><p class=pgc-img-caption>图1.自动编码器的图示</p></div><p class=ql-align-justify><strong>如何使用自动编码器为稀有事件分类？</strong></p><ul><li class=ql-align-justify>我们将数据分为两部分：正标记和负标记。</li><li class=ql-align-justify>带负标记的数据被视为流程的正常状态。正常状态是指该过程无事件。</li><li class=ql-align-justify>我们将忽略带正号的数据，并仅在负标记数据上训练自动编码器。</li><li class=ql-align-justify>这个自动编码器现在已经学习了正常过程的特性。</li><li class=ql-align-justify>一个训练有素的自动编码器将预测任何来自正常状态的新数据（因为它将具有相同的模式或分布）。</li><li class=ql-align-justify>因此，重建误差会很小。</li><li class=ql-align-justify>但是，如果我们尝试从稀有事件重建数据，则自动编码器会很困难。</li><li class=ql-align-justify>这将使罕见事件期间的重构误差变高。</li><li class=ql-align-justify>我们可以捕获如此高的重建误差，并将其标记为罕见事件预测。</li><li class=ql-align-justify>该过程类似于异常检测方法。</li></ul><p class=ql-align-justify><strong>履行</strong></p><p class=ql-align-justify><strong>数据和问题</strong></p><p class=ql-align-justify>这是来自纸浆和造纸厂的二进制标记数据，用于断纸。纸张断裂是纸张制造中的一个严重的问题。单张纸张破损会造成数千美元的损失，而且工厂每天至少会看到一次或多次断片。这导致每年数百万美元的损失和工作危险。</p><p class=ql-align-justify>由于过程的性质，检测中断事件是具有挑战性的。正如[1]中所述，即使断裂减少5％也会给工厂带来显著的好处。</p><p class=ql-align-justify>我们的数据包含了15天内收集的大约18k行数据。列y包含二进制标签，其中1表示分页符。其余列是预测变量。大约有124个阳性标记样本（~0.6％）。</p><p class=ql-align-justify><strong>代码</strong></p><p class=ql-align-justify>导入所需的库。</p><div class=pgc-img><img alt=实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/3461f58f3d1a4e1fabfd26263f36520b><p class=pgc-img-caption></p></div><p class=ql-align-justify>请注意，我们正在设置随机种子的重现性的结果。</p><p class=ql-align-justify><strong>数据预处理</strong></p><p class=ql-align-justify>现在，我们读取并准备数据。</p><pre class=ql-align-justify>df = pd.read_csv("data/processminer-rare-event-mts - data.csv")</pre><p class=ql-align-justify>这种罕见事件的目的是在碎片发生之前就预测它。我们将尝试提前4分钟预测休息时间。要构建此模型，我们将标签向上移动2行（相当于4分钟）。</p><pre class=ql-align-justify>df.y = df.y.shift(-2)</pre><p class=ql-align-justify>现在，我们将数据分为训练集、有效集和测试集。然后我们将仅使用0的数据子集来训练自动编码器。</p><div class=pgc-img><img alt=实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/26b93d955aae495183836088bd9c9563><p class=pgc-img-caption></p></div><p class=ql-align-justify><strong>标准化</strong></p><p class=ql-align-justify>对于自动编码器，通常最好使用自动编码器的标准化数据（转换为高斯、平均值为0和方差1）。</p><div class=pgc-img><img alt=实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/193b1e737f8844c5b52c69cc582096ac><p class=pgc-img-caption></p></div><p class=ql-align-justify><strong>自动编码器分类器</strong></p><p class=ql-align-justify><strong>初始化</strong></p><p class=ql-align-justify>首先，我们将初始化自动编码器架构。我们正在构建一个简单的自动编码器，应该探索更复杂的架构和其他配置。</p><div class=pgc-img><img alt=实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/77ff52e1bf3240fe84feaae8364f7660><p class=pgc-img-caption></p></div><p class=ql-align-justify><strong>训练</strong></p><p class=ql-align-justify>我们将训练模型并将其保存在一个文件中。保存经过训练有素的模型是为将来的分析节省时间的好实践。</p><div class=pgc-img><img alt=实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/59a2098181cd4d719704ed2cb37663fd><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/bbbe9d9164ec446f9070e6e7e6b8b900><p class=pgc-img-caption>图2.自动编码器训练的损失</p></div><p class=ql-align-justify><strong>分类</strong></p><p class=ql-align-justify>在下文中，我们将展示如何将自动编码器重建错误用于罕见事件分类。</p><p class=ql-align-justify>如前所述，如果重构错误很高，我们会将其归类为分页符。我们需要确定这个门槛。</p><p class=ql-align-justify>我们将使用验证集来确定阈值。</p><div class=pgc-img><img alt=实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/13a2cbc561cb408e8a04b28440fffff7><p class=pgc-img-caption>图3.阈值0.8应该在精确度和召回率之间提供合理的权衡</p></div><div class=pgc-img><img alt=实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/8c0dc604426f45478f59a2e564b5ffed><p class=pgc-img-caption></p></div><p class=ql-align-justify>现在，我们将对测试数据进行分类。</p><p class=ql-align-justify>我们不应该从测试数据估计分类阈值。这会导致过度拟合。</p><div class=pgc-img><img alt=实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/bc92d4d1c8ba4e38a08527afa12b6198><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f29d24240fd345d3a7b456541ce383db><p class=pgc-img-caption></p></div><p class=ql-align-justify>在图4中，阈值线上方的橙色和蓝色点分别代表真阳性和假阳性。 我们可以看到，我们有很多误报。 为了看得更清楚，我们可以看到一个混淆矩阵。</p><div class=pgc-img><img alt=实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/87627f2588d741bd8c83dc3c46ed7ca3><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9b6bc57b03f0432aa9cb30dcb344b779><p class=pgc-img-caption>图5.测试预测的混淆矩阵</p></div><p class=ql-align-justify>我们可以预测21次休息中的4次。大约25％的召回率，这对造纸业来说是一个很好的召回率。假阳性率约为7％。这对于工厂来说并不理想，但也不可怕。</p><p class=ql-align-justify>尽管如此，这个模型还可以进一步改进，在假阳性率较小的情况下提高召回率。</p><p class=ql-align-justify>Github存储库（<a class=pgc-link data-content=mp href=https://github.com/cran2367/autoencoder_classifier target=_blank>GitHub - cran2367/autoencoder_classifier: Autoencoder model for rare event classification</a>）</p><p class=ql-align-justify>这里显示了有带注释的整个代码。</p><p class=ql-align-justify><strong>这里有什么可以做得更好的？</strong></p><p class=ql-align-justify>这是一个（多元）时间序列数据。我们没有考虑数据中的时间信息/模式。在下一篇文章中，我们将探讨使用RNN是否可行。我们将尝试一个LSTM自动编码器。</p><p class=ql-align-justify><strong>结论</strong></p><p class=ql-align-justify>我们研究了来自造纸厂的极端罕见事件二进制标记数据，以构建自动编码器分类器。我们达到了合理的精度。这里的目的是演示如何使用基本的自动编码器进行罕见的事件分类。我们将进一步开发其他方法，包括可以提取时间特征以获得更高精度的LSTM自动编码器。</p><div class=pgc-img><img alt=实操讲解：使用Keras中的自动编码器进行极端罕见事件分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/61d1d0440d0346bd855e3ff1f08139bd><p class=pgc-img-caption>编译出品</p></div></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'实操','讲解','Keras'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>