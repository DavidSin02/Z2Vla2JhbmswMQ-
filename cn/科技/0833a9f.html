<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>æœºå™¨å­¦ä¹ åå¤§ç»å…¸ç®—æ³•ä¹‹éšæœºæ£®æ— | æå®¢å¿«è¨Š</title><meta property="og:title" content="æœºå™¨å­¦ä¹ åå¤§ç»å…¸ç®—æ³•ä¹‹éšæœºæ£®æ— - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0833a9f.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0833a9f.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0833a9f.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0833a9f.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0833a9f.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0833a9f.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0833a9f.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0833a9f.html><meta property="article:published_time" content="2020-10-29T21:01:05+08:00"><meta property="article:modified_time" content="2020-10-29T21:01:05+08:00"><meta name=Keywords content><meta name=description content="æœºå™¨å­¦ä¹ åå¤§ç»å…¸ç®—æ³•ä¹‹éšæœºæ£®æ—"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/0833a9f.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>æœºå™¨å­¦ä¹ åå¤§ç»å…¸ç®—æ³•ä¹‹éšæœºæ£®æ—</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right><strong>éšæœºæ£®æ—ç®€ä»‹</strong></h1><p style=text-align:justify>éšæœºæ£®æ—æ˜¯æœºå™¨å­¦ä¹ ä¸€ç§å¸¸ç”¨çš„æ–¹æ³•ã€‚å®ƒæ˜¯ä»¥å†³ç­–æ ‘ä¸ºåŸºç¡€ï¼Œç”¨éšæœºçš„æ–¹å¼æ’åˆ—å»ºç«‹çš„ï¼Œ<strong>æ£®æ—é‡Œæ¯ä¸ªå†³ç­–æ ‘ä¹‹é—´éƒ½æ˜¯æ²¡æœ‰å…³è”çš„ã€‚</strong> åœ¨å¾—åˆ°æ£®æ—ä¹‹åï¼Œå½“æœ‰ä¸€ä¸ªæ–°çš„è¾“å…¥æ ·æœ¬è¿›å…¥çš„æ—¶å€™ï¼Œå°±è®©æ£®æ—ä¸­çš„æ¯ä¸€æ£µå†³ç­–æ ‘åˆ†åˆ«è¿›è¡Œä¸€ä¸‹åˆ¤æ–­ï¼Œçœ‹çœ‹è¿™ä¸ªæ ·æœ¬åº”è¯¥å±äºå“ªä¸€ç±»ï¼ˆå¯¹äºåˆ†ç±»ç®—æ³•ï¼‰ï¼Œç„¶åçœ‹çœ‹å“ªä¸€ç±»è¢«é€‰æ‹©æœ€å¤šï¼Œå°±é¢„æµ‹è¿™ä¸ªæ ·æœ¬ä¸ºé‚£ä¸€ç±»ã€‚éšæœºæ£®æ—å¯ä»¥ç”¨æ¥è¿›è¡Œæ— ç›‘ç£å­¦ä¹ èšç±»å’Œå¼‚å¸¸ç‚¹æ£€æµ‹ã€‚</p><p style=text-align:justify>å†³ç­–æ ‘ï¼ˆdecision treeï¼‰æ˜¯ä¸€ä¸ªæ ‘ç»“æ„ï¼ˆå¯ä»¥æ˜¯äºŒå‰æ ‘æˆ–éäºŒå‰æ ‘ï¼‰ã€‚å…¶æ¯ä¸ªéå¶èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªç‰¹å¾å±æ€§ä¸Šçš„æµ‹è¯•ï¼Œæ¯ä¸ªåˆ†æ”¯ä»£è¡¨è¿™ä¸ªç‰¹å¾å±æ€§åœ¨æŸä¸ªå€¼åŸŸä¸Šçš„è¾“å‡ºï¼Œè€Œæ¯ä¸ªå¶èŠ‚ç‚¹å­˜æ”¾ä¸€ä¸ªç±»åˆ«ã€‚ä½¿ç”¨å†³ç­–æ ‘è¿›è¡Œå†³ç­–çš„è¿‡ç¨‹å°±æ˜¯ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œæµ‹è¯•å¾…åˆ†ç±»é¡¹ä¸­ç›¸åº”çš„ç‰¹å¾å±æ€§ï¼Œå¹¶æŒ‰ç…§å…¶å€¼é€‰æ‹©è¾“å‡ºåˆ†æ”¯ï¼Œç›´åˆ°åˆ°è¾¾å¶å­èŠ‚ç‚¹ï¼Œå°†å¶å­èŠ‚ç‚¹å­˜æ”¾çš„ç±»åˆ«ä½œä¸ºå†³ç­–ç»“æœã€‚è¯¦æƒ…è¯·å‰å¾€å…ˆå‰çš„æ¨é€ã€‚</p><h1 class=pgc-h-arrow-right><strong>ç®—æ³•æµç¨‹</strong></h1><p style=text-align:justify>éšæœºæ£®æ—é‡Œæ¯æ£µæ ‘æŒ‰ç…§å¦‚ä¸‹è§„åˆ™ç”Ÿæˆï¼š</p><ul><li>1ã€å¦‚æœè®­ç»ƒé›†å¤§å°ä¸ºNï¼Œå¯¹äºæ¯æ£µæ ‘è€Œè¨€ï¼Œéšæœºä¸”æœ‰æ”¾å›åœ°ä»è®­ç»ƒé›†ä¸­çš„æŠ½å–Nä¸ªè®­ç»ƒæ ·æœ¬ï¼Œä½œä¸ºè¯¥æ ‘çš„è®­ç»ƒé›†ï¼›</li></ul><p style=text-align:justify>PS:<strong>ä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼šæ¯æ£µæ ‘çš„è®­ç»ƒé›†éƒ½æ˜¯ä¸åŒçš„ï¼Œè€Œä¸”é‡Œé¢åŒ…å«é‡å¤çš„è®­ç»ƒæ ·æœ¬ã€‚</strong></p><ul><li>2ã€å¦‚æœæ¯ä¸ªæ ·æœ¬çš„ç‰¹å¾ç»´åº¦ä¸ºMï¼ŒæŒ‡å®šä¸€ä¸ªå¸¸æ•°m&lt;&lt;Mï¼Œéšæœºåœ°ä»Mä¸ªç‰¹å¾ä¸­é€‰å–mä¸ªç‰¹å¾å­é›†ï¼Œæ¯æ¬¡æ ‘è¿›è¡Œåˆ†è£‚æ—¶ï¼Œä»è¿™mä¸ªå±æ€§ä¸­é‡‡ç”¨æŸç§ç­–ç•¥ï¼ˆæ¯”å¦‚è¯´ä¿¡æ¯å¢ç›Šï¼‰æ¥é€‰æ‹©1ä¸ªå±æ€§ä½œä¸ºè¯¥èŠ‚ç‚¹çš„åˆ†è£‚å±æ€§ã€‚</li><li>3ã€æ¯æ£µæ ‘éƒ½å°½æœ€å¤§ç¨‹åº¦çš„ç”Ÿé•¿ï¼Œå¹¶ä¸”æ²¡æœ‰å‰ªæè¿‡ç¨‹ã€‚</li><li>4ã€ æŒ‰ç…§æ­¥éª¤1~3å»ºç«‹å¤§é‡çš„å†³ç­–æ ‘ï¼Œè¿™æ ·å°±æ„æˆäº†éšæœºæ£®æ—äº†ã€‚</li></ul><p style=text-align:justify><strong>ä¸€å¼€å§‹æˆ‘ä»¬æåˆ°çš„éšæœºæ£®æ—ä¸­çš„â€œéšæœºâ€å°±æ˜¯æŒ‡çš„è¿™é‡Œçš„ä¸¤ä¸ªéšæœºæ€§ã€‚ä¸¤ä¸ªéšæœºæ€§çš„å¼•å…¥å¯¹éšæœºæ£®æ—çš„åˆ†ç±»æ€§èƒ½è‡³å…³é‡è¦ã€‚ç”±äºå®ƒä»¬çš„å¼•å…¥ï¼Œä½¿å¾—éšæœºæ£®æ—ä¸å®¹æ˜“é™·å…¥è¿‡æ‹Ÿåˆï¼Œå¹¶ä¸”å…·æœ‰å¾ˆå¥½</strong><strong>å¾—</strong><strong>æŠ—å™ªèƒ½åŠ›ï¼ˆæ¯”å¦‚ï¼šå¯¹ç¼ºçœå€¼ä¸æ•æ„Ÿï¼‰</strong>ã€‚</p><h1 class=pgc-h-arrow-right><strong>éšæœºæ£®æ—ä¼˜ç‚¹</strong></h1><ul><li>å®ƒèƒ½å¤Ÿå¤„ç†å¾ˆé«˜ç»´åº¦ï¼ˆfeatureå¾ˆå¤šï¼‰çš„æ•°æ®ï¼Œå¹¶ä¸”ä¸ç”¨åšç‰¹å¾é€‰æ‹©(å› ä¸ºç‰¹å¾å­é›†æ˜¯éšæœºé€‰æ‹©çš„)ã€‚</li><li>åœ¨åˆ›å»ºéšæœºæ£®æ—çš„æ—¶å€™ï¼Œå¯¹generlization errorä½¿ç”¨çš„æ˜¯æ— åä¼°è®¡ï¼Œæ¨¡å‹æ³›åŒ–èƒ½åŠ›å¼ºã€‚</li><li>è®­ç»ƒé€Ÿåº¦å¿«ï¼Œå®¹æ˜“åšæˆå¹¶è¡ŒåŒ–æ–¹æ³•(è®­ç»ƒæ—¶æ ‘ä¸æ ‘ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„)ã€‚</li><li>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œèƒ½å¤Ÿæ£€æµ‹åˆ°featureé—´çš„äº’ç›¸å½±å“ã€‚</li><li>å¯¹äºä¸å¹³è¡¡çš„æ•°æ®é›†æ¥è¯´ï¼Œå®ƒå¯ä»¥å¹³è¡¡è¯¯å·®ã€‚</li></ul><p style=text-align:justify>éšæœºæ£®æ—ï¼ˆRandom Forestï¼Œç®€ç§°RFï¼‰ä¸»è¦åº”ç”¨äºå›å½’å’Œåˆ†ç±»ï¼Œä¸”æ‹¥æœ‰å¹¿æ³›çš„åº”ç”¨å‰æ™¯ï¼Œä»å¸‚åœºè¥é”€åˆ°åŒ»ç–—ä¿å¥ä¿é™©ï¼Œæ—¢å¯ä»¥ç”¨æ¥åšå¸‚åœºè¥é”€æ¨¡æ‹Ÿçš„å»ºæ¨¡ï¼Œç»Ÿè®¡å®¢æˆ·æ¥æºï¼Œä¿ç•™å’Œæµå¤±ï¼Œä¹Ÿå¯ç”¨æ¥é¢„æµ‹ç–¾ç—…çš„é£é™©å’Œç—…æ‚£è€…çš„æ˜“æ„Ÿæ€§ã€‚æœ€è¿‘å‡ å¹´çš„å›½å†…å¤–å¤§èµ›ï¼ŒåŒ…æ‹¬2013å¹´ç™¾åº¦æ ¡å›­ç”µå½±æ¨èç³»ç»Ÿå¤§èµ›ã€2014å¹´é˜¿é‡Œå·´å·´å¤©æ± å¤§æ•°æ®ç«èµ›ä»¥åŠKaggleæ•°æ®ç§‘å­¦ç«èµ›ï¼Œå‚èµ›è€…å¯¹éšæœºæ£®æ—çš„ä½¿ç”¨å æœ‰ç›¸å½“é«˜çš„æ¯”ä¾‹ã€‚è€Œä¸”éšæœºæ£®æ—åœ¨è¿ç®—é‡æ²¡æœ‰æ˜¾è‘—æé«˜çš„æƒ…å†µä¸‹ç²¾åº¦å¾—åˆ°äº†å¾ˆå¤§çš„æ”¹å–„ã€‚</p><h1 class=pgc-h-arrow-right><strong>ä»£ç å®ç°</strong></h1><p style=text-align:justify>éšæœºæ£®æ—å®ç°åˆ†ç±»ç®—æ³•</p><pre><code>import&nbsp;pandas&nbsp;as&nbsp;pdimport&nbsp;numpy&nbsp;as&nbsp;npimport&nbsp;randomimport&nbsp;mathimport&nbsp;collectionsfrom&nbsp;sklearn.externals.joblib&nbsp;import&nbsp;Parallel,&nbsp;delayedclass&nbsp;Tree(object):&nbsp;&nbsp;&nbsp;&nbsp;&#34;&#34;&#34;å®šä¹‰ä¸€æ£µå†³ç­–æ ‘&#34;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.split_feature&nbsp;=&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.split_value&nbsp;=&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.leaf_value&nbsp;=&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tree_left&nbsp;=&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.tree_right&nbsp;=&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;calc_predict_value(self,&nbsp;dataset):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&#34;&#34;é€šè¿‡é€’å½’å†³ç­–æ ‘æ‰¾åˆ°æ ·æœ¬æ‰€å±å¶å­èŠ‚ç‚¹&#34;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.leaf_value&nbsp;is&nbsp;not&nbsp;None:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self.leaf_value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;dataset[self.split_feature]&nbsp;&lt;=&nbsp;self.split_value:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self.tree_left.calc_predict_value(dataset)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self.tree_right.calc_predict_value(dataset)&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;describe_tree(self):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&#34;&#34;ä»¥jsonå½¢å¼æ‰“å°å†³ç­–æ ‘ï¼Œæ–¹ä¾¿æŸ¥çœ‹æ ‘ç»“æ„&#34;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;self.tree_left&nbsp;and&nbsp;not&nbsp;self.tree_right:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leaf_info&nbsp;=&nbsp;&#34;{leaf_value:&#34;&nbsp;+&nbsp;str(self.leaf_value)&nbsp;+&nbsp;&#34;}&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;leaf_info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left_info&nbsp;=&nbsp;self.tree_left.describe_tree()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right_info&nbsp;=&nbsp;self.tree_right.describe_tree()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tree_structure&nbsp;=&nbsp;&#34;{split_feature:&#34;&nbsp;+&nbsp;str(self.split_feature)&nbsp;+&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;,split_value:&#34;&nbsp;+&nbsp;str(self.split_value)&nbsp;+&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;,left_tree:&#34;&nbsp;+&nbsp;left_info&nbsp;+&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;,right_tree:&#34;&nbsp;+&nbsp;right_info&nbsp;+&nbsp;&#34;}&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;tree_structureclass&nbsp;RandomForestClassifier(object):&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;n_estimators=10,&nbsp;max_depth=-1,&nbsp;min_samples_split=2,&nbsp;min_samples_leaf=1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_split_gain=0.0,&nbsp;colsample_bytree=None,&nbsp;subsample=0.8,&nbsp;random_state=None):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;éšæœºæ£®æ—å‚æ•°&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_estimators:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;æ ‘æ•°é‡&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max_depth:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;æ ‘æ·±åº¦ï¼Œ-1è¡¨ç¤ºä¸é™åˆ¶æ·±åº¦&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_samples_split:&nbsp;èŠ‚ç‚¹åˆ†è£‚æ‰€éœ€çš„æœ€å°æ ·æœ¬æ•°é‡ï¼Œå°äºè¯¥å€¼èŠ‚ç‚¹ç»ˆæ­¢åˆ†è£‚&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_samples_leaf:&nbsp;&nbsp;å¶å­èŠ‚ç‚¹æœ€å°‘æ ·æœ¬æ•°é‡ï¼Œå°äºè¯¥å€¼å¶å­è¢«åˆå¹¶&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_split_gain:&nbsp;&nbsp;&nbsp;&nbsp;åˆ†è£‚æ‰€éœ€çš„æœ€å°å¢ç›Šï¼Œå°äºè¯¥å€¼èŠ‚ç‚¹ç»ˆæ­¢åˆ†è£‚&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colsample_bytree:&nbsp;&nbsp;åˆ—é‡‡æ ·è®¾ç½®ï¼Œå¯å–[sqrtã€log2]ã€‚sqrtè¡¨ç¤ºéšæœºé€‰æ‹©sqrt(n_features)ä¸ªç‰¹å¾ï¼Œ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log2è¡¨ç¤ºéšæœºé€‰æ‹©log(n_features)ä¸ªç‰¹å¾ï¼Œè®¾ç½®ä¸ºå…¶ä»–åˆ™ä¸è¿›è¡Œåˆ—é‡‡æ ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subsample:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;è¡Œé‡‡æ ·æ¯”ä¾‹&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random_state:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;éšæœºç§å­ï¼Œè®¾ç½®ä¹‹åæ¯æ¬¡ç”Ÿæˆçš„n_estimatorsä¸ªæ ·æœ¬é›†ä¸ä¼šå˜ï¼Œç¡®ä¿å®éªŒå¯é‡å¤&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.n_estimators&nbsp;=&nbsp;n_estimators&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.max_depth&nbsp;=&nbsp;max_depth&nbsp;if&nbsp;max_depth&nbsp;!=&nbsp;-1&nbsp;else&nbsp;float(&#39;inf&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.min_samples_split&nbsp;=&nbsp;min_samples_split&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.min_samples_leaf&nbsp;=&nbsp;min_samples_leaf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.min_split_gain&nbsp;=&nbsp;min_split_gain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.colsample_bytree&nbsp;=&nbsp;colsample_bytree&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.subsample&nbsp;=&nbsp;subsample&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.random_state&nbsp;=&nbsp;random_state&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.trees&nbsp;=&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.feature_importances_&nbsp;=&nbsp;dict()&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;fit(self,&nbsp;dataset,&nbsp;targets):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&#34;&#34;æ¨¡å‹è®­ç»ƒå…¥å£&#34;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;targets.unique().__len__()&nbsp;==&nbsp;2,&nbsp;&#34;There&nbsp;must&nbsp;be&nbsp;two&nbsp;class&nbsp;for&nbsp;targets!&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targets&nbsp;=&nbsp;targets.to_frame(name=&#39;label&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.random_state:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random.seed(self.random_state)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random_state_stages&nbsp;=&nbsp;random.sample(range(self.n_estimators),&nbsp;self.n_estimators)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ä¸¤ç§åˆ—é‡‡æ ·æ–¹å¼&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.colsample_bytree&nbsp;==&nbsp;&#34;sqrt&#34;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.colsample_bytree&nbsp;=&nbsp;int(len(dataset.columns)&nbsp;**&nbsp;0.5)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;self.colsample_bytree&nbsp;==&nbsp;&#34;log2&#34;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.colsample_bytree&nbsp;=&nbsp;int(math.log(len(dataset.columns)))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.colsample_bytree&nbsp;=&nbsp;len(dataset.columns)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;å¹¶è¡Œå»ºç«‹å¤šæ£µå†³ç­–æ ‘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.trees&nbsp;=&nbsp;Parallel(n_jobs=-1,&nbsp;verbose=0,&nbsp;backend=&#34;threading&#34;)(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delayed(self._parallel_build_trees)(dataset,&nbsp;targets,&nbsp;random_state)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;random_state&nbsp;in&nbsp;random_state_stages)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_parallel_build_trees(self,&nbsp;dataset,&nbsp;targets,&nbsp;random_state):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&#34;&#34;bootstrapæœ‰æ”¾å›æŠ½æ ·ç”Ÿæˆè®­ç»ƒæ ·æœ¬é›†ï¼Œå»ºç«‹å†³ç­–æ ‘&#34;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subcol_index&nbsp;=&nbsp;random.sample(dataset.columns.tolist(),&nbsp;self.colsample_bytree)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset_stage&nbsp;=&nbsp;dataset.sample(n=int(self.subsample&nbsp;*&nbsp;len(dataset)),&nbsp;replace=True,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random_state=random_state).reset_index(drop=True)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataset_stage&nbsp;=&nbsp;dataset_stage.loc[:,&nbsp;subcol_index]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targets_stage&nbsp;=&nbsp;targets.sample(n=int(self.subsample&nbsp;*&nbsp;len(dataset)),&nbsp;replace=True,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random_state=random_state).reset_index(drop=True)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tree&nbsp;=&nbsp;self._build_single_tree(dataset_stage,&nbsp;targets_stage,&nbsp;depth=0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(tree.describe_tree())&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;tree&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_build_single_tree(self,&nbsp;dataset,&nbsp;targets,&nbsp;depth):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&#34;&#34;é€’å½’å»ºç«‹å†³ç­–æ ‘&#34;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;å¦‚æœè¯¥èŠ‚ç‚¹çš„ç±»åˆ«å…¨éƒ½ä¸€æ ·/æ ·æœ¬å°äºåˆ†è£‚æ‰€éœ€æœ€å°æ ·æœ¬æ•°é‡ï¼Œåˆ™é€‰å–å‡ºç°æ¬¡æ•°æœ€å¤šçš„ç±»åˆ«ã€‚ç»ˆæ­¢åˆ†è£‚&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(targets[&#39;label&#39;].unique())&nbsp;&lt;=&nbsp;1&nbsp;or&nbsp;dataset.__len__()&nbsp;&lt;=&nbsp;self.min_samples_split:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tree&nbsp;=&nbsp;Tree()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tree.leaf_value&nbsp;=&nbsp;self.calc_leaf_value(targets[&#39;label&#39;])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;tree&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;depth&nbsp;&lt;&nbsp;self.max_depth:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;best_split_feature,&nbsp;best_split_value,&nbsp;best_split_gain&nbsp;=&nbsp;self.choose_best_feature(dataset,&nbsp;targets)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left_dataset,&nbsp;right_dataset,&nbsp;left_targets,&nbsp;right_targets&nbsp;=&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.split_dataset(dataset,&nbsp;targets,&nbsp;best_split_feature,&nbsp;best_split_value)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tree&nbsp;=&nbsp;Tree()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;å¦‚æœçˆ¶èŠ‚ç‚¹åˆ†è£‚åï¼Œå·¦å¶å­èŠ‚ç‚¹/å³å¶å­èŠ‚ç‚¹æ ·æœ¬å°äºè®¾ç½®çš„å¶å­èŠ‚ç‚¹æœ€å°æ ·æœ¬æ•°é‡ï¼Œåˆ™è¯¥çˆ¶èŠ‚ç‚¹ç»ˆæ­¢åˆ†è£‚&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;left_dataset.__len__()&nbsp;&lt;=&nbsp;self.min_samples_leaf&nbsp;or&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right_dataset.__len__()&nbsp;&lt;=&nbsp;self.min_samples_leaf&nbsp;or&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;best_split_gain&nbsp;&lt;=&nbsp;self.min_split_gain:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tree.leaf_value&nbsp;=&nbsp;self.calc_leaf_value(targets[&#39;label&#39;])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;tree&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;å¦‚æœåˆ†è£‚çš„æ—¶å€™ç”¨åˆ°è¯¥ç‰¹å¾ï¼Œåˆ™è¯¥ç‰¹å¾çš„importanceåŠ 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.feature_importances_[best_split_feature]&nbsp;=&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.feature_importances_.get(best_split_feature,&nbsp;0)&nbsp;+&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tree.split_feature&nbsp;=&nbsp;best_split_feature&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tree.split_value&nbsp;=&nbsp;best_split_value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tree.tree_left&nbsp;=&nbsp;self._build_single_tree(left_dataset,&nbsp;left_targets,&nbsp;depth+1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tree.tree_right&nbsp;=&nbsp;self._build_single_tree(right_dataset,&nbsp;right_targets,&nbsp;depth+1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;tree&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;å¦‚æœæ ‘çš„æ·±åº¦è¶…è¿‡é¢„è®¾å€¼ï¼Œåˆ™ç»ˆæ­¢åˆ†è£‚&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tree&nbsp;=&nbsp;Tree()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tree.leaf_value&nbsp;=&nbsp;self.calc_leaf_value(targets[&#39;label&#39;])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;tree&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;choose_best_feature(self,&nbsp;dataset,&nbsp;targets):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&#34;&#34;å¯»æ‰¾æœ€å¥½çš„æ•°æ®é›†åˆ’åˆ†æ–¹å¼ï¼Œæ‰¾åˆ°æœ€ä¼˜åˆ†è£‚ç‰¹å¾ã€åˆ†è£‚é˜ˆå€¼ã€åˆ†è£‚å¢ç›Š&#34;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;best_split_gain&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;best_split_feature&nbsp;=&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;best_split_value&nbsp;=&nbsp;None&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;feature&nbsp;in&nbsp;dataset.columns:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;dataset[feature].unique().__len__()&nbsp;&lt;=&nbsp;100:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unique_values&nbsp;=&nbsp;sorted(dataset[feature].unique().tolist())&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;å¦‚æœè¯¥ç»´åº¦ç‰¹å¾å–å€¼å¤ªå¤šï¼Œåˆ™é€‰æ‹©100ä¸ªç™¾åˆ†ä½å€¼ä½œä¸ºå¾…é€‰åˆ†è£‚é˜ˆå€¼&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unique_values&nbsp;=&nbsp;np.unique([np.percentile(dataset[feature],&nbsp;x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;x&nbsp;in&nbsp;np.linspace(0,&nbsp;100,&nbsp;100)])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;å¯¹å¯èƒ½çš„åˆ†è£‚é˜ˆå€¼æ±‚åˆ†è£‚å¢ç›Šï¼Œé€‰å–å¢ç›Šæœ€å¤§çš„é˜ˆå€¼&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;split_value&nbsp;in&nbsp;unique_values:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left_targets&nbsp;=&nbsp;targets[dataset[feature]&nbsp;&lt;=&nbsp;split_value]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right_targets&nbsp;=&nbsp;targets[dataset[feature]&nbsp;&gt;&nbsp;split_value]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;split_gain&nbsp;=&nbsp;self.calc_gini(left_targets[&#39;label&#39;],&nbsp;right_targets[&#39;label&#39;])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;split_gain&nbsp;&lt;&nbsp;best_split_gain:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;best_split_feature&nbsp;=&nbsp;feature&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;best_split_value&nbsp;=&nbsp;split_value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;best_split_gain&nbsp;=&nbsp;split_gain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;best_split_feature,&nbsp;best_split_value,&nbsp;best_split_gain&nbsp;&nbsp;&nbsp;&nbsp;@staticmethod&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;calc_leaf_value(targets):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&#34;&#34;é€‰æ‹©æ ·æœ¬ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„ç±»åˆ«ä½œä¸ºå¶å­èŠ‚ç‚¹å–å€¼&#34;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label_counts&nbsp;=&nbsp;collections.Counter(targets)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;major_label&nbsp;=&nbsp;max(zip(label_counts.values(),&nbsp;label_counts.keys()))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;major_label[1]&nbsp;&nbsp;&nbsp;&nbsp;@staticmethod&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;calc_gini(left_targets,&nbsp;right_targets):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&#34;&#34;åˆ†ç±»æ ‘é‡‡ç”¨åŸºå°¼æŒ‡æ•°ä½œä¸ºæŒ‡æ ‡æ¥é€‰æ‹©æœ€ä¼˜åˆ†è£‚ç‚¹&#34;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;split_gain&nbsp;=&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;targets&nbsp;in&nbsp;[left_targets,&nbsp;right_targets]:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gini&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ç»Ÿè®¡æ¯ä¸ªç±»åˆ«æœ‰å¤šå°‘æ ·æœ¬ï¼Œç„¶åè®¡ç®—gini&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label_counts&nbsp;=&nbsp;collections.Counter(targets)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;label_counts:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prob&nbsp;=&nbsp;label_counts[key]&nbsp;*&nbsp;1.0&nbsp;/&nbsp;len(targets)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gini&nbsp;-=&nbsp;prob&nbsp;**&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;split_gain&nbsp;+=&nbsp;len(targets)&nbsp;*&nbsp;1.0&nbsp;/&nbsp;(len(left_targets)&nbsp;+&nbsp;len(right_targets))&nbsp;*&nbsp;gini&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;split_gain&nbsp;&nbsp;&nbsp;&nbsp;@staticmethod&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;split_dataset(dataset,&nbsp;targets,&nbsp;split_feature,&nbsp;split_value):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&#34;&#34;æ ¹æ®ç‰¹å¾å’Œé˜ˆå€¼å°†æ ·æœ¬åˆ’åˆ†æˆå·¦å³ä¸¤ä»½ï¼Œå·¦è¾¹å°äºç­‰äºé˜ˆå€¼ï¼Œå³è¾¹å¤§äºé˜ˆå€¼&#34;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left_dataset&nbsp;=&nbsp;dataset[dataset[split_feature]&nbsp;&lt;=&nbsp;split_value]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left_targets&nbsp;=&nbsp;targets[dataset[split_feature]&nbsp;&lt;=&nbsp;split_value]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right_dataset&nbsp;=&nbsp;dataset[dataset[split_feature]&nbsp;&gt;&nbsp;split_value]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right_targets&nbsp;=&nbsp;targets[dataset[split_feature]&nbsp;&gt;&nbsp;split_value]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;left_dataset,&nbsp;right_dataset,&nbsp;left_targets,&nbsp;right_targets&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;predict(self,&nbsp;dataset):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&#34;&#34;è¾“å…¥æ ·æœ¬ï¼Œé¢„æµ‹æ‰€å±ç±»åˆ«&#34;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;_,&nbsp;row&nbsp;in&nbsp;dataset.iterrows():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pred_list&nbsp;=&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ç»Ÿè®¡æ¯æ£µæ ‘çš„é¢„æµ‹ç»“æœï¼Œé€‰å–å‡ºç°æ¬¡æ•°æœ€å¤šçš„ç»“æœä½œä¸ºæœ€ç»ˆç±»åˆ«&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;tree&nbsp;in&nbsp;self.trees:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pred_list.append(tree.calc_predict_value(row))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pred_label_counts&nbsp;=&nbsp;collections.Counter(pred_list)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pred_label&nbsp;=&nbsp;max(zip(pred_label_counts.values(),&nbsp;pred_label_counts.keys()))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res.append(pred_label[1])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;np.array(res)if&nbsp;__name__&nbsp;==&nbsp;&#39;__main__&#39;:&nbsp;&nbsp;&nbsp;&nbsp;df&nbsp;=&nbsp;pd.read_csv(&#34;source/wine.txt&#34;)&nbsp;&nbsp;&nbsp;&nbsp;df&nbsp;=&nbsp;df[df[&#39;label&#39;].isin([1,&nbsp;2])].sample(frac=1,&nbsp;random_state=66).reset_index(drop=True)&nbsp;&nbsp;&nbsp;&nbsp;clf&nbsp;=&nbsp;RandomForestClassifier(n_estimators=5,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max_depth=5,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_samples_split=6,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_samples_leaf=2,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_split_gain=0.0,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colsample_bytree=&#34;sqrt&#34;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subsample=0.8,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random_state=66)&nbsp;&nbsp;&nbsp;&nbsp;train_count&nbsp;=&nbsp;int(0.7&nbsp;*&nbsp;len(df))&nbsp;&nbsp;&nbsp;&nbsp;feature_list&nbsp;=&nbsp;[&#34;Alcohol&#34;,&nbsp;&#34;Malic&nbsp;acid&#34;,&nbsp;&#34;Ash&#34;,&nbsp;&#34;Alcalinity&nbsp;of&nbsp;ash&#34;,&nbsp;&#34;Magnesium&#34;,&nbsp;&#34;Total&nbsp;phenols&#34;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;Flavanoids&#34;,&nbsp;&#34;Nonflavanoid&nbsp;phenols&#34;,&nbsp;&#34;Proanthocyanins&#34;,&nbsp;&#34;Color&nbsp;intensity&#34;,&nbsp;&#34;Hue&#34;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;OD280/OD315&nbsp;of&nbsp;diluted&nbsp;wines&#34;,&nbsp;&#34;Proline&#34;]&nbsp;&nbsp;&nbsp;&nbsp;clf.fit(df.loc[:train_count,&nbsp;feature_list],&nbsp;df.loc[:train_count,&nbsp;&#39;label&#39;])&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;sklearn&nbsp;import&nbsp;metrics&nbsp;&nbsp;&nbsp;&nbsp;print(metrics.accuracy_score(df.loc[:train_count,&nbsp;&#39;label&#39;],&nbsp;clf.predict(df.loc[:train_count,&nbsp;feature_list])))&nbsp;&nbsp;&nbsp;&nbsp;print(metrics.accuracy_score(df.loc[train_count:,&nbsp;&#39;label&#39;],&nbsp;clf.predict(df.loc[train_count:,&nbsp;feature_list])))</code></pre><p style=text-align:justify>ç°åœ¨å®ç°éšæœºæ£®æ—åŸºæœ¬ä¸Šéƒ½æ˜¯å¯ä»¥ç›´æ¥è°ƒç”¨sklearné‡Œé¢çš„APIã€‚</p><pre><code>from&nbsp;sklearn.ensemble&nbsp;import&nbsp;RandomForestClassifier</code></pre><h1 class=pgc-h-arrow-right><strong>å‚è€ƒèµ„æ–™</strong></h1><p style=text-align:justify>[1]https://blog.csdn.net/yangyin007/article/details/82385967</p><p style=text-align:justify>[2]https://zhuanlan.zhihu.com/p/22097796</p><p style=text-align:justify>[3]https://github.com/zhaoxingfeng/RandomForest/blob/master/RandomForestClassification.py</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'æœºå™¨','å­¦ä¹ ','ç»å…¸'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>