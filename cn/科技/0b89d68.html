<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>[按键精灵手机版教程]纯API，教你画射击游戏的准心 | 极客快訊</title><meta property="og:title" content="[按键精灵手机版教程]纯API，教你画射击游戏的准心 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/56848524b86d4c398792468e06eea9bf"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0b89d68.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0b89d68.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0b89d68.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0b89d68.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0b89d68.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0b89d68.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0b89d68.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0b89d68.html><meta property="article:published_time" content="2020-10-29T20:58:37+08:00"><meta property="article:modified_time" content="2020-10-29T20:58:37+08:00"><meta name=Keywords content><meta name=description content="[按键精灵手机版教程]纯API，教你画射击游戏的准心"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/0b89d68.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>[按键精灵手机版教程]纯API，教你画射击游戏的准心</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><div class=pgc-img><img alt=[按键精灵手机版教程]纯API，教你画射击游戏的准心 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/56848524b86d4c398792468e06eea9bf><p class=pgc-img-caption></p></div><p>金猪脚本（原飞猪脚本）以按键精灵教学为主,涉及UiBot，Python,Lua等脚本编程语言,教学包括全自动办公脚本,游戏辅助脚本,引流脚本,网页脚本,安卓脚本,IOS脚本,注册脚本,点赞脚本,阅读脚本以及网赚脚本等各个领域。想制作脚本和学习按键精灵的朋友可以添加按键精灵学习交流群:554127455 学习路上不再孤单,金猪脚本伴你一同成长.</p><div class=pgc-img><img alt=[按键精灵手机版教程]纯API，教你画射击游戏的准心 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a10baa6f0b0f455daa76d1d3237688a8><p class=pgc-img-caption></p></div><blockquote><p>有的时候，玩枪击游戏，不想一直使用脚本。想偶尔手动，但是又因为没有准心时常打不准，锵锵锵~那为什么不自己画一个准心呢？我们一起来学习下这个准心要如何画吧~</p></blockquote><div class=pgc-img><img alt=[按键精灵手机版教程]纯API，教你画射击游戏的准心 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a782d861bad6485eb3d6caef6fbb84f3><p class=pgc-img-caption></p></div><blockquote></blockquote><p>首先，我们先来简单了解下，要用到的几个Api函数，吼吼~欢迎表格君上场~</p><hr><p><strong>SetROP2</strong>声明Declare Function SetROP2 Lib "gdi32" Alias "SetROP2" (ByVal hdc As Long, ByVal nDrawMode As Long) As Long功能主要用于设定当前前景色的混合模式。R2_NOT就是取反的意思，即前景色为背景色的反色，经常用R2_NOT来画橡皮线，因为两次取反可以还原背景色。参数1.设备场景的句柄 2.设备场景的新绘图模式返回值如执行成功，返回前一个绘图模式；零表示出错</p><p>GetWindowDC声明Declare Function GetWindowDC Lib "user32" Alias "GetWindowDC" (ByVal hwnd As Long) As Long功能获取整个窗口（包括边框、滚动条、标题栏、菜单等）的设备场景参数窗口句柄返回值设备句柄</p><p>CreatePen声明Declare Function CreatePen Lib "gdi32" Alias "CreatePen" (ByVal nPenStyle As Long, ByVal nWidth As Long, ByVal crColor As Long) As Long功能用指定的样式、宽度和颜色创建一个画笔参数画笔类型返回值如函数执行成功，就返回指向新画笔的一个句柄；否则返回零</p><p>SelectObject声明Declare Function SelectObject Lib "gdi32" Alias "SelectObject" (ByVal hdc As Long, ByVal hObject As Long) As Long功能每个设备场景都可能有选入其中的图形对象。其中包括位图、刷子、字体、画笔以及区域等等。一次选入设备场景的只能有一个对象。选定的对象会在设备场景的绘图操作中使用。例如，当前选定的画笔决定了在设备场景中描绘的线段颜色及样式参数1.一个设备场景的句柄 2.一个画笔、位图、刷子、字体或区域的句柄返回值与以前选入设备场景的相同hObject类型的一个对象的句柄，零表示出错。如选定的对象是一个区域（Region），结果就是下列常数之一：SIMPLEREGION， COMPLEXREGION 或 NULLREGION 对区域进行描述， GDI_ERROR 表示出错</p><p><strong>MoveToEx</strong>声明Declare Function MoveToEx Lib "gdi32" Alias "MoveToEx" (ByVal hdc As Long, ByVal x As Long, ByVal y As Long, lpPoint As POINTAPI) As Long功能为指定的设备场景指定一个新的当前画笔位置。前一个位置保存在lpPoint中参数1.指向一个设备场景的句柄 2.采用逻辑座标表示的新画笔位置 3.前一个画笔位置返回值非零表示成功，零表示失败</p><p><strong>LineTo</strong>声明Declare Function LineTo Lib "gdi32" Alias "LineTo" (ByVal hdc As Long, ByVal x As Long, ByVal y As Long) As Long功能用当前画笔画一条线，从当前位置连到一个指定的点。这个函数调用完毕，当前位置变成x,y点参数1设备场景的句柄 2.线段终点位置，采用逻辑座标表示。这个点不会实际画出来；它不属于线段的一部分返回值非零表示成功，零表示失败</p><p><strong>DeleteObject</strong>声明Declare Function DeleteObject Lib "gdi32" Alias "DeleteObject" (ByVal hObject As Long) As Long功能用这个函数删除GDI对象，比如画笔、刷子、字体、位图、区域以及调色板等等。对象使用的所有系统资源都会被释放参数一个GDI对象的句柄返回值非零表示成功，零表示失败</p><p>我们拿桌面窗口做例子，在桌面窗口上画一个准心，准心随着鼠标移动而移动。</p><p>脚本大致过程：</p><p>1、获取当前鼠标座标，以鼠标座标作为画笔位置</p><p>2、取设备句柄，这里设置取屏幕设备句柄</p><p>3、创建一个画笔对象</p><p>4、将创建的画笔对象载入到设备场景里（当前屏幕即是设备场景）。</p><p>5、清屏一次，消除之前画笔对象画的准心</p><p>6、指定好画笔开始的位置，（设置鼠标所在的座标）</p><p>7、 以鼠标座标为中心，画一条横线。以鼠标座标为中心，画一条竖线</p><p>8、加入Do……Loop 循环，画一个准心删除一个准心，这样就实现了准心跟随鼠标移动而移动</p><p><strong>代码：</strong></p><p class=ql-align-center><br></p><ol><li>Declare Function 取设备句柄 Lib "user32" Alias "GetWindowDC" (ByVal hwnd As Long) As Long</li><li>Declare Function 创建画笔对象 Lib "gdi32" Alias "CreatePen" (ByVal nPenStyle As Long, ByVal nWidth As Long, ByVal crColor As Long) As Long</li><li>Declare Function 选入场景 Lib "gdi32.dll" Alias "SelectObject" (ByVal hwnd As Long,ByVal hwnd As Long) As Long</li><li>Declare Function 指定画笔位置 Lib "gdi32" Alias "MoveToEx" (ByVal hdc As Long, ByVal x As Long, ByVal y As Long, ByVal x As Long) As Long</li><li>Declare Function 画直线 Lib "gdi32" Alias "LineTo" (ByVal hdc As Long, ByVal x As Long, ByVal y As Long) As Long</li><li>Declare Function 删除对象 Lib "gdi32" Alias "DeleteObject" (ByVal hObject As Long) As Long</li><li>//取设备句柄（窗口句柄）[返回设备句柄，整数型]</li><li>//创建画笔对象（类型，宽度，颜色）[返回对象句柄]</li><li>//选人场景（设备句柄，场景句柄）</li><li>//指定画笔位置(设备句柄，X，Y，座标结购)</li><li>//画直线（设备句柄，终点X，终点Y）</li><li>//删除对象（对象句柄）</li><li>Do</li><li>GetCursorPos x, y</li><li>设备句柄 =取设备句柄(0)//窗口句柄为0时，取屏幕设备句柄，如在指定窗口画就填写窗口句柄</li><li>对象句柄 = 创建画笔对象(1, 2, 255)//参数1为类型，参数2为线条粗细，参数3为10进制的颜色值（255是红色）</li><li>TracePrint 设备句柄</li><li>TracePrint 对象句柄</li><li>TracePrint 选入场景(设备句柄, 对象句柄)//此操作相当于windows画图时鼠标选择了画笔按钮。</li><li>Call Plugin.Msg.HideScrTXT()</li><li>TracePrint 指定画笔位置(设备句柄,x-50,y,座标结构)//座标结构不要使用，按键不支持此数据类型</li><li>TracePrint 画直线(设备句柄, x + 50, y )//画横线</li><li>TracePrint 指定画笔位置(设备句柄,x,y-50,座标结构)//座标结构不要使用，按键不支持此数据类型</li><li>TracePrint 画直线(设备句柄, x, y + 50)//画竖线</li><li>loop</li><li>TracePrint 删除对象(对象句柄)'画完以后记得释放对象</li></ol><p>复制代码</p><hr><p>另一种方法，通过 <strong>SetROP2 </strong>函数实现。</p><hr><p>前一种方法，是使用屏幕刷新 [backcolor=rgb(247, 247, 247)]Call Plugin.Msg.HideScrTXT() 用屏幕刷新来实现，画完一个准心刷新一次屏幕，把前面的画的准心清除掉。 <strong>SetROP2 </strong>函数是使用反色来覆盖掉前一次画的准心。</p><p>脚本大致思路：</p><p>1、画准心前，先取屏幕背景色的反色作为画笔的颜色，并且记录好当前鼠标座标。</p><p>2、画一个准心</p><p>3、画完之后，再次取反色，第一次获取屏幕背景色的反色，然后第二次再取反色，那这次取到的就是屏幕的背景色了。然后利用原来记录好的鼠标座标，画一个准心，相当于把之前画的准心用屏幕背景色再画一次进行覆盖。</p><p>4、循环画准心，达到鼠标移动，准心跟着移动的效果。</p><p><strong>代码：</strong></p><ol><li>Declare Function 反色 Lib "gdi32" Alias "SetROP2" (ByVal hdc As Long, ByVal nDrawMode As Long) As Long</li><li>Declare Function 取设备句柄 Lib "user32" Alias "GetWindowDC" (ByVal hwnd As Long) As Long</li><li>Declare Function 创建画笔对象 Lib "gdi32" Alias "CreatePen" (ByVal nPenStyle As Long, ByVal nWidth As Long, ByVal crColor As Long) As Long</li><li>Declare Function 选入场景 Lib "gdi32.dll" Alias "SelectObject" (ByVal hwnd As Long,ByVal hwnd As Long) As Long</li><li>Declare Function 指定画笔位置 Lib "gdi32" Alias "MoveToEx" (ByVal hdc As Long, ByVal x As Long, ByVal y As Long, ByVal x As Long) As Long</li><li>Declare Function 画直线 Lib "gdi32" Alias "LineTo" (ByVal hdc As Long, ByVal x As Long, ByVal y As Long) As Long</li><li>Declare Function 删除对象 Lib "gdi32" Alias "DeleteObject" (ByVal hObject As Long) As Long</li><li>//反色 （设备句柄，绘图模式）</li><li>//取设备句柄（窗口句柄）[返回设备句柄，整数型]</li><li>//创建画笔对象（类型，宽度，颜色）[返回对象句柄]</li><li>//选人场景（设备句柄，场景句柄）</li><li>//指定画笔位置(设备句柄，X，Y，座标结购)</li><li>//画直线（设备句柄，终点X，终点Y）</li><li>//删除对象（对象句柄）</li><li>// x1，y1 绘制座标 x2，y2 上次绘制座标</li><li>Dim x1, x2, y1, y2</li><li>设备句柄 =取设备句柄(0)//取桌面窗口设备句柄，如在指定窗口画就填写窗口句柄</li><li>对象句柄 = 创建画笔对象(1, 2, 0)//参数1为类型，参数2为线条粗细，参数3为10进制的颜色值（这里用到了反色api准心是背景反色就不设置颜色了）</li><li>TracePrint 设备句柄</li><li>TracePrint 对象句柄</li><li>TracePrint 选入场景(设备句柄, 对象句柄)//此操作相当于windows画图时鼠标选择了画笔按钮。</li><li>Do</li><li>反色 设备句柄, 6 //R2_NOT 绘图模式的值是6</li><li>TracePrint 指定画笔位置(设备句柄, x2 - 50, y2, 座标结构)//座标结构不要使用，按键不支持此数据类型</li><li>TracePrint 画直线(设备句柄, x2 + 50, y2 )//画横线</li><li>TracePrint 指定画笔位置(设备句柄, x2, y2 - 50, 座标结构)//座标结构不要使用，按键不支持此数据类型</li><li>TracePrint 画直线(设备句柄, x2, y2 + 50)//画竖线</li><li>GetCursorPos x1, y1</li><li>反色 设备句柄,6</li><li>TracePrint 指定画笔位置(设备句柄, x1 - 50, y1, 座标结构)//座标结构不要使用，按键不支持此数据类型</li><li>TracePrint 画直线(设备句柄, x1 + 50, y1 )//画横线</li><li>TracePrint 指定画笔位置(设备句柄, x1, y1 - 50, 座标结构)//座标结构不要使用，按键不支持此数据类型</li><li>TracePrint 画直线(设备句柄, x1, y1 + 50)//画竖线</li><li>x2 = x1</li><li>y2 = y1</li><li>loop</li></ol></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'按键','精灵手','机版'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>