<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>「项目详解」200SMART+V20在收卷机械上的应用 | 极客快訊</title><meta property="og:title" content="「项目详解」200SMART+V20在收卷机械上的应用 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/9fbbe052d62d4c25bf05cab938ca0ca2"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0c142e3.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0c142e3.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0c142e3.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0c142e3.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0c142e3.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0c142e3.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0c142e3.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0c142e3.html><meta property="article:published_time" content="2020-10-29T21:07:16+08:00"><meta property="article:modified_time" content="2020-10-29T21:07:16+08:00"><meta name=Keywords content><meta name=description content="「项目详解」200SMART+V20在收卷机械上的应用"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/0c142e3.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>「项目详解」200SMART+V20在收卷机械上的应用</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><br></p><p><strong>一、项目介绍</strong></p><p><br></p><h1 class=pgc-h-arrow-right><strong>1、行业背景：</strong></h1><p>目前国内塑料机械企业加大了对新兴市场的开拓，国际知名度进一步扩大，市场竞争力也进一步提高，这台设备就是出口到非洲国家，并且后续仍然会有大批量来自国外的订单。</p><p><br></p><h1 class=pgc-h-arrow-right><strong>2、工艺介绍：</strong></h1><p>收卷机的前道为挤出机放卷，挤出机出料由收卷机的240个异步电机完成。240个异步电机都是由V20控制，前道挤出与后道收卷的通讯由S7-200SMART完成，收卷的工艺主要在V20内部实现。</p><p><br></p><h1 class=pgc-h-arrow-right><strong>3、工艺难点：</strong></h1><p>① S7-200SMART与240*V20的通讯；</p><p>② LUA脚本的应用；</p><p>③ V20自由功能块的搭建。</p><p style=text-align:justify></p><p><br></p><p><strong>二、控制系统构成</strong></p><p style=text-align:justify><strong>1、系统结构网络图：</strong></p><p style=text-align:justify><br></p><div class=pgc-img><img alt=「项目详解」200SMART+V20在收卷机械上的应用 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9fbbe052d62d4c25bf05cab938ca0ca2><p class=pgc-img-caption></p></div><p style=text-align:justify><br></p><p style=text-align:justify><strong>2、选型依据及理论计算：</strong></p><p>共240个V20 ，所有V20的初速度都是通过主CPU给定，所以CPU需要同时与所有的V20进行通讯。V20支持USS和Modbus通讯，一个CPU通过串行链路最多可以连接31个变频器，所以首先排除USS的可能性。</p><p><br></p><p>Modbus通讯有两种模式，单播模式下，支持1到247个站，通过轮询的方式主站发起通讯，从站应答。另一种是广播模式，此模式下主站寻址所有从站，从站不做应答。</p><p><br></p><p>针对此应用，单播模式使用轮询的方式240个站情况下，轮询一次时间较长<strong>（200个从站，每个站的读取完毕的平均时间按20ms计算，那么轮询一遍，假设每个站通讯都正常的周期也有 20*200=4000ms，而实际应用中从站读写的周期恐怕都比20ms大很多）不符合控制逻辑需求，</strong>会导致位置在前的站先运行。</p><p><br></p><p><strong>采用广播模式情况下（1个字符在RTU模式下是以8位二进制形式传输的，故10个字符时间就是10*8个bit传输的时间，波特率为9600baud，即9600bit/s，那么1bit所需的传输时间就是1/9600秒，这样10个字符时间=10*8*1/9600秒=0.0083S），即保证站数量的可扩展性，也保证同步性。</strong>另外V20也支持LUA脚本，P值可以实时修改。内部也支持自由功能块，可以搭建需要的逻辑。对于CPU只要支持Modbus通讯，所以选择了200SMART就可以满足客户要求，并且配套SmartLineV3触摸屏作为显示及操作。</p><p style=text-align:justify></p><p><br></p><p><strong>三、功能实现</strong></p><p style=text-align:justify><strong>1、V20初速度给定：</strong></p><div class=pgc-img><img alt=「项目详解」200SMART+V20在收卷机械上的应用 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/89e4885599e4422b909d9475420c8da1><p class=pgc-img-caption></p></div><p style=text-align:justify><br></p><p>由于使用的是广播模式，所以站号必须为0。</p><p style=text-align:justify></p><div class=pgc-img><img alt=「项目详解」200SMART+V20在收卷机械上的应用 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3b5414f278bc4278bbf5444d097b56c5><p class=pgc-img-caption></p></div><p style=text-align:justify><br></p><p style=text-align:justify>写入速度之前必须要首先写控制字，在对应的寄存器内写047E。写入完成后再执行一次Modbus_MSG，再40101内写入主频率。</p><p style=text-align:justify><br></p><p style=text-align:justify><strong>2. V20内部自由功能块的搭建</strong></p><p>由于客户要求CPU只实现初速度的给定及报警的一些基本功能的实现，主要功能都要在V20内实现。所以V20必须实现如下功能：</p><p>① . 初速度给定后如果摆杆不提升，也就是空载状态下，运行5-10S后自动停机；</p><p>② . 需要使用V20内部PID实现收卷；</p><p>③ . 断线停机及摆杆提升过高一定时间需要自动停机；</p><p><strong>需要针对设备工艺需求单独搭建功能图</strong></p><p style=text-align:justify></p><p style=text-align:justify><strong>3. LUA脚本的应用</strong></p><p>Lua 是一种轻量小巧的脚本语言，用标准C语言编写并以源代码形式开放， 其设计目的是为了嵌入应用程序中，从而为应用程序提供灵活的扩展和定制功能。</p><p style=text-align:justify></p><p style=text-align:justify><strong>编程环境SciTE：</strong></p><p>SciTE（Scintilla Text Editor）是一个体积小巧的文本编辑器,支持众多的编程语言的语法高亮显示，比如C、C++、Lua、PHP、C#、perl、html、css、java、ruby等等。免费而且开源。支持linux和windows环境。在windows下面只需要将下载的文件解压缩就能使用。</p><p style=text-align:justify></p><p>如果需要使用脚本功能，必须确保Firmware是V3.94及以上，然后必须通过参数下载器，并且配备SD卡。</p><p style=text-align:justify></p><p style=text-align:justify><strong>必备文件：</strong></p><p>• autorun.lua</p><p>• utils.lua</p><p>• SSTAGE2.bin</p><p><br></p><p style=text-align:justify><strong>Lua脚本文件导入V20过程：</strong></p><p>• 在SD卡根目录下新建一个名为romfs的文件夹，将脚本文件“autorun.lua”, “utils.lua” 放入文件夹。</p><p>• 把“SSTAGE2.bin” 文件拷贝到SD卡根目录下。</p><p>• 将SD卡放入参数下载器，参数下载器插入变频器。</p><p>• 变频器上电，脚本文件成功导入变频器后，会提示“reboot”，V20变频器需要断电重新上电。</p><p>• 设置参数P4002=1即完成了脚本的导入</p><p style=text-align:justify></p><p style=text-align:justify><strong>脚本主要实现P值的实时更改，根据线速度的变化，对P值进行比例计算。</strong></p><p style=text-align:justify></p><p><br></p><p><strong>四、控制难点</strong></p><p><strong>1. 性能指标。</strong></p><p style=text-align:justify>节拍：300m/min。</p><p style=text-align:justify><br></p><p style=text-align:justify><strong>2. 控制关键点及难点</strong></p><p>①在脚本内通过卷径运算，实时更改P值，实现PID的精确控制；</p><p>②V20搭建功能块，实现PID的介入与出错报警；</p><p>③PLC与变频器通讯实现。</p><p><br></p><p><strong>3. 关键及难点部分的调试过程描述</strong></p><p style=text-align:justify><strong>（1）变频器与PLC通讯失败</strong></p><p style=text-align:justify><strong>采取手段：</strong></p><ul><li>检查PLC通讯程序，确保程序没有问题；</li><li>用抓包软件查看报文，发现PLC发出的报文不存在问题；</li><li>检查硬件，单独把PLC连接1台V20，并且采用调换AB相的方式，也就是PLC的A接到变频器的B，PLC的B接到变频器的A，便可以正常发送数据到V20，后查询资料，SMARTPLC是A- B+,所以对应到变频器端A+ B-之后必须A对应B，B对应A。</li></ul><p style=text-align:justify><br></p><p style=text-align:justify><strong>（2）变频器与PLC正常通讯，但无法接收到正确的频率</strong></p><p style=text-align:justify><strong>采取手段：</strong></p><p>首先检查通讯程序及地址，发现地址没有问题。后思考是否需要先发送控制字使能，查找对应控制字地址，也就是40100发047E，40101发频率，40101为4000H定标，也就是0-50HZ对应0-16384，进行换算后变频器可以收到PLC发送的正确频率。</p><p><br></p><p style=text-align:justify><strong>（3）变频器F72报警</strong></p><p style=text-align:justify><strong>采取手段：</strong></p><p>首先查看F72报警内容：USS/MODBUS 设定值故障，变频器在规定的时间内 P2014（USS /MODBUS 报文间断时间），报文间断期间无来自 USS/MODBUS 的设定值。</p><p><strong>针对报警内容，对如下几项进行判断：</strong></p><p><strong>（1）、主站出现异常</strong></p><ul><li>检查 USS/MODBUS 主站状态</li><li>检查控制字，控制字的第 10位必须为 1，检查没有问题</li></ul><p style=text-align:justify><strong>（2）. 硬件问题</strong></p><ul><li>检查 USS/MODBUS 通讯电缆断线或通讯电缆插头，发现并未出现松动</li></ul><p><strong>（3）、干扰问题</strong></p><ul><li>检查 USS/MODBUS 主站、变频器是否正确可靠接地，变频器与电机之间连</li><li>接电缆最好使用 4 芯电缆 3 相+PE 线，并使用 PE 线将变频器和电机进行接地连接；</li><li>检查 USS/MODBUS 通讯电缆屏蔽层是否可靠接地，USS/MODBUS 电缆屏蔽层</li><li>应正确压接到 USS/MODBUS 插头的屏蔽夹；</li><li>检查 USS/MODBUS 电缆是否与动力电缆走在同一桥架或走线槽中，USS/MODBUS 电缆应与动力电缆保持一定距离，如果平行布线间距最好大于 20cm；</li><li>检查终端电阻；</li></ul><p style=text-align:justify><br></p><p style=text-align:justify>以上多项都检查全部排出后，否认硬件出现问题，最后通过查询V20相关资料，更改参数P2014(报文间断时间)为0，不会再次出现F72报警。</p><p style=text-align:justify></p><p><br></p><p><strong>五、控制效果</strong></p><p style=text-align:justify>通过内部功能块实现PID功能及脚本实时更改P值，不会导致卷径的变化使摆杆上下浮动很大，实现了收卷过程中摆杆上下浮动更小，达到收卷更加稳定的效果，并且提升了线速度。</p><p style=text-align:justify></p><p><br></p><p><strong>六、应用体会</strong></p><p style=text-align:justify>V20虽然是定位入门级的变频器，但是其功能非常强大，既可以通过LUA脚本实现简单的编程功能，也可以通过自由功能块搭建逻辑应用于简单的机型。</p><p style=text-align:justify><br></p><p style=text-align:justify></p><p><br></p><p><strong>七、不惧竞争</strong></p><p style=text-align:justify>客户之前使用国产变频器及触摸屏，没有CPU的情况下，实现对整机的控制，总体成本不比西门子低，并且实际运行性能不如西门子方案。针对如上所述，西门子会不断对程序及脚本进行标准化，简化调试过程。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'项目','详解','200SMART'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>