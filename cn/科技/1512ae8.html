<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Excel基础知识-文本之长度函数和提取函数 | 极客快訊</title><meta property="og:title" content="Excel基础知识-文本之长度函数和提取函数 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/65206a3eccae405281cfbb2b9c708090"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/1512ae8.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/1512ae8.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/1512ae8.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/1512ae8.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/1512ae8.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/1512ae8.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/1512ae8.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/1512ae8.html><meta property="article:published_time" content="2020-10-29T21:04:54+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:54+08:00"><meta name=Keywords content><meta name=description content="Excel基础知识-文本之长度函数和提取函数"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/1512ae8.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Excel基础知识-文本之长度函数和提取函数</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p class=ql-align-justify>在Excel的操作中，我们经常处理一些复杂的文本，文本可能包括数字，字母，汉字，标点符号，有时候需要从中提取一些数字，大写字母或者统计内容项，要完成这些功能，通常离不开两个函数一个LEN和LENB函数，我们就先来聊聊这两个函数用法和区别吧。</p><p><strong>LEN和LENB</strong></p><p class=ql-align-justify><strong>功能：</strong>统计参数的长度，参数可以为常量，表达式，名称，引用单元格；LEN返回是文本长度，有多少字符长度为几而LENB返回的是文本字节长度，比如一个中文字符包括标点符号都是两个字节，那么问题来了，为什么中文字符占两个字节？</p><p class=ql-align-justify>我们知道日常在计算机中使用的所有数字，字母，符号，汉字都是用二进制的数字存储的，而计算机也是国外人设计的，他们在设计之初为了满足他们的语言特点就是规定了基础编码系统为ASCII编码，最初为7位数字和高位校验位来表示所有的大小字母数字以及常用符号，控制符，通信专用符（存储范围：0-127）；后基于X86的系统支持8位ASCII，也就现在的1-255，一个字节为8二进制数（2的8次方减1），它们就有了统一的名称叫单字节字符；再存储其他的字符需要增加一个字节，所以其它的字符都叫双字节字符，比如汉字，全角下的标点符号，其他语言的文字字符。</p><p>下面我们一起看看这两个函数的简单用法，结构图如下：</p><div class=pgc-img><img alt=Excel基础知识-文本之长度函数和提取函数 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/65206a3eccae405281cfbb2b9c708090><p class=pgc-img-caption>LEN和LENB函数的结构图示意图</p></div><p class=ql-align-justify>看完结构图是不是觉得，你还是说说怎么用吧？好的，我的问题是“我很loveyou”中，如果用上面的两个函数计算出英文的长度是几？汉字的长度是几？你要是直接数数那就赖皮啦，我们一起看看用计算机的方式来得出结果吧！其实就是简答的数学题，我们转化一下条件：假设汉字有X个，英文为Y个，我们可以得出两个等式分别为 X+Y=len("我很loveyou"),2X+Y=lenb("我很loveyou");X=lenb("我很loveyou")-len("我很loveyou"),Y=2*len("我很loveyou")-lenb("我很loveyou");有了公式，假设“我很loveyou”在单元格A1中，统计汉字个数公式：=lenb(A1)-len(A1)等于2;统计英文字母个数的公式：=2*len(A1)-lenb(A1)是不是等于7呢？</p><p><strong>提取函数</strong></p><p class=ql-align-justify>说到文本的提取函数，应该有六个，分为三对，分别为LEFT,MID,RIGHT,LEFTB,MIDB,RIGHTB;</p><p class=ql-align-justify>LEFT函数和RIGHT函数结构比较接近，两者不同的就是方向的差异，LEFT是从左1位开始向后截取为第二参数长度的字符串，而RIGHT则是从右末开始向前截取长度为第二参数的长度的字符串；需注2点：1.文本参数为错误码时会直接返回错误码（文本为引用单元格或函数时，处理需注意考虑错误编码的情况）；2.数字参数在不输入情况下，默认为1，如参数>len(文本),则返回整个文本；具体结构图如下：</p><div class=pgc-img><img alt=Excel基础知识-文本之长度函数和提取函数 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fd76ac7c6a104c40bd0be7a19f03e934><p class=pgc-img-caption>LEFT函数和RIGHT函数的结构图</p></div><p class=ql-align-justify>​至于MID函数在<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6687199530410050060/?group_id=6687199530410050060" target=_blank>Excel基础知识-详解随机点名器</a>​​​​有过详细介绍，这里就不过多赘述了！接下来就要看看LEFTB,MIDB,RIGHTB函数的情况，其他的功能上跟没有B的函数没有什么差别，主要的差别是在后面的“数字”部分，这里的参数的数字为字节数，因为单字节字符和双字节字符的区别，同样的参数截取的长度就有所不同，下面我们亲身验证一下这些细微的不同吧!</p><div class=pgc-img><img alt=Excel基础知识-文本之长度函数和提取函数 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/016aad122026429388695de5190d880a><p class=pgc-img-caption>leftb函数和rightb函数结构图</p></div><p>而MIDB函数只是参数跟上两个函数不同，所以单独拿出来说一下，先上结构图吧，</p><div class=pgc-img><img alt=Excel基础知识-文本之长度函数和提取函数 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/deee277cab18425186796310377cd8cf><p class=pgc-img-caption>MIDB函数的结构图</p></div><p class=ql-align-justify>这里需要说明“开始字节”和“字节数”这两参数，由于是字节数，特别注意在填写参数要注意，填写不当，就会出现你意向不到的结果，下面就仔细确认一下之前，先对字符串的存储，其实字符串每个字符后面会跟一个分隔符，长度为一个字节，Excel为了对字符串的长度进行精准显示，都在程序处理中会过滤掉中间这些分隔符，而末尾的分隔符会被保留，这样话的实际每个双字符的字符占用三个字节，带着这个认识再看是不是就容易理解LEFTB函数和RIGHTB函数，文本参数是双字节时，我们输入3，实际匹配出1个汉字和一个分隔符，当输入4时，会自动过滤掉中间的占位符，就返回了2个汉字，输入5时，依然会匹配出2个汉字一个分隔符。</p><p class=ql-align-justify>“分隔符”我怎么没有见过，你不会是骗人的吧？哪我就来证明一下，我说的你看不见的分隔符确实存在，为了方便检测结果，做了一个小的例子，使用的函数为MIDB，检测一下它的存在！数据单元格为A2,内容为：你没有说谎吗？，开始字节在B2单元格，字节数在C2单元格，D2=MIDB(A2,B2,C2)回车，为了让分隔符“显形”，我对D2单元格的文字设置了下划线，好了一起见证奇迹吧：效果图下：</p><div class=pgc-img><img alt=Excel基础知识-文本之长度函数和提取函数 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/06f20bd5bf8c44fdb0bc596e357100ff><p class=pgc-img-caption>分隔符显示效果图</p></div><p class=ql-align-justify>​你可以从图中看出分隔符的存在以及位置，是不是你平时都没有注意到这些呢？这些有用吗？如果你在使用MIDB函数截取文字的时候，就需要注意这个问题，如果你截取N个汉字，如果字节数填2×N就会出现少一汉字的情况，解决这类问题的方法就是截取字节数需2×N+1，就能截取完整的汉字啦，或首或尾都会保留一个分隔符（注：分隔符在字符紧跟其后，这也是为什么当开始字节数为1，不会出现分隔的原因！分隔符也不参与字符字节长度的计算）。</p><p class=ql-align-justify>今天的文章就写到这儿了，希望你在读文的时候，有所收获！哪是我最开心的事，希望你有时间也要多多实践，如果发现文中的纰漏，也欢迎你指正，在进步的路上我们一起前行。时光流转，来日方长，期待与屏幕前的你下文再见！</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'函数','Excel','基础'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>