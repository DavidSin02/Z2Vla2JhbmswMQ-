<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>åŸºäº HTML5 Canvas çš„ç®€æ˜“ 2D 3D ç¼–è¾‘å™¨ | æå®¢å¿«è¨Š</title><meta property="og:title" content="åŸºäº HTML5 Canvas çš„ç®€æ˜“ 2D 3D ç¼–è¾‘å™¨ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/8a0a10ae0db9431c8e2cdf7d935e3dcd"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/159c812.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/159c812.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/159c812.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/159c812.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/159c812.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/159c812.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/159c812.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/159c812.html><meta property="article:published_time" content="2020-10-29T20:58:37+08:00"><meta property="article:modified_time" content="2020-10-29T20:58:37+08:00"><meta name=Keywords content><meta name=description content="åŸºäº HTML5 Canvas çš„ç®€æ˜“ 2D 3D ç¼–è¾‘å™¨"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/159c812.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>åŸºäº HTML5 Canvas çš„ç®€æ˜“ 2D 3D ç¼–è¾‘å™¨</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><p>ä¸ç®¡åœ¨ä»»ä½•é¢†åŸŸï¼Œåªè¦èƒ½è®©éç¨‹åºå‘˜èƒ½é€šè¿‡æ‹–æ‹½æ¥å®ç° 2D å’Œ 3D çš„è®¾è®¡å›¾å°±æ˜¯å¾ˆç‰›çš„ï¼Œä»Šå¤©æˆ‘ä»¬ä¸éœ€è¦ 3dMaxs ç­‰è®¾è®¡è½¯ä»¶ï¼Œç›´æ¥ç”¨ HT å°±èƒ½è‡ªå·±å†™å‡ºä¸€ä¸ª 2D 3D ç¼–è¾‘å™¨ï¼Œå®ç°è¿™ä¸ªåŠŸèƒ½æˆ‘è§‰å¾—æˆå°±æ„Ÿè¿˜æ˜¯çˆ†æ£šçš„ï¼Œå“ˆå“ˆï¼åªè¦ä½ ä¼šæƒ³ï¼Œèƒ½åšï¼Œå°±èƒ½æ ¹æ®è¿™ä¸ªç¼–è¾‘å™¨å»¶å±•æˆ big thingï¼</p><p>ä¸‹é¢æ˜¯å®ç°æ•ˆæœå›¾ï¼š</p><div class=pgc-img><img alt="åŸºäº HTML5 Canvas çš„ç®€æ˜“ 2D 3D ç¼–è¾‘å™¨" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8a0a10ae0db9431c8e2cdf7d935e3dcd><p class=pgc-img-caption></p></div><p>æˆ‘ä»¬é¦–å…ˆå°†æ‰€æœ‰éœ€è¦ç”¨åˆ°çš„ json æ–‡ä»¶ä½œä¸ºçŸ¢é‡å›¾è¾“å‡ºï¼ŒçŸ¢é‡å›¾çš„å¥½å¤„æ˜¯ç»„ä»¶ä¸Šçš„å›¾å…ƒç¼©æ”¾éƒ½ä¸ä¼šå¤±çœŸï¼Œå¹¶ä¸”ä¸å†éœ€è¦ä¸º Retina æ˜¾ç¤ºå±æä¾›ä¸åŒå°ºå¯¸çš„å›¾ç‰‡ï¼Œ åœ¨ devicePixelRatio å¤šæ ·åŒ–çš„ç§»åŠ¨æ—¶ä»£ï¼Œ è¦å®ç°å®Œç¾çš„è·¨å¹³å°ï¼ŒçŸ¢é‡å¯èƒ½æ˜¯çš„æœ€ä½æˆæœ¬çš„è§£å†³æ–¹æ¡ˆã€‚</p><p>HT é€šè¿‡ ht.Default.setImage å‡½æ•°æ¥æ³¨å†Œå›¾ç‰‡ï¼Œå¯ä»¥æ˜¯ base64ã€jpgã€ png ä»¥åŠ json æ ¼å¼çš„å›¾ç‰‡ï¼š</p><pre>ht.Default.setImage('edit', 'images/default.json');ht.Default.setImage('shape', 'images/edit.json');ht.Default.setImage('edge', 'images/edge.json');ht.Default.setImage('circle', 'images/circle.json');ht.Default.setImage('roundRect', 'images/roundRect.json');ht.Default.setImage('rect', 'images/rect.json');</pre><p>è¿™è¾¹æˆ‘æ³¨å†Œçš„æ˜¯é¡¶éƒ¨å·¥å…·æ¡çš„ 6 ä¸ªå›¾ç‰‡ï¼Œåˆ†åˆ«ä¸ºâ€œç¼–è¾‘â€ã€â€œä¸è§„åˆ™å›¾å½¢â€ã€â€œåœ†â€ã€â€œåœ†è§’çŸ©å½¢â€ã€â€œçŸ©å½¢â€ä»¥åŠâ€œè¿çº¿â€ï¼ŒåŠŸèƒ½å¦‚å…¶åã€‚ä¸»è¦æ“ä½œï¼šç‚¹å‡»å·¥å…·æ¡çš„ä»»æ„ä¸€ä¸ªå›¾æ ‡ï¼Œåœ¨å·¥å…·æ¡ä¸‹çš„ç©ºç™½å¤„æ‹–åŠ¨é¼ æ ‡ï¼Œå³å¯å®ç°ç»˜å›¾ã€‚</p><div class=pgc-img><img alt="åŸºäº HTML5 Canvas çš„ç®€æ˜“ 2D 3D ç¼–è¾‘å™¨" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/67aaabadd5c944ac8e3d08e77617d3fe><p class=pgc-img-caption></p></div><p>é‚£ä¹ˆæ¥ä¸‹æ¥çš„æ­¥éª¤å°±æ˜¯åˆ›å»ºâ€œå·¥å…·æ¡â€ï¼ŒHT å°è£…äº†å·¥å…·æ¡çš„ç»„ä»¶ ht.widget.Toolbar åœ¨è¿™ä¸ªå‡½æ•°çš„å‚æ•°ä¸­å¡«å…¥å·¥å…·æ¡ä¸­çš„å…ƒç´ ï¼Œå…·ä½“æ“ä½œæ–¹æ³•è¯·çœ‹ HT for Web å·¥å…·æ¡æ‰‹å†Œï¼Œè¿™è¾¹å€¼å¾—æ³¨æ„çš„ä¸€ä¸ªç‚¹æ˜¯ï¼ŒgroupId æ˜¯å°†ä¸€ä¸ªç±»å‹çš„å…ƒç´ åˆ†ç»„ï¼Œåˆ†ç»„çš„å¥½å¤„æ˜¯åœ¨æˆ‘ä»¬é€‰ä¸­è¿™ä¸ªç»„ä¸­çš„ä»»æ„ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œå…¶ä»–çš„å…ƒç´ éƒ½ä¸é€‰ä¸­ï¼Œå°±èƒ½é€ æˆâ€œå•é€‰â€çš„æ•ˆæœï¼š</p><pre>toolbar = new ht.widget.Toolbar();toolbar.addItem(createItem('edit', 'edit', 'ç¼–è¾‘', [ new ht.graph.EditInteractor(graphView)]));//è¿™è¾¹æœ€åä¸€ä¸ªå‚æ•°æ•°ç»„å¯æ”¾ç½®å¤šä¸ªäº¤äº’å™¨ï¼Œå…·ä½“å®šä¹‰è¯·å‚è§ HT for Web å…¥é—¨æ‰‹å†Œ//addItem(item, index)å¯åœ¨æŒ‡å®šindexä½ç½®æ’å…¥æ–°å…ƒç´ ï¼Œindexä¸ºç©ºä»£è¡¨æ’å…¥åˆ°æœ€åã€‚toolbar.addItem(createItem('shape', 'shape', 'ä¸è§„åˆ™å›¾å½¢', [ new CreateShapeInteractor(graphView)]));toolbar.addItem(createItem('circle', 'circle', 'åœ†', [ new CreateNodeInteractor(graphView)]));toolbar.addItem(createItem('roundRect', 'roundRect', 'åœ†è§’çŸ©å½¢', [ new CreateNodeInteractor(graphView)]));toolbar.addItem(createItem('rect', 'rect', 'çŸ©å½¢', [ new CreateNodeInteractor(graphView)]));toolbar.addItem(createItem('edge', 'edge', 'è¿çº¿', [ new CreateEdgeInteractor(graphView)]));toolbar.getItemById('edit').selected = true;//é»˜è®¤é€‰ä¸­â€œç¼–è¾‘â€toolbar.getSelectBackground = function(){//é‡è½½è‡ªå®šä¹‰é€‰ä¸­èƒŒæ™¯é¢œè‰² return '#eee';}</pre><p>åœ¨ä¸Šé¢ç”¨åˆ°çš„ addItem å‡½æ•°æ˜¯å‘ ht.widget.Toolbar å·¥å…·æ¡ä¸­æ·»åŠ å…ƒç´ ï¼Œæ·»åŠ çš„å…ƒç´ æ˜¯ä» createItem å‡½æ•°ä¸­ä¼ å›æ¥çš„å…ƒç´ ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªå‡½æ•°ä¸­åˆ©ç”¨äº† vector çŸ¢é‡åˆ›é€ äº†ä¸€ä¸ªçŸ©å½¢å’Œä¸€å¼ å›¾ç‰‡çš„ç»“åˆä½“ï¼Œæˆ‘ä»¬å°†ä¹‹å‰æ³¨å†Œå¥½çš„çŸ¢é‡å›¾ä¼ ç»™è¿™ä¸ªç»“åˆä½“ä¸­çš„â€œå›¾ç‰‡â€ï¼Œç„¶åé€šè¿‡æ§åˆ¶è¿™ä¸ªå›¾ç‰‡çš„â€œæ¸²æŸ“é¢œè‰²â€ï¼Œæ¥è¿‡æ»¤å·¥å…·æ¡é€‰ä¸­å’Œéé€‰ä¸­çŠ¶æ€çš„é¢œè‰²ï¼š</p><pre>function createItem(id, iconName, toolTip, interactorsArr){ var item = { id: id,//å·¥å…·æ¡å…ƒç´ çš„å”¯ä¸€æ ‡ç¤ºï¼Œå¦‚æœè®¾ç½®å¯é€šè¿‡getItemByIdè·å– unfocusable: true,//å·¥å…·æ¡å…ƒç´ æ˜¯å¦ä¸å¯è·å–ç„¦ç‚¹ï¼Œé»˜è®¤é¼ æ ‡æ»‘è¿‡æ—¶ä¼šæ˜¾ç¤ºä¸€ä¸ªçŸ©å½¢è¾¹æ¡†ï¼Œå¯è®¾ç½®ä¸ºtrueå…³é—­æ­¤æ•ˆæœ icon: iconName,//å·¥å…·æ¡å…ƒç´ çš„å›¾æ ‡ toolTip: toolTip,//å·¥å…·æ¡å…ƒç´ çš„æ–‡å­—æç¤º groupId: 'bar'//å¯¹å·¥å…·æ¡å…ƒç´ è¿›è¡Œåˆ†ç»„ï¼ŒåŒä¸€ä¸ªåˆ†ç»„å†…çš„å…ƒç´ é€‰ä¸­ä¼šè‡ªåŠ¨å‡ºç°äº’æ–¥æ•ˆæœ }; var json = ht.Default.getImage(iconName); var width = json ? json.width : 16; var height = json ? json.height : 16; item.icon = { width: width + 8, height: height + 8, fitSize: json ? json.fitSize : false, comps: [ { type: 'rect',//ç»„ä»¶ç±»å‹ rect: [0, 0, width + 8, height + 8]//æŒ‡å®šç»„ä»¶ç»˜åˆ¶åœ¨çŸ¢é‡ä¸­çš„çŸ©å½¢è¾¹ç•Œ }, { type: 'image', name: iconName, color: {//æ¸²æŸ“é¢œè‰²ï¼ŒHTç³»ç»Ÿä¼šè‡ªåŠ¨é‡‡ç”¨è¯¥é¢œè‰²å¯¹å›¾ç‰‡å†…å®¹è¿›è¡Œæ¸²æŸ“ func: (data, view) =&gt; { return '#000' } } } ] }; item.action = function(){//å‡½æ•°ç±»å‹ï¼Œå·¥å…·æ¡å…ƒç´ è¢«ç‚¹å‡»æ—¶è°ƒç”¨ for(var i = 0; i &lt; toolbar.getItems().length; i++){ toolbar.getItems()[i].icon.comps[1].color = '#000'; } item.icon.comps[1].color = '#1E90FF'; graphView.setInteractors(interactorsArr);//ç»„åˆå¤šä¸ªäº¤äº’å™¨ graphView.sm().clearSelection();//æ¯æ¬¡å·¥å…·æ¡æœ‰ç‚¹å‡»çš„æ—¶å€™å°±æ¸…ç©ºæ‰€æœ‰çš„é€‰ä¸­ } return item;}</pre><p>æ¥ç€åˆ©ç”¨ HT å°è£…çš„é¢æ¿ç»„ä»¶ ht.widget.BorderPane å°†æ•´ä¸ªç•Œé¢åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼šé¡¶éƒ¨å’Œåº•éƒ¨ã€‚æˆ‘ä»¬åˆåˆ©ç”¨ HT å°è£…çš„ ht.widget.SplitView åˆ†å‰²ç»„ä»¶å°†åº•éƒ¨åˆ†ä¸ºä¸Šä¸‹ä¸¤ä¸ªéƒ¨åˆ†ï¼Œæœ€åå°†è¿™ä¸ªå¤–è¾¹æ¡† borderPane æ·»åŠ è¿› body ä½“ä¸­ï¼š</p><pre>splitView = new ht.widget.SplitView(graphView, g3d, 'v', 0.5);borderPane = new ht.widget.BorderPane();borderPane.setTopView(toolbar);borderPane.setCenterView(splitView);borderPane.addToDOM(); </pre><p>æ•´ä¸ªåœºæ™¯éƒ½åˆ¶ä½œå®Œæ¯•ï¼Œæ¥ç€å°±æ˜¯åŠŸèƒ½éƒ¨åˆ†ã€‚æˆ‘ä»¬æŠŠåˆ¶ä½œâ€œä¸è§„åˆ™å›¾å½¢â€ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„éƒ¨åˆ†æ”¾åˆ° CreateShapeInteractor.js ä¸­ï¼Œåˆ¶ä½œâ€œåœ†â€ã€â€œåœ†è§’çŸ©å½¢â€ä»¥åŠâ€œçŸ©å½¢â€ä¸‰ä¸ªéƒ¨åˆ†åˆ†ä¸ºä¸€ä¸ªéƒ¨åˆ†æ”¾åˆ° CreateNodeInteractor.js ä¸­ï¼Œå°†â€œè¿çº¿â€åˆ†ä¸ºä¸€ä¸ªéƒ¨åˆ†æ”¾åˆ° CreateEdgeInteractor.js ä¸­ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†å¯¹è¿™ä¸‰ä¸ª js æ–‡ä»¶ä¸€ä¸ªä¸ªè§£æã€‚</p><div class=pgc-img><img alt="åŸºäº HTML5 Canvas çš„ç®€æ˜“ 2D 3D ç¼–è¾‘å™¨" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/599278788b2b407bb988471e275f45bf><p class=pgc-img-caption></p></div><p>è¿™ä¸‰ä¸ª js æ–‡ä»¶çš„å…±åŒç‚¹æ˜¯é€šè¿‡ HT å°è£…çš„ç»§æ‰¿å‡½æ•° ht.Default.def ç»§æ‰¿å¹¶åˆ›å»ºæ–°çš„ç±»ï¼Œè¿™ä¸‰ä¸ªç±»æˆ‘ä»¬åœ¨å‰é¢çš„ä»£ç ä¸­æ˜¯æœ‰æåˆ°çš„ï¼š CreateShapeInteractorã€CreateNodeInteractor ä»¥åŠ CreateEdgeInteractor ç±»ï¼Œéƒ½å¤§åŒå°å¼‚ï¼Œæˆ‘ä»¬è¿™é‡Œé‡ç‚¹è§£æ CreateNodeInteractor.js æ–‡ä»¶ã€‚</p><p>é¦–å…ˆå°±æ˜¯è¦å£°æ˜å®šä¹‰ä¸€ä¸ª CreateNodeInteractor ç±»ï¼Œå°±æ˜¯è¿™ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><div class=pgc-img><img alt="åŸºäº HTML5 Canvas çš„ç®€æ˜“ 2D 3D ç¼–è¾‘å™¨" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1b455e08680242798f10e74d39089e28><p class=pgc-img-caption></p></div><pre>var CreateNodeInteractor = function (graphView) { CreateNodeInteractor.superClass.constructor.call(this, graphView); };ht.Default.def(CreateNodeInteractor, ht.graph.Interactor, { //è‡ªå®šä¹‰ç±»ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç±»åï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºç»§æ‰¿çš„ç±»ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºæ­¤ç±»çš„æ–¹æ³• //è¿™è¾¹é‡æ–°ç»˜åˆ¶è¿™ä¸ªç±»çš„æ–¹æ³•}</pre><p>æ¥ç€å°±æ˜¯å‘è¿™ä¸ªç±»ä¸­æ·»åŠ æˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½ï¼Œä¸»è¦çš„åŠŸèƒ½æ˜¯â€œé¼ æ ‡ç‚¹å‡»äº‹ä»¶çš„è§¦å‘â€ä»¥åŠâ€œè§¦æ‘¸å±å¹•äº‹ä»¶çš„è§¦å‘â€ï¼Œæˆ‘ä»¬é€šè¿‡å¯¹äº‹ä»¶çš„ç›‘å¬æ¥ç»˜åˆ¶å›¾å½¢ï¼Œé¦–å…ˆå°±æ˜¯åˆ¤æ–­é¼ æ ‡å·¦é”®æˆ–è€…è§¦å±æ˜¯å¦ç‚¹å‡»ï¼š</p><pre>handle_touchstart: function (e) {//è§¦å± å¼€å§‹ç‚¹å‡» ht.Default.preventDefault(e);//é˜»æ­¢æ‰€æœ‰çš„é»˜è®¤äº¤äº’äº‹ä»¶ if (ht.Default.isLeftButton(e)) {//é¼ æ ‡å·¦é”®æ˜¯å¦ç‚¹å‡» this._graphView.setFocus(e);//è®¾ç½®ç„¦ç‚¹ this.p1 = this._graphView.lp(e);//è·å–å½“å‰é€»è¾‘åº§æ ‡ç‚¹ this.startDragging(e);//è°ƒç”¨ startDragging å¼€å§‹æ‹–æ‹½å‡½æ•°  }} </pre><p>ç„¶åå¯¹é¼ æ ‡å¼¹èµ·æˆ–è€…è§¦å±æ˜¯å¦ç»“æŸè¿›è¡Œäº‹ä»¶çš„åˆ¤æ–­ï¼Œå¹¶ç›´æ¥ç”Ÿæˆä¸€ä¸ª ht.Node èŠ‚ç‚¹ã€‚HT æŠŠå•çº¯çš„ç‚¹å‡»äº‹ä»¶å’Œæ‹–æ‹½äº‹ä»¶åˆ†ä¸ºä¸¤ç§å‘½åæ ¼å¼ï¼Œå•çº¯çš„ç‚¹å‡»äº‹ä»¶ä¸º handle_* æ–¹æ³•ï¼Œæ‹–æ‹½äº‹ä»¶æ˜¯ handleWindow* æ–¹æ³•ã€‚ä¸Šé¢çš„ä»£ç å°±æ˜¯ä»ç‚¹å‡»å·¥å…·æ¡çš„èƒ½è§¦å‘ CreateNodeInteractor ç±»çš„å…ƒç´ å¼€å§‹ï¼Œåˆ°æ”¾åˆ°ç•Œé¢ä¸­ç”Ÿæˆå›¾å…ƒç»“æŸã€‚å¹¶æ²¡æœ‰æ‹–æ‹½çš„è¿‡ç¨‹ï¼Œä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„å¤§å°ï¼š</p><div class=pgc-img><img alt="åŸºäº HTML5 Canvas çš„ç®€æ˜“ 2D 3D ç¼–è¾‘å™¨" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b42ac3fa9b504f5496a6dae8b3bb5f43><p class=pgc-img-caption></p></div><p>HT é»˜è®¤è°ƒç”¨ ht.graph.DefaultInteractor äº‹ä»¶ï¼Œé‡Œé¢æœ‰ä¸€ç³»åˆ—çš„æ“ä½œï¼Œæˆ‘ä»¬ç°åœ¨è¦åšçš„æ‹–æ‹½è·Ÿè¿™ä¸ªæœ‰å†²çªï¼Œæ‰€ä»¥åœ¨å‰é¢æˆ‘ä»¬å…ˆå°†è¿™ä¸ªé»˜è®¤çš„äº‹ä»¶é˜»æ­¢ï¼Œè·å–é¼ æ ‡ç‚¹ä¸‹çš„ç¬¬ä¸€ä¸ªç‚¹çš„é€»è¾‘åº§æ ‡å’Œç¬¬äºŒä¸ªç‚¹çš„é€»è¾‘åº§æ ‡ï¼Œæ ¹æ®è¿™ä¸¤ä¸ªåº§æ ‡çš„ç‚¹ç”Ÿæˆä¸€ä¸ªçŸ©å½¢ï¼Œç„¶åå¼€å§‹ç»˜åˆ¶èŠ‚ç‚¹ï¼š</p><pre>handleWindowTouchMove: function(e) { ht.Default.preventDefault(e);//é˜»æ­¢äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºï¼Œå¸¸ç”¨äºå±è”½è§¦å±ä¸Šé»˜è®¤DoubleTapç¼©æ”¾ç­‰è¡Œä¸º if (!this.p1) { return; } this.p2 = this._graphView.lp(e); const rect = ht.Default.unionPoint(this.p1, this.p2);//å°† p1 å’Œ p2 ä¸¤ä¸ªç‚¹ç»„åˆæˆä¸€ä¸ªçŸ©å½¢ if (this.node) { this.node.setRect(rect); } else { if (!rect.width || !rect.height) { return; } this._graphView.dm().beginTransaction();//ç±»ä¼¼æ•°æ®åº“é‡Œå¼€å¯äº‹åŠ¡ï¼Œä»beginTransaction()åˆ°endTransaction()ä¹‹é—´æ‰€æœ‰çš„ä¿®æ”¹å¯è¢«ä¸€æ¬¡æ€§æ’¤é”€æˆ–é‡åš this.createNode(rect, false);//è°ƒç”¨ createNode å‡½æ•° }}</pre><p>ç„¶ååœ¨æ‹–æ‹½ç»“æŸçš„æ—¶å€™åšç»“æŸç»˜åˆ¶å›¾å½¢çš„æ“ä½œï¼Œè¿™é‡Œæˆ‘æ˜¯ç›´æ¥è®¾ç½®ç»˜åˆ¶ç»“æŸåå°±å°†å·¥å…·æ¡é€‰ä¸­â€œç¼–è¾‘â€çš„å…ƒç´ ï¼š</p><pre>handleWindowTouchEnd: function(e) { ht.Default.preventDefault(e); this._graphView.dm().endTransaction();//ç±»ä¼¼æ•°æ®åº“é‡Œç»“æŸäº‹åŠ¡ï¼Œä»beginTransaction()åˆ°endTransaction()ä¹‹é—´æ‰€æœ‰çš„ä¿®æ”¹å¯è¢«ä¸€æ¬¡æ€§æ’¤é”€æˆ–é‡åš if (!this.node &amp;&amp; this.p1) { this.createNode({ x: this.p1.x - 25, y: this.p1.y - 25, width: 50, height: 50 }, true); } var continuousCreating = false; if (!continuousCreating) { for(var i = 0; i &lt; toolbar.getItems().length; i++){ toolbar.getItems()[i].selected = false; toolbar.getItems()[i].icon.comps[1].color = '#000'; } toolbar.getItemById('edit').selected = true; toolbar.getItemById('edit').icon.comps[1].color = '#1E90FF'; borderPane.iv(); this._graphView.setEditable(true); this._graphView.sm().ss(this.node); } else { this.node = this.p1 = this.p2 = null; }}</pre><p>æœ€åï¼Œæˆ‘ä»¬åªè¦çŸ¥é“å¦‚ä½•ç»˜åˆ¶å›¾å…ƒå°±å¥½äº†ï¼Œåœ¨ HT ä¸­ï¼ŒåŸºç¡€çš„å›¾å…ƒéƒ½å¯ä»¥é€šè¿‡è®¾ç½®æ ·å¼ä¸­çš„ shape æˆ–è€… shape3d æ¥ç”Ÿæˆä¸åŒçš„å›¾å…ƒï¼Œæˆ‘ä»¬è¿™è¾¹å°±æ˜¯é€šè¿‡è¿™ç§é€”å¾„ï¼Œå¦‚æœæƒ³è¦åœ¨ç•Œé¢ä¸­ç”Ÿæˆå¤æ‚å›¾å½¢ï¼Œå¦‚ï¼šæœºæŸœæ¨¡å‹ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼šhttp://www.cnblogs.com/xhload3d/p/7887229.html</p><pre>createNode: function(rect, click) { // create instance if (ht.Default.isFunction(this.type)) { this.node = this.type(rect, click); } else { this.node = new ht.Node(); } this.node.setTall(50);//ä¸º 3D å›¾å½¢åšå‡†å¤‡ï¼Œè®¾ç½®å…¶åšåº¦ï¼Œæ‰ä¼šæœ‰ç«‹ä½“æ„Ÿ if(toolbar.getItemById('circle').selected){//å¦‚æœå·¥å…·æ¡çš„ â€˜circleâ€™ è¢«é€‰ä¸­ this.node.s({//è®¾ç½® style æ ·å¼ "shape": "oval",//æ¤­åœ†å½¢ï¼Œä¸ºç©ºæ—¶æ˜¾ç¤ºä¸ºå›¾ç‰‡ï¼Œå¯è®¾ç½®å¤šè¾¹å½¢ç±»å‹å‚è§å…¥é—¨æ‰‹å†Œ "shape.background": "#D8D8D8",//å¤šè¾¹å½¢ç±»å‹å›¾å…ƒèƒŒæ™¯ "shape.border.width": 1,//å¤šè¾¹å½¢ç±»å‹å›¾å…ƒè¾¹æ¡†å®½åº¦ "shape.border.color": "#979797",//å¤šè¾¹å½¢ç±»å‹å›¾å…ƒè¾¹æ¡†é¢œè‰² "shape3d": "sphere"//ä¸ºç©ºæ—¶æ˜¾ç¤ºä¸ºå…­é¢ç«‹æ–¹ä½“ï¼Œå…¶ä»–å¯é€‰å€¼ä¸ºbox|sphere|cylinder|cone|torus|star|rect|roundRect|triangle|rightTriangle|parallelogram|trapezoid }); }else if(toolbar.getItemById('roundRect').selected){ this.node.s({ "shape": "roundRect",//åœ†è§’çŸ©å½¢ "shape.background": "#D8D8D8", "shape.border.width": 1, "shape.border.color": "#979797", "shape3d": "roundRect" }); }else if(toolbar.getItemById('rect').selected){ this.node.s({ "shape": "rect",//çŸ©å½¢ "shape.background": "#D8D8D8", "shape.border.width": 1, "shape.border.color": "#979797", "shape3d": "rect" }); } // set bounds if (click) { this.node.setPosition(rect.x + rect.width / 2, rect.y + rect.height / 2);//è®¾ç½® node çš„åº§æ ‡ç‚¹ } else { this.node.setRect(rect);//è®¾ç½® node çš„å¤–çŸ©å½¢è¾¹æ¡†å¤§å° } // add to data model this._graphView.dm().add(this.node);//å°†è¿™ä¸ª node æ·»åŠ è¿›æ•°æ®å®¹å™¨ DataModel ä¸­}</pre><p>åˆ°æ­¤ï¼Œåˆ›å»º ht.Node èŠ‚ç‚¹çš„å£°æ˜å…¨éƒ¨ç»“æŸï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„æƒ³è±¡åˆ›å»ºä½ æƒ³è¦çš„ç¼–è¾‘å™¨ï¼</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'HTML5','Canvas','ç®€æ˜“'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>