<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Qt编写地图综合应用10-点聚合 | 极客快訊</title><meta property="og:title" content="Qt编写地图综合应用10-点聚合 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/785649a9882e437fbc45505d4d9d70f0"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/164bbc4c.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/164bbc4c.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/164bbc4c.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/164bbc4c.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/164bbc4c.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/164bbc4c.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/164bbc4c.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/164bbc4c.html><meta property="article:published_time" content="2020-10-29T21:10:09+08:00"><meta property="article:modified_time" content="2020-10-29T21:10:09+08:00"><meta name=Keywords content><meta name=description content="Qt编写地图综合应用10-点聚合"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/164bbc4c.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Qt编写地图综合应用10-点聚合</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>## 一、前言</h1><p>点聚合在地图相关应用中比较常用，比如在地图上查询结果通常以标记点的形式展现，但是如果标记点较多，不仅会大大增加客户端的渲染时间，让客户端变得很卡，而且会让人产生密集恐惧症，密密麻麻的一大堆点挤在一起。为了解决这一问题，我们需要一种手段能在用户有限的可视区域范围内，利用最小的区域展示出最全面的信息，而又不产生重叠覆盖，这个东西专业名词就叫点聚合，百度地图内置了方法可以设置点聚合BMapLib.MarkerClusterer，注意这个方法在BMapLib中而不是在BMAP中，所以要使用点聚合的话需要引入这个MarkerClusterer_min.js类文件，不然是没用的，这个很容易忽视，因为绝大部分类和方法都是在BMap中都有。</p><h1 class=pgc-h-arrow-right>## 二、功能特点</h1><p>1. 同时支持在线地图和离线地图两种模式。</p><p>2. 同时支持webkit内核、webengine内核、IE内核。</p><p>3. 支持设置多个标注点，信息包括名称、地址、经纬度。</p><p>4. 可设置地图是否可单击、拖动、鼠标滚轮缩放。</p><p>5. 可设置协议版本、秘钥、主题样式、中心座标、中心城市、地理编码位置等。</p><p>6. 可设置地图缩放比例和级别，缩略图、比例尺、路况信息等控件的可见。</p><p>7. 支持地图交互，比如鼠标按下获取对应位置的经纬度。</p><p>8. 支持查询路线，可设置起点位置、终点位置、路线模式、路线方式、路线方案（最少时间、最少换乘、最少步行、不乘地铁、最短距离、避开高速）。</p><p>9. 可显示点线面工具，可直接在地图上划线、点、矩形、圆形等。</p><p>10. 可设置行政区划，指定某个城市区域绘制图层，在线地图自动输出行政区划边界点集合到js文件给离线地图使用。</p><p>11. 可静态或者动态添加多个覆盖物。支持点、折线、多边形、矩形、圆形、弧线、点聚合等。</p><p>12. 函数接口友好和统一，使用简单方便，就一个类。</p><p>13. 支持js动态交互添加点、删除点、清空点、重置点，不需要刷新页面。</p><p>14. 支持任意Qt版本、任意系统、任意编译器。</p><h1 class=pgc-h-arrow-right>## 三、体验地址</h1><p>国内站点：[https://gitee.com/feiyangqingyun](https://gitee.com/feiyangqingyun)</p><p>国际站点：[https://github.com/feiyangqingyun](https://github.com/feiyangqingyun)</p><h1 class=pgc-h-arrow-right>## 四、效果图</h1><p><br></p><div class=pgc-img><img alt=Qt编写地图综合应用10-点聚合 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/785649a9882e437fbc45505d4d9d70f0><p class=pgc-img-caption></p></div><p><br></p><h1 class=pgc-h-arrow-right>## 五、相关代码</h1><pre><code>void MapBaiDu::getMarkers(QStringList &amp;list){    //通用多个点座标转换成 BMap.Marker 对象    //座标格式 121.414,31.1828|121.414,31.1838|121.416,31.1838    list &lt;&lt; QString("  function getMarkers(points) {");    list &lt;&lt; QString("    var markers = []");    list &lt;&lt; QString("    var listPoint = points.split(\"|\");");    list &lt;&lt; QString("    var len = listPoint.length");    list &lt;&lt; QString("    for (var i = 0; i &lt; len; i++) {");    list &lt;&lt; QString("      var list = listPoint[i].split(\",\");");    list &lt;&lt; QString("      var pot = new BMap.Point(list[0], list[1]);");    list &lt;&lt; QString("      var marker = new BMap.Marker(pot);");    list &lt;&lt; QString("      markers.push(marker);");    list &lt;&lt; QString("    }");    list &lt;&lt; QString("    return markers;");    list &lt;&lt; QString("  }");}void MapBaiDu::addMarkerClusterer(QStringList &amp;list){    list &lt;&lt; QString("  function addMarkerClusterer(points) {");    list &lt;&lt; QString("    var markers = getMarkers(points);");    //最简单的用法,生成一个marker数组,然后调用markerClusterer类即可    list &lt;&lt; QString("    var markerClusterer = new BMapLib.MarkerClusterer(map, {markers:markers});");    list &lt;&lt; QString("  }");}</code></pre></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Qt','编写','地图'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>