<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>技术趣讲 | 60 分钟搞懂「正则表达式」 | 极客快訊</title><meta property="og:title" content="技术趣讲 | 60 分钟搞懂「正则表达式」 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/eaee8d2e512c44168627b8f244fb5e43"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/187187bc.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/187187bc.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/187187bc.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/187187bc.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/187187bc.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/187187bc.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/187187bc.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/187187bc.html><meta property="article:published_time" content="2020-11-14T21:07:13+08:00"><meta property="article:modified_time" content="2020-11-14T21:07:13+08:00"><meta name=Keywords content><meta name=description content="技术趣讲 | 60 分钟搞懂「正则表达式」"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/187187bc.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>技术趣讲 | 60 分钟搞懂「正则表达式」</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><br></p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/eaee8d2e512c44168627b8f244fb5e43><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>第一回 初来乍到</h1><p>NPC: "欢迎来到正则表达式的国度，勇士！这里的每一个人都使用正则表达式，我是这里的 NPC，每一个来到这里的人都将由我代为介绍正则世界的规则，至于能领悟到何种境界，就看你的造化了。祝你好运，勇士！"</p><p>你："啊，好的，正则表达式......有点奇怪的名字，它是什么呢？"</p><p>NPC："什么？你还没有听过正则表达式，真是一个莽撞的小伙子。看来你也和外面世界的人一样，每次只有用到<strong>字符串匹配</strong> 时，才会通过「谷鸽」来我们的国度寻找答案。一群知其然不知其所以然的家伙。"</p><p>说着，NPC 身前浮现出几个鎏金大字：</p><blockquote><p>正则表达式：用来匹配一系列符合某个规则的字符串的表达式。</p></blockquote><p>"正则的意思是正规、规则。正则表达式的英文名是 Regular Expression，可以直译为描述某种规则的表达式，一般缩写为 regex" ，NPC 缓缓说道。</p><p><br></p><h1 class=pgc-h-arrow-right>第二回 牛刀小试</h1><p>NPC："我先来考考你吧：你如何判断一个字符串是不是有效的电话号码？这可是一个非常常见的需求。"</p><p>你："没问题，我以前确实写过一份类似的代码。首先判断字符串是否是 11 位，再判断每一位是否都是数字就可以了。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/91d32378baff47f88469dde9a1021b1a><p class=pgc-img-caption></p></div><p>NPC："好了好了，快把你这份代码藏好，这份代码放到我们正则的国度是会被笑掉大牙的。看看我们国度的人是怎么实现这份需求的吧！"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4cb12835149c4fd0a3a8d6a4fbfe3a7c><p class=pgc-img-caption></p></div><p>你："啊？如此简洁的实现，正则强者竟恐怖如斯！"</p><p>NPC："这可不是什么强者写的代码，充其量算是牛刀小试罢了。"</p><p><br></p><h1 class=pgc-h-arrow-right>第三回 初窥门径</h1><p>NPC："我先给你讲讲正则表达式的精确匹配。一个普通的字符串，比如 abc，它如果用来做正则表达式匹配的话，只能匹配自己。也就是说它只能匹配字符串 abc，不能匹配 ab，Abc 等其他任何字符串。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/18015481e24b4c2e85fab307924fa9fe><p class=pgc-img-caption></p></div><p>你："这好像没什么用，需要精确匹配的话，我们可以用 String.equals()函数，不需要用正则吧？"</p><p>NPC："没错，正则表达式的精确匹配很少用到。我只是在给你介绍正则表达式的一条基本规则而已。"</p><p>NPC："如果需要匹配的字符串含有特殊字符，那就需要用 \转义。比如 a&b，在用正则表达式匹配时，需要使用 a\&b，又由于在 Java 字符串中，\ 也是特殊字符，它也需要转义，所以 a\&b 对应的 Java 字符串是 a\\&b，它是用来匹配 a&b 的。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/079cfd08b7714be2aa8717c1fff304a0><p class=pgc-img-caption></p></div><p>你："这么说来，这两个反斜杠的意义竟然还不一样：<strong>一个是正则的转义，一个是 Java 字符串的转义</strong>。那么我们之前那个匹配电话号码的例子里面， \\d的本意也是 \d吗？"</p><p>NPC："不错不错，算你还有点悟性。\d在正则表达式中表示匹配任意数字，d 是 digital 的简写。比如 00\d就可以匹配 000， 007，008等等。"</p><p>你："那么，00\d可以匹配 0066吗？"</p><p>NPC："不能，\d只能匹配单个数字。"</p><p>你："那我要怎么才能匹配多个数字呢？"</p><p>NPC："你可以写多次，比如 \d\d就能匹配两个数字，\d\d\d能匹配三个数字，需要匹配几个数字就写几次就行了。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/8b5f4e3667304cf9bd64a18496ca6ced><p class=pgc-img-caption></p></div><p>你："那我如果要匹配 10000 个数字呢？总不能写一万次吧？"</p><p>NPC："那就像我们刚才匹配电话号码的例子一样，在 \d 后面打上花括号 {}，{n} 表示匹配 n 次。\d{10000} 就表示匹配 10000 个数字。"</p><p>你："原来如此，现在我能完全看懂刚才写的匹配电话号码的例子了！"</p><p>NPC："趁热打铁，如果要匹配 n ~ m 次，用 {n,m}即可，如果要匹配至少 n次，用 {n,}即可。需要注意，后不能有空格。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/6004152a6cfd4b38af89785f85abd01b><p class=pgc-img-caption></p></div><p>"按照这个写法，如果要匹配最多 m次，是不是用 {,m}？ "你若有所思。<br>NPC："刚夸了你有点悟性又被你蠢哭了，最多 m 次需要这么写吗？直接用 {0,m}不就行了吗？只是因为正无穷不好表示我们才用的 {n,}，在正则国度根本没有 {,m}这样的写法。 "</p><p>你："啊，原来如此，我想多了。"</p><p><br></p><h1 class=pgc-h-arrow-right>第四回 小有所成</h1><p>NPC："正则的基础规则中，除了 \d，还有 \w和\s，w 是 word 的简写，表示匹配一个常用字符，包括字母、数字、下划线。s 是 space 的简写，表示匹配一个空格，包括三种：</p><ul class=ul-list><li>空格键打出来的空格</li><li>Tab 键打出来的空格</li><li>回车键打出来的空格"</li></ul><p>你："Tab 键打出来的空格和回车键打出来的空格？是指 \t和 \n吗？"</p><p>NPC："完全正确。"</p><p>你："我明白了，我来测试一下。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4502d9be92534b53a35a74e7a3cd5045><p class=pgc-img-caption></p></div><p>NPC："非常棒，我的勇士！希望这三个基本规则还不至于让你记昏了头。不过请放心，没有其他字母需要记忆了，只有这三个而已。"</p><p><br></p><h1 class=pgc-h-arrow-right>第五回 更进一步</h1><p>NPC："记住上面三个规则之后，你还可以顺带获得几个新的规则。因为正则国度规定：<strong>将字母换成大写，就表示相反的意思</strong>。用 \d你可以匹配一个数字，\D则表示匹配一个非数字。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/42c52d8f73b24cc5a1a3cdee1b43d529><p class=pgc-img-caption></p></div><p>你："哈，设计者真是太机智了，大大减少了我这种新手的学习成本。"</p><p>NPC："是的，这非常好记。类似地，\W 可以匹配 \w 不能匹配的字符，\S 可以匹配 \s 不能匹配的字符。"</p><p><br></p><h1 class=pgc-h-arrow-right>第六回 渐入佳境</h1><p>NPC："有时候，我们对某些位置的字符没有要求，仅需要占个位置即可。这时候我们就可以用 . 字符。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/84d5683949894bddb29f25da243ccebe><p class=pgc-img-caption></p></div><p>你："那是不是也可以理解为：.可以匹配任意字符。"</p><p>NPC："是的，可以这么理解。还记得之前说的 {n}表示匹配 n次吗？有时候，我们对匹配的次数没有要求，匹配任意次均可，这时，我们就可以用 *字符。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/b968b229a9c34278b8e704dd88d1330d><p class=pgc-img-caption></p></div><p>你："我有疑问，为什么第三个表达式也会输出 true 呢？明明没有出现数字啊？"</p><p>NPC："那意味着出现了 0 次，* 是指 <strong>可以匹配任意次，包括 0 次</strong>。也就是说，* 等价于 {0,}"</p><p>你："我感觉比较常见的需求应该是某个字符至少出现一次吧？"</p><p>NPC："那就可以用 +匹配，+表示 <strong>至少匹配一次</strong>。它等价于 {1,}"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6a6a80d57034471c8788d5162a9588e9><p class=pgc-img-caption></p></div><p>你："哈哈，看来设计者也发现了这个需求更常用。平时 +号比 *号用得多吧"！你感觉自己猜到了语法设计者的想法，洋洋得意地对 NPC 说道。</p><p>"这倒没人统计过"，NPC 白了你一眼，"在我们正则的国度，常常是一个场景一个正则，不存在谁比谁更常用的对比，按照实际场景使用就行了。"</p><p>NPC："还有一种场景，如果某个字符要么匹配 0 次，要么匹配 1 次，我们就可以用 ? 匹配。它等价于 {0,1}"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9ea4e7738bb54aa7af90108834856a3c><p class=pgc-img-caption></p></div><p>你：" .匹配任意字符；*匹配任意次，包括 0 次；+号匹配至少 1 次，?匹配 0 次或 1 次。我记住了！"</p><p><br></p><h1 class=pgc-h-arrow-right>第七回 心浮气躁</h1><p>一下子掌握了这么多的正则匹配规则的你有点飘飘然，于是你对 NPC 说道："我感觉我已经掌握了够多的匹配规则，足以应付所有的字符串匹配场景了！"</p><p>NPC："是的，你已经掌握了足够多的规则，勇士。可先别得意得太早，我再考考你吧。看看匹配电话号码的程序，如果我们规定电话号码不能以 0 开头，应该怎么写正则表达式呢？"</p><p>"不能以 0 开头，那就不能用\d{11}了，这......"，你抓耳挠腮，为难起来。</p><p>这时，调皮的 NPC 学着你刚才的样子，说道："我已经掌握了足够多的匹配规则，足以应付所有的字符串匹配场景了！"</p><p>你："呃，还差一点......快别取笑我了，快告诉我这个要用什么新的规则吧！"</p><p>"年轻人啊，总是心浮气躁"，NPC 摇了摇头，"这样的场景需要用 [] 来匹配，[] 用于匹配指定范围内的字符，比如[123456789] 可以匹配 1~9。"</p><p>你："啊哈，那我就知道怎么写了， 这个问题的正则匹配规则是[123456789]\d{10}。"</p><p>NPC："就是这样。这里还有一个语法糖，[123456789] 写起来太麻烦，可以写作 [1-9]。"</p><p>你："只能用于数字吗？可以用在字母身上吗？"</p><p>NPC："当然可以，比如 [a-g] 表示 [abcdefg]，[U-Z] 表示 [UVWXYZ]。"</p><p>你："但如果既可以是数字 1~9，又可以是字母 a~g，还可以是字母 U~Z，还是得把所有范围列出来。"</p><p>NPC："不必，你还可以这么写：[1-9a-gU-Z]。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f08ec85cf068449fa821a9b93ad0a32f><p class=pgc-img-caption></p></div><p>你："这可真是太方便了！如果是 0~1，8~9 可以这样组合吗？"</p><p>NPC："那样的话，你写 [0189] 不是更简洁吗？"</p><p>你："我想学习（装 X）。"</p><p>NPC："那当然也是可以的，[0-18-9] 正是你想要的。由于正则一次只匹配一个字符，所以这样写并不会有歧义，也就是说计算机不会把这种写法误解成要匹配 0~18 之类的。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/be860d9e2f40473482cac239dc0fff77><p class=pgc-img-caption></p></div><p>NPC："还有一种写法可以实现这一点，那就是用 <strong>或 </strong>运算符，正则的 <strong>或 </strong>运算符是 |，[0189]也可以写作 0|1|8|9。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/68d66806f8474ef58a930d56dcc4e883><p class=pgc-img-caption></p></div><p>你："所以说范围就是 <strong>或 </strong>的简写，对吗？"</p><p>NPC："不对，<strong>或</strong> 可以实现更多的功能，它并不局限於单个字符。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/84568cdab099499e9c63ddddc7d3ba54><p class=pgc-img-caption></p></div><p>你："如果我想排除某些字符呢？比如这个位置不能是 [123]。我记得你之前说正则王国以大写表示取反，[]要怎么大写呢？"</p><p>NPC："[]可没有大写之说，[]取反的方式是：[^]，比如不能是 [123]的表示方法为 [^123]或者 [^1-3]"</p><p>你："原来如此，我懂了。现在还有什么规则我没有学到的吗？"</p><p>NPC："新手教程到这里就结束了，这已经足够你应付许多应用场景了。但我这还有两本高手秘籍，你想不想学呢？"</p><p>你："高手秘籍！听着都让人激动啊，快讲讲！"</p><p><br></p><h1 class=pgc-h-arrow-right>第八回 探囊取物</h1><p>NPC："这第一本秘籍的名字叫 探囊取物。考虑一个实际需求，有许许多多以下格式的字符串，你需要用正则表达式匹配出其姓名和年龄。</p><ul class=ul-list><li>Name:Aurora Age:18</li><li>其中还夹杂着一些无关紧要的数据</li><li>Name:Bob Age:20</li><li>错误的数据有着各种各样错误的格式</li><li>Name:Cassin Age:22</li><li>..."</li></ul><p>你："没问题，这已经难不倒我了。让我想想......观察字符串的规则，只需要用 Name:\w+\s*Age:\d{1,3} 就能匹配了。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/bcbf65371e1a44258ed564d6ee8957ec><p class=pgc-img-caption></p></div><p>NPC："很好！一般来说，下一步你要做的就是取出这些表达式中的姓名和年龄，以便把它们存到数据库中。"</p><p>你："那我可以用 indexOf 和 subString 函数来取这些值。 "</p><p>NPC："的确可行，但你现在不需要那个蠢办法了，我的勇士。你已经掌握了正则的力量，在我们正则国度有更简洁的取值方式。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f11728b21cfe4d96b6671ec244efd63d><p class=pgc-img-caption></p></div><p>NPC："看吧，只要用 ()将需要取值的地方括起来，传给 Pattern 对象，再用 Pattern 对象匹配后获得的 Matcher 对象来取值就行了。每个匹配的值将会按照顺序保存在 Matcher 对象的 group 中。"</p><p>NPC："你可以看到我用 ()把 \\w+和 \\d{1,3}分别括起来了，判断 Pattern 对象与字符串是否匹配的方法是 Matcher.matches()，如果匹配成功，这个函数将返回 true，如果匹配失败，则返回 false。"</p><p>你："这里是不是写错了，为什么 group 是从下标 1 开始取值的，计算机不都从 0 开始数吗？"</p><p>NPC："并没有写错，这是因为 group(0) 被用来保存整个匹配的字符串了。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f2cdef98ec9443cd9892949d3ebac7dd><p class=pgc-img-caption></p></div><p>你："原来是这样，分组可真是太方便了。但我们之前都是用的 String.matches方法来匹配的正则表达式，这里用的 Pattern 又是什么呢？"</p><p>NPC："想知道这个问题的答案的话，我们不妨来看一下 String.matches方法的源码。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/09a9ff6dfddb48f894e4b6660473de73><p class=pgc-img-caption></p></div><p>"源码中调用了 Pattern.matches方法，我们再跟进去。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8adda965d4464e909c6fac741f129244><p class=pgc-img-caption></p></div><p>你："啊，我明白了！原来 Pattern 并不是什么新鲜东西，String.matches内部就是调用的 Pattern，两种写法的原理是一模一样的！"</p><p>NPC："没错，并且阅读源码之后，你可以发现，每次调用 String.matches函数，都会新建出一个 Pattern 对象。所以如果要用同一个正则表达式多次匹配字符串的话，最佳的做法不是直接调用 String.matches方法，而应该先用正则表达式新建一个 Pattern 对象，然后反复使用，以提高程序运行效率。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f601f04033e14ed99d7712e870cdf7d3><p class=pgc-img-caption></p></div><p><br></p><h1 class=pgc-h-arrow-right>第九回 移花接木</h1><p>NPC："我这第二本秘籍名为 移花接木。再考虑一个实际场景：你有一个让用户输入标签的输入框，用户可以输入多个标签。可是你并没有提示用户，标签之前用什么间隔符号隔开。"</p><p>你："你还别说，我之前真遇到过这个问题。结果用户的输入五花八门，有用逗号的，有用分号的，有用空格的，还有用制表符的......"</p><ul class=ul-list><li>二分，回溯，递归，分治</li><li>搜索；查找；旋转；遍历</li><li>数论 图论 逻辑 概率</li></ul><p>NPC："那你是怎么解决的呢？"</p><p>你："用 String.split 函数呗，这个函数我已经用得很熟练了。将各种分隔符号依次传入尝试，最后总算是解决了。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5fc1c101318d4b62893f03631116fa4e><p class=pgc-img-caption></p></div><p>输出为：</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/91436cc00d3a4dfea38b2ffe23c48fa8><p class=pgc-img-caption></p></div><p>这时，你看到 NPC 露出了心痛的表情："暴殄天物啊！你这种行为就好比拿着精心打磨的钻石当电钻头，这样的代码在我们正则王国是会遭人唾骂的。"</p><p>你："String.split 函数不就是用来分割字符串的吗？"</p><p>NPC："当然是，但 split 函数可不是你这样用的，不知你是否看过 split 函数的源码，这个函数传入的参数实际上是一个正则表达式。"</p><p>你："啊？但我之前没写过正则表达式，分割出来也没出错啊！"</p><p>NPC："当然，你忘了我最开始给你讲的了吗？你直接使用字符串，在正则王国属于精确匹配，只能匹配你写死的那个字符串。"</p><p>你："原来如此。那么我应该怎么做呢？"</p><p>NPC："当然是用正则表达式模糊匹配，只要能匹配成功，就以其分割。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a92f1abd7ded4d97ac6b99d874dcd3d0><p class=pgc-img-caption></p></div><p>输出为：</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/7ad73ff8b0004222bc4554d44922ecfa><p class=pgc-img-caption></p></div><p>你："原来 split 函数这么强大，我以后不会犯这种错误了！"</p><p>NPC："字符串中，可不止这一个函数是传入的正则表达式，你还记得替换所有匹配字符串用的什么函数吗？"</p><p>你："用的是 replaceAll 函数，这个函数不会也是传的正则表达式吧！"</p><p>NPC："正是这样，所以我们可以用正则表达式模糊匹配，将符合规则的字符串全部替换掉。比如就现在这个例子，我们可以把用户输入的所有数据统一规范为使用 ; 分隔，那我们就可以这样写。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e6db6bf3144b4777ba2b837d4ec196b4><p class=pgc-img-caption></p></div><p>输出为：</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7e17098e77404cdda0748839ba87dcea><p class=pgc-img-caption></p></div><p>你："果然是 移花接木，模糊匹配比精确匹配效率高多了！"</p><p>NPC："还不止这一点，在 replaceAll 的第二个参数中，我们可以通过 $1，$2，...来反向引用匹配到的子串。只要将需要引用的部分用 ()括起来就可以了。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/44b5669add57424d9b7eed5fe8a624d8><p class=pgc-img-caption></p></div><p>输出为：</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c76ec7970dea4cc3b525bf48ff77ddca><p class=pgc-img-caption></p></div><p>你："哈，有时候我们不需要替换，只需要将正则匹配出来的部分添加一些前缀或后缀，就可以用这种方式！"</p><p>NPC："完全正确。"</p><p><br></p><h1 class=pgc-h-arrow-right>第十回 蓦然回首</h1><p>NPC："恭喜你学完了所有的正则教程，现在你知道正则表达式是什么了吧。"</p><p>你："没错，以前总感觉正则表达式晦涩难懂，每次用到时就去网上搜索答案，现在看来也不过如此。"</p><p>NPC："说 不过如此 倒是有些托大了，虽然我给你介绍了正则表达式的基本规则，但正则表达式里面还有不少的学问可以去挖掘的。每种技术都有一个熟能生巧的过程。"</p><p>你："什么？还有学问？我感觉我已经学完了啊！还有什么学问，一并给我讲了吧！"</p><p>NPC："那你看这样一道题：给你一些字符串，统计其末尾 e 的个数：</p><ul class=ul-list><li>LeetCode</li><li>LeetCodeeee</li><li>LeetCodeee"</li></ul><p>你："看起来并不难，用 (\w+)(e*) 匹配，再取 group(2) 判断即可。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ef100434f71444cb87b9dee55d5d1525><p class=pgc-img-caption></p></div><p>NPC："你运行一下试试看。"</p><p>输出如下：</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/54418a563d93460cae81974c4d186d30><p class=pgc-img-caption></p></div><p>你："怎么会这样？我期望的结果是 group1 等于 LeetCod，group2 等于 e 才对啊！"</p><p>NPC："这是因为 e 仍然属于 \w 能匹配的范畴，正则表达式默认会尽可能多地向后匹配，我们王国将其称之为 贪婪匹配。"</p><p>你："贪婪匹配，听起来和贪心算法有异曲同工之妙。"</p><p>NPC："没错，贪婪匹配和贪心算法原理是一致的。与之对应的匹配方式叫做 非贪婪匹配，非贪婪匹配 会在能匹配目标字符串的前提下，尽可能少的向后匹配。"</p><p>你："那么，我要怎样指定匹配方式为非贪婪匹配呢？"</p><p>NPC："也很简单，在需要非贪婪匹配的正则表达式后面加个 ? 即可表示非贪婪匹配。"</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c85cd6e1c3af4c1da0a1d8d67003598d><p class=pgc-img-caption></p></div><p>运行程序，输出如下：</p><div class=pgc-img><img alt="技术趣讲 | 60 分钟搞懂「正则表达式」" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9c3680a45c0e4052a75b6e611d58b740><p class=pgc-img-caption></p></div><p>你："这里也用的是 ?，我记得之前 ?表示的是匹配 0 次或者 1 次，两个符号不会混淆吗？"</p><p>NPC："不会混淆的，你仔细想一想就能明白了，如果只有一个字符，那就不存在贪婪不贪婪的问题，如果匹配多次，那么表示非贪婪匹配的 ?前面必有一个标志匹配次数的符号。所以不会出现混淆。"</p><p>你："最后一个问题，为什么这里没有匹配成 group1 等于 L，group2 等于 ee...... 哦我明白了，如果这样匹配的话，字符串 LeetCode就无法和正则表达式匹配起来。怪不得非贪婪匹配的定义是 在能匹配目标字符串的前提下，尽可能少的向后匹配。"</p><p>NPC："就是这个原理，看来你是真的完全明白了。"</p><p><br></p><h1 class=pgc-h-arrow-right>第十一回 最终考验</h1><p>NPC："天下没有不散的宴席，是时候说再见了。虽然我能教你的，或是说想与你探讨的，还不止这些内容，但授人以鱼不如授人以渔，以后遇到正则相关的问题，还是要靠你自己动脑思考。"</p><p>你："这么快就要告别了吗？不知道为什么，竟然还有点舍不得......"</p><p>NPC："我最后再出一道题考考你，你就可以从正则王国顺利毕业了。来看下你的题目吧：我们王国有一个人口吃，请你帮忙矫正他。他今天说：肚...子。。好饿........，....早知道.....当.....初...。。。多.....刷.....点。。。力.....扣了.........！"</p><p>你："ez，只需要用 str.replaceAll(<strong>__, __</strong>) 就可以解决了！"</p><p><br></p><h1 class=pgc-h-arrow-right>互动话题：</h1><p>嘿，说你呢！在留言区写下你的答案吧！</p><p><br></p><p>本文作者：Alpinist Wang</p><p>声明：本文归 “力扣” 版权所有，如需转载请联系。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'搞懂','技术','趣讲'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>