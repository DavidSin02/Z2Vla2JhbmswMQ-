<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>åŸºäºCanalå’ŒKafkaå®ç°MySQLçš„Binlogè¿‘å®æ—¶åŒæ­¥ | æå®¢å¿«è¨Š</title><meta property="og:title" content="åŸºäºCanalå’ŒKafkaå®ç°MySQLçš„Binlogè¿‘å®æ—¶åŒæ­¥ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/dafc2ca594c643728ee9361b349265ae"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/20559cc7.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/20559cc7.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/20559cc7.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/20559cc7.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/20559cc7.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/20559cc7.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/20559cc7.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/20559cc7.html><meta property="article:published_time" content="2020-11-14T21:00:58+08:00"><meta property="article:modified_time" content="2020-11-14T21:00:58+08:00"><meta name=Keywords content><meta name=description content="åŸºäºCanalå’ŒKafkaå®ç°MySQLçš„Binlogè¿‘å®æ—¶åŒæ­¥"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/20559cc7.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>åŸºäºCanalå’ŒKafkaå®ç°MySQLçš„Binlogè¿‘å®æ—¶åŒæ­¥</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p>ä½œè€…ï¼šThrowable</p><h2 class=heading>å‰æ</h2><p>è¿‘æ®µæ—¶é—´ï¼Œä¸šåŠ¡ç³»ç»Ÿæ¶æ„åŸºæœ¬å®Œå¤‡ï¼Œæ•°æ®å±‚é¢çš„å»ºè®¾æ¯”è¾ƒè–„å¼±ï¼Œå› ä¸ºç¬”è€…ç›®å‰å·¥ä½œé‡å¿ƒåœ¨äºæ­å»ºä¸€ä¸ªå°å‹çš„æ•°æ®å¹³å°ã€‚ä¼˜å…ˆçº§æ¯”è¾ƒé«˜çš„ä¸€ä¸ªä»»åŠ¡å°±æ˜¯éœ€è¦è¿‘å®æ—¶åŒæ­¥ä¸šåŠ¡ç³»ç»Ÿçš„æ•°æ®ï¼ˆåŒ…æ‹¬ä¿å­˜ã€æ›´æ–°æˆ–è€…è½¯åˆ é™¤ï¼‰åˆ°ä¸€ä¸ªå¦ä¸€ä¸ªæ•°æ®æºï¼ŒæŒä¹…åŒ–ä¹‹å‰éœ€è¦æ¸…æ´—æ•°æ®å¹¶ä¸”æ„å»ºä¸€ä¸ªç›¸å¯¹åˆç†çš„ä¾¿äºåç»­ä¸šåŠ¡æ•°æ®ç»Ÿè®¡ã€æ ‡ç­¾ç³»ç»Ÿæ„å»ºç­‰æ‰©å±•åŠŸèƒ½çš„æ•°æ®æ¨¡å‹ã€‚åŸºäºå½“å‰å›¢é˜Ÿçš„èµ„æºå’Œèƒ½åŠ›ï¼Œä¼˜å…ˆè°ƒç ”äº†Alibabaå¼€æºä¸­é—´ä»¶Canalçš„ä½¿ç”¨ã€‚</p><p><br></p><div class=pgc-img><img alt=åŸºäºCanalå’ŒKafkaå®ç°MySQLçš„Binlogè¿‘å®æ—¶åŒæ­¥ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dafc2ca594c643728ee9361b349265ae><p class=pgc-img-caption></p></div><p><br></p><p>è¿™ç¯‡æ–‡ç« ç®€å•ä»‹ç»ä¸€ä¸‹å¦‚ä½•å¿«é€Ÿåœ°æ­å»ºä¸€å¥—Canalç›¸å…³çš„ç»„ä»¶ã€‚</p><h2 class=heading>å…³äºCanal</h2><h3 class=heading>ç®€ä»‹</h3><p>ä¸‹é¢çš„ç®€ä»‹å’Œä¸‹ä¸€èŠ‚çš„åŸç†å‡æ¥è‡ªäºCanalé¡¹ç›®çš„READMEï¼š</p><div class=pgc-img><img alt=åŸºäºCanalå’ŒKafkaå®ç°MySQLçš„Binlogè¿‘å®æ—¶åŒæ­¥ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/969b5fe5dfc14744870ccae0a9e78c58><p class=pgc-img-caption></p></div><p>Canal[kÉ™'nÃ¦l]ï¼Œè¯‘æ„ä¸ºæ°´é“/ç®¡é“/æ²Ÿæ¸ ï¼Œä¸»è¦ç”¨é€”æ˜¯åŸºäºMySQLæ•°æ®åº“å¢é‡æ—¥å¿—è§£æï¼Œæä¾›å¢é‡æ•°æ®è®¢é˜…å’Œæ¶ˆè´¹ã€‚æ—©æœŸé˜¿é‡Œå·´å·´å› ä¸ºæ­å·å’Œç¾å›½åŒæœºæˆ¿éƒ¨ç½²ï¼Œå­˜åœ¨è·¨æœºæˆ¿åŒæ­¥çš„ä¸šåŠ¡éœ€æ±‚ï¼Œå®ç°æ–¹å¼ä¸»è¦æ˜¯åŸºäºä¸šåŠ¡triggerè·å–å¢é‡å˜æ›´ã€‚ä» 2010 å¹´å¼€å§‹ï¼Œä¸šåŠ¡é€æ­¥å°è¯•æ•°æ®åº“æ—¥å¿—è§£æè·å–å¢é‡å˜æ›´è¿›è¡ŒåŒæ­¥ï¼Œç”±æ­¤è¡ç”Ÿå‡ºäº†å¤§é‡çš„æ•°æ®åº“å¢é‡è®¢é˜…å’Œæ¶ˆè´¹ä¸šåŠ¡ã€‚</p><p>åŸºäºæ—¥å¿—å¢é‡è®¢é˜…å’Œæ¶ˆè´¹çš„ä¸šåŠ¡åŒ…æ‹¬ï¼š</p><ul><li>æ•°æ®åº“é•œåƒ</li><li>æ•°æ®åº“å®æ—¶å¤‡ä»½</li><li>ç´¢å¼•æ„å»ºå’Œå®æ—¶ç»´æŠ¤ï¼ˆæ‹†åˆ†å¼‚æ„ç´¢å¼•ã€å€’æ’ç´¢å¼•ç­‰ï¼‰</li><li>ä¸šåŠ¡Cacheåˆ·æ–°</li><li>å¸¦ä¸šåŠ¡é€»è¾‘çš„å¢é‡æ•°æ®å¤„ç†</li></ul><h3 class=heading>Canalçš„å·¥ä½œåŸç†</h3><p>MySQLä¸»å¤‡å¤åˆ¶åŸç†ï¼š</p><p><br></p><div class=pgc-img><img alt=åŸºäºCanalå’ŒKafkaå®ç°MySQLçš„Binlogè¿‘å®æ—¶åŒæ­¥ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4de3b09b89e74cb789e4b02070568158><p class=pgc-img-caption></p></div><p><br></p><ul><li>MySQLçš„Masterå®ä¾‹å°†æ•°æ®å˜æ›´å†™å…¥äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆbinary logï¼Œå…¶ä¸­è®°å½•å«åšäºŒè¿›åˆ¶æ—¥å¿—äº‹ä»¶binary log eventsï¼Œå¯ä»¥é€šè¿‡show binlog eventsè¿›è¡ŒæŸ¥çœ‹ï¼‰</li><li>MySQLçš„Slaveå®ä¾‹å°†masterçš„binary log eventsæ‹·è´åˆ°å®ƒçš„ä¸­ç»§æ—¥å¿—ï¼ˆrelay logï¼‰</li><li>MySQLçš„Slaveå®ä¾‹é‡æ”¾relay logä¸­çš„äº‹ä»¶ï¼Œå°†æ•°æ®å˜æ›´åæ˜ å®ƒåˆ°è‡ªèº«çš„æ•°æ®</li></ul><p>Canalçš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š</p><ul><li>Canalæ¨¡æ‹ŸMySQL Slaveçš„äº¤äº’åè®®ï¼Œä¼ªè£…è‡ªå·±ä¸ºMySQL Slaveï¼Œå‘MySQL Masterå‘é€dumpåè®®</li><li>MySQL Masteræ”¶åˆ°dumpè¯·æ±‚ï¼Œå¼€å§‹æ¨é€binary logç»™Slaveï¼ˆå³Canalï¼‰</li><li>Canalè§£æbinary logå¯¹è±¡ï¼ˆåŸå§‹ä¸ºbyteæµï¼‰ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡è¿æ¥å™¨å‘é€åˆ°å¯¹åº”çš„æ¶ˆæ¯é˜Ÿåˆ—ç­‰ä¸­é—´ä»¶ä¸­</li></ul><h3 class=heading>å…³äºCanalçš„ç‰ˆæœ¬å’Œéƒ¨ä»¶</h3><p>æˆªæ­¢ç¬”è€…å¼€å§‹ç¼–å†™æœ¬æ–‡çš„æ—¶å€™ï¼ˆ2020-03-05ï¼‰ï¼ŒCanalçš„æœ€æ–°å‘å¸ƒç‰ˆæœ¬æ˜¯v1.1.5-alpha-1ï¼ˆ2019-10-09å‘å¸ƒçš„ï¼‰ï¼Œæœ€æ–°çš„æ­£å¼ç‰ˆæ˜¯v1.1.4ï¼ˆ2019-09-02å‘å¸ƒçš„ï¼‰ã€‚å…¶ä¸­ï¼Œv1.1.4ä¸»è¦æ·»åŠ äº†é‰´æƒã€ç›‘æ§çš„åŠŸèƒ½ï¼Œå¹¶ä¸”åšäº†ä¸€äº›åˆ—çš„æ€§èƒ½ä¼˜åŒ–ï¼Œæ­¤ç‰ˆæœ¬é›†æˆçš„è¿æ¥å™¨æ˜¯Tcpã€Kafkaå’ŒRockerMQã€‚è€Œv1.1.5-alpha-1ç‰ˆæœ¬å·²ç»æ–°å¢äº†RabbitMQè¿æ¥å™¨ï¼Œä½†æ˜¯æ­¤ç‰ˆæœ¬çš„RabbitMQè¿æ¥å™¨æš‚æ—¶ä¸èƒ½å®šä¹‰è¿æ¥RabbitMQçš„ç«¯å£å·ï¼Œä¸è¿‡æ­¤é—®é¢˜å·²ç»åœ¨masteråˆ†æ”¯ä¸­ä¿®å¤ï¼ˆå…·ä½“å¯ä»¥å‚çœ‹æºç ä¸­çš„CanalRabbitMQProducerç±»çš„æäº¤è®°å½•ï¼‰ã€‚æ¢è¨€ä¹‹ï¼Œv1.1.4ç‰ˆæœ¬ä¸­ç›®å‰èƒ½ä½¿ç”¨çš„å†…ç½®è¿æ¥å™¨åªæœ‰Tcpã€Kafkaå’ŒRockerMQä¸‰ç§ï¼Œå¦‚æœæƒ³å°é²œä½¿ç”¨RabbitMQè¿æ¥å™¨ï¼Œå¯ä»¥é€‰ç”¨ä¸‹é¢çš„ä¸¤ç§æ–¹å¼ä¹‹ä¸€ï¼š</p><ul><li>é€‰ç”¨v1.1.5-alpha-1ç‰ˆæœ¬ï¼Œä½†æ˜¯æ— æ³•ä¿®æ”¹RabbitMQçš„portå±æ€§ï¼Œé»˜è®¤ä¸º5672ã€‚</li><li>åŸºäºmasteråˆ†æ”¯è‡ªè¡Œæ„å»ºCanalã€‚</li></ul><p>ç›®å‰ï¼ŒCanalé¡¹ç›®çš„æ´»è·ƒåº¦æ¯”è¾ƒé«˜ï¼Œä½†æ˜¯è€ƒè™‘åˆ°åŠŸèƒ½çš„ç¨³å®šæ€§é—®é¢˜ï¼Œç¬”è€…å»ºè®®é€‰ç”¨ç¨³å®šç‰ˆæœ¬åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å®æ–½ï¼Œå½“å‰å¯ä»¥é€‰ç”¨v1.1.4ç‰ˆæœ¬ï¼Œ<strong>æœ¬æ–‡çš„ä¾‹å­ç”¨é€‰ç”¨çš„å°±æ˜¯v1.1.4ç‰ˆæœ¬ï¼Œé…åˆKafkaè¿æ¥å™¨ä½¿ç”¨</strong>ã€‚Canalä¸»è¦åŒ…æ‹¬ä¸‰ä¸ªæ ¸å¿ƒéƒ¨ä»¶ï¼š</p><ul><li>canal-adminï¼šåå°ç®¡ç†æ¨¡å—ï¼Œæä¾›é¢å‘WebUIçš„Canalç®¡ç†èƒ½åŠ›ã€‚</li><li>canal-adapterï¼šé€‚é…å™¨ï¼Œå¢åŠ å®¢æˆ·ç«¯æ•°æ®è½åœ°çš„é€‚é…åŠå¯åŠ¨åŠŸèƒ½ï¼ŒåŒ…æ‹¬RESTã€æ—¥å¿—é€‚é…å™¨ã€å…³ç³»å‹æ•°æ®åº“çš„æ•°æ®åŒæ­¥ï¼ˆè¡¨å¯¹è¡¨åŒæ­¥ï¼‰ã€HBaseæ•°æ®åŒæ­¥ã€ESæ•°æ®åŒæ­¥ç­‰ç­‰ã€‚</li><li>canal-deployerï¼šå‘å¸ƒå™¨ï¼Œæ ¸å¿ƒåŠŸèƒ½æ‰€åœ¨ï¼ŒåŒ…æ‹¬binlogè§£æã€è½¬æ¢å’Œå‘é€æŠ¥æ–‡åˆ°è¿æ¥å™¨ä¸­ç­‰ç­‰åŠŸèƒ½éƒ½ç”±æ­¤æ¨¡å—æä¾›ã€‚</li></ul><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œcanal-deployeréƒ¨ä»¶æ˜¯å¿…é¡»çš„ï¼Œå…¶ä»–ä¸¤ä¸ªéƒ¨ä»¶æŒ‰éœ€é€‰ç”¨å³å¯ã€‚</p><h2 class=heading>éƒ¨ç½²æ‰€éœ€çš„ä¸­é—´ä»¶</h2><p>æ­å»ºä¸€å¥—å¯ä»¥ç”¨çš„ç»„ä»¶éœ€è¦éƒ¨ç½²MySQLã€Zookeeperã€Kafkaå’ŒCanalå››ä¸ªä¸­é—´ä»¶çš„å®ä¾‹ï¼Œä¸‹é¢ç®€å•åˆ†æä¸€ä¸‹éƒ¨ç½²è¿‡ç¨‹ã€‚é€‰ç”¨çš„è™šæ‹Ÿæœºç³»ç»Ÿæ˜¯CentOS7ã€‚</p><h3 class=heading>å®‰è£…MySQL</h3><p>ä¸ºäº†ç®€å•èµ·è§ï¼Œé€‰ç”¨yumæºå®‰è£…ï¼ˆå®˜æ–¹é“¾æ¥æ˜¯https://dev.mysql.com/downloads/repo/yumï¼‰ï¼š</p><p><br></p><div class=pgc-img><img alt=åŸºäºCanalå’ŒKafkaå®ç°MySQLçš„Binlogè¿‘å®æ—¶åŒæ­¥ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/71b780cac0f44cc2923c3c6db7b92944><p class=pgc-img-caption></p></div><p><br></p><p>::: info mysql80-community-release-el7-3è™½ç„¶åŒ…åå¸¦äº†mysql80å…³é”®å­—ï¼Œå…¶å®å·²ç»é›†æˆäº†MySQLä¸»æµç‰ˆæœ¬5.6ã€5.7å’Œ8.xç­‰ç­‰çš„æœ€æ–°å®‰è£…åŒ…ä»“åº“ :::</p><p>é€‰ç”¨çš„æ˜¯æœ€æ–°ç‰ˆçš„MySQL8.xç¤¾åŒºç‰ˆï¼Œä¸‹è½½CentOS7é€‚ç”¨çš„rpmåŒ…ï¼š</p><pre><code>cd /data/mysqlwget https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm// ä¸‹è½½å®Œæ¯•ä¹‹åsudo rpm -Uvh mysql80-community-release-el7-3.noarch.rpm</code></pre><p>æ­¤æ—¶åˆ—ä¸¾ä¸€ä¸‹yumä»“åº“é‡Œé¢çš„MySQLç›¸å…³çš„åŒ…ï¼š</p><pre><code>[root@localhost mysql]# yum repolist all | grep mysqlmysql-cluster-7.5-community/x86_64 MySQL Cluster 7.5 Community   disabledmysql-cluster-7.5-community-source MySQL Cluster 7.5 Community - disabledmysql-cluster-7.6-community/x86_64 MySQL Cluster 7.6 Community   disabledmysql-cluster-7.6-community-source MySQL Cluster 7.6 Community - disabledmysql-cluster-8.0-community/x86_64 MySQL Cluster 8.0 Community   disabledmysql-cluster-8.0-community-source MySQL Cluster 8.0 Community - disabledmysql-connectors-community/x86_64  MySQL Connectors Community    enabled:    141mysql-connectors-community-source  MySQL Connectors Community -  disabledmysql-tools-community/x86_64       MySQL Tools Community         enabled:    105mysql-tools-community-source       MySQL Tools Community - Sourc disabledmysql-tools-preview/x86_64         MySQL Tools Preview           disabledmysql-tools-preview-source         MySQL Tools Preview - Source  disabledmysql55-community/x86_64           MySQL 5.5 Community Server    disabledmysql55-community-source           MySQL 5.5 Community Server -  disabledmysql56-community/x86_64           MySQL 5.6 Community Server    disabledmysql56-community-source           MySQL 5.6 Community Server -  disabledmysql57-community/x86_64           MySQL 5.7 Community Server    disabledmysql57-community-source           MySQL 5.7 Community Server -  disabledmysql80-community/x86_64           MySQL 8.0 Community Server    enabled:    161mysql80-community-source           MySQL 8.0 Community Server -  disabled</code></pre><p>ç¼–è¾‘/etc/yum.repos.d/mysql-community.repoæ–‡ä»¶ï¼ˆ[mysql80-community]å—ä¸­enabledè®¾ç½®ä¸º1ï¼Œå…¶å®é»˜è®¤å°±æ˜¯è¿™æ ·å­ï¼Œä¸ç”¨æ”¹ï¼Œå¦‚æœè¦é€‰ç”¨5.xç‰ˆæœ¬åˆ™éœ€è¦ä¿®æ”¹å¯¹åº”çš„å—ï¼‰ï¼š</p><pre><code>[mysql80-community]name=MySQL 8.0 Community Serverbaseurl=http://repo.mysql.com/yum/mysql-8.0-community/el/7/$basearch/enabled=1gpgcheck=1gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql</code></pre><p>ç„¶åå®‰è£…MySQLæœåŠ¡ï¼š</p><pre><code>sudo yum install mysql-community-server</code></pre><p>è¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒæ¼«é•¿ï¼Œå› ä¸ºéœ€è¦ä¸‹è½½å’Œå®‰è£…5ä¸ªrpmå®‰è£…åŒ…ï¼ˆæˆ–è€…æ˜¯æ‰€æœ‰å®‰è£…åŒ…ç»„åˆçš„å‹ç¼©åŒ…mysql-8.0.18-1.el7.x86_64.rpm-bundle.tarï¼‰ã€‚å¦‚æœç½‘ç»œæ¯”è¾ƒå·®ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä»å®˜ç½‘æ‰‹åŠ¨ä¸‹è½½åå®‰è£…ï¼š</p><p><br></p><div class=pgc-img><img alt=åŸºäºCanalå’ŒKafkaå®ç°MySQLçš„Binlogè¿‘å®æ—¶åŒæ­¥ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6b7b87630ee04b41b5221133a5af75ce><p class=pgc-img-caption></p></div><p><br></p><pre><code>// ä¸‹è½½ä¸‹é¢5ä¸ªrpmåŒ… common --&gt; libs --&gt; libs-compat --&gt; client --&gt; servermysql-community-commonmysql-community-libsmysql-community-libs-compatmysql-community-clientmysql-community-server// å¼ºåˆ¶å®‰è£…rpm -ivh mysql-community-common-8.0.18-1.el7.x86_64.rpm --force --nodepsrpm -ivh mysql-community-libs-8.0.18-1.el7.x86_64.rpm --force --nodepsrpm -ivh mysql-community-libs-compat-8.0.18-1.el7.x86_64.rpm --force --nodepsrpm -ivh mysql-community-client-8.0.18-1.el7.x86_64.rpm --force --nodepsrpm -ivh mysql-community-server-8.0.18-1.el7.x86_64.rpm --force --nodeps</code></pre><p>å®‰è£…å®Œæ¯•ä¹‹åï¼Œå¯åŠ¨MySQLæœåŠ¡ï¼Œç„¶åæœç´¢MySQLæœåŠ¡çš„rootè´¦å·çš„ä¸´æ—¶å¯†ç ç”¨äºé¦–æ¬¡ç™»é™†ï¼ˆmysql -u root -pï¼‰ï¼š</p><pre><code>// å¯åŠ¨æœåŠ¡ï¼Œå…³é—­æœåŠ¡å°±æ˜¯service mysqld stopservice mysqld start// æŸ¥çœ‹ä¸´æ—¶å¯†ç  cat /var/log/mysqld.log[root@localhost log]# cat /var/log/mysqld.log 2020-03-02T06:03:53.996423Z 0 [System] [MY-013169] [Server] /usr/sbin/mysqld (mysqld 8.0.18) initializing of server in progress as process 227802020-03-02T06:03:57.321447Z 5 [Note] [MY-010454] [Server] A temporary password is generated for root@localhost: &gt;kjYaXENK6li2020-03-02T06:04:00.123845Z 0 [System] [MY-010116] [Server] /usr/sbin/mysqld (mysqld 8.0.18) starting as process 22834// ç™»å½•ä¸´æ—¶rootç”¨æˆ·ï¼Œä½¿ç”¨ä¸´æ—¶å¯†ç [root@localhost log]# mysql -u root -p</code></pre><p>æ¥ä¸‹æ¥åšä¸‹é¢çš„æ“ä½œï¼š</p><ul><li>ä¿®æ”¹rootç”¨æˆ·çš„å¯†ç ï¼šALTER USER 'root'@'localhost' IDENTIFIED BY 'QWqw12!@';ï¼ˆæ³¨æ„å¯†ç è§„åˆ™å¿…é¡»åŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—å’Œç‰¹æ®Šå­—ç¬¦ï¼‰</li><li>æ›´æ–°rootçš„hostï¼Œåˆ‡æ¢æ•°æ®åº“use mysql;ï¼ŒæŒ‡å®šhostä¸º%ä»¥ä¾¿å¯ä»¥è®©å…¶ä»–æœåŠ¡å™¨è¿œç¨‹è®¿é—®UPDATE USER SET HOST = '%' WHERE USER = 'root';</li><li>èµ‹äºˆ'root'@'%'ç”¨æˆ·ï¼Œæ‰€æœ‰æƒé™ï¼Œæ‰§è¡ŒGRANT ALL PRIVILEGES ON *.* TO 'root'@'%';</li><li>æ”¹å˜root'@'%ç”¨æˆ·çš„å¯†ç æ ¡éªŒè§„åˆ™ä»¥ä¾¿å¯ä»¥ä½¿ç”¨Navicatç­‰å·¥å…·è®¿é—®ï¼šALTER USER 'root'@'%' IDENTIFIED WITH mysql_native_password BY 'QWqw12!@';</li></ul><p><br></p><div class=pgc-img><img alt=åŸºäºCanalå’ŒKafkaå®ç°MySQLçš„Binlogè¿‘å®æ—¶åŒæ­¥ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/25e8556a69604d4d9e8575b64dbe8b3d><p class=pgc-img-caption></p></div><p><br></p><p>æ“ä½œå®Œæˆä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨rootç”¨æˆ·è¿œç¨‹è®¿é—®æ­¤è™šæ‹Ÿæœºä¸Šçš„MySQLæœåŠ¡ã€‚æœ€åç¡®è®¤æ˜¯å¦å¼€å¯äº†binlogï¼ˆæ³¨æ„ä¸€ç‚¹æ˜¯MySQL8.xé»˜è®¤å¼€å¯binlogï¼‰SHOW VARIABLES LIKE '%bin%';ï¼š</p><p><br></p><div class=pgc-img><img alt=åŸºäºCanalå’ŒKafkaå®ç°MySQLçš„Binlogè¿‘å®æ—¶åŒæ­¥ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4aa6d8b4465d49f2b0903f0cc8201adf><p class=pgc-img-caption></p></div><p><br></p><p>æœ€ååœ¨MySQLçš„Shellæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œæ–°å»ºä¸€ä¸ªç”¨æˆ·åcanalå¯†ç ä¸ºQWqw12!@çš„æ–°ç”¨æˆ·ï¼Œèµ‹äºˆREPLICATION SLAVEå’Œ REPLICATION CLIENTæƒé™ï¼š</p><pre><code>CREATE USER canal IDENTIFIED BY 'QWqw12!@';GRANT SELECT, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO 'canal'@'%';FLUSH PRIVILEGES;ALTER USER 'canal'@'%' IDENTIFIED WITH mysql_native_password BY 'QWqw12!@';</code></pre><p>åˆ‡æ¢å›å»rootç”¨æˆ·ï¼Œåˆ›å»ºä¸€ä¸ªæ•°æ®åº“testï¼š</p><pre><code>CREATE DATABASE `test` CHARSET `utf8mb4` COLLATE `utf8mb4_unicode_ci`;</code></pre><h3 class=heading>å®‰è£…Zookeeper</h3><p>Canalå’ŒKafkaé›†ç¾¤éƒ½ä¾èµ–äºZookeeperåšæœåŠ¡åè°ƒï¼Œä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œä¸€èˆ¬ä¼šç‹¬ç«‹éƒ¨ç½²ZookeeperæœåŠ¡æˆ–è€…Zookeeperé›†ç¾¤ã€‚ç¬”è€…è¿™é‡Œé€‰ç”¨2020-03-04å‘å¸ƒçš„3.6.0ç‰ˆæœ¬ï¼š</p><pre><code>midkr /data/zk# åˆ›å»ºæ•°æ®ç›®å½•midkr /data/zk/datacd /data/zkwget http://mirror.bit.edu.cn/apache/zookeeper/zookeeper-3.6.0/apache-zookeeper-3.6.0-bin.tar.gztar -zxvf apache-zookeeper-3.6.0-bin.tar.gzcd apache-zookeeper-3.6.0-bin/confcp zoo_sample.cfg zoo.cfg &amp;&amp; vim zoo.cfg</code></pre><p>æŠŠzoo.cfgæ–‡ä»¶ä¸­çš„dataDirè®¾ç½®ä¸º/data/zk/dataï¼Œç„¶åå¯åŠ¨Zookeeperï¼š</p><pre><code>[root@localhost conf]# sh /data/zk/apache-zookeeper-3.6.0-bin/bin/zkServer.sh start/usr/bin/javaZooKeeper JMX enabled by defaultUsing config: /data/zk/apache-zookeeper-3.6.0-bin/bin/../conf/zoo.cfgStarting zookeeper ... STARTED</code></pre><p>è¿™é‡Œæ³¨æ„ä¸€ç‚¹ï¼Œè¦å¯åŠ¨æ­¤ç‰ˆæœ¬çš„ZookeeperæœåŠ¡å¿…é¡»æœ¬åœ°å®‰è£…å¥½JDK8+ï¼Œè¿™ä¸€ç‚¹éœ€è¦è‡ªè¡Œå¤„ç†ã€‚å¯åŠ¨çš„é»˜è®¤ç«¯å£æ˜¯2181ï¼Œå¯åŠ¨æˆåŠŸåçš„æ—¥å¿—å¦‚ä¸‹ï¼š</p><p><br></p><div class=pgc-img><img alt=åŸºäºCanalå’ŒKafkaå®ç°MySQLçš„Binlogè¿‘å®æ—¶åŒæ­¥ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/543903be42b74908819c43e17de120a2><p class=pgc-img-caption></p></div><p><br></p><h3 class=heading>å®‰è£…Kafka</h3><p>Kafkaæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶ï¼Œå®ƒçš„éƒ¨ç½²ä¾èµ–äºZookeeperã€‚ç¬”è€…åœ¨æ­¤é€‰ç”¨2.4.0å¹¶ä¸”Scalaç‰ˆæœ¬ä¸º2.13çš„å®‰è£…åŒ…ï¼š</p><pre><code>mkdir /data/kafkamkdir /data/kafka/datawget http://mirrors.tuna.tsinghua.edu.cn/apache/kafka/2.4.0/kafka_2.13-2.4.0.tgztar -zxvf kafka_2.13-2.4.0.tgz</code></pre><p>ç”±äºè§£å‹å/data/kafka/kafka_2.13-2.4.0/config/server.propertiesé…ç½®ä¸­å¯¹åº”çš„zookeeper.connect=localhost:2181å·²ç»ç¬¦åˆéœ€è¦ï¼Œä¸å¿…ä¿®æ”¹ï¼Œéœ€è¦ä¿®æ”¹æ—¥å¿—æ–‡ä»¶çš„ç›®å½•log.dirsä¸º/data/kafka/dataã€‚ç„¶åå¯åŠ¨KafkaæœåŠ¡ï¼š</p><pre><code>sh /data/kafka/kafka_2.13-2.4.0/bin/kafka-server-start.sh /data/kafka/kafka_2.13-2.4.0/config/server.properties</code></pre><p><br></p><div class=pgc-img><img alt=åŸºäºCanalå’ŒKafkaå®ç°MySQLçš„Binlogè¿‘å®æ—¶åŒæ­¥ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/548bd02dfbae4c0f88490da266b4a8e4><p class=pgc-img-caption></p></div><p><br></p><p>è¿™æ ·å¯åŠ¨ä¸€æ—¦é€€å‡ºæ§åˆ¶å°å°±ä¼šç»“æŸKafkaè¿›ç¨‹ï¼Œå¯ä»¥æ·»åŠ -daemonå‚æ•°ç”¨äºæ§åˆ¶Kafkaè¿›ç¨‹åå°ä¸æŒ‚æ–­è¿è¡Œã€‚</p><pre><code>sh /data/kafka/kafka_2.13-2.4.0/bin/kafka-server-start.sh -daemon /data/kafka/kafka_2.13-2.4.0/config/server.properties</code></pre><h3 class=heading>å®‰è£…å’Œä½¿ç”¨Canal</h3><p>ç»ˆäºåˆ°äº†ä¸»è§’ç™»åœºï¼Œè¿™é‡Œé€‰ç”¨Canalçš„v1.1.4ç¨³å®šå‘å¸ƒç‰ˆï¼Œåªéœ€è¦ä¸‹è½½deployeræ¨¡å—ï¼š</p><pre><code>mkdir /data/canalcd /data/canal# è¿™é‡Œæ³¨æ„ä¸€ç‚¹ï¼ŒGithubåœ¨å›½å†…è¢«å¢™ï¼Œä¸‹è½½é€Ÿåº¦ææ…¢ï¼Œå¯ä»¥å…ˆç”¨å…¶ä»–ä¸‹è½½å·¥å…·ä¸‹è½½å®Œå†ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸­wget https://github.com/alibaba/canal/releases/download/canal-1.1.4/canal.deployer-1.1.4.tar.gztar -zxvf canal.deployer-1.1.4.tar.gz</code></pre><p>è§£å‹åçš„ç›®å½•å¦‚ä¸‹ï¼š</p><pre><code>- bin   # è¿ç»´è„šæœ¬- conf  # é…ç½®æ–‡ä»¶  canal_local.properties  # canalæœ¬åœ°é…ç½®ï¼Œä¸€èˆ¬ä¸éœ€è¦åŠ¨  canal.properties        # canalæœåŠ¡é…ç½®  logback.xml             # logbackæ—¥å¿—é…ç½®  metrics                 # åº¦é‡ç»Ÿè®¡é…ç½®  spring                  # spring-å®ä¾‹é…ç½®ï¼Œä¸»è¦å’Œbinlogä½ç½®è®¡ç®—ã€ä¸€äº›ç­–ç•¥é…ç½®ç›¸å…³ï¼Œå¯ä»¥åœ¨canal.propertiesé€‰ç”¨å…¶ä¸­çš„ä»»æ„ä¸€ä¸ªé…ç½®æ–‡ä»¶  example                 # å®ä¾‹é…ç½®æ–‡ä»¶å¤¹ï¼Œä¸€èˆ¬è®¤ä¸ºå•ä¸ªæ•°æ®åº“å¯¹åº”ä¸€ä¸ªç‹¬ç«‹çš„å®ä¾‹é…ç½®æ–‡ä»¶å¤¹    instance.properties   # å®ä¾‹é…ç½®ï¼Œä¸€èˆ¬æŒ‡å•ä¸ªæ•°æ®åº“çš„é…ç½®- lib   # æœåŠ¡ä¾èµ–åŒ…- logs  # æ—¥å¿—æ–‡ä»¶è¾“å‡ºç›®å½•</code></pre><p>åœ¨å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒå»ºè®®æŠŠlogback.xmlçš„æ—¥å¿—çº§åˆ«ä¿®æ”¹ä¸ºDEBUGæ–¹ä¾¿å®šä½é—®é¢˜ã€‚è¿™é‡Œéœ€è¦å…³æ³¨canal.propertieså’Œinstance.propertiesä¸¤ä¸ªé…ç½®æ–‡ä»¶ã€‚canal.propertiesæ–‡ä»¶ä¸­ï¼Œéœ€è¦ä¿®æ”¹ï¼š</p><ul><li>å»æ‰canal.instance.parser.parallelThreadSize = 16è¿™ä¸ªé…ç½®é¡¹çš„<strong>æ³¨é‡Š</strong>ï¼Œä¹Ÿå°±æ˜¯å¯ç”¨æ­¤é…ç½®é¡¹ï¼Œå’Œå®ä¾‹è§£æå™¨çš„çº¿ç¨‹æ•°ç›¸å…³ï¼Œä¸é…ç½®ä¼šè¡¨ç°ä¸ºé˜»å¡æˆ–è€…ä¸è¿›è¡Œè§£æã€‚</li><li>canal.serverModeé…ç½®é¡¹æŒ‡å®šä¸ºkafkaï¼Œå¯é€‰å€¼æœ‰tcpã€kafkaå’Œrocketmqï¼ˆmasteråˆ†æ”¯æˆ–è€…æœ€æ–°çš„çš„v1.1.5-alpha-1ç‰ˆæœ¬ï¼Œå¯ä»¥é€‰ç”¨rabbitmqï¼‰ï¼Œé»˜è®¤æ˜¯kafkaã€‚</li><li>canal.mq.serversé…ç½®éœ€è¦æŒ‡å®šä¸ºKafkaæœåŠ¡æˆ–è€…é›†ç¾¤Brokerçš„åœ°å€ï¼Œè¿™é‡Œé…ç½®ä¸º127.0.0.1:9092ã€‚</li></ul><blockquote><p>canal.mq.serversåœ¨ä¸åŒçš„canal.serverModeæœ‰ä¸åŒçš„æ„ä¹‰ã€‚ kafkaæ¨¡å¼ä¸‹ï¼ŒæŒ‡KafkaæœåŠ¡æˆ–è€…é›†ç¾¤Brokerçš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯bootstrap.servers rocketmqæ¨¡å¼ä¸‹ï¼ŒæŒ‡NameServeråˆ—è¡¨ rabbitmqæ¨¡å¼ä¸‹ï¼ŒæŒ‡RabbitMQæœåŠ¡çš„Hostå’ŒPort</p></blockquote><p>å…¶ä»–é…ç½®é¡¹å¯ä»¥å‚è€ƒä¸‹é¢ä¸¤ä¸ªå®˜æ–¹Wikiçš„é“¾æ¥ï¼š</p><ul><li>Canal-Kafka-RocketMQ-QuickStart</li><li>AdminGuide</li></ul><p>instance.propertiesä¸€èˆ¬æŒ‡ä¸€ä¸ªæ•°æ®åº“å®ä¾‹çš„é…ç½®ï¼ŒCanalæ¶æ„æ”¯æŒä¸€ä¸ªCanalæœåŠ¡å®ä¾‹ï¼Œå¤„ç†å¤šä¸ªæ•°æ®åº“å®ä¾‹çš„binlogå¼‚æ­¥è§£æã€‚instance.propertieséœ€è¦ä¿®æ”¹çš„é…ç½®é¡¹ä¸»è¦åŒ…æ‹¬ï¼š</p><ul><li>canal.instance.mysql.slaveIdéœ€è¦é…ç½®ä¸€ä¸ªå’ŒMasterèŠ‚ç‚¹çš„æœåŠ¡IDå®Œå…¨ä¸åŒçš„å€¼ï¼Œè¿™é‡Œç¬”è€…é…ç½®ä¸º654321ã€‚</li><li>é…ç½®æ•°æ®æºå®ä¾‹ï¼ŒåŒ…æ‹¬åœ°å€ã€ç”¨æˆ·ã€å¯†ç å’Œç›®æ ‡æ•°æ®åº“ï¼š canal.instance.master.addressï¼Œè¿™é‡ŒæŒ‡å®šä¸º127.0.0.1:3306ã€‚ canal.instance.dbUsernameï¼Œè¿™é‡ŒæŒ‡å®šä¸ºcanalã€‚ canal.instance.dbPasswordï¼Œè¿™é‡ŒæŒ‡å®šä¸ºQWqw12!@ã€‚ æ–°å¢canal.instance.defaultDatabaseNameï¼Œè¿™é‡ŒæŒ‡å®šä¸ºtestï¼ˆéœ€è¦åœ¨MySQLä¸­å»ºç«‹ä¸€ä¸ªtestæ•°æ®åº“ï¼Œè§å‰é¢çš„æµç¨‹ï¼‰ã€‚</li><li>Kafkaç›¸å…³é…ç½®ï¼Œè¿™é‡Œæš‚æ—¶ä½¿ç”¨é™æ€topicå’Œå•ä¸ªpartitionï¼š canal.mq.topicï¼Œè¿™é‡ŒæŒ‡å®šä¸ºtestï¼Œ<strong>ä¹Ÿå°±æ˜¯è§£æå®Œçš„binlogç»“æ„åŒ–æ•°æ®ä¼šå‘é€åˆ°Kafkaçš„å‘½åä¸ºtestçš„topicä¸­</strong>ã€‚ canal.mq.partitionï¼Œè¿™é‡ŒæŒ‡å®šä¸º0ã€‚</li></ul><p>é…ç½®å·¥ä½œåšå¥½ä¹‹åï¼Œå¯ä»¥å¯åŠ¨CanalæœåŠ¡ï¼š</p><pre><code>sh /data/canal/bin/startup.sh # æŸ¥çœ‹æœåŠ¡æ—¥å¿—tail -100f /data/canal/logs/canal/canal# æŸ¥çœ‹å®ä¾‹æ—¥å¿—  -- ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå…³æ³¨å®ä¾‹æ—¥å¿—å³å¯tail -100f /data/canal/logs/example/example.log</code></pre><p>å¯åŠ¨æ­£å¸¸åï¼Œè§å®ä¾‹æ—¥å¿—å¦‚ä¸‹ï¼š</p><p><br></p><div class=pgc-img><img alt=åŸºäºCanalå’ŒKafkaå®ç°MySQLçš„Binlogè¿‘å®æ—¶åŒæ­¥ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5d899e1984b5448a97c88876f8f44b69><p class=pgc-img-caption></p></div><p><br></p><p>åœ¨testæ•°æ®åº“åˆ›å»ºä¸€ä¸ªè®¢å•è¡¨ï¼Œå¹¶ä¸”æ‰§è¡Œå‡ ä¸ªç®€å•çš„DMLï¼š</p><pre><code>use `test`;CREATE TABLE `order`(    id          BIGINT UNIQUE PRIMARY KEY AUTO_INCREMENT COMMENT 'ä¸»é”®',    order_id    VARCHAR(64)    NOT NULL COMMENT 'è®¢å•ID',    amount      DECIMAL(10, 2) NOT NULL DEFAULT 0 COMMENT 'è®¢å•é‡‘é¢',    create_time DATETIME       NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',    UNIQUE uniq_order_id (`order_id`)) COMMENT 'è®¢å•è¡¨';INSERT INTO `order`(order_id, amount) VALUES ('10086', 999);UPDATE `order` SET amount = 10087 WHERE order_id = '10086';DELETE  FROM `order` WHERE order_id = '10086';</code></pre><p>è¿™ä¸ªæ—¶å€™ï¼Œå¯ä»¥åˆ©ç”¨Kafkaçš„kafka-console-consumeræˆ–è€…Kafka ToolsæŸ¥çœ‹testè¿™ä¸ªtopicçš„æ•°æ®ï¼š</p><pre><code>sh /data/kafka/kafka_2.13-2.4.0/bin/kafka-console-consumer.sh --bootstrap-server 127.0.0.1:9092 --from-beginning --topic test</code></pre><p><br></p><div class=pgc-img><img alt=åŸºäºCanalå’ŒKafkaå®ç°MySQLçš„Binlogè¿‘å®æ—¶åŒæ­¥ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/86a283a62c6d4cf3a87cabf4085ea0c1><p class=pgc-img-caption></p></div><p><br></p><p>å…·ä½“çš„æ•°æ®å¦‚ä¸‹ï¼š</p><pre><code>// testæ•°æ®åº“å»ºåº“è„šæœ¬{"data":null,"database":"`test`","es":1583143732000,"id":1,"isDdl":false,"mysqlType":null,"old":null,"pkNames":null,"sql":"CREATE DATABASE `test` CHARSET `utf8mb4` COLLATE `utf8mb4_unicode_ci`","sqlType":null,"table":"","ts":1583143930177,"type":"QUERY"}// orderè¡¨å»ºè¡¨DDL{"data":null,"database":"test","es":1583143957000,"id":2,"isDdl":true,"mysqlType":null,"old":null,"pkNames":null,"sql":"CREATE TABLE `order`\n(\n    id          BIGINT UNIQUE PRIMARY KEY AUTO_INCREMENT COMMENT 'ä¸»é”®',\n    order_id    VARCHAR(64)    NOT NULL COMMENT 'è®¢å•ID',\n    amount      DECIMAL(10, 2) NOT NULL DEFAULT 0 COMMENT 'è®¢å•é‡‘é¢',\n    create_time DATETIME       NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',\n    UNIQUE uniq_order_id (`order_id`)\n) COMMENT 'è®¢å•è¡¨'","sqlType":null,"table":"order","ts":1583143958045,"type":"CREATE"}// INSERT{"data":[{"id":"1","order_id":"10086","amount":"999.0","create_time":"2020-03-02 05:12:49"}],"database":"test","es":1583143969000,"id":3,"isDdl":false,"mysqlType":{"id":"BIGINT","order_id":"VARCHAR(64)","amount":"DECIMAL(10,2)","create_time":"DATETIME"},"old":null,"pkNames":["id"],"sql":"","sqlType":{"id":-5,"order_id":12,"amount":3,"create_time":93},"table":"order","ts":1583143969460,"type":"INSERT"}// UPDATE{"data":[{"id":"1","order_id":"10086","amount":"10087.0","create_time":"2020-03-02 05:12:49"}],"database":"test","es":1583143974000,"id":4,"isDdl":false,"mysqlType":{"id":"BIGINT","order_id":"VARCHAR(64)","amount":"DECIMAL(10,2)","create_time":"DATETIME"},"old":[{"amount":"999.0"}],"pkNames":["id"],"sql":"","sqlType":{"id":-5,"order_id":12,"amount":3,"create_time":93},"table":"order","ts":1583143974870,"type":"UPDATE"}// DELETE{"data":[{"id":"1","order_id":"10086","amount":"10087.0","create_time":"2020-03-02 05:12:49"}],"database":"test","es":1583143980000,"id":5,"isDdl":false,"mysqlType":{"id":"BIGINT","order_id":"VARCHAR(64)","amount":"DECIMAL(10,2)","create_time":"DATETIME"},"old":null,"pkNames":["id"],"sql":"","sqlType":{"id":-5,"order_id":12,"amount":3,"create_time":93},"table":"order","ts":1583143981091,"type":"DELETE"}</code></pre><p>å¯è§Kafkaçš„åä¸ºtestçš„topicå·²ç»å†™å…¥äº†å¯¹åº”çš„ç»“æ„åŒ–binlogäº‹ä»¶æ•°æ®ï¼Œå¯ä»¥ç¼–å†™æ¶ˆè´¹è€…ç›‘å¬Kafkaå¯¹åº”çš„topicç„¶åå¯¹è·å–åˆ°çš„æ•°æ®è¿›è¡Œåç»­å¤„ç†ã€‚</p><h2 class=heading>å°ç»“</h2><p>è¿™ç¯‡æ–‡ç« å¤§éƒ¨åˆ†ç¯‡å¹…ç”¨äºä»‹ç»å…¶ä»–ä¸­é—´ä»¶æ˜¯æ€ä¹ˆéƒ¨ç½²çš„ï¼Œè¿™ä¸ªé—®é¢˜ä¾§é¢è¯´æ˜äº†Canalæœ¬èº«éƒ¨ç½²å¹¶ä¸å¤æ‚ï¼Œå®ƒçš„é…ç½®æ–‡ä»¶å±æ€§é¡¹æ¯”è¾ƒå¤šï¼Œä½†æ˜¯å®é™…ä¸Šéœ€è¦è‡ªå®šä¹‰å’Œæ”¹åŠ¨çš„é…ç½®é¡¹æ˜¯æ¯”è¾ƒå°‘çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜äº†å®ƒçš„è¿ç»´æˆæœ¬å’Œå­¦ä¹ æˆæœ¬å¹¶ä¸é«˜ã€‚åé¢ä¼šåˆ†æåŸºäºç»“æ„åŒ–binlogäº‹ä»¶åšELTå’ŒæŒä¹…åŒ–ç›¸å…³å·¥ä½œä»¥åŠCanalçš„ç”Ÿäº§ç¯å¢ƒå¯ç”¨çº§åˆ«HAé›†ç¾¤çš„æ­å»ºã€‚</p><blockquote><p>æ¥æºï¼šæ˜é‡‘ é“¾æ¥ï¼šhttps://juejin.im/post/5e6a6746f265da575c16d678</p></blockquote></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Canal','Kafka','å®ç°'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>