<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>OpenCV入门教程三-图像的载入、显示和输出一站式完全解析 | 极客快訊</title><meta property="og:title" content="OpenCV入门教程三-图像的载入、显示和输出一站式完全解析 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/6bdc9d65421246cfad65f035c925d08f"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/21eeb6b8.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/21eeb6b8.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/21eeb6b8.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/21eeb6b8.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/21eeb6b8.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/21eeb6b8.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/21eeb6b8.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/21eeb6b8.html><meta property="article:published_time" content="2020-11-14T21:01:36+08:00"><meta property="article:modified_time" content="2020-11-14T21:01:36+08:00"><meta name=Keywords content><meta name=description content="OpenCV入门教程三-图像的载入、显示和输出一站式完全解析"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/21eeb6b8.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>OpenCV入门教程三-图像的载入、显示和输出一站式完全解析</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right><span style="color:#c00;--tt-darkmode-color: #FF0C00">一、开胃菜之一 • 关于OpenCV的命名空间</span></h1><p>OpenCV中的C++类和函数都是定义在命名空间cv之内的，有两种方法可以访问。第一种是，在代码开头的适当位置，加上usingnamespace cv;这句。</p><p>另外一种是在使用OpenCV类和函数时，都加入cv::命名空间。不过这种情况难免会不爽，每用一个OpenCV的类或者函数，都要多敲四下键盘写出cv::，很麻烦。</p><p>所以，浅墨推崇大家在代码开头的适当位置，加上using namespace cv;这句。于是和opencv命名空间一了百了了。</p><pre><code>#include &lt;opencv2/core/core.hpp&gt;#include&lt;opencv2/highgui/highgui.hpp&gt; using namespace cv;</code></pre><h1 class=pgc-h-arrow-right>二、开胃菜之二 • 关于Mat类型</h1><p>cv::Mat类是用于保存图像以及其他矩阵数据的数据结构。默认情况下，其尺寸为0，我们也可以指定初始尺寸,比如，比如定义一个Mat类对象，就要写cv::Mat pic(320,640,cv::Scalar(100));</p><p></p><p>Mat类型作为OpenCV2新纪元的重要代表“人物”，浅墨准备在稍后的文章中，花长篇幅详细讲解它，现在我们只要理解，它是对应于OpenCV1.0时代的IplImage的主要用来存放图像的数据结构就行了。对于这篇文章，我们需要用到关于Mat其实就简单的这样一句代码：</p><pre><code> Mat myMat= imread("dota.jpg");</code></pre><p>表示从工程目录下把一幅名为dota.jpg的jpg类型的图像载入到Mat类型的myMat中。这里的imread函数这篇文章的下文就会详细剖析到。</p><p></p><p>好吧，开胃菜就是这么多了，下面来看看今天的主要内容，图像的载入和显示，处理图像混合，设置感兴趣区域以及如何输出图像，一项一项来击破吧。</p><h1 class=pgc-h-arrow-right><span style="color:#f60;--tt-darkmode-color: #FF6600">三、图像的载入和显示</span></h1><p>在新版本的OpenCV2中，最简单的图像载入和显示只需要3句代码，非常便捷。这三句代码分别对应了三个函数，他们分别是：</p><p>imread( ), namedWindow( )以及imshow( )。我们依次来解析一下这三个函数。</p><h1 class=pgc-h-arrow-right><span style="color:#939;--tt-darkmode-color: #993399">1.imread函数</span></h1><p>首先，我们看imread函数，可以在OpenCV官方文档中查到其原型如下：</p><pre><code>Mat imread(const string&amp; filename, intflags=1 );</code></pre><p>■ 第一个参数，const string&类型的filename，填我们需要载入的图片路径名。</p><p>在Windows操作系统下，OpenCV的imread函数支持如下类型的图像载入：</p><ol start=1><li>Windows位图 - *.bmp, *.dib</li><li>JPEG文件 - *.jpeg, *.jpg, *.jpe</li><li>JPEG 2000文件- *.jp2</li><li>PNG图片 - *.png</li><li>便携文件格式- *.pbm, *.pgm, *.ppm</li><li>Sun rasters光栅文件 - *.sr, *.ras</li><li>TIFF 文件 - *.tiff, *.tif</li></ol><p>■ 第二个参数，int类型的flags，为载入标识，它指定一个加载图像的颜色类型。可以看到它自带缺省值1.所以有时候这个参数在调用时我们可以忽略，在看了下面的讲解之后，我们就会发现，如果在调用时忽略这个参数，就表示载入三通道的彩色图像。</p><p>可以在OpenCV中标识图像格式的枚举体中取值。通过转到定义，我们可以在higui_c.h中发现这个枚举的定义是这样的</p><pre><code>enum{/* 8bit, color or not */   CV_LOAD_IMAGE_UNCHANGED  =-1,/* 8bit, gray */   CV_LOAD_IMAGE_GRAYSCALE  =0,/* ?, color */   CV_LOAD_IMAGE_COLOR      =1,/* any depth, ? */   CV_LOAD_IMAGE_ANYDEPTH   =2,/* ?, any color */   CV_LOAD_IMAGE_ANYCOLOR   =4};</code></pre><p>相应的解释：</p><ol start=1><li>CV_LOAD_IMAGE_UNCHANGED，这个标识在新版本中被废置了，忽略。</li><li>CV_LOAD_IMAGE_ANYDEPTH- 如果取这个标识的话，若载入的图像的深度为16位或者32位，就返回对应深度的图像，否则，就转换为8位图像再返回。</li><li>CV_LOAD_IMAGE_COLOR- 如果取这个标识的话，总是转换图像到彩色一体</li><li>CV_LOAD_IMAGE_GRAYSCALE- 如果取这个标识的话，始终将图像转换成灰度1</li></ol><p>如果输入有冲突的标志，将采用较小的数字值。比如CV_LOAD_IMAGE_COLOR | CV_LOAD_IMAGE_ANYCOLOR 将载入3通道图。</p><p>如果想要载入最真实的图像，选择CV_LOAD_IMAGE_ANYDEPTH | CV_LOAD_IMAGE_ANYCOLOR。</p><p></p><p>因为flags是int型的变量，如果我们不在这个枚举体中取值的话，还可以这样来：</p><ol start=1><li>flags >0返回一个3通道的彩色图像。</li><li>flags =0返回灰度图像。</li><li>flags &lt;0返回包含Alpha通道的加载的图像。</li></ol><p><span style="color:#4f4f4f;--tt-darkmode-color: #979797">需要注意的点：输出的图像默认情况下是不载入Alpha通道进来的。如果我们需要载入Alpha通道的话呢，这里就需要取负值。<br>如果你搞怪，flags取1999，也是可以的，这时就表示返回一个3通道的彩色图像。好了，讲了这么多，来几个载入示例，一看就懂：</span></p><pre><code>  Mat image0=imread("dota.jpg",CV_LOAD_IMAGE_ANYDEPTH | CV_LOAD_IMAGE_ANYCOLOR);//载入最真实的图像	Mat image1=imread("dota.jpg",0);//载入灰度图Mat image2=imread("dota.jpg",199);//载入3通道的彩色图像       	Mat logo=imread("dota_logo.jpg");//载入3通道的彩色图像</code></pre><p><span style="color:#c00;--tt-darkmode-color: #FF0C00">2.namedWindow函数</span></p><p>顾名思义，namedWindow函数，用于创建一个窗口。</p><p>函数原型是这样的：</p><pre><code>void namedWindow(const string&amp; winname,int flags=WINDOW_AUTOSIZE ); </code></pre><p>■ 第一个参数，const string&型的name，即填被用作窗口的标识符的窗口名称。</p><p>■ 第二个参数，int 类型的flags ，窗口的标识，可以填如下的值：</p><p>WINDOW_NORMAL设置了这个值，用户便可以改变窗口的大小（没有限制）</p><p>WINDOW_AUTOSIZE如果设置了这个值，窗口大小会自动调整以适应所显示的图像，并且不能手动改变窗口大小。</p><p>WINDOW_OPENGL 如果设置了这个值的话，窗口创建的时候便会支持OpenGL。</p><p>函数剖析：</p><p>首先需要注意的是，它有默认值WINDOW_AUTOSIZE，所以，一般情况下，这个函数我们填一个变量就行了。</p><p>namedWindow函数的作用是，通过指定的名字，创建一个可以作为图像和进度条的容器窗口。如果具有相同名称的窗口已经存在，则函数不做任何事情。</p><p>我们可以调用destroyWindow()或者destroyAllWindows()函数来关闭窗口，并取消之前分配的与窗口相关的所有内存空间。</p><p>但话是这样说，其实对于代码量不大的简单小程序来说，我们完全没有必要手动调用上述的destroyWindow()或者destroyAllWindows()函数，因为在退出时，所有的资源和应用程序的窗口会被操作系统会自动关闭。</p><h1 class=pgc-h-arrow-right><span style="color:#c93;--tt-darkmode-color: #CC9933">3.imshow函数</span></h1><p>在指定的窗口中显示一幅图像。</p><pre><code>void imshow(const string&amp; winname, InputArray mat);</code></pre><p>■ 第一个参数，const string&类型的winname，填需要显示的窗口标识名称。</p><p>■ 第二个参数，InputArray 类型的mat，填需要显示的图像。</p><p>imshow 函数详解：</p><p>imshow 函数用于在指定的窗口中显示图像。如果窗口是用CV_WINDOW_AUTOSIZE（默认值）标志创建的，那么显示图像原始大小。否则，将图像进行缩放以适合窗口。而imshow 函数缩放图像，取决于图像的深度：</p><p>如果载入的图像是8位无符号类型（8-bit unsigned），就显示图像本来的样子。</p><p>如果图像是16位无符号类型（16-bit unsigned）或32位整型（32-bit integer），便用像素值除以256。也就是说，值的范围是[0,255 x 256]映射到[0,255]。</p><p>如果图像是32位浮点型（32-bit floating-point），像素值便要乘以255。也就是说，该值的范围是[0,1]映射到[0,255]。</p><h1 class=pgc-h-arrow-right><span style="color:#c00;--tt-darkmode-color: #FF0C00">四、输出图像到文件——imwrite函数</span></h1><p>在OpenCV中，输出图像到文件，我们一般都用imwrite函数，它的声明如下：</p><pre><code>bool imwrite(const string&amp; filename,InputArray img, const vector&lt;int&gt;&amp; params=vector&lt;int&gt;() );</code></pre><p><span style="color:#4f4f4f;--tt-darkmode-color: #979797">■ 第一个参数，const string&类型的filename，填需要写入的文件名就行了，带上后缀，比如，“123.jpg”这样。</span></p><p><span style="color:#4f4f4f;--tt-darkmode-color: #979797">■ 第二个参数，InputArray类型的img，一般填一个Mat类型的图像数据就行了。</span></p><p><span style="color:#4f4f4f;--tt-darkmode-color: #979797">■ 第三个参数，const vector&lt;int>&类型的params，表示为特定格式保存的参数编码，它有默认值vector&lt;int>()，所以一般情况下不需要填写。而如果要填写的话，有下面这些需要了解的地方：</span></p><ol start=1><li>对于JPEG格式的图片，这个参数表示从0到100的图片质量（CV_IMWRITE_JPEG_QUALITY），默认值是95.</li><li>对于PNG格式的图片，这个参数表示压缩级别（CV_IMWRITE_PNG_COMPRESSION）从0到9。较高的值意味着更小的尺寸和更长的压缩时间，而默认值是3。</li><li>对于PPM，PGM，或PBM格式的图片，这个参数表示一个二进制格式标志（CV_IMWRITE_PXM_BINARY），取值为0或1，而默认值是1。</li></ol><h1 class=pgc-h-arrow-right><span style="color:#c00;--tt-darkmode-color: #FF0C00">五、一个综合示例</span></h1><p><span style="color:#4f4f4f;--tt-darkmode-color: #979797">最后是一个综合示例，载入图像，进行简单图像混合，显示图像，并且输出混合后的图像到jpg。</span></p><p><span style="color:#4f4f4f;--tt-darkmode-color: #979797">由于篇幅原因，这里的图像混合具体细节我们放到稍后的文章中再讲，现在先给大家看看混合的效果和源码。囧，因为opencv图像处理真的很少涉及到设计模式的问题，所以很多时候往往就是main函数中塞满一串串代码打天下，即便是OpenCV官方的示例都是如此。</span></p><p><span style="color:#4f4f4f;--tt-darkmode-color: #979797">好了，如下就是这篇文章配套综合示例的配套源码，非常的简单明了：</span></p><pre><code>//-----------------------------------【程序说明】----------------------------------------------//  程序名称:：【OpenCV入门教程之三】图像的载入，显示与输出 一站式完全解析 博文配套源码// VS2010版   OpenCV版本：2.4.8//      2014年3月5日 Create by 浅墨//  描述： 图像的载入，显示与输出 一站式剖析   配套源码//  图片素材出处：dota2原画圣堂刺客 dota2 logo  动漫人物//------------------------------------------------------------------------------------------------  #include&lt;opencv2/core/core.hpp&gt;#include&lt;opencv2/highgui/highgui.hpp&gt; using namespace cv;  int main( ){//-----------------------------------【一、图像的载入和显示】--------------------------------------//     描述：以下三行代码用于完成图像的载入和显示//-------------------------------------------------------------------------------------------------- Mat girl=imread("girl.jpg"); //载入图像到MatnamedWindow("【1】动漫图"); //创建一个名为 "【1】动漫图"的窗口 imshow("【1】动漫图",girl);//显示名为 "【1】动漫图"的窗口  //-----------------------------------【二、初级图像混合】--------------------------------------//     描述：二、初级图像混合//-----------------------------------------------------------------------------------------------//载入图片Mat image= imread("dota.jpg",199);Mat logo= imread("dota_logo.jpg"); //载入后先显示namedWindow("【2】原画图");imshow("【2】原画图",image); namedWindow("【3】logo图");imshow("【3】logo图",logo); //定义一个Mat类型，用于存放，图像的ROIMat imageROI;//方法一imageROI=image(Rect(800,350,logo.cols,logo.rows));//方法二//imageROI=image(Range(350,350+logo.rows),Range(800,800+logo.cols)); //将logo加到原图上addWeighted(imageROI,0.5,logo,0.3,0.,imageROI); //显示结果namedWindow("【4】原画+logo图");imshow("【4】原画+logo图",image); //-----------------------------------【三、图像的输出】--------------------------------------//     描述：将一个Mat图像输出到图像文件//-----------------------------------------------------------------------------------------------//输出一张jpg图片到工程目录下imwrite("我喜欢打dota2 by浅墨.jpg",image); waitKey(); return 0;}</code></pre><p>下面是运行截图</p><div class=pgc-img><img alt=OpenCV入门教程三-图像的载入、显示和输出一站式完全解析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6bdc9d65421246cfad65f035c925d08f><p class=pgc-img-caption></p></div><p>接着是载入一张dota2原画和dota2logo图，为图像融合做准备：</p><div class=pgc-img><img alt=OpenCV入门教程三-图像的载入、显示和输出一站式完全解析 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/87b1c1d855264c989fd87128ae5ca27d><p class=pgc-img-caption></p></div><p>logo图：</p><div class=pgc-img><img alt=OpenCV入门教程三-图像的载入、显示和输出一站式完全解析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/63aed35c88584e64b0154e967c747a64><p class=pgc-img-caption></p></div><p>最终，经过处理，得到dota2原画+logo的融合，并输出一张名为我喜欢打dota2 by浅墨.jpg的图片到工程目录下。</p><div class=pgc-img><img alt=OpenCV入门教程三-图像的载入、显示和输出一站式完全解析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b0f02026895e47d48d6d94df61b4b5c9><p class=pgc-img-caption></p></div><blockquote class=pgc-blockquote-abstract><p>本文转载于https://blog.csdn.net/poem_qianmo/article/details/20537737</p><p>作者：毛星云</p><p>感兴趣可以去看原作者其他文章</p></blockquote></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'OpenCV','入门','图像'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>