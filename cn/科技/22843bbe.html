<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>VBAï½œä½¿ç”¨å’Œå®šåˆ¶Excelå†…ç½®å¯¹è¯æ¡† | æå®¢å¿«è¨Š</title><meta property="og:title" content="VBAï½œä½¿ç”¨å’Œå®šåˆ¶Excelå†…ç½®å¯¹è¯æ¡† - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/46d400040f01ab2435b7"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/22843bbe.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/22843bbe.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/22843bbe.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/22843bbe.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/22843bbe.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/22843bbe.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/22843bbe.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/22843bbe.html><meta property="article:published_time" content="2020-11-14T21:01:55+08:00"><meta property="article:modified_time" content="2020-11-14T21:01:55+08:00"><meta name=Keywords content><meta name=description content="VBAï½œä½¿ç”¨å’Œå®šåˆ¶Excelå†…ç½®å¯¹è¯æ¡†"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/22843bbe.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>VBAï½œä½¿ç”¨å’Œå®šåˆ¶Excelå†…ç½®å¯¹è¯æ¡†</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><p>åœ¨Excelä¸­ï¼Œå¯¹è¯æ¡†å¯ä»¥å®ç°åº”ç”¨ç¨‹åºä¸ç”¨æˆ·çš„äº¤äº’ã€‚åœ¨VBAä¸­ï¼ŒExcelæä¾›äº†è°ƒç”¨è¿™äº›å†…ç½®å¯¹è¯æ¡†çš„æ¥å£ï¼Œä½¿å¼€å‘è€…å¯å……åˆ†åˆ©ç”¨å†…ç½®å¯¹è¯æ¡†å®ç°æ›´å¤šçš„æ“ä½œã€‚</p><h1>1 ç”¨FindFileæ–¹æ³•æ‰“å¼€æ–‡ä»¶</h1><blockquote><p>Sub æ‰“å¼€å·¥ä½œç°¿()</p><p>Dim wb As Workbook</p><p>Set wb = ActiveWorkbook</p><p>If <strong>Application.FindFile</strong> Then 'æ˜¾ç¤ºâ€œæ‰“å¼€â€å¯¹è¯æ¡†</p><p>MsgBox "å·²æ‰“å¼€å·¥ä½œç°¿æ–‡ä»¶ï¼"</p><p>wb.Activate</p><p>Else</p><p>MsgBox "æ‰“å¼€å·¥ä½œç°¿å¤±è´¥ï¼"</p><p>End If</p><p>End Sub</p><p>'ä¸Šé¢ä»£ç è¿è¡Œåï¼Œæ˜¾ç¤ºâ€œæ‰“å¼€â€å¯¹è¯æ¡†ï¼Œé€‰æ‹©ä¸€ä¸ªå·¥ä½œç°¿ï¼Œå•å‡»â€œæ‰“å¼€â€åå³å¯æ‰“å¼€è¯¥å·¥ä½œç°¿</p></blockquote><h1>2 ä½¿ç”¨å¯¹è¯æ¡†è·å–å•ä¸ªæ–‡ä»¶å</h1><p>2.1 ä½¿ç”¨GetOpenFilenameæ–¹æ³•æ˜¾ç¤ºâ€œæ‰“å¼€â€å¯¹è¯æ¡†ï¼Œè·å–é€‰æ‹©çš„æ–‡ä»¶å</p><blockquote><p>Sub è·å–å•ä¸ªæ–‡ä»¶å()</p><p>Dim strFilt As String</p><p>Dim strTitle As String</p><p>Dim strFname As Variant</p><p>strFilt = "æ–‡æœ¬æ–‡ä»¶(*.txt),*.txt," & _</p><p>"Excelæ–‡ä»¶(*.xls;*.xlsx;*.xlsm),*.xls;*.xlsx;*.xlsm," & _</p><p>"æ‰€æœ‰æ–‡ä»¶(*.*),*.*"</p><p>strTitle = "æ‰“å¼€Excelæ–‡ä»¶"</p><p><strong>strFname = </strong><strong>Application.GetOpenFilename</strong> _</p><p>(fileFilter:=strFilt, _</p><p>Title:=strTitle)</p><p>If strFname = False Then</p><p>MsgBox "æ²¡é€‰æ‹©æ–‡ä»¶ï¼"</p><p>Else</p><p>MsgBox "é€‰æ‹©çš„æ–‡ä»¶æ˜¯ï¼š" & strFname</p><p>End If</p><p>End Sub</p></blockquote><p>2.2 ä½¿ç”¨GetSaveAsFilenameæ–¹æ³•æ‰“å¼€â€œå¦å­˜ä¸ºâ€å¯¹è¯æ¡†è·å–æ–‡ä»¶å</p><blockquote><p>Sub è·å–ä¿å­˜æ–‡ä»¶å()</p><p>Dim fn As String</p><p>fn = <strong>Application.GetSaveAsFilename</strong>( _</p><p>fileFilter:="Text Files (*.txt), *.txt")</p><p>If fn &lt;> "False" Then</p><p>'åœ¨æ­¤å¤„ç¼–å†™ä¿å­˜æ–‡ä»¶çš„ä»£ç </p><p>MsgBox "ä¿å­˜æ–‡ä»¶ä¸ºï¼š" & fn</p><p>End If</p><p>End Sub</p></blockquote><h1>3 ä½¿ç”¨å¯¹è¯æ¡†è·å–å¤šä¸ªæ–‡ä»¶å</h1><blockquote><p>Sub è·å–å¤šä¸ªæ–‡ä»¶å()</p><p>Dim strFilt As String</p><p>Dim strTitle As String</p><p>Dim strFname As Variant</p><p>Dim i As Integer</p><p>Dim strMsg As String</p><p>strFilt = "æ–‡æœ¬æ–‡ä»¶(*.txt),*.txt," & _</p><p>"Excelæ–‡ä»¶(*.xls;*.xlsx;*.xlsm),*.xls;*.xlsx;*.xlsm," & _</p><p>"æ‰€æœ‰æ–‡ä»¶(*.*),*.*"</p><p>strTitle = "æ‰“å¼€Excelæ–‡ä»¶"</p><p><strong>strFname = Application.GetOpenFilename _</strong></p><p>(fileFilter:=strFilt, _</p><p>Title:=strTitle, _</p><p><strong>MultiSelect:=True</strong>) 'å…è®¸é€‰æ‹©å¤šä¸ªæ–‡ä»¶</p><p>If Not IsArray(strFname) Then 'è¿”å›å€¼ä¸æ˜¯æ•°ç»„</p><p>MsgBox "æ²¡é€‰æ‹©æ–‡ä»¶ï¼"</p><p>Else</p><p>For i = LBound(strFname) To UBound(strFname)</p><p>strMsg = strMsg & strFname(i) & vbCrLf</p><p>Next</p><p>MsgBox "é€‰æ‹©çš„æ–‡ä»¶æ˜¯ï¼š" & vbNewLine & strMsg</p><p>End If</p><p>End Sub</p></blockquote><h1>4 ä½¿ç”¨Dialogsé›†åˆå¯ä»¥è°ƒç”¨æ‰€æœ‰Excelå†…ç½®å¯¹è¯æ¡†</h1><p>Excel2007ä¸­æœ‰1101ä¸ªå†…ç½®å¯¹è¯æ¡†ï¼Œå¦‚ä¸‹é¢ä»£ç å¯ä»¥è°ƒç”¨â€œå¯¹é½"æ ‡ç­¾é¡µï¼š<br></p><blockquote><p>Sub å¯¹é½å¯¹è¯æ¡†()</p><p>Application.Dialogs(xlDialogAlignment).Show</p><p>End Sub</p></blockquote><h1>5 è®¾ç½®å†…ç½®å¯¹è¯æ¡†çš„åˆå§‹å€¼</h1><p>åœ¨VBAä¸­ï¼Œå¯ä»¥é€šè¿‡æ›´æ”¹å¯¹è¯æ¡†çš„é€‰é¡¹å‚æ•°ï¼Œå®šåˆ¶ç”¨æˆ·éœ€è¦çš„å¯¹è¯æ¡†ï¼š<br></p><blockquote><p>Sub è®¾ç½®å­—ä½“1()</p><p>Application.Dialogs(xlDialogFontProperties).Show _</p><p>"é»‘ä½“", "ç²—ä½“", 20, True, True, False, , _</p><p>True, 5, 4, True, 3</p><p>End Sub</p></blockquote><blockquote><p>Sub è®¾ç½®å­—ä½“2()</p><p>Application.Dialogs(xlDialogFontProperties).Show _</p><p>arg1:="é»‘ä½“", arg2:="ç²—ä½“", arg3:=20, _</p><p>arg4:=True, arg5:=True, arg7:=True, arg8:=True, _</p><p>arg9:=5, arg10:=4, arg11:=True, arg12:=3</p><p>End Sub</p></blockquote><p>é€‰æ‹©éœ€è¦è®¾ç½®å­—ä½“çš„å•å…ƒæ ¼åŒºåŸŸåï¼Œè¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œè°ƒç”¨è‡ªå®šä¹‰çš„å†…ç½®å¯¹è¯æ¡†åï¼Œå³å¯å¯¹é€‰æ‹©åŒºåŸŸè¿›è¡Œæ ¼å¼è®¾ç½®ï¼š</p><p><img alt=VBAï½œä½¿ç”¨å’Œå®šåˆ¶Excelå†…ç½®å¯¹è¯æ¡† onerror=errorimg.call(this); src=https://p3.pstatp.com/large/46d400040f01ab2435b7></p><p>ï¼Endï¼<br></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'VBA','Excel','å†…ç½®'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>