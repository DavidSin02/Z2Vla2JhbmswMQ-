<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>入坑解读 | 什么是SQL注入？ | 极客快訊</title><meta property="og:title" content="入坑解读 | 什么是SQL注入？ - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/dfic-imagehandler/a3af198e-ba1d-4220-8850-5583018f8293"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/23df1bd.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/23df1bd.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/23df1bd.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/23df1bd.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/23df1bd.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/23df1bd.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/23df1bd.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/23df1bd.html><meta property="article:published_time" content="2020-10-29T20:54:42+08:00"><meta property="article:modified_time" content="2020-10-29T20:54:42+08:00"><meta name=Keywords content><meta name=description content="入坑解读 | 什么是SQL注入？"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/23df1bd.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>入坑解读 | 什么是SQL注入？</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>在<strong>OWASP</strong>发布的top10排行榜中<strong>SQL注入漏洞</strong>一直是危害排名极高的漏洞，数据库注入一直是web中一个令人头疼的问题。</p><blockquote class=pgc-blockquote-abstract><p><strong>OWASP，Open Web Application Security Project，开放式Web应用程序安全项目：</strong></p><p>这是一个提供有关计算机和互联网应用程序的公正、实际、有成本效益信息的组织。其目的是协助个人、企业和机构来发现和使用可信赖软件。</p></blockquote><p><strong>一个严重的SQL注入漏洞，可能会直接导致一家公司破产！</strong></p><p>这并不是戏言，其实SQL注入漏洞最主要的形成原因是在进行数据交互中，当前端的数据传入后端进行处理时，由于没有做严格的判断，导致其传入的“数据”在拼接到SQL语句中之后，由于其特殊性，被当作SQL语句的一部分被执行，从而导致数据库受损（被脱库、被删除、甚至整个服务器权限沦陷）。</p><div class=pgc-img><img alt="入坑解读 | 什么是SQL注入？" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/a3af198e-ba1d-4220-8850-5583018f8293><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><strong>一、什么是SQL注入</strong></h1><p>SQL注入是一种<strong>非常常见</strong>的数据库攻击手段，SQL注入漏洞也是网络世界中最普遍的漏洞之一。大家也许都听过某某学长通过攻击学校数据库修改自己成绩的事情，这些学长们一般用的就是SQL注入方法。</p><p><strong>SQL注入</strong>其实就是恶意用户通过在表单中填写包含SQL关键字的数据来使数据库执行非常规代码的过程。简单来说，就是数据「越俎代庖」做了代码才能干的事情。</p><p>这个问题的来源是，SQL数据库的操作是通过SQL语句来执行的，而无论是执行代码还是数据项都必须写在SQL语句之中，这就导致如果我们在数据项中加入了某些SQL语句关键字（比如说SELECT、DROP等等），这些关键字就很可能在数据库写入或读取数据时得到执行。</p><h1 class=pgc-h-arrow-right><strong>二、SQL注入的产生需要满足以下两个条件</strong></h1><p><strong>1、参数用户可控：前端传给后端的参数用户可控。</strong></p><div class=pgc-img><img alt="入坑解读 | 什么是SQL注入？" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/55ad760e61bb496aa4fb8e72282cf0b4><p class=pgc-img-caption></p></div><p><strong>2、参数带入数据库查询：传入的参数拼接到SQL语句中，且带入数据库中查询。</strong></p><div class=pgc-img><img alt="入坑解读 | 什么是SQL注入？" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/75c9b2e4d195475bbae02118ebba4d38><p class=pgc-img-caption>正是这个拼接的过程导致了代码的注入</p></div><p>多言无益，我们拿真实的案例来说话。下面我们先使用SQLite建立一个学生档案表。</p><h4 class=pgc-h-arrow-right><strong>SQL数据库操作示例：</strong></h4><pre><code>import sqlite3连接数据库：conn = sqlite3.connect('test.db')建立新的数据表：conn.executescript('''DROP TABLE IF EXISTS students;       CREATE TABLE students       (id INTEGER PRIMARY KEY AUTOINCREMENT,       name TEXT NOT NULL);''')插入学生信息：students = ['Paul','Tom','Tracy','Lily']for name in students:    query = "INSERT INTO students (name) VALUES ('%s')" % (name)    conn.executescript(query);检视已有的学生信息：cursor = conn.execute("SELECT id, name from students")print('IDName')for row in cursor:    print('{0}{1}'.format(row[0], row[1]))conn.close()</code></pre><p>点击运行按钮，将会打印目前表中的内容。上述程序中我们建立了一个test.db数据库以及一个students数据表，并向表中写入了四条学生信息。</p><p>那么<strong>SQL注入</strong>又是怎么一回事呢？我们尝试再插入一条恶意数据，数据内容就是漫画中的"Robert');DROP TABLE students;--"，看看会发生什么情况。</p><h4 class=pgc-h-arrow-right><strong>SQL数据库注入示例：</strong></h4><pre><code>conn = sqlite3.connect('test.db')</code></pre><pre><code>插入包含注入代码的信息：name = "Robert');DROP TABLE students;--"query = "INSERT INTO students (name) VALUES ('%s')" % (name)conn.executescript(query)检视已有的学生信息：cursor = conn.execute("SELECT id, name from students")print('IDName')for row in cursor:    print('{0}{1}'.format(row[0], row[1]))conn.close()</code></pre><p>你将会发现，运行后，程序没有输出任何数据内容，而是返回一条错误信息：表单students无法找到！</p><p>这是为什么呢？问题就在于我们所插入的数据项中包含SQL关键字DROP TABLE，这两个关键字的意义是从数据库中清除一个表单。</p><p>而关键字之前的Robert');使得SQL执行器认为上一命令已经结束，从而使得危险指令DROP TABLE得到执行。</p><p>也就是说，这段包含DROP TABLE关键字的数据项使得原有的简单的插入姓名信息的SQL语句：</p><pre><code>INSERT INTO students (name) VALUES ('Robert')变为了同时包含另外一条清除表单命令的语句：INSERT INTO students (name) VALUES ('Robert');DROP TABLE students;</code></pre><p>而SQL数据库执行上述操作后，students表单被清除，因而表单无法找到，所有数据项丢失。当然，现在很多网站都有了<strong>防止SQL注入的操作，这里就不过多介绍了。</strong></p><p>关于如何防止防止SQL注入，后期安仔这边会整理，如果你急用的话，可以百度搜索，了解一下。</p><p>SQL注入说白了，就是通过把SQL命令插入到WEB表单提交或输入域名或页面请求的查询字符串，最终达到欺骗服务器执行恶意的SQL命令。</p><h1 class=pgc-h-arrow-right><strong>三、SQL注入类型：</strong></h1><p><strong>1、按照注入点分类：</strong></p><p><strong>（1）数字型注入：</strong>许多网页链接有类似的结构 http://xxx.com/users.php?id=1 基于此种形式的注入，注入点id为数字，一般被叫做数字型注入点，通过这种形式查询出后台数据库信息返回前台展示，可以构造类似以下的SQL语句进行爆破：select *** from 表名 where id=1 and 1=1。</p><div class=pgc-img><img alt="入坑解读 | 什么是SQL注入？" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/851f3c2f9dca46e294bace7298ee8186><p class=pgc-img-caption></p></div><p><strong>（2）字符型注入：</strong>网页链接有类似的结构</p><p>http://xxx.com/users.php?name=admin 这种形式，注入点name为字符串，被称为字符型注入，可以用：select *** from 表名 where name='admin' and 1=1。</p><div class=pgc-img><img alt="入坑解读 | 什么是SQL注入？" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fa03ccd8d55842b0b2505cad9021b2b2><p class=pgc-img-caption></p></div><p><strong>（3）搜索型注入：</strong>主要是指在数据搜索时没有过滤搜索参数，一般在链接地址中有 "keyword=“关键字”"，注入点提交的是SQL语句，select * from 表名 where 字段 like '%关键字%' and '%1%'='%1%'。</p><div class=pgc-img><img alt="入坑解读 | 什么是SQL注入？" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0b08d86d7dff4526bec8d144b6fe5daa><p class=pgc-img-caption></p></div><p><strong>2、按照执行效果来分类：</strong></p><p><strong>（1）基于布尔的盲注：</strong>根据页面返回判断条件真假注入。</p><p><strong>（2）基于时间的盲注：</strong>即不能根据页面返回内容判断任何信息，用条件语句查看时间延迟语句是否执行（即页面返回时间是否增加）来判断。</p><p><strong>（3）基于报错的注入：</strong>即页面会返回错误信息，或者把注入的语句的结果直接返回在页面中。</p><ul><li>单引号</li><li>双引号</li><li>基于数字型注入</li></ul><p><strong>（4）联合查询注入：</strong>可以使用union情况下注入。</p><p></p><h1 class=pgc-h-arrow-right><strong>四、SQL注入常见的绕过方法</strong></h1><p>（1）大小写关键词绕过(UNiOn)</p><p>（2）双写关键词绕过(ununionion)</p><p>（3）编码绕过（base64、url）</p><p>（4）内联注释绕过（/*! Union */）</p><p><br></p><h1 class=pgc-h-arrow-right><strong>SQL注入工具推荐</strong></h1><p>当掌握了SQL注入的原理及注入方法后就可以尝试用工具注入了，手动注入成本较高。推荐工具SQLmap</p><p>工具下载地址：<u>https://github.com/sqlmapproject/sqlmap</u></p><p>作为专注“实战”技术分享的信息安全教育平台，安界网为大家提供SQL注入以及文件上传的修炼课程，本课程主要讲解了SQL注入和文件上传两个漏洞，这两个漏洞在OWASP TOP 10中排名靠前，是危害极大的两个漏洞，希望通过本次课程，大家可以更快速的GetSQL注入的基本套路以及防御方法。</p><div class=tt-column-card data-content='{"url":"","content":"","thumb_url":"http://p0.pstatp.com/large/pgc-image/4beef859ef454aa3a969b91980e2bda4","title":"SQL注入&文件上传深入修炼课程","author_description":"安界","price":49.9,"share_price":3.99,"sold":0,"column_id":"6837311901727211784","new_thumb_url":"http://sf6-ttcdn-tos.pstatp.com/img/pgc-image/4beef859ef454aa3a969b91980e2bda4"}'><p class=column-placeholder></p></div><p>如果你想跟我讨论更多关于SQL注入的问题，欢迎私信回复【入群】，加入安界网络安全大咖群，跟我一起讨论。</p><p>我是安仔，一名刚入职网络安全圈的网安萌新，欢迎关注我，跟我一起成长；</p><p>小白入行网络安全、混迹安全行业找大咖，以及更多成长干货资料，欢迎关注<a class=tteditor-forum data-concern-id=1667099819060248 data-id=1667099819060248 data-name=安界网人才培养计划 data-uid>#安界网人才培养计划#</a>、<a class=tteditor-forum data-concern-id=1630858953410567 data-id=1630858953410567 data-name=网络安全在我身边 data-uid>#网络安全在我身边#</a>、<a class=tteditor-mention data-concern-id data-id data-name=安界人才培养计划 data-uid=3443310982085820>@安界人才培养计划</a>。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'入坑','解读','什么'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>