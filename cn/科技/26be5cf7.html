<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>什么是核心交换机的链路聚合、冗余、堆叠、热备份 | 极客快訊</title><meta property="og:title" content="什么是核心交换机的链路聚合、冗余、堆叠、热备份 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/e7b9b834cb27438bb9fd4fd077fc8075"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/26be5cf7.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/26be5cf7.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/26be5cf7.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/26be5cf7.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/26be5cf7.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/26be5cf7.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/26be5cf7.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/26be5cf7.html><meta property="article:published_time" content="2020-11-14T21:06:12+08:00"><meta property="article:modified_time" content="2020-11-14T21:06:12+08:00"><meta name=Keywords content><meta name=description content="什么是核心交换机的链路聚合、冗余、堆叠、热备份"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/26be5cf7.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>什么是核心交换机的链路聚合、冗余、堆叠、热备份</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>我们前面曾多次提到对于核心交换机的选择，大家可能对于核心交换机的背板带宽、包转发率都已经有所了解，然而核心交换机主要选择并不止这些参数，还需要看链路聚合、冗余、堆叠、热备份等这些功能，这些功能非常重要，决定了核心交换机在实际应用中的性能、效率、稳定性等，我们一起来了解下。</p><p class=ql-align-justify><br></p><p class=ql-align-center><strong>一、链路聚合</strong></p><p>是将两个或更多数据信道结合成一个单个的信道，该信道以一个单个的更高带宽的逻辑链路出现。链路聚合一般用来连接一个或多个带宽需求大的设备，例如连接骨干网络的服务器或服务器群。它可以用于扩展链路带宽，提供更高的连接可靠性。</p><p class=ql-align-justify><strong>1、举例</strong></p><p>公司有2层楼，分别运行着不同的业务，本来两个楼层的网络是分开的，但都是一家公司难免会有业务往来，这时我们就可以打通两楼之前的网络，使具有相互联系的部门之间高速通信。</p><p>如下图：</p><div class=pgc-img><img alt=什么是核心交换机的链路聚合、冗余、堆叠、热备份 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e7b9b834cb27438bb9fd4fd077fc8075><p class=pgc-img-caption></p></div><p>如上图所示，SwitchA和SwitchB通过以太链路分别都连接VLAN10和VLAN20的网络，且SwitchA和SwitchB之间有较大的数据流量。</p><p>用户希望SwitchA和SwitchB之间能够提供较大的链路带宽来使相同VLAN间互相通信。同时用户也希望能够提供一定的冗余度，保证数据传输和链路的可靠性。</p><p>创建Eth-Trunk接口并加入成员接口，实现增加链路带宽，2台交换机分别配置Eth-Trunk1 分别将需要通信的3条线路的端口加入Eth-Trunk1，设置端口trunk， 允许相应的vlan通过；这样两楼的网络就可以正常通信了。</p><p><strong>2、实现配置步骤：</strong></p><p><strong>在SwitchA上创建Eth-Trunk1并配置为LACP模式。SwitchB配置过程与SwitchA类似，不再赘述</strong></p><p>&lt;HUAWEI> system-view</p><p>[HUAWEI] sysname SwitchA</p><p>[SwitchA] interface eth-trunk 1</p><p>[SwitchA-Eth-Trunk1] mode lacp</p><p>[SwitchA-Eth-Trunk1] quit</p><p><strong>配置SwitchA上的成员接口加入Eth-Trunk。SwitchB配置过程与SwitchA类似，不再赘述</strong></p><p>[SwitchA] interface gigabitethernet 0/0/1</p><p>[SwitchA-GigabitEthernet0/0/1] eth-trunk 1</p><p>[SwitchA-GigabitEthernet0/0/1] quit</p><p>[SwitchA] interface gigabitethernet 0/0/2</p><p>[SwitchA-GigabitEthernet0/0/2] eth-trunk 1</p><p>[SwitchA-GigabitEthernet0/0/2] quit</p><p>[SwitchA] interface gigabitethernet 0/0/3</p><p>[SwitchA-GigabitEthernet0/0/3] eth-trunk 1</p><p>[SwitchA-GigabitEthernet0/0/3] quit</p><p><strong>在SwitchA上配置系统优先级为100，使其成为LACP主动端</strong></p><p>[SwitchA] lacp priority 100</p><p><strong>在SwitchA上配置活动接口上限阈值为2</strong></p><p>[SwitchA] interface eth-trunk 1</p><p>[SwitchA-Eth-Trunk1] max active-linknumber 2</p><p>[SwitchA-Eth-Trunk1] quit</p><p><strong>在SwitchA上配置接口优先级确定活动链路</strong></p><p>[SwitchA] interface gigabitethernet 0/0/1</p><p>[SwitchA-GigabitEthernet0/0/1] lacp priority 100</p><p>[SwitchA-GigabitEthernet0/0/1] quit</p><p>[SwitchA] interface gigabitethernet 0/0/2</p><p>[SwitchA-GigabitEthernet0/0/2] lacp priority 100</p><p>[SwitchA-GigabitEthernet0/0/2] quit</p><p class=ql-align-center><strong>二、链路冗余</strong></p><p>为了保持网络的稳定性，在多台交换机组成的网络环境中，通常都使用一些备份连接，以提高网络的效率、稳定性，这里的备份连接也称为备份链路或者冗余链路。</p><p class=ql-align-justify><br></p><p class=ql-align-center><strong>三、交换机的堆叠</strong></p><p>通过专有的堆叠电缆连接起来，可将多台交换机堆叠成一台逻辑交换机。该逻辑交换机中的所有交换机共享相同的配置信息和路由信息。当向逻辑交换机增加和减少单体交换机时不会影响其性能。</p><p class=ql-align-justify><br></p><p class=ql-align-justify>叠加的交换机之间通过两条环路连接起来。交换机的硬件负责将数据包在双环路上做负载均衡。环路在这里充当了这个大的逻辑交换机的背板的角色，在双环路都正常工作时，数据包在这台逻辑交换机上的传输率为32Gbps。</p><p class=ql-align-justify>当一个数据帧需要传输时，交换机的软件会进行计算看哪条环路更可用，然后数据帧会被送到该环路上。如果一条堆叠电缆出故障，故障两端的交换机都会侦测到该故 障，并将受影响的环路断开，而逻辑交换机仍然可以以单环的状态工作，此时的数据包通过率为16Gbps。交换机的堆叠采用菊花链方式，连接的方式参考下图。</p><div class=pgc-img><img alt=什么是核心交换机的链路聚合、冗余、堆叠、热备份 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/20935a70858e4302a20bf6955f7692c5><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify>堆叠增加交换机端口与带宽的稳定性。</p><p class=ql-align-center><strong>四、热备份（HSRP)</strong></p><p class=ql-align-justify><br></p><p>核心交换机是整个网络的核心和心脏，如果核心交换机发生致命性的故障，将导致本地网络的瘫痪，所造成的损失也是难以估计的。所以我们在选择核心交换机时，经常会看到有的核心交换机具有堆叠或热备份等功能。</p><p class=ql-align-justify><br></p><p class=ql-align-justify>对核心交换机采用热备份是提高网络可靠性的必然选择。在一个核心交换机完全不能工作的情况下，它的全部功能便被系统中的另一个备份路由器完全接管，直至出现问题的路由器恢复正常，这就是热备份路由协议.</p><p class=ql-align-justify>实现HSRP的条件是系统中有多台核心交换机，它们组成一个“热备份组”，这个组形成一个虚拟路由器。在任意时刻，一个组内只有一个路由器是活动的，并由它来转发数据包，如果活动路由器发生了故障，将选择一个备份路由器来替代活动路由器，但是在本网络内的主机看来，虚拟路由器没有改变。所以主机仍然保持连接，没有受到故障的影响，这样就较好地解决了核心交换机切换的问题。</p><p class=ql-align-justify>为了减少网络的数据流量，在设置完活动核心交换机和备份核心交换机之后，只有活动核心交换机和备份核心交换机定时发送HSRP报文。如果活动核心交换机失效，备份核心交换机将接管成为活动核心交换机。如果备份核心交换机失效或者变成了活跃核心交换机，将由另外的核心交换机被选为备份核心交换机。</p><p class=ql-align-justify><strong>1、当某台接入层交换机到主核心交换机的线路出现故障，切换至备机，数据流走向</strong></p><div class=pgc-img><img alt=什么是核心交换机的链路聚合、冗余、堆叠、热备份 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/57149d49b7ba4dab995507c3d70e6acc><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify>当接入层交换机1上联至核心交换机A的数据链路出现故障，导致接入层交换机1的数据链路切换至核心交换机B，但在切换期间接入层交换机1分丢6个数据包，如上图所示。</p><p class=ql-align-justify></p><p class=ql-align-justify>当服务器与核心交换机A之间主链路出现故障（如线路、网卡等），服务器主网卡切换至备用网卡上时，会丢6个数据包，但当主链路恢复以后，服务器会自动从备用网卡切换至主网卡，而这次切换时数据包不会丢失。具体终端访问服务器的数据流走向如下图。</p><div class=pgc-img><img alt=什么是核心交换机的链路聚合、冗余、堆叠、热备份 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/383865cd75ad4e01a697f03abe56974c><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'什么','交换机','链路'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>