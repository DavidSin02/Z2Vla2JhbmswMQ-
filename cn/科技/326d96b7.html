<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>大厂是怎么做移动端适配的 | 极客快訊</title><meta property="og:title" content="大厂是怎么做移动端适配的 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/dfic-imagehandler/a10f1365-be46-43af-a2b3-c2e9eac356a1"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/326d96b7.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/326d96b7.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/326d96b7.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/326d96b7.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/326d96b7.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/326d96b7.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/326d96b7.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/326d96b7.html><meta property="article:published_time" content="2020-10-29T21:10:52+08:00"><meta property="article:modified_time" content="2020-10-29T21:10:52+08:00"><meta name=Keywords content><meta name=description content="大厂是怎么做移动端适配的"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/326d96b7.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>大厂是怎么做移动端适配的</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><br></p><div class=pgc-img><img alt=大厂是怎么做移动端适配的 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/a10f1365-be46-43af-a2b3-c2e9eac356a1><p class=pgc-img-caption></p></div><p class=pgc-end-literature>作者：子非鱼</p><p class=pgc-end-literature>转发链接：https://mp.weixin.qq.com/s/uQ8c2Z6GJr4eyH3kidZt3g</p><h1 class=pgc-h-arrow-right>前言</h1><p>随着Web技术的革新，移动端适配方案也在不断的变化，网上有很多关于移动端适配的文章，说什么rem布局已经过时，vm适配才是最好的适配方案。有这种理解的同学是错误的，任何适配方案都有它的优缺点，要结合自己的使用场景来进行选择。</p><p>前面小编也发布了几篇关于移动适配的文章，一起来复习一下：</p><p>《<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6808803145490104844/?group_id=6808803145490104844" rel="noopener noreferrer" target=_blank>手把手教你绕过移动端适配大坑</a>》</p><p>《<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6804711145329394189/?group_id=6804711145329394189" rel="noopener noreferrer" target=_blank>吃透移动端 1px｜从基本原理到开源解决方案</a>》</p><p>《<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6804714118545670660/?group_id=6804714118545670660" rel="noopener noreferrer" target=_blank>吃透移动端 H5 与 Hybrid｜实践踩坑12种问题汇总</a>》</p><p>文章先讲一下几种常见的适配方案，然后再看看几个大厂（<strong>腾讯、京东、网易、小红书、微博、美团、B站、搜狐、饿了么、携程、大众点评、知乎、拍拍贷、陆金所</strong>）的移动端页面都采用了什么样的适配方案，最后讨论下各个适配方法的适用场景和优缺点，如果有不对之处，希望能得到大佬们的指正。</p><div class=pgc-img><img alt=大厂是怎么做移动端适配的 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7f4b75d16ce2492f9510d7d45095bd8e><p class=pgc-img-caption></p></div><p><br></p><h1 class=pgc-h-arrow-right>移动端适配的重新思考</h1><p><br></p><p><strong>1</strong></p><h1 class=pgc-h-arrow-right>移动端适配就是用rem或vw ？</h1><p>并不是所有场景都适合用用rem或vw进行适配。</p><ul><li>vw和rem适配的本质是等比例缩放，让页面在不同屏幕尺寸下有类似于矢量图片缩放的效果，保证了页面元素之间的尺寸缩放比例和位置。</li><li>这两种适配方案适合视觉组件种类比较多，视觉设计对元素位置的相对关系依赖较强的移动端页面，基本上大部分页面都可以用这两种方案进行适配。</li><li>但对于文本内容较多，我们希望引导用户沉浸在更多的内容而不是更大的内容的，这种等比例缩放的方案并不能满足要求，我推荐直接使用px结合flex等布局方式进行适配。</li></ul><p><strong>2</strong></p><h1 class=pgc-h-arrow-right>rem该抛弃了，使用vw不香么 ？</h1><p>vm适配不是万能的，最好与rem配合使用</p><ul><li>当初之所以使用rem的方案流行开来正是因为在那时viewport units的浏览器支持程度不甚理想(IOS 8+, Android 4.4+ 参见viewport units的caniuse）。而相比较之下rem就好多了(IOS 4.1+, Android 2.1+ 参见caniuse)，所以对于vw，在当时的大环境下前端想说爱你不容易。</li><li>随着前端技术的革新，最主要是各大浏览器厂商的给力，除Opera Mini全版本和IE低版本不支持之外，其他的浏览器基本上都已经支持vw了，开始有人或者有团队在探讨论在实际项目中的使用。虽然大漠老师在《再聊移动端页面的适配》一文中提出的vw方案中使用viewport-units-buggyfill库进行兼容的做法，我个人更是不建议，由于这个库使用了css content属性进行兼容处理，官方文档中就指出了对部分浏览器的img标签有影响 ，需要全局引入一条css规则。且对于需要正常使用content的情况（如：图标字体）也会引起不可避免的冲突，另外也不支持伪元素的兼容。所以从我个人的角度来说，如果你一定要问我使用怎样的vw适配方案，我会推荐给你上述两种vw + rem的方案。</li><li>虽然采用vw适配后的页面效果很好，但是它是利用视口单位实现的布局，依赖视口大小而自动缩放，无论视口过大还是过小，它也随着视口过大或者过小，失去了最大最小宽度的限制。</li></ul><p><br></p><h1 class=pgc-h-arrow-right>移动端适配方案</h1><p><strong>1</strong></p><h1 class=pgc-h-arrow-right>rem适配</h1><p>rem适配的本质是布局等比例的缩放，通过动态设置html的font-size来改变rem的大小。</p><h1 class=pgc-h-arrow-right>viewport 配置</h1><pre><code>1&lt;!-- dpr = 1--&gt;2&lt;meta name="viewport" content="width=device-width; initial-scale=1; maximum-scale=1; minimum-scale=1; user-scalable=no;"&gt;</code></pre><p>上面把scale设置成固定1倍的视口的大小，也可以根据dpr的值缩放viewport，如下：</p><pre><code> 1//下面是根据设备dpr设置viewport 2var dpr = window.devicePixelRatio || 1 3var scale = 1 / dpr 4 5viewport.setAttribute( 6    "content", 7    "width=device-width" + 8    ",initial-scale=" + 9     scale +10    ", maximum-scale=" +11     scale +12    ", minimum-scale=" +13     scale +14    ", user-scalable=no"15)</code></pre><p>有几点要注意</p><ul><li>viewport标签只对移动端浏览器有效，对PC端浏览器是无效的。</li><li>当缩放比例为100%时，逻辑像素 = CSS 像素宽度 = 理想视口的宽度 = 布局视口的宽度。</li><li>单独设置initial-scale或 width都会有兼容性问题，所以设置布局视口为理想视口的最佳方法是同时设置这两个属性。</li><li>即使设置了user-scalable = no，在Android Chrome浏览器中也可以强制启用手动缩放。</li></ul><h1 class=pgc-h-arrow-right>设置 rem 基准值</h1><p>核心代码为如下</p><pre><code>1// set 1rem = 逻辑像素（设备独立像素） / 102function setRemUnit () {3    var rem = document.documentElement.clientWidth / 104    // 375/10 = 37.55    docEl.style.fontSize = rem + 'px'6}7setRemUnit()</code></pre><p><br></p><ul><li>将html节点的font-size设置为页面clientWidth(布局视口)的1/10，即：1rem = 布局视口的1/10</li><li>在iphone6下：docEl.clientWidth=设备独立像素（逻辑像素）= 布局视口宽度 = 理想窗口宽度 = 375。此时：1rem = 375/10 +px = 37.5px</li></ul><h1 class=pgc-h-arrow-right>postcss-pxtorem将单位转化为 rem</h1><pre><code> 1module.exports = { 2  plugins: { 3    'autoprefixer': { 4      browsers: ['Android &gt;= 4.0', 'iOS &gt;= 7'] 5    }, 6    'postcss-pxtorem': { 7        rootValue: 37.5, 8        propList: ['*', '!font-size'], 9        selectorBlackList: ['van-circle__layer', 'ignore'],10    }11  }12}</code></pre><p><br></p><ul><li>rootValue是转换px的基准值，参考设备iPhone6，设备宽度375px规则：基准值=当前设备宽度的1/10</li><li>基准值设置代码中，在iPhone6设备设置的html—>font-size 也为37.5px</li><li>但是设计稿尺寸750px大小，所以量取设计稿量尺寸的时候需要除以2</li></ul><h1 class=pgc-h-arrow-right>rem布局的缺点</h1><p>在响应式布局中，必须通过js来动态控制根元素font-size的大小，也就是说css样式和js代码有一定的耦合性，且必须将改变font-size的代码放在css样式之前。</p><p><strong>2</strong></p><p><strong>vw适配</strong></p><p>vw是基于Viewport视窗的长度单位，这里的视窗（Viewport）指的就是浏览器可视化的区域，而这个可视区域是window.innerWidth/window.innerHeight的大小，用图简单的示意如下</p><div class=pgc-img><img alt=大厂是怎么做移动端适配的 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/b35d307b368941ed9d738b4b48cff847><p class=pgc-img-caption></p></div><p>在CSS Values and Units Module Level 3中和Viewport相关的单位有四个，分别为vw、vh、vmin和vmax。</p><ul><li>vw：是Viewport's width的简写,1vw等于window.innerWidth的1%</li><li>vh：和vw类似，是Viewport's height的简写，1vh等于window.innerHeihgt的1%</li><li>vmin：vmin的值是当前vw和vh中较小的值</li><li>vmax：vmax的值是当前vw和vh中较大的值</li></ul><div class=pgc-img><img alt=大厂是怎么做移动端适配的 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9efed15994ab4b05ad63e742de40bb88><p class=pgc-img-caption></p></div><p>如果设计稿使用750px宽度，则100vw = 750px，即1vw = 7.5px。那么我们可以根据设计图上的px值直接转换成对应的vw值。如果不想自己计算，我们可以使用PostCSS的插件postcss-px-to-viewport，让我们可以直接在代码中写px。</p><pre><code> 1{ 2    loader: 'postcss-loader', 3    options: { 4        plugins: ()=&gt;[ 5            require('autoprefixer')({ 6                browsers: ['last 5 versions'] 7            }), 8            require('postcss-px-to-viewport')({ 9                viewportWidth: 375, //视口宽度（数字)10                viewportHeight: 1334, //视口高度（数字）11                unitPrecision: 3, //设置的保留小数位数（数字）12                viewportUnit: 'vw', //设置要转换的单位（字符串）13                selectorBlackList: ['.ignore', '.hairlines'], //不需要进行转换的类名（数组）14                minPixelValue: 1, //设置要替换的最小像素值（数字）15                mediaQuery: false//允许在媒体查询中转换px（true/false）16            })17        ]18}</code></pre><p><br></p><p><strong>3</strong></p><p><strong>搭配vw和rem</strong></p><ul><li>给根元素大小设置随着视口变化而变化的vw单位，这样就可以实现动态改变其大小。</li><li>限制根元素字体大小的最大最小值，配合body加上最大宽度和最小宽度。</li></ul><pre><code> 1// rem 单位换算：定为 75px 只是方便运算，750px-75px、640-64px、1080px-108px，如此类推 2$vm_fontsize: 75; // iPhone 6尺寸的根元素大小基准值 3@function rem($px) { 4     @return ($px / $vm_fontsize ) * 1rem; 5} 6// 根元素大小使用 vw 单位 7$vm_design: 750; 8html { 9    font-size: ($vm_fontsize / ($vm_design / 2)) * 100vw; 10    // 同时，通过Media Queries 限制根元素最大最小值11    @media screen and (max-width: 320px) {12        font-size: 64px;13    }14    @media screen and (min-width: 540px) {15        font-size: 108px;16    }17}18// body 也增加最大最小宽度限制，避免默认100%宽度的 block 元素跟随 body 而过大过小19body {20    max-width: 540px;21    min-width: 320px;22}</code></pre><p><br></p><p><strong>4</strong></p><p><strong>px 适配</strong></p><p>就像开篇提到的，并不是说移动端就一定要使用相对长度单位，传统的响应式布局依然是很好的选择，尤其在新闻，社区等可阅读内容较多的场景直接使用px单位可以营造更好地体验。px方案可以让大屏幕手机展示出更多的内容，更符合人们的阅读习惯。</p><div class=pgc-img><img alt=大厂是怎么做移动端适配的 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/08e60ecbd95944728d6d5bd6a55110c2><p class=pgc-img-caption></p></div><p><strong>互联网大厂的适配调研</strong></p><p><br></p><p><strong>1</strong></p><p><strong>rem适配例子</strong></p><h1 class=pgc-h-arrow-right>1.1 固定1倍vieport</h1><p>注：下面描述的rem与px的对应关系是在设备独立像素为375px（iPhone6/7/8）情况下。</p><p><strong>拍拍贷m站首页（https://m.ppdai.com/）</strong></p><ul><li>1rem = 20px</li><li>最大基准值为40px</li><li>限制页面宽度750px</li></ul><p><strong>小红书（https://www.xiaohongshu.com/）</strong></p><ul><li>1rem = 50px</li><li>最大基准值为60px</li><li>字体和页面都进行缩放</li><li>配合media query，限制body的最大宽度</li></ul><pre><code>1@media screen and (min-width: 768px)2body {3    width: 450PX!important;4}</code></pre><p><strong>微博（https://m.weibo.cn/）</strong></p><ul><li>字体和页面都进行缩放</li><li>基准值是根据media query生成的</li></ul><h1 class=pgc-h-arrow-right>1.2 可缩放vieport</h1><p>下面描述的rem与px的对应关系是在设备独立像素为375px（iPhone6/7/8）、viewport scale 0.5的情况下。</p><p><strong>美团（http://i.meituan.com/）</strong></p><ul><li>1rem = 100px</li></ul><p><strong>B站主站（https://m.bilibili.com/index.html）</strong></p><ul><li>1rem = 46.875px</li></ul><p><strong>搜狐（https://m.sohu.com/）</strong></p><ul><li>1rem = 75px</li></ul><p><br></p><p><strong>2</strong></p><h1 class=pgc-h-arrow-right>vm适配例子</h1><p><strong>拍拍贷借款页（https://ld.ppdai.com/loan/mobile_base/373/25999?）</strong></p><ul><li>不限制页面宽度</li><li>无兼容性处理，个人不推荐</li></ul><p><br></p><p><strong>3</strong></p><h1 class=pgc-h-arrow-right>vm+rem适配例子</h1><p><strong>京东（https://m.jd.com/）</strong></p><ul><li>固定vieport，元素布局上使用rem单位</li><li>html元素的font-size使用vw + px fallback的形式</li><li>当页面超过一定宽度时，根据media query设置font-size为px，优先级高于vw。</li><li>限制页面宽度为1080px</li></ul><div class=pgc-img><img alt=大厂是怎么做移动端适配的 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/df898113620442269993241946c3e305><p class=pgc-img-caption></p></div><p>image.png</p><div class=pgc-img><img alt=大厂是怎么做移动端适配的 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/aaadcafb630941d1a977bf7c78d9e330><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>网易（https://3g.163.com/touch/）</h1><ul><li>固定viewport，元素布局上使用rem单位</li><li>html元素的font-size使用vw + px fallback的形式</li><li>使用media query设置根元素font-size中px的值</li><li>当页面超过一定宽度时，px单位的优先级高于vw</li><li>限制布局宽度为768px</li></ul><div class=pgc-img><img alt=大厂是怎么做移动端适配的 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/71ba04dc4f944cd390ca21c46bd570e6><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>饿了么（https://h5.ele.me/msite/）</h1><ul><li>对viewport进行了缩放</li><li>html元素的font-size依然由px指定</li><li>具体元素的布局上使用vw + rem fallbak的形式</li><li>没有限制布局宽度</li><li>css构建过程需要插件支持，可参考这个插件：pandaGao/stylus-px-to-relative-unit</li></ul><div class=pgc-img><img alt=大厂是怎么做移动端适配的 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dcac95366dd14c01b84bb33ae7b53bd2><p class=pgc-img-caption></p></div><p><br></p><p><strong>4</strong></p><h1 class=pgc-h-arrow-right>px 方案例子</h1><p><strong>携程（https://m.ctrip.com/html5/）</strong></p><ul><li>固定1倍vieport</li><li>布局方案：px+flex+百分比</li><li>设置body的最大宽度为max-width: 540px;</li></ul><p><strong>大众点评（https://m.dianping.com/）</strong></p><ul><li>元素较丰富，采用px+flex布局，适配效果很好</li></ul><p><strong>知乎（https://www.zhihu.com/）</strong></p><ul><li>追求阅读体验的场景，使用px布局。</li></ul><p><strong>腾讯（https://xw.qq.com/）</strong></p><ul><li>首页主要内容是新闻，为了更好的阅读体验，使用px布局。</li></ul><p><strong>陆金所（https://m.lu.com/）</strong></p><ul><li>:root {font-size:10px；}，并没有根据屏幕的大小来设置不同的font-size</li><li>存在问题：布局页面设成1rem时候，在chrome浏览器上任然12px，并不是10px</li><li>布局中虽然用了rem单位，但其实还是绝对单位方案</li><li>可能希望用户在大屏手机上能看到更多内容吧</li></ul><p><br></p><h1 class=pgc-h-arrow-right>总结</h1><ul><li>新闻，社区等可阅读内容较多的场景：px+flex+百分比</li><li>对视觉组件种类较多，视觉设计对元素位置的相对关系依赖较强的移动端页面：vw + rem</li></ul><p>以上只是自己的拙见以及自己这一两年有关于移动端适配的一些探索，如果有不对之处，还请各路大神指正。</p><p class=pgc-end-literature>作者：子非鱼</p><p class=pgc-end-literature>转发链接：https://mp.weixin.qq.com/s/uQ8c2Z6GJr4eyH3kidZt3g</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'大厂','怎么','移动端'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>