<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>数据库SQL最常用语句 | 极客快訊</title><meta property="og:title" content="数据库SQL最常用语句 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/332cb941.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/332cb941.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/332cb941.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/332cb941.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/332cb941.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/332cb941.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/332cb941.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/332cb941.html><meta property="article:published_time" content="2020-11-14T21:04:12+08:00"><meta property="article:modified_time" content="2020-11-14T21:04:12+08:00"><meta name=Keywords content><meta name=description content="数据库SQL最常用语句"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/332cb941.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>数据库SQL最常用语句</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>数据库最常用语句</h1><p></p><p>　1、复制表(只复制结构,源表名：a 新表名：b)</p><p>　　法一：select * into b from a where 1&lt;>1</p><p>　　法二：select top 0 * into b from a</p><p>　　2、拷贝表(拷贝数据,源表名：a 目标表名：b)</p><p>insert into b(a, b, c) select d,e,f from b;</p><p>　　3、跨数据库之间表的拷贝(具体数据使用绝对路径)</p><p>insert into b(a, b, c) select d,e,f from b in ‘具体数据库’ where 条件</p><p>　　例子：..from b in '"&Server.MapPath(&#34;.")&&#34;\data.mdb" &&#34;' where..</p><p>　　4、子查询(表名1：a 表名2：b)</p><p>select a,b,c from a where a IN (select d from b ) 或者: select a,b,c from a where a IN (1,2,3)</p><p>　　5、显示文章、提交人和最后回复时间</p><p>select a.title,a.username,b.adddate from table a,(select max(adddate) adddate from table where table.title=a.title) b</p><p>6、外连接查询(表名1：a 表名2：b)</p><p>select a.a, a.b, a.c, b.c, b.d, b.f from a LEFT OUT JOIN b ON a.a = b.c</p><p>　　7、在线视图查询(表名1：a )</p><p>select * from (SELECT a,b,c FROM a) T where t.a > 1;</p><p>　　8、between的用法,between限制查询数据范围时包括了边界值,not between不包括</p><p>select * from table1 where time between time1 and time2</p><p>select a,b,c, from table1 where a not between 数值1 and 数值2</p><p>　　9、in 的使用方法</p><p>select * from table1 where a [not] in (‘值1’,’值2’,’值4’,’值6’)</p><p>　　10、两张关联表，删除主表中已经在副表中没有的信息</p><p>delete from table1 where not exists ( select * from table2 where table1.field1=table2.field1 )</p><p>　　11、四表联查问题：</p><p>select * from a left inner join b on a.a=b.b right inner join c on a.a=c.c inner join d on a.a=d.d where .....</p><p>　　12、日程安排提前五分钟提醒</p><p>SQL: select * from 日程安排 where datediff('minute',f开始时间,getdate())>5</p><p>　　13、一条sql 语句搞定数据库分页</p><p>select top 10 b.* from (select top 20 主键字段,排序字段 from 表名 order by 排序字段 desc) a,表名 b where b.主键字段 = a.主键字段 order by a.排序字段</p><p>　　14、前10条记录</p><p>select top 10 * form table1 where 范围</p><p>　　15、选择在每一组b值相同的数据中对应的a最大的记录的所有信息(类似这样的用法可以用于论坛每月排行榜,每月热销产品分析,按科目成绩排名,等等.)</p><p>select a,b,c from tablename ta where a=(select max(a) from tablename tb where tb.b=ta.b)</p><p>　　16、包括所有在 TableA 中但不在 TableB和TableC 中的行并消除所有重复行而派生出一个结果表</p><p>(select a from tableA ) except (select a from tableB) except (select a from tableC)</p><p>　　17、随机取出10条数据</p><p>select top 10 * from tablename order by newid()</p><p>　　18、随机选择记录</p><p>select newid()</p><p>　　19、删除重复记录</p><p>Delete from tablename where id not in (select max(id) from tablename group by col1,col2,...)</p><p>　　20、列出数据库里所有的表名</p><p>select name from sysobjects where type='U'</p><p>21、列出表里的所有的</p><p>select name from syscolumns where id=object_id('TableName')</p><p>+(1)数据记录筛选：<br>sql="select*from数据表where字段名=字段值orderby字段名[desc]"<br>sql="select*from数据表where字段名like'%字段值%'orderby字段名[desc]"<br>sql="select top10* from数据表where字段名order by字段名[desc]"<br>sql="select*from数据表where字段名in('值1','值2','值3')"<br>sql="select*from数据表where字段名between值1and值2"<br>(2)更新数据记录：<br>sql="update数据表set字段名=字段值where条件表达式"<br>sql="update数据表set字段1=值1,字段2=值2……字段n=值n<br>where条件表达式"<br>(3)删除数据记录：<br>sql="delete from数据表where条件表达式"<br>sql="delete from数据表"(将数据表所有记录删除)<br>(4)添加数据记录：<br>sql="insert into数据表(字段1,字段2,字段3…) values(值1,值2,值3…)"<br>sql="insert into目标数据表<br>Select * from源数据表"(把源数据表的记录添加到目标数据表)<br>(5)数据记录统计函数：<br>AVG(字段名)得出一个表格栏平均值<br>COUNT(*|字段名)对数据行数的统计或对某一栏有值的数据行数统计<br>MAX(字段名)取得一个表格栏最大的值<br>MIN(字段名)取得一个表格栏最小的值<br>SUM(字段名)把数据栏的值相加<br>引用以上函数的方法：<br>sql="select sum(字段名) as别名from数据表 where条件表达式"<br>setrs=conn.excute(sql)<br>用rs("别名")获取统的计值，其它函数运用同上。<br>(5)数据表的建立和删除：<br>CREATE TABLE数据表名称(字段1类型1(长度),字段2类型2(长度)……)<br>例：CREATE TABLE tab01 (name varchar (50), datetime defaultnow ())<br>DROPTABLE数据表名称(永久性删除一个数据表)<br>4.记录集对象的方法：<br>rs.move next将记录指针从当前的位置向下移一行<br>rs.move previous将记录指针从当前的位置向上移一行<br>rs.move first将记录指针移到数据表第一行<br>rs.move last将记录指针移到数据表最后一行<br>rs.absoluteposition=N将记录指针移到数据表第N行<br>rs.absolutepage=N将记录指针移到第N页的第一行<br>rs.pagesize=N设置每页为N条记录<br>rs.pagecount根据pagesize的设置返回总页数<br>rs.recordcount返回记录总数<br>rs.bof返回记录指针是否超出数据表首端，true表示是，false为否<br>rs.eof返回记录指针是否超出数据表末端，true表示是，false为否<br>rs.delete删除当前记录，但记录指针不会向下移动<br>rs.add new添加记录到数据表末端<br>rs.update更新数据表记录</p><p>SQL语句的添加、删除、修改虽然有如下很多种方法，但在使用过程中还是不够用，不知是否有高手把更多灵活的使用方法贡献出来？</p><p>添加、删除、修改使用db.Execute(Sql)命令执行操作<br>╔----------------╗<br>☆ 数据记录筛选 ☆<br>╚----------------╝<br>注意：单双引号的用法可能有误(没有测试)</p><p>Sql = "Select Distinct 字段名 From 数据表"<br>Distinct函数，查询数据库存表内不重复的记录</p><p>Sql = "Select Count(*) From 数据表 where 字段名1>#18:0:0# and 字段名1&lt; #19:00# "<br>count函数,查询数库表内有多少条记录，“字段名1”是指同一字段<br>例：<br>set rs=conn.execute("select count(id) as idnum from news")<br>response.write rs("idnum")</p><p>sql="select * from 数据表 where 字段名 between 值1 and 值2"<br>Sql="select * from 数据表 where 字段名 between #2003-8-10# and #2003-8-12#"<br>在日期类数值为2003-8-10 19:55:08 的字段里查找2003-8-10至2003-8-12的所有记录，而不管是几点几分。</p><p>select * from tb_name where datetime between #2003-8-10# and #2003-8-12#<br>字段里面的数据格式为：2003-8-10 19:55:08，通过sql查出2003-8-10至2003-8-12的所有纪录，而不管是几点几分。</p><p>Sql="select * from 数据表 where 字段名=字段值 order by 字段名 [desc]"</p><p>Sql="select * from 数据表 where 字段名 like '%字段值%' order by 字段名 [desc]"<br>模糊查询</p><p>Sql="select top 10 * from 数据表 where 字段名 order by 字段名 [desc]"<br>查找数据库中前10记录</p><p>Sql="select top n * form 数据表 order by newid()"<br>随机取出数据库中的若干条记录的方法<br>top n，n就是要取出的记录数</p><p>Sql="select * from 数据表 where 字段名 in ('值1','值2','值3')"</p><p><br>☆ 添加数据记录 ☆<br>sql="insert into 数据表 (字段1,字段2,字段3 …) valuess (值1,值2,值3 …)"</p><p>sql="insert into 数据表 valuess (值1,值2,值3 …)"<br>不指定具体字段名表示将按照数据表中字段的顺序，依次添加</p><p>sql="insert into 目标数据表 select * from 源数据表"<br>把源数据表的记录添加到目标数据表</p><p><br>☆ 更新数据记录 ☆<br>Sql="update 数据表 set 字段名=字段值 where 条件表达式"</p><p>Sql="update 数据表 set 字段1=值1,字段2=值2 …… 字段n=值n where 条件表达式"</p><p>Sql="update 数据表 set 字段1=值1,字段2=值2 …… 字段n=值n "<br>没有条件则更新整个数据表中的指定字段值</p><p><br>☆ 删除数据记录 ☆<br>Sql="delete from 数据表 where 条件表达式"</p><p>Sql="delete from 数据表"<br>没有条件将删除数据表中所有记录)</p><p>引用以上函数的方法：<br>sql="select sum(字段名) as 别名 from 数据表 where 条件表达式"<br>set rs=conn.excute(sql)<br>用 rs("别名") 获取统的计值，其它函数运用同上。</p><p>☆ 数据表的建立和删除 ☆<br>CREATE TABLE 数据表名称(字段1 类型1(长度),字段2 类型2(长度) …… )<br>例：CREATE TABLE tab01(name varchar(50),datetime default now())<br>DROP TABLE 数据表名称 (永久性删除一个数据表)</p><p><br>☆ 记录集对象的方法 ☆<br>rs.movenext 将记录指针从当前的位置向下移一行<br>rs.moveprevious 将记录指针从当前的位置向上移一行<br>rs.movefirst 将记录指针移到数据表第一行<br>rs.movelast 将记录指针移到数据表最后一行<br>rs.absoluteposition=N 将记录指针移到数据表第N行<br>rs.absolutepage=N 将记录指针移到第N页的第一行<br>rs.pagesize=N 设置每页为N条记录<br>rs.pagecount 根据 pagesize 的设置返回总页数<br>rs.recordcount 返回记录总数<br>rs.bof 返回记录指针是否超出数据表首端，true表示是，false为否<br>rs.eof 返回记录指针是否超出数据表末端，true表示是，false为否<br>rs.delete 删除当前记录，但记录指针不会向下移动<br>rs.addnew 添加记录到数据表末端<br>rs.update 更新数据表记录</p><p><br></p><p>注：本文如有文字侵权，请联系作者删除。谢谢！</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'数据库','SQL','语句'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>