<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>视频监控系统画面花屏、马赛克、拖影问题快速解决方法 | 极客快訊</title><meta property="og:title" content="视频监控系统画面花屏、马赛克、拖影问题快速解决方法 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/cb2d31e6fca940f58ecb757944925d57"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/34be393c.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/34be393c.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/34be393c.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/34be393c.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/34be393c.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/34be393c.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/34be393c.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/34be393c.html><meta property="article:published_time" content="2020-11-14T21:02:11+08:00"><meta property="article:modified_time" content="2020-11-14T21:02:11+08:00"><meta name=Keywords content><meta name=description content="视频监控系统画面花屏、马赛克、拖影问题快速解决方法"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/34be393c.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>视频监控系统画面花屏、马赛克、拖影问题快速解决方法</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>监控画面花屏、马赛克、拖影、跳秒，可能不少朋友都有遇到过。如果不了解问题出现的原因、没有掌握正确的排查方法，就很难快速解决问题。下面小编就给大家介绍快速定位、解决花屏问题的方法。</p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/cb2d31e6fca940f58ecb757944925d57><p class=pgc-img-caption></p></div><p style=text-align:justify><br>我们先通过三个监控现场实例，看看常见的引发花屏问题的原因：</p><p style=text-align:justify><br></p><p><strong><span style="background-color:#159f7c;--tt-darkmode-bgcolor: #159F7C">先学习几个案例</span></strong></p><p><strong><span style="background-color:#79cec9;--tt-darkmode-bgcolor: #79CEC9">01</span>预览、回放花屏</strong></p><p><strong>【问题现象】</strong></p><p>2019年8月，某工程商使用NVR6200出现花屏问题，多个屏幕大面积横条纹马赛克闪烁，花得特别严重，工程商很揪心。</p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/97766689dce14ab5bf262d3644819200><p class=pgc-img-caption></p></div><p>回放花屏</p><p><strong>【问题原因】</strong></p><p>经过排查，<strong>主交换机用的是监控专用的8口交换机，开启了超距开关（超距端口速率为10Mbps），录像机连接的是超距端口</strong>。</p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b2b08ef077274509baf9e3663dd37c11><p class=pgc-img-caption></p></div><p>现场交换机超距开关为“开”的原因，是工程商误以为开了延长模式后，监控转发更流畅。</p><p><strong>【解决方法】</strong></p><p>由于现场所有点位都没有超过100米，所以不需要启用超距模式，关闭超距开关后，问题顺利解决。</p><p><strong><span style="background-color:#79cec9;--tt-darkmode-bgcolor: #79CEC9">02</span>预览卡顿、花屏预览</strong></p><p><strong>【问题现象】</strong></p><p>某工程商使用NVR6100出现花屏问题，多个画面下方出现大块紫色、绿色、灰色的色块，无法正常显示视频。</p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9a524048bb3b4c78b7a6ad5e908e1477><p class=pgc-img-caption></p></div><p><strong>【问题原因】</strong></p><p>通过NVR“快速诊断”功能诊断网络通信质量：</p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0539625c5d2a4e91b21eac2bcec8ccf9><p class=pgc-img-caption></p></div><p style=text-align:justify>从诊断结果可以看出，<strong>大部分通道都存在延迟较大、丢包率高</strong>。由于现场没有使用监控专用交换机（排除了延长模式导致的问题），由此可以判断，很有可能是NVR与交换机连接的核心线路存在问题。</p><p><strong>【解决方法】</strong></p><p>直接更换了一条NVR到核心交换机的主线，更换后问题解决。</p><p><strong><span style="background-color:#79cec9;--tt-darkmode-bgcolor: #79CEC9">03</span>预览卡顿、延迟</strong></p><p><strong>【问题现象】</strong></p><p>某工程商使用NVR6400添加40余个摄像机，大部分画面出现明显的延迟、卡顿。</p><p><strong>【问题原因】</strong></p><p>通过NVR“快速诊断”功能诊断网络通信质量有一定延迟，经进一步了解，现场使用48路NVR添加了40个IPC，NVR连接千兆上联交换机，但<strong>由于错将NVR连接到交换机的百兆端口，导致协商到100M，出现丢包卡顿。</strong></p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c8554eb7e8844fbb93023deb0a79a652><p class=pgc-img-caption></p></div><p><strong>【解决方法】</strong></p><p>纠正连接方法，NVR连接到千兆端口后问题顺利解决。</p><p><strong><span style="background-color:#159f7c;--tt-darkmode-bgcolor: #159F7C">花屏问题解决思路</span></strong></p><p>上述三个现场都是典型的花屏、卡顿问题，经过我们排查，很快就定位了问题原因并解决了问题。那么，如何快速判断出现花屏问题的原因？如何解决花屏的问题？今天小编给大家奉上快速解决花屏问题的三板斧：<strong>一诊断、二调开关、三换线</strong>。通过学习本文介绍的内容，解决花屏问题不再困难！</p><p><strong>第一板斧：快速诊断定位问题</strong></p><p>遇到卡顿、花屏的问题，首先需要判断网络通信质量有没有问题，那么，该如何快速判断网络通信状况呢？<strong>我们的全系列录像机均内置“诊断工具”，可一键快速诊断网络连通性及通信质量（延迟、丢包情况）。</strong></p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2fac2f29224b44139882499eecaeda67><p class=pgc-img-caption></p></div><p>工程商需掌握的操作</p><p>在NVR上进入【设置-系统设置-系统配置-诊断工具】即可使用“快速诊断”功能，点击后稍等片刻，等待诊断完成后即可查看诊断结果。诊断结果分为“外部连通性”和“通道网络质量”两个部分：</p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/560dab4d9ebe45559b225f902c76857d><p class=pgc-img-caption></p></div><p>其中通道网络质量用于诊断录像机和摄像头之间的连通性。通道网络质量是通过对每个通道的IPC去Ping一定量的数据包，通过丢包率以及延迟来判断NVR跟每个IPC之间的网络质量。<strong>如果网络延迟比较大、丢包严重，说明这个线路质量存在问题或不稳定</strong>。<strong>一般情况下，有线监控网络中，延迟为1~2ms；无线网络延迟为50ms以内算正常。如果你的ping值超过这个数字，基本上确定是属于网络原因。</strong></p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0dd5fb42f8f24e659cb038bb1014787c><p class=pgc-img-caption></p></div><p>如上图，延迟较高的通道或者丢包率较高的通道可能会产生NVR取流中断现象，表现为预览花屏、马赛克、录像断断续续或者提示资源不足等现象。根据诊断结果，我们可以大概判断问题出现的原因：</p><p><strong><span style="background-color:#f7fbf9;--tt-darkmode-bgcolor: #BCBFBE">1、所有通道的延迟都很大、丢包率都很高</span></strong></p><p><span style="background-color:#f7fbf9;--tt-darkmode-bgcolor: #BCBFBE">很有可能是主干网络出现了问题，我们需要确认NVR网口的协商速率，检查NVR与核心交换机的网线连接、水晶头质量等，需要从主干网络去解决问题。</span></p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/99f5d67fa4394d7da99bf335270b8ea7><p class=pgc-img-caption></p></div><p><br></p><p><strong><span style="background-color:#f7fbf9;--tt-darkmode-bgcolor: #BCBFBE">2、一部分通道延迟较大、丢包率较高</span></strong></p><p><span style="background-color:#f7fbf9;--tt-darkmode-bgcolor: #BCBFBE">可能是这部分IPC连接在某一个交换机上，交换机上联口的传输带宽不足导致的异常，比如连接IPC较多的汇聚交换机使用百兆口上联、汇聚交换机的超距端口级联下一级交换机、接入交换机超距端口上联等情况。</span></p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/22382da630af48c5a14779e284d49752><p class=pgc-img-caption></p></div><p><br></p><p><strong><span style="background-color:#f7fbf9;--tt-darkmode-bgcolor: #BCBFBE">3、某一个或几个通道延迟较大、丢包率较高</span></strong></p><p><span style="background-color:#f7fbf9;--tt-darkmode-bgcolor: #BCBFBE">可能是这些IPC的网线较长、网线质量较差、水晶头接触不良或无线传输不稳定等，需要找到问题通道并解决线路连接的问题。</span></p><p><span style="background-color:#f7fbf9;--tt-darkmode-bgcolor: #BCBFBE"><br></span></p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ad3f220cc96146b9ba1b598894391b7f><p class=pgc-img-caption></p></div><p><strong>第二板斧：合理使用延长开关</strong></p><p>根据诊断结果，我们大概可以判断问题原因，当我们使用的是安防监控专用交换机时，尤其要注意是否开启了超距模式/延长模式。<strong>开启超距模式后，超距端口为10Mbps，但Uplink口为百兆或千兆。</strong></p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/230b1389c1164b3b97ba84a3ca71fa8c><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c2b73ac8a9c14bc894c626a379bab5f4><p class=pgc-img-caption></p></div><p><strong>汇聚交换机/核心交换机：</strong>一般级联一级或多级交换机，开启超距模式后，超距端口协商速率为10Mbps，无法满足传输需求，应关闭超距开关。</p><p><strong>接入交换机：</strong>接入交换机开启超距模式后，超距端口为10Mbps，如果使用超距端口作为上联口则无法满足传输带宽需求，需使用Uplink口作为上联口。</p><p><strong>第三板斧：注意主干线路</strong></p><p>根据诊断结果，如果所有通道的延迟都很大、丢包率都很高，那么很有可能是NVR与核心交换机之间的传输带宽出现问题，我们可以结合NVR网口的协商速率来判断。一般来说，可能的原因如下：</p><p><strong><span style="background-color:#ffa900;--tt-darkmode-bgcolor: #FFA900">核心交换机不是千兆口</span></strong></p><p>对于大路数的NVR，添加的IPC较多，尤其是超过20个IPC时，百兆传输带宽已经无法满足传输需求。这时需要使用全千兆或千兆上联的交换机，NVR需要连接交换机的千兆端口。</p><p><strong><span style="background-color:#ffa900;--tt-darkmode-bgcolor: #FFA900">主网线的网线质量较差</span></strong></p><p>对于NVR与交换机之间的核心线路来说，其质量会影响NVR与所有通道的通信，需要使用质量较好的8芯网线进行连接。当使用出现问题时，我们可以尝试更换网线或重新制作水晶头来解决问题。</p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d5bcfe8b4f1540bfade1489f55d32e14><p class=pgc-img-caption></p></div><p>网线材质对比</p><p><strong><span style="background-color:#159f7c;--tt-darkmode-bgcolor: #159F7C">实测花屏问题</span></strong></p><p>实际组网应用下，大家可能经常会有以下两种拓扑组网，分别是独立交换机使用和交换机串联应用。下面通过实验看一下延长模式应用不恰当带来的问题：</p><p><strong>1、NVR接入端口为延长端口会花屏</strong></p><p>交换机开启超距模式后，超距端口为10Mbps，如果NVR错误地连接到超距端口，则无法满足传输带宽需求，需使用Uplink来连接NVR。</p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/7e1b100991eb43e19089145edb1f84a3><p class=pgc-img-caption></p></div><p>NVR连接到uplink口后问题解决：</p><p><strong>2、核心交换机开启超距模式导致花屏的问题</strong></p><p>实验测试另外一种拓扑结构，即接入交换机连接到汇聚和核心交换机的Uplink口，由于骨干线路变为10M，导致丢包严重出现花屏问题。这种监控组网模式下，需要把核心、汇聚交换机的延长模式关闭。</p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/49e2d6d4931a491e8cd1d70e2e5397b9><p class=pgc-img-caption></p></div><p>实验效果如下：</p><p><br>当连接IPC的网线长度不超过100米时，没有必要开启超距模式，我们可以关闭超距模式开关。</p><p><strong><span style="background-color:#159f7c;--tt-darkmode-bgcolor: #159F7C">如何避免花屏问题？</span></strong></p><p>出现花屏的根本原因往往是线路丢包导致录像机收到的视频数据不全，而丢失那部分视频在监控画面上就会以花屏的形式显示出来。那么，如何避免出现花屏的问题呢？</p><p><span style="background-color:#79cec9;--tt-darkmode-bgcolor: #79CEC9">01</span><strong>梳理网络拓扑</strong></p><p>在摄像机数量较多的网络中，交换机级联层数较多、上联端口传输带宽不足是导致花屏的主要原因。清晰的网络拓扑图有助于我们快速定位问题节点。</p><div class=pgc-img><img alt=视频监控系统画面花屏、马赛克、拖影问题快速解决方法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0fea881e4fea43a58465b33f95fdcf5c><p class=pgc-img-caption></p></div><p><br>说明：</p><p>带宽值=（主码流码率+子码流码率）*通道数*1.2；</p><p>本图中IPC主码流码率为4M，子码流码率为1M；</p><p>上联口传输带宽建议不超过交换机端口速率的70%，即100M网口建议传输带宽不超过70M。</p><p>在工程实施前，我们应该合理规划网络拓扑：</p><p><br><strong>a. 选择合适类型的交换机：</strong></p><p>关于监控网络中如何选配交换机可参考《千百兆、核心、PoE、光纤？详细介绍监控网络中的交换机选配方法》。</p><p><strong>b. 上联口用千兆：</strong></p><p>交换机的上联口需要传输其接入的所有IPC（包括其下方级联交换机接入的IPC）的数据，其传输的数据量往往较大，建议选择支持千兆上联口的交换机（千兆上联交换机或全千兆交换机）。</p><p><strong>c. 避免多层级联：</strong></p><p>交换机级联层数过多时，故障率也会升高，应尽量避免交换机多层级联，建议最好不超过3级。</p><p>对于已经安装好的工程，出现花屏问题时，我们也要对网络拓扑进行梳理，根据上述原则进行调整，从而解决花屏的问题。</p><p><span style="background-color:#79cec9;--tt-darkmode-bgcolor: #79CEC9">02</span><strong>善用智能编码</strong></p><p>大部分有线IPC都支持智能编码，<strong>开启IPC的智能编码后，IPC在保证视频、图像质量的前提下，最大程度的压缩码率大小，可有效降低传输码率，降低对网络传输设备的要求</strong>，可有效降低因带宽不足导致的卡顿、掉线、黑屏等问题，提高监控网络的稳定性。</p><p><span style="background-color:#79cec9;--tt-darkmode-bgcolor: #79CEC9">03</span><strong>保证网线质量</strong></p><p>俗话说，好马配好鞍，再好的监控设备，如果没有好的传输线材支撑，最终的监控效果也可能是很不稳定。</p><p>那么各级设备需要用什么样的网线？监控网络中有核心交换机、汇聚交换机、接入交换机、PoE设备：</p><p><strong>核心交换机：</strong>连接的是录像机、服务器、路由器等设备，必须要保证其传输稳定性，建议使用超五类0.5mm线径无氧铜网线或更好的网线。</p><p><strong>接入交换机：</strong>如果连接的是近距离（例如二三十米左右）的点位，可以使用一般线材。如果传输距离更远（例如五六十米到上百米），建议使用超五类0.5mm线径无氧铜或更好的网线。</p><p><strong>PoE供电：</strong>建议使用8芯或4芯0.5mm线径无氧铜网线，需要保障线材材质和绞合紧密程度。</p><p>当然，全部使用好的网线，更能保障网络的稳定性，减少故障出现的概率。关于网线的选择，可参考《好马还得配好鞍，好监控设备该搭配什么样的网线？》</p><p>总结</p><p>监控工程中，出现花屏、卡顿或者马赛克等问题着实令人头疼，但在工程实施前进行合理的规划、选配合适的交换机，可以有效避免类似问题的出现。已实施的工程如出现此类问题，通过合理的排查方法，掌握“一诊断、二调开关、三换线”这三板斧，也可以快速地定位问题原因并解决。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'视频','监控系','统画'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>