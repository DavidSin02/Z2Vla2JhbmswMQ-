<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>经典机器学习系列之「神经网络详解」 | 极客快訊</title><meta property="og:title" content="经典机器学习系列之「神经网络详解」 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/0a60363e1dd145ae8ab0815afb1d426c"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3515ec7.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3515ec7.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3515ec7.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3515ec7.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3515ec7.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3515ec7.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3515ec7.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3515ec7.html><meta property="article:published_time" content="2020-10-29T21:05:34+08:00"><meta property="article:modified_time" content="2020-10-29T21:05:34+08:00"><meta name=Keywords content><meta name=description content="经典机器学习系列之「神经网络详解」"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/3515ec7.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>经典机器学习系列之「神经网络详解」</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>这节主要来详细说一下神经网络。从神经网络定义到 <strong>M-P模型</strong> 再扩展到 <strong>单层感知机</strong> 、 <strong>多层前馈神经网络</strong> 、再到 <strong>深层神经网络</strong> 。(本文有一些概念省略了，若有写得不清楚的地方，我们一起在微信群里面讨论讨论)。</p><h2 class=pgc-h-arrow-right>神经网络的定义</h2><p>在不同的领域、以及不同人的一些偏好。大家对神经网络的叫法有些许差别。但主要会包括以下几种命名方式：</p><ul><li>神经网络(Neural Network)</li><li>人工神经网络(Artificial Neural Network)</li><li>人工神经系统(Artificial Neural Systems)</li><li>神经计算机(Neural Computer)</li><li>自适应系统(Adaptive Systems)</li><li>自适应网(Adaptive Network)</li><li>联结主义(Connectionisms)</li></ul><p>不同的学科对神经网络的定义也大不相同，比较广泛的一种定义是：由具有适应性的简单单元组成的广泛并行互联的网络，它的组织能够模拟生物神经系统对真实世界物体所作出的反应。</p><h2 class=pgc-h-arrow-right>M-P神经元模型</h2><p>在神经网络中，最基本的信息处理单元就是M-P神经元模型。</p><div class=pgc-img><img alt=经典机器学习系列之「神经网络详解」 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/0a60363e1dd145ae8ab0815afb1d426c><p class=pgc-img-caption></p></div><p>一个M-P神经元模型，接收来自其它 个神经元传递过来的输入信号。输入信号通过带权重的连接，进行传递，神经元接收到的总输入值将与神经元的 <strong>阈值</strong> 进行比较，，如果大于阈值，就会通过 <strong>激活函数</strong> 处理产生神经元的输出。到这里，所谓的M-P模型，其本质就是一个广义的线性回归模型。</p><p>理想的激活函数是阶跃函数，但阶跃函数具有不可导的性质一般我么采用Sigmoid函数，这一点在 <strong>经典机器学习系列之【线性模型与广义线性模型】</strong> 有具体详解。</p><p>当M-P神经元模型的激活函数选用Sigmoid函数时，M-P模型其实就是一个逻辑斯蒂回归模型。</p><h2 class=pgc-h-arrow-right>单层感知机</h2><p>所谓单层感知机，就是只拥有一层M-P神经元的神经网络模型。只包含两层神经元，输入层和输出层。输入层接收外界输入信号后，传递给输出层；输出层是一个或者多个M-P神经元，进行激活处理。</p><div class=pgc-img><img alt=经典机器学习系列之「神经网络详解」 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/98a2b332079c4a88aa39188a58203dd6><p class=pgc-img-caption></p></div><p>给定训练数据集，权重 以及阈值 可通过学习得到。阈值 可看作一个固定输入为 的“哑节点”(dummy node)所对应的连接权重 ，这样，权重和阈值的学习就可统一为权重的学习。</p><p>其学习规则为：对训练样例 ，若当前感知机的输出为 ，则感知机权重调整如下所示：</p><p>上述公式是误差对参数 求偏导数所得到的。 称为学习率(learning rate)。从上式可以看出，若预测正确，误差为0，感知器参数将不发生调整。否者将会更具错误的大小进行修正。</p><p>对于线性可分问题，感知机最终将会收敛，而对于线性不可分的异或问题，感知机将会发生振荡(fluctuation)， 难以稳定下来，不能求得合适解。例如对下图所示的异或非线性问题，感知机就难以求解。</p><div class=pgc-img><img alt=经典机器学习系列之「神经网络详解」 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/dd41bfd4af4b42c9b56bc801c564abf0><p class=pgc-img-caption></p></div><p>要解决非线性可分问题，需要考虑使用多层功能神经元。即输入层和输出层之间包含一层隐藏层。隐藏层和输出层神经元都是拥有激活函数的功能神经元。</p><div class=pgc-img><img alt=经典机器学习系列之「神经网络详解」 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c12abba6ef2b41c1ac2b071e8aa41c23><p class=pgc-img-caption></p></div><h2 class=pgc-h-arrow-right>多层前馈神经网络</h2><p>当把隐藏层层数扩大之后，神经元之间的连接将会更加复杂。每层神经元与下一层神经元全互连，神经元之间不存在同层连接，也不存在跨层连接，这样的神经网络结构通常称为“ <strong>多层前馈神经网络</strong> ”(multi-layer feedforward neural network)。</p><p>其中 <strong>多层</strong> 指的是，除了输入层和输出层以外，还存在一个或者多个隐含层。 <strong>前馈</strong> 指的是：外界信号从输入层经由隐含层到达输出层，不存在信号的逆向传播。</p><div class=pgc-img><img alt=经典机器学习系列之「神经网络详解」 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b4c0eec7eddd4ece92a1655a849986a0><p class=pgc-img-caption></p></div><p>与M-P模型一样，输入层神经元接收外界的输入信号，隐藏层与输出层对信号进行处理加工，最终结果由输出层神经元输出。</p><p>神经网络所需要做的事情就是：依据训练给定的样本，来调整神经元之间的“连接权”，以及每个功能神经元的阈值。最终所得到的这个模型，期望对未知样本有一定的泛化能力。</p><h3 class=pgc-h-arrow-right>BP求解单隐层前馈网络</h3><p>我们以单隐层前馈网络为例，对其模型进行求解。由于这里固定了是单隐层前馈神经网络，我们就不对其神经网络结构求解进行讨论，只讨论其参数学习问题。这里我们采用 <strong>误差反向传播算法</strong> (Back Propagation，简称BP算法)来对其模型参数进行求解。神经网络学习就是依据训练数据来调整神经元之间的连接权值，以及每个M-P神经元的阈值。</p><p>给定训练集 ， ， ，即输入样本由 个属性描述，输出是 维实值向量。如下图所示：</p><div class=pgc-img><img alt=经典机器学习系列之「神经网络详解」 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/02875d06f0c947ef9ffc0710015f2038><p class=pgc-img-caption></p></div><p>假设隐藏层神经元个数为 个。输出层神经元的阈值用 表示。隐层第 个神经元的阈值用 表示。</p><ul><li>输入层第 个神经元与隐藏层第 个神经元之间的连接权为 。</li><li>隐层第 个神经元与输出层第 个神经元之间的连接权为 。</li></ul><p>隐层第 个神经元接收到的输入为 ；</p><p>输出层第 个神经元接收到的输入为 。其中 为隐层第 个神经元的输出。</p><p>假设隐层和输出层神经元都使用Sigmoid激活函数。对训练例 ，假定神经网络的输出为 ，即神经网络的预测输出表达式为：</p><p>则网络在样本集 上的均方误差为：</p><p>到这里，我么整个的前馈神经网络的数学模型就已经建立完成了。接下来我们需要依据使误差最小这个优化目标，来求解神经网络参数矩阵。在计算参数矩阵之前，我们先来计算一下神经网络的参数有多少个：输入层到隐藏层的 个权值；隐藏层到输出层的 个权值； 个隐藏层神经元阈值； 个输出层神经元阈值，总共 个参数。</p><p>之后我们需要利用BP算法，对这些参数进行更新估计。BP算法基于梯度下降(gradient descent)策略，以目标的 <strong>负梯度方向</strong> 对参数进行调整。给定学习率 ，有：</p><p>注意到 先影响到第 个神经元的输入值 ，再影响到其输出值 ，然后影响到 ，最后有：</p><p>依据 的定义 ，有：</p><p>由 Sigmoid 函数的性质 可得：</p><p>于是可以得到BP算法中关于 的更新公式：</p><p>类似这种链式求导法则，我们可以得到：</p><p>其中：</p><p>到这里模型参数的求解大体过程就完成了。</p><p>最后做一个 <strong>总结</strong> ：基于BP的单隐层前馈神经网络工作流程如下所示：对每个训练样本，先走前向传播，输入传递给输入层、隐藏层、输出层。依据输出层的输出结果计算误差，再将误差反向传播到隐藏层神经元，最后依据隐层神经元的误差来对连接权和阈值进行调整，迭代循环该过程，直到达到设定的终止条件(如设定的迭代次数，或者误差小于某个值)。</p><p>其算法伪代码如下图所示：</p><div class=pgc-img><img alt=经典机器学习系列之「神经网络详解」 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/632725e6acec4c52b59d6e5ca18f5fa6><p class=pgc-img-caption></p></div><h3 class=pgc-h-arrow-right>BP算法所存在的问题</h3><p>在实际的运用过程中，BP算法还会面临一些实际的问题：</p><ul><li><strong>结构学习问题</strong></li></ul><p>多层前馈神经网络包括输入层、输出层、一个或者多个隐藏层。</p><p>在数学原理上，一个包含足够多神经元的隐藏层的前馈神经网络就能以任意精度逼近任意复杂的连续函数。也就是说两层的前馈神经网络就足够逼近任意的连续复杂函数，因此通常选用一个隐含层。</p><p>当网络层数确定下来之后，每层设置的神经元个数又为多少呢？通常，输入层依据求解问题的数据维度及数据类型而定。输出层由待分类问题的类别数目所确定的。隐含层神经元个数是一个超参数问题，实际操作过程中依据经验而定。</p><ul><li><strong>初始化问题</strong></li></ul><p>在网络学习之前，连接权重和阈值都初始化为 <strong>不同</strong> 的 <strong>小随机数</strong> 。不同是为了保证网络可以学习。小随机数是为了防止其值过大，而提前进入饱和状态。初始化参数设置不好的话，网络容易陷入局部最优，若这种情况发生，程序多跑几次，网络重新初始化就可以了。</p><ul><li><strong>步长设置问题</strong></li></ul><p>学习率控制着算法的收敛速度。太大容易振荡，太小收敛速度又过慢。比较好的设置方法是，训练刚开始时，补偿设置较大，随着训练进行，步长逐渐缩小。实际应用过程中，可以采取自适应步长，步长随网络训练变化。</p><ul><li><strong>权值与阈值的更新问题</strong></li></ul><p>标准的BP算法是样例更新，即每处理一个样本就更新权值和阈值。样例更新的缺陷就是：参数更新频繁，不同样例之间的下降梯度方向可能抵消，迭代的次数较多。训练样例的输入顺序会对训练结果有较大的影响，单个处理会对最后更新的样例比较偏爱，而给样例排序是比较困难的一件事情。</p><p>采用的办法是周期更新制，即处理完一遍所有的训练样例才更新权值和阈值。但周期更新的累计误差下降到一定程度后，进一步下降会非常缓慢。这个时候样例更新就会比较好。两者折中就变成了Batch更新。</p><ul><li><strong>过拟合问题</strong></li></ul><p>神经网络的过拟合问题表现为：训练误差持续降低，但测试误差却升高。缓解这个问题可以采取 <strong>提前结束训练</strong> 和 <strong>正则化</strong> 方法。提前结束训练：就是训练误差降低，测试误差升高的时候停止训练；正则化：在误差目标函数中增加描述网络复杂程度的部分，比如连接权值和阈值的平方和，所体现的是大道至简的思想。</p><h2 class=pgc-h-arrow-right>深层神经网络</h2><p>随着计算能力的大幅提高可缓解训练低效性；训练数据的大幅增加则可降低过拟合风险，因此,以深度学习(deep learning)为代表的复杂模型开始受到人们的关注。</p><p>典型的深度学习模型就是很深层的神经网络：包含2个以上隐含层的神经网络。</p><div class=pgc-img><img alt=经典机器学习系列之「神经网络详解」 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/c82362f6a6654235b5b8f1478e6dcec4><p class=pgc-img-caption></p></div><p>深度伸进网络的模型更加复杂，能够拟合更加复杂的模型，主要是归功于 <strong>隐藏层神经元数目的增多</strong> （模型宽度），和 <strong>隐藏层层数的增多</strong> （模型深度）。增加隐藏层层数更容易使得神经网络模型变复杂，因为隐藏层数目不仅增加了拥有激活函数的神经元数目，还增加了激活函数嵌套的层数。</p><p>但是随着隐藏层的增多，BP算法中误差一层一层往前传播会变得越来越困难，导致梯度消失。那如何学习深层神经网络模型呢？目前主要采取两种办法：</p><ul><li><strong>预训练+微调</strong></li></ul><p>在预训练阶段，采用无监督逐层训练，将上一层隐藏层节点的输出作为输入，而本层隐藏层结点的输出作为一下一层隐含层节点的输入。</p><p>预训练全部完成后，再对整个网络进行微调训练，一般使用BP算法。</p><p>预训练+微调的做法可以视为将大量参数进行分组，对每组先找到局部看起来比较好的设置，然后再基于这些局部较优的结果联合起来进行全局寻优。</p><ul><li><strong>权共享</strong></li></ul><p>权共享就是让一组神经元共享相同的连接权值。卷积神经网络就是典型的权共享网络。CNN复合多个卷积层和采样层对输入信号进行加工，然后在连接层实现与输出目标之间的映射。</p><h3 class=pgc-h-arrow-right>深度学习理解</h3><p>深度学习通过多层处理，逐渐将初始的低层特征表示转化为高层特征表示后，用“简单模型”即可完成复杂的分类学习等任务。由此可将深度学习理解为进行“ <strong>特征学习</strong> ”(feature learning) 或“表示学习” (representation learning)。</p><p>非深度学习技术用于解决现实任务时，描述样本的特征通常需由人类专家来手工设计，这称为“ <strong>特征工程</strong> ” (feature engineering)。众所周知，特征的好坏对模型的泛化性能有至关重要的影响，要人类专家手工设计出好特征并非易事；而特征学习则通过深度学习技术自动产生好特征，这使得机器学习向“全自动数据分析”又前进了一步。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'经典','机器','学习'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>