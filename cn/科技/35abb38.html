<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>é¢è¯•é¢˜ç¬¬4ç¯‡ï¼šé‡å†™äº†equalsï¼Œè¿˜è¦é‡å†™hashCodeï¼Ÿ | æå®¢å¿«è¨Š</title><meta property="og:title" content="é¢è¯•é¢˜ç¬¬4ç¯‡ï¼šé‡å†™äº†equalsï¼Œè¿˜è¦é‡å†™hashCodeï¼Ÿ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/9b1f878c17e84c1caa06a5deda2c10f1"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/35abb38.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/35abb38.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/35abb38.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/35abb38.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/35abb38.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/35abb38.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/35abb38.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/35abb38.html><meta property="article:published_time" content="2020-10-29T21:01:26+08:00"><meta property="article:modified_time" content="2020-10-29T21:01:26+08:00"><meta name=Keywords content><meta name=description content="é¢è¯•é¢˜ç¬¬4ç¯‡ï¼šé‡å†™äº†equalsï¼Œè¿˜è¦é‡å†™hashCodeï¼Ÿ"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/35abb38.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>é¢è¯•é¢˜ç¬¬4ç¯‡ï¼šé‡å†™äº†equalsï¼Œè¿˜è¦é‡å†™hashCodeï¼Ÿ</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><blockquote><p>ã€ŠJavaé¢è¯•é¢˜ç³»åˆ—ã€‹ï¼šä¸€ä¸ªé•¿çŸ¥è¯†åˆå¾ˆæœ‰æ„æ€çš„ä¸“æ ã€‚æ·±å…¥æŒ–æ˜ã€åˆ†ææºç ã€æ±‡æ€»åŸç†ã€å›¾æ–‡ç»“åˆï¼Œæ‰“é€ å…¬ä¼—å·ç³»åˆ—æ–‡ç« ï¼Œé¢è¯•ä¸å¦å‡å¯æå‡Levelã€‚æ¬¢è¿æŒç»­å…³æ³¨ã€ç¨‹åºæ–°è§†ç•Œã€‘ã€‚æœ¬ç¯‡ä¸ºç¬¬4ç¯‡ã€‚</p></blockquote><p style=text-align:start>æ ¸å¿ƒé—®é¢˜ï¼šé‡å†™äº†equalsæ–¹æ³•ï¼Œä¸ºä»€ä¹ˆè¿˜è¦é‡å†™hashCodeæ–¹æ³•ï¼Ÿ</p><p style=text-align:start>è¿™ä¸ä»…ä»…æ˜¯ä¸€é“é¢è¯•é¢˜ï¼Œè€Œä¸”æ˜¯å…³ç³»åˆ°æˆ‘ä»¬çš„ä»£ç æ˜¯å¦å¥å£®å’Œæ­£ç¡®çš„é—®é¢˜ã€‚åœ¨å‰é¢ä¸¤ç¯‡æ–‡ç« æ¶‰åŠåˆ°äº†equalsæ–¹æ³•çš„åº•å±‚è®²è§£ï¼šã€Šè¯´è¯´==å’Œequalsçš„åŒºåˆ«ï¼Ÿä½ çš„å›ç­”å¯èƒ½æ˜¯é”™è¯¯çš„ã€‹å’Œã€ŠIntegerç­‰å·åˆ¤æ–­çš„å†…å¹•ï¼Œä½ å¯èƒ½ä¸çŸ¥é“ï¼Ÿã€‹ã€‚</p><p style=text-align:start>æœ¬ç¯‡æ–‡ç« ï¼Œå¸¦å¤§å®¶ä»åº•å±‚æ¥åˆ†æä¸€ä¸‹hashcodeæ–¹æ³•é‡å†™çš„æ„ä¹‰ä»¥åŠå¦‚ä½•å®ç°ã€‚</p><h1 class=pgc-h-arrow-right>å›é¡¾equalsæ–¹æ³•</h1><p style=text-align:start>æˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹Objectçš„equalsæ–¹æ³•å®ç°ï¼Œå¹¶ç®€å•æ±‡æ€»ä¸€ä¸‹ä½¿ç”¨equalsæ–¹æ³•çš„è§„å¾‹ã€‚</p><pre><code>public boolean equals(Object obj) {    return (this == obj);}</code></pre><p style=text-align:start>é€šè¿‡ä¸Šé¢Objectçš„æºä»£ç ï¼Œå¯ä»¥å¾—å‡ºä¸€ä¸ªç»“è®ºï¼šå¦‚æœä¸€ä¸ªç±»æœªé‡å†™equalsæ–¹æ³•ï¼Œé‚£ä¹ˆæœ¬è´¨ä¸Šé€šè¿‡â€œ==â€å’Œequalsæ–¹æ³•æ¯”è¾ƒçš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„çš„å†…å­˜åœ°å€ã€‚</p><p style=text-align:start>å‰é¢ä¸¤ç¯‡æ–‡ç« è®²åˆ°Stringå’ŒIntegeråœ¨æ¯”è¾ƒæ—¶çš„åŒºåˆ«ï¼Œå…³é”®ç‚¹ä¹Ÿæ˜¯å®ƒä»¬å¯¹equalsæ–¹æ³•çš„å®ç°ã€‚</p><p style=text-align:start>é¢è¯•æ—¶æ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œä»Objectç±»ç»§æ‰¿çš„equalsæ–¹æ³•ä¸â€œ==â€å®Œå…¨ç­‰ä»·ï¼Œæ¯”è¾ƒçš„éƒ½æ˜¯å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚ä½†æˆ‘ä»¬å¯ä»¥é‡å†™equalsæ–¹æ³•ï¼Œä½¿å…¶æŒ‰ç…§éœ€è¦è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚Stringç±»é‡å†™äº†equalsæ–¹æ³•ï¼Œæ¯”è¾ƒçš„æ˜¯å­—ç¬¦çš„åºåˆ—ï¼Œè€Œä¸å†æ˜¯å†…å­˜åœ°å€ã€‚</p><h1 class=pgc-h-arrow-right>ä¸hashCodeæ–¹æ³•çš„å…³ç³»</h1><p style=text-align:start>é‚£ä¹ˆequalsæ–¹æ³•ä¸hashCodeæ–¹æ³•åˆæœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹Objectä¸Šequalsæ–¹æ³•çš„ä¸€æ®µæ³¨é‡Šã€‚</p><blockquote><p>Note that it is generally necessary to override the hashCode method whenever this method is overridden, so as to maintain the general contract for the hashCode method, which states that equal objects must have equal hash codes.</p></blockquote><p style=text-align:start>å¤§è‡´æ„æ€æ˜¯ï¼šå½“é‡å†™equalsæ–¹æ³•åæœ‰å¿…è¦å°†hashCodeæ–¹æ³•ä¹Ÿé‡å†™ï¼Œè¿™æ ·åšæ‰èƒ½ä¿è¯ä¸è¿èƒŒhashCodeæ–¹æ³•ä¸­â€œç›¸åŒå¯¹è±¡å¿…é¡»æœ‰ç›¸åŒå“ˆå¸Œå€¼â€çš„çº¦å®šã€‚</p><p style=text-align:start>æ­¤å¤„åªæ˜¯æé†’äº†æˆ‘ä»¬é‡å†™hashCodeæ–¹æ³•çš„å¿…è¦æ€§ï¼Œé‚£å…¶ä¸­æåˆ°çš„hashCodeæ–¹æ³•è®¾è®¡çº¦å®šåˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç›¸å…³çš„å†…å®¹å®šä¹‰åœ¨hashCodeæ–¹æ³•çš„æ³¨è§£éƒ¨åˆ†ã€‚</p><h1 class=pgc-h-arrow-right>hashCodeæ–¹æ³•çº¦å®š</h1><p style=text-align:start>å…³äºhashCodeæ–¹æ³•çš„çº¦å®šåŸæ–‡æ¯”è¾ƒå¤šï¼Œå¤§å®¶ç›´æ¥çœ‹æºç å³å¯çœ‹åˆ°ï¼Œè¿™é‡Œæ±‡æ€»ä¸€ä¸‹ï¼Œå…±ä¸‰æ¡ï¼š</p><p style=text-align:start>ï¼ˆ1ï¼‰å¦‚æœå¯¹è±¡åœ¨ä½¿ç”¨equalsæ–¹æ³•ä¸­è¿›è¡Œæ¯”è¾ƒçš„å‚æ•°æ²¡æœ‰ä¿®æ”¹ï¼Œé‚£ä¹ˆå¤šæ¬¡è°ƒç”¨ä¸€ä¸ªå¯¹è±¡çš„hashCode()æ–¹æ³•è¿”å›çš„å“ˆå¸Œå€¼åº”è¯¥æ˜¯ç›¸åŒçš„ã€‚</p><p style=text-align:start>ï¼ˆ2ï¼‰å¦‚æœä¸¤ä¸ªå¯¹è±¡é€šè¿‡equalsæ–¹æ³•æ¯”è¾ƒæ˜¯ç›¸ç­‰çš„ï¼Œé‚£ä¹ˆè¦æ±‚è¿™ä¸¤ä¸ªå¯¹è±¡çš„hashCodeæ–¹æ³•è¿”å›çš„å€¼ä¹Ÿåº”è¯¥æ˜¯ç›¸ç­‰çš„ã€‚</p><p style=text-align:start>ï¼ˆ3ï¼‰å¦‚æœä¸¤ä¸ªå¯¹è±¡é€šè¿‡equalsæ–¹æ³•æ¯”è¾ƒæ˜¯ä¸åŒçš„ï¼Œé‚£ä¹ˆä¹Ÿä¸è¦æ±‚è¿™ä¸¤ä¸ªå¯¹è±¡çš„hashCodeæ–¹æ³•è¿”å›çš„å€¼æ˜¯ä¸ç›¸åŒçš„ã€‚ä½†æ˜¯æˆ‘ä»¬åº”è¯¥çŸ¥é“å¯¹äºä¸åŒå¯¹è±¡äº§ç”Ÿä¸åŒçš„å“ˆå¸Œå€¼å¯¹äºå“ˆå¸Œè¡¨(HashMapç­‰)èƒ½å¤Ÿæé«˜æ€§èƒ½ã€‚</p><p style=text-align:start>å…¶å®ï¼Œçœ‹åˆ°è¿™é‡Œæˆ‘ä»¬äº†è§£äº†hashCodeçš„å®ç°è§„çº¦ï¼Œä½†è¿˜æ˜¯ä¸æ¸…æ¥šä¸ºä»€ä¹ˆå®ç°equalsæ–¹æ³•éœ€è¦é‡å†™hashCodeæ–¹æ³•ã€‚ä½†æˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€æ¡è§„å¾‹ï¼šhashCodeæ–¹æ³•å®é™…ä¸Šå¿…é¡»è¦å®Œæˆçš„ä¸€ä»¶äº‹æƒ…å°±æ˜¯ï¼Œä¸ºequalsæ–¹æ³•è®¤å®šä¸ºç›¸åŒçš„å¯¹è±¡è¿”å›ç›¸åŒçš„å“ˆå¸Œå€¼ã€‚</p><p style=text-align:start>å…¶å®åœ¨ä¸Šé¢è§„çº¦ä¸­æåˆ°äº†å“ˆå¸Œè¡¨ï¼Œè¿™ä¹Ÿæ­£æ˜¯hashCodeæ–¹æ³•è¿ç”¨çš„åœºæ™¯ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦é‡å†™çš„æ ¸å¿ƒã€‚</p><h1 class=pgc-h-arrow-right>hashCodeåº”ç”¨åœºæ™¯</h1><p style=text-align:start>å¦‚æœäº†è§£HashMapçš„æ•°æ®ç»“æ„ï¼Œå°±ä¼šçŸ¥é“å®ƒç”¨åˆ°â€œé”®å¯¹è±¡â€çš„å“ˆå¸Œç ï¼Œå½“æˆ‘ä»¬è°ƒç”¨putæ–¹æ³•æˆ–è€…getæ–¹æ³•å¯¹Mapå®¹å™¨è¿›è¡Œæ“ä½œæ—¶ï¼Œéƒ½æ˜¯æ ¹æ®é”®å¯¹è±¡çš„å“ˆå¸Œç æ¥è®¡ç®—å­˜å‚¨ä½ç½®çš„ã€‚å¦‚æœæˆ‘ä»¬å¯¹å“ˆå¸Œç çš„è·å–æ²¡æœ‰ç›¸å…³ä¿è¯ï¼Œå°±å¯èƒ½ä¼šå¾—ä¸åˆ°é¢„æœŸçš„ç»“æœã€‚</p><div class=pgc-img><img alt=é¢è¯•é¢˜ç¬¬4ç¯‡ï¼šé‡å†™äº†equalsï¼Œè¿˜è¦é‡å†™hashCodeï¼Ÿ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9b1f878c17e84c1caa06a5deda2c10f1><p class=pgc-img-caption></p></div><p style=text-align:start>è€Œå¯¹è±¡çš„å“ˆå¸Œç çš„è·å–æ­£æ˜¯é€šè¿‡hashCodeæ–¹æ³•è·å–çš„ã€‚å¦‚æœè‡ªå®šä¹‰çš„ç±»ä¸­æ²¡æœ‰å®ç°è¯¥æ–¹æ³•ï¼Œåˆ™ä¼šé‡‡ç”¨Objectä¸­çš„hashCode()æ–¹æ³•ã€‚</p><p style=text-align:start>åœ¨Objectä¸­è¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªæœ¬åœ°æ–¹æ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªintç±»å‹çš„å“ˆå¸Œå€¼ã€‚å¯ä»¥é€šè¿‡å°†å¯¹è±¡çš„å†…éƒ¨åœ°å€è½¬æ¢ä¸ºæ•´æ•°æ¥å®ç°çš„ï¼Œä½†æ˜¯Javaä¸­æ²¡æœ‰å¼ºåˆ¶è¦æ±‚é€šè¿‡è¯¥æ–¹å¼å®ç°ã€‚</p><p style=text-align:start>å…·ä½“å®ç°ç½‘ç»œä¸Šæœ‰ä¸åŒçš„è¯´æ³•ï¼Œæœ‰è¯´é€šè¿‡å†…ç½®åœ°å€è½¬æ¢å¾—æ¥ï¼Œä¹Ÿæœ‰è¯´â€œOpenJDK8é»˜è®¤hashCodeçš„è®¡ç®—æ–¹æ³•æ˜¯é€šè¿‡å’Œå½“å‰çº¿ç¨‹æœ‰å…³çš„ä¸€ä¸ªéšæœºæ•°+ä¸‰ä¸ªç¡®å®šå€¼ï¼Œè¿ç”¨Marsaglia's xorshift schemeéšæœºæ•°ç®—æ³•å¾—åˆ°çš„ä¸€ä¸ªéšæœºæ•°â€è·å¾—ã€‚</p><p style=text-align:start>æ— è®ºé»˜è®¤å®ç°æ˜¯æ€æ ·çš„ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æ— æ³•æ»¡è¶³equalsæ–¹æ³•ç›¸åŒï¼ŒåŒæ—¶hashCodeç»“æœä¹Ÿç›¸åŒçš„æ¡ä»¶ã€‚æ¯”å¦‚ä¸‹é¢çš„ç¤ºä¾‹é‡å†™ä¸å¦å·®è·å¾ˆå¤§ã€‚</p><pre><code>public void test1() {	String s = "ok";	StringBuilder sb = new StringBuilder(s);	System.out.println(s.hashCode() + "  " + sb.hashCode());	String t = new String("ok");	StringBuilder tb = new StringBuilder(s);	System.out.println(t.hashCode() + "  " + tb.hashCode());}</code></pre><p style=text-align:start>ä¸Šé¢è¿™æ®µä»£ç æ‰“å°çš„ç»“æœä¸ºï¼š</p><pre><code>3548  18336389143548  1620303253</code></pre><p style=text-align:start>Stringå®ç°äº†hashCodeæ–¹æ³•ï¼Œè€ŒStringBuilderå¹¶æ²¡æœ‰å®ç°ï¼Œè¿™å°±å¯¼è‡´å³ä½¿å€¼æ˜¯ä¸€æ ·çš„ï¼ŒhashCodeä¹Ÿä¸åŒã€‚</p><p style=text-align:start>ä¸Šä¸ªç¤ºä¾‹ä¸­é—®é¢˜è¿˜ä¸å¤ªæ˜æ˜¾ï¼Œä¸‹é¢æˆ‘ä»¬ä»¥HashMapä¸ºä¾‹ï¼Œçœ‹çœ‹å¦‚æœæ²¡æœ‰å®ç°hashCodeæ–¹æ³•ä¼šå¯¼è‡´ä»€ä¹ˆä¸¥é‡çš„åæœã€‚</p><pre><code>@Testpublic void test2() {	String hello = "hello";	Map&lt;String, String&gt; map1 = new HashMap&lt;&gt;();	String s1 = new String("key");	String s2 = new String("key");	map1.put(s1, hello);	System.out.println("s1.equals(s2):" + s1.equals(s2));	System.out.println("map1.get(s1):" + map1.get(s1));	System.out.println("map1.get(s2):" + map1.get(s2));	Map&lt;Key, String&gt; map2 = new HashMap&lt;&gt;();	Key k1 = new Key("A");	Key k2 = new Key("A");	map2.put(k1, hello);	System.out.println("k1.equals(k2):" + s1.equals(s2));	System.out.println("map2.get(k1):" + map2.get(k1));	System.out.println("map2.get(k2):" + map2.get(k2));}class Key {	private String k;	public Key(String key) {		this.k = key;	}	@Override	public boolean equals(Object obj) {		if (obj instanceof Key) {			Key key = (Key) obj;			return k.equals(key.k);		}		return false;	}}</code></pre><p style=text-align:start>å®ä¾‹ä¸­å®šä¹‰äº†å†…éƒ¨ç±»Keyï¼Œå…¶ä¸­å®ç°äº†equalsæ–¹æ³•ï¼Œä½†æœªå®ç°hashCodeæ–¹æ³•ã€‚å­˜æ”¾äºMapä¸­çš„valueå€¼éƒ½æ˜¯å­—ç¬¦ä¸²â€œhelloâ€ã€‚</p><p style=text-align:start>ä»£ç åˆ†ä¸¤æ®µï¼Œç¬¬ä¸€æ®µæ¼”ç¤ºå½“Mapçš„keyé€šè¿‡å®ç°äº†hashCodeçš„Stringæ—¶æ˜¯ä»€ä¹ˆæ•ˆæœï¼›ç¬¬äºŒæ®µæ¼”ç¤ºäº†å½“Mapçš„keyé€šè¿‡æœªå®ç°hashCodeæ–¹æ³•çš„Keyå¯¹è±¡æ—¶æ˜¯ä»€ä¹ˆæ•ˆæœã€‚</p><p style=text-align:start>æ‰§è¡Œä¸Šè¿°ä»£ç ï¼Œæ‰“å°ç»“æœå¦‚ä¸‹ï¼š</p><pre><code>s1.equals(s2):truemap1.get(s1):hellomap1.get(s2):hellok1.equals(k2):truemap2.get(k1):hellomap2.get(k2):null</code></pre><p style=text-align:start>åˆ†æç»“æœå¯ä»¥çœ‹å‡ºï¼Œå¯¹äºStringä½œä¸ºkeyçš„s1å’Œs2æ¥è¯´ï¼Œé€šè¿‡equalsæ¯”è¾ƒç›¸ç­‰æ˜¯è‡ªç„¶çš„ï¼Œè·å¾—çš„å€¼ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚ä½†k1å’Œk2é€šè¿‡equalsæ¯”è¾ƒæ˜¯ç›¸ç­‰ï¼Œä½†ä¸ºä»€ä¹ˆåœ¨Mapä¸­è·å¾—çš„ç»“æœå´ä¸ä¸€æ ·ï¼Ÿæœ¬è´¨ä¸Šå°±æ˜¯å› ä¸ºæ²¡æœ‰é‡å†™hashCodeæ–¹æ³•å¯¼è‡´Mapåœ¨å­˜å‚¨å’Œè·å–è¿‡ç¨‹ä¸­è°ƒç”¨hashCodeæ–¹æ³•è·å¾—çš„å€¼ä¸ä¸€è‡´ã€‚</p><p style=text-align:start>æ­¤æ—¶åœ¨Keyç±»ä¸­æ·»åŠ hashCodeæ–¹æ³•ï¼š</p><pre><code>@Overridepublic int hashCode(){	return k.hashCode();}</code></pre><p style=text-align:start>å†æ¬¡æ‰§è¡Œï¼Œä¾¿å¯æ­£å¸¸è·å¾—å¯¹åº”çš„å€¼ã€‚</p><pre><code>s1.equals(s2):truemap1.get(s1):hellomap1.get(s2):hellok1.equals(k2):truemap2.get(k1):hellomap2.get(k2):hello</code></pre><p style=text-align:start>é€šè¿‡ä¸Šé¢çš„å…¸å‹å®ä¾‹æ¼”ç¤ºäº†ä¸é‡å†™hashCodeæ–¹æ³•çš„æ½œåœ¨åæœã€‚ç®€å•çœ‹ä¸€ä¸‹HashMapä¸­çš„putæ–¹æ³•ã€‚</p><pre><code>public V put(K key, V value) {    return putVal(hash(key), key, value, false, true);}static final int hash(Object key) {    int h;    return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);}final V putVal(int hash, K key, V value, boolean onlyIfAbsent,               boolean evict) {    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i;    if ((tab = table) == null || (n = tab.length) == 0)        n = (tab = resize()).length;    // é€šè¿‡å“ˆå¸Œå€¼æ¥æŸ¥æ‰¾åº•å±‚æ•°ç»„ä½äºè¯¥ä½ç½®çš„å…ƒç´ pï¼Œå¦‚æœpä¸ä¸ºnullï¼Œåˆ™ä½¿ç”¨æ–°çš„é”®å€¼å¯¹æ¥è¦†ç›–æ—§çš„é”®å€¼å¯¹    if ((p = tab[i = (n - 1) &amp; hash]) == null)        tab[i] = newNode(hash, key, value, null);    else {        Node&lt;K,V&gt; e; K k;        // (äºŒè€…å“ˆå¸Œå€¼ç›¸ç­‰)ä¸”(äºŒè€…åœ°å€å€¼ç›¸ç­‰æˆ–è°ƒç”¨equalsè®¤å®šç›¸ç­‰)ã€‚        if (p.hash == hash &amp;&amp;            ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))            e = p;        else if (p instanceof TreeNode)            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value);        else {            for (int binCount = 0; ; ++binCount) {                if ((e = p.next) == null) {                    p.next = newNode(hash, key, value, null);                    if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st                        treeifyBin(tab, hash);                    break;                }                if (e.hash == hash &amp;&amp;                    ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))                    break;                p = e;            }        }        // å¦‚æœåº•å±‚æ•°ç»„ä¸­å­˜åœ¨ä¼ å…¥çš„Keyï¼Œé‚£ä¹ˆä½¿ç”¨æ–°ä¼ å…¥çš„è¦†ç›–æ‰æŸ¥åˆ°çš„        if (e != null) { // existing mapping for key            V oldValue = e.value;            if (!onlyIfAbsent || oldValue == null)                e.value = value;            afterNodeAccess(e);            return oldValue;        }    }    ++modCount;    if (++size &gt; threshold)        resize();    afterNodeInsertion(evict);    return null;}</code></pre><p style=text-align:start>åœ¨ä¸Šè¿°æ–¹æ³•ä¸­ï¼Œputæ–¹æ³•åœ¨æ‹¿åˆ°keyçš„ç¬¬ä¸€æ­¥å°±å¯¹keyå¯¹è±¡è°ƒç”¨äº†hashCodeæ–¹æ³•ã€‚æš‚ä¸”ä¸çœ‹åé¢çš„ä»£ç ï¼Œå¦‚æœæ²¡æœ‰é‡å†™hashCodeæ–¹æ³•ï¼Œå°±æ— æ³•ç¡®ä¿keyçš„hashå€¼ä¸€è‡´ï¼Œåç»­æ“ä½œå°±æ˜¯ä¸¤ä¸ªkeyçš„æ“ä½œäº†ã€‚</p><h1 class=pgc-h-arrow-right>é‡å†™hashCodeæ–¹æ³•</h1><p style=text-align:start>äº†è§£äº†é‡å†™hashCodeæ–¹æ³•çš„é‡è¦æ€§ï¼Œä¹Ÿäº†è§£äº†å¯¹åº”çš„è§„çº¦ï¼Œé‚£ä¹ˆä¸‹é¢æˆ‘ä»¬å°±èŠèŠå¦‚ä½•ä¼˜é›…çš„é‡å†™hashCodeæ–¹æ³•ã€‚</p><p style=text-align:start>é¦–å…ˆï¼Œå¦‚æœä½¿ç”¨IDEAçš„è¯ï¼Œé‚£ä¹ˆç›´æ¥ä½¿ç”¨å¿«æ·é”®å³å¯ã€‚</p><div class=pgc-img><img alt=é¢è¯•é¢˜ç¬¬4ç¯‡ï¼šé‡å†™äº†equalsï¼Œè¿˜è¦é‡å†™hashCodeï¼Ÿ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0ff7d86bc96d4a43bb149b499f35d8a1><p class=pgc-img-caption></p></div><p style=text-align:start>ç”Ÿæˆçš„æ•ˆæœå¦‚ä¸‹ï¼š</p><pre><code>@Overridepublic boolean equals(Object o) {	if (this == o) {		return true;	}	if (o == null || getClass() != o.getClass()) {		return false;	}	Key key = (Key) o;	return Objects.equals(k, key.k);}@Overridepublic int hashCode() {	return Objects.hash(k);}</code></pre><p style=text-align:start>æ ¹æ®éœ€è¦å¯å¯¹ç”Ÿæˆçš„æ–¹æ³•å†…éƒ¨å®ç°è¿›è¡Œä¿®æ”¹ã€‚åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ç”¨åˆ°äº†java.util.Objectsç±»ï¼Œå®ƒçš„hashæ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å¦‚æœå‚æ•°ä¸ºnullï¼Œå°±åªè¿”å›0ï¼Œå¦åˆ™è¿”å›å¯¹è±¡å‚æ•°è°ƒç”¨çš„hashCodeçš„ç»“æœã€‚Objects.hashæ–¹æ³•æºç å¦‚ä¸‹ï¼š</p><pre><code>public static int hash(Object... values) {    return Arrays.hashCode(values);}</code></pre><p style=text-align:start>å…¶ä¸­Arrays.hashCodeæ–¹æ³•æºç å¦‚ä¸‹ï¼š</p><pre><code>public static int hashCode(Object a[]) {    if (a == null)        return 0;    int result = 1;    for (Object element : a)        result = 31 * result + (element == null ? 0 : element.hashCode());    return result;}</code></pre><p style=text-align:start>å½“ç„¶æ­¤å¤„åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨Objectsç±»hashCodeæ–¹æ³•ï¼š</p><pre><code>public static int hashCode(Object o) {    return o != null ? o.hashCode() : 0;}</code></pre><p style=text-align:start>å¦‚æœæ˜¯å¤šä¸ªå±æ€§éƒ½å‚ä¸hashå€¼çš„æƒ…å†µå»ºè®®å¯ä½¿ç”¨ç¬¬ä¸€ä¸ªæ–¹æ³•ã€‚åªä¸è¿‡éœ€è¦æ³¨æ„ï¼Œåœ¨ç±»ç»“æ„ï¼ˆæˆå‘˜å˜é‡ï¼‰å˜åŠ¨æ—¶ï¼ŒåŒæ­¥å¢å‡æ–¹æ³•é‡Œé¢çš„å‚æ•°å€¼ã€‚</p><h1 class=pgc-h-arrow-right>å°ç»“</h1><p style=text-align:start>å½“æˆ‘ä»¬å‡†å¤‡é¢è¯•æ—¶ï¼Œä¸€ç›´åœ¨èƒŒè¯µâ€œå®ç°equalsæ–¹æ³•çš„åŒæ—¶ä¹Ÿè¦å®ç°hashCodeæ–¹æ³•â€ï¼Œç‰¢è®°è¿™äº›ç»“è®ºå¹¶æ²¡æœ‰é”™ã€‚ä½†æˆ‘ä»¬ä¹Ÿä¸èƒ½å› ä¸ºåŒ†å¿™å‡†å¤‡é¢è¯•é¢˜ï¼Œè€Œå¿˜è®°äº†è¿™äº›é¢è¯•é¢˜ä¹‹æ‰€ä»¥é¢‘ç¹å‡ºç°çš„åŸå› æ˜¯ä»€ä¹ˆã€‚å½“æ·±å…¥æ¢ç´¢ä¹‹åï¼Œä¼šå‘ç°åœ¨é‚£äº›æ¯ç‡¥çš„ç»“è®ºèƒŒåè¿˜æœ‰è¿™ä¹ˆå¤šä¸å®¹å¿½è§†çš„çŸ¥è¯†ç‚¹ï¼Œè¿˜æœ‰è¿™ä¹ˆå¤šæœ‰æ„æ€çš„è®¾è®¡ä¸é™·é˜±ã€‚</p><p style=text-align:start>æˆ‘æ˜¯è§‰å¾—è¶Šç ”ç©¶è¶Šæœ‰æ„æ€ï¼Œè¶Šç ”ç©¶è¶Šå‘ç°è‡ªå·±æ›¾ç»çš„æ— çŸ¥ã€‚ä½ å‘¢ï¼Ÿå…³æ³¨ä¸€ä¸‹ï¼ŒæœŸå¾…ä¸‹ä¸€ç¯‡æ–‡ç« å§ã€‚</p><blockquote class=pgc-blockquote-abstract><p>åŸæ–‡é¦–å‘äºå…¬ä¼—å·ï¼šç¨‹åºæ–°è§†ç•Œ</p></blockquote></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'é‡å†™','é¢è¯•é¢˜','equals'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>