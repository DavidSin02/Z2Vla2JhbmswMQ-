<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>一个很牛的格式化文本函数——TEXT | 极客快訊</title><meta property="og:title" content="一个很牛的格式化文本函数——TEXT - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/bfe0a610021f4fddbb62bd926ed43167"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/35fb3da0.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/35fb3da0.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/35fb3da0.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/35fb3da0.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/35fb3da0.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/35fb3da0.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/35fb3da0.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/35fb3da0.html><meta property="article:published_time" content="2020-11-14T21:00:59+08:00"><meta property="article:modified_time" content="2020-11-14T21:00:59+08:00"><meta name=Keywords content><meta name=description content="一个很牛的格式化文本函数——TEXT"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/35fb3da0.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>一个很牛的格式化文本函数——TEXT</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>TEXT函数是一个超级好用的格式化文本函数</p><p><strong>函数基础</strong></p><p>功能：</p><p>TEXT 函数可通过格式代码对数字应用格式，从而更改数字的显示方式。</p><p>如果要按更可读的格式显示数字，或者将数字与文本或符号组合，它将非常有用。</p><p>语法</p><p>TEXT(数值,格式代码)</p><ul><li>Value：数值，或是计算结果为数字值的公式，也或对包含数字值的单元格的引用。</li><li>Format_text：文本形式的数字格式。</li></ul><p>text返回的一律都是文本形式的数据。如果需要计算，可以先将文本转换为数值，然后再计算。</p><p>文本型数值遇到四则运算会自动转为数值。</p><p>但文本会不参与sum之类的函数运算。</p><p>分类应用</p><p>TEXT 函数主要是通过格式代码来应用格式的。</p><p>今天，韩老师来讲TEXT函数格式日期与时间的用法：</p><p><strong>1、格式日期</strong></p><p>先看下图，TEXT函数通过不同的格式代码，转换日期格式的结果：</p><p>（格式代码，即是TEXT公式的第二个参数，下图公式中“”内的部分）</p><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/bfe0a610021f4fddbb62bd926ed43167><p class=pgc-img-caption></p></div><p>公式中的代码及其含义：</p><p>代码含义m将月显示为不带前导零的数字。mm根据需要将月显示为带前导零的数字。mmm将月显示为缩写形式（Jan 到 Dec）。mmmm将月显示为完整名称（January 到 December）。d将日显示为不带前导零的数字。dd根据需要将日显示为带前导零的数字。ddd将日显示为缩写形式（Sun 到 Sat）。dddd将日显示为完整名称（Sunday 到 Saturday）。yy将年显示为两位数字。yyyy将年显示为四位数字。</p><p>另：阿拉伯数字与中文数字转换时：</p><ul><li>格式参数为'[dbnum1]'：普通的大写，如“七百八十九”；</li><li>格式参数为'[dbnum2]'：财务专用大写，如“柒佰捌拾玖”；</li><li>格式参数为'[dbnum3]'：阿拉伯数字之间加单位，如“７百８十９”；但用'[dbnum3]'转成的数字是全角，所与如果转换成普通的半角，TEXT函数之外要套用ASC函数。</li></ul><p><strong>2、格式时间</strong></p><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0b1166bccd974bc59bdb1de0c33b98b6><p class=pgc-img-caption></p></div><p>公式中的代码及其含义：</p><p>代码含义h将小时显示为不带前导零的数字。[h]以小时为单位显示经过的时间。如果使用了公式，该公式返回小时数超过 24 的时间，请使用类似于 [h]:mm:ss 的数字格式。hh根据需要将小时显示为带前导零的数字。如果格式含有 AM 或 PM，则基于 12 小时制显示小时；否则，基于 24 小时制显示小时。m将分钟显示为不带前导零的数字。 注释 m 或 mm 代码必须紧跟在 h 或 hh 代码之后或紧跟在 ss 代码之前；否则，Excel 会显示月份而不是分钟。[m]以分钟为单位显示经过的时间。如果所用的公式返回的分钟数超过 60，请使用类似于 [mm]:ss 的数字格式。mm根据需要将分钟显示为带前导零的数字。 注释 m 或 mm 代码必须紧跟在 h 或 hh 代码之后或紧跟在 ss 代码之前；否则，Excel 会显示月份而不是分钟。s将秒显示为不带前导零的数字。[s]以秒为单位显示经过的时间。如果所用的公式返回的秒数超过 60，请使用类似于 [ss] 的数字格式。ss根据需要将秒显示为带前导零的数字。如果要显示秒的小数部分，请使用类似于 h:mm:ss.00 的数字格式。AM/PM、am/pm、A/P、a/p基于 12 小时制显示小时。时间介于午夜和中午之间时，Excel 会使用 AM、am、A 或 a 表示时间；时间介于中午和午夜之间时，Excel 会使用 PM、pm、P 或 p 表示时间。</p><p><strong>3、千分位分隔符</strong></p><p>要将逗号显示为千位分隔符或按倍数1,000 缩放数字。</p><p>,（逗号）在数字中显示千位分隔符。如果格式中含有被数字符号(#) 或零包围起来的逗号，Excel 会分隔千位。位占位符后的逗号会以1,000 为单位计量数字。例如，如果format_text 参数为 '#,###.0,'，Excel会将数字 12,200,000显示为 12,200.0。</p><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/25ff7045164b4ee4acd803fc0d38db54><p class=pgc-img-caption></p></div><p>公式中的代码及其含义：</p><p>代码含义'#,###'只保留整数'#,###.00'保留两位小数'#,'显示为1,000的整倍数'#,###.0,'显示为1,000的整倍数，且保留一位小数'0.0,,'显示为1,000,000的整倍数，且保留一位小数</p><p>其中：# 只显示有意义的数字而不显示无意义的零。</p><p><strong>4、格式数字、货币</strong></p><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a0634371822447dcac8695aa6fd3cd88><p class=pgc-img-caption></p></div><p>公式中的代码及其含义：</p><p>代码含义'0.00'只保留整数'#,##0'千分位分隔符，只保留整数'#,##0.00'千分位分隔符，保留整数两位小数'$#,##0'只保留整数'$#,##0.00'保留两位小数'$#,##0.00_);($#,##0.00)'两位小数，负数'$ * #,##0'只保留整数，$与数字间一个空字符'$ * #,##0.00'两位小数，$与数字间一个空字符</p><p><strong>5、加0前导符补充位数</strong></p><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/d6cc6f86fbe24f41b7e017ef25c45fb7><p class=pgc-img-caption></p></div><p><strong>6、百分比</strong></p><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/204243d6ed1c4a23809aaf2b7b2f3e1f><p class=pgc-img-caption></p></div><p><strong>7、特殊格式</strong></p><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d6309b455ef04000a1302be8f4201ace><p class=pgc-img-caption></p></div><p><strong>8、条件区段判断</strong></p><p><strong>8.1四个条件区段：</strong></p><p>TEXT函数的格式代码默认分为4个条件区段，各区段之间用半角分号间隔。</p><p>默认情况下，这四个区段的定义为：</p><p>[>0];[&lt;0];[=0];[文本]</p><p><strong>【举例1】</strong>按区段条件判断，然后返回相应结果：</p><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5215813af5d24b56b2a4a917e24d9451><p class=pgc-img-caption></p></div><p>公式：=TEXT(A2,'0.00;-0;0;文本')的含义是：</p><p>A2单元格的值，按照四种情况返回结果：</p><ul><li>>0，保留两位小数；</li><li>&lt;0，只保留整数；</li><li>=0，返回0值；</li><li>文本，返回“文本”二字。</li></ul><p><strong>【举例2】</strong>按区段条件，强制返回相应结果：</p><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/84d53ceadfbc45fd89b04186f35231f9><p class=pgc-img-caption></p></div><p>公式：=TEXT(A8,'1!0!0;5!0;0;文本')的含义是：</p><p>A8单元格的值，按照四种情况返回结果：</p><ul><li>>0，返回100；</li><li>&lt;0，返回50；</li><li>=0，返回0值；</li><li>文本，返回“文本”二字。</li></ul><p>公式中使用的感叹号（英文半角）是转义字符，强制其后的第一个字符不具备代码的含义，而仅仅是数字。比如：1!0!0，将两个0强制成数字0，而不是数字格式代码0。</p><p>在实际应用中，可以使用部分条件区段。</p><p><strong>8.2三个条件区段：</strong></p><p>三个区段为：</p><p>[>0];[&lt;0];[=0]</p><p><strong>【举例3】</strong></p><p>公式：=TEXT(A15,'盈利;亏损;平衡')的含义是：</p><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/44b0c9d4bd08480a84f93ad5cc30a09d><p class=pgc-img-caption></p></div><p>A15单元格的值，按照三种情况返回结果：</p><ul><li>>0，返回“盈利”；</li><li>&lt;0，返回“亏损”；</li><li>=0，返回“平衡”；</li></ul><p><strong>8.3两个条件区段：</strong></p><p>两个区段的为：</p><p>[>0];[&lt;0]</p><p><strong>【举例4】</strong></p><p>公式：=TEXT(A22,'盈利;亏损')的含义是：</p><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3f410328767b434c91e28f5ebde00753><p class=pgc-img-caption></p></div><p>A22单元格的值，按照两种情况返回结果：</p><ul><li>>0，返回“盈利”；</li><li>&lt;0，返回“亏损”；</li></ul><p>一个区段的，就不讲了，昨天前天的两篇文章，都算是一个区段的。</p><p><strong>9、自定义条件区段</strong></p><p>TEXT函数除了可以使用默认区段以外，还可以自定义条件区段。</p><p><strong>9.1四个自定义条件区段：</strong></p><p>四个区段的定义为：</p><p>[条件1];[条件2];[不满足条件的其他部分];[文本]</p><p><strong>【举例5】</strong></p><p>公式：=TEXT(A38,'[>=85]优秀;[>=60]合格;不合格;无成绩')的含义是：</p><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/035a7bf093c540b99c4aac0b9a1e3fc6><p class=pgc-img-caption></p></div><p>A38单元格的值，按照自定义的四种情况返回结果：</p><ul><li>>=85，返回“优秀”；</li><li>>=60，返回“合格”；</li><li>不满足以上条件的数值，返回“不合格”；</li><li>非数值，返回“文本”二字。</li></ul><p><strong>9.2三个自定义条件区段：</strong></p><p>三个区段的定义为：</p><p>[条件1];[条件2];[不满足条件的其他部分]</p><p><strong>【举例6】</strong></p><p>公式：=TEXT(A46,'[>=85]优秀;[>=60]合格;不合格')的含义是：</p><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/80851863821f4c2891c6ec79422c4570><p class=pgc-img-caption></p></div><p>A46单元格的值，按照自定义的四种情况返回结果：</p><ul><li>>=85，返回“优秀”；</li><li>>=60，返回“合格”；</li><li>不满足以上条件，返回“不合格”；</li></ul><p><strong>9.3两个自定义条件区段：</strong></p><p>两个区段的定义为：</p><p>[条件];[不满足条件的其他部分]</p><p><strong>【举例7】</strong></p><p>公式：=TEXT(A54,'[>=60]合格;不合格')的含义是：</p><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1d085e68877943489b30e57583f49f8f><p class=pgc-img-caption></p></div><p>A54单元格的值，按照自定义的四种情况返回结果：</p><ul><li>>=60，返回“合格”；</li><li>不满足以上条件，返回“不合格”；</li></ul><p><strong>10、巧用TEXT嵌套自定义多条件区段</strong></p><p>以上举例中，我们可以看到，成绩只能判断到“优秀、合格、不合格”级别，如果再多级别，一个TEXT就解决不了了。TEXT函数也可以嵌套解决这个问题：</p><p><strong>【举例8】</strong></p><p>要求：</p><p>90分及以上，返回“优秀”；</p><p>70分及以上，返回“良好”；</p><p>60分及以上，返回“合格”；</p><p>60分以下，返回“不合格”。</p><p>结果如下：</p><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/21c252e53d964b3eb88e2bde4555e488><p class=pgc-img-caption></p></div><p>公式：TEXT(TEXT(A62-60,'[>=30]优秀;不合格;0'),'[>=10]良好;合格')，分解来解释：</p><p>TEXT(A62-60,'[>=30]优秀;不合格;0')</p><p>对A62-60进行分段计算：</p><ul><li>如果>=30，返回“优秀”；</li><li>如果&lt;0，返回“不合格”；</li><li>不满足以上条件，返回成绩的整数。</li><li>如果成绩中有小数，最后一个区段可以写成0.0，或0.00.</li></ul><p>通过这个公式，把成绩分段成了>=90,&lt;60,60~89三个区段。</p><p>TEXT(TEXT(A62-60,'[>=30]优秀;不合格;0'),'[>=10]良好;合格')</p><p>这一部分，对60~89的成绩，减去60，然后计算：</p><ul><li>如果>=10，返回“良好”；</li><li>否则，返回“合格”；</li></ul><div class=pgc-img><img alt=一个很牛的格式化文本函数——TEXT onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f747495caf3e475ca941efc07c982b1d><p class=pgc-img-caption></p></div></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'一个','函数','TEXT'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>