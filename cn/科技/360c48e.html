<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>H3C配置经典全面教程 | 极客快訊</title><meta property="og:title" content="H3C配置经典全面教程 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/590e48895fe34e4b8dafc12000636709"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/360c48e.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/360c48e.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/360c48e.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/360c48e.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/360c48e.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/360c48e.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/360c48e.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/360c48e.html><meta property="article:published_time" content="2020-10-29T20:51:46+08:00"><meta property="article:modified_time" content="2020-10-29T20:51:46+08:00"><meta name=Keywords content><meta name=description content="H3C配置经典全面教程"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/360c48e.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>H3C配置经典全面教程</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><strong>1 H3C MSR路由器、交换机基本调试步骤（初学级别）：</strong></p><hr><p><strong>1.1如何登陆进路由器或交换机</strong></p><p>1.1.1搭建配置环境</p><p>第一次使用H3C系列路由器时，只能通过配置口(Console)进行配置。</p><p>1）将配置电缆的RJ-45一端连到路由器的配置口(Console)上。</p><p>2）将配置电缆的DB-9(或DB-25)孔式插头接到要对路由器进行配置的微机或终端的串口上。</p><p></p><div class=pgc-img><img alt=H3C配置经典全面教程 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/590e48895fe34e4b8dafc12000636709><p class=pgc-img-caption></p></div><p></p><p>备注：登陆交换机的方法与路由器的一致，现仅用路由器举</p><p>1.1.2设置微机或终端的参数（进入路由器或交换机）</p><p>1）打开微机（笔记本电脑）或终端。如果使用微机进行配置，需要在微机上运行终端仿真程序，如windows的超级终端。</p><div class=pgc-img><img alt=H3C配置经典全面教程 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/49252d671b244fc09127851dd1fcfd70><p class=pgc-img-caption></p></div><p></p><p>2）第二步：设置终端参数</p><p>a、命名此终端 H3C或者自己想命的名</p><div class=pgc-img><img alt=H3C配置经典全面教程 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/36cd6ab7f32f4f73b471c544685621d6><p class=pgc-img-caption></p></div><p></p><p>b、选择串口 一般选用COM口，常选用COM1</p><div class=pgc-img><img alt=H3C配置经典全面教程 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/793ca55c0c6d4304af45978f41b03842><p class=pgc-img-caption></p></div><p></p><p>c、设置终端具体参数(此处点击“默认值”即可)</p><div class=pgc-img><img alt=H3C配置经典全面教程 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2fa25d21cdbd44199c9087bc21eea1cb><p class=pgc-img-caption></p></div><p></p><p>d、打开路由器的电源，路由器进行启动</p><div class=pgc-img><img alt=H3C配置经典全面教程 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/034118124dc545688b2751a052cdba6e><p class=pgc-img-caption></p></div><p></p><p>e、当路由器启动完毕后，回车几下，当出现&lt;H3C>时即可配置路由器。</p><div class=pgc-img><img alt=H3C配置经典全面教程 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f832c8e940624e4cafd8d264e1e7dcd2><p class=pgc-img-caption></p></div><p></p><p><strong>1.2路由器基本调试命令</strong></p><p>1.2.1使用本地用户进行telnet登录的认证</p><p>&lt;H3C> system-view 进入系统视图</p><p>[H3C]telnet server enable 打开路由器的telnet功能</p><p>[H3C]configure-user count <strong>5</strong> 设置允许同时配置路由器的用户数</p><p>[H3C]local-user <strong>telnet</strong> 添加本地用户(此处为telnet用户登陆时使用的用户名)</p><p>[H3C-luser-telnet]password simple <strong>h3c</strong> 设置telnet用户登陆时所使用的密码</p><p>[H3C-luser-telnet]service-type telnet 设置本地用户的服务类型(此处为telnet)</p><p>[H3C-luser-telnet]level 3 设置本地用户的服务级别</p><p>[H3C-luser-telnet]quit 退出本地用户视图</p><p>[H3C]</p><p>[H3C]user-interface vty 0 4 进入用户视图</p><p>[H3C-ui-vty0-4]authentication-mode scheme 选择“scheme”认证方式</p><p>备注：红色部分可以由客户自行设置，此处仅做举例时使用!</p><p>1.2.2路由器接口的配置</p><p>为接口配置ip地址</p><p>&lt;H3C> system-view 进入系统视图</p><p>[H3C] interface serial 3/0 进入某个端口</p><p>[H3C-Serial3/0] ip address<strong> 200.1.1.1 255.255.255.0 </strong>为该端口设置ip地址</p><p>[H3C-Serial3/0] undo shutdown 对该端口进行复位</p><p>[H3C-Serial3/0] quit 退回到系统视图</p><p>[H3C]</p><p>备注：红色部分可以由客户自行设置，此处仅做举例时使用!</p><p>1.2.3静态路由或默认路由的配置</p><p>&lt;H3C> system-view 进入系统视图</p><p>[H3C]ip route-static <strong>192.168.1.0 255.255.255.0 192.168.0.1 </strong>添加一条静态路由</p><p>[H3C]ip route-static<strong> 0.0.0.0 0.0.0.0 192.168.0.1 </strong>添加一条默认路由</p><p>备注：红色部分可以由客户自行设置，此处仅做举例时使用!</p><p>1.2.3配置文件的管理</p><p>display current-configuration 显示当前的配置文件</p><p>&lt;H3C>save 保存配置文件</p><p>display interface <strong>GigabitEthernet 0/0 </strong>查看某端口的状态</p><p>备注：</p><p>display命令可以在任何视图下进行</p><p>红色部分可以由客户自行设置，此处仅做举例时使用!</p><p>交换机的配置文件管理与路由器相同，故交换机的配置幻灯片中不再做举例。</p><p><strong>1.3 交换机的基本调试命令</strong></p><p>1.3.1 创建VLAN并将端口加入到vlan中</p><p>&lt;H3C> system-view 进入系统视图</p><p>[H3C]vlan <strong>10</strong> 创建vlan 10</p><p>[H3C-vlan100]port ethernet <strong>0/1 </strong>将某个端口加入到vlan中</p><p>[H3C-vlan100]quit 退出到系统</p><p>[H3C]</p><p>备注：红色部分可以由客户自行设置，此处仅做举例时使用!</p><p>1.3.2创建vlan虚接口并为接口配置ip地址</p><p>&lt;H3C> system-view 进入系统视图</p><p>[H3C]interface vlan-interface <strong>1</strong> 创建vlan虚接口</p><p>[H3C-Vlan-interface100] ip address <strong>192.168.1.1 255.255.255.0</strong> 配置ip地址</p><p>备注：红色部分可以由客户自行设置，此处仅做举例时使用!</p><p>1.3.3 配置默认路由</p><p>[H3C] interface vlan-interface 1</p><p>[H3C-Vlan-interface10] ip address <strong>192.168.1.1 255.255.255.0</strong></p><p>[H3C-Vlan-interface10] quit</p><p>[H3C] ip route-static 0.0.0.0 0.0.0.0 <strong>192.168.1.2 </strong>配置缺省路由</p><p><strong>备注：红色部分可以由客户自行设置，此处仅做举例时使用!</strong></p><p>1.3.4设置端口类型</p><p>&lt;H3C> system-view 进入系统视图</p><p>[H3C]interface ethernet 0/1</p><p>[H3C]port link-type trunk 将端口类型设置为trunk</p><p>[H3C]port trunk permit vlan all trunk端口允许所有vlan通过</p><p>[H3C]save</p><p>Trunk可以收发多个vlan的报文，用于交换机与交换机之间的互连</p><p>1.3.5交换机设置telnet登录的认证配置命令</p><p>&lt;H3C> system-view 进入系统视图</p><p>[H3C]local-user telnet 添加本地用户(此处为telnet用户登陆时使用的用户名)</p><p>[H3C-luser-telnet]password simple h3c 设置telnet用户登陆时所使用的密码</p><p>[H3C-luser-telnet]service-type telnet 设置本地用户的服务类型(此处为telnet)</p><p>[H3C-luser-telnet]level 3 设置本地用户的服务级别</p><p>[H3C-luser-telnet]quit 退出本地用户视图</p><p>[H3C]</p><p>[H3C]user-interface vty 0 4 进入用户视图</p><p>[H3C-ui-vty0-4]authentication-mode scheme 选择“scheme”认证方式</p><p><strong>典型案例：</strong></p><p>案例1：如下图，LAB （router）通过配置路由器适当的两台终端电脑能够相互通信，请写出相关配置语句。</p><p></p><div class=pgc-img><img alt=H3C配置经典全面教程 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/171efb02b5c346378794071061dc7889><p class=pgc-img-caption></p></div><p></p><p>案例2：LAB （switch）</p><div class=pgc-img><img alt=H3C配置经典全面教程 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/bfc5c1943d034415bf3ccc3ab0c2c454><p class=pgc-img-caption></p></div><p></p><p><strong>2 H3C交换机基本配置命令（入门级:配置语句拷贝注解）</strong></p><hr><p><strong>2.1 IP地址配置命令：</strong></p><p>&lt;Quidway>system-view----进入系统配置模式</p><p>[Quidway] 系统配置编辑模式</p><p>[Quidway] interface Vlan-interface 1---交换机出厂默认VLAN-1</p><p>[Quidway-Vlan-interface1]ip add 192.168.X.254 255.255.255.0–配置IP地址</p><p>[Quidway-Vlan-interface1]quit</p><p>[Quidway] ip route-static 0.0.0.0 0.0.0.0 192.168.0.33-配置静态路由（网关）</p><p><strong>2.2 远程登录配置命令：</strong></p><p>&lt;Quidway>system-view----进入系统配置模式</p><p>[Quidway] 系统配置编辑模式</p><p>[Quidway] user-interface vty 0 4</p><p>[Quidway-ui-vty0-4] user privilege level 3—管理权限配置</p><p>[Quidway-ui-vty0-4] set authentication password cipher 123456 （cipher为密文密码）</p><p><strong>2.3 配置端口速率及端口双工命令：</strong></p><p>&lt;Quidway>system-view----进入系统配置模式</p><p>[Quidway] 系统配置编辑模式</p><p>[Quidway]interface Ethernet 1/0/1---进入的端口</p><p>[Quidway-Ethernet1/0/1] duplex full—配置端口为“全双工状态”</p><p>[Quidway-Ethernet1/0/1] speed 100---配置端口为“100M”如果是千兆端口可以配置成1000M。</p><p><strong>2.4 划分VLAN配置命令：</strong></p><p>&lt;Quidway>system-view----进入系统配置模式</p><p>[Quidway] 系统配置编辑模式</p><p>[Quidway]VLAN 100---创建VLAN---ID为:100</p><p>[Quidway]VLAN 101---创建VLAN---ID为:101</p><p>[Quidway-vlan100] port Ethernet 1/0/1 to Ethernet 1/0/10----从第1口到第10口添加到VLAN 100</p><p>[Quidway-vlan101] port Ethernet 1/0/11 to Ethernet 1/0/24----从第11口到第24口添加到VLAN 101</p><p><strong>2.5 配置TRUNK命令：</strong></p><p>比如一栋宿舍楼需要两个网段，划分了两个VLAN为100和101，VLAN 100作为管理VLAN配置命令如下：</p><p>&lt;Quidway>system-view----进入系统配置模式</p><p>[Quidway] 系统配置编辑模式</p><p>[Quidway]VLAN 100---创建VLAN---ID为:100</p><p>[Quidway]VLAN 101---创建VLAN---ID为:101</p><p>[Quidway-vlan100] port Ethernet 1/0/1 to Ethernet 1/0/10----从第1口到第10口添加到VLAN 100</p><p>[Quidway-vlan101] port Ethernet 1/0/11 to Ethernet 1/0/24----从第11口到第24口添加到VLAN 101</p><p>[Quidway] interface Vlan-interface 100—进入VLAN 100</p><p>[Quidway-Vlan-interface100]ip address 192.168.100.254 255.255.255.0---给VLAN 100配置管理IP</p><p>[Quidway-Vlan-interface100]quit</p><p>[Quidway]ip route-static 0.0.0.0 0.0.0.0 192.168.100.33—配置静态路由（网关）</p><p>上联端口为千兆端口GigabitEthernet1/1/1在配置模式下配置命令如下：</p><p>[Quidway] interface GigabitEthernet 1/1/1---进入上联端口</p><p>[Quidway-GigabitEthernet1/1/1] port link-type trunk --TRUNK是端口汇聚的意思</p><p>[Quidway-GigabitEthernet1/1/1] port trunk permit（允许）vlan all----配置允许通过的VLAN</p><p>如果上联的路由器端口是自适应那么交换机上联口也是自适应，如果配置了1000M全双工那么交换机的上联端口也要配成1000M全双工。如下命令：[Quidway-GigabitEthernet1/1/1] duplex full—配置端口为“全双工状态”[Quidway-GigabitEthernet1/1/1] speed 1000---配置端口为“1000M”</p><p><strong>2.6 SNMP配置命令：</strong></p><p>[Quidway]snmp-agent community read 1234---SNMP读的密码</p><p>[Quidway]snmp-agent community write 4567—SNMP写的密码</p><p>[Quidway]snmp-agent sys-info version all—SNMP软件版本有V1、V2c、V3这里配置的是允许所有版本。</p><p></p><p><strong>2.7 配置防ARP攻击命令：</strong></p><p>&lt;Quidway>system-view</p><p>[Quidway]dhcp-snooping--开启交换机DHCP Snooping 功能。</p><p>开启VLAN 1 内所有端口的ARP 入侵检测功能。</p><p>[Quidway]vlan 1</p><p>[Quidway-vlan1]arp detection enable</p><p>[Quidway-vlan1]quit</p><p>设置上联端口Ethernet1/0/1 为DHCP Snooping 信任端口，ARP 信任端口。</p><p>[Quidway]interface Ethernet1/0/1</p><p>[Quidway-Ethernet1/0/1]dhcp-snooping trust</p><p>[Quidway-Ethernet1/0/1]arp detection trust</p><p>[Quidway-Ethernet1/0/1]quit</p><p>开启端口Ethernet1/0/2 上的ARP 报文限速功能，设置ARP 报文通过的最大速率为20pps。--目的是针对用户接入口，除上联端口外，下联用户端口建议都设置该命令。如下：</p><p>[Quidway]interface Ethernet1/0/2</p><p>[Quidway-Ethernet1/0/2]arp rate-limit enable</p><p>[Quidway-Ethernet1/0/2]arp rate-limit 20</p><p>[Quidway-Ethernet1/0/2]quit</p><p>配置端口状态自动恢复功能，恢复时间间隔为30 秒。</p><p>[Quidway] arp protective-down recover enable</p><p>[Quidway] arp protective-down recover interval 3</p><p><strong>3 H3C交换机基本配置（中级版）</strong></p><hr><p><strong>3.1VRP，CMW简介</strong></p><p>3.1.1 VRP（Versatile Routing Platform，通用路由平台）是华为公司数据通信产品的通用网络操作系统平台。</p><p>3.1.2 CMW（Comware）是H3C公司的核心软件平台。</p><p>3.1.3 VRP、CMW的体系结构以TCP/IP模型为参考，实现了数据链路层、网络层和应用层的多种协议，其体系结构图如下:</p><div class=pgc-img><img alt=H3C配置经典全面教程 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/424445b39b6f4a209ec13166d783ae07><p class=pgc-img-caption></p></div><p></p><p>3.1.4 VRP视图结构</p><p>用户视图</p><p>系统视图</p><p>　 命令：system-view</p><p>在系统视图下 可以进入各种功能视图，在各功能视图中还可以进入子功能视图</p><div class=pgc-img><img alt=H3C配置经典全面教程 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/81a6c19e78db4d4cbeeb1748b16e9dbb><p class=pgc-img-caption></p></div><p></p><p><strong>3.2基本命令</strong></p><p>3.2.1配置系统名</p><p>1)用途：用户名是设备的名字，目的是让用户更加方便的使用设备．</p><p>2)配置命令: sysname</p><p>3.2.2接口描述</p><p>1)用途：接口描述是为了指明接口的一些属性，如是什么接口，对端接的什么设备等，让用户更加了解该接口。</p><p>2)配置命令: interface ethernet0/1</p><p>description connect to student</p><p>3.2.3接口IP地址的配置</p><p>1)用途:给接口一个网络上唯一的区分符．</p><p>2)配置命令:interface vlan 1</p><p>ip address 168.10.2.1 255.255.255.0</p><p>3.2.4 查看交换机信息</p><p>1)用途:让用户对设备的信息更了解，也有利于对设备做配置．</p><p>2）配置命令:</p><p>　显示版本 display version</p><p>　显示当前配置信息 　 display current</p><p>显示NVRAM的配置 display saved-config</p><p>　显示接口信息　 　display interface XX</p><p>　显示路由信息　 　display ip routing-table</p><p>3.2.5 调试交换机</p><p>1)用途:更细致的查看交换机的各种数据包，帮助发现网络问题．</p><p>2)常用调试命令:</p><p>terminal debugging</p><p>terminal monitor　</p><p>debugging ip packet</p><p>undo debugging all</p><p>3.2.6 端口镜像</p><p>1)用途:通过镜像来抓取网络流量，帮助分析网络问题．</p><p>2)配置命令:</p><p>monitor-port Ethernet 0/1 both （监控端口）</p><p>mirroring-port Ethernet0/2 both（源端口）</p><p>3.2.7 流镜像</p><p>1)用途:</p><p>　通过镜像来抓取网络流量，帮助分析网络问题．</p><p>2)配置命令:</p><p>mirrored-to ip-group 2000 interface Ethernet 0/1</p><p>acl number 2000</p><p>rule 0 permit</p><p>3.2.8快捷命令行介绍</p><p>VRP、CMW</p><p>Ctrl+F 前移一个字符</p><p>Ctrl+B 后移一个字符</p><p>Ctrl+P ↑(向上箭头)重用前一条命令</p><p>Ctrl+N ↓(向下箭头)重用下一条命令</p><p></p><p>3.2.9引导配置</p><p>1)用途:通过引导配置，可以改变从什么地方取得交换机的系统软件．</p><p>2)配置命令</p><p>　boot boot-loader xxxx.bin</p><p>查看命令</p><p>display boot-loader</p><p><strong>3.3交换</strong></p><p>VLAN（Virtual Local Area Network）技术是把一个LAN划分成多个逻辑的“LAN”－VLAN，每个VLAN是一个广播域，VLAN内的主机间通信就和在一个LAN内一样，而VLAN间则不能直接互通，这样，广播报文被限制在一个VLAN内。</p><p>vlan 100 (1-4094) 创建VLAN</p><p>undo vlan 100 (1-4094) 删除VLAN.</p><p>port Ethernet 2/0/1 在VLAN中增加端口.</p><p>undo port Ethernet 2/0/1 在VLAN中删除端口.</p><p>port access vlan 100 (1-4094) 将端口加入VLAN</p><p>undo port access vlan 100 (1-4094) 将端口脱离VLAN</p><p>display vlan VLAN ID (1-4094) 显示VLAN信息</p><p>Trunk</p><p>Trunk允许在只有一条链路的情况下传输VLAN信息</p><p>• 定义端口属性为Trunk.</p><p>port link-type trunk</p><p>• 删除端口Trunk属性.</p><p>undo port link-type</p><p>• 定义端口可以传输的VLAN.</p><p>port trunk permit vlan VLAN ID</p><p>• 在VLAN中删除端口.</p><p>undo port trunk permit vlan VLAN ID</p><p>Link Aggregation</p><p>链路聚合是将几条物理链路聚合在一起，当作一条 逻辑链路来使用。</p><p>分为静态聚合和动态聚合</p><p>• 静态聚合端口.</p><p>link-aggregation Ethernet 0/1 to Ethernet 0/4 both</p><p>• 删除端口的静态聚合.</p><p>undo link-aggregation all</p><p>• 在端口下进行动态聚合.</p><p>lacp enable</p><p>• 在端口下取消动态聚合.</p><p>undo lacp enable</p><p>STP（Spanning Tree Protocol）是生成树协议的英文缩写。该协议可应用于环路网络，通过一定的算法阻断某些冗余路径，将环路网络修剪成无环路的树型网络，从而避免报文在环路网络中的增生和无限循环。</p><p>• 定义STP模式.</p><p>stp mode stp</p><p>• 取消STP模式.</p><p>undo stp mode</p><p>• 定义MSTP模式.</p><p>stp mode mstp</p><p>• 取消MSTP模式.</p><p>undo stp mode</p><p><strong>3.4路由</strong></p><p>3.4.1 RIP</p><p>RIP是Routing Information Protocol（路由信息协议）的简称。它是一种较为简单的内部网关协议（IGP），主要用于规模较小的网络中。</p><p>• 启动RIP，进入RIP视图</p><p>rip</p><p>• 停止RIP协议的运行</p><p>undo rip</p><p>• 在指定的网络接口上应用RIP</p><p>network network-address</p><p>• 在指定的网络接口上取消应用RIP</p><p>undo network network-address</p><p>• 指定接口的RIP版本为RIP-1</p><p>rip version 1</p><p>• 指定接口的RIP版本为RIP-2</p><p>rip version 2 [ broadcast | multicast ]</p><p>• 将接口运行的RIP版本恢复为缺省值</p><p>undo rip version { 1 | 2 }</p><p>3.4.2 OSPF</p><p>OSPF是Open Shortest Path First（开放最短路由优先协议）的缩写。它是IETF组织开发的一个基于链路状态的内部网关协议。目前使用的是版本2（RFC2328）.</p><p>• 定义router id</p><p>• 启动OSPF，进入OSPF视图</p><p>ospf</p><p>关闭OSPF路由协议进程</p><p>undo ospf [ process-id ]</p><p>• 进入OSPF区域视图</p><p>area area-id</p><p>• 删除指定的OSPF区域</p><p>undo area area-id</p><p>• 指定网段运行OSPF协议</p><p>network ip-address wildcard-mask</p><p>• 取消网段运行OSPF协议</p><p>undo network ip-address wildcard-mask</p><p><strong>3.5网络管理</strong></p><p>3.5.1 SNMP的介绍</p><p>• 介绍</p><p>　简单网络管理协议（SNMP)是被广泛应用的一项工业标准，是目前用得最广泛的计算机网络管理协议．</p><p>• 结构</p><p>　SNMP结构分为NMS(Network Management Station)和AGENT两部分，NMS是运行客户端的工作站，AGENT是运行在网络设备上的服务端软件．</p><p>• SNMP版本</p><p>　SNMP现在有三个版本，SNMP v3/v2c/v1,SNMP v3兼容v1和v2c.</p><p>• SNMP的配置包括：</p><p>　启动和关闭SNMP AGENT服务</p><p>　设置团体名</p><p>　配置一个SNMP组</p><p>　设置管理员的联系方法</p><p>　允许／禁止发送Trap报文</p><p>　设置Trap目标主机的地址</p><p>　指定发送报文的源地址</p><p>SNMP实例配置</p><p></p><div class=pgc-img><img alt=H3C配置经典全面教程 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f1748972006444f99bfa85798261f068><p class=pgc-img-caption></p></div><p></p><p>• System-view 进入视图</p><p>• Snmp-agent community read public 只读团体属性名public</p><p>• Snmp-agent communty write private 只写团体属性名private</p><p>• Snmp-agent sys-inf contact Mr.wang-tel 3306 设置管理员联系方法</p><p>• Snmp-agent sys-info location telephone 3rd floor 路由器物理位置</p><p>• Snmp-agent trap enable 使能trap报文</p><p>• Snmp-agent target-host trap address udp-domain 129.102.149.23 udp-port 5000 params securityname public 允许向网管工作站129.102.149.23发送trap报文，使用团体名为public.</p><p></p><p><strong>3.6安全管理</strong></p><p>3.6.1认证与授权</p><p>• 要点</p><p>• 需要确定权利的等级</p><p>• 需要确定授权的策略</p><p>　　Generic or per user</p><p>RADIUS</p><p>Local authentication</p><p>3.6.2认证配置</p><p>• 本地验证</p><p>• VRP的配置</p><p>　 local-user huawei</p><p>password simple 123</p><p>service-type telnet 设置本地认证用户名和密码</p><p>　user-interface vty 0 4 进入vty视图</p><p>　authentication-mode scheme 通过telnet访问的用户使用本地验证</p><p>3.6.3限制授权</p><p>区分用户在设备上的授权</p><p>• 配置等级</p><p>• 视图等级</p><p>• 支持等级</p><p>　使用特权等级（level 1---level 3)</p><p>3.6.4授权配置</p><p>• VRP的配置</p><p>　local-user huawei password simple 123 建立用户</p><p>　local-user huawei level 3 设定授权等级</p><p>• 应用命令</p><p>command-privilege level 3 view serial display interface</p><p>• VRP的命令行保护</p><p>super password level {1/2/3} {simple/cipher} 123</p><p>3.6.5 Vty和console的时间保护</p><p>• 用途</p><p>为了使通过vty和console登陆的设备在使用者离开后不被其他没有授权的人使用．</p><p>• VRP的配置</p><p>Idle-timeout minite second</p><p>3.6.6访问控制列表</p><p>• 概述</p><p>路由器为了过滤数据包，需要配置一系列的规则，以决定什么样的数据包能够通过，这些规则就是通过访问控制列表ACL（Access Control List）定义的。</p><p>• 分类</p><p>基本的访问控制列表（basic acl）</p><p>高级的访问控制列表（advanced acl）</p><p>基于接口的访问控制列表（interface-based acl）</p><p>基于mac的访问控制列表（mac-based acl）</p><p>3.6.7标准访问列表的配置</p><p>• 在系统视图下，创建一个基本访问控制列表</p><p>acl {number number/name name basic} [match- order {config/auto}]</p><p>• 在基本访问控制列表试图下，配置ACL规则．</p><p>rule [rule-id] {permit/deny} [source sour-add sour-wildcast/any] [time-range time-name] [logging] [fragment] [vpn-instance vpn-instance-name]</p><p>acl number 2000</p><p>rule 1 permit source 20.1.1.0 0.0.0.255</p><p><strong>4 H3C配置实验数据注解</strong></p><p>1、system-view 进入系统视图模式</p><p>2、sysname 为设备命名</p><p>3、display current-configuration 当前配置情况</p><p>4、 language-mode Chinese|English 中英文切换</p><p>5、interface Ethernet 1/0/1 进入以太网端口视图</p><p>6、 port link-type Access|Trunk|Hybrid 设置端口访问模式</p><p>7、 undo shutdown 打开以太网端口</p><p>8、 shutdown 关闭以太网端口</p><p>9、 quit 退出当前视图模式</p><p>10、 vlan 10 创建VLAN 10并进入VLAN 10的视图模式</p><p>11、 port access vlan 10 在端口模式下将当前端口加入到vlan 10中</p><p>12、port E1/0/2 to E1/0/5 在VLAN模式下将指定端口加入到当前vlan中</p><p>13、port trunk permit vlan all 允许所有的vlan通过</p><p>H3C路由器######################################################################################</p><p>1、system-view 进入系统视图模式</p><p>2、sysname R1 为设备命名为R1</p><p>3、display ip routing-table 显示当前路由表</p><p>4、 language-mode Chinese|English 中英文切换</p><p>5、interface Ethernet 0/0 进入以太网端口视图</p><p>6、 ip address 192.168.1.1 255.255.255.0 配置IP地址和子网掩码</p><p>7、 undo shutdown 打开以太网端口</p><p>8、 shutdown 关闭以太网端口</p><p>9、 quit 退出当前视图模式</p><p>10、 ip route-static 192.168.2.0 255.255.255.0 192.168.12.2 description To.R2 配置静态路由</p><p>11、 ip route-static 0.0.0.0 0.0.0.0 192.168.12.2 description To.R2 配置默认的路由</p><p>H3C S3100 Switch</p><p>H3C S3600 Switch</p><p>H3C MSR 20-20 Router</p><p>##########################################################################################</p><p>1、调整超级终端的显示字号；</p><p>2、捕获超级终端操作命令行，以备日后查对；</p><p>3、 language-mode Chinese|English 中英文切换 ；</p><p>4、复制命令到超级终端命令行，粘贴到主机；</p><p>5、交换机清除配置 :&lt;H3C>reset save ；&lt;H3C>reboot ；</p><p>6、路由器、交换机配置时不能掉电，连通测试前一定要</p><p>检查网络的连通性，不要犯最低级的错误。</p><p>7、192.168.1.1/24 等同 192.168.1.1 255.255.255.0；在配置交换机和路由器时， 192.168.1.1 255.255.255.0 可以写成：</p><p>192.168.1.1 24</p><p>8、设备命名规则：地名-设备名-系列号 例：PingGu-R-S360</p><p><strong>H3C交换机的一些简单配置</strong></p><p>这里使用的H3C交换机是H126A，仅仅只做了最基本的配置以满足使用。</p><p>配置中可以通过display current-configura命令来显示当前使用的配置内容。</p><p># 配置VLAN 1</p><p>&lt;Sysname>system-view</p><p>System View: return to User View with Ctrl+Z.</p><p>[Sysname]vlan 1</p><p>[Sysname-vlan1] quit</p><p>[Sysname]management-vlan 1</p><p>[Sysname]interface Vlan-interface 1</p><p>[Sysname-Vlan-interface1] ip address 10.0.1.201 255.255.255.0</p><p># 显示VLAN 接口1 的相关信息。</p><p>&lt;Sysname> display ip interface Vlan-interface 1</p><p># 创建VLAN（H3C不支持cisco的VTP，所以只能添加静态VLAN）</p><p>&lt;H3C_TEST>system-view</p><p>System View: return to User View with Ctrl+Z.</p><p>[H3C_TEST]vlan 99</p><p>[H3C_TEST-vlan99]name seicoffice</p><p>[H3C_TEST-vlan99]quit</p><p># 把交换机的端端口划分到相应的Vlan中</p><p>[H3C_TEST]interface ethernet1/0/2　　　　　　　//进入端口模式</p><p>[H3C_TEST-Ethernet1/0/2]port link-type access //设置端口的类型为access</p><p>[H3C_TEST-Ethernet1/0/2]port access vlan 99　　//把当前端口划到vlan 99</p><p>[H3C_TEST]vlan 99</p><p>[H3C_TEST-vlan99]port ethernet1/0/1 to ethernet1/0/24　　//把以及网端口1/0/1到1/0/24划到vlan99</p><p>[H3C_TEST-vlan99]quit</p><p>[H3C_TEST-GigabitEthernet1/2/1]port trunk permit vlan 1 99 // {ID|All} 设置trunk端口允许通过的VLAN</p><p>-------------------------------------------------------------------------------------------------------</p><p># 配置本地用户</p><p>&lt;Sysname>system-view</p><p>System View: return to User View with Ctrl+Z.</p><p>[Sysname]local-user h3c</p><p>New local user added.</p><p>[Sysname-luser-h3c]service-type telnet level 3</p><p>[Sysname-luser-h3c]password simple h3</p><p># 配置欢迎信息</p><p>[H3C_TEST]header login %Welcome to login h3c!%</p><p># 配置用户认证方式telnet(vty 0-4)</p><p>[H3C_TEST]user-interface vty 0 4</p><p>[H3C_TEST-ui-vty0-4]authentication-mode scheme</p><p>[H3C_TEST-ui-vty0-4]protocol inbound telnet</p><p>[H3C_TEST-ui-vty0-4]super authentication-mode super-password</p><p>[H3C_TEST-ui-vty0-4]quit</p><p>[H3C_TEST]super password level 3 simple h3c //用户登陆后提升权限的密码</p><p># 配置Radius策略</p><p>[H3C_TEST]radius scheme radius1</p><p>New Radius scheme</p><p>[H3C_TEST-radius-radius1]primary authentication 10.0.1.253 1645</p><p>[H3C_TEST-radius-radius1]primary accounting 10.0.1.253 1646</p><p>[H3C_TEST-radius-radius1]secondary authentication 127.0.0.1 1645</p><p>[H3C_TEST-radius-radius1]secondary accounting 127.0.0.1 1646</p><p>[H3C_TEST-radius-radius1]timer 5</p><p>[H3C_TEST-radius-radius1]key authentication h3c</p><p>[H3C_TEST-radius-radius1]key accounting h3c</p><p>[H3C_TEST-radius-radius1]server-type extended</p><p>[H3C_TEST-radius-radius1]user-name-format without-domain</p><p></p><p># 配置域</p><p>[H3C_TEST]domain h3c</p><p>[H3C_TEST-isp-h3c]authentication radius-scheme radius1 local</p><p>[H3C_TEST-isp-h3c]scheme radius-scheme radius1 local</p><p>[H3C_TEST]domain default enable h3c</p><p></p><p># 配置在远程认证失败时，本地认证的key</p><p>[H3C_TEST]local-server nas-ip 127.0.0.1 key h3c</p><p>H3C交换机路由器telnet和console口登录配置</p><p>2009年11月09日 星期一 10:00</p><p>级别说明</p><p>Level 名称</p><p>命令0</p><p>参观</p><p>ping、tracert、telnet</p><p>1、监控</p><p>display、debugging</p><p>2、配置</p><p>所有配置命令（管理级的命令除外）</p><p>3、管理</p><p>文件系统命令、FTP命令、TFTP命令、XMODEM命令</p><p>telnet仅用密码登录，管理员权限</p><p>[Router]user-interface vty 0 4[Router-ui-vty0-4]user privilege level 3[Router-ui-vty0-4]set authentication password simple abc</p><p>telnet仅用密码登录，非管理员权限</p><p>[Router]super password level 3 simple super</p><p>[Router]user-interface vty 0 4[Router-ui-vty0-4]user privilege level 1[Router-ui-vty0-4]set authentication password simple abc</p><p>telnet使用路由器上配置的用户名密码登录，管理员权限</p><p>[Router]local-user admin password simple admin[Router]local-user admin service-type telnet[Router]local-user admin level 3</p><p>[Router]user-interface vty 0 4[Router-ui-vty0-4]authentication-mode local</p><p>telnet使用路由器上配置的用户名密码登录，非管理员权限</p><p>[Router]super password level 3 simple super</p><p>[Router]local-user manage password simple manage[Router]local-user manage service-type telnet[Router]local-user manage level 2</p><p>[Router]user-interface vty 0 4[Router-ui-vty0-4]authentication-mode local</p><p>对console口设置密码，登录后使用管理员权限</p><p>[Router]user-interface con 0[Router-ui-console0]user privilege level 3[Router-ui-console0]set authentication password simple abc</p><p>对console口设置密码，登录后使用非管理员权限</p><p>[Router]super password level 3 simple super</p><p>[Router]user-interface con 0[Router-ui-console0]user privilege level 1[Router-ui-console0]set authentication password simple abc</p><p>对console口设置用户名和密码，登录后使用管理员权限</p><p>[Router]local-user admin password simple admin[Router]local-user admin service-type terminal[Router]local-user admin level 3</p><p>[Router]user-interface con 0[Router-ui-console0]authentication-mode local</p><p>对console口设置用户名和密码，登录后使用非管理员权限</p><p>[Router]super password level 3 simple super</p><p>[Router]local-user manage password simple manage[Router]local-user manage service-type terminal[Router]local-user manage level 2</p><p>[Router]user-interface con 0[Router-ui-console0]authentication-mode local</p><p>simple 是明文显示，cipher 是加密显示</p><p>路由器不设置telnet登录配置时，用户无法通过telnet登录到路由器上</p><p>[Router-ui-vty0-4]acl 2000 inbound可以通过acl的规则只允许符合条件的用户远程登录路由器</p><p>路由器命令</p><p>~~~~~~~~~~</p><p>[Quidway]display version 显示版本信息</p><p>[Quidway]display current-configuration 显示当前配置</p><p>[Quidway]display interfaces 显示接口信息</p><p>[Quidway]display ip route 显示路由信息</p><p>[Quidway]sysname aabbcc 更改主机名</p><p>[Quidway]super passwrod 123456 设置口令</p><p>[Quidway]interface serial0 进入接口</p><p>[Quidway-serial0]ip address &lt;ip>&lt;mask></p><p>[Quidway-serial0]undo shutdown 激活端口</p><p>[Quidway]link-protocol hdlc 绑定hdlc协议</p><p>[Quidway]user-interface vty 0 4</p><p>[Quidway-ui-vty0-4]authentication-mode password</p><p>[Quidway-ui-vty0-4]set authentication-mode password simple 222</p><p>[Quidway-ui-vty0-4]user privilege level 3</p><p>[Quidway-ui-vty0-4]quit</p><p>[Quidway]debugging hdlc all serial0 显示所有信息</p><p>[Quidway]debugging hdlc event serial0 调试事件信息</p><p>[Quidway]debugging hdlc packet serial0 显示包的信息</p><p>静态路由：</p><p>[Quidway]ip route-static &lt;ip>&lt;mask>{interface number|nexthop}[value][reject|blackhole]</p><p>例如：</p><p>[Quidway]ip route-static 129.1.0.0 16 10.0.0.2</p><p>[Quidway]ip route-static 129.1.0.0 255.255.0.0 10.0.0.2</p><p>[Quidway]ip route-static 129.1.0.0 16 Serial 2</p><p>[Quidway]ip route-static 0.0.0.0 0.0.0.0 10.0.0.2</p><p>动态路由：</p><p>[Quidway]rip</p><p>[Quidway]rip work</p><p>[Quidway]rip input</p><p>[Quidway]rip output</p><p>[Quidway-rip]network 1.0.0.0 可以all</p><p>[Quidway-rip]network 2.0.0.0</p><p>[Quidway-rip]peer ip-address</p><p>[Quidway-rip]summary</p><p>[Quidway]rip version 1</p><p>[Quidway]rip version 2 multicast</p><p>[Quidway-Ethernet0]rip split-horizon 水平分隔</p><p>[Quidway]router id A.B.C.D 配置路由器的ID</p><p>[Quidway]ospf enable 启动OSPF协议</p><p>[Quidway-ospf]import-route direct 引入直联路由</p><p>[Quidway-Serial0]ospf enable area &lt;area_id> 配置OSPF区域</p><p>标准访问列表命令格式如下：</p><p>acl &lt;acl-number> [match-order config|auto] 默认前者顺序匹配。</p><p>rule [normal|special]{permit|deny} [source source-addr source-wildcard|any]</p><p>例：</p><p>[Quidway]acl 10</p><p>[Quidway-acl-10]rule normal permit source 10.0.0.0 0.0.0.255</p><p>[Quidway-acl-10]rule normal deny source any</p><p>扩展访问控制列表配置命令</p><p>配置TCP/UDP协议的扩展访问列表：</p><p>rule {normal|special}{permit|deny}{tcp|udp}source {&lt;ip wild>|any}destination &lt;ip wild>|any}</p><p>[operate]</p><p>配置ICMP协议的扩展访问列表：</p><p>rule {normal|special}{permit|deny}icmp source {&lt;ip wild>|any]destination {&lt;ip wild>|any]</p><p>[icmp-code] [logging]</p><p>扩展访问控制列表操作符的含义</p><p>equal portnumber 等于</p><p>greater-than portnumber 大于</p><p>less-than portnumber 小于</p><p>not-equal portnumber 不等</p><p>range portnumber1 portnumber2 区间</p><p>扩展访问控制列表举例</p><p>[Quidway]acl 101</p><p>[Quidway-acl-101]rule deny souce any destination any</p><p>[Quidway-acl-101]rule permit icmp source any destination any icmp-type echo</p><p>[Quidway-acl-101]rule permit icmp source any destination any icmp-type echo-reply</p><p>[Quidway]acl 102</p><p>[Quidway-acl-102]rule permit ip source 10.0.0.1 0.0.0.0 destination 202.0.0.1 0.0.0.0</p><p>[Quidway-acl-102]rule deny ip source any destination any</p><p>[Quidway]acl 103</p><p>[Quidway-acl-103]rule permit tcp source any destination 10.0.0.1 0.0.0.0 destination-port equal ftp</p><p>[Quidway-acl-103]rule permit tcp source any destination 10.0.0.2 0.0.0.0 destination-port equal www</p><p>[Quidway]firewall enable</p><p>[Quidway]firewall default permit|deny</p><p>[Quidway]int e0</p><p>[Quidway-Ethernet0]firewall packet-filter 101 inbound|outbound</p><p>地址转换配置举例</p><p>[Quidway]firewall enable</p><p>[Quidway]firewall default permit</p><p>[Quidway]acl 101</p><p>[Quidway-acl-101]rule deny ip source any destination any</p><p>[Quidway-acl-101]rule permit ip source 129.38.1.4 0 destination any</p><p>[Quidway-acl-101]rule permit ip source 129.38.1.1 0 destination any</p><p>[Quidway-acl-101]rule permit ip source 129.38.1.2 0 destination any</p><p>[Quidway-acl-101]rule permit ip source 129.38.1.3 0 destination any</p><p>[Quidway]acl 102</p><p>[Quidway-acl-102]rule permit tcp source 202.39.2.3 0 destination 202.38.160.1 0</p><p>[Quidway-acl-102]rule permit tcp source any destination 202.38.160.1 0 destination-port great-than</p><p>1024</p><p>[Quidway-Ethernet0]firewall packet-filter 101 inbound</p><p>[Quidway-Serial0]firewall packet-filter 102 inbound</p><p>[Quidway]nat address-group 202.38.160.101 202.38.160.103 pool1</p><p>[Quidway]acl 1</p><p>[Quidway-acl-1]rule permit source 10.110.10.0 0.0.0.255</p><p>[Quidway-acl-1]rule deny source any</p><p>[Quidway-acl-1]int serial 0</p><p>[Quidway-Serial0]nat outbound 1 address-group pool1</p><p>[Quidway-Serial0]nat server global 202.38.160.101 inside 10.110.10.1 ftp tcp</p><p>[Quidway-Serial0]nat server global 202.38.160.102 inside 10.110.10.2 www tcp</p><p>[Quidway-Serial0]nat server global 202.38.160.102 8080 inside 10.110.10.3 www tcp</p><p>[Quidway-Serial0]nat server global 202.38.160.103 inside 10.110.10.4 smtp udp</p><p>PPP验证：</p><p>主验方：pap|chap</p><p>[Quidway]local-user u2 password {simple|cipher} aaa</p><p>[Quidway]interface serial 0</p><p>[Quidway-serial0]ppp authentication-mode {pap|chap}</p><p>[Quidway-serial0]ppp chap user u1 //pap时，不用此句</p><p>pap被验方：</p><p>[Quidway]interface serial 0</p><p>[Quidway-serial0]ppp pap local-user u2 password {simple|cipher} aaa</p><p>chap被验方：</p><p>[Quidway]interface serial 0</p><p>[Quidway-serial0]ppp chap user u1</p><p>[Quidway-serial0]local-user u2 password {simple|cipher} aaa</p><p>H3C路由器配置方案注解</p><p>2010-06-19 22:44</p><p>#</p><p>version 5.20, Release 1719 //版本信息，自动显示</p><p>#</p><p>sysname H3C //给设备命名为H3C</p><p>#</p><p>super password level 3 cipher 7WC1&lt;3E`[Y)./a!1$H@GYA!! //设置super密码</p><p>#</p><p>domain default enable system</p><p>#</p><p>telnet server enable</p><p>#</p><p>vlan 1</p><p>#</p><p>domain system</p><p>access-limit disable</p><p>state active</p><p>idle-cut disable</p><p>self-service-url disable</p><p>#</p><p>user-group system //从此以上未标注的为默认配置，不用去理解</p><p>#</p><p>local-user admin //添加用户名为admin的用户</p><p>password cipher .]@USE=B,53Q=^Q`MAF4&lt;1!! //设置密码（密文）</p><p>authorization-attribute level 3 //设置用户权限为3级（最高）</p><p>service-type telnet //设置用户的模式为telnet用户</p><p>local-user share //从此往下四行同上</p><p>password cipher [HM$GH8P1GSQ=^Q`MAF4&lt;1!!</p><p>authorization-attribute level 1</p><p>service-type telnet</p><p>#</p><p>controller E1 0/0 //进入E1物理端口（两兆口）</p><p>using e1 //设置端口模式为E1（设置后下面会出现interface Serial0/0:0）</p><p>#</p><p>interface Aux0 //从此以下三行为主控板aux口默认配置</p><p>async mode flow</p><p>link-protocol ppp</p><p>#</p><p>interface Ethernet0/0 //进入E0/0接口（以太网口）</p><p>port link-mode route //配置该接口为路由模式</p><p>#</p><p>interface Serial0/0:0 //进入Serial0/0:0端口（前面用using e1命令后产生，对应E1端口）</p><p>link-protocol ppp //配置链路协议为ppp（默认）</p><p>ip address 74.1.63.170 255.255.255.252 //配置该接口IP地址</p><p>#</p><p>interface NULL0</p><p>#</p><p>interface Vlan-interface1 //lan口vlan地址（lan口地址）</p><p>ip address 192.168.1.1 255.255.255.0</p><p>#</p><p>interface Ethernet0/1</p><p>port link-mode bridge</p><p>#</p><p>interface Ethernet0/2</p><p>port link-mode bridge</p><p>#</p><p>interface Ethernet0/3</p><p>port link-mode bridge</p><p>#</p><p>interface Ethernet0/4</p><p>port link-mode bridge</p><p>#</p><p>ip route-static 74.1.8.0 255.255.255.0 74.1.63.169 //配置静态路由</p><p>#</p><p>user-interface aux 0</p><p>user-interface vty 0 4 //进入vty接口（远程登陆接口）0-4通道</p><p>authentication-mode scheme //配置登陆验证类型为scheme（用户验证型）</p><p>user privilege level 1 //设置当验证模式不是scheme类型时的登录级别（废配置）</p><p>#</p><p>return</p><p><strong>H3C路由器基本配置命令</strong></p><p>2009-05-13 22:56</p><p>[Quidway]display version 显示版本信息</p><p>[Quidway]display current-configuration 显示当前配置</p><p>[Quidway]display interfaces 显示接口信息</p><p>[Quidway]display ip route 显示路由信息</p><p>[Quidway]sysname aabbcc 更改主机名</p><p>[Quidway]super passwrod 123456 设置口令</p><p>[Quidway]interface serial0 进入接口</p><p>[Quidway-serial0]ip address &lt;ip>&lt;mask></p><p>[Quidway-serial0]undo shutdown 激活端口</p><p>[Quidway]link-protocol hdlc 绑定hdlc协议</p><p>[Quidway]user-interface vty 0 4</p><p>[Quidway-ui-vty0-4]authentication-mode password</p><p>[Quidway-ui-vty0-4]set authentication-mode password simple 222</p><p>[Quidway-ui-vty0-4]user privilege level 3</p><p>[Quidway-ui-vty0-4]quit</p><p>[Quidway]debugging hdlc all serial0 显示所有信息</p><p>[Quidway]debugging hdlc event serial0 调试事件信息</p><p>[Quidway]debugging hdlc packet serial0 显示包的信息</p><p>静态路由：</p><p>[Quidway]ip route-static &lt;ip>&lt;mask>{interface number|nexthop}[value][reject|blackhole]</p><p>例如：</p><p>[Quidway]ip route-static 129.1.0.0 16 10.0.0.2</p><p>[Quidway]ip route-static 129.1.0.0 255.255.0.0 10.0.0.2</p><p>[Quidway]ip route-static 129.1.0.0 16 Serial 2</p><p>[Quidway]ip route-static 0.0.0.0 0.0.0.0 10.0.0.2</p><p>动态路由：</p><p>[Quidway]rip</p><p>[Quidway]rip work</p><p>[Quidway]rip input</p><p>[Quidway]rip output</p><p>[Quidway-rip]network 1.0.0.0 ;可以all</p><p>[Quidway-rip]network 2.0.0.0</p><p>[Quidway-rip]peer ip-address</p><p>[Quidway-rip]summary</p><p>[Quidway]rip version 1</p><p>[Quidway]rip version 2 multicast</p><p>[Quidway-Ethernet0]rip split-horizon ;水平分隔</p><p>[Quidway]router id A.B.C.D 配置路由器的ID</p><p>[Quidway]ospf enable 启动OSPF协议</p><p>[Quidway-ospf]import-route direct 引入直联路由</p><p>[Quidway-Serial0]ospf enable area &lt;area_id> 配置OSPF区域</p><p></p><p>标准访问列表命令格式如下：</p><p>acl &lt;acl-number> [match-order config|auto] 默认前者顺序匹配。</p><p>rule [normal|special]{permit|deny} [source source-addr source-wildcard|any]</p><p>例：</p><p>[Quidway]acl 10</p><p>[Quidway-acl-10]rule normal permit source 10.0.0.0 0.0.0.255</p><p>[Quidway-acl-10]rule normal deny source any</p><p>扩展访问控制列表配置命令</p><p>配置TCP/UDP协议的扩展访问列表：</p><p>rule {normal|special}{permit|deny}{tcp|udp}source {&lt;ip wild>|any}destination &lt;ip wild>|any}</p><p>[operate]</p><p>配置ICMP协议的扩展访问列表：</p><p>rule {normal|special}{permit|deny}icmp source {&lt;ip wild>|any]destination {&lt;ip wild>|any]</p><p>[icmp-code] [logging]</p><p>扩展访问控制列表操作符的含义</p><p>equal portnumber 等于</p><p>greater-than portnumber 大于</p><p>less-than portnumber 小于</p><p>not-equal portnumber 不等</p><p>range portnumber1 portnumber2 区间</p><p>扩展访问控制列表举例</p><p>[Quidway]acl 101</p><p>[Quidway-acl-101]rule deny souce any destination any</p><p>[Quidway-acl-101]rule permit icmp source any destination any icmp-type echo</p><p>[Quidway-acl-101]rule permit icmp source any destination any icmp-type echo-reply</p><p>[Quidway]acl 102</p><p>[Quidway-acl-102]rule permit ip source 10.0.0.1 0.0.0.0 destination 202.0.0.1 0.0.0.0</p><p>[Quidway-acl-102]rule deny ip source any destination any</p><p>[Quidway]acl 103</p><p>[Quidway-acl-103]rule permit tcp source any destination 10.0.0.1 0.0.0.0 destination-port equal ftp</p><p>[Quidway-acl-103]rule permit tcp source any destination 10.0.0.2 0.0.0.0 destination-port equal www</p><p>[Quidway]firewall enable</p><p>[Quidway]firewall default permit|deny</p><p>[Quidway]int e0</p><p>[Quidway-Ethernet0]firewall packet-filter 101 inbound|outbound</p><p>地址转换配置举例</p><p>[Quidway]firewall enable</p><p>[Quidway]firewall default permit</p><p>[Quidway]acl 101</p><p>[Quidway-acl-101]rule deny ip source any destination any</p><p>[Quidway-acl-101]rule permit ip source 129.38.1.4 0 destination any</p><p>[Quidway-acl-101]rule permit ip source 129.38.1.1 0 destination any</p><p>[Quidway-acl-101]rule permit ip source 129.38.1.2 0 destination any</p><p>[Quidway-acl-101]rule permit ip source 129.38.1.3 0 destination any</p><p>[Quidway]acl 102</p><p>[Quidway-acl-102]rule permit tcp source 202.39.2.3 0 destination 202.38.160.1 0</p><p>[Quidway-acl-102]rule permit tcp source any destination 202.38.160.1 0 destination-port great-than</p><p>1024</p><p>[Quidway-Ethernet0]firewall packet-filter 101 inbound</p><p>[Quidway-Serial0]firewall packet-filter 102 inbound</p><p>[Quidway]nat address-group 202.38.160.101 202.38.160.103 pool1</p><p>[Quidway]acl 1</p><p>[Quidway-acl-1]rule permit source 10.110.10.0 0.0.0.255</p><p>[Quidway-acl-1]rule deny source any</p><p>[Quidway-acl-1]int serial 0</p><p>[Quidway-Serial0]nat outbound 1 address-group pool1</p><p>[Quidway-Serial0]nat server global 202.38.160.101 inside 10.110.10.1 ftp tcp</p><p>[Quidway-Serial0]nat server global 202.38.160.102 inside 10.110.10.2 www tcp</p><p>[Quidway-Serial0]nat server global 202.38.160.102 8080 inside 10.110.10.3 www tcp</p><p>[Quidway-Serial0]nat server global 202.38.160.103 inside 10.110.10.4 smtp udp</p><p>PPP验证：</p><p>主验方：pap|chap</p><p>[Quidway]local-user u2 password {simple|cipher} aaa</p><p>[Quidway]interface serial 0</p><p>[Quidway-serial0]ppp authentication-mode {pap|chap}</p><p>[Quidway-serial0]ppp chap user u1 //pap时，不用此句</p><p>pap被验方：</p><p>[Quidway]interface serial 0</p><p>[Quidway-serial0]ppp pap local-user u2 password {simple|cipher} aaa</p><p>chap被验方：</p><p>[Quidway]interface serial 0</p><p>[Quidway-serial0]ppp chap user u1</p><p>[Quidway-serial0]local-user u2 password {simple|cipher} aaa</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'H3C','经典','教程'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>