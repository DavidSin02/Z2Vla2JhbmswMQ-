<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ | æå®¢å¿«è¨Š</title><meta property="og:title" content="springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/fb037e70190b458d9f24f56fef7a85d7"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/393e0ea8.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/393e0ea8.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/393e0ea8.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/393e0ea8.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/393e0ea8.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/393e0ea8.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/393e0ea8.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/393e0ea8.html><meta property="article:published_time" content="2020-11-14T21:04:29+08:00"><meta property="article:modified_time" content="2020-11-14T21:04:29+08:00"><meta name=Keywords content><meta name=description content="springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/393e0ea8.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p>ä½¿ç”¨æ³¨è§£é…ç½®springï¼Œéœ€è¦ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><p>éœ€è¦å¯¼å…¥ä¸€ä¸ªåŒ…ï¼š</p><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/fb037e70190b458d9f24f56fef7a85d7><p class=pgc-img-caption></p></div><p><br></p><p>æ­¥éª¤1ï¼šéœ€è¦ä¸ºä¸»é…ç½®æ–‡ä»¶å¼•å…¥æ–°çš„å‘½åç©ºé—´ï¼ˆçº¦æŸï¼‰ï¼Œå’Œä¹‹å‰ä»‹ç»çš„ä¸€æ ·ï¼Œå¯¼å…¥æ–°çš„çº¦æŸï¼š</p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4da26c639057465f9a090e469f98e919><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ba06df1c52a74233a21cd14a850183d4><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/5d512a2d066e49e29efcc9f222f09980><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/552e4e21c0ba4702b24bea12acd7e64d><p class=pgc-img-caption></p></div><p>ç„¶ååœ¨application.xmlçš„Designä¸­å³å‡»beans</p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/53e40986bf8146da94fc6a93ec53c48a><p class=pgc-img-caption></p></div><p>ç„¶åAdd</p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/c64f4857747e4b15964bdb1d5d9fde67><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3ae317de62d54bbca1ae15ead89a83b4><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d41ce214201d4562a4994f40b1207d55><p class=pgc-img-caption></p></div><p>è¿™é‡Œé¢çš„å‘½åç©ºé—´ä½¿ç”¨contextï¼Œéœ€è¦æŒ‡å®šï¼Œè¿™æ˜¯å› ä¸ºåœ¨ä¹‹å‰å¯¼å…¥Beanå‘½åç©ºé—´çš„æ—¶å€™æ²¡æœ‰æŒ‡å®šï¼Œè€Œæ²¡æœ‰æŒ‡å®šçš„åªèƒ½æœ‰ä¸€ä¸ªï¼Œå¤šä¸ªå°±ä¼šå‡ºé—®é¢˜ï¼Œæ‰€ä»¥ä»¥ååœ¨å¯¼å…¥å‘½åç©ºé—´éƒ½éœ€è¦æŒ‡å®šprofix</p><p><strong>2.å¼€å¯ä½¿ç”¨æ³¨è§£ä»£ç†é…ç½®æ–‡ä»¶</strong></p><p>&lt;context:component-scan base-package="com.huanfeng.bean">&lt;/context:component-scan></p><p>è¿™ä¸ªé…ç½®çš„å°±æ˜¯è¯´springä¼šå»com.huanfeng.beanä¸­æ‰«ææ‰€æœ‰çš„æ³¨è§£ï¼ˆåŒ…æ‹¬beanåŒ…ä¸‹é¢çš„æ‰€æœ‰ç±»ä»¥åŠå­åŒ…ä¸‹çš„æ‰€æœ‰ç±»ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸‹é¢å°±å¯ä»¥åœ¨com.huanfeng.beanä¸‹çš„æ‰€æœ‰ç±»ä¸­ä½¿ç”¨æ³¨è§£é…ç½®æ–‡ä»¶äº†</p><p><strong>3.åœ¨ç±»ä¸­ä½¿ç”¨æ³¨è§£é…ç½®æ–‡ä»¶</strong></p><p><strong>@Component("user")</strong></p><p><strong>è¿™ä¸ªé…ç½®åœ¨ç±»ä¸Šï¼Œè¡¨ç¤ºä¸ºç±»åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„åå­—æ˜¯user</strong></p><p><strong>@Service("user")</strong></p><p><strong>@Controller("user")</strong></p><p><strong>@Repository("user")</strong></p><p><strong>ä»¥ä¸Šçš„ä¸‰ä¸ªæ³¨è§£å’Œ@Componentæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œæœ‰æ—¶å€™ä¸ºäº†å°†å¼€å‘è€…æ¸…æ™°ï¼Œæ‰€ä»¥å¸¸å¸¸ä½¿ç”¨@Serviceåœ¨serviceå±‚ï¼Œä½¿ç”¨Controlleråœ¨webå±‚ï¼Œä½¿ç”¨Repositoryåœ¨daoå±‚</strong></p><p><strong>@Scope(scopeName="singleton")</strong></p><p><strong>è¿™ä¸ªé…ç½®åœ¨ç±»ä¸Šï¼Œè¡¨ç¤ºè¿™ä¸ªç±»åªåˆ›å»ºä¸€ä¸ªå¯¹è±¡</strong></p><p><strong>@Value("18")</strong></p><p><strong>private Integer age</strong></p><p><strong>è¿™ä¸ªæ˜¯é…ç½®ç›´æ¥ä¸ºå±æ€§èµ‹å€¼ï¼Œä½¿ç”¨äº†åå°„çš„æ–¹å¼ï¼Œè·å–åˆ°Fieldç„¶åèµ‹å€¼</strong></p><p>@Value("huanfeng")</p><p>public void setName(String name){</p><p>this.name=name</p><p>}</p><p>ä»¥ä¸Šæ˜¯åŸºæœ¬ç±»å‹ï¼Œå¦‚æœä½¿ç”¨å¼•ç”¨ç±»å‹å±æ€§å¯ä»¥ï¼š</p><p>@Autowired</p><p>private Car car</p><p>è‡ªåŠ¨è£…é…ï¼Œspringä¼šå»å¯»æ‰¾carå¯¹è±¡èµ‹å€¼ç»™è¿™ä¸ªå±æ€§ï¼Œä½†æ˜¯å½“è¿™ç§ç±»å‹çš„å¯¹è±¡å¾ˆå¤šæ—¶ï¼Œå°†å‡ºé—®é¢˜</p><p>@Qualifier("car")</p><p>private Car car</p><p>è‡ªåŠ¨è£…é…ï¼Œspringä¼šå»å¯»æ‰¾åä¸ºcarçš„carå¯¹è±¡èµ‹å€¼ç»™è¿™ä¸ªå±æ€§</p><p>@Resource(name="car")</p><p>private Car car</p><p>æ‰‹åŠ¨æ³¨å…¥ï¼ŒæŒ‡å®šæ³¨å…¥nameä¸ºcarçš„å¯¹è±¡</p><p>éœ€è¦æ³¨æ„çš„æ˜¯è¦æƒ³æ³¨å…¥carï¼Œéœ€è¦åœ¨Carç±»ä¸Šä½¿ç”¨@Componentæ¥æ³¨æ˜</p><p>è¿™ä¸ªæ˜¯é…ç½®ä½¿ç”¨åœ¨æ–¹æ³•ä¸Šï¼Œè¿™ä¸ªè¡¨ç¤ºè°ƒç”¨setNameæ–¹æ³•ä¼ é€’å‚æ•°huanfengï¼Œå®Œæˆä¸ºå±æ€§nameçš„èµ‹å€¼å·¥ä½œï¼Œè¿™ä¸ªæ˜¯å’Œä¸Šé¢çš„ä¸ºageå±æ€§èµ‹å€¼æ˜¯ä¸€æ ·çš„ï¼Œä¸åŒçš„æ˜¯è¿™é‡Œæ²¡æœ‰ä½¿ç”¨åå°„</p><p>@PostConstruct</p><p>public void init(){...}</p><p>ä½¿ç”¨è¿™ä¸ªæ³¨è§£çš„æ–¹æ³•ä¼šæˆä¸ºåˆå§‹åŒ–æ–¹æ³•ï¼Œåœ¨å®¹å™¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨è°ƒç”¨</p><p>@PreDestroy</p><p>public void destory(){..}</p><p>ä½¿ç”¨è¿™ä¸ªæ³¨è§£çš„æ–¹æ³•ä¼šæˆä¸ºé”€æ¯æ–¹æ³•ï¼Œåœ¨å®¹å™¨é”€æ¯è¿™ä¸ªå¯¹è±¡ä¹‹å‰ä¼šè‡ªåŠ¨è°ƒç”¨</p><pre><code>@Component("user")@Scope(scopeName="singleton")public class User {	@Value("huanfeng")	private String name;	@Value("11")	private Integer age;	@Resource(name="car")	private Car car;		public User(String name,Integer age,Car car) {		System.out.println("æ‰§è¡Œäº†æ„é€ æ–¹æ³•");		this.name=name;		this.age=age;		this.car=car;	}	public Car getCar() {		return car;	}	public void setCar(Car car) {		this.car = car;	}	public User() {		System.out.println("ssas");	}	public String getName() {		return name;	}	public void setName(String name) {		this.name = name;	}	public Integer getAge() {		return age;	}	public void setAge(Integer age) {		this.age = age;	}	@PostConstruct	public void init() {		System.out.println("åˆå§‹åŒ–");	}	@PreDestroy	public void destroy() {		System.out.println("é”€æ¯æ–¹æ³•");	}	public String toString() {		return this.age+this.name+this.car.getName();	}	}</code></pre><h1 class=pgc-h-arrow-right>springä¸­å®‰è£…stsæ’ä»¶</h1><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/be15d7c3404c4bef81190169a9ca7baf><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/597a1e2a373e4383b19769a1bd021265><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/cf050de3e47e44459e01090b66b174ad><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fb15981ba94d4800923d1f714f816a1c><p class=pgc-img-caption></p></div><p>ä¹‹åä¼šç­‰å¾ˆé•¿çš„ä¸€æ®µæ—¶é—´</p><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/77638b86be354285baa699e554efd0c0><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/02dbb7d1f13942b5a2dfee02ea2377fa><p class=pgc-img-caption></p></div><p>æˆ‘ä»¬æ— è®ºæ˜¯ä½¿ç”¨æ³¨è§£æ¥é…ç½®è¿˜æ˜¯ä½¿ç”¨é…ç½®æ–‡ä»¶æ¥é…ç½®ï¼Œé‚£ä¹ˆæˆ‘ä»¬éƒ½éœ€è¦æµ‹è¯•æ˜¯å¦é…ç½®æˆåŠŸï¼š</p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/18e2895cf54247a5bcc1b223e1eb1157><p class=pgc-img-caption></p></div><p><br></p><pre><code>import org.junit.Test;import org.springframework.context.ApplicationContext;import org.springframework.context.support.ClassPathXmlApplicationContext;import org.springframework.core.env.SystemEnvironmentPropertySource;import com.huanfeng.bean.Complex;import com.huanfeng.bean.User;public class Demo {	@Test	public void fun1(){		//1 åˆ›å»ºå®¹å™¨å¯¹è±¡		ApplicationContext ac = new ClassPathXmlApplicationContext("applicationContext.xml");		//2 å‘å®¹å™¨"è¦"userå¯¹è±¡		User c = (User) ac.getBean("user");		//3 æ‰“å°userå¯¹è±¡		System.out.println(c);	}}</code></pre><p>è¿™æ ·çš„æµ‹è¯•æ–¹å¼ï¼Œæ¯æ¬¡åˆ›å»ºä¸€ä¸ªæµ‹è¯•æ–¹æ³•éƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªå®¹å™¨å¯¹è±¡ï¼Œç„¶åè·å–åˆ°å®¹å™¨ä¸­çš„æ–¹æ³•ï¼Œspringå¯¹å…¶è¿›è¡Œäº†æ•´åˆï¼Œä½¿ç”¨æ³¨è§£çš„æ–¹å¼ï¼Œæ–¹ä¾¿è½»æ¾</p><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/648a17495ec44e6e98fff674cbbf84d2><p class=pgc-img-caption></p></div><p>å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ç°éœ€è¦ä¸‰ä¸ªæ­¥éª¤ï¼Œ</p><p>ç¬¬ä¸€æ­¥æ˜¯ä½¿ç”¨æ³¨è§£è®©springå¸®åŠ©æˆ‘ä»¬åˆ›å»ºå®¹å™¨</p><p>ç¬¬äºŒæ­¥æ˜¯æ‰§è¡Œåˆ›å»ºå®¹å™¨çš„æ—¶å€™ä½¿ç”¨å“ªä¸ªé…ç½®æ–‡ä»¶</p><p>ç¬¬ä¸‰æ­¥æ˜¯æˆ‘ä»¬æƒ³è¦æµ‹è¯•å“ªä¸ªç±»ï¼Œæˆ‘ä»¬å°±å†™ä¸€ä¸ªå±æ€§ï¼Œç„¶åæ³¨è§£è¿™ä¸ªå±æ€§ï¼Œé‚£ä¹ˆspringå°±ä¼šå°†è¿™ä¸ªå¯¹è±¡èµ‹å€¼ç»™è¿™ä¸ªå±æ€§ï¼Œä¹‹åæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œæµ‹è¯•äº†ã€‚</p><pre><code>package com.huanfeng.shiyan;import javax.annotation.Resource;import org.junit.Test;import org.junit.runner.RunWith;import org.springframework.context.ApplicationContext;import org.springframework.context.support.ClassPathXmlApplicationContext;import org.springframework.core.env.SystemEnvironmentPropertySource;import org.springframework.test.context.ContextConfiguration;import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;import com.huanfeng.bean.Complex;import com.huanfeng.bean.User;//å¸®æˆ‘ä»¬åˆ›å»ºå®¹å™¨@RunWith(SpringJUnit4ClassRunner.class)//æŒ‡å®šåˆ›å»ºå®¹å™¨æ—¶ä½¿ç”¨å“ªä¸ªé…ç½®æ–‡ä»¶@ContextConfiguration("classpath:applicationContext.xml")public class Demo {	//å°†åä¸ºuserçš„å¯¹è±¡æ³¨å…¥åˆ°uå˜é‡ä¸­	@Resource(name="user")	private User u;	@Test	public void fun1(){		System.out.println(u);	}}</code></pre><h1 class=pgc-h-arrow-right>aop</h1><p>aopçš„æ ¸å¿ƒæ€æƒ³</p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6049d0bcbb5a4d1a83bc078a6209f66a><p class=pgc-img-caption></p></div><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨filteræ¥æ‹¦æˆªè¯·æ±‚ï¼Œåœ¨filterå†…éƒ¨ä½¿ç”¨åŠ¨æ€ä»£ç†æ¥è§£å†³requestçš„ä¹±ç é—®é¢˜ï¼Œè¿™å°±æ˜¯aopçš„æ€æƒ³ï¼Œspringå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œspringæœ‰ä¸¤ç§ä»£ç†æ–¹å¼ï¼š</p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c49c92cac298465f9296e1eb1f9cba8a><p class=pgc-img-caption></p></div><p>è¦æ˜¯ä½¿ç”¨åŠ¨æ€ä»£ç†éœ€è¦æ³¨æ„çš„æ˜¯è¢«ä»£ç†å¯¹è±¡å¿…é¡»è¦å®ç°æ¥å£æ‰èƒ½äº§ç”Ÿä»£ç†å¯¹è±¡</p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15a4e5dd33b646e2ad0fe1327ad1fa74><p class=pgc-img-caption></p></div><p>åœ¨è¢«ä»£ç†å¯¹è±¡ä¸­å¦‚æœæ²¡æœ‰å®ç°æ¥å£ï¼Œé‚£ä¹ˆæ²¡æœ‰åŠæ³•ä½¿ç”¨åŠ¨æ€ä»£ç†æŠ€æœ¯</p><p>cglibä»£ç†æŠ€æœ¯å¯ä»¥å¯¹ä»»ä½•ç±»ç”Ÿæˆä»£ç†ï¼Œä»£ç†çš„åŸç†æ˜¯å¯¹ç›®æ ‡å¯¹è±¡è¿›è¡Œç»§æ‰¿ä»£ç†ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯¹Aç±»è¿›è¡Œcglibä»£ç†ï¼Œå®é™…ä¸Šç”Ÿæˆçš„è¿™ä¸ªä»£ç†å¯¹è±¡æ˜¯Aç±»çš„å­ç±»</p><p>springä¼šä¼˜å…ˆä½¿ç”¨åŠ¨æ€ä»£ç†æŠ€æœ¯</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æ‰‹åŠ¨æ˜¯å¦‚ä½•å®‰æ’çš„ï¼Œä¸‹é¢é€šè¿‡ä¸€ä¸ªå…·ä½“ä¾‹å­æ¥è¯´æ˜</p><p>å…·ä½“è¯´æ˜¯æ‰‹åŠ¨çš„ä½¿ç”¨åŠ¨æ€ä»£ç†æŠ€æœ¯æ¥å®Œæˆå¯¹serviceçš„å¢å¼ºï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨serviceä¸­å¼€å¯äº‹åŠ¡</p><p>æˆ‘ä»¬å…ˆæ¥å»ºç«‹ä¸€ä¸ªServiceçš„æ¥å£ï¼š</p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5d7b354bd2c949c38f13503db3971c6d><p class=pgc-img-caption></p></div><p>è¿™ä¸ªserviceæœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ–¹æ³•æ˜¯å¢åŠ æ–¹æ³•ï¼Œå¦å¤–ä¸€ä¸ªæ–¹æ³•æ˜¯åˆ é™¤æ–¹æ³•ï¼Œç„¶ååˆ›å»ºServiceç±»ä»è€Œå®ç°è¿™ä¸ªæ¥å£ï¼š</p><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/29f8ded1fb234db9ac8a298cb0b5c74c><p class=pgc-img-caption></p></div><p><br></p><pre><code>package com.huanfeng.service;public class UserServiceImpl implements UserService {	@Override	public void add() {		//è¿™é‡Œçš„å·¥ä½œæ˜¯å¢åŠ user		System.out.println("å¢åŠ ");	}	@Override	public void delete() {		//è¿™é‡Œçš„å·¥ä½œæ˜¯åˆ é™¤user		System.out.println("åˆ é™¤");	}}</code></pre><p>æŒ‰ç…§ä¹‹å‰çš„æ—¶å€™æ–¹æ³•æ˜¯ç›´æ¥ä½¿ç”¨Seriveå°±å¯ä»¥äº†ï¼Œä½†æ˜¯æ­¤æ—¶çš„Serviceå¹¶æ²¡æœ‰å¼€å¯äº‹åŠ¡ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŠ¨æ€ä»£ç†æŠ€æœ¯ï¼Œæ¥å¯¹è¿™ä¸ªServiceè¿›è¡Œå¢å¼º</p><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»UserServiceProxyFactory</p><pre><code>package com.huanfeng.proxy;import java.lang.reflect.InvocationHandler;import java.lang.reflect.Method;import java.lang.reflect.Proxy;import com.huanfeng.service.UserService;import com.huanfeng.service.UserServiceImpl;public class UserServiceProxyFactory implements InvocationHandler{	private UserService us;	public UserServiceProxyFactory(UserService us){		super();		this.us=us;	}	public UserService getUserServiceProxy() {		UserService userServiceProxy=(UserService) Proxy.newProxyInstance(UserServiceProxyFactory.class.getClassLoader(),UserServiceImpl.class.getInterfaces(),this);		return userServiceProxy;	}	@Override	public Object invoke(Object arg0, Method method, Object[] arg2) throws Throwable {		System.out.println("å¼€å¯äº‹åŠ¡");		Object invoke=method.invoke(us, arg2);		System.out.println("å…³é—­äº‹åŠ¡");		return invoke;	}}</code></pre><p>é¦–å…ˆè¿™ä¸ªç±»æœ‰ä¸€ä¸ªåŠ¨æ€ä»£ç†UserServiceçš„æ–¹æ³•ï¼Œè¿™ä¸ªgetUserServiceProxyæ–¹æ³•ä¸­ä½¿ç”¨proxy.newProxyInstanceæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼ é€’ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªç±»åŠ è½½å™¨ï¼ˆéšä¾¿ä¸€ä¸ªéƒ½è¡Œï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯éœ€è¦ä»£ç†ç±»çš„æ¥å£ï¼Œç¬¬ä¸‰ä¸ªæ˜¯InvokeHandleræ¥å£ï¼Œå› ä¸ºæˆ‘ä»¬çš„è¿™ä¸ªä»£ç†ç±»å®ç°äº†InvokeHandleræ¥å£ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¼ é€’å‚æ•°thiså°±å¥½äº†ï¼Œç„¶åå› ä¸ºå®ç°äº†è¿™ä¸ªæ¥å£ï¼Œæ‰€ä»¥éœ€è¦é‡å†™å…¶invokeæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä¸»è¦å‚æ•°ç¬¬äºŒä¸ªæ˜¯å¢å¼ºçš„æ–¹æ³•ï¼Œç¬¬ä¸‰ä¸ªæ˜¯æ–¹æ³•çš„å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨invokeæ–¹æ³•è¿›è¡Œå†…éƒ¨è°ƒç”¨ï¼Œåœ¨è°ƒç”¨å‰åè¿›è¡Œæ–¹æ³•çš„å¢å¼ºå·¥ä½œã€‚</p><pre><code>@Test	public void fun3() {		UserService us=new UserServiceImpl();		UserServiceProxyFactory factory=new UserServiceProxyFactory(us);		UserService usProxy=factory.getUserServiceProxy();		usProxy.add();	}</code></pre><p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªServiceï¼Œç„¶ååˆ›å»ºåŠ¨æ€ä»£ç†ç±»å¹¶å°†è¿™ä¸ªServiceä½œä¸ºå‚æ•°ä¼ é€’ã€‚è°ƒç”¨getUserServiceProxyæ–¹æ³•å°±å¯ä»¥è·å–åˆ°è¿™ä¸ªServiceçš„ä»£ç†ç±»äº†ï¼Œä¹‹ååªè¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå…¶å®å®ƒéƒ½ä¼šèµ°ä»£ç†ç±»çš„invokeæ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨å†…éƒ¨å¯¹å…¶è¿›è¡Œå¢å¼ºäº†ã€‚</p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/7a6d58adf7cd4d3ba43406c0d6ecf4c7><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d7f08ee0beeb4e009144b4365f5b0f62><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9dd96c9d14394684980c9d6b7cd063a5><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>springä¸­aopçš„ä½¿ç”¨</h1><p>å¯¼æŠ¥ï¼š</p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b983474fb62e480e9dc5aecf3424b40e><p class=pgc-img-caption></p></div><p>å¯¼å…¥aopçš„çº¦æŸï¼š</p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fd8556412b1349c8ba8c39e977980b5e><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9613735406524b6fae39e7e036d57573><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/06a1e1aebfe3496b82b2566c27eb6177><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2f62121cadfa4a46991e4b1f8ae219c0><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e10103b08bbc4d4f8b95a18daf892211><p class=pgc-img-caption></p></div><p><strong>ç¬¬ä¸€åˆ›å»ºç›®æ ‡å¯¹è±¡</strong></p><pre><code>public interface UserService {	public void add();	public void delete();}</code></pre><pre><code>public class UserServiceImpl implements UserService {	@Override	public void add() {		//è¿™é‡Œçš„å·¥ä½œæ˜¯å¢åŠ user		System.out.println("å¢åŠ ");	}	@Override	public void delete() {		//è¿™é‡Œçš„å·¥ä½œæ˜¯åˆ é™¤user		System.out.println("åˆ é™¤");	}}</code></pre><p><strong>ç¬¬äºŒ:è®¾è®¡é€šçŸ¥</strong></p><p><strong>è®¾è®¡ä¸€ä¸ªç±»ï¼Œè¿™ä¸ªç±»ä¸­ä¸“é—¨å­˜æ”¾éœ€è¦ä»£ç†å¯¹è±¡çš„é€šçŸ¥ï¼Œé€šçŸ¥æ€»å…±åˆ†ä¸ºäº”ç§ï¼š</strong></p><p>å‰ç½®é€šçŸ¥ ï¼šç›®æ ‡æ–¹æ³•è¿è¡Œä¹‹å‰è°ƒç”¨</p><p>åç½®é€šçŸ¥(å¦‚æœå‡ºç°å¼‚å¸¸ä¸ä¼šè°ƒç”¨):åœ¨ç›®æ ‡æ–¹æ³•è¿è¡Œä¹‹åè°ƒç”¨</p><p>ç¯ç»•é€šçŸ¥:åœ¨ç›®æ ‡æ–¹æ³•ä¹‹å‰å’Œä¹‹åéƒ½è°ƒç”¨</p><p>å¼‚å¸¸æ‹¦æˆªé€šçŸ¥:å¦‚æœå‡ºç°å¼‚å¸¸,å°±ä¼šè°ƒç”¨</p><p>åç½®é€šçŸ¥(æ— è®ºæ˜¯å¦å‡ºç° å¼‚å¸¸éƒ½ä¼šè°ƒç”¨):åœ¨ç›®æ ‡æ–¹æ³•è¿è¡Œä¹‹åè°ƒç”¨</p><pre><code>package com.huang.aop;import org.aspectj.lang.ProceedingJoinPoint;public class MyAdvice {	//å‰ç½®é€šçŸ¥		public void before(){			System.out.println("è¿™æ˜¯å‰ç½®é€šçŸ¥!!");		}		//åç½®é€šçŸ¥		public void afterReturning(){			System.out.println("è¿™æ˜¯åç½®é€šçŸ¥(å¦‚æœå‡ºç°å¼‚å¸¸ä¸ä¼šè°ƒç”¨)!!");		}		//ç¯ç»•é€šçŸ¥		public Object around(ProceedingJoinPoint pjp) throws Throwable {			System.out.println("è¿™æ˜¯ç¯ç»•é€šçŸ¥ä¹‹å‰çš„éƒ¨åˆ†!!");			Object proceed = pjp.proceed();//è°ƒç”¨ç›®æ ‡æ–¹æ³•			System.out.println("è¿™æ˜¯ç¯ç»•é€šçŸ¥ä¹‹åçš„éƒ¨åˆ†!!");			return proceed;		}		//å¼‚å¸¸é€šçŸ¥		public void afterException(){			System.out.println("å‡ºäº‹å•¦!å‡ºç°å¼‚å¸¸äº†!!");		}		//åç½®é€šçŸ¥		public void after(){			System.out.println("è¿™æ˜¯åç½®é€šçŸ¥(å‡ºç°å¼‚å¸¸ä¹Ÿä¼šè°ƒç”¨)!!");		}}</code></pre><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/7257b18d4ca34246beb74caf922174cf><p class=pgc-img-caption></p></div><p><strong>ç¬¬ä¸‰æ­¥ï¼šç»‡å…¥ï¼ˆä½¿ç”¨é…ç½®çš„æ–¹å¼ï¼‰</strong></p><p><strong>ç»‡å…¥åˆ†ä¸ºä¸‰æ­¥ï¼š</strong></p><p><strong>1.é…ç½®ç›®æ ‡å¯¹è±¡</strong></p><p><strong>2.é…ç½®é€šçŸ¥å¯¹è±¡</strong></p><p><strong>3.é…ç½®å°†é€šçŸ¥ç»‡å…¥ç›®æ ‡å¯¹è±¡</strong></p><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9a18d717085c47519be9d68c0f0cd5c9><p class=pgc-img-caption></p></div><p><br></p><pre><code>&lt;!-- 1.é…ç½®ç›®æ ‡å¯¹è±¡ --&gt;	&lt;bean name="userService" class="com.huanfeng.service.UserServiceImpl"&gt;&lt;/bean&gt;&lt;!-- é…ç½®é€šçŸ¥å¯¹è±¡ --&gt;    &lt;bean name="myAdvice" class="com.huanfeng.aop.MyAdvice"&gt;&lt;/bean&gt;&lt;!-- 3.é…ç½®å°†é€šçŸ¥ç»‡å…¥ç›®æ ‡å¯¹è±¡ --&gt;	&lt;aop:config&gt;		&lt;aop:pointcut expression="execution(* com.huanfeng.service.*ServiceImpl.*(..))" id="pc"/&gt;		&lt;aop:aspect ref="myAdvice" &gt;			&lt;!-- æŒ‡å®šåä¸ºbeforeæ–¹æ³•ä½œä¸ºå‰ç½®é€šçŸ¥ --&gt;			&lt;aop:after method="after" pointcut-ref="pc"/&gt;			&lt;aop:before method="before" pointcut-ref="pc" /&gt;			&lt;!-- åç½® --&gt;			&lt;aop:after-returning method="afterReturning" pointcut-ref="pc" /&gt;			&lt;!-- ç¯ç»•é€šçŸ¥ --&gt;			&lt;aop:around method="around" pointcut-ref="pc" /&gt;			&lt;!-- å¼‚å¸¸æ‹¦æˆªé€šçŸ¥ --&gt;			&lt;aop:after-throwing method="afterException" pointcut-ref="pc"/&gt;			&lt;!-- åç½® --&gt;			&lt;aop:after method="after" pointcut-ref="pc"/&gt;		&lt;/aop:aspect&gt;	&lt;/aop:config&gt;</code></pre><p>è¿™ä¸ªé…ç½®åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š</p><p>ç¬¬ä¸€éƒ¨åˆ†æ˜¯é…ç½®ç›®æ ‡å¯¹è±¡ï¼Œä½¿ç”¨beançš„æ–¹å¼</p><p>ç¬¬äºŒéƒ¨åˆ†æ˜¯é…ç½®é€šçŸ¥å¯¹è±¡ï¼Œä½¿ç”¨beançš„æ–¹å¼</p><p>ç¬¬ä¸‰éƒ¨åˆ†æ˜¯ç»‡å…¥ï¼Œexecution(* com.huanfeng.service.*ServiceImpl.*(..))æ˜¯å›ºå®šçš„ç¬¬ä¸€ä¸ª*è¡¨ç¤ºè¿”å›å€¼ä»»æ„ï¼Œç„¶åServiceå‰é¢çš„*è¡¨ç¤ºServiceå‰é¢çš„ä»»æ„ï¼Œç„¶ååé¢çš„*è¡¨ç¤ºè¿™ä¸ª*ServiceImplä¸‹é¢çš„æ‰€æœ‰çš„æ–¹æ³•ï¼Œ(..)è¡¨ç¤ºæ–¹æ³•çš„å‚æ•°æ˜¯ä»»æ„çš„ï¼Œæˆ‘ä»¬ç»™è¿™æ ·çš„åˆ‡ç‚¹èµ·åä¸ºpcï¼Œç„¶åæˆ‘ä»¬å°±å°±å¯ä»¥ä½¿ç”¨aop:aspectæ¥è¿›è¡Œç»‡å…¥äº†ï¼Œrefè¡¨ç¤ºå¢å¼ºçš„æ–¹æ³•ç±»ï¼Œç„¶ååœ¨å†…éƒ¨å¯¹pcè¿›è¡Œç»‡å…¥ã€‚</p><p>æ­¤æ—¶&lt;bean name="userService" class="com.huanfeng.service.UserServiceImpl">&lt;/bean>å¯¹åº”çš„è¿™ä¸ªç±»å°±è¢«å¢å¼ºäº†</p><p>æµ‹è¯•ï¼š</p><pre><code>cishipackage com.huanfeng.shiyan;import javax.annotation.Resource;import org.junit.Test;import org.junit.runner.RunWith;import org.springframework.context.ApplicationContext;import org.springframework.context.support.ClassPathXmlApplicationContext;import org.springframework.test.context.ContextConfiguration;import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;import com.huanfeng.bean.User;import com.huanfeng.service.UserService;@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration("classpath:applicationContext.xml")public class Demo {	@Resource(name="userService")	private UserService us;		@Test	public void fun1(){		us.add();	}	}</code></pre><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c3de133ae24f476fabf364d1673c5a32><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d07decfdc61b477383b5f3ab83205427><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7ad0b4e1d24c4704aef69f8e2cbdb1c5><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>springçš„æ³¨è§£é…ç½®</h1><p>é¦–å…ˆä½¿ç”¨æ³¨è§£é…ç½®éœ€è¦åœ¨xmlä¸­å®Œæˆä¸‰æ­¥ï¼Œå…¶ä¸­å‰ä¸¤æ­¥å’Œå‰é¢ä¸€æ ·ï¼Œåé¢çš„ä¸€æ­¥æ˜¯å¼€å¯æ³¨è§£aop</p><pre><code>&lt;!-- å‡†å¤‡å·¥ä½œ: å¯¼å…¥aop(çº¦æŸ)å‘½åç©ºé—´ --&gt;&lt;!-- 1.é…ç½®ç›®æ ‡å¯¹è±¡ --&gt;	&lt;bean name="userService" class="com.huanfeng.service.UserServiceImpl"&gt;&lt;/bean&gt;&lt;!-- é…ç½®é€šçŸ¥å¯¹è±¡ --&gt;    &lt;bean name="myAdvice" class="com.huanfeng.annotationaop.MyAdvice"&gt;&lt;/bean&gt;&lt;!-- å¼€å¯ä½¿ç”¨æ³¨è§£å®Œæˆç»‡å…¥ --&gt;	&lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;</code></pre><p>é…ç½®å¥½äº†ï¼Œä¹‹åæˆ‘ä»¬éœ€è¦åœ¨é€šçŸ¥å¯¹è±¡ä¸­è¿›è¡Œé…ç½®ï¼š</p><pre><code>package com.huanfeng.annotationaop;import org.aspectj.lang.ProceedingJoinPoint;import org.aspectj.lang.annotation.After;import org.aspectj.lang.annotation.AfterReturning;import org.aspectj.lang.annotation.AfterThrowing;import org.aspectj.lang.annotation.Around;import org.aspectj.lang.annotation.Aspect;import org.aspectj.lang.annotation.Before;//@Aspectè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªé€šçŸ¥ç±»@Aspectpublic class MyAdvice {	    //å‰ç½®é€šçŸ¥	    @Before("execution(* com.huanfeng.service.*ServiceImpl.*(..))")		public void before(){			System.out.println("è¿™æ˜¯å‰ç½®é€šçŸ¥!!");		}		//åç½®é€šçŸ¥	    @AfterReturning("execution(* com.huanfeng.service.*ServiceImpl.*(..))")		public void afterReturning(){			System.out.println("è¿™æ˜¯åç½®é€šçŸ¥(å¦‚æœå‡ºç°å¼‚å¸¸ä¸ä¼šè°ƒç”¨)!!");		}		//ç¯ç»•é€šçŸ¥	    @Around("execution(* com.huanfeng.service.*ServiceImpl.*(..))")		public Object around(ProceedingJoinPoint pjp) throws Throwable {			System.out.println("è¿™æ˜¯ç¯ç»•é€šçŸ¥ä¹‹å‰çš„éƒ¨åˆ†!!");			Object proceed = pjp.proceed();//è°ƒç”¨ç›®æ ‡æ–¹æ³•			System.out.println("è¿™æ˜¯ç¯ç»•é€šçŸ¥ä¹‹åçš„éƒ¨åˆ†!!");			return proceed;		}		//å¼‚å¸¸é€šçŸ¥	    @AfterThrowing("execution(* com.huanfeng.service.*ServiceImpl.*(..))")		public void afterException(){			System.out.println("å‡ºäº‹å•¦!å‡ºç°å¼‚å¸¸äº†!!");		}		//åç½®é€šçŸ¥	    @After("execution(* com.huanfeng.service.*ServiceImpl.*(..))")		public void after(){			System.out.println("è¿™æ˜¯åç½®é€šçŸ¥(å‡ºç°å¼‚å¸¸ä¹Ÿä¼šè°ƒç”¨)!!");		}}</code></pre><p>æˆ‘ä»¬æ¯ä¸ªé€šçŸ¥éƒ½å†™ä¸€ä¸ªexecutionå¤ªè´¹äº‹äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç»Ÿä¸€å¤„ç†ï¼š</p><pre><code>package com.huanfeng.annotationaop;import org.aspectj.lang.ProceedingJoinPoint;import org.aspectj.lang.annotation.After;import org.aspectj.lang.annotation.AfterReturning;import org.aspectj.lang.annotation.AfterThrowing;import org.aspectj.lang.annotation.Around;import org.aspectj.lang.annotation.Aspect;import org.aspectj.lang.annotation.Before;import org.aspectj.lang.annotation.Pointcut;//@Aspectè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªé€šçŸ¥ç±»@Aspectpublic class MyAdvice {	    //å‰ç½®é€šçŸ¥		@Pointcut("execution(* com.huanfeng.service.*ServiceImpl.*(..))")		public void pc(){}	    @Before("MyAdvice.pc()")		public void before(){			System.out.println("è¿™æ˜¯å‰ç½®é€šçŸ¥!!");		}		//åç½®é€šçŸ¥	    @AfterReturning("MyAdvice.pc()")		public void afterReturning(){			System.out.println("è¿™æ˜¯åç½®é€šçŸ¥(å¦‚æœå‡ºç°å¼‚å¸¸ä¸ä¼šè°ƒç”¨)!!");		}		//ç¯ç»•é€šçŸ¥	    @Around("MyAdvice.pc()")		public Object around(ProceedingJoinPoint pjp) throws Throwable {			System.out.println("è¿™æ˜¯ç¯ç»•é€šçŸ¥ä¹‹å‰çš„éƒ¨åˆ†!!");			Object proceed = pjp.proceed();//è°ƒç”¨ç›®æ ‡æ–¹æ³•			System.out.println("è¿™æ˜¯ç¯ç»•é€šçŸ¥ä¹‹åçš„éƒ¨åˆ†!!");			return proceed;		}		//å¼‚å¸¸é€šçŸ¥	    @AfterThrowing("MyAdvice.pc()")		public void afterException(){			System.out.println("å‡ºäº‹å•¦!å‡ºç°å¼‚å¸¸äº†!!");		}		//åç½®é€šçŸ¥	    @After("MyAdvice.pc()")		public void after(){			System.out.println("è¿™æ˜¯åç½®é€šçŸ¥(å‡ºç°å¼‚å¸¸ä¹Ÿä¼šè°ƒç”¨)!!");		}}</code></pre><p>ä¹‹åå°±å¯ä»¥æµ‹è¯•äº†ï¼š</p><pre><code>package com.huanfeng.annotationaop;import javax.annotation.Resource;import org.junit.Test;import org.junit.runner.RunWith;import org.springframework.test.context.ContextConfiguration;import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;import com.huanfeng.service.UserService;import com.huanfeng.service.UserServiceImpl;@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration("classpath:com/huanfeng/annotationaop/applicationContext.xml")public class Demo {	@Resource(name="userService")	private UserService us;	@Test	public void test1() {		us.add();	}}</code></pre><h1 class=pgc-h-arrow-right>springæ•´åˆjdbcæ¨¡æ¿</h1><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5ca066823dd6442fa12b42bc1983fdb3><p class=pgc-img-caption></p></div><p>JdbcTemplateæ¨¡æ¿çš„ä½¿ç”¨ï¼Œè¿™ä¸ªå’ŒQueryRunnerä½¿ç”¨æ˜¯å·®ä¸å¤šçš„ï¼Œå°†æ•°æ®åº“è¿æ¥æ± è¿æ¥ä¸Šå°±å¯ä»¥è¿›è¡Œæ•°æ®åº“æ“ä½œäº†</p><pre><code>//åˆ›å»ºè¿æ¥æ± 		ComboPooledDataSource dataSource=new ComboPooledDataSource();		dataSource.setDriverClass("com.mysql.jdbc.Driver");		dataSource.setJdbcUrl("jdbc:mysql:///spring_data");		dataSource.setUser("root");		dataSource.setPassword("root");		//åˆ›å»ºJDBCæ¨¡æ¿å¯¹è±¡		JdbcTemplate jt=new JdbcTemplate();		jt.setDataSource(dataSource);		String sql="DELETE FROM shiyan WHERE number='3'";		int i=jt.update(sql);		System.out.println(i);</code></pre><p>ä¸Šé¢ä»…ä»…ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨jabcTemplateæ¥å®Œæˆæ•°æ®åº“çš„è¿æ¥å·¥ä½œï¼Œå¯¹äºæ•°æ®åº“çš„æ“ä½œè€Œè¨€ï¼Œéœ€è¦è¿›è¡Œå¢åˆ æ”¹æŸ¥çš„æ“ä½œï¼Œé‚£ä¹ˆå¦‚ä½•ä½¿ç”¨jdbcè¿›è¡Œå¢åˆ æ”¹æŸ¥å‘¢</p><pre><code>package com.huanfeng.dao;import java.util.List;import com.huanfeng.dao.User;public interface UserDao {	//å¢åŠ 	void add(User u);	//åˆ é™¤	void delete(Integer id);	//ä¿®æ”¹	void update(User u);	//æŸ¥è¯¢æŒ‡å®šidçš„uesr	User getById(Integer id);	//æŸ¥è¯¢useræ€»äººæ•°	int getTotalCount();	//æŸ¥è¯¢æ‰€æœ‰userä¿¡æ¯	List&lt;User&gt; getAll();}</code></pre><p>å¦‚ä¸‹æ‰€ç¤ºæ¶µç›–äº†ä½¿ç”¨jtå¤„ç†å¸¸è§æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥æ“ä½œçš„å¸¸ç”¨æ–¹æ³•ï¼Œå…¶ä¸­é™¤äº†æŸ¥è¯¢ä¹‹å¤–éƒ½ä½¿ç”¨updateæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯sqlè¯­å¥ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯sqlè¯­å¥çš„ï¼Ÿå¯¹åº”çš„å€¼ã€‚</p><p>æŸ¥è¯¢ä½¿ç”¨queryï¼ˆè·å–listï¼‰å’ŒqueryObjectï¼ˆè·å–ä¸€ä¸ªå¯¹è±¡æˆ–è€…å•ä¸ªå€¼ï¼‰éƒ½å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯sqlï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯sqlä¸­çš„ï¼Ÿï¼ˆå¯æœ‰å¯æ— ï¼Œè¿™æ˜¯å¯å˜é•¿çš„å‚æ•°ï¼‰ï¼Œç¬¬äºŒä¸ªæ˜¯ä¸€ä¸ªRowMapperè¿™ä¸ªç±»ä¼¼äºdbutilsä¸­çš„ListHandler,ä½†æ˜¯è¿™ä¸ªæ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨çš„å¯¹å…¶è¿›è¡Œå°è£…å¤„ç†ï¼Œç„¶åé‡Œé¢çš„å‚æ•°ResultSetè¡¨ç¤ºæŸ¥è¯¢å‡ºæ¥çš„æ¯ä¸€è¡Œç»“æœï¼Œæˆ‘ä»¬åªéœ€è¦å°†å…¶å°è£…æˆä¸€ä¸ªuserå¯¹è±¡å°±å¥½äº†ï¼Œç„¶åå®ƒä¼šè‡ªåŠ¨çš„ä¸€æ¬¡åˆä¸€æ¬¡åœ°å°è£…ã€‚</p><p>è¿˜æœ‰å¦‚æœæŸ¥è¯¢å‡ºæ¥çš„ç»“æœæ˜¯ä¸€ä¸ªå€¼ï¼Œæ¯”å¦‚æŸ¥è¯¢count(*)ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨queryObjectï¼Œæ­¤æ—¶çš„ç¬¬äºŒä¸ªå‚æ•°å°±ä¸æ˜¯RowMapperäº†ï¼Œè€Œæ˜¯è¿™ä¸ªå€¼å¯¹åº”çš„ç±»å‹</p><pre><code>package com.huanfeng.dao;import java.sql.ResultSet;import java.sql.SQLException;import java.util.List;import com.huanfeng.dao.User;import org.springframework.jdbc.core.JdbcTemplate;import org.springframework.jdbc.core.RowMapper;public class UserDaoImpl implements UserDao {	private JdbcTemplate jt;	public void setjt(JdbcTemplate jt) {		this.jt=jt;	}	@Override	//è¿™æ˜¯å¢åŠ æ–¹æ³•	public void add(User u) {		String sql="insert into user values(?,?,null)";		jt.update(sql,u.getName(),u.getAge());	}    //è¿™æ˜¯åˆ é™¤æ–¹æ³•	@Override	public void delete(Integer id) {		String sql="delete from user where id=?";		jt.update(sql,id);	}	@Override	//è¿™æ˜¯ä¿®æ”¹æ–¹æ³•	public void update(User u) {		String sql="update user set name=? ,age=? where id=?";		jt.update(sql,u.getName(),u.getAge(),u.getId());	}	@Override	//è¿™æ˜¯è·å–æŒ‡å®šidçš„ç”¨æˆ·	public User getById(Integer id) {		String sql="select * from user where id=?";		User u=jt.queryForObject(sql, new RowMapper&lt;User&gt;() {			@Override			public User mapRow(ResultSet rs, int arg1) throws SQLException {				User u=new User();				u.setAge(rs.getInt("age"));				u.setName(rs.getString("name"));				u.setId(rs.getInt("id"));				return u;			}}, id);		return u;	}	@Override	//è·å–ç”¨æˆ·çš„æ•°é‡	public int getTotalCount() {		String sql="select count(*) from user";		Integer c=jt.queryForObject(sql,Integer.class);		return c;	}	@Override	//è·å–æ‰€æœ‰çš„ç”¨æˆ·	public List&lt;User&gt; getAll() {		String sql="select * from user";		List&lt;User&gt; userList=jt.query(sql, new RowMapper&lt;User&gt;(){			@Override			public User mapRow(ResultSet rs, int arg1) throws SQLException {				User u=new User();				u.setAge(rs.getInt("age"));				u.setId(rs.getInt("id"));				u.setName(rs.getString("name"));				return u;			}});		return userList;	}}</code></pre><p>å°†jdbcæ•´åˆè¿›springä¸­ï¼Œå¹¶è¿›è¡Œæµ‹è¯•ï¼š</p><pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.springframework.org/schema/beans" xmlns:context="http://www.springframework.org/schema/context" xmlns:aop="http://www.springframework.org/schema/aop" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.2.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.2.xsd "&gt;&lt;!-- 1ã€é…ç½®æ•°æ®åº“è¿æ¥æ±  --&gt;&lt;bean name="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"&gt;	&lt;property name="jdbcUrl" value="jdbc:mysql:///spring_data"&gt;&lt;/property&gt;	&lt;property name="driverClass" value="com.mysql.jbdc.Driver"&gt;&lt;/property&gt;	&lt;property name="user" value="root"&gt;&lt;/property&gt;	&lt;property name="password" value="root"&gt;&lt;/property&gt;&lt;/bean&gt;&lt;!-- 2ã€é…ç½®æ¨¡æ¿JDBC --&gt;&lt;bean name="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate"&gt;	&lt;property name="dataSource" ref="dataSource"&gt;&lt;/property&gt;&lt;/bean&gt;&lt;!-- 3ã€é…ç½®UserDao --&gt;&lt;bean name="userDao" class="com.huanfeng.dao.UserDaoImpl"&gt;	&lt;property name="jt" ref="jdbcTemplate"&gt;&lt;/property&gt;&lt;/bean&gt;&lt;/beans&gt;</code></pre><p>å¦‚ä¸Šæ‰€ç¤ºè¦æƒ³ä½¿ç”¨é…ç½®JDBCé¦–å…ˆéœ€è¦ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± ï¼Œç„¶åå°†jdbcæ¨¡æ¿é…ç½®åˆ°userDaoä¸­ï¼Œæ­¤æ—¶å°±å¯ä»¥åœ¨æµ‹è¯•é›†ä¸­ç›´æ¥ä½¿ç”¨userDaoæ¥è¿›è¡Œæ“ä½œäº†ï¼š</p><pre><code>package com.huanfeng.dao;import java.util.List;import javax.annotation.Resource;import org.junit.Test;import org.junit.runner.RunWith;import org.springframework.core.env.SystemEnvironmentPropertySource;import org.springframework.test.context.ContextConfiguration;import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration("classpath:com/huanfeng/dao/applicationContext.xml")public class Demo {	@Resource(name="userDao")	private UserDao ud;	@Test	public void test1() {		User u=new User();		u.setAge(100);		u.setName("xia");		u.setId(3);		ud.add(u);	}	@Test	public void test2() {		ud.delete(1);	}	@Test	public void test3() {		User u=new User();		u.setAge(100);		u.setName("xiaoo");		u.setId(3);		ud.update(u);	}	@Test	public void test4() {		User u=ud.getById(2);		System.out.println(u);	}	@Test	public void test5() {		int c=ud.getTotalCount();		System.out.println(c);	}	@Test	public void test6() {		List&lt;User&gt; l=ud.getAll();		System.out.println(l);	}}</code></pre><p>jdbcçš„æ‰©å±•ï¼Œåœ¨ä¹‹å‰æˆ‘ä»¬ä½¿ç”¨äº†JdbcTemplateçš„æ—¶å€™ä½¿ç”¨äº†UserDaoImplè¿›è¡Œäº†å‚æ•°ä¼ é€’ï¼Œæ˜¯å¦å¯ä»¥ä¸è¿›è¡Œè¿™æ ·åœ°æ“ä½œäº†ï¼Ÿå¯ä»¥å…·ä½“æ¥è¯´é¦–å…ˆUserDaoImplä¸­ä½¿ç”¨ï¼Œæˆ‘ä»¬éœ€è¦ç»§æ‰¿ï¼š</p><p>JdbcDaoSupport</p><p>è¿™æ ·å°±å¯ä»¥é€šè¿‡super.getJdbcTemplate()è·å–jdbcæ¨¡æ¿å¯¹è±¡äº†ã€‚</p><p>é‚£ä¹ˆåœ¨xmlä¸­å°±ä¸ç”¨é…ç½®æ¨¡æ¿å¯¹è±¡äº†ï¼Œä½†æ˜¯éœ€è¦å°†æ•°æ®åº“è¿æ¥æ± é…ç½®åˆ°UserServiceDaoä¸­ï¼š</p><pre><code>package com.huanfeng.dao;import java.sql.ResultSet;import java.sql.SQLException;import java.util.List;import com.huanfeng.dao.User;import org.springframework.jdbc.core.JdbcTemplate;import org.springframework.jdbc.core.RowMapper;import org.springframework.jdbc.core.support.JdbcDaoSupport;public class UserDaoImpl2 extends JdbcDaoSupport implements UserDao {	@Override	//è¿™æ˜¯å¢åŠ æ–¹æ³•	public void add(User u) {		String sql="insert into user values(?,?,null)";		super.getJdbcTemplate().update(sql,u.getName(),u.getAge());	}    //è¿™æ˜¯åˆ é™¤æ–¹æ³•	@Override	public void delete(Integer id) {		String sql="delete from user where id=?";		super.getJdbcTemplate().update(sql,id);	}	@Override	//è¿™æ˜¯ä¿®æ”¹æ–¹æ³•	public void update(User u) {		String sql="update user set name=?, age=? where id=?";		super.getJdbcTemplate().update(sql,u.getName(),u.getAge(),u.getId());	}	@Override	//è¿™æ˜¯è·å–æŒ‡å®šidçš„ç”¨æˆ·	public User getById(Integer id) {		String sql="select * from user where id=?";		User u=super.getJdbcTemplate().queryForObject(sql, new RowMapper&lt;User&gt;() {			@Override			public User mapRow(ResultSet rs, int arg1) throws SQLException {				User u=new User();				u.setAge(rs.getInt("age"));				u.setName(rs.getString("name"));				u.setId(rs.getInt("id"));				return u;			}}, id);		return u;	}	@Override	//è·å–ç”¨æˆ·çš„æ•°é‡	public int getTotalCount() {		String sql="select count(*) from user";		Integer c=super.getJdbcTemplate().queryForObject(sql,Integer.class);		return c;	}	@Override	//è·å–æ‰€æœ‰çš„ç”¨æˆ·	public List&lt;User&gt; getAll() {		String sql="select * from user";		List&lt;User&gt; userList=super.getJdbcTemplate().query(sql, new RowMapper&lt;User&gt;(){			@Override			public User mapRow(ResultSet rs, int arg1) throws SQLException {				User u=new User();				u.setAge(rs.getInt("age"));				u.setId(rs.getInt("id"));				u.setName(rs.getString("name"));				return u;			}});		return userList;	}}</code></pre><pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.springframework.org/schema/beans" xmlns:context="http://www.springframework.org/schema/context" xmlns:aop="http://www.springframework.org/schema/aop" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.2.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.2.xsd "&gt;&lt;!-- 1ã€é…ç½®æ•°æ®åº“è¿æ¥æ±  --&gt;&lt;bean name="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"&gt;	&lt;property name="jdbcUrl" value="jdbc:mysql:///spring_data"&gt;&lt;/property&gt;	&lt;property name="driverClass" value="com.mysql.jbdc.Driver"&gt;&lt;/property&gt;	&lt;property name="user" value="root"&gt;&lt;/property&gt;	&lt;property name="password" value="root"&gt;&lt;/property&gt;&lt;/bean&gt;&lt;!-- 3ã€é…ç½®UserDao --&gt;&lt;bean name="userDao" class="com.huanfeng.dao.UserDaoImpl2"&gt;	&lt;property name="dataSource" ref="dataSource"&gt;&lt;/property&gt;&lt;/bean&gt;&lt;/beans&gt;</code></pre><p>å°†æ•°æ®åº“è¿æ¥æ± çš„é…ç½®åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼š</p><pre><code>jdbc.jdbcUrl=jdbc:mysql:///spring_datajdbc.driverClass=com.mysql.jdbc.Driverjdbc.user=rootjdbc.password=root</code></pre><p>ä¹‹ååœ¨xmlä¸­å°±å¯ä»¥è¿™æ ·è¿›è¡Œé…ç½®äº†</p><pre><code>&lt;context:property-placeholder location="classpath:db.properties"  /&gt;&lt;!-- 1ã€é…ç½®æ•°æ®åº“è¿æ¥æ±  --&gt;&lt;bean name="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"&gt;	&lt;property name="jdbcUrl" value="${jdbc.jdbcUrl}"&gt;&lt;/property&gt;	&lt;property name="driverClass" value="${jdbc.driverClass}"&gt;&lt;/property&gt;	&lt;property name="user" value="${jdbc.user}"&gt;&lt;/property&gt;	&lt;property name="password" value="${jdbc.password}"&gt;&lt;/property&gt;&lt;/bean&gt;</code></pre><h1 class=pgc-h-arrow-right>äº‹åŠ¡</h1><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/def44838ec284d2aa703a724d3b892dd><p class=pgc-img-caption></p></div><p><strong>äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºï¼š</strong></p><blockquote class=pgc-blockquote-abstract><p>PROPAGION_XXX :äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º * ä¿è¯åŒä¸€ä¸ªäº‹åŠ¡ä¸­ PROPAGATION_REQUIRED æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœä¸å­˜åœ¨ å°±æ–°å»ºä¸€ä¸ª(é»˜è®¤) PROPAGATION_SUPPORTS æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¸ä½¿ç”¨äº‹åŠ¡ PROPAGATION_MANDATORY æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœä¸å­˜åœ¨ï¼ŒæŠ›å‡ºå¼‚å¸¸</p><p><br></p><p>* ä¿è¯æ²¡æœ‰åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ PROPAGATION_REQUIRES_NEW å¦‚æœæœ‰äº‹åŠ¡å­˜åœ¨ï¼ŒæŒ‚èµ·å½“å‰äº‹åŠ¡ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ PROPAGATION_NOT_SUPPORTED ä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœæœ‰äº‹åŠ¡å­˜åœ¨ï¼ŒæŒ‚èµ·å½“å‰äº‹åŠ¡</p><p><br></p><p>PROPAGATION_NEVER ä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœæœ‰äº‹åŠ¡å­˜åœ¨ï¼ŒæŠ›å‡ºå¼‚å¸¸</p><p><br></p><p>PROPAGATION_NESTED å¦‚æœå½“å‰äº‹åŠ¡å­˜åœ¨ï¼Œåˆ™åµŒå¥—äº‹åŠ¡æ‰§è¡Œ</p></blockquote><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/66cfafbc03144d848bc806c01940f174><p class=pgc-img-caption></p></div><p>äº‹åŠ¡ï¼Œè½¬è´¦</p><p>é¦–å…ˆåœ¨xmlä¸­é…ç½®å¥½æ•°æ®åº“è¿æ¥æ± ï¼Œäº‹åŠ¡ï¼Œä»¥åŠserviceå’Œdaoï¼š</p><pre><code>&lt;!-- äº‹åŠ¡æ ¸å¿ƒç®¡ç†å™¨ï¼Œå°è£…äº†æ‰€æœ‰äº‹åŠ¡æ“ä½œ --&gt;&lt;bean name="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager" &gt;	&lt;property name="dataSource" ref="dataSource" &gt;&lt;/property&gt;&lt;/bean&gt;&lt;!-- äº‹åŠ¡æ¨¡æ¿å¯¹è±¡ --&gt;&lt;bean name="transactionTemplate" class="org.springframework.transaction.support.TransactionTemplate" &gt;	&lt;property name="transactionManager" ref="transactionManager" &gt;&lt;/property&gt;&lt;/bean&gt;&lt;!-- 1ã€é…ç½®æ•°æ®åº“è¿æ¥æ±  --&gt;&lt;bean name="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"&gt;	&lt;property name="jdbcUrl" value="${jdbc.jdbcUrl}"&gt;&lt;/property&gt;	&lt;property name="driverClass" value="${jdbc.driverClass}"&gt;&lt;/property&gt;	&lt;property name="user" value="${jdbc.user}"&gt;&lt;/property&gt;	&lt;property name="password" value="${jdbc.password}"&gt;&lt;/property&gt;&lt;/bean&gt;&lt;!-- 3ã€é…ç½®UserDao --&gt;&lt;bean name="AccountDao" class="com.huanfeng.dao.AccountDaoImpl"&gt;	&lt;property name="dataSource" ref="dataSource"&gt;&lt;/property&gt;&lt;/bean&gt;                           &lt;bean name="AccountService" class="com.huanfeng.service.AccountServiceImpl"&gt;	&lt;property name="ad" ref="AccountDao"&gt;&lt;/property&gt;	&lt;property name="tt" ref="transactionTemplate" &gt;&lt;/property&gt;&lt;/bean&gt;</code></pre><p>é¦–å…ˆé…ç½®äº‹åŠ¡çš„æ ¸å¿ƒç®¡ç†å™¨ï¼Œé‡Œé¢éœ€è¦ä¾èµ–æ•°æ®åº“è¿æ¥æ± ï¼Œç„¶åé…ç½®äº‹åŠ¡æ¨¡æ¿å¯¹è±¡ï¼Œè¿™ä¸ªä¾èµ–äº‹åŠ¡çš„æ ¸å¿ƒç®¡ç†å™¨ã€‚</p><p>ä¹‹åé…ç½®serviceå’Œdaoï¼Œdaoä¸­ç”±äºä½¿ç”¨äº†ç»§æ‰¿JdbcDaoSupportï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦ä¾èµ–æ•°æ®åº“è¿æ¥æ± ï¼Œç„¶åServiceä¸ä»…ä¾èµ–daoï¼Œè€Œä¸”è¿˜ä¾èµ–äº‹åŠ¡æ¨¡æ¿å¯¹è±¡ã€‚</p><pre><code>package com.huanfeng.dao;public interface AccountDao {	void increaseMoney(Integer id,Double money);	void decreaseMoney(Integer id,Double money);}</code></pre><pre><code>package com.huanfeng.dao;import org.springframework.jdbc.core.support.JdbcDaoSupport;public class AccountDaoImpl extends JdbcDaoSupport implements AccountDao {	@Override	public void increaseMoney(Integer id, Double money) {		String sql="update table_count set money=money+? where id=?";		super.getJdbcTemplate().update(sql,money,id);	}	@Override	public void decreaseMoney(Integer id, Double money) {		String sql="update table_count set money=money-? where id=?";		super.getJdbcTemplate().update(sql,money,id);	}}</code></pre><pre><code>package com.huanfeng.service;public interface AccountService {	public void transfer(Integer from,Integer to,Double money);}</code></pre><pre><code>package com.huanfeng.service;import org.springframework.transaction.TransactionStatus;import org.springframework.transaction.support.TransactionCallbackWithoutResult;import org.springframework.transaction.support.TransactionTemplate;import com.huanfeng.dao.AccountDao;public class AccountServiceImpl implements AccountService {	private AccountDao ad;	private TransactionTemplate tt;	public TransactionTemplate getTt() {		return tt;	}	public void setTt(TransactionTemplate tt) {		this.tt = tt;	}	public AccountDao getAd() {		return ad;	}	public void setAd(AccountDao ad) {		this.ad = ad;	}	@Override	public void transfer(Integer from, Integer to, Double money) {				tt.execute(new TransactionCallbackWithoutResult() {			@Override			protected void doInTransactionWithoutResult(TransactionStatus arg0) {				//å‡é’±				ad.decreaseMoney(from, money);				//åŠ é’±				ad.increaseMoney(to, money);			}		});	}}</code></pre><p>AccountServiceImplä¸­éœ€è¦TransactionTemplateäº‹åŠ¡æ¨¡æ¿å¯¹è±¡ï¼Œä»¥ä¾¿äºå¼€å¯äº‹åŠ¡ï¼Œä¹‹åå¯ä»¥æµ‹è¯•äº†ï¼š</p><pre><code>package com.huanfeng.transaction;import javax.annotation.Resource;import org.junit.Test;import org.junit.runner.RunWith;import org.springframework.test.context.ContextConfiguration;import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;import com.huanfeng.service.AccountService;@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration("classpath:com/huanfeng/dao/applicationContext3.xml")public class Demo1 {	@Resource(name="AccountService")	private AccountService as;	@Test	public void test1() {		as.transfer(1, 2, 500d);	}}</code></pre><h1 class=pgc-h-arrow-right>aopé…ç½®äº‹åŠ¡</h1><p>é¦–å…ˆé…ç½®çº¦æŸ</p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/37ff33c55009412c852b351d1e7d3ed8><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/72b21a1a1883496ebc4ed65d578a60e1><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4b4ac682a46a4a669f21abb5c2748bd5><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=springæ¡†æ¶çš„å…¥é—¨å­¦ä¹ ï¼šAOPå’Œé¢å‘åˆ‡é¢çš„äº‹åŠ¡ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/104e2d77dbd54ba2978ff1021c27da32><p class=pgc-img-caption></p></div><p>äº‹åŠ¡æœ¬èº«å°±éœ€è¦å¼€å¯äº‹åŠ¡ä»¥åŠå…³é—­äº‹åŠ¡ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨é¢å‘åˆ‡é¢çš„æ€æƒ³æ¥å¯¹serviceä¸­çš„æ–¹æ³•è¿›è¡Œå¢å¼ºï¼Œspringå·²ç»å†™å¥½äº†é€šçŸ¥ï¼Œæ‰€ä»¥ä¸éœ€è¦æˆ‘ä»¬å†™é€šçŸ¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡tx:adviceæ¥é…ç½®äº‹åŠ¡é€šçŸ¥ï¼Œç„¶åå°†è¿™ä¸ªé€šçŸ¥ç»‡å…¥åˆ°serviceæ–¹æ³•ä¸­ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„serviceéƒ½æ˜¯è¢«äº‹åŠ¡å¢å¼ºçš„æ–¹æ³•ï¼Œä¹‹åå°±ä¸éœ€è¦æ‰‹åŠ¨å¢åŠ äº‹åŠ¡äº†ã€‚é…ç½®å¦‚ä¸‹ï¼š</p><pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.springframework.org/schema/beans" xmlns:context="http://www.springframework.org/schema/context" xmlns:aop="http://www.springframework.org/schema/aop" xmlns:tx="http://www.springframework.org/schema/tx" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.2.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.2.xsd "&gt;&lt;context:property-placeholder location="classpath:db.properties"  /&gt;&lt;!-- äº‹åŠ¡æ ¸å¿ƒç®¡ç†å™¨ï¼Œå°è£…äº†æ‰€æœ‰äº‹åŠ¡æ“ä½œ --&gt;&lt;bean name="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager" &gt;	&lt;property name="dataSource" ref="dataSource" &gt;&lt;/property&gt;&lt;/bean&gt;&lt;!-- äº‹åŠ¡æ¨¡æ¿å¯¹è±¡ --&gt;&lt;bean name="transactionTemplate" class="org.springframework.transaction.support.TransactionTemplate" &gt;	&lt;property name="transactionManager" ref="transactionManager" &gt;&lt;/property&gt;&lt;/bean&gt;&lt;tx:advice id="txAdvice" transaction-manager="transactionManager" &gt;	&lt;tx:attributes&gt;		&lt;!-- ä»¥æ–¹æ³•ä¸ºå•ä½,æŒ‡å®šæ–¹æ³•åº”ç”¨ä»€ä¹ˆäº‹åŠ¡å±æ€§			isolation:éš”ç¦»çº§åˆ«			propagation:ä¼ æ’­è¡Œä¸º			read-only:æ˜¯å¦åªè¯»		 --&gt;		&lt;tx:method name="save*" isolation="REPEATABLE_READ" propagation="REQUIRED" read-only="false" /&gt;		&lt;tx:method name="persist*" isolation="REPEATABLE_READ" propagation="REQUIRED" read-only="false" /&gt;		&lt;tx:method name="update*" isolation="REPEATABLE_READ" propagation="REQUIRED" read-only="false" /&gt;		&lt;tx:method name="modify*" isolation="REPEATABLE_READ" propagation="REQUIRED" read-only="false" /&gt;		&lt;tx:method name="delete*" isolation="REPEATABLE_READ" propagation="REQUIRED" read-only="false" /&gt;		&lt;tx:method name="remove*" isolation="REPEATABLE_READ" propagation="REQUIRED" read-only="false" /&gt;		&lt;tx:method name="get*" isolation="REPEATABLE_READ" propagation="REQUIRED" read-only="true" /&gt;		&lt;tx:method name="find*" isolation="REPEATABLE_READ" propagation="REQUIRED" read-only="true" /&gt;		&lt;tx:method name="transfer" isolation="REPEATABLE_READ" propagation="REQUIRED" read-only="false" /&gt;	&lt;/tx:attributes&gt;&lt;/tx:advice&gt;&lt;!-- é…ç½®ç»‡å…¥ --&gt;&lt;aop:config  &gt;	&lt;!-- é…ç½®åˆ‡ç‚¹è¡¨è¾¾å¼ --&gt;	&lt;aop:pointcut expression="execution(* com.huanfeng.service.*ServiceImpl.*(..))" id="txPc"/&gt;	&lt;!-- é…ç½®åˆ‡é¢ : é€šçŸ¥+åˆ‡ç‚¹		 	advice-ref:é€šçŸ¥çš„åç§°		 	pointcut-ref:åˆ‡ç‚¹çš„åç§°	 --&gt;	&lt;aop:advisor advice-ref="txAdvice" pointcut-ref="txPc" /&gt;&lt;/aop:config&gt;&lt;!-- 1ã€é…ç½®æ•°æ®åº“è¿æ¥æ±  --&gt;&lt;bean name="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"&gt;	&lt;property name="jdbcUrl" value="${jdbc.jdbcUrl}"&gt;&lt;/property&gt;	&lt;property name="driverClass" value="${jdbc.driverClass}"&gt;&lt;/property&gt;	&lt;property name="user" value="${jdbc.user}"&gt;&lt;/property&gt;	&lt;property name="password" value="${jdbc.password}"&gt;&lt;/property&gt;&lt;/bean&gt;&lt;!-- 3ã€é…ç½®UserDao --&gt;&lt;bean name="userDao" class="com.huanfeng.dao.UserDaoImpl2"&gt;	&lt;property name="dataSource" ref="dataSource"&gt;&lt;/property&gt;&lt;/bean&gt;&lt;bean name="AccountDao" class="com.huanfeng.dao.AccountDaoImpl"&gt;	&lt;property name="dataSource" ref="dataSource"&gt;&lt;/property&gt;&lt;/bean&gt;                           &lt;bean name="AccountService" class="com.huanfeng.service.AccountServiceImpl"&gt;	&lt;property name="ad" ref="AccountDao"&gt;&lt;/property&gt;	&lt;property name="tt" ref="transactionTemplate" &gt;&lt;/property&gt;&lt;/bean&gt;&lt;/beans&gt;</code></pre><p>ä¹‹åå†servieä¸­ç›´æ¥è°ƒç”¨daoä¸­çš„æ–¹æ³•å°±å¯ä»¥äº†ï¼š</p><pre><code>public void transfer(Integer from, Integer to, Double money) {				//å‡é’±				ad.decreaseMoney(from, money);				//åŠ é’±				ad.increaseMoney(to, money);	}</code></pre><p>ä¸‹é¢å­¦ä¹ ä¸€ä¸‹æ³¨è§£çš„é…ç½®æ–¹å¼</p><p>æˆ‘ä»¬å¯ä»¥å°†å‰é¢çš„é€šçŸ¥å’Œç»‡å…¥å…¨éƒ¨åˆ æ‰ï¼Œä½¿ç”¨&lt;tx:annotation-driven/>ï¼Œæ­¤æ—¶çš„xmlé…ç½®ä¸ºï¼š</p><pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.springframework.org/schema/beans" xmlns:context="http://www.springframework.org/schema/context" xmlns:aop="http://www.springframework.org/schema/aop" xmlns:tx="http://www.springframework.org/schema/tx" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.2.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.2.xsd "&gt;&lt;context:property-placeholder location="classpath:db.properties"  /&gt;&lt;!-- äº‹åŠ¡æ ¸å¿ƒç®¡ç†å™¨ï¼Œå°è£…äº†æ‰€æœ‰äº‹åŠ¡æ“ä½œ --&gt;&lt;bean name="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager" &gt;	&lt;property name="dataSource" ref="dataSource" &gt;&lt;/property&gt;&lt;/bean&gt;&lt;!-- äº‹åŠ¡æ¨¡æ¿å¯¹è±¡ --&gt;&lt;bean name="transactionTemplate" class="org.springframework.transaction.support.TransactionTemplate" &gt;	&lt;property name="transactionManager" ref="transactionManager" &gt;&lt;/property&gt;&lt;/bean&gt;&lt;tx:annotation-driven/&gt;&lt;!-- 1ã€é…ç½®æ•°æ®åº“è¿æ¥æ±  --&gt;&lt;bean name="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"&gt;	&lt;property name="jdbcUrl" value="${jdbc.jdbcUrl}"&gt;&lt;/property&gt;	&lt;property name="driverClass" value="${jdbc.driverClass}"&gt;&lt;/property&gt;	&lt;property name="user" value="${jdbc.user}"&gt;&lt;/property&gt;	&lt;property name="password" value="${jdbc.password}"&gt;&lt;/property&gt;&lt;/bean&gt;&lt;!-- 3ã€é…ç½®UserDao --&gt;&lt;bean name="userDao" class="com.huanfeng.dao.UserDaoImpl2"&gt;	&lt;property name="dataSource" ref="dataSource"&gt;&lt;/property&gt;&lt;/bean&gt;&lt;bean name="AccountDao" class="com.huanfeng.dao.AccountDaoImpl"&gt;	&lt;property name="dataSource" ref="dataSource"&gt;&lt;/property&gt;&lt;/bean&gt;                           &lt;bean name="AccountService" class="com.huanfeng.service.AccountServiceImpl"&gt;	&lt;property name="ad" ref="AccountDao"&gt;&lt;/property&gt;	&lt;property name="tt" ref="transactionTemplate" &gt;&lt;/property&gt;&lt;/bean&gt;&lt;/beans&gt;</code></pre><p>ç„¶åä½¿ç”¨çš„æ—¶å€™å¯ä»¥ç›´æ¥åœ¨serviceä¸­è¿›è¡Œé…ç½®ï¼š</p><pre><code>@Transactional(isolation=Isolation.REPEATABLE_READ,propagation=Propagation.REQUIRED,readOnly=false)public void transfer(Integer from, Integer to, Double money) {				ad.decreaseMoney(from, money);				ad.increaseMoney(to, money);	}</code></pre><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨@Transationalæ¥ç›´æ¥åœ¨æ–¹æ³•åŒé…ç½®é€šçŸ¥ï¼Œæ­¤æ—¶è¡¨ç¤ºè¿™ä¸ªæ–¹æ³•è¢«äº‹åŠ¡é€šçŸ¥å¢å¼ºäº†ï¼Œå½“ç„¶å¦‚æœæ¯ä¸ªæ–¹æ³•éƒ½è¿™æ ·é…ç½®æ„Ÿè§‰éº»çƒ¦ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥é…ç½®åœ¨ç±»ä¸Šï¼Œè¿™æ ·è¡¨ç¤ºè¿™ä¸ªç±»çš„æ‰€æœ‰æ–¹æ³•éƒ½è¢«å¢å¼ºäº†ï¼Œä½†æ˜¯ç¬¬ä¸€ä¼˜å…ˆçº§åº”è¯¥è¿˜æ˜¯æ–¹æ³•ã€‚</p><pre><code>@Transactional(isolation=Isolation.REPEATABLE_READ,propagation=Propagation.REQUIRED,readOnly=true)public class AccountServiceImpl implements AccountService {	private AccountDao ad ;	private TransactionTemplate tt;		@Override	@Transactional(isolation=Isolation.REPEATABLE_READ,propagation=Propagation.REQUIRED,readOnly=false)	public void transfer(final Integer from,final Integer to,final Double money) {				//å‡é’±				ad.decreaseMoney(from, money);				int i = 1/0;				//åŠ é’±				ad.increaseMoney(to, money);	}}</code></pre></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'spring','å…¥é—¨','å­¦ä¹ '</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>