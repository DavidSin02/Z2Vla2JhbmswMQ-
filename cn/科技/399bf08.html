<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>线程，进程，协程， 并发，并行，同步，异步概念解析 | 极客快訊</title><meta property="og:title" content="线程，进程，协程， 并发，并行，同步，异步概念解析 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/41ca5e6e9b914e628478b8262ae96e43"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/399bf08.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/399bf08.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/399bf08.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/399bf08.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/399bf08.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/399bf08.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/399bf08.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/399bf08.html><meta property="article:published_time" content="2020-10-29T20:58:13+08:00"><meta property="article:modified_time" content="2020-10-29T20:58:13+08:00"><meta name=Keywords content><meta name=description content="线程，进程，协程， 并发，并行，同步，异步概念解析"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/399bf08.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>线程，进程，协程， 并发，并行，同步，异步概念解析</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>我相信线程，进程，协程， 并发，并行，同步，异步这几个概念大家在编程过程中肯定会遇到，但是偏偏这几个概念又那么类似，很容易让人模糊，今天我就用这一篇文章来和大家梳理一下这几个概念。</p><h2 class=pgc-h-arrow-right>1. 同步与异步</h2><ul><li>当我们 <strong>同步</strong> 的执行某个任务时，我们需要等到这个任务执行完给我们反馈结果，我们才能去执行其他的任务。</li><li>但是 <strong>异步</strong> 的执行某个任务时，我们可以不用等这个任务结束就去执行另一项任务。就像常用到的异步刷新操作。通过异步执行的任务执行结束后我们可以通过 <strong>回调函数</strong> 获得结果。</li></ul><p>我们可以明显的看出同步和异步的差别，那异步操作那么好为什么不都使用异步操作呢？同步操作存在的意义是有些任务必须是 <strong>按顺序执行</strong> 的，就像我们去银行取钱，最起码的保证你的银行账户里有钱你才能取，要不然岂不是去抢银行了:full_moon_with_face:。</p><h2 class=pgc-h-arrow-right>2. 并发与并行</h2><h2 class=pgc-h-arrow-right>2.1 并发 Concurrency</h2><p>咱们用做早饭来举例，例如说你还没起床，你的女朋友已经早早的起来了，在厨房给你准备早饭，她想给你做一份面包片和煎蛋，她为了能让你尽快的吃上早饭，开了两个锅，一个锅用来煎蛋，一个锅用来煎面包片，但是她为了食物尽可能美味，只能看一下煎蛋的锅，在去看一下烤面包片，这样 <strong>每个锅看一分钟，来回切换</strong> ，这样终于把面包片和煎蛋做好了，这时你也睡醒了，吃到了美味的早餐。</p><p>你女朋友的这个做早饭的流程就是并发操作，因为她不可能同时将注意力放在两个锅上，只能通过逐渐切换注意力的方式来使任务很好的完成。但是如果你的女朋友可以在两个锅之间切换的足够快:joy:，在旁边看起来就像是她在同时操作两个锅 。</p><h2 class=pgc-h-arrow-right>2.2 并行 Parallelism</h2><p>咱们还是用做早餐为例，现在你和你的女朋友在一起已经很久了，她再也受不了天天早上给你做饭的日子了，所以今天早上她把你也拽起来和她一起做饭。同样还是煎面包片和煎蛋，这时你和你女朋友一份一个锅，你在准备煎蛋，你的女朋友在煎面包片，你俩就这样很和谐的做着自己的事互不干扰，很快就吃到了美味的早餐。</p><p>你和你的女朋友同时做饭，每个人操作一个锅的方式就是并行操作。</p><h4 class=pgc-h-arrow-right>ps:突然将你想到了，原来自己没有女朋友 。</h4><h2 class=pgc-h-arrow-right>2.3 图解并发与并行</h2><p>假设我们有两个任务A和B，我们使用并发执行是这样的。</p><div class=pgc-img><img alt="线程，进程，协程， 并发，并行，同步，异步概念解析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/41ca5e6e9b914e628478b8262ae96e43><p class=pgc-img-caption></p></div><p>可以看到虽然A和B作为两个整体的任务但是未必会直接执行完，而是会在两个任务间来回切换。因为cpu切换的速度实在太快了，所以我们看起来好像是A和B在同时执行，但其实在每个时间点上只有一个任务在执行。</p><p>我们再来看一下并行的方式。</p><div class=pgc-img><img alt="线程，进程，协程， 并发，并行，同步，异步概念解析" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/560940e5ee2a4189aefed8ab30a9783c><p class=pgc-img-caption></p></div><p>并行操作是指两个任务同时执行的。</p><h2 class=pgc-h-arrow-right>3. 进程，线程与协程</h2><h2 class=pgc-h-arrow-right>3.1 进程 Process</h2><p>电脑中每个软件的启动就代表一个进程，就是把写的程序加载到操作系统中来执行预定好的任务。操作系统会为进程分配相应的资源来支撑它完成任务，每个进程会分配一个唯一的PID。</p><div class=pgc-img><img alt="线程，进程，协程， 并发，并行，同步，异步概念解析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6ae9160393d7469c9012ee35746d0508><p class=pgc-img-caption></p></div><p>我们这次用老王来举例，假如说老王现在想盖个房子，我们就可以把盖房子这件事作为一个任务，而老王就是负责这个任务的进程。</p><h2 class=pgc-h-arrow-right>3.2 线程 Thread</h2><p>线程是进程的执行实例，是一个程序执行的最小单元，每个进程里的任务会有线程去具体执行。</p><div class=pgc-img><img alt="线程，进程，协程， 并发，并行，同步，异步概念解析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/35af01d88bad4e8d9cb44f87033f1f03><p class=pgc-img-caption></p></div><p>我们还是继续说老王，现在盖房子这个任务已经确定下来了，但是他发现自己不会盖，要请个工人来盖房子，于是他去外面请了一个工人A，这个工人A要做搬砖和搬木头的工作，此时这个工人A就是一个 <strong>进程</strong> ，老王还要求他这两个任务不能差距太大，要同步进行，所以这个工人A只能搬一趟转头，搬一趟木头，这样的操作就是 <strong>单线程的并发操作</strong></p><p>。</p><p>干了两天，工人A不高兴了干的活太多了要加钱，这时老王一看一个人干也确实慢，就去外面又请了一个工人B，此时工人B也就对应着一个 <strong>线程</strong> ，老王让工人A继续搬砖，而工人B来负责搬木头，这样两个任务就能同时进行了，这就是 <strong>多线程的并行操作</strong> 。而且此时工人A和工人B是同时 <strong>共享着老王提供的资源</strong> 。</p><h2 class=pgc-h-arrow-right>3.3 进程与线程+单核与多核</h2><p>其实刚才老王那个例子已经能解释进程与线程的操作了，但是有些不太谨慎。</p><ul><li>如果我们使用的是 <strong>单核CPU</strong> ，那么我们是无法执行并行操作的，只能做到并发，这样来充分调用CPU的资源。</li><li>如果我们使用的是 <strong>多核CPU</strong> ，我们才可以真正的意义上做到并行操作。</li></ul><p>我们的操作系统在进程或线程间切换是比较消耗资源的，因为要保存当前运行状态的上下文信息，而且进程或线程的切换是由操作系统决定的，到达运行时间之后，操作系统会将当前执行的任务挂起，我们只能等待下个分配到的时间片来继续执行任务。这也就引出来协程的概念。</p><h2 class=pgc-h-arrow-right>3.4 协程 Coroutine</h2><p>就像我们刚才说到的，任务的切换是操作系统来控制，我们有没有什么办法来减小这种开销呢？我们就可以使用协程， <strong>协程我们可以理解为轻量级的线程</strong> 。 协程在执行过程中不会由操作系统直接操作，而是由编译器决定，比如协程A说我当前的任务还得一段时间执行完，我可以让出当前占用的资源了，协程A就会通知调度器，由调度器来分配下一个协程执行。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'线程','进程','协程'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>