<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ | æå®¢å¿«è¨Š</title><meta property="og:title" content="èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/b4554f16bed74f61ad7cc35a9bd92154"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ab05587.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ab05587.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3ab05587.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ab05587.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ab05587.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3ab05587.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3ab05587.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ab05587.html><meta property="article:published_time" content="2020-11-14T21:01:36+08:00"><meta property="article:modified_time" content="2020-11-14T21:01:36+08:00"><meta name=Keywords content><meta name=description content="èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/3ab05587.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b4554f16bed74f61ad7cc35a9bd92154><p class=pgc-img-caption></p></div><p class=ql-align-justify>ä½œè€…ï¼šVictor Zhou</p><p class=ql-align-justify>ç¿»è¯‘ï¼šç‹é›¨æ¡</p><p class=ql-align-justify>æ ¡å¯¹ï¼šå´é‡‘è¿ª</p><p class=ql-align-justify>æœ¬æ–‡çº¦<strong>3800å­—</strong>ï¼Œå»ºè®®é˜…è¯»15åˆ†é’Ÿã€‚</p><p class=ql-align-justify>æœ¬æ–‡å°†ä»‹ç»æœ€åŸºç¡€çš„å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆVanilla RNNsï¼‰çš„æ¦‚å†µï¼Œå·¥ä½œåŸç†ï¼Œä»¥åŠå¦‚ä½•åœ¨Pythonä¸­å®ç°ã€‚</p><p class=ql-align-justify>å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰æ˜¯ä¸€ç§ä¸“é—¨å¤„ç†åºåˆ—çš„ç¥ç»ç½‘ç»œã€‚ç”±äºåœ¨å¤„ç†æ–‡æœ¬æ—¶ååˆ†é«˜æ•ˆï¼Œå®ƒç»å¸¸ç”¨äºè‡ªç„¶è¯­è¨€å¤„ç†(NLP)ã€‚åœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨RNNæ˜¯ä»€ä¹ˆï¼Œäº†è§£å®ƒçš„å·¥ä½œåŸç†ï¼Œå¹¶ä½¿ç”¨Pythonä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªçœŸæ­£çš„RNNï¼ˆä»…ä½¿ç”¨numpyï¼‰ã€‚</p><p class=ql-align-justify>åœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»‹ç»äº†ä¸€äº›ç¥ç»ç½‘ç»œçš„åŸºæœ¬çŸ¥è¯†ã€‚æœ¬æ–‡å¯¹åŸºç¡€éƒ¨åˆ†ä¸åšè¿‡å¤šä»‹ç»ï¼Œå¦‚æœ‰éœ€è¦ï¼Œå»ºè®®å…ˆé˜…è¯»åŸºç¡€æ–‡ç« ã€‚</p><p class=ql-align-justify>é™„é“¾æ¥ï¼š</p><p class=ql-align-justify>https://victorzhou.com/blog/intro-to-neural-networks/</p><p class=ql-align-justify>è®©æˆ‘ä»¬å¼€å§‹å§ï¼</p><p class=ql-align-justify><strong>1. ä¸ºä»€ä¹ˆè¦ç”¨RNNs?</strong></p><p class=ql-align-justify>å…³äºåŸå§‹çš„ç¥ç»ç½‘ç»œï¼ˆåŒæ ·å¯¹äºCNNsï¼‰çš„ä¸€ä¸ªé—®é¢˜æ˜¯å®ƒä»¬åªèƒ½ä½¿ç”¨é¢„å®šå¤§å°çš„è¾“å…¥å’Œè¾“å‡ºï¼šå®ƒä»¬é‡‡ç”¨å›ºå®šå¤§å°çš„è¾“å…¥å¹¶ç”Ÿæˆå›ºå®šå¤§å°çš„è¾“å‡ºã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒRNNså¯ä»¥å°†å¯å˜é•¿åº¦åºåˆ—ä½œä¸ºè¾“å…¥å’Œè¾“å‡ºã€‚ä»¥ä¸‹æ˜¯RNNçš„ç¤ºä¾‹ï¼š</p><p class=ql-align-justify></p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/39008dd8c44a4284bf0ee932ae7630c1><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-center>çº¢è‰²ä¸ºè¾“å…¥ï¼Œç»¿è‰²ä¸ºRNNæœ¬èº«ï¼Œè“è‰²ä¸ºè¾“å‡ºã€‚æ¥æºï¼šAndrej Karpathy</p><p class=ql-align-justify>è¿™ç§å¤„ç†åºåˆ—çš„èƒ½åŠ›ä½¿RNNè¡¨ç°ä¼˜å¼‚ã€‚ä¾‹å¦‚ï¼š</p><ul><li class=ql-align-justify>æœºå™¨ç¿»è¯‘ï¼ˆä¾‹å¦‚Googleç¿»è¯‘ï¼‰ä½¿ç”¨â€œå¤šå¯¹å¤šâ€RNNã€‚åŸå§‹æ–‡æœ¬åºåˆ—è¢«é€å…¥RNNï¼ŒéšåRNNå°†ç¿»è¯‘çš„æ–‡æœ¬ä½œä¸ºè¾“å‡ºã€‚</li><li class=ql-align-justify>æƒ…æ„Ÿåˆ†æï¼ˆä¾‹å¦‚ï¼Œè¿™æ˜¯ä¸€ä¸ªç§¯æçš„è¿˜æ˜¯è´Ÿé¢çš„è¯„è®ºï¼Ÿï¼‰é€šå¸¸æ˜¯ä½¿ç”¨â€œå¤šå¯¹ä¸€â€RNNã€‚å°†è¦åˆ†æçš„æ–‡æœ¬é€å…¥RNNï¼Œç„¶åRNNäº§ç”Ÿå•ä¸ªè¾“å‡ºåˆ†ç±»ï¼ˆä¾‹å¦‚ï¼Œè¿™æ˜¯ä¸€ä¸ªç§¯æçš„è¯„è®ºï¼‰ã€‚</li></ul><p class=ql-align-justify>åœ¨æœ¬æ–‡åé¢ï¼Œæˆ‘ä»¬å°†ä»é›¶å¼€å§‹æ„å»ºâ€œå¤šå¯¹ä¸€â€RNNï¼Œå¹¶å®ŒæˆåŸºæœ¬çš„æƒ…æ„Ÿåˆ†æã€‚</p><p class=ql-align-justify><strong>2. å¦‚ä½•ä½¿ç”¨RNNs</strong></p><p class=ql-align-justify>è®©æˆ‘ä»¬æ¥çœ‹çœ‹â€œå¤šå¯¹å¤šâ€RNNå§ï¼</p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5d012a4a16164ce49e1e3f73fc91f195><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5a95e60f52204c29bd048e09bd58e23a><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><ol><li class=ql-align-justify>åŸºäºä¹‹å‰çš„éšè—çŠ¶æ€å’Œä¸‹ä¸€ä¸ªè¾“å…¥ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸‹ä¸€ä¸ªéšè—çŠ¶æ€ã€‚</li><li class=ql-align-justify>é€šè¿‡è®¡ç®—, æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸‹ä¸€ä¸ªè¾“å‡º ã€‚</li></ol><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/726a90ff59bd4714810755a61d671341><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-center>å¤šå¯¹å¤š RNN</p><p class=ql-align-justify>è¿™å°±æ˜¯ä½¿RNNå¾ªç¯çš„è¿‡ç¨‹ï¼šæ¯ä¸€æ­¥éƒ½ä¼šä½¿ç”¨ç›¸åŒçš„æƒé‡ã€‚ æ›´å…·ä½“åœ°è¯´ï¼Œå…¸å‹çš„åŸå§‹RNNä»…ä½¿ç”¨3ç»„æƒé‡å°±èƒ½å®Œæˆè®¡ç®—ï¼š</p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c0c735105cf84822a817035c0bff279e><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify>æ­¤å¤–ï¼Œ æˆ‘ä»¬è¿˜è¦åœ¨RNNä¸­å¼•å…¥ä¸¤ä¸ªåç§»é‡ï¼š</p><p class=ql-align-justify>æˆ‘ä»¬ç”¨çŸ©é˜µè¡¨ç¤ºæƒé‡ï¼Œç”¨å‘é‡è¡¨ç¤ºåå·®ã€‚è¿™3ä¸ªæƒé‡å’Œ2ä¸ªåå·®å°±æ„æˆäº†æ•´ä¸ªRNNï¼</p><p class=ql-align-justify>ä»¥ä¸‹æ˜¯å°†æ‰€æœ‰å†…å®¹ç»„åˆåœ¨ä¸€èµ·çš„å…¬å¼ï¼š</p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2ff73edfcaca4a359c0267ca8231ffab><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>ä¸è¦ç•¥è¿‡è¿™äº›æ–¹ç¨‹å¼ã€‚ åœä¸‹æ¥ä¸€åˆ†é’Ÿçœ‹çœ‹å®ƒã€‚ å¦å¤–ï¼Œè¦æ—¶åˆ»ç‰¢è®°æƒé‡æ˜¯çŸ©é˜µï¼Œå…¶ä»–å˜é‡æ˜¯å‘é‡ã€‚</p><p class=ql-align-justify>æˆ‘ä»¬åœ¨çŸ©é˜µä¹˜æ³•ä¸­åº”ç”¨æ‰€æœ‰çš„æƒé‡ï¼Œå¹¶å°†åå·®æ·»åŠ åˆ°æ‰€å¾—ç»“æœä¸­ã€‚ç„¶åæˆ‘ä»¬å°†tanhä½œä¸ºç¬¬ä¸€ä¸ªç­‰å¼çš„æ¿€æ´»å‡½æ•°ï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ¿€æ´»ï¼Œå¦‚sigmoidï¼‰ã€‚</p><p class=ql-align-justify><strong>3. é—®é¢˜</strong></p><p class=ql-align-justify>æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä»é›¶å¼€å§‹åº”ç”¨RNNæ¥æ‰§è¡Œç®€å•çš„æƒ…æ„Ÿåˆ†æä»»åŠ¡ï¼šç¡®å®šç»™å®šçš„æ–‡æœ¬çš„æƒ…æ„Ÿæ˜¯æ­£å‘çš„è¿˜æ˜¯è´Ÿå‘çš„ã€‚</p><p class=ql-align-justify>ä»¥ä¸‹æ˜¯æˆ‘ä¸ºæœ¬æ–‡æ•´ç†çš„æ•°æ®é›†ä¸­çš„ä¸€äº›ç¤ºä¾‹ï¼š</p><p class=ql-align-justify>é™„æ•°æ®é›†é“¾æ¥ï¼š</p><p class=ql-align-justify>https://github.com/vzhou842/rnn-from-scratch/blob/master/data.py</p><p class=ql-align-justify></p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/598b612ed3fb434eaf198dd9e7c1d94b><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify><strong>4. è®¡åˆ’</strong></p><p class=ql-align-justify>ç”±äºè¿™æ˜¯ä¸€ä¸ªåˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨â€œå¤šå¯¹ä¸€â€RNNã€‚è¿™å’Œæˆ‘ä»¬ä¹‹å‰è®¨è®ºè¿‡çš„â€œå¤šå¯¹å¤šâ€RNNç±»ä¼¼ï¼Œä½†ä¸åŒçš„æ˜¯å®ƒåªä½¿ç”¨æœ€ç»ˆéšè—çŠ¶æ€è¾“å‡ºä¸€ä¸ªyï¼š</p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d4b8424e273348c88360d90142a476d6><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-center>å¤šå¯¹ä¸€ RNN</p><p class=ql-align-justify>æ¯ä¸ªéƒ½æ˜¯ä¸€ä¸ªè¡¨ç¤ºæ–‡æœ¬ä¸­å•è¯çš„å‘é‡ã€‚è¾“å‡ºçš„yå‘é‡å°†åŒ…å«ä¸¤ä¸ªæ•°å­—ï¼Œä¸€ä¸ªè¡¨ç¤ºç§¯ææ€åº¦ï¼Œå¦ä¸€ä¸ªè¡¨ç¤ºæ¶ˆææ€åº¦ã€‚æˆ‘ä»¬å°†åº”ç”¨Softmaxå°†è¿™äº›å€¼è½¬æ¢ä¸ºæ¦‚ç‡ï¼Œå¹¶æœ€ç»ˆåœ¨ç§¯æ/æ¶ˆæä¹‹é—´åšå‡ºå†³å®šã€‚</p><p class=ql-align-justify>è®©æˆ‘ä»¬å¼€å§‹å®ç°RNNå§ï¼</p><p class=ql-align-justify><strong>5. é¢„å¤„ç†</strong></p><p class=ql-align-justify>å‰æ–‡æåˆ°çš„æ•°æ®é›†ç”±ä¸¤éƒ¨åˆ†ç»„æˆã€‚</p><pre class=ql-align-justify>data.pytrain_data = { 'good': True, 'bad': False, # ... more data} test_data = { 'this is happy': True, 'i am good': True, # ... more data}True=ç§¯æï¼ŒFalse=æ¶ˆæ</pre><p class=ql-align-justify>æˆ‘ä»¬å¿…é¡»è¿›è¡Œä¸€äº›é¢„å¤„ç†æ‰èƒ½å°†æ•°æ®è½¬æ¢ä¸ºå¯ç”¨çš„æ ¼å¼ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æ„å»ºè¯æ±‡è¡¨ï¼Œç”¨æ¥å­˜æ”¾æ•°æ®ä¸­å‡ºç°çš„è¯æ±‡ï¼š</p><pre class=ql-align-justify>main.pyfrom data import train_data, test_data # Create the vocabulary.vocab = list(set([w for text in train_data.keys() for w in text.split(' ')]))vocab_size = len(vocab)print('%d unique words found' % vocab_size) # 18 unique words found</pre><p class=ql-align-justify>ç°åœ¨ï¼Œvocabè¿™ä¸ªåˆ—è¡¨ä¸­åŒ…å«äº†æ‰€æœ‰çš„å•è¯ï¼Œè¿™é‡Œæ˜¯æŒ‡è‡³å°‘åœ¨ä¸€ä¸ªè®­ç»ƒæ ·æœ¬ä¸­å‡ºç°çš„å•è¯ã€‚æ¥ä¸‹æ¥ï¼Œä¸ºäº†è¡¨ç¤ºè¯æ±‡è¡¨ä¸­çš„æ¯ä¸ªå•è¯ï¼Œæˆ‘ä»¬å°†è®¾å®šä¸€ä¸ªæ•´æ•°ç´¢å¼•ã€‚</p><pre class=ql-align-justify>main.py# Assign indices to each word.word_to_idx = { w: i for i, w in enumerate(vocab) }idx_to_word = { i: w for i, w in enumerate(vocab) }print(word_to_idx['good']) # 16 (this may change)print(idx_to_word[0]) # sad (this may change)</pre><p class=ql-align-justify>æˆ‘ä»¬ç°åœ¨å¯ä»¥ç”¨ç›¸åº”çš„æ•´æ•°ç´¢å¼•è¡¨ç¤ºä»»ä½•ç»™å®šçš„å•è¯ï¼è¿™æ˜¯å¿…è¦çš„æ­¥éª¤ï¼Œå› ä¸ºRNNæ— æ³•ç†è§£å•è¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»ç»™å®ƒè¾“å…¥æ•°å­—ã€‚</p><p class=ql-align-justify>æœ€åï¼Œå›æƒ³ä¸€ä¸‹RNNçš„æ¯ä¸ªè¾“å…¥æ˜¯ä¸€ä¸ªå‘é‡ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ç‹¬çƒ­ç¼–ç ï¼Œå…¶ä¸­åŒ…å«é™¤äº†å•ä¸ªä¸€ä¹‹å¤–çš„æ‰€æœ‰é›¶ã€‚æ¯ä¸ªç‹¬çƒ­å‘é‡ä¸­çš„â€œ1â€å°†ä½æ–¼å•è¯çš„ç›¸åº”æ•´æ•°ç´¢å¼•å¤„ã€‚</p><p class=ql-align-justify>ç”±äºæˆ‘ä»¬çš„è¯æ±‡è¡¨ä¸­æœ‰18ä¸ªå”¯ä¸€çš„å•è¯ï¼Œæ¯ä¸ªå°†æ˜¯ä¸€ä¸ª18ç»´çš„å•çƒ­çŸ¢é‡ã€‚</p><pre class=ql-align-justify>main.pyimport numpy as np def createInputs(text): ''' Returns an array of one-hot vectors representing the words in the input text string. - text is a string - Each one-hot vector has shape (vocab_size, 1) ''' inputs = [] for w in text.split(' '): v = np.zeros((vocab_size, 1)) v[word_to_idx[w]] = 1 inputs.append(v) return inputs</pre><p class=ql-align-justify>éšåï¼Œæˆ‘ä»¬å°†ç”¨createInputsï¼ˆï¼‰æ¥ç”Ÿæˆè¾“å…¥å‘é‡ï¼Œå¹¶ä¼ å…¥åˆ°RNNä¸­ã€‚</p><p class=ql-align-justify><strong>6. å‘å‰ä¼ æ’­é˜¶æ®µ</strong></p><p class=ql-align-justify>æ˜¯æ—¶å€™å¼€å§‹å®ç°æˆ‘ä»¬çš„RNNäº†ï¼æˆ‘ä»¬é¦–å…ˆå°†åˆå§‹åŒ–RNNéœ€è¦çš„3ä¸ªæƒé‡å’Œ2ä¸ªåç§»é‡ï¼š</p><pre class=ql-align-justify>rnn.pyimport numpy as npfrom numpy.random import randn class RNN: # A Vanilla Recurrent Neural Network.  def __init__(self, input_size, output_size, hidden_size=64): # Weights self.Whh = randn(hidden_size, hidden_size) / 1000 self.Wxh = randn(hidden_size, input_size) / 1000 self.Why = randn(output_size, hidden_size) / 1000  # Biases self.bh = np.zeros((hidden_size, 1)) self.by = np.zeros((output_size, 1))</pre><p class=ql-align-justify>æ³¨æ„ï¼šæˆ‘ä»¬é™¤ä»¥1000ä»¥å‡å°‘æƒé‡çš„åˆå§‹æ–¹å·®ã€‚å°½ç®¡è¿™ä¸æ˜¯åˆå§‹åŒ–æƒé‡çš„æœ€ä½³æ–¹æ³•ï¼Œä½†å®ƒå¾ˆç›´è§‚ï¼Œé€‚ç”¨äºè¿™ç¯‡æ–‡ç« ã€‚</p><p class=ql-align-justify>æˆ‘ä»¬ä½¿ç”¨np.random.randnï¼ˆï¼‰ï¼ŒåŸºäºæ ‡å‡†æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–æƒé‡ã€‚</p><p class=ql-align-justify>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å®ç°RNNå‰å‘ä¼ æ’­ã€‚ è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„è¿™ä¸¤ä¸ªæ–¹ç¨‹å—?</p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9673d7c35e234318ad42304ae8c9683e><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>ä»¥ä¸‹æ˜¯åœ¨ä»£ç ä¸­çš„å®ç°ï¼š</p><pre class=ql-align-justify>rnn.pyclass RNN: # ...  def forward(self, inputs): ''' Perform a forward pass of the RNN using the given inputs. Returns the final output and hidden state. - inputs is an array of one hot vectors with shape (input_size, 1). ''' h = np.zeros((self.Whh.shape[0], 1))  # Perform each step of the RNN for i, x in enumerate(inputs): h = np.tanh(self.Wxh @ x + self.Whh @ h + self.bh)  # Compute the output y = self.Why @ h + self.by  return y, h</pre><p class=ql-align-justify></p><p class=ql-align-justify>è¿™å¾ˆç®€å•å§ï¼Ÿ è¯·æ³¨æ„ï¼Œå› ä¸ºæ²¡æœ‰ä¹‹å‰çš„hå¯ä»¥ä½¿ç”¨ï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€æ­¥ä¸­å°†håˆå§‹åŒ–ä¸ºé›¶å‘é‡ã€‚</p><p class=ql-align-justify>è®©æˆ‘ä»¬æ¥è¯•è¯•å§ï¼š</p><pre class=ql-align-justify>main.py# ... def softmax(xs): # Applies the Softmax Function to the input array. return np.exp(xs) / sum(np.exp(xs)) # Initialize our RNN!rnn = RNN(vocab_size, 2) inputs = createInputs('i am very good')out, h = rnn.forward(inputs)probs = softmax(out)print(probs) # [[0.50000095], [0.49999905]]</pre><p class=ql-align-justify>å¦‚æœéœ€è¦å¤ä¹ Softmaxç›¸å…³çŸ¥è¯†ï¼Œå¯ä»¥é€šè¿‡é“¾æ¥é˜…è¯»ç›¸å…³çš„å¿«é€Ÿè§£é‡Šã€‚</p><p class=ql-align-justify>é™„é“¾æ¥ï¼š</p><p class=ql-align-justify>https://victorzhou.com/blog/softmax/</p><p class=ql-align-justify>æˆ‘ä»¬çš„RNNå¯ä»¥æˆåŠŸè¿è¡Œï¼Œä½†å®ƒçœ‹èµ·æ¥ä¸æ˜¯å¾ˆæœ‰ç”¨ã€‚ çœ‹æ¥æˆ‘ä»¬å¾—ä½œå‡ºä¸€äº›æ”¹å˜......</p><p class=ql-align-justify><strong>7. åé¦ˆé˜¶æ®µ</strong></p><p class=ql-align-justify>ä¸ºäº†è®­ç»ƒRNNï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæŸå¤±å‡½æ•°ã€‚æˆ‘ä»¬å°†ä½¿ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œå®ƒé€šå¸¸ä¸Softmaxç»“åˆã€‚ è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c23f0bbb55a7402fa9b59e2b56c1d419><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a142d7dfe7eb4e77a350206c92e8b0a4><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/85903da4a2994065a288efda25173e86><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>ç°åœ¨æˆ‘ä»¬æœ‰äº†æŸå¤±å‡½æ•°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ¥è®­ç»ƒRNNæ¨¡å‹ï¼Œä»¥å°½é‡å‡å°‘æŸå¤±ã€‚ è¿™æ„å‘³ç€æˆ‘ä»¬ç°åœ¨è¦åšä¸€äº›æ¢¯åº¦ç›¸å…³çš„è®¡ç®—ï¼</p><p class=ql-align-justify>ä»¥ä¸‹éƒ¨åˆ†éœ€è¦ä¸€äº›å¤šå˜é‡å¾®ç§¯åˆ†çš„åŸºæœ¬çŸ¥è¯†ï¼Œä½ å¯ä»¥é€‰æ‹©è·³è¿‡è¿™éƒ¨åˆ†ã€‚å³ä½¿ä½ ä¸å¤ªäº†è§£ï¼Œæˆ‘ä¹Ÿå»ºè®®ä½ å¤§æ¦‚æµè§ˆä¸€ä¸‹ã€‚æ¨å¯¼å‡ºç»“æœåï¼Œæˆ‘ä»¬å°†é€æ­¥å®Œæˆä»£ç ï¼Œæµ…å±‚æ¬¡çš„ç†è§£ä¹Ÿä¼šæœ‰æ‰€å¸®åŠ©ã€‚</p><p class=ql-align-justify>å¦‚æœæƒ³è¦æ·±å…¥äº†è§£æœ¬èŠ‚ï¼Œå¯ä»¥é˜…è¯»æˆ‘åœ¨â€œç¥ç»ç½‘ç»œä»‹ç»â€ä¸€æ–‡ä¸­çš„â€œè®­ç»ƒç¥ç»ç½‘ç»œâ€éƒ¨åˆ†ã€‚ æ­¤å¤–ï¼Œæœ¬æ–‡çš„æ‰€æœ‰ä»£ç éƒ½åœ¨Githubä¸Šï¼Œä½ ä¹Ÿå¯ä»¥åœ¨Githubä¸Šå…³æ³¨æˆ‘ã€‚</p><p class=ql-align-justify>é™„Githubé“¾æ¥ï¼š</p><p class=ql-align-justify>https://github.com/vzhou842/rnn-from-scratch</p><p class=ql-align-justify><strong>7.1å®šä¹‰</strong></p><p class=ql-align-justify>é¦–å…ˆï¼Œæˆ‘ä»¬è¦æ˜ç¡®ä¸€äº›å®šä¹‰ï¼š</p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4dcf72c26932453fa4d8f8176a0bb807><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><strong>7.2 å‡†å¤‡</strong></p><p class=ql-align-justify>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ç¼–è¾‘å‘å‰ä¼ æ’­é˜¶æ®µå¹¶ç¼“å­˜ä¸€äº›æ•°æ®ï¼Œä»¥ä¾¿åœ¨åé¦ˆé˜¶æ®µä½¿ç”¨ã€‚åœ¨æˆ‘ä»¬å¤„ç†å®ƒçš„åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜å°†ä¸ºæˆ‘ä»¬çš„åé¦ˆé˜¶æ®µè®¾ç½®æ¡†æ¶ã€‚å¤§è‡´å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class=ql-align-justify>rnn.pyclass RNN: # ...  def forward(self, inputs): ''' Perform a forward pass of the RNN using the given inputs. Returns the final output and hidden state. - inputs is an array of one hot vectors with shape (input_size, 1). ''' h = np.zeros((self.Whh.shape[0], 1))  self.last_inputs = inputs self.last_hs = { 0: h } # Perform each step of the RNN for i, x in enumerate(inputs): h = np.tanh(self.Wxh @ x + self.Whh @ h + self.bh) self.last_hs[i + 1] = h # Compute the output y = self.Why @ h + self.by  return y, h  def backprop(self, d_y, learn_rate=2e-2):''' Perform a backward pass of the RNN. - d_y (dL/dy) has shape (output_size, 1). - learn_rate is a float. ''' pass</pre><p class=ql-align-justify><strong>7.3 æ¢¯åº¦</strong></p><p class=ql-align-justify>ç°åœ¨å¼€å§‹æ˜¯æ•°å­¦ç™»åœºçš„æ—¶å€™å•¦ï¼æˆ‘ä»¬è¦å¼€å§‹è®¡ç®—</p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e8656aa08fcf4ed3a785df089ce8d15f><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>é€šè¿‡é“¾å¼æ³•åˆ™è®¡ç®—çš„è¿‡ç¨‹å°±ä½œä¸ºç»ƒä¹ å§ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6610a11d321e46aea59280da55d1b866><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/64e6c5394ee1459c807d7327b40260f6><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><pre class=ql-align-justify>main.py# Loop over each training examplefor x, y in train_data.items(): inputs = createInputs(x) target = int(y)  # Forward out, _ = rnn.forward(inputs) probs = softmax(out)  # Build dL/dy d_L_d_y = probs d_L_d_y[target] -= 1 # Backward rnn.backprop(d_L_d_y)</pre><p class=ql-align-justify>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å®Œæˆå’Œçš„æ¢¯åº¦è®¡ç®—ï¼Œè¿™ä»…ç”¨äºå°†æœ€ç»ˆéšè—çŠ¶æ€è½¬æ¢ä¸ºRNNçš„è¾“å‡ºã€‚ æˆ‘ä»¬æœ‰ï¼š</p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c4630bfcedea4ea5b98ed3a0adcd367e><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>æ˜¯æœ€ç»ˆçš„éšè—çŠ¶æ€ã€‚å› æ­¤ï¼Œ</p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/258eb18514514300b33fb40039dedda3><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify>åŒæ ·çš„ï¼Œ</p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/158b93f866f743dfab89d5c77d33f5e6><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>æˆ‘ä»¬ç°åœ¨å¯ä»¥å¼€å§‹åº”ç”¨backpropï¼ˆï¼‰ï¼</p><pre class=ql-align-justify>rnn.pyclass RNN: # ...  def backprop(self, d_y, learn_rate=2e-2): ''' Perform a backward pass of the RNN. - d_y (dL/dy) has shape (output_size, 1). - learn_rate is a float. ''' n = len(self.last_inputs)  # Calculate dL/dWhy and dL/dby.d_Why = d_y @ self.last_hs[n].T d_by = d_y</pre><p class=ql-align-justify>æç¤ºï¼šæˆ‘ä»¬ä¹‹å‰åœ¨forwardï¼ˆï¼‰ä¸­åˆ›å»ºäº†self.last_hsã€‚</p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c81850133da148aaab981c92a9f03c31><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/afb8337efc014c368d19ab6ee83e72bd><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>å› ä¸ºæ”¹å˜å°†å½±å“æ¯ä¸€ä¸ªï¼Œè¿™ä¸€åˆ‡éƒ½ä¼šå½±å“yå’Œæœ€ç»ˆLã€‚ä¸ºäº†è®¡ç®—çš„æ¢¯åº¦, æˆ‘ä»¬éœ€è¦æ‰€æœ‰æ—¶é—´æ­¥é•¿çš„åå‘ä¼ æ’­ï¼Œè¿™ç§°ä¸ºåå‘ä¼ æ’­æ—¶é—´ï¼ˆBPTTï¼‰ï¼š</p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a113ecd4ea9e42e5913993d09a41539e><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/aa759978510e4839ab7f608178c12669><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><pre class=ql-align-justify>rnn.pyclass RNN: # â€¦  def backprop(self, d_y, learn_rate=2e-2):â€˜â€™â€™Perform a backward pass of the RNN.- d_y (dL/dy) has shape (output_size, 1).- learn_rate is a float.â€˜â€™â€™n = len(self.last_inputs) # Calculate dL/dWhy and dL/dby.D_Why = d_y @ self.last_hs[n].Td_by = d_y # Initialize dL/dWhh, dL/dWxh, and dL/dbh to zero.D_Whh = np.zeros(self.Whh.shape)d_Wxh = np.zeros(self.Wxh.shape)d_bh = np.zeros(self.bh.shape) # Calculate dL/dh for the last h.d_h = self.Why.T @ d_y # Backpropagate through time.For t in reversed(range(n)): # An intermediate value: dL/dh * (1 â€“ h^2) temp = ((1 â€“ self.last_hs[t + 1] ** 2) * d_h)  # dL/db = dL/dh * (1 â€“ h^2) d_bh += temp # dL/dWhh = dL/dh * (1 â€“ h^2) * h_{t-1} d_Whh += temp @ self.last_hs[t].T # dL/dWxh = dL/dh * (1 â€“ h^2) * x d_Wxh += temp @ self.last_inputs[t].T # Next dL/dh = dL/dh * (1 â€“ h^2) * Whh d_h = self.Whh @ temp # Clip to prevent exploding gradients.For d in [d_Wxh, d_Whh, d_Why, d_bh, d_by]: np.clip(d, -1, 1, out=d) # Update weights and biases using gradient descent.Self.Whh -= learn_rate * d_Whhself.Wxh -= learn_rate * d_Wxhself.Why -= learn_rate * d_Whyself.bh -= learn_rate * d_bhself.by -= learn_rate * d_by</pre><p class=ql-align-justify>è¡¥å……ä¸€äº›æ³¨æ„äº‹é¡¹ï¼š</p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4919e750049140fd83b3b807bcbbe5ab><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>å¥½å•¦ï¼æˆ‘ä»¬çš„RNNå·²ç»å®Œæˆå•¦ã€‚</p><p class=ql-align-justify><strong>8. é«˜æ½®</strong></p><p class=ql-align-justify>ç»ˆäºç­‰åˆ°äº†è¿™ä¸€åˆ» - è®©æˆ‘ä»¬æµ‹è¯•RNNå§ï¼</p><p class=ql-align-justify>é¦–å…ˆï¼Œæˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªå¸®åŠ©å‡½æ•°æ¥å¤„ç†RNNçš„æ•°æ®ï¼š</p><pre class=ql-align-justify>main.pyimport random def processData(data, backprop=True): ''' Returns the RNN's loss and accuracy for the given data. - data is a dictionary mapping text to True or False. - backprop determines if the backward phase should be run. ''' items = list(data.items()) random.shuffle(items)  loss = 0 num_correct = 0  for x, y in items: inputs = createInputs(x) target = int(y)  # Forward out, _ = rnn.forward(inputs) probs = softmax(out)  # Calculate loss / accuracy loss -= np.log(probs[target]) num_correct += int(np.argmax(probs) == target)  if backprop: # Build dL/dy d_L_d_y = probs d_L_d_y[target] -= 1  # Backward rnn.backprop(d_L_d_y)  return loss / len(data), num_correct / len(data)ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å®Œæˆä¸€ä¸ªè®­ç»ƒçš„å¾ªç¯ï¼šmain.py# Training loopfor epoch in range(1000): train_loss, train_acc = processData(train_data)  if epoch % 100 == 99: print('--- Epoch %d' % (epoch + 1)) print('Train:\tLoss %.3f | Accuracy: %.3f' % (train_loss, train_acc))  test_loss, test_acc = processData(test_data, backprop=False) print('Test:\tLoss %.3f | Accuracy: %.3f' % (test_loss, test_acc))</pre><p class=ql-align-justify>è¿è¡Œ main.pyåº”è¯¥ä¼šå¾—åˆ°å¦‚ä¸‹è¾“å‡ºï¼š</p><pre class=ql-align-justify>--- Epoch 100Train: Loss 0.688 | Accuracy: 0.517Test: Loss 0.700 | Accuracy: 0.500--- Epoch 200Train: Loss 0.680 | Accuracy: 0.552Test: Loss 0.717 | Accuracy: 0.450--- Epoch 300Train: Loss 0.593 | Accuracy: 0.655Test: Loss 0.657 | Accuracy: 0.650--- Epoch 400Train: Loss 0.401 | Accuracy: 0.810Test: Loss 0.689 | Accuracy: 0.650--- Epoch 500Train: Loss 0.312 | Accuracy: 0.862Test: Loss 0.693 | Accuracy: 0.550--- Epoch 600Train: Loss 0.148 | Accuracy: 0.914Test: Loss 0.404 | Accuracy: 0.800--- Epoch 700Train: Loss 0.008 | Accuracy: 1.000Test: Loss 0.016 | Accuracy: 1.000--- Epoch 800Train: Loss 0.004 | Accuracy: 1.000Test: Loss 0.007 | Accuracy: 1.000--- Epoch 900Train: Loss 0.002 | Accuracy: 1.000Test: Loss 0.004 | Accuracy: 1.000--- Epoch 1000Train: Loss 0.002 | Accuracy: 1.000Test: Loss 0.003 | Accuracy: 1.000</pre><p class=ql-align-justify>æˆ‘ä»¬è‡ªå·±åˆ¶é€ çš„RNNä¹Ÿä¸é”™ã€‚</p><p class=ql-align-justify>æƒ³äº²è‡ªå°è¯•æˆ–ä¿®è¡¥è¿™äº›ä»£ç ï¼Ÿä½ ä¹Ÿå¯ä»¥åœ¨Githubä¸Šæ‰¾åˆ°ã€‚</p><p class=ql-align-justify>é™„é“¾æ¥ï¼š</p><p class=ql-align-justify>https://github.com/vzhou842/rnn-from-scratch</p><p class=ql-align-justify><strong>9. æ€»ç»“</strong></p><p class=ql-align-justify>æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å®Œæˆäº†å›å½’ç¥ç»ç½‘ç»œçš„æ¼”ç»ƒï¼ŒåŒ…æ‹¬å®ƒä»¬æ˜¯ä»€ä¹ˆï¼Œå®ƒä»¬å¦‚ä½•å·¥ä½œï¼Œä¸ºä»€ä¹ˆå®ƒä»¬æœ‰ç”¨ï¼Œå¦‚ä½•è®­ç»ƒå®ƒä»¬ä»¥åŠå¦‚ä½•å®ç°å®ƒä»¬ã€‚ä¸è¿‡ï¼Œä½ è¿˜å¯ä»¥åšæ›´å¤šçš„äº‹æƒ…ï¼š</p><ul><li class=ql-align-justify>äº†è§£é•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼ˆLSTMï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªæ›´å¼ºå¤§å’Œæ›´å—æ¬¢è¿çš„RNNæ¶æ„ï¼Œæˆ–å…³äºLSTMçš„è‘—åçš„å˜ä½“--é—¨æ§å¾ªç¯å•å…ƒï¼ˆGRUï¼‰ã€‚</li><li class=ql-align-justify>é€šè¿‡æ°å½“çš„MLåº“ï¼ˆå¦‚Tensorflowï¼ŒKerasæˆ–PyTorchï¼‰ï¼Œä½ å¯ä»¥å°è¯•æ›´å¤§/æ›´å¥½çš„RNNã€‚</li><li class=ql-align-justify>äº†è§£åŒå‘RNNï¼Œå®ƒå¯ä»¥å¤„ç†å‰å‘å’Œåå‘åºåˆ—ï¼Œå› æ­¤è¾“å‡ºå±‚å¯ä»¥è·å¾—æ›´å¤šä¿¡æ¯ã€‚</li><li class=ql-align-justify>å°è¯•åƒGloVeæˆ–Word2Vecè¿™æ ·çš„WordåµŒå…¥ï¼Œå¯ç”¨äºå°†å•è¯è½¬æ¢ä¸ºæ›´æœ‰ç”¨çš„çŸ¢é‡è¡¨ç¤ºã€‚</li><li class=ql-align-justify>æŸ¥çœ‹è‡ªç„¶è¯­è¨€å·¥å…·åŒ…ï¼ˆNLTKï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†äººç±»è¯­è¨€æ•°æ®çš„Pythonåº“</li></ul><p class=ql-align-justify><br></p><p class=ql-align-justify>åŸæ–‡æ ‡é¢˜ï¼š</p><p class=ql-align-justify>An Introduction to Recurrent Neural Networks for Beginners</p><p class=ql-align-justify>åŸæ–‡é“¾æ¥ï¼š</p><p class=ql-align-justify>https://victorzhou.com/blog/intro-to-rnns/</p><p class=ql-align-right>ç¼–è¾‘ï¼šäºè…¾å‡¯</p><p class=ql-align-right>æ ¡å¯¹ï¼šæ¨å­¦ä¿Š</p><p class=ql-align-justify><strong>è¯‘è€…ç®€ä»‹</strong></p><div class=pgc-img><img alt=èœé¸Ÿå¿…å¤‡çš„å¾ªç¯ç¥ç»ç½‘ç»œæŒ‡å—ï¼ˆé™„é“¾æ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/73b93b6bac1f4de6babdd47b1b33bf2f><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify><strong>ç‹é›¨æ¡</strong>ï¼ŒUIUCç»Ÿè®¡å­¦åœ¨è¯»ç¡•å£«ï¼Œæœ¬ç§‘ç»Ÿè®¡ä¸“ä¸šï¼Œç›®å‰ä¸“æ³¨äºCodingæŠ€èƒ½çš„æå‡ã€‚ç†è®ºåˆ°åº”ç”¨çš„è½¬æ¢ä¸­ï¼Œæ•¬ç•æ•°æ®ï¼ŒæŒç»­è¿›åŒ–ã€‚</p><p class=ql-align-center><strong>â€” å®Œ â€”</strong></p><p class=ql-align-justify>å…³æ³¨æ¸…å-é’å²›æ•°æ®ç§‘å­¦ç ”ç©¶é™¢å®˜æ–¹å¾®ä¿¡å…¬ä¼—å¹³å°â€œ<strong>THUæ•°æ®æ´¾</strong>â€åŠå§Šå¦¹å·â€œ<strong>æ•°æ®æ´¾THU</strong>â€è·å–æ›´å¤šè®²åº§ç¦åˆ©åŠä¼˜è´¨å†…å®¹ã€‚</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'èœé¸Ÿ','å¿…å¤‡','å¾ªç¯'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>