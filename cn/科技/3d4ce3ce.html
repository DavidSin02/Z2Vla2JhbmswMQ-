<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>初学Python-只需4步，爬取网站图片（附py文件） | 极客快訊</title><meta property="og:title" content="初学Python-只需4步，爬取网站图片（附py文件） - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/95c9e3644dda41d69923f95fdfe8b582"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3d4ce3ce.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3d4ce3ce.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3d4ce3ce.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3d4ce3ce.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3d4ce3ce.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3d4ce3ce.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3d4ce3ce.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3d4ce3ce.html><meta property="article:published_time" content="2020-11-14T20:59:46+08:00"><meta property="article:modified_time" content="2020-11-14T20:59:46+08:00"><meta name=Keywords content><meta name=description content="初学Python-只需4步，爬取网站图片（附py文件）"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/3d4ce3ce.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>初学Python-只需4步，爬取网站图片（附py文件）</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>很多人学习Python很重要的一个原因是，可以很简单的把一个网站的数据爬下来。</p><p>尤其是做我们这一行，产品经理，电商行业。</p><p><br></p><blockquote><p>领导：弄一个买卖游戏周边商品的交易APP出来。<br>我：行，那我们卖什么呀？<br>领导：看下友商卖什么我们就卖什么。<br>我：好吧，那就爬点数据下来吧。</p></blockquote><p><br></p><p>玩笑归玩笑，虽有夸张成分，但也不无道理。</p><p>作为入门级别，首先就来学习下怎么爬取网站图片。只需要调用4个方法，即可轻松批量拿到网站图片。</p><div class=pgc-img><img alt=初学Python-只需4步，爬取网站图片（附py文件） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/95c9e3644dda41d69923f95fdfe8b582><p class=pgc-img-caption></p></div><p>下面对于每一步调用的方法进行详细说明（主要还是自己拿了别人代码之后遇到的坑）</p><blockquote><p><strong>第一步：获取网页的源代码</strong></p></blockquote><p><strong>urllib.request.urlopen().read()</strong></p><p>这个方法是获取到请求的这个URL所返回的网页源代码信息数据，返回值是bytes类型时，要将其转换成utf-8才能正常显示在python程序中，所以还要调用<strong>decode()</strong>方法进行解码。</p><p>最终得到的就是平时我们编写或者查看的页面源代码了。</p><div class=pgc-img><img alt=初学Python-只需4步，爬取网站图片（附py文件） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/514fd76a955a4671bfe0350a46265c6c><p class=pgc-img-caption></p></div><p>这里可能会出现的报错信息：</p><p>1.Non-ASCII character 'e5'</p><p>原因：这是编码的问题，Python的默认编码文件是用的ASCII码，而你的Python文件中使用了中文等非英语字符。</p><p>解决方法：在第一行添加 # -- coding: UTF-8 --</p><div class=pgc-img><img alt=初学Python-只需4步，爬取网站图片（附py文件） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/abd9d70bbf464a5ab0e4ccd13e183eaa><p class=pgc-img-caption></p></div><p>2.如果爬取的网站是https协议的，需要在请求时会验证一次SSL证书</p><p>解决方法：全局加上以下代码</p><div class=pgc-img><img alt=初学Python-只需4步，爬取网站图片（附py文件） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2f198af737834621b9c4e780cabfbaf1><p class=pgc-img-caption></p></div><blockquote><p><strong>第二步：过滤出图片URL</strong></p></blockquote><p>这一步至为关键，因为在一堆网页源代码中，要有效找出目标对象（图片URL）的特点（结构特征）才行。怎么找？</p><p><strong>1.了解图片URL的html表达方式</strong></p><p>学过html的同学都知道，图片的标签是&lt;img>，src属性定义其图片源路径。</p><p><br></p><p><strong>2.使用正则表达式进行匹配</strong></p><p>我也没有详细了解过正则表达式各个符号的含义，这里不展开讲。</p><p>这里的正则表达式的意思是，过滤出所有标签是&lt;img>，旗下的src属性，且属性值是以http开头jpg结尾的源代码。</p><p><strong>每个网站的规则都不一样，不能直接套用代码。</strong></p><p>简单例子，你要爬取的网站图片是png格式，直接拿代码去运行肯定是什么都抓不到的。</p><p>再例如，我在一开始设定的规则中是没有加上http开头的，结果抓到一些图片URL是相对路径的数据，导致后面是无法访问URL报错的。</p><p><br></p><p><strong>3.将所有匹配规则的代码存入list里</strong></p><p><strong>re.compile()</strong> 根据包含的正则表达式的字符串创建模式对象（直接拿来用就好）</p><p><strong>findall()</strong> 返回string中所有与pattern相匹配的全部字串，返回形式为数组</p><div class=pgc-img><img alt=初学Python-只需4步，爬取网站图片（附py文件） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4a15d14c430e40d3bd6251a2de68cc0d><p class=pgc-img-caption></p></div><p>我们试一下打印出来imglist是什么结果，看是不是就把所有匹配规则的内容全部找出来呢！</p><div class=pgc-img><img alt=初学Python-只需4步，爬取网站图片（附py文件） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/bbb678ba5b4f4314b77faeb259c89eba><p class=pgc-img-caption></p></div><blockquote><p><strong>第三步：定义图片保存路径</strong></p></blockquote><p>这一步看个人习惯，如果只是少数几张图片，就没有必要新建一个文件夹给图片都保存整理到一起。</p><p>不过如果是爬一个网站或一个网页相对数量级比较大的时候，建议还是全部整理到一个文件夹里面，好管理嘛。</p><p>“新建文件夹”这个基础的操作，就调用<strong>os.makedirs()</strong>方法即可。</p><div class=pgc-img><img alt=初学Python-只需4步，爬取网站图片（附py文件） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/aef3674d04f54519a9f1d3515ec4f02a><p class=pgc-img-caption></p></div><p>但是这里有3个注意的点：</p><p><strong>1.新建文件夹，你是希望指定路径还是在当前路径下创建？</strong></p><p>指定路径：很简单，直接把你想要创建文件夹的路径复制出来，加上新建文件夹的名称，作为参数直接写到方法里即可。</p><p>eg.（windows）</p><p>当前路径：先获取当前的目录，再拼接上新建文件夹的名称。</p><p>获取当前目录的方式是：<strong>os.getcwd()</strong></p><p>eg.</p><div class=pgc-img><img alt=初学Python-只需4步，爬取网站图片（附py文件） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/dc8e7e0686a944259d56811da5c96d23><p class=pgc-img-caption></p></div><p><strong>2.新建的文件夹是否已存在？</strong></p><p>相同目录下不能有重名的文件/文件夹，如果直接创建的话，就会报错：文件已存在，无法创建。</p><div class=pgc-img><img alt=初学Python-只需4步，爬取网站图片（附py文件） onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/0f8722ba7f7c45cb9b75b9c58ac96152><p class=pgc-img-caption></p></div><p><strong>3.是否需要考虑windows和macOS的路径表述方式不一样？</strong></p><p>注意一下，两个操作系统对于路径的表述方式是不一样的，尤其是指定路径，要输入正确的路径才能创建成功。</p><blockquote><p><strong>第四步：将图片URL保存到文件夹下</strong></p></blockquote><p>现在，图片URL已经存入到list里（见第2步）、保存图片的文件夹也有了，就可以将虚拟的图片url转换成真实的png或jpg文件。</p><p><strong>urllib.request.urlretrieve(url, filename) </strong>这个方法就是将远程数据下载到本地</p><p>url：远程或本地的url，对应这里就是要放图片URL了。</p><p>filename：保存的完整地方，即“路径+文件名”。如果未指定该参数，urllib会生成一个临时文件来保存数据。</p><p><br></p><p>这里要注意3个地方：</p><p><strong>1.图片的文件名怎么生成？</strong></p><p>建议使用最简单的方式来生成文件名：递增数字+图片后缀</p><p>这里就再次说明要新建文件夹的重要性，新建文件夹后，这个目录下是全新空白的，不用考虑生成的文件名会不会和原有文件名重复的问题。</p><p>递增数字：譬如说，第一张图片叫“1.jpg”，第二张图片叫“2.jpg”，如此类推。</p><p><strong>2.一般网站</strong><strong>爬</strong><strong>下来的图片是多张的，如何批量处理？</strong></p><p>这里也说明了，为什么要将抓取到的图片url存到list里面了。给list一个循环，每个url调用一次urllib.request.urlretrieve()方法，那就相当于每个url都保存为1个图片。</p><div class=pgc-img><img alt=初学Python-只需4步，爬取网站图片（附py文件） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b4bd0f90a02d404fb0e02953d62e92bf><p class=pgc-img-caption></p></div><p><strong>3.报错：urllib2.HTTPError: HTTP Error 403: Forbidden</strong></p><p>原因：一些网站是禁止爬虫做的处理</p><p>解决方法：可以在请求加上头信息，伪装成浏览器访问User-Agent（具体的信息可以通过火狐的FireBug插件查询），再去请求。</p><div class=pgc-img><img alt=初学Python-只需4步，爬取网站图片（附py文件） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/55c52bd8f0cb4a91aa396643fb491001><p class=pgc-img-caption></p></div><blockquote><p><strong>运行结果：一堆图片</strong></p></blockquote><div class=pgc-img><img alt=初学Python-只需4步，爬取网站图片（附py文件） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/231651fe28d149e6a4353e7c99a7d6c0><p class=pgc-img-caption></p></div><blockquote><p><strong>其他问题</strong></p></blockquote><p><strong>1.没有自动安装或导入第三方库，如urllib.request</strong></p><p>报错：ImportError: No module named request</p><p>解决方法：安装第三方库，Mac机上在安装python3之后，系统是自动安装了pip3，所以我们只需要每次使用pip3即可安装（Windows请自行百度，注意区分Python2和Python3）</p><p>敲入安装命令：pip3 install requests</p><p><strong>2.千万千万要注意windows和mac系统的路径表达方式不一样</strong></p><p>因为我是两个操作系统切换着用，所以很头痛有这个问题，每次要记得改就是了，没技术难度。或者再加一层系统判断进行兼容就好了。</p><p><strong class=highlight-text>这里小编是一个有着5年工作经验的Python工程师，关于Python有一个完整学习Python的路线，学习材料和工具。需要的伙伴可以私信我，发送“Python”就可以获取领取地址，免费送给大家。对于学习Python有任何问题（学习方法，学习效率，如何就业）都可以问我。希望你也能凭自己的努力，成为下一个优秀的程序员！</strong></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'初学','Python','爬取'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>