<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>PYTHON PANDASæ•°æ®å¸§é‡å¡‘ | æå®¢å¿«è¨Š</title><meta property="og:title" content="PYTHON PANDASæ•°æ®å¸§é‡å¡‘ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/299c6e128a574817b9c6b33a79dabebb"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3faac91.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3faac91.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3faac91.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3faac91.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3faac91.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3faac91.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3faac91.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3faac91.html><meta property="article:published_time" content="2020-10-29T21:06:37+08:00"><meta property="article:modified_time" content="2020-10-29T21:06:37+08:00"><meta name=Keywords content><meta name=description content="PYTHON PANDASæ•°æ®å¸§é‡å¡‘"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/3faac91.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>PYTHON PANDASæ•°æ®å¸§é‡å¡‘</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p>åœ¨Pythonä¸­èåŒ–é‡å¡‘Pandasæ•°æ®æ¡†-æ•™ç¨‹å’Œå¯è§†åŒ–</p><p>å¯è§†åŒ–pd.meltå¦‚ä½•ä»å®½åˆ°é•¿æ ¼å¼é‡å¡‘Pandasæ•°æ®å¸§</p><div class=pgc-img><img alt="PYTHON PANDASæ•°æ®å¸§é‡å¡‘" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/299c6e128a574817b9c6b33a79dabebb><p class=pgc-img-caption>> Visual tutorial on how to use pd.melt() to reshape pandas dataframes from wide to long in Python</p></div><p></p><p>Pandasçš„meltï¼ˆï¼‰æ–¹æ³•å¦‚ä½•é‡å¡‘æ•°æ®å¸§ï¼Ÿ æ‚¨å¦‚ä½•å°†æ•°æ®æ¡†ä»å®½æ ¼å¼é‡å¡‘åˆ°é•¿æ ¼å¼ï¼Ÿ æœ¬æ•™ç¨‹å°†å¼•å¯¼æ‚¨é€æ­¥ä½¿ç”¨pd.meltï¼ˆï¼‰ï¼ˆæˆ–ä¸pandasæ•°æ®å¸§ç›¸å…³è”çš„meltæ–¹æ³•ï¼‰é‡å¡‘æ•°æ®å¸§ã€‚</p><p>æˆ‘å¼ºçƒˆå»ºè®®æ‚¨åœ¨é˜…è¯»æœ¬æ–‡æ—¶å°è¯•ä½¿ç”¨Pythonç¼–å†™ä»£ç ã€‚ å°è¯•åœ¨å…±äº«çš„DeepNoteç¬”è®°æœ¬ä¸Šè¿è¡Œæœ¬æ•™ç¨‹ï¼ˆæ‚¨åªèƒ½è¿è¡Œä½†ä¸èƒ½ç¼–è¾‘æ­¤ç¬”è®°æœ¬ï¼‰ã€‚</p><p>å¦å¤–ï¼Œæ‚¨å¯èƒ½æƒ³æŸ¥çœ‹å®˜æ–¹çš„Pandasæ–‡æ¡£å’Œæˆ‘çš„numpyé‡å¡‘æ•™ç¨‹ï¼š</p><h1 class=pgc-h-arrow-right>åœ¨Pythonä¸­é‡å¡‘numpyæ•°ç»„â€”åˆ†æ­¥æ•™ç¨‹</h1><h1 class=pgc-h-arrow-right>æœ¬æ•™ç¨‹å’Œå¤‡å¿˜å•æä¾›å¯è§†åŒ–å¸®åŠ©æ‚¨äº†è§£numpyå¦‚ä½•é‡å¡‘æ•°ç»„ã€‚</h1><h1 class=pgc-h-arrow-right>å®½è¿˜æ˜¯é•¿æ•°æ®å¸§</h1><p>å¦‚æœæˆ‘ä»¬å°†ä¸€ä¸ªå®½æ•°æ®æ¡†ä¸é•¿æ•°æ®æ¡†è¿›è¡Œæ¯”è¾ƒï¼Œæœ€å®¹æ˜“ç†è§£å®ƒæ˜¯ä»€ä¹ˆæ ·ã€‚</p><div class=pgc-img><img alt="PYTHON PANDASæ•°æ®å¸§é‡å¡‘" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/aae94cb6d96e473da9a56c42a86f6518><p class=pgc-img-caption>> Wide pandas dataframe can be melted/stacked using pd.melt()</p></div><p>ä¸‹é¢æ˜¯ç›¸åº”çš„æ•°æ®æ¡†ï¼ˆå…·æœ‰ç›¸åŒçš„ä¿¡æ¯ï¼‰ï¼Œä½†æ ¼å¼è¾ƒé•¿ï¼š</p><div class=pgc-img><img alt="PYTHON PANDASæ•°æ®å¸§é‡å¡‘" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/3f1d0bc572274424b3d14358acd5cb4f><p class=pgc-img-caption>> Long pandas dataframe can be "unmelted" using pd.pivot_table() (not covered in this article)</p></div><p></p><p>åœ¨å¼€å§‹æˆ‘ä»¬çš„pd.meltæ•™ç¨‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨pd.DataFrameåœ¨Pythonä¸­é‡æ–°åˆ›å»ºä¸Šé¢çš„å®½æ•°æ®æ¡†ã€‚</p><p>import pandas as pd</p><p># create wide dataframe</p><p>df_wide = pd.DataFrame( {"student": ["Andy", "Bernie", "Cindy", "Deb"], "school": ["Z", "Y", "Z", "Y"], "english": [10, 100, 1000, 10000], # eng grades "math": [20, 200, 2000, 20000], # math grades "physics": [30, 300, 3000, 30000] # physics grades })</p><h1 class=pgc-h-arrow-right>èåŒ–ä¾‹1</h1><p>æˆ‘ä»¬é€šè¿‡id_varsæŒ‡å®šæ ‡è¯†ç¬¦åˆ—æ¥èåŒ–æ•°æ®æ¡†ã€‚ "å‰©ä½™çš„"éæ ‡è¯†ç¬¦åˆ—ï¼ˆè‹±è¯­ï¼Œæ•°å­¦ï¼Œç‰©ç†å­¦ï¼‰å°†èåŒ–æˆ–å½¼æ­¤å †å æˆä¸€åˆ—ã€‚</p><p>å°†åˆ›å»ºä¸€ä¸ªæ–°çš„æŒ‡æ ‡åˆ—ï¼ˆåŒ…å«å€¼è‹±è¯­ï¼Œæ•°å­¦ï¼Œç‰©ç†ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡var_nameé‡å‘½åè¯¥æ–°åˆ—ï¼ˆcLaSsï¼‰ã€‚ æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡value_nameé‡å‘½ååŒ…å«æ‰€æœ‰å®é™…æˆç»©çš„åˆ—ï¼ˆgRaDeï¼‰ã€‚</p><blockquote class=pgc-blockquote-abstract><p>print(df_wide)</p><p>> student school english math physics Andy Z 10 20 30 Bernie Y 100 200 300 Cindy Z 1000 2000 3000 Deb Y 10000 20000 30000</p><p>df_wide.melt(id_vars=["student", "school"], var_name="cLaSs",</p><p># rename value_name="gRaDe")</p><p># rename> student school cLaSs gRaDe0 Andy Z english 101 Bernie Y english 1002 Cindy Z english 10003 Deb Y english 100004 Andy Z math 205 Bernie Y math 2006 Cindy Z math 20007 Deb Y math 200008 Andy Z physics 309 Bernie Y physics 30010 Cindy Z physics 300011 Deb Y physics 30000</p></blockquote><div class=pgc-img><img alt="PYTHON PANDASæ•°æ®å¸§é‡å¡‘" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d448f8dfb5d44d7a9fa36948c162c8f6><p class=pgc-img-caption>> Wide to long: new indicator column "cLaSs" + values melted/stacked "gRaDe" column</p></div><p></p><h1 class=pgc-h-arrow-right>èåŒ–ä¾‹2</h1><p>æ‚¨å¯ä»¥ä½¿ç”¨value_varsæŒ‡å®šè¦èåˆæˆ–å †å åˆ°åˆ—ä¸­çš„åˆ—ï¼ˆæ­¤å¤„ï¼Œæˆ‘ä»¬ä¸åŒ…æ‹¬ç‰©ç†åˆ—ï¼Œå› æ­¤value_vars = [" english"ï¼Œ" math"]ï¼‰ã€‚ æˆ‘ä»¬è¿˜ä»id_varsä¸­åˆ é™¤äº†schoolåˆ—ã€‚</p><blockquote class=pgc-blockquote-abstract><p>print(df_wide)</p><p>> student school english math physics Andy Z 10 20 30 Bernie Y 100 200 300 Cindy Z 1000 2000 3000 Deb Y 10000 20000 30000</p><p>df_wide.melt(id_vars="student", value_vars=["english", "math"], var_name="cLaSs", #rename value_name="gRaDe")</p><p># rename></p><p>student cLaSs gRaDe0 Andy english 101 Bernie english 1002 Cindy english 10003 Deb english 100004 Andy math 205 Bernie math 2006 Cindy math 20007 Deb math 2000</p></blockquote><div class=pgc-img><img alt="PYTHON PANDASæ•°æ®å¸§é‡å¡‘" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/05818ca1839140189c295f4b34a6db42><p class=pgc-img-caption></p></div><p></p><h1 class=pgc-h-arrow-right>èåŒ–ä¾‹3</h1><p>æœ€åï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚æœä»…å°†å­¦ç”Ÿåˆ—æŒ‡å®šä¸ºæ ‡è¯†ç¬¦åˆ—ï¼ˆid_vars =" student"ï¼‰ï¼Œä½†æœªæŒ‡å®šè¦é€šè¿‡value_varså †å çš„åˆ—ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µã€‚ ç»“æœï¼Œæ‰€æœ‰éæ ‡è¯†ç¬¦åˆ—ï¼ˆå­¦æ ¡ï¼Œè‹±è¯­ï¼Œæ•°å­¦ï¼Œç‰©ç†ï¼‰å°†è¢«å †å åˆ°ä¸€åˆ—ä¸­ã€‚</p><p>æœ€ç»ˆçš„é•¿æ•°æ®å¸§çœ‹èµ·æ¥æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºç°åœ¨cLaSså’ŒgRaDeåˆ—åŒ…å«äº†ä¸åº”åŒ…å«çš„å€¼ã€‚ è¿™é‡Œçš„é‡ç‚¹æ˜¯å‘æ‚¨å±•ç¤ºpd.meltçš„å·¥ä½œæ–¹å¼ã€‚</p><blockquote class=pgc-blockquote-abstract><p>print(df_wide)> student school english math physics Andy Z 10 20 30 Bernie Y 100 200 300 Cindy Z 1000 2000 3000 Deb Y 10000 20000 30000</p><p>df_wide.melt(id_vars="student", var_name="cLaSs", # rename value_name="gRaDe")</p><p># rename> student cLaSs gRaDe0 Andy school Z1 Bernie school Y2 Cindy school Z3 Deb school Y4 Andy english 105 Bernie english 1006 Cindy english 10007 Deb english 100008 Andy math 209 Bernie math 20010 Cindy math 200011 Deb math 2000012 Andy physics 3013 Bernie physics 30014 Cindy physics 300015 Deb physics 30000</p></blockquote><div class=pgc-img><img alt="PYTHON PANDASæ•°æ®å¸§é‡å¡‘" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a278aaff6f0142ce8053bd67325b675b><p class=pgc-img-caption>> Wide to long: school column isn't an identifier column</p></div><p></p><h1 class=pgc-h-arrow-right>ç»“æŸè¯­</h1><p>æˆ‘å¸Œæœ›æ‚¨ç°åœ¨å¯¹pd.meltreshapeså¦‚ä½•å¡‘é€ æ•°æ®å¸§æœ‰æ›´å¥½çš„äº†è§£ã€‚ æˆ‘æœŸå¾…æ‚¨çš„æƒ³æ³•å’Œè¯„è®ºã€‚</p><p>å¦‚æœæ‚¨è®¤ä¸ºè¿™ç¯‡æ–‡ç« æœ‰ç”¨ï¼Œè¯·å…³æ³¨æˆ‘å¹¶è®¿é—®æˆ‘çš„ç½‘ç«™ï¼Œä»¥è·å–æ›´å¤šæ•°æ®ç§‘å­¦æ•™ç¨‹ä»¥åŠå…¶ä»–æ–‡ç« ï¼š</p><p>(æœ¬æ–‡ç¿»è¯‘è‡ªHause Linçš„æ–‡ç« ã€ŠReshape pandas dataframe with melt in Python â€” tutorial and visualizationã€‹ï¼Œå‚è€ƒï¼šhttps://towardsdatascience.com/reshape-pandas-dataframe-with-melt-in-python-tutorial-and-visualization-29ec1450bb02)</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'PYTHON','PANDAS','æ•°æ®'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>