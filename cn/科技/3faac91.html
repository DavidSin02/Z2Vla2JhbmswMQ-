<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>PYTHON PANDAS数据帧重塑 | 极客快訊</title><meta property="og:title" content="PYTHON PANDAS数据帧重塑 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/299c6e128a574817b9c6b33a79dabebb"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3faac91.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3faac91.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3faac91.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3faac91.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3faac91.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3faac91.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3faac91.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3faac91.html><meta property="article:published_time" content="2020-10-29T21:06:37+08:00"><meta property="article:modified_time" content="2020-10-29T21:06:37+08:00"><meta name=Keywords content><meta name=description content="PYTHON PANDAS数据帧重塑"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/3faac91.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>PYTHON PANDAS数据帧重塑</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>在Python中融化重塑Pandas数据框-教程和可视化</p><p>可视化pd.melt如何从宽到长格式重塑Pandas数据帧</p><div class=pgc-img><img alt="PYTHON PANDAS数据帧重塑" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/299c6e128a574817b9c6b33a79dabebb><p class=pgc-img-caption>> Visual tutorial on how to use pd.melt() to reshape pandas dataframes from wide to long in Python</p></div><p></p><p>Pandas的melt（）方法如何重塑数据帧？ 您如何将数据框从宽格式重塑到长格式？ 本教程将引导您逐步使用pd.melt（）（或与pandas数据帧相关联的melt方法）重塑数据帧。</p><p>我强烈建议您在阅读本文时尝试使用Python编写代码。 尝试在共享的DeepNote笔记本上运行本教程（您只能运行但不能编辑此笔记本）。</p><p>另外，您可能想查看官方的Pandas文档和我的numpy重塑教程：</p><h1 class=pgc-h-arrow-right>在Python中重塑numpy数组—分步教程</h1><h1 class=pgc-h-arrow-right>本教程和备忘单提供可视化帮助您了解numpy如何重塑数组。</h1><h1 class=pgc-h-arrow-right>宽还是长数据帧</h1><p>如果我们将一个宽数据框与长数据框进行比较，最容易理解它是什么样。</p><div class=pgc-img><img alt="PYTHON PANDAS数据帧重塑" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/aae94cb6d96e473da9a56c42a86f6518><p class=pgc-img-caption>> Wide pandas dataframe can be melted/stacked using pd.melt()</p></div><p>下面是相应的数据框（具有相同的信息），但格式较长：</p><div class=pgc-img><img alt="PYTHON PANDAS数据帧重塑" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/3f1d0bc572274424b3d14358acd5cb4f><p class=pgc-img-caption>> Long pandas dataframe can be "unmelted" using pd.pivot_table() (not covered in this article)</p></div><p></p><p>在开始我们的pd.melt教程之前，让我们使用pd.DataFrame在Python中重新创建上面的宽数据框。</p><p>import pandas as pd</p><p># create wide dataframe</p><p>df_wide = pd.DataFrame( {"student": ["Andy", "Bernie", "Cindy", "Deb"], "school": ["Z", "Y", "Z", "Y"], "english": [10, 100, 1000, 10000], # eng grades "math": [20, 200, 2000, 20000], # math grades "physics": [30, 300, 3000, 30000] # physics grades })</p><h1 class=pgc-h-arrow-right>融化例1</h1><p>我们通过id_vars指定标识符列来融化数据框。 "剩余的"非标识符列（英语，数学，物理学）将融化或彼此堆叠成一列。</p><p>将创建一个新的指标列（包含值英语，数学，物理），我们可以通过var_name重命名该新列（cLaSs）。 我们还可以通过value_name重命名包含所有实际成绩的列（gRaDe）。</p><blockquote class=pgc-blockquote-abstract><p>print(df_wide)</p><p>> student school english math physics Andy Z 10 20 30 Bernie Y 100 200 300 Cindy Z 1000 2000 3000 Deb Y 10000 20000 30000</p><p>df_wide.melt(id_vars=["student", "school"], var_name="cLaSs",</p><p># rename value_name="gRaDe")</p><p># rename> student school cLaSs gRaDe0 Andy Z english 101 Bernie Y english 1002 Cindy Z english 10003 Deb Y english 100004 Andy Z math 205 Bernie Y math 2006 Cindy Z math 20007 Deb Y math 200008 Andy Z physics 309 Bernie Y physics 30010 Cindy Z physics 300011 Deb Y physics 30000</p></blockquote><div class=pgc-img><img alt="PYTHON PANDAS数据帧重塑" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d448f8dfb5d44d7a9fa36948c162c8f6><p class=pgc-img-caption>> Wide to long: new indicator column "cLaSs" + values melted/stacked "gRaDe" column</p></div><p></p><h1 class=pgc-h-arrow-right>融化例2</h1><p>您可以使用value_vars指定要融合或堆叠到列中的列（此处，我们不包括物理列，因此value_vars = [" english"，" math"]）。 我们还从id_vars中删除了school列。</p><blockquote class=pgc-blockquote-abstract><p>print(df_wide)</p><p>> student school english math physics Andy Z 10 20 30 Bernie Y 100 200 300 Cindy Z 1000 2000 3000 Deb Y 10000 20000 30000</p><p>df_wide.melt(id_vars="student", value_vars=["english", "math"], var_name="cLaSs", #rename value_name="gRaDe")</p><p># rename></p><p>student cLaSs gRaDe0 Andy english 101 Bernie english 1002 Cindy english 10003 Deb english 100004 Andy math 205 Bernie math 2006 Cindy math 20007 Deb math 2000</p></blockquote><div class=pgc-img><img alt="PYTHON PANDAS数据帧重塑" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/05818ca1839140189c295f4b34a6db42><p class=pgc-img-caption></p></div><p></p><h1 class=pgc-h-arrow-right>融化例3</h1><p>最后，让我们看看如果仅将学生列指定为标识符列（id_vars =" student"），但未指定要通过value_vars堆叠的列，会发生什么情况。 结果，所有非标识符列（学校，英语，数学，物理）将被堆叠到一列中。</p><p>最终的长数据帧看起来是错误的，因为现在cLaSs和gRaDe列包含了不应包含的值。 这里的重点是向您展示pd.melt的工作方式。</p><blockquote class=pgc-blockquote-abstract><p>print(df_wide)> student school english math physics Andy Z 10 20 30 Bernie Y 100 200 300 Cindy Z 1000 2000 3000 Deb Y 10000 20000 30000</p><p>df_wide.melt(id_vars="student", var_name="cLaSs", # rename value_name="gRaDe")</p><p># rename> student cLaSs gRaDe0 Andy school Z1 Bernie school Y2 Cindy school Z3 Deb school Y4 Andy english 105 Bernie english 1006 Cindy english 10007 Deb english 100008 Andy math 209 Bernie math 20010 Cindy math 200011 Deb math 2000012 Andy physics 3013 Bernie physics 30014 Cindy physics 300015 Deb physics 30000</p></blockquote><div class=pgc-img><img alt="PYTHON PANDAS数据帧重塑" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a278aaff6f0142ce8053bd67325b675b><p class=pgc-img-caption>> Wide to long: school column isn't an identifier column</p></div><p></p><h1 class=pgc-h-arrow-right>结束语</h1><p>我希望您现在对pd.meltreshapes如何塑造数据帧有更好的了解。 我期待您的想法和评论。</p><p>如果您认为这篇文章有用，请关注我并访问我的网站，以获取更多数据科学教程以及其他文章：</p><p>(本文翻译自Hause Lin的文章《Reshape pandas dataframe with melt in Python — tutorial and visualization》，参考：https://towardsdatascience.com/reshape-pandas-dataframe-with-melt-in-python-tutorial-and-visualization-29ec1450bb02)</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'PYTHON','PANDAS','数据'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>