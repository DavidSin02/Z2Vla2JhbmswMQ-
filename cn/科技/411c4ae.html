<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Seleniumå…ƒç´ æŸ¥æ‰¾ä¸æ“ä½œ | æå®¢å¿«è¨Š</title><meta property="og:title" content="Seleniumå…ƒç´ æŸ¥æ‰¾ä¸æ“ä½œ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/cde0e3b1fe3d4d6491d7aa79d1e4bcf7"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/411c4ae.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/411c4ae.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/411c4ae.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/411c4ae.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/411c4ae.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/411c4ae.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/411c4ae.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/411c4ae.html><meta property="article:published_time" content="2020-10-29T21:06:59+08:00"><meta property="article:modified_time" content="2020-10-29T21:06:59+08:00"><meta name=Keywords content><meta name=description content="Seleniumå…ƒç´ æŸ¥æ‰¾ä¸æ“ä½œ"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/411c4ae.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Seleniumå…ƒç´ æŸ¥æ‰¾ä¸æ“ä½œ</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><p class=ql-align-center><br></p><div class=pgc-img><img alt=Seleniumå…ƒç´ æŸ¥æ‰¾ä¸æ“ä½œ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/cde0e3b1fe3d4d6491d7aa79d1e4bcf7><p class=pgc-img-caption></p></div><p>â€‹ Selenium æ˜¯ä¸€ä¸ªç”¨äºWebåº”ç”¨ç¨‹åºæµ‹è¯•çš„å·¥å…·ã€‚Seleniumæµ‹è¯•ç›´æ¥è¿è¡Œåœ¨æµè§ˆå™¨ä¸­ï¼Œå°±åƒçœŸæ­£çš„ç”¨æˆ·åœ¨æ“ä½œä¸€æ ·ã€‚æ”¯æŒçš„æµè§ˆå™¨åŒ…æ‹¬IEï¼ˆ7, 8, 9, 10, 11 ï¼‰ï¼Œ Mozilla Firefox ï¼Œ Safariï¼ŒGoogle Chromeï¼ŒOperaç­‰ã€‚è¿™ä¸ªå·¥å…·çš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼šæµ‹è¯•ä¸æµè§ˆå™¨çš„å…¼å®¹æ€§â€”â€”æµ‹è¯•ä½ çš„åº”ç”¨ç¨‹åºçœ‹æ˜¯å¦èƒ½å¤Ÿå¾ˆå¥½å¾—å·¥ä½œåœ¨ä¸åŒæµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿä¹‹ä¸Šã€‚æµ‹è¯•ç³»ç»ŸåŠŸèƒ½â€”â€”åˆ›å»ºå›å½’æµ‹è¯•æ£€éªŒè½¯ä»¶åŠŸèƒ½å’Œç”¨æˆ·éœ€æ±‚ã€‚æ”¯æŒè‡ªåŠ¨å½•åˆ¶åŠ¨ä½œå’Œè‡ª åŠ¨ç”Ÿæˆ .Netã€Javaã€Perlã€pythonç­‰ä¸åŒè¯­è¨€çš„æµ‹è¯•è„šæœ¬ã€‚</p><p><strong>1.1 ä¸‹è½½selenium2.0çš„åŒ…</strong></p><ol><li>å®˜æ–¹downloadåŒ…åœ°å€ï¼š</li><li>http://code.google.com/p/selenium/downloads/list</li><li>å®˜æ–¹User Guideï¼š</li><li>http://seleniumhq.org/docs/</li><li>å®˜æ–¹API:</li><li>http://selenium.googlecode.com/git/docs/api/java/index.html</li></ol><p><strong>1.2.1 ç”¨webdriveræ‰“å¼€ä¸€ä¸ªæµè§ˆå™¨</strong></p><ul><li>æ‰“å¼€firefoxæµè§ˆå™¨ï¼š</li></ul><pre>WebDriver driver = new FirefoxDriver(); </pre><ul><li>æ‰“å¼€IEæµè§ˆå™¨</li></ul><pre>WebDriver driver = new InternetExplorerDriver ();</pre><ul><li>æ‰“å¼€HtmlUnitæµè§ˆå™¨</li></ul><pre>WebDriverdriver = new HtmlUnitDriver();</pre><ul><li>æ‰“å¼€chromeæµè§ˆå™¨</li></ul><pre>WebDriverdriver = new ChromeDriver();</pre><p><strong>1.2.2 æœ€å¤§åŒ–æµè§ˆå™¨</strong></p><pre>WebDriver driver = new FirefoxDriver();driver.manage().window().maximize();</pre><p><strong>1.2.3 å…³é—­æµè§ˆå™¨ã€€</strong></p><pre>WebDriver driver = new FirefoxDriver();driver.close();// æˆ–WebDriver driver = new FirefoxDriver();driver.quit();</pre><p><strong>1.3 æ‰“å¼€æµ‹è¯•é¡µé¢</strong></p><pre>driver.get("http://www.google.com");driver.navigate().to("http://www.baidu.com/");</pre><p>P.S.navigateæ–¹æ³•ä¼šäº§ç”Ÿ1ä¸ªNavigatorå¯¹è±¡ï¼Œå…¶å°è£…äº†ä¸å¯¼èˆªç›¸å…³çš„ä¸€äº›æ–¹æ³•ï¼Œæ¯”å¦‚å‰è¿›åé€€ç­‰</p><p><strong>1.4 é¡µé¢å…ƒç´ å®šä½</strong></p><p>Webdriveræä¾›ä¸‹é¢ä¸¤ç§æ–¹æ³•æ¥å®šä½é¡µé¢å…ƒç´ ï¼Œå‚æ•°æ˜¯Byå¯¹åƒï¼Œæœ€å¸¸ç”¨æ˜¯By.idå’ŒBy.nameæŸ¥æ‰¾ã€‚</p><ul><li><strong>findElement</strong>ï¼šå®šä½æŸä¸ªå…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å…ƒç´ ä¼šæŠ›å‡ºå¼‚å¸¸:NoSuchElementException</li><li><strong>findElement</strong>ï¼šå®šä½ä¸€ç»„å…ƒç´ </li></ul><p>ä¾‹å¦‚éœ€è¦å®šä½å¦‚ä¸‹å…ƒç´ ï¼š</p><pre>&lt;input class="input_class" type="text" name="passwd" id="passwd-id" /&gt;</pre><ul><li>By.idï¼š</li></ul><pre>WebElement element = driver.findElement(By.id("passwd-id"));</pre><ul><li>By.nameï¼š</li></ul><pre>WebElement element = driver.findElement(By.name("passwd"));</pre><ul><li>By.xpathï¼š</li></ul><pre>WebElement element =driver.findElement(By.xpath("//input[@id='passwd-id']"));</pre><ul><li>By.className</li></ul><pre>WebElement element = driver.findElement(By.className("input_class"));</pre><ul><li>By.cssSelector</li></ul><pre>WebElement element = driver.findElement(By.cssSelector(".input_class"));</pre><ul><li>By.linkText:</li></ul><pre>//é€šä¿—ç‚¹å°±æ˜¯ç²¾ç¡®æŸ¥è¯¢WebDriver driver = new FirefoxDriver();driver.get("http://www.baidu.com/");WebElement element = driver.findElement(By.linkText("ç™¾ç§‘"));</pre><ul><li>By.partialLinkTextï¼š</li></ul><pre>//è¿™ä¸ªæ–¹æ³•å°±æ˜¯æ¨¡ç³ŠæŸ¥è¯¢WebDriver driver = new FirefoxDriver();driver.get("http://www.baidu.com/");WebElement element = driver.findElement(By.partialLinkText("hao"));</pre><ul><li>By.tagName:</li></ul><pre>WebDriver driver = new FirefoxDriver();driver.get("http://www.baidu.com/");String test= driver.findElement(By.tagName("form")).getAttribute("name");System.out.println(test); </pre><p><strong>1.5 å¦‚ä½•å¯¹é¡µé¢å…ƒç´ è¿›è¡Œæ“ä½œ</strong></p><p><strong>1.5.1 è¾“å…¥æ¡†ï¼ˆtext field or textareaï¼‰</strong></p><pre>WebElement element = driver.findElement(By.id("passwd-id")); element.sendKeys(â€œtestâ€);//åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥å†…å®¹ï¼š element.clear();ã€€ã€€ã€€ã€€ //å°†è¾“å…¥æ¡†æ¸…ç©º element.getText();ã€€ã€€ //è·å–è¾“å…¥æ¡†çš„æ–‡æœ¬å†…å®¹ï¼š</pre><p><strong>1.5.2ä¸‹æ‹‰é€‰æ‹©æ¡†(Select)</strong></p><pre>Select select = new Select(driver.findElement(By.id("select")));  select.selectByVisibleText(â€œAâ€); select.selectByValue(â€œ1â€);  select.deselectAll(); select.deselectByValue(â€œ1â€); select.deselectByVisibleText(â€œAâ€); select.getAllSelectedOptions(); select.getFirstSelectedOption(); </pre><p><strong>1.5.3å•é€‰é¡¹(Radio Button)</strong></p><pre>WebElement radio=driver.findElement(By.id("BookMode")); radio.click();ã€€ã€€ã€€ã€€ //é€‰æ‹©æŸä¸ªå•é€‰é¡¹ radio.clear();ã€€ã€€ã€€ã€€ //æ¸…ç©ºæŸä¸ªå•é€‰é¡¹ radio.isSelected();ã€€ã€€//åˆ¤æ–­æŸä¸ªå•é€‰é¡¹æ˜¯å¦å·²ç»è¢«é€‰æ‹©</pre><p><strong>1.5.4å¤šé€‰é¡¹(checkbox)</strong></p><pre>WebElement checkbox = driver.findElement(By.id("myCheckbox.")); checkbox.click(); checkbox.clear(); checkbox.isSelected(); checkbox.isEnabled();</pre><p><strong>1.5.5æŒ‰é’®(button)</strong></p><pre>WebElement btn= driver.findElement(By.id("save")); btn.click();ã€€ã€€ã€€ã€€ã€€ //ç‚¹å‡»æŒ‰é’® btn.isEnabled ();ã€€ã€€//åˆ¤æ–­æŒ‰é’®æ˜¯å¦enable</pre><p><strong>1.5.7å¼¹å‡ºå¯¹è¯æ¡†(Popup dialogs)</strong></p><pre>Alert alert = driver.switchTo().alert(); alert.accept();ã€€ã€€//ç¡®å®š alert.dismiss();ã€€ //å–æ¶ˆ alert.getText();ã€€//è·å–æ–‡æœ¬</pre><p><strong>1.5.8è¡¨å•(Form)</strong></p><p>Formä¸­çš„å…ƒç´ çš„æ“ä½œå’Œå…¶å®ƒçš„å…ƒç´ æ“ä½œä¸€æ ·ï¼Œå¯¹å…ƒç´ æ“ä½œå®Œæˆåå¯¹è¡¨å•çš„æäº¤å¯ä»¥ï¼š</p><pre>WebElement approve = driver.findElement(By.id("approve"));approve.click();// æˆ–approve.submit(); //åªé€‚åˆäºè¡¨å•çš„æäº¤</pre><p><strong>1.5.9ä¸Šä¼ æ–‡ä»¶</strong></p><p>ä¸Šä¼ æ–‡ä»¶çš„å…ƒç´ æ“ä½œï¼š</p><pre>WebElement adFileUpload =driver.findElement(By.id("WAP-upload"));String filePath = "C:\test\\uploadfile\\media_ads\\test.jpg";adFileUpload.sendKeys(filePath);</pre><p><strong>1.6 Windows å’Œ Framesä¹‹é—´çš„åˆ‡æ¢</strong></p><pre>driver.switchTo().defaultContent();ã€€ã€€ã€€ã€€ã€€//è¿”å›åˆ°æœ€é¡¶å±‚çš„frame/iframedriver.switchTo().frame("leftFrame");ã€€ã€€ã€€ã€€//åˆ‡æ¢åˆ°æŸä¸ªframeï¼šdriver.switchTo().window("windowName");ã€€//åˆ‡æ¢åˆ°æŸä¸ªwindow</pre><p><strong>1.7 è°ƒç”¨Java Script</strong></p><p>Web driverå¯¹Java Scriptçš„è°ƒç”¨æ˜¯é€šè¿‡JavascriptExecutoræ¥å®ç°çš„ï¼Œä¾‹å¦‚ï¼š</p><pre>JavascriptExecutor js = (JavascriptExecutor) driver;js.executeScript("JSè„šæœ¬");</pre><p><strong>1.8 è¶…æ—¶è®¾ç½®</strong></p><pre>WebDriver driver = new FirefoxDriver(); driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);ã€€ã€€ã€€ã€€ //è¯†åˆ«å…ƒç´ æ—¶çš„è¶…æ—¶æ—¶é—´ driver.manage().timeouts().pageLoadTimeout(10, TimeUnit.SECONDS);ã€€ã€€//é¡µé¢åŠ è½½æ—¶çš„è¶…æ—¶æ—¶é—´ driver.manage().timeouts().setScriptTimeout(10, TimeUnit.SECONDS);ã€€ã€€//å¼‚æ­¥è„šæœ¬çš„è¶…æ—¶æ—¶é—´</pre></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Selenium','æŸ¥æ‰¾','å…ƒç´ '</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>