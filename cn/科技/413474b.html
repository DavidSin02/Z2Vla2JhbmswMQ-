<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>在图上发送消息的神经网络MPNN简介和代码实现 | 极客快訊</title><meta property="og:title" content="在图上发送消息的神经网络MPNN简介和代码实现 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/fec249c696fa41538ce2fbf97960bb8a"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/413474b.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/413474b.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/413474b.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/413474b.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/413474b.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/413474b.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/413474b.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/413474b.html><meta property="article:published_time" content="2020-10-29T21:04:30+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:30+08:00"><meta name=Keywords content><meta name=description content="在图上发送消息的神经网络MPNN简介和代码实现"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/413474b.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>在图上发送消息的神经网络MPNN简介和代码实现</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><br></p><p>欢迎来到图神经网络的世界，在这里我们在图上构建深度学习模型。你可以认为这很简单。毕竟，我们难道不能重用使用正常数据的模型吗?</p><div class=pgc-img><img alt=在图上发送消息的神经网络MPNN简介和代码实现 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fec249c696fa41538ce2fbf97960bb8a><p class=pgc-img-caption></p></div><p><br></p><p>其实不是。在图中所有的数据点(节点)是相互连接的。这意味着数据不再是独立的，这使得大多数标准的机器学习模型毫无用处，因为它们的推导都强烈地基于这个假设。为了克服这个问题，可以从图中提取数字数据，或者使用直接对这类数据进行操作的模型。</p><p>创建直接在图上工作的模型更为理想，因为我们可以获得更多关于图的结构和属性的信息。在本文中，我们将研究一种专门为此类数据设计的架构，即消息传递神经网络(MPNNs)。</p><h1 class=pgc-h-arrow-right>模型的各种变体</h1><div class=pgc-img><img alt=在图上发送消息的神经网络MPNN简介和代码实现 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/066bf385363f4f4dba8c4b8d9356ebd8><p class=pgc-img-caption></p></div><p><br></p><p>在将模型标准化为单个MPNN框架之前，几位独立研究人员已经发布了不同的变体。 这种类型的结构在化学中特别流行，可以帮助预测分子的性质。</p><p>Duvenaud等人在2015年发表了有关该主题的第一批著作之一[1]。 他使用消息传递体系结构从图分子中提取有价值的信息，然后将其转换为单个特征向量。 当时，他的工作具有开创性，因为他使体系结构与众不同。 实际上是最早可以在图上运行的卷积神经网络体系结构之一。</p><div class=pgc-img><img alt=在图上发送消息的神经网络MPNN简介和代码实现 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/70b581f314e94e10907cb87a932f7f29><p class=pgc-img-caption></p></div><p><br></p><p>Duvenaud等人创建的消息传递体系结构。 他将模型定义为可区分的层的堆栈，其中每一层是传递消息的另一轮。 修改自[1]</p><p>Li等人在2016年对此构架进行了另一尝试[2]。 在这里，他们专注于图的顺序输出，例如在图[2]中找到最佳路径。 为此，他们将GRU（门控循环单元）嵌入其算法中。</p><p>尽管这些算法似乎完全不同，但是它们具有相同的基本概念，即消息在图中的节点之间传递。 我们将很快看到如何将这些模型组合成一个框架。</p><h1 class=pgc-h-arrow-right>将模型统一到MPNN框架</h1><div class=pgc-img><img alt=在图上发送消息的神经网络MPNN简介和代码实现 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/23e507570e4b4b2a9d7bbb624a024464><p class=pgc-img-caption></p></div><p><br></p><p>节点V1的消息传递体系结构的一个非常简单的示例。 在这种情况下，一条消息是邻居的隐藏状态的总和。 更新函数是消息m和h1之间的平均值。</p><p>毕竟，MPNN背后的想法在概念上很简单。</p><p>图中的每个节点都具有隐藏状态（即特征向量）。 对于每个节点Vt，我们将隐藏状态的函数以及所有相邻节点的边缘与节点Vt本身进行聚合。 然后，我们使用获得的消息和该节点的先前隐藏状态来更新节点Vt的隐藏状态。</p><p>有3个主要方程式定义图[3]上的MPNN框架。 从相邻节点获得的消息由以下公式给出：</p><div class=pgc-img><img alt=在图上发送消息的神经网络MPNN简介和代码实现 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2541534215e04a998036237d35e6a82b><p class=pgc-img-caption></p></div><p><br></p><p>从邻居节点获取消息。</p><p>它是从邻居获得的所有消息Mt的总和。 Mt是取决于隐藏状态和相邻节点边缘的任意函数。 我们可以通过保留一些输入参数来简化此功能。 在上面的示例中，我们仅求和不同的隐藏状态hw。</p><p>然后，我们使用一个简单的方程式更新节点Vt的隐藏状态：</p><div class=pgc-img><img alt=在图上发送消息的神经网络MPNN简介和代码实现 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/483e02e8dfdd49e799ae28d30e1b2f8a><p class=pgc-img-caption></p></div><p><br></p><p>使用先前的隐藏状态和新消息更新节点的状态。</p><p>简单地说，通过用新获得的消息mv更新旧的隐藏状态来获得节点Vt的隐藏状态。 在上述示例的情况下，更新函数Ut是先前隐藏状态和消息之间的平均值。</p><p>我们将此消息传递算法重复指定的次数。 之后，我们进入最后的读出阶段。</p><div class=pgc-img><img alt=在图上发送消息的神经网络MPNN简介和代码实现 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/c950239a618f404f921a9626ec7f8fc3><p class=pgc-img-caption></p></div><p><br></p><p>将获得的隐藏状态映射到描述整个图形的单个特征向量中。</p><p>在此步骤中，我们提取所有新近更新的隐藏状态，并创建描述整个图形的最终特征向量。 然后可以将此特征向量用作标准机器学习模型的输入。</p><p>就是这样！ 这些是MPNN的基础。 这个框架非常强大，因为我们可以定义不同的消息并根据想要实现的功能更新功能。 我建议查看[3]以获得更多信息，以了解MPNN模型的不同变体。</p><h1 class=pgc-h-arrow-right>在哪里可以找到模型的实现</h1><p>MPNN已经被少数深度学习库实现。 以下是一些我可以找到的不同实现的列表：</p><p>原始模型代码github/brain-research/mpnn</p><p>Deepchem整合github/deepchem/deepchem/tree/master/contrib/mpnn</p><p>PyTorch的Geometric实现 github/rusty1s/pytorch_geometric</p><h1 class=pgc-h-arrow-right>总结</h1><p>MPNN框架标准化了由多个研究人员独立创建的不同消息传递模型。 该框架的主要思想包括消息，更新和读出功能，它们在图中的不同节点上运行。 MPNN模型的一些变体共享此功能，但是它们的定义不同。</p><h1 class=pgc-h-arrow-right>引用</h1><p><br></p><p>[1] Convolutional Networks on Graphs for Learning Molecular Fingerprints</p><p>[2] Gated Graph Sequence Neural Networks</p><p>[3] Neural Message Passing for Quantum Chemistry</p><p><br></p><p>作者：Kacper Kubara</p><p>deephub翻译组</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'图上','发送','神经'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>