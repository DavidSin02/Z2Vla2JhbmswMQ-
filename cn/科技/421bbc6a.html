<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>报表工具对比选型系列用例——过程计算 | 极客快訊</title><meta property="og:title" content="报表工具对比选型系列用例——过程计算 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/194902429a4c43218283ae04603edd77"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/421bbc6a.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/421bbc6a.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/421bbc6a.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/421bbc6a.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/421bbc6a.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/421bbc6a.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/421bbc6a.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/421bbc6a.html><meta property="article:published_time" content="2020-11-14T21:01:26+08:00"><meta property="article:modified_time" content="2020-11-14T21:01:26+08:00"><meta name=Keywords content><meta name=description content="报表工具对比选型系列用例——过程计算"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/421bbc6a.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>报表工具对比选型系列用例——过程计算</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>我们知道，报表呈现的数据常常并不是直接从数据库（源）取出来的数据，而还要进行一些运算，报表工具通常也会提供一定的运算能力（如过滤、分组等）以应对这种需求。但是，情况复杂时，报表数据集上的运算可能要多个步骤才能完成，这时候就要考查报表工具对过程式计算的支持程度了。</p><h1 class=pgc-h-arrow-right>用例说明</h1><p><strong>统计要求</strong></p><p>列出指定时段的大客户。所谓大客户，定义为销售额占前一半的客户，也就是把客户销售额从大到小排序后，前面若干个客户的合计销售额构成总销售的一半，这些客户被称为大客户。</p><p><strong>报表式样</strong></p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/194902429a4c43218283ae04603edd77><p class=pgc-img-caption></p></div><p><strong>数据结构</strong></p><p>[销售记录表]</p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/2aa60e66051a45dd9889f3a03dd931d2><p class=pgc-img-caption></p></div><p><strong>特点分析：</strong></p><p>这个报表式样很简单，主要麻烦之处在于需要从原始数据集计算出大客户后再呈现，而这个计算并不是简单一步能完成的。</p><p>我们的重点是考查报表工具的过程计算能力，所以假定不使用 SQL 或数据源的计算能力来完成。</p><h1 class=pgc-h-arrow-right>润干报表</h1><p><strong>制作过程:</strong></p><p>1、 配置并连接数据源。</p><p>2、 设置数据集</p><p>润干报表提供了一个独立的计算引擎，可以通过内置的脚本实现对数据的计算并将结果返回给报表数据集，在报表中新增数据集，数据集类型使用脚本数据集，脚本如下：</p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f1cca452cff34c619143aa7d6b6b2dd8><p class=pgc-img-caption></p></div><p>2.1 A1 格：单元格做了数据源的连接，然后 A6 单元格在执行完毕后关闭连接。</p><p>2.2 A2：从客户销售表中取数，此处根据客户名称做了汇总，并且按照销售额降序排序。</p><p>2.3 A3：对销售额进行求和操作并处以 2，取出总金额的一半，用于判断大客户。B3 设置初始值为 0，用于做销售额累加操作</p><p>2.4 A4：对销售额进行累加，取出累加金额大于 A3 中对应的 A2 的序号</p><p>2.5 A5：根据序号取 A2 中对应的值，并做为结果集返回给报表</p><p>3、 设计报表模板</p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d9df96046adf4ab18750b479ad167dcb><p class=pgc-img-caption></p></div><p>脚本数据集中返回的数据就是大客户的数据信息，所以制作报表就相当简单, 设置如下：：</p><p>3.1、 A2、B2 单元格直接取数据集中的数据</p><p>3.2、 B3、B4 单元格直接用数据集汇总函数，对数据集计数取出大客户数量，对销售额用 avg 函数取出平均销售额。</p><p>3.3、 设置边框、金额显示格式。</p><p><strong>运行结果</strong>：</p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/dd66abfdf16541aa9d7456c88c9aba50><p class=pgc-img-caption></p></div><p><strong>完成后点评</strong></p><p>1、 0.5 小时，使用脚本数据集中内置的语法，几个单元格的处理就能快速实现需求。</p><p>2、 可以使用脚本数据集，内置丰富语法规则，能快速处理各种复杂的数据统计要求。</p><p>3、 报表设计简单，并且不需要辅助单元格，报表计算效率高。</p><h1 class=pgc-h-arrow-right>帆软报表</h1><p><strong>制作过程:</strong></p><p>1、 配置并连接数据源。</p><p>2、 设置数据集</p><p>增加数据库查询，SQL 为： SELECT 客户,sum(销售额) 销售额 FROM DEMO. 客户销售表 group by 客户 order by 销售额 desc</p><p>3、 设计报表模板</p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/90cfc3942845439d90ac321fb9de5181><p class=pgc-img-caption></p></div><p>3.1 B2 单元格取总销售额的一半，用于判断大客户，单元格内对销售额求和，并设置自定义显示公式 $$$/2，帆软对字段汇总后如果再进行计算，无法直接在单元格里手动加表达式，只能设置自定义显示公式。</p><p>3.2 A3、B3 单元格取数数据集中的客户和销售额字段。</p><p>3.3 C3: 求累计金额，=B3+C3[A3:-1]，增加条件属性，对非大客户的数据进行隐藏。</p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b5ecf0a14c814975a0363bcb9a7022d8><p class=pgc-img-caption></p></div><p>3.4 B4: 大客户数量，=count(B3[!0;!0]{C3 &lt;= B2 || (C3[A3:-1] &lt; B2 && C3 >= B2)})，用 count 函数统计累计销售大于总销售额一般的数量。</p><p>3.5 平均销售额，=sum(B3[!0;!0]{C3 &lt;= B2 || (C3[A3:-1] &lt; B2 && C3 >= B2)}) / B4，设置单元格的格式保留两位小数。</p><p>3.6 将不需要展现的行列设置隐藏。</p><p><strong>报表结果</strong></p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c5b8a944cde646daa1834c02a6b6538b><p class=pgc-img-caption></p></div><p><strong>完成后点评</strong></p><p>1、 用时 1 小时。</p><p>2、 累计实现可以通过内置的层次函数 LAYERTOTAL(B1, C1, D1) 实现，也可以通过层次座标, 本例使用的是层次做表方式，内置功能比较丰富。</p><p>3、 可以根据条件公式动态设置报表行列的动态隐藏。</p><p>4、 需要增加辅助单元格，会增加额外资源的耗用，尤其是客户数量多时，报表中是取出了所有客户信息（小客户数量常常多得多），然后再判断隐藏，数据量大时报表计算性能会有影响。</p><h1 class=pgc-h-arrow-right>Smartbi</h1><p><strong>制作过程</strong></p><p>1、 配置并连接数据源。</p><p>2、 设置数据集</p><p>采用原生 SQL 数据集，直接通过 SQL 语句取数就行：</p><p>select 客户,sum(销售额) 金额 from 客户销售表 group by 客户 order by 金额 desc。</p><p>3、 设计报表模板</p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1fef83cbab6d464a8c79dcbbbbdb50c3><p class=pgc-img-caption></p></div><p>报表的设计在 excel 内完成，借助丰富的 excel 函数，smartbi 解决这种格间运算也不是太麻烦。如几个关键计算：</p><p>3.1 D1：所有客户的销售总金额，D2 中写入表达式 =D1/2, 取总销售额的一半。</p><p>3.2 D3 格：累积金额，=SSR_GetCell(D3,B3,-1)+C3。</p><p>3.3 E3：=IF(SSR_GetSubCells(D3,B3)>D2,1+SSR_GetCell(E3,B3,-1),0)，根据累积金额，标识当出现累积金额大于总金额一半的时候 标识为 1，后面累计值依然大于总金额一半，数值累计为 2/3/4（用于隐藏后面不要的数据）等</p><p>3.4 C4 格：=MATCH(1,SSR_GetSubCells(E3,A3),0)，根据 E3 的标识，查找第一个出现的 1 所在的序号，该序号即标识大客户数。</p><p>3.5 C5 格：平均销售额相对简单，=D4/C4，并设置报表中数据显示格式</p><p>3.6 隐藏行设置，需要隐藏掉非大客户数据，不支持表格内定义隐藏表达式，这里根据 E3 值大于 1 的就隐藏，要借助平台给电子表格设置宏（需要写 js 代码）实现：</p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/df3d8ddb1255445cb6db6ecaf3750282><p class=pgc-img-caption></p></div><p><strong>运行结果</strong></p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/028dda986fe5491c8893a748dfa13ba3><p class=pgc-img-caption></p></div><p><strong>完成后点评：</strong></p><p>1、 用时：1.5 小时。</p><p>2、 完全在 excel 中操作，容易上手，操作起来比较方便。excel 函数丰富，这个报表主要是其查找类函数的使用。</p><p>3、 隐藏不需要（除大客户外）的客户数据时，不支持表格内定义隐藏表达式，需要 js 代码才能实现，难度较大。</p><p>4、 需要增加辅助单元格，会增加额外资源的耗用，尤其是客户数量多时，报表中是取出了所有客户信息（小客户数量常常多得多），然后再判断隐藏，数据量大时报表计算性能会有影响。</p><h1 class=pgc-h-arrow-right>永洪 BI</h1><p><strong>制作过程：</strong></p><p>1、 配置并连接数据源。</p><p>2、 设置数据集</p><p>使用 SQL 语句数据集：select 客户,sum(销售额) 金额 from 客户销售表 group by 客户 order by 金额 desc</p><p>3、 设计报表模板</p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d29e5cfdbf7f45ba85f226ce0e508732><p class=pgc-img-caption></p></div><p>3.1 第一列增加了个按销售额取数，实际中发现数据集中虽然按照销售额排序了，但是直接取出客户名称字段时，即使不排序，也不会按照数据集原有数据排序，所以前边增加了个销售额字段，并且设置降序排序。</p><p>3.2 第四列中取出了总销售额以及对应的累计销售额，累计销售额直接拖拽，设置下格间计算未累计就行</p><p>3.3 大客户数量单元格使用格间计算，里边表达式为：</p><p>var a=0;</p><p>for(var i=1;i&lt;=ridx-1;i++){</p><p>if(cell(i,3)>=cell(0,3)/2){</p><p>a=i;</p><p>break;</p><p>}</p><p>}</p><p>通过 js 语法，对行列循环，判断累计值是否大于销售额总计的一半，返回对应行数也就是数量。</p><p>3.4 大客户平均销售额同样的做法：</p><p>var a=0;</p><p>for(var i=1;i&lt;=ridx-2;i++){</p><p>if(cell(i,3)>=cell(0,3)/2){</p><p>a=cell(i,3)/i;</p><p>break;</p><p>}</p><p>}</p><p>3.5 第一列和第四列是辅助列，右侧有个隐藏列设置，将这两列隐藏掉</p><p>3.6 隐藏行设置，永洪不支持单元格隐藏行表达式，如果要隐藏掉非大客户数据，需要通过 js 语句实现，可以在 js 中获取到报表计算后的行属性，根据 3.3 中获取的大客户数量动态设置非大客户（报表计算后行号超过大客户数量的行）行高为 0，来达到隐藏的效果，这个和 Smartbi 有些类似，这里就不具体实现了。</p><p><strong>运行结果</strong></p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/42ce3bdc2ddb46f09689ca2408670037><p class=pgc-img-caption></p></div><p><strong>完成后点评</strong></p><p>1、 用时 2 小时，格间计算那几个单元格处理时间较长，比较考验开发能力。</p><p>2、 格间计算中可以用 js 语法进行数据的计算，适合开发人员操作，比较灵活, 但同时内置函数少，比较考验开发人员能力。</p><p>3、 累计设置比较方便，直接用内置的语法就行。</p><p>4、 排序设置有问题，数据集中设置了数据的排序，但是报表里默认不会按照相应的顺序排序（也可能没找到方法）。</p><p>5、 需要增加辅助列来实现，比如累计列，如果数据量大会额外占用内存空间。</p><p>6、 可以设置隐藏列，但是设置后设计界面也就无法看到该列，无法还原，而且如果数据集变动而隐藏列里引用了变动前的字段，很难更改。</p><p>7、 需要增加辅助单元格，会增加额外资源的耗用，尤其是客户数量多时，报表中是取出了所有客户信息（小客户数量常常多得多），然后再判断隐藏，数据量大时报表计算性能会有影响。并且隐藏掉非大客户信息时，需要写复杂的 js，难度较大。</p><h1 class=pgc-h-arrow-right>亿信</h1><p><strong>制作过程</strong></p><p>1、 配置并链接数据源</p><p>2、 设置数据集</p><p>直接通过 SQL 语句取数就行：SQL 语句为：select customer,sum(sales) as sales from sales group by customer order by sum(sales) desc</p><p>3、 设计报表模板</p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a5bfa585c4e34279a4ce44d4cbc425c4><p class=pgc-img-caption></p></div><p>3.1 A1：=sum(TEST.sales)/2 计算所有客户的销售总金额的一半，并在右侧属性里设置隐藏属性</p><p>3.2 A3：=TEST.customer 浮动维字段，同时在右侧设置排序的依据是 B3。</p><p>3.3 C3：=self.leftcell.value+self.upcell.value 实现金额累计计算</p><p>3.4 D3：=if(GRID1.C3.upcell.value&lt;GRID1.A1,1,null) 将累计金额大于 A1 单元格值的数据标识为 1，不符合条件的标识为 null，方便后面统计数量。</p><p>3.5 B4：=sum(GRID1.D3$)，根据 D3 的标识统计出来大客户数量（D3 中大客户返回 1，对 1 求和就是大客户数量）</p><p>3.6 B5：=GRID1.D3$.select(@.value=1).select(true,@.leftcell(2).value).avg() 先使用数组的方式过滤出来对应的数据，然后再进行求平均的计算</p><p>3.7 选中第 3 行设置显示表达式为：&lt;#=if(GRID1.D3=1,1,0)#>，D3 单元格标识出了本条数据是否是大客户，这里根据 D3 单元格值控制本行是否显示（如果为 1 则返回 1 表示显示，否则返回 0 不显示）</p><p><strong>运行结果</strong></p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d7b57b732f6e4d71accd26dc64b0ba55><p class=pgc-img-caption></p></div><p><strong>完成后点评：</strong></p><p>1、 制作用时：1.5 小时</p><p>2、 内置函数比较丰富，本表中常用操作基本上都是通过内置函数实现。</p><p>3、 可以根据条件公式动态设置报表行列的动态隐藏，比较方便。</p><p>4、 需要增加辅助单元格，会增加额外资源的耗用，尤其是客户数量多时，报表中是取出了所有客户信息（小客户数量常常多得多），然后再判断隐藏，数据量大时报表计算性能会有影响。</p><h1 class=pgc-h-arrow-right>总结</h1><ol start=1><li>这个例子报表结果格式相对比较简单，各个报表工具基本上都能实现。</li><li>对于本例中考查的过程计算，帆软、Smartbi、永洪、亿信这四款工具实现方法基本一致，都是通过辅助行列取出销售额总计、累计销售额，然后进行数据判断来确定哪些客户是大客户并对数据统计，最后将辅助行列再隐藏掉。整个过程有一定的难度和繁琐度，这是因为报表只能执行状态式计算，用来处理过程计算就只能采取这种迂回的办法。</li><li>这几款产品之间来看，帆软、Smartbi、亿信基本上一致，都是使用内置函数或者方法实现，隐藏行列也比较方便。而永洪累计实现方便，直接通过鼠标设置就行，但是做数据统计时就要写复杂的 javascript 语法来统计，这块实现难度比较大，而且隐藏行列设置也不太方便。永洪的复杂报表功能相比其它三款要更弱一点，帆软在这四款中相对更好，这和之前测试其它案例的结论也一致。</li><li>润干事实上也可以采用隐藏格手段实现，但我们在这里则提供了一种与众不同的方法。润干增加了一个计算层，使用脚本数据集，可以更方便地实现过程式计算，返回给报表就是处理后的数据结果，报表中不再做特别处理，整体过程更为简单，而且消耗资源也比使用辅助格要少得多，性能会更优。仍然是和之前测试案例的结论一致，润干是这几款产品中拥有最强计算能力的产品，计算层明显拉开了和其它产品的差距，这对于高效开发复杂报表是至关重要的。</li></ol><h1 class=pgc-h-arrow-right>进一步的例子</h1><p>我们再通过一个例子在看计算层的意义，查询股票最长连续上涨的天数：</p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4efe77722a854ac6b4b642ea0ca529f3><p class=pgc-img-caption></p></div><p>数据源是一个文本，记录各支股票的每天的收盘价：</p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f7dc8982464d438d97c732fbf809c311><p class=pgc-img-caption></p></div><p>这个报表的样式也很简单，但计算过程要更为繁琐：需要先将按日期过滤后的数据集按股票代码分组，再计算出每组股票连续上涨的天数，然后再过滤出超过 5 天的股票。</p><p>这种复杂的过程，如果没有计算层的协助，使用隐藏格就是个非常麻烦的过程，大体描述如下：</p><p>1、 取出文本数据集，放入单元格中</p><p>2、 设置排序，按股票代码和日期排序</p><p>3、 按股票代码分组，做成两层报表</p><p>4、 在明细行增加辅助格计算连续上涨的天数</p><p>5、 在分组行计算最大连续上涨的天数</p><p>6、 将明细行隐藏</p><p>7、 将非指定日期和不满足条件的分组隐藏。</p><p>这个过程，对于帆软这种格间计算能力较强的报表工具，还只是繁琐；而 Smartbi、永洪和亿信这些就不只是繁琐的问题，中间的计算也很难表达。并且，无论是哪一款工具，都会导致整个报表臃肿，有大量的隐藏格（远远多于呈现出来的格子）。</p><p>要避免这些，实际使用的办法常常会借助自定义数据源，用 Java 读出数据把结果集计算好，或者把数据导入数据库用 SQL 来算。无论哪种方法，都依然非常繁琐，严重影响开发效率。</p><p>但是，如果像润干报表一样有个可解释执行的计算层的话，那就会很简单，实现这个逻辑也不需要几行代码：</p><div class=pgc-img><img alt=报表工具对比选型系列用例——过程计算 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4c771e067ee24edcb3eef2e466c92f04><p class=pgc-img-caption></p></div><p>A1 :=file(“F:/ 股票信息.txt”).import@t().select(left(string(Date),7)==rq), 读取股票信息中的数据，并根据报表中传入的 rq 参数进行数据过滤，取某月数据</p><p>A2：=A1.sort(Date).group(SID)，按照日期排序，并根据 SID 字段分组</p><p>A3：go=A2.new(SID, ~.group@i(Closing>Closing\[-1\]).max(~.len()):ts)，Closing[-1] 取当前记录上一条的收盘价，A3 中根据同一只股票当天收盘大于前一天收盘价来取最大连续上涨天数。</p><p>A4：return A3.select(ts>=5)，取出 A3 中最大连续上涨天数大于 5 的数据，返回给报表数据集使用。</p><p>由于脚本数据集中已经处理好了数据，报表中制作就相当简单了，就不用具体解释了。</p><h1 class=pgc-h-arrow-right>复杂报表最后的结论</h1><p>我们用了三篇文章对比了这五款以复杂报表能力为宣传点的报表工具:<br>报表工具对比选型系列用例——多源分片报表</p><p>报表工具对比选型系列用例——排名及跨行组统计<br>总体结论如下：</p><ol start=1><li>润干的优势非常明显，即使不考虑它特有的计算层，其复杂报表能力也是这五款产品中最强的。再加上计算层，可以说是遥遥领先，和其它几款产品相比已经差出档次了。</li><li>帆软居次，如果抛开润干特有的计算层，帆软的复杂报表能力和润干相比还是会弱，但相差不算很大了，而且帆软友好的界面能够再加分，可以认为润干和帆软是第一档的产品，把复杂报表作为宣传点都算是名符其实的。</li><li>Smartbi 就要弱一些，模型基本实现了，但表达式细节和润干帆软差得不少，可以算作是第二档的产品。把复杂报表作为宣传点，在 BI 领域中也还勉强说得过去。</li><li>永洪和亿信，严格地说，其复杂报表能力还处于没入门的阶段，和其它几款产品相比的差距非常大。只能算作第三档甚至不入档的产品了，其实这两款产品本来是 BI 色彩很强的产品，把复杂报表作为宣传点就有点名不符实了。</li></ol></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'报表','选型','用例'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../cn/%E7%A7%91%E6%8A%80/91bf4ae.html alt=报表工具对比选型系列用例——多源分片报表 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/95fb949a3a52446d9469fefa4df369df style=border-radius:25px></a>
<a href=../../cn/%E7%A7%91%E6%8A%80/91bf4ae.html title=报表工具对比选型系列用例——多源分片报表>报表工具对比选型系列用例——多源分片报表</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>