<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>å¦‚ä½•ä»é›¶å¼€å§‹ä¸¤å¤©æ’¸ä¸€ä¸ªå¾®ä¿¡å°ç¨‹åºï¼Ÿï¼ï¼ˆå†…å«æºç ï¼‰ | æå®¢å¿«è¨Š</title><meta property="og:title" content="å¦‚ä½•ä»é›¶å¼€å§‹ä¸¤å¤©æ’¸ä¸€ä¸ªå¾®ä¿¡å°ç¨‹åºï¼Ÿï¼ï¼ˆå†…å«æºç ï¼‰ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/4007ebeb6be24800a3d7fe0b85c2f122"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/437b27b.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/437b27b.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/437b27b.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/437b27b.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/437b27b.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/437b27b.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/437b27b.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/437b27b.html><meta property="article:published_time" content="2020-10-29T20:59:18+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:18+08:00"><meta name=Keywords content><meta name=description content="å¦‚ä½•ä»é›¶å¼€å§‹ä¸¤å¤©æ’¸ä¸€ä¸ªå¾®ä¿¡å°ç¨‹åºï¼Ÿï¼ï¼ˆå†…å«æºç ï¼‰"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/437b27b.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>å¦‚ä½•ä»é›¶å¼€å§‹ä¸¤å¤©æ’¸ä¸€ä¸ªå¾®ä¿¡å°ç¨‹åºï¼Ÿï¼ï¼ˆå†…å«æºç ï¼‰</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><blockquote>ã€ç¨‹åºäººç”Ÿ ç¼–è€…æŒ‰ã€‘æ–°äººå¦‚ä½•å…¥é—¨å°ç¨‹åºï¼Ÿä¸å¦¨å°è¯•åšä¸€ä¸ªå®ç”¨æ€§å¼ºçš„å¤©æ°”åº”ç”¨å°ç¨‹åºå§ã€‚ä¸‹é¢æ˜¯ä½œè€…åªç”¨äº†ä¸¤å¤©æ—¶é—´å†™çš„å·²ä¸Šçº¿å¤©æ°”å°ç¨‹åºï¼Œä¸€èµ·æ¥å­¦å­¦å¦‚ä½•åšçš„ã€‚</blockquote><p class=ql-align-center><br></p><p class=ql-align-center><strong>å‰æœŸå‡†å¤‡</strong></p><p class=ql-align-justify><br></p><h1><strong>å¤©æ°”æ•°æ®</strong></h1><p class=ql-align-justify>å› ä¸ºè¿™æ˜¯ä¸ªäººçš„DEMOï¼Œå¼€å‘å‰å°±å†³å®šé€‰æ‹©å…è´¹çš„å¤©æ°”æ•°æ®ï¼ˆä¸ªäººå¼€å‘å…è´¹ï¼‰ï¼Œæˆ‘é€‰æ‹©äº†ç™¾åº¦åœ°å›¾å¼€æ”¾å¹³å°çš„å¤©æ°”æ•°æ®ï¼Œæ­£å¥½ä¹Ÿæä¾›äº†å°ç¨‹åºå¯¹åº”çš„ SDKï¼Œå¯èƒ½ç›¸æ¯”äºå…¶ä»–çš„å¤©æ°” APIï¼Œç™¾åº¦è¿”å›çš„æ•°æ®åå°‘ï¼šä¾‹å¦‚å½“å¤© PM2.5ã€å½“å¤©å’Œæœªæ¥ä¸‰å¤©æ•°æ®ã€å½“å¤©ç”Ÿæ´»æŒ‡æ•°ï¼Œä½†æ˜¯å¯¹äºä¸€æ¬¾ç®€å•çš„å¤©æ°”åº”ç”¨å°ç¨‹åºæ¥è¯´ä¹Ÿå¤Ÿäº†ã€‚</p><h1 class=ql-align-justify><strong>åœ°ç†ç¼–ç </strong></h1><p class=ql-align-justify>è·å–å¤©æ°”æ•°æ®é»˜è®¤è¿”å›å½“å‰åŸå¸‚çš„å¤©æ°”æ•°æ®ï¼Œå¦‚æœè¦è·å–å…¶ä»–çš„åŸå¸‚çš„å¤©æ°”æ•°æ®ï¼Œéœ€è¦ä¼ å…¥ç»çº¬åº¦ã€‚ä¸ºäº†è·å–å…¶ä»–åŸå¸‚çš„ç»çº¬åº¦ï¼Œè¿™é‡Œä½¿ç”¨çš„åœ°å›¾çš„åœ°ç†ç¼–ç æ¥å£ï¼Œè¾“å…¥åŸå¸‚åï¼Œè¾“å‡ºç»çº¬åº¦ï¼Œç„¶åè°ƒç”¨è·å–å¤©æ°”æ•°æ® API å³å¯ã€‚</p><p><strong>è¿è¡Œå‰å‡†å¤‡</strong></p><p class=ql-align-justify><br></p><ol><li class=ql-align-justify>æ³¨å†Œå¾®ä¿¡å°ç¨‹åºï¼Œè·å– AppID</li><li class=ql-align-justify>æ³¨å†Œç™¾åº¦åœ°å›¾å¼€æ”¾å¹³å°å¼€å‘è€…ï¼Œåˆ›å»ºåº”ç”¨ï¼Œè·å– akï¼ˆå…¶ä»–é…ç½®è‡ªè¡ŒæŸ¥çœ‹ï¼‰</li><li class=ql-align-justify>åœ¨ app.js ä¸­æ›¿æ¢ globalData ä¸­çš„ ak ä¸ºè‡ªå·±çš„ ak</li><li class=ql-align-justify>Run</li></ol><h1 class=ql-align-center><strong>å…·ä½“å®ç°</strong></h1><p class=ql-align-justify>è¯¥åº”ç”¨æœ‰äº”ä¸ªé¡µé¢ï¼šé¦–é¡µã€åŸå¸‚é€‰æ‹©é¡µã€è®¾ç½®é¡µã€å…³äºé¡µã€ç³»ç»Ÿä¿¡æ¯é¡µï¼ˆå±•ç¤ºé¡µï¼‰ã€‚åˆ†åˆ«æ˜¯è¿™æ ·å®ç°çš„ï¼š</p><p class=ql-align-justify><strong>é¦–é¡µ</strong></p><p class=ql-align-justify>ä»ä¸Šåˆ°ä¸‹ä¾æ¬¡æ˜¯ï¼šå…¶ä»–åŸå¸‚å¤©æ°”æœç´¢ã€å½“å‰åŸå¸‚æ•°æ®å±•ç¤ºã€å½“å¤©å’Œæœªæ¥ä¸‰å¤©å¤©æ°”æ•°æ®å±•ç¤ºã€å½“å¤©ç”Ÿæ´»æŒ‡æ•°å±•ç¤ºã€footerã€‚ä¸‹æ‹‰åˆ·æ–°ä¼šåˆ·æ–°å½“å‰åœ°åŒºçš„å¤©æ°”æ•°æ®ã€‚å…¶ä¸­ï¼Œé¡¶éƒ¨åŸå¸‚å¤©æ°”æœç´¢å’Œç”Ÿæ´»æŒ‡æ•°å¯ä»¥åœ¨è®¾ç½®ä¸­éšè—ã€‚å±å¹•å³ä¸‹è§’æ˜¯ä¸€ä¸ªå¯ä»¥ç§»åŠ¨çš„æ‚¬æµ®çƒèœå•ï¼Œç‚¹å‡»åä¼šå¼¹å‡ºåŸå¸‚é€‰æ‹©ã€è®¾ç½®ã€å…³äºé¡µé¢çš„å…¥å£ã€‚èƒŒæ™¯è‰²é»˜è®¤æ˜¯ #40a7e7 çº¯è‰²ï¼Œå¯åœ¨è®¾ç½®ä¸­æ›´æ¢èƒŒæ™¯å›¾ï¼Œæœªæ¥ä¸‰å¤©å¤©æ°”é¢„æŠ¥å’Œç”Ÿæ´»æŒ‡æ•°åˆ†åˆ«æ·»åŠ äº†é€æ˜çš„é»‘è‰²èƒŒæ™¯ã€‚æœ€ç»ˆå®ç°å›¾å¦‚ä¸‹ï¼š</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=å¦‚ä½•ä»é›¶å¼€å§‹ä¸¤å¤©æ’¸ä¸€ä¸ªå¾®ä¿¡å°ç¨‹åºï¼Ÿï¼ï¼ˆå†…å«æºç ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4007ebeb6be24800a3d7fe0b85c2f122><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><strong>ä¸»é¡µé¢</strong></p><p class=ql-align-justify>å…ˆå®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å–å½“å‰åœ°åŒºçš„å¤©æ°”æ•°æ®ï¼š</p><pre>init(params) { let that = this let BMap = new bmap.BMapWX({ ak: globalData.ak, }) BMap.weather({ location: params.location, fail: that.fail, success: that.success, })},</pre><p class=ql-align-justify>ak è¯·æ›¿æ¢ä¸ºè‡ªå·±çš„ akï¼Œå› ä¸ºéœ€è¦è·å–ç”¨æˆ·çš„åœ°ç†ä½ç½®ï¼Œæ‰€ä»¥åœ¨ fail çš„å›è°ƒä¸­éœ€è¦å¤„ç†ç”¨æˆ·æ‹’ç»è·å–åœ°ç†ä½ç½®çš„é€»è¾‘ã€‚è¿™é‡Œå¤„ç†ä¸ºï¼šæç¤ºæ‰“å¼€åœ°ç†ä½ç½®æˆæƒï¼Œ3000ms å wx.openSetting() è·³è½¬åˆ°å°ç¨‹åºè®¾ç½®é¡µï¼Œå¦‚ä¸‹ï¼š</p><pre class=ql-align-justify>fail (res) { wx.stopPullDownRefresh() let errMsg = res.errMsg || '' // æ‹’ç»æˆæƒåœ°ç†ä½ç½®æƒé™ if (errMsg.indexOf('deny') !== -1 || errMsg.indexOf('denied') !== -1) { wx.showToast({ title: 'éœ€è¦å¼€å¯åœ°ç†ä½ç½®æƒé™', icon: 'none', duration: 3000, success (res) { let timer = setTimeout(() =&gt; { clearTimeout(timer) wx.openSetting({}) }, 3000) }, }) } else { wx.showToast({ title: 'ç½‘ç»œä¸ç»™åŠ›ï¼Œè¯·ç¨åå†è¯•', icon: 'none', }) }},</pre><p class=ql-align-justify>è·å–åˆ°ç”¨æˆ·çš„åœ°ç†ä½ç½®åï¼Œæ‰§è¡Œ successï¼š</p><pre class=ql-align-justify>success (data) { wx.stopPullDownRefresh() let now = new Date() // å­˜ä¸‹æ¥æºæ•°æ® data.updateTime = now.getTime() data.updateTimeFormat = utils.formatDate(now, "MM-dd hh:mm") let results = data.originalData.results[0] || {} data.pm = this.calcPM(results['pm25']) // å½“å¤©å®æ—¶æ¸©åº¦ data.temperature = `${results.weather_data[0].date.match(/\d+/g)[2]}` wx.setStorage({ key: 'cityDatas', data: data, }) this.setData({ cityDatas: data, })},</pre><p class=ql-align-justify>çœ‹ä¸€ä¸‹è¿”å›çš„å¤©æ°”æ•°æ®æ ¼å¼ï¼š</p><pre class=ql-align-justify>{ "error": 0,  "status": "success",  "date": "2018-06-29",  "results": [ { "currentCity": "åŒ—äº¬å¸‚",  "pm25": "55",  "index": [ { "des": "å¤©æ°”ç‚çƒ­ï¼Œå»ºè®®ç€çŸ­è¡«ã€çŸ­è£™ã€çŸ­è£¤ã€è–„å‹Tæ¤è¡«ç­‰æ¸…å‡‰å¤å­£æœè£…ã€‚",  "zs": "ç‚çƒ­",  "tipt": "ç©¿è¡£æŒ‡æ•°",  "title": "ç©¿è¡£" },  { "des": "è¾ƒé€‚å®œæ´—è½¦ï¼Œæœªæ¥ä¸€å¤©æ— é›¨ï¼Œé£åŠ›è¾ƒå°ï¼Œæ“¦æ´—ä¸€æ–°çš„æ±½è½¦è‡³å°‘èƒ½ä¿æŒä¸€å¤©ã€‚",  "zs": "è¾ƒé€‚å®œ",  "tipt": "æ´—è½¦æŒ‡æ•°",  "title": "æ´—è½¦" },  { "des": "å„é¡¹æ°”è±¡æ¡ä»¶é€‚å®œï¼Œå‘ç”Ÿæ„Ÿå†’æœºç‡è¾ƒä½ã€‚ä½†è¯·é¿å…é•¿æœŸå¤„äºç©ºè°ƒæˆ¿é—´ä¸­ï¼Œä»¥é˜²æ„Ÿå†’ã€‚",  "zs": "å°‘å‘",  "tipt": "æ„Ÿå†’æŒ‡æ•°",  "title": "æ„Ÿå†’" },  { "des": "å¤©æ°”è¾ƒå¥½ï¼Œæ— é›¨æ°´å›°æ‰°ï¼Œä½†è€ƒè™‘æ°”æ¸©å¾ˆé«˜ï¼Œè¯·æ³¨æ„é€‚å½“å‡å°‘è¿åŠ¨æ—¶é—´å¹¶é™ä½è¿åŠ¨å¼ºåº¦ï¼Œè¿åŠ¨ååŠæ—¶è¡¥å……æ°´åˆ†ã€‚",  "zs": "è¾ƒä¸å®œ",  "tipt": "è¿åŠ¨æŒ‡æ•°",  "title": "è¿åŠ¨" },  { "des": "å±ä¸­ç­‰å¼ºåº¦ç´«å¤–çº¿è¾å°„å¤©æ°”ï¼Œå¤–å‡ºæ—¶å»ºè®®æ¶‚æ“¦SPFé«˜äº15ã€PA+çš„é˜²æ™’æŠ¤è‚¤å“ï¼Œæˆ´å¸½å­ã€å¤ªé˜³é•œã€‚",  "zs": "ä¸­ç­‰",  "tipt": "ç´«å¤–çº¿å¼ºåº¦æŒ‡æ•°",  "title": "ç´«å¤–çº¿å¼ºåº¦" } ],  "weather_data": [ { "date": "å‘¨äº” 06æœˆ29æ—¥ (å®æ—¶ï¼š34â„ƒ)",  "dayPictureUrl": "http://api.map.baidu.com/images/weather/day/duoyun.png",  "nightPictureUrl": "http://api.map.baidu.com/images/weather/night/qing.png",  "weather": "å¤šäº‘è½¬æ™´",  "wind": "ä¸œå—é£å¾®é£",  "temperature": "38 ~ 25â„ƒ" },  { "date": "å‘¨å…­",  "dayPictureUrl": "http://api.map.baidu.com/images/weather/day/duoyun.png",  "nightPictureUrl": "http://api.map.baidu.com/images/weather/night/duoyun.png",  "weather": "å¤šäº‘",  "wind": "ä¸œå—é£å¾®é£",  "temperature": "36 ~ 23â„ƒ" },  { "date": "å‘¨æ—¥",  "dayPictureUrl": "http://api.map.baidu.com/images/weather/day/qing.png",  "nightPictureUrl": "http://api.map.baidu.com/images/weather/night/qing.png",  "weather": "æ™´",  "wind": "ä¸œå—é£å¾®é£",  "temperature": "35 ~ 23â„ƒ" },  { "date": "å‘¨ä¸€",  "dayPictureUrl": "http://api.map.baidu.com/images/weather/day/qing.png",  "nightPictureUrl": "http://api.map.baidu.com/images/weather/night/duoyun.png",  "weather": "æ™´è½¬å¤šäº‘",  "wind": "å—é£å¾®é£",  "temperature": "35 ~ 25â„ƒ" } ] } ]}</pre><p class=ql-align-justify>success é‡Œç¼“å­˜äº†æœ€æ–°ä¸€æ¬¡è·å–çš„å¤©æ°”æ•°æ®+æ›´æ–°çš„æ—¶é—´ cityDatasï¼Œå°ç¨‹åºçš„æ¨¡æ¿é‡Œæ— æ³•ä½¿ç”¨æ–¹æ³•ï¼Œæ‰€ä»¥æ•°æ®éœ€è¦åœ¨ js é‡Œé¢å…ˆæ ¼å¼åŒ–ã€‚</p><p class=ql-align-justify>calcPM ç”¨æ¥è®¡ç®—å½“å‰ PM2.5 çš„è´¨é‡ï¼Œè¿”å›â€œä¼˜è‰¯å·®â€ç±»ä¼¼å­—æ ·ï¼ŒèŒƒå›´æ ‡å‡†å¯è‡ªè¡Œæœç´¢ã€‚å½“å¤©çš„å®æ—¶æ¸©åº¦å¹¶æ²¡æœ‰ç»™å‡ºç‹¬ç«‹çš„å­—æ®µï¼Œè€Œæ˜¯æ··åœ¨äº† wearther_data[0] çš„ data å­—æ®µé‡Œï¼š"date": "å‘¨äº” 06æœˆ29æ—¥ (å®æ—¶ï¼š34â„ƒ)"ï¼Œéœ€è¦è‡ªè¡Œæå–ã€‚è¿”å›çš„å¤©æ°” icon å’Œè‰²è°ƒä¸æ­ï¼Œå°±æ²¡æœ‰ä½¿ç”¨ã€‚å…¶ä»–çš„æ•°æ®æŒ‰ç…§æŒ‰ç…§æˆ‘ä»¬è¦æ˜¾ç¤ºçš„æ ¼å¼ç›´æ¥å¡«å……å³å¯ã€‚</p><p class=ql-align-justify><strong>åŸå¸‚å¤©æ°”æœç´¢</strong></p><p class=ql-align-justify>è·å–å¤©æ°”æ•°æ®ä¼ å‚ä¸ºç»çº¬åº¦ï¼Œæ‰€ä»¥æœç´¢åŸå¸‚å¤©æ°”æ—¶ï¼Œéœ€å…ˆå°†åŸå¸‚è½¬æ¢ä¸ºå¯¹åº”çš„ç»çº¬åº¦ï¼Œç„¶åè°ƒç”¨è·å–å¤©æ°”æ•°æ® API å³å¯ã€‚</p><p class=ql-align-justify>è¿”å›çš„æ•°æ®æ ¼å¼ä¸ºï¼š</p><pre class=ql-align-justify>{ "status":0, "result":{ "location":{ "lng":117.21081309155257, "lat":39.143929903310074 }, "precise":0, "confidence":12, "level":"åŸå¸‚" }}</pre><p class=ql-align-justify>ç„¶åç›´æ¥è°ƒç”¨è·å–å¤©æ°” API å³å¯ã€‚å…·ä½“ä»£ç å¯å‚è€ƒæ–‡æœ«ã€‚</p><p class=ql-align-justify><strong>æœç´¢åŠ¨ç”»å½©è›‹</strong></p><p class=ql-align-justify>åœ¨æœç´¢æ¡†é‡Œæœç´¢ 520 æˆ– 521ï¼Œä¼šå‡ºç°ä»é¡¶éƒ¨ä¸‹å°å¿ƒå¿ƒçš„åŠ¨ç”»ï¼Œå¦‚ä¸‹ï¼š</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=å¦‚ä½•ä»é›¶å¼€å§‹ä¸¤å¤©æ’¸ä¸€ä¸ªå¾®ä¿¡å°ç¨‹åºï¼Ÿï¼ï¼ˆå†…å«æºç ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b85447de037b4fc8a00be1ae29d1d0a0><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>åªéœ€åˆ›å»ºäº†ä¸€ä¸ª heartbeat çš„ç»„ä»¶ã€‚wxml ç»“æ„æ˜¯éå†æ•°ç»„ï¼Œåˆ›å»ºå¤šä¸ªå¤§å°ã€ä½ç½®éšæœºçš„å›¾ç‰‡ï¼š</p><pre class=ql-align-justify>&lt;image wx:for='{{arr}}' wx:key='{{index}}' animation='{{animations[index]}}' class='heart' style='left:{{lefts[index]}}px;top:{{tops[index]}}px;width:{{widths[index]}}rpx;height:{{widths[index]}}rpx;' src='../../img/heartbeat.png'&gt;&lt;/image&gt;</pre><p class=ql-align-justify>ç„¶åä½¿ç”¨çš„æ˜¯å°ç¨‹åºæä¾›çš„ wx.createAnimationï¼ŒåŠ¨ç”»çš„ä½¿ç”¨æ¯”è¾ƒç®€å•ï¼Œåˆ›å»ºåŠ¨ç”»ï¼Œç„¶åèµ‹äºˆ animation å±æ€§å³å¯ï¼Œæ¯”è¾ƒç®€å•ã€‚</p><p class=ql-align-justify>ä½†æ˜¯ä¹Ÿæœ‰å±€é™æ€§ï¼Œæ¯”å¦‚æ²¡æœ‰ç›´æ¥çš„åŠ¨ç”»ç»“æŸåçš„å›è°ƒï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ setTimeout æ¥å®ç°ç­‰ã€‚è¿™é‡Œä¼šç”¨åˆ°å¯ç”¨çª—å£å®½é«˜ï¼Œå› ä¸ºå¤šå¤„ç”¨åˆ°äº†è¯¥å‚æ•°ï¼Œæ‰€ä»¥åœ¨ app.js é‡Œé¢å¼‚æ­¥è·å–äº†å…ˆã€‚</p><p class=ql-align-justify>åŠ¨ç”»ä»£ç å¦‚ä¸‹ï¼š</p><pre class=ql-align-justify>dance (callback) { let windowWidth = this.data.windowWidth let windowHeight = this.data.windowHeight let duration = this.data.duration let animations = [] let lefts = [] let tops = [] let widths = [] let obj = {} for (let i = 0; i &lt; this.data.arr.length; i++) { lefts.push(Math.random() * windowWidth) tops.push(-140) widths.push(Math.random() * 50 + 40) let animation = wx.createAnimation({ duration: Math.random() * (duration - 1000) + 1000 }) animation.top(windowHeight).left(Math.random() * windowWidth).rotate(Math.random() * 960).step() animations.push(animation.export()) } this.setData({ lefts, tops, widths, }) let that = this let timer = setTimeout(() =&gt; { that.setData({ animations, }) clearTimeout(timer) }, 200) let end = setTimeout(() =&gt; { callback &amp;&amp; callback() clearTimeout(end) }, duration) },},</pre><p class=ql-align-justify>é¦–é¡µæœç´¢ç‰¹å®šå…³é”®è¯åï¼Œè°ƒç”¨ç»„ä»¶ dance æ–¹æ³•å³è§¦å‘å°å¿ƒå¿ƒåŠ¨ç”»ã€‚</p><p class=ql-align-justify><strong>æ‚¬æµ®çƒèœå•</strong></p><p class=ql-align-justify>å±å¹•å³ä¸‹è§’çš„æ‚¬æµ®çƒæä¾›äº†ä¸‰ä¸ªé¡µé¢çš„å…¥å£ï¼šåŸå¸‚é€‰æ‹©é¡µã€è®¾ç½®é¡µã€å…³äºé¡µã€‚èœå•å¼¹å‡ºã€æ”¶å›ä¼šæœ‰åŠ¨ç”»ã€‚</p><p class=ql-align-justify>è¿™é‡Œçš„åŠ¨ç”»åˆ†ä¸ºå¼¹å‡ºå’Œæ”¶èµ·ï¼Œä¸¤è€…å†™èµ·æ¥åŸºæœ¬ä¸Šä¸€æ ·çš„ï¼Œåªæ˜¯åŠ¨ç”»çš„å‚æ•°ä¸ä¸€æ ·ã€‚è¿™é‡Œè´´å‡ºå¼¹å‡ºçš„åŠ¨ç”»ï¼š</p><pre class=ql-align-justify>// wxml&lt;!-- æ‚¬æµ®èœå• --&gt;&lt;view class='menus'&gt; &lt;image src="../../img/location.png" animation="{{animationOne}}" class="menu" bindtap="menuOne" style='top:{{pos.top}}px;left:{{pos.left}}px;'&gt;&lt;/image&gt; &lt;image src="../../img/setting.png" animation="{{animationTwo}}" class="menu" bindtap="menuTwo" style='top:{{pos.top}}px;left:{{pos.left}}px;'&gt;&lt;/image&gt; &lt;image src="../../img/info.png" animation="{{animationThree}}" class="menu" bindtap="menuThree" style='top:{{pos.top}}px;left:{{pos.left}}px;'&gt;&lt;/image&gt; &lt;image src="../../img/menu.png" animation="{{animationMain}}" class="menu main" bindtap="menuMain" catchtouchmove='menuMainMove' style='top:{{pos.top}}px;left:{{pos.left}}px;'&gt;&lt;/image&gt;&lt;/view&gt;// jspopp() { let animationMain = wx.createAnimation({ duration: 200, timingFunction: 'ease-out' }) let animationOne = wx.createAnimation({ duration: 200, timingFunction: 'ease-out' }) let animationTwo = wx.createAnimation({ duration: 200, timingFunction: 'ease-out' }) let animationThree = wx.createAnimation({ duration: 200, timingFunction: 'ease-out' }) animationMain.rotateZ(180).step() animationOne.translate(-50, -60).rotateZ(360).opacity(1).step() animationTwo.translate(-90, 0).rotateZ(360).opacity(1).step() animationThree.translate(-50, 60).rotateZ(360).opacity(1).step() this.setData({ animationMain: animationMain.export(), animationOne: animationOne.export(), animationTwo: animationTwo.export(), animationThree: animationThree.export(), })},</pre><p class=ql-align-justify>æ‚¬æµ®èœå•æ˜¯å¯ä»¥åœ¨å±å¹•ä¸Šéšæ„æ»‘åŠ¨çš„ï¼Œæ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œç›‘å¬ touchmove äº‹ä»¶å³å¯ï¼Œå› ä¸ºèœå•å±•å¼€æ–¹å‘æ˜¯åœ¨å·¦è¾¹ï¼Œæ‰€ä»¥æ‚¬æµ®èœå•èƒ½å¾€å·¦è¾¹ç§»åŠ¨çš„æœ€è¿œè·ç¦»è¦æœ‰ä¸€æ®µé—´éš”ï¼Œå¦åˆ™å±•å¼€çš„èœå•å°±è¿›å…¥å·¦è¾¹å±å¹•äº†ï¼Œç§»åŠ¨åˆ°ä¸Šæ–¹åŒæ ·é€»è¾‘ï¼ˆåæœŸå¯ä»¥æ”¹æˆèœå•å±•å¼€æ–¹å‘éšç§»åŠ¨è€Œæ”¹å˜ï¼Œè€Œä¸æ˜¯ä¸€å‘³åœ¨å·¦è¾¹å±•å¼€ï¼‰ã€‚</p><p class=ql-align-justify><strong>åŸå¸‚é€‰æ‹©é¡µ</strong></p><p class=ql-align-justify>åŸå¸‚é€‰æ‹©é¡µé¢å°±æ˜¯ä¸€ä¸ªåŸå¸‚åˆ—è¡¨ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=å¦‚ä½•ä»é›¶å¼€å§‹ä¸¤å¤©æ’¸ä¸€ä¸ªå¾®ä¿¡å°ç¨‹åºï¼Ÿï¼ï¼ˆå†…å«æºç ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/cf1b6b0deb3f48c9b8021ba87aff7601><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>ç‚¹å‡»ç›¸åº”çš„åŸå¸‚ï¼Œè·³è½¬åˆ°é¦–é¡µè·å–æ‰€é€‰åŸå¸‚çš„å¤©æ°”æ•°æ®ã€‚è¿™é‡Œçš„åŸå¸‚æ•°æ®æ˜¯è¿™æ ·çš„æ ¼å¼æ— åºçš„åˆ—è¡¨ï¼š</p><pre>{ "letter": "B", "name": "åŒ—äº¬å¸‚" }</pre><p class=ql-align-justify>å› ä¸ºéœ€è¦æŒ‰ç…§å­—æ¯æ’åˆ—è¿›è¡Œæ’åºï¼Œæ‰€ä»¥éœ€è¦å…ˆæ’åºå†éå†ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre class=ql-align-justify>// æŒ‰ç…§å­—æ¯é¡ºåºç”Ÿæˆéœ€è¦çš„æ•°æ®æ ¼å¼getSortedAreaObj(areas) { // let areas = staticData.areas areas = areas.sort((a, b) =&gt; { if (a.letter &gt; b.letter) { return 1 } if (a.letter &lt; b.letter) { return -1 } return 0 }) let obj = {} for (let i = 0, len = areas.length; i &lt; len; i++) { let item = areas[i] delete item.districts let letter = item.letter if (!obj[letter]) { obj[letter] = [] } obj[letter].push(item) } // è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œç›´æ¥ç”¨ wx:for æ¥éå†å¯¹è±¡ï¼Œindex ä¸º keyï¼Œitem ä¸º valueï¼Œitem æ˜¯ä¸€ä¸ªæ•°ç»„ return obj},</pre><p class=ql-align-justify>ç‚¹å‡»åŸå¸‚åï¼Œéœ€è¦é€šçŸ¥é¦–é¡µâ€œæˆ‘å·²ç»åˆ‡æ¢åŸå¸‚äº†ï¼Œéº»çƒ¦è·å–ä¸‹è¿™ä¸ªåŸå¸‚çš„æ•°æ®è°¢è°¢â€ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ä½¿ç”¨ getCurrentPages è·å–é¡µé¢å †æ ˆï¼Œä¿®æ”¹é¦–é¡µæ•°æ®çš„æ–¹å¼ã€‚</p><p class=ql-align-justify><strong>å…³äºé¡µ</strong></p><p class=ql-align-justify>å…³äºé¡µæ˜¯ä¸€ä¸ªå±•ç¤ºé¡µï¼Œæ²¡æœ‰å¤šå°‘äº¤äº’ï¼Œä½¿ç”¨åˆ°çš„ API åªæœ‰å¤åˆ¶åˆ°å‰ªåˆ‡æ¿ wx.setClipboardDataã€‚â€œå¾®ä¿¡å¿«é€Ÿè”ç³»â€ä½¿ç”¨çš„æ˜¯å°ç¨‹åºæä¾›çš„è”ç³»å®¢æœçš„æ–¹å¼ã€‚æœ‰ç²¾åŠ›çš„è¯ï¼Œå¯ä»¥è‡ªå·±æ­å»ºæœåŠ¡ï¼Œå°†å°ç¨‹åºçš„æ¶ˆæ¯ Push åˆ°è‡ªå·±çš„æœåŠ¡ä¸Šå»ã€‚æ•ˆæœå›¾ï¼š</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=å¦‚ä½•ä»é›¶å¼€å§‹ä¸¤å¤©æ’¸ä¸€ä¸ªå¾®ä¿¡å°ç¨‹åºï¼Ÿï¼ï¼ˆå†…å«æºç ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/dac47eac6e99450295b73b05ef9f88b2><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><strong>è®¾ç½®é¡µ</strong></p><p class=ql-align-justify>è®¾ç½®é¡µçš„åŠŸèƒ½çœ‹ç€æœ‰ç‚¹å¤šï¼Œå…¶å®å¹¶ä¸å¤šï¼Œåªæ˜¯ä¸€å † API çš„è°ƒç”¨ã€‚è¿™ä¸ªé¡µé¢åˆ†äº†è‡ªå®šä¹‰ã€æ£€æŸ¥æ›´æ–°ã€å°å·¥å…·ã€æ¸…é™¤æ•°æ®ä¸‰ä¸ªéƒ¨åˆ†ã€‚å„ä¸ªè®¾ç½®å‚æ•°ä¿å­˜åœ¨ Storage ä¸­ã€‚ä¸€ä¸ªä¸€ä¸ªæ¥è¯´ã€‚</p><p class=ql-align-justify><strong>1. è‡ªå®šä¹‰</strong></p><ul><li class=ql-align-justify>è‡ªå®šä¹‰é¦–é¡µèƒŒæ™¯</li></ul><p class=ql-align-justify>è‡ªå®šä¹‰èƒŒæ™¯æ˜¯å°†é€‰å–çš„å›¾ç‰‡ï¼ˆwx.chooseImageï¼‰ä¿å­˜ï¼ˆwx.saveFileï¼‰åˆ°æœ¬åœ°ï¼Œç„¶åé¦–é¡µè·å–ï¼ˆwx.getSavedFileListï¼‰ä¿å­˜çš„å›¾ç‰‡ï¼Œåœ¨é¦–é¡µå±•ç¤ºå‡ºæ¥å³å¯ã€‚</p><p class=ql-align-justify>é•¿æŒ‰åˆ é™¤ï¼Œåˆ™æ˜¯è·å–ï¼ˆwx.getSavedFileListï¼‰ä¿å­˜çš„å›¾ç‰‡ï¼Œç„¶å wx.removeSavedFile æ‰å³å¯ã€‚ç°åœ¨è®¾ç½®çš„æ˜¯æœ¬åœ°åªä¿å­˜ä¸€å¼ å›¾ç‰‡ï¼Œæ‰€ä»¥é‡æ–°è®¾ç½®å…¶ä»–èƒŒæ™¯æ—¶ï¼Œä¼šåˆ é™¤ä¸Šä¸€å¼ èƒŒæ™¯å›¾ï¼Œç„¶åé‡æ–°ä¿å­˜æ–°èƒŒæ™¯å›¾ã€‚</p><ul><li class=ql-align-justify>æ‰“å¼€é¡¶éƒ¨åŸå¸‚å¤©æ°”å¿«æ·æœç´¢</li></ul><p class=ql-align-justify>è¯¥æ“ä½œåªæ˜¯å°†é¦–é¡µçš„é¡¶éƒ¨æœç´¢ wx:if æ‰è€Œå·²ã€‚switch ç»„ä»¶çš„æ ·å¼å¯ä»¥é€šè¿‡ä¿®æ”¹é»˜è®¤çš„ç±»æ¥ä¿®æ”¹ï¼Œè°ƒä¸€ä¸ªè‡ªå·±æ»¡æ„çš„å³å¯ã€‚</p><pre>.wx-switch-input{width:84rpx !important;height:43rpx !important;}.wx-switch-input::before{width:82rpx !important;height: 38rpx !important;}.wx-switch-input::after{width: 38rpx !important;height: 38rpx !important;}</pre><ul><li class=ql-align-justify>æ˜¾ç¤ºç”Ÿæ´»æŒ‡æ•°ä¿¡æ¯</li></ul><p class=ql-align-justify>åŒæ · wx:if ã€‚</p><ul><li class=ql-align-justify>æ£€æŸ¥æ›´æ–°</li></ul><p class=ql-align-justify>æ£€æŸ¥æ›´æ–°é»˜è®¤å…³é—­ã€‚å°ç¨‹åºçš„æ›´æ–°æ˜¯åœ¨å†·å¯åŠ¨æ—¶å»æ£€æŸ¥ï¼Œå¦‚æœæœ‰æ–°ç‰ˆæœ¬ä¼šå¼‚æ­¥ä¸‹è½½ï¼Œå†æ¬¡å†·å¯åŠ¨æ—¶ä¼šåŠ è½½æ–°ç‰ˆæœ¬ã€‚è¿™é‡Œä½¿ç”¨ wx.getUpdateManagerï¼Œå› ä¸ºè¯¥ API åŸºç¡€åº“æ”¯æŒæœ€ä½ç‰ˆæœ¬æ˜¯ 1.9.90ï¼ŒåŸºç¡€åº“ç‰ˆæœ¬ä½çš„ä¼šæç¤ºä¸æ”¯æŒï¼Œæ˜¾ç¤ºçš„æ–‡æ¡ˆä¹Ÿä¼šç›¸åº”ä¿®æ”¹ã€‚</p><ul><li class=ql-align-justify>å°å·¥å…·</li></ul><p class=ql-align-justify>1ï¼‰NFC</p><p class=ql-align-justify>ä½¿ç”¨ wx.getHCEStateã€‚</p><p class=ql-align-justify>2ï¼‰å±å¹•äº®åº¦</p><p class=ql-align-justify>è·å–å±å¹•äº®åº¦ã€è®¾ç½®å±å¹•äº®åº¦ã€ä¿æŒå¸¸äº®ä½¿ç”¨çš„ API åˆ†åˆ«æ˜¯ wx.getScreenBrightnessã€wx.setScreenBrightnessã€wx.setKeepScreenOnã€‚å®Œæ•´å®ç°å¯æŸ¥çœ‹æºç ã€‚</p><p class=ql-align-justify>3ï¼‰ç³»ç»Ÿä¿¡æ¯</p><p class=ql-align-justify>ç³»ç»Ÿä¿¡æ¯ä¼šè·³è½¬åˆ°æ–°é¡µé¢ã€‚</p><ul><li class=ql-align-justify>æ¸…é™¤æ•°æ®</li></ul><p class=ql-align-justify>1ï¼‰é¦–é¡µæ‚¬æµ®çƒå¤ä½</p><p class=ql-align-justify>é¦–é¡µæ‚¬æµ®çƒçš„ä½ç½®ä¿¡æ¯æ˜¯ä¿å­˜æœ¬åœ°çš„å˜é‡ posï¼Œå¤ä½ä½ç½®ï¼Œæ¸…é™¤ pos å³å¯ã€‚</p><p class=ql-align-justify>2ï¼‰æ¢å¤åˆå§‹åŒ–è®¾ç½®</p><p class=ql-align-justify>è®¾ç½®ä¿¡æ¯æ˜¯ä¿å­˜æœ¬åœ°çš„å˜é‡ settingï¼Œå¤ä½ä½ç½®ï¼Œæ¸…é™¤ setting å³å¯ã€‚</p><p class=ql-align-justify>3ï¼‰æ¸…é™¤æ‰€æœ‰æœ¬åœ°æ•°æ®</p><p class=ql-align-justify>wx.clearStorage å³å¯ã€‚</p><p class=ql-align-justify>æ•ˆæœå›¾ï¼š</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=å¦‚ä½•ä»é›¶å¼€å§‹ä¸¤å¤©æ’¸ä¸€ä¸ªå¾®ä¿¡å°ç¨‹åºï¼Ÿï¼ï¼ˆå†…å«æºç ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ca0a247b27c74061b90d37bcd83f3bd2><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><blockquote>æºç åœ°å€ï¼šhttps://github.com/myvin/quietweatheråŸæ–‡é“¾æ¥ï¼šhttps://juejin.im/post/5b39bbcc5188252ce018c745<br></blockquote></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'é›¶å¼€å§‹','ä¸¤å¤©','ä¸€ä¸ª'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>