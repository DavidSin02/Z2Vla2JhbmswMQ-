<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Java ä»£ç ç•Œ 3% çš„ç‹è€…ï¼Ÿçœ‹æˆ‘æ˜¯å¦‚ä½•è§£é”™è¿™ 5 é“é¢˜çš„ | æå®¢å¿«è¨Š</title><meta property="og:title" content="Java ä»£ç ç•Œ 3% çš„ç‹è€…ï¼Ÿçœ‹æˆ‘æ˜¯å¦‚ä½•è§£é”™è¿™ 5 é“é¢˜çš„ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/ecee78fc812b4f9f91de26268c1e1e89"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4768eb47.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4768eb47.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4768eb47.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4768eb47.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4768eb47.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4768eb47.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4768eb47.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4768eb47.html><meta property="article:published_time" content="2020-11-14T21:00:51+08:00"><meta property="article:modified_time" content="2020-11-14T21:00:51+08:00"><meta name=Keywords content><meta name=description content="Java ä»£ç ç•Œ 3% çš„ç‹è€…ï¼Ÿçœ‹æˆ‘æ˜¯å¦‚ä½•è§£é”™è¿™ 5 é“é¢˜çš„"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/4768eb47.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Java ä»£ç ç•Œ 3% çš„ç‹è€…ï¼Ÿçœ‹æˆ‘æ˜¯å¦‚ä½•è§£é”™è¿™ 5 é“é¢˜çš„</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><div class=pgc-img><img alt="Java ä»£ç ç•Œ 3% çš„ç‹è€…ï¼Ÿçœ‹æˆ‘æ˜¯å¦‚ä½•è§£é”™è¿™ 5 é“é¢˜çš„" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ecee78fc812b4f9f91de26268c1e1e89><p class=pgc-img-caption></p></div><h1>å¼•è¨€</h1><p>å‰äº›æ—¥å­ï¼Œé˜¿é‡Œå¦¹ï¼ˆå¦¹å­å‡ºé¢˜ä¹Ÿè¿™ä¹ˆéš¾ï¼‰å‘è¡¨äº†ä¸€ç¯‡æ–‡ç« ã€Šæ‚¬èµå¾é›†ï¼5 é“é¢˜å¾é›†ä»£ç ç•Œå‰ 3% çš„è¶…çº§ç‹è€…ã€‹â€”â€”çœ‹åˆ°è¿™ä¸ªæ ‡é¢˜ï¼Œæˆ‘å†…å¿ƒéå¸¸éå¸¸æ¿€åŠ¨ï¼Œå› ä¸ºç»ˆäºå¯ä»¥è¯æ˜è‡ªå·±æŠ€æœ¯å¾ˆç‰›é€¼äº†ã€‚</p><p>ä½†é—æ†¾çš„æ˜¯ï¼Œå‡­å€Ÿ 8 å¹´çš„ Java å¼€å‘ç»éªŒï¼Œæˆ‘å‘ç°è¿™äº”é“é¢˜è‡ªå·±å…¨è§£é”™äº†ï¼æƒ¨ç—›çš„æ•™è®­å†æ¬¡è¯æ˜ï¼Œæˆ‘æ˜¯é‚£è¢«ç§’æ€çš„ 97% çš„å·¥ç¨‹å¸ˆä¹‹ä¸€ã€‚</p><p>ä¸è¿‡ï¼Œå¥½æ­¹æˆ‘è¿™äººè„¸çš®ç‰¹åˆ«åšï¼Œè™½ç„¶å…¨éƒ½åšé”™äº†ï¼Œä½†è¿˜æ˜¯æ•¢æ–¼å¦ç„¶åœ°é¢å¯¹è‡ªå·±ã€‚</p><p><strong>01ã€åŸå§‹ç±»å‹çš„ float</strong></p><p>ç¬¬ä¸€é¢˜æ˜¯è¿™æ ·çš„ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre>public class FloatPrimitiveTest { public static void main(String[] args) { float a = 1.0f - 0.9f; float b = 0.9f - 0.8f; if (a == b) { System.out.println("true"); } else { System.out.println("false"); } }}</pre><p>ä¹ä¸€çœ‹ï¼Œè¿™é“é¢˜ä¹Ÿå¤ªç®€å•äº†å§ï¼Ÿ</p><p>1.0f - 0.9f çš„ç»“æœä¸º 0.1fï¼Œ0.9f - 0.8f çš„ç»“æœä¸º 0.1fï¼Œé‚£è‡ªç„¶ a == b å•Šã€‚</p><p>ä½†å®é™…çš„ç»“æœç«Ÿç„¶ä¸æ˜¯è¿™æ ·çš„ï¼Œå¤ªä¼¤è‡ªå°Šäº†ã€‚</p><pre>float a = 1.0f - 0.9f;System.out.println(a); // 0.100000024float b = 0.9f - 0.8f;System.out.println(b); // 0.099999964</pre><p>åŠ ä¸Šä¸¤æ¡æ‰“å°è¯­å¥åï¼Œæˆ‘æ˜ç™½äº†ï¼ŒåŸæ¥å‘ç”Ÿäº†ç²¾åº¦é—®é¢˜ã€‚</p><p>Java è¯­è¨€æ”¯æŒä¸¤ç§åŸºæœ¬çš„æµ®ç‚¹ç±»å‹ï¼š float å’Œ double ï¼Œä»¥åŠä¸å®ƒä»¬å¯¹åº”çš„åŒ…è£…ç±» Float å’Œ Double ã€‚å®ƒä»¬éƒ½ä¾æ® IEEE 754 æ ‡å‡†ï¼Œè¯¥æ ‡å‡†ç”¨ç§‘å­¦è®°æ•°æ³•ä»¥åº•æ•°ä¸º 2 çš„å°æ•°æ¥è¡¨ç¤ºæµ®ç‚¹æ•°ã€‚</p><p>ä½†æµ®ç‚¹è¿ç®—å¾ˆå°‘æ˜¯ç²¾ç¡®çš„ã€‚è™½ç„¶ä¸€äº›æ•°å­—å¯ä»¥ç²¾ç¡®åœ°è¡¨ç¤ºä¸ºäºŒè¿›åˆ¶å°æ•°ï¼Œæ¯”å¦‚è¯´ 0.5ï¼Œå®ƒç­‰äº 2<sup>-1</sup>ï¼›ä½†æœ‰äº›æ•°å­—åˆ™ä¸èƒ½ç²¾ç¡®çš„è¡¨ç¤ºï¼Œæ¯”å¦‚è¯´ 0.1ã€‚å› æ­¤ï¼Œæµ®ç‚¹è¿ç®—å¯èƒ½ä¼šå¯¼è‡´èˆå…¥è¯¯å·®ï¼Œäº§ç”Ÿçš„ç»“æœæ¥è¿‘ä½†å¹¶ä¸ç­‰äºæˆ‘ä»¬å¸Œæœ›çš„ç»“æœã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬çœ‹åˆ°äº† 0.1 çš„ä¸¤ä¸ªç›¸è¿‘çš„æµ®ç‚¹å€¼ï¼Œä¸€ä¸ªæ˜¯æ¯” 0.1 ç•¥å¾®å¤§äº†ä¸€ç‚¹ç‚¹çš„ 0.100000024ï¼Œä¸€ä¸ªæ˜¯æ¯” 0.1 ç•¥å¾®å°äº†ä¸€ç‚¹ç‚¹çš„ 0.099999964ã€‚</p><p>Java å¯¹äºä»»æ„ä¸€ä¸ªæµ®ç‚¹å­—é¢é‡ï¼Œæœ€ç»ˆéƒ½èˆå…¥åˆ°æ‰€èƒ½è¡¨ç¤ºçš„æœ€é è¿‘çš„é‚£ä¸ªæµ®ç‚¹å€¼ï¼Œé‡åˆ°è¯¥å€¼ç¦»å·¦å³ä¸¤ä¸ªèƒ½è¡¨ç¤ºçš„æµ®ç‚¹å€¼è·ç¦»ç›¸ç­‰æ—¶ï¼Œé»˜è®¤é‡‡ç”¨å¶æ•°ä¼˜å…ˆçš„åŸåˆ™â€”â€”è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸¤ä¸ªéƒ½ä»¥ 4 ç»“å°¾çš„æµ®ç‚¹å€¼çš„åŸå› ã€‚</p><p><strong>02ã€åŒ…è£…å™¨ç±»å‹ Float</strong></p><p>å†æ¥çœ‹ç¬¬äºŒé¢˜ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre>public class FloatWrapperTest { public static void main(String[] args) { Float a = Float.valueOf(1.0f - 0.9f); Float b = Float.valueOf(0.9f - 0.8f); if (a.equals(b)) { System.out.println("true"); } else { System.out.println("false"); } }}</pre><p>ä¹ä¸€çœ‹ï¼Œè¿™é“é¢˜ä¹Ÿä¸éš¾ï¼Œå¯¹å§ï¼Ÿæ— éæ˜¯æŠŠåŸå§‹ç±»å‹çš„ float è½¬æˆäº†åŒ…è£…å™¨ç±»å‹ Floatï¼Œå¹¶ä¸”ä½¿ç”¨ equals æ›¿ä»£ == è¿›è¡Œåˆ¤æ–­ã€‚</p><p>è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¥ä¸ºåŒ…è£…å™¨ä¼šè§£å†³æ‰ç²¾åº¦çš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘çŒœæƒ³è¾“å‡ºç»“æœä¸º trueã€‚ä½†ç»“æœå†æ¬¡æ‰“è„¸â€”â€”è™½ç„¶æˆ‘è„¸çš®åšï¼Œä½†ä»ç„¶èƒ½æ„Ÿè§‰åˆ°è„¸æœ‰äº›å¾®å¾®çš„çº¢äº†èµ·æ¥ã€‚</p><pre>Float a = Float.valueOf(1.0f - 0.9f);System.out.println(a); // 0.100000024Float b = Float.valueOf(0.9f - 0.8f);System.out.println(b); // 0.099999964</pre><p>åŠ ä¸Šä¸¤æ¡æ‰“å°è¯­å¥åï¼Œæˆ‘æ˜ç™½äº†ï¼ŒåŸæ¥åŒ…è£…å™¨å¹¶ä¸ä¼šè§£å†³ç²¾åº¦çš„é—®é¢˜ã€‚</p><pre>private final float value;public Float(float value) { this.value = value;}public static Float valueOf(float f) { return new Float(f);}public boolean equals(Object obj) { return (obj instanceof Float) &amp;&amp; (floatToIntBits(((Float)obj).value) == floatToIntBits(value));}</pre><p>ä»æºç å¯ä»¥çœ‹å¾—å‡ºæ¥ï¼ŒåŒ…è£…å™¨ Float çš„ç¡®æ²¡æœ‰å¯¹ç²¾åº¦åšä»»ä½•å¤„ç†ï¼Œå†µä¸” equals æ–¹æ³•çš„å†…éƒ¨ä»ç„¶ä½¿ç”¨äº† == è¿›è¡Œåˆ¤æ–­ã€‚</p><p><strong>03ã€switch åˆ¤æ–­ null å€¼çš„å­—ç¬¦ä¸²</strong></p><p>æ¥çœ‹ç¬¬ä¸‰é¢˜ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre>public class SwitchTest { public static void main(String[] args) { String param = null; switch (param) { case "null": System.out.println("null"); break; default: System.out.println("default"); } }}</pre><p>è¿™é“é¢˜å°±æœ‰ç‚¹ä»¤æˆ‘é›¾é‡Œçœ‹èŠ±äº†ã€‚</p><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œswitch æ˜¯ä¸€ç§é«˜æ•ˆçš„åˆ¤æ–­è¯­å¥ï¼Œæ¯”èµ· if/else çœŸçš„æ˜¯çˆ½å¿«å¤šäº†ã€‚å°¤å…¶æ˜¯ JDK 1.7 ä¹‹åï¼Œswitch çš„ case æ¡ä»¶å¯ä»¥æ˜¯ char, byte, short, int, Character, Byte, Short, Integer, String, æˆ–è€… enum ç±»å‹ã€‚</p><p>æœ¬é¢˜ä¸­ï¼Œparam ç±»å‹ä¸º Stringï¼Œé‚£ä¹ˆæˆ‘è®¤ä¸ºæ˜¯å¯ä»¥ä½œä¸º switch çš„ case æ¡ä»¶çš„ï¼Œä½† param çš„å€¼ä¸º nullï¼Œnull å’Œ "null" è‚¯å®šæ˜¯ä¸åŒ¹é…çš„ï¼Œæˆ‘è®¤ä¸ºç¨‹åºåº”è¯¥è¿›å…¥åˆ° default è¯­å¥è¾“å‡º defaultã€‚</p><p>ä½†ç»“æœå†æ¬¡æ‰“è„¸ï¼ç¨‹åºæŠ›å‡ºäº†å¼‚å¸¸ï¼š</p><pre>Exception in thread "main" java.lang.NullPointerException at com.cmower.java_demo.Test.main(Test.java:7)</pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œswitch () çš„æ‹¬å·ä¸­ä¸å…è®¸ä¼ å…¥ nullã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æˆ‘ç¿»äº†ç¿» JDK çš„å®˜æ–¹æ–‡æ¡£ï¼Œçœ‹åˆ°å…¶ä¸­æœ‰è¿™æ ·ä¸€å¥æè¿°ï¼Œæˆ‘ç›´æ¥æ¬è¿‡æ¥å¤§å®¶çœ‹ä¸€çœ¼å°±æ˜ç™½äº†ã€‚</p><blockquote><p>When the switch statement is executed, first the Expression is evaluated. If the Expression evaluates to null, a NullPointerException is thrown and the entire switch statement completes abruptly for that reason. Otherwise, if the result is of a reference type, it is subject to unboxing conversion.</p></blockquote><p>å¤§è‡´çš„æ„æ€å°±æ˜¯è¯´ï¼Œswitch è¯­å¥æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šå…ˆæ‰§è¡Œ switch () è¡¨è¾¾å¼ï¼Œå¦‚æœè¡¨è¾¾å¼çš„å€¼ä¸º nullï¼Œå°±ä¼šæŠ›å‡º NullPointerExceptionå¼‚å¸¸ã€‚</p><p>é‚£åˆ°åº•æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><pre>public static void main(String args[]){ String param = null; String s; switch((s = param).hashCode()) { case 3392903:  if(s.equals("null")) { System.out.println("null"); break; } // fall through default: System.out.println("default"); break; }}</pre><p>å€ŸåŠ© jadï¼Œæˆ‘ä»¬æ¥åç¼–è¯‘ä¸€ä¸‹ switch çš„å­—èŠ‚ç ï¼Œç»“æœå¦‚ä¸Šæ‰€ç¤ºã€‚åŸæ¥ switch () è¡¨è¾¾å¼å†…éƒ¨æ‰§è¡Œçš„ç«Ÿç„¶æ˜¯ (s = param).hashCode()ï¼Œå½“ param ä¸º null çš„æ—¶å€™ï¼Œs ä¹Ÿä¸º nullï¼Œè°ƒç”¨ hashCode() æ–¹æ³•çš„æ—¶å€™è‡ªç„¶ä¼šæŠ›å‡º NullPointerException äº†ã€‚</p><p><strong>04ã€BigDecimal çš„èµ‹å€¼æ–¹å¼</strong></p><p>æ¥çœ‹ç¬¬å››é¢˜ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre>public class BigDecimalTest { public static void main(String[] args) { BigDecimal a = new BigDecimal(0.1); System.out.println(a); BigDecimal b = new BigDecimal("0.1"); System.out.println(b); }}</pre><p>è¿™é“é¢˜çœŸä¸éš¾ï¼Œa å’Œ b çš„å”¯ä¸€åŒºåˆ«å°±åœ¨äº a åœ¨è°ƒç”¨ BigDecimal æ„é€ æ–¹æ³•èµ‹å€¼çš„æ—¶å€™ä¼ å…¥äº†æµ®ç‚¹æ•°ï¼Œè€Œ b ä¼ å…¥äº†å­—ç¬¦ä¸²ï¼Œa å’Œ b çš„ç»“æœåº”è¯¥éƒ½ä¸º 0.1ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºè¿™ä¸¤ç§èµ‹å€¼æ–¹å¼æ˜¯ä¸€æ ·çš„ã€‚</p><p>ä½†å®é™…ä¸Šï¼Œè¾“å‡ºç»“æœå®Œå…¨å‡ºä¹æˆ‘çš„æ„æ–™ï¼š</p><pre>BigDecimal a = new BigDecimal(0.1);System.out.println(a); // 0.1000000000000000055511151231257827021181583404541015625BigDecimal b = new BigDecimal("0.1");System.out.println(b); // 0.1</pre><p>è¿™ç©¶ç«Ÿåˆæ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p><p>è¿™å°±å¿…é¡»çœ‹å®˜æ–¹æ–‡æ¡£äº†ï¼Œæ˜¯æ—¶å€™æ¬å‡º BigDecimal(double val) çš„ JavaDoc é•‡æ¥¼äº†ã€‚</p><ol><li>The results of this constructor can be somewhat unpredictable. One might assume that writing new BigDecimal(0.1) in Java creates a BigDecimal which is exactly equal to 0.1 (an unscaled value of 1, with a scale of 1), but it is actually equal to 0.1000000000000000055511151231257827021181583404541015625. This is because 0.1 cannot be represented exactly as a double (or, for that matter, as a binary fraction of any finite length). Thus, the value that is being passed in to the constructor is not exactly equal to 0.1, appearances notwithstanding.</li></ol><p>è§£é‡Šï¼šä½¿ç”¨ double ä¼ å‚çš„æ—¶å€™ä¼šäº§ç”Ÿä¸å¯é¢„æœŸçš„ç»“æœï¼Œæ¯”å¦‚è¯´ 0.1 å®é™…çš„å€¼æ˜¯ 0.1000000000000000055511151231257827021181583404541015625ï¼Œè¯´ç™½äº†ï¼Œè¿™è¿˜æ˜¯ç²¾åº¦çš„é—®é¢˜ã€‚ï¼ˆæ—¢ç„¶å¦‚æ­¤ï¼Œä¸ºä»€ä¹ˆä¸åºŸå¼ƒå‘¢ï¼Ÿï¼‰</p><ol><li>The String constructor, on the other hand, is perfectly predictable: writing new BigDecimal("0.1") creates a BigDecimal which is exactly equal to 0.1, as one would expect. Therefore, it is generally recommended that the String constructor be used in preference to this one.</li></ol><p>è§£é‡Šï¼šä½¿ç”¨å­—ç¬¦ä¸²ä¼ å‚çš„æ—¶å€™ä¼šäº§ç”Ÿé¢„æœŸçš„ç»“æœï¼Œæ¯”å¦‚è¯´ new BigDecimal("0.1") çš„å®é™…ç»“æœå°±æ˜¯ 0.1ã€‚</p><ol><li>When a double must be used as a source for a BigDecimal, note that this constructor provides an exact conversion; it does not give the same result as converting the double to a String using the Double.toString(double) method and then using the BigDecimal(String) constructor. To get that result, use the static valueOf(double) method.</li></ol><p>è§£é‡Šï¼šå¦‚æœå¿…é¡»å°†ä¸€ä¸ª double ä½œä¸ºå‚æ•°ä¼ é€’ç»™ BigDecimal çš„è¯ï¼Œå»ºè®®ä¼ é€’è¯¥ double å€¼åŒ¹é…çš„å­—ç¬¦ä¸²å€¼ã€‚æ–¹å¼æœ‰ä¸¤ç§ï¼š</p><pre>double a = 0.1;System.out.println(new BigDecimal(String.valueOf(a))); // 0.1System.out.println(BigDecimal.valueOf(a)); // 0.1</pre><p>ç¬¬ä¸€ç§ï¼Œä½¿ç”¨ String.valueOf() æŠŠ double è½¬ä¸ºå­—ç¬¦ä¸²ã€‚</p><p>ç¬¬äºŒç§ï¼Œä½¿ç”¨ valueOf() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å†…éƒ¨ä¼šè°ƒç”¨ Double.toString() å°† double è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œæºç å¦‚ä¸‹ï¼š</p><pre>public static BigDecimal valueOf(double val) { // Reminder: a zero double returns '0.0', so we cannot fastpath // to use the constant ZERO. This might be important enough to // justify a factory approach, a cache, or a few private // constants, later. return new BigDecimal(Double.toString(val));}</pre><p><strong>05ã€ReentrantLock</strong></p><p>æœ€åä¸€é¢˜ï¼Œä¹Ÿå°±æ˜¯ç¬¬äº”é¢˜ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre>public class LockTest { private final static Lock lock = new ReentrantLock(); public static void main(String[] args) { try { lock.tryLock(); } catch (Exception e) { e.printStackTrace(); } finally { lock.unlock(); } }}</pre><p>é—®é¢˜å¦‚ä¸‹ï¼š</p><p>A: lock æ˜¯éå…¬å¹³é”</p><p>B: finally ä»£ç å—ä¸ä¼šæŠ›å‡ºå¼‚å¸¸</p><p>C: tryLock è·å–é”å¤±è´¥åˆ™ç›´æ¥å¾€ä¸‹æ‰§è¡Œ</p><p>å¾ˆæƒ­æ„§ï¼Œæˆ‘ä¸çŸ¥é“ ReentrantLock æ˜¯ä¸æ˜¯å…¬å¹³é”ï¼›ä¹Ÿä¸çŸ¥é“ finally ä»£ç å—ä¼šä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼›æ›´ä¸çŸ¥é“ tryLock è·å–é”å¤±è´¥çš„æ—¶å€™ä¼šä¸ä¼šç›´æ¥å¾€ä¸‹æ‰§è¡Œã€‚æ²¡æ³•ä½œç­”äº†ã€‚</p><p>è¿ç»­äº”é“é¢˜è§£ä¸å‡ºæ¥ï¼Œè™½ç„¶æˆ‘è„¸çš®éå¸¸åšï¼Œä½†ä¹Ÿè§‰å¾—è„¸ä¸Šç«è¾£è¾£çš„ï¼Œå°±åƒè¢«äººç‹ ç‹ åœ°æŠ½äº†ä¸€ä¸ªè€³å…‰ã€‚</p><p>å®¹æˆ‘ç ”ç©¶ç ”ç©¶å§ã€‚</p><p>1ï¼‰lock æ˜¯éå…¬å¹³é”</p><p>ReentrantLock æ˜¯ä¸€ä¸ªä½¿ç”¨é¢‘ç‡éå¸¸é«˜çš„é”ï¼Œæ”¯æŒé‡å…¥æ€§ï¼Œèƒ½å¤Ÿå¯¹å…±äº«èµ„æºé‡å¤åŠ é”ï¼Œå³å½“å‰çº¿ç¨‹è·å–è¯¥é”åå†æ¬¡è·å–æ—¶ä¸ä¼šè¢«é˜»å¡ã€‚</p><p>ReentrantLock æ—¢æ˜¯å…¬å¹³é”åˆæ˜¯éå…¬å¹³é”ã€‚è°ƒç”¨æ— å‚æ„é€ æ–¹æ³•æ—¶æ˜¯éå…¬å¹³é”ï¼Œæºç å¦‚ä¸‹ï¼š</p><pre>public ReentrantLock() { sync = new NonfairSync();}</pre><p>æ‰€ä»¥æœ¬é¢˜ä¸­çš„ lock æ˜¯éå…¬å¹³é”ï¼ŒA é€‰é¡¹æ˜¯æ­£ç¡®çš„ã€‚</p><p>ReentrantLock è¿˜æä¾›äº†å¦å¤–ä¸€ç§æ„é€ æ–¹æ³•ï¼Œæºç å¦‚ä¸‹ï¼š</p><pre>public ReentrantLock(boolean fair) { sync = fair ? new FairSync() : new NonfairSync();}</pre><p>å½“ä¼ å…¥ true çš„æ—¶å€™ä¸ºå…¬å¹³é”ï¼Œfalse çš„æ—¶å€™ä¸ºéå…¬å¹³é”ã€‚</p><p>é‚£å…¬å¹³é”å’Œéå…¬å¹³é”åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p><p>å…¬å¹³é”å¯ä»¥ä¿è¯è¯·æ±‚èµ„æºåœ¨æ—¶é—´ä¸Šçš„ç»å¯¹é¡ºåºï¼Œè€Œéå…¬å¹³é”æœ‰å¯èƒ½å¯¼è‡´å…¶ä»–çº¿ç¨‹æ°¸è¿œæ— æ³•è·å–åˆ°é”ï¼Œé€ æˆâ€œé¥¥é¥¿â€çš„ç°è±¡ã€‚</p><p>å…¬å¹³é”ä¸ºäº†ä¿è¯æ—¶é—´ä¸Šçš„ç»å¯¹é¡ºåºï¼Œéœ€è¦é¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè€Œéå…¬å¹³é”ä¼šå‡å°‘ä¸€äº›ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ€§èƒ½å¼€é”€ç›¸å¯¹è¾ƒå°ï¼Œå¯ä»¥ä¿è¯ç³»ç»Ÿæ›´å¤§çš„ååé‡ã€‚</p><p>2ï¼‰finally ä»£ç å—ä¸ä¼šæŠ›å‡ºå¼‚å¸¸</p><p>Lock å¯¹è±¡åœ¨è°ƒç”¨ unlock æ–¹æ³•æ—¶ï¼Œä¼šè°ƒç”¨ AbstractQueuedSynchronizer çš„ tryRelease æ–¹æ³•ï¼Œå¦‚æœå½“å‰çº¿ç¨‹ä¸æŒæœ‰é”çš„è¯ï¼Œåˆ™æŠ›å‡º IllegalMonitorStateException å¼‚å¸¸ã€‚</p><p>æ‰€ä»¥å»ºè®®æœ¬é¢˜çš„ç¤ºä¾‹ä»£ç ä¼˜åŒ–ä¸ºä»¥ä¸‹å½¢å¼ï¼ˆè¿›å…¥ä¸šåŠ¡ä»£ç å—ä¹‹å‰ï¼Œå…ˆåˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”ï¼‰ï¼š</p><pre>boolean isLocked = lock.tryLock();if (isLocked) { try { // doSomething(); } catch (Exception e) { e.printStackTrace(); } finally { lock.unlock(); }}</pre><p>3ï¼‰tryLock è·å–é”å¤±è´¥åˆ™ç›´æ¥å¾€ä¸‹æ‰§è¡Œ</p><p>tryLock() æ–¹æ³•çš„ Javadoc å¦‚ä¸‹ï¼š</p><blockquote><p>Acquires the lock if it is available and returns immediately with the value true. If the lock is not available then this method will return immediately with the value false.</p></blockquote><p>ä¸­æ–‡æ„æ€æ˜¯å¦‚æœé”å¯ä»¥ç”¨ï¼Œåˆ™è·å–è¯¥é”ï¼Œå¹¶ç«‹å³è¿”å› trueï¼Œå¦‚æœé”ä¸å¯ç”¨ï¼Œåˆ™ç«‹å³è¿”å› falseã€‚</p><p>é’ˆå¯¹æœ¬é¢˜çš„è¯ï¼Œ åœ¨ tryLock è·å–é”å¤±è´¥çš„æ—¶å€™ï¼Œç¨‹åºä¼šæ‰§è¡Œ finally å—çš„ä»£ç ã€‚</p><h1>å°ç»“</h1><p>æƒ³äº†è§£å­¦ä¹ Javaæ–¹é¢çš„æŠ€æœ¯ä»¥åŠå­¦ä¹ è¿›é˜¶å“ªæ–¹é¢çš„æŠ€æœ¯çŸ¥è¯†ç‚¹ç­‰</p><p>ç§ä¿¡æœ¬å¤´æ¡å·ï¼šå‘é€ï¼šâ€œå…è´¹èµ„æ–™â€å°±å¯ä»¥è·å–Javaæ¶æ„å­¦ä¹ èµ„æ–™</p><p>å¾®æœåŠ¡ã€åˆ†å¸ƒå¼ã€é«˜å¹¶å‘ã€é«˜å¯ç”¨ï¼Œæ€§èƒ½ä¼˜åŒ–ä¸¶æºç åˆ†æç­‰ç­‰ä¸€äº›æŠ€æœ¯</p><p>æ¬¢è¿å…³æ³¨å¤´æ¡å·:JAVAå¤§é£å“¥</p><p>è§‰å¾—æ”¶è·çš„è¯å¯ä»¥ç‚¹ä¸ªå…³æ³¨æ”¶è—è½¬å‘ä¸€æ³¢å–”ï¼Œè°¢è°¢å¤§ä½¬ä»¬æ”¯æŒï¼</p><p>æœ€åï¼Œæ¯ä¸€ä½è¯»åˆ°è¿™é‡Œçš„Javaç¨‹åºçŒ¿æœ‹å‹ä»¬ï¼Œæ„Ÿè°¢ä½ ä»¬èƒ½è€å¿ƒåœ°çœ‹å®Œã€‚å¸Œæœ›åœ¨æˆä¸ºä¸€åæ›´ä¼˜ç§€çš„Javaç¨‹åºçŒ¿çš„é“è·¯ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä¸€èµ·å­¦ä¹ ã€ä¸€èµ·è¿›æ­¥ï¼éƒ½èƒ½èµ¢å–ç™½å¯Œç¾ï¼Œèµ°å‘æ¶æ„å¸ˆçš„äººç”Ÿå·…å³°!</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Java','ä»£ç ç•Œ','3%'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>