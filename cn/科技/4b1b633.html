<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>LeetCode 56，一道有趣的合并区间问题 | 极客快訊</title><meta property="og:title" content="LeetCode 56，一道有趣的合并区间问题 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/7b3eaa362f814e1c82e1669b20e06dfb"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4b1b633.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4b1b633.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4b1b633.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4b1b633.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4b1b633.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4b1b633.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4b1b633.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4b1b633.html><meta property="article:published_time" content="2020-10-29T20:50:12+08:00"><meta property="article:modified_time" content="2020-10-29T20:50:12+08:00"><meta name=Keywords content><meta name=description content="LeetCode 56，一道有趣的合并区间问题"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/4b1b633.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>LeetCode 56，一道有趣的合并区间问题</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>今天是<strong>LeetCode专题的第33篇</strong>文章，我们一起来看LeetCode的第56题，它的难度是Medium。</p><p><br></p><h2 class=pgc-h-arrow-right>题意</h2><p><br></p><p>这道题的题意也很简单，只有一句话：“Given a collection of intervals, merge all overlapping intervals.”</p><p><br></p><p>interval是<strong>间隔、区间</strong>的意思，也就是说题目会给我们一系列区间，让我们把这些区间合并在一起。</p><p><br></p><p>我们看下题目给的样例来感受一下：</p><p><br></p><blockquote><p>“</p><p>Input: [[1,3],[2,6],[8,10],[15,18]]<br>Output: [[1,6],[8,10],[15,18]]<br>Explanation: Since intervals [1,3] and [2,6] overlaps, merge them into [1,6].</p></blockquote><blockquote><p>“</p><p>Input: [[1,4],[4,5]]<br>Output: [[1,5]]<br>Explanation: Intervals [1,4] and [4,5] are considered overlapping.</p></blockquote><p><br></p><h2 class=pgc-h-arrow-right>分析</h2><p><br></p><p>通过观察样例，我们发现题目通过数组给定区间，每个区间有两个端点。两个区间能够合并的条件，就是<strong>互相之间有交叉的部分</strong>。我们看下下图，这应该很直观。</p><div class=pgc-img><img alt="LeetCode 56，一道有趣的合并区间问题" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7b3eaa362f814e1c82e1669b20e06dfb><p class=pgc-img-caption></p></div><p><br></p><p>当两个区间[s1, e1]和[s2, e2]中的e1 >= s2时，这两个区间就可以进行合并。合并之后得到的新区间是[s1, e2]。</p><p><br></p><p>但是这存在一个小问题，我们如何能判断第一个区间一定在第二个区间的左侧呢，会不会发生重叠呢？</p><div class=pgc-img><img alt="LeetCode 56，一道有趣的合并区间问题" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e67519be95ba4b4bba0976392c4cf829><p class=pgc-img-caption></p></div><p>如果是这种情况那么合并之后的结果就是[s2, e2]了，另外一个问题是，这样的区间一共有N个，我们<strong>怎么判断合并的顺序</strong>呢？很有可能出现AB两个区间原本不能合并，但是A合并了区间C之后又可以和B合并的情况。如果我们枚举的话会很麻烦，我们不但需要考虑合并的时候会发生的种种情况，还需要考虑合并的发生顺序。而且我们也很难得知是否所有能够合并的区间已经合并完成。</p><p><br></p><h2 class=pgc-h-arrow-right>题解</h2><p><br></p><p>我们梳理一下目前遇到的问题，第一个问题是区间根据位置的不同<strong>合并之后的结果可能有多个</strong>。第二个问题是<strong>区间合并之后会创建新的合并的可能</strong>，第三个问题是我们<strong>判断当前是否还有合并的可能开销很大</strong>。</p><p><br></p><p>其中第三个问题是前两个问题导致的，只要解决了其中一个，第三个问题自然迎刃而解。其中<strong>第二个问题是无法解决</strong>的，因为这是区间合并的天然属性，我们执行区间合并必然会有这样的情况发生。所以我们只能针对第一个问题下手，合并之后的结果可能有多种的本质原因是区间的位置关系可能有多个。A和B合并，A可以出现在B的左侧，也可以出现在B的右侧。再根据区间长短关系，所以才导致了多种结果。</p><p><br></p><p>如果我们能够保证<strong>A一定出现在B的左侧</strong>，那么A和B就只有三种情况。一种是A和B不相交，也就是不能合并。第二种是A和B相交，第三种是A包含B。</p><p><br></p><p>我们把图画出来，很容易发现后面两种能够合并的情况其实可以概括成一种，它们合并之后的结果都是[s1, max(e1, e2)]。</p><div class=pgc-img><img alt="LeetCode 56，一道有趣的合并区间问题" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7b07a47c9fc74735971a32aa00b52041><p class=pgc-img-caption></p></div><p>既然如此，本题的关键就是<strong>区间之间的顺序</strong>。假如我们保证了区间的顺序，我们依次合并显然可以很容易得到结果。但是我们怎么得到区间顺序呢？</p><p><br></p><p>其实很简单，就是<strong>排序</strong>，既然区间本来没有顺序，我们对它们排序，不就有顺序了吗？</p><p><br></p><p>我们可以规定左侧端点小的区间排在前面，如果两个区间左端点一致，右端点小的靠前。这是什么？这其实就是<strong>字典序排序</strong>，在Python当中我们可以直接调用sorted对多元素的list进行字典序排序。如果是其他语言，也不麻烦，我们可以自己定义比较算子，一样可以解决。</p><p><br></p><p>既然区间有序了，我们只需要从左到右遍历就可以覆盖所有情况了，第三个问题也就解决了。</p><p><br></p><p>最后，我们来看下代码，只要想到了排序，这道题并不难。但是初学者往往很难想到排序上，这当中的思维推导过程才是我们需要熟悉的。</p><pre><code>class Solution:    def merge(self, intervals: List[List[int]]) -&gt; List[List[int]]:        ret = []        if len(intervals) == 0:            return ret        # 字典序排序        intervals = sorted(intervals)        # l，r表示当前区间的两个端点        l, r = intervals[0]        # 从1开始遍历区间，进行合并        for i in range(1, len(intervals)):            s, e = intervals[i]            # 如果可以合并，维护合并之后的右端点            if s &lt;= r:                r = max(r, e)            else:            # 否则加入答案，将i区间作为当前进行合并的区间                ret.append([l, r])                l, r = s, e                        ret.append([l, r])        return ret</code></pre><p><br></p><h2 class=pgc-h-arrow-right>结尾</h2><p><br></p><p>到这里，这道题就结束了，除了排序之外，这道题还可以使用<strong>连通分量</strong>的思想来做。我们可以枚举所有区间的关系，我们可以把所有区间看成是图上的一个点。只要两个区间可以合并，我们就把它们两个点之间连一条边。这样所有可以合并在一起的区间，就构成了一个连通分量。我们最后遍历这整张图上所有的连通分量就可以拿到所有合并之后的区间结果。和排序比起来，这个算法显然复杂得多，需要<strong>建图、连边，然后计算连通分量</strong>。并且复杂度也很高，是 O(n^2) 的算法。我觉得完全没有必要，所以就不多介绍了，感兴趣的同学可以自己了解一下，只要图建好之后，连通分量的求解也不是很复杂。</p><p><br></p><p>你看，复杂的算法未必效果就好，还是要适合题目的才是最好的，但什么算法是适合题目的呢？这才是所有问题的关键。这不禁让我想到了电影霍元甲里面，李连杰说的一句话，武功本身没有强弱之别，只是使用武功的武者实力有高下之分。算法也是一样，复杂的算法并不一定就强，灵活运用、理性分析、合理运用才是王道。</p><p><br></p><p>今天的文章就到这里，原创不易，需要你<strong>一个关注</strong>的支持，你的举手之劳对我来说很重要。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'LeetCode','56','区间'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>