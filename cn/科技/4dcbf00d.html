<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>如何来实现SpringBoot应用的JPA数据持久化和热插拔 | 极客快訊</title><meta property="og:title" content="如何来实现SpringBoot应用的JPA数据持久化和热插拔 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/dc38450079574dd685472184b5fa06f8"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4dcbf00d.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4dcbf00d.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4dcbf00d.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4dcbf00d.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4dcbf00d.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4dcbf00d.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4dcbf00d.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4dcbf00d.html><meta property="article:published_time" content="2020-11-14T20:59:17+08:00"><meta property="article:modified_time" content="2020-11-14T20:59:17+08:00"><meta name=Keywords content><meta name=description content="如何来实现SpringBoot应用的JPA数据持久化和热插拔"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/4dcbf00d.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>如何来实现SpringBoot应用的JPA数据持久化和热插拔</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>数据持久化</h1><p>JPA ( Java Persistence API)是用于管理Java EE和Java SE环境中的持久化，以及对象/关系映射的Java API。</p><p>JPA最新规范为“JSR 338: Java Persistence 2.1”( htps:/cp.org/e/e/ail?id=338)。目前，市面上实现该规范的常见JPA框架有EclipseLink ( ht://www.eclipse.org/ecipselink)、Hibermate( ht:t:hib/mate.or/orom )、Apache OpenJPA ( htp://penipapache.org/)等。<br>本文主要介绍以Hibernate为实现的JPA。</p><div class=pgc-img><img alt=如何来实现SpringBoot应用的JPA数据持久化和热插拔 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dc38450079574dd685472184b5fa06f8><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>JPA的产生背景</h1><p>在JPA产生之前，围绕如何简化数据库操作的相关讨论已经是层出不穷，众多厂商和开源社区也都提供了持久层框架的实现，其中ORM框架最为开发人员所关注。</p><p>ORM ( Object Relational Mapping,对象关系映射)是-一种用于实现面向对象编程语言里不同类型系统的数据之间转换的程序技术。由于面向对象数据库系统( OODBS)的实现在技术上还存在难点，目前，市面上流行的数据库还是以关系型数据库为主。</p><p>由于关系型数据库使用的SQL语言是一-种非过程化的面向集合的语言，而目前许多应用仍然是由高级程序设计语言( 如Java)来实现的，但是高级程序设计语言是过程化的，而且是面向单个数据的，这使得SQL与它之间存在着不匹配，这种不匹配称为“阻抗失配”。由于“阻抗失配”的存在，使得开发人员在使用关系型数据库时不得不花很多功夫去完成两种语言之间的相互转化。</p><p>而ORM框架的产生，正是为了简化这种转化操作。在编程语言中，使用ORM就可以使用面向对象的方式来完成数据库的操作。</p><p>ORM框架的出现，使直接存储对象成为可能，它们将对象拆分成SQL语句，从而来操作数据库。但是不同的ORM框架，在使用上存在比较大的差异，这也导致开发人员需要学习各种不同的ORM框架，增加了技术学习的成本。</p><p>而JAP规范就是为了解决这个问题:规范ORM框架，使用ORM框架统- -的接口 和用法。这样在采用面向接口编程的技术中，即便更换了不同的ORM框架，也无须变更业务逻辑。</p><p>最早的JPA规范是由Java官方提出的，随JavaEE5规范一同发布。</p><p><strong>实体( Entity )</strong></p><p>实体是轻量级的持久化域对象。通常，实体表示关系数据库中的表，并且每个实体实例对应于该表中的行。实体的主要编程工件是实体类，尽管实体可以使用辅助类。</p><p>在EJB3之前，EJB 主要包含三种类型:会话bean、消息驱动bean、实体bean。但自EJB 3.0开始，实体bean被单独分离出来，形成了新的规范: JPA。 所以，JPA完全可以脱离EJB 3来使用。实体是JPA中的核心概念。</p><p>实体的持久状态通过持久化字段或持久化属性来表示。这些字段或属性使用对象/关系映射注解将实体和实体关系映射到基础数据存储中的关系数据。</p><p>与实体在概念上比较接近的另外一个领域对象是值对象。实体是可以被跟踪的，通常会有一个主键(唯一标识)来追踪其状态。而值对象则没有这种标识，我们只关心值对象的属性。</p><h1 class=pgc-h-arrow-right>Spring Data JPA概述</h1><p>Spring Data JPA是更大的Spring Data家族的一部分，使得轻松实现基于JPA的存储库变得更容易。该模块用于处理对基于JPA的数据访问层的增强支持。它使更容易构建基于使用Spring数据访问技术栈的应用程序。</p><p>Spring Data JPA对于JPA的支持则是更近-步。使用Spring Data JPA，开发者无须过多关注EntityManager的创建、事务处理等JPA相关的处理，这基本上也是作为一个 开发框架而言所能做到的极限了，甚至Spring Data JPA让你连实现持久层业务逻辑的工作都省了，唯-要做的，就只是声明持久层的接口，其他都交给Spring Data JPA来帮你完成。</p><p>Spring Data JPA就是这么强大，让你的数据持久层开发工作简化，只需声明一个接口。比如，你声明了一个findUserBylId0，Spring Data JPA就能判断出这是根据给定条件的ID查询出满足条件的User对象，而其中的实现过程开发者无须关心，这一-切都交予Spring Data JPA来完成。</p><p>对于普通开发者而言，自己实现应用程序的数据访问层是一件极 其繁琐的过程。开发者必须编写太多的样板代码来执行简单查询、分页和审计。Spring Data JPA旨在通过将努力减少到实际需要的量来显著改进数据访问层的实现。作为开发人员，只需要编写存储库的接口，包括自定义查询方法，而这些接口的实现，Spring Data JPA将会自动提供。</p><p>Spring Data JPA包含如下特征。</p><p>●基于Spring和JPA来构建复杂的存储库。</p><p>支持Querydsl ( htp://ww.querydsl.com)谓词，因此支持类型安全的JPA查询。</p><p>域类的透明审计。</p><p>具备分页支持、动态查询执行、集成自定义数据访问代码的能力。</p><p>在引导时验证带@Query注解的查询。</p><p>●支持基于XML的实体映射。</p><p>通过引入@EnableJpaRepositories来实现基于JavaConfig的存储库配置。</p><h1 class=pgc-h-arrow-right>如何使用Spring Data JPA</h1><p>在项目中使用spring- data-jpa的推荐方法是使用依赖关系管理系统。下 面是使用Gradle构建的示例。</p><pre><code>dependencies {compile ' org. spr ingf ramework. data:spring-data-jpa:2.0.0.M4 '}</code></pre><p>在代码中，我们只需声明继承自Spring Data JPA中的接口。</p><pre><code>import org. springfr amework. data. jpa. repository .JpaRepository;public interface UserRepository extends JpaRepository&lt;User, Long&gt;{List&lt;User&gt; findByNameLike (String name) ;</code></pre><p>在这个例子中，代码继承自Spring Data JPA中的JpaRepository接口，而后声明相关的方法即可。比如声明findByNameLike，就能自动实现通过名称来模糊查询的方法。</p><div class=pgc-img><img alt=如何来实现SpringBoot应用的JPA数据持久化和热插拔 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/42abab5fb5ec4678824fa2a14a6fd651><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>Spring Data JPA的核心概念</h1><p>SpringData存储库抽象中的中央接口是Repository。它将域类及域类的ID类型作为类型参数进行管理。此接口主要作为标记接口捕获要使用的类型，并帮助发现扩展此接口。而CrudReposi-tory为受管理的实体类提供复杂的CRUD功能。</p><pre><code>public interface CrudRepository&lt;T, ID extends Serializable&gt;extends Repository&lt;T, ID&gt; {&lt;S extends T&gt; S save(S entity); // (1)T findOne (ID primaryKey) ;  // (2)Iterable&lt;T&gt; findAll () ;  // (3)Long count() ; // (4)void delete(T entity) ; // (5)boolean exists(ID primaryKey); // (6)//省略更多方法...</code></pre><p>CrudRepository接口中的方法含义如下。</p><p>(1)保存给定实体。</p><p>(2)返回由给定ID标识的实体。</p><p>(3)返回所有实体。</p><p>(4)返回实体的数量。</p><p>(5)删除给定的实体。</p><p>(6)指示是否存在具有给定ID的实体。</p><p>同时还提供其他特定的持久化技术的抽象，比如JpaRepository或MongoRepository,这些接口扩展了CrudRepository。</p><p>在CrudRepository的顶部有一个PagingAndSortingRepository 抽象，它增加了额外的方法来简化对实体的分页访问。</p><pre><code>public interface PagingAndSortingRepository&lt;T, ID extends Serializable&gt;extends CrudRepository&lt;T, ID&gt; {Iterable&lt;T&gt; findAll (Sort sort) ;Page&lt;T&gt; findAll (Pageable pageable) ;}</code></pre><hr><h1 class=pgc-h-arrow-right>实现热插拔</h1><p>对于Java项目而言，在开发过程中，一个非常大的问题在于，每次在修改完文件之后都需要重新编译、启动，才能查看到最新的修改效果，这极大影响了开发效率。因此, Spring Boot提供了几种热插拔( Hot Swapping)方式。本节主要介绍如何来实现Spring Boot应用的热插拔。</p><h1 class=pgc-h-arrow-right>重新加载静态内容</h1><p>有多种热加载的方式,推荐的方法是使用spring-boot-devtools,因为它提供了额外的功能,例如，支持快速应用程序重启和LiveReload及智能的开发时配置(如模板缓存)。</p><p>以下是在Maven添加Devtools的方式。</p><pre><code>&lt;dependencies&gt;&lt;dependency&gt;&lt;groupId&gt;org. springframework.boot&lt;/groupId&gt;&lt;arti factId&gt;spring-boot-devtools&lt;/arti factId&gt;&lt;optional&gt;true&lt;/optional&gt;&lt;/ dependency&gt;&lt;/dependencies&gt;</code></pre><p>在Gradle添加Devtools则更加多简洁。</p><pre><code>dependencies{compile ("org. spr ingframework .boot :spring-boot-devtools")}</code></pre><p>Devtools通过监视类路径的变更来实现热加载。这意味着静态资源更改必须构建才能使更改生效。不同的IDE触发更新的方式有所不同。默认情况下，在Eclipse中，保存修改的文件将导致类路径被更新并触发重新启动。在IntelliJ IDEA中，构建项目( Build -→Make Project )将具有相同的效果。</p><p>在IDE中运行(特别是调试)是另外-一个非常好的开发方式，因为几乎所有现代IDE都允许重新加载静态资源，通常还可以热部署Java类的更改。</p><p>LiveReload</p><p>spring- boot- devtools模块包括一个嵌入式LiveReload 服务器，可以在资源更改时用于触发浏览器刷新。ht/iv/reload.com/excensions/ 网站为Chrome、Firefox 和Safari等免费提供了LiveReload浏览器的扩展程序。</p><p>如果不想在应用程序运行时启动LiveReload服务器，则可以将spring devtools.livereload.enabled属性设置为false。</p><p>需要注意的是，一次只能运行一个LiveReload服务器。应用程序启动之前，请确保没有其他LiveReload服务器正在运行。如果从IDE启动多个应用程序，则只有第一个应用程序将 支持LiveReload。</p><h1 class=pgc-h-arrow-right>重新加载模板</h1><p>Spring Boot在大多数模板技术中,都有包括禁用缓存的配置选项。启用这个禁用缓存的选项后，修改模板文件，就能自动实现模板的加载。如果使用spring -boot-devtools模块，这些属性将在开发时自动配置上。</p><p>下面是常用模板的禁用缓存的设置。</p><p>( 1 ) Thymeleaf</p><p>如果使用Thymeleaf，请设置spring.thymeleaf.cache为false。</p><p>( 2 ) FreeMarker</p><p>如果使用FreeMarker,请设置springfreemarker.cache为false。</p><p>(3) Groovy</p><p>如果使用Groovy,请设置spring.groovy.cache为false。</p><h1 class=pgc-h-arrow-right>应用程序快速重启</h1><p>spring-boot-devtools模块支持应用程序自动重新启动。虽然并不像商业软件JRebel那样快，但通常比“冷启动”快得多。所以，如果不想花费太多资源在这些商业软件身上，不妨尝试下Devtools。</p><h1 class=pgc-h-arrow-right>重新加载Java类而不重新启动容器</h1><p>现代IDE (如Eclipse、IDEA 等)都支持字节码的热插拔，所以如果进行了不影响类或方法签名的更改，那么应重新加载Java类，而不是重启容器，这样会更快、更干净，而且不会因为重启容器而产生副作用。</p><hr><h1 class=pgc-h-arrow-right>本文给大家介绍的内容是以Hibernate为实现的JPA，如何来实现SpringBoot应用的热插拔</h1><p>1.觉得文章不错的小伙伴，可以转发关注小编一下；</p><p>2.下篇文章给大家介绍微服务测试这一块儿的内容；</p><p>3.感谢大家支持！！！！</p><p><br></p><div class=pgc-img><img alt=如何来实现SpringBoot应用的JPA数据持久化和热插拔 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/86ad0cd1b1d34527ba5c44ba87fc11f7><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'插拔','实现','SpringBoot'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>