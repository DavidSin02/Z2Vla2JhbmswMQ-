<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Python数据清洗(一)：类型转换和冗余数据删除 | 极客快訊</title><meta property="og:title" content="Python数据清洗(一)：类型转换和冗余数据删除 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/936eb6071cd947a4b3fedc4277d90815"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4ee568a.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4ee568a.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4ee568a.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4ee568a.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4ee568a.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4ee568a.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4ee568a.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4ee568a.html><meta property="article:published_time" content="2020-10-29T20:59:01+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:01+08:00"><meta name=Keywords content><meta name=description content="Python数据清洗(一)：类型转换和冗余数据删除"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/4ee568a.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Python数据清洗(一)：类型转换和冗余数据删除</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div class=pgc-img><img alt=Python数据清洗(一)：类型转换和冗余数据删除 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/936eb6071cd947a4b3fedc4277d90815><p class=pgc-img-caption></p></div><blockquote><p>作者 | 刘顺祥</p></blockquote><blockquote><p>来源 | 数据分析1480</p></blockquote><p>数据分析过程中最头疼也是工作量最大的部分算是探索和清洗了——探索的目的是了解数据，了解数据背后隐藏的规律；洗的目的则是为了让干净的数据进入分析或建模的下一个环节。小编将通过三篇文章，详细讲解工作中常规的数据清洗方法，<strong>包括数据类型的转换，重复数据的处理，缺失值的处理以及异常数据的识别和处理</strong>。这是Python数据清洗系列的第一篇文章，主要分享的内容包括——<strong>数据类型的转换and冗余数据的识别和处理</strong></p><h1><strong>数据类型的判断和转换</strong></h1><p>如下表所示，为某公司用户的个人信息和交易数据，涉及的字段为用户id、性别、年龄、受教育水平、交易金额和交易日期。从表面上看，似乎没有看出数据背后可能存在的问题，那接下来就将其读入到Python中，并通过探索的方式发现数据中的问题。</p><div class=pgc-img><img alt=Python数据清洗(一)：类型转换和冗余数据删除 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/41a4aa5583de432caed58fd0577f7c7d><p class=pgc-img-caption></p></div><p>读取数据，以及查看数据规模、查看数据中各变量的数据类型的代码如下：</p><pre># 导入第三方包import pandas as pd# 读入外部数据data3 = pd.read_excel(io=r'C:\Users\Administrator\Desktop\datas\data3.xlsx')# 查看数据的规模data3.shapeout:(3000, 6)# 查看表中各变量的数据类型# data3.dtypesout:</pre><p>表中各变量的数据类型如表下表所示：</p><div class=pgc-img><img alt=Python数据清洗(一)：类型转换和冗余数据删除 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fd01a2adb5de48ada07cfea29ac3d26a><p class=pgc-img-caption></p></div><p>上述代码利用<strong>shape“方法”</strong>返回了数据集的规模，即该数据包含3000行6列；通过<strong>dtypes“方法”</strong>则返回了数据集中各变量的数据类型——除id变量和age变量为数值型，其余变量均为字符型。直观上能够感受到一点问题，即数据类型不对，例如用户id应该为字符型，消费金额custom_amt为数值型，订单日期为日期型。如果发现数据类型不对，如何借助于Python工具实现数据类型的转换呢？可参照如下代码的实现。</p><pre># 数值型转字符型data3['id'] = data3['id'].astype(str)# 字符型转数值型data3['custom_amt'] = data3['custom_amt'].str[1:].astype(float)# 字符型转日期型data3['order_date'] = pd.to_datetime(data3['order_date'], format = '%Y年%m月%d日')# 重新查看数据集的各变量类型data3.dtypesout:</pre><p>这些数据经过处理后，各个字段的数据类型如下表所示：</p><div class=pgc-img><img alt=Python数据清洗(一)：类型转换和冗余数据删除 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7d505e92c58147de9041b34cdb0f6e57><p class=pgc-img-caption></p></div><p>如上结果所示，三个变量全都转换成了各自所期望的数据类型。<strong>astype“方法”</strong>用于数据类型的强制转换，可选择的常用转换类型包括str（表示字符型）、float（表示浮点型）和int（表示整型）。由于消费金额custom_amt变量中的值<strong>包含人民币符号“￥”</strong>，所以在数据类型转换之前必须将其删除（通过字符串的切片方法删除，<strong>[1:]表示从字符串的第二个元素开始截断</strong>）。对于字符转日期问题，推荐使用更加灵活的to_datetime函数，因为它在format参数的调节下，可以识别任意格式的字符型日期值。</p><p>需要注意的是，Python中的函数有两种表现形式，一种是常规理解下的<strong>函数</strong>（语法为func(parameters)，如to_datetime函数），另一种则是<strong>“方法”</strong>（语法为obj.func(parameters)，如dtypes和astype“方法”）。两者的区别在于 “方法”是针对特定对象的函数（即该“方法”只能用在某个固定类型的对象上），而函数并没有这方面的限制。</p><p>基于如上类型的转换结果，最后浏览一下数据的展现形式：</p><pre># 预览数据的前5行data3.head()</pre><div class=pgc-img><img alt=Python数据清洗(一)：类型转换和冗余数据删除 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8eb8c5d369ac45f9b5e39884c4d38ebe><p class=pgc-img-caption></p></div><h1><strong>冗余数据的判断和处理</strong></h1><p>如上过程是对数据中各变量类型的判断和转换，除此还需要监控表中是否存在“脏”数据，如冗余的重复观测和缺失值等。可以通过<strong>duplicated“方法”</strong>进行 “脏”数据的识别和处理。仍然对上边的data3数据为例进行操作，具体代码如下所示。</p><pre># 判断数据中是否存在重复观测data3.duplicated().any()out:False</pre><p>如上结果返回的是False，说明该数据集中并不存在重复观测。假如读者利用如上的代码在数据集中发现了重复观测，可以使用drop_duplicates“方法”将冗余信息删除。</p><p><strong>需要说明的是</strong>，在使用duplicated“方法”对数据行作重复性判断时，会返回一个与原数据行数相同的序列（如果数据行没有重复，则对应False，否则对应True），为了得到最终的判断结果，需要<strong>再使用any“方法”</strong>（即序列中只要存在一个True，则返回True）。</p><p>duplicated“方法”和drop_duplicates“方法”都有一个非常重要的参数，<strong>就是subset</strong>。默认情况下不设置该参数时，表示对数据的所有列进行重复性判断；如果需要按指定的变量做数据的重复性判断时，就可以使用该参数指定具体的变量列表。举例如下：</p><pre># 构造数据df = pd.DataFrame(dict(name = ['张三','李四','王二','张三','赵五','丁一','王二'], gender = ['男','男','女','男','女','女','男'], age = [29,25,27,29,21,22,27], income = [15600,14000,18500,15600,10500,18000,13000], edu = ['本科','本科','硕士','本科','大专','本科','硕士']))# 查看数据df</pre><div class=pgc-img><img alt=Python数据清洗(一)：类型转换和冗余数据删除 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2a67676fe4084ee68e3aea4c5dfdc219><p class=pgc-img-caption></p></div><p>目测有两条数据完全一样，就是用户张三，如果直接使用drop_duplicates“方法”，而不做任何参数的修改时，将会删除第二次出现的用户张三。代码如下：</p><pre># 默认情况下，对数据的所有变量进行判断df.drop_duplicates()</pre><div class=pgc-img><img alt=Python数据清洗(一)：类型转换和冗余数据删除 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a42003904acb406aa7c4be39fe8860ee><p class=pgc-img-caption></p></div><p>假设在数据清洗中，用户的姓名和年龄相同就认为是重复数据，那么该如何基于这两个变量进行重复值的删除呢？此时就需要使用subset参数了，代码如下：</p><pre>df.drop_duplicates(subset=['name','age'])</pre><div class=pgc-img><img alt=Python数据清洗(一)：类型转换和冗余数据删除 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/61460297f5c742cfb8e5c7686086c47e><p class=pgc-img-caption></p></div><p><strong>需要注意的是</strong>，使用drop_duplicates“方法”删除重复数据，并不能直接影响到原始数据，即原始数据中还是存在重复观测的。如需使drop_duplicates“方法”的删除功能作用在原始数据中，<strong>必须将inplace参数设置为True</strong>。</p><p>本期的内容就介绍到这里，<strong>下一篇将分享缺失值的识别和处理技术。</strong></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Python','数据','类型'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>