<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Swapäº¤æ¢åˆ†åŒºæ¦‚å¿µ | æå®¢å¿«è¨Š</title><meta property="og:title" content="Swapäº¤æ¢åˆ†åŒºæ¦‚å¿µ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/1538208895235789e0d1c51"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4f88146.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4f88146.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4f88146.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4f88146.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4f88146.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4f88146.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4f88146.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4f88146.html><meta property="article:published_time" content="2020-10-29T21:00:58+08:00"><meta property="article:modified_time" content="2020-10-29T21:00:58+08:00"><meta name=Keywords content><meta name=description content="Swapäº¤æ¢åˆ†åŒºæ¦‚å¿µ"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/4f88146.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Swapäº¤æ¢åˆ†åŒºæ¦‚å¿µ</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><p>ä»€ä¹ˆæ˜¯Linux swap spaceå‘¢ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸‹é¢ä¸¤æ®µå…³äºLinux swap spaceçš„è‹±æ–‡ä»‹ç»èµ„æ–™:</p><p>Linux divides its physical RAM (random access memory) into chucks of memory called pages. Swapping is the process whereby a page of memory is copied to the preconfigured space on the hard disk, called swap space, to free up that page of memory. The combined sizes of the physical memory and the swap space is the amount of virtual memory available.</p><p>Swap space in Linux is used when the amount of physical memory (RAM) is full. If the system needs more memory resources and the RAM is full, inactive pages in memory are moved to the swap space. While swap space can help machines with a small amount of RAM, it should not be considered a replacement for more RAM. Swap space is located on hard drives, which have a slower access time than physical memory.Swap space can be a dedicated swap partition (recommended), a swap file, or a combination of swap partitions and swap files.</p><p>Linuxå†…æ ¸ä¸ºäº†æé«˜è¯»å†™æ•ˆç‡ä¸é€Ÿåº¦ï¼Œä¼šå°†æ–‡ä»¶åœ¨å†…å­˜ä¸­è¿›è¡Œç¼“å­˜ï¼Œè¿™éƒ¨åˆ†å†…å­˜å°±æ˜¯Cache Memory(ç¼“å­˜å†…å­˜)ã€‚å³ä½¿ä½ çš„ç¨‹åºè¿è¡Œç»“æŸåï¼ŒCache Memoryä¹Ÿä¸ä¼šè‡ªåŠ¨é‡Šæ”¾ã€‚è¿™å°±ä¼šå¯¼è‡´ä½ åœ¨Linuxç³»ç»Ÿä¸­ç¨‹åºé¢‘ç¹è¯»å†™æ–‡ä»¶åï¼Œä½ ä¼šå‘ç°å¯ç”¨ç‰©ç†å†…å­˜å˜å°‘ã€‚å½“ç³»ç»Ÿçš„ç‰©ç†å†…å­˜ä¸å¤Ÿç”¨çš„æ—¶å€™ï¼Œå°±éœ€è¦å°†ç‰©ç†å†…å­˜ä¸­çš„ä¸€éƒ¨åˆ†ç©ºé—´é‡Šæ”¾å‡ºæ¥ï¼Œä»¥ä¾›å½“å‰è¿è¡Œçš„ç¨‹åºä½¿ç”¨ã€‚é‚£äº›è¢«é‡Šæ”¾çš„ç©ºé—´å¯èƒ½æ¥è‡ªä¸€äº›å¾ˆé•¿æ—¶é—´æ²¡æœ‰ä»€ä¹ˆæ“ä½œçš„ç¨‹åºï¼Œè¿™äº›è¢«é‡Šæ”¾çš„ç©ºé—´è¢«ä¸´æ—¶ä¿å­˜åˆ°Swapç©ºé—´ä¸­ï¼Œç­‰åˆ°é‚£äº›ç¨‹åºè¦è¿è¡Œæ—¶ï¼Œå†ä»Swapåˆ†åŒºä¸­æ¢å¤ä¿å­˜çš„æ•°æ®åˆ°å†…å­˜ä¸­ã€‚è¿™æ ·ï¼Œç³»ç»Ÿæ€»æ˜¯åœ¨ç‰©ç†å†…å­˜ä¸å¤Ÿæ—¶ï¼Œæ‰è¿›è¡ŒSwapäº¤æ¢ã€‚</p><p>å…³äºSwapåˆ†åŒºï¼Œå…¶å®æˆ‘ä»¬æœ‰å¾ˆå¤šç–‘é—®,å¦‚æœèƒ½å¼„æ¸…æ¥šè¿™äº›ç–‘é—®ï¼Œé‚£ä¹ˆä½ å¯¹Swapçš„äº†è§£æŒæ¡å°±å·®ä¸å¤šäº†ã€‚å¦‚ä½•æŸ¥çœ‹Swapåˆ†åŒºå¤§å°ï¼Ÿ Swapåˆ†åŒºå¤§å°åº”è¯¥å¦‚ä½•è®¾ç½®ï¼Ÿç³»ç»Ÿåœ¨ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨Swapåˆ†åŒº? æ˜¯å¦å¯ä»¥è°ƒæ•´ï¼Ÿ å¦‚ä½•è°ƒæ•´Swapåˆ†åŒºçš„å¤§å°ï¼ŸSwapåˆ†åŒºæœ‰ä»€ä¹ˆä¼˜åŠ£å’Œè¦æ³¨æ„çš„åœ°æ–¹ï¼Ÿ Swapåˆ†åŒºæ˜¯å¦å¿…è¦ï¼Ÿé‚£ä¹ˆæˆ‘ä¸€ä¸ªä¸€ä¸ªæ¥çœ‹çœ‹è¿™äº›ç–‘é—®å§ï¼</p><p><strong>æŸ¥çœ‹Swapåˆ†åŒºå¤§å°</strong></p><p>æŸ¥çœ‹Swapåˆ†åŒºçš„å¤§å°ä»¥åŠä½¿ç”¨æƒ…å†µï¼Œä¸€èˆ¬ä½¿ç”¨freeå‘½ä»¤å³å¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼ŒSwapå¤§å°ä¸º2015Mï¼Œç›®å‰æ²¡æœ‰ä½¿ç”¨Swapåˆ†åŒº</p><pre>[root@DB-Server ~]# free -m total used free shared buffers cachedMem: 1000 855 145 0 28 296-/+ buffers/cache: 530 470Swap: 2015 0 2015</pre><p>å¦å¤–æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨swaponå‘½ä»¤æŸ¥çœ‹å½“å‰swapç›¸å…³ä¿¡æ¯ï¼šä¾‹å¦‚swapç©ºé—´æ˜¯swap partitionï¼ŒSwap sizeï¼Œä½¿ç”¨æƒ…å†µç­‰è¯¦ç»†ä¿¡æ¯</p><pre>[root@DB-Server ~]# swapon -sFilename Type Size Used Priority/dev/sda3 partition 2064344 0 -1[root@DB-Server ~]# cat /proc/swapsFilename Type Size Used Priority/dev/sda3 partition 2064344 0 -1[root@DB-Server ~]# </pre><div class=pgc-img><img alt=Swapäº¤æ¢åˆ†åŒºæ¦‚å¿µ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1538208895235789e0d1c51><p class=pgc-img-caption></p></div><p><strong>Swapåˆ†åŒºå¤§å°è®¾ç½®</strong></p><p>ç³»ç»Ÿçš„Swapåˆ†åŒºå¤§å°è®¾ç½®å¤šå¤§æ‰æ˜¯æœ€ä¼˜å‘¢ï¼Ÿ å…³äºè¿™ä¸ªé—®é¢˜ï¼Œåº”è¯¥è¯´åªèƒ½æœ‰ä¸€ä¸ªç»Ÿä¸€çš„å‚è€ƒæ ‡å‡†ï¼Œå…·ä½“è¿˜åº”è¯¥æ ¹æ®ç³»ç»Ÿå®é™…æƒ…å†µå’Œå†…å­˜çš„è´Ÿè·ç»¼åˆè€ƒè™‘ï¼ŒåƒORACLEçš„å®˜æ–¹æ–‡æ¡£å°±æ¨èå¦‚ä¸‹è®¾ç½®ï¼Œè¿™ä¸ªæ˜¯æ ¹æ®ç‰©ç†å†…å­˜æ¥åšå‚è€ƒçš„ã€‚</p><p><strong>RAM</strong></p><p><strong>Swap Space</strong></p><p><strong>Up to 512 MB</strong></p><p>2 times the size of RAM</p><p><strong>Between 1024 MB and 2048 MB</strong></p><p>1.5 times the size of RAM</p><p><strong>Between 2049 MB and 8192 MB</strong></p><p>Equal to the size of RAM</p><p><strong>More than 8192 MB</strong></p><p>0.75 times the size of RAM</p><p>å¦å¤–åœ¨å…¶å®ƒåšå®¢ä¸­çœ‹åˆ°ä¸‹é¢ä¸€ä¸ªæ¨èè®¾ç½®ï¼Œå½“ç„¶æˆ‘ä¸æ¸…æ¥šå…¶æ€ä¹ˆå¾—åˆ°è¿™ä¸ªæ ‡å‡†çš„ã€‚æ˜¯å¦åˆç†ä¹Ÿæ— ä»è€ƒè¯ã€‚å¯ä»¥ä½œä¸ºä¸€ä¸ªå‚è€ƒã€‚</p><p>4Gä»¥å†…çš„ç‰©ç†å†…å­˜ï¼ŒSWAP è®¾ç½®ä¸ºå†…å­˜çš„2å€ã€‚</p><p>4-8Gçš„ç‰©ç†å†…å­˜ï¼ŒSWAP ç­‰äºå†…å­˜å¤§å°ã€‚</p><p>8-64G çš„ç‰©ç†å†…å­˜ï¼ŒSWAP è®¾ç½®ä¸º8Gã€‚</p><p>64-256Gç‰©ç†å†…å­˜ï¼ŒSWAP è®¾ç½®ä¸º16Gã€‚</p><p>ä¸Šä¸‹ä¸¤ä¸ªæ ‡å‡†ç¡®å®ä¹Ÿå¾ˆè®©äººæ— æ‰€é€‚ä»ã€‚æˆ‘å°±æœ‰ä¸€æ¬¡åœ¨ä¸€å°ORACLEæ•°æ®åº“æœåŠ¡å™¨ï¼ˆ64Gçš„RAMï¼‰ï¼ŒæŒ‰ç…§å®˜æ–¹æ¨èè®¾ç½®äº†ä¸€ä¸ªå¾ˆå¤§çš„Swapåˆ†åŒºï¼Œä½†æ˜¯æˆ‘å‘ç°å…¶å®è¿™ä¸ªSwapå‡ ä¹å¾ˆå°‘ç”¨åˆ°ï¼Œå…¶å®æ˜¯æµªè´¹äº†ç£ç›˜ç©ºé—´ã€‚æ‰€ä»¥å¦‚æœæ ¹æ®ç³»ç»Ÿå®é™…æƒ…å†µå’Œå†…å­˜çš„è´Ÿè·ç»¼åˆè€ƒè™‘ï¼Œå…¶å®åº”è¯¥æŒ‰ç…§ç¬¬äºŒä¸ªå‚è€ƒæ ‡å‡†è®¾ç½®ä¸º8Gå³å¯ã€‚å½“ç„¶è¿™ä¸ªåªæ˜¯ä¸ªäººçš„ä¸€äº›è®¤çŸ¥ã€‚</p><p><strong>é‡Šæ”¾Swapåˆ†åŒºç©ºé—´</strong></p><pre>[root@testlnx ~]# free -m total used free shared buffers cachedMem: 64556 55368 9188 0 926 51405-/+ buffers/cache: 3036 61520Swap: 65535 13 65522[root@testlnx ~]# swapon -sFilename Type Size Used Priority/dev/mapper/VolGroup00-LogVol01 partition 67108856 14204 -1</pre><p><strong>ä½¿ç”¨swapoffå…³é—­äº¤æ¢åˆ†åŒº</strong></p><p>[root@testlnx ~]# swapoff /dev/mapper/VolGroup00-LogVol01</p><p><strong>ä½¿ç”¨swaponå¯ç”¨äº¤æ¢åˆ†åŒº</strong>ï¼Œæ­¤æ—¶æŸ¥çœ‹äº¤æ¢åˆ†åŒºçš„ä½¿ç”¨æƒ…å†µï¼Œä½ ä¼šå‘ç°usedä¸º0äº†</p><pre>[root@testlnx ~]# swapon /dev/mapper/VolGroup00-LogVol01[root@testlnx ~]# free -m total used free shared buffers cachedMem: 64556 55385 9171 0 926 51406-/+ buffers/cache: 3052 61504Swap: 65535 0 65535[root@testlnx ~]#</pre><p><strong>Swapåˆ†åŒºç©ºé—´ä»€ä¹ˆæ—¶å€™ä½¿ç”¨</strong></p><p>ç³»ç»Ÿåœ¨ä»€ä¹ˆæƒ…å†µæˆ–æ¡ä»¶ä¸‹æ‰ä¼šä½¿ç”¨Swapåˆ†åŒºçš„ç©ºé—´å‘¢ï¼Ÿ å…¶å®æ˜¯Linuxé€šè¿‡ä¸€ä¸ªå‚æ•°swappinessæ¥æ§åˆ¶çš„ã€‚å½“ç„¶è¿˜æ¶‰åŠåˆ°å¤æ‚çš„ç®—æ³•ã€‚</p><p>è¿™ä¸ªå‚æ•°å€¼å¯ä¸º 0-100ï¼Œæ§åˆ¶ç³»ç»Ÿ swap çš„ä½¿ç”¨ç¨‹åº¦ã€‚é«˜æ•°å€¼å¯ä¼˜å…ˆç³»ç»Ÿæ€§èƒ½ï¼Œåœ¨è¿›ç¨‹ä¸æ´»è·ƒæ—¶ä¸»åŠ¨å°†å…¶è½¬æ¢å‡ºç‰©ç†å†…å­˜ã€‚ä½æ•°å€¼å¯ä¼˜å…ˆäº’åŠ¨æ€§å¹¶å°½é‡é¿å…å°†è¿›ç¨‹è½¬æ¢å¤„ç‰©ç†å†…å­˜ï¼Œå¹¶é™ä½ååº”å»¶è¿Ÿã€‚é»˜è®¤å€¼ä¸º 60ã€‚æ³¨æ„ï¼šè¿™ä¸ªåªæ˜¯ä¸€ä¸ªæƒå€¼ï¼Œä¸æ˜¯ä¸€ä¸ªç™¾åˆ†æ¯”å€¼ï¼Œæ¶‰åŠåˆ°ç³»ç»Ÿå†…æ ¸å¤æ‚çš„ç®—æ³•ã€‚å…³äºè¯¥å‚æ•°è¯·å‚è€ƒè¿™ç¯‡æ–‡ç« [è½¬è½½]è°ƒæ•´è™šæ‹Ÿå†…å­˜ï¼Œåœ¨æ­¤ä¸åšè¿‡å¤šèµ˜è¿°ã€‚ä¸‹é¢æ˜¯å…³äºswappinessçš„ç›¸å…³èµ„æ–™</p><p>The Linux 2.6 kernel added a new kernel parameter called swappiness to let administrators tweak the way Linux swaps. It is a number from 0 to 100. In essence, higher values lead to more pages being swapped, and lower values lead to more applications being kept in memory, even if they are idle. Kernel maintainer Andrew Morton has said that he runs his desktop machines with a swappiness of 100, stating that "My point is that decreasing the tendency of the kernel to swap stuff out is wrong. You really don't want hundreds of megabytes of BloatyApp's untouched memory floating about in the machine. Get it out on the disk, use the memory for something useful."</p><p>Swappiness is a property of the Linux kernel that changes the balance between swapping out runtime memory, as opposed to dropping pages from the system page cache. Swappiness can be set to values between 0 and 100 inclusive. A low value means the kernel will try to avoid swapping as much as possible where a higher value instead will make the kernel aggressively try to use swap space. The default value is 60, and for most desktop systems, setting it to 100 may affect the overall performance, whereas setting it lower (even 0) may improve interactivity (by decreasing response latency.</p><p>æœ‰ä¸¤ç§ä¸´æ—¶ä¿®æ”¹swappinesså‚æ•°çš„æ–¹æ³•ï¼Œç³»ç»Ÿé‡å¯åå¤±æ•ˆ</p><pre>æ–¹æ³•1ï¼š[root@DB-Server ~]# more /proc/sys/vm/swappiness60[root@DB-Server ~]# echo 10 &gt; /proc/sys/vm/swappiness[root@DB-Server ~]# more /proc/sys/vm/swappiness10 æ–¹æ³•2[root@DB-Server ~]#sysctl vm.swappiness=10</pre><p>æ°¸ä¹…ä¿®æ”¹swappinesså‚æ•°çš„æ–¹æ³•å°±æ˜¯åœ¨é…ç½®æ–‡ä»¶/etc/sysctl.confé‡Œé¢ä¿®æ”¹vm.swappinessçš„å€¼ï¼Œç„¶åé‡å¯ç³»ç»Ÿ</p><pre>echo 'vm.swappiness=10' &gt;&gt;/etc/sysctl.conf</pre><p>å¦‚æœæœ‰äººä¼šé—®æ˜¯å¦ç‰©ç†å†…å­˜ä½¿ç”¨åˆ°æŸä¸ªç™¾åˆ†æ¯”åæ‰ä¼šä½¿ç”¨Swapäº¤æ¢ç©ºé—´ï¼Œå¯ä»¥æ˜ç¡®çš„å‘Šè¯‰ä½ ä¸æ˜¯è¿™æ ·ä¸€ä¸ªç®—æ³•ï¼Œå¦‚ä¸‹æˆªå›¾æ‰€ç¤ºï¼ŒåŠæ—¶ç‰©ç†å†…å­˜åªå‰©ä¸‹8Mäº†ï¼Œä½†æ˜¯ä¾ç„¶æ²¡æœ‰ä½¿ç”¨Swapäº¤æ¢ç©ºé—´ï¼Œè€Œå¦å¤–ä¸€ä¸ªä¾‹å­ï¼Œç‰©ç†å†…å­˜è¿˜å‰©ä¸‹19Gï¼Œå±…ç„¶ç”¨äº†ä¸€ç‚¹ç‚¹Swapäº¤æ¢ç©ºé—´ã€‚</p><div class=pgc-img><img alt=Swapäº¤æ¢åˆ†åŒºæ¦‚å¿µ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1538208895294b865968294><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=Swapäº¤æ¢åˆ†åŒºæ¦‚å¿µ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153820889550278669de3d5><p class=pgc-img-caption></p></div><p>å¦å¤–è°ƒæ•´/proc/sys/vm/swappinessè¿™ä¸ªå‚æ•°ï¼Œå¦‚æœä½ æ²¡æœ‰ç»å¯¹æŠŠæ¡ï¼Œå°±ä¸è¦éšä¾¿è°ƒæ•´è¿™ä¸ªå†…æ ¸å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ç¬¦åˆå¤§å¤šæ•°æƒ…å†µä¸‹çš„ä¸€ä¸ªæœ€ä¼˜å€¼ã€‚</p><p><strong>Swapäº¤æ¢åˆ†åŒºå¯¹æ€§èƒ½çš„å½±å“</strong></p><p>æˆ‘ä»¬çŸ¥é“Linuxå¯ä»¥ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªå¸¸è§„æ–‡ä»¶æˆ–ç‹¬ç«‹åˆ†åŒºä½œä¸ºSwapäº¤æ¢ç©ºé—´ï¼Œç›¸å¯¹è€Œè¨€ï¼Œäº¤æ¢åˆ†åŒºè¦å¿«ä¸€äº›ã€‚ä½†æ˜¯å’ŒRAMæ¯”è¾ƒè€Œè¨€ï¼ŒSwapäº¤æ¢åˆ†åŒºçš„æ€§èƒ½ä¾ç„¶æ¯”ä¸ä¸Šç‰©ç†å†…å­˜ï¼Œç›®å‰çš„æœåŠ¡å™¨ä¸ŠRAMåŸºæœ¬ä¸Šéƒ½ç›¸å½“å……è¶³ï¼Œé‚£ä¹ˆæ˜¯å¦å¯ä»¥è€ƒè™‘æŠ›å¼ƒSwapäº¤æ¢åˆ†åŒºï¼Œæ˜¯å¦ä¸éœ€è¦ä¿ç•™Swapäº¤æ¢åˆ†åŒºå‘¢ï¼Ÿè¿™ä¸ªå…¶å®æ˜¯æˆ‘çš„ç–‘é—®ä¹‹ä¸€ã€‚åœ¨è¿™ç¯‡What Is a Linux SWAP Partition, And What Does It Do?åšå®¢ä¸­ï¼Œä½œè€…ç»™å‡ºäº†swapäº¤æ¢ç©ºé—´çš„ä¼˜åŠ£</p><p><strong>Advantages:</strong></p><ol><li>Provides overflow space when your memory fills up completely</li><li>Can move rarely-needed items away from your high-speed memory</li><li>Allows you to hibernate</li></ol><p><strong>Disadvantages:</strong></p><ol><li>Takes up space on your hard drive as SWAP partitions do not resize dynamically</li><li>Can increase wear and tear to your hard drive</li><li>Does not necessarily improve performance (see below)</li></ol><p>å…¶å®ä¿ç•™swapåˆ†åŒºæ¦‚æ‹¬èµ·æ¥å¯ä»¥ä»ä¸‹é¢æ¥çœ‹ï¼š</p><p>é¦–å…ˆï¼Œå½“ç‰©ç†å†…å­˜ä¸è¶³ä»¥æ”¯æ’‘ç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºï¼ˆè¿›ç¨‹ï¼‰çš„è¿ä½œæ—¶ï¼Œè¿™ä¸ªSwapäº¤æ¢åˆ†åŒºå¯ä»¥ç”¨ä½œä¸´æ—¶å­˜æ”¾ä½¿ç”¨ç‡ä¸é«˜çš„å†…å­˜åˆ†é¡µï¼ŒæŠŠè…¾å‡ºçš„å†…å­˜äº¤ç»™æ€¥éœ€çš„åº”ç”¨ç¨‹åºï¼ˆè¿›ç¨‹ï¼‰ä½¿ç”¨ã€‚æœ‰ç‚¹ç±»ä¼¼æœºæˆ¿çš„UPSç³»ç»Ÿï¼Œè™½ç„¶æ­£å¸¸æƒ…å†µä¸‹ä¸éœ€è¦ä½¿ç”¨ï¼Œä½†æ˜¯å¼‚å¸¸æƒ…å†µä¸‹ï¼Œ Swapäº¤æ¢åˆ†åŒºè¿˜æ˜¯ä¼šå‘æŒ¥å…¶å…³é”®ä½œç”¨ã€‚</p><p>å…¶æ¬¡ï¼Œå³ä½¿ä½ çš„æœåŠ¡å™¨æ‹¥æœ‰è¶³å¤Ÿå¤šçš„ç‰©ç†å†…å­˜ï¼Œä¹Ÿæœ‰ä¸€äº›ç¨‹åºä¼šåœ¨å®ƒä»¬åˆå§‹åŒ–æ—¶æ®‹ç•™çš„æå°‘å†ç”¨åˆ°çš„å†…å­˜åˆ†é¡µå†…å®¹è½¬ç§»åˆ° swap ç©ºé—´ï¼Œä»¥æ­¤è®©å‡ºç‰©ç†å†…å­˜ç©ºé—´ã€‚å¯¹äºæœ‰å‘ç”Ÿå†…å­˜æ³„æ¼æœºç‡çš„åº”ç”¨ç¨‹åºï¼ˆè¿›ç¨‹ï¼‰ï¼ŒSwapäº¤æ¢åˆ†åŒºæ›´æ˜¯é‡è¦ï¼Œå› ä¸ºè°ä¹Ÿä¸æƒ³çœ‹åˆ°ç”±äºç‰©ç†å†…å­˜ä¸è¶³å¯¼è‡´ç³»ç»Ÿå´©æºƒã€‚</p><p>æœ€åï¼Œç°åœ¨å¾ˆå¤šä¸ªäººç”¨æˆ·åœ¨ä½¿ç”¨Linuxï¼Œæœ‰äº›ç”šè‡³æ˜¯PCçš„è™šæ‹Ÿæœºä¸Šè·‘Linuxç³»ç»Ÿï¼Œæ­¤æ—¶å¯èƒ½å¸¸ç”¨åˆ°ä¼‘çœ ï¼ˆHibernateï¼‰ï¼Œè¿™ç§æƒ…å†µä¸‹ä¹Ÿæ˜¯æ¨èåˆ’åˆ†Swapäº¤æ¢åˆ†åŒºçš„ã€‚</p><p>å…¶å®å°‘é‡ä½¿ç”¨Swapäº¤æ¢ç©ºé—´æ˜¯ä¸ä¼šå½±å“æ€§èƒ½ï¼Œåªæœ‰å½“RAMèµ„æºå‡ºç°ç“¶é¢ˆæˆ–è€…å†…å­˜æ³„éœ²ï¼Œè¿›ç¨‹å¼‚å¸¸æ—¶å¯¼è‡´é¢‘ç¹ã€å¤§é‡ä½¿ç”¨äº¤æ¢åˆ†åŒºæ‰ä¼šå¯¼è‡´ä¸¥é‡æ€§èƒ½é—®é¢˜ã€‚å¦å¤–ä½¿ç”¨Swapäº¤æ¢åˆ†åŒºé¢‘ç¹ï¼Œè¿˜ä¼šå¼•èµ·kswapd0è¿›ç¨‹ï¼ˆè™šæ‹Ÿå†…å­˜ç®¡ç†ä¸­, è´Ÿè´£æ¢é¡µçš„ï¼‰è€—ç”¨å¤§é‡CPUèµ„æºï¼Œå¯¼è‡´CPUé£™å‡ã€‚</p><p>å…³äºSwapåˆ†åŒºçš„ä¼˜åŠ£ä»¥åŠæ˜¯å¦åº”è¯¥èˆå¼ƒï¼Œæˆ‘æœ‰ç‚¹æ¶è¶£å‘³çš„æƒ³åˆ°äº†è¿™ä¸ªäº‹æƒ…ï¼šäººèº«ä¸Šçš„ä¸¤ä¸ªå™¨å®˜ï¼Œé˜‘å°¾å’Œæ‰æ¡ƒä½“ã€‚åˆ‡é™¤é˜‘å°¾æˆ–æ‰æ¡ƒä½“æ˜¯å¦ä¹Ÿæ˜¯äº‰è®ºä¸ä¼‘ã€‚å¦å¤–ï¼Œå…¶å®ä¸è¦Swapäº¤æ¢åˆ†åŒºï¼ŒLinuxä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„ï¼ˆæœ‰äººæåŠè¿‡è¿™ä¸ªé—®é¢˜ï¼‰</p><p><strong>è°ƒæ•´Swapåˆ†åŒºçš„å¤§å°</strong></p><p>å¦‚ä¸‹æµ‹è¯•æ¡ˆä¾‹æ‰€ç¤ºï¼ŒSwapåˆ†åŒºå¤§å°ä¸º65535Mï¼Œæˆ‘ç°åœ¨æƒ³å°†Swapåˆ†åŒºè°ƒæ•´ä¸º8Gï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹çœ‹å…·ä½“æ“ä½œå§</p><p>1ï¼šæŸ¥çœ‹Swapçš„ä½¿ç”¨æƒ…å†µä»¥åŠç›¸å…³ä¿¡æ¯</p><pre>[root@getlnx14uat ~]# swapon -sFilename Type Size Used Priority/dev/mapper/VolGroup00-LogVol01 partition 67108856 878880 -1[root@getlnx14uat ~]# free -m total used free shared buffers cachedMem: 3957 3920 36 0 39 3055-/+ buffers/cache: 825 3132Swap: 65535 858 64677</pre><p>2ï¼š å…³é—­Swapäº¤æ¢åˆ†åŒº</p><pre>[root@getlnx14uat ~]# swapoff /dev/mapper/VolGroup00-LogVol01[root@getlnx14uat ~]# swapon -sFilename Type Size Used Priority</pre><p>3ï¼š è¿™é‡Œæ˜¯ç¼©å°Swapåˆ†åŒºå¤§å°ï¼Œå¦‚æœæ˜¯å¢å¤§Swapåˆ†åŒºå¤§å°ï¼Œé‚£ä¹ˆå°±éœ€è¦æ‰©å±•æ­£åœ¨ä½¿ç”¨çš„swapåˆ†åŒºçš„é€»è¾‘å·,æ­¤å¤„ä½¿ç”¨lvreduceå‘½ä»¤æ”¶ç¼©é€»è¾‘å·ã€‚</p><pre>[root@getlnx14uat ~]# lvreduce -L 8G /dev/mapper/VolGroup00-LogVol01 WARNING: Reducing active logical volume to 8.00 GB THIS MAY DESTROY YOUR DATA (filesystem etc.)Do you really want to reduce LogVol01? [y/n]: y Reducing logical volume LogVol01 to 8.00 GB Logical volume LogVol01 successfully resized</pre><p>4ï¼šæ ¼å¼åŒ–swapåˆ†åŒº</p><pre>[root@getlnx14uat ~]# mkswap /dev/mapper/VolGroup00-LogVol01Setting up swapspace version 1, size = 8589930 kB</pre><p>5:å¯åŠ¨swapåˆ†åŒº,å¹¶å¢åŠ åˆ°/etc/fstabè‡ªåŠ¨æŒ‚è½½</p><pre>[root@getlnx14uat ~]# swapon -sFilename Type Size Used Priority[root@getlnx14uat ~]# swapon /dev/mapper/VolGroup00-LogVol01[root@getlnx14uat ~]# swapon -sFilename Type Size Used Priority/dev/mapper/VolGroup00-LogVol01 partition 8388600 0 -1</pre><div class=pgc-img><img alt=Swapäº¤æ¢åˆ†åŒºæ¦‚å¿µ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/15382088954441d1d43e0dd><p class=pgc-img-caption></p></div><p><strong>å‚è€ƒèµ„æ–™ï¼š</strong></p><p>https://wiki.archlinux.org/index.php/swap</p><p><u>http://blog.csdn.net/tianlesoftware/article/details/8741873</u></p><p><u>http://www.makeuseof.com/tag/swap-partition/</u></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Swap','äº¤æ¢','åˆ†åŒº'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>