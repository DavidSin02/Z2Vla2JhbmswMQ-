<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>C++æ ¸å¿ƒå‡†åˆ™T.1:ä½¿ç”¨æ¨¡æ¿æé«˜ä»£ç çš„æŠ½è±¡æ°´å¹³ | æå®¢å¿«è¨Š</title><meta property="og:title" content="C++æ ¸å¿ƒå‡†åˆ™T.1:ä½¿ç”¨æ¨¡æ¿æé«˜ä»£ç çš„æŠ½è±¡æ°´å¹³ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/0730d36e8efa4c9eab39a51418011e18"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/50f810bd.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/50f810bd.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/50f810bd.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/50f810bd.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/50f810bd.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/50f810bd.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/50f810bd.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/50f810bd.html><meta property="article:published_time" content="2020-11-14T21:00:09+08:00"><meta property="article:modified_time" content="2020-11-14T21:00:09+08:00"><meta name=Keywords content><meta name=description content="C++æ ¸å¿ƒå‡†åˆ™T.1:ä½¿ç”¨æ¨¡æ¿æé«˜ä»£ç çš„æŠ½è±¡æ°´å¹³"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/50f810bd.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>C++æ ¸å¿ƒå‡†åˆ™T.1:ä½¿ç”¨æ¨¡æ¿æé«˜ä»£ç çš„æŠ½è±¡æ°´å¹³</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div class=pgc-img><img alt=C++æ ¸å¿ƒå‡†åˆ™T.1:ä½¿ç”¨æ¨¡æ¿æé«˜ä»£ç çš„æŠ½è±¡æ°´å¹³ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0730d36e8efa4c9eab39a51418011e18><p class=pgc-img-caption>æœˆå­£</p></div><h1 class=pgc-h-arrow-right>T.1: Use templates to raise the level of abstraction of code</h1><h1 class=pgc-h-arrow-right>T.1:ä½¿ç”¨æ¨¡æ¿æé«˜ä»£ç çš„æŠ½è±¡æ°´å¹³</h1><p><strong>Reasonï¼ˆåŸå› ï¼‰</strong></p><p style=text-align:justify>Generality. Reuse. Efficiency. Encourages consistent definition of user types.</p><p style=text-align:justify>æ™®éæ€§ã€‚é‡ç”¨ã€‚æ•ˆç‡ã€‚é¼“åŠ±ç”¨æˆ·ç±»å‹çš„ä¸€è‡´æ€§ã€‚</p><p style=text-align:justify><strong>Example, badï¼ˆåé¢ç¤ºä¾‹ï¼‰</strong></p><p style=text-align:justify>Conceptually, the following requirements are wrong because what we want of T is more than just the very low-level concepts of "can be incremented" or "can be added":</p><p style=text-align:justify>æ¦‚å¿µä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›Tä¸ä»…é™äºå¯ä»¥è¿›è¡Œå¢é‡æ“ä½œæˆ–è€…å¯ä»¥ä½œä¸ºè¢«åŠ æ•°è¿™æ ·éå¸¸ä½æ°´å¹³çš„æ¦‚å¿µï¼Œå› æ­¤ä¸‹é¢çš„éœ€æ±‚æ˜¯é”™è¯¯çš„ã€‚</p><pre><code>template&lt;typename T&gt;    // requires Incrementable&lt;T&gt;T sum1(vector&lt;T&gt;&amp; v, T s){    for (auto x : v) s += x;    return s;}template&lt;typename T&gt;    // requires Simple_number&lt;T&gt;T sum2(vector&lt;T&gt;&amp; v, T s){    for (auto x : v) s = s + x;    return s;}</code></pre><p style=text-align:justify>Assuming that Incrementable does not support+ and Simple_number does not support +=, we have overconstrained implementers of sum1 and sum2. And, in this case, missed an opportunity for a generalization.</p><p style=text-align:justify>å‡è®¾Incrementableä¸æ”¯æŒ+è€Œä¸”Simple_numberä¸æ”¯æŒ+=ï¼Œæˆ‘ä»¬è¿‡åˆ†çº¦æŸäº†sum1å’Œsum2çš„å®ç°è€…ã€‚è€Œä¸”ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¤±å»äº†æ³›åŒ–çš„æœºä¼šã€‚</p><p style=text-align:justify><strong>Exampleï¼ˆç¤ºä¾‹ï¼‰</strong></p><pre><code>template&lt;typename T&gt;    // requires Arithmetic&lt;T&gt;T sum(vector&lt;T&gt;&amp; v, T s){    for (auto x : v) s += x;    return s;}</code></pre><p style=text-align:justify>Assuming that Arithmetic requires both + and +=, we have constrained the user of sum to provide a complete arithmetic type. That is not a minimal requirement, but it gives the implementer of algorithms much needed freedom and ensures that any Arithmetic type can be used for a wide variety of algorithms.</p><p style=text-align:justify>å‡è®¾ç®—æœ¯è¿ç®—æ—¢éœ€è¦+ä¹Ÿéœ€è¦+=ï¼Œæˆ‘ä»¬å·²ç»è¦æ±‚sumçš„ç”¨æˆ·æä¾›å®Œå…¨çš„ç®—æœ¯ç±»å‹ã€‚è¿™ä¸æ˜¯æœ€å°åŒ–çš„éœ€æ±‚ï¼Œä½†æ˜¯å®ƒä¸ºç®—æ³•çš„å®ç°è€…æä¾›äº†æ‰€éœ€çš„æ›´å¤šè‡ªç”±ï¼Œè€Œä¸”ä¿è¯ç®—æœ¯ç±»å‹å¯ä»¥ç”¨äºå¤šç§å¤šæ ·çš„ç®—æ³•ã€‚</p><p style=text-align:justify>For additional generality and reusability, we could also use a more general Container or Range concept instead of committing to only one container, vector.</p><p style=text-align:justify>ä¸ºäº†é¢å¤–çš„æ³›ç”¨æ€§å’Œé‡ç”¨æ€§ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æ›´é€šç”¨çš„å®¹å™¨æˆ–èŒƒå›´æ¦‚å¿µä»£æ›¿ç‰¹å®šçš„å®¹å™¨vectorã€‚</p><p style=text-align:justify><strong>Noteï¼ˆæ³¨æ„ï¼‰</strong></p><p style=text-align:justify>If we define a template to require exactly the operations required for a single implementation of a single algorithm (e.g., requiring just += rather than also = and +) and only those, we have overconstrained maintainers. We aim to minimize requirements on template arguments, but the absolutely minimal requirements of an implementation is rarely a meaningful concept.</p><p style=text-align:justify>å¦‚æœæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªè¦æ±‚ç”¨äºç‰¹å®šç®—æ³•çš„ç‰¹å®šå®ç°çš„æ“ä½œçš„æ¨¡æ¿ï¼ˆä¾‹å¦‚åªè¦æ±‚+=è€Œä¸åŒæ—¶è¦æ±‚=å’Œ+ï¼‰è€Œä¸”åªè¦æ±‚è¿™äº›ï¼Œæˆ‘ä»¬å°±è¿‡åˆ†çº¦æŸç»´æŠ¤è€…äº†ã€‚æˆ‘ä»¬çš„ç›®çš„åœ¨äºæœ€å°åŒ–æ¨¡æ¿å‚æ•°çš„éœ€æ±‚ï¼Œä½†æ˜¯æŸä¸€å®ç°çš„ç»å¯¹æœ€å°éœ€æ±‚å‡ ä¹ä¸ä¼šæˆä¸ºæœ‰æ„ä¹‰çš„æ¦‚å¿µã€‚</p><p style=text-align:justify><strong>Noteï¼ˆæ³¨æ„ï¼‰</strong></p><p style=text-align:justify>Templates can be used to express essentially everything (they are Turing complete), but the aim of generic programming (as expressed using templates) is to efficiently generalize operations/algorithms over a set of types with similar semantic properties.</p><p style=text-align:justify>æ¨¡æ¿å¯ä»¥ç”¨äºä»æœ¬è´¨ä¸Šè¡¨è¾¾ä»»ä½•ä¸œè¥¿ï¼ˆå®ƒä»¬å…·å¤‡å›¾çµå®Œå¤‡æ€§ï¼‰ï¼Œä½†æ˜¯æ³›å‹ç¼–ç¨‹çš„ç›®çš„ï¼ˆåƒä½¿ç”¨æ¨¡æ¿è¡¨è¾¾çš„é‚£æ ·ï¼‰æ˜¯é«˜æ•ˆæ¦‚æ‹¬å¯ä»¥é€‚ç”¨äºå…·æœ‰ç›¸ä¼¼è¯­ä¹‰å±æ€§ä¸€å¥—ç±»å‹çš„æ“ä½œ/ç®—æ³•ã€‚</p><p style=text-align:justify><strong>Noteï¼ˆæ³¨æ„ï¼‰</strong></p><p style=text-align:justify>The requires in the comments are uses of concepts. "Concepts" are defined in an ISO Technical Specification: concepts. Concepts are supported in GCC 6.1 and later. Consequently, we comment out uses of concepts in examples; that is, we use them as formalized comments only. If you use GCC 6.1 or later, you can uncomment them.</p><p style=text-align:justify>æ³¨é‡Šä¸­çš„éœ€æ±‚æ˜¯conceptçš„ç”¨æ³•ã€‚â€œConceptsâ€è¢«å®šä¹‰åœ¨ISOæŠ€æœ¯è§„æ ¼ä¸­ã€‚GCC6.1ä¹‹åçš„ç‰ˆæœ¬éƒ½æ”¯æŒConceptsã€‚å› æ­¤ï¼Œåœ¨ä¾‹å­ä¸­æˆ‘ä»¬æ³¨é‡Šæ‰ç›¸å…³ä»£ç ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åªå°†å®ƒä»¬ç”¨ä½œæ ‡å‡†æ³¨é‡Šã€‚å¦‚æœä½ ä½¿ç”¨GCC6.1ä¹‹åçš„ç‰ˆæœ¬ï¼Œä½ å¯ä»¥å»æ‰æ³¨é‡Šç¬¦å·ã€‚</p><p style=text-align:justify>è¯‘è€…æ³¨ï¼šconceptsæ–‡æ¡£é“¾æ¥ï¼š</p><p style=text-align:justify>http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4553.pdf</p><p style=text-align:justify><strong>Enforcementï¼ˆå®æ–½å»ºè®®ï¼‰</strong></p><ul><li>Flag algorithms with "overly simple" requirements, such as direct use of specific operators without a concept.</li><li>æ ‡è®°éœ€æ±‚è¿‡äºç®€å•çš„ç®—æ³•ï¼Œä¾‹å¦‚ä¸ç”¨conceptè€Œç›´æ¥ä½¿ç”¨ç‰¹å®šæ“ä½œç¬¦ã€‚</li><li>Do not flag the definition of the "overly simple" concepts themselves; they may simply be building blocks for more useful concepts.</li><li>ä¸è¦æ ‡è®°å®šä¹‰è¿‡äºç®€å•çš„conceptæœ¬èº«ï¼›å®ƒä»¬æ²¡å‡†åªæ˜¯ä½œä¸ºæŸä¸ªæ›´æœ‰ç”¨çš„conceptçš„ä¸€éƒ¨åˆ†å­˜åœ¨çš„ã€‚</li></ul><p style=text-align:justify><strong>åŸæ–‡é“¾æ¥</strong></p><p style=text-align:justify>https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#t1-use-templates-to-raise-the-level-of-abstraction-of-code</p><p style=text-align:justify><strong>æ–°ä¹¦ä»‹ç»</strong></p><p style=text-align:justify>ã€Šå®æˆ˜Pythonè®¾è®¡æ¨¡å¼ã€‹ä¸€ä¹¦æ˜¯ä½œè€…æœ€è¿‘å‡ºç‰ˆçš„æ–°ä¹¦ï¼Œæ‹œæ‰˜å¤šå¤šå…³æ³¨ï¼</p><div class=pgc-img><img alt=C++æ ¸å¿ƒå‡†åˆ™T.1:ä½¿ç”¨æ¨¡æ¿æé«˜ä»£ç çš„æŠ½è±¡æ°´å¹³ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6f9f0a02597a452f892d70f9fbfe934e><p class=pgc-img-caption></p></div><p style=text-align:justify>æœ¬ä¹¦åˆ©ç”¨Python çš„æ ‡å‡†GUI å·¥å…·åŒ…tkinterï¼Œé€šè¿‡å¯æ‰§è¡Œçš„ç¤ºä¾‹å¯¹23 ä¸ªè®¾è®¡æ¨¡å¼é€ä¸ªè¿›è¡Œè¯´æ˜ã€‚è¿™æ ·ä¸€æ–¹é¢å¯ä»¥ä½¿è¯»è€…äº†è§£çœŸå®çš„è½¯ä»¶å¼€å‘å·¥ä½œä¸­æ¯ä¸ªè®¾è®¡æ¨¡å¼çš„è¿ç”¨åœºæ™¯å’Œæƒ³è¦è§£å†³çš„é—®é¢˜ï¼›å¦ä¸€æ–¹é¢é€šè¿‡å¯¹è¿™äº›é—®é¢˜çš„è§£å†³è¿‡ç¨‹è¿›è¡Œè¯´æ˜ï¼Œè®©è¯»è€…æ˜ç™½åœ¨ç¼–å†™ä»£ç æ—¶å¦‚ä½•åˆ¤æ–­ä½¿ç”¨è®¾è®¡æ¨¡å¼çš„åˆ©å¼Šï¼Œå¹¶åˆç†è¿ç”¨è®¾è®¡æ¨¡å¼ã€‚</p><p style=text-align:justify>å¯¹è®¾è®¡æ¨¡å¼æ„Ÿå…´è¶£è€Œä¸”å¸Œæœ›éšå­¦éšç”¨çš„è¯»è€…é€šè¿‡æœ¬ä¹¦å¯ä»¥å¿«é€Ÿè·¨è¶Šä»ç†è§£åˆ°è¿ç”¨çš„é—¨æ§›ï¼›å¸Œæœ›å­¦ä¹ Python GUI ç¼–ç¨‹çš„è¯»è€…å¯ä»¥å°†æœ¬ä¹¦ä¸­çš„ç¤ºä¾‹ä½œä¸ºè®¾è®¡å’Œå¼€å‘çš„å‚è€ƒï¼›ä½¿ç”¨Python è¯­è¨€è¿›è¡Œå›¾åƒåˆ†æã€æ•°æ®å¤„ç†å·¥ä½œçš„è¯»è€…å¯ä»¥ç›´æ¥ä»¥æœ¬ä¹¦ä¸­çš„ç¤ºä¾‹ä¸ºåŸºç¡€ï¼Œè¿…é€Ÿæ„å»ºè‡ªå·±çš„ç³»ç»Ÿæ¶æ„ã€‚</p><p style=text-align:justify><br></p><hr><p style=text-align:justify><br></p><p style=text-align:center>è§‰å¾—æœ¬æ–‡æœ‰å¸®åŠ©ï¼Ÿè¯·åˆ†äº«ç»™æ›´å¤šäººã€‚</p><p style=text-align:center>å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ã€é¢å‘å¯¹è±¡æ€è€ƒã€‘è½»æ¾å­¦ä¹ æ¯ä¸€å¤©ï¼</p><p style=text-align:center>é¢å‘å¯¹è±¡å¼€å‘ï¼Œé¢å‘å¯¹è±¡æ€è€ƒï¼</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'C++','å‡†åˆ™','T.1'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>