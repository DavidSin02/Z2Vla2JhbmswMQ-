<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”» | æå®¢å¿«è¨Š</title><meta property="og:title" content="æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”» - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/ee4f15e064504e11869881b7ee7dbd0d"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/55db463.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/55db463.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/55db463.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/55db463.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/55db463.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/55db463.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/55db463.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/55db463.html><meta property="article:published_time" content="2020-10-29T20:50:38+08:00"><meta property="article:modified_time" content="2020-10-29T20:50:38+08:00"><meta name=Keywords content><meta name=description content="æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”»"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/55db463.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”»</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>ä¸€ã€PropertyValuesHolder</h1><p>é˜…è¯»æœ¬æ–‡éœ€è¦ä¸Šä¸€æœ¬Androidå±æ€§åŠ¨ç”»çš„åŸºç¡€ï¼Œè¿™æ ·æ‰å¯ä»¥æ˜ç™½æ¥ä¸‹æ¥è¦è®²ä»€ä¹ˆã€‚</p><h2 class=pgc-h-arrow-right>1.ç†è§£å’Œä½¿ç”¨</h2><p>PropertyValuesHolder æ˜¯ObjectAnimationç±»ä¼¼çš„ä¸€ä¸ªæ–¹æ³•ï¼Œåªæ˜¯å°‘äº†ä¸€ä¸ªtargetï¼Œå°±æ˜¯è¦æ‰§è¡Œçš„æ§ä»¶ã€‚çœ‹çœ‹æ­£å¸¸çš„ä½¿ç”¨æ–¹æ³•ï¼šä¼šåŒæ—¶æ‰§è¡Œå…¨éƒ¨çš„Holder</p><pre><code>public void  doPropertyValuesHolder(){        //å®šä¹‰ä¸€ä¸ªæ—‹è½¬Holder        PropertyValuesHolder rotationHolder=                PropertyValuesHolder.ofFloat(                        "rotation",                        60f,40f,100f,-60f,40f,88f,77f);        //å®šä¹‰ä¸€ä¸ªé€æ˜Holder        PropertyValuesHolder alphaHolder=                PropertyValuesHolder.ofFloat(                        "alpha",                        0.01f,0.5f,1.0f,0.8f,0.2f,0.0f);        //åŠ è½½è¿›ObjectAnimator        ObjectAnimator objectAnimator=ObjectAnimator.ofPropertyValuesHolder(ballImageView,rotationHolder,alphaHolder);        objectAnimator.setDuration(3000);        objectAnimator.start();    }</code></pre><h2 class=pgc-h-arrow-right>2.æ–¹æ³•å’Œå‚æ•°</h2><p>å¯ä»¥çœ‹çœ‹è¿™ä¸ªæ–¹æ³•çš„å‚æ•°ï¼š</p><pre><code>ObjectAnimator ofPropertyValuesHolder(Object target,PropertyValuesHolder... values)</code></pre><pre><code>PropertyValuesHolder ofFloat(String propertyName, float... values)</code></pre><p>Object target æ˜¯è¦æ˜¾ç¤ºåŠ¨ç”»çš„æ§ä»¶</p><p>PropertyValuesHolder... values è£…è½½å¤šä¸ªPropertyValuesHolder</p><p>String propertyName ä»£è¡¨è¦åå°„çš„å‚æ•°ï¼Œè·ŸObjectAnimationçš„å‚æ•°æ˜¯ä¸€æ ·çš„</p><p>float... values ä»£è¡¨æ˜¯å¯å˜é•¿å‚æ•° è¿™æ ·çš„æ–¹æ³•è¿˜æœ‰ä»¥ä¸‹å›¾ç‰‡è¿™äº›ï¼š</p><div class=pgc-img><img alt=æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”» onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ee4f15e064504e11869881b7ee7dbd0d><p class=pgc-img-caption></p></div><p>å…¶ä¸­ofObject()æ–¹æ³• ï¼Œä¹Ÿæ˜¯è·ŸObjectAnimationçš„ç›¸ä¼¼ï¼Œä¹Ÿæ˜¯è¦è‡ªå®šä¹‰TypeEvaluatorã€‚</p><div class=pgc-img><img alt=æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”» onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c20d7deef644470a8e143dd181aceb86><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>äºŒã€Keyframe</h1><h2 class=pgc-h-arrow-right>1.ç†è§£å’Œä½¿ç”¨</h2><p>çœ‹åå­—ï¼Œå°±æ˜¯ç†è§£ä¸ºå…³é”®å¸§çš„æ„æ€ï¼Œåœ¨åŠ¨ç”»ä¸­ï¼Œåœ¨æŸå¸§åšä¸€äº›æ“ä½œï¼Œä»è€Œå®ç°å¯¹æ¯”æ•ˆæœæ¯”è¾ƒæ˜æ˜¾çš„æ•ˆæœã€‚ å…³é”®å¸§è¡¨ç¤ºæ˜¯æŸä¸ªç‰©ä½“åœ¨å“ªä¸ªæ—¶é—´ç‚¹åº”è¯¥åœ¨å“ªä¸ªä½ç½®ä¸Šã€‚ å…·ä½“ä½¿ç”¨ï¼š</p><pre><code> public void  doPropertyValuesHolderKeyFrame(){        //å¤´keyframe1ï¼Œä»è¿›åº¦0.6å¼€å§‹ï¼Œåœ¨è¿›åº¦60%çš„æ—¶å€™ï¼Œæ•°å€¼æ˜¯0.1f        Keyframe keyframe1=Keyframe.ofFloat(0.6f,0.1f);        //ä¸­é—´keyframe2        Keyframe keyframe2=Keyframe.ofFloat(0.1f,0.8f);        //å°¾éƒ¨keyframe3ï¼Œä»¥50%è¿›åº¦ä½œä¸ºç»“æŸï¼Œè¿™æ—¶å€™çš„æ•°å€¼ä¸º0.2f        Keyframe keyframe3=Keyframe.ofFloat(0.5f,0.2f);        //è£…è½½åˆ°Holderä¸­ï¼Œå¹¶è®¾ç½®è¦åå°„çš„æ–¹æ³•ï¼Œè¿™æ˜¯åå°„çš„æ˜¯setAlpha()æ–¹æ³•ï¼Œæ§åˆ¶é€æ˜åº¦        PropertyValuesHolder alphaHolder=PropertyValuesHolder.ofKeyframe("alpha",keyframe1,keyframe2,keyframe3);        //æŠŠè£…è½½åˆ°Holderä¸­è£…è½½åˆ°ObjectAnimatoræˆ–è€…ValueAnimation        ObjectAnimator objectAnimator=ObjectAnimator.ofPropertyValuesHolder(ballImageView,alphaHolder);        objectAnimator.setDuration(3000);        objectAnimator.start();    }</code></pre><h2 class=pgc-h-arrow-right>2.æ–¹æ³•å’Œå‚æ•°</h2><pre><code>Keyframe ofFloat(float fraction, float value)</code></pre><p>float fraction è¡¨ç¤ºè¿›åº¦</p><p>float value è¡¨ç¤ºåœ¨è¿™ä¸ªè¿›åº¦ä¸‹çš„æ•°å€¼</p><pre><code> PropertyValuesHolder ofKeyframe(String propertyName, Keyframe... values)</code></pre><p>String propertyName è¦åå°„çš„setæ–¹æ³•</p><p>Keyframe... values ä¼ å…¥Keyframe</p><p>Keyframeçš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯å’Œå…¶ä»–çš„ç±»ä¼¼çš„ã€‚</p><div class=pgc-img><img alt=æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”» onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a376cc480be040d29b655e1d4071d467><p class=pgc-img-caption></p></div><p>Keyframeçš„setæ–¹æ³•ï¼Œè®¾ç½®è¿›åº¦ï¼Œæ’å€¼å™¨ï¼Œæ•°å€¼ã€‚ æ²¡æœ‰è®¾ç½®æ’å€¼å™¨çš„æ—¶å€™ï¼Œé»˜è®¤æ˜¯çº¿æ€§æ’å€¼å™¨</p><pre><code> keyframe1.setInterpolator(new LinearInterpolator()); //é»˜è®¤çº¿æ€§æ’å€¼å™¨</code></pre><div class=pgc-img><img alt=æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”» onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fbb2b7bfe53e4c13a2d95d25f1d731d6><p class=pgc-img-caption></p></div><h2 class=pgc-h-arrow-right>3.å¸§çš„æ“ä½œ</h2><p>ç›´æ¥å†™ç»“è®ºï¼š</p><ul><li>å¦‚æœå»æ‰0å¸§ï¼Œåˆ™ä»¥ç¬¬ä¸€ä¸ªå…³é”®å¸§ä¸ºèµ·å§‹ä½ç½®</li><li>å¦‚æœå»æ‰ç»“æŸå¸§ï¼ˆè¿›åº¦ä¸º1ï¼‰ï¼Œåˆ™ä»¥æœ€åä¸€ä¸ªå…³é”®å¸§ä¸ºç»“æŸä½ç½®</li><li>ä½¿ç”¨keyframeæ¥æ„å»ºåŠ¨ç”»ï¼Œè‡³å°‘éœ€è¦2å¸§</li></ul><h1 class=pgc-h-arrow-right>ä¸‰ã€ViewPropertyAnimator</h1><h2 class=pgc-h-arrow-right>1.ç†è§£å’Œä½¿ç”¨</h2><p>å¯ä»¥é€šè¿‡ä¸²è¡Œçš„å½¢å¼ï¼Œå¿«é€Ÿå®šä¹‰åŠ¨ç”»ï¼Œçœå»ä¸€äº›å®šä¹‰ï¼Œåœ¨æ¯æ¬¡ç•Œé¢ç»˜åˆ¶çš„æ—¶å€™ï¼Œå¯åŠ¨åŠ¨ç”»ï¼Œæ¯”å…¶ä»–çš„æ›´èŠ‚çœæ¶ˆè€—ã€‚ æ¯”å¦‚ï¼š</p><pre><code> ballImageView.animate().alpha(0.5f).rotation(360f).scaleX(1.5f).translationX(100f);</code></pre><h2 class=pgc-h-arrow-right>2.å‚æ•°å’Œæ–¹æ³•</h2><p>å¯ä»¥çœ‹åˆ°è¿™äº›æ–¹æ³•çš„è¿”å›å€¼ï¼ŒåŸºæœ¬éƒ½æ˜¯ViewPropertyAnimator</p><div class=pgc-img><img alt=æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”» onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/33e72dc69af4456daf9d5ae696ba8931><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”» onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9c20521105694cf6bcc01577ec0a3091><p class=pgc-img-caption></p></div><p>å†å¼•ç”¨ä¸€å¼ è¡¨æ ¼ï¼š</p><p>å‡½æ•° å«ä¹‰ alpha(float value) è®¾ç½®é€æ˜åº¦ scaleY(float value) è®¾ç½® Yè½´æ–¹å‘çš„ç¼©æ”¾å¤§å° scaleX(float value) è®¾ç½®Xè½´æ–¹å‘çš„ç¼©æ”¾å¤§å° translationY(float value) è®¾ç½®Yè½´æ–¹å‘çš„ç§»åŠ¨å€¼ translationX(float value) è®¾ç½®Xè½´æ–¹å‘çš„ç§»åŠ¨å€¼ rotation(float value) è®¾ç½®ç»•Zè½´æ—‹è½¬åº¦æ•° rotationX(float value) è®¾ç½®ç»•xè½´æ—‹è½¬åº¦æ•° rotationY(float value) è®¾ç½®ç»• Y è½´æ—‹è½¬åº¦æ•° x(float value) ç›¸å¯¹äºçˆ¶å®¹å™¨çš„å·¦ä¸Šè§’åº§æ ‡åœ¨ Xè½´æ–¹å‘çš„æœ€ç»ˆä½ç½® y(float value) ç›¸å¯¹äºçˆ¶å®¹å™¨çš„å·¦ä¸Šè§’åº§æ ‡åœ¨Yè½´æ–¹å‘çš„æœ€ç»ˆä½ç½® alphaBy(float value) è®¾ç½®é€æ˜åº¦å¢é‡ rotationBy(float value) è®¾ç½®ç»•Zè½´æ—‹è½¬å¢é‡ rotationXBy(float value) è®¾ç½®ç»• X æ²¹æ—‹è½¬å¢é‡ rotationYBy(float value) è®¾ç½®ç»ŸYè½´æ—‹è½¬å¢é‡ translationXBy(float value) è®¾ç½®Xè½´æ–¹å‘çš„ç§»åŠ¨å€¼å¢é‡ translationYBy(float value) è®¾ç½®Yè½´æ–¹å‘çš„ç§»åŠ¨å€¼å¢é‡ scaleXBy(float value) è®¾ç½®Xè½´æ–¹å‘çš„ç¼©æ”¾å¤§å°å¢é‡ scaleYBy(float value) è®¾ç½® Yè½´æ–¹å‘çš„ç¼©æ”¾å¤§å°å¢é‡ xBy(float value) ç›¸å¯¹äºçˆ¶å®¹å™¨çš„å·¦ä¸Šè§’åº§æ ‡åœ¨ Xè½´æ–¹å‘çš„ä½ç½®å¢é‡ yBy(float value) ç›¸å¯¹äºçˆ¶å®¹å™¨çš„å·¦ä¸Šè§’åº§æ ‡åœ¨ Yè½´æ–¹å‘çš„ä½ç½®å¢é‡ setlnterpolator(Timelnterpolator interpolator) è®¾ç½®æ’å€¼å™¨ setStartDelay(long startDelay) è®¾ç½®å¼€å§‹å»¶æ—¶ setDuration(long duration) è®¾ç½®åŠ¨ç”»æ—¶é•¿</p><h1 class=pgc-h-arrow-right>å››ã€animateLayoutChanges</h1><p>android:animateLayoutChanges="true" åœ¨LayoutåŠ å…¥æ§ä»¶ï¼Œæˆ–è€…ç§»é™¤æ§ä»¶çš„æ—¶å€™ï¼Œæ·»åŠ åŠ¨ç”»ï¼Œä½†æ˜¯åªèƒ½ä½¿ç”¨é»˜è®¤åŠ¨ç”»ã€‚</p><pre><code> &lt;LinearLayout            android:animateLayoutChanges="true"            android:layout_width="match_parent"            android:layout_height="match_parent"            android:orientation="vertical"/&gt;</code></pre><h1 class=pgc-h-arrow-right>äº”ã€LayoutTransition</h1><p>LayoutTransitionå¯ä»¥æ§åˆ¶ViewGroupçš„åŠ¨ç”»ï¼Œå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„åŠ¨ç”»ã€‚ å…·ä½“ä½¿ç”¨ï¼š</p><pre><code> public void doLayoutTransition(){        LinearLayout linearLayout=new LinearLayout(this);        //1.åˆ›å»ºå®ä¾‹        LayoutTransition transition=new LayoutTransition();        //2.åˆ›å»ºåŠ¨ç”»        ObjectAnimator objectAnimator=ObjectAnimator.ofFloat(null,"rotation",0f,90f,0f);        //3.åŠ¨ç”»å‡ºç°å½¢å¼è¿›è¡Œè®¾ç½®        transition.setAnimator(LayoutTransition.DISAPPEARING,objectAnimator);        //4.å°†LayoutTransitionè®¾ç½®åˆ°ViewGroupä¸­        linearLayout.setLayoutTransition(transition);          //5.å¼€æºåŠ¨ç”»åº“ NineOldAndroids    }</code></pre><p>setAnimator(int transitionType, Animator animator)</p><p>è¿™ä¸ªæ–¹æ³•ä¸­ï¼ŒtransitionTypeæœ‰äº”ä¸ªé€‰é¡¹</p><div class=pgc-img><img alt=æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”» onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/376a1c51788048f99470d2f1c2801260><p class=pgc-img-caption></p></div><p>CHANGE_APPEARING ç”±äºå®¹å™¨ä¸­è¦æ˜¾ç¤ºä¸€ä¸ªæ–°çš„å…ƒç´ ï¼Œå…¶ä»–éœ€è¦å˜åŒ–çš„å…ƒç´ æ‰€åº”ç”¨çš„åŠ¨ç”»ï¼ˆé—®é¢˜å¤šï¼Œä¸å¸¸ç”¨ï¼‰</p><p>_CHANGE_DISAPPEARING_ å½“ä¸ªå®¹å™¨ä¸­æŸä¸ªå…ƒç´ è¦æ¶ˆå¤±æ—¶ï¼Œå…¶ä»–éœ€è¦å˜åŒ–çš„å…ƒç´ æ‰€åº”ç”¨çš„åŠ¨ç”»ï¼ˆé—®é¢˜å¤šï¼Œä¸å¸¸ç”¨ï¼‰</p><p>_CHANGING_ å®¹å™¨ä¸­æ­£åœ¨æ›´æ”¹çš„å…ƒç´ çš„åŠ¨ç”»å˜åŒ–</p><p>_APPEARING_ å…ƒç´ åœ¨å®¹å™¨ä¸­å‡ºç°æ—¶æ‰€å®šä¹‰çš„åŠ¨ç”»</p><p>_DISAPPEARING_ å…ƒç´ åœ¨å®¹å™¨ä¸­æ¶ˆå¤±æ—¶æ‰€å®šä¹‰çš„åŠ¨ç”»</p><h1 class=pgc-h-arrow-right>å…­ã€PathMeasure</h1><p>PathMeasureç±»ä¼¼ä¸€ä¸ªè®¡ç®—å™¨ï¼Œå¯ä»¥è®¡ç®—å‡ºç›®æ ‡pathçš„åº§æ ‡ï¼Œé•¿åº¦ç­‰</p><h2 class=pgc-h-arrow-right>1.åˆå§‹åŒ–</h2><pre><code>  public void doPathMeasure(){        Path path=new Path();        //åˆå§‹åŒ–æ–¹æ³•1        PathMeasure pathMeasure1=new PathMeasure();        pathMeasure1.setPath(path,true);        //åˆå§‹åŒ–æ–¹æ³•2        PathMeasure pathMeasure2=new PathMeasure(path,false);    }</code></pre><p>setPath(Path path, boolean forceClosed) path å°±æ˜¯ä»£è¡¨è¦è®¡ç®—çš„ç›®æ ‡Pathã€‚ forceClosed æ˜¯å¦é—­åˆï¼Œtrueä¼šè®¡ç®—é—­åˆçŠ¶æ€ä¸‹çš„Pathï¼Œfalseä¼šæŒ‰ç…§PathåŸæ¥æƒ…å†µæ¥è®¡ç®—ã€‚</p><h2 class=pgc-h-arrow-right>2.å‡½æ•°è°ƒç”¨</h2><p>è‡ªå®šä¹‰ä¸€ä¸ªview</p><pre><code>public class PathView extends View {    Path mPath;    Paint mPaint;    PathMeasure mPathMeasure;    public PathView(Context context, @Nullable AttributeSet attrs) {        super(context, attrs);        mPath=new Path();        mPaint=new Paint();        mPathMeasure=new PathMeasure();    }    @Override    protected void onDraw(Canvas canvas) {        super.onDraw(canvas);        canvas.translate(250,250); //ç”»å¸ƒç§»åŠ¨        mPaint.setColor(Color.BLUE); //ç”»ç¬”é¢œè‰²        mPaint.setStrokeWidth(5); //ç”»ç¬”ç²—ç»†        mPaint.setStyle(Paint.Style.STROKE); //ç”»ç¬”é£æ ¼        mPath.moveTo(0,0);        mPath.lineTo(0,100);        mPath.lineTo(100,100);        mPath.lineTo(100,0);        mPathMeasure.setPath(mPath,true);        Log.v("showLog",                "getLength()=="+mPathMeasure.getLength()                        +"  isClosed()=="+ mPathMeasure.isClosed()); //ç»“æœ400.0  true        mPathMeasure.setPath(mPath,false);        Log.v("showLog",                "getLength()=="+mPathMeasure.getLength()                        +"  isClosed()=="+ mPathMeasure.isClosed()); //ç»“æœ300.0  false        canvas.drawPath(mPath,mPaint); //ç»˜åˆ¶è·¯å¾„    }}</code></pre><p>ç»˜åˆ¶æ•ˆæœï¼š</p><div class=pgc-img><img alt=æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”» onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/cdb95babbae8487ca5b6ebaa22dd5983><p class=pgc-img-caption></p></div><h3 class=pgc-h-arrow-right>2.1 PathMeasure.getLength()</h3><p>PathMeasure.getLength() å‡½æ•°ç”¨äºæµ‹é‡è·¯å¾„çš„é•¿åº¦</p><h3 class=pgc-h-arrow-right>2.2 PathMeasure.isClosed()</h3><p>PathMeasure.isClosed() å‡½æ•°ç”¨äºè¿”å›æ˜¯å¦æµ‹é‡é—­åˆçŠ¶æ€</p><h3 class=pgc-h-arrow-right>2.3 PathMeasure.nextContour()</h3><pre><code>           mPath.addRect(-50, -50, 50, 50, Path.Direction.CW);        canvas.drawPath(mPath, mPaint);        mPath.addRect(-100, -100, 100, 100, Path.Direction.CW);        canvas.drawPath(mPath, mPaint);        mPath.addRect(-120, -120, 120, 120, Path.Direction.CW);        canvas.drawPath(mPath, mPaint);        mPathMeasure.setPath(mPath, false);        do {            float len = mPathMeasure.getLength();            Log.v("showLog", "len=" + len);        } while (mPathMeasure.nextContour());</code></pre><p>æ•ˆæœï¼š</p><div class=pgc-img><img alt=æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”» onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fd3d920653774afbbfd834f878cb2857><p class=pgc-img-caption></p></div><p>æ‰“å°ç»“æœï¼š</p><pre><code>len=400.0len=800.0len=960.0</code></pre><p>PathMeasure.nextContour()å¾—åˆ°çš„é¡ºåºä¸æ·»åŠ çš„Pathçš„é¡ºåºç›¸åŒ</p><p>PathMeasure.getLength()åªæ˜¯å¾—åˆ°å½“å‰pathçš„é•¿åº¦ï¼Œä¸æ˜¯å…¨éƒ¨çš„é•¿åº¦</p><h3 class=pgc-h-arrow-right>2.3 getSegment()</h3><p>ä½¿ç”¨getSegmentå‡½æ•°éœ€è¦ç¦ç”¨ç¡¬ä»¶åŠ é€Ÿ åœ¨æ„é€ æ–¹æ³•ä¸­åŠ å…¥ setLayerType(LAYER_TYPE_SOFTWARE,null);</p><pre><code>         mPath.addRect(-50, -50, 50, 50, Path.Direction.CW);        mPathMeasure.setPath(mPath,false); //è®¡ç®—çš„path        mPathMeasure.getSegment(0,150,mDstPath,true); //æˆªå–å¹¶æ·»åŠ åˆ°mDstPathï¼Œæ˜¯æ·»åŠ ï¼Œä¸æ˜¯å…¶ä»–        canvas.drawPath(mPath, mPaint); //ç»˜åˆ¶åŸæ¥çš„path        canvas.translate(200,0); //ç”»å¸ƒç§»åŠ¨        mPaint.setColor(Color.RED);        canvas.drawPath(mDstPath, mPaint); //ç»˜åˆ¶æ·»åŠ åçš„mDstPath</code></pre><pre><code> boolean getSegment(float startD, float stopD, Path dst, boolean startWithMoveTo)</code></pre><p>startDpathå¼€å§‹æˆªå–çš„ç‚¹ï¼Œæˆªå–çš„èµ·å§‹ç‚¹ï¼Œæ˜¯ä»¥å·¦ä¸Šè§’çš„ç‚¹å¼€å§‹çš„</p><p>stopDæˆªå–åœæ­¢çš„ç‚¹</p><p>dstæˆªå–åæ·»åŠ åˆ°çš„path</p><p>startWithMoveToæ˜¯å¦ä¿å­˜åŸçŠ¶ï¼Œtrueä¿å­˜åŸæ ·ï¼Œfalseåˆ™ä¼šè¿æ¥åˆå§‹ç‚¹å’Œç»ˆç‚¹ï¼Œå’ŒåŸæ¥çš„ä¸ä¸€å®šç›¸åŒå½¢çŠ¶ ä»¥ä¸Šä»£ç çš„æ•ˆæœ: æˆªå›¾çš„æ–¹å‘ï¼Œä¸åŸæ¥çš„pathçš„ç”Ÿæˆæ–¹å‘æœ‰å…³</p><div class=pgc-img><img alt=æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”» onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/852d4797db5c4b068f32a4f353728fdd><p class=pgc-img-caption></p></div><h3 class=pgc-h-arrow-right>2.4 åŠ¨æ€ç”»åœ†çš„ä¾‹å­</h3><p>ä»£ç ï¼š</p><pre><code>public class PathView extends View {    Path mPath, mDstPath;    Paint mPaint;    PathMeasure mPathMeasure;    float mCurAnimValue;    public PathView(Context context, @Nullable AttributeSet attrs) {        super(context, attrs);        setLayerType(LAYER_TYPE_SOFTWARE, null);        mPath = new Path();        mDstPath = new Path();        mPaint = new Paint();        mPathMeasure = new PathMeasure();        mPaint.setColor(Color.BLUE); //ç”»ç¬”é¢œè‰²        mPaint.setStrokeWidth(5); //ç”»ç¬”ç²—ç»†        mPaint.setStyle(Paint.Style.STROKE); //ç”»ç¬”é£æ ¼        mPath.addCircle(100, 100, 50, Path.Direction.CW); //ä¸€ä¸ªå®Œæ•´çš„åœ†        mPathMeasure.setPath(mPath, true); //è¦è®¡ç®—çš„path        ValueAnimator animator = ValueAnimator.ofFloat(0, 1); //è¿›åº¦ 0~1        animator.setRepeatCount(ValueAnimator.INFINITE); //æ— é™å¾ªç¯        animator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() {            @Override            public void onAnimationUpdate(ValueAnimator animation) {                mCurAnimValue = (Float) animation.getAnimatedValue(); //å¾—åˆ°å½“å‰çš„è¿›åº¦                invalidate();//é‡ç»˜ï¼Œé‡æ–°æ‰§è¡ŒonDraw()æ–¹æ³•            }        });        animator.setDuration(5000);        animator.start();    }    @Override    protected void onDraw(Canvas canvas) {        super.onDraw(canvas);        canvas.translate(100, 100); //ç”»å¸ƒç§»åŠ¨        float stop=mPathMeasure.getLength()*mCurAnimValue; //ä¸€ä¸ªè¿›åº¦ç¡®å®šä¸€ä¸ªæˆªå–ç‚¹        mDstPath.reset();        mPathMeasure.getSegment(0,stop,mDstPath,true); //ä¸€ç‚¹ç‚¹æ·»åŠ         canvas.drawPath(mDstPath,mPaint); //æ¯æ¬¡æœ‰è¿›åº¦æ›´æ–°ï¼Œå°±ç»˜åˆ¶ä¸€å°æ®µæˆªå–    }}</code></pre><p>æ•ˆæœï¼š</p><div class=pgc-img><img alt=æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”» onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/91192788a7424bd79bb6e3985019444a><p class=pgc-img-caption></p></div><h3 class=pgc-h-arrow-right>2.5 getPosTan()</h3><p>å…ˆçœ‹çœ‹å‡½æ•°çš„å®šä¹‰ï¼š</p><pre><code>boolean getPosTan(float distance, float pos[], float tan[]) </code></pre><p>float distance è·ç¦»pathçš„å…¶å®é•¿åº¦</p><p>float pos[] è¯¥ç‚¹çš„åº§æ ‡å€¼ã€‚xå’Œy pos[0]=xï¼Œpos[1]=y</p><p>float tan[] è¯¥ç‚¹çš„æ­£åˆ‡å€¼ã€‚xå’Œy pos[0]=xï¼Œpos[1]=y tan&lt;a=y/x</p><h3 class=pgc-h-arrow-right>2.6 ç®­å¤´ç”»åœ†çš„ä¾‹å­</h3><p>ä»£ç ï¼š</p><pre><code>public class PathView extends View {    Path mPath, mDstPath;    Paint mPaint;    PathMeasure mPathMeasure;    float mCurAnimValue;    Bitmap mArrowBmp;    float[] mPos;    float[] mTan;    int mCenterX,mCenterY;    float mRadius;    public PathView(Context context, @Nullable AttributeSet attrs) {        super(context, attrs);        setLayerType(LAYER_TYPE_SOFTWARE, null);        mPath = new Path();        mDstPath = new Path();        mPaint = new Paint();        mPathMeasure = new PathMeasure();        mPos=new float[2];        mTan=new float[2];        //åŠ è½½ç®­å¤´å›¾ç‰‡        mArrowBmp= BitmapFactory.decodeResource(getResources(), R.drawable.arrow);        mPaint.setColor(Color.BLUE); //ç”»ç¬”é¢œè‰²        mPaint.setStrokeWidth(5); //ç”»ç¬”ç²—ç»†        mPaint.setStyle(Paint.Style.STROKE); //ç”»ç¬”é£æ ¼        mPath.addCircle(540, 972, 486, Path.Direction.CW); //ä¸€ä¸ªå®Œæ•´çš„åœ†        mPathMeasure.setPath(mPath, true); //è¦è®¡ç®—çš„path        ValueAnimator animator = ValueAnimator.ofFloat(0, 1); //è¿›åº¦ 0~1        animator.setRepeatCount(ValueAnimator.INFINITE); //æ— é™å¾ªç¯        animator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() {            @Override            public void onAnimationUpdate(ValueAnimator animation) {                mCurAnimValue = (Float) animation.getAnimatedValue(); //å¾—åˆ°å½“å‰çš„è¿›åº¦                invalidate();//é‡ç»˜ï¼Œé‡æ–°æ‰§è¡ŒonDraw()æ–¹æ³•            }        });        animator.setDuration(5000);        animator.start();    }    @Override    protected void onSizeChanged(int w, int h, int oldw, int oldh) {        /*         * å¾—åˆ°h,wçš„æœ€å°çš„é‚£ä¸ªå€¼;         * &gt;&gt; 1 ç§»ä½ è·Ÿ /2 ç›¸åŒ;         * ä¹˜ä»¥0.9f,è¡¨ç¤ºå å¸ƒå±€çš„90%         * */        mRadius = (Math.min(h, w) &gt;&gt; 1) * 0.9f;        // ä¸­å¿ƒåº§æ ‡        mCenterX = w / 2;        mCenterY = h / 2;        Log.v("showLog",mCenterX+"  "+mCenterY+"  "+mRadius);        postInvalidate();        super.onSizeChanged(w, h, oldw, oldh);    }    @Override    protected void onDraw(Canvas canvas) {        super.onDraw(canvas);        float stop=mPathMeasure.getLength()*mCurAnimValue; //ä¸€ä¸ªè¿›åº¦ç¡®å®šä¸€ä¸ªæˆªå–ç‚¹        mDstPath.reset();        mPathMeasure.getSegment(0,stop,mDstPath,true); //ä¸€ç‚¹ç‚¹æ·»åŠ         canvas.drawPath(mDstPath,mPaint); //æ¯æ¬¡æœ‰è¿›åº¦æ›´æ–°ï¼Œå°±ç»˜åˆ¶ä¸€å°æ®µæˆªå–        mPathMeasure.getPosTan(stop,mPos,mTan); //è·å¾—æ¯ç‚¹çš„æ­£åˆ‡å€¼å’Œåº§æ ‡        /**         *    Math.atan2(mTan[1],mTan[0])è·å¾—tançš„å¼§åº¦å€¼         *    *180.0/Math.PIå°†è½¬åŒ–ä¸ºè§’åº¦å€¼         * */        float degrees=(float)(Math.atan2(mTan[1],mTan[0])*180.0/Math.PI);        Matrix matrix=new Matrix();        /**         * å°†å›¾ç‰‡å›´ç»•ä¸­å¿ƒç‚¹æ—‹è½¬æŒ‡å®šè§’åº¦         * postRotate(float degrees, float px, float py)         * degreesæ˜¯è§’åº¦  ï¼ˆpx,pyï¼‰æ˜¯å›¾ç‰‡ä¸­å¿ƒç‚¹         * */        matrix.postRotate(degrees,mArrowBmp.getWidth()/2,mArrowBmp.getHeight()/2);        /**         * å°†å›¾ç‰‡ä»é»˜è®¤çš„ï¼ˆ0ï¼Œ0ï¼‰ç‚¹ç§»åŠ¨åˆ°è·¯å¾„çš„æœ€å‰ç«¯         * */        matrix.postTranslate(mPos[0]-mArrowBmp.getWidth()/2,mPos[1]-mArrowBmp.getHeight()/2);        //ç»˜åˆ¶å›¾ç‰‡        canvas.drawBitmap(mArrowBmp,matrix,mPaint);    }}</code></pre><p>æ•ˆæœï¼š</p><div class=pgc-img><img alt=æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”» onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/5504f7ffdf344e98b5ba748f9cc7eed3><p class=pgc-img-caption></p></div><h3 class=pgc-h-arrow-right>2.7 getMatrix()</h3><p>å‚æ•°ç±»å‹ï¼š</p><pre><code>boolean getMatrix(float distance, Matrix matrix, int flags)</code></pre><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><pre><code>          //è®¡ç®—æ–¹ä½è§’        Matrix matrix = new Matrix();        //è·å–ä½ç½®ä¿¡æ¯        mPathMeasure.getMatrix(stop,matrix,PathMeasure.POSITION_MATRIX_FLAG);        //è·å–åˆ‡è¾¹ä¿¡æ¯        mPathMeasure.getMatrix(stop,matrix,PathMeasure.TANGENT_MATRIX_FLAG); </code></pre><h3 class=pgc-h-arrow-right>2.8 æ”¯ä»˜æˆåŠŸä¾‹å­</h3><pre><code>public class TickView extends View {    Path mPath, mDstPath;    Paint mPaint;    PathMeasure mPathMeasure;    float mCurAnimValue;    int mCenterX, mCenterY;    float mRadius;    public TickView(Context context, @Nullable AttributeSet attrs) {        super(context, attrs);        setLayerType(LAYER_TYPE_SOFTWARE, null);        mPath = new Path();        mDstPath = new Path();        mPaint = new Paint();        mPathMeasure = new PathMeasure();        mPaint.setColor(Color.BLUE); //ç”»ç¬”é¢œè‰²        mPaint.setStrokeWidth(5); //ç”»ç¬”ç²—ç»†        mPaint.setStyle(Paint.Style.STROKE); //ç”»ç¬”é£æ ¼        mCenterX = 540;        mCenterY = 972;        mRadius = 486 / 2;        /**         * åœ†         * */        mPath.addCircle(mCenterX, mCenterY, mRadius, Path.Direction.CW);        /**         * å¯¹å‹¾         * */        mPath.moveTo(mCenterX - mRadius / 2, mCenterY);        mPath.lineTo(mCenterX, mCenterY + mRadius / 2);        mPath.lineTo(mCenterX + mRadius / 2, mCenterY - mRadius / 3);        mPathMeasure.setPath(mPath, false); //è¦è®¡ç®—çš„path        ValueAnimator animator = ValueAnimator.ofFloat(0, 2); //è¿›åº¦ 0~1 æ˜¯åœ†ï¼Œ1~2æ˜¯å¯¹å‹¾        animator.setRepeatCount(ValueAnimator.RESTART);        animator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() {            @Override            public void onAnimationUpdate(ValueAnimator animation) {                mCurAnimValue = (Float) animation.getAnimatedValue(); //å¾—åˆ°å½“å‰çš„è¿›åº¦                invalidate();//é‡ç»˜ï¼Œé‡æ–°æ‰§è¡ŒonDraw()æ–¹æ³•            }        });        animator.setDuration(5000);        animator.start();    }    @Override    protected void onSizeChanged(int w, int h, int oldw, int oldh) {        /*         * å¾—åˆ°h,wçš„æœ€å°çš„é‚£ä¸ªå€¼;         * &gt;&gt; 1 ç§»ä½ è·Ÿ /2 ç›¸åŒ;         * ä¹˜ä»¥0.9f,è¡¨ç¤ºå å¸ƒå±€çš„90%         * */        mRadius = (Math.min(h, w) &gt;&gt; 1) * 0.9f;        // ä¸­å¿ƒåº§æ ‡        mCenterX = w / 2;        mCenterY = h / 2;        Log.v("showLog", mCenterX + "  " + mCenterY + "  " + mRadius);        postInvalidate();        super.onSizeChanged(w, h, oldw, oldh);    }    @Override    protected void onDraw(Canvas canvas) {        super.onDraw(canvas);        if (mCurAnimValue &lt; 1) {            float stop = mPathMeasure.getLength() * mCurAnimValue;            mPathMeasure.getSegment(0, stop, mDstPath, true);        } else if (mCurAnimValue == 1) {            mPathMeasure.getSegment(0, mPathMeasure.getLength(), mDstPath, true);            mPathMeasure.nextContour();        } else {            float stop = mPathMeasure.getLength() * (mCurAnimValue - 1);            mPathMeasure.getSegment(0, stop, mDstPath, true);        }        canvas.drawPath(mDstPath, mPaint);    }}</code></pre><p>æ•ˆæœï¼š</p><div class=pgc-img><img alt=æ·±å…¥äº†è§£ä¸€äº›AndroidåŠ¨ç”» onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/930b90db257c42069501f2e75f43e805><p class=pgc-img-caption></p></div><p>ç¼–ç¨‹ä¸­æˆ‘ä»¬ä¼šé‡åˆ°å¤šå°‘æŒ«æŠ˜ï¼Ÿè¡¨æ”¾å¼ƒï¼Œæ²™æ¼ å°½å¤´å¿…æ˜¯ç»¿æ´²ã€‚</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'äº†è§£','Android','åŠ¨ç”»'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>