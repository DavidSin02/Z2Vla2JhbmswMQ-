<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>讨论：Service层需要接口吗？ | 极客快訊</title><meta property="og:title" content="讨论：Service层需要接口吗？ - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/S7QqYwT3jhkulD"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/5d1585c0.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/5d1585c0.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/5d1585c0.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/5d1585c0.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/5d1585c0.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/5d1585c0.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/5d1585c0.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/5d1585c0.html><meta property="article:published_time" content="2020-11-14T20:59:17+08:00"><meta property="article:modified_time" content="2020-11-14T20:59:17+08:00"><meta name=Keywords content><meta name=description content="讨论：Service层需要接口吗？"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/5d1585c0.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>讨论：Service层需要接口吗？</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>优质文章，及时送达</p><p>链接：toutiao.com/i6882356844245975563</p><p>前几天刷头条又刷到了「Service层和Dao层真的有必要每个类都加上接口吗？」这个问题，之前简单回答了一波，给出的观点是「看情况」</p><p>现在结合我参与的项目以及阅读的一些项目源码来看。如果<strong>项目中使用了像Spring这样的依赖注入框架，那可以不用接口</strong>！</p><p>先来说说为什么使用了依赖注入框架以后，可以不使用接口！</p><p>我整理了支持Service层和Dao层需要加上接口的理由，总结下来就这么三个：</p><ul><li><p>可以在尚未实现具体Service逻辑的情况下编写上层代码，如Controller对Service的调用</p></li><li><p>Spring默认是基于动态代理实现AOP的，动态代理需要接口</p></li><li><p>可以对Service进行多实现</p></li></ul><p>实际上，这三个理由都站不住脚！</p><p>先说说第一个理由：「上层可以在下层逻辑没有实现的情况下进行编码」！很典型的面向接口编程，对层与层之间进行了解耦，看起来好像没有问题。</p><p>这种开发方式适合不同模块之间是由不同的人或项目组开发的，因为沟通的成本比较大。同时避免由于项目组之间开发进度的差异而相互影响。</p><p>不过让我们回想一下，在一般项目开发里面，有多少项目组是按层来切分开发任务的呢？实际上，大部分的项目都是按照功能划分的。即使是现在前后端分离的情况，单纯的后端开发也是按照功能模块进行任务划分，即一个人负责从Controller层到DAO层的完整逻辑处理。在这种情况下，每一层都先定义一个接口，再去实现逻辑，除了增加了开发人员的工作量（当然，如果代码量计入工作量的话，那开发人员应该也不是太排斥接口的！），实际没有任何用处。</p><p>如果开发人员想在下层逻辑没有完成的情况下，先开发上层逻辑，可以先编写下层类的空方法来先完成上层的逻辑。</p><p>这里推荐一个个人比较喜欢的开发流程，自上向下的编码流程：</p><ul><li><p>先在Controller层编写逻辑，遇到需要委托Service调用的地方，直接先写出调用代码。</p></li><li><p>优先完成Controller层的流程</p></li><li><p>然后使用IDE的自动补全，对刚才调用下层的代码生成对应的类和方法，在里面添加TODO</p></li><li><p>等所有的类和方法都补全了，再基于TODO，按照上面的流程去一个个的完善逻辑。</p></li><li><p>此方法可以使你对业务流程有比较好的理解。</p></li></ul><p>对于第二个理由，就完全不成立了。Spring默认是基于动态代理的，不过通过配置是可以使用CGLib来实现AOP。CGLib是不需要接口的。</p><p>最后一个理由是「可以对Service进行多实现」。这个理由不充分，或者说没有考虑场景。实际上在大多数情况下是不需要多实现，或者说可以使用其它方式替代基于接口的多实现。</p><p>另外，对于很多使用了接口的项目，项目结构也是有待商榷的！下面，我们结合项目结构来说明。</p><p>一般项目结构都是按层来划分的，如下所示：</p><ul><li><p>Controller</p></li><li><p>Service</p></li><li><p>Dao</p></li></ul><p>对于不需要多实现的情况，也就不需要接口了。上面的项目结构即可满足要求。</p><p>对于需要多实现的情况，无论是现在需要，还是后面需要。这种情况下，看起来好像是需要接口。此时的项目结构看起来像这样：</p><ul><li><p>Controller</p></li><li><p>Service</p></li><ul><li><p>--- 接口在一个包中</p></li><li><p>impl --- 实现在另一个包里</p></li></ul><li><p>Dao</p></li></ul><p>对于上面的结构，我们来考虑多实现的情况下，该怎么处理？</p><p>第一种方式，是在Service中新增一个包，在里面编写新的逻辑，然后修改配置文件，将新实现作为注入对象。</p><ul><li><p>Controller</p></li><li><p>Service</p></li><ul><li><p>---- 接口在一个包中</p></li><li><p>impl ---实现在另一个包里</p></li><li><p>impl2 ---新实现在另一个包里</p></li></ul><li><p>Dao</p></li></ul><p>第二种方式，是新增一个Service模块，在里面编写新的逻辑（注意这里的包和原来Service的包不能相同，或者包相同，但是类名不同，否则无法创建类。因为在加载时需要同时加载两个Service模块，如果包名和类名都相同，两个模块的类全限定名就是一样的了！），然后修改配置文件，将新逻辑作为注入对象。</p><ul><li><p>Controller</p></li><li><p>Service</p></li><ul><li><p>---- 接口在一个包中</p></li><li><p>impl ---实现在另一个包里</p></li></ul><li><p>Service2</p></li><ul><li><p>impl2 ---新实现在另一个包里</p></li></ul><li><p>Dao</p></li></ul><p>相对而言，实际第一种方式相对更简单一点，只需要关注包层面。而第二种方式需要关注模块和包两个层面。另外，实际这两种方式都导致了项目中包含了不需要的逻辑代码。因为老逻辑都会被打进包里。</p><p>不过，从结构上来看，实际方式二的结构要比方式一的结构更清晰，因为从模块上能区分逻辑。</p><p>那有没有办法来结合两者的优点呢？答案是肯定的，而且操作起来也不复杂！</p><p>首先将接口和实现独立开，作为一个独立的模块：</p><ul><li><p>Controller</p></li><li><p>Service --- 接口模块</p></li><ul><li><p>ServiceImpl</p></li><li><p>impl ---实现在另一个包里</p></li></ul><li><p>ServiceImpl2</p></li><ul><li><p>impl2 ---新实现在另一个包里</p></li></ul><li><p>Dao</p></li></ul><p>其次，调整打包配置，ServiceImpl和ServiceImpl2二选一。既然ServiceImpl和ServiceImpl2是二选一，那ServiceImpl和ServiceImpl2的包结构就可以相同。包结构相同了，那调整了依赖以后，依赖注入相关的配置就不需要调整了。调整后，项目结构看起来像这样：</p><ul><li><p>Controller</p></li><li><p>Service --- 接口模块</p></li><ul><li><p>ServiceImpl</p></li><li><p>impl ---实现在另一个包</p></li></ul><li><p>ServiceImpl2</p></li><ul><li><p>impl ---新实现和老实现在相同的包中</p></li></ul><li><p>Dao</p></li></ul><p>现在，ServiceImpl和ServiceImpl2模块中的包结构、类名都是一样的。那我们还需要接口模块吗？</p><p>假设，我们把Service接口模块去掉，结构变成了如下所示：</p><ul><li><p>Controller</p></li><li><p>Service1 --- 老实现</p></li><li><p>Service2 --- 新实现</p></li><li><p>Dao</p><br></li></ul><p>单纯的通过调整模块依赖，是否能实现Service的多实现？答案显而易见吧？</p><p>上面给出了不使用接口的理由。不过不使用接口并不是完全没有缺点的，主要问题就是在进行多实现的时候，没有一个强接口规范。即不能通过实现接口，借助IDE快速生成框架代码。对于没有实现的接口，IDE也能给出错误提醒。</p><p>一个不太优雅的解决是，将原来的模块里的代码拷贝一份到新模块中，基于老代码来实现新的逻辑。</p><p>所以，如果一个项目需要多实现、且多实现数量较多（不过一般项目不会有多个实现的），则推荐使用接口。否则不需要使用接口。</p><p>本文针对「Service层是否需要接口」这个问题，指出需要接口的理由的问题。以及个人对这个问题的观点，希望在评论区写出自己的理解 ！</p><p class=pgc-end-source>- END -</p><pre><div><div><div><div><pre><p class=pgc-end-source>最近整理一份面试资料《Java技术栈学习手册》，覆盖了Java技术、面试题精选、Spring全家桶、Nginx、SSM、微服务、数据库、数据结构、架构等等。</p><p class=pgc-end-source>获取方式：点“  并回复 777</p></pre></div></div></div></div></pre><img alt=讨论：Service层需要接口吗？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/S7QqYwT3jhkulD></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'讨论','Service','接口'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>