<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶ | æå®¢å¿«è¨Š</title><meta property="og:title" content="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/18f1b156dc784f34a3ae9edea43e9a78"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/5e149ba4.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/5e149ba4.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/5e149ba4.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/5e149ba4.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/5e149ba4.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/5e149ba4.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/5e149ba4.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/5e149ba4.html><meta property="article:published_time" content="2020-10-29T21:08:52+08:00"><meta property="article:modified_time" content="2020-10-29T21:08:52+08:00"><meta name=Keywords content><meta name=description content="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/5e149ba4.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æœ€è¿‘å¼€å§‹å­¦ä¹ ç½‘ç»œå®‰å…¨å’Œç³»ç»Ÿå®‰å…¨ï¼Œæ¥è§¦åˆ°äº†å¾ˆå¤šæ–°æœ¯è¯­ã€æ–°æ–¹æ³•å’Œæ–°å·¥å…·ï¼Œä½œä¸ºä¸€ååˆå­¦è€…ï¼Œæ„Ÿè§‰å®‰å…¨é¢†åŸŸæ¶‰åŠçš„çŸ¥è¯†å¥½å¹¿ã€å¥½æ‚ï¼Œä½†åŒæ—¶ä¹Ÿéå¸¸æœ‰æ„æ€ã€‚è¿™ç³»åˆ—æ–‡ç« æ˜¯ä½œè€…å­¦ä¹ å®‰å…¨è¿‡ç¨‹ä¸­çš„æ€»ç»“å’Œæ¢ç´¢ï¼Œæˆ‘ä»¬ä¸€èµ·å»</span><span style="color:#4d4d4d;--tt-darkmode-color: #999999">èºº</span><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è¿‡é‚£äº›å‘ã€è·¨è¿‡é‚£äº›æ´ã€å®ˆä½é‚£äº›ç«™ï¼ŒçœŸå¿ƒå¸Œæœ›æ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œæ„Ÿè°¢æ‚¨çš„é˜…è¯»å’Œå…³æ³¨ã€‚</span></p><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">Pythoné»‘å¸½ç¬¬ä¸€ç¯‡æ–‡ç« å°†åˆ†äº«è·å–Windowsä¸»æœºä¿¡æ¯ï¼Œåˆ©ç”¨æ³¨å†Œè¡¨è·å–ä¸»æœºååŠUSBå†å²ç—•è¿¹ã€å›æ”¶ç«™æ–‡ä»¶ç­‰ï¼Œè¿™äº›çŸ¥è¯†å¹¿æ³›åº”ç”¨äºç”µå­å–è¯ã€Webæ¸—é€å’Œæ”»å‡»æº¯æºé¢†åŸŸï¼Œå…¶ä¸­USBè·å–æ˜¯äº®ç‚¹ã€‚å¸Œæœ›è¿™ç¯‡åŸºç¡€æ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œæ›´å¸Œæœ›å¤§å®¶æé«˜å®‰å…¨æ„è¯†ï¼Œå­¦ä¼šç›¸å…³é˜²èŒƒï¼Œä¹Ÿæ¬¢è¿å¤§å®¶è®¨è®ºã€‚å¨œç’‹AIå®‰å…¨ä¹‹å®¶äº2020å¹´8æœˆ18æ—¥å¼€é€šï¼Œå°†ä¸“æ³¨äºPythonå’Œå®‰å…¨æŠ€æœ¯ï¼Œä¸»è¦åˆ†äº«Webæ¸—é€ã€ç³»ç»Ÿå®‰å…¨ã€CVEå¤ç°ã€å¨èƒæƒ…æŠ¥åˆ†æã€äººå·¥æ™ºèƒ½ã€å¤§æ•°æ®åˆ†æã€æ¶æ„ä»£ç æ£€æµ‹ç­‰æ–‡ç« ã€‚çœŸå¿ƒæƒ³æŠŠè‡ªå·±è¿‘åå¹´çš„æ‰€å­¦æ‰€åšæ‰€æ„Ÿåˆ†äº«å‡ºæ¥ï¼Œä¸å¤§å®¶ä¸€èµ·è¿›æ­¥ã€‚</span></p><p><br></p><blockquote><p><span style="color:#555666;--tt-darkmode-color: #555666"><span style="background-color:#eef0f4;--tt-darkmode-bgcolor: #BDBEC1">å£°æ˜ï¼šæœ¬äººåšå†³åå¯¹åˆ©ç”¨æ•™å­¦æ–¹æ³•è¿›è¡Œæ¶æ„æ”»å‡»çš„è¡Œä¸ºï¼Œä¸€åˆ‡é”™è¯¯çš„è¡Œä¸ºå¿…å°†å—åˆ°ä¸¥æƒ©ï¼Œç»¿è‰²ç½‘ç»œéœ€è¦æˆ‘ä»¬å…±åŒç»´æŠ¤ï¼Œæ›´æ¨èå¤§å®¶äº†è§£æŠ€æœ¯èƒŒåçš„åŸç†ï¼Œæ›´å¥½åœ°è¿›è¡Œå®‰å…¨é˜²æŠ¤ã€‚è™½ç„¶ä½œè€…æ˜¯ä¸€åå®‰å…¨å°ç™½ï¼Œä½†ä¼šä¿è¯æ¯ä¸€ç¯‡æ–‡ç« éƒ½ä¼šå¾ˆç”¨å¿ƒåœ°æ’°å†™ï¼Œå¸Œæœ›è¿™äº›åŸºç¡€æ€§æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œåœ¨å®‰å…¨è·¯ä¸Šä¸€èµ·å‰è¡Œã€‚</span></span></p></blockquote><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">ä¸€.è·å–Windowsä¸»æœºä¿¡æ¯</span></h1><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">WMI(Windows Management Instrumentation) æ˜¯ä¸€é¡¹æ ¸å¿ƒçš„Windowsç®¡ç†æŠ€æœ¯ï¼ŒWMIæ¨¡å—å¯ç”¨äºè·å–Windowså†…éƒ¨ä¿¡æ¯ã€‚WMIä½œä¸ºä¸€ç§è§„èŒƒå’ŒåŸºç¡€ç»“æ„ï¼Œé€šè¿‡å®ƒå¯ä»¥è®¿é—®ã€é…ç½®ã€ç®¡ç†å’Œç›‘è§†å‡ ä¹æ‰€æœ‰çš„Windowsèµ„æºï¼Œæ¯”å¦‚ç”¨æˆ·å¯ä»¥åœ¨è¿œç¨‹è®¡ç®—æœºå™¨ä¸Šå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼›è®¾å®šä¸€ä¸ªåœ¨ç‰¹å®šæ—¥æœŸå’Œæ—¶é—´è¿è¡Œçš„è¿›ç¨‹ï¼›è¿œç¨‹å¯åŠ¨è®¡ç®—æœºï¼›è·å¾—æœ¬åœ°æˆ–è¿œç¨‹è®¡ç®—æœºçš„å·²å®‰è£…ç¨‹åºåˆ—è¡¨ï¼›æŸ¥è¯¢æœ¬åœ°æˆ–è¿œç¨‹è®¡ç®—æœºçš„Windowsäº‹ä»¶æ—¥å¿—ç­‰ç­‰ã€‚</span></p><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æœ¬æ–‡ä½¿ç”¨Pythonè·å–Windowsç³»ç»Ÿä¸Šç›¸å…³çš„ä¿¡æ¯å¯ä»¥ä½¿ç”¨WMIæ¥å£ï¼Œå®‰è£…è°ƒç”¨PIPå·¥å…·å³å¯ã€‚</span></p><ul><li>pip install wmi</li><li>import wmi</li></ul><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/18f1b156dc784f34a3ae9edea43e9a78><p class=pgc-img-caption></p></div><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ä¸‹é¢çš„ä»£ç æ˜¯è·å–Windowsä¸»æœºç›¸å…³ä¿¡æ¯ã€‚</span></p><pre><code>import wmiimport osimport socketw = wmi.WMI()#è·å–ç”µè„‘ä½¿ç”¨è€…ä¿¡æ¯for CS in w.Win32_ComputerSystem():    #print(CS)    print("ç”µè„‘åç§°: %s" %CS.Caption)    print("ä½¿ç”¨è€…: %s" %CS.UserName)    print("åˆ¶é€ å•†: %s" %CS.Manufacturer)    print("ç³»ç»Ÿä¿¡æ¯: %s" %CS.SystemFamily)    print("å·¥ä½œç»„: %s" %CS.Workgroup)    print("æœºå™¨å‹å·: %s" %CS.model)    print("")#è·å–æ“ä½œç³»ç»Ÿä¿¡æ¯for OS in w.Win32_OperatingSystem():    #print(OS)    print("æ“ä½œç³»ç»Ÿ: %s" %OS.Caption)    print("è¯­è¨€ç‰ˆæœ¬: %s" %OS.MUILanguages)    print("ç³»ç»Ÿä½æ•°: %s" %OS.OSArchitecture)    print("æ³¨å†Œäºº: %s" %OS.RegisteredUser)    print("ç³»ç»Ÿé©±åŠ¨: %s" %OS.SystemDevice)    print("ç³»ç»Ÿç›®å½•: %s" %OS.SystemDirectory)    print("")#è·å–ç”µè„‘IPå’ŒMACä¿¡æ¯for address in w.Win32_NetworkAdapterConfiguration(ServiceName = "e1dexpress"):    #print(address)    print("IPåœ°å€: %s" % address.IPAddress)    print("MACåœ°å€: %s" % address.MACAddress)    print("ç½‘ç»œæè¿°: %s" % address.Description)    print("")#è·å–ç”µè„‘CPUä¿¡æ¯for processor in w.Win32_Processor():    #print(processor)    print("CPUå‹å·: %s" % processor.Name.strip())    print("CPUæ ¸æ•°: %s" % processor.NumberOfCores)    print("")#è·å–BIOSä¿¡æ¯for BIOS in w.Win32_BIOS():    #print(BIOS)    print("ä½¿ç”¨æ—¥æœŸ: %s" %BIOS.Description)    print("ä¸»æ¿å‹å·: %s" %BIOS.SerialNumber)    print("å½“å‰è¯­è¨€: %s" %BIOS.CurrentLanguage)    print("")#è·å–å†…å­˜ä¿¡æ¯for memModule in w.Win32_PhysicalMemory():    totalMemSize = int(memModule.Capacity)    print("å†…å­˜å‚å•†: %s" %memModule.Manufacturer)    print("å†…å­˜å‹å·: %s" %memModule.PartNumber)    print("å†…å­˜å¤§å°: %.2fGB" %(totalMemSize/1024**3))    print("")#è·å–ç£ç›˜ä¿¡æ¯for disk in w.Win32_DiskDrive():    diskSize = int(disk.size)    print("ç£ç›˜åç§°: %s" %disk.Caption)    print("ç¡¬ç›˜å‹å·: %s" %disk.Model)    print("ç£ç›˜å¤§å°: %.2fGB" %(diskSize/1024**3))#è·å–æ˜¾å¡ä¿¡æ¯for xk in w.Win32_VideoController():    print("æ˜¾å¡åç§°: %s" %xk.name)    print("")       #è·å–è®¡ç®—æœºåç§°å’ŒIPhostname = socket.gethostname()ip = socket.gethostbyname(hostname)print("è®¡ç®—æœºåç§°: %s" %hostname)print("IPåœ°å€: %s" %ip)</code></pre><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è¾“å‡ºç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8a38bf7d7e6241298d88d1a6f1966bce><p class=pgc-img-caption></p></div><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8bf7c2306c4149f0813362aecbd1e6a7><p class=pgc-img-caption></p></div><p><br></p><hr><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">äºŒ.è·å–Windowsæ³¨å†Œè¡¨ä¿¡æ¯</span></h1><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">1.æ³¨å†Œè¡¨åŸºæœ¬ç»“æ„</span></h1><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ³¨å†Œè¡¨ï¼ˆRegistryï¼‰æ˜¯Windowsç³»ç»Ÿä¸­ä¸€ä¸ªé‡è¦çš„æ•°æ®åº“ï¼Œå®ƒç”¨äºå­˜å‚¨æœ‰å…³åº”ç”¨ç¨‹åºã€ç”¨æˆ·å’Œç³»ç»Ÿä¿¡æ¯ã€‚æ³¨å†Œè¡¨çš„ç»“æ„å°±åƒ</span><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ä¸€é¢—æ ‘</span><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼Œæ ‘çš„é¡¶çº§èŠ‚ç‚¹(hive)ä¸èƒ½æ·»åŠ ã€ä¿®æ”¹å’Œåˆ é™¤ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºæ˜¯Windowsæ³¨å†Œè¡¨çš„é¡¶çº§èŠ‚ç‚¹ã€‚</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a2b3054b9d4c4ab7beaedf509a680ab2><p class=pgc-img-caption></p></div><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åœ¨C#ä¸­å¯¹æ³¨å†Œè¡¨è¿›è¡Œæ“ä½œï¼Œéœ€è¦å¼•ç”¨å‘½åç©ºé—´using Microsoft.Win32ã€‚</span></p><ul><li><strong>RegistryKeyç±»</strong>ï¼šè¡¨ç¤ºæ³¨å†Œè¡¨ä¸­çš„é¡¶çº§ç»“ç‚¹ï¼Œæ­¤ç±»æ˜¯æ³¨å†Œè¡¨çš„å°è£…ã€‚</li><li><strong>Registryç±»</strong>ï¼šæä¾›è¡¨ç¤ºWindowsæ³¨å†Œè¡¨ä¸­çš„æ ¹é¡¹RegistryKeyå¯¹è±¡ï¼Œå¹¶æä¾›è®¿é—®é¡¹/å€¼çš„staticæ–¹æ³•ã€‚å¸¸ç”¨çš„Registryå¯¹è±¡çš„é¡¶çº§èŠ‚ç‚¹ï¼ˆèœ‚çª,hiveï¼‰çš„å±æ€§å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</li></ul><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b59c6ae501214fa8a820992e532f37da><p class=pgc-img-caption></p></div><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ³¨å†Œè¡¨ä¸­å¸¸ç”¨çš„æ•°æ®ç±»å‹æœ‰ï¼š</span></p><ul><li><strong>REG_SZ</strong>ï¼šå­—ç¬¦ä¸²æ•°æ®çš„ä¸»è¦ç±»å‹ï¼Œç”¨äºå­˜å‚¨å›ºå®šé•¿åº¦çš„å­—ç¬¦ä¸²æˆ–å…¶ä»–çŸ­æ–‡æœ¬å€¼ã€‚æˆ‘ä»¬åœ¨å®é™…ç¨‹åºä¸­å¸¸ç”¨è¿™ç§æ•°æ®ç±»å‹ï¼Œå¦‚æœè¦ä¿å­˜å¸ƒå°”å€¼æ—¶ï¼Œå°†å®ƒè¡¨ç¤ºæˆ0æˆ–1ã€‚</li><li><strong>REG_BINARY</strong>ï¼šç”¨äºå­˜å‚¨äºŒè¿›åˆ¶æ•°æ®ã€‚</li><li><strong>REG_EXPAND_SZ</strong>ï¼šå¯æ‰©å±•çš„å­—ç¬¦ä¸²å€¼ï¼Œå¯ä»¥ä¿å­˜åœ¨è¿è¡Œæ—¶æ‰è§£æçš„ç³»ç»Ÿå˜é‡ã€‚</li><li><strong>REG_MULTI_SZ</strong>ï¼šä»¥æ•°ç»„çš„æ ¼å¼ä¿å­˜å¤šä¸ªæ–‡æœ¬å­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²"å…ƒç´ "éƒ½ä»¥nullå­—ç¬¦ç»“æŸã€‚</li></ul><p><br></p><hr><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">2.æ³¨å†Œè¡¨åŸºæœ¬æ“ä½œ</span></h1><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">Pythonæ³¨å†Œè¡¨æ“ä½œä¸»è¦è°ƒç”¨winregæ‰©å±•åŒ…ã€‚å®˜æ–¹æ–‡æ¡£å¦‚ä¸‹ï¼š</span></p><ul><li>https://docs.python.org/3.0/library/winreg.html</li></ul><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åŸºæœ¬æ“ä½œå‡½æ•°å¦‚ä¸‹ï¼š</span></p><p style=text-align:start><strong><span style="background-color:#f8f840;--tt-darkmode-bgcolor: #D0D036">(1) åˆ›å»ºæ“ä½œ</span></strong></p><ul><li><strong>winreg.ConnectRegistry(computer_name, key)</strong><br>ä¸è®¡ç®—æœºçš„é¢„å®šä¹‰æ³¨å†Œè¡¨å¥æŸ„å»ºç«‹è¿æ¥</li><li><strong>winreg.CreateKey(key, sub_key)</strong><br>åˆ›å»ºæˆ–æ‰“å¼€æŒ‡å®šçš„é”®</li></ul><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ä¾‹å¦‚åœ¨HKEY_CURRENT_USERä¸‹åˆ›å»ºé”®Eastmountï¼Œå…¶ä¸­æˆ‘ä»¬æœ€å¸¸ç”¨çš„æ˜¯åœ¨\Softwareè¿™ä¸ªé”®ä¸‹åˆ›å»ºç¨‹åºäº§å“é”®ï¼Œä¿å­˜ä¸€äº›ç¨‹åºçš„é…ç½®åœ¨æ³¨å†Œè¡¨ä¸­ã€‚å¦‚æœSoftwareä¸­æ²¡æœ‰Eastmounté”®ï¼Œåˆ™ä¼šå…ˆåˆ›å»ºè¿™ä¸ªé”®åŠå…¶å­é”®ï¼Œå¦‚æœå­˜åœ¨å°±ä¸ä¼šé‡å†™ã€‚</span></p><pre><code>import winreg as wg#åˆ›å»ºé”®subDir = r"Software\Microsoft\Windows\CurrentVersion\Explorer"key_test = wg.OpenKey(wg.HKEY_CURRENT_USER, subDir)wg.CreateKey(key_test, 'Eastmount')wg.CloseKey(key_test)</code></pre><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è¿è¡Œç»“æœå¦‚ä¸‹:</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d9d7dc51ef134f9f8071fc8dbeeff79f><p class=pgc-img-caption></p></div><p><br></p><p style=text-align:start><strong><span style="background-color:#f8f840;--tt-darkmode-bgcolor: #D0D036">(2) æ£€ç´¢é”®å€¼æ“ä½œ</span></strong></p><ul><li><strong>winreg.QueryInfoKey(key)</strong><br>ä»¥å…ƒç»„å½¢å¼è¿”å›é”®çš„ä¿¡æ¯</li><li><strong>winreg.QueryValue(key, sub_key)</strong><br>ä»¥å­—ç¬¦ä¸²å½¢å¼æ£€ç´¢é”®çš„æœªå‘½åå€¼</li><li><strong>winreg.QueryValueEx(key, value_name)</strong><br>æ£€ç´¢ä¸æ‰“å¼€æ³¨å†Œè¡¨é¡¹å…³è”çš„æŒ‡å®šå€¼åç§°çš„ç±»å‹å’Œæ•°æ®</li></ul><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åœ¨Eastmountä¸‹é¢æ–°å»ºä¸€ä¸ªå€¼yxzï¼Œå†…å®¹ä¸ºâ€œhello naâ€ï¼Œç„¶åç¼–å†™ä»£ç è¯»å–ç›¸å…³çš„å†…å®¹ã€‚</span></p><pre><code>#è·å–é”®å€¼æ•°æ®é¡¹å€¼subDir = r"Software\Microsoft\Windows\CurrentVersion\Explorer\Eastmount"key_test = wg.OpenKey(wg.HKEY_CURRENT_USER, subDir)value,type_ = wg.QueryValueEx(key_test,'yxz')print(value)print(type_)</code></pre><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è¾“å‡ºç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fdbe11f8733a4a02a53ebadd248b5079><p class=pgc-img-caption></p></div><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a6e524d77c6c4805b568bbc234feea4a><p class=pgc-img-caption></p></div><p><br></p><p style=text-align:start><strong><span style="background-color:#f8f840;--tt-darkmode-bgcolor: #D0D036">(3) åˆ›å»ºé”®å€¼æ“ä½œ</span></strong></p><ul><li><strong>winreg.SetValue(key, sub_key, type, value)</strong><br>å°†å€¼ä¸æŒ‡å®šçš„é”®å…³è”</li><li><strong>winreg.SetValueEx(key, value_name, reserved, type, value)</strong><br>å°†æ•°æ®å­˜å‚¨åœ¨æ‰“å¼€çš„æ³¨å†Œè¡¨é¡¹Valueå­—æ®µä¸­</li></ul><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åˆ›å»ºé”®å€¼ä»£ç å¦‚ä¸‹ï¼Œä½†ä¼šæç¤ºPermissionError: [WinError 5] æ‹’ç»è®¿é—®é”™è¯¯ã€‚</span></p><pre><code>#åˆ›å»ºé”®å€¼æ•°æ®é¡¹subDir = r"Software\Microsoft\Windows\CurrentVersion\Explorer\Eastmount"key_test = wg.OpenKey(wg.HKEY_CURRENT_USER, subDir)print(key_test)#PermissionError: [WinError 5] æ‹’ç»è®¿é—®wg.SetValueEx(key_test,'data','',wg.REG_SZ,'0') wg.CloseKey(key_test)</code></pre><p><strong><span style="background-color:#f8f840;--tt-darkmode-bgcolor: #D0D036">(4) åˆ é™¤é”®å€¼æ“ä½œ</span></strong></p><ul><li><strong>winreg.DeleteKey(key, sub_key)</strong><br>åˆ é™¤æŒ‡å®šçš„é”®</li><li><strong>winreg.DeleteValue(key, value)</strong><br>ä»æ³¨å†Œè¡¨é¡¹ä¸­åˆ é™¤å€¼</li></ul><pre><code>#åˆ é™¤é”®å€¼æ•°æ®é¡¹subDir = r"Software\Microsoft\Windows\CurrentVersion\Explorer\Eastmount"key_test = wg.OpenKey(wg.HKEY_CURRENT_USER,subDir,0,wg.KEY_WRITE)wg.DeleteValue(key_test,'yxz')wg.CloseKey(key_test)</code></pre><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æˆåŠŸåˆ é™¤é”®å€¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9f22c4f8bf9a4d4199bc0dcc852d5308><p class=pgc-img-caption></p></div><p><br></p><p style=text-align:start><strong><span style="background-color:#f8f840;--tt-darkmode-bgcolor: #D0D036">(5) å…¶ä»–æ“ä½œ</span></strong></p><ul><li><strong>winreg.EnumKey(key, index)</strong><br>æšä¸¾æ‰“å¼€æ³¨å†Œè¡¨çš„é”®</li><li><strong>winreg.EnumValue(key, index)</strong><br>æšä¸¾æ‰“å¼€æ³¨å†Œè¡¨é¡¹çš„å€¼</li><li><strong>winreg.OpenKey(key, sub_key,sam=KEY_READ)</strong><br>æ‰“å¼€æŒ‡å®šé”®</li><li><strong>winreg.FlushKey(key)</strong><br>åˆ·æ–°æ³¨å†Œè¡¨</li><li><strong>winreg.LoadKey(key, sub_key, file_name)</strong><br>åœ¨æŒ‡å®šé”®ä¸‹åˆ›å»ºä¸€ä¸ªå­é”®ï¼Œå¹¶å°†æ³¨å†Œä¿¡æ¯ä»æŒ‡å®šæ–‡ä»¶å­˜å‚¨åˆ°è¯¥å­é”®ä¸­</li></ul><p><br></p><hr><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">3.è·å–ç”¨æˆ·è´¦æˆ·ä¿¡æ¯</span></h1><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8db6d9d1d44146cdaf5df879ccd7ef25><p class=pgc-img-caption></p></div><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è·å–ç”¨æˆ·åç§°çš„ä»£ç å¦‚ä¸‹ï¼š</span></p><pre><code># encoding:utf-8from winreg import *import sys#è¿æ¥æ³¨å†Œè¡¨æ ¹é”® ä»¥HKEY_LOCAL_MACHINEä¸ºä¾‹regRoot = ConnectRegistry(None, HKEY_LOCAL_MACHINE)subDir = r'SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList'#è·å–æŒ‡å®šç›®å½•ä¸‹æ‰€æœ‰é”®çš„æ§åˆ¶keyHandle = OpenKey(regRoot, subDir)#è·å–è¯¥ç›®å½•ä¸‹æ‰€æœ‰é”®çš„ä¸ªæ•°(0-ä¸‹å±é”®ä¸ªæ•° 1-å½“å‰é”®å€¼ä¸ªæ•°)count = QueryInfoKey(keyHandle)[0]for i in range(count):    #ç©·ä¸¾é”®è·å–é”®å    subKeyName = EnumKey(keyHandle, i)    subDir_2 = r'%s\%s' % (subDir, subKeyName)        #æ ¹æ®è·å–çš„é”®åæ‹¼æ¥ä¹‹å‰çš„è·¯å¾„ä½œä¸ºå‚æ•° è·å–å½“å‰é”®ä¸‹æ‰€å±é”®çš„æ§åˆ¶    keyHandle_2 = OpenKey(regRoot, subDir_2)    num = QueryInfoKey(keyHandle_2)[1]    for j in range(num):        name, value, type_ = EnumValue(keyHandle_2, j)        if('ProfileImagePath' in name and 'Users' in value):            print(value)    #è¯»å†™æ“ä½œç»“æŸåå…³é—­é”®    CloseKey(keyHandle_2)    CloseKey(keyHandle)CloseKey(regRoot)</code></pre><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¯»å–å«æœ‰Userså­—æ®µçš„æ•°æ®ï¼Œä»è€Œé—´æ¥è·å–ç”¨æˆ·è´¦æˆ·ä¿¡æ¯ã€‚</span></p><pre><code>C:\Usersiuzhang</code></pre><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">ä¸‰.è·å–å›æ”¶ç«™å†…å®¹</span></h1><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦å»è·å–å›æ”¶ç«™æ–‡ä»¶å‘¢ï¼Ÿå› ä¸ºå¾ˆå¤šæƒ…å†µä¸‹è°ƒæŸ¥å–è¯éœ€è¦è·å–è¿œç¨‹ç›®æ ‡çš„å†å²ç—•è¿¹ï¼Œå›æ”¶ç«™æ˜¯é‡è¦çš„ä¸€ä¸ªç›®æ ‡ã€‚åœ¨Windowsæ“ä½œç³»ç»Ÿä¸­ï¼Œå›æ”¶ç«™æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥å­˜æ”¾è¢«åˆ é™¤æ–‡ä»¶çš„ç‰¹è‰²æ–‡ä»¶å¤¹ã€‚</span></p><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åœ¨ä½¿ç”¨FATæ–‡ä»¶ç³»ç»Ÿçš„Windows98ç³»ç»Ÿä¸­ï¼Œå›æ”¶ç«™ç›®å½•é€šå¸¸æ˜¯C:\Recycledï¼›åœ¨Windows NT2000ã€Windows XPåœ¨å†…æ”¯æŒçš„NTFSæ“ä½œç³»ç»Ÿä¸­ï¼ŒC:\Recyclerï¼›åœ¨Windows Vistaå’ŒWindows7ä¸­ï¼Œå›æ”¶ç«™ç›®å½•æ˜¯C:\$Recycle.Binã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå›æ”¶ç«™ä¸­åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«ä½äºæ¡Œé¢å’ŒDç›˜ç›®å½•ã€‚</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8a204919dd7f429e8103fd91afe14e72><p class=pgc-img-caption></p></div><p><br></p><p style=text-align:start><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç¬¬ä¸€æ­¥ï¼Œæ£€æµ‹å›æ”¶ç«™ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚</span></strong></p><pre><code>import osdef returnDir():    #å®šä¹‰å›æ”¶ç«™ç›®å½•    dirs = ['C:\\Recycler\\', 'C:\\Recycled', 'C:\\$Recycle.Bin\\']    for recycleDir in dirs:        if os.path.isdir(recycleDir):            return recycleDir    return None#è°ƒç”¨å‡½æ•°res = returnDir()print(res) #C:\$Recycle.Bin\</code></pre><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">Windows10æ“ä½œç³»ç»Ÿè¾“å‡ºç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e933ca76d25d4a258c09429ceb05d015><p class=pgc-img-caption></p></div><p style=text-align:start><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç¬¬äºŒæ­¥ï¼Œæ‰¾åˆ°å›æ”¶ç«™ä¹‹åï¼Œæ£€æµ‹å…¶ä¸­çš„å†…å®¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå­—ç¬¦ä¸²SIDä¸ç”¨æˆ·è´¦æˆ·åæ˜¯å¯¹åº”çš„ï¼Œæ¯”å¦‚1001ç»“å°¾çš„SIDã€‚</span></strong></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3eb7d83ee654425385a60845bbfc6bbe><p class=pgc-img-caption></p></div><p style=text-align:start><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç¬¬ä¸‰æ­¥ï¼Œç¼–å†™ä»£ç è·å–å›æ”¶ç«™æ–‡ä»¶å¤¹æ‰€åœ¨ç›®å½•ã€‚</span></strong></p><pre><code>import os#åˆ¤æ–­å›æ”¶ç«™ç›®å½•æ˜¯å¦å­˜åœ¨def returnDir():    dirs = ['C:\\Recycler\\', 'C:\\Recycled', 'C:\\$Recycle.Bin\\']    for recycleDir in dirs:        if os.path.isdir(recycleDir):            return recycleDir    return None#è·å–å›æ”¶ç«™å†…å®¹def findRecycle(recycleDir):    dirList = os.listdir(recycleDir)    for sid in dirList:        print(sid)        files = os.listdir(recycleDir+sid)        print(files,"\n")#ä¸»å‡½æ•°def main():    res = returnDir()    print(res) #C:\$Recycle.Bin\    findRecycle(res)    if __name__ == '__main__':    main()</code></pre><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è¾“å‡ºç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b0355fc475844f82ad65a5c6bb15df51><p class=pgc-img-caption></p></div><p style=text-align:start><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç¬¬å››æ­¥ï¼Œç”¨pythonå°†ç”¨æˆ·çš„SIDå…³è”èµ·æ¥ï¼Œä½¿ç”¨Windowsæ³¨å†Œè¡¨å°†SIDè½¬åŒ–ä¸ºä¸€ä¸ªå‡†ç¡®çš„ç”¨æˆ·åã€‚</span></strong></p><ul><li>é€šè¿‡æ£€æŸ¥Windowsæ³¨å†Œè¡¨é”®å€¼</li><li>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\ProfileImagePath</li></ul><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥å°†æ¯ä¸€ä¸ªSIDè½¬åŒ–ä¸ºç”¨æˆ·åï¼Œè¿™ä¸ªå‡½æ•°å°†æ‰“å¼€æ³¨å†Œä¾¿æ£€æŸ¥ProfileImagePathé”®å€¼ï¼Œæ‰¾åˆ°å…¶å€¼å¹¶ä»ä¸­æ‰¾åˆ°ç”¨æˆ·åã€‚</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/78a170592fae4b97ba75eb1049db29bc><p class=pgc-img-caption></p></div><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç”¨æˆ·åä¸ºâ€œxiuzhangâ€ã€‚</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/54075b5c16a44ca6bab4a83a96adbd14><p class=pgc-img-caption></p></div><p style=text-align:start><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç¬¬äº”æ­¥ï¼Œè·å–å›æ”¶ç«™æ‰€æœ‰å†…å®¹ã€‚</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999"><br></span><span style="background-color:#f8f840;--tt-darkmode-bgcolor: #D0D036">å®Œæ•´ä»£ç ï¼š</span></p><pre><code>import osimport winreg#åˆ¤æ–­å›æ”¶ç«™ç›®å½•æ˜¯å¦å­˜åœ¨def returnDir():    dirs = ['C:\\Recycler\\', 'C:\\Recycled', 'C:\\$Recycle.Bin\\']    for recycleDir in dirs:        if os.path.isdir(recycleDir):            return recycleDir    return None#é€šè¿‡sidè·å–ç”¨æˆ·åä¿¡æ¯def sid2user(sid):    try:        key = winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE,                                "SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\\" + sid)        #è·å–è¯¥ç›®å½•ä¸‹æ‰€æœ‰é”®çš„ä¸ªæ•°: 0-ä¸‹å±é”®ä¸ªæ•°; 1-å½“å‰é”®å€¼ä¸ªæ•°        count = winreg.QueryInfoKey(key)[1]         for j in range(count):            #FileNotFoundError: [WinError 2] ç³»ç»Ÿæ‰¾ä¸åˆ°æŒ‡å®šçš„æ–‡ä»¶            #(value, type) = winreg.QueryValue(key, 'ProfileImagePath')            name, value, type = winreg.EnumValue(key, j)            if('ProfileImagePath' in name):                user = value.split('\\')[-1]                #print(user)        return user    except:        return sid#è·å–å›æ”¶ç«™å†…å®¹def findRecycle(recycleDir):    dirList = os.listdir(recycleDir)    for sid in dirList:        print(sid)        files = os.listdir(recycleDir+sid)        print(files)        user = sid2user(sid)        print('[*]Listing Files For User:' + str(user))        for file in files:            print('[+]Found File:' + str(file))        print("")#ä¸»å‡½æ•°def main():    res = returnDir()    print(res)             #C:\$Recycle.Bin    findRecycle(res)    if __name__ == '__main__':    main()</code></pre><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è¾“å‡ºç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e7ef6b58186249c5986c81f00466a8ed><p class=pgc-img-caption></p></div><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å¯¹åº”çš„å›æ”¶ç«™å†…å®¹å¦‚ä¸‹ï¼Œä½†éå¸¸å¯æƒœè·å–çš„å€¼æ— æ³•å¯¹åº”ï¼Œwhyï¼Ÿåç»­ä½œè€…ä¼šç»§ç»­æ·±å…¥æŒ–æ˜ã€‚</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/cec8026cc16d479ea2dd686cd3f0a172><p class=pgc-img-caption></p></div><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999"><br></span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/c2899141e4404d2599745ce15ba387b8><p class=pgc-img-caption></p></div><p><br></p><hr><p style=text-align:start><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å¦‚æœæˆ‘ä»¬æƒ³æŠŠæ–‡ä»¶åˆ é™¤åˆ°å›æ”¶ç«™ï¼Œåˆæ€ä¹ˆè§£å†³å‘¢ï¼ŸPythonåˆ é™¤æ–‡ä»¶ä¸€èˆ¬ä½¿ç”¨os.removeï¼Œä½†è¿™æ ·æ˜¯ç›´æ¥åˆ é™¤æ–‡ä»¶ï¼Œä¸åˆ åˆ°å›æ”¶ç«™çš„ï¼Œé‚£ä¹ˆæƒ³åˆ é™¤æ–‡ä»¶åˆ°å›æ”¶ç«™æ€ä¹ˆåŠï¼Ÿ</span></strong></p><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">(1) å®‰è£…pypiwin32æ‰©å±•åŒ…ï¼ˆå«win32apiï¼‰ã€‚</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/49332704024948ef96cc03ccdea62e00><p class=pgc-img-caption></p></div><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">(2) è°ƒç”¨SHFileOperationå‡½æ•°å®ç°åˆ é™¤æ–‡ä»¶è‡³å›æ”¶ç«™ã€‚</span></p><blockquote><p><span style="color:#555666;--tt-darkmode-color: #555666"><span style="background-color:#eef0f4;--tt-darkmode-bgcolor: #BDBEC1">åœ¨Windowsçš„shellapiæ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸ºSHFileOperationçš„å¤–å£³å‡½æ•°ï¼Œç”¨å®ƒå¯ä»¥å®ç°å„ç§æ–‡ä»¶æ“ä½œï¼Œå¦‚æ–‡ä»¶çš„æ‹·è´ã€åˆ é™¤ã€ç§»åŠ¨ç­‰ï¼Œè¯¥å‡½æ•°ä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼Œå®ƒåªæœ‰ä¸€ä¸ªæŒ‡å‘SHFILEOPSTRUCTç»“æ„çš„å‚æ•°ã€‚</span></span></p></blockquote><pre><code>from win32com.shell import shell,shellconimport osdebug = Falsedef deltoreCyclebin(filename):    #ç›´æ¥åˆ é™¤æ–‡ä»¶ï¼Œä¸ç»è¿‡å›æ”¶ç«™    #os.remove(filename)     if not debug:        #åˆ é™¤æ–‡ä»¶åˆ°å›æ”¶ç«™        res = shell.SHFileOperation((0,                                     shellcon.FO_DELETE,                                     filename,                                     None,                                     shellcon.FOF_SILENT | shellcon.FOF_ALLOWUNDO | shellcon.FOF_NOCONFIRMATION,                                     None,                                     None))        print(res)        if not res[1]:            os.system('del '+ filename)if __name__ == '__main__':    filename = "C:\\Users\iuzhang\\Desktop\\require.rb"    deltoreCyclebin(filename)</code></pre><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æœ€ç»ˆæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°require.rbæ–‡ä»¶è¢«æˆåŠŸåˆ é™¤ã€‚</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/aacd301cc20144af800b149a62325c79><p class=pgc-img-caption></p></div><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å¯èƒ½ä¼šé‡åˆ°â€œPermissionError: [WinError 5] æ‹’ç»è®¿é—®â€é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®Python.exeç”¨æˆ·åå®Œå…¨æ§åˆ¶ï¼Œå¹¶ä¸”ç”¨ç®¡ç†å‘˜æ–¹å¼æ‰“å¼€å³å¯è§£å†³ã€‚</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f0a761d2c72e48678f4814643c69ded3><p class=pgc-img-caption></p></div><p><br></p><hr><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">å››.è·å–Uç›˜ç—•è¿¹</span></h1><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åœ¨Windowsç³»ç»Ÿä¸­ï¼Œå½“ä¸€ä¸ªUSBç§»åŠ¨å­˜å‚¨è®¾å¤‡æ’å…¥æ—¶ï¼Œå°±ä¼šåœ¨æ³¨å†Œè¡¨ä¸­ç•™ä¸‹ç—•è¿¹ã€‚å½“ç§»åŠ¨è®¾å¤‡æ’å…¥è®¡ç®—æœºæ—¶ï¼Œå³æ’å³ç”¨ç®¡ç†å™¨PnP(Plug and Play)æ¥å—è¯¥äº‹ä»¶ï¼Œå¹¶ä¸”åœ¨USBè®¾å¤‡çš„å›ºä»¶(Firewre information)ä¸­æŸ¥è¯¢æœ‰å…³è¯¥è®¾å¤‡çš„æè¿°ä¿¡æ¯(å‚å•†ã€å‹å·ã€åºåˆ—å·ç­‰)ã€‚å½“è®¾å¤‡è¢«è¯†åˆ«åï¼Œåœ¨æ³¨å†Œè¡¨ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„é”®å€¼ï¼š</span></p><ul><li><strong>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USBSTOR</strong></li></ul><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åœ¨è¿™ä¸ªé”®å€¼ä¸‹ï¼Œä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„ç»“æ„å­é”®ï¼Œè¯¥å­é”®ä»£è¡¨è®¾å¤‡ç±»æ ‡ç¤ºç¬¦ï¼Œç”¨æ¥æ ‡è¯†è®¾å¤‡çš„ä¸€ä¸ªç‰¹å®šç±»ã€‚</span></p><ul><li><strong>Disk&Ven_###&Prod_###&Rev_###</strong></li></ul><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å…¶ä¸­ï¼Œå­é”®ä¸­"###"ä»£è¡¨åŒºåŸŸç”±PnPç®¡ç†å™¨ä¾æ®åœ¨USBè®¾å¤‡æè¿°ç¬¦ä¸­è·å–çš„æ•°æ®å¡«å†™ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</span></p><ul><li><strong>Disk&Ven_aigo&Prod_Miniking&Rev_8.07æ˜¯Device class ID</strong></li><li><strong>Q0UKCH37&0æ˜¯Unique instance ID(UID)</strong></li></ul><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8ed47bdcd6a9437bb044424afc391e54><p class=pgc-img-caption></p></div><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ³¨æ„éœ€è¦åˆ¤æ–­Serviceå€¼ä¸ºdiskï¼Œå³ä¸ºç£ç›˜çš„å­é¡¹ï¼Œå…‰ç›˜ä¸ºcdromã€‚</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ab9eb3ba70d347dabdb63e5f011a0248><p class=pgc-img-caption></p></div><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å¦‚æœä½¿ç”¨UVCViewå·¥å…·å¯ä»¥çœ‹è§USBè®¾å¤‡æè¿°å†…å®¹ï¼Œå…¶ä¸­çš„ä¿¡æ¯éƒ½æ˜¯ç›¸äº’å¯¹åº”çš„ã€‚è®¾å¤‡ç±»IDä¸€æ—¦å»ºç«‹ï¼Œå°±éœ€è¦å»ºç«‹ä¸€ä¸ªç‰¹å®š</span><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å”¯ä¸€</span><span style="color:#4d4d4d;--tt-darkmode-color: #999999">çš„UIDï¼Œå®ƒå¯ä»¥æŠŠå…·æœ‰åŒä¸€è®¾å¤‡ç±»æ ‡è¯†çš„å¤šä¸ªå­˜å‚¨è®¾å¤‡åŒºåˆ†ã€‚</span></p><p style=text-align:start><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å®Œæ•´å®ç°ä»£ç å¦‚ä¸‹ï¼š</span></strong></p><pre><code># encoding:utf-8from winreg import *import sysusb_name = []uid_flag = []usb_path = []#è¿æ¥æ³¨å†Œè¡¨æ ¹é”® ä»¥HKEY_LOCAL_MACHINEä¸ºä¾‹regRoot = ConnectRegistry(None, HKEY_LOCAL_MACHINE)#æ£€ç´¢å­é¡¹subDir = r"SYSTEM\CurrentControlSet\Enum\USBSTOR"#è·å–æŒ‡å®šç›®å½•ä¸‹æ‰€æœ‰é”®çš„æ§åˆ¶keyHandle = OpenKey(regRoot, subDir)#è·å–è¯¥ç›®å½•ä¸‹æ‰€æœ‰é”®çš„ä¸ªæ•°(0-ä¸‹å±é”®ä¸ªæ•° 1-å½“å‰é”®å€¼ä¸ªæ•°)count = QueryInfoKey(keyHandle)[0]print(count)#ç©·ä¸¾USBSTORé”®è·å–é”®åfor i in range(count):    subKeyName = EnumKey(keyHandle, i)    subDir_2 = r'%s\%s' % (subDir, subKeyName)    #print(subDir_2)    #æ ¹æ®è·å–çš„é”®åæ‹¼æ¥ä¹‹å‰çš„è·¯å¾„ä½œä¸ºå‚æ•° è·å–å½“å‰é”®ä¸‹æ‰€å±é”®çš„æ§åˆ¶    keyHandle_2 = OpenKey(regRoot, subDir_2)    num = QueryInfoKey(keyHandle_2)[0]    #éå†å­é”®å†…å®¹    for j in range(num):        subKeyName_2 = EnumKey(keyHandle_2, j)        #print(subKeyName_2)        result_path = r'%s\%s' % (subDir_2, subKeyName_2)        #è·å–å…·ä½“é”®å€¼å†…å®¹å¹¶åˆ¤æ–­Serviceä¸ºdisk        keyHandle_3 = OpenKey(regRoot, result_path)        numKey = QueryInfoKey(keyHandle_3)[1]        for k in range(numKey):            #è·å–USBåç§°            name, value, type_ = EnumValue(keyHandle_3, k)            if(('Service' in name) and ('disk'in value)):                value,type_ = QueryValueEx(keyHandle_3,'FriendlyName')                usb = value                uid = subKeyName_2                path = "USBSTOR" + "\\" + subKeyName + "\\" + subKeyName_2                print(usb)                print(uid)                print(path)                                print("")    #å…³é—­é”®å€¼CloseKey(keyHandle)CloseKey(regRoot)</code></pre><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è¾“å‡ºçš„USBè®°å½•é”®åå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/eeaba84a897d4671b5877c14111da572><p class=pgc-img-caption></p></div><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å…¶ä¸­å¯¹åº”çš„æ³¨å†Œè¡¨ä¿¡æ¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒFriendlyNameå³æ˜¯è¾“å‡ºçš„â€œUSBåç§° Kingston DataTraveler 2.0 USB Deviceâ€ï¼ŒUIDåºå·ä¸ºâ€œC860008862F1EE501A0F0105&0â€ï¼Œæœç´¢çš„Service(æœåŠ¡)ä¸ºdisk(ç£ç›˜)çš„é€‰é¡¹ã€‚</span></p><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/807a2adeb953415cb789ae36af51f295><p class=pgc-img-caption></p></div><p><br></p><p style=text-align:start><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç®€å•æ€»ç»“ï¼š</span></strong></p><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ä¸ªäººæ„Ÿè§‰è¿™æ–¹é¢çš„èµ„æ–™çœŸå¿ƒå¾ˆå°‘ï¼Œæ–‡ç« åšå®¢ä¹Ÿå°‘ï¼Œæ‰€ä»¥çœ‹èµ·æ¥æ“ä½œä¼¼ä¹å¾ˆç®€å•ï¼Œä½†çœŸæ­£å®ç°èµ·æ¥è¿˜æ˜¯ä»¤äººæ·±æ€çš„ã€‚ç„¶åå°±æ˜¯å…¶å®å­˜å‚¨USBè®°å½•çš„è¿˜æœ‰å¾ˆå¤šé”®å€¼ï¼Œå¦‚</span></p><ul><li><strong>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USB</strong><br>è¯¥é”®å€¼ä¸­èƒ½çœ‹åˆ°å‚å•†å·(VID_)ã€å‚å•†äº§å“å·(PID_)ï¼Œè¿˜æœ‰LocationInformation(ç«¯å£å·) Port_#0001.Hub_#0005ç­‰ã€‚</li></ul><div class=pgc-img><img alt="ã€ŒPythoné»‘å¸½ã€ è·å–æ³¨å†Œè¡¨ã€Uç›˜å†å²ç—•è¿¹å’Œå›æ”¶ç«™æ–‡ä»¶" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ab2df992f7f84aeabd3a45c09e636468><p class=pgc-img-caption></p></div><ul><li><strong>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceClasses</strong><br>è¯¥é”®å€¼ä¸‹æœ‰ä¸¤ä¸ªè®¾å¤‡ç±»ï¼š{53F56307-B6BF-11D0-94F2-00A0C91EFB8B}{53F5630d-B6BF-11D0-94F2-00A0C91EFB8B}ï¼Œå¯ä»¥é€šè¿‡ä»–ä»¬è·å–USBæœ€åæ¥å…¥ç³»ç»Ÿæ—¶é—´ã€‚</li></ul><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ¥ä¸‹æ¥æˆ‘æƒ³è¦å®Œæˆçš„å°±æ˜¯å¦‚ä½•æŠŠè¿™äº›é”®å€¼è”ç³»èµ·æ¥ï¼Œä¼¼ä¹è¦é€šè¿‡Dictionary&lt;string, UInfo>ï¼ŒåŒæ—¶æ€æ ·è·å–æ—¶é—´ï¼Œæ€æ ·æ­£ç¡®åˆ é™¤è¿™äº›ä¿¡æ¯éƒ½å€¼å¾—æ·±ç©¶ã€‚</span></p><p><br><strong>æ›´å¤šé»‘å®¢æ•™ç¨‹ï¼Œæ­å»ºé’“é±¼ç½‘ç«™ï¼Œå¦‚ä½•åç›—åˆ«äººçš„è´¦å· è®°å¾—ç§ä¿¡å°ç¼–01è·å–</strong></p><hr><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">äº”.æ€»ç»“</span></h1><p style=text-align:start><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è¿™ç¯‡æ–‡ç« çœŸçš„èŠ±è´¹äº†ä¸€äº›ç²¾åŠ›ï¼Œå¸Œæœ›æ‚¨å–œæ¬¢ã€‚åŒæ—¶æ„Ÿè§‰è‡ªå·±è¦å­¦ä¹ çš„çŸ¥è¯†å¥½å¤šï¼Œä¹Ÿæœ‰å¥½å¤šå¤§ç¥å§è™è—é¾™ï¼Œå¼€æºåˆ†äº«ã€‚ä½œä¸ºåˆå­¦è€…ï¼Œæˆ‘ä»¬å¯èƒ½æœ‰å·®è·ï¼Œä¸è®ºä½ ä¹‹å‰æ˜¯ä»€ä¹ˆæ–¹å‘ï¼Œæ˜¯ä»€ä¹ˆå·¥ä½œï¼Œæ˜¯ä»€ä¹ˆå­¦å†ï¼Œæ˜¯å¤§å­¦å¤§ä¸“ä¸­ä¸“ï¼Œäº¦æˆ–æ˜¯é«˜ä¸­åˆä¸­ï¼Œåªè¦ä½ å–œæ¬¢å®‰å…¨ï¼Œå–œæ¬¢æ¸—é€ï¼Œå°±æœç€è¿™ä¸ªç›®æ ‡å»åŠªåŠ›å§ï¼æœ‰å·®è·ä¸å¯æ€•ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯å»ç¼©å°å·®è·ï¼Œå»æˆ˜æ–—ï¼Œå†µä¸”è¿™ä¸ªå­¦ä¹ çš„å†ç¨‹çœŸçš„å¾ˆç¾ï¼Œå®‰å…¨çœŸçš„æœ‰æ„æ€ã€‚ä½†åˆ‡å‹¿å»åšåäº‹ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ç™½å¸½å­ï¼Œæ˜¯ç»´æŠ¤æˆ‘ä»¬çš„ç½‘ç»œï¼Œå®‰å…¨è·¯ä¸Šå…±å‹‰ã€‚</span></strong></p><p>æ­¤æ–‡è½¬è½½äºï¼šEastmount</p><p>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ï¼Œå¦‚æœ‰ä¾µæƒè”ç³»å°ç¼–åˆ é™¤ï¼</p><p>åŸæ–‡åœ°å€ï¼šhttps://blog.csdn.net/Eastmount/article/details</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'å›æ”¶ç«™','Python','é»‘å¸½'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>