<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>优化 |运筹学线性规划单纯形法之求解 | 极客快訊</title><meta property="og:title" content="优化 |运筹学线性规划单纯形法之求解 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/30104498c04643a9ade41d54ac435510"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/5fbaf7e.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/5fbaf7e.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/5fbaf7e.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/5fbaf7e.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/5fbaf7e.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/5fbaf7e.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/5fbaf7e.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/5fbaf7e.html><meta property="article:published_time" content="2020-10-29T20:50:35+08:00"><meta property="article:modified_time" content="2020-10-29T20:50:35+08:00"><meta name=Keywords content><meta name=description content="优化 |运筹学线性规划单纯形法之求解"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/5fbaf7e.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>优化 |运筹学线性规划单纯形法之求解</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>『运筹OR帷幄』原创</p><p class=ql-align-center><strong>作者：臧永森</strong></p><p>作者：臧永森，清华大学工业工程系在读博士，研究方向：运筹优化算法的设计与应用、数据统计分析、大数据技术与应用，戚铭尧老师团队</p><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p><strong>编者按</strong></p><p>此文属于电子书线性规划专题第三章单纯形法的内容。在前面的文章中，我们为引入单纯形法介绍了可行域、最优解、可行解、基解、基可行解等基础概念，也阐述了它们之间的关系（具体可见文章《在单纯形法之前》）。在明确了这些基本概念之后，这一节我们来探讨单纯形法的思想逻辑和求解步骤。</p><p class=ql-align-justify>我们已经知道，优化问题的最优解一定是基可行解，那么如何找到最优的基可行解就是最优化问题的求解思路。因此，单纯形法在求解过程，就是不断地寻求变量出入基的循环迭代过程，每次迭代都达到降低目标函数值（或增大目标函数值）的目的，最终得到最优解。那么在迭代过程中，如何使解在改善过程中向着最优解的方向尽快地收敛呢？我们下面用比较直观的方式来解析这个过程。</p><p><strong>单纯形法的基本思想与逻辑</strong></p><p class=ql-align-justify>本文采用的思路参考Dimitris Bertsimas和 John N. Tsitsiklis在 Introduction to Linear Optimization一书中提出的方法[1]。考虑如下标准线性规划问题：</p><div class=pgc-img><img alt="优化 |运筹学线性规划单纯形法之求解" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/30104498c04643a9ade41d54ac435510><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify>我们将矩阵A拆分为n个列元素：A1, A2, A3,, An，那么我们可以将问题看成是满足非负约束（4）、凸约束（3）以及约束（5）的最小化问题。</p><div class=pgc-img><img alt="优化 |运筹学线性规划单纯形法之求解" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/95a8b69d0ac64259833704c9ad2034fa><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify>结合式（3）和（5）我们可以看出，原优化问题转化为求解能够构造出（b, z）的使得z值最小的关于（Ai, ci）的凸组合。为了更好地理解它们之间的几何关系，我们将一个平面视作包含A的一个m维空间，将与ci相关的成本项看作是一维垂直数轴，这时每一个点（Ai, ci）都可以唯一在该三维座标系中表示出来，如图1所示：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="优化 |运筹学线性规划单纯形法之求解" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/91eb0e158d3246f0817993e8e6b741e5><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-center>图1 线性规划问题1—4的“列几何”图示</p><p class=ql-align-justify><br></p><p class=ql-align-justify>我们将（b, z）同样视为一条垂直线表示在图1中，这条垂直线叫做需求线，其与平面的交点是（b, 0）点。需求线与（Ai, ci）的凸组合在几何上有一定的关系，它们或相交或相离，这取决于我们对（Ai, ci）凸组合的选取，选取的凸组合不一样，几何关系就不同。很容易能理解，如果需求线和凸组合相交，说明（b, z）可以用相应的凸组合表示出来，也就表明这个凸组合就是原问题的一个可行解；而如果相离，则说明这个凸组合不满足能够表达（b, z）的条件，也就不是原问题的可行解。所有的凸组合构成了一个凸包，如果需求线能够与凸包相交，那么原问题就存在可行解，如果需求线不能与凸包相交，说明原问题无解。进一步将图1抽象，得到图2，从图中我们可以看出，点I、H、G就是三个不同的凸组合与需求线的交点，也就是原问题的三个可行解。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="优化 |运筹学线性规划单纯形法之求解" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/28cd8252acb84a4a9de0497d1573b31f><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-center>图2 可行解的“列几何”图示</p><p class=ql-align-justify><br></p><p class=ql-align-justify>经过上面的分析我们得知，要找到最优解，就是找到与需求线相交的使得z值最小的凸组合。那么如何找这样的凸组合呢？首先引入两个定义：</p><ol><li class=ql-align-justify>如果向量</li></ol><div class=pgc-img><img alt="优化 |运筹学线性规划单纯形法之求解" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/eeb7c4099ec94333a1df55db50986ef6><p class=pgc-img-caption></p></div><ol><li class=ql-align-justify>是线性独立的，那么向量</li></ol><div class=pgc-img><img alt="优化 |运筹学线性规划单纯形法之求解" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/142016f4644040719c31fd75a4b8e38c><p class=pgc-img-caption></p></div><ol><li class=ql-align-justify>被称为Rn空间中的仿射独立或者仿射无关，其中k&lt;=n。</li><li class=ql-align-justify>在Rn空间中由k+1个仿射无关向量组成的凸包被称为k维单纯形。</li></ol><p class=ql-align-justify><br></p><p class=ql-align-justify>对模型（1—4）来说，总共有m+1个等式约束，假定约束系数矩阵是满秩的，那么一个基可行解将对应m+1个线性独立的列向量，也就意味着有m+1个基点，根据上述定义，由基点之间的差向量线性独立可以得到其仿射独立，由此可以知道它们组成的凸包是m维单纯形。</p><p class=ql-align-justify>假设m维单纯形与需求线相交于点（b, z），由（5）知用来表示（b, z）的线性组合的权重向量是xi ，该向量就是一个基可行解，也就对应我们上节所分析的基变量的内容，当然z就是相应的目标函数值。我们用图2做一个解释，阴影区域的三角形CDF，就是一个2维单纯形，其与需求线的交点H点就是基可行解，点C、D、F是基点。</p><p class=ql-align-justify>我们对二维单纯形CDF做一些改变，会发现相应的z值（与需求线的交点）也会变化，比如我们令基点B取代基点F，单纯形变为BCD，这时可行解变为I点，相应的z值较之前有所增长。类似地，若点E取代点C成为基点，单纯形由CDF变为EDF，可行解就出现在G点，此时z值有所减小。从这些变化中我们找出这样一个规律，当且仅当新加入基的点在当前单纯形平面上方（下方）时，所得的交点（即可行解）对应的z值会增大（减小）。</p><p class=ql-align-justify>如果我们更加形象地描述这个基点变化的过程，就如同用手抓住单纯形CDF的基点C，保持D点和F点固定不变，用力向上拉（向下拉），将C点拉到B点（E点），也就产生了新的单纯形BCD（EDF）。单纯形法的旋转迭代过程，就是不断找到基点向上拉（向下拉）到新基点形成新单纯形的过程。</p><p><strong>单纯形法的求解过程</strong></p><p class=ql-align-justify>简单总结一下单纯形法的求解原理。先找到一个基可行解，然后从非基解中找一个比较有前途的点入基，替换掉基可行解中有待改善的基点，从而达到改善目标函数的目的，如此重复迭代，直至无法找到可以入基的点。</p><p class=ql-align-justify>下面我们用一个例题来演示单纯形法的求解过程。用单纯形法求解如下LP问题：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="优化 |运筹学线性规划单纯形法之求解" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f70213aa77b84704bd0d38044fe08265><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><strong>第一步：</strong>将上述LP转化为标准形式，目的是能够在初始单纯形表中很容易地获得初始基可行解。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="优化 |运筹学线性规划单纯形法之求解" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4574c526437e40aabe9a2cc88d85584e><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><strong>第二步</strong>，将标准LP列入第0个单纯形表，如表1：</p><p class=ql-align-center>表1 单纯形表0</p><p class=ql-align-justify><br></p><div class=pgc-img><img alt="优化 |运筹学线性规划单纯形法之求解" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/910cdedab64449b7b6539c3ca9974470><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify>上述单纯形表中可以看出初始基变量是（s1,s2,s3），从表中找一个能够入基的变量，要求该变量入基后能够使得目标函数值增大量最大。决策变量在第0行的系数看成是这个变量的缩减成本，就是当这个变量增加1时，目标函数z的值将减少的量。比如x1的系数是-2，就说明当x1每增加1，z值将减少-2，也就是增加2。因此如果我们要选择能够使目标函数增加量最大的量入基，应该选择第0行中系数最小的负值（读者可以考虑下为什么必须是负值）。因此这里选择x2入基。</p><p class=ql-align-justify>那如何选择出基变量呢？这里我们采用比值法，用右端项的值（即rhs列）除以出基变量对应的列系数（红色线框标注），从中选择最小的比值对应的基变量出基。如果不选择最小比值对应的基变量出基，将会导致后面的迭代过程出现负的右端项，相应行的基变量将为负值，这与LP标准型的变量非负约束相违背，因此这种操作是不被允许的。所以，表1中的比值优胜者是3，因此s3出基（蓝色线框标注）。</p><p class=ql-align-justify><strong>第三步：</strong>通常我们会在x2所在列与s3所在行交汇点圈一个圈，也就是元素4。这表示这一点是我们的转轴点，通过初等变化，将该元素所在的行与列的其他元素变为0，该元素本身变为1，得到下一个单纯形表，如表2所示：</p><p class=ql-align-center>表2 单纯形表1</p><p class=ql-align-justify><br></p><div class=pgc-img><img alt="优化 |运筹学线性规划单纯形法之求解" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/c50f6560079c4f218a000fddfd639374><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify><strong>第四步：</strong>继续在第0行找负系数对应的入基变量，发现x1对应的系数是-2，可以入基。同时比值运算发现s1对应的变量需要出基，因此第一行、x1列对应的元素1是转轴点，圈一个圈，并进行列运算，得表3：</p><p class=ql-align-center>表3 单纯形表2</p><p class=ql-align-justify><br></p><div class=pgc-img><img alt="优化 |运筹学线性规划单纯形法之求解" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/875aea93cc8c414d8843afab0c4fa505><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify><strong>第五步：</strong>继续上述计算，注意这里因为入基变量s3对应的列有负值，在比值运算时直接赋值为空，因为比值只看正值，如果将负值也考虑进来取最小比值，同样将导致负的右端项。通过入基变量选取和比值测试，对元素2圈圈，做行列变换，得表4：</p><p class=ql-align-center>表4 单纯形表3</p><p class=ql-align-justify><br></p><div class=pgc-img><img alt="优化 |运筹学线性规划单纯形法之求解" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/755ef971fd454d7a9a7e868ac9c9de1e><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify><strong>第六步：</strong>最新表中发现第0行的所有元素均为正值，此时选取任何变量入基，都会使得z值因为正的缩减成本而降低，很显然这对于最大化问题来说是不利的。因此，上表已经达到最优状态，单纯形法迭代结束。</p><p class=ql-align-justify>综上，原问题最优解就是</p><div class=pgc-img><img alt="优化 |运筹学线性规划单纯形法之求解" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/cd35c630f89a4de8bc7e38ecc0df08e0><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify>本文主要介绍了单纯形法的基本逻辑思路，以及具体的求解过程，接下来我们将继续带领大家探索单纯形法求解过程中可能出现的几种解，以及单纯形法的变形求解方法。，希望大家继续关注【优化】板块，电子书线性规划专题的科普文。</p><h1 class=ql-align-justify><strong>参考文献：</strong></h1><p>[1] Dimitris Bertsimas, John N. Tsitsiklis, Introduction to Linear Optimization. Athena Scientific, Belmont, Massachusetts. P120—123.</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'优化','运筹','学线性'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>