<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>jackson学习之九：springboot整合(配置文件) | 极客快訊</title><meta property="og:title" content="jackson学习之九：springboot整合(配置文件) - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/e4c011d1115e489dbe99f5d3cfc2ed59"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/60fcbeb.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/60fcbeb.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/60fcbeb.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/60fcbeb.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/60fcbeb.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/60fcbeb.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/60fcbeb.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/60fcbeb.html><meta property="article:published_time" content="2020-10-29T20:59:53+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:53+08:00"><meta name=Keywords content><meta name=description content="jackson学习之九：springboot整合(配置文件)"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/60fcbeb.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>jackson学习之九：springboot整合(配置文件)</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>欢迎访问我的GitHub</h1><p style=text-align:start>https://github.com/zq2599/blog_demos</p><p style=text-align:start>内容：所有原创文章分类和汇总，及配套源码，涉及Java、Docker、Kubernetes、DevOPS等；</p><h1 class=pgc-h-arrow-right>关于springboot整合jackson</h1><ul><li>本文是《jackson学习》系列的第九篇，学习如何在springboot项目中使用jackson，以<strong>springboot-2.3.3.RELEASE</strong>版本为例，jackson是springboot的默认json处理工具，如下图红框，jackson在maven配置中被spring-boot-starter-web间接依赖，可直接使用：</li></ul><div class=pgc-img><img alt=jackson学习之九：springboot整合(配置文件) onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e4c011d1115e489dbe99f5d3cfc2ed59><p class=pgc-img-caption></p></div><ul><li>在springboot项目中常用的配置方式有两种：</li></ul><ol start=1><li>用properties或yml配置文件来配置，即本篇的内容；</li><li>用配置类来配置，这是下一篇文章的主题；</li></ol><h1 class=pgc-h-arrow-right>本篇概览</h1><p>今天实战内容如下：</p><ol start=1><li>开发springboot应用，体验springboot默认支持jackson，包括jackson注解和ObjectMapper实例的注入；</li><li>在application.yml中添加jackson配置，验证是否生效；</li></ol><h1 class=pgc-h-arrow-right>源码下载</h1><p style=text-align:start>如果您不想编码，可以在GitHub下载所有源码，地址和链接信息如下表所示(<br>https://github.com/zq2599/blog_demos)：</p><div class=pgc-img><img alt=jackson学习之九：springboot整合(配置文件) onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/5b88b2760adb4532b2f8452061b7a671><p class=pgc-img-caption></p></div><ul><li>这个git项目中有多个文件夹，本章的应用在jacksondemo文件夹下，如下图红框所示：</li></ul><div class=pgc-img><img alt=jackson学习之九：springboot整合(配置文件) onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/a5f57b4e37674a1c976552f07772a576><p class=pgc-img-caption></p></div><ul><li>jacksondemo是父子结构的工程，本篇的代码在springbootproperties子工程中，如下图：</li></ul><div class=pgc-img><img alt=jackson学习之九：springboot整合(配置文件) onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/73a7c84dfb4241f08a1cfa27860b3091><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>开始实战</h1><ol start=1><li>由于同属于《jackson学习》系列文章，因此本篇的springboot工程作为<strong>jacksondemo</strong>的子工程存在，pom.xml如下，需要注意的是parent<strong>不能使用</strong>spring-boot-starter-parent，而是通过dependencyManagement节点来引入springboot依赖：</li></ol><pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;    &lt;parent&gt;        &lt;artifactId&gt;jacksondemo&lt;/artifactId&gt;        &lt;groupId&gt;com.bolingcavalry&lt;/groupId&gt;        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;        &lt;relativePath&gt;../pom.xml&lt;/relativePath&gt;    &lt;/parent&gt;    &lt;groupId&gt;com.bolingcavalry&lt;/groupId&gt;    &lt;artifactId&gt;springbootproperties&lt;/artifactId&gt;    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;    &lt;name&gt;springbootproperties&lt;/name&gt;    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;    &lt;properties&gt;        &lt;java.version&gt;1.8&lt;/java.version&gt;    &lt;/properties&gt;    &lt;!--不用spring-boot-starter-parent作为parent时的配置--&gt;    &lt;dependencyManagement&gt;        &lt;dependencies&gt;            &lt;dependency&gt;                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;                &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;                &lt;version&gt;2.3.3.RELEASE&lt;/version&gt;                &lt;type&gt;pom&lt;/type&gt;                &lt;scope&gt;import&lt;/scope&gt;            &lt;/dependency&gt;        &lt;/dependencies&gt;    &lt;/dependencyManagement&gt;    &lt;dependencies&gt;        &lt;dependency&gt;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;        &lt;/dependency&gt;        &lt;dependency&gt;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;            &lt;scope&gt;test&lt;/scope&gt;            &lt;exclusions&gt;                &lt;exclusion&gt;                    &lt;groupId&gt;org.junit.vintage&lt;/groupId&gt;                    &lt;artifactId&gt;junit-vintage-engine&lt;/artifactId&gt;                &lt;/exclusion&gt;            &lt;/exclusions&gt;        &lt;/dependency&gt;        &lt;!-- swagger依赖 --&gt;        &lt;dependency&gt;            &lt;groupId&gt;io.springfox&lt;/groupId&gt;            &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;        &lt;/dependency&gt;        &lt;!-- swagger-ui --&gt;        &lt;dependency&gt;            &lt;groupId&gt;io.springfox&lt;/groupId&gt;            &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;        &lt;/dependency&gt;    &lt;/dependencies&gt;    &lt;build&gt;        &lt;plugins&gt;            &lt;plugin&gt;                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;            &lt;/plugin&gt;        &lt;/plugins&gt;    &lt;/build&gt;&lt;/project&gt;</code></pre><ol start=2><li>启动类很平常：</li></ol><pre><code>package com.bolingcavalry.springbootproperties;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@SpringBootApplicationpublic class SpringbootpropertiesApplication {    public static void main(String[] args) {        SpringApplication.run(SpringbootpropertiesApplication.class, args);    }}</code></pre><ol start=3><li>由于用到了swagger，因此要添加swagger配置：</li></ol><pre><code>package com.bolingcavalry.springbootproperties;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import springfox.documentation.builders.ApiInfoBuilder;import springfox.documentation.builders.PathSelectors;import springfox.documentation.builders.RequestHandlerSelectors;import springfox.documentation.service.ApiInfo;import springfox.documentation.service.Contact;import springfox.documentation.service.Tag;import springfox.documentation.spi.DocumentationType;import springfox.documentation.spring.web.plugins.Docket;import springfox.documentation.swagger2.annotations.EnableSwagger2;@Configuration@EnableSwagger2public class SwaggerConfig {    @Bean    public Docket createRestApi() {        return new Docket(DocumentationType.SWAGGER_2)                .apiInfo(apiInfo())                .tags(new Tag("JsonPropertySerializationController", "JsonProperty相关测试"))                .select()                // 当前包路径                .apis(RequestHandlerSelectors.basePackage("com.bolingcavalry.springbootproperties.controller"))                .paths(PathSelectors.any())                .build();    }    //构建 api文档的详细信息函数,注意这里的注解引用的是哪个    private ApiInfo apiInfo() {        return new ApiInfoBuilder()                //页面标题                .title("SpringBoot整合Jackson(基于配置文件)")                //创建人                .contact(new Contact("程序员欣宸", "https://github.com/zq2599/blog_demos", "zq2599@gmail.com"))                //版本号                .version("1.0")                //描述                .description("API 描述")                .build();    }}</code></pre><ol start=4><li>序列化和反序列化用到的Bean类，可见使用了<strong>JsonProperty</strong>属性来设置序列化和反序列化时的json属性名，<strong>field0</strong>字段刻意没有get方法，是为了验证JsonProperty的序列化能力：</li></ol><pre><code>package com.bolingcavalry.springbootproperties.bean;import com.fasterxml.jackson.annotation.JsonProperty;import io.swagger.annotations.ApiModel;import io.swagger.annotations.ApiModelProperty;import java.util.Date;@ApiModel(description = "JsonProperty注解测试类")public class Test {    @ApiModelProperty(value = "私有成员变量")    @JsonProperty(value = "json_field0", index = 1)    private Date field0 = new Date();    public void setField0(Date field0) {        this.field0 = field0;    }    @ApiModelProperty(value = "来自get方法的字符串")    @JsonProperty(value = "json_field1", index = 0)    public String getField1() {        return "111";    }    @Override    public String toString() {        return "Test{" +                "field0=" + field0 +                '}';    }}1234567891011121314151617181920212223242526272829303132</code></pre><ol start=6><li>测试用的Controller代码如下，很简单只有两个接口，<strong>serialization</strong>返回序列化结果，<strong>deserialization</strong>接受客户端请求参数，反序列化成实例，通过toString()来检查反序列化的结果，另外，还通过Autowired注解从spring容器中将ObjectMapper实例直接拿来用：</li></ol><pre><code>package com.bolingcavalry.springbootproperties.controller;import com.bolingcavalry.springbootproperties.bean.Test;import com.fasterxml.jackson.core.JsonProcessingException;import com.fasterxml.jackson.databind.ObjectMapper;import io.swagger.annotations.Api;import io.swagger.annotations.ApiOperation;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.RequestBody;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod;import org.springframework.web.bind.annotation.RestController;@RestController@RequestMapping("/jsonproperty")@Api(tags = {"JsonPropertySerializationController"})public class JsonPropertySerializationController {    private static final Logger logger = LoggerFactory.getLogger(JsonPropertySerializationController.class);    @Autowired    ObjectMapper mapper;    @ApiOperation(value = "测试序列化", notes = "测试序列化")    @RequestMapping(value = "/serialization", method = RequestMethod.GET)    public Test serialization() throws JsonProcessingException {        Test test = new Test();        logger.info(mapper.writeValueAsString(test));        return test;    }    @ApiOperation(value = "测试反序列化", notes="测试反序列化")    @RequestMapping(value = "/deserialization",method = RequestMethod.PUT)    public String deserialization(@RequestBody Test test) {        return test.toString();    }}</code></pre><h1 class=pgc-h-arrow-right>验证(不用配置文件)</h1><ul><li>先来看看没有配置文件时，默认的jackson配置的表现，直接在IDEA上运行SpringbootpropertiesApplication；</li></ul><ul><li>浏览器访问http://localhost:8080/swagger-ui.html ，如下图红框1，<strong>json_field0</strong>和<strong>json_field1</strong>都是JsonProperty注释，出现在了swagger的model中，这证明jackson注解已经生效：</li></ul><div class=pgc-img><img alt=jackson学习之九：springboot整合(配置文件) onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/c65b273007c14eba9da28a16ea2dce8a><p class=pgc-img-caption></p></div><ul><li>点击上图的红框2，看看springboot引用返回的序列化结果，如下图：</li></ul><div class=pgc-img><img alt=jackson学习之九：springboot整合(配置文件) onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/001a6093cffa424581be3111ef2eb656><p class=pgc-img-caption></p></div><ul><li>另外，上述红框中的json格式，每个属性单独一行，像是做了格式化调整的，这是springboot做的？还是swagger展示的时候做的？用浏览器访问http://localhost:8080/jsonproperty/serialization ，结果如下，可见springboot返回的是<strong>未经过格式化的json</strong>：</li></ul><div class=pgc-img><img alt=jackson学习之九：springboot整合(配置文件) onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/17dc476d85c040dabf432a5559f0edfe><p class=pgc-img-caption></p></div><ul><li>接下来咱们添加jackson相关的配置信息并验证是否生效；</li></ul><h1 class=pgc-h-arrow-right>添加配置文件并验证</h1><ul><li>在resources目录新增application.yml文件，内容如下：</li></ul><pre><code>spring:  jackson:    # 日期格式化    date-format: yyyy-MM-dd HH:mm:ss    # 序列化相关    serialization:      # 格式化输出      indent_output: true      # 忽略无法转换的对象      fail_on_empty_beans: true    # 反序列化相关    deserialization:      # 解析json时，遇到不存在的属性就忽略      fail_on_unknown_properties: false    # 设置空如何序列化    defaultPropertyInclusion: NON_EMPTY    parser:      # 允许特殊和转义符      allow_unquoted_control_chars: true      # 允许单引号      allow_single_quotes: true</code></pre><ul><li>将鼠标放置下图红框位置，再按住Ctlr键，IDEA会弹出一个浮层，提示该配置对应的jackson代码，如下图：</li></ul><div class=pgc-img><img alt=jackson学习之九：springboot整合(配置文件) onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/98e9c8d9fbfa494e94a8877d86c7aa02><p class=pgc-img-caption></p></div><ul><li>在上图中，按住Ctlr键，用鼠标点击红框位置即可打开此配置对应的jackson源码，如下图：</li></ul><div class=pgc-img><img alt=jackson学习之九：springboot整合(配置文件) onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/28905e23064b4f368d8bcbb499bec8ce><p class=pgc-img-caption></p></div><ul><li>重新运行springboot应用，用浏览器访问：<strong>http://localhost:8080/jsonproperty/serialization</strong> ，结果如下图，可见json_field0的格式变成了<strong>yyyy-MM-dd HH:mm:ss</strong>，而且json输出也做了格式化，证明application.yml中的配置已经生效：</li></ul><div class=pgc-img><img alt=jackson学习之九：springboot整合(配置文件) onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/607b90f837424699857e7f831cdf228c><p class=pgc-img-caption></p></div><ul><li>再来试试反序列化，打开swagger页面，操作和响应如下图所示，注意红框1里面请求参数的格式：</li></ul><div class=pgc-img><img alt=jackson学习之九：springboot整合(配置文件) onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dd8b382abea84f83af69c4e5d87e6987><p class=pgc-img-caption></p></div><ul><li>至此，在springboot中通过yml配置jackson的操作实战就完成了，接下来的章节，咱们在配置类中用代码来完成yml的配置；</li></ul><h1 class=pgc-h-arrow-right>欢迎关注我的公众号：程序员欣宸</h1><div class=pgc-img><img alt=jackson学习之九：springboot整合(配置文件) onerror=errorimg.call(this); src=https://p9.pstatp.com/large/dfic-imagehandler/612ae87f-785b-471e-a34a-5ac4939b4aef><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'配置文件','jackson','学习'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>