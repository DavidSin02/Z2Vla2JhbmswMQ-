<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>第七讲：C语言基础之函数，第四节，变量的存储类别 | 极客快訊</title><meta property="og:title" content="第七讲：C语言基础之函数，第四节，变量的存储类别 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/0433f60c397e45ddbc3fe35c0af3d74a"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6536c4f5.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6536c4f5.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/6536c4f5.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6536c4f5.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6536c4f5.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/6536c4f5.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/6536c4f5.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6536c4f5.html><meta property="article:published_time" content="2020-11-14T20:59:55+08:00"><meta property="article:modified_time" content="2020-11-14T20:59:55+08:00"><meta name=Keywords content><meta name=description content="第七讲：C语言基础之函数，第四节，变量的存储类别"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/6536c4f5.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>第七讲：C语言基础之函数，第四节，变量的存储类别</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>本文约3000字，主要讲了<strong>C语言基础之函数-变量的存储类别，动态存储方式与静态存储方式（自动的（auto），静态的（static），寄存器的（register），外部的（extern））、存储类总结以及一些案例和例题。</strong>前面已介绍了从变量的作用域（即从空间）角度来分，可以分为全局变量和局部变量。那么从变量值存在的时间（即生存期）角度来分，又可以分为静态存储方式和动态存储方式。</p><p>带你进入C语言的世界，入门C语言，后边将持续更新。<strong>可以收藏学习。想了解</strong><a class=pgc-link data-content=mp href="https://www.toutiao.com/i6766035466102768139/?group_id=6766035466102768139" target=_blank>C语言基础之函数，局部变量和全局变量以及一些建议和说明，有案例和例题</a><strong>等，</strong>请点击该处跳转阅读。</p><p><strong>本文全干货，新手必备，感谢你的阅读，祝你学有所成，生活愉快！</strong></p><hr><h1><strong>一、动态存储方式与静态存储方式</strong></h1><p><strong>1.</strong>所谓静态存储方式是指在程序运行期间由系统分配固定的存储空间的方式。而动态存储方式则是在程序运行期间根据需要进行动态的分配存储空间的方式。用户存储空间可以分为三部分：</p><p>（1）程序区</p><p>（2）静态存储区</p><p>（3）动态存储区</p><p><strong>2.变量的存储类别</strong></p><p>在Ｃ语言中每一个变量和函数有两个属性：数据类型和数据的存储类别。对数据型（如整型、字符型等）。存储类别指的是数据在内存中存储的方式。</p><p>存储方式分为两大类：静态存储类和动态存储类。</p><p>具体包含四种：自动的（auto），静态的（static），寄存器的（register），外部的（extern）。根据变量的存储类别，可以知道变量的作用域和生存期。</p><h1><strong>二、auto变量</strong></h1><p>函数中的局部变量，如不专门声明为static存储类别，都是动态地分配存储空间的(栈)，数据存储在动态存储区中。</p><p>函数中的形参和在函数中定义的变量(包括在复合语句中定义的变量)，都属此类，在调用该函数时系统会给它们分配存储空间，在函数调用结束时就自动释放这些存储空间。</p><p>因此这类局部变量称为自动变量。自动变量用关键字auto作存储类别的声明。</p><blockquote><p>案例1：</p><p>int ｆ（int ａ） ／*定义f函数，ａ为形参 *／</p><p>｛</p><p>auto int ｂ，ｃ＝３； ／*定义ｂ、ｃ为自动 变量 *／</p><p>…………</p><p>｝</p></blockquote><p>关键字auto可以省略，auto不写则隐含定为“自动存储类别”，属于动态存储方式。</p><h1><strong>三、用static声明局部变量</strong></h1><p><strong>1.</strong>有时希望函数中的局部变量的值在函数调用结束后不消失而保留原值，即其占用的存储单元不释放，<strong>在下一次该函数调用时，该变量已有值，就是上一次函数调用结束时的值。</strong>这时就应该指定该局部变量为“静态局部变量”，用关键字static进行声明。</p><blockquote><p>案例2：考察静态局部变量的值</p><p>#include &lt;stdio.h></p><p>int f(int a)</p><p>{</p><p>auto int b = 0;</p><p>static int c = 3;</p><p><br></p><p>b = b + 1; // b == 1 , 1 , 1</p><p>c = c + 1; // c == 4 , 5 , 6</p><p><br></p><p>return (a+b+c); // 7 , 8 , 9</p><p><br></p><p>}</p><p>main()</p><p>{</p><p>int a=2, i;</p><p>for(i=0; i &lt; 3; i++)</p><p>{</p><p>printf("%d\n", f(a));</p><p>}</p><p>}</p></blockquote><p><strong>2.对静态局部变量的说明</strong></p><p>(1) 静态局部变量属于静态存储类别，在静态存储区内分配存储单元。在程序整个运行期间都不释放。而自动变量（即动态局部变量）属于动态存储类别，占动态存储区空间而不占静态存储区空间，函数调用结束后即释放。</p><p>(2) 对静态局部变量是在编译时赋初值的，即只赋初值一次，在程序运行时它已有初值。以后每次调用函数时不再重新赋初值而只是保留上次函数调用结束时的值。而对自动变量赋初值，不是在编译时进行的，而是在函数调用时进行，每调用一次函数重新给一次初值，相当于执行一次赋值语句。</p><p>(3)如在定义局部变量时不赋初值的话，则对静态局部变量来说，<strong>编译时自动赋初值０（对数值型变量）或空字符（对字符变量）。</strong>而对自动变量来说，如果不赋初值则它的值是一个不确定的值。这是由于每次函数调用结束后存储单元已释放，下次调用时又重新另分配存储单元，而<strong>所分配的单元中的值是不确定的。</strong></p><p>(4) 虽然静态局部变量在函数调用结束后仍然存在，但<strong>其他函数是不能引用它的。</strong></p><blockquote><p>案例3：输出１到５的阶乘值。</p><p>#include &lt;stdio.h></p><p>int fac(int n)</p><p>{</p><p>static int f = 1;</p><p><br></p><p>f = f * n; // 1, 2, 2*3, 6*4, 24*5</p><p><br></p><p>return (f); // 1, 2, 6, 24, 120</p><p>}</p><p>main()</p><p>{</p><p>int i;</p><p>for(i=1; i &lt;= 5; i++)</p><p>{</p><p>printf("%d! = %d\n", i, fac(i)); // 1, 2, 6, 24, 120</p><p>}</p><p>}</p></blockquote><h1><strong>四、register变量</strong></h1><p>一般情况下，变量（包括静态存储方式和动态存储方式）的值是存放在内存中的。当程序中用到哪一个变量的值时，由控制器发出指令将内存中该变量的值送到运算器中。 经过运算器进行运算，如果需要存数，再从运算器将数据送到内存存放。</p><div class=pgc-img><img alt=第七讲：C语言基础之函数，第四节，变量的存储类别 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0433f60c397e45ddbc3fe35c0af3d74a><p class=pgc-img-caption></p></div><p>如果有一些变量使用频繁（例如在一个函数中执行10000次循环，每次循环中都要引用某局部变量），则为存取变量的值要花费不少时间。为提高执行效率，Ｃ语言允许将局部变量的值放在CPU中的寄存器中，需要用时直接从寄存器取出参加运算，不必再到内存中去存取。</p><p>由于对寄存器的存取速度远高于对内存的存取速度，因此这样做可以提高执行效率。这种变量叫做寄存器变量，用关键字register作声明。</p><blockquote><p>案例4：看看这个输出的是什么</p><p>#include &lt;stdio.h></p><p>int fac(int n)</p><p>{</p><p>register int i, f = 1;</p><p><br></p><p>for(i=1; i &lt;= n; i++)</p><p>{</p><p>f *= i;</p><p>}</p><p><br></p><p>return (f);</p><p>}</p><p>main()</p><p>{</p><p>int i;</p><p>for(i=1; i &lt;= 15; i++)</p><p>{</p><p>printf("%d! = %d\n", i, fac(i));</p><p>}</p><p>}</p><p>//注意，这个版本不用static特性，所以把阶乘的过程放在fac()函数中实现。</p></blockquote><h1><strong>六、用extern声明外部变量</strong></h1><p>外部变量即全局变量，它的作用域是从变量的定义处开始，到本程序文件的末尾。在此作用域内，全局变量可以为程序中各个函数所引用。编译时将外部变量分配在静态存储区。有时需要用extern来声明外部变量，以扩展外部变量的作用城。</p><blockquote><p>案例5：用extern声明外部变量，扩展程序文件中的作用域。</p><p>#include &lt;stdio.h></p><p>int max(int x, int y)</p><p>{</p><p>int z;</p><p>z = x>y ? x : y;</p><p>return(z);</p><p>}</p><p>main()</p><p>{</p><p>extern A, B; //试试去掉extern关键字。</p><p>printf("%d\n", max(A, B));</p><p>}</p><p>int A = 13, B = -8;</p></blockquote><h1><strong>七、存储类总结</strong></h1><p><strong>1.</strong>从作用域角度分，有局部变量和全局变量。</p><div class=pgc-img><img alt=第七讲：C语言基础之函数，第四节，变量的存储类别 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/63ab1960215247779d9563e21ebf8acf><p class=pgc-img-caption></p></div><p><strong>2.</strong>从变量存在的时间（生存期）来区分，有动态存储和静态存储两类。</p><p>静态存储：是程序整个运行时间都存在；（静态局部\外部变量、外部变量）</p><p>动态存储：是在调用函数时临时分配单元。（自动变量、寄存器变量、形式参数）</p><p><strong>3.</strong>从变量值存放的位置来区分：</p><div class=pgc-img><img alt=第七讲：C语言基础之函数，第四节，变量的存储类别 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e329658e15c14f5eb15ff63ffb4c0abb><p class=pgc-img-caption></p></div><p><strong>4.</strong>作用域和生存期的概念</p><p>一个是空间角度，一个是时间角度。有联系但不是一回事。</p><p><strong>5.</strong>Static对局部变量和全局变量作用不同。</p><p><br></p><p>对局部变量来说：使变量由动态存储方式变为静态存储方式。</p><p>对全局变量来说：使变量局部化（限于本文），但仍为静态存储方式。</p><p>从作用域来看：有static声明的，其作用域都是局限的。</p><p><strong>6.</strong>内部函数和外部函数</p><p><strong>内部函数：</strong>只能在本文件被其他函数调用</p><p>在定义时，函数名和函数类型前加static。例：static int fun（int a，int b）</p><p><strong>外部函数：</strong>在函数最左端加关键字extern表示。</p><p>例如：extern int fun（int a，int b）</p><p>如果定义时省略extern，则隐含为外部函数。</p><hr><p><strong>感谢您的阅读，希望有所收获！会持续更新！函数大类就结束了，下一章写指针！</strong></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'语言','基础','函数'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>