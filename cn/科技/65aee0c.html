<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>SpringBoot>08 - 配置文件、基本注解使用 | 极客快訊</title><meta property="og:title" content="SpringBoot>08 - 配置文件、基本注解使用 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/65aee0c.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/65aee0c.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/65aee0c.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/65aee0c.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/65aee0c.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/65aee0c.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/65aee0c.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/65aee0c.html><meta property="article:published_time" content="2020-10-29T20:59:54+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:54+08:00"><meta name=Keywords content><meta name=description content="SpringBoot>08 - 配置文件、基本注解使用"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/65aee0c.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>SpringBoot>08 - 配置文件、基本注解使用</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>一、配置文件：</p><p>配置文件格式 分 application.properties 和 application.yml(官方推荐使用)。</p><p>1、常见的自带属性:</p><p>############ tomcat 相关 ############</p><p>#访问的根路径</p><p>server.context-path=/</p><p>#端口号</p><p>server.port=8080</p><p>#session失效时间 （秒）</p><p>server.session-timeout=30</p><p>#编码</p><p>server.tomcat.uri-encoding=utf-8</p><p>########### 数据库相关 #############</p><p>spring.datasource.url= #数据库地址</p><p>spring.datasource.username=</p><p>spring.datasource.password=</p><p>spring.datasource.driver-class-name= #数据库驱动</p><p>########### Mybatis 配置 ###########</p><p>mybatis.typeAliasesPackage= #别名，对应实体类包</p><p>mybatis.mapperLocations= #mybatis xml位置</p><p>########### 自带日志的配置 ##########</p><p># 日志级别</p><p>logging.level.com.coolron.user.dao=debug</p><p>logging.file=my.log #日志名称</p><p>logging.path=./log #日志路径（默认日志名为 spring.log） 和 logging.file 只能出现一个</p><p>spring.output.ansi.enabled=DETECT # 控制台多彩输出</p><p>########### Redis 配置 ###########</p><p>## Redis数据库索引（默认为0）</p><p>spring.redis.database=0</p><p>## Redis服务器地址</p><p>spring.redis.host=191.250.49.120</p><p>## Redis服务器连接端口</p><p>spring.redis.port=6333</p><p>## Redis服务器连接密码（默认为空）</p><p>spring.redis.password=</p><p>## 连接池最大连接数（使用负值表示没有限制）</p><p>spring.redis.pool.max-active=8</p><p>## 连接池最大阻塞等待时间（使用负值表示没有限制）</p><p>spring.redis.pool.max-wait=-1</p><p>## 连接池中的最大空闲连接</p><p>spring.redis.pool.max-idle=8</p><p>## 连接池中的最小空闲连接</p><p>spring.redis.pool.min-idle=0</p><p>## 连接超时时间（毫秒）</p><p>spring.redis.timeout=3000</p><p><br></p><p>其他属性参看：http://blog.yuqiyu.com/spring-boot-chapter31.html</p><p>2、自定义属性：</p><p>application.properties文件中：</p><p>############## 自定义属性 #################</p><p>custom.properties.social.weixin.app-id = wxfd65ab1fadb2</p><p>custom.properties.social.weixin.app-secret = 66bb4566de776ac6ds1dbejhhcc3dd1</p><p>custom.properties.social.clients[0] = coolron</p><p>custom.properties.social.clients[1] = test</p><p></p><p>自定义属性的读取：</p><p>提供两种方式：使用@Value 读取，将配置文件的属性赋给实体类读取。</p><p>方式一、利用@Value 读取</p><p>1、测试controller：</p><p>/**</p><p>* @Auther: xf</p><p>* @Date: 2018/10/31 15:06</p><p>* @Description: 测试自定义属性</p><p>*/</p><p>@Slf4j</p><p>@RestController</p><p>public class PropertiesController {</p><p>@Value("${custom.properties.social.weixin.app-id}")</p><p>private String appId;</p><p>@Value("${custom.properties.social.clients[0].clientId}")</p><p>private String clientId;</p><p>@GetMapping(value = "getProperties")</p><p>public ApiResult test(){</p><p>log.info("custom.properties.social.weixin.app-id,{}", appId);</p><p>log.info("custom.properties.social.clients[0].clientId,{}", clientId);</p><p>return ApiResult.ok(appId + ">>>>>>>>>>" + clientId);</p><p>}</p><p>}</p><p><br></p><p>方式二、利用实体类读取配置文件自定义属性：</p><p>注意： 以下各类中属性的命名一定要跟配置文件中自定义的属性名称相对应</p><p>1、配置文件读取器：对应配置文件中 custom.properties</p><p>/**</p><p>* 配置文件读取器 读取整个系统配置</p><p>*/</p><p>// 会读取 custom.properties 开头的配置项</p><p>@Data</p><p>@Component</p><p>@ConfigurationProperties(prefix = "custom.properties")</p><p>public class CustomProperties {</p><p>// social 会读取到 此类中去</p><p>private SocialProperties social = new SocialProperties();</p><p>}</p><p></p><p>2、social 实体类：对应配置文件中 social</p><p>@Data</p><p>public class SocialProperties {</p><p>private WeixinProperties weixin = new WeixinProperties();</p><p>private String[] clients = {}; // 默认空数组</p><p>}</p><p></p><p>3、weixin 实体类：对应配置文件中 weixin</p><p>@Data</p><p>public class WeixinProperties{</p><p>private String appId;</p><p>private String appSecret;</p><p>}</p><p></p><p>4、读取器配置类：</p><p>@Configuration</p><p>// 作用 : 使 CustomProperties 配置文件读取器生效</p><p>@EnableConfigurationProperties(CustomProperties.class)</p><p>public class PropertiesCoreConfig {</p><p>}</p><p></p><p>5、在 Propertiescontroller 中新增代码：</p><p>// 注入配置文件读取器</p><p>@Autowired</p><p>private CustomProperties customProperties;</p><p>@GetMapping(value = "getBeanPro")</p><p>public ApiResult beanPro(){</p><p>log.info("app-id: ,{}", customProperties.getSocial().getWeixin().getAppId());</p><p>log.info("clients[0].clientId: ,{}", customProperties.getSocial().getClients()[0]);</p><p>log.info("clients[1].clientId: ,{}", customProperties.getSocial().getClients()[1]);</p><p>return ApiResult.ok(appId + ">>>>>>>>>>" + clientId);</p><p>}</p><p></p><p>6、测试：请求接口：localhost:8080/getBeanPro 控制台如下：</p><p>在这里插入图片描述</p><p>二、多环境配置：</p><p>在开发、测试、生成不同的环境使用不同的配置文件，以swagger 为例，生产和测试环境不需要。Spring Boot中多环境配置文件名需要满足 application-{profile}.properties 的格式，其中{profile}对应你的环境标识。</p><p>1、在src/main/resources 下新建：</p><p>在这里插入图片描述</p><p>2、选择配置文件</p><p>方式一、 在application.properties中指定使用dev/pro/test哪种环境：</p><p># 指定配置文件</p><p>spring.profiles.active=dev</p><p>#spring.profiles.active=pro</p><p>#spring.profiles.active=test</p><p></p><p>效果：开发环境配置文件application-dev.properties 生效。</p><p>方式二： 运行 jar 包（后续章节涉及打包）的时候指定配置文件：</p><p>指定配置文件</p><p>java -jar xxx.jar --spring.profiles.active=test</p><p>java -jar xxx.jar --spring.profiles.active=pro</p><p></p><p>附加：自定义配置文件</p><p>若配置较多，不想都写到application.properties中，可以自定义配置文件，例如：custome.properties, 只需使用@PropertySource 注解映入即可。</p><p>// 建议写到启动类、自定义属性配置类（CustomProperties ）上或者根据自身环境决定。</p><p>@PropertySource(value = “classpath:custom.properties”)</p><p></p><p>三、springboot 基本注解的使用</p><p>此处总结几个常用注解，其他注解遇到了再补充：</p><p>@Configuration：类上，表明这是一个IOC容器，相当于springMVC中的配置文件，springboot使用该注解用作java配置。</p><p>@Bean： 方法上，常结合@Configuration使用，往spring容器中添加一个组件。</p><p>@Component： 类上，将备被注解的类交给spring容器管理，例如本章的 CustomProperties类</p><p>@ComponentScan：类上，相当于 xml配置文件中的context:component-scan标签，对标注了@Controller、@Service、@Respoitory、@Component等的类扫描，注册为bean</p><p>@SpringBootConfiguration：启动类上，包含@SpringBootConfiguration（继承@Configuration）、 @EnableAutoConfiguration和 @ComponentScan注解</p><p>@RestController：包含@ResponseBody 和 @Controller 的注解</p><p>@PathVariable、@RequestParam、@RequestMapping、@Controller、@Service、@RequestBody、@ResponseBody：跟SpringMVC相同。</p><p># 请求路径 PUT、DELETE、PATCH 同下</p><p>@GetMapping = @RequestMapping(method = RequestMethod.GET)</p><p>@PostMapping = @RequestMapping(method = RequestMethod.POST)</p><p>@EnableScheduling：建议加到启动类上，开启springboot定时支持，结合@Scheduled做定时任务。</p><p>@PropertySource：加载指定的配置文件，例如本章中附加：自定义配置文件</p><p></p><p>至此，springboot配置中常见的自带属性、按需自定义属性，以及它们的两种读取方式：@Value 和 实体类映射，自定义配置文件的引入，常用的几种注解，重点为利用实体类读取配置文件自定义属性。</p><p><br></p><p>原文链接：https://blog.csdn.net/cp026la/java/article/details/86497342</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'配置文件','SpringBoot','08'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>