<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>vim技巧：设置空格和Tab字符可见，并自定义显示的字符颜色 | 极客快訊</title><meta property="og:title" content="vim技巧：设置空格和Tab字符可见，并自定义显示的字符颜色 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/dfic-imagehandler/0d6f7cf7-39d5-464a-9435-e12cf082df89"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/66836947.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/66836947.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/66836947.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/66836947.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/66836947.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/66836947.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/66836947.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/66836947.html><meta property="article:published_time" content="2020-11-14T21:05:00+08:00"><meta property="article:modified_time" content="2020-11-14T21:05:00+08:00"><meta name=Keywords content><meta name=description content="vim技巧：设置空格和Tab字符可见，并自定义显示的字符颜色"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/66836947.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>vim技巧：设置空格和Tab字符可见，并自定义显示的字符颜色</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div class=pgc-img><img alt=vim技巧：设置空格和Tab字符可见，并自定义显示的字符颜色 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/0d6f7cf7-39d5-464a-9435-e12cf082df89><p class=pgc-img-caption></p></div><p>使用 Windows 下的一些 IDE（例如 Source Insight）查看代码时，可以设置空格和Tab字符可见。本篇文章介绍在 vim 中如何进行这个设置，并自定义显示的字符颜色。具体包括下面的内容：</p><ul><li>设置空格和Tab字符可见的好处</li><li>设置空格和Tab字符可见的方法</li><li>设置空格和Tab字符的显示颜色</li><li>只针对特定类型文件自动设置空格和 tab 字符可见</li></ul><h1>设置空格和Tab字符可见的好处</h1><p>在实际工作中，设置空格和Tab字符可见，主要是基于下面的需求：</p><ul><li>由于 tab 字符在不同编辑器下的显示宽度可能不同，在代码中使用 tab 字符进行缩进，在其他地方查看时，排版缩进会发生变化。一些公司的编程规范要求不能使用 tab 字符。设置 tab 字符可见，可以发现哪里用了 tab 字符，便于删除。</li><li>一些公司使用 git 管理代码，并上传到 gerrit 服务器上。如果上传的代码包含 tab 字符，在 gerrit 上审核代码会把 tab 字符显示成红色，也是不建议用 tab 字符，所以需要设置 tab 字符可见，方便在上传代码之前就发现、并删掉 tab 字符。</li><li>在 git 上用 git log -p 命令查看代码修改前后时，行末空格会显示红色的警告。为了不看到这个警告，需要设置空格可见，发现行末空格，以便及时删除。</li></ul><h1>设置空格和Tab字符可见的方法</h1><p>在 vim 中，可以使用下面命令来设置空格和 tab 字符可见：</p><pre>:setlocal list:set listchars=tab:&gt;~,trail:.</pre><p>执行 <strong>:setlocal list</strong> 命令后，会把 tab 字符显示为 CTRL-I 键的显示字符，实际显示为 <strong>^I</strong>。同时会在行末显示一个 <strong>$</strong> 字符。默认不会显示空格。</p><p>这个 <strong>list</strong> 选项是一个 “local to window“ 选项，也就是可以使用 <strong>:setlocal</strong> 命令来设置成只在当前窗口生效，这样设置之后，用 <strong>:edit</strong> 命令再打开其他文件，在新的窗口上没有开启这个设置，不会影响其他文件。</p><p>如果想要在打开代码文件时，才显示空格或 tab 字符，打开其他类型文件，例如 txt 文件、markdown 文件、makefile 文件等，不显示空格或 tab 字符，就可以使用 <strong>:setlocal list</strong> 命令。如果需要设置成全局状态，所有窗口都开启这个设置，可以使用 <strong>:set list </strong>命令。</p><p>由于把 tab 字符显示为 <strong>^I</strong> 不够直观，不想在行末显示 <strong>$</strong> 字符，且需要显示空格，所以再执行 <strong>set listchars=tab:>~,trail:.</strong> 命令来设置 tab 字符和空格的显示样式，且行末不显示字符。</p><p>这个 <strong>listchars</strong> 选项是一个 “global” 选项，一旦设置，对所有窗口都生效，用于设置 <strong>list</strong> 属性会显示哪些字符、以及如何显示。常见的选项值说明如下：</p><ul><li><strong>eol:c</strong><br>设置行末显示字符为 c。这里 c 可以换成任意一个字符，例如默认的 ‘$’ 字符、或者改成 ‘#’ 字符，等等。<br>显然，要设置成一个可见字符，才能明显地看到显示效果。<br>如果没有设置这一项，行末不显示任何字符。</li><li><strong>tab:xy</strong><br>设置 tab 字符的显示样式，字符 x 总是会显示，会显示零个或多个字符 y 以填充到 tab 字符的显示宽度。<br>例如，设置为 <strong>tab:>-</strong>，且 tab 字符的显示宽度是 4，那么 tab 字符会显示为 <strong>>---</strong>。<br>实际显示的时候，可能只显示一个 <strong>></strong>，或者只显示 <strong>>-</strong>。这个跟 tab 字符所在的位置有关。假设 tab 字符的显示宽度为 4，意味着 tab 字符的宽度总是停在 4 的倍数行上，当手动输入 3 个空格，再输入一个 tab 字符时，tab 字符只会显示一个空白字符，那么就只显示所设置的字符 x，对于刚才的例子来说，就是只显示 <strong>></strong> 字符。<br>在实际测试时，如有设置 <strong>:set expandtab</strong>，会把 tab 字符转换成空格，输入 tab 键不会得到 tab 字符，要先执行 <strong>:set noexpandtab </strong>命令，关闭这个设置再来测试。</li><li><strong>tab:xyz</strong><br>设置 tab 字符的显示样式，字符 z 总是会显示，显示字符 z 之后，如果还有可显示的位置，字符 x 会显示在开头，在字符 x 和 字符 z 中间显示零个或多个字符 y 以填充到 tab 字符的显示宽度。<br>例如，设置为 <strong>tab:&lt;-></strong>，且 tab 字符的显示为 4，那么 tab 字符会显示为 <strong>&lt;--></strong>。<br>实际显示的时候，可能只显示一个 <strong>></strong>，或者显示为 <strong>&lt;></strong>、<strong>&lt;-></strong> 等，跟 tab 字符所在的位置有关。如上面说明所示。</li><li>如果没有设置 <strong>tab:</strong> 这一项，tab 字符默认会显示为 <strong>^I</strong>。</li><li><strong>space:c</strong><br>设置所有的空格显示为字符 c，包括行首空格、行中间的空格、行末空格都会显示。<br>这里 c 可以换成任意一个字符。<br>如果没有设置这一项，空格显示为默认的空白。</li><li><strong>trail:c</strong><br>设置行末空格显示为字符 c，会覆盖 <strong>space:</strong> 这一项的设置，且只覆盖行末空格的显示。<br>这里 c 可以换成任意一个字符。<br>如果没有设置这一项，行末空格保持为 <strong>space:</strong> 这一项的设置。</li><li>不同设置项之间，用英文逗号 ‘,’ 隔开。例如，<strong>tab:>~,trail:.</strong> 设置了 tab 字符和行末空格的显示样式。</li></ul><p>基于上面说明，可以知道 <strong>set listchars=tab:>~,trail:.</strong> 命令设置 tab 字符显示为 <strong>>~~~~</strong> 的样式（假设 tab 字符的显示宽度是 4），设置行末空格显示为点号 ‘.’，不显示行首空格和行中间的空格，行末不显示字符。如果需要显示所有空格，可以把 <strong>trail</strong> 改成 <strong>space</strong>。</p><h1>设置空格和Tab字符的显示颜色</h1><p>进行前面的设置之后，空格和 tab 字符已经可见，但是显示的字符颜色使用了 <strong>hi SpecialKey</strong> 这一项的颜色，可以执行 <strong>:hi</strong> 命令查看 SpecialKey 对应的颜色是什么，跟 vim 使用的颜色主题有关，不同颜色主题可能有不同的颜色，例如蓝色、绿色、黑底白色等。</p><p>这个显示颜色会跟代码文件本身的颜色高亮混在一起，不方便区分。假设 tab 字符显示为 <strong>>~~~~</strong>，字符颜色是蓝色，如果后面跟着蓝色的代码关键字，就跟代码关键字显示成一个整体，不方便看到代码关键字。前面把行末空格显示为点号 ‘.’，如果某句注释的行末有空格，容易误以为是注释本身的点号。</p><p>为了方便区分于代码文件自身的颜色高亮，可以使用下面命令来设置可见的空格和 tab 字符显示为灰色，不那么显眼：</p><pre>:hi SpecialKey guifg=darkgrey ctermfg=darkgrey</pre><p>如果不想显示成灰色，可以修改上面 guifg、ctermfg 的值，设置成个人喜欢的颜色。</p><p>这样设置之后，会有一个问题，就是修改了默认 <strong>hi SpecialKey</strong> 这一项的颜色。而 vim 会用到这个颜色来显示自身的一些内容，例如执行 <strong>:map</strong> 命令，显示映射的快捷键时，按键字符就显示为 <strong>hi SpecialKey </strong>这一项的颜色，改成灰色后，不太显眼。</p><p>为了避免直接修改 <strong>hi SpecialKey </strong>这一项的颜色，我们可以自定义一个颜色组，并设置为只对空格和 tab 字符生效，具体如下所示：</p><pre>:highlight MyTabSpace guifg=darkgrey ctermfg=darkgrey:match MyTabSpace /\t\| /</pre><p>这里用 <strong>:highlight</strong> 命令（这个命令也可以简写为 <strong>:hi</strong> 命令）来自定义了一个 MyTabSpace 颜色组，显示为灰色。然后用 <strong>:match</strong> 命令设置 MyTabSpace 颜色组对空格和 tab 字符生效。上面的 <strong>\t </strong>就是 tab 字符。不同字符串之间用 <strong>|</strong> 隔开，书写的时候要使用<strong> \| </strong>转义。在 <strong>|</strong> 后面的空白字符就是空格。</p><h1>只针对特定类型文件自动开启空格和 tab 字符可见</h1><p>如前面说明，我们可能只想在查看代码文件时，才设置空格和 tab 字符可见，并且最好是自动开启。这个就需要在 <strong>~/.vimrc</strong> 文件中进行配置。完整配置如下：</p><pre>" 创建一个新的 MyTabSpace 组,并设置它的颜色highlight MyTabSpace guifg=darkgrey ctermfg=darkgrey" 指定tab字符和空格的颜色组为MyTabSpace,不同字符串之间用|隔开,要使用\|转义.match MyTabSpace /\t\| /" 针对特定类型的代码文件,设置显示Tab键和行尾空格以便在查看代码时注意到它们autocmd FileType c,cpp,java,xml setlocal list | set listchars=tab:&gt;~,trail:.</pre><p>这段配置先使用 <strong>:highlight</strong> 命令（在 <strong>.vimrc</strong> 文件中书写时，省略了前面的冒号）自定义一个 MyTabSpace 颜色组，颜色为灰色。然后用 <strong>:match</strong> 命令设置 MyTabSpace 颜色组对空格和 tab 字符生效。由于空格和 tab 字符默认不可见，所以对于没有设置空格和 tab 字符可见的文件窗口来说，这个设置没有影响。</p><p>后面使用 <strong>:autocmd</strong> 命令针对 <strong>c,cpp,java,xml</strong> 这些类型的文件自动设置空格和tab 字符可见，就能看到这些字符显示为灰色。其他类型文件没有自动设置，不受影响。如有需要，可以自行添加其他类型的文件后缀名。</p><p>可以使用 <strong>:help 'list'</strong> 命令查看 <strong>list</strong> 选项的说明。<br>可以使用 <strong>:help 'listchars'</strong> 命令查看 <strong>listchars</strong> 选项的说明。<br>可以使用 <strong>:help :highlight</strong> 命令查看设置颜色高亮的更多说明。<br>可以使用 <strong>:help :match</strong> 命令查看如何设置指定字符串的显示颜色组。<br>可以使用 <strong>:help :autocmd</strong> 命令查看如何针对特定类型文件自动执行指定命令。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'字符','vim','设置'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>