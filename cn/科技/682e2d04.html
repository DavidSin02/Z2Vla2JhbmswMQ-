<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ | æå®¢å¿«è¨Š</title><meta property="og:title" content="æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/153594655429837077dd27a"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/682e2d04.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/682e2d04.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/682e2d04.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/682e2d04.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/682e2d04.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/682e2d04.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/682e2d04.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/682e2d04.html><meta property="article:published_time" content="2020-11-14T21:03:08+08:00"><meta property="article:modified_time" content="2020-11-14T21:03:08+08:00"><meta name=Keywords content><meta name=description content="æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/682e2d04.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä»‹ç»äº†åˆ©ç”¨Pythonè¿›è¡Œå›¾åƒåˆ†æçš„åŸºæœ¬çŸ¥è¯†å’Œæ“ä½œï¼ˆã€Šæ•™ç¨‹ï¼šä½¿ç”¨Pythonè¿›è¡ŒåŸºæœ¬å›¾åƒæ•°æ®åˆ†æï¼ã€‹<strong>ç‚¹å‡»åŸæ–‡</strong>å³å¯é˜…è¯»ï¼Œæœ¬æ–‡æ˜¯ä¸Šç¯‡æ–‡ç« çš„å»¶ç»­ï¼Œå°†ç»§ç»­ä¸ºå¤§å®¶ä»‹ç»åŸºæœ¬å›¾åƒå¤„ç†æŠ€æœ¯ï¼Œæœ¬æ–‡ä½œè€…ä¸»è¦ä½¿ç”¨SciKit-Image - numpyæ‰§è¡Œå¤§å¤šæ•°æ“ä½œï¼Œè€Œä¸æ˜¯å¸¸ç”¨çš„OpenCVå·¥å…·ï¼Œå½“ç„¶ï¼Œå…¶ä¸­å¶å°”ä¹Ÿä¼šç©¿æ’ä½¿ç”¨å…¶ä»–åº“ã€‚</p><p><strong>å›¾ç‰‡äº®åº¦è½¬æ¢</strong></p><p>è®©æˆ‘ä»¬å…ˆä»å¯¼å…¥å›¾åƒå¼€å§‹ï¼š</p><pre>%matplotlib inlineimport imageioimport matplotlib.pyplot as pltimport warningsimport matplotlib.cbookwarnings.filterwarnings("ignore",category=matplotlib.cbook.mplDeprecation)pic = imageio.imread('img/parrot.jpg')plt.figure(figsize = (6,6))plt.imshow(pic);plt.axis('off');</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/153594655429837077dd27a><p class=pgc-img-caption></p></div><p><strong></strong></p><p><strong>å›¾ç‰‡è´Ÿå˜æ¢</strong></p><p>äº®åº¦å˜æ¢å‡½æ•°åœ¨æ•°å­¦ä¸Šå®šä¹‰ä¸ºï¼š</p><pre>s=T(r)</pre><p>å…¶ä¸­ræ˜¯å¯¼å…¥å›¾ç‰‡çš„åƒç´ ï¼Œsæ˜¯è¾“å‡ºå›¾ç‰‡çš„åƒç´ ã€‚Tæ˜¯ä¸€ä¸ªè½¬æ¢å‡½æ•°ï¼Œå®ƒå°†rçš„æ¯ä¸ªå€¼æ˜ å°„åˆ°sçš„æ¯ä¸ªå€¼ã€‚</p><p>è´Ÿå˜æ¢ï¼Œå³å˜æ¢é¢ å€’ã€‚åœ¨è´Ÿå˜æ¢ä¸­ï¼Œè¾“å…¥å›¾åƒçš„æ¯ä¸ªå€¼ä»L-1ä¸­å‡å»å¹¶æ˜ å°„åˆ°è¾“å‡ºå›¾åƒä¸Šã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨ä»¥ä¸‹å…¬å¼å®Œæˆè½¬æ¢ï¼š</p><pre>s=(Lâ€“1)â€“r</pre><p>å› æ­¤æ¯ä¸ªå€¼å‡å»255ï¼Œæœ€ç»ˆæ•ˆæœæ˜¯ï¼Œå›¾ç‰‡åŸæ¥è¾ƒäº®çš„éƒ¨åˆ†å˜æš—ï¼Œè¾ƒæš—çš„éƒ¨åˆ†å˜äº®ï¼Œè¿™å°±äº§ç”Ÿäº†è´Ÿå˜æ¢ã€‚</p><pre>negative = 255 - pic # neg = (L-1) - imgplt.figure(figsize = (6,6))plt.imshow(negative);plt.axis('off');</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535946555346ca39ccc90e><p class=pgc-img-caption></p></div><p><strong></strong></p><p><strong>æ—¥å¿—è½¬æ¢</strong></p><p>æ—¥å¿—è½¬æ¢å¯ä»¥ç”±ä»¥ä¸‹å…¬å¼å®šä¹‰ï¼š</p><p>s=câˆ—log(r+1)</p><p>å…¶ä¸­ï¼Œså’Œræ˜¯è¾“å‡ºå’Œè¾“å…¥å›¾ç‰‡çš„åƒç´ å€¼ï¼Œcæ˜¯å¸¸æ•°ã€‚å€¼1è¢«æ·»åŠ åˆ°è¾“å…¥å›¾ç‰‡çš„æ¯ä¸ªåƒç´ å€¼ï¼Œå¦‚æœå›¾ç‰‡ä¸­çš„åƒç´ å¼ºåº¦ä¸º0ï¼Œåˆ™logï¼ˆ0ï¼‰ç­‰äºæ— ç©·å¤§ï¼Œæ·»åŠ 1çš„ä½œç”¨æ˜¯ä½¿æœ€å°å€¼è‡³å°‘ä¸º1ã€‚</p><p>åœ¨å¯¹æ•°å˜æ¢æœŸé—´ï¼Œä¸è¾ƒé«˜åƒç´ å€¼ç›¸æ¯”ï¼Œå›¾åƒä¸­çš„æš—åƒç´ è¢«æ‰©å±•ã€‚è¾ƒé«˜çš„åƒç´ å€¼åœ¨æ—¥å¿—è½¬æ¢ä¸­è¢«å‹ç¼©ï¼Œå¯¹æ•°å˜æ¢ä¸­çš„cå€¼å¯è°ƒæ•´å¢å¼ºç±»å‹ã€‚</p><pre>%matplotlib inlineimport imageioimport numpy as npimport matplotlib.pyplot as pltpic = imageio.imread('img/parrot.jpg')gray = lambda rgb : np.dot(rgb[... , :3] , [0.299 , 0.587, 0.114])gray = gray(pic)'''log transform-&gt; s = c*log(1+r)So, we calculate constant c to estimate s-&gt; c = (L-1)/log(1+|I_max|)'''max_ = np.max(gray)def log_transform(): return (255/np.log(1+max_)) * np.log(1+gray)plt.figure(figsize = (5,5))plt.imshow(log_transform(), cmap = plt.get_cmap(name = 'gray'))plt.axis('off');</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15359465543073f817d95ba><p class=pgc-img-caption></p></div><p><strong></strong></p><p><strong>Gammaæ ¡æ­£</strong></p><p>Gammaæ ¡æ­£æ˜¯ç”¨äºå¯¹è§†é¢‘æˆ–é™æ­¢å›¾åƒç³»ç»Ÿä¸­çš„äº®åº¦æˆ–åˆºæ¿€å€¼è¿›è¡Œç¼–ç å’Œè§£ç çš„éçº¿æ€§æ“ä½œã€‚Gammaæ ¡æ­£ä¹Ÿç§°ä¸ºå¹‚å¾‹å˜æ¢ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬çš„å›¾ç‰‡åƒç´ å¼ºåº¦å¿…é¡»ä»0,255åˆ°0,1.0çš„èŒƒå›´ç¼©æ”¾ï¼Œé€šè¿‡åº”ç”¨ä»¥ä¸‹ç­‰å¼è·å¾—è¾“å‡ºçš„Gammaæ ¡æ­£å›¾åƒï¼š</p><pre>Vo=V1 ^(1/G)</pre><p>å…¶ä¸­Viæ˜¯è¾“å…¥å›¾åƒï¼ŒGæ˜¯gammaå€¼ï¼Œå°†è¾“å‡ºå›¾åƒVoç¼©æ”¾å›0-255èŒƒå›´ã€‚</p><p>gammaå€¼G&lt;1æœ‰æ—¶è¢«ç§°ä¸ºç¼–ç gammaï¼Œå¹¶ä¸”å‹ç¼©å¹‚å¾‹éçº¿æ€§ç¼–ç çš„è¿‡ç¨‹è¢«ç§°ä¸ºgammaå‹ç¼©; Gammaå€¼&lt;1ä¼šå°†å›¾åƒç§»å‘å…‰è°±çš„è¾ƒæš—ç«¯ã€‚</p><p>ç›¸åï¼Œä¼½é©¬å€¼G>1è¢«ç§°ä¸ºè§£ç gammaï¼Œå¹¶ä¸”è†¨èƒ€å¹‚å¾‹éçº¿æ€§åº”ç”¨çš„è¿‡ç¨‹è¢«ç§°ä¸ºgammaæ‰©å±•ã€‚Gammaå€¼>1å°†ä½¿å›¾åƒæ˜¾å¾—æ›´äº®ï¼Œgammaå€¼G=1å¯¹è¾“å…¥å›¾åƒæ²¡æœ‰å½±å“ï¼š</p><pre>import imageioimport matplotlib.pyplot as plt# Gamma encodingpic = imageio.imread('img/parrot.jpg')gamma = 2.2 # Gamma &lt; 1 ~ Dark ; Gamma &gt; 1 ~ Brightgamma_correction = ((pic/255) ** (1/gamma))plt.figure(figsize = (5,5))plt.imshow(gamma_correction)plt.axis('off');</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/15359465543707517644f35><p class=pgc-img-caption></p></div><p><strong></strong></p><p><strong>Gammaæ ¡æ­£çš„åŸå› </strong></p><p>åº”ç”¨Gammaæ ¡æ­£çš„åŸå› æ˜¯äººçš„çœ¼ç›æ‰€æ„ŸçŸ¥çš„é¢œè‰²å’Œäº®åº¦ä¸æ•°ç ç›¸æœºä¸­çš„ä¼ æ„Ÿå™¨ä¸åŒã€‚ è™½ç„¶ï¼Œæ•°ç ç›¸æœºåœ¨äº®åº¦ä¹‹é—´å…·æœ‰çº¿æ€§å…³ç³»ï¼Œä½†äººçœ¼æ˜¯éçº¿æ€§å…³ç³»ã€‚ä¸ºäº†è§£é‡Šè¿™ç§å…³ç³»ï¼Œæˆ‘ä»¬åº”ç”¨Gammaæ ¡æ­£ã€‚</p><p>è¿˜æœ‰ä¸€äº›å…¶ä»–çš„çº¿æ€§å˜æ¢å‡½æ•°ï¼Œæ¯”å¦‚ï¼š</p><ul><li>Contrast Stretching</li><li>Intensity-Level Slicing</li><li>Bit-Plane Slicing</li></ul><p><strong>å·ç§¯</strong></p><p>æˆ‘ä»¬åœ¨å‰ä¸€ç¯‡æ–‡ç« ä¸­ç®€è¦è®¨è®ºè¿‡ï¼Œè®¡ç®—æœºå¯¹å›¾åƒçš„å¤„ç†æœ€ç»ˆä¼šå‘ˆç°ä¸€ä¸ªåƒç´ å€¼æ•°ç»„ã€‚æ ¹æ®å›¾åƒçš„åˆ†è¾¨ç‡å’Œå¤§å°ï¼Œæ¯”å¦‚ä¼šå‡ºç°ä¸€ä¸ª32 x 32 x 3çš„æ•°ç»„ï¼Œå…¶ä¸­3è¡¨ç¤ºRGBå€¼æˆ–é€šé“ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªPNGæ ¼å¼çš„å½©è‰²å›¾åƒï¼Œå®ƒçš„å¤§å°æ˜¯480 x 480ï¼Œè¿™ä»£è¡¨çš„æ•°ç»„å°†æ˜¯480 * 480 * 3ï¼Œè¿™äº›æ•°å­—ä¸­çš„æ¯ä¸€ä¸ªéƒ½åœ¨0åˆ°255ä¹‹é—´ï¼Œæè¿°äº†è¯¥ç‚¹çš„åƒç´ å¼ºåº¦ã€‚</p><p>å‡è®¾æˆ‘ä»¬è¾“å…¥ä¸€ä¸ª32 * 32 * 3çš„åƒç´ å€¼æ•°ç»„ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•ç†è§£å·ç§¯çš„æ¦‚å¿µå‘¢ï¼Ÿä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡ä¸ºé—ªçƒåœ¨å›¾åƒå·¦ä¸Šæ–¹çš„æ‰‹ç”µç­’ï¼Œæ‰‹ç”µç­’ç…§å°„åŒºåŸŸä¸º3 x 3ï¼Œå‡è®¾è¯¥æ‰‹ç”µç­’æ»‘è¿‡è¾“å…¥å›¾åƒçš„æ‰€æœ‰åŒºåŸŸã€‚åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œè¿™ä¸ªæ‰‹ç”µç­’è¢«ç§°ä¸ºè¿‡æ»¤å™¨æˆ–å†…æ ¸ï¼Œå®ƒæ‰€ç…§å°„çš„åŒºåŸŸç§°ä¸º receptive field ã€‚</p><p>ç°åœ¨ï¼Œæ­¤è¿‡æ»¤å™¨ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­æ•°å­—ç§°ä¸ºæƒé‡æˆ–å‚æ•°ã€‚éœ€è¦æ³¨æ„ï¼Œæ»¤é•œçš„æ·±åº¦å¿…é¡»ä¸è¾“å…¥æ·±åº¦ç›¸åŒï¼Œå› æ­¤æ»¤é•œçš„å°ºå¯¸ä¸º3*3*3ã€‚</p><p>å›¾åƒå†…æ ¸æˆ–æ»¤é•œæ˜¯ä¸€ä¸ªå°çŸ©é˜µï¼Œç”¨äºåº”ç”¨å¯èƒ½åœ¨Photoshopæˆ–Gimpä¸­æ‰¾åˆ°çš„ä¸€äº›å˜æ¢ï¼Œä¾‹å¦‚æ¨¡ç³Šã€é”åŒ–æˆ–æµ®é›•ç­‰ï¼Œå®ƒä»¬ä¹Ÿç”¨äºæœºå™¨å­¦ä¹ çš„åŠŸèƒ½æå–ï¼Œè¿™æ˜¯ä¸€ç§ç”¨äºç¡®å®šå›¾åƒé‡è¦éƒ¨åˆ†çš„æŠ€æœ¯ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†è¿‡æ»¤å™¨æ”¾åœ¨å·¦ä¸Šè§’ã€‚å½“æ»¤æ³¢å™¨å›´ç»•è¾“å…¥å›¾åƒæ»‘åŠ¨æˆ–å·ç§¯æ—¶ï¼Œå®ƒå°†æ»¤æ³¢å™¨ä¸­çš„å€¼ä¹˜ä»¥å›¾åƒçš„åŸå§‹åƒç´ å€¼ï¼ˆä¹Ÿç§°ä¸ºè®¡ç®—å…ƒç´ ä¹˜æ³•ï¼‰ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯¹è¾“å…¥å·ä¸Šçš„æ¯ä¸ªä½ç½®é‡å¤æ­¤è¿‡ç¨‹ã€‚ä¸‹ä¸€æ­¥æ˜¯å°†è¿‡æ»¤å™¨å‘å³ç§»åŠ¨ä¸€ä¸ªæ­¥å¹…ï¼Œä¾æ­¤ç±»æ¨ã€‚è¾“å…¥å·ä¸Šçš„æ¯ä¸ªä½ç½®éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ•°å­—ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥é€‰æ‹©æ­¥å¹…ä¸º2ç”šè‡³æ›´å¤šï¼Œä½†æˆ‘ä»¬å¿…é¡»ä¿è¯è¯¥æ•°å€¼é€‚åˆè¾“å…¥å›¾åƒã€‚</p><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535946554310d41874567a><p class=pgc-img-caption></p></div><p>å½“æ»¤é•œæ»‘è¿‡æ‰€æœ‰ä½ç½®åï¼Œæˆ‘ä»¬ä¼šå‘ç°å‰©ä¸‹çš„æ˜¯ä¸€ä¸ª30x30x1çš„æ•°å­—æ•°ç»„ï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¸ºè¦ç´ å›¾ã€‚æˆ‘ä»¬å¾—åˆ°30x30é˜µåˆ—çš„åŸå› æ˜¯æœ‰300ä¸ªä¸åŒçš„ä½ç½®ï¼Œ3x3æ»¤é•œå¯ä»¥æ”¾åœ¨32x32è¾“å…¥å›¾åƒä¸Šã€‚è¿™900ä¸ªæ•°å­—æ˜ å°„åˆ°30x30é˜µåˆ—ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¡ç®—å·ç§¯å›¾åƒï¼š</p><pre>Convolved: (Nâˆ’F)/S + 1</pre><p>å…¶ä¸­ï¼ŒNå’ŒFåˆ†åˆ«ä»£è¡¨è¾“å…¥å›¾åƒå’Œå†…æ ¸å¤§å°ï¼ŒSä»£è¡¨æ­¥å¹…æˆ–æ­¥é•¿ã€‚</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª3x3æ»¤æ³¢å™¨ï¼Œåœ¨5x5çŸ©é˜µä¸Šè¿›è¡Œå·ç§¯ï¼Œæ ¹æ®ç­‰å¼ï¼Œæˆ‘ä»¬åº”è¯¥å¾—åˆ°ä¸€ä¸ª3x3çŸ©é˜µï¼ŒæŠ€æœ¯ä¸Šç§°ä¸ºæ¿€æ´»æ˜ å°„æˆ–ç‰¹å¾æ˜ å°„ã€‚</p><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1535946554311632db173f1><p class=pgc-img-caption></p></div><p>å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸æ­¢ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬çš„è¾“å‡ºé‡å°†æ˜¯28 * 28 * nï¼ˆå…¶ä¸­næ˜¯æ¿€æ´»å›¾çš„æ•°é‡ï¼‰ã€‚é€šè¿‡ä½¿ç”¨æ›´å¤šè¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ›´å¥½ä¿ç•™ç©ºé—´ç»´åº¦ã€‚</p><p>å¯¹äºå›¾åƒçŸ©é˜µè¾¹ç•Œä¸Šçš„åƒç´ ï¼Œå†…æ ¸çš„ä¸€äº›å…ƒç´ å¯èƒ½ç«™åœ¨å›¾åƒçŸ©é˜µä¹‹å¤–ï¼Œå› æ­¤ä¸å…·æœ‰æ¥è‡ªå›¾åƒçŸ©é˜µçš„ä»»ä½•å¯¹åº”å…ƒç´ ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ¶ˆé™¤è¿™äº›ä½ç½®çš„å·ç§¯è¿ç®—ï¼Œæœ€ç»ˆå‡ºç°å°äºè¾“å…¥çš„è¾“å‡ºçŸ©é˜µï¼Œæˆ–è€…æˆ‘ä»¬å¯ä»¥å°†å¡«å……åº”ç”¨äºè¾“å…¥çŸ©é˜µã€‚</p><p>æˆ‘ä»¬å¯ä»¥å°†è‡ªå®šä¹‰ç»Ÿä¸€çª—å£åº”ç”¨äºå›¾åƒï¼š</p><pre>%%timeimport numpy as npimport imageioimport matplotlib.pyplot as pltfrom scipy.signal import convolve2ddef Convolution(image, kernel): conv_bucket = [] for d in range(image.ndim): conv_channel = convolve2d(image[:,:,d], kernel, mode="same", boundary="symm") conv_bucket.append(conv_channel) return np.stack(conv_bucket, axis=2).astype("uint8")kernel_sizes = [9,15,30,60]fig, axs = plt.subplots(nrows = 1, ncols = len(kernel_sizes), figsize=(15,15));pic = imageio.imread('img:/parrot.jpg')for k, ax in zip(kernel_sizes, axs): kernel = np.ones((k,k)) kernel /= np.sum(kernel) ax.imshow(Convolution(pic, kernel)); ax.set_title("Convolved By Kernel: {}".format(k)); ax.set_axis_off();Wall time: 43.5 s</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15359465546062b8fdbc70d><p class=pgc-img-caption></p></div><p>è½®å»“å†…æ ¸ï¼ˆåˆåâ€œè¾¹ç¼˜â€å†…æ ¸ï¼‰ç”¨äºçªå‡ºæ˜¾ç¤ºåƒç´ å€¼ä¹‹é—´çš„å·®å¼‚ï¼Œäº®åº¦æ¥è¿‘çš„ç›¸é‚»åƒç´ æ—è¾¹çš„åƒç´ åœ¨æ–°å›¾åƒä¸­å°†æ˜¾ç¤ºä¸ºé»‘è‰²ï¼Œè€Œå·®å¼‚æ€§è¾ƒå¤§çš„ç›¸é‚»åƒç´ çš„æ—è¾¹åƒç´ å°†æ˜¾ç¤ºä¸ºç™½è‰²ã€‚</p><pre>%%timefrom skimage import colorfrom skimage import exposureimport numpy as npimport imageioimport matplotlib.pyplot as plt# import imagepic = imageio.imread('img/crazycat.jpeg')plt.figure(figsize = (5,5))plt.imshow(pic)plt.axis('off');Wall time: 34.9 ms</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1535946554684428bca3216><p class=pgc-img-caption></p></div><pre># Convert the image to grayscaleimg = color.rgb2gray(pic)# outline kernel - used for edge detectionkernel = np.array([[-1,-1,-1], [-1,8,-1], [-1,-1,-1]])# we use 'valid' which means we do not add zero padding to our imageedges = convolve2d(img, kernel, mode = 'valid')# Adjust the contrast of the filtered image by applying Histogram Equalizationedges_equalized = exposure.equalize_adapthist(edges/np.max(np.abs(edges)), clip_limit = 0.03)# plot the edges_clippedplt.figure(figsize = (5,5))plt.imshow(edges_equalized, cmap='gray') plt.axis('off');</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/15359465549101c06f7b8ac><p class=pgc-img-caption></p></div><p>è®©æˆ‘ä»¬ç”¨ä¸åŒç±»å‹çš„è¿‡æ»¤å™¨è¯•ä¸€ä¸‹ï¼Œæ¯”å¦‚Sharpen Kernelã€‚é”åŒ–å†…æ ¸å¼ºè°ƒç›¸é‚»åƒç´ å€¼çš„ä¹‹é—´å·®å¼‚ï¼Œè¿™ä¼šè®©å›¾åƒçœ‹èµ·æ¥æ›´ç”ŸåŠ¨ã€‚è®©æˆ‘ä»¬å°†è¾¹ç¼˜æ£€æµ‹å†…æ ¸åº”ç”¨äºé”åŒ–å†…æ ¸çš„è¾“å‡ºï¼Œå¹¶ä½¿ç”¨ box blur filterè¿›ä¸€æ­¥æ ‡å‡†åŒ–ã€‚</p><pre>%%timefrom skimage import colorfrom skimage import exposurefrom scipy.signal import convolve2dimport numpy as npimport imageioimport matplotlib.pyplot as plt# Convert the image to grayscaleimg = color.rgb2gray(pic) # apply sharpen filter to the original imagesharpen_kernel = np.array([[0,-1,0], [-1,5,-1], [0,-1,0]])image_sharpen = convolve2d(img, sharpen_kernel, mode = 'valid')# apply edge kernel to the output of the sharpen kerneledge_kernel = np.array([[-1,-1,-1], [-1,8,-1], [-1,-1,-1]])edges = convolve2d(image_sharpen, edge_kernel, mode = 'valid')# apply normalize box blur filter to the edge detection filtered imageblur_kernel = np.array([[1,1,1], [1,1,1], [1,1,1]])/9.0;denoised = convolve2d(edges, blur_kernel, mode = 'valid')# Adjust the contrast of the filtered image by applying Histogram Equalizationdenoised_equalized = exposure.equalize_adapthist(denoised/np.max(np.abs(denoised)), clip_limit=0.03)plt.figure(figsize = (5,5))plt.imshow(denoised_equalized, cmap='gray') plt.axis('off')plt.show()</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15359465549667d3513a7f0><p class=pgc-img-caption></p></div><p>ä¸ºäº†æ¨¡ç³Šå›¾åƒï¼Œå¯ä»¥ä½¿ç”¨å¤§é‡ä¸åŒçš„çª—å£å’ŒåŠŸèƒ½ã€‚ å…¶ä¸­æœ€å¸¸è§çš„æ˜¯Gaussian windowã€‚ä¸ºäº†è§£å®ƒå¯¹å›¾åƒçš„ä½œç”¨ï¼Œè®©æˆ‘ä»¬å°†æ­¤è¿‡æ»¤å™¨åº”ç”¨äºå›¾åƒã€‚</p><pre>%%timefrom skimage import colorfrom skimage import exposurefrom scipy.signal import convolve2dimport numpy as npimport imageioimport matplotlib.pyplot as plt# import imagepic = imageio.imread('img/parrot.jpg')# Convert the image to grayscaleimg = color.rgb2gray(pic)# gaussian kernel - used for blurringkernel = np.array([[1,2,1], [2,4,2], [1,2,1]])kernel = kernel / np.sum(kernel)# we use 'valid' which means we do not add zero padding to our imageedges = convolve2d(img, kernel, mode = 'valid')# Adjust the contrast of the filtered image by applying Histogram Equalizationedges_equalized = exposure.equalize_adapthist(edges/np.max(np.abs(edges)), clip_limit = 0.03)# plot the edges_clippedplt.figure(figsize = (5,5))plt.imshow(edges_equalized, cmap='gray') plt.axis('off')plt.show()</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1535946555256e32bbc8caa><p class=pgc-img-caption></p></div><p>é€šè¿‡ä½¿ç”¨æ›´å¤šçª—æˆ·ï¼Œå¯ä»¥æå–ä¸åŒç§ç±»çš„ä¿¡æ¯ã€‚ Sobel kernels ä»…ç”¨äºæ˜¾ç¤ºç‰¹å®šæ–¹å‘ä¸Šç›¸é‚»åƒç´ å€¼çš„å·®å¼‚ï¼Œå°è¯•ä½¿ç”¨å†…æ ¸å‡½æ•°æ²¿ä¸€ä¸ªæ–¹å‘è¿‘ä¼¼å›¾åƒçš„æ¢¯åº¦ã€‚</p><p>é€šè¿‡åœ¨Xå’ŒYæ–¹å‘ç§»åŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å›¾åƒä¸­æ¯ä¸ªé¢œè‰²çš„æ¢¯åº¦å›¾ã€‚</p><pre>%%timefrom skimage import colorfrom skimage import exposurefrom scipy.signal import convolve2dimport numpy as npimport imageioimport matplotlib.pyplot as plt# import imagepic = imageio.imread('img/parrot.jpg')# right sobelsobel_x = np.c_[ [-1,0,1], [-2,0,2], [-1,0,1]]# top sobelsobel_y = np.c_[ [1,2,1], [0,0,0], [-1,-2,-1]]ims = []for i in range(3): sx = convolve2d(pic[:,:,i], sobel_x, mode="same", boundary="symm") sy = convolve2d(pic[:,:,i], sobel_y, mode="same", boundary="symm") ims.append(np.sqrt(sx*sx + sy*sy))img_conv = np.stack(ims, axis=2).astype("uint8")plt.figure(figsize = (6,5))plt.axis('off')plt.imshow(img_conv);</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153594655539344efb4418b><p class=pgc-img-caption></p></div><p>è‡³äºé™å™ªï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ç±»ä¼¼Gaussian Filterçš„æ»¤æ³¢å™¨ï¼Œè¿™æ˜¯ä¸€ç§æ•°å­—æ»¤æ³¢æŠ€æœ¯ï¼Œé€šå¸¸ç”¨äºå›¾ç‰‡é™å™ªã€‚é€šè¿‡å°†Gaussian Filterå’Œgradient findingæ“ä½œç»“åˆåœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬å¯ä»¥ç”Ÿæˆä¸€äº›ç±»ä¼¼äºåŸå§‹å›¾åƒå¹¶ä»¥æœ‰è¶£æ–¹å¼æ‰­æ›²çš„å¥‡æ€ªå›¾æ¡ˆã€‚</p><pre>%%timefrom scipy.signal import convolve2dfrom scipy.ndimage import (median_filter, gaussian_filter)import numpy as npimport imageioimport matplotlib.pyplot as pltdef gaussain_filter_(img): """ Applies a median filer to all channels """ ims = [] for d in range(3): img_conv_d = gaussian_filter(img[:,:,d], sigma = 4) ims.append(img_conv_d) return np.stack(ims, axis=2).astype("uint8")filtered_img = gaussain_filter_(pic)# right sobelsobel_x = np.c_[ [-1,0,1], [-2,0,2], [-1,0,1]]# top sobelsobel_y = np.c_[ [1,2,1], [0,0,0], [-1,-2,-1]]ims = []for d in range(3): sx = convolve2d(filtered_img[:,:,d], sobel_x, mode="same", boundary="symm") sy = convolve2d(filtered_img[:,:,d], sobel_y, mode="same", boundary="symm") ims.append(np.sqrt(sx*sx + sy*sy))img_conv = np.stack(ims, axis=2).astype("uint8")plt.figure(figsize=(7,7))plt.axis('off')plt.imshow(img_conv);</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535946555598630edceecf><p class=pgc-img-caption></p></div><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ä½¿ç”¨Median filter å¯ä»¥å¯¹å›¾åƒäº§ç”Ÿä»€ä¹ˆæ•ˆæœã€‚</p><pre>%%timefrom scipy.signal import convolve2dfrom scipy.ndimage import (median_filter, gaussian_filter)import numpy as npimport imageioimport matplotlib.pyplot as pltdef median_filter_(img, mask): """ Applies a median filer to all channels """ ims = [] for d in range(3): img_conv_d = median_filter(img[:,:,d], size=(mask,mask)) ims.append(img_conv_d) return np.stack(ims, axis=2).astype("uint8")filtered_img = median_filter_(pic, 80)# right sobelsobel_x = np.c_[ [-1,0,1], [-2,0,2], [-1,0,1]]# top sobelsobel_y = np.c_[ [1,2,1], [0,0,0], [-1,-2,-1]]ims = []for d in range(3): sx = convolve2d(filtered_img[:,:,d], sobel_x, mode="same", boundary="symm") sy = convolve2d(filtered_img[:,:,d], sobel_y, mode="same", boundary="symm") ims.append(np.sqrt(sx*sx + sy*sy))img_conv = np.stack(ims, axis=2).astype("uint8")plt.figure(figsize=(7,7))plt.axis('off')plt.imshow(img_conv);</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535946555634890a53db73><p class=pgc-img-caption></p></div><p><strong></strong></p><p><strong>é˜ˆå€¼ä¹‹ Ostuæ–¹æ³•</strong></p><p>é˜ˆå€¼å¤„ç†æ˜¯å›¾åƒå¤„ç†ä¸­éå¸¸åŸºæœ¬çš„æ“ä½œï¼Œå°†ç°åº¦å›¾åƒè½¬æ¢ä¸ºå•è‰²æ˜¯å¸¸è§çš„å›¾åƒå¤„ç†ä»»åŠ¡ã€‚è€Œä¸”ï¼Œä¸€ä¸ªå¥½çš„ç®—æ³•æ€»æ˜¯ä»¥è‰¯å¥½çš„åŸºç¡€å¼€å§‹ï¼</p><p>Otsué˜ˆå€¼å¤„ç†æ˜¯ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„å…¨å±€è‡ªåŠ¨é˜ˆå€¼å¤„ç†æ–¹æ³•ï¼Œç”¨äºäºŒå€¼åŒ–ç°åº¦å›¾åƒï¼Œå¦‚å‰æ™¯å’ŒèƒŒæ™¯ã€‚åœ¨å›¾åƒå¤„ç†ä¸­ï¼ŒOtsuçš„é˜ˆå€¼å¤„ç†æ–¹æ³•ï¼ˆ1979ï¼‰åŸºäºç›´æ–¹å›¾çš„å½¢çŠ¶è‡ªåŠ¨äºŒå€¼åŒ–æ°´å¹³å†³å®šï¼Œå®Œå…¨åŸºäºå¯¹å›¾åƒç›´æ–¹å›¾æ‰§è¡Œçš„è®¡ç®—ã€‚</p><p>è¯¥ç®—æ³•å‡è®¾å›¾åƒç”±ä¸¤ä¸ªåŸºæœ¬ç±»ç»„æˆï¼šå‰æ™¯å’ŒèƒŒæ™¯ï¼Œè®¡ç®—æœ€å°é˜ˆå€¼å¹¶æœ€å°åŒ–ä¸¤ç±»çš„ç±»æ–¹å·®åŠ æƒã€‚</p><p><strong>ç®—æ³•</strong></p><p>å¦‚æœæˆ‘ä»¬åœ¨è¿™ä¸ªç®€å•çš„é€æ­¥ç®—æ³•ä¸­åŠ å…¥ä¸€ç‚¹æ•°å­¦ï¼Œé‚£ä¹ˆè¿™ç§è§£é‡Šå°±ä¼šå‘ç”Ÿå˜åŒ–ï¼š</p><p>è®¡ç®—æ¯ä¸ªå¼ºåº¦çº§åˆ«çš„ç›´æ–¹å›¾å’Œæ¦‚ç‡ã€‚</p><ul><li>è®¾ç½®åˆå§‹wiå’ŒÎ¼iã€‚</li><li>ä»é˜ˆå€¼t = 0åˆ°t = L-1ï¼š</li><li>oupdateï¼šwiå’ŒÎ¼i</li><li>ocomputeï¼šÏƒ_b** 2ï¼ˆtï¼‰</li><li>æ‰€éœ€é˜ˆå€¼å¯¹åº”äºÏƒ_b** 2ï¼ˆtï¼‰çš„æœ€å¤§å€¼ã€‚</li></ul><pre>import numpy as npimport imageioimport matplotlib.pyplot as pltpic = imageio.imread('img/potato.jpeg')plt.figure(figsize=(7,7))plt.axis('off')plt.imshow(pic);</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1535946555690f8c943c0b0><p class=pgc-img-caption></p></div><pre>def otsu_threshold(im): # Compute histogram and probabilities of each intensity level pixel_counts = [np.sum(im == i) for i in range(256)] # Initialization s_max = (0,0) for threshold in range(256): # update w_0 = sum(pixel_counts[:threshold]) w_1 = sum(pixel_counts[threshold:]) mu_0 = sum([i * pixel_counts[i] for i in range(0,threshold)]) / w_0 if w_0 &gt; 0 else 0  mu_1 = sum([i * pixel_counts[i] for i in range(threshold, 256)]) / w_1 if w_1 &gt; 0 else 0 # calculate - inter class variance s = w_0 * w_1 * (mu_0 - mu_1) ** 2 if s &gt; s_max[1]: s_max = (threshold, s) return s_max[0]</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535946555663fe1699a624><p class=pgc-img-caption></p></div><p>å¦‚æœå¯ä»¥å‡è®¾ç›´æ–¹å›¾å…·æœ‰åŒå³°åˆ†å¸ƒå¹¶ä¸”ä¸¤å³°ä¹‹é—´å…·æœ‰æ·±ä¸”å°–é”çš„è°·ï¼Œåˆ™Otsuçš„æ–¹æ³•ä¼šè¡¨ç°æ›´ä¼˜ã€‚å¦‚æœå‰æ™¯ä¸èƒŒæ™¯å·®å¼‚è¾ƒå°ï¼Œåˆ™ç›´æ–¹å›¾ä¸ä¼šå‘ˆç°åŒå³°æ€§ã€‚</p><p><strong>K-Meansèšç±»</strong></p><p>K-Meansèšç±»æ˜¯ä¸€ç§çŸ¢é‡é‡åŒ–æ–¹æ³•ï¼Œæœ€åˆæ¥è‡ªä¿¡å·å¤„ç†ï¼Œæ˜¯æ•°æ®æŒ–æ˜ä¸­èšç±»åˆ†æçš„å¸¸ç”¨æ–¹æ³•ã€‚</p><p>åœ¨Otsué˜ˆå€¼å¤„ç†ä¸­ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æœ€å°åŒ–æ®µå†…åƒç´ æ–¹å·®çš„é˜ˆå€¼ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬ä¸æ˜¯ä»ç°åº¦å›¾åƒä¸­å¯»æ‰¾é˜ˆå€¼ï¼Œè€Œæ˜¯åœ¨é¢œè‰²ç©ºé—´ä¸­å¯»æ‰¾èšç±»ï¼Œé€šè¿‡è¿™æ ·åšï¼Œæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°äº†K-meansèšç±»ã€‚</p><pre>from sklearn import clusterimport matplotlib.pyplot as plt# load imagepic = imageio.imread('img/purple.jpg')plt.figure(figsize=(7,7))plt.imshow(pic)plt.axis('off');</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1535946555877d3b4440736><p class=pgc-img-caption></p></div><p>ä¸ºäº†èšç±»å›¾åƒï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶è½¬æ¢ä¸ºäºŒç»´æ•°ç»„ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨scikit-learnæ–¹æ³•åˆ›å»ºé›†ç¾¤ï¼Œä¼ é€’n_clusters 5ä»¥å½¢æˆäº”ä¸ªé›†ç¾¤ã€‚èšç±»å‡ºç°åœ¨ç”Ÿæˆå›¾åƒä¸­ï¼Œå°†å…¶åˆ†ä¸ºäº”ä¸ªéƒ¨åˆ†ï¼Œæ¯éƒ¨åˆ†çš„é¢œè‰²ä¸åŒã€‚</p><pre>%%time# fit on the image with cluster fivekmeans_cluster = cluster.KMeans(n_clusters=5)kmeans_cluster.fit(pic_2d)cluster_centers = kmeans_cluster.cluster_centers_cluster_labels = kmeans_cluster.labels_</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1535946555907bfb072ebde><p class=pgc-img-caption></p></div><p>ä¸€æ—¦å½¢æˆäº†ç°‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ç°‡ä¸­å¿ƒå’Œæ ‡ç­¾é‡æ–°åˆ›å»ºå›¾åƒï¼Œä»¥æ˜¾ç¤ºå…·æœ‰åˆ†ç»„æ¨¡å¼çš„å›¾åƒã€‚</p><p><strong>ç›´çº¿æ£€æµ‹ä¹‹éœå¤«å˜æ¢</strong></p><p>å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿä»¥æ•°å­¦å½¢å¼è¡¨ç¤ºè¯¥å½¢çŠ¶ï¼Œåˆ™éœå¤«å˜æ¢æ˜¯ä¸€ç§ç”¨äºæ£€æµ‹ä»»ä½•å½¢çŠ¶çš„æµè¡ŒæŠ€æœ¯ã€‚å®ƒå¯ä»¥æ£€æµ‹å½¢çŠ¶ï¼Œå³ä½¿å®ƒè¢«ç ´åæˆ–æ‰­æ›²ä¸€ç‚¹ç‚¹ã€‚ æˆ‘ä»¬ä¸ä¼šè¿‡äºæ·±å…¥åˆ†æéœå¤«å˜æ¢çš„æœºåˆ¶ã€‚</p><p><strong>ç®—æ³•</strong></p><ul><li>Corneræˆ–è¾¹ç¼˜æ£€æµ‹</li><li>ÏèŒƒå›´å’ŒÎ¸èŒƒå›´åˆ›å»º</li><li>Ïï¼šDmaxè‡³Dmax</li><li>Î¸ï¼š90åˆ°90</li></ul><p><strong>éœå¤«å˜æ¢</strong></p><ul><li>2Dæ•°ç»„çš„è¡Œæ•°ç­‰äºÏå€¼çš„æ•°é‡ï¼Œåˆ—æ•°ç­‰äºÎ¸å€¼çš„æ•°é‡ã€‚</li><li>åœ¨ç´¯åŠ å™¨ä¸­æŠ•ç¥¨</li><li>å¯¹äºæ¯ä¸ªè¾¹ç¼˜ç‚¹å’ŒÎ¸å€¼ï¼Œæ‰¾åˆ°æœ€æ¥è¿‘çš„Ïå€¼å¹¶åœ¨ç´¯åŠ å™¨ä¸­é€’å¢è¯¥ç´¢å¼•ã€‚</li><li>ç´¯åŠ å™¨ä¸­çš„å±€éƒ¨æœ€å¤§å€¼æŒ‡ç¤ºè¾“å…¥å›¾åƒä¸­æœ€çªå‡ºçš„çº¿çš„å‚æ•°ã€‚</li></ul><pre>def hough_line(img): # Rho and Theta ranges thetas = np.deg2rad(np.arange(-90.0, 90.0)) width, height = img.shape diag_len = int(np.ceil(np.sqrt(width * width + height * height))) # Dmax rhos = np.linspace(-diag_len, diag_len, diag_len * 2.0) # Cache some resuable values cos_t = np.cos(thetas) sin_t = np.sin(thetas) num_thetas = len(thetas) # Hough accumulator array of theta vs rho accumulator = np.zeros((2 * diag_len, num_thetas), dtype=np.uint64) y_idxs, x_idxs = np.nonzero(img) # (row, col) indexes to edges # Vote in the hough accumulator for i in range(len(x_idxs)): x = x_idxs[i] y = y_idxs[i] for t_idx in range(num_thetas): # Calculate rho. diag_len is added for a positive index rho = round(x * cos_t[t_idx] + y * sin_t[t_idx]) + diag_len accumulator[rho, t_idx] += 1 return accumulator, thetas, rhos</pre><p><strong>è¾¹ç¼˜æ£€æµ‹</strong></p><p>è¾¹ç¼˜æ£€æµ‹æ˜¯ä¸€ç§ç”¨äºæŸ¥æ‰¾å›¾åƒå†…å¯¹è±¡è¾¹ç•Œçš„å›¾åƒå¤„ç†æŠ€æœ¯ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯æ£€æµ‹äº®åº¦çš„ä¸è¿ç»­æ€§ã€‚</p><p>å¸¸è§çš„è¾¹ç¼˜æ£€æµ‹ç®—æ³•åŒ…æ‹¬</p><ul><li>Sobel</li><li>Canny</li><li>Prewitt</li><li>Roberts</li><li>fuzzy logic methods</li></ul><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€ç§æœ€æµè¡Œçš„æ–¹æ³•ï¼Œå³Canny Edge Detectionï¼ˆCannyè¾¹ç¼˜æ£€æµ‹ï¼‰ã€‚</p><p><strong>Cannyè¾¹ç¼˜æ£€æµ‹</strong></p><p>ä¸€ç§èƒ½å¤Ÿæ£€æµ‹å›¾åƒä¸­è¾ƒå®½èŒƒå›´è¾¹ç¼˜çš„å¤šçº§è¾¹ç¼˜æ£€æµ‹æ“ä½œï¼ŒCannyè¾¹ç¼˜æ£€æµ‹ç®—æ³•å¯ä»¥åˆ†è§£ä¸º5æ­¥ï¼š</p><ul><li>åº”ç”¨é«˜æ–¯æ»¤æ³¢å™¨</li><li>æ‰¾å‡ºå¼ºåº¦æ¢¯åº¦</li><li>åº”ç”¨éæå¤§å€¼æŠ‘åˆ¶</li><li>åº”ç”¨åŒé˜ˆå€¼</li><li>é€šè¿‡æ»åæ€§é—¨é™è·Ÿè¸ªè¾¹ç¼˜çº¿</li></ul><p><strong>å›¾ç‰‡çŸ¢é‡ä¹‹è½®å»“è·Ÿè¸ª</strong></p><p>ä½¿ç”¨Scikit-Imageï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è½®å»“è·Ÿè¸ªç®—æ³•æå–å›¾ç‰‡è¾¹ç¼˜è·¯å¾„ï¼ˆå‹¾å‹’å›¾ç‰‡è½®å»“ï¼‰ï¼Œè¿™å¯ä»¥æ§åˆ¶æœ€ç»ˆè·¯å¾„éµå¾ªåŸå§‹ä½å›¾çš„å½¢çŠ¶ã€‚</p><pre>from sklearn.cluster import KMeansimport matplotlib.pyplot as pltfrom skimage import measureimport numpy as npimport imageiopic = imageio.imread('img/parrot.jpg')h,w = pic.shape[:2]im_small_long = pic.reshape((h * w, 3))im_small_wide = im_small_long.reshape((h,w,3))km = KMeans(n_clusters=2)km.fit(im_small_long)seg = np.asarray([(1 if i == 1 else 0) for i in km.labels_]).reshape((h,w))contours = measure.find_contours(seg, 0.5, fully_connected="high")simplified_contours = [measure.approximate_polygon(c, tolerance=5) for c in contours]plt.figure(figsize=(5,10))for n, contour in enumerate(simplified_contours): plt.plot(contour[:, 1], contour[:, 0], linewidth=2)plt.ylim(h,0)plt.axes().set_aspect('equal')</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535946555902191f40f236><p class=pgc-img-caption></p></div><p><strong></strong></p><p><strong>å›¾åƒå‹ç¼©ä¹‹å †å è‡ªç¼–ç å™¨</strong></p><p>Autoencoderæ˜¯ä¸€ç§æ•°æ®å‹ç¼©ç®—æ³•ï¼Œå…¶ä¸­å‹ç¼©å’Œè§£å‹ç¼©åŠŸèƒ½æ˜¯ï¼š</p><ul><li>Data-specific</li><li>Lossy</li></ul><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/153594655594997e8391a8c><p class=pgc-img-caption></p></div><p>ä»¥ä¸‹ä¸ºå…·ä½“å®ç°ä»£ç ï¼š</p><pre>import numpy as npimport matplotlib.pyplot as pltimport tensorflow as tffrom tensorflow.examples.tutorials.mnist import input_datamnist = input_data.read_data_sets("MNIST_data",one_hot=True)# Parameternum_inputs = 784 # 28*28neurons_hid1 = 392neurons_hid2 = 196neurons_hid3 = neurons_hid1 # Decoder Beginsnum_outputs = num_inputslearning_rate = 0.01# activation functionactf = tf.nn.relu# place holderX = tf.placeholder(tf.float32, shape=[None, num_inputs])# Weightsinitializer = tf.variance_scaling_initializer()w1 = tf.Variable(initializer([num_inputs, neurons_hid1]), dtype=tf.float32)w2 = tf.Variable(initializer([neurons_hid1, neurons_hid2]), dtype=tf.float32)w3 = tf.Variable(initializer([neurons_hid2, neurons_hid3]), dtype=tf.float32)w4 = tf.Variable(initializer([neurons_hid3, num_outputs]), dtype=tf.float32)# Biasesb1 = tf.Variable(tf.zeros(neurons_hid1))b2 = tf.Variable(tf.zeros(neurons_hid2))b3 = tf.Variable(tf.zeros(neurons_hid3))b4 = tf.Variable(tf.zeros(num_outputs))# Activation Function and Layersact_func = tf.nn.reluhid_layer1 = act_func(tf.matmul(X, w1) + b1)hid_layer2 = act_func(tf.matmul(hid_layer1, w2) + b2)hid_layer3 = act_func(tf.matmul(hid_layer2, w3) + b3)output_layer = tf.matmul(hid_layer3, w4) + b4# Loss Functionloss = tf.reduce_mean(tf.square(output_layer - X))# Optimizeroptimizer = tf.train.AdamOptimizer(learning_rate)train = optimizer.minimize(loss)# Intialize Variablesinit = tf.global_variables_initializer()saver = tf.train.Saver()num_epochs = 5batch_size = 150with tf.Session() as sess: sess.run(init) # Epoch == Entire Training Set for epoch in range(num_epochs): num_batches = mnist.train.num_examples // batch_size # 150 batch size for iteration in range(num_batches): X_batch, y_batch = mnist.train.next_batch(batch_size) sess.run(train, feed_dict={X: X_batch}) training_loss = loss.eval(feed_dict={X: X_batch})  print("Epoch {} Complete. Training Loss: {}".format(epoch,training_loss)) saver.save(sess, "./stacked_autoencoder.ckpt") # Test Autoencoder output on Test Datanum_test_images = 10with tf.Session() as sess: saver.restore(sess,"./stacked_autoencoder.ckpt") results = output_layer.eval(feed_dict={X:mnist.test.images[:num_test_images]})Extracting MNIST_data\train-images-idx3-ubyte.gzExtracting MNIST_data\train-labels-idx1-ubyte.gzExtracting MNIST_data\t10k-images-idx3-ubyte.gzExtracting MNIST_data\t10k-labels-idx1-ubyte.gzEpoch 0 Complete. Training Loss: 0.023349963128566742Epoch 1 Complete. Training Loss: 0.022537199780344963Epoch 2 Complete. Training Loss: 0.0200303066521883Epoch 3 Complete. Training Loss: 0.021327141672372818Epoch 4 Complete. Training Loss: 0.019387174397706985INFO:tensorflow:Restoring parameters from ./stacked_autoencoder.ckpt</pre><div class=pgc-img><img alt=æŠ€æœ¯å®è·µâ€”â€”Pythonå›¾åƒå¤„ç†è¿›é˜¶ï¼šå¤šç§å›¾åƒå˜æ¢ç®—æ³•å®è·µï¼ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535946556183f12f15e9d4><p class=pgc-img-caption></p></div><p>ç¬¬ä¸€è¡ŒåŠ è½½MNISTè®­ç»ƒé›†ï¼Œç¬¬äºŒè¡Œä½¿ç”¨è‡ªç¼–ç å™¨è¿›è¡Œç¼–ç å’Œè§£ç ï¼Œä¹‹åé‡æ„è®­ç»ƒé›†ã€‚ä½†æ˜¯ï¼Œé‡å»ºå›¾åƒä¸­ç¼ºå°‘å¤§é‡ä¿¡æ¯ã€‚å› æ­¤ï¼Œè‡ªç¼–ç å™¨ä¸å¦‚å…¶ä»–å‹ç¼©æŠ€æœ¯å¥½ï¼Œä½†ä½œä¸ºä¸€é—¨æ­£åœ¨å¿«é€Ÿå¢é•¿ä¸­çš„æŠ€æœ¯ï¼Œå…¶æœªæ¥è¿˜ä¼šå‡ºç°å¾ˆå¤šè¿›æ­¥ã€‚</p><p>ï¼ˆä»£ç ä¸‹è½½å¯è®¿é—®Githubåœ°å€ï¼šhttps://github.com/iphton/Image-Processing-in-Pythonï¼‰</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'å®è·µ','å›¾åƒ','æŠ€æœ¯'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>