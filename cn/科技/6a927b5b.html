<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>基于双向匹配的陌生人社交业务、策略及算法思考 | 极客快訊</title><meta property="og:title" content="基于双向匹配的陌生人社交业务、策略及算法思考 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/c645f4aff499460db9e5a70e8bd704ed"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6a927b5b.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6a927b5b.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/6a927b5b.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6a927b5b.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6a927b5b.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/6a927b5b.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/6a927b5b.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6a927b5b.html><meta property="article:published_time" content="2020-10-29T21:11:27+08:00"><meta property="article:modified_time" content="2020-10-29T21:11:27+08:00"><meta name=Keywords content><meta name=description content="基于双向匹配的陌生人社交业务、策略及算法思考"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/6a927b5b.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>基于双向匹配的陌生人社交业务、策略及算法思考</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>作为连接人的工具，社交产品的价值不言而喻；熟人社交领域，微信已占据绝对霸主地位，但是在陌生人社交领域还未出现类似绝对地位的产品，今天就以探探和Tinder为例，跟大家聊聊陌生人社交。本文主要通过对业务策略的分析，引入一些数据、算法、架构体系设计的思考，希望可以让大家在做算法和数据过程中了解到对业务洞察的必要性。</p><p>我们常用的资讯、短视频、电商、音乐等，属于典型的以单向匹配及满意度为终结的产品，比如电商产品中的用户->商品、短视频产品中的用户->短视频等；而陌生人社交则是以双向匹配满意度为终结的产品。最大的不一样就是满意度体现在单向还是双向匹配的完成度上，正因为这种不一样，建模就异常复杂。所以，通过本文的梳理过程可以为我们带来非常大的启发 ( 其实招聘、打车、外卖等都存在一定的双向匹配问题，有感兴趣的小伙伴欢迎在文末留言探讨交流 )。接下来，我们将开启今天的探索之旅：</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c645f4aff499460db9e5a70e8bd704ed><p class=pgc-img-caption></p></div><p>图1 在线交友约会双向匹配图</p><p>交友匹配/推荐在广义上，也是撮合交易的一种，在平台产品上的展现形态，也以推荐、排序、匹配聊天为主。但交友匹配有极其独特的特点，那就是人是无库存的唯一品和非标准品。唯一指的是每个人几乎各不相同，长相、性格、职业等等，完全不同于商城的商品推荐。非标是指，需求方对另一方是有要求的，而且在不同人、时间也不同，是非标准品；所以在非标、唯一的情况下，我们需要考虑当下单向交互、中期双向匹配、长期群体成功率。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ff6f629e42aa4e56bdd4eea27a648803><p class=pgc-img-caption></p></div><p>图2 交友领域的匹配问题要素解构</p><p><strong>01</strong></p><p><strong>陌生人社交背景</strong></p><p>首先我们大致介绍下以Tinder为代表的陌生人社交的业务和产品形态，然后再分享其中一些比较有趣的问题，最后我们看看有哪些东西是可以数据化和算法介入的。</p><p>Tinder是基于LBS的陌生社交产品，当你打开它，手机屏幕上就会呈现出一张异性的照片，喜欢就向右滑动，给一个yes，不喜欢就向左滑动，给出一个no，如下图。如果恰巧对方也喜欢你 ( 互相都右滑了 )，那么你们就匹配成功，接下来可以聊天、交流、满意的话，你们就可以约会了。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6157cb4c73d2430bb8cb1f0682a4e6d6><p class=pgc-img-caption></p></div><p>图3 Tinder产品使用界面 ( 喜欢右滑，不喜欢左滑 )</p><p>Tinder的母公司Match Group作为交友领域的鼻祖，在婚恋社交领域产品矩阵非常庞大，发展迅速，并且有很好的盈利，旗下产品和近年来的收入及盈利可参考下图 ( 来自其财报 )，其中Tinder更是众多APP中发展最迅猛的，Tinder也是全球除了游戏以外，IAP ( In-App Purchase ) 付费最高的产品。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fd5f28b294974fe0bdb2036cf17d16a2><p class=pgc-img-caption></p></div><p>图4 Match Group系列产品</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/cd15568605b64f6e9420b989cee7773a><p class=pgc-img-caption></p></div><p>图5 Match Group15-19年收入和利润</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a490be6c8f1240b88d34aa9f107499f4><p class=pgc-img-caption></p></div><p>图6 Tinder的排位</p><p>再介绍一下Tinder上的用户的大致分布，主流的群体为90后和00后，学生和初入职场的单身白领居多，男女比例接近 ( 在国内，男女比7:3或8:2 )。</p><h1 class=pgc-h-arrow-right><strong>02</strong></h1><h1 class=pgc-h-arrow-right><strong>陌生人社交的特点及思考</strong></h1><p>在陌生人社交领域有哪些不同的特点呢，我们逐一来看看：</p><h2 class=pgc-h-arrow-right><strong>1. 用户定位及标签明显</strong></h2><p>Tinder等陌生人社交产品的用户定位及标签明显，用户大多数情况会在单身、无聊、xxx等情况下安装使用软件。这是常态：在需要时下载安装，用了几天或几个小时就卸载，当再有需求时又重新安装使用。在熟人社交平台中用户往往会展现自己正向的那一面，极力保持个人良好的形象，而由于陌生人社交平台有着鲜明的标签特色 ( 比如Tinder、探探、陌陌都逃不过YP的标签 )，用户的诉求往往会有较大的差异，并且隐私要求更高 ( 不希望过多暴露真实信息 )；在陌生人社交平台中很多用户都会突破原有禁锢，以新的形象/不同于生活中的另一面，展现和认识一些人。</p><h2 class=pgc-h-arrow-right><strong>2. 双向匹配及转化链路长</strong></h2><p>上面也说过，大多数交友类APP最终的用户体验诉求是匹配成功 ( 即用户开始聊天、交流、约会、成为男女朋友等 )，这个跟大部分互联产品不一样的地方是非单向网络，双向网络存在双向匹配问题，单向满意效用低。双向匹配网络中，如果有用户发现了很多心仪的对象，右滑表示喜欢以后，如果不能有一定比例的回音，用户可能很快流失，这也说明单单从一方来决定最终的展现是有问题的，而这些产品往往非常依赖于智能匹配技术，这就给推荐系统提出了新的挑战。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/90f456422b094b5c9666f28faf780ba7><p class=pgc-img-caption></p></div><p>图7 典型的双向匹配</p><p>在双向匹配问题中，从展示到喜欢，再到被喜欢方交互和回应，这里面的转化链非常长，而且存在用户是否在线的问题；就算最终匹配成功后，用户可以进行聊天和约会，我们还需要评估聊天的成功率；这里面可能存在有很长的时间反馈延迟，用户的体验和收益需要被喜欢人反馈后才能真正体现。所以，链路长也带来了成功率的下降。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/42aee5da5b0648c38f947e3322286c6a><p class=pgc-img-caption></p></div><p>图8 Tinder类产品交友匹配链路</p><p>虽然很复杂，很困难，但是在社交领域先行者的探索中，也证明了数据与算法预估建模是可以真实地带来匹配及回复聊天率的上升，通过数据我们可以看到下图的相关性 ( 来自于OkCupid Blog )，在建模匹配率高的真实情况下也是更高的。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9028a5e6bc9e433eb343691296cbf66f><p class=pgc-img-caption></p></div><p>图9 建模匹配率和回复率的关系</p><h2 class=pgc-h-arrow-right><strong>3. 网络效应和流动性</strong></h2><p>互联网的本质就是一张信息网络，互联网产品普遍具有网络效应，而社交类产品则更加依赖于网络效应，边际成本下降明显，边际收益上升明显。那某个社交产品如何评估网络效应的强弱，或者说达到多少才是合适的呢。前两天跟一个朋友交流陌生人社交，他们有一个观点就是在可互动 ( 比如基于LBS的产品，可互动指的是距离不能大于某个值 ) 的用户每日用户数需要达到2000以上，7日留存在40%以上，这个产品是初具网络效应的，值得投入持续拉新最大的 ( 当然上述2000和40%会被具体产品的用户活跃情况、性别比例、产品特性决定 )。比如可以分析每个区块 ( 比如同城 ) 中人数对整体活跃度的影响，最终可以画出如下的图表，随着用户增长，拐点会出现 ( 拐点可能就是magic number )，规模临界点前后的差异巨大。当然下图需要在用户体量增加时做好匹配，不然用户量的上升可以使体验下降，继而带来留存的下降。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/61d7b9612cad42078fadfd05582f4b31><p class=pgc-img-caption></p></div><p>图10 上线用户数与留存的关系</p><p>因为交友类产品存在地理位置的限制，如果某个地区匮乏的话，无法解决这个地区足够数量的潜在匹配问题，一个用户在若干次交互后再无新的用户可交互。这种情况下，无论用户体验多么有趣或参与度很高，这个地区的用户就容易流失，网络效应需要分地区。所以初期基于地域的属性可以集中力量做片区发展，在某个或某几个地区走通并验证，则可以逐个地区铺开。</p><p>陌生人社交就像我前面介绍的，用户可能会有反复下载和卸载的过程，并且不像熟人社交，用户天然具有流动性。这是业务天然的优点和缺点，缺点是说今天用户就不会像使用微信一下长期高频使用，比如找到女朋友了。优点是每天有新的供给和需求在轮替。有足够多的流动性，可以带来新鲜感，才能产生更多的匹配与聊天。</p><p>由于流动性和网络效应在双向匹配中的影响，必然存在单边失衡的情况，这时候出现了需求多供给少的情况，需要做好流量的平衡，动态维持一个比例，比如当性别失衡时 ( 突然大量涌入一波男性用户 )，需要保证核心的用户的体验。活跃、留存高的用户不一定是你的核心用户，活跃、留存高、付费、且被别人喜欢的用户才是你的核心用户 ( 付费、或者被其他人消费 )。核心要素是找到一个生态系统良性运转的本质，有流入有流出，动态平衡。这中间就是长期与短期目标的确定，长期需要考虑生态性问题，短期一般是可度量可迭代的。很多社交产品一开始做得很好，却因为没有很好的一套生态体系，逐渐走向末路。很多用户的个性优势、兴趣需求互相不匹配，甚至感觉到干扰。只有当用户自然流失等于或小于平台自然流入，产品运营团队才可以把更多精力放在服务用户身上，而非拉新促活。</p><h2 class=pgc-h-arrow-right><strong>4. 哪方才是驱动力</strong></h2><p>Tinder的男女比例接近 ( 国内2款头部陌生人社交产品男女比大概为8:2、7:3 )，那到底是男性还是女性才是社交类产品的驱动力呢？哪方的存在可以更多地拉升产品整体的体验，或者哪方对产品影响更大。目前几款产品都是认为女性更重要，至少在冷启动阶段体现的特别明显，两方市场率先都引入了女性作为种子用户，因为在当下从社会男女比例以及性别心理差异化方面看，男性更容易被异性吸引，且引流成本更低。虽然是双向匹配，但是还是存在供给与需求的差异，冷启动阶段女生的角色更偏向于供给的角色。比如从国内较大的陌生人社交产品了解到的数据，用户看了每100张照片，女生会选择6%喜欢 ( 右滑 )，男生会选择60%喜欢 ( 右滑 )，和现实中选择态度很相似，男生对于陌生匹配的反感程度更低，耐受度更高，男生天然更开放，只要这里异性多，对男生而言就是最好的服务了。维持这种生态系统运作的基本机制，通常是对女性提供更加开放友好的环境，吸引她们入驻，再以此辐射男性群体。这中间需要以女性视角关注产品 ( 男生希望快速触达，女生希望更有安全感 )，所以相互匹配才能交流，从这个角度来看是一个偏向于女性的功能。</p><p>从另一个视角来看这个问题，在匹配效率达到一定值以后，核心用户会被服务好，并且有不错的留存。这时候用户体量的外扩是两方持续博弈的过程。在新用户进入或老用户流失过程中，永远是非平衡态，一方的快速增长，需要快速推动另一方的新用户进入。如果更深入地从匹配角度来看，假设产品的匹配效率和推荐没问题，在现有用户群体下，理想情况下互相满意的匹配完成后，剩余了一群人，这群人的性别比例才是根本。因为不是两方数量达到一定比例就可以了，还需要考虑质量，如果男性需求过剩，需要新的女生进入产生供给，这部分女生不是引入对应的数量就可以了，而是要满足上述过剩男生需求的女生，才能使得生态达到平衡。</p><p>当然最终哪个群体才是某个阶段的核心驱动力呢？其实就是看供需关系、看贡献，供小于需的那部分群体就是需要重要考虑和保护的，差体验用户 ( 卖货、不法交易 ) 需要被限制，这部分人的存在和留存高反而会严重拉低其它用户体验和留存；不同用户价值不同，留存的高低对系统影响也就应该区别对待。</p><h2 class=pgc-h-arrow-right><strong>5. 资源独占/头部效应&有限供给</strong></h2><p>在电商、内容等领域，一个商品、短视频可以海量地分发给各个用户，但是在社交特别是交友领域，这肯定是不行的，道德问题和双向匹配满意度问题都限制了分发的有限性。每个用户作为供给，只能完成一定次数的被匹配 ( 而且这个次数一般不会大 )，同一人能与多人匹配并聊天，但是一般只能与一人成为男女朋友谈恋爱。如果不考虑道德问题，用户的交际带宽也是有限的，无法做到人人有反馈 ( 例如在探探中发现有个女生在几天之内被喜欢了30w次 )。优质用户也只能提供有限的供给，这和书籍或者商品很不一样，并不是只要有库存就可以同时推荐给很多用户。美女帅哥在平台上从来不缺被喜欢，很容易成为产品的头部用户，他们也可以为产品吸引更多的用户进来；如果我们过度推荐这些用户可能会让这些用户收到到上万个喜欢的轰炸，但他们无法提供高的反馈率，比如下图中的头部用户拿到了几倍于普通用户的喜欢，但是回复率和匹配率却是颜值一般的人的五分之一水平 ( 来自于OkCupid Blog )。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/71461f0b39ab497fb443f59b59f502b6><p class=pgc-img-caption></p></div><p>图11 颜值与收信数的关系，回复率与颜值的关系</p><p>头部效应不受控的话，海量匹配会被沉没，带来了双向匹配成功率的快速下降，而且占用了大量的曝光机会。不能大部分人没人喜欢，没有曝光，需要平衡。所以这里面就要求在流量分发的过程中做流控，但是如何在这有限次展现中获得优质匹配是个大学问。既要尽量为这个用户匹配到合适的用户，但是又不能海量地将其展现给各类用户，就算Ta可能被大部分喜欢。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1b5638d426bd42b1ada4dbff673f0db6><p class=pgc-img-caption></p></div><p>图12 匹配相关的流量宏观调控系统</p><p>举个例子，今天有2个候选人分别为A和B，现在有个用户C使用产品，他对A和B均比较满意，但是A跟C的匹配度更高，这时候给C首先展现A好像比较自然。但是如果现在用户D进来了，他对A比较满意，对B不满意，这时候是不是在C来的时候，为其展现B更合适，因为后面D来可以匹配A，这样匹配度为100%，不然的话就是50%。上述问题中，有效供给、时间先后效应，全局最优匹配度问题均暴露了出来。好的很容易被匹配，不要过早匹配，而是留给另一个还不错且更苛刻的用户？那前提是你知道ta是好的，并且为了还有匹配机会，你才会在初期匹配度较高的情况下，不对ta进行匹配。比如头部的用户往往是相对优质的用户，但是他们也是单点，存在有限供给问题。推荐系统中存在趋热问题，召回打压，排序如何打压，最终控制减少头部效应。比如引入每个用户的受欢迎程度指标 ( 可以通过仿真系统模拟其未来的被喜欢数和匹配概率等 )，可以为匹配时是否进行平缓限流有影响。因为有限供给，如果在达到限流条件后，其被匹配方若无回应或回应负向，则可以再次释放这个用户进入新的匹配。有限供给下的问题，是全局优化问题，但是看看能否拆解到局部优化，每次匹配尽量实时，这个比较重要，如果能拆，那就好办非常多了。你有一盘不错的货，上午来了很多人，询价了问你卖不卖，卖了感觉下午还有人过来，不卖下午可能匹配不好，大概这个意思。对用户分层，并构建流量配比实验。这中间如何分层，从被喜欢最多的群体里面反推他们喜欢的人，如果这群人没有再往外推，那么自成一个群体；剩余人群继续这个操作。</p><h2 class=pgc-h-arrow-right><strong>6. 新人</strong></h2><p>契合上面提到的流动性问题，在池子中存在流出情况，并且被需求方用户消费过的用户无法做二次展现 ( 不能给一个人反复看他之前看过的 )，这时候新用户的快速引入就非常有必要。由于匹配概率的准确率依赖于数据，所以如何让新人在只有静态信息时 ( 地区、设备、年龄、职业等 )，快速定位其喜欢和被喜欢的人群，这中间对新用户进行聚类是一个很重要的点；通过静态信息初步匹配后，在后续的左右滑过程中 ( 平衡好Exploit & Explore )，尽量多样的积累用户信息非常重要。这里需要兼顾精准与多样，利用用户实时的正反馈 ( 比如右滑 ) 来快速修正其初期的群体偏好，当然这中间存在匹配不精准，流量的浪费情况。</p><p>初期新用户对匹配或对高颜值的期待，会非常有别于老用户，比如往往初次体验对颜值期待更高，当然通过数据分析，我们发现颜值也是测试偏好和拉新的手段。但长期来说，匹配聊天成功率是普遍的终极需求。新用户的首次匹配成功，开启聊天的时间间隔，会对长期留存产生较大的影响。</p><h2 class=pgc-h-arrow-right><strong>7. 心理学效应</strong></h2><p><strong>序列效应：</strong>这个效应与幼鹅效应/锚定效应类似。用户在浏览产品内的其他用户时，对其中某个用户的喜欢或不喜欢往往会受前面女生的影响。举个例子，比如用户看到的其他用户的颜值顺序是一般、一般、一般、一般和美、美、美、一般，两个序列中第四个人为同一人，有可能在第一个序列中用户4会被喜欢，在第二个序列中用户4可能不会被喜欢。推荐的整体序列问题，给一群难看的加一个一般的，和一群不好看的加一个好看的。比如在流量分发过程中通过list-wise方式的强化学习建模，目标提升累计的长期收益。</p><p><strong>争议效应：</strong>有人喜欢有人讨厌出现分歧的情况越多，更容易有匹配和交流。比如Okcupid做了大量分析，分析结果如下图 ( 来自于OkCupid Blog )，左边的用户整体评分比右边的接近些，但是右边的高分与低分的较多，属于争议型用户，而往往争议型用户收到的右滑比前者更多。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/73ab3158c0b6467e9ac25ded4f10161e><p class=pgc-img-caption></p></div><p>图13 评分有分歧的用户收到更多的信息</p><p><strong>可得性对时效性敏感：</strong>前面也介绍了本身陌生人社交类产品具有较强的用户诉求，比如可得性和时效性是较强的影响，往往初期是蓝色的线，我们希望往橙色的线靠近，希望可以在短时间内达成更多的匹配，如果同时去看留存情况的话，橙色线的留存好了很多。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e04d6b60fea24cf5b2619fdb81ac279b><p class=pgc-img-caption></p></div><p>图14 颜值与收信数的关系，回复率与颜值的关系</p><p><strong>性别区分大：</strong>对于男性，主要通过照片颜值来判断；对于女性，则考虑背景、学历、地位等各种因素。如下图，首先评分上女性更正太的分布，并且三分之二的男性将喜欢给了最漂亮的三分之一；而评分上男性则大部分集中在低分 ( 可能男生不会拍照吧 )，收到喜欢率相对颜值稍微有左移一些 ( 来自于OkCupid Blog )。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/557f5eb6c0d74a6fa670101256693412><p class=pgc-img-caption></p></div><p>图15 男性与女性新引力分布&收信数分布</p><p><strong>年龄集中/年轻人的游戏：</strong>在OkCupid的数据来看 ( 下左图 )，陌生人社交的人群集中在24岁附近，30岁后急剧下降，最后逐渐减少，因为其余的单身人士要么找到伴侣，要么退出了竞争。当然这中间男女吸引力的下降也有区别，比如女性吸引力的峰值出现在31岁，男性则出现在36岁。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fbf040a0d9514c51b0ccebeb57e35d2a><p class=pgc-img-caption></p></div><p>图16 平台不同年龄的分布&平台不同年龄可匹配人数分布</p><p><strong>性别和年龄对于异性年龄的接受度差异大：</strong>男性往往随着年龄的增长可以接受越大的年龄下限，而上限基本维持；女性则基本维持这个上下限，见下图 ( 来自于OkCupid Blog )。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b6563463a25e480cac5947e075c3f296><p class=pgc-img-caption></p></div><p>图17 男性与女性随年龄增长可接受对方的年龄上下限</p><p>上面举了几个例子，由于各种心理学效应的存在，往往需要通过复杂建模 ( 比如序列模型 )，并结合部分规则干预的手段来做匹配校准。</p><h2 class=pgc-h-arrow-right><strong>8. 风控</strong></h2><p>社交类产品，第一肩负着较大的"舆论与监管的压力"，第二劣质流量将破坏氛围，所以建立一套风控体系既可以降低产品监管下架风险，也可以提升体验，并且降噪 ( 劣质用户行为数据基本无价值 )。</p><p>一个好用户好不容易在平台上匹配到了一个其他用户，结果这个用户上来就卖货，这样的经历基本可能就让用户卸载了APP。除了上述这种情况，还有些用户使用网红甚至明星的非本人照片来做头像，有些用户不是来交友的，他们用非本人信息匹配完成后，开始骚扰用户，类似恶意用户无非就是各类拖、卖货、色情等。我们可利用图像技术识别用户的信息真伪性 ( 比如头像是否被其他人使用，如果是明星存在被其它使用的可能 )；也可以利用NLP技术识别用户聊天阶段是否出现违禁词、是否存在兜售商品或者骚扰性词汇等。</p><p>当然这里面推荐也可以发挥价值，对于风险高但不明确的用户分发过程中不做海量分发，虽然可能短时间内有较好的颜值和被喜欢率，并且反馈及时；也可以开通用户举报反馈渠道，当存在用户投诉情况时，将被投诉用户送入审核通道，不再推荐上给予流量。</p><h2 class=pgc-h-arrow-right><strong>9. 为了匹配效率，进行全面的数据收集</strong></h2><p>为了让匹配效率更高，并且识别出隐藏的恶意用户或低价值用户，我们需要收集更多的数据进行预测和筛选。比如前置显性数据收集，可以在用户进入APP后，加一些对自己的描述，或者对另一半要求标签，当然这个功能男女生使用频率差异大。当然也需要记住的是用户不会告诉你一切，并且用户可能也无法准确描述自己的需求。这时候就需要收集一些"隐式"的数据信息，比如当新用户进来时，在为其推荐了一批用户后，Ta的交互 ( 喜欢or不喜欢，是否查看某个用户的详细标签信息、是否有较长的停留等 )，这些都可以反映出用户感兴趣的对象和不感兴趣的人，这背后利用算法和数据技术进行分析就可以得到一个隐式的用户偏好。</p><p>数据非常有用，但也需要进行降噪，比如上述的偏好建模过程中，需要进行噪声数据的识别，比如滑动速度与是否是谨慎可以用来判断用户随意性。比如用户滑动速度小于1s，基本不做停留，而且基本大量右滑，这时候可能需要丢弃这个数据。去噪类的方法看上去很简单，但是最终线上的效果却可能很好。</p><h2 class=pgc-h-arrow-right><strong>10. 社交产品中的感性因素</strong></h2><p>社交场景中存在很多感性因素，对于这些感性因素的把握，也可能会带来不错的收益，比如：</p><p><strong>持续刺激：</strong>短时高强度给予被匹配用户改为持续间隔刺激对用户刺激及留存有较大的影响。比如头部、中腰部用户获取到的关注、匹配率、被喜欢率均高出其他人很多，这时候可以引入蓄水池，在这些匹配完成后 ( 比如有100个match )，不是在用户打开APP的瞬间完成全部展现，而是在用户使用APP的过程中，每隔一段时间 ( 比如5分钟或者更久 ) 或者用户滑卡疲劳时，弹出匹配，让用户在体感上有在线持续有匹配，在这个产品上自己很受欢迎，类似的体验可以拉升用户活跃和留存。</p><p><strong>地理位置可能胜过颜值：</strong>由于陌生人社交有较强的可得性需求，所以对于LBS也是较敏感的，在距离上的贴近可以带来用户对于可得性的满足。比如在颜值相当或者略差的情况下，用户可能对于近距离的匹配也会更感兴趣，这个在陌陌上特征明显。</p><p><strong>快匹配和慢匹配：</strong>陌陌单向可发起匹配和交流，Tinder和探探需要双向匹配才可发起聊天；陌陌属于瀑布流形式，一屏可以看到若干用户，直接可进行比较，而Tinder和探探则是单图滑卡型；虽然后者匹配速度慢，难度大，但是后者对用户的骚扰更少，匹配质量会高于前者。作为Soul这类不看颜值的匹配，就更加突出了效率低和质量高。</p><p><strong>男女匹配策略差异：</strong>前面也讲了男女用户在匹配过程中注意力的差异，男看女只关注外貌，均匀分配给男生；女生看男生完全不一样，颜值曲线波动特别大，证明推荐和个性化维度会有更强的效能。</p><p><strong>群体有偏与谁先说话：</strong>根据前面哪个是核心驱动力的基础上，我们可以对匹配进行改造，非核心用户与核心用户完成匹配后，非核心用户发起第一次聊天后才为核心用户展示已匹配成功。比如男生A与女生B完成匹配，男生会先收到匹配信息，然后如果男生说了第一句话，才给女生展示已经匹配的信息，这样女生的体验会更好。</p><h1 class=pgc-h-arrow-right><strong>03</strong></h1><h1 class=pgc-h-arrow-right><strong>数据及算法体系设计</strong></h1><h2 class=pgc-h-arrow-right><strong>1. 挑战</strong></h2><p><strong>业务特点：</strong>流动性 ( 用户卸载与下载循环，非强需求 )、新用户、消耗速度快 ( 用户消费的就是用户 )、有限的供给关系。</p><p><strong>建模：</strong>双向、延时、多指标博弈、难以度量感性因素、社会学因素，商业化 ( "查看喜欢我的人"是用户付费功能模块，如何提升普通用户的付费率和续费率，并且尽量平衡其它普通用户的体验 )，流量不具有独立性 ( 无法使用传统的灰度方式进行迭代 )。</p><p><strong>2. 目标</strong></p><p>我们先来看看Tinder的核心指标，如下图：</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d87e0f39e34d46f6b7a78f72e50d2a0d><p class=pgc-img-caption></p></div><p>图18 Tinder建模目标</p><p>可以看到Tinder从三个维度来看分别为Activeness ( 新账户数量、使用时长、每日访问次数、每次匹配完成后的对话频率 )、Pickiness ( 右滑率、喜欢率 )、Attractiveness ( 被喜欢率、信息被点击率、信息展示时长 )，其中attractiveness 和pickiness基本可以用户推荐的当下可预估，做起来比较简单，activeness就需要考虑宏观匹配、调控及长期规划了。</p><p>被喜欢率：这个维度的分数取决于有多少人右滑喜欢你，而喜欢你的人自己获得的喜欢越多，对你的分数加成也越大。被喜欢率=被右滑个数/展现次数。</p><p>喜欢率：这个指标是表现了用户对平台其它用户的满意度，看了同样的用户数以后，你右滑的越多这个值越高。喜欢率=右滑个数/展现次数。</p><p>除了上述因素之外，交友类产品中距离也是一个非常重要的因素，所以在上面的匹配公式中，匹配与被匹配用户距离也需要作为一个因子，融合进匹配度计算公式。"效率"是陌生人社交应用至关重要的竞争力，需要每天绞尽脑汁琢磨男、女用户的心理，如何才能更好地做到高效匹配问题，只有高效的匹配健康的匹配率才是长期发展的根本，下图中我们更倾向于后者。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5d314316bb5340b8837525e5d9714781><p class=pgc-img-caption></p></div><p>图19 用户数与匹配率的不健康和健康关系图</p><p>短期指标我们不过多介绍，中长期的评价指标可以是用户次日、7日、30日留存 ，用户付费率、用户整体匹配率等等。用户留存，我们需要看核心用户群体的保留，不单单看全局的流失和留存，关键用户的重要度需要加权。做分类以及评分预测时，不妨针对业务的头部和长尾现象来做模型改造和模型选择，这就是需要识别优质资源 ( 贡献较高的喜欢率，付费意愿强，留存互动较好等 )，先分类再匹配。一个方向是用户来了之后，我帮助他在平台内找到合适的用户，还有一种思路是通过将高价值用户识别出来，在策略上进行一些优先级的排定，比如老用户召回的Push可以分优先级来做，这批用户是第一优先级的。还有一些维度我们也需要分用户维度，比如新用户的首次匹配成功。因为新用户在第一次使用产品过程中，开启聊天的时间间隔，对长期有较深远的影响。</p><p><strong>指标的非独立性和联动：</strong>首先，指标之间不可能完全独立，我们在优化一个指标的同时很容易对另一个指标产生副作用。比如互动率、留存、付费率等。一个产品上线初期 ( 其实中后期也很难 )，不可能在太复杂的业务逻辑下，完全依靠算法达成产品目标，所以初期可能需要加入一些规则进行宏观控制，在机制运行过程中进行调整纠偏。</p><h2 class=pgc-h-arrow-right><strong>3. 相关数据指标及特征</strong></h2><p>拟合一个目标最好的方式之一就是将这个目标的历史先验信息加入进来，比如一个被喜欢率很高的用户，在未来任然高的概率比历史被喜欢率低的要高。所以一个用户的历史被喜欢率、喜欢率、匹配率都可以加入特征去影响匹配。</p><p><strong>反馈率/在线率：</strong>这个指标需要计算用户在收到一个被喜欢后，多久会反馈，因为双向匹配网络中，两个人在互相右滑的间隔中，越短的间隔可以带来更好的首滑用户体验。反馈率=被喜欢后进行喜欢操作的时间间隔，在线率=一天24小时内在线次数 ( 时间间隔小于30分钟记为1次 )。</p><p><strong>颜值分：</strong>用户会在注册使用产品中上传照片，通过图像识别进行颜值打分，这个分偏向于大众分，属于大部分人的审美；在匹配阶段使用的图像Match分更加重要，毕竟萝卜青菜各有所爱。</p><p><strong>用户标签：</strong>当然用户双方选择并不是完全看颜值，毕竟大部分都是 ( 长相 ) 普通的人，所以可以通过标签及用户生活圈层的相似程度来为每个用户建立一套算法作为推荐参考。比如某大陌生人社交平台上有超过70%的人填了各种标签，平均每人填了15个以上的标签。这些都是在照片背后的信息，可以用来为匹配增加更多信息决策依据，而且越详细的标签也代表了用户的认真程度，可以加分不少，也是一个特征。在前期匹配，标签数据不一定有颜值这么有影响，但是长远来说，跟图片无关的文本型的信息，但是对聊天的影响非常大 ( 比如职业、学历、背景相同可能话题更多，聊天更多 )。</p><p>其它特征还有很多，比如用户的年龄、性别、使用频次、活跃时间段、地理位置 ( 城市、小区 )、星座、生日、毕业院校、工作行业、工作岗位、历史匹配数/率、左右滑卡数等等。对于统计类指标及样本进入模型是需要降噪，异常低频和高频的需要进行处理。</p><h2 class=pgc-h-arrow-right><strong>4. 精准与去中心化</strong></h2><p><strong>双向匹配算法中有两个要素：一个是精准度，一个是去中心化。</strong>既要控制头部的用户的超级火爆，第二个就是需要精准扶贫，对匹配困难户扶一把。这两个点真正做好的非常少，因为这两个一定程度上是相互冲突的。</p><p>这里面需要突出的是分别对供需建模 ( 供需关系 )、决策匹配建模 ( 匹配率预估 )、分配建模 ( 流控、运筹规划 )、匹配时效建模 ( 时间预估 )。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3b804e8513b84a2885139d7adeae0058><p class=pgc-img-caption></p></div><p>图20 匹配中的关键系统模块图</p><h3 class=pgc-h-arrow-right><strong>5. 核心系统</strong></h3><p>针对上述的问题，需要构建起几大系统对网络、社会环境进行建模分析，比如仿真系统、计划系统、控制系统、指标系统、溯源系统。</p><p><strong>指标系统：</strong>业务的核心指标统计分析中心。</p><p><strong>控制系统：</strong>实际业务中的召回、排序、业务逻辑、流量控制等模块。</p><p><strong>溯源系统：</strong>通过日志埋点，记录历史每个时刻各个系统的状态，方便未来回溯分析。</p><p><strong>仿真系统：</strong>即"沙盘模拟环境"，交友类产品要求用户之间深度参与服务过程，线上试错成本极高。仿真系统主要是覆盖主流程，对于细节部分可以忽略，一般精度在8-9成，结合溯源回放历史过程对业务建模、用户行为模拟等方法模拟线上场景，仿真通过选取指标系统中的核心指标输出报告，做到离线预估，当然这个系统是逐步完善的。</p><p><strong>计划系统：</strong>利用全局历史数据、单粒度用户历史数据进行预测后，进行规划尽量逼近全局最优的流量和曝光分配方案，并通过控制系统在实际系统中产生影响，当然这个过程也是在实时调整的，客观和虚拟的实时融合，通过数据反馈时刻都在推演未来，就像下围棋一样，每一步的落子前多往前看几步棋，别人落子后，重新推演计算下一步方案。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dcf2cf3e4a10491da2ec963c309911c5><p class=pgc-img-caption></p></div><p>图21 匹配场景中的若干系统</p><p><strong>推荐架构：</strong>在这个体系内，用户上线瞬间，我们能准确找到它的潜在的匹配用户，预测出Ta有多受欢迎 ( 在不同的冷热分桶里会有多少个喜欢 )，策略是让人-人匹配，和让过于受欢迎、有竞争力的用户能够牺牲部分曝光 ( 由于大量的喜欢已经产生，这部分曝光为头部用户带来的边际收益很小 )，分配给新、中腰部用户，达到反馈提升的效果。调度系统对已有的各类算法匹配结果进行调度使用，根据用户行为和既定分配策略，并使用增量学习算法，学习用户偏好并动态调整用户推荐结果。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ad39b41d3c164fbeb06f1ac2ebe1afa0><p class=pgc-img-caption></p></div><p>图22 产品漏斗和模块解构</p><p>使用智能系统需要做双向概率预估，通过将A对B和B对A的喜欢概率进行预估，并相乘计算匹配成功率；由于反馈及时程度往往也较大地影响了这个用户的留存，所以在给用户匹配其他可能Ta喜欢的人时，我们需要在匹配计算公式中加入对方未来活跃(活跃时间间隔预估)并回复的概率，并作为因子影响匹配成功率。比如对实时在线的用户给予优先权（因子分数高），让反馈速度提升。并且我们在展示层引入供需关系，并通过冷热预估、投放策略（贪心、概率、bandit等）来进行控制。</p><p>各个模块要点和目标诉求可参考下图。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d8ab12c53874488091989b00f380b210><p class=pgc-img-caption></p></div><p>图23 目标与拆解</p><p>细节点上，我们需要在整流程中注意popularity ( 受欢迎度/热度 )，distance ( 距离 )，recency ( 活跃度 )，fatigue ( 疲劳度 )，match ( 匹配度 ) 等；通过引入用户静态标签在召回、排序、干预阶段进行策略学习 ( 比如男生会学习到颜值的重要性，女生模型会学习到学历、职业等标签的重要性，有些喜欢多滑动多看漂亮小姐姐，有些希望快速匹配近距离的异性 )。分地区、分时段、多模型的精细化预估；分布式、多线程、并行计算满足海量数据的实时性要求；在供需失衡之前，实施调控干预。通过数据和算法回顾过去、监控现在、预测未来，利用网络状态的分析及推演 ( 看清网络，为优化提供支撑 ) 指导业务。</p><div class=pgc-img><img alt=基于双向匹配的陌生人社交业务、策略及算法思考 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a0b30269bacc4d71ab754d12f68c75b1><p class=pgc-img-caption></p></div><p>图24 匹配产品背后的系统图</p><p><strong>04</strong></p><p><strong>总结</strong></p><p>社交类产品的发展壮大一定是感性与理性交织，个体匹配 ( 微观 ) 和全局匹配 ( 宏观 ) 兼顾的。尽可能从微观出发，利用数据和算法，得到宏观，并通过类似财务对账机制，保证两者的一致性，一致才能驱动优化。</p><p>社交类产品异常复杂，如何制定正确的优化指标真的很难，需要构建闭环，并缩短业务迭代的闭环，提升迭代效率，小步快跑试错。数据质量是地基，保证好质量，并多做覆盘分析。业务理解 > 工程实现；数据 > 系统 > 算法。</p><p>作者：姚凯飞，出海方向创业者。前 Club Factory 推荐&风控算法负责人，前阿里推荐算法工程师，多年电商及视频推荐经验，硕士毕业于上海交通大学，目前在跨境电商方向创业。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'双向','业务','社交'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>