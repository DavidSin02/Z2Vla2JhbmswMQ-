<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Fzf：Golang开发的Github高星系统模糊搜索补全工具 | 极客快訊</title><meta property="og:title" content="Fzf：Golang开发的Github高星系统模糊搜索补全工具 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/b6efd0314b444ab584fe52ec5ecf8252"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6b8c2546.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6b8c2546.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/6b8c2546.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6b8c2546.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6b8c2546.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/6b8c2546.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/6b8c2546.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6b8c2546.html><meta property="article:published_time" content="2020-10-29T21:10:13+08:00"><meta property="article:modified_time" content="2020-10-29T21:10:13+08:00"><meta name=Keywords content><meta name=description content="Fzf：Golang开发的Github高星系统模糊搜索补全工具"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/6b8c2546.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Fzf：Golang开发的Github高星系统模糊搜索补全工具</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>工欲善其事，必先利其器，常使用Linux命令终端的人都知道，bash默认情况下提供了很多便利的功能，比如TAB命令补全等，CTRL+R命令搜索等，但是这些功能往往有这样或者那样的问题致使不够尽兴。今天，虫虫给大家介绍一款强大通用系统模糊搜索补全工具Fzf，可以给这方面的功能锦上添花，趋于完美。</p><div class=pgc-img><img alt=Fzf：Golang开发的Github高星系统模糊搜索补全工具 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b6efd0314b444ab584fe52ec5ecf8252><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>概述</h1><p>Fzf是一个开源的交互式shell命令行模糊查询工具，可以用于对文件，历史记录（history），进程，主机名，书签，git commit等等列表和应用。</p><p>Fzf是用Golang语言开发的shell系统工具，源代码托管再Github上（github.com/junegunn/fzf.git），截止目前该项目已经累积了25500多星，Fork上千。</p><p>借助于Golang静态编译的特点，Fzf具有便携式，无依赖性；高性能，速度飞快的优点，同时还具有：</p><p>最全面的功能集；</p><p>布局灵活；</p><p>额外强大的插件支持：</p><p>比如Vim/Neovim插件，可支持键绑定和模糊自动补全。</p><h1 class=pgc-h-arrow-right>安装</h1><p>Fzf支持通过Homebrew、操作系统包管理器以及源码方式安装。其文件项目有四部分组成，包括以下组件：</p><p>fzf可执行文件；</p><p>fzf-tmux脚本，用于在tmux窗格中启动fzf；</p><p>Shell扩展：支持按键绑定（CTRL-T，CTRL-R和ALT-C），支持bash，zsh，fish。</p><p>模糊自动补全，支持bash，zsh。</p><p>Vim/Neovim插件。</p><p>其中，fzf可执行文件是必须的，其他组件依赖于它。如果不需要其他组件，可以单独下载fzf可执行文件运行。</p><h1 class=pgc-h-arrow-right>发行版包管理器安装</h1><p>Fzf最简单的安装方法就是通过OS发行版本的包管理器一键安装。Fzf支持了最广泛的发行版本安装：</p><p><strong>Arch Linux：</strong></p><p>sudo pacman -S fzf</p><p><strong>Debian系：</strong></p><p>fzf支持Debian Buster及更新的版本，可以使用apt-get包管理器安装。sudo apt-get install fzf</p><p><strong>Fedora：</strong></p><p>fzf支持Fedora 26及更新的版本，可以使用dnf安装：</p><p>sudo dnf install fzf</p><p>默认情况下，启用vim或neovim的Shell补全和插件。Shell键绑定已安装，但默认情况下未启用。有关更多信息，请参见Fedora的软件包文档（/usr/share/doc/fzf/README.Fedora）。</p><p><strong>FreeBSD：</strong></p><p>pkg install fzf</p><p><strong>NixOS：</strong></p><p>以使用Nix软件包管理器来安装fzf。</p><p>nix-env -iA nixpkgs.fzf</p><p><strong>openSUSE：</strong></p><p>对于openSUSE 支持Tumbleweed版本，可通过zypper安装：</p><p>sudo zypper install fzf</p><p><strong>Windows：</strong></p><p>Windows的预编译二进制文件可以项目发布页下载。fzf也支持以Chocolatey或Scoop软件包管理器安装：</p><p>choco install fzf</p><p>scoop install fzf</p><p>但是，该项目的其他组件可能无法在Windows上运行。已知问题和限制可以在Wiki页面上找到。可能要考虑在Windows子系统（适用于Linux）上安装fzf，以确保一切运行正常。</p><p><strong>Homebrew安装</strong></p><p>对于Mac系统可以Homebrew fzf。</p><p>brew install fzf</p><p>如果要安装用键绑定和模糊补全脚本使用：</p><p>(brew --prefix)/opt/fzf/install</p><p>也可以通过MacPorts：</p><p>sudo port install fzf</p><h1 class=pgc-h-arrow-right>Git安装</h1><p>如果你的用的发行版恰好不支持，或者你需要自定义源码安装最新版本，可以通过git clone 克隆项目，然后执行安装程序即可。</p><p>git clone --depth 1 github.com/junegunn/fzf.git ~/.fzf</p><p>~/.fzf/install</p><div class=pgc-img><img alt=Fzf：Golang开发的Github高星系统模糊搜索补全工具 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/20c5ded4ae824cde9d53a7e82f4ca149><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>Vim插件</h1><p>安装好Fzf后，在Vim配置文件中将目录添加到&runtimepath，就可以在Vim启它，如下所示：</p><p>对Homebrew安装的</p><p>set rtp+=/usr/local/opt/fzf</p><p>对通过git安装的</p><p>set rtp+=~/.fzf</p><p>如果使用要vim-plug，则配置如下：</p><p>对Homebrew安装的</p><p>Plug '/usr/local/opt/fzf'</p><p>对通过git安装的</p><p>Plug '~/.fzf'</p><p>也可以使用vim-plug来完成安装工作，而不是在系统上单独安装fzf（使用Homebrew或git clone），然后通过配置在Vim中启用（添加到&runtimepath ）。</p><p>Plug 'junegunn/fzf', { 'dir': '~/.fzf', 'do': './install --all' }</p><h1 class=pgc-h-arrow-right>升级fzf</h1><p>Fzf在持续迭代开发，为了获取最新功能，则需要时时升级版本。Fzf的升级方法如下：</p><p>git安装：</p><p>cd ~/.fzf && git pull && ./install</p><p>brew：</p><p>brew update; brew reinstall fzf</p><p>chocolatey: choco upgrade fzf</p><p>vim-plug: :PlugUpdate fzf</p><h1 class=pgc-h-arrow-right>Fzf源码编译</h1><p>Fzf编译需要golang 1.11版本以上，还依赖下面的第三方库：</p><p>使用的第三方库</p><p>mattn/go-runewidth</p><p>mattn/ o-shellwords</p><p>mattn/go-isatty</p><p>tcell</p><p>构建fzf二进制文件并将其复制到bin目录，</p><p>make && make install</p><p>在目标中构建32位和64位可执行文件和tarball</p><p>make release</p><p>为目标中所有受支持的平台制作发布档案</p><p>make release-all</p><p><strong>使用go get构建</strong></p><p>Fzf也支持，直接通过go get命令，而无需手动克隆存储库。具体命令如下：</p><p>go get -u github.com/junegunn/fzf</p><h1 class=pgc-h-arrow-right>Fzf用法大全</h1><p>Fzf安装后，将启动交互式查找程序，从STDIN中读取列表，然后将所选项目写入STDOUT。</p><p>find * -type f | fzf > selected</p><div class=pgc-img><img alt=Fzf：Golang开发的Github高星系统模糊搜索补全工具 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/26b6fe74a6e74e658a847e06e8f59e19><p class=pgc-img-caption></p></div><p>如果没有STDIN管道，则fzf将使用find命令来获取文件列表（不包括隐藏文件）。（可以使用FZF_DEFAULT_COMMAND覆盖默认命令）</p><p>vim $(fzf）</p><h1 class=pgc-h-arrow-right>使用finder</h1><p>CTRL-J/CTRL-K（或CTRL-N/CTRL-P）可上下移动光标</p><p>输入键选择项目，按CTRL-C/ TRL-G/ESC退出</p><p>在多选模式（-m）中，使用TAB和Shift-TAB标记多个项目</p><p>Emacs样式键绑定</p><p>鼠标：滚动，单击，双击；在多选模式下按住Shift点击并Shift滚动。</p><h1 class=pgc-h-arrow-right>布局</h1><p>默认情况下，Fzf开题全屏模式，我们可以使用--height选项使其在光标下方开始。</p><p>vim $(fzf --height 40%)</p><div class=pgc-img><img alt=Fzf：Golang开发的Github高星系统模糊搜索补全工具 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e4c4559e03f34266844efb522cf8e2f6><p class=pgc-img-caption></p></div><p>如果喜欢"自上而下"的布局而不是默认的"自下而上"的布局，请使用--reverse和--layout选项。</p><p>vim $(fzf --height 40%)</p><div class=pgc-img><img alt=Fzf：Golang开发的Github高星系统模糊搜索补全工具 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6218feb51fcd4bb3b39101492de700da><p class=pgc-img-caption></p></div><p>可以将这些选项添加到$ FZF_DEFAULT_OPTS，以便默认情况下应用它们。例如，</p><pre>export FZF_DEFAULT_OPTS ='--height 40% --layout = reverse --border'</pre><h1 class=pgc-h-arrow-right>搜索语法</h1><p>除非有特殊说明，Fzf都会以扩展搜索模式启动，可以在其中键入多个以空格分隔的搜索词。比如：^music .mp3$ chongchong !fire</p><p>相关解释如下：</p><p>chongchong模糊匹配，匹配chognchong字条；</p><p>^music前缀精准匹配，匹配以music开头的字条；</p><p>.mp3$ 后缀精准匹配，匹配以.mp3结尾的字条；</p><p>'whild 精准匹配，匹配包含wild的字条；</p><p>!fire 反向精准匹配，匹配其中不包含fire的字条；！也支持对前后缀匹配的反向匹配。</p><p>上例子表示查找以music开头，以.mp3结尾，不包括fire，含有chongchong的字条。</p><p>如果不喜欢模糊匹配并且不想"引用"每个单词，可以用-e或--exact选项启动fzf。注意：设置为--exact时，"-prefix"选项会实效。</p><p>单个竖线字符可以充当OR运算符。比如，下面的查询匹配以core开头，以go，rb或py结尾的条目。</p><p>^core go$ | rb$ | py$</p><h1 class=pgc-h-arrow-right>环境变量</h1><p><strong>FZF_DEFAULT_COMMAND</strong></p><p>输入为tty时使用的默认命令</p><p>例如导出FZF_DEFAULT_COMMAND ='fd --type f'</p><p><strong>FZF_DEFAULT_OPTS</strong></p><p>默认选项</p><p>例如export FZF_DEFAULT_OPTS ="-layout = reverse --inline-info"</p><h1 class=pgc-h-arrow-right>fzf-tmux脚本</h1><p>fzf-tmux是一个bash脚本，用来在tmux窗格中打开fzf。</p><div class=pgc-img><img alt=Fzf：Golang开发的Github高星系统模糊搜索补全工具 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/54317faf494f47a2a625886ca4eb3ef3><p class=pgc-img-caption></p></div><p><br></p><p>在水平分割中窗体中（15行））显示git分支</p><p>git branch | fzf-tmux -d 15</p><p>在左侧垂直分割的窗体中（屏幕宽度的20%）显示字典的内容：</p><p>cat /usr/share/dict/words | fzf-tmux -l 20% --multi --reverse</p><p>如果不是tmux模式，该插件也可以正常工作，只是-[udlr]选项会实效。通常模式下需要使用--height HEIGHT[%]选项，启动非全屏模式的fzf。</p><p>fzf --height 40%</p><h1 class=pgc-h-arrow-right>命令行的键绑定</h1><p>安装脚本将会在bash，zsh和fish添加以下按键绑定。</p><p><strong>CTRL-T: </strong>将选定的文件或者目录粘贴到命令行上</p><div class=pgc-img><img alt=Fzf：Golang开发的Github高星系统模糊搜索补全工具 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c60db9c50ae4425dbbdfbd3e39c59a82><p class=pgc-img-caption></p></div><p>可通过设置FZF_CTRL_T_COMMAND覆盖默认命令；</p><p>可通过设置FZF_CTRL_T_OPTS设置其他选项；</p><p><strong>CTRL-R : </strong>从历史记录中将所选命令粘贴到命令行上</p><div class=pgc-img><img alt=Fzf：Golang开发的Github高星系统模糊搜索补全工具 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/d141722d1c9a4fb08f3d08c85e3d48c1><p class=pgc-img-caption></p></div><p>如果想按时间顺序查看命令，请再次按CTRL-R，按相关性切换排序</p><p>可通过设置FZF_CTRL_R_OPTS设置其他选项；</p><p><strong>ALT-C </strong>cd进入所选目录</p><p>可通过设置FZF_ALT_C_COMMAND以覆盖默认命令；</p><p>可通过设置FZF_ALT_C_OPTS设置其他选项；</p><p>在tmux会话下，可以通过将FZF_TMUX设置为1来在拆分窗格中启动fzf，然后使用FZF_TMUX_HEIGHT更改窗格的高度（例如20%，50%等）。</p><p>如果在bash上使用vi模式，则需要在.bashrc中的source ~/.fzf.bash之前添加set -o vi，以使其正确设置vi模式的键绑定。</p><p>可以在Wiki页面上找到更多提示。</p><h1 class=pgc-h-arrow-right>bash和zsh的模糊补全</h1><h1 class=pgc-h-arrow-right>文件和目录</h1><p>如果光标前的单词以触发序列（默认为<strong>**</strong>）结尾，则可以触发文件和目录的模糊补全。</p><p>COMMAND [DIRECTORY/] [FUZZY_PATTERN] ** &lt;TAB></p><p>当前目录下的文件,可以使用TAB键选择多个项目</p><p>cat ** &lt;TAB></p><div class=pgc-img><img alt=Fzf：Golang开发的Github高星系统模糊搜索补全工具 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3c450773afab4739865383b8acd6fb62><p class=pgc-img-caption></p></div><p>对父目录下的文件名补全</p><p>vim ../** &lt;TAB></p><div class=pgc-img><img alt=Fzf：Golang开发的Github高星系统模糊搜索补全工具 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c723d72062aa4e4492547e7c3d4af107><p class=pgc-img-caption></p></div><p>父目录下匹配`fzf`的文件</p><p>vim ../fzf** &lt;TAB></p><div class=pgc-img><img alt=Fzf：Golang开发的Github高星系统模糊搜索补全工具 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a8bab949ea7f4a1cafd39db9a2d2e798><p class=pgc-img-caption></p></div><p>用户主目录下的文件</p><p>cat ~/** &lt;TAB></p><p>当前目录下的目录（单选）</p><p>cd ** &lt;TAB></p><p>~/github下与`fzf`匹配的目录</p><p>cd ~/github/fzf** &lt;TAB></p><h1 class=pgc-h-arrow-right>进程ID</h1><p>PID的模糊补全提供给kill命令。在这种情况下，没有触发序列，只需在kill命令后按tab键即可。</p><p>可以使用&lt;TAB>或&lt;Shift-TAB>键选择多个进程</p><p>kill -9 &lt;TAB></p><div class=pgc-img><img alt=Fzf：Golang开发的Github高星系统模糊搜索补全工具 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ea0fc118f28c4e5c9d7220e8e67dbc02><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>主机名</h1><p>对ssh和telnet命令，支持主机名的模糊补全。补全名称是从/etc/hosts和~/.ssh/config中获取的。</p><p>ssh ** &lt;TAB></p><p>telnet ** &lt;TAB></p><h1 class=pgc-h-arrow-right>环境变量/别名</h1><p>unset **&lt;TAB></p><p>export **&lt;TAB></p><p>unalias **&lt;TAB></p><h1 class=pgc-h-arrow-right>默认配置项</h1><h1 class=pgc-h-arrow-right>触发关键字</h1><p>比如使用~~作为触发关键字，不用默认的**，可通过设置：</p><p>export FZF_COMPLETION_TRIGGER='~~'</p><h1 class=pgc-h-arrow-right>fzf命令的选项</h1><p>export FZF_COMPLETION_OPTS='+c -x'</p><h1 class=pgc-h-arrow-right>默认搜索工具</h1><p>使用fd（github.com/sharkdp/fd）代替默认find命令列出路径</p><p>_fzf_compgen_path() {</p><p>fd --hidden --follow --exclude ".git" . "$1"</p><p>}</p><p>其中函数（$1）的第一个参数开始便利的基础目录。</p><p>使用fd生成目录补全的列表：</p><p>_fzf_compgen_dir() {</p><p>fd --type d --hidden --follow --exclude ".git" . "$1"</p><p>}</p><h1 class=pgc-h-arrow-right>增加命令支持</h1><p>在bash上，仅对预定义的命令集启用了模糊补全，其详细里列表通过"complete | grep _fzf"查看。Fzf也支持对其进行扩展，方法是：</p><p>_fzf_setup_completion path|dir COMMANDS...</p><p>比如：</p><p>_fzf_setup_completion path ag git kubectl</p><p>_fzf_setup_completion dir tree</p><h1 class=pgc-h-arrow-right>Vim插件</h1><p>Fzf的Vim插件提供了两个核心功能fzf#run和fzf#wrap，其中:fzf命令基本文件选择器命令。</p><p><strong>fzf#run（[spec dict]）</strong>：使用给定的规范在Vim中启动fzf，比如：</p><p>:call fzf#run({'source': 'ls'})</p><p><strong>fzf#wrap([spec dict]) -> (dict) </strong>：采用fzf#run的规范，并返回其扩展版本以及用于处理全局首选项的其他选项（g：fzf_xxx）。</p><p>:echo fzf#wrap({'source': 'ls'})</p><p>通常在将规范传递给fzf#run之前将其包装在fzf#wrap</p><p>:call fzf#run(fzf#wrap({'source': 'ls'}))</p><p><strong>:FZF [fzf_options string] [path string]：</strong>基本的模糊文件选择器，对那些不想编写VimScript来实现自定义命令的人的参考实现</p><h1 class=pgc-h-arrow-right>用法</h1><p><strong>:FZF[!]</strong></p><p>"在当前目录下查找文件</p><p>:FZF</p><p>在主目录下查找文件</p><p>：FZF ~</p><p>使用fzf命令行选项</p><p>:FZF --reverse --info=inline /tmp</p><p>与ctrlp.vim相似，使用Enter键，CTRL-T，CTRL-X或CTRL-V在当前窗口，新选项卡，水平分割或垂直分割中分别打开选定的文件。</p><p>注意，环境变量FZF_DEFAULT_COMMAND和FZF_DEFAULT_OPTS也起作用。</p><h1 class=pgc-h-arrow-right>配置项</h1><p>g:fzf_action：自定义的额外按键绑定，用于以不同方式打开所选文件</p><p>g:fzf_layout: 确定fzf窗口的大小和位置</p><p>g:fzf_colors: 自定义fzf颜色以匹配当前的配色方案</p><p>g:fzf_history_dir: 启用历史记录功能</p><h1 class=pgc-h-arrow-right>fzf#run</h1><p>fzf#run()函数是Vim集成的核心。它需要一个字典参数，一个规范，并相应地启动fzf进程。至少要指定接收器选项，以告诉它应该对所选条目执行的操作。</p><p>call fzf#run({'sink': 'e'})</p><p>上面没有指定源，所以这等效于在没有标准输入管道的情况下在命令行上启动fzf。fzf将使用find命令（或$ FZF_DEFAULT_COMMAND（如果已定义））列出当前目录下的文件。选择一个文件时候，它将使用接收器:e命令将其打开。如果要在新选项卡中打开它，则可以传递:tabedit命令作为接收器。</p><p>call fzf#run({'sink': 'tabedit'})</p><p>可以使用任何shell命令作为源，而不是使用默认的find命令。比如下面示例将列出git管理的文件。相当于shell命令行下运行git ls-files | fzf。</p><p>call fzf#run({'source': 'git ls-files', 'sink': 'e'})</p><p>可以将fzf选项指定为spec词典中的选项条目。</p><p>call fzf#run({'sink': 'tabedit', 'options': '--multi --reverse'})</p><p>不希望fzf窗口占据整个屏幕，还可以传递布局选项。</p><p>call fzf#run({'source': 'git ls-files', 'sink': 'e', 'left': '40%'})</p><p>call fzf#run({'source': 'git ls-files', 'sink': 'e', 'window': '30vnew'})</p><p>源不一定是外部shell命令，可以传递Vim​​数组作为源。下面的示例中，传递了颜色名称实现颜色方案选择器的源。</p><p>call fzf#run({'source': map(split(globpath(&rtp, 'colors/*.vim')),</p><p>\ 'fnamemodify(v:val, ":t:r")'),</p><p>\ 'sink': 'colo', 'left': '25%'})</p><h1 class=pgc-h-arrow-right>fzf#wrap</h1><p>前面说过:FZF命令的几个方面可以使用一组全局选项变量进行配置。使用不同的方式打开文件（g:fzf_action），窗口位置和大小（g:fzf_layout），调色板（g:fzf_colors）等不同的方式。那么，如何使我们的自定义fzf#run调用也能起作用呢？只需将其传递给fzf#run，然后用fzf#wrap修饰spec词典:</p><p>fzf#wrap([name string], [spec dict], [fullscreen bool]) -> (dict)</p><p>所有参数都是可选的。通常只需要传递一个规范字典。</p><p>name用于管理历史记录文件。如果未定义g:fzf_history_dir，则会被忽略。</p><p>fullscreeen 可设置为0或1（默认值:0）。</p><p>fzf#wrap接受一个规范，并返回它的扩展版本（也是字典），并带有用于解决全局首选项的其他选项。可以像这样检查它的返回值：</p><p>echo fzf#wrap({'source': 'ls'})</p><p>打包规范之后，就可将其传递给fzf#run。</p><p>call fzf#run(fzf#wrap({'source': 'ls'}))</p><p>现在，它支持CTRL-T，CTRL-V和CTRL-X键绑定，并根据g:fzf_layout设置打开fzf窗口。</p><p>为了使其易于使用，让我们定义LS命令使用。</p><p><br></p><p>command! LS call fzf#run(fzf#wrap({'source': 'ls'}))</p><p>然后就可以通:LS调用。</p><h1 class=pgc-h-arrow-right>其他功能</h1><h1 class=pgc-h-arrow-right>性能问题</h1><p>Fzf很快，而且会变得越来越快。在大多数情况下，性能都不是问题。但是有几个性能选项需要了解。</p><p><strong>--ansi</strong>：告诉Fzf提取并解析输入中的ANSI颜色代码，这会使初始扫描变慢。因此，不建议将其添加到$FZF_DEFAULT_OPTS中。</p><p><strong>--nth</strong>：该选项也会使fzf变慢，指定该选项后fzf必须对每行做标记。</p><p><strong>--with-nth</strong>：该选项也会使fzf变慢，指定该选项后fzf必须每行标记并重新转载。</p><p>如果对想能有严苛要求，可以考虑使用--algo = v1（默认值为v2）使fzf使用更快的贪婪算法。但是，不能保证该算法找到最佳顺序的匹配，因此一般不建议使用。</p><h1 class=pgc-h-arrow-right>执行外部程序</h1><p>可以通过设置键绑定来启动外部进程，而无需离开fzf（execute，execute-silent）。</p><p>通过按F1键以较少的文件打开文件而不离开fzf，通过按CTRL-Y将行复制到剪贴板并中止fzf（需要pbcopy支持）</p><p>fzf --bind 'f1:execute(less -f {}),ctrl-y:execute-silent(echo {} | pbcopy)+abort'</p><h1 class=pgc-h-arrow-right>预览窗口</h1><p>设置--preview选项时，fzf会自动以当前行作为参数启动外部进程，并在拆分窗口中显示结果。</p><p>使用{}替换为焦点行的单引号字符串</p><p>fzf --preview 'cat {}'</p><p>由于预览窗口仅在该过程完成后才更新，因此该命令快速完成很重要。</p><p>使用head而不是cat，以便命令不会花费太长时间来完成</p><p>fzf --preview 'head -100 {}'</p><p>预览窗口支持ANSI颜色，因此可以使用语法突出显示文件内容的程序，比如和</p><p>bat、Highlight、CodeRay、Rouge等配合使用，比如下面的命令依次使用bat, highlight, coderay, rougify，然后回退到cat：</p><p>fzf --preview '[[ $(file --mime {}) =~ binary ]] &&</p><p>echo {} is a binary file ||</p><p>(bat --style=numbers --color=always {} ||</p><p>highlight -O ansi -l {} ||</p><p>coderay {} ||</p><p>rougify {} ||</p><p>cat {}) 2> /dev/null | head -500'</p><p>也可以使用--preview-window选项自定义预览窗口的大小和位置。例如，</p><p>fzf --height 40% --reverse --preview 'file {}' --preview-window down:1</p><p>fzf --height 40％--reverse --preview'file {}'--preview-window down：1</p><h1 class=pgc-h-arrow-right>.gitignore</h1><p>可以使用fd，ripgrep或silver搜索程序代替默认的find命令来遍历文件系统，搜索时候支持利用git忽略定义.gitignore文件排除文件和目录。</p><p>将fd的输出输入fzf</p><p>fd --type f | fzf</p><p>将fd设置为fzf的默认源</p><p>export FZF_DEFAULT_COMMAND='fd --type f'</p><p>设置后， fzf（不带管道）将使用fd代替find</p><p>也支持对CTRL-T命令使用：</p><p>export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"</p><p>如果要使该命令遵循符号链接，并且不希望其排除隐藏文件，可使用以下命令：</p><p>export FZF_DEFAULT_COMMAND='fd --type f --hidden --follow --exclude .git'</p><h1 class=pgc-h-arrow-right>git ls-tree快速遍历</h1><p>如果在大型git存储库中运行fzf，则使用git ls-tree可以提高遍历的速度。</p><p>export FZF_DEFAULT_COMMAND='</p><p>(git ls-tree -r --name-only HEAD ||</p><p>find . -path "*/\.*" -prune -o -type f -print -o -type l -print |</p><p>sed s/^..//) 2> /dev/null'</p><h1 class=pgc-h-arrow-right>Fish Shell</h1><p>Fish Shell 2.6.0之前的版本不允许在命令替换中从STDIN读取，所以简单的vim（fzf）将无法正常工作。 fish 2.5.0和更早版本需要使用使用read fish命令：</p><p>fzf | read -l result; and vim $result</p><p>对于多个结果：</p><p>fzf -m | while read -l r; set result $result $r; end; and vim $result</p><p>fish shell的glob系统系统和shell不同，所以**的补全功能将不起作用。但是，CTRL-T命令将使用命令行最后一个标记作为递归搜索的根文件夹。例如，在以下命令行的末尾按下CTRL-T</p><p>ls /var/</p><p>将列出/var/下的所有文件和文件夹。</p><p>使用自定义FZF_CTRL_T_COMMAND时，请使用未扩展的$dir变量来使用此功能。当最后不是有效目录时，$dir默认为.。 例：</p><p>set -g FZF_CTRL_T_COMMAND "command find -L \$dir -type f 2> /dev/null | sed '1d; s#^\./##'"</p><h1 class=pgc-h-arrow-right>总结</h1><p>Fzf是一款非常优秀、老少皆宜的开源系统工具，可以用来取代shell默认的搜索和补全行为。由于使用golang开发安装部署非常方便，性能也非常高。适合于开发者，运维和其他Linux用户,Github 2万多星就足以说明其多受欢迎了,非常值得大家使用。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Fzf','Golang','开发'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>