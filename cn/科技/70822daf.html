<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>TensorFlowå®æˆ˜ï¼šChapter-7ä¸‹ï¼ˆTFTSåº“ä¸æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰ | æå®¢å¿«è¨Š</title><meta property="og:title" content="TensorFlowå®æˆ˜ï¼šChapter-7ä¸‹ï¼ˆTFTSåº“ä¸æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/153490532779764442c6667"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/70822daf.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/70822daf.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/70822daf.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/70822daf.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/70822daf.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/70822daf.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/70822daf.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/70822daf.html><meta property="article:published_time" content="2020-11-14T21:03:08+08:00"><meta property="article:modified_time" content="2020-11-14T21:03:08+08:00"><meta name=Keywords content><meta name=description content="TensorFlowå®æˆ˜ï¼šChapter-7ä¸‹ï¼ˆTFTSåº“ä¸æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/70822daf.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>TensorFlowå®æˆ˜ï¼šChapter-7ä¸‹ï¼ˆTFTSåº“ä¸æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><ul><li>æœ¬èŠ‚ç®€ä»‹</li><li>TensorFlowæ›´æ–°</li><li>æ³¨æ„</li><li>ä¸‹è½½æœ€æ–°æºç ç¼–è¯‘æºç æ›´æ–°</li><li>é¦–å…ˆå¸è½½å½“å‰çš„tensorflow</li><li>å‚è€ƒå®˜æ–¹çš„ä»æºç å®‰è£…tensorflow</li><li>ç›´æ¥ä½¿ç”¨pipå·¥å…·æ›´æ–°</li><li>æ›´æ–°åå¯èƒ½ä¼šé‡åˆ°çš„å¼‚å¸¸</li><li>è‡ªå®šä¹‰LSTMå¾ªç¯ç¥ç»ç½‘ç»œè¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹</li><li>å·¥ç¨‹å®ç°</li><li>éœ€è¦ç”¨åˆ°çš„æ¨¡å—</li><li>ç”Ÿæˆè®­ç»ƒæ•°æ®ä¸æµ‹è¯•æ•°æ®</li><li>æ³¨è§£</li><li>å®šä¹‰ç½‘ç»œæ¨¡å‹</li><li>åˆ›å»ºæ¨¡å‹å¹¶è®­ç»ƒ</li><li>Estimatorå·¥å…·</li><li>ç»˜å›¾</li><li>åˆ©ç”¨TFTSè¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹</li><li>è½½å…¥æ•°æ®éƒ¨åˆ†</li><li>ä»CSVæ–‡ä»¶ä¸­è¯»å…¥æ—¶é—´åºåˆ—æ•°æ®</li><li>ä½¿ç”¨ARæ¨¡å‹é¢„æµ‹æ—¶é—´åºåˆ—</li><li>ä»£ç å®ç°</li><li>äº§ç”Ÿæ•°æ®</li><li>åˆ›å»ºaræ¨¡å‹</li><li>è®­ç»ƒè¯„ä¼°æ¨¡å‹å¹¶é¢„æµ‹</li><li>ä½¿ç”¨LSTMé¢„æµ‹å•å˜é‡æ—¶é—´åºåˆ—</li><li>äº§ç”Ÿè®­ç»ƒæ•°æ®</li><li>å®šä¹‰è®­ç»ƒæ¨¡å‹å¹¶é¢„æµ‹</li><li>ç»˜åˆ¶é¢„æµ‹æ•°æ®å›¾</li><li>ä½¿ç”¨LSTMé¢„æµ‹å¤šå˜é‡æ—¶é—´åºåˆ—</li><li>è·å–è®­ç»ƒæ•°æ®</li><li>å®šä¹‰è®­ç»ƒæ¨¡å‹å¹¶é¢„æµ‹</li><li>ç»˜åˆ¶é¢„æµ‹å›¾</li><li>æ€»ç»“</li></ul><h1><strong>æœ¬èŠ‚ç®€ä»‹</strong></h1><p>æœ¬èŠ‚å…³äºTFTSæ¨¡å—çš„ä½¿ç”¨å‚è€ƒçŸ¥ä¹-ä½•ä¹‹æº-å¦‚ä½•ä¼˜é›…åœ°ç”¨TensorFlowé¢„æµ‹æ—¶é—´åºåˆ—ï¼šTFTSåº“è¯¦ç»†æ•™ç¨‹ã€‚</p><p>å¦‚ä½•åœ¨TensorFlowä¸Šä½¿ç”¨LSTMæ¥åšæ—¶é—´åºåˆ—é¢„æµ‹æ˜¯ä¸€ä¸ªå¾ˆè€çš„è¯é¢˜ï¼Œç„¶è€Œä¸€ç›´æ²¡æœ‰æ¯”è¾ƒå¥½çš„è§£å†³æ–¹æ¡ˆã€‚åœ¨åˆšåˆšå‘å¸ƒçš„TensorFlow1.3ç‰ˆæœ¬ä¸­ï¼Œåœ¨tf.contribåŒ…ä¸‹å¼•å…¥äº†ä¸€ä¸ªTime Seriesæ¨¡å—(TensorFlow Time Series,TFTS)ã€‚å…¶æºç åœ°å€åœ¨github timeseriesã€‚TFTSæä¾›äº†ä¸€å¥—åŸºç¡€çš„æ—¶é—´åºåˆ—æ¨¡å‹APIã€‚<strong>ç›®å‰æä¾›ARã€Anomaly Mixture ARã€LSTMä¸‰ç§é¢„æµ‹æ¨¡å‹ã€‚</strong></p><p>è¿™é‡Œå› ä¸ºæ˜¯åˆšåˆšå‘å¸ƒçš„åº“ï¼Œæ–‡æ¡£åŒ®ä¹ï¼Œæˆ‘ä»¬ç€é‡äºä»‹ç»TFTSçš„ä»¥ä¸‹å‡ ä¸ªåŠŸèƒ½:</p><ul><li>è¯»å…¥æ—¶é—´åºåˆ—æ•°æ®ï¼ˆåˆ†ä¸ºä»numpyæ•°ç»„å’Œcsvæ–‡ä»¶ä¸¤ç§æ–¹å¼ï¼‰</li><li>ç”¨ARæ¨¡å‹å¯¹æ—¶é—´åºåˆ—è¿›è¡Œé¢„æµ‹</li><li>ç”¨LSTMæ¨¡å‹å¯¹æ—¶é—´åºåˆ—è¿›è¡Œé¢„æµ‹ï¼ˆåŒ…å«å•å˜é‡å’Œå¤šå˜é‡ï¼‰</li></ul><p>å…ˆçœ‹æ•ˆæœå›¾ï¼Œ</p><ol><li>ä½¿ç”¨è‡ªå®šä¹‰LSTMå¾ªç¯ç½‘ç»œå¯¹å•å˜é‡è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹(æ²¡ä½¿ç”¨TFTSï¼Œä»£ç æ¯”è¾ƒç¹ç):</li></ol><div class=pgc-img><img alt=TensorFlowå®æˆ˜ï¼šChapter-7ä¸‹ï¼ˆTFTSåº“ä¸æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153490532779764442c6667><p class=pgc-img-caption></p></div><ol><li><br></li><li>ä½¿ç”¨TFTSä¸‹çš„ARæ¨¡å‹é¢„æµ‹æ•ˆæœå¦‚ä¸‹ï¼Œè“è‰²ä¸ºè®­ç»ƒæ•°æ®ï¼Œç»¿è‰²ä¸ºæ¨¡å‹æ‹Ÿåˆæ•°æ®ï¼Œçº¢è‰²ä¸ºé¢„æµ‹æ•°æ®:</li></ol><div class=pgc-img><img alt=TensorFlowå®æˆ˜ï¼šChapter-7ä¸‹ï¼ˆTFTSåº“ä¸æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1534905340254238b94744c><p class=pgc-img-caption></p></div><ol><li><br></li><li>ä½¿ç”¨TFTSä¸‹çš„LSTMå¯¹å•å˜é‡è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹:</li></ol><div class=pgc-img><img alt=TensorFlowå®æˆ˜ï¼šChapter-7ä¸‹ï¼ˆTFTSåº“ä¸æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/15349053676857b8384ce87><p class=pgc-img-caption></p></div><ol><li><br></li><li>ä½¿ç”¨TFTSä¸‹çš„LSTMå¯¹å¤šå˜é‡è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹:</li></ol><div class=pgc-img><img alt=TensorFlowå®æˆ˜ï¼šChapter-7ä¸‹ï¼ˆTFTSåº“ä¸æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15349053822246c145a2838><p class=pgc-img-caption></p></div><ol><li><br></li></ol><p>è¿™é‡Œæ¶‰åŠåˆ°çš„ä»£ç ä¿å­˜åœ¨github-hzy46.ç½‘é€Ÿä¸å¥½çš„åŒå­¦å¯ä»¥åˆ°æˆ–è€…åœ¨CSDNä¸Šä¸‹è½½ã€‚</p><hr><hr><h1><strong>TensorFlowæ›´æ–°</strong></h1><p><strong>æ³¨æ„</strong></p><p>åé¢ä½¿ç”¨çš„LSTMæ¨¡å‹çš„ä¾‹å­é¡»ä½¿ç”¨TensorFlowæœ€æ–°çš„å¼€å‘ç‰ˆçš„æºç ã€‚å…·ä½“æ¥è¯´ï¼Œè¦ä¿è¯ä¸‹é¢è¿™å¥è¯å¯ä»¥æˆåŠŸæ‰§è¡Œã€‚</p><p>from tensorflow.contrib.timeseries.python.timeseries.estimators import TimeSeriesRegressor</p><ul><li>1</li><li>2</li></ul><p>å¦‚æœæ‰§è¡Œä¸æˆåŠŸï¼Œåˆ™éœ€è¦ä¸‹é¢çš„æ›´æ–°æ“ä½œã€‚</p><p><strong>ä¸‹è½½æœ€æ–°æºç (ç¼–è¯‘æºç æ›´æ–°)</strong></p><p><strong>1. é¦–å…ˆå¸è½½å½“å‰çš„tensorflow</strong></p><p>pip uninstall tensorflow #gpuç‰ˆ å°±æ˜¯tensorflow-gpu</p><ul><li>1</li><li>2</li></ul><p><strong>2. å‚è€ƒå®˜æ–¹çš„ä»æºç å®‰è£…tensorflow</strong></p><p>å‚è€ƒTensorFlowå®˜æ–¹å®‰è£…æ•™ç¨‹ã€‚æˆ‘çš„å¼€å‘ç¯å¢ƒæ˜¯Ubuntu16.04+1080æ˜¾å¡ï¼Œéœ€è¦å®‰è£…gpuç‰ˆæœ¬ã€‚</p><ul><li>ä¿è¯æ˜¾å¡é©±åŠ¨ï¼ŒCUDA8.0,cudnn6.0å®‰è£…æˆåŠŸ</li><li>å®‰è£…bazel bazelå®‰è£…æ•™ç¨‹</li><li>å®‰è£…Pythonä¾èµ–åŒ…</li><li>sudo apt-get install python-numpy python-dev python-pip python-wheel # å¯¹py2</li><li>sudo apt-get install python3-numpy python3-dev python3-pip python3-wheel #å¯¹py3</li><li>1</li><li>2</li><li>ä»githubä¸Šä¸‹è½½æœ€æ–°çš„æºç </li><li>git clone https://github.com/tensorflow/tensorflow</li><li>1</li><li>é…ç½®tensorflowå®‰è£…</li><li>cd tensorflow # cd to the top-level directory created</li><li>$ ./configure</li><li>'''</li><li>é™¤äº†CUDAé¡¹é€‰æ‹©yï¼Œå…¶ä»–éƒ½æ˜¯næˆ–è€…é»˜è®¤é¡¹.</li><li>Configuration finished</li><li>'''</li><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>ç¼–è¯‘æˆpipåŒ…</li></ul><p>'''</p><p>ç¼–è¯‘</p><p>'''</p><p>bazel build --config=opt --config=cuda //tensorflow/tools/pip_package:build_pip_package</p><p>'''</p><p>æŒºé•¿çš„ä¸€æ®µç¼–è¯‘æ—¶é—´</p><p>ç”Ÿäº§pipåŒ…</p><p>'''</p><p>bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg</p><p>'''</p><p>å®‰è£…</p><p>'''</p><p>sudo pip install /tmp/tensorflow_pkg/tensorflow-1.3.0-py2-none-any.whl</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li></ul><p>å¦‚æœå‡ºå•¥é—®é¢˜ï¼Œå»ºè®®ç›´æ¥çœ‹å®˜æ–¹æ•™ç¨‹æ¥æ•´ï¼Œæœ‰å•¥å°é—®é¢˜ï¼Œä¸Šstackoverflowä¸Šæ‰¾æ‰¾åŸå› ã€‚(ä»æºç ç¼–è¯‘tensorflowå‰å‰ååèŠ±è´¹äº†æˆ‘2å¤©çš„æ—¶é—´ï¼Œç°åœ¨æ•´å‡ºæ¥äº†ï¼Œè¸©äº†ä¸å°‘çš„å‘ï¼Œæ„Ÿè§‰ä¸‹æ¬¡ä¼šå¿«å¾ˆå¤šäº†ï½)</p><p>ç°åœ¨9æœˆåˆtensorflowçš„pipå®‰è£…ç‰ˆæœ¬è¿˜ä¸æ”¯æŒè¿™ä¸ªTimeSeriesRegressorç±»ï¼Œç­‰åˆ°åé¢ç‰ˆæœ¬ç¨³å®šæ›´æ–°äº†ï¼Œåº”è¯¥å¯ä»¥ç”¨ä¸‹é¢pipå·¥å…·æ›´æ–°ã€‚</p><p><strong>ç›´æ¥ä½¿ç”¨pipå·¥å…·æ›´æ–°</strong></p><p>å› ä¸ºæœ¬æ¬¡ç”¨åˆ°çš„åº“éœ€è¦è¿è¡Œåœ¨TensorFlow1.3ç‰ˆæœ¬ï¼Œè€Œæˆ‘çš„ç¯å¢ƒæ˜¯Ubuntuä¸‹çš„1.0.1ç‰ˆæœ¬çš„TensorFlowã€‚å¦‚æœä½ ä¸çŸ¥é“è‡ªå·±çš„TensorFlowæ˜¯å•¥ç‰ˆæœ¬ï¼Œæœ‰ä¸€ä¸ªç®€å•çš„æ–¹æ³•:</p><p>æ¿€æ´»pythonç¼–ç¨‹ç¯å¢ƒï¼Œé”®å…¥ä»¥ä¸‹ä»£ç è¿è¡Œå³å¯ã€‚</p><p>import tensorflow as tf</p><p>print(tf.__version__) # æŸ¥çœ‹tensorflowç‰ˆæœ¬</p><p>print(tf.__path__) # æŸ¥çœ‹tensorflowå®‰è£…ä½ç½®</p><p>'''</p><p>è¾“å‡ºï¼š</p><p>1.0.1</p><p>['/root/anaconda2/lib/python2.7/site-packages/tensorflow']</p><p>'''</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li></ul><p>æ›´æ–°æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚æœä½ çš„TensorFlowæ˜¯æ™®é€šçš„å®‰è£…ï¼Œç›´æ¥åœ¨å‘½ä»¤è¡Œé”®å…¥ä»¥ä¸‹å‘½ä»¤:</p><p>$: sudo pip install --upgrade tensorflow-gpu # æˆ‘å®‰è£…çš„æ˜¯gpuç‰ˆ</p><ul><li>1</li></ul><p>ç­‰å¾…æ›´æ–°å®Œæˆå³å¯ã€‚</p><p>import tensorflow as tf</p><p>print(tf.__version__) # æŸ¥çœ‹tensorflowç‰ˆæœ¬</p><p>print(tf.__path__) # æŸ¥çœ‹tensorflowå®‰è£…ä½ç½®</p><p>'''</p><p>è¾“å‡ºï¼š</p><p>1.3.0</p><p>['/root/anaconda2/lib/python2.7/site-packages/tensorflow']</p><p>'''</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li></ul><p><strong>æ›´æ–°åå¯èƒ½ä¼šé‡åˆ°çš„å¼‚å¸¸</strong></p><ul><li>é—®é¢˜æè¿°:</li><li>libcudnn.so.6:cannot open sharedobject file: No such file or directory</li><li>1</li><li>é—®é¢˜åˆ†æ:</li><li>æˆ‘åœ¨å¼€å§‹å®‰è£…1.0.1ç‰ˆæœ¬çš„tensorflowæ—¶ï¼Œé…ç½®çš„æ˜¯CUDA8.0+cudnn-v5.1ã€‚è¿™é‡Œæˆ‘æŠŠtensorflowå‡çº§åˆ°1.3ç‰ˆæœ¬ï¼Œæ–°çš„Tensorflowé€‚é…çš„æ˜¯cudnn-v6.0ã€‚æ•…éœ€è¦å‡çº§cudnnã€‚</li><li>è§£å†³åŠæ³•:</li><li>å‡çº§cudnnçš„æ–¹æ³•å‚è€ƒå®‰è£…CUDNNã€‚</li></ul><ol><li>ä¸‹è½½é€‚é…CUDAç‰ˆæœ¬å’Œç³»ç»Ÿç‰ˆæœ¬çš„cudnn-v6.0</li></ol><ul><li><br></li></ul><ol><li>è§£å‹ä¸‹è½½å¥½çš„cudnn</li><li>$ : sudo tar -zxvf cudnn-8.0-linux-x64-v6.0.tgz</li><li>â€¦</li><li>å°†è§£å‹æ–‡ä»¶æ‹·è´å¹¶ä¿®æ”¹æƒé™</li><li>$ :sudo cp cuda/include/cudnn.h /usr/local/cuda/include/ # copy file</li><li>$ :sudo cp cuda/lib64/libcudnn* /usr/local/cuda/lin64/</li><li>$ :sudo chmod a+r /usr/local/cuda/include/cudnn.h # ä¿®æ”¹æƒé™</li><li>$ :sudo chmod a+r /usr/local/cuda/libcudnn*</li></ol><ul><li>1</li><li>2</li><li>3</li><li>4</li></ul><p>åˆ°è¿™é‡Œï¼Œç®—æ˜¯å¤§åŠŸå‘Šæˆäº†ï½</p><hr><hr><h1><strong>è‡ªå®šä¹‰LSTMå¾ªç¯ç¥ç»ç½‘ç»œè¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹</strong></h1><p>åœ¨ä½¿ç”¨TFTSåº“å‰ï¼Œæˆ‘ä»¬å…ˆåˆ©ç”¨è‡ªå®šä¹‰å¾ªç¯ç¥ç»ç½‘ç»œé¢„æµ‹æ­£å¼¦å‡½æ•°ã€‚åˆæ­¥å­¦ä¹ ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨LSTMå¾ªç¯ç¥ç»ç½‘ç»œè¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹ï¼Œè¿™é‡Œæˆ‘ä»¬ä¼šä½¿ç”¨TensorFlowçš„ä¸€ä¸ªé«˜çº§å°è£…å·¥å…·-TFLearn(é›†æˆåœ¨tf.contrib.learn).</p><p><strong>å·¥ç¨‹å®ç°</strong></p><p><strong>1. éœ€è¦ç”¨åˆ°çš„æ¨¡å—</strong></p><p># coding:utf8</p><p>import numpy as np</p><p>import tensorflow as tf</p><p>from tensorflow.contrib.learn.python.learn.estimators.estimator import SKCompat</p><p>import matplotlib.pyplot as plt</p><p>learn = tf.contrib.learn</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li></ul><p><strong>2. ç”Ÿæˆè®­ç»ƒæ•°æ®ä¸æµ‹è¯•æ•°æ®</strong></p><p>å› ä¸ºæ˜¯è¦é¢„æµ‹æ­£å¼¦å‡½æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨npæ¨¡å—ä¸‹çš„np.sinå‡½æ•°ç”Ÿæˆè®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®ã€‚</p><p>TRAINING_EXAMPLES = 10000 # è®­ç»ƒæ•°æ®å¤§å°</p><p>TESTING_EXAMPLES = 1000 # æµ‹è¯•æ•°æ®å¤§å°</p><p>SAMPLE_GAP = 0.01 #é‡‡æ ·é—´éš”</p><p>TIMESTEPS = 10 # å¾ªç¯ç¥ç»ç½‘ç»œæˆªæ–­é•¿åº¦</p><p>def generate_data(seq):</p><p>'''</p><p>å®šä¹‰ç”Ÿæˆæ­£å¼¦å‡½æ•°æ•°æ®å‡½æ•°</p><p>:param seq:</p><p>:return: Xä¸ºè®­ç»ƒæ•°æ®åºåˆ—,yä¸ºé¢„æµ‹æ•°æ®</p><p>'''</p><p>X = []</p><p>y = []</p><p>for i in range(len(seq) - TIMESTEPS - 1):</p><p>X.append([seq[i: i + TIMESTEPS]]) # æˆªå–ä»¥iä¸‹æ ‡å¼€å§‹çš„ä»¥TIMESTEPSä¸ºbatchçš„æ•°æ®</p><p>y.append([seq[i + TIMESTEPS]]) # é¢„æµ‹i+TIMESTEPSçš„æ•°æ®</p><p>return np.array(X, dtype=np.float32), np.array(y, dtype=np.float32)</p><p># ç”Ÿæˆæ•°æ®</p><p># TRAINING_EXAMPLESè®­ç»ƒæ•°æ®ä¸ªæ•° SAMPLE_GAPé‡‡æ ·é—´éš”</p><p>test_start = TRAINING_EXAMPLES * SAMPLE_GAP</p><p># è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®ä¸ªæ•°</p><p>test_end = (TRAINING_EXAMPLES + TESTING_EXAMPLES) * SAMPLE_GAP</p><p># np.linspaceç”Ÿæˆç­‰å·®æ•°åˆ— å³é‡‡æ ·æ¨ªè½´æ•°æ®</p><p># ä»0åˆ°test_start,ç”ŸæˆTRAINING_EXAMPLESä¸ªæ•°æ®(å³é‡‡æ ·é—´éš”ä¸ºSAMPLE_GAP)</p><p>train_X, train_y = generate_data(np.sin(np.linspace(</p><p>0, test_start, TRAINING_EXAMPLES, dtype=np.float32)))</p><p># np.linspaceç”Ÿæˆç­‰å·®æ•°åˆ—</p><p>#</p><p>test_X, test_y = generate_data(np.sin(np.linspace(</p><p>test_start, test_end, TESTING_EXAMPLES, dtype=np.float32)))</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li><li>31</li><li>32</li><li>33</li><li>34</li><li>35</li><li>36</li><li>37</li></ul><hr><p><strong>æ³¨è§£ï¼š</strong></p><p>è®­ç»ƒæ•°æ®TRAINING_EXAMPLESåŠ ä¸Šæµ‹è¯•æ•°æ®TESTING_EXAMPLESä¸€å…±éœ€è¦11000ç»„ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬è®¾ç½®æ˜¯é‡‡æ ·é—´éš”SAMPLE_GAPæ˜¯0.01ã€‚æ•…æˆ‘ä»¬æ•´ä¸ªé‡‡æ ·è·ç¦»æ˜¯11000*0.01=110.ä¹Ÿå°±æ˜¯åœ¨sinå‡½æ•°ä¸Šï¼Œxè½´ä¸º[0,110]è¿™æ®µè·ç¦»ä¸Šå‡åˆ†ä¸º11000ä»½ã€‚</p><p>è®­ç»ƒæ•°æ®æ˜¯ä»¥ç½‘ç»œçš„æˆªæ–­é•¿åº¦ä¸ºåˆ†å‰²é—´è·ã€‚è¿™é‡Œå¾ªç¯ç¥ç»ç½‘ç»œçš„æˆªæ–­é•¿åº¦TIMESTEPSä¸º10ã€‚æ•…æˆ‘ä»¬çš„æ•°æ®ä¹Ÿæ˜¯10ä¸ªé‡‡æ ·ç‚¹å’Œå¯¹åº”çš„sinå€¼ä¸ºä¸€ç»„ï¼Œé¢„æµ‹ç¬¬11ä¸ªç‚¹ã€‚(è®­ç»ƒæ—¶å€™å°±æ˜¯å›å½’ç¬¬11ä¸ªç‚¹çš„å€¼).</p><ul><li>å…ˆä½¿ç”¨np.linspaceå‡½æ•°å–å‡ºç­‰å·®é—´éš”çš„é‡‡æ ·ç‚¹</li><li>å†ä½¿ç”¨np.sinå‡½æ•°è·å¾—å¯¹åº”çš„sinå€¼ã€‚</li><li>åœ¨ç”Ÿæˆæ•°æ®generate_dataæ—¶ï¼Œä»¥TIMESTEPSæˆªæ–­æ•°æ®åˆ°Xå†…ï¼Œå°†TIMESTEPS+1ä¸ªæ•°æ®æ”¾åˆ°å¯¹åº”çš„æ ‡ç­¾yå†…ã€‚</li></ul><p>ä¸‹é¢æ˜¯np.linspaceå’Œnp.sinçš„ç”¨æ³•ç¤ºä¾‹ï¼š</p><div class=pgc-img><img alt=TensorFlowå®æˆ˜ï¼šChapter-7ä¸‹ï¼ˆTFTSåº“ä¸æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1534905400997ddbd9982c2><p class=pgc-img-caption></p></div><hr><p><strong>3. å®šä¹‰ç½‘ç»œæ¨¡å‹</strong></p><p>æˆ‘ä»¬ä½¿ç”¨BasicLSTMCellå’ŒMultiRNNCellæ„æˆä¸€ä¸ªhidden_sizeä¸º30çš„2å±‚çš„LSTMå¾ªç¯ç¥ç»ç½‘ç»œã€‚éœ€è¦æ³¨æ„çš„æ˜¯<strong>ä¸åŒç‰ˆæœ¬ä¸‹åœ¨åˆ›å»ºLSTMCellsçš„æ–¹æ³•æ˜¯ä¸ä¸€æ ·çš„ã€‚</strong></p><p>HIDDEN_SIZE = 30 # éšè—å•å…ƒä¸ªæ•°</p><p>NUM_LAYERS = 2 #LSTMå±‚æ•°</p><p>TRAINING_STEPS = 3000 # è®­ç»ƒæ•°æ®è½®æ•°</p><p>BATCH_SIZE = 32 # batchå¤§å°</p><p>def lstm_model(X, y):</p><p>'''</p><p>å®šä¹‰LSTMæ¨¡å‹</p><p>:param X: è®­ç»ƒæ•°æ®</p><p>:param y: é¢„æµ‹æ ‡ç­¾</p><p>:return:</p><p>'''</p><p># 1.2ç‰ˆæœ¬å,tensorflowå¯¹ä½¿ç”¨BasicLSTMCellç­‰ RNNCellsç”Ÿæˆcellsæœ‰ä¸åŒçš„å¤„ç†æ–¹æ³•ï¼Œè¿™é‡Œå¤šå±‚çš„RNNå»ºè®®é‡‡ç”¨è¿™ç§åˆ›å»ºcellæ–¹æ³•</p><p>stacked_rnn = []</p><p>for iiLyr in range(NUM_LAYERS):</p><p>stacked_rnn.append(tf.nn.rnn_cell.BasicLSTMCell(HIDDEN_SIZE, state_is_tuple=True))</p><p>cell = tf.nn.rnn_cell.MultiRNNCell(cells=stacked_rnn, state_is_tuple=True)</p><p>#lstm_cell = tf.contrib.rnn.BasicLSTMCell(HIDDEN_SIZE, state_is_tuple=True) #1.2ç‰ˆæœ¬å‰</p><p>#cell = tf.contrib.rnn.MultiRNNCell([lstm_cell] * NUM_LAYERS)</p><p># å°†å¤šå±‚LSTMç»“æ„è¿æ¥æˆRNNç½‘ç»œå¹¶è®¡ç®—å…¶å‰å‘ä¼ æ’­ç»“æœ</p><p>output, _ = tf.nn.dynamic_rnn(cell, X, dtype=tf.float32)</p><p># åªå…³æ³¨ç½‘ç»œçš„æœ€åä¸€ä¸ªè¾“å‡ºç»“æœ,å³ä¸ºä¸‹ä¸€æ—¶åˆ»çš„é¢„æµ‹è¾“å‡º</p><p>output = tf.reshape(output, [-1, HIDDEN_SIZE])</p><p># é€šè¿‡æ— æ¿€æ´»å‡½æ•°çš„å…¨è”æ¥å±‚è®¡ç®—çº¿æ€§å›å½’ï¼Œå¹¶å°†æ•°æ®å‹ç¼©æˆä¸€ç»´æ•°ç»„çš„ç»“æ„ã€‚</p><p>predictions = tf.contrib.layers.fully_connected(output, 1, None)</p><p>labels = tf.reshape(y, [-1])</p><p>predictions = tf.reshape(predictions, [-1])</p><p># å®šä¹‰å¹³æ–¹å·®æŸå¤±</p><p>loss = tf.losses.mean_squared_error(predictions, labels)</p><p># åˆ›å»ºæ¨¡å‹ä¼˜åŒ–å™¨å¹¶å¾—åˆ°ä¼˜åŒ–æ­¥éª¤</p><p>train_op = tf.contrib.layers.optimize_loss(</p><p>loss, tf.contrib.framework.get_global_step(),</p><p>optimizer="Adagrad", learning_rate=0.1)</p><p>return predictions, loss, train_op</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li><li>31</li><li>32</li><li>33</li><li>34</li><li>35</li><li>36</li><li>37</li><li>38</li><li>39</li><li>40</li></ul><p><strong>4. åˆ›å»ºæ¨¡å‹å¹¶è®­ç»ƒ</strong></p><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†tf.contrib.learnä¸‹çš„ä¸€ä¸ª<strong>å°è£…æ¨¡å‹å·¥å…·Estimator</strong>ã€‚ä½¿ç”¨Estimatorå°è£…å¥½ä¸€ä¸ªé¢„æµ‹æ¨¡å‹å((å·²è®­ç»ƒ)ï¼Œæˆ‘ä»¬å¯¹æµ‹è¯•æ•°æ®è¿›è¡Œäº†é¢„æµ‹ï¼Œå†è®¡ç®—äº†ä¸‹å‡æ–¹è¯¯å·®ï¼Œå¤§ä½“ä¸Šçš„è¯„ä¼°äº†ä¸€ä¸‹æ¨¡å‹çš„é¢„æµ‹æ€§èƒ½ã€‚</p><p># å°è£…ä¹‹å‰å®šä¹‰çš„lstm</p><p># å¦‚æœä½ çš„tensorflow1.2ç‰ˆæœ¬å‰å·²ç»è®­ç»ƒå¥½äº†è¿™æ ·çš„çš„ä¸€ä¸ªæ¨¡å‹ï¼Œåœ¨tensorflowæ›´æ–°åï¼Œé‡æ–°ç”Ÿæˆæ¨¡å‹ã€‚</p><p># å› ä¸ºåœ¨æ–°ç‰ˆæœ¬çš„Tensorflowé‡Œï¼ŒLSTMå•å…ƒçš„æ–‡ä»¶æ”¹å˜äº†ï¼Œè¿™é‡Œæˆ‘ä»¬ç®€å•çš„æŠŠä»¥å‰çš„model_dirä¿®æ”¹äº†ï¼Œä¿è¯åˆ›å»ºäº†æ–°çš„æ¨¡å‹</p><p>regressor = SKCompat(learn.Estimator(model_fn=lstm_model, model_dir="Models/model_3"))</p><p># æ‹Ÿåˆæ•°æ®</p><p>regressor.fit(train_X, train_y, batch_size=BATCH_SIZE, steps=TRAINING_STEPS)</p><p># è®¡ç®—é¢„æµ‹å€¼</p><p>predicted = [[pred] for pred in regressor.predict(test_X)]</p><p># è®¡ç®—MSE</p><p>rmse = np.sqrt(((predicted - test_y) ** 2).mean(axis=0))</p><p>print ("Mean Square Error is: %f" % rmse[0])</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li></ul><hr><p><strong>Estimatorå·¥å…·</strong></p><p>è¿™é‡Œæˆ‘ä»¬ç®€å•çš„ä»‹ç»ä»¥ä¸‹Estimatorå·¥å…·ã€‚</p><p>å‚è€ƒTensorFlow 0.12 Estimators Models Layerså­¦ä¹ ç¬”è®°ã€‚Estimatorsçš„ä½œç”¨æ˜¯:</p><ul><li>tf.estimator frameworkç”¨äºå¿«é€Ÿæ„å»ºå’Œè®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹ï¼ŒåŒæ—¶Estimatoræä¾›äº†ä¸€äº›å¸¸è§çš„æ¨¡å‹(å¸¸è§çš„å›å½’å’Œåˆ†ç±»æ¨¡å‹ï¼Œä¾‹å¦‚:çº¿æ€§åˆ†ç±»ï¼Œçº¿æ€§å›å½’ç­‰)</li><li>tf.estimatorä¸ºmonitors,checkpointingæä¾›äº†åˆå§‹åŒ–é…ç½®ï¼ŒåŒæ—¶æä¾›äº†æ„å»ºå’Œè¯„ä¼°è‡ªå®šä¹‰æ¨¡å‹çš„å¤§éƒ¨åˆ†é€»è¾‘ã€‚ä¾ç…§ç€tutorialå¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆ›å»ºä¸€ä¸ªestimator.TensorFlowå…³äºEstimatorä»‹ç»</li></ul><p>æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºtf.estimatorå·¥å…·æ˜¯ç”¨æ¥æä¾›ä¸€ä¸ªè‡ªå®šä¹‰æ¨¡å‹çš„æ¡†æ¶ï¼Œæˆ‘ä»¬ç…§ç€å®šä¹‰å¥½çš„æ ¼å¼é…ç½®å¥½è¾“å…¥å³å¯ã€‚</p><ol><li><strong>åˆ›å»ºä¸€ä¸ªEstimator</strong></li></ol><ul><li>å…ˆçœ‹æ„é€ å™¨å®šä¹‰:</li><li>init(model_fn=None, model_dir=None, config=None, params=None, feature_engineering_fn=None)</li><li>'''</li><li>Args:</li><li>model_fn: æ¨¡å‹å®šä¹‰ï¼Œå®šä¹‰äº†train, eval, predictçš„å®ç°</li><li>model_dir: logæ–‡ä»¶å’Œè®­ç»ƒå‚æ•°çš„ä¿å­˜ç›®å½•</li><li>config: Configuration object</li><li>params: dict of hyper parameters that will be passed into model_fn. Keys are names of parameters, values are basic python types.</li><li>feature_engineering_fn: Feature engineering function. Takes features and labels which are the output of input_fn and returns features and labels which will be fed into model_fn. Please check model_fn for a definition of features and labels.</li><li>'''</li><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li><strong>tf.estimatorå¸¸æ¥æ”¶2ä¸ªå‚æ•°:model_fnå’Œmodel_dir.æ³¨æ„åˆ°æˆ‘ä»¬ä½¿ç”¨çš„.</strong></li><li>learn.Estimator(model_fn=lstm_model, model_dir="Models/model_3") # model_fnå’Œmodel_dirå‚æ•°</li><li>1</li><li><strong>è¿™é‡Œéœ€è¦æ³¨æ„model_fn:</strong></li></ul><ol><li>model_fn(features, labels, mode, params)</li><li>'''</li><li>features: Tensor or dict of Tensor's. å³æ ·æœ¬æ•°æ®x.</li><li>labels: Tensor or dict of Tensor's. æ ·æœ¬æ•°æ®y.(æ”¯æŒæ— æ ‡ç­¾è®­ç»ƒï¼Œè°ƒæ•´å¯¹åº”çš„modeå³å¯)</li><li>mode: æŒ‡å®šmodel_fnåŠŸèƒ½.</li><li>params: params is a dict of hyperparameters</li><li>'''</li></ol><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li></ul><ol><li><strong>è®­ç»ƒæ¨¡å‹</strong></li><li>å°†æˆ‘ä»¬çš„è®­ç»ƒæ•°æ®å¡ç»™fitï¼Œè®­ç»ƒå®Œæˆåï¼Œå°±ä¼šæŒ‰ç…§å‰é¢æŒ‡å®šçš„model_dirå­˜æ”¾è®­ç»ƒå¥½çš„æ¨¡å‹.</li><li>fit(x=None, y=None, input_fn=None, steps=None, batch_size=None, monitors=None, max_steps=None)</li><li>'''</li><li>x: è®­ç»ƒæ•°æ®x. æ ¼å¼ä¸º[n_samples,n_features...],å¦‚æœè®¾ç½®æ­¤å‚æ•°ï¼Œinput_fnéœ€ä¸ºNone.</li><li>y: è®­ç»ƒæ•°æ®yã€‚xå¯¹åº”çš„æ ‡ç­¾ã€‚</li><li>steps: æ¯æ¬¡è®­ç»ƒops.</li><li>batch_size: minibatch size.</li><li>moitors: Used for callbacks inside the training loop.</li><li>max_steps: Number of total steps for which to train model.</li><li>input_fn: è¯´ç™½äº†å°±æ˜¯æŠŠxï¼Œyï¼Œbatch_sizeåŒ…è£…ä¸€ä¸‹ã€‚ ç”¨è¿™ä¸ªå°±ä¸ç”¨è®¾ç½®x,y,batch_sizeäº†.</li><li>'''</li></ol><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li></ul><ol><li><strong>é¢„æµ‹</strong></li><li>å°†éœ€è¦é¢„æµ‹çš„æ•°æ®å¡ç»™predictï¼Œè¿”å›çš„å°±æ˜¯é¢„æµ‹å€¼.</li><li>predict(x=None, input_fn=None, batch_size=None, outputs=None, as_iterable=True)</li><li>'''</li><li>x : ä¸ºéœ€è¦é¢„æµ‹çš„æ•°æ®ã€‚</li><li>batch_size: minibatch size.</li><li>input_fn: å¯¹xå’Œbatch_sizeçš„åŒ…è£…</li><li>outputs: list of str, name of the output to predict. If None, returns all</li><li>as_iterable: If True, return an iterable which keeps yielding predictions for each example until inputs are exhausted. Note: The inputs must terminate if you want the iterable to terminate (e.g. be sure to pass num_epochs=1 if you are using something like read_batch_features).</li><li>'''</li></ol><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li></ul><ol><li><strong>æ³¨æ„</strong></li><li><strong>å‰é¢æˆ‘è¯´äº†å¦‚æœåœ¨è¾“å…¥çš„æ—¶å€™è®¾ç½®x,y,batch_sizeå°±ä¸è¦è®¾ç½®input_fnï¼Œéœ€è¦æ³¨æ„çš„æ˜¯:ï¼Œå¦‚æœä½¿ç”¨x,yè€Œä¸æ˜¯input_fnæ¥ä¼ å‚æ•°çš„å½¢å¼ï¼Œéœ€è¦ç”¨Estimatoré‡Œä¸€ä¸ªå«SKCompatçš„ç±»åŒ…è£…ä¸€ä¸‹</strong>.</li><li>estimator_instance = SKCompat(Estimator(model_fn=..., model_dir=...))</li></ol><ul><li>1</li><li>2</li></ul><ol><li>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¯¹TensorFlowå†…çš„Estimatorå·¥å…·ä»‹ç»å°±ç®—ç»“æŸäº†ï½</li></ol><hr><p><strong>5. ç»˜å›¾</strong></p><p>ä½¿ç”¨pltå°†é¢„æµ‹æ•°æ®å’Œæµ‹è¯•æ•°æ®ç»˜åˆ¶å‡ºæ¥ï¼Œæœ‰ä¸€ä¸ªç›´è§‚ä¸Šçš„è®¤è¯†ã€‚</p><p>fig = plt.figure()</p><p>plot_predicted, = plt.plot(predicted, label='predicted')</p><p>plot_test, = plt.plot(test_y[0:399], label='real_sin')</p><p>plt.legend([plot_predicted, plot_test],['predicted', 'real_sin'])</p><p>plt.show()</p><p>fig.savefig('pre_sin.png')</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li></ul><div class=pgc-img><img alt=TensorFlowå®æˆ˜ï¼šChapter-7ä¸‹ï¼ˆTFTSåº“ä¸æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1534905420970d8901ff26f><p class=pgc-img-caption></p></div><hr><hr><h1><strong>åˆ©ç”¨TFTSè¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹</strong></h1><p>åˆ°è¿™é‡Œç®—æ˜¯åˆ‡å…¥ä¸»é¢˜äº†ï¼Œä¸‹é¢ä»‹ç»å¦‚ä½•ä½¿ç”¨TFTSæ¨¡å—è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹ã€‚</p><p><strong>è½½å…¥æ•°æ®éƒ¨åˆ†</strong></p><p>å¯¹äºæ—¶é—´åºåˆ—é¢„æµ‹é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ<strong>æ•°æ®æŠ½è±¡æˆ:{è§‚å¯Ÿç‚¹:è§‚å¯Ÿå€¼}</strong>ã€‚ä¾‹å¦‚æŸå¹´ä¸€æœˆçš„ä»·æ ¼ä¸º120å…ƒï¼ŒäºŒæœˆçš„ä»·æ ¼ä¸º130å…ƒï¼Œä¸‰æœˆçš„ä»·æ ¼ä¸º135å…ƒï¼Œå››æœˆçš„ä»·æ ¼ä¸º132å…ƒã€‚é‚£ä¹ˆè§‚å¯Ÿçš„æ—¶é—´ç‚¹å¯ä»¥çœ‹åšæ˜¯1,2,3,4ï¼Œè€Œåœ¨å„æ—¶é—´ç‚¹ä¸Šè§‚å¯Ÿåˆ°çš„æ•°æ®çš„å€¼ä¸º120,130,135,132ã€‚</p><p>TFTSåº“æä¾›äº†ä¸¤ä¸ªæ•°æ®è¯»å–å™¨NumpyReaderå’ŒCSVReader.</p><p>NumpyReaderç”¨äºä»Numpyæ•°ç»„ä¸­è¯»å…¥æ•°æ®ï¼Œä¸‹é¢ä¸¾ä¸€ä¸ªdemo:</p><p>import numpy as np</p><p>import matplotlib.pyplot as plt</p><p>x = np.array(range(1000))</p><p>noise = np.random.uniform(-0.2, 0.2, 1000) # éšæœºç”Ÿæˆ-0.2~0.2ä¹‹é—´çš„æ•°æ®</p><p>y = np.sin(np.pi * x * 0.01) + x * 0.005 + noise # y=sin(0.01*pi*x) + 0.005*x + noise</p><p>p = plt.plot(x, y)</p><p>plt.show()</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li></ul><div class=pgc-img><img alt=TensorFlowå®æˆ˜ï¼šChapter-7ä¸‹ï¼ˆTFTSåº“ä¸æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15349054358039a9e76c444><p class=pgc-img-caption></p></div><p>æ¨ªè½´å³â€™é‡‡æ ·ç‚¹xâ€™,çºµè½´ä¸ºâ€™é‡‡æ ·å€¼yâ€™.</p><p>TFTSæä¾›çš„è¯»å…¥xå’Œyçš„æ¥å£éå¸¸ç®€å•ï¼Œä½¿ç”¨demoå¦‚ä¸‹:</p><p>data = {</p><p>tf.contrib.timeseries.TrainEvalFeatures.TIMES: x,</p><p>tf.contrib.timeseries.TrainEvalFeatures.VALUES: y,</p><p>}</p><p>reader = NumpyReader(data)</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li></ul><p>æˆ‘ä»¬é¦–å…ˆæŠŠxå’Œyè½¬ä¸ºPythonä¸­çš„dict.æˆ‘ä»¬æ¥åˆ†æä»¥ä¸‹ä¸Šé¢dataçš„å†™æ³•ã€‚tf.contrib.timeseries.TrainEvalFeatures.TIMESå°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²â€™timesâ€™ï¼Œè€Œå¯¹åº”tf.contrib.timeseries.TrainEvalFeatures.VALUESä¹Ÿæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²â€™valuesâ€™.ä¸Šé¢çš„dataå®šä¹‰ä¹Ÿå¯ä»¥å†™æˆ:</p><p>data = {</p><p>'times' : x,</p><p>'values': y,</p><p>}</p><ul><li>1</li><li>2</li><li>3</li><li>4</li></ul><p>è‡³äºä¸ºä»€ä¹ˆå†™æˆä¸Šé¢çš„é‚£ä¸ªå½¢å¼ï¼Œä¹Ÿæ˜¯ä¸ºäº†é…åˆè§„èŒƒåŒ–ã€‚</p><p>NumpyReaderè¿”å›çš„å¯¹è±¡æœ‰ä¸€ä¸ª<strong>read_full()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç”¨äºä»Readerä¸­è¯»å–æ‰€æœ‰çš„æ•°æ®</strong>ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯:<strong>read_full()ä¼šäº§ç”Ÿè¯»å–é˜Ÿåˆ—</strong>(è¿™æ ·çš„å¤„ç†è®­ç»ƒæ•°æ®çš„æ–¹æ³•å’ŒTensorFlowå¼€æºçš„AlexNetç½‘ç»œä¸Šå¯¹è¾“å…¥æ•°æ®åšå¢å¼ºæ“ä½œä½¿ç”¨çš„æ–¹æ³•ç±»ä¼¼)ï¼Œè¿™è¦æ±‚æˆ‘ä»¬åœ¨ä½¿ç”¨è¯¥æ–¹æ³•å‰ï¼Œéœ€è¦<strong>å…ˆè°ƒç”¨tf.train.start_queue_runnerså¯åŠ¨é˜Ÿåˆ—</strong>ï¼Œç„¶åæ‰èƒ½è¯»å–æ•°æ®ã€‚ä½¿ç”¨çš„demoå¦‚ä¸‹:</p><p>with tf.Session() as sess:</p><p>full_data = reader.read_full()</p><p>coord = tf.train.Coordinator() # åˆ›å»ºä¸€ä¸ªçº¿ç¨‹åè°ƒå™¨</p><p>threads = tf.train.start_queue_runners(sess=sess, coord=coord) # å¯åŠ¨çº¿ç¨‹é˜Ÿåˆ—</p><p>print('times shape:', full_data['times'])</p><p>print('values shape:', full_data['values'])</p><p>print(sess.run(full_data)['times'][0:10])</p><p>print(sess.run(full_data)['values'][0:10])</p><p>coord.request_stop()</p><p>'''</p><p>è¾“å‡º:</p><p>times shape: Tensor("Squeeze_1:0", shape=(1000,), dtype=int64)</p><p>values shape: Tensor("Squeeze:0", shape=(1000, 1), dtype=float64)</p><p>[0 1 2 3 4 5 6 7 8 9]</p><p>[[-0.09581681]</p><p>[ 0.01284531]</p><p>[ 0.1107236 ]</p><p>[ 0.08856841]</p><p>[ 0.19104294]</p><p>[ 0.32795446]</p><p>[ 0.17780316]</p><p>[ 0.35017529]</p><p>[ 0.10477021]</p><p>[ 0.16101822]]</p><p>'''</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li><li>28</li><li>29</li></ul><p>é€šå¸¸åœ¨è®­ç»ƒæ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬é‡‡éœ€è¦çš„æ˜¯<strong>minibatchå½¢å¼çš„è®­ç»ƒæ•°æ®</strong>ï¼ŒTFTSåº“æä¾›äº†<strong>tf.contrib.timeseries.RandomWindowInputFn</strong>æ–¹æ³•ç”¨äºåœ¨readerä¸­éšæœºé€‰å–window_sizeå¤§å°çš„æ•°æ®ç»„æˆä¸€ç»„åºåˆ—æ•°æ®ã€‚demoå¦‚ä¸‹:</p><p>train_input_fn = tf.contrib.timeseries.RandomWindowInputFn(</p><p>reader, batch_size=2, window_size=10)</p><p>with tf.Session() as sess:</p><p>batch_data = train_input_fn.create_batch()</p><p>coord = tf.train.Coordinator()</p><p>threads = tf.train.start_queue_runners(sess=sess, coord=coord)</p><p>one_batch = sess.run(batch_data[0])</p><p>coord.request_stop()</p><p>print('one_batch_data:', one_batch)</p><p>'''</p><p>å³ä¸€ä¸ªbatchä¸º2ç»„åºåˆ—æ•°æ®ï¼Œæ¯ç»„åºåˆ—æ•°æ®æœ‰10æ¡æ•°æ®ã€‚</p><p>è¾“å‡º:</p><p>one_batch_data: {</p><p>'values': array([[[ 1.21827106],</p><p>[ 1.37975747],</p><p>[ 1.15419451],</p><p>[ 1.07579377],</p><p>[ 1.19008057],</p><p>[ 1.32173953],</p><p>[ 1.2152622 ],</p><p>[ 1.31092923],</p><p>[ 1.26184174],</p><p>[ 1.25915473]],</p><p>[[ 0.08465949],</p><p>[-0.0859257 ],</p><p>[-0.02987006],</p><p>[ 0.17472125],</p><p>[ 0.23542243],</p><p>[ 0.2032668 ],</p><p>[ 0.07650485],</p><p>[ 0.20822309],</p><p>[ 0.30753332],</p><p>[ 0.16054565]]]),</p><p>'times': array([[61, 62, 63, 64, 65, 66, 67, 68, 69, 70],</p><p>[ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]])}</p><p>'''</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li><li>31</li><li>32</li><li>33</li><li>34</li><li>35</li><li>36</li><li>37</li><li>38</li><li>39</li><li>40</li><li>41</li></ul><p>TFTSä»Numpyä¸­è¯»å–æ•°æ®çš„æµç¨‹å¤§æ¦‚æ“ä½œå°±æ˜¯è¿™æ ·äº†ï½</p><hr><p><strong>ä»CSVæ–‡ä»¶ä¸­è¯»å…¥æ—¶é—´åºåˆ—æ•°æ®</strong></p><p>TFTSè¿˜æä¾›äº†CSVReaderç”¨äºè¯»å–CSVæ–‡ä»¶ã€‚</p><p>é¡¹ç›®ä¸­æä¾›äº†ä¸€ä¸ªinput_input_csv.pyæ–‡ä»¶ç”¨äºå¤„ç†csvæ–‡ä»¶ï¼Œè¿™é‡Œå¤„ç†çš„æ–‡ä»¶æ˜¯â€™./data/period_trend.csvâ€™.</p><p>è¿™é‡ŒCSVçš„æ–‡ä»¶å½¢å¼å¦‚ä¸‹(æˆªå–):</p><p>1,-0.6656603714</p><p>2,-0.1164380359</p><p>3,0.7398626488</p><p>4,0.7368633029</p><p>5,0.2289480898</p><p>6,2.257073255</p><p>7,3.023457405</p><p>8,2.481161007</p><p>9,3.773638612</p><p>10,5.059257738</p><p>11,3.553186083</p><p>12,4.554486452</p><p>13,3.655475698</p><p>14,3.419647598</p><p>15,4.303376245</p><p>16,4.830153934</p><p>17,7.253057441</p><p>18,5.064802335</p><p>19,5.448082106</p><p>20,6.251301517</p><p>...</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li></ul><p>CSVçš„ç¬¬ä¸€åˆ—æ•°æ®ä¸ºæ—¶é—´ç‚¹ï¼Œç¬¬äºŒåˆ—æ•°æ®ä¸ºå¯¹åº”çš„è§‚å¯Ÿå€¼ã€‚</p><p>CSVReaderçš„æ“ä½œæ­¥éª¤é™¤äº†è¯»å–æ–‡ä»¶çš„éƒ¨åˆ†ä¸åŒï¼Œåé¢çš„æ“ä½œå’Œå‰é¢çš„NumpyReaderæ˜¯ä¸€æ ·çš„ã€‚æ“ä½œçš„demoå¦‚ä¸‹:</p><p>from __future__ import print_function</p><p>import tensorflow as tf</p><p>csv_file_name = './data/period_trend.csv'</p><p>reader = tf.contrib.timeseries.CSVReader(csv_file_name)</p><p>with tf.Session() as sess:</p><p>data = reader.read_full()</p><p>coord = tf.train.Coordinator()</p><p>threads = tf.train.start_queue_runners(sess=sess, coord=coord)</p><p>print(sess.run(data))</p><p>coord.request_stop()</p><p>train_input_fn = tf.contrib.timeseries.RandomWindowInputFn(reader, batch_size=4, window_size=16)</p><p>with tf.Session() as sess:</p><p>data = train_input_fn.create_batch()</p><p>coord = tf.train.Coordinator()</p><p>threads = tf.train.start_queue_runners(sess=sess, coord=coord)</p><p>batch1 = sess.run(data[0])</p><p>batch2 = sess.run(data[0])</p><p>coord.request_stop()</p><p>print('batch1:', batch1)</p><p>print('batch2:', batch2)</p><p>'''</p><p>è¾“å‡º:</p><p>{'values': array([[ -0.66566038],</p><p>[ -0.11643804],</p><p>[ 0.73986262],</p><p>[ 0.73686332],</p><p>[ 0.22894809],</p><p>[ 2.25707316],</p><p>[ 3.02345729],</p><p>...</p><p>dtype=float32), 'times': array([ 1, 2, 3, 4, 5, 6, ...ï¼Œ500])}</p><p>batch1: {'values': array([[[ 9.75562382],</p><p>[ 9.1494894 ],</p><p>[ 8.94796562],</p><p>[ 9.1767683 ],dtype=float32), 'times': array([[ 98, 99ï¼Œ...,129]])}</p><p>batch2: {'values': array([[[ 4.97288084],</p><p>[ 5.21278238],...ï¼Œdtype=float32), 'times': array([[ 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94,</p><p>95, 96, 97],...ï¼Œ226]])}</p><p>'''</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li><li>31</li><li>32</li><li>33</li><li>34</li><li>35</li><li>36</li><li>37</li><li>38</li><li>39</li><li>40</li><li>41</li><li>42</li><li>43</li><li>44</li><li>45</li><li>46</li><li>47</li></ul><p>åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œè½½å…¥æ•°æ®éƒ¨åˆ†åˆ°è¿™é‡Œå°±ç®—ç»“æŸäº†ã€‚</p><hr><p><strong>ä½¿ç”¨ARæ¨¡å‹é¢„æµ‹æ—¶é—´åºåˆ—</strong></p><p>ARæ¨¡å‹æ˜¯ä¸€ç§çº¿æ€§é¢„æµ‹ï¼Œå³å·²çŸ¥Nä¸ªæ•°æ®ï¼Œå¯ç”±æ¨¡å‹æ¨å‡ºç¬¬Nç‚¹å‰é¢æˆ–åé¢çš„æ•°æ®ï¼ˆè®¾æ¨å‡ºPç‚¹ï¼‰ï¼Œæ‰€ä»¥å…¶æœ¬è´¨ç±»ä¼¼äºæ’å€¼ï¼Œå…¶ç›®çš„éƒ½æ˜¯ä¸ºäº†å¢åŠ æœ‰æ•ˆæ•°æ®ï¼Œåªæ˜¯ARæ¨¡å‹æ˜¯ç”±Nç‚¹é€’æ¨ï¼Œè€Œæ’å€¼æ˜¯ç”±ä¸¤ç‚¹ï¼ˆæˆ–å°‘æ•°å‡ ç‚¹ï¼‰å»æ¨å¯¼å¤šç‚¹ï¼Œæ‰€ä»¥ARæ¨¡å‹è¦æ¯”æ’å€¼æ–¹æ³•æ•ˆæœæ›´å¥½ã€‚</p><p><strong>ä»£ç å®ç°</strong></p><p><strong>äº§ç”Ÿæ•°æ®</strong></p><p>äº§ç”Ÿæ•°æ®çš„æ–¹æ³•å°±æ˜¯ä¸Šé¢ä»‹ç»çš„æ–¹æ³•ã€‚</p><p>x = np.array(range(1000))</p><p>noise = np.random.uniform(-0.2, 0.2, 1000)</p><p>y = np.sin(np.pi * x / 100) + x / 200. + noise</p><p>plt.plot(x, y)</p><p>plt.savefig('timeseries_y.jpg')</p><p>data = {</p><p>tf.contrib.timeseries.TrainEvalFeatures.TIMES: x,</p><p>tf.contrib.timeseries.TrainEvalFeatures.VALUES: y,</p><p>}</p><p>reader = NumpyReader(data)</p><p>train_input_fn = tf.contrib.timeseries.RandomWindowInputFn(</p><p>reader, batch_size=16, window_size=40)</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li></ul><p><strong>åˆ›å»ºaræ¨¡å‹</strong></p><p>åˆ›å»ºaræ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨tf.contrib.timeseries.ARRegressorç±»</p><hr><p>å…ˆçœ‹ä¸‹ARRegressorç±»</p><p>class ARRegressor(_TimeSeriesRegressor):</p><p>"""</p><p>ARRegressoræ˜¯åŸºäºæ»‘çª—æ¨¡å‹çš„ã€‚è¿™è¦æ±‚è¾“å…¥çª—å£å¤§å°è¦å›ºå®šä¸º'input_window_size'ï¼Œè¾“å‡ºçª—å£å¤§å°å›ºå®šä¸º'output_window_size'. åŒæ—¶è¿™ä¸¤ä¸ªå‚æ•°çš„å’Œå¿…é¡»ç­‰äºwindow_size(æ»¡è¶³è®­ç»ƒæˆ–è¯„ä¼°æ—¶ä½¿ç”¨çš„input_fn)ã€‚å»ºè®®ä½¿ç”¨'RandomWindowInputFn'(å°±æ˜¯ä¸Šé¢è®²çš„éšæœºäº§ç”Ÿbatchæ•°æ®çš„å‡½æ•°)äº§ç”Ÿè®­ç»ƒæˆ–è€…è¯„ä¼°ã€‚</p><p>"""</p><p>def __init__(self,</p><p>periodicities, input_window_size,</p><p>output_window_size, num_features, num_time_buckets=10,</p><p>loss=ar_model.ARModel.NORMAL_LIKELIHOOD_LOSS,</p><p>hidden_layer_sizes=None, anomaly_prior_probability=None,</p><p>anomaly_distribution=None, optimizer=None,</p><p>model_dir=None, config=None):</p><p>"""</p><p>å‚æ•°:</p><p>periodicities: value or a list of values. è¾“å…¥ä¿¡å·çš„å‘¨æœŸã€‚</p><p>input_window_size: å›å½’æ—¶ç»™å®šçš„è¾“å…¥æ•°æ®æ—¶é—´æ­¥æ•°.</p><p>output_window_size: é¢„æµ‹æ—¶é—´æ­¥æ•°ï¼Œå»ºè®®è®¾ç½®>1.</p><p>num_features: æ—¶é—´åºåˆ—çš„ç»´åº¦.(æ•°æ®çš„è§‚å¯Ÿå€¼)</p><p>loss: SQUARED_LOSS æˆ–è€… NORMAL_LIKELIHOOD_LOSS.</p><p>hidden_layer_sizes: é»˜è®¤å³å¯.</p><p>anomaly_distributionï¼›anomaly_distribution: é»˜è®¤å³å¯ï¼ŒæŒ‡å®šå³æ„æˆæ··åˆæ¨¡å‹</p><p>optimizer: defaults to Adagrad with step size 0.1.</p><p>model_dir:æ¨¡å‹å­˜å‚¨åœ°å€.(ä¸Šé¢Estimatoræœ‰è®²)</p><p>config: See `Estimator`.</p><p>"""</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li></ul><p>æ€»çš„æ¥è¯´ï¼Œéœ€è¦å¡«çš„å‚æ•°æœ‰periodicities,input_window_size,output_window_size,num_features,lossã€‚å…¶å®ƒçš„å‚æ•°é»˜è®¤å³å¯ã€‚</p><hr><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æœ‰<strong>input_window_size + output_window_size = window_size</strong>.(RandomWindowInputFnç”Ÿæˆæ•°æ®é‡Œé¢çš„window_size).æˆ‘ä»¬åœ¨ä¸Šé¢çš„ç”Ÿæˆæ•°æ®ä½¿ç”¨çš„window_size=40.ä¸‹é¢ä½¿ç”¨çš„æ˜¯input_window_size=30, output_window_size=10.å°±æ˜¯è¾“å…¥åºåˆ—30ä¸ªï¼Œé¢„æµ‹10ä¸ªã€‚</p><p><strong>num_features</strong>å³æ—¶é—´åºåˆ—çš„ç»´åº¦ã€‚å°±æ˜¯åœ¨ä¸€ä¸ªæ—¶é—´ç‚¹ä¸Šè§‚å¯Ÿåˆ°çš„æ•°æ®ç»´åº¦ã€‚æˆ‘ä»¬è¿™é‡Œæ¯ä¸€æ­¥éƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„å€¼ï¼Œæ‰€ä»¥num_features=1ã€‚</p><p><strong>periodicities</strong>æ˜¯ä¿¡å·çš„å‘¨æœŸåˆ†é‡çš„å‘¨æœŸï¼Œæˆ‘ä»¬ä¿¡å·çš„è¡¨è¾¾å¼ä¸º:</p><p>y=sin(0.01âˆ—Ï€âˆ—x)+0.005âˆ—x+noise</p><p>y=sin(0.01âˆ—Ï€âˆ—x)+0.005âˆ—x+noise</p><p>yçš„å‘¨æœŸåˆ†é‡çš„frequencyä¸º2âˆ—Ï€âˆ—(1/f)</p><p>2âˆ—Ï€âˆ—(1/f),æ•…f=200,æ‰€ä»¥periodicities=200</p><p>f=200,æ‰€ä»¥periodicities=200ã€‚</p><p><strong>loss</strong>çš„å–å€¼ç°åœ¨æ”¯æŒNORMAL_LIKELIHOOD_LOSSå’ŒSQUARED_LOSSã€‚ ar = tf.contrib.timeseries.ARRegressor(</p><p>periodicities=200, input_window_size=30, output_window_size=10,</p><p>num_features=1,</p><p>loss=tf.contrib.timeseries.ARModel.NORMAL_LIKELIHOOD_LOSS)</p><p>'''</p><p>(input_window_size=30) + (output_window_size=10) = (window_size=40)</p><p>'''</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li></ul><p><strong>è®­ç»ƒè¯„ä¼°æ¨¡å‹å¹¶é¢„æµ‹</strong></p><p>ä½¿ç”¨trainå‡½æ•°ä¼ å…¥åˆ›å»ºå¥½çš„æ•°æ®train_input_fnè®­ç»ƒæ¨¡å‹å³å¯.</p><p>ar.train(input_fn=train_input_fn, steps=6000)</p><ul><li>1</li></ul><p>æ¥ä¸‹æ¥å°±æ˜¯å¯¹æ¨¡å‹è¿›è¡Œè¯„ä¼°ï¼Œé¦–å…ˆæˆ‘ä»¬ä½¿ç”¨ARæ¨¡å‹æä¾›çš„evaluateå‡½æ•°ï¼Œè¿™é‡Œevaluationçš„å¤„ç†æ˜¯ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹åœ¨åŸå…ˆçš„è®­ç»ƒé›†ä¸Šè¿›è¡Œè®¡ç®—ï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°æ¨¡å‹çš„æ‹Ÿåˆæ•ˆæœ.</p><p>evaluation_input_fn = tf.contrib.timeseries.WholeDatasetInputFn(reader)</p><p>evaluation = ar.evaluate(input_fn=evaluation_input_fn, steps=1)</p><p># keys of evaluation: ['covariance', 'loss', 'mean', 'observed', 'start_tuple', 'times', 'global_step']</p><p># evaluation['covariance']ä»£è¡¨åæ–¹å·® evaluation['loss']ä»£è¡¨æŸå¤± etc..</p><ul><li>1</li><li>2</li><li>3</li><li>4</li></ul><p>å¦‚æœè¦ç†è§£è¿™é‡Œevaluateå‡½æ•°çš„é€»è¾‘ï¼Œè¿™é‡ŒARæ¨¡å‹ï¼šæ¯æ¬¡éƒ½æ¥æ”¶é•¿åº¦ä¸º30çš„è¾“å…¥è§‚æµ‹åºåˆ—ï¼Œå¹¶è¾“å‡ºé•¿åº¦ä¸º10çš„é¢„æµ‹åºåˆ—ã€‚ä»¥æ­¤ä¸ºè§„åˆ™ï¼Œæ¯æ¬¡ç§»åŠ¨æ­¥é•¿ä¸º1ï¼Œä»¥æ­¤ç±»æ¨ï¼Œæ•´ä¸ªè®­ç»ƒé›†é•¿åº¦ä¸º1000çš„åºåˆ—ï¼Œæœ€ç»ˆæˆ‘ä»¬å¾—åˆ°970ä¸ªé¢„æµ‹å€¼ã€‚</p><p>è¿™970ä¸ªé¢„æµ‹å€¼è®°å½•åœ¨evaluation[â€˜meanâ€™]ä¸­;evaluationè¿˜æœ‰å…¶ä»–å‡ ä¸ªé”®å€¼:evaluation[â€˜lossâ€™]è¡¨ç¤ºæ€»çš„æŸå¤±ï¼Œevaluation[â€˜timesâ€™]è¡¨ç¤ºevaluation[â€˜meanâ€™]å¯¹åº”çš„æ—¶é—´ç‚¹ç­‰ç­‰.</p><p>è¯„ä¼°å®Œæ¨¡å‹åï¼Œä¸‹é¢è¯¥æ˜¯ä½¿ç”¨æ¨¡å‹äº†ï¼Œè¿™é‡Œæˆ‘ä»¬ä¼šç”¨åˆ°predictå‡½æ•°æ¥é¢„æµ‹ï¼Œä¼ å…¥å‚æ•°ä¸ºevaluation[â€˜start_tupleâ€™]ä¼šè¢«ç”¨äºä¹‹åçš„é¢„æµ‹ä¸­ï¼Œå®ƒç›¸å½“äºæœ€å30æ­¥çš„è¾“å‡ºå€¼å’Œå¯¹åº”çš„æ—¶é—´ç‚¹ã€‚ä»¥æ­¤ä¸ºèµ·ç‚¹(ä¹Ÿå°±æ˜¯ç»™å®šè§‚å¯Ÿæ•°æ®)ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹1000æ­¥ä»¥åçš„å€¼è¿›è¡Œé¢„æµ‹ï¼Œå¯¹åº”çš„ä»£ç ä¸ºï¼š</p><p>(predictions,) = tuple(ar.predict(</p><p>input_fn=tf.contrib.timeseries.predict_continuation_input_fn(</p><p>evaluation, steps=250)))</p><ul><li>1</li><li>2</li><li>3</li></ul><p>è¿™é‡Œçš„ä»£ç åœ¨1000æ­¥ä¹‹ååˆåƒåé¢„æµ‹äº†250ä¸ªæ—¶é—´ç‚¹ã€‚å¯¹åº”çš„å€¼å°±ä¿å­˜åœ¨predictions[â€˜meanâ€™]ä¸­ã€‚æˆ‘ä»¬å¯ä»¥æŠŠè§‚æµ‹åˆ°çš„å€¼ã€æ¨¡å‹æ‹Ÿåˆçš„å€¼ã€é¢„æµ‹å€¼ç”¨ä¸‹é¢çš„ä»£ç ç”»å‡ºæ¥ï¼š</p><p>plt.figure(figsize=(15, 5))</p><p>plt.plot(data['times'].reshape(-1), data['values'].reshape(-1), label='origin')</p><p>plt.plot(evaluation['times'].reshape(-1), evaluation['mean'].reshape(-1), label='evaluation')</p><p>plt.plot(predictions['times'].reshape(-1), predictions['mean'].reshape(-1), label='prediction')</p><p>plt.xlabel('time_step')</p><p>plt.ylabel('values')</p><p>plt.legend(loc=4)</p><p>plt.savefig('predict_result.jpg')</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li></ul><div class=pgc-img><img alt=TensorFlowå®æˆ˜ï¼šChapter-7ä¸‹ï¼ˆTFTSåº“ä¸æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1534905582992424220237f><p class=pgc-img-caption></p></div><hr><p><strong>ä½¿ç”¨LSTMé¢„æµ‹å•å˜é‡æ—¶é—´åºåˆ—</strong></p><p>æ³¨æ„ï¼šä»¥ä¸‹LSTMæ¨¡å‹çš„ä¾‹å­å¿…é¡»ä½¿ç”¨TensorFlowæœ€æ–°çš„å¼€å‘ç‰ˆçš„æºç ã€‚å…·ä½“æ¥è¯´ï¼Œè¦ä¿è¯</p><p>from tensorflow.contrib.timeseries.python.timeseries.estimators import TimeSeriesRegressor</p><ul><li>1</li></ul><p>å¯ä»¥æˆåŠŸæ‰§è¡Œã€‚(å°±æ˜¯å‰é¢è¯´çš„éœ€è¦å®‰è£…æœ€æ–°ç‰ˆçš„tensorflow)</p><p>ç»™å‡ºä¸¤ä¸ªç”¨LSTMé¢„æµ‹æ—¶é—´åºåˆ—æ¨¡å‹çš„ä¾‹å­ï¼Œåˆ†åˆ«æ˜¯train_lstm.pyå’Œtrain_lstm_multivariate.pyã€‚å‰è€…æ˜¯åœ¨LSTMä¸­è¿›è¡Œå•å˜é‡çš„æ—¶é—´åºåˆ—é¢„æµ‹ï¼Œåè€…æ˜¯ä½¿ç”¨LSTMè¿›è¡Œå¤šå˜é‡æ—¶é—´åºåˆ—é¢„æµ‹ã€‚ä¸ºäº†ä½¿ç”¨LSTMæ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦å…ˆä½¿ç”¨TFTSåº“å¯¹å…¶è¿›è¡Œå®šä¹‰ï¼Œå®šä¹‰æ¨¡å‹çš„ä»£ç æ¥æºäºTFTSçš„ç¤ºä¾‹æºç ï¼Œåœ¨train_lstm.pyå’Œtrain_lstm_multivariate.pyä¸­åˆ†åˆ«æ‹·è´äº†ä¸€ä»½ã€‚</p><p><strong>äº§ç”Ÿè®­ç»ƒæ•°æ®</strong></p><p>è¿™é‡Œæˆ‘ä»¬äº§ç”Ÿçš„æ•°æ®å…¬å¼ä¿®æ”¹ä¸€ä¸‹</p><p>y=sin(Ï€âˆ—0.02âˆ—x)+cos(Ï€âˆ—0.02âˆ—x)+sin(Ï€âˆ—0.04âˆ—x)+noise</p><p>y=sin(Ï€âˆ—0.02âˆ—x)+cos(Ï€âˆ—0.02âˆ—x)+sin(Ï€âˆ—0.04âˆ—x)+noise</p><p>åŒæ ·ç”¨å‡½æ•°åŠ å™ªå£°çš„æ–¹æ³•ç”Ÿæˆä¸€ä¸ªæ¨¡æ‹Ÿçš„æ—¶é—´åºåˆ—æ•°æ®ï¼š</p><p>x = np.array(range(1000))</p><p>noise = np.random.uniform(-0.2, 0.2, 1000)</p><p>y = np.sin(np.pi * x / 50 ) + np.cos(np.pi * x / 50) + np.sin(np.pi * x / 25) + noise</p><p>data = {</p><p>tf.contrib.timeseries.TrainEvalFeatures.TIMES: x,</p><p>tf.contrib.timeseries.TrainEvalFeatures.VALUES: y,</p><p>}</p><p>'''</p><p>plt.plot(x, y)</p><p>plt.savefig('train_data.jpg')</p><p>'''</p><p>reader = NumpyReader(data)</p><p>train_input_fn = tf.contrib.timeseries.RandomWindowInputFn(</p><p>reader, batch_size=4, window_size=100) # batch_sizeä¸º4 åºåˆ—é•¿åº¦ä¸º100</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li></ul><p>äº§ç”Ÿæ•°æ®å¦‚ä¸‹:</p><div class=pgc-img><img alt=TensorFlowå®æˆ˜ï¼šChapter-7ä¸‹ï¼ˆTFTSåº“ä¸æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1534905461004578947d80b><p class=pgc-img-caption></p></div><p><strong>å®šä¹‰è®­ç»ƒæ¨¡å‹å¹¶é¢„æµ‹</strong></p><p>è¿™é‡Œä½¿ç”¨TFTSåŒ…å†…æä¾›çš„TimeSeriesRegressoræ¨¡å‹ã€‚å…¶ä¸­_LSTMModelæ¥è‡ªTFTSåŒ…çš„å®˜æ–¹ä¾‹å­ã€‚</p><hr><ul><li><strong>_LSTMModelæ¥å—ä¸¤ä¸ªå‚æ•°:</strong>num_units: æ¨¡å‹ä¸­ä½¿ç”¨çš„LSTMå•å…ƒä¸ªæ•°</li><li>num_features: æ—¶é—´åºåˆ—èƒ½è§‚å¯Ÿåˆ°çš„ç»´åº¦.(å³æ¯ä¸ªæ—¶é—´æ­¥èƒ½è§‚å¯Ÿåˆ°çš„æ•°æ®ç‰¹å¾é‡)</li></ul><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ¨¡å‹å‚æ•°ä¸ºnum_features = 1è¡¨ç¤ºå•å˜é‡æ—¶é—´åºåˆ—ï¼Œå³æ¯ä¸ªæ—¶é—´ç‚¹ä¸Šè§‚å¯Ÿåˆ°çš„é‡åªæ˜¯ä¸€ä¸ªå•ç‹¬çš„æ•°å€¼ã€‚num_units=128è¡¨ç¤ºä½¿ç”¨éšå±‚ä¸º128å¤§å°çš„LSTMæ¨¡å‹ã€‚åç»­çš„è®­ç»ƒï¼Œè¯„ä¼°ï¼Œé¢„æµ‹å’Œå‰é¢è®²çš„ä»£ç ç±»ä¼¼ã€‚åœ¨ä»¥åçš„1000ç»„æ•°æ®ä¸Šï¼Œæˆ‘ä»¬å‘åé¢„æµ‹äº†200ç»„æ•°æ®ã€‚</p><hr><p>ä»£ç å¦‚ä¸‹:</p><p>estimator = ts_estimators.TimeSeriesRegressor(</p><p>model=_LSTMModel(num_features=1, num_units=128),</p><p>optimizer=tf.train.AdamOptimizer(0.001))</p><p>estimator.train(input_fn=train_input_fn, steps=2000)</p><p>evaluation_input_fn = tf.contrib.timeseries.WholeDatasetInputFn(reader)</p><p>evaluation = estimator.evaluate(input_fn=evaluation_input_fn, steps=1)</p><p># Predict starting after the evaluation é¢„æµ‹åç»­çš„200ç»„æ•°æ®</p><p>(predictions,) = tuple(estimator.predict(</p><p>input_fn=tf.contrib.timeseries.predict_continuation_input_fn(</p><p>evaluation, steps=200)))</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li></ul><p><strong>ç»˜åˆ¶é¢„æµ‹æ•°æ®å›¾</strong></p><p>observed_times = evaluation["times"][0]</p><p>observed = evaluation["observed"][0, :, :]</p><p>evaluated_times = evaluation["times"][0]</p><p>evaluated = evaluation["mean"][0]</p><p>predicted_times = predictions['times']</p><p>predicted = predictions["mean"]</p><p>plt.figure(figsize=(15, 5))</p><p>plt.axvline(999, linestyle="dotted", linewidth=4, color='r')</p><p>observed_lines = plt.plot(observed_times, observed, label="observation", color="k")</p><p>evaluated_lines = plt.plot(evaluated_times, evaluated, label="evaluation", color="g")</p><p>predicted_lines = plt.plot(predicted_times, predicted, label="prediction", color="r")</p><p>plt.legend(handles=[observed_lines[0], evaluated_lines[0], predicted_lines[0]],</p><p>loc="upper left")</p><p>plt.savefig('predict_result.jpg')</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li></ul><div class=pgc-img><img alt=TensorFlowå®æˆ˜ï¼šChapter-7ä¸‹ï¼ˆTFTSåº“ä¸æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15349056032327a60fa42cb><p class=pgc-img-caption></p></div><hr><p><strong>ä½¿ç”¨LSTMé¢„æµ‹å¤šå˜é‡æ—¶é—´åºåˆ—</strong></p><p>ä¸ä¸Šé¢çš„ä½¿ç”¨LSTMé¢„æµ‹å•å˜é‡æ—¶é—´åºåˆ—ä¸åŒçš„åœ°æ–¹åœ¨äºæ•°æ®çš„è¯»å–å’Œæ¨¡å‹çš„é¢„æµ‹é‡ã€‚ä½¿ç”¨åŸç†å®è´¨ä¸Šæ˜¯ä¸€è‡´çš„ã€‚</p><p><strong>è·å–è®­ç»ƒæ•°æ®</strong></p><p>æ‰€è°“å¤šå˜é‡æ—¶é—´åºåˆ—ï¼Œå°±æ˜¯æŒ‡åœ¨æ¯ä¸ªæ—¶é—´ç‚¹ä¸Šçš„è§‚æµ‹é‡æœ‰å¤šä¸ªå€¼ã€‚åœ¨data/multivariate_periods.csvæ–‡ä»¶ä¸­ï¼Œä¿å­˜äº†ä¸€ä¸ªå¤šå˜é‡æ—¶é—´åºåˆ—çš„æ•°æ®ï¼š(ä¸‹é¢æ˜¯æˆªå–)</p><p>0,0.926906299771,1.99107237682,2.56546245685,3.07914768197,4.04839057867</p><p>1,0.108010001864,1.41645361423,2.1686839775,2.94963962176,4.1263503303</p><p>2,-0.800567600028,1.0172132907,1.96434754116,2.99885333086,4.04300485864</p><p>3,0.0607042871898,0.719540073421,1.9765012584,2.89265588817,4.0951014426</p><p>4,0.933712200629,0.28052120776,1.41018552514,2.69232603996,4.06481164223</p><p>5,-0.171730652974,0.260054421028,1.48770816369,2.62199129293,4.44572807842</p><p>6,-1.00180162933,0.333045158863,1.50006392277,2.88888309683,4.24755865606</p><p>7,0.0580061875336,0.688929398826,1.56543458772,2.99840358953,4.52726873347</p><p>8,0.764139447412,1.24704875327,1.77649279698,3.13578593851,4.63238922951</p><p>9,-0.230331874785,1.47903998963,2.03547545751,3.20624030377,4.77980005228</p><p>10,-1.03846045211,2.01133000781,2.31977503972,3.67951536251,5.09716775897</p><p>11,0.188643592253,2.23285349038,2.68338482249,3.49817168611,5.24928239634</p><p>12,0.91207302309,2.24244446841,2.71362604985,3.96332587625,5.37802271594</p><p>13,-0.296588665881,2.02594634141,3.07733910479,3.99698324956,5.56365901394</p><p>14,-0.959961476551,1.45078629833,3.18996420137,4.3763059609,5.65356015609</p><p>15,0.46313530679,1.01141441548,3.4980215948,4.20224896882,5.88842247449</p><p>16,0.929354125798,0.626635305936,3.70508262244,4.51791573544,5.73945973251</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li></ul><p>å³æ¯ä¸ªæ—¶é—´æ­¥ä¸Šèƒ½è§‚å¯Ÿåˆ°å¤šä¸ªæ•°æ®å˜é‡(è¿™é‡Œæœ‰5ç»„æ•°æ®)ã€‚ä¸¾ä¸ªç®€å•çš„ä¾‹å­:å¦‚æœç°åœ¨æˆ‘åœ¨è·‘æ­¥ï¼Œæ¯ä¸ªæ—¶é—´æ­¥ä¸Šï¼Œå¯ä»¥è·å–åˆ°æˆ‘çš„å¿ƒè·³ï¼Œè¡€å‹ï¼Œä½“æ¸©ã€‚è¿™å°±æ˜¯åœ¨æ¯ä¸ªæ—¶é—´æ­¥ä¸Šèƒ½è§‚å¯Ÿåˆ°3ä¸ªæ•°æ®å˜é‡ã€‚</p><p>ä¸‹é¢ä¾æ—§æ˜¯ä½¿ç”¨CSVReaderå¤„ç†æ•°æ®ï¼ŒåŒºåˆ«åœ¨column_nameså‚æ•°ï¼Œè¯¥å‚æ•°å‘Šè¯‰CSVReaderé‚£äº›å˜é‡æ˜¯å¯¹åº”çš„æ—¶é—´æ­¥å’Œå˜é‡ã€‚</p><p>csv_file_name = path.join("./data/multivariate_periods.csv")</p><p>reader = tf.contrib.timeseries.CSVReader(</p><p>csv_file_name,</p><p>column_names=((tf.contrib.timeseries.TrainEvalFeatures.TIMES,)</p><p>+ (tf.contrib.timeseries.TrainEvalFeatures.VALUES,) * 5))</p><p>train_input_fn = tf.contrib.timeseries.RandomWindowInputFn(</p><p>reader, batch_size=4, window_size=32)</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li></ul><p><strong>å®šä¹‰è®­ç»ƒæ¨¡å‹å¹¶é¢„æµ‹</strong></p><p>è¿™é‡Œä¸ä¸Šé¢çš„ç¨‹åºä¸åŒçš„åœ°æ–¹åœ¨äº_LSTMModelä¸­å‚æ•°num_features=5.å³èƒ½è§‚å¯Ÿçš„æ•°æ®é‡ç»´åº¦ä¸º5.æœ¬æ¬¡å‘åé¢„æµ‹çš„æ•°æ®ä¸º100ç»„ã€‚(è®­ç»ƒæ•°æ®100ç»„)</p><p>estimator = ts_estimators.TimeSeriesRegressor(</p><p>model=_LSTMModel(num_features=5, num_units=128),</p><p>optimizer=tf.train.AdamOptimizer(0.001))</p><p>estimator.train(input_fn=train_input_fn, steps=200)</p><p>evaluation_input_fn = tf.contrib.timeseries.WholeDatasetInputFn(reader)</p><p>evaluation = estimator.evaluate(input_fn=evaluation_input_fn, steps=1)</p><p># Predict starting after the evaluation</p><p>(predictions,) = tuple(estimator.predict(</p><p>input_fn=tf.contrib.timeseries.predict_continuation_input_fn(</p><p>evaluation, steps=100)))</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li></ul><p><strong>ç»˜åˆ¶é¢„æµ‹å›¾</strong></p><p>observed_times = evaluation["times"][0]</p><p>observed = evaluation["observed"][0, :, :]</p><p>evaluated_times = evaluation["times"][0]</p><p>evaluated = evaluation["mean"][0]</p><p>predicted_times = predictions['times']</p><p>predicted = predictions["mean"]</p><p>plt.figure(figsize=(15, 5))</p><p>plt.axvline(99, linestyle="dotted", linewidth=4, color='r')</p><p>observed_lines = plt.plot(observed_times, observed, label="observation", color="k")</p><p>evaluated_lines = plt.plot(evaluated_times, evaluated, label="evaluation", color="g")</p><p>predicted_lines = plt.plot(predicted_times, predicted, label="prediction", color="r")</p><p>plt.legend(handles=[observed_lines[0], evaluated_lines[0], predicted_lines[0]],</p><p>loc="upper left")</p><p>plt.savefig('predict_result.jpg')</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li></ul><div class=pgc-img><img alt=TensorFlowå®æˆ˜ï¼šChapter-7ä¸‹ï¼ˆTFTSåº“ä¸æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15349054915748b089e1943><p class=pgc-img-caption></p></div><hr><hr><h1><strong>æ€»ç»“</strong></h1><p>TFTSæ˜¯Tensorflowå®˜æ–¹æä¾›çš„åŸºäºLSTMæ¨¡å‹çš„æ—¶åºé¢„æµ‹å·¥å…·ï¼Œå¯ä»¥ç”¨äºå¸¸è§çš„æ—¶åºæ¨¡å‹ä¸Š(æ›¿ä»£HMM)ã€‚è¿™é‡Œè®²äº†å¦‚æœä½¿ç”¨TFTSæ¨¡å‹è¯»å–æ•°æ®å¹¶äº§ç”Ÿè®­ç»ƒæ•°æ®ï¼ŒåŒæ—¶è®²äº†å¦‚æœä½¿ç”¨TFTSæ¨¡å—è‡ªå¸¦çš„ARå’ŒLSTMæ¨¡å‹ã€‚</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'TensorFlow','å®æˆ˜','Chapter'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>