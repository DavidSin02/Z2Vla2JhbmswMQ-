<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>关于Excel的颜色，全部在这里。还赠送您一个颜色的自定义函数 | 极客快訊</title><meta property="og:title" content="关于Excel的颜色，全部在这里。还赠送您一个颜色的自定义函数 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/8928ef8cc04441d99c5c23611afdfc57"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/743a9ab.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/743a9ab.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/743a9ab.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/743a9ab.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/743a9ab.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/743a9ab.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/743a9ab.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/743a9ab.html><meta property="article:published_time" content="2020-10-29T21:04:59+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:59+08:00"><meta name=Keywords content><meta name=description content="关于Excel的颜色，全部在这里。还赠送您一个颜色的自定义函数"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/743a9ab.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>关于Excel的颜色，全部在这里。还赠送您一个颜色的自定义函数</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>各位朋友，今天和你们分享Excel中颜色的一些基础知识，详见下面列表：</p><p><strong class=highlight-text>1、颜色索引值及其使用：ColorIndex；</strong></p><p><strong class=highlight-text>2、颜色的RGB值；</strong></p><p><strong class=highlight-text>3、颜色的RGB值与十进制值的相互转换；</strong></p><p><strong class=highlight-text>4、颜色的RGB值与16进制值的相互转换；</strong></p><p><strong class=highlight-text>5、颜色的中文名称、英文名称及其使用；</strong></p><p><strong class=highlight-text>6、赠送的自定义函数演示效果及代码；</strong></p><hr><h1 class=pgc-h-arrow-right><strong>一、颜色索引表</strong></h1><div class=pgc-img><img alt=关于Excel的颜色，全部在这里。还赠送您一个颜色的自定义函数 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8928ef8cc04441d99c5c23611afdfc57><p class=pgc-img-caption>颜色索引</p></div><hr><p>在Excel中，颜色索引为1～56，共56个，我们可以用下面的VBA代码生成颜色索引和对应的颜色：</p><blockquote class=pgc-blockquote-abstract><p>Sub 生成1至56号颜色()</p><p>Dim a%</p><p>For a = 1 To 56</p><p>Range("A" & a + 2) = a '列生成颜色索引代码</p><p>Range("B" & a + 2).Interior.ColorIndex = a 'B列显示对应的颜色</p><p>Next</p><p>End Sub</p></blockquote><div class=pgc-img><img alt=关于Excel的颜色，全部在这里。还赠送您一个颜色的自定义函数 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/13617797b52a4be1ad9492662e22ce6b><p class=pgc-img-caption>生成颜色</p></div><p>下面我们来看看颜色索引值是怎么使用的：</p><p><strong>1、在工作表中的使用</strong></p><p>在工作表中，我们可以用于自定义格式来设置单元格格式（如下图），我们可以用【[颜色1]～[颜色56]】来调用这56种颜色中的任意颜色（一定要加上中括号）。</p><div class=pgc-img><img alt=关于Excel的颜色，全部在这里。还赠送您一个颜色的自定义函数 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/b4f63815694c4b5889a89017b121eba3><p class=pgc-img-caption>自定义格式调用颜色索引值</p></div><p>上面的格式设置，使用了自定义格式中的四个区间，分别是：<strong>正数;负数;零;文本</strong>，每个区间用英文状态的分号【;】分隔，设置每个区间的格式代码，当单元格内容为相应格式时，显示对应的格式的设置效果（如此例中的字体颜色效果），有点类似于条件格式。</p><p><strong>2、在VBA代码中的使用</strong></p><p>我们也会用到用VBA代码给单元格填充颜色，例如我在本节开始生成颜色填充的代码。代码中调用颜色索引值的是：</p><pre><code>Range("B" &amp; a + 2).Interior.ColorIndex = a</code></pre><p>即，当a=1时，单元格B3填充颜色3；…依次累加…；当a=56时，单元格B58填充颜色58。</p><p>注意：这里用的是<strong class=highlight-text>ColorIndex</strong>，要和后面以示区别。</p><hr><h1 class=pgc-h-arrow-right><strong>二、颜色的RGB值</strong></h1><p>在Office2007及以上的版本中，支持了自定义颜色，即除了以上56种颜色外，可以设置和显示更多的颜色。见下图：</p><div class=pgc-img><img alt=关于Excel的颜色，全部在这里。还赠送您一个颜色的自定义函数 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/7f4aff1b740d496c86d41d99b6b39fdc><p class=pgc-img-caption>RGB颜色设置</p></div><p>RGB是颜色三原色的缩写：<strong class=highlight-text>R(ed)红色，G(reen)绿色，B(lue)蓝色</strong>，每个颜色基色用8bit数据表示，即2^8=256色。通过设置RGB值，我们可以获得256×256×256=16777216种颜色。这个常用于在工作表中对单元格底色、单元格字符颜色、单元格边框颜色等的设置（在VBA中的使用，见下一节）。</p><p>给大家分享一个自定义函数，用于直接提取单元格填充色的RGB值</p><blockquote class=pgc-blockquote-abstract><p>Function GetRGB(Rng As Range)</p><p>Application.Volatile '定制该函数为易失性函数</p><p>If Rng.Count > 1 Then</p><p>GetRGB = "请选择单个单元格" '限制选取单个单元格</p><p>Else</p><p>Dim Cr, R, G, B '申明变量</p><p>Cr = Rng.Interior.Color '获取单元格颜色值</p><p>R = Cr Mod 256 '计算颜色R值</p><p>G = (Cr - R) / 256 Mod 256 '计算颜色G值</p><p>B = (Cr - R - G * 256) / 256 ^ 2 '计算颜色B值</p><p>GetRGB = R & "," & G & "," & B '输出RGB值</p><p>End If</p><p>End Function</p></blockquote><div class=pgc-img><img alt=关于Excel的颜色，全部在这里。还赠送您一个颜色的自定义函数 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0e21eecbcc284489b114e07736a1630e><p class=pgc-img-caption>获取单元格填充色的RGB值</p></div><p>请大家注意代码中的这句：【<strong class=highlight-text>Rng.Interior.Color</strong>】，与上面的【<strong class=highlight-text>Range().Interior.ColorIndex</strong>】的区别：</p><p><strong class=highlight-text>①Interior.Color表示单元格的颜色值，即颜色的十进制值；</strong></p><p><strong class=highlight-text>②Interior.ColorIndex表示单元格的颜色索引，即数字1～56。</strong></p><p>在用VBA填充单元格颜色的时候，一定要注意<strong class=highlight-text>Color</strong>和<strong class=highlight-text>ColorIndex</strong>的区别。下面我给大家说说颜色的十进制值。</p><hr><h1 class=pgc-h-arrow-right><strong>三、颜色RGB值与十进制值相互转换</strong></h1><p>在上一节的代码中，是把十进制的颜色值转换为RGB的颜色值，那么RGB的颜色值是怎么转换为十进制的颜色值的呢？公式如下：</p><pre><code>十进制颜色值＝R×256^0+G×256^1+B×256^2</code></pre><p>获取十进制值的方法：①直接用代码<strong class=highlight-text>Interior.Color</strong>获取；②通过上面的公式，用RGB值计算的来。</p><p>我们对单元格颜色填充的过程录制一个宏。通过录制的代码，可以看出代码中用的颜色值是十进制的，同样我们可以把要填充的颜色，通过RGB值或十进制值，利用VBA代码填充到单元格中（见下图）。</p><div class=pgc-img><img alt=关于Excel的颜色，全部在这里。还赠送您一个颜色的自定义函数 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/00795848a33c40558fa678c5dec9653e><p class=pgc-img-caption>RBG值和颜色值在VBA中的使用</p></div><h1 class=pgc-h-arrow-right><strong>四、颜色RGB值与的十六进制值相互转换</strong></h1><p>这个在EXCEL中用得很少，主要给大家分享RGB颜色值与16进制的颜色代码相互转换的原理：</p><p>通过最前面的颜色索引表，可以看出16进制的颜色代码由6个字符（除井号）组成，分为三组：1～2位是R颜色的代码，3～4位是G颜色的代码，5～6位是B颜色的代码。转换过程也比较简单 ，用工作表内置的十进制转16进制函数【DEC2HEX】，将10进制的R、G、B值分别转化为16进制的R、G、B值（注意格式为两位数），然后将R、G、B的16进制代码按顺序合并起来，再最前面加上井号。</p><p>16进制的颜色代码，要转换为RGB的值，用16进制转10进制函数【HEX2DEC】反过来操作就可以了。</p><h1 class=pgc-h-arrow-right><strong>五、颜色中文、英文名称及其使用</strong></h1><p>在Excel中，有部分颜色，可以直接使用名称明细如下：.</p><div class=pgc-img><img alt=关于Excel的颜色，全部在这里。还赠送您一个颜色的自定义函数 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/deb62ed38996402ca8a56af62e10bb16><p class=pgc-img-caption>可用直接使用名称的颜色</p></div><p>可用中文名称的颜色（7个）：<strong class=highlight-text>黑色、白色、红色、绿色、蓝色、黄色、洋红；</strong></p><p>可用英文名称的颜色（8个）：<strong class=highlight-text>vbBlack、vbWhite、vbRed、vbGreen、vbBlue、vbYellow、vbMagenta、vbCyan。</strong></p><p>1、中文名称用在自定义格式中，详见下图</p><div class=pgc-img><img alt=关于Excel的颜色，全部在这里。还赠送您一个颜色的自定义函数 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6e6fcc025dad46949346e3ebde299ed2><p class=pgc-img-caption>中文颜色名称在自定义格式中的使用</p></div><p>2、英文名称用在VBA代码中，详见下图</p><div class=pgc-img><img alt=关于Excel的颜色，全部在这里。还赠送您一个颜色的自定义函数 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/68b8e65d835444848088ce8076c4f5df><p class=pgc-img-caption>英文名称在VBA中的使用</p></div><hr><p>案例中，主要用单元格填充效果，是因为单元格填充显示效果更明显。能用於单元格底色的颜色代码，同样可以用於单元格中字体、单元格边框、绘制的图形线条和填充、图表的颜色等。</p><hr><p>既然说到颜色，很多人都有按颜色来对单元格进行计算的需求，今天赠送大家一个自定义函数，可以实现按颜色对数据进行<strong>求和、统计、合并</strong>。效果如下：</p><div class=pgc-img><img alt=关于Excel的颜色，全部在这里。还赠送您一个颜色的自定义函数 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8a7dbfc274f5488e8b67b0baaeeda09d><p class=pgc-img-caption>按颜色计算的自定义函数</p></div><div class=pgc-img><img alt=关于Excel的颜色，全部在这里。还赠送您一个颜色的自定义函数 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/68967564294b4fec90544900beb505a9><p class=pgc-img-caption>自定义函数的代码</p></div><p><strong class=highlight-text>由于自定义代码较多，单独贴出来会影响阅读效果，故直接截图上传的。有需要文中案例和代码的朋友，可以关注我，然后用私信<a class=pgc-link data-content=mp href=http://toutiao.com/item/6796907929833308686/ rel="noopener noreferrer" target=_blank>【查看发私信的教程】</a>发送关键字【颜色】就可以获文中所有的资料和代码（由于用的是VBA代码，需要启用宏才能正常使用）。</strong></p><p><strong class=highlight-text>另外，在关于颜色计算上，你们还有比较好的建议或者问题，都可以在下面给我留言、讨论。</strong></p><hr><p>好了，今天就到这里，感谢各位朋友的关注和支持。</p><blockquote class=pgc-blockquote-abstract><p><strong>如果你喜欢我分享的内容，请点个赞支持下；</strong></p><p><strong>如果你觉得我分享的内容对你有帮助，可以关注我；</strong></p><p><strong>如果要看我以前分享过的好玩的内容，大家可以去我的主页查看历史文章。</strong></p></blockquote></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'颜色','关于','Excel'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>