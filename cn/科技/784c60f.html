<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>手把手教你如何用Python爬取网站文本信息 | 极客快訊</title><meta property="og:title" content="手把手教你如何用Python爬取网站文本信息 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/61b1914ac3a34b07be93226071546148"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/784c60f.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/784c60f.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/784c60f.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/784c60f.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/784c60f.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/784c60f.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/784c60f.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/784c60f.html><meta property="article:published_time" content="2020-10-29T20:50:15+08:00"><meta property="article:modified_time" content="2020-10-29T20:50:15+08:00"><meta name=Keywords content><meta name=description content="手把手教你如何用Python爬取网站文本信息"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/784c60f.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>手把手教你如何用Python爬取网站文本信息</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><div class=pgc-img><img alt=手把手教你如何用Python爬取网站文本信息 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/61b1914ac3a34b07be93226071546148><p class=pgc-img-caption></p></div><p><strong>提取网页源代码——Requests 工具包</strong></p><p>在我们提取网络信息之前，我们必须将网页的源代码进行提取，Requests工具包现在可以说是最好用和最普及的静态网页爬虫工具，它是由大神Kenneth Reitz所搭建的。在Requests的官方介绍里，Requests所遵守的哲学理念是：</p><p>1.Beautiful is better than ugly. （美胜过丑）</p><p>2.Explicit is better than implicit.（清晰胜过隐匿）</p><p>3.Simple is better than complex.（简单胜过复杂）</p><p>4.Complex is better than complicated.（复杂胜过繁琐）</p><p>5.Readability counts.（可读性很重要）</p><p>Requests工具包的使用非常简单，最主要使用的函数为requests.get(url),其中参数url就是我们想提取源代码的网页，再通过requests.get(url).text将页面转换为字符串，就可以供我们使用了。</p><div class=pgc-img><img alt=手把手教你如何用Python爬取网站文本信息 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/9f480380-cd87-47f6-9897-05bade418255><p class=pgc-img-caption></p></div><p><strong>信息提取——Xpath</strong></p><p>我们普通的网页一般都是XML文档格式，当我们想提取里面的内容时，我们需要借助Xpath来分解其中的格式，提取我们想要的内容。在了解Xpath之前我们需要知道四个基本概念：节点、元素、属性、文本 。我们来看一个例子：</p><pre>&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;​ ​&lt;bookstore&gt;​ ​&lt;book&gt;​ &lt;title&gt;Harry Potter&lt;/title&gt;​ &lt;author&gt;J K. Rowling&lt;/author&gt;​ &lt;year&gt;2005&lt;/year&gt;​ &lt;price&gt;29.99&lt;/price&gt;​&lt;/book&gt;​ ​&lt;/bookstore&gt;​</pre><p>这就是一个网页的源码，其中 &lt;bookstore> 是文档节点， &lt;author>J K. Rowling&lt;/author> 是元素节点， lang="en" 是属性节点。 J K. Rowling 、2005 和29.99是文本（文本通常就是我们想爬取的内容）。</p><p><strong>实例分享——爬取豆瓣电影的信息</strong></p><p>接下来我们做一个很简单的实例分享，我们想爬取在豆瓣网上的电影《超时空同居》的导演和演员信息。</p><p>首先我们找到电影的URL：</p><div class=pgc-img><img alt=手把手教你如何用Python爬取网站文本信息 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f6d24d50daaa406f8ea68d47806f2a73><p class=pgc-img-caption></p></div><p>右键点击看网页的源代码 view page source（或者可以进入开发者模式（insepect））：</p><div class=pgc-img><img alt=手把手教你如何用Python爬取网站文本信息 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0fcb44c215914a2d86b3d651586cf836><p class=pgc-img-caption></p></div><p>接下来我们就进入网页源代码了，我们想要搜集的信息就在源代码里，只用输入关键字就可以查看到，比如这里我们输入’雷佳音’就定位到了我们想要寻找的位置：</p><div class=pgc-img><img alt=手把手教你如何用Python爬取网站文本信息 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9b423033eb9a4292b51d81270bd2a0d1><p class=pgc-img-caption></p></div><p>接下来我们就需要分析TML的格式了，例如我们要找到所有的主演：</p><div class=pgc-img><img alt=手把手教你如何用Python爬取网站文本信息 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6c6f91ca488442238d48c41f81feb9b3><p class=pgc-img-caption></p></div><p>大家可以看到有一个普遍的规律：主演的名字所对应的节点名都为a，属性都为rel="v:starring"，这样我们就可以很轻易的用xpath的语法定位到拥有这个元素的节点，然后将所有的结果找出。</p><p>同理，导演的名字所对应的节点名为a，属性都为rel=" v:directedBy"，我们同样可以通过这个定位找到相应的文本：</p><div class=pgc-img><img alt=手把手教你如何用Python爬取网站文本信息 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d391cbfad5bf46289429eb0337dad967><p class=pgc-img-caption></p></div><p>具体的代码如下：</p><pre>import requests​from lxml import etree​ ​ ​url='https://movie.douban.com/subject/27133303/?from=showing' #输入我们的url​get = requests.get(url).text # get(url) 得到我们的网页, text将源网页转化为字符串​ ​ ​selector = etree.HTML(get) # 将源码转换为xpath可以识别的TML格式​ ​ ​info = {} #字典用于储存信息​info['电影'] = selector.xpath('//title/text()')[0].strip() # 定位电影名字​info['导演']=selector.xpath('//a[@rel="v:directedBy"]/text()') # 定位导演名字​info['演员']=selector.xpath('//a[@rel="v:starring"]/text()') # 定位演员名字​print(info)</pre><p>最后我们得到一个字典集的结果：</p><pre>{'电影': '超时空同居 (豆瓣)', '导演': ['苏伦'], '演员': ['雷佳音', '佟丽娅', '张衣', '于和伟', '王正佳', '陶虹', '李念', '李光洁', '杨玏', '范明', '徐峥', '杨迪', '方龄', '陈昊']}</pre><p><strong>实例分享2——爬取带有json格式豆瓣电影的信息</strong></p><p>首先，json是一种轻量级的数据交换格式，它简洁和清晰的层次结构使得 JSON 成为理想的数据交换语言，易于人阅读和编写，同时也易于机器解析和生成，并有效地提升网络传输效率。</p><p>在我们爬虫的过程中，我们有时候可以在开发者模式返回的网页里找到完整的json格式的数据，这时候我们就可以运用requests包里的json函数将爬取到的原文本转化格式，从而方便我们提取内容。我们还是拿豆瓣电影举例：</p><div class=pgc-img><img alt=手把手教你如何用Python爬取网站文本信息 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/222caf0688af45f99c164dc2aa5535a1><p class=pgc-img-caption></p></div><p>这是点击分类后我们看到的电影信息，假如我们想爬取这些电影的信息，我们可以点击右键进入开发者模式（inspector）。</p><div class=pgc-img><img alt=手把手教你如何用Python爬取网站文本信息 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/48f6822b817a49568b01f13f347120b1><p class=pgc-img-caption></p></div><p>在打开开发者模式之后一定要记得刷新一次，否则不会显示之前接收到的页面信息。然后我们选择右边标签的network，下面再点击XHR选项,我们就会看到一个返回的网页，双击它。</p><div class=pgc-img><img alt=手把手教你如何用Python爬取网站文本信息 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a422b1367b644f67b85b4e67bd862ef4><p class=pgc-img-caption></p></div><p>上图就是打开后的json文件，由于我的电脑下载了json插件的缘故，它的格式要更清晰（使用Chrome浏览器的同学可以进入Chrome商店下载Juan Ramón JSON Beautifier Chrome插件）。Json文件其实也可以被理解为是一个大的字典，里面有很多层小的字典和列表，我们找到json网页后只需要用requests变成json格式即可方便的提取信息。</p><p>代码如下：</p><pre>import requestsurl='https://movie.douban.com/j/new_search_subjects?sort=T&amp;range=0,10&amp;tags=&amp;start=0'get = requests.get(url).json() #用json()函数得到网页源码​get = get['data']​info = {}​for i in range(len(get)):​ ​ info[get[i]['title']] = [get[i]['directors'], get[i]['rate'] ] #提取每部电影的导演和评分​print(info)</pre></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Python','爬取','网站'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>