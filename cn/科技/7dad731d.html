<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>对于新手来说，Python中有哪些难以理解的概念？ | 极客快訊</title><meta property="og:title" content="对于新手来说，Python中有哪些难以理解的概念？ - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/1f4ec4c3a6484cf58453023c44e01d75"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7dad731d.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7dad731d.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/7dad731d.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7dad731d.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7dad731d.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/7dad731d.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/7dad731d.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7dad731d.html><meta property="article:published_time" content="2020-11-14T21:05:10+08:00"><meta property="article:modified_time" content="2020-11-14T21:05:10+08:00"><meta name=Keywords content><meta name=description content="对于新手来说，Python中有哪些难以理解的概念？"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/7dad731d.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>对于新手来说，Python中有哪些难以理解的概念？</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p><strong>老手都是从新手一路走过来的</strong>，很多新手伙伴可能会对一些基础的概念理解都存在一定的困难，提起Python中难以理解的概念，很多伙伴对于<strong>Python变量赋值的机制</strong>有些疑惑，不过对于习惯于求根究底的程序员，只有深入理解了某个事物本质，掌握了它的客观规律，才能得心应手、运用自如，进阶更高层次来看待这个事物，此刻<strong>“庖丁解牛”</strong>这个成语能够贴切表达这个意思，<strong>你看见的是整头的牛，而我看见的是牛的内部肌理筋骨，就是这个状态！！！</strong></p><div class=pgc-img><img alt=对于新手来说，Python中有哪些难以理解的概念？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1f4ec4c3a6484cf58453023c44e01d75><p class=pgc-img-caption></p></div><p><strong>那么为什么Python变量赋值的机制难以理解呢？</strong></p><p>我想可能是我们的思维被C语言变量赋值的机制所固化了。在C语言中变量所分配到的地址是内存空间中一个固定的位置，当我们改变变量值时，对应内存空间中的值也相应改变。在Python中变量存储的机制是完全不一样的，当给一个变量赋值时首先解释器会给这个值分配内存空间，然后将变量指向这个值的地址，那么当我们改变变量值的时候解释器又会给新的值分配另一个内存空间，再将变量指向这个新值的地址，所以和C语言相比，在Python中改变的是变量所指向的地址，而内存空间中的值是固定不变的。</p><div class=pgc-img><img alt=对于新手来说，Python中有哪些难以理解的概念？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4a265defcec4496c85ac4d23f9b9c14f><p class=pgc-img-caption></p></div><p>接下来我们要由浅入深的去验证下我们的结论。在Ubuntu 16.04 LTS 32 位的环境下通过id方法查看变量的内存地址的方式来进行验证，为什么要强调环境呢？因为不同的环境下测试结果可能会由于解释器的优化不同而有所不同。</p><p>那这里我们就以Python的int类型为例，可以看到执行 i += 1 后，变量i的内存地址会发生变化，事实上 i += 1 并不是在原有变量i的地址上加1,而是重新创建一个值为6的int对象，变量i则引用了这个新的对象，因此当变量i和变量j的值相同时会指向同个内存地址。同样以Python的float 类型为例也验证了这个变量存储管理的机制。</p><pre>———————— int example————————i = 5 ——》》》 i ---&gt; 5 id(i) ---&gt; 0xa26f880i += 1 ——》》》 i ---&gt; 6 id(i) ---&gt; 0xa26f874j = 5 ——》》》 j ---&gt; 5 id(j) ---&gt; 0xa26f880________________ float example_______________i = 1.5 ——》》》 i ---&gt; 1.5 id(i) ---&gt; 0x9e86c8ci += 1 ——》》》 i ---&gt; 2.5 id(i) ---&gt; 0x9e86cacj = 1.5 ——》》》 j ---&gt; 1.5 id(j) ---&gt; 0x9e86c8c</pre><p><strong>陆陆续续的试了列表、字典、字符串、元组等变量类型赋值的效果，我发现其实Python中的对象分为可变类型和不可变类型，列表、字典是可变类型，而整数、浮点、短字符串、元组等是不可变类型。</strong>可变类型的变量赋值与我们了解的C语言机制相同，而不可变类型的变量赋值时，实际上是重新创建一个不可变类型的对象，并将原来的变量重新指向新创建的对象，当然如果没有其他变量引用原有对象时，原有对象就会被回收。这也是Python作为动态类型语言的特点，即变量不需要预先声明类型，当变量在赋值时解释器会根据值的类型创建对应的内存空间进行存储，并将变量指向这个地址空间即可，比如运行a=1时，解释器将变量指向整形值1的地址，当运行a=0.1时，解释器将变量指向浮点值0.1的地址。</p><div class=pgc-img><img alt=对于新手来说，Python中有哪些难以理解的概念？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/26320e4eadc44fc1b1bcaed538b0f9bc><p class=pgc-img-caption></p></div><p><strong>但是问题又来了！！！为什么Python可以这样肆无忌惮地完成动态类型的特征？</strong></p><p>这里要深究到PyObject这个结构体的层面。通常来说，无论什么语言最终被计算机识别到的都是内存中的字节信息，对象实际上就是在更高的层次上把内存上的数据作为一个整体来考虑，比如一个整数或是一个字符串。Python中所有的东西都是对象，它们拥有一些相同的内容，这些内容定义在PyObject这个结构体中。</p><pre>typedef struct _object {Py_ssize_t ob_refcnt;struct _typeobject *ob_type;} PyObject;</pre><p>ob_refcnt是一个整形变量，它的作用是实现引用计数机制。比如一个对象A，当有一个新的PyObject *引用该对象时，A的引用计数增加；而当这个PyObject *被删除时，A的引用计数减少。当A的引用计数减少到0时，A就可以从堆上被删除，以释放出内存供别的对象使用。ob_type是一个指向_typeobject结构体的指针，这个结构体实际上也是一个对象，它是用来指定一个对象类型的类型对象，这个类型对象记录了不同的对象所需的内存空间的大小信息。那么简单的说，Python中对象机制的核心一个是引用计数，一个就是类型。</p><p>PyObject是一个定长对象的结构体，对于可变长度对象的结构体是PyVarObject，它比PyObject结构体多一个ob_size变量，用于指定容器中包含的元素数量。比如list中有5个元素，那么PyVarObject.ob_size的值就是5。PyVarObject实际上只是对PyObject的一个扩展而已，任何一个PyVarObject所占用的内存，开始部分的字节定义和PyObject是一样的。这就可以解释说，当Python创建一个整形对象PyIntObject，首先它会为这个对象分配内存，并进行初始化，然后这个对象会由一个PyObject*变量来维护，因为每一个对象都拥有相同的对象头部，这使得对象的引用变得非常的统一。无论对象实际上的类型是什么，只需要通过PyObject*指针就可以引用任意的一个对象。</p><div class=pgc-img><img alt=对于新手来说，Python中有哪些难以理解的概念？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a40a903e03254877812c5c6f2b4cd51c><p class=pgc-img-caption></p></div><p>深入浅出了Python变量赋值的机制以后，大家就不觉得这是难以理解的概念了吧！</p><p><strong>其实学习的乐趣就体现在恍然大悟、融会贯通的那一时刻。</strong></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Python','难以','新手'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>