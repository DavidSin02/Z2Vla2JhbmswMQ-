<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>电气大牛详细讲解《PLC系统通信》，看完就明了（下） | 极客快訊</title><meta property="og:title" content="电气大牛详细讲解《PLC系统通信》，看完就明了（下） - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/6cb647b99e29452c91846d59bfe62a5d"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/80e111da.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/80e111da.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/80e111da.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/80e111da.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/80e111da.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/80e111da.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/80e111da.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/80e111da.html><meta property="article:published_time" content="2020-11-14T21:03:08+08:00"><meta property="article:modified_time" content="2020-11-14T21:03:08+08:00"><meta name=Keywords content><meta name=description content="电气大牛详细讲解《PLC系统通信》，看完就明了（下）"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/80e111da.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>电气大牛详细讲解《PLC系统通信》，看完就明了（下）</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6cb647b99e29452c91846d59bfe62a5d><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/35b9cd253965459a854310d19200f485><p class=pgc-img-caption></p></div><p>上章说到PLC通信中的基本概念以及串口的相关知识，那么本篇文章就给大家结合实例讲述一下：N：N连接通信，双机并行连接通信以及串行同行协议格式等问题我们如何去理解和记忆。</p><p><strong>一、N：N连接通信</strong></p><p><strong></strong></p><p>随着工业生产规模的不断扩大及对自动化水平的要求越来越高，作为工业自动化生产系统中的一种重要的自动控制装置——PLC，其自身的控制能力得到了极大的提高；目前，大型机的控制点数均已超过2048点。尽管如此，单靠不断增加PLC的输入与输出点数已难以满足现代工业控制系统日益复杂的控制功能。因此，PLC控制系统也逐步从单机分散型控制向着多机协同的网络化控制系统发展。PLC与PLC之间的通信称为同位通信，又称为N：N网络。如图7-7 所示为<strong>三菱FX2N 系列PLC与PLC之间的系统连接框图</strong>，该系统由<strong>RS—485通信</strong>所用的 FX2N—485—BD功能扩展模块或特殊适配器连接，可以通过程序数据连接2～8台PLC。各站间，位软元件（4~64点）和字软元件（4～8点）被自动连接，通过分配到本站上的软元件，可知道其他站的ON/OFF 状态和寄存器数值。（该系统中的特殊辅助电器不能作为他用）。</p><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5f3ae17ee79b4db1b25f7497a35539a4><p class=pgc-img-caption></p></div><p>图中0号为主站点，其余为从站点。各站点之间的通信通过FX2N-485-BD的通信接口连接。与N:N网络通信中有关的辅助继电器和数据寄存器（如下所示）。</p><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b215312d09d74db3a475e7cc90dc4d47><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ceb8f48ae38d4222bbc2304c0d989484><p class=pgc-img-caption></p></div><p><strong>N：N网络的个数据寄存器设置如下：</strong></p><p>(1) 工作站号的设置（D8176）。D8176的取值范围在0~7，主站设置为0，从站设置为1~7。</p><p>(2) 从站个数的设置（D8177）。该设置只适用于主站，D8177的设定范围为1~7之间的值，默认值为7.</p><p>(3) 刷新范围的设置（D8178）。刷新范围是指主站与从站共享的辅助继电器和数据寄存器的范围。刷新范围由主站的D8178设置，可以设定为0、1或2（默认值为0）。当为0时，即为模式0；当为1时，即模式1，当为2时，模式2。</p><p>(4) 重试次数的设置（D8179）。D8179的设定范围为0~10（默认值为3），该设置仅用于主站。当通信出错时，主站就会根据设置次数自动重试通信。</p><p>(5) 通信超市时间设置（D80180）。通信超时时主站点与从站点之间的通信驻留时间。D8180的设定范围为5~55，默认值为5，该值乘以10ms就是通信超时时间。该设置仅用于主站。</p><p>注：以上设置只有在程序运行或PLC启动时才有效。</p><p><strong>【实例说明：</strong>通过本实例来说明FX2N PLC通过N:N通信网络配置及通信，为3台FX2N系列的PLC通过N：N网络交换数据结构简图<strong>】。</strong>其硬件接线如下所示：</p><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5ac431ab429040d388959006e9ebeaae><p class=pgc-img-caption></p></div><p>该系统刷新范围设置为模式1，重试次数为3次，通信超时时间为50ms。系统所进行的操作如下：</p><ul><li>通过M1000~M1003，用主站的X0~X3来控制1号从站的Y10~Y13。</li><li>通过M1064~M1067，用1号从站的X0~X3来控制2号从站的Y14~Y17。</li><li>通过M1128~M1131，用2号从站的X0~X3来控制主站的Y20~Y23。</li><li>主站的数据寄存器D1为1号从站的计数器C1提供设定值。C1的触点状态由M1070映射到主站的Y5输出点。</li></ul><p>按照通信控制要求，需要设计主站点设定程序、主站设定程序、主站的通信程序、星战1的程序和从站2的程序，个梯形图程序和对应的指令表（如图）。</p><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/37175043e3354ff9a06526f1119023f6><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/9092f95428324bc386d69ec1680d45b3><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f11d5a27c4e143e985d7a2f2af3a4cf4><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f8b17430ef4e47c8ae20634a5344675f><p class=pgc-img-caption></p></div><p>【实例分析】N：N通信网络设置只有在程序运行或PLC启动时有效。各工作站号由D8176设置，主站为0号，从站为1~7，从站个数最多为7，由D8177设置。本例中为实现由3台FX2N系列的PLC所构建的N：N网络的数据交换所进行的设置。</p><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/f15ef96d17f244479aff03b9f5bc0920><p class=pgc-img-caption></p></div><p><strong>一、双机并行连接通信</strong></p><p>并行连接，用来实现两台一组的FX系列PLC之间的数据自动传送，分组情况如下：</p><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9c0284824b15404783a39b1db482408c><p class=pgc-img-caption></p></div><p>并行连接的工作模式分为两种，即标准模式和告诉模式，由特殊辅助继电器M8162来设置。朱涵与从站之间通过周期性的自动通信相应的辅助继电器和数据寄存器实现数据共享，与并行连接有关的标志寄存器如下：</p><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7b454c7598d44190aebd56b78d8066c8><p class=pgc-img-caption></p></div><p>一般模式的通信示意图以及高速模式通信示意图如下：</p><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c153882977cd4d0493942ed3012649fa><p class=pgc-img-caption></p></div><p><strong>一、计算机连接与无协议数据传输</strong></p><p>在计算机与PLC的通信中，多台PLC通过RS—485接口配适器或接口功能扩展板及数据连接线来实现与一台计算机之间的信息、数据的交换。我们把这种通信网络称为1：N网络。一台计算机可连接的PLC台数可达16台之多。在通信过程中，计算机发出读写PLC数据命令，PLC收到后返回相应。</p><p><strong>1、串行通信协议的格式</strong></p><p>计算机与PLC之间互联通信的实现，在计算机中必须依据互连的PLC的通信协议来编</p><p>写通信程序。FX 系列 PLC 采用异步格式，由|位起始位、7位数据位、1位偶校验位及1位停止位组成，波特率为9600bps，字符为ASCII码，格式如图7-17所示。</p><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5cd53efac6ad4056bfbf7eacbd1beeab><p class=pgc-img-caption></p></div><p>起始位：标志着一个新字节的开始。当发送设备要发送数据时，首先发送一个低电平信号，起始位通过通信线传向接收设备，接收设备检测到这个逻辑低电平后就开始准备接收数据位信号。数据位：起始位之后就是5、6、7或8位数据位，IBMPC中经常采用7位或8位数据</p><p>传送。当数据位为0时，收发线为低电平，反之为高电平。奇偶校验位：用于检查在传送过程中是否发生错误。若选择偶校验，则各位数据位加上校验位使字符数据中为“1”的位为偶数；若选择奇校验，其和将是奇数。奇偶校验位可有可无，可奇可偶。</p><p>停止位：停止位是低电平，表示一个字符数据传送的结束。停止位可以是一位、一位半C 或两位。在两个串行通信设备进行任意通信前，必须对上述参数如传送数据的信息格式，包括起始位、数据位、奇偶校验位、停止位和波特率等，在通信双方中设置一致，才可进行可靠的通信，该设置是由 PLC中的特殊数据寄存器D8120设定的。</p><p>D8120的通信格式设定如下所示：</p><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/11fd7427466e47ebbdc605b3d2bdd12d><p class=pgc-img-caption></p></div><p>其中，60为最低位，b15为最高位。D8120上述参数设定后关闭PLC电源，而后重新接通电源后，则计算机与PLC的通信格式就确定了。</p><p>通信格式要求：数据长度为8位，偶校验，1个停止位，传输速率19200bit/s，无起始位</p><p>和结束位，无校验和，计算机连接协议，RS—232C接口，控制协议格式1。</p><p>基于表7-7可知，D8120设置对应的二进制值为0100 1000 1001 0111；对应的十六进制数为4897H。</p><p><strong>2、计算机连接通信协议</strong></p><p>在计算机连接通信中，计算机和PLC之间有三种数据传递形式：计算机从PLC中读数据、计算机向PLC写数据、PLC向计算机写数据。</p><p><strong>（1）数据传输的基本格式</strong></p><p>数据传输的基本格式如图7-18 所示。通过特殊寄存器D8120的b15位，可以选择计算机连接协议的两种格式（格式1和格式4），报文末尾上控制代码CR/LF（回车、换行符）只有在控制协议格式4时才有，只有当数据寄存器D8120的b13位置为1时，PLC才在报文中</p><p>加上校验和代码。</p><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/696bdeb799b44e48bc41f2dfe7602a82><p class=pgc-img-caption></p></div><p><strong>（2）计算机读取PLC数据的数据传输格式。</strong></p><p>这里以协议1为例，介绍计算机读取PLC数据传输格式。</p><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d2b95cee3e4f4e769f336033d5b10d8a><p class=pgc-img-caption></p></div><p><strong>（3）计算机向PLC写数据的数据传输格式</strong></p><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c371d0f913cf448aae43b326ba7dea22><p class=pgc-img-caption></p></div><p>计算机首先向PLC发送写数据命令报文，（图中A区），PLC收到计算机的命令后，执行相应操作，然后向计算机发送确认报文（图中B区以STX开头的报文），表示写操作已执行。若计算机发送的写命令有错误或者在通信过程中出现了错误，PLC将向计算机发送图中B部分的以NAK 开头的报文，通过错误代码告诉计算机产生通信错误的可能原因。</p><p><strong>2、对控制协议各部分说明</strong></p><p>（1）控制代码，计算机连接的控制代码如下所示：</p><div class=pgc-img><img alt=电气大牛详细讲解《PLC系统通信》，看完就明了（下） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d3b91e34f0b94ca6b3bdcb06ec173f65><p class=pgc-img-caption></p></div><p>（1）站号</p><p>用来确定计算机所访问的PLC。</p><p>（2）PC号</p><p>FX系列PLC的PC号是由十六进制数FF代表的。</p><p>（3）消息等待</p><p>一些计算机在发送和接收状态转换时需要一定的延迟时间。</p><p>（4）命令</p><p>用来指定要求的操作，如读、写等。命令用量为ASCII字符定义。</p><p>（5）效验代码</p><p>用来效验接收到的信息中数据正确与否。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'电气','详细','讲解'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>