<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>【一文读懂】磁编码器的前世今生 | 极客快訊</title><meta property="og:title" content="【一文读懂】磁编码器的前世今生 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/8a54579c5828483983cdb7b1a3d0fd02"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8445500.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8445500.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8445500.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8445500.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8445500.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8445500.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8445500.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8445500.html><meta property="article:published_time" content="2020-10-29T21:04:14+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:14+08:00"><meta name=Keywords content><meta name=description content="【一文读懂】磁编码器的前世今生"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/8445500.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>【一文读懂】磁编码器的前世今生</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><span>磁感应传感器很早就有出现了,霍尔感应的和磁阻感应的，但真正作为商品磁感应编码器,大约出现在2005年至2006年初。当时奥地利微电子推出了AS5040系列磁感应芯片（AS5040,AS5043，AS5045等）。</span></p><p><span>我在2006年底开始测试试验AS5043芯片，在2007年开发AS5045磁编的应用。其中AS5045输出12位串行信号，或者256脉冲的AB相信号，给与编码器厂家极大的制作磁编方便性，简单的电源配置加机械转轴和外壳，即可快速生产出磁感应编码器，而早期的磁编芯片，仅仅是为替换电位器而设计的。</span></p><div class=pgc-img><img alt=【一文读懂】磁编码器的前世今生 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8a54579c5828483983cdb7b1a3d0fd02><p class=pgc-img-caption>单极磁编码器原理示意图</p></div><p><span>AS5045（包括AS5040,AS5043）很快成为了一款卖了十多年的经典磁编芯片，一个小扁圆体的横向NS磁极的磁铁，产生一个看不见却物理存在的磁场，如果有铁粉撒在下面，你可以看到磁力线及磁场强度弱或强。AS5045设计了四个正交的霍尔传感器，这四个霍尔传感器代替了铁粉来感应小磁铁磁场强度的强弱变化，好比这样的磁场类似于是一张磁场地图，每一个位置感应到的磁场强度都是唯一的，在磁编芯片内已经与设计的饱和磁场做了图形预设，在测量中与设计磁场地图做比对，即可快速获得在地图上的位置。</span></p><p><strong>霍尔效应从本质上讲</strong>是运动的带电粒子在磁场中受洛仑兹力作用引起的偏转。当带电粒子（电子或空穴）被约束在固体材料中，这种偏转就导致在垂直电流和磁场的方向上产生正负电荷的聚积，从而形成附加的横向电场。检测这种横向电压差的变化,成为霍尔传感器。</p><div class=pgc-img><img alt=【一文读懂】磁编码器的前世今生 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/aa0f3daefcbf4fd5a73ab477c7ae24e8><p class=pgc-img-caption>磁铁与传感器圆心对齐</p></div><p><span>在2007年，RLS公司推出了另一款经典磁编AM8192磁编芯片，信号输出达到了13位。RLS公司后被雷尼绍收购，雷尼绍敏锐的发觉单磁极磁编做到13位似乎已是顶峰了，转而发展多磁极（多磁场）方向，并在几年后发展了大孔径绝对值磁编，可用于机器人手臂关节的全闭环测量。</span></p><p><span>同时，另一种磁感应原理也没有停步——磁阻原理。</span></p><p><strong>磁阻的原理</strong><span>在于某些半导体材料对于磁场强度的敏感性，引起其阻抗值的变化，通过饱和磁场与惠斯通电桥的预先平衡，当磁场强度发生改变，电桥平衡改变，而检测出磁场的变化。磁阻传感器最初是背磁式感应原理获得突破，并在增量式齿轮传感编码器上获得成功。在磁阻感应芯片的背后加入一个较强的磁体，穿透磁阻感应芯片，给前方产生一个磁场，芯片处于饱和磁场中央。当前方有铁磁性材料出现，影响了芯片内原有磁场分布，磁阻敏感地发生阻抗变化，并被电桥检测出来。</span></p><div class=pgc-img><img alt=【一文读懂】磁编码器的前世今生 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/237e760dcb0548e2b61911bd3c26974f><p class=pgc-img-caption>磁阻的原理</p></div><p><strong>磁阻的敏感度比霍尔感应更快更敏感，其响应速度优于霍尔感应</strong>，适合于高速的旋转齿轮测量，经过芯片波形整定输出正余弦信号，再可细分成更高分辨率的方波脉冲信号，目前这种背磁式磁编有多家磁编芯片厂家提供，用于高速电主轴的转速测量，最高测量转速已可达40000RPM。</p><p><span>在单对圆形NS磁极的上方感应型，与经典的霍尔感应原理（AS5045）相似的安装方式方面，磁阻厂家也不甘寂寞，霍尼韦尔、英飞凌、安华高等也都推出了相对应的产品。例如2011年英飞凌的TLE5012,12位或15位的信号输出。</span></p><p><span>因为磁阻感应的灵敏度比霍尔式的高，响应也快，磁阻传感器芯片厂家信心满满，意图在高分辨率上有比霍尔原理有更多的突破，英飞凌的15位，安华高的16位纷纷登场。但是，</span><strong>灵敏度高同时意味着噪音引入也高，而且阻抗这玩艺不仅仅对磁场敏感，对温度对周边电气环境一样的敏感</strong><span>，在12位以上的几种磁阻传感器上，输出的最后几位都是飘忽不停的。需要用平均算法稳定下来，这又牺牲了磁阻响应较快的优势。</span></p><p>在霍尔感应方面，2015年奥地利微电子在奋斗了十年后，终于将AS5040系列的输出再提高了2位，推出了AS5047,能够输出14位信号，而其增量脉冲信号只有AB相的1024PPR，经过四倍频也只有12位（4096）。</p><p>后起之秀日本的旭化成（AKM），主攻伺服电机的磁编,以稳定的增量脉冲输出信号为突破，2014年推出AK7451,有较为稳定的AB相1024PPR方波脉冲输出，其利用日本工业体系半导体技术较为领先的优势，在增量方波信号处理上输出的波形确实比AS5047漂亮。旭化成计划今年推出的AK7452,输出2500PPR方波脉冲和UVW信号，大有取代目前伺服市场上大量的2500线UVW光编趋势。</p><div class=pgc-img><img alt=【一文读懂】磁编码器的前世今生 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a607ccfca3ff4e5abc2c688cc3f2c5ad><p class=pgc-img-caption>AK7451原理图黑匣子</p></div><p>另外有一群磁编厂家，以游标式多磁极磁编为发展方向，例如TIMKEN，IC-haus等等。</p><p>在国内，以江苏多维电子为首的一批磁编芯片厂家也在兴起，多维电子是以磁阻为基本原理，( GMR or TMR?) 隧道磁阻？仍然是阻抗对于磁场敏感度的捕捉原理。期待国产的磁编芯片能够尽快赶上。</p><p>十年间全球磁编芯片厂家各显神，群雄并起。但只是在奋斗了十几年后，单对磁极的磁编分辨率有效性也仅仅在14位，而增量脉冲输出式的在12~13位。</p><p><strong>而磁编的精度更是在0.3度至1度之间难以与光编的精度匹敌。</strong></p><p><span>那么是什么限制了磁编在分辨率和精度上升的空间？</span></p><p>磁编的“第一原理”是什么？</p><p>第一性原理（First principle thinking，又称“第一原理”），是古希腊哲学家亚里士多德提出的一个哲学术语：</p><p>每个系统中存在一个最基本的命题，它不能被违背或删除。</p><p><strong>是磁铁是磁场的分辨率与精度是有限的！</strong>不管是霍尔还是磁阻，不管是正面对磁场还是背磁式，所有的磁编都要有用到这个磁铁产生的磁场。磁铁是不能被删除被忽略的。</p><p>我们生活在地球上，地球的磁场不在南北极中心（尽管我们把磁极用NS表示），也不在一个明确固定的点上，而是一个范围，随着地球表面下地幔的运动，磁极在缓慢的漂移。</p><p>而目前磁编用的磁铁都是经济的1元左右通过简单快速充磁获得（经济性恰恰是磁编较之于光编的竞争优势），充磁设备与磁场检测设备的精度都有局限性，目前较高的也仅为0.2%，折算到分辨率位数是512（9位）。磁铁在使用中因材质表面也会发生“微火山”“陨石坑”和铁屑堆积的磁场变化。</p><p><strong>其次，磁编都是通过磁场强度的模拟量变化</strong>，这种感应都还不是线性的，需要磁编芯片线性拟合，这对于每一个充磁获得的磁铁都是不一样，（没有更高精度的磁场检测装备，也没有人工去检测校准每个磁铁的线性度一致性）。NS分布的中心线并不是一个明确的界限，而是一个虚线，而且还不一定直线。</p><p><br></p><div class=pgc-img><img alt=【一文读懂】磁编码器的前世今生 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1f5dd8cc256548c38013669bc83644aa><p class=pgc-img-caption>几乎所有的磁编芯片都要经过非线性修正，到一个接近于正余弦信号的波形</p></div><p><span>几乎所有的磁编芯片都要经过非线性修正，到一个接近于正余弦信号的波形。</span></p><p><br></p><div class=pgc-img><img alt=【一文读懂】磁编码器的前世今生 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b1670935b9e34dbfa095776dbc1d1f3c><p class=pgc-img-caption>需要大量修正工作</p></div><p><strong>所有的补偿修正都是以牺牲响应速度为代价的</strong>，然而还有磁编是感应型的有磁滞现象，还有AD转换运算滞后的时间差，在对于已经运动的磁编测量还会带来运动时间差的角度偏差。</p><div class=pgc-img><img alt=【一文读懂】磁编码器的前世今生 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/90e398a74abb41afad532c3995da9fcd><p class=pgc-img-caption>安装偏差</p></div><p><strong>这些都是磁编用经济性磁铁的局限性造成的先天不足。</strong>当然，也许可以在磁铁材质与充磁精度上下足文章，并在磁场检测设备和每一个磁铁严格检测上下足文章（人工投入），但是那样的磁编成本将远远大于光编了，也就失去了磁编的低成本竞争力。而磁编在运动后在响应时间上的损失却是无法补偿的。</p><p><span>那么，按照第一性原理的思维，磁铁及磁场和它的感应式原理是无法绕过的。</span><strong>磁编的突破就要在磁铁与磁场上动脑精</strong><span>，在360度一周内分割出更多的磁铁或更多对磁场分布，才能提高磁编的分辨率与精度。多对磁极磁编以及背磁式游标磁编，就是这样的思维下被开发出来了</span></p><p>假如我来做一个单对磁极17位磁编</p><p>当全球知名磁编芯片厂家经过多年努力下，单对磁极的磁编还停在13位14位时，最近两年国内市场却纷纷冒出了低成本单对磁极的17位甚至更高位数的磁编，究竟是哪路大神可以突破磁编第一性原理做得出这个高分辨率来？</p><p>我仔细想想我十年前最初拿着AS5045资料学习的时候所想的问题，答案其实早在十年前就已经有了。那么好吧，就好比让我来做一个17位磁编，挖一下这个单对磁极17位磁编的坑。</p><p><strong>第一个小技巧：选择模拟信号的磁编芯片</strong>，数字串行输出的原先是多少位的，只有省略减少位数却不能再增加位数了，而模拟信号可以接近无限的AD转换“细分”，靠芯片“分出”很高的分辨率来。</p><p><strong>第二个小技巧：选择数字串行信号做输出</strong>，不能做AB相增量输出。我在前面讲到AS5047数字串行输出的是14位，而AB相输出1024脉冲的经过四倍频也只是12位，为什么做增量脉冲输出的少掉了2位？这是因为数字输出的可以跳数可以反序，例如123，67，45，89，到17位时有13万个数，你会一格格极为缓慢的转动编码器去验证每个数的顺序吗？</p><p>也没有这个条件如此慢并高精度控制转速的去一格格读它的顺序，这样也就没人能看出破绽了。但是AB相增量脉冲却不行，当有跳数反序，输出的AB相位差就乱了，读数计数器计数的累加就是错的了，这就好比要求南郭先生一个个吹竽无法再滥竽充数了。记住，必须输出数字串行信号，决不能提AB相增量脉冲输出。</p><p><strong>第三个小技巧：叫“补偿技术”</strong>，补偿是基于重复精度的对单信号周期误差的补偿，是基於单信号品质不佳，但虽然有误差却仍然有一定的规律性，对于这样的误差规律性进行补偿。磁铁磁场非线性没关系，装歪了装斜了都没关系，只要在编码器安装磁铁与电路板后的首次通电时转一下，读取输出波形并与理想波形对比，用芯片寄存补偿。以后还会变吗？这不是刻舟求剑吗？没有关系只要出厂一个月是好的就够了。</p><p><strong>第四个小技巧：叫“校准技术”</strong>，基于重复精度的校准。重复精度是在大行程精度不够的情况下，强调单信号角度位置每次的重复性。在已经细分后的角度值，经过与高精度的校准仪器对比，逐点寄存误差量并修正，这种做法称之为“校准”。校准是基於单信号周期已有的重复精度，对于大行程偏差的一种修正。</p><p>磁编装好后与一个较高精度的光编轴对轴的转一圈，寄存偏差并校准补回去，保存在磁编芯片了。反正一出厂刚刚校准过的，准啊。以后会不会不准了再回厂校准？就像汽车行驶一段公里数要保养一次那样？出厂后谁管它啊。</p><p><strong>第五个小技巧：叫“低通滤波”</strong>，说白了就是读取一百次算平均值吧，这个在当初AS5045和TLE5012的厂家都已经主动在教我的小技巧了，它可以过滤掉各种噪音与毛刺，没什么神秘的。这在低速的读数眼睛能看到的很稳定，没有跳数的，用于低速测量。至于输出刷新速率，还有前面的运动后磁滞损失、校准与补偿时间损失，总体结果大约几个Hz响应吧。如果再有点技巧，在芯片里面设定一个转速计算，当低速时自动增加采样数多一点读数做平均值。</p><p><strong>第六个小技巧：叫脸皮要厚！</strong>这样只是刻舟求剑式的慢速的好看的小技巧有用吗？很管用！因为用经济型17位编码器的用户可能还不太懂磁编，也有可能即使懂了其实也只是买个安慰剂，或者更便于伺服电机的销售——经济级伺服也用上了高大上的17位绝对值编码器了，那样更好卖。这些经济的伺服他们的机械结构精度、他们的减速机精度以及他们的控制器刷新与响应速度都还没有那么高，足够可以掩盖一个单对磁极17位磁编的毛刺与假象了。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'磁编','码器','今生'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>