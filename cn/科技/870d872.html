<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>分析报告还不会用动态分析？利用Power BI参数轻松实现 | 极客快訊</title><meta property="og:title" content="分析报告还不会用动态分析？利用Power BI参数轻松实现 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/16a56bac60d04e0da4bd5f9f46b020e5"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/870d872.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/870d872.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/870d872.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/870d872.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/870d872.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/870d872.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/870d872.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/870d872.html><meta property="article:published_time" content="2020-10-29T20:58:18+08:00"><meta property="article:modified_time" content="2020-10-29T20:58:18+08:00"><meta name=Keywords content><meta name=description content="分析报告还不会用动态分析？利用Power BI参数轻松实现"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/870d872.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>分析报告还不会用动态分析？利用Power BI参数轻松实现</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p class=ql-align-justify><br></p><div class=pgc-img><img alt="分析报告还不会用动态分析？利用Power BI参数轻松实现" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/16a56bac60d04e0da4bd5f9f46b020e5><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify>静态的分析经常不能满足实际分析的需要，还需要引入动态分析，通过调节某个维度的增减变化来观察对分析结果的影响。在PowerBI中，可以使用「参数」，以切片器的形式来控制变量，与其他指标进行交互，进而完成动态分析。</p><h1 class=ql-align-justify><strong>创建「参数」</strong></h1><p class=ql-align-justify>在PowerBI Desktop中，在“建模”选型卡下，点击“新建参数”，</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="分析报告还不会用动态分析？利用Power BI参数轻松实现" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fb48b6363d644b33963614e45d622b4f><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>然后将出现这个窗口，</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="分析报告还不会用动态分析？利用Power BI参数轻松实现" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8f81634f3d1d486d8f74f290df848785><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>比如按照以上默认的值建立的参数就是建立一个从0到20的整数序列：0、1、2、3……20，点击确定，画布上将出现一个切片器，这是因为新建参数时，左下角有个默认选项：将切片器添加到此页，通过滑动切片器可以调整参数的数值，</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="分析报告还不会用动态分析？利用Power BI参数轻松实现" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/815dc539caa2437e90bcd3cb890cb579><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>在数据视图下，可以看到这个参数表，</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="分析报告还不会用动态分析？利用Power BI参数轻松实现" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1d733e83756f49aba7f875f3f7143094><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>其实就是利用DAX函数GENERATESERIES新建了一个表而已，只是这里是通过图形界面点击的方式创建的，并且通过新建参数的方式，不只是新建了这张表，同时也新建了一个度量值，并自动添加到数据模型中，可以在整个报表中使用，通过右边的字段区可以看到这个度量值，</p><blockquote>参数 值 = SELECTEDVALUE('参数'[参数])</blockquote><p class=ql-align-justify><br></p><p class=ql-align-justify>这个度量值就是提取被选中的参数值，切片器滑到哪个数值，该度量值就返回什么数值，正是通过这个切片器和这个度量值的结合，来自由的控制变量，以下就通过几个实例来看看参数是如何实现动态分析的。</p><h1 class=ql-align-justify><strong>TopN分析</strong></h1><p class=ql-align-justify>假设有全国每个省市的GDP金额，想知道GDP排名前5位GDP之和，可以这样写度量值：</p><blockquote>GDP = SUM('各省市GDP'[金额])前5名GDP = CALCULATE([GDP],TOPN(5,ALL('各省市GDP'[地区]),[GDP]))</blockquote><p class=ql-align-justify><br></p><p class=ql-align-justify>这里使用了<strong>函数TOPN，第一个参数就是要返回的行数，第二个参数是被筛选的表，第三个参数是排序依据，还有第四个可选参数，默认为0按降序排列，就是提取前N位的行数；如果为1，就是按降序排列，将返回最小的N行。</strong></p><p class=ql-align-justify>这个度量值是计算前5名之和，如果想知道前10名，把TOPN的第一个参数改为10即可，但是在分析过程中我们不能总是手动更改度量值，这时就可以利用参数来自动实现。</p><p class=ql-align-justify>新建一个从1到10的参数，自动生成的度量值为了更具可读性可以重命名为[TOPN参数],然后把这个度量值来替换TOPN函数的第一个参数，更改上面的这个度量值：</p><blockquote>前N名GDP = CALCULATE([GDP],TOPN([TOPN参数],ALL('各省市GDP'[地区]),[GDP]))</blockquote><p class=ql-align-justify><br></p><p class=ql-align-justify>然后就可以通过拖动切片器来实现动态的TOPN分析了，</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="分析报告还不会用动态分析？利用Power BI参数轻松实现" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/c0bb27d317e448798727a6533d270d55><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><h1 class=ql-align-justify><strong>动态移动平均</strong></h1><p class=ql-align-justify>在分析股价走势图时，经常用到30日均线、60日均线等，<strong>使用移动平均线可以熨平每日价格的剧烈波动，让用户能更清晰看到长期的变化趋势</strong>。</p><p class=ql-align-justify>30日均线就是向前推30天的均价折线图，60天均线、120天均线以此类推，我们先建立一个参数GENERATESERIES(30，120，30)，以及度量值：[移动平均参数]。</p><p class=ql-align-justify>由于股市不是每天都开盘的，所以不能直接用自然日期表向前推N天，这里直接在每日股价走势数据中添加编号，编写度量值：</p><blockquote>N天均线 = AVERAGEX(filter(all('股价走势'),'股价走势'[编号]&lt;=VALUES('股价走势'[编号])&&'股价走势'[编号]>=VALUES('股价走势'[编号])-[移动平均参数]),'股价走势'[收盘价])</blockquote><p class=ql-align-justify><br></p><p class=ql-align-justify>AVERAGEX函数是一个迭代函数，可以将筛选出的表依据最后一个参数取算术平均值，控制移动平均天数的就是<strong><em>'股价走势'[编号])-[移动平均参数]</em></strong>，将这个度量值和收盘价维度同时放入到折线图中，</p><div class=pgc-img><img alt="分析报告还不会用动态分析？利用Power BI参数轻松实现" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e75980c95ca44a4d9f82d996714f6680><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify>可以直观的看出，天数越长的均线越平滑，走势越稳定。</p><h1 class=ql-align-justify><strong>动态折扣率</strong></h1><p class=ql-align-justify>如果要测算对商品进行打折的情况下的销售额，可以新建一个折扣率参数GENERATESERIES(0.5，1，0.1)，假设最低打5折，设置最小值为0.5，注意这里的数据类型选择“十进制数字”，</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="分析报告还不会用动态分析？利用Power BI参数轻松实现" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c0c3950db25f44fe9fda72111b7e3af7><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>参数度量值重命名为[折扣率参数]，原有计算销售额的度量值假设为[销售额]，新建一个度量值：</p><blockquote>折扣销售额=[销售额]*[折扣率参数]</blockquote><p class=ql-align-justify><br></p><p class=ql-align-justify>将这个度量值和原来的[销售额]同时放入到柱形图中，</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="分析报告还不会用动态分析？利用Power BI参数轻松实现" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/75323a259c454baa82721652f24db5a5><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>通过切片器选择不同的折扣率就可以动态的展示折后的销售情况。</p><p>关于参数就介绍到这里，参数的更多应用场景，可以根据这里的例子举一反三，使用方法类似。公众号回复“PowerBI”获取145页入门资料，2019年，掌握一个新技能，Fighting！</p><p><strong>THE END</strong></p><p class=ql-align-justify><strong>.</strong></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'报告','还不会','用动态'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>