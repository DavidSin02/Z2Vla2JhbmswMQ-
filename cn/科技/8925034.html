<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>如何禁止公司内网主机访问外网？ | 极客快訊</title><meta property="og:title" content="如何禁止公司内网主机访问外网？ - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/RZecx6II5jZ2WA"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8925034.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8925034.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8925034.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8925034.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8925034.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8925034.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8925034.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8925034.html><meta property="article:published_time" content="2020-10-29T21:05:53+08:00"><meta property="article:modified_time" content="2020-10-29T21:05:53+08:00"><meta name=Keywords content><meta name=description content="如何禁止公司内网主机访问外网？"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/8925034.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>如何禁止公司内网主机访问外网？</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>有朋友多次问到，如何让企业的某个部分只能访问内网，不能访问外网，这个在企业实际应用中非常广泛，为了保密，会使企业的部分网络禁止与外部通信。</p><p>这里面我们就需要用到ACL了，首先我们来了解下ACL，ACL即访问控制列表，那么它有什么作用呢？</p><p></p><h2><strong>ACL的作用</strong></h2><p>1、ACL可以限制网络流量、提高网络性能。例如，ACL可以根据数据包的协议，指定数据包的优先级。</p><p>2、ACL提供对通信流量的控制手段。例如，ACL可以限定或简化路由更新信息的长度，从而限制通过路由器某一网段的通信流量。</p><p>3、ACL是提供网络安全访问的基本手段。ACL允许主机A访问人力资源网络，而拒绝主机B访问。</p><p>4、ACL可以在路由器端口处决定哪种类型的通信流量被转发或被阻塞。例如，用户可以允许E-mail通信流量被路由，拒绝所有的Telnet通信流量。</p><p>例如：</p><p>某部门要求只能使用 WWW 这个功能，就可以通过ACL实现；</p><p>又例如，</p><p>为了某部门的保密性，不允许其访问外网，也不允许外网访问它，就可以通过ACL实现。</p><p>那么我们来看下实例，如何实现使用 ACL 限制内网主机访问外网。</p><p><strong>1、案例</strong></p><p>某公司通过交换机实现各部门之间的互连。现要求Switch能够禁止研发部和市场部的部分主机访问外网，防止公司机密泄露。以华为例。</p><p><strong>1、拓扑图</strong></p><img alt=如何禁止公司内网主机访问外网？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RZecx6II5jZ2WA><p><strong>2、配置思路</strong></p><p>采用如下的思路在Switch上进行配置：</p><p>1、配置基本ACL和基于ACL的流分类，使设备可以对研发部与市场部的指定主机的 报文进行过滤。</p><p>2、配置流行为，拒绝匹配上ACL的报文通过。</p><p>3. 配置并应用流策略，使ACL和流行为生效。</p><p><strong>步骤1 配置接口所属的VLAN以及接口的IP地址</strong></p><p># 创建VLAN10和VLAN20。</p><p>&lt;HUAWEI> system-view</p><p>[HUAWEI] sysname Switch</p><p>[Switch] vlan batch 10 20</p><p># 配置Switch的接口GE0/0/1、GE0/0/2为trunk类型接口，并分别加入VLAN10和 VLAN20；配置Switch的接口GE0/0/3为trunk类型接口，加入VLAN10和VLAN20。</p><p>[Switch] interface gigabitethernet 0/0/1</p><p>[Switch-GigabitEthernet0/0/1] port link-type trunk</p><p>[Switch-GigabitEthernet0/0/1] port trunk allow-pass vlan 10</p><p>[Switch-GigabitEthernet0/0/1] quit</p><p>[Switch] interface gigabitethernet 0/0/2</p><p>[Switch-GigabitEthernet0/0/2] port link-type trunk</p><p>[Switch-GigabitEthernet0/0/2] port trunk allow-pass vlan 20</p><p>[Switch-GigabitEthernet0/0/2] quit</p><p>[Switch] interface gigabitethernet 0/0/3</p><p>[Switch-GigabitEthernet0/0/3] port link-type trunk</p><p>[Switch-GigabitEthernet0/0/3] port trunk allow-pass vlan 10 20</p><p>[Switch-GigabitEthernet0/0/3] quit</p><p># 创建VLANIF10和VLANIF20，并配置各VLANIF接口的IP地址。</p><p>[Switch] interface vlanif 10</p><p>[Switch-Vlanif10] ip address 10.1.1.1 24</p><p>[Switch-Vlanif10] quit</p><p>[Switch] interface vlanif 20</p><p>[Switch-Vlanif20] ip address 10.1.2.1 24</p><p>[Switch-Vlanif20] quit</p><p>这里面普及下vlanif接口和vlan端口的区别：</p><p><strong>（1）vlan端口：</strong>是物理端口，通常我们通过配置access vlan 10 使某个物理接口属于vlan 10</p><p><strong>（2）vlan if ：</strong>interface vlan 是逻辑端口，通常这个接口地址作为vlan下面用户的网关。</p><p><strong>步骤2 配置ACL</strong></p><p># 创建基本ACL 2001并配置ACL规则，拒绝源IP地址为10.1.1.11和10.1.2.12的主机的报 文通过。</p><p>[Switch] acl 2001</p><p>[Switch-acl-basic-2001] rule deny source 10.1.1.11 0 //禁止IP地址为10.1.1.11的主机访问外网</p><p>[Switch-acl-basic-2001] rule deny source 10.1.2.12 0 //禁止IP地址为10.1.2.12的主机访问外网</p><p>[Switch-acl-basic-2001] quit</p><p><strong>步骤3 配置基于基本ACL的流分类</strong></p><p>#配置基于基本ACL的流分类 # 配置流分类tc1，对匹配ACL 2001的报文进行分类。</p><p>[Switch] traffic classifier tc1 //创建流分类</p><p>[Switch-classifier-tc1] if-match acl 2001 //将ACL与流分类关联</p><p>[Switch-classifier-tc1] quit</p><p><strong>步骤4 配置流行为</strong></p><p># 配置流行为tb1，动作为拒绝报文通过。</p><p>[Switch] traffic behavior tb1 //创建流行为</p><p>[Switch-behavior-tb1] deny //配置流行为动作为拒绝报文通过 [Switch-behavior-tb1] quit</p><p><strong>步骤5 配置流策略</strong></p><p># 定义流策略，将流分类与流行为关联。</p><p>[Switch] traffic policy tp1 //创建流策略</p><p>[Switch-trafficpolicy-tp1] classifier tc1 behavior tb1 //将流分类tc1与流行为tb1关联</p><p>[Switch-trafficpolicy-tp1] quit</p><p><strong>步骤6 在接口下应用流策略</strong></p><p># 由于内网主机访问外网的流量均从接口GE0/0/3出口流向Internet，所以可以在接口 GE0/0/3的出方向应用流策略。</p><p>[Switch] interface gigabitethernet 0/0/3</p><p>[Switch-GigabitEthernet0/0/3] traffic-policy tp1 outbound //流策略应用在接口出方向</p><p>[Switch-GigabitEthernet0/0/3] quit</p><p><strong>3、验收配置结果</strong></p><p># 查看ACL规则的配置信息</p><img alt=如何禁止公司内网主机访问外网？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RZecx6ZJCtxX7G><p># 查看流分类的配置信息。</p><img alt=如何禁止公司内网主机访问外网？ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RZecx6n6aZfhk1><p># 查看流策略的配置信息。</p><img alt=如何禁止公司内网主机访问外网？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RZecx6y1E4U3N1><p>IP地址为10.1.1.11和10.1.2.12的主机无法访问外网，其他主机均可以访问外网。</p><p>最新弱电资料更新—弱电最新各类经典项目ppt方案（8月4日）</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'内网','主机访','问外网'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>