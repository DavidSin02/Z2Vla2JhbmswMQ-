<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>传感器节点控制器 – 助力未来连网传感器 | 极客快訊</title><meta property="og:title" content="传感器节点控制器 – 助力未来连网传感器 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/ROMUp42ABcViLU"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8c87408f.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8c87408f.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8c87408f.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8c87408f.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8c87408f.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8c87408f.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8c87408f.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8c87408f.html><meta property="article:published_time" content="2020-10-29T21:11:31+08:00"><meta property="article:modified_time" content="2020-10-29T21:11:31+08:00"><meta name=Keywords content><meta name=description content="传感器节点控制器 – 助力未来连网传感器"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/8c87408f.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>传感器节点控制器 – 助力未来连网传感器</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p></p><h4>传感器节点控制器 – 助力未来连网传感器</h4><h5>2019-04-22</h5><h5>Marios Iliopoulos, Fotios Kerasiotis, Nikolaos Moschopoulos</h5><p><strong>引言</strong></p><p>今天的便携式设备通过持续的活动监测和情境感知来了解周围环境。为了实现这个功能，设备集成了越来越多的传感器和外设，由此产生大量数据。这反过来使得集成更强大的CPU变得很有必要，以便执行越来越多的计算。同时，必须缩小设计尺寸，降低成本和功耗，但又不牺牲最终产品不断提升的功能要求。</p><p>传感器中枢（Sensor hub）的概念被越来越多地采用到当今的SoC设计中，以满足“始终运行”的传感器/外设访问和控制（甚至以高速率）的要求，而且不会增加功耗和设计成本。传感器中枢可以是小型CPU内核，与传感器/外设连接，并通过执行后台操作并仅在需要时“唤醒”主处理器，充当功耗较大的主处理器的卸载引擎的角色。</p><p><strong>用于传感器采集的基于处理器的典型架构</strong></p><p>应用在集成多个传感器的系统中的典型基于微控制器的架构包括以下组件<sup>[1]</sup>：</p><p>a)一个微控制器单元（MCU） - 也称为处理子系统，MCU控制系统内所有构成部分的运行并处理数据。它包括一个处理器、一个内部或外部存储器、以及本地数据处理所需的所有外设和子系统。在典型的基于MCU的架构中，控制器执行所有传感器数据收集、处理和存储。</p><p>b)传感器元件（或传感子系统） - 一组传感器，可以是无源或有源，数字或模拟的任意组合。这些传感器将来自外部环境的输入信息转换成电信号。在大多数应用中，传感器用于监测运动、光、气压、振动、流速、温度、通风、电等。通常来说，传感器元件在其输出端生成电压或电流信号。在数据被处理、存储和传输之前，这些信号一般会被放大，并通过模数转换器转换成数字信号。</p><p>c)无线电 - 一种短距离收发器，提供与主机的无线通信。</p><p>d)电源子系统 - 通常连接到电池或能量采集器。该子系统充当可控单元，可单独打开和关闭系统构建块的电源。它通常是MCU软件中的一个软件块。电源子系统负责为每个单独的硬件组件提供合适的电源电压。</p><p>在具有多个传感器的更复杂的基于微控制器的架构中，在硬件中集成了智能，用来控制各种子系统。 例如，从传感器到存储器传输数据耗时又耗电，这一部分工作其实可以从处理器转移到直接内存存取（DMA）单元。电源管理单元（PMU）还可以被编程为对特定事件做出反应并关闭各种子系统，例如外设、传感器和无线电。</p><img alt="传感器节点控制器 – 助力未来连网传感器" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ROMUp42ABcViLU><p><em>图1. 基于微控制器的典型架构</em></p><p>这种先进架构的目的是尽可能减少主MCU活跃的时间。原来需要MCU干预的任务，现在可以由智能子系统执行。然而，还存在一个问题，就是每次有来自传感器、无线电或各种子系统的事件时，MCU都需要被唤醒，因为它是唯一可以部署逻辑来处理这些事件的元件。</p><p><strong>优化功率的技术 - 添加传感器节点控制器</strong></p><p>为了延长具有多个传感器的系统的续航时间，已经提出了很多种降低功耗的技术<sup>[2]，[3]</sup>。有些技术在媒体访问控制层面进行节能<sup>[4]，[5]</sup>，有些技术从数据聚合或融合著手<sup>[6]，[7]</sup>，有的则采用芯片设计优化技术，如片上功率门控<sup>[8]</sup>或动态电压调节<sup>[9]</sup>。</p><p>本文介绍了一种不同的技术，来优化多传感器系统中的电源使用，同时将主处理器用于数据采集的唤醒时间控制到最短。该技术基于集成复杂的硬件状态机，可以接管主处理器上的重复性任务，如传感器轮询和读取，从而实现集成的低功耗传感器中枢概念。专用硬件状态机可以更快地唤醒，并使用更少的模块来将数据从传感器/外设传输到内存，以及反向传输，而主处理器保持休眠状态。此外，传感器中枢可以对数据执行简单操作，因此主处理器只需要在要求复杂数据操作时唤醒。</p><p>这种方法的一个很好的例子，是集成在Dialog半导体公司的DA1469x蓝牙低功耗SoC解决方案中的传感器节点控制器（SNC）硬件模块<sup>[10]</sup>。SNC是一种微型硬件状态机，能运行由有限的指令集组成的微码（μcode），有助于开发人员操控通信控制器（即SPI、I2C等）、传感器和外设。它可以通过使用其最小指令集自动运行，无需唤醒系统的其余部分。这允许它执行众多操作 - 例如：轮询传感器状态位、比较寄存器与内存地址内容（值）、将数据从通信接口传输到系统RAM以及比较分支 - 同时消耗最低电流。</p><img alt="传感器节点控制器 – 助力未来连网传感器" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ROMUp4JEtsuetu><p><em>图2. 具有传感器节点控制器外设的应用处理器架构</em></p><p>SNC的主要特性如下（图3）：</p><p>· 传感器节点指令集（SeNIS），包含10条微码生成指令，适用于：</p><p>o 轻松创建指向内存缓冲区的指针</p><p>o 轮询串行接口状态位</p><p>o 比较阈值</p><p>· 系统RAM用于微码存储和数据</p><p>· DMA功能，用于将数据直接从通信接口传输到系统RAM</p><p>· 直接访问所有外设和寄存器</p><p>· 通过PMU在中断触发和域上电（例如定时器、GPIO）后立即执行</p><p>· SNC到主处理器通知，以及反向通知</p><p>SNC与所有通信接口（SPI、I2C和UART）位于相同的电源域，SNC还可以控制其他电源域。它执行驻留在系统RAM中的微码，其中SNC具有直接内存连接；以系统时钟速度运行；并且可以生成中断以通知PMU所有操作都已完成，从而可以关闭整个系统的电源。</p><img alt="传感器节点控制器 – 助力未来连网传感器" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ROMUp4fEvAI9d5><p><em>图3. 传感器节点控制器框图</em></p><p>使用此类专用硬件执行传感器和外设数据操作的架构的主要优点是：</p><p>· 主CPU睡眠时间更长，从而可以节省功耗</p><p>· 节省MIPS，因为CPU不必访问慢速外设或执行简单的数据操作</p><p>不过它有一些缺点。SNC编程模型的非常简单的指令集仅允许基本操作。另外，编程SNC需要使用汇编语言。最后，由于SNC是一个非常简单的模块，调试会变得复杂。</p><p><strong>节省功耗和MIPS</strong></p><p>我们已经进行了一系列测量，证明了使用SNC可以实现的功耗和MIPS节省。这些测量是在Dialog的基于ARM Cortex-M33的DA1469x SoC上进行的，并比较了只使用主CPU和在SNC支持下执行的相同任务。 第一组测量集中在访问通常用于传感器读数的慢速外设（如I2C和SPI）时节省的功耗/MIPS。第二组测量着眼于使用DA1469x中包含的蓝牙低功耗（BLE）通信模块的实际应用案例。</p><p>表1描述了传输小型SPI或I2C数据事务（如写/读16/128字节）时的能耗。</p><img alt="传感器节点控制器 – 助力未来连网传感器" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ROMUp4sEebMC5M><p><em>表1：传输小型数据事务时的能耗（数字为1.8 V，8-bit传输）</em></p><p>与CPU（CM33）相比，SNC执行事务所需的时间要短很多，如表2所示。由于CPU可能需要执行忙等待，因此节省了时间相当于节省了MIPS。</p><img alt="传感器节点控制器 – 助力未来连网传感器" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ROMUp5588eRiVn><p><em>表2：SNC写/读8 bit数据所需的时间以及CPU相应所需的时间</em></p><p>对现实生活中的使用案例，我们比较了每隔1500毫秒（表3）和500毫秒（表4）进行广播时所消耗的功率，同时使用SPI每100毫秒读取加速计传感器一次。</p><img alt="传感器节点控制器 – 助力未来连网传感器" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ROMUpGOAAggOop><p><em>表3：每1500毫秒进行广播时的能耗，使用SPI每100毫秒进行一次传感器读取</em></p><img alt="传感器节点控制器 – 助力未来连网传感器" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ROMUpGe5uVEPbq><p><em>表4：每500毫秒进行广播时的能耗，使用SPI每100毫秒进行一次传感器读取</em></p><p>在复杂的应用中，如果需要访问多个传感器，考虑到缓存未命中和任务切换等问题，对MCU的占用会更大。</p><p><strong>降低编程复杂度</strong></p><p>上面提到过，使用集成的传感器节点控制器时面临的最大挑战之一，是确保基础系统功能的编程、调试和充分利用与采用通用MCU的方案一样简单。挑战的主要方面有：</p><p>· 提供对开发人员友好的抽象编程，以有效控制驱动与连接的传感器/外设的通信接口，以及与主CPU通信相对应的基本功能。</p><p>· 利用10指令汇编式编程，并提供更高级别的编程结构，以简化和加速软件开发。</p><p>· 支持完整的系统整体调试 - 而不是单独调试每个CPU内核，因为可能无法检测到当内核并行运行时的系统行为错误。</p><p>为了解决这些挑战，我们需要一个完整、易于使用的编程框架。它必须包括抽象和程序，将并发操作系统任务的范例扩展到在SNC上执行的相应（并行）处理。我们已经为Dialog DA1469x解决方案开发了这样的编程框架（图4）。它具有以下特点：</p><p>· 简化的SNC微码开发</p><p>o 通过定义基于SeNIS的类C编程语言，可以同时支持汇编和类C编程。</p><p>· 用于编程的“混合”编码模型</p><p>o 在相同的源和头文件中同时包含针对SNC和主处理器情境（context）的代码开发 - 使用了一个C预处理器来定义基于SeNIS的语言结构，方便开发人员。</p><p>· 与驱动主处理器通信接口、交换SNC通知、和操作系统资源相关的基础机制和功能的抽象，作为一组完整且易于使用的API程序/类C函数。</p><p>· 可观察性和高级调试机制同时应用于SNC和主处理器执行情境。</p><img alt="传感器节点控制器 – 助力未来连网传感器" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ROMUpGr6BdgWgW><p><em>图4. SNC编程框架</em></p><p>SNC编程模型的特征可归纳如下：</p><p>· DA1469x应用包括由OS任务和SNC 微码并行执行的进程。</p><p>· SNC适配器向DA1469x系统注册或注销SNC微码，从而创建一列SNC微码，每个微码由特定PMU事件触发。</p><p>· SNC适配器采用特殊的SNC微码，根据相应的微码列表实现注册的SNC微码执行的调度，并通过其低级驱动器控制SNC硬件模块。</p><p>· 定义了一组基于SeNIS的结构预处理器宏，从而生成一组汇编和类C语言结构用于SNC微码开发。</p><p>· 提供一组低级驱动器SNC微码，可用于驱动SPI、I2C等通信外设。</p><p>· 为操作系统任务和SNC微码提供了一种机制，进行交换：</p><p>o 通知</p><p>o 数据（即：SNC 队列）</p><p>除了上述实现轻松编程SNC函数的结构之外，还提供以下内容以支持调试：</p><p>· 使用SNC断点和逐步调试区域来调试SNC微码的机制。</p><p>· SNC仿真器，而不是SNC硬件模块，用于改进和简化SNC微码调试过程。</p><p><strong>总结</strong></p><p>本文介绍了一种新的架构，可最大限度地降低集成了多个传感器和外设的便携式系统的功耗。该架构使用复杂的硬件状态机来卸载主处理器上的一些重复性任务，例如传感器/外设轮询和读取。与其他架构相比，这种新架构在功耗和MIPS优化方面具有很大的优势，不过会使编程模型变的更复杂。因此，我们还介绍了一种对开发人员友好的编程框架来克服该问题。</p><p><strong>参考文献</strong></p><p>[1] Goran Nikolić, Mile Stojčev, Zoran Stamenković, Goran Panić, Branislav Petrović, “Wireless Sensor Node with low power sensing”, Electronics and Energetics Vol. 27, No 3, September 2014, pp. 435 - 453</p><p>[2] V. Raghunathan, S. Ganerival, and M. Srivastava, "Emerging Techniques for Long Lived Wireless Sensor Networks", IEEE Communication Magazine, 2006, Vol.41, No. 4, (pp. 130-141)</p><p>[3] G. Anastasi, M. Conti, M. Di Francesco, and A. Passarella, "Energy Conservation in Wireless Sensor Networks: A survey", Ad Hoc Networks, 2009, Vol. 7, (pp. 537–568)</p><p>[4] W. Ye, J. Heidemann, and D. Estrin, "An Energy-Efficient Mac Protocol for Wireless Sensor Networks," Proc. IEEE Infocom, New York (USA) 2002, (pp. 1567-1576).</p><p>[5] M. Al Ameen, S.M. Riazul Islam, and K. Kwak, "Energy Saving Mechanisms for MAC Protocols in Wireless Sensor Networks", Hindawi Publishing Corporation International Journal of Distributed Sensor Networks, Volume 2010 (2010), Article ID 163413, (pp 1-16)</p><p>[6] M. Hempstead, N. Tripathi, P. Mauro, G.-Y. Wei, and D. Brooks, "An Ultra Low Power System Architecture for Sensor Network Applications," Proc. 32nd Annual International Symposium on Computer Architecture, Madison (USA) 2005, (pp. 208-219).</p><p>[7] A. Boulis, S. Ganeriwal, and M. Srivastava, "Aggregation in Sensor Networks: An Energy Accuracy Trade-Off", Ad Hoc Networks, Vol. 1, 2003, (pp. 317–331)</p><p>[8] G. Panić, Z. Stamenković, and R. Kraemer, "Power Gating in Wireless Sensor Networks", Wireless Pervasive Computing, 2008. ISWPC2008. 3rd International Symposium on Santorini, Greece, May 2008, (pp. 499-503)</p><p>[9] T. Burd, and R. Brodersen, "Energy Efficient Microprocessor Design", Kluwer Academic Publishers, Norwell MA, USA, 2002</p><p>[10] Dialog Semiconductor, “DA1469x Datasheet”</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'感器','节点','未来'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>