<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>SpringBootæ•´åˆMyBatisPlusé…ç½®åŠ¨æ€æ•°æ®æºï¼ˆæ–‡æœ«æœ‰æƒŠå–œï¼‰ | æå®¢å¿«è¨Š</title><meta property="og:title" content="SpringBootæ•´åˆMyBatisPlusé…ç½®åŠ¨æ€æ•°æ®æºï¼ˆæ–‡æœ«æœ‰æƒŠå–œï¼‰ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/ebfc1edc673a4121ab43dae6314cb425"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8dc0a13.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8dc0a13.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8dc0a13.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8dc0a13.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8dc0a13.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8dc0a13.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8dc0a13.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8dc0a13.html><meta property="article:published_time" content="2020-10-29T20:58:17+08:00"><meta property="article:modified_time" content="2020-10-29T20:58:17+08:00"><meta name=Keywords content><meta name=description content="SpringBootæ•´åˆMyBatisPlusé…ç½®åŠ¨æ€æ•°æ®æºï¼ˆæ–‡æœ«æœ‰æƒŠå–œï¼‰"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/8dc0a13.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>SpringBootæ•´åˆMyBatisPlusé…ç½®åŠ¨æ€æ•°æ®æºï¼ˆæ–‡æœ«æœ‰æƒŠå–œï¼‰</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><p><strong>MybatisPlusç‰¹æ€§</strong></p><div class=pgc-img><img alt=SpringBootæ•´åˆMyBatisPlusé…ç½®åŠ¨æ€æ•°æ®æºï¼ˆæ–‡æœ«æœ‰æƒŠå–œï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ebfc1edc673a4121ab43dae6314cb425></div><ul><li><strong>æ— ä¾µå…¥</strong>ï¼šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œå¼•å…¥å®ƒä¸ä¼šå¯¹ç°æœ‰å·¥ç¨‹äº§ç”Ÿå½±å“ï¼Œå¦‚ä¸èˆ¬é¡ºæ»‘</li><li><strong>æŸè€—å°</strong>ï¼šå¯åŠ¨å³ä¼šè‡ªåŠ¨æ³¨å…¥åŸºæœ¬ CURDï¼Œæ€§èƒ½åŸºæœ¬æ— æŸè€—ï¼Œç›´æ¥é¢å‘å¯¹è±¡æ“ä½œ</li><li><strong>å¼ºå¤§çš„ CRUD æ“ä½œ</strong>ï¼šå†…ç½®é€šç”¨ Mapperã€é€šç”¨ Serviceï¼Œä»…ä»…é€šè¿‡å°‘é‡é…ç½®å³å¯å®ç°å•è¡¨å¤§éƒ¨åˆ† CRUD æ“ä½œï¼Œæ›´æœ‰å¼ºå¤§çš„æ¡ä»¶æ„é€ å™¨ï¼Œæ»¡è¶³å„ç±»ä½¿ç”¨éœ€æ±‚</li><li><strong>æ”¯æŒ Lambda å½¢å¼è°ƒç”¨</strong>ï¼šé€šè¿‡ Lambda è¡¨è¾¾å¼ï¼Œæ–¹ä¾¿çš„ç¼–å†™å„ç±»æŸ¥è¯¢æ¡ä»¶ï¼Œæ— éœ€å†æ‹…å¿ƒå­—æ®µå†™é”™</li><li><strong>æ”¯æŒå¤šç§æ•°æ®åº“</strong>ï¼šæ”¯æŒ MySQLã€MariaDBã€Oracleã€DB2ã€H2ã€HSQLã€SQLiteã€Postgreã€SQLServer2005ã€SQLServer ç­‰å¤šç§æ•°æ®åº“</li><li><strong>æ”¯æŒä¸»é”®è‡ªåŠ¨ç”Ÿæˆ</strong>ï¼šæ”¯æŒå¤šè¾¾ 4 ç§ä¸»é”®ç­–ç•¥ï¼ˆå†…å«åˆ†å¸ƒå¼å”¯ä¸€ ID ç”Ÿæˆå™¨ - Sequenceï¼‰ï¼Œå¯è‡ªç”±é…ç½®ï¼Œå®Œç¾è§£å†³ä¸»é”®é—®é¢˜</li><li><strong>æ”¯æŒ XML çƒ­åŠ è½½</strong>ï¼šMapper å¯¹åº”çš„ XML æ”¯æŒçƒ­åŠ è½½ï¼Œå¯¹äºç®€å•çš„ CRUD æ“ä½œï¼Œç”šè‡³å¯ä»¥æ—  XML å¯åŠ¨</li><li><strong>æ”¯æŒ ActiveRecord æ¨¡å¼</strong>ï¼šæ”¯æŒ ActiveRecord å½¢å¼è°ƒç”¨ï¼Œå®ä½“ç±»åªéœ€ç»§æ‰¿ Model ç±»å³å¯è¿›è¡Œå¼ºå¤§çš„ CRUD æ“ä½œ</li><li><strong>æ”¯æŒè‡ªå®šä¹‰å…¨å±€é€šç”¨æ“ä½œ</strong>ï¼šæ”¯æŒå…¨å±€é€šç”¨æ–¹æ³•æ³¨å…¥ï¼ˆ Write once, use anywhere ï¼‰</li><li><strong>æ”¯æŒå…³é”®è¯è‡ªåŠ¨è½¬ä¹‰</strong>ï¼šæ”¯æŒæ•°æ®åº“å…³é”®è¯ï¼ˆorderã€key......ï¼‰è‡ªåŠ¨è½¬ä¹‰ï¼Œè¿˜å¯è‡ªå®šä¹‰å…³é”®è¯</li><li><strong>å†…ç½®ä»£ç ç”Ÿæˆå™¨</strong>ï¼šé‡‡ç”¨ä»£ç æˆ–è€… Maven æ’ä»¶å¯å¿«é€Ÿç”Ÿæˆ Mapper ã€ Model ã€ Service ã€ Controller å±‚ä»£ç ï¼Œæ”¯æŒæ¨¡æ¿å¼•æ“ï¼Œæ›´æœ‰è¶…å¤šè‡ªå®šä¹‰é…ç½®ç­‰æ‚¨æ¥ä½¿ç”¨</li><li><strong>å†…ç½®åˆ†é¡µæ’ä»¶</strong>ï¼šåŸºäº MyBatis ç‰©ç†åˆ†é¡µï¼Œå¼€å‘è€…æ— éœ€å…³å¿ƒå…·ä½“æ“ä½œï¼Œé…ç½®å¥½æ’ä»¶ä¹‹åï¼Œå†™åˆ†é¡µç­‰åŒäºæ™®é€š List æŸ¥è¯¢</li><li><strong>å†…ç½®æ€§èƒ½åˆ†ææ’ä»¶</strong>ï¼šå¯è¾“å‡º Sql è¯­å¥ä»¥åŠå…¶æ‰§è¡Œæ—¶é—´ï¼Œå»ºè®®å¼€å‘æµ‹è¯•æ—¶å¯ç”¨è¯¥åŠŸèƒ½ï¼Œèƒ½å¿«é€Ÿæªå‡ºæ…¢æŸ¥è¯¢</li><li><strong>å†…ç½®å…¨å±€æ‹¦æˆªæ’ä»¶</strong>ï¼šæä¾›å…¨è¡¨ delete ã€ update æ“ä½œæ™ºèƒ½åˆ†æé˜»æ–­ï¼Œä¹Ÿå¯è‡ªå®šä¹‰æ‹¦æˆªè§„åˆ™ï¼Œé¢„é˜²è¯¯æ“ä½œ</li><li><strong>å†…ç½® Sql æ³¨å…¥å‰¥ç¦»å™¨</strong>ï¼šæ”¯æŒ Sql æ³¨å…¥å‰¥ç¦»ï¼Œæœ‰æ•ˆé¢„é˜² Sql æ³¨å…¥æ”»å‡»</li></ul><p><strong>å¿«é€Ÿå¼€å§‹</strong></p><p>åˆå§‹åŒ–æµ‹è¯•æ•°æ®è¡¨ï¼š</p><p>DROP TABLE IF EXISTS user;</p><p>CREATE TABLE user</p><p>(</p><p>id BIGINT(20) NOT NULL COMMENT 'ä¸»é”®ID',</p><p>name VARCHAR(30) NULL DEFAULT NULL COMMENT 'å§“å',</p><p>age INT(11) NULL DEFAULT NULL COMMENT 'å¹´é¾„',</p><p>email VARCHAR(50) NULL DEFAULT NULL COMMENT 'é‚®ç®±',</p><p>PRIMARY KEY (id)</p><p>);</p><p>DELETE FROM user;</p><p>INSERT INTO user (id, name, age, email) VALUES</p><p>(1, 'Jone', 18, 'test1@baomidou.com'),</p><p>(2, 'Jack', 20, 'test2@baomidou.com'),</p><p>(3, 'Tom', 28, 'test3@baomidou.com'),</p><p>(4, 'Sandy', 21, 'test4@baomidou.com'),</p><p>(5, 'Billie', 24, 'test5@baomidou.com');</p><p><strong>çˆ¶å·¥ç¨‹ä¾èµ–</strong></p><p>è¯¥å·¥ç¨‹ç”¨äºä¾èµ–ç®¡ç†ï¼Œpomå¦‚ä¸‹ï¼š</p><p>&lt;properties></p><p>&lt;project.build.sourceEncoding>UTF-8&lt;/project.build.sourceEncoding></p><p>&lt;project.reporting.outputEncoding>UTF-8&lt;/project.reporting.outputEncoding></p><p>&lt;java.version>1.8&lt;/java.version></p><p>&lt;spring-cloud.version>Finchley.RELEASE&lt;/spring-cloud.version></p><p>&lt;mybatis-plus-version>3.1.1&lt;/mybatis-plus-version></p><p>&lt;mysql-driver-version>5.1.47&lt;/mysql-driver-version></p><p>&lt;druid-version>1.1.10&lt;/druid-version></p><p>&lt;/properties></p><p>&lt;dependencyManagement></p><p>&lt;dependencies></p><p>&lt;dependency></p><p>&lt;groupId>org.springframework.boot&lt;/groupId></p><p>&lt;artifactId>spring-boot-dependencies&lt;/artifactId></p><p>&lt;version>2.1.5.RELEASE&lt;/version></p><p>&lt;type>pom&lt;/type></p><p>&lt;scope>import&lt;/scope></p><p>&lt;/dependency></p><p>&lt;/dependencies></p><p>&lt;/dependencyManagement></p><p><strong>åˆ›å»ºMyBaitsPluså·¥ç¨‹</strong></p><p>ä¾èµ–å¦‚ä¸‹ï¼š</p><p>&lt;dependencies></p><p>&lt;dependency></p><p>&lt;groupId>org.springframework.boot&lt;/groupId></p><p>&lt;artifactId>spring-boot-starter&lt;/artifactId></p><p>&lt;/dependency></p><p>&lt;dependency></p><p>&lt;groupId>org.springframework.boot&lt;/groupId></p><p>&lt;artifactId>spring-boot-starter-web&lt;/artifactId></p><p>&lt;/dependency></p><p>&lt;dependency></p><p>&lt;groupId>org.springframework.boot&lt;/groupId></p><p>&lt;artifactId>spring-boot-starter-test&lt;/artifactId></p><p>&lt;scope>test&lt;/scope></p><p>&lt;/dependency></p><p>&lt;!-- mybatis plus --></p><p>&lt;dependency></p><p>&lt;groupId>com.baomidou&lt;/groupId></p><p>&lt;artifactId>mybatis-plus-boot-starter&lt;/artifactId></p><p>&lt;version>${mybatis-plus-version}&lt;/version></p><p>&lt;/dependency></p><p>&lt;!-- mysql --></p><p>&lt;dependency></p><p>&lt;groupId>mysql&lt;/groupId></p><p>&lt;artifactId>mysql-connector-java&lt;/artifactId></p><p>&lt;version>${mysql-driver-version}&lt;/version></p><p>&lt;/dependency></p><p>&lt;!-- druidæ•°æ®è¿æ¥æ±  --></p><p>&lt;dependency></p><p>&lt;groupId>com.alibaba&lt;/groupId></p><p>&lt;artifactId>druid-spring-boot-starter&lt;/artifactId></p><p>&lt;version>${druid-version}&lt;/version></p><p>&lt;/dependency></p><p>&lt;dependency></p><p>&lt;groupId>org.projectlombok&lt;/groupId></p><p>&lt;artifactId>lombok&lt;/artifactId></p><p>&lt;optional>true&lt;/optional></p><p>&lt;/dependency></p><p>&lt;dependency></p><p>&lt;groupId>log4j&lt;/groupId></p><p>&lt;artifactId>log4j&lt;/artifactId></p><p>&lt;version>1.2.17&lt;/version></p><p>&lt;/dependency></p><p>&lt;/dependencies></p><p><strong>propertiesé…ç½®</strong></p><p>åœ¨è¿™é‡Œé…ç½®æ•°æ®åº“è¿æ¥ï¼Œä»¥åŠæ•°æ®è¿æ¥æ± ä¸mybatisplusçš„é…ç½®ç­‰</p><p>server.port=8080</p><p>spring.application.name=mybatis</p><p>spring.datasource.type=com.alibaba.druid.pool.DruidDataSource</p><p>spring.datasource.driver-class-name=com.mysql.jdbc.Driver</p><p>spring.datasource.url=jdbc:mysql://localhost:3306/mybatis?useSSL=false&characterEncoding=utf8</p><p>spring.datasource.username=root</p><p>spring.datasource.password=root</p><p>spring.datasource.druid.initial-size=5</p><p>spring.datasource.druid.min-idle=5</p><p>spring.datasource.druid.maxActive=20</p><p>spring.datasource.druid.maxWait=60000</p><p>spring.datasource.druid.timeBetweenEvictionRunsMillis=60000</p><p>spring.datasource.druid.minEvictableIdleTimeMillis=300000</p><p>spring.datasource.druid.validationQuery=SELECT 1 FROM DUAL</p><p>spring.datasource.druid.testWhileIdle=true</p><p>spring.datasource.druid.testOnBorrow=false</p><p>spring.datasource.druid.testOnReturn=false</p><p>spring.datasource.druid.poolPreparedStatements=true</p><p>spring.datasource.druid.maxPoolPreparedStatementPerConnectionSize=20</p><p>spring.datasource.druid.filters=stat,slf4j</p><p>spring.datasource.druid.connectionProperties=druid.stat.mergeSql=true;druid.stat.slowSqlMillis=5000</p><p>spring.datasource.druid.web-stat-filter.enabled=true</p><p>spring.datasource.druid.web-stat-filter.url-pattern=/*</p><p>spring.datasource.druid.web-stat-filter.exclusions=*.js,*.gif,*.jpg,*.bmp,*.png,*.css,*.ico,/druid/*</p><p>spring.datasource.druid.stat-view-servlet.url-pattern=/druid/*</p><p>spring.datasource.druid.stat-view-servlet.allow=127.0.0.1,192.168.163.1</p><p>spring.datasource.druid.stat-view-servlet.deny=192.168.1.73</p><p>spring.datasource.druid.stat-view-servlet.reset-enable=false</p><p>#Druid ç®¡ç†è´¦å·</p><p>spring.datasource.druid.stat-view-servlet.login-username=admin</p><p>#Druid ç®¡ç†å¯†ç </p><p>spring.datasource.druid.stat-view-servlet.login-password=123456</p><p>#com.simple.spring.boot.mapper è¯¥åŒ…æ‰“å°DEBUGçº§åˆ«æ—¥å¿—</p><p>logging.level.com.simple.spring.boot.mapper=debug</p><p>#mybatis plus mapperæ–‡ä»¶è·¯å¾„</p><p>mybatis-plus.mapperLocations=classpath:/mybatis/mapper/*.xml</p><p>#mybaits plus å®ä½“ç±»è·¯å¾„</p><p>mybatis-plus.typeAliasesPackage=com.simple.spring.**.entities</p><p>mybatis-plus.typeEnumsPackage=</p><p>#æ•°æ®åº“ç›¸å…³é…ç½®</p><p>#ä¸»é”®ç±»å‹ AUTO:"æ•°æ®åº“IDè‡ªå¢", INPUT:"ç”¨æˆ·è¾“å…¥ID",ID_WORKER:"å…¨å±€å”¯ä¸€ID (æ•°å­—ç±»å‹å”¯ä¸€ID)", UUID:"å…¨å±€å”¯ä¸€ID UUID";</p><p>mybatis-plus.global-config.db-config.id-type=UUID</p><p>#å­—æ®µç­–ç•¥ IGNORED:"å¿½ç•¥åˆ¤æ–­",NOT_NULL:"é NULL åˆ¤æ–­"),NOT_EMPTY:"éç©ºåˆ¤æ–­"</p><p>mybatis-plus.global-config.db-config.field-strategy=not_empty</p><p>#é©¼å³°ä¸‹åˆ’çº¿è½¬æ¢</p><p>mybatis-plus.global-config.db-config.column-underline=true</p><p>#æ•°æ®åº“å¤§å†™ä¸‹åˆ’çº¿è½¬æ¢</p><p>#capital-mode: true</p><p>#é€»è¾‘åˆ é™¤é…ç½®</p><p>mybatis-plus.global-config.db-config.logic-delete-value=0</p><p>mybatis-plus.global-config.db-config.logic-not-delete-value= 1</p><p>#mybatis-plus.global-config.db-config.db-type= sqlserver</p><p>#åˆ·æ–°mapper è°ƒè¯•ç¥å™¨</p><p>mybatis-plus.global-config.refresh=true</p><p># åŸç”Ÿé…ç½®</p><p>mybatis-plus.configuration.map-underscore-to-camel-case=true</p><p>mybatis-plus.configuration.cache-enabled=false</p><p>mybatis-plus.configuration.call-setters-on-nulls =true</p><p><strong>å¸¸è§„å¢åˆ æ”¹æŸ¥å®ç°</strong></p><p>åˆ›å»ºå®ä½“ç±»ï¼š</p><p>**</p><p>* å®ä½“ç±»</p><p>* @author: SimpleWu</p><p>* @date: 2019/5/25</p><p>*/</p><p>@Data</p><p>public class User {</p><p>private Long id;</p><p>private String name;</p><p>private Integer age;</p><p>private String email;</p><p>}</p><p>è¯¥lombokæ’ä»¶çœå»getsetæ–¹æ³•ã€‚</p><p>åˆ›å»ºUserMapperæ¥å£ï¼Œå¹¶ä¸”å®ç°BaseMapper&lt;User>è¿™é‡Œæˆ‘ä»¬æŒ‡å®šå®ä½“ç±»ä¸ºuserå¯ç›´æ¥ä½¿ç”¨æ¥å£ä¸­çš„æ–¹æ³•ã€‚</p><ul><li>æŸ¥è¯¢æ‰€æœ‰æ•°æ®</li></ul><p>public List&lt;User> getList(){</p><p>return userMapper.selectList(null);</p><p>}</p><ul><li>æŸ¥è¯¢æ•°æ®å¸¦æŸ¥è¯¢æ¡ä»¶</li></ul><p>public List&lt;User> getListQuery(){</p><p>User user = new User();</p><p>user.setName("SimpleWu");</p><p>Wrapper&lt;User> wrapper = new QueryWrapper&lt;>(user);</p><p>return userMapper.selectList(wrapper);</p><p>}</p><ul><li>æŸ¥è¯¢å¸¦åˆ†é¡µ</li></ul><p>public IPage&lt;User> page(){</p><p>int currentPage = 1 ; //å½“å‰é¡µ</p><p>int pageSize = 2 ;//æ¯é¡µå¤§å°</p><p>IPage&lt;User> page = new Page(currentPage,pageSize);</p><p>page = userMapper.selectPage(page,null);</p><p>return page;</p><p>}</p><ul><li>æ ¹æ®å®ä½“ç±»æ–°å¢æ•°æ®</li></ul><p>@Transactional//æœ¬åœ°äº‹åŠ¡å¼€å¯</p><p>public int insert(){</p><p>User user = new User();</p><p>user.setId(6l);</p><p>user.setName("SimpleWu");</p><p>user.setAge(100);</p><p>user.setEmail("SimpleWu@gmail.com");</p><p>return userMapper.insert(user);</p><p>}</p><ul><li>æ ¹æ®ä¸»é”®åˆ é™¤æ•°æ®</li></ul><p>@Transactional//æœ¬åœ°äº‹åŠ¡å¼€å¯</p><p>public int deleteById(){</p><p>int userId = 6;</p><p>return userMapper.deleteById(userId);</p><p>}</p><ul><li>æ ¹æ®IDæ›´æ–°æ•°æ®</li></ul><p>@Transactional//æœ¬åœ°äº‹åŠ¡å¼€å¯</p><p>public int updateById(){</p><p>User user = new User();</p><p>user.setId(5l);</p><p>user.setName("update");</p><p>user.setAge(100);</p><p>user.setEmail("update@email.com");</p><p>return userMapper.updateById(user);</p><p>}</p><ul><li>æ¡ä»¶æ„é€ å™¨</li><li>UpdateWrapper ç”¨äºå¢åˆ æ”¹æ„é€ æ¡ä»¶</li><li>QueryWrapper ç”¨äºæŸ¥è¯¢æ„é€ æ¡ä»¶</li></ul><p>Transactional//æœ¬åœ°äº‹åŠ¡å¼€å¯</p><p>public int updateWrapperUser(){</p><p>User user = new User();</p><p>user.setId(5l);</p><p>user.setName("update");</p><p>user.setAge(100);</p><p>user.setEmail("update@email.com");</p><p>User updateWrapperUser = new User();</p><p>updateWrapperUser.setId(1l);</p><p>/**</p><p>* ä¿®æ”¹ UpdateWrapper</p><p>* æŸ¥è¯¢ QueryWrapper</p><p>*/</p><p>Wrapper&lt;User> wrapper = new UpdateWrapper&lt;>(updateWrapperUser);</p><p>return userMapper.update(user,wrapper);</p><p>}</p><ul><li>Mapperæ¥å£ç»‘å®šMapperæ–‡ä»¶</li><li>properitesä¸­é…ç½®æ—¢å¯</li></ul><p>#æ‰«æmybatis/mapperä¸‹é¢çš„æ‰€æœ‰xml</p><p>mybatis-plus.mapperLocations=classpath:/mybatis/mapper/*.xml</p><ul><li>UserMapperæ¥å£æµ‹è¯•</li></ul><p>public interface UserMapper extends BaseMapper&lt;User> {</p><p>Map&lt;String,Object> queryUser(@Param("USER_ID") String userId);</p><p>}</p><p>UserMapper.xmlï¼Œå¦‚ä¸‹ï¼š</p><p>&lt;select id="queryUser" resultType="java.util.HashMap" parameterType="java.lang.String"></p><p>SELECT</p><p>ID,</p><p>NAME</p><p>FROM</p><p>USER</p><p>WHERE ID = #{USER_ID}</p><p>&lt;/select></p><p>æ‰§è¡ŒSQLï¼š</p><p>public Map&lt;String,Object> myMapper(){</p><p>return userMapper.queryUser("2");</p><p>}</p><p>åœ¨SpringBootä¸­ä½¿ç”¨MybatisPlusåˆ†é¡µéœ€è¦æ³¨å…¥Beanï¼Œå¹¶ä¸”åœ¨å¯åŠ¨ç±»ä¸Šä½¿ç”¨@MapperScan("com.simple.spring.boot.mapper")æ‰«æmapperæ–‡ä»¶è·¯å¾„å¦‚ä¸‹ï¼š</p><p>@SpringBootApplication</p><p>@MapperScan("com.simple.spring.boot.mapper")</p><p>public class MybatisPlusApplication {</p><p>/**</p><p>* åˆ†é¡µæ’ä»¶æ³¨å†Œ</p><p>* @return</p><p>*/</p><p>@Bean</p><p>public PaginationInterceptor paginationInterceptor() {</p><p>return new PaginationInterceptor();</p><p>}</p><p>public static void main(String[] args) {</p><p>SpringApplication.run(MybatisPlusApplication.class, args);</p><p>}</p><p>}</p><p>ä½¿ç”¨MyBatisPluså¯ä»¥ä¸ºæˆ‘ä»¬å‡å°‘å¾ˆå¤šå¾ˆå¤šçš„ä»£ç ï¼Œä¸è¿‡éœ€è¦ç¼–å†™å®ä½“ç±»ï¼Œæœ‰å¤±å¿…æœ‰å¾—ã€‚</p><p><strong>é…ç½®åŠ¨æ€æ•°æ®æº</strong></p><p>dynamic-datasource-spring-boot-starter æ˜¯ä¸€ä¸ªåŸºäºspringbootçš„å¿«é€Ÿé›†æˆå¤šæ•°æ®æºçš„å¯åŠ¨å™¨ã€‚</p><p><strong>ä¼˜åŠ¿</strong></p><p>ç½‘ä¸Šå…³äºåŠ¨æ€æ•°æ®æºçš„åˆ‡æ¢çš„æ–‡æ¡£æœ‰å¾ˆå¤šï¼Œæ ¸å¿ƒåªæœ‰ä¸¤ç§ã€‚</p><ol><li>æ„å»ºå¤šå¥—ç¯å¢ƒï¼Œä¼˜åŠ¿æ˜¯æ–¹ä¾¿æ§åˆ¶ä¹Ÿå®¹æ˜“é›†æˆä¸€äº›ç®€å•çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œç¼ºç‚¹æ˜¯éåŠ¨æ€åŒæ—¶ä»£ç é‡è¾ƒå¤š,é…ç½®éš¾åº¦å¤§ã€‚</li><li>åŸºäºspringæä¾›åŸç”Ÿçš„ AbstractRoutingDataSource ï¼Œå‚è€ƒä¸€äº›æ–‡æ¡£è‡ªå·±å®ç°åˆ‡æ¢ã€‚</li></ol><p>å¦‚æœä½ çš„æ•°æ®æºè¾ƒå°‘ï¼Œåœºæ™¯ä¸å¤æ‚ï¼Œé€‰æ‹©ä»¥ä¸Šä»»æ„ä¸€ç§éƒ½å¯ä»¥ã€‚å¦‚æœä½ éœ€è¦æ›´å¤šç‰¹æ€§ï¼Œè¯·å°è¯•æœ¬åŠ¨æ€æ•°æ®æºã€‚</p><ol><li>æ•°æ®æºåˆ†ç»„ï¼Œé€‚ç”¨äºå¤šç§åœºæ™¯ çº¯ç²¹å¤šåº“ è¯»å†™åˆ†ç¦» ä¸€ä¸»å¤šä» æ··åˆæ¨¡å¼ã€‚</li><li>ç®€å•é›†æˆDruidæ•°æ®æºç›‘æ§å¤šæ•°æ®æºï¼Œç®€å•é›†æˆMybatis-Plusç®€åŒ–å•è¡¨ï¼Œç®€å•é›†æˆP6syæ ¼å¼åŒ–sqlï¼Œç®€å•é›†æˆJndiæ•°æ®æºã€‚</li><li>ç®€åŒ–Druidå’ŒHikariCpé…ç½®ï¼Œæä¾›å…¨å±€å‚æ•°é…ç½®ã€‚</li><li>æä¾›è‡ªå®šä¹‰æ•°æ®æºæ¥æº(é»˜è®¤ä½¿ç”¨ymlæˆ–propertiesé…ç½®)ã€‚</li><li>é¡¹ç›®å¯åŠ¨åèƒ½åŠ¨æ€å¢å‡æ•°æ®æºã€‚</li><li>ä½¿ç”¨spelåŠ¨æ€å‚æ•°è§£ææ•°æ®æºï¼Œå¦‚ä»sessionï¼Œheaderå’Œå‚æ•°ä¸­è·å–æ•°æ®æºã€‚ï¼ˆå¤šç§Ÿæˆ·æ¶æ„ç¥å™¨ï¼‰</li><li>å¤šå±‚æ•°æ®æºåµŒå¥—åˆ‡æ¢ã€‚ï¼ˆä¸€ä¸ªä¸šåŠ¡ServiceAè°ƒç”¨ServiceBï¼ŒServiceBè°ƒç”¨ServiceCï¼Œæ¯ä¸ªServiceéƒ½æ˜¯ä¸åŒçš„æ•°æ®æºï¼‰</li><li>ä½¿ç”¨æ­£åˆ™åŒ¹é…æˆ–spelè¡¨è¾¾å¼æ¥åˆ‡æ¢æ•°æ®æºï¼ˆå®éªŒæ€§åŠŸèƒ½ï¼‰ã€‚</li></ol><p><strong>åŠ£åŠ¿</strong></p><p>ä¸èƒ½ä½¿ç”¨å¤šæ•°æ®æºäº‹åŠ¡ï¼ˆåŒä¸€ä¸ªæ•°æ®æºä¸‹èƒ½ä½¿ç”¨äº‹åŠ¡ï¼‰ï¼Œç½‘ä¸Šå…¶ä»–æ–¹æ¡ˆä¹Ÿéƒ½ä¸èƒ½æä¾›ã€‚</p><p>å¦‚æœä½ éœ€è¦ä½¿ç”¨åˆ°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œé‚£ä¹ˆä½ çš„æ¶æ„åº”è¯¥åˆ°äº†å¾®æœåŠ¡åŒ–çš„æ—¶å€™äº†ã€‚</p><p>å¦‚æœå‘¼å£°å¼ºçƒˆï¼Œé¡¹ç›®è¾¾åˆ°800 starï¼Œä½œè€…è€ƒè™‘é›†æˆåˆ†å¸ƒå¼äº‹åŠ¡ã€‚</p><p>PS: å¦‚æœæ‚¨åªæ˜¯å‡ ä¸ªæ•°æ®åº“ä½†æ˜¯æœ‰å¼ºçƒˆçš„éœ€æ±‚åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå»ºè®®è¿˜æ˜¯ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼è‡ªå·±æ„å»ºå¤šå¥—ç¯å¢ƒé›†æˆatomicè¿™ç±»ï¼Œç½‘ä¸Šç™¾åº¦å¾ˆå¤šã€‚</p><p><strong>çº¦å®š</strong></p><ol><li>æœ¬æ¡†æ¶åªåš <strong>åˆ‡æ¢æ•°æ®æº</strong> è¿™ä»¶æ ¸å¿ƒçš„äº‹æƒ…ï¼Œå¹¶<strong>ä¸é™åˆ¶ä½ çš„å…·ä½“æ“ä½œ</strong>ï¼Œåˆ‡æ¢äº†æ•°æ®æºå¯ä»¥åšä»»ä½•CRUDã€‚</li><li>é…ç½®æ–‡ä»¶æ‰€æœ‰ä»¥ä¸‹åˆ’çº¿ _ åˆ†å‰²çš„æ•°æ®æº <strong>é¦–éƒ¨</strong> å³ä¸ºç»„çš„åç§°ï¼Œç›¸åŒç»„åç§°çš„æ•°æ®æºä¼šæ”¾åœ¨ä¸€ä¸ªç»„ä¸‹ã€‚</li><li>åˆ‡æ¢æ•°æ®æºå³å¯æ˜¯ç»„åï¼Œä¹Ÿå¯æ˜¯å…·ä½“æ•°æ®æºåç§°ï¼Œåˆ‡æ¢æ—¶é»˜è®¤é‡‡ç”¨è´Ÿè½½å‡è¡¡æœºåˆ¶åˆ‡æ¢ã€‚</li><li>é»˜è®¤çš„æ•°æ®æºåç§°ä¸º <strong>master</strong> ï¼Œä½ å¯ä»¥é€šè¿‡spring.datasource.dynamic.primaryä¿®æ”¹ã€‚</li><li>æ–¹æ³•ä¸Šçš„æ³¨è§£ä¼˜å…ˆäºç±»ä¸Šæ³¨è§£ã€‚</li></ol><p><strong>å»ºè®®</strong></p><p>å¼ºçƒˆå»ºè®®åœ¨ <strong>ä¸»ä»æ¨¡å¼</strong> ä¸‹éµå¾ªæ™®éçš„è§„åˆ™ï¼Œä»¥ä¾¿ä»–äººèƒ½æ›´è½»æ˜“ç†è§£ä½ çš„ä»£ç ã€‚</p><p>ä¸»æ•°æ®åº“ <strong>å»ºè®®</strong> åªæ‰§è¡Œ INSERT UPDATE DELETE æ“ä½œã€‚</p><p>ä»æ•°æ®åº“ <strong>å»ºè®®</strong> åªæ‰§è¡Œ SELECT æ“ä½œã€‚</p><p><strong>å¿«é€Ÿå¼€å§‹</strong></p><p>åŠ å…¥ä¾èµ–ï¼š</p><p>&lt;!-- åŠ¨æ€æ•°æ®æº --></p><p>&lt;dependency></p><p>&lt;groupId>com.baomidou&lt;/groupId></p><p>&lt;artifactId>dynamic-datasource-spring-boot-starter&lt;/artifactId></p><p>&lt;version>2.5.4&lt;/version></p><p>&lt;/dependency></p><p>æ³¨é‡Šæ‰åŸæ¥çš„æ•°æ®åº“é…ç½®ï¼ŒåŠ å…¥ï¼š</p><p>#è®¾ç½®é»˜è®¤çš„æ•°æ®æºæˆ–è€…æ•°æ®æºç»„,é»˜è®¤å€¼å³ä¸ºmaster</p><p>spring.datasource.dynamic.primary=master</p><p>#ä¸»åº“é…ç½®</p><p>spring.datasource.dynamic.datasource.master.username=root</p><p>spring.datasource.dynamic.datasource.master.password=root</p><p>spring.datasource.dynamic.datasource.master.driver-class-name=com.mysql.jdbc.Driver</p><p>spring.datasource.dynamic.datasource.master.url=jdbc:mysql://localhost:3306/mybatis?useSSL=false&characterEncoding=utf8</p><p>#ä»åº“é…ç½®</p><p>spring.datasource.dynamic.datasource.slave_1.username=root</p><p>spring.datasource.dynamic.datasource.slave_1.password=root</p><p>spring.datasource.dynamic.datasource.slave_1.driver-class-name=com.mysql.jdbc.Driver</p><p>spring.datasource.dynamic.datasource.slave_1.url=jdbc:mysql://localhost:3307/mybatis?useSSL=false&characterEncoding=utf8</p><p>ä½¿ç”¨ <strong>@DS</strong> åˆ‡æ¢æ•°æ®æºã€‚</p><p>@DS("master")</p><p>public List&lt;User> getListQuery(){</p><p>User user = new User();</p><p>user.setName("SimpleWu");</p><p>Wrapper&lt;User> wrapper = new QueryWrapper&lt;>(user);</p><p>return userMapper.selectList(wrapper);</p><p>}</p><p>@DS("slave_1")</p><p>public IPage&lt;User> page(){</p><p>int currentPage = 1 ; //å½“å‰é¡µ</p><p>int pageSize = 2 ;//æ¯é¡µå¤§å°</p><p>IPage&lt;User> page = new Page(currentPage,pageSize);</p><p>page = userMapper.selectPage(page,null);</p><p>return page;</p><p>}</p><p><strong>@DS</strong> å¯ä»¥æ³¨è§£åœ¨æ–¹æ³•ä¸Šå’Œç±»ä¸Šï¼Œ<strong>åŒæ—¶å­˜åœ¨æ–¹æ³•æ³¨è§£ä¼˜å…ˆäºç±»ä¸Šæ³¨è§£</strong>ã€‚</p><p>æ³¨è§£åœ¨serviceå®ç°æˆ–mapperæ¥å£æ–¹æ³•ä¸Šï¼Œä½†å¼ºçƒˆä¸å»ºè®®åŒæ—¶åœ¨serviceå’Œmapperæ³¨è§£ã€‚ (å¯èƒ½ä¼šæœ‰é—®é¢˜)</p><p>å¦‚æœä¸åŠ å…¥ä¸»é”®åˆ™ä½¿ç”¨é»˜è®¤æ•°æ®æºã€‚</p><p>DruidDataSourceAutoConfigureä¼šæ³¨å…¥ä¸€ä¸ªDataSourceWrapperï¼Œå…¶ä¼šåœ¨åŸç”Ÿçš„spring.datasourceä¸‹æ‰¾url,username,passwordç­‰ã€‚è€Œæˆ‘ä»¬åŠ¨æ€æ•°æ®æºçš„é…ç½®è·¯å¾„æ˜¯å˜åŒ–çš„,æ‰€ä»¥éœ€è¦æ’é™¤ï¼š</p><p>spring:</p><p>autoconfigure:</p><p>exclude: com.alibaba.druid.spring.boot.autoconfigure.DruidDataSourceAutoConfigure</p><p>æˆ–è€…åœ¨ç±»ä¸Šæ’é™¤ï¼š</p><p>@SpringBootApplication(exclude = DruidDataSourceAutoConfigure.class)</p><p>ç„¶åæ›´æ¢propertiesé…ç½®ä¿¡æ¯ï¼š</p><p>#å…¬å…±é…ç½® Druidç™»å½•è´¦å· å¯†ç </p><p>spring.datasource.druid.stat-view-servlet.login-username=admin</p><p>spring.datasource.druid.stat-view-servlet.login-password=123456</p><p>spring.datasource.dynamic.druid.initial-size=5</p><p>spring.datasource.dynamic.druid.min-idle=5</p><p>spring.datasource.dynamic.druid.maxActive=20</p><p>spring.datasource.dynamic.druid.maxWait=60000</p><p>spring.datasource.dynamic.druid.timeBetweenEvictionRunsMillis=60000</p><p>spring.datasource.dynamic.druid.minEvictableIdleTimeMillis=300000</p><p>spring.datasource.dynamic.druid.validationQuery=SELECT 1 FROM DUAL</p><p>spring.datasource.dynamic.druid.testWhileIdle=true</p><p>spring.datasource.dynamic.druid.testOnBorrow=false</p><p>spring.datasource.dynamic.druid.testOnReturn=false</p><p>spring.datasource.dynamic.druid.poolPreparedStatements=true</p><p>spring.datasource.dynamic.druid.maxPoolPreparedStatementPerConnectionSize=20</p><p>spring.datasource.dynamic.druid.filters=stat,slf4j</p><p>spring.datasource.dynamic.druid.connectionProperties=druid.stat.mergeSql=true;druid.stat.slowSqlMillis=5000</p><p>spring.datasource.dynamic.druid.web-stat-filter.enabled=true</p><p>spring.datasource.dynamic.druid.web-stat-filter.url-pattern=/*</p><p>spring.datasource.dynamic.druid.web-stat-filter.exclusions=*.js,*.gif,*.jpg,*.bmp,*.png,*.css,*.ico,/druid/*</p><p>spring.datasource.dynamic.druid.stat-view-servlet.url-pattern=/druid/*</p><p>spring.datasource.dynamic.druid.stat-view-servlet.allow=127.0.0.1,192.168.163.1</p><p>spring.datasource.dynamic.druid.stat-view-servlet.deny=192.168.1.73</p><p>spring.datasource.dynamic.druid.stat-view-servlet.reset-enable=false</p><p>æœ¬ç¯‡ä»£ç æ¡ˆä¾‹åœ°å€ï¼š</p><p>https://github.com/450255266/open-doubi</p><p>ä½œè€…ï¼šSimpleWu</p><p>å‡ºå¤„ï¼šhttps://www.cnblogs.com/SimpleWu/p/10930388.html</p><h1><strong>æœ€åï¼Œå°ç¼–ç»™å¤§å®¶åˆ†äº«ä¸€ä»½Javaå­¦ä¹ ä»å…¥é—¨åˆ°ç²¾é€šçš„å…¨å¥—å­¦ä¹ èµ„æ–™</strong></h1><h1><strong>è½¬å‘æ­¤æ–‡ï¼Œå…³æ³¨å¹¶ç§ä¿¡å°ç¼–â€œå­¦ä¹ â€é©¬ä¸Šå…è´¹é¢†å–</strong></h1><div class=pgc-img><img alt=SpringBootæ•´åˆMyBatisPlusé…ç½®åŠ¨æ€æ•°æ®æºï¼ˆæ–‡æœ«æœ‰æƒŠå–œï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6e80367ad0b94f70b707c9208e8e3c57></div><h1><strong>å½“ç„¶è¿˜æœ‰ä¸€äº›å…¶ä»–çš„èµ„æ–™ï¼š</strong></h1><div class=pgc-img><img alt=SpringBootæ•´åˆMyBatisPlusé…ç½®åŠ¨æ€æ•°æ®æºï¼ˆæ–‡æœ«æœ‰æƒŠå–œï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/038e479916b144c0a920e736b2351d14></div><div class=pgc-img><img alt=SpringBootæ•´åˆMyBatisPlusé…ç½®åŠ¨æ€æ•°æ®æºï¼ˆæ–‡æœ«æœ‰æƒŠå–œï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/574575c14a5544ad8c395b63e790ec62></div><div class=pgc-img><img alt=SpringBootæ•´åˆMyBatisPlusé…ç½®åŠ¨æ€æ•°æ®æºï¼ˆæ–‡æœ«æœ‰æƒŠå–œï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8130aa61c5ed451d8a8a375770e130b9></div></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'æ–‡æœ«','SpringBoot','MyBatisPlus'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>