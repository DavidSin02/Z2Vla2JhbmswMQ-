<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>I2C接口学习笔记 | 极客快訊</title><meta property="og:title" content="I2C接口学习笔记 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/d876fbb087244b0e842451017b0f026c"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/90ba125.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/90ba125.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/90ba125.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/90ba125.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/90ba125.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/90ba125.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/90ba125.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/90ba125.html><meta property="article:published_time" content="2020-10-29T21:04:18+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:18+08:00"><meta name=Keywords content><meta name=description content="I2C接口学习笔记"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/90ba125.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>I2C接口学习笔记</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>说明：<u>本文写于2018年1月，现第一次放到头条上。文中大部分资料来自I2C规范，但绝对是本人编写的，部分英文未进行翻译，并不是不知道如何翻译，而是时间有限，对于专业人员而言，意思不难明白，所以就不浪费时间，如果感兴趣的朋友需要进一步探讨，后续会陆续释放出相关接口，如MIPI、UART、HDMI、DDR、SPI等接口的学习笔记。因本人水平有限，文中难免有错漏之处，敬请指正和谅解！</u></p><p>接口名称：IIC 或 I2C</p><p>英文全称：Inter-integrated Circuit</p><p>中文：集成电路总线</p><p>标准维护和制定：NA</p><p>发明者： PHILIPS（1982年）<strong>（现为NXP Semiconductors）</strong></p><p>网址： www.nxp.com</p><p>当前规范<strong>：I2C-bus specification and user manual</strong></p><p>最新版本：V6（1992年释放V1.0）</p><p>生效时间：2014.04.04</p><p>下一版本：NA</p><p>说明： I2C为全双工双向串行总线，一根是双向的数据线SDA，另一根是时钟线SCL。其数据传输速率有以下5种：</p><ol start=1><li>标准模式SM（Standard mode）:100kbps；（双向）</li><li>快速模式FM（Fast mode）: 400Kbps；（双向）</li><li>快速+FM+（Fast Mode Plus）:1Mbps; （双向）</li><li>高速模式HS(High speed mode):3.4Mbps；（双向）</li><li>超快速模式UFM（Ultra Fast-mode）：5Mbps（单向）</li></ol><p>注：行业内许多总线接口都采用IIC接口作为基础然后进行修改和适配。如</p><p>SMBus：System Management Bus www.smbus.org</p><p>PMBus ：Power Management Bus www.pmbus.org</p><p>IPMI：Intelligent Platform Management Interface (www.intel.com/design/servers/ipmi/ipmi.htm)</p><p>DDC：Display Data Channel www.vesa.org.</p><p>ATCA：Advanced Telecom Computing Architecture</p><p>(www.picmg.org/v2internal/resourcepage2.cfm?id=2)</p><p><br></p><p><strong>普通I2C（不含UFM）总线配置示意图</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d876fbb087244b0e842451017b0f026c><p class=pgc-img-caption></p></div><p><strong>UFM I2C总线配置示意图</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1872bf1e68f14393b9e5a247c5b2b22a><p class=pgc-img-caption></p></div><p><strong>一、接口结构</strong></p><p>I2C总线采用二线制传输，一根是数据线SDA（Serial Data Line），另一根是时钟线SCL（Serial Clock line），所有I2C器件都连接在SDA和SCL上，每一个器件具有一个唯一的地址。其架构如下图所示。可以连接几个器件取决于<strong>总线电容</strong>的限制。</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/75aff727bd1743be91e9e7538ffc2c81><p class=pgc-img-caption>I2C连接模型</p></div><p><strong>I2C总线中有一个发送器（Transmitter）和一个接收器（Receiver）。</strong></p><p><strong>I2C总线在逻辑分为Master和Slave两个角色。</strong></p><p>I2C总线支持多主（multi-mastering）和主从（master-slave）两种工作方式。<strong>主机是指启动数据的传送（发起始信号）、发出时钟信号、发出终止信号的器件。通常，主机由单片机或其它微处理器担任。</strong></p><p><strong>从机是指被主机访问的器件，它可以是其它单片机，或者其他外围芯片，如：A/D、D/A、LED或LCD驱动、串行存储器芯片。</strong></p><p>多主方式下，I2C总线上可以有多个主机。I2C总线需通过硬件和软件仲裁来确定主机对总线的控制权。</p><p>主从工作方式时，系统中只有一个主机，总线上的其它器件均为从机（具有I2C总线接口），只有主机能对从机进行读写访问，因此，不存在总线的竞争等问题。在主从方式下，I2C总线的时序可以模拟 ，I2C总线的使用不受主机是否具有I2C总线接口的制。</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b21cf4a450314dbb91b1e8cc5a552a1c><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1dd4d309d7cb4e639fe57737a016a190><p class=pgc-img-caption></p></div><p><strong>二、工作原理</strong></p><p>2.1 非超高速模式I2C总线工作原理</p><p>2.1.1 数据位传输BIT TRANSFER</p><p>I2C总线上主机与从机之间一次传送的数据称为一帧。由<strong>启动信号、若干个数据字节、应答位和停止信号</strong>组成。数据传送的基本单元为8位数据，每个字节后面必须跟随一个ACK位。数据传输是MSB（Most Significant Bit）优先。</p><p>时钟线SCL的一个时钟周期只能传输一位数据。在SCL时钟线为高电平期间内，数据线SDA上的数据必须稳定。当SCL时钟线变为低电平时，数据线SDA的状态才能改变。</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ab8ff00e54994d09989f82aac06673e9><p class=pgc-img-caption></p></div><p><strong>2.1.2 启动和停止 START & STOP conditions</strong></p><p>起始（START）状态：I2C总线传输过程中，当时钟线SCL为高电平，数据线SDA出现高电平到低电平跳变时，标志I2C总线传输数据开始。</p><p>停止（STOP）状态：I2C总线传输过程中，当时钟线SCL为高电平，数据线SDA出现低电平到高电平跳变时，标志着I2C总线传输数据结束。</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/84d1ecbbc7894366a01226c6dc81b458><p class=pgc-img-caption></p></div><p><strong>2.1.3 数据的传送TRANSFERRING DATA</strong></p><p>每次传输的字节数不受限制。每个字节后必须跟一个应答（acknowledge）位。数据传输时，首先传送最高位，如图10.5所示，如果从机暂时不能接收下一个字节数据，如从机响应内部中断，那么，可以使时钟线SCL保持为低电平，迫使主机处于等待状态；当从机准备就绪后，再释放时钟线SCL，使数据传输继续进行。</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3a53ddbd851943ce8cb5d7c830d38a9f><p class=pgc-img-caption></p></div><p><strong>2.1.4 应答Acknowledge</strong></p><p>I2C协议规定，在每个字节传送完毕后，必须有一个应答位。应答位的时钟脉冲由主机产生。在应答时钟有效期间，发送设备把数据线SDA置为高电平；接收设备必须把数据线SDA置为低电平，并且在此期间保持低电平状态，以便产生有效的应答信号。</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/720e0863976747ddb5d9e126b1593d5d><p class=pgc-img-caption></p></div><p><strong>2.1.5 数据传输格式</strong></p><p>在起始状态S之后，先发送一个7位从机地址（或10位地址），接着第8位是数据方向位，＝0表示发送(写)，＝1表示请求数据(读)。</p><p>一次数据传输总是由主机产生停止状态P而结束。但是，如果主机还希望在总线上传输数据，那么，它可以产生另一个起始状态和寻址另一个从机，不需要先产生一个停止状态。在这种传输方式中，就可能有读写方式的组合。</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ca6875457af14e9bb4bdcadd3d91f0d8><p class=pgc-img-caption></p></div><p>在I2C总线启动或应答信号后的第1~8个时钟脉冲，对应一个字节的8位数据传送。高电平期间，数据串行传送；低电平期间为数据准备，允许总线上数据电平变化。一旦I2C总线启动，传送的字节数没有限制，只要求每传送一个字节后，对方回应一个应答位。发送时，最先发送的是数据的最高位。每次传送开始有起始信号，结束时有停止信号。传送完一个字节，可以通过对时钟线的控制使传送暂停</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/674579285d264cb29fe68d2c675729c5><p class=pgc-img-caption></p></div><p><br></p><p>一个SLAVE器件有<strong>7位和10位地址（可支持1024个器件）</strong>两种。使用10位地址格式时，第一个字节的前7位确定地址，第8位确定R（读，高电平）还是/W（写，低电平）。</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e500f12bfb9a4e7f9798812c54b461f9><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e5c8f31095a746ad964b7875c87a93bb><p class=pgc-img-caption></p></div><p><br></p><p><strong>2.2 超快速模式UFM I2C总线工作原理</strong></p><p>超高速I2C总线的速率可达5Mbps，由于其是单向传输（主至从） 其常见用于LED驱动器件，此时MCU作为发送器，LED驱动器件作为接收器。其传输还是基于普通I2C，传输包括START启动位, slave address被动器件地址,command命令位, ninth clock第九时钟 和 STOP位等。它的两根线为区别普通I2C，分别被称之为USDA和USCL。其配置可参考下图。</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/87585a6d134e461783b1e148a4c61be6><p class=pgc-img-caption>UFM Mode I2C</p></div><p><br></p><p><strong>2.2.1 UFM模式I2C的信令和逻辑电平</strong></p><p>逻辑电平同普通I2C，依赖于VDD电压，一般为低电平为0.3VDD，高电平为0.7VDD。</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4872c29a904545c9a796133a2168e5e2><p class=pgc-img-caption></p></div><p><br></p><p><strong>2.2.2 UFM I2C 位传输</strong></p><p>位传输示意图见下图所示<strong>。</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c6a64c5b888d4bfb89dd5ec385652299><p class=pgc-img-caption>Bit Transfer</p></div><p><br></p><p><strong>2.2.3 启动和停止</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d1855428cd464d44be6c528e43e18401><p class=pgc-img-caption>Start & Stop Conditions</p></div><p><br></p><p><strong>2.2.4 字节格式</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1f155ac5b4fc40cb82e70dcdf52f4d0b><p class=pgc-img-caption></p></div><p><br></p><p><strong>2.2.5 数据传输</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/837386ff32f64332845fbe93e6c6352c><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/80d080d377c8427799872680ba61aecc><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0556c75c6076405f87a71fe42bbfd0a7><p class=pgc-img-caption></p></div><p><strong>2.2.6 启动字节</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/53a61109cf0940e0a3712343eeb77b54><p class=pgc-img-caption></p></div><p><strong>2.2.7 Device ID</strong></p><p>在UFM时，不支持Device ID。</p><p><strong>2.2.8 软件复位</strong></p><p>Following a General Call, (0000 0000), sending 0000 0110 (06h) as the second byte</p><p>causes a software reset. This feature is optional and not all devices respond to this</p><p>command. On receiving this 2-byte sequence, all devices designed to respond to the</p><p>general call address reset and take in the programmable part of their address.</p><p><strong>三、应用设计</strong></p><p>普通 SDA和SCL线接口一般设计为开集或开漏;但对于UFM模式（最高达5Mbps）的SDA和SCL则是推挽输出（Push-Pull output）,如下图所示，当总线处于空闲状态时，USCL和USDA脚上部三极管导通而处于高电平。</p><p>不管是普通SDA和SCL还是USDA和USCL，其逻辑电平不依赖于信号电平的大小，而是与供电电压成正比，即一般为输入低电平VIL为0.3VDD，输入高电平VIH为0.7VDD。</p><p>注意：UFM总线（单向）不能兼容普通的、前面4种模式的I2C总线（它们需要电流源或上拉电阻且为双向）。</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e4eded8460424bf187561a632394e14c><p class=pgc-img-caption>普通I2C 内部电路</p></div><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/debf9bdc104c4c1cba7b7b5fc14bfc11><p class=pgc-img-caption>UFM I2C内部 电路</p></div><p><strong>3.1 上拉电阻的选择</strong></p><p>一个标准模式的I2C总线，其连接结构如下图所示。在这种连接结构中，我们来讨论如何确定上拉电阻Rp和串联电阻Rs（防止高压脉冲冲击）的取值范围，进而确定一个阻值的选择规则。</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/26ee2153a26f4637844a2a44da6778b5><p class=pgc-img-caption></p></div><p><br></p><p>根据I2C总线的原理，Rp取值的范围取决于以下三个要素：</p><ol start=1><li>供电电压</li><li>总线电容</li><li>总线上所连接器件的个数（输入电流+漏电电流）</li></ol><p><strong>对于I2C输出，因为总线要求VOLmax = 0.4 V时，标准和快速模式下其SINK灌电流最小值为3mA、快速+模式下为20mA,因此，供电电压限制了Rp的最小值。具体关系见下图3.1 所示。</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9feeb672a97c4520853596452e39bb61><p class=pgc-img-caption>图3.1 Rp最小值与供电电压VDD的关系</p></div><p><strong>例如</strong>：假设供电电压为VDD=5V±10%,VOLmax=0.4 V @3 mA,则Rpmin =</p><p>(5.5-0.4)/0.003=1.7 KΩ</p><p>总线电容是所连接器件的引脚、线缆或线路以及连接器等共同作用的等效电容，其总的等效电容量会影响时钟的上升时间tr,因此，电容Cb与上升时间tr成正比，即电容越大，上升时间tr越大，例如，在标准模式（即速率为100Kbps）时，总等效电容Cb不能大于400pF(快速模式时不能大于100pF,其余值可根据速率而定)。可以说，此电容Cb值确定了Rp(上拉电阻)的最大值。计算公式见如下，具体关系见下图3.2所示。<strong>式中，tr为上升时间，Cb为总线电容</strong></p><p><strong>图3.2 RP最大值与总线电容的关系</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/12edc393a6e04683a7bd8f70099858c3><p class=pgc-img-caption>图3.2 RP最大值 与总线电容的关系</p></div><p><strong>3.2 Rs电阻的选择</strong></p><p>低电平的噪声裕量要求为0.1VDD，因此，此电平的要求限制了Rs的最大值，同时此电阻值也会影响下降时间tf。<strong>供电VDD、Rp和Rs三者之间的关系见下图3.3所示</strong>。</p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3f39ca24629e46aab1f01369d26b0746><p class=pgc-img-caption>图3.3 供电VDD、Rp和Rs三者之间的关系</p></div><p><br></p><p><strong>3.3 输入漏电流Input leakage</strong></p><p>输入高电平最大漏电流为10uA,且高电平时的噪声裕量为0.2VDD，这两个要素就限制了Rp的最大值。其关系图见下图3.4所示。</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/b0b554f9911e457b943365824c69647e><p class=pgc-img-caption></p></div><p><br></p><p>图3.4 输入高电平漏电流与VDD和Rp电阻取值的关系函数</p><p><strong>3.4 标准、快速、快速+及高速模式I2C总线的特性参数</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6b77511f76114ec4a209e04c97cebf37><p class=pgc-img-caption>表3.1. SDA和SCL I/O的特性参数表</p></div><p>[1] Some legacy Standard-mode devices had fixed input levels of VIL = 1.5 V and VIH = 3.0 V. Refer to component data sheets.</p><p>[2] Maximum VIH = VDD(max) + 0.5 V or 5.5 V, whichever is lower. See component data sheets.</p><p>[3] The same resistor value to drive 3 mA at 3.0 V VDD provides the same RC time constant when using &lt;2 V VDD with a smaller current draw.</p><p>[4] In order to drive full bus load at 400 kHz, 6 mA IOL is required at 0.6 V VOL. Parts not meeting this specification can still function, but not at 400 kHz and 400 pF.</p><p>[5] The maximum tf for the SDA and SCL bus lines quoted in 表3.2(300 ns) is longer than the specified maximum tof for the output stages (250 ns). This allows series protection resistors (Rs) to be connected between the SDA/SCL pins and the SDA/SCL bus lines as shown in Figure 45 without exceeding the maximum specified tf.</p><p>[6] Necessary to be backwards compatible with Fast-mode.</p><p>[7] In Fast-mode Plus, fall time is specified the same for both output stage and bus timing. If series resistors are used, designers should allow for this when considering bus timing.</p><p>[8] Input filters on the SDA and SCL inputs suppress noise spikes of less than 50 ns.</p><p>[9] If VDD is switched off, I/O pins of Fast-mode and Fast-mode Plus devices must not obstruct the SDA and SCL lines.</p><p>[10] Special purpose devices such as multiplexers and switches may exceed this capacitance because they connect multiple paths together</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b3cce0a423da4a8aa36581b2ef7a9cdc><p class=pgc-img-caption>表3.2. 标准、快速及快速+等模式下I2C总线器件SDA和SCL的特性参数</p></div><p>[1] All values referred to VIH(min) (0.3VDD) and VIL(max) (0.7VDD) levels (see Table 9).</p><p>[2] tHD;DAT is the data hold time that is measured from the falling edge of SCL, applies to data in transmission and the acknowledge.</p><p>[3] A device must internally provide a hold time of at least 300 ns for the SDA signal (with respect to the VIH(min) of the SCL signal) to bridge the undefined region of the falling edge of SCL.</p><p>[4] The maximum tHD;DAT could be 3.45 μs and 0.9 μs for Standard-mode and Fast-mode, but must be less than the maximum of tVD;DAT or tVD;ACK by a transition time. This maximum must only be met if the device does not stretch the LOW period (tLOW) of the SCL signal. If the clock stretches the SCL, the data must be valid by the set-up time before it releases the clock.</p><p>[5] A Fast-mode I2C-bus device can be used in a Standard-mode I2C-bus system, but the requirement tSU;DAT 250 ns must then be met. This will automatically be the case if the device does not stretch the LOW period of the SCL signal. If such a device does stretch the LOW period of the SCL signal, it must output the next data bit to the SDA line tr(max) + tSU;DAT = 1000 + 250 = 1250 ns (according to the Standard-mode I2C-bus specification) before the SCL line is released. Also the acknowledge timing must meet this set-up time.</p><p>[6] If mixed with Hs-mode devices, faster fall times according to 表3.2 are allowed.</p><p>[7] The maximum tf for the SDA and SCL bus lines is specified at 300 ns. The maximum fall time for the SDA output stage tf is specified at 250 ns. This allows series protection resistors to be connected in between the SDA and the SCL pins and the SDA/SCL bus lines without exceeding the maximum specified tf.</p><p>[8] In Fast-mode Plus, fall time is specified the same for both output stage and bus timing. If series resistors are used, designers should allow for this when considering bus timing.</p><p>[9] Necessary to be backwards compatible to Fast-mode.</p><p>[10] The maximum bus capacitance allowable may vary from this value depending on the actual operating voltage and frequency of the application.具体可参考I2C总线标准文档。</p><p>[11] tVD;DAT = time for data signal from SCL LOW to SDA output (HIGH or LOW, depending on which one is worse).</p><p>[12] tVD;ACK = time for Acknowledgement signal from SCL LOW to SDA output (HIGH or LOW, depending on which one is worse).</p><p>表3.3 高速模式I2C总线器件SDAH, SCLH, SDA和SCL I/O特性参数</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/af47a8561c9948a390bfd205960a4d2a><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/d4257a569c5e4f818ed459142c823bb7><p class=pgc-img-caption></p></div><p>[1] Devices that use non-standard supply voltages which do not conform to the intended I2C-bus system levels must relate their input levels to the VDD voltage to which the pull-up resistors Rp are connected.</p><p>[2] Devices that offer the level shift function must tolerate a maximum input voltage of 5.5 V at SDA and SCL.</p><p>[3] For capacitive bus loads between 100 pF and 400 pF, the rise and fall time values must be linearly interpolated.</p><p>[4] If their supply voltage has been switched off, SDAH and SCLH I/O stages of Hs-mode slave devices must have floating outputs. Due to the current-source output circuit, which normally has a clipping diode to VDD, this requirement is not mandatory for the SCLH or the SDAH I/O stage of Hs-mode master devices. This means that the supply voltage of Hs-mode master devices cannot be switched off without affecting the SDAH and SCLH lines.</p><p>[5] Special purpose devices such as multiplexers and switches may exceed this capacitance because they connect multiple paths together</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8617c990d707497ea57709ad38dedd35><p class=pgc-img-caption>表3.4高速模式Hs I2C-总线器件SDAH, SCLH, SDA和SCL特性参数</p></div><p>[1] All values referred to VIH(min) and VIL(max) levels (see 表3.3).</p><p>[2] For bus line loads Cb between 100 pF and 400 pF the timing parameters must be linearly interpolated.</p><p>[3] A device must internally provide a data hold time to bridge the undefined part between VIH and VIL of the falling edge of the SCLH signal. An input circuit with a threshold as low as possible for the falling edge of the SCLH signal minimizes this hold time.</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/327f38f3f07e4df29d614ad2776c21d1><p class=pgc-img-caption></p></div><p><strong>3.5 UFM模式总线特性参数</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/30be72a032ce47449d0b0f5de16b1c5e><p class=pgc-img-caption>表3.5 USDA和USCL I/O特性参数表</p></div><p>[1] Refer to component data sheets for actual switching points.</p><p>[2] Maximum VIH = VDD(max) + 0.5 V or 5.5 V, whichever is lower. See component data sheets.</p><p>[3] Special purpose devices such as multiplexers and switches may exceed this capacitance because they connect multiple paths together.</p><p>[4] Input filters on the USDA and USCL slave inputs suppress noise spikes of less than 10 ns.</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6b7331b9dfb64e5ca4743995c4a85f5a><p class=pgc-img-caption></p></div><p>[1] tVD;DAT = minimum time for USDA data out to be valid following USCL LOW.</p><p>[2] Typical rise time or fall time for UFm signals is 25 ns measured from the 30 % level to the 70 % level (rise time) or from the 70 % level to the 30 % level (fall time).</p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e3689a935ac9480ea3eb549de9b54945><p class=pgc-img-caption></p></div><p><strong>3.6 电平转换电路的设计</strong></p><p>因为半导体技术的发展，产生了各种电压的信令及接口，如TTL、CMOS、LVTTL、LVCMOS、ECL、PECL、LVPECL、CML、VML等，电压有5V、3.3V、1.8V、1.5V、1.2V、0.6V等等。下面简单介绍一下，电平转换电路，以便I2C电路在不同的电平之间也能起工作。</p><p>下图图3.5中，VDD1=3.3V代表低压端，也可以是2.5V、1.8V等其它电压，VDD2=5V代表高压端，也可以是其它电压，如12V、9V等，原则上就是VDD2>=VDD1.两个N沟通增强型MOS场效应管TR1、TR2充当SCL和SDA线电平转换作用，MOS管G极接低压VDD1端，MOS管S端（源极）接低压端SDA1或SCL1，MOS管D端（漏极）接高压端SDA2或SCL2.其工作原理解释如下：</p><p><strong>当I2C总线空闲时，TR1/TR2 G和S电平均为3.3V，则GS低于导通电压不能导通而MOS管截止，总线高压端与低压端均保持高电平而相互不受影响；</strong></p><p><strong>当低压端总线拉低时，TR1/TR2 G端保持3.3V，S端被拉低电，所以GS高于导通电压而MOS管DS导通，将把SDA2/SCL2的电平拉到低电平状态；</strong></p><p><strong>当高压端总线拉低时，TR1/TR2内置的、并联在D、S两极的反向二极管会导通，直到GS超过导通门限而导通，从而把SDA1/SCL1也拉到低电平。</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/535704b7458948fdb6c7e87724343769><p class=pgc-img-caption>图3.5 电平转换电路原理图</p></div><p><strong>四、测试验证</strong></p><p>I2C总线设计上比较简单，测试也比较简单，用逻辑分析仪和数字示波器就能很好的进行分析，本节就不再介绍<strong>。</strong></p><p><br></p><p>---------------------------------------------------The END------------------------------------------------</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'I2C','学习','笔记'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>