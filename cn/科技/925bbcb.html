<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>运用 Windows Sandbox 打造容器轻量级桌面环境 | 极客快訊</title><meta property="og:title" content="运用 Windows Sandbox 打造容器轻量级桌面环境 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/127bc71da7a9489791ae606fad3da493"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/925bbcb.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/925bbcb.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/925bbcb.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/925bbcb.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/925bbcb.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/925bbcb.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/925bbcb.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/925bbcb.html><meta property="article:published_time" content="2020-10-29T21:04:22+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:22+08:00"><meta name=Keywords content><meta name=description content="运用 Windows Sandbox 打造容器轻量级桌面环境"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/925bbcb.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>运用 Windows Sandbox 打造容器轻量级桌面环境</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><ul><li class=ql-align-justify>Windows10自带Linux子系统(WSL，Windows Subsystem for Linux)后，微软又推出了一种新的轻量级桌面环境 Windows Sandbox，专为安全运行应用程序而量身定制。</li><li class=ql-align-justify>你有多少次下载了一个可执行文件，却害怕运行它？您是否曾经遇到过需要彻底安装Windows 但又不想设置虚拟机的情况？</li></ul><p class=ql-align-justify>在Microsoft，我们经常遇到这些情况，因此微软开发了 Windows Sandbox：一个独立的临时桌面环境，您可以在其中运行不受信任的软件，而不必担心会对您的PC 产生持久影响。Windows Sandbox 中安装的任何软件仅保留在沙箱中，不会影响您的主机。Windows Sandbox 关闭后，将永久删除包含其所有文件和状态的所有软件。</p><p class=ql-align-justify><strong>Windows Sandbox 具有以下属性：</strong></p><ul><li class=ql-align-justify>Windows 原生功能 - 此功能所需的一切都随Windows 10 Pro 和Enterprise 一起提供。无需下载VHD！</li><li class=ql-align-justify>纯净 - 每次Windows Sandbox 运行时，它都像Windows 的全新安装一样干净</li><li class=ql-align-justify>一次性 - 设备上没有任何东西; 关闭应用程序后，一切都将被丢弃</li><li class=ql-align-justify>安全 - 使用基于硬件的虚拟化进行内核隔离，后者依靠Microsoft 的虚拟机管理程序运行单独的内核，将Windows Sandbox 与主机隔离开来</li><li class=ql-align-justify>高效 - 使用集成的内核调度程序，智能内存管理和虚拟GPU</li></ul><p class=ql-align-justify><br></p><p><strong>使用该功能的先决条件</strong></p><ul><li class=ql-align-justify>Windows 10 Pro 或Enterprise Insider 内部版本18305 或更高版本</li><li class=ql-align-justify>AMD64 架构</li><li class=ql-align-justify>在BIOS 中启用虚拟化功能</li><li class=ql-align-justify>至少4GB 的RAM（推荐8GB）</li><li class=ql-align-justify>至少1 GB 的可用磁盘空间（建议使用SSD）</li><li class=ql-align-justify>至少2 个CPU 核心（建议使用4 个超线程核心）</li></ul><p class=ql-align-justify><br></p><p><strong>快速开始</strong></p><ul><li class=ql-align-justify>安装Windows 10 预览版18305 （专业版 或 企业版）</li><li class=ql-align-justify>启用虚拟化：</li><li class="ql-align-justify ql-indent-1">如果您使用的是物理机，请确保在BIOS 中启用了虚拟化功能。</li><li class="ql-align-justify ql-indent-1">如果您使用的是虚拟机，请使用此PowerShell cmdlet 启用嵌套虚拟化：Set-VMProcessor -VMName &lt;VMName> -ExposeVirtualizationExtensions $ true</li><li class=ql-align-justify>打开Windows 功能，然后选择Windows Sandbox。选择“ 确定” 以安装Windows Sandbox。系统可能会要求您重新启动计算机。</li></ul><p class=ql-align-center><br></p><div class=pgc-img><img alt="运用 Windows Sandbox 打造容器轻量级桌面环境" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/127bc71da7a9489791ae606fad3da493><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><ul><li class=ql-align-justify>使用“ 开始” 菜单，找到Windows Sandbox，运行它并允许提权</li><li class=ql-align-justify>从主机复制可执行文件</li><li class=ql-align-justify>将可执行文件粘贴到Windows Sandbox 的窗口中（在Windows 桌面上）</li><li class=ql-align-justify>在Windows Sandbox 中运行可执行文件; 如果是安装程序，请继续安装</li><li class=ql-align-justify>运行应用程序并像平常一样使用它</li><li class=ql-align-justify>完成实验后，您只需关闭Windows Sandbox 应用程序即可。所有沙盒内容都将被丢弃并永久删除</li><li class=ql-align-justify>确认主机没有您在Windows Sandbox 中进行的任何修改</li></ul><p class=ql-align-justify><br></p><p class=ql-align-center><br></p><div class=pgc-img><img alt="运用 Windows Sandbox 打造容器轻量级桌面环境" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/55409c3b28234312b9b23df1df029813><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>Windows Sandbox 遵循宿主机的数据设置。所有其他隐私设置都设置为其默认值。</p><p class=ql-align-justify></p><p class=ql-align-justify><strong>Windows Sandbox 技术详解</strong></p><p class=ql-align-justify>Windows Sandbox 构建于 Windows 容器技术之上。Window容器最初的设计是为应用在云中运行。Windows Sandbox采用了该技术，增加了与Windows 10 的集成，并构建了一些功能，使其更适合在PC和笔记本电脑上运行，而无需Windows Server 的全部功能。</p><p class=ql-align-justify><strong>微软所做的一些重要改进包括：</strong></p><ul><li class=ql-align-justify>动态生成的图像</li></ul><p class=ql-align-justify>Windows Sandbox 的核心是一个轻量级虚拟机，因此需要一个操作系统镜像才能启动。Windows Sandbox的一项重要增强功能是能够使用计算机上安装的Windows 10 副本，而不是像使用普通虚拟机那样下载新的VHD 映像。</p><p class=ql-align-justify>我们希望始终呈现一个干净的环境，但挑战在于某些操作系统文件可能会发生变化。Sandbox的解决方案是构建称之为“动态基本映像” 的操作系统映像：具有可以更改的文件的干净副本的操作系统映像，但链接到主机上已存在的Windows 映像中无法更改的文件。大多数文件是链接（不可变文件），这就是完整操作系统的小尺寸（~100MB）的原因。我们使用Windows 容器术语将此实例称为Windows Sandbox 的“基本映像”。</p><p class=ql-align-justify>如果未安装Windows Sandbox，我们会将动态基本映像保存在仅 25MB 的压缩包中。安装动态基础包时，它占用大约100MB 的磁盘空间。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="运用 Windows Sandbox 打造容器轻量级桌面环境" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/cc1bb9d81d3440378cf5558a03d5870b><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><ul><li class=ql-align-justify><strong>智能内存管理</strong></li></ul><p class=ql-align-justify>内存管理是Sandbox与Windows 内核集成的另一个领域。Microsoft 的虚拟机管理程序允许将单个物理机器划分为多个共享相同物理硬件的虚拟机。虽然这种方法适用于传统的服务器工作负载，但它不适合运行资源有限的设备。微软设计了Windows Sandbox，以便主机可以根据需要从沙盒中回收内存。</p><p class=ql-align-justify>此外，由于Windows Sandbox 基本上运行与主机相同的操作系统映像，因此还允许Windows Sandbox通过称为“直接映射” 的技术使用与操作系统二进制文件的主机相同的物理内存页面。换句话说，ntdll 的相同可执行页面将映射到主机上的沙箱中。Windows Sandbox确保以安全的方式完成这项工作，并且不会分享任何涉密内容。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="运用 Windows Sandbox 打造容器轻量级桌面环境" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9e0942a1da5f453996ae6c6098baba79><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><ul><li class=ql-align-justify><strong>集成内核调度程序</strong></li></ul><p class=ql-align-justify>使用普通虚拟机，Microsoft 的虚拟机管理程序可控制在VM 中运行的虚拟处理器的调度。但是，对于Windows Sandbox，使用称为“集成调度程序” 的新技术，该技术允许主机决定何时运行沙箱。</p><p class=ql-align-justify></p><p class=ql-align-justify>Windows Sandbox采用了一种独特的调度策略，该策略允许以与为进程调度线程相同的方式调度沙箱的虚拟处理器。主机上的高优先级任务可以抢占沙箱中不太重要的工作。使用集成调度程序的好处是，主机将Windows Sandbox 作为一个进程而不是虚拟机来管理，从而产生响应速度更快的主机，类似于 Linux KVM。</p><p class=ql-align-justify></p><p class=ql-align-justify>这里的整个目标是将Sandbox 视为应用程序，但具有虚拟机的安全保障。</p><p class=ql-align-justify></p><ul><li class=ql-align-justify><strong>快照和克隆</strong></li></ul><p class=ql-align-justify>如上所述，Windows Sandbox 使用Microsoft 的虚拟机管理程序。如果我们需要运行一个Windows副本，可能需要一些时间来启动副本。因此，不是每次启动Windows Sandbox 时都占用使用沙盒操作系统的全部资源，而是使用其他两种技术; “快照” 和“克隆”。</p><p class=ql-align-justify></p><p class=ql-align-justify>快照允许我们一次启动沙盒环境并将内存，CPU 和设备状态保存到磁盘。然后，当我们需要一个新的Windows Sandbox 实例时，我们可以从磁盘恢复沙箱环境并将其放入内存而不是启动它。这明显减少了Windows Sandbox 的启动时间。</p><ul><li class=ql-align-justify><strong>图形虚拟化</strong></li></ul><p class=ql-align-justify>硬件加速渲染是快速稳定的响应用户体验的关键，特别是对于图形密集型或媒体密集型用例。但是，虚拟机与其主机隔离，无法访问GPU 等高级设备。因此，图形虚拟化技术的作用是弥合这一差距，并在虚拟化环境中提供硬件加速; 例如 Microsoft RemoteFX。</p><p class=ql-align-justify></p><p class=ql-align-justify>最近，Microsoft 与它的图形生态系统合作伙伴合作，将现代图形虚拟化功能直接集成到DirectX 和WDDM 中，这是Windows 上显示驱动程序使用的驱动程序模型。</p><p class=ql-align-justify></p><p class=ql-align-justify>从较高层面来看，这种形式的图形虚拟化的工作原理如下：</p><ul><li class=ql-align-justify>在Hyper-V VM 中运行的应用程序正常使用图形API。</li><li class=ql-align-justify>VM 中的图形组件（已被开启以支持虚拟化）在VM 边界与主机协调以执行图形工作负载。</li><li class=ql-align-justify>主机在VM 中的应用程序之间分配和调度图形资源以及本机运行的应用程序。从概念上讲，它们表现为一个图形客户端池。</li></ul><p class=ql-align-justify><br></p><p class=ql-align-justify><strong>此过程如下所示：</strong></p><p class=ql-align-center><br></p><div class=pgc-img><img alt="运用 Windows Sandbox 打造容器轻量级桌面环境" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3a446a40143940f69f45955181e857db><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>这使Windows Sandbox VM 能够受益于硬件加速渲染，Windows 可以在主机和来宾之间动态分配图形资源。其结果是提高了Windows Sandbox 中运行的应用程序的性能和响应能力，并提高了图形密集用例的电池寿命。</p><p class=ql-align-justify></p><p class=ql-align-justify>要利用这些优势，您需要一个具有兼容GPU 和图形驱动程序（WDDM 2.5 或更高版本）的系统。不兼容的系统将使用Microsoft 的基于CPU 的渲染技术在Windows Sandbox 中呈现应用程序。</p><ul><li class=ql-align-justify>电池直通</li></ul><p class=ql-align-justify>Windows Sandbox 还了解主机的电池状态，从而可以优化功耗。这对于将用于笔记本电脑的技术至关重要，因为不浪费电池对用户来说非常重要。</p><p class=ql-align-justify></p><p class=ql-align-justify><strong>结束语</strong></p><p class=ql-align-justify>使用Windows Sandbox，您可以得到一个安全清爽无残留的沙盒子系统。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'运用','Windows','Sandbox'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>