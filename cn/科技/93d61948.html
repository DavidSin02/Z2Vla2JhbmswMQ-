<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>基于4通道时间交织的FPGA高速采样系统 | 极客快訊</title><meta property="og:title" content="基于4通道时间交织的FPGA高速采样系统 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/5957000798649c5ce814"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/93d61948.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/93d61948.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/93d61948.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/93d61948.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/93d61948.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/93d61948.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/93d61948.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/93d61948.html><meta property="article:published_time" content="2020-11-14T21:01:13+08:00"><meta property="article:modified_time" content="2020-11-14T21:01:13+08:00"><meta name=Keywords content><meta name=description content="基于4通道时间交织的FPGA高速采样系统"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/93d61948.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>基于4通道时间交织的FPGA高速采样系统</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>李 宇1，2，刘崇庆2，3，吕立钧3，谭洪舟3</p><p>（1.广东药科大学 信息工程学院，广东 广州510006；</p><p>2.华为技术有限公司，广东 深圳518129；</p><p>3.广东顺德中山大学-卡内基梅隆大学国际联合研究院，广东 顺德528300）</p><p><strong>摘 要：</strong>时间交织采样是提高模数转换器采样率的一种有效途径。为了完成时间交织采样的通道失配误差方法评估，提出并设计了一套基于4通道时间交织的FPGA高速模数转换采样系统。系统由前端模拟电路、采样阵列、多相时钟电路模块、基于FPGA的数据缓冲与修正处理模块构成。系统采样输出数据通过上传到上位机进行显示与性能指标分析。测试结果表明，该TIADC系统通过对失配误差的数字后端补偿后能稳定工作在1 GS/s采样率。其采样有效位与平均信噪比分别达到7.03 bit与44.1 dB，可以应用于采样失配修正方法的验证与评估。</p><p><strong>中图分类号：</strong>TN957.5</p><p><strong>文献标识码：</strong>A</p><p><strong>DOI：</strong>10.16157/j.issn.0258-7998.172139</p><p><strong>中文引用格式：</strong>李宇，刘崇庆，吕立钧，等. 基于4通道时间交织的FPGA高速采样系统[J].电子技术应用，2018，44(1)：52-56.</p><p><strong>英文引用格式：</strong>Li Yu，Liu Chongqing，Lv Lijun，et al. FPGA high-speed sampling system based on 4 channel time-interleaved[J]. Application of Electronic Technique，2018，44(1)：52-56.</p><p><strong>0 引言</strong></p><p>高性能的模数转换器(Analog Digital Converter，ADC)被广泛应用于通信、仪器仪表、计算机和医疗设备等领域，对国民经济、国防建设以及科学研究具有重要意义。单采样单元的ADC芯片由于存在内部热噪声、孔径抖动和渡越时间不确定性等因素，面临采样速度和精度相互制约的影响，出现了瓶颈。而由多通道时间交织ADC(Time-Interleaved ADC，TIADC)采用M个相同型号的ADC单元依次交替完成采样。理论上，TIADC的采样率可以到达单ADC的M倍，同时保持采样精度基本不变<sup>[1]</sup>。但是由于ADC采样单元与外围电路的个体差异，导致的采样通道间不一致性会引起失配失真，如偏置误差、增益误差以及时间相位误差将严重降低数据采集系统性能<sup>[2]</sup>。基于数字信号处理方法的数字后端修正技术可有效抑制以上失配造成的失真。近年来，已有文献应用FPGA实现数字后端修正技术。文献[3]采用DSP与FPGA实现了4通道交织采样速率达1G的采样系统，并对误差进行了补偿。文献[4]则设计了400 MS/s的2通道交织采样系统。</p><p>本文提出并设计了一套4通道时间交织FPGA高速模拟信号采样系统。系统的数据流控制、失配误差数字修正等功能均在1片FPGA中实现，无需额外采用DSP处理器，降低了系统的结构复杂度。</p><p><strong>1 TIADC系统方案</strong></p><p>系统采用4块8 bit、具有250 MS/s的AD9481模数转换器通过时间交织采样实现1 GS/s、8 bit的采样系统。系统由功率分配与差分传输电路、ADC阵列、多相时钟电路以及FPGA等构成(如图1所示)。模拟前端信号经等功率拆分并转换为差分信号传输至ADC阵列，4路ADC在多相时钟驱动下对输入信号并行交织模数转换，产生的高速数据流交由FPGA实现缓存、修正并上传到PC，完成显示与性能评估。</p><img alt=基于4通道时间交织的FPGA高速采样系统 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/5957000798649c5ce814><p><strong>1.1 ADC模拟前端信号处理</strong></p><p>模拟输入信号通过信号调理电路到达ADC采样前端时，由于物理器件及结构的不一致性带来通道间的偏置误差及增益误差，将分别在频域±kf<sub>s</sub>/M、±f<sub>in</sub>+kf<sub>s</sub>/M产生峰值杂散谱，其中k=1，2，…，M-1，导致信噪比降低<sup>[5]</sup>。采取对同一模拟信号进行等功率拆分与差分传输方式进行模拟前端信号处理。首先，选用SCP-4-1+功分器进行输入信号1:4拆分，在输入信号带宽为1~400 MHz情况下，功率拆分输出4路信号相位失配最大仅为0.58°，并保证最大幅度失配小于0.15 dB。然后采用射频变压器ADT4-1WT+，设计了差分传输电路，其输入输出绕线比为4:1，具有一定的升压作用。电路如图2所示。</p><img alt=基于4通道时间交织的FPGA高速采样系统 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/5674000f7fd068d8712b><p><strong>1.2 高精度多相时钟设计</strong></p><p>基于AD9516-3的时钟合成方案可以实现高稳定度的频率合成与分频，如图3所示。由于时钟产生单元的LVPECL通道分频系数仅支持由1～32整数倍调节，且信号延时的粗调Δt<sub>1</sub>～Δt<sub>4</sub>与PLL倍频频周期的最小单位有关，为方便相位调节，通过FPGA的控制逻辑SPI配置时钟芯片的功能寄存器，对VCO分频器进行2分频得到1 GHz信号，然后通道分频器对该信号进行4分频，产生4路250 MHz相位不定的LVPECL时钟信号。应用由LC电路组成的可编程延迟线，通过控制延迟模块电路中的DAC调节电容C以实现时钟信号延迟控制得到4路时钟信号的相位差分别为0°、90°、180°以及270°。</p><img alt=基于4通道时间交织的FPGA高速采样系统 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/56770007a7fdcf5074a6><p><strong>2 高速数据流缓存与处理</strong></p><p>系统采用EP3C25Q240C6作为数据流处理单元，其逻辑功能包括由片内RAM组成的异步FIFO缓冲模块，以及对各通道ADC数据进行失配误差处理的修正模块等。由于系统的输入数据带宽大于输出数据带宽，设计了数据发送缓冲存储器实现数据上传，最后利用剩余的逻辑资源例化一个逻辑分析仪模块。逻辑功能结构如图4所示。</p><img alt=基于4通道时间交织的FPGA高速采样系统 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/5957000798658ab9ec52><p><strong>2.1 数据接收缓存与重排序</strong></p><p>为实现异步时钟域的数据接收，系统的接收模块采用异步FIFO，采用ADC输出的随路时钟DCO作为FIFO的写时钟。由于DCO输出的相位与驱动ADC的多相输入时钟有关，输出的等相位差、多路随路时钟DCO_1+、DCO_2+、DCO_3+、DCO_4+、DCO_1-、DCO_2-、DCO_3-、DCO_4-按相位要求依次向FIFOA/B/C/D_P及FIFOA/B/C/D_N中写入采样数据，其中写请求在随路时钟上升沿触发。为防止FIFO读空或者写满，经DCO_4-同步并发出写请求后，等待FIFO半满，发出FIFO读请求，保证FIFO的容量始终保持在FIFO的中间状态，提高缓存的安全度，保证了重排序与联合模块输出与采样顺序同步。</p><p><strong>2.2 误差修正</strong></p><p>通道间的电路特性差异导致失配误差，降低了无伪谱动态范围等性能。选用第1通道为另外3条通道的参考通道。直流偏置误差与增益误差可以通过在需要修正的每条通道上增加一个加法器与乘法器进行补偿。补偿前需要失配参数的测定。此模块应用文献[6]提出的FFT方法消除以上3种误差。剩下的时间失配误差则应用文献[7]的频率稀疏性方法进行修正。由于修正补偿方法不是本文的设计重点，更丰富的修正方法可以参考文献[8]等。</p><p><strong>2.3 采样数据存储与上传</strong></p><p>采用SignalTap II实现采样信号重现，并上传PC。通过例化一个双端口RAM作为发送数据存储器，其深度为256，对应于系统测试时每次获取32 Kbit数据。数据发送存储器通过判断双口RAM地址的大小来决定系统数据的发送或接收。发送存储器初始化状态时默认为接收状态，地址为0，允许采样处理后的数据写入发送存储器，同时禁能存储器读和数据上传命令，当发送存储器满，即地址为255时，禁能发送存储器写，同时使能存储器读和数据上传命令。系统数据上传流程如图5所示。</p><img alt=基于4通道时间交织的FPGA高速采样系统 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/595700079866b35eb145><p><strong>3 TIADC系统实验与测试</strong></p><p><strong>3.1 实验测试条件与环境</strong></p><p>实验评测包括信噪比以及有效位分析等，方案如图6所示。硬件测试用到信号发生器、示波器、信号源分析仪、稳压电源等设备。</p><img alt=基于4通道时间交织的FPGA高速采样系统 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/595800020c8d83ef78f8><p><strong>3.2 性能测试评估</strong></p><p>首先对单通道ADC性能测试，4路ADC分别对一个幅度为1 Vp-p、频率为17 MHz的正弦波信号在250 MS/s采样率下进行采样，分析得到4个单通道ADC的性能结果如图7所示。测试的平均SNR达到44.93 dB，较AD9481官方参数降低1.07 dB；平均有效位达到7.17 bit，较官方参数降低0.33 bit，误差控制在较低水平。</p><img alt=基于4通道时间交织的FPGA高速采样系统 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/5676000b8aea8a0962be><p>对输入信号幅度1 Vp-p、频率70 MHz的正弦波信号进行1 GS/s的交织采样，得到未进行数字补偿的输出。图8是SignalTap II抓取的时域波形，其对应的频谱图如图9所示。</p><img alt=基于4通道时间交织的FPGA高速采样系统 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/5675000b9348806fd57a><img alt=基于4通道时间交织的FPGA高速采样系统 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/56770007a7fed3a38ceb><p>显然在位于频率点250 MHz以及±70 MHz+250 MHz处出现峰值误差杂散谱，与前面描述相吻合。通过在FPGA中应用文献[6，7]的误差修正方法，得到输出信号频谱如图10所示。修正使得信号的信噪比提高了18.7 dB，达到44.3 dB，有效位提高3.11 bit，达到7.06 bit。硬件引起的通道失配误差保持在一个较低水平且是可控的。</p><img alt=基于4通道时间交织的FPGA高速采样系统 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/5674000f7fd35b610a10><p>为验证系统工作的有效性，分别对0~250 MHz内的正弦信号进行采样与数字后端通道失配误差补偿。系统采样的性能参数如表1所示。随着采样信号频率的升高，系统受信号抖动、时延以及ADC芯片本身存在的频率特性等不确定因素影响增多，SNR与ENOB呈现下降趋势，但保持在误差可控范围之内。</p><img alt=基于4通道时间交织的FPGA高速采样系统 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/5957000798695203e9d0><p><strong>4 结论</strong></p><p>本文设计了一套FPGA处理交织采样重构与通道失配修正的高速采样系统。通过失配误差的数字后端补偿，系统性能得到明显提高。该系统能稳定工作在1 GS/s采样率下，平均信噪比达到44.1 dB，有效位达到7.03 bit。由系统硬件引起的通道失配误差得到有效控制, 适用于数字失配修正补偿方法的验证与评估。</p><p><strong>参考文献</strong></p><p>[1] MANGANARO G，ROBERTSON D.Interleaving ADCs：Unraveling the mysteries[J].Analogue Dialogue，2015，49.</p><p>[2] 张尚良，邹月娴.TIADC高速数据捕获和时间失配补偿的FPGA实现[J]. 数据采集与处理，2011(5)：601-608.</p><p>[3] 易敏，苏淑靖，季伟，等.基于FPGA的高速时间交替采样系统[J].电子技术应用，2015，41(1)：71-74.</p><p>[4] 骈洋，苏淑靖.基于时间交替采样技术的高速高精度ADC系统[J].电子器件，2016，39(6)：1397-1401.</p><p>[5] MEHTA N.Sampling time error calibration for time-inter-leaved ADCs[D].Hollad：Delft University of Technology，2013.</p><p>[6] PEREIRA J M D，GIRAO P M B S，SERRA A M C.An FFT-basedmethod to evaluate and compensate gain and offset errors of interleaved ADC systems[J].Instrumentation & Measurement IEEE Transactions on，2004，53(2)：423-430.</p><p>[7] LIU S J，XU X J，ZOU Y X.Blind timing skew estimation based on spectra sparsity and all phase FFT for time-interleaved ADCs[C].IEEE International Conference on Digital Signal Processing.IEEE，2015：926-930.</p><p>[8] 尹勇生，吴景生，陈红梅，等.一种带参考注入信号的TIADC时间失配校准算法[J].电子技术应用，2017，43(5)：44-47.</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'时间','交织','FPGA'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>