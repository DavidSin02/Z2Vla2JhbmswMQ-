<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Pandas数据帧（DataFrame） | 极客快訊</title><meta property="og:title" content="Pandas数据帧（DataFrame） - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/a751fee7daf04c45b9c1f9268ffa241c"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/96b841c.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/96b841c.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/96b841c.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/96b841c.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/96b841c.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/96b841c.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/96b841c.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/96b841c.html><meta property="article:published_time" content="2020-10-29T21:06:37+08:00"><meta property="article:modified_time" content="2020-10-29T21:06:37+08:00"><meta name=Keywords content><meta name=description content="Pandas数据帧（DataFrame）"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/96b841c.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Pandas数据帧（DataFrame）</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>数据帧(DataFrame)是二维数据结构，即数据以行和列的表格方式排列。</p><p>数据帧(DataFrame)的功能特点：</p><ul><li>潜在的列是不同的类型</li><li>大小可变</li><li>标记轴(行和列)</li><li>可以对行和列执行算术运算</li></ul><p><strong>结构体</strong></p><p>假设要创建一个包含学生数据的数据帧。参考以下图示 -</p><div class=pgc-img><img alt=Pandas数据帧（DataFrame） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a751fee7daf04c45b9c1f9268ffa241c><p class=pgc-img-caption></p></div><p>可以将上图表视为SQL表或电子表格数据表示。</p><p>pandas.DataFrame</p><p><em>pandas</em>中的DataFrame可以使用以下构造函数创建 -</p><pre>pandas.DataFrame( data, index, columns, dtype, copy)Python</pre><p>构造函数的参数如下 -</p><p>1 data 数据采取各种形式，如:ndarray，series，map，lists，dict，constant和另一个DataFrame。</p><p>2 index 对于行标签，要用于结果帧的索引是可选缺省值np.arrange(n)，如果没有传递索引值。</p><p>3 columns 对于列标签，可选的默认语法是 - np.arange(n)。 这只有在没有索引传递的情况下才是这样。</p><p>4 dtype 每列的数据类型。</p><p>5 copy 如果默认值为False，则此命令(或任何它)用于复制数据。</p><p>创建DataFrame</p><p>Pandas数据帧(<em>DataFrame</em>)可以使用各种输入创建，如 -</p><ul><li>列表</li><li>字典</li><li>系列</li><li>Numpy ndarrays</li><li>另一个数据帧(<em>DataFrame</em>)</li></ul><p>在本章的后续章节中，我们将看到如何使用这些输入创建数据帧(<em>DataFrame</em>)。</p><p>创建一个空的DataFrame</p><p>创建基本数据帧是空数据帧。</p><p><strong>示例</strong></p><pre>#import the pandas library and aliasing as pdimport pandas as pddf = pd.DataFrame()print dfPython</pre><p>执行上面示例代码，得到以下结果 -</p><pre>Empty DataFrameColumns: []Index: []Shell</pre><p>从列表创建DataFrame</p><p>可以使用单个列表或列表列表创建数据帧(<em>DataFrame</em>)。</p><p><strong>实例-1</strong></p><pre>import pandas as pddata = [1,2,3,4,5]df = pd.DataFrame(data)print dfPython</pre><p>执行上面示例代码，得到以下结果 -</p><pre> 00 11 22 33 44 5Shell</pre><p><strong>实例-2</strong></p><pre>import pandas as pddata = [['Alex',10],['Bob',12],['Clarke',13]]df = pd.DataFrame(data,columns=['Name','Age'])print dfPython</pre><p>执行上面示例代码，得到以下结果 -</p><pre> Name Age0 Alex 101 Bob 122 Clarke 13Shell</pre><p><strong>实例-3</strong></p><pre>import pandas as pddata = [['Alex',10],['Bob',12],['Clarke',13]]df = pd.DataFrame(data,columns=['Name','Age'],dtype=float)print dfPython</pre><p>执行上面示例代码，得到以下结果 -</p><pre> Name Age0 Alex 10.01 Bob 12.02 Clarke 13.0Shell</pre><blockquote><p>注意 - 可以观察到，dtype参数将Age列的类型更改为浮点。</p></blockquote><p>从ndarrays/Lists的字典来创建DataFrame</p><p>所有的ndarrays必须具有相同的长度。如果传递了索引(index)，则索引的长度应等于数组的长度。</p><p>如果没有传递索引，则默认情况下，索引将为range(n)，其中n为数组长度。</p><p><strong>实例-1</strong></p><pre>import pandas as pddata = {'Name':['Tom', 'Jack', 'Steve', 'Ricky'],'Age':[28,34,29,42]}df = pd.DataFrame(data)print dfPython</pre><p>执行上面示例代码，得到以下结果 -</p><pre> Age Name0 28 Tom1 34 Jack2 29 Steve3 42 RickyShell</pre><blockquote><p>注 - 观察值0,1,2,3。它们是分配给每个使用函数range(n)的默认索引。</p></blockquote><p><strong>示例-2</strong></p><p>使用数组创建一个索引的数据帧(<em>DataFrame</em>)。</p><pre>import pandas as pddata = {'Name':['Tom', 'Jack', 'Steve', 'Ricky'],'Age':[28,34,29,42]}df = pd.DataFrame(data, index=['rank1','rank2','rank3','rank4'])print dfPython</pre><p>执行上面示例代码，得到以下结果 -</p><pre> Age Namerank1 28 Tomrank2 34 Jackrank3 29 Steverank4 42 RickyShell</pre><blockquote><p>注意 - index参数为每行分配一个索引。</p></blockquote><p>从列表创建数据帧DataFrame</p><p>字典列表可作为输入数据传递以用来创建数据帧(<em>DataFrame</em>)，字典键默认为列名。</p><p><strong>实例-1</strong></p><p>以下示例显示如何通过传递字典列表来创建数据帧(<em>DataFrame</em>)。</p><pre>import pandas as pddata = [{'a': 1, 'b': 2},{'a': 5, 'b': 10, 'c': 20}]df = pd.DataFrame(data)print dfPython</pre><p>执行上面示例代码，得到以下结果 -</p><pre> a b c0 1 2 NaN1 5 10 20.0Shell</pre><blockquote><p>注意 - 观察到，NaN(不是数字)被附加在缺失的区域。</p></blockquote><p><strong>示例-2</strong></p><p>以下示例显示如何通过传递字典列表和行索引来创建数据帧(<em>DataFrame</em>)。</p><pre>import pandas as pddata = [{'a': 1, 'b': 2},{'a': 5, 'b': 10, 'c': 20}]df = pd.DataFrame(data, index=['first', 'second'])print dfPython</pre><p>执行上面示例代码，得到以下结果 -</p><pre> a b cfirst 1 2 NaNsecond 5 10 20.0Shell</pre><p><strong>实例-3</strong></p><p>以下示例显示如何使用字典，行索引和列索引列表创建数据帧(<em>DataFrame</em>)。</p><pre>import pandas as pddata = [{'a': 1, 'b': 2},{'a': 5, 'b': 10, 'c': 20}]#With two column indices, values same as dictionary keysdf1 = pd.DataFrame(data, index=['first', 'second'], columns=['a', 'b'])#With two column indices with one index with other namedf2 = pd.DataFrame(data, index=['first', 'second'], columns=['a', 'b1'])print df1print df2Python</pre><p>执行上面示例代码，得到以下结果 -</p><pre>#df1 output a bfirst 1 2second 5 10#df2 output a b1first 1 NaNsecond 5 NaNShell</pre><blockquote><p>注意 - 观察，df2使用字典键以外的列索引创建DataFrame; 因此，附加了NaN到位置上。 而df1是使用列索引创建的，与字典键相同，所以也附加了NaN。</p></blockquote><p>从系列的字典来创建DataFrame</p><p>字典的系列可以传递以形成一个DataFrame。 所得到的索引是通过的所有系列索引的并集。</p><p><strong>示例</strong></p><pre>import pandas as pdd = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']), 'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}df = pd.DataFrame(d)print df`Python</pre><p>执行上面示例代码，得到以下结果 -</p><pre> one twoa 1.0 1b 2.0 2c 3.0 3d NaN 4Shell</pre><blockquote><p>注意 - 对于第一个系列，观察到没有传递标签'd'，但在结果中，对于d标签，附加了NaN。</p></blockquote><p>现在通过实例来了解列选择，添加和删除。</p><p>列选择</p><p>下面将通过从数据帧(DataFrame)中选择一列。</p><p>示例</p><pre>import pandas as pdd = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']), 'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}df = pd.DataFrame(d)print df ['one']Python</pre><p>执行上面示例代码，得到以下结果 -</p><pre>a 1.0b 2.0c 3.0d NaNName: one, dtype: float64Shell</pre><p>列添加</p><p>下面将通过向现有数据框添加一个新列来理解这一点。</p><p><strong>示例</strong></p><pre>import pandas as pdd = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']), 'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}df = pd.DataFrame(d)# Adding a new column to an existing DataFrame object with column label by passing new seriesprint ("Adding a new column by passing as Series:")df['three']=pd.Series([10,20,30],index=['a','b','c'])print dfprint ("Adding a new column using the existing columns in DataFrame:")df['four']=df['one']+df['three']print dfPython</pre><p>执行上面示例代码，得到以下结果 -</p><pre>Adding a new column by passing as Series: one two threea 1.0 1 10.0b 2.0 2 20.0c 3.0 3 30.0d NaN 4 NaNAdding a new column using the existing columns in DataFrame: one two three foura 1.0 1 10.0 11.0b 2.0 2 20.0 22.0c 3.0 3 30.0 33.0d NaN 4 NaN NaNShell</pre><p>列删除</p><p>列可以删除或弹出; 看看下面的例子来了解一下。</p><p><strong>例子</strong></p><pre># Using the previous DataFrame, we will delete a column# using del functionimport pandas as pdd = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']),  'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd']),  'three' : pd.Series([10,20,30], index=['a','b','c'])}df = pd.DataFrame(d)print ("Our dataframe is:")print df# using del functionprint ("Deleting the first column using DEL function:")del df['one']print df# using pop functionprint ("Deleting another column using POP function:")df.pop('two')print dfPython</pre><p>执行上面示例代码，得到以下结果 -</p><pre>Our dataframe is: one three twoa 1.0 10.0 1b 2.0 20.0 2c 3.0 30.0 3d NaN NaN 4Deleting the first column using DEL function: three twoa 10.0 1b 20.0 2c 30.0 3d NaN 4Deleting another column using POP function: threea 10.0b 20.0c 30.0d NaNShell</pre><p>行选择，添加和删除</p><p>现在将通过下面实例来了解行选择，添加和删除。我们从选择的概念开始。</p><p><strong>标签选择</strong></p><p>可以通过将行标签传递给loc()函数来选择行。参考以下示例代码 -</p><pre>import pandas as pdd = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']),  'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}df = pd.DataFrame(d)print df.loc['b']Python</pre><p>执行上面示例代码，得到以下结果 -</p><pre>one 2.0two 2.0Name: b, dtype: float64Shell</pre><p>结果是一系列标签作为DataFrame的列名称。 而且，系列的名称是检索的标签。</p><p><strong>按整数位置选择</strong></p><p>可以通过将整数位置传递给iloc()函数来选择行。参考以下示例代码 -</p><pre>import pandas as pdd = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']), 'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}df = pd.DataFrame(d)print df.iloc[2]Python</pre><p>执行上面示例代码，得到以下结果 -</p><pre>one 3.0two 3.0Name: c, dtype: float64Shell</pre><p>行切片</p><p>可以使用:运算符选择多行。参考以下示例代码 -</p><pre>import pandas as pdd = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']),  'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}df = pd.DataFrame(d)print df[2:4]Python</pre><p>执行上面示例代码，得到以下结果 -</p><pre> one twoc 3.0 3d NaN 4Shell</pre><p><strong>附加行</strong></p><p>使用append()函数将新行添加到DataFrame。 此功能将附加行结束。</p><pre>import pandas as pddf = pd.DataFrame([[1, 2], [3, 4]], columns = ['a','b'])df2 = pd.DataFrame([[5, 6], [7, 8]], columns = ['a','b'])df = df.append(df2)print dfPython</pre><p>执行上面示例代码，得到以下结果 -</p><pre> a b0 1 21 3 40 5 61 7 8Shell</pre><p><strong>删除行</strong></p><p>使用索引标签从DataFrame中删除或删除行。 如果标签重复，则会删除多行。</p><p>如果有注意，在上述示例中，有标签是重复的。这里再多放一个标签，看看有多少行被删除。</p><pre>import pandas as pddf = pd.DataFrame([[1, 2], [3, 4]], columns = ['a','b'])df2 = pd.DataFrame([[5, 6], [7, 8]], columns = ['a','b'])df = df.append(df2)# Drop rows with label 0df = df.drop(0)print dfPython</pre><p>执行上面示例代码，得到以下结果 -</p><pre> a b1 3 41 7 8Shell</pre><p>在上面的例子中，一共有两行被删除，因为这两行包含相同的标签0。</p><p>原文出自【易百教程】，商业转载请联系作者获得授权，非商业转载请保留原文链接：https://www.yiibai.com/pandas/python_pandas_dataframe.html</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Pandas','数据','DataFrame'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>