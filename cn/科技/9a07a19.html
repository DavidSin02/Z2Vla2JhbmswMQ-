<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>朴素贝叶斯与文本分类 | 极客快訊</title><meta property="og:title" content="朴素贝叶斯与文本分类 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/6ecbf65356fd4c028abd100252c2adbf"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9a07a19.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9a07a19.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9a07a19.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9a07a19.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9a07a19.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9a07a19.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9a07a19.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9a07a19.html><meta property="article:published_time" content="2020-10-29T21:07:51+08:00"><meta property="article:modified_time" content="2020-10-29T21:07:51+08:00"><meta name=Keywords content><meta name=description content="朴素贝叶斯与文本分类"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/9a07a19.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>朴素贝叶斯与文本分类</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><blockquote><p>朴素贝叶斯 (Naive Bayesian algorithm) 是一种基于概率统计的分类方法，主要用到了贝叶斯定理和特征条件独立性假设。朴素贝叶斯具有悠久的历史，其算法逻辑比较简单，有健壮的性能，通常可以用于文本分类、信用评估等方面。</p></blockquote><h1><strong>1、朴素贝叶斯</strong></h1><p><strong>1.1 贝叶斯公式</strong></p><p>给定一个样本，我们用 X 表示样本的特征，用 Y 表示样本的类别，我们首先可以计算出 X 和 Y 的联合概率 P(X,Y):</p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6ecbf65356fd4c028abd100252c2adbf><p class=pgc-img-caption>X 和 Y 的联合概率</p></div><p>从联合概率 P(X,Y) 可以推导出则贝叶斯公式：</p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/29e47529e94648eea16cb6fd291083d1><p class=pgc-img-caption>贝叶斯公式</p></div><p>其中 P(Y) 称为先验概率，P(Y|X) 称为后验概率。</p><p>对于二分类问题，若 P(Y = 0|X) > P(Y = 1|X)，则判断样本 X 的类标为 Y = 0。因为对于任意 X，P(X) 是固定的，则我们只需要比较 P(X|Y = 0)P(Y = 0) 与 P(X|Y = 1)P(Y = 1) 的大小即可以知道 X 属于哪一个类。</p><p>P(Y = 0) 与 P(Y = 1) 可以用下面的公式计算，其中 D 表示整个数据集，D0 表示属于第 0 类的所有数据，D1 表示属于第 1 类的所有数据：</p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8bc6d664ef314cfa81f05ed613a2f1f7><p class=pgc-img-caption>类标 Y 的先验概率</p></div><p>而 P(X|Y = 0) 和 P(X|Y = 1) 一般不容易进行计算，因此朴素贝叶斯采用了<strong>条件独立性假设</strong>，使 P(X|Y) 更容易计算，而且也具有比较好的鲁棒性。</p><p><strong>1.2 条件独立性假设</strong></p><p>假定特征 X 有 N 维，X = [X1, X2, ..., XN]，则贝叶斯公式可以表示为</p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/143c9b55ca7d4c17b757dfdf683b478e><p class=pgc-img-caption>贝叶斯公式</p></div><p>而 P(X|Y = 0) 和 P(X|Y = 1) 可以表示为:</p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8e5206d04df34b7fbdfffd68adbc6a73><p class=pgc-img-caption></p></div><p>朴素贝叶斯采用条件独立性假设计算上面的公式，条件独立性假设是指，样本 X 的特征之间出现与否是互相独立的。</p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/60ebb94012164a51ac8f4390b9b5b682><p class=pgc-img-caption>条件独立性假设</p></div><p>而 P(Xi = x|Y = y) 的概率对于不同的数据和任务有不同方式计算，常见的有：</p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f92038e54b9b4e6c8a548763ff225701><p class=pgc-img-caption></p></div><p>D(Xi=x,Y=y) 表示数据集中类标等于 y 且第 i 个属性值为 x 的所有数据，|D| 表示求数据集 D 里面数据个数。通过上面的方法，我们就可以计算出 P(Y) 和 P(X|Y)，然后用于对比 P(Y|X) 的大小，从而找出样本所属的类。</p><h1><strong>2、朴素贝叶斯优化技巧</strong></h1><p><strong>2.1 取对数相加代替概率相乘</strong></p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e0e2c6df1612409da531786d50f367c5><p class=pgc-img-caption></p></div><p>在条件独立性假设里，我们将 P(X|Y) 转换成了对于每一位特征的概率相乘。由于概率是小于 1 的数，多次相乘后的数可能会很小，另外乘法的运算时间相对也长一点，因此通常采用<strong>取对数</strong>，然后相加的方式。</p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dd3846bf7219437ab75c3a96614b29b9><p class=pgc-img-caption></p></div><p>计算对数的时间花销也是比较大的，因此通常会事先计算出大量概率值 P 对应的 log P 并保存下来，在后续计算时从保存的表中直接读取 log P 的值。</p><p><strong>2.2 转为特征权重相加</strong></p><p>我们要比较 P(Y = 0|X) 与 P(Y = 1|X)，等价于比较 log P(Y = 0|X) 和 log P(Y = 1|X)，如果 log P(Y = 0|X) - log P(Y = 1|X) > 0 则 X 属于 Y=0 的概率更大。</p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/8c6311b6063f4c41abfee604ee88dcf6><p class=pgc-img-caption></p></div><p>最终可以转换为：</p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0ff4bcffcda64af4ba4b1414bb35f547><p class=pgc-img-caption></p></div><p>我们可以将第 i 个特征所有选项 xi 的权重保存在 hash 表中，使用时查找，加快算法速度。</p><p><strong>2.3 平滑处理</strong></p><p>原始的 P(X|Y) 的计算方法为：</p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/da87f670507040fd8fb9d76cbec4425f><p class=pgc-img-caption></p></div><p>使用上面的公式计算概率 P(X|Y) 有可能出现概率为 0 的情况，此时后验概率 P(Y|X) 的值就变为 0 了。因此在实际使用时，通常要进行平滑处理。</p><p>假设第 i 个特征 Xi 有 k 种可能的取值，则可以使用下面的公式进行平滑处理。</p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fc11d24359544d278ca50ef49e33e181><p class=pgc-img-caption>平滑处理</p></div><h1><strong>3、文本分类</strong></h1><p>我们以垃圾邮件分类为例子，了解朴素贝叶斯在文本分类中的应用。</p><p><strong>3.1 垃圾邮件</strong></p><p>我们的样本是一封邮件，则样本的特征 X 为邮件的内容，类标 Y 表示邮件是否是垃圾邮件。</p><p>X = 内容，如"上次的股票赚了吧，加微信获取更多股票信息"</p><p>Y = 类别，如 "垃圾邮件"、"正常邮件"</p><p>那么给定一封邮件 <strong>"上次的股票赚了吧，加微信获取更多股票信息"</strong>，就可以根据贝叶斯公式计算出这封邮件属于垃圾邮件的概率。</p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/200e41c9290b42f3bdeedea45e3e8b7d><p class=pgc-img-caption></p></div><p><strong>3.2 分词以及去掉停用词</strong></p><p>直接在数据集上统计 <strong>P("上次的股票赚了吧，加微信获取更多股票信息"|"垃圾邮件")</strong> 是不实际的，因为每封邮件的内容都不一样，下次邮件内容换成 "上次的股票赚了吧，加QQ获取更多股票信息"，则得到的概率为 0。</p><p>因此通常需要进行分词处理以及去掉停用词，停用词指一些对于我们分类没有帮助的词，通常是一些非常中性的词，如 "了"、"我"。</p><p>分词："上次", "的", "股票", "赚了", "吧", "加", "微信", "获取", "更多", "股票", "信息"</p><p>去掉停用词："上次", "股票", "赚了", "微信", "获取", "更多"、"股票", "信息"</p><p>则最终 <strong>P("上次的股票赚了吧，加微信获取更多股票信息"|"垃圾邮件")</strong> 可以转换为</p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/340218684d7943928f07607dfe5c3e25><p class=pgc-img-caption></p></div><p>根据条件独立性假设，最终变为：</p><div class=pgc-img><img alt=朴素贝叶斯与文本分类 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b3fadd35269a45a1b482601a4996c202><p class=pgc-img-caption></p></div><p>经过上述的步骤，我们可以计算出 P(Y="垃圾邮件"|X) 和 P(Y="正常邮件"|X) 的概率，最终判断邮件 X 是不是垃圾邮件。</p><h1><strong>4、总结</strong></h1><p>朴素贝叶斯是一种比较简单的算法，具有不错的鲁棒性。</p><p>朴素贝叶斯主要使用了<strong>贝叶斯公式</strong>和<strong>条件独立性假设</strong>。</p><p>朴素贝叶斯文本分类器实际上是词袋模型，也就是把文本看成是一个包含很多单词的袋子，与文本单词顺序无关。因此句子 "我喜欢听张学友唱歌" 和 "张学友喜欢听我唱歌" 在朴素贝叶斯看来是没有区别的。</p><h1><strong>参考文献</strong></h1><p>李航《统计学习方法》</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'朴素','贝叶斯','分类'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>