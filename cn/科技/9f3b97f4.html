<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 | 极客快訊</title><meta property="og:title" content="哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/c81a4e74f993415ab0f26c360778d5eb"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9f3b97f4.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9f3b97f4.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9f3b97f4.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9f3b97f4.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9f3b97f4.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9f3b97f4.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9f3b97f4.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9f3b97f4.html><meta property="article:published_time" content="2020-11-14T21:02:42+08:00"><meta property="article:modified_time" content="2020-11-14T21:02:42+08:00"><meta name=Keywords content><meta name=description content="哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/9f3b97f4.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>聊一段小插曲，一大早开电脑帮学员解决一个公式的问题。没开电脑之前，觉得很简单，类似的我以前处理过，可是打开电脑以后却发生了奇怪的一幕，不管我怎么改公式，结果一直不对。</p><p style=text-align:start><br></p><p style=text-align:start>对C列进行筛选，对筛选的结果，引用最大的日收入和对应人员。</p><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c81a4e74f993415ab0f26c360778d5eb><p class=pgc-img-caption></p></div><p style=text-align:start><br></p><p style=text-align:start>在没开电脑之前，我就一直在脑海里想，如果现在是针对普通的情况下，查找最大值和对应人员。这种可以借助LOOKUP+MAX获取。</p><blockquote><p>=LOOKUP(1,0/(MAX($A$4:$A$99)=$A$4:$A$99),A$4:A$99)</p></blockquote><p style=text-align:start><br></p><p style=text-align:start>针对筛选的情况下，用辅助列SUBTOTAL判断是否筛选。这个去年还写过文章，轻车熟路。</p><p style=text-align:start>难倒90%的人，根据筛选内容查找对应值，居然如此简单！</p><p style=text-align:start><br></p><p style=text-align:start>打开电脑以后，按照想法操作。先建立一个辅助列，判断内容是否有筛选，可见单元格的都是1。</p><blockquote><p>=SUBTOTAL(3,C4)</p></blockquote><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0e01e10c11bd4c369f78f5aa22cea597><p class=pgc-img-caption></p></div><p style=text-align:start><br></p><p style=text-align:start>根据筛选判断，还有日收入最大值两个条件进行LOOKUP。</p><blockquote><p>=LOOKUP(1,0/((MAX($A$4:$A$99)=$A$4:$A$99)*($D$4:$D$99=1)),A$4:A$99)</p></blockquote><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/29007543065d4f8b9551c98dedb0ecba><p class=pgc-img-caption></p></div><p style=text-align:start><br></p><p style=text-align:start>筛选完，发现结果没变，依然是400，怎么回事呢？</p><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/341a2496ca3b4eda84a25f11f4cbaa62><p class=pgc-img-caption></p></div><p style=text-align:start><br></p><p style=text-align:start>想起来了，应该是没有先判断是否为1，再返回最大值，要嵌套IF进行判断。输入公式后，按Ctrl+Shift+Enter结束，发现结果没变，依然是400。</p><blockquote><p>=LOOKUP(1,0/(MAX(IF($D$4:$D$99=1,$A$4:$A$99,0))=IF($D$4:$D$99=1,$A$4:$A$99,0)),A$4:A$99)</p></blockquote><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3d2cc04cc54642469a45b4c81b3f9bb0><p class=pgc-img-caption></p></div><p style=text-align:start><br></p><p style=text-align:start>奇怪了，按理说这样应该没问题啊。</p><p style=text-align:start><br></p><p style=text-align:start>我又将SUBTOTAL第一参数的3改成103，发现白折腾，依然没变化，还是400。</p><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/7d899537450f491e86479031345a0d24><p class=pgc-img-caption></p></div><p style=text-align:start><br></p><p style=text-align:start>究竟问题出在哪，正当我开始怀疑人生的时候。。。</p><p style=text-align:start><br></p><p style=text-align:start>打开了计算选项，发现居然是手动。没想到问题出在这里，正常手动是针对数据和公式非常多的情况下设置，没想到这个表格这么一丁点数据也这样设置。</p><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1624adcd2b1e47669ed328ad23bf8c50><p class=pgc-img-caption></p></div><blockquote><p>财务工作中，你是否遇到焦头烂额不知如何解决的问题呢？</p></blockquote><div class=tt-applet-card data-content='{"app_group_id":"6738266834958549005","schema":"sslocal://microapp?app_id=tt80b1f60c1f9b7d40&meta=%7B%22name%22%3A%22%E4%BC%9A%E8%AE%A1%E9%97%AE%22%2C%22icon%22%3A%22https%3A%2F%2Fsf3-ttcdn-tos.pstatp.com%2Fimg%2Fdeveloper%2Fapp%2Ftt80b1f60c1f9b7d40%2Ficon69f1936~144x144.jpeg%22%2C%22orientation%22%3A0%7D","orientation":0,"min_jssdk":"","app_id":"tt80b1f60c1f9b7d40","summary":"会计问题，专家免费解答。","state":1,"icon":"https://sf3-ttcdn-tos.pstatp.com/img/developer/app/tt80b1f60c1f9b7d40/icon69f1936~144x144.jpeg","type":1,"name":"会计问","cover_img":"","inserttype":"single","summarycount":"","errortip":"","showerrortip":"","schematip":"","showschematip":""}'>（此处已添加小程序，请到今日头条客户端查看）</div><p style=text-align:start>于是，赶紧改成自动。</p><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1d078a19ae184195a1dfeedbe558471b><p class=pgc-img-caption></p></div><p style=text-align:start><br></p><p style=text-align:start>还是原来的公式，公式右拉，最大日收入和对应人员都没问题。</p><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8243b12c1447470fa640b0ac13bfebce><p class=pgc-img-caption></p></div><p style=text-align:start><br></p><p style=text-align:start>哈哈哈，没想到问题出在这里，很意外。</p><p style=text-align:start><br></p><p style=text-align:start>在解决完问题后，我又想到一个问题，最大日收入可能同时对应着多个人员，如果遇到这种情况又该如何解决？</p><p style=text-align:start><br></p><p style=text-align:start>LOOKUP是查找最后满足条件的值，可以借助2019版的TEXTJOIN解决。同样是数组公式，按Ctrl+Shift+Enter结束。</p><blockquote><p>=TEXTJOIN(",",1,IF(MAX(IF($D$4:$D$99=1,$A$4:$A$99,0))=IF($D$4:$D$99=1,$A$4:$A$99,0),B$4:B$99,""))</p></blockquote><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ba1c2a63cb61451c88b77e9b952cc176><p class=pgc-img-caption></p></div><p style=text-align:start><br></p><p style=text-align:start>低版本没有这个函数，不过没关系，我这里提供一个自定义函数，作用一样。</p><p style=text-align:start>遭了，你的Excel找不到这个TEXTJOIN函数！</p><p style=text-align:start><br></p><p style=text-align:start>后来的后来，我发现有2个可以改进的地方。</p><p style=text-align:start><br></p><p style=text-align:start>01 在筛选的时候，用SUBTOTAL可能会筛选出错。</p><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3e75effde77c404e9ce689ddde072d54><p class=pgc-img-caption></p></div><p style=text-align:start><br></p><p style=text-align:start>针对这种情况，对SUBTOTAL的公式略作改动，在后面*1，作用就是防止最后一行当成汇总行导致出错。</p><blockquote><p>=SUBTOTAL(103,C4)*1</p></blockquote><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7f94ae19534945fd9007557ae3d49712><p class=pgc-img-caption></p></div><p style=text-align:start><br></p><p style=text-align:start>02 获取最大日收入，其实用MAX+IF数组就可以，无需嵌套LOOKUP。</p><blockquote><p>=MAX(IF($D$4:$D$99=1,$A$4:$A$99,0))</p></blockquote><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/36cdd10688e443aaa364256f7ff94b86><p class=pgc-img-caption></p></div><p style=text-align:start><br></p><p style=text-align:start>在已经获得最大日收入的情况下，对应人员公式可以进一步简化。</p><blockquote><p>=TEXTJOIN(",",1,IF(($D$4:$D$99=1)*($A$4:$A$99=D2),B$4:B$99,""))</p></blockquote><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/624e71a203cc4fc49030f9f5ec3833fd><p class=pgc-img-caption></p></div><p style=text-align:start><br></p><p style=text-align:start>好，这就是一个问题的全部思考过程。即便是我，有的时候也会犯傻，不过犯傻后要能知道自己错在哪，哪些问题没考虑到。</p><p style=text-align:start><br></p><p style=text-align:start>作者：卢子</p><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/bc992aa3826f4ccf895198577b8c3b84><p class=pgc-img-caption></p></div><p style=text-align:start>这里相信有许多想要学习会计的同学，大家可以关注小编头条号，</p><p style=text-align:start>下方评论区留言：<strong>想要学习，</strong>并收藏本文；私信小编<strong>：学习</strong></p><p style=text-align:start>即可领取一整套系统的<strong>会计学习资料</strong>！还可以免费试学会计课程15天！</p><p style=text-align:start>因领取人数太多，不能及时回复，请大家耐心等待。。。。</p><div class=pgc-img><img alt=哈哈哈，没想到我也有写Excel公式写到怀疑人生的时候 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5c4fd90a6b4a45d9b1273b387e6a91b2><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Excel','写到','怀疑'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>