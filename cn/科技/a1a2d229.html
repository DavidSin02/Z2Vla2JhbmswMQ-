<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>excel提取技巧：单元格部分内容提取的三种方法 | 极客快訊</title><meta property="og:title" content="excel提取技巧：单元格部分内容提取的三种方法 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/15395830590494739893a0b"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1a2d229.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1a2d229.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a1a2d229.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1a2d229.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1a2d229.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a1a2d229.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a1a2d229.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1a2d229.html><meta property="article:published_time" content="2020-10-29T21:08:52+08:00"><meta property="article:modified_time" content="2020-10-29T21:08:52+08:00"><meta name=Keywords content><meta name=description content="excel提取技巧：单元格部分内容提取的三种方法"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/a1a2d229.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>excel提取技巧：单元格部分内容提取的三种方法</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><div class=pgc-img><img alt=excel提取技巧：单元格部分内容提取的三种方法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15395830590494739893a0b><p class=pgc-img-caption></p></div><p>问题来自于一位群友的求助，大家请看图：</p><div class=pgc-img><img alt=excel提取技巧：单元格部分内容提取的三种方法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/153958305905416c21b550a><p class=pgc-img-caption></p></div><p>数据源在A列，包含了很多项信息，现在需要从中提取出容值、封装和耐压三项数据，不难发现，需要提取的数据具有一定的规律性，分别是数据源的第二、三、四个逗号之后的数据。</p><p>当我们遇到问题的时候，找到规律是解决问题的关键。现在规律找到了，因此解决方法也就有了。这里有三种方法，从最简单的快捷键操作到经典的吃遍天下的公式都有，以下分别进行介绍。</p><p><strong>1.快速填充法（Ctrl+ E）</strong></p><div class=pgc-img><img alt=excel提取技巧：单元格部分内容提取的三种方法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1539583059301c61562e57c><p class=pgc-img-caption></p></div><p>评价：★★★★★</p><p>优势：简单、易用。</p><p>劣势：还没有发现。</p><p><strong>操作要点：</strong></p><p>（1）在B2单元格输入0402时，要先输入一个单引号，或者把单元格修改为文本格式再输入；</p><p>（2）只输入一个数据可能无法通过Ctrl+E得到正确结果，这时候连续输入两个数据就可以了。</p><p><strong>提示：</strong>组合键Ctrl+ E只能在Excel2013及以上的版本才能使用。</p><p>就本例而言，Ctrl+ E略微显得有些麻烦，因此再介绍一种用分列的处理方法。</p><p><strong>2.分列法</strong></p><div class=pgc-img><img alt=excel提取技巧：单元格部分内容提取的三种方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539583059014c5bb0351e1><p class=pgc-img-caption></p></div><p>评价：★★★★☆</p><p>优势：简单、易用。</p><p>劣势：数据量大了后工作量还是比较重。</p><p><strong>操作要点：</strong></p><p>（1）分列过程中使用逗号进行分隔；</p><p>（2）需要跳过不导入的列；</p><p>（3）对容值这列数据设置为文本格式；</p><p>（4）手工指定数据存放的目标区域。</p><p>相比第一个方法来说，使用分列就简单了许多，同时通过这个例子，大家也可以对分列这个强大的功能有了深入的了解。</p><p>使用分列虽然比较方便，但如果经常要处理这类数据的话，操作量也是蛮大的，最后我们再来分享一个公式的做法。</p><p><strong>3. TRIM-MID-SUBSTITUTE-REPT组合公式法</strong></p><p>使用公式：=TRIM(MID(SUBSTITUTE($A2,",",REPT(" ",99)),COLUMN(B1)*99,99))</p><p>右拉下拉即可得到所需的结果。</p><div class=pgc-img><img alt=excel提取技巧：单元格部分内容提取的三种方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/153958305909551b191c589><p class=pgc-img-caption></p></div><p>评价：★★★★☆</p><p>优势：快速，对付大量数据尤其实用，并且可以修改参数用于更复杂的字符提取。</p><p>劣势：公式不好记。</p><p><strong>公式解析：</strong></p><p>这个公式里用到了五个函数，其中有我们比较熟悉的MID和COLUMN，也有我们不太常用的TRIM、SUBSTITUTE和REPT函数。下面简单来解释一下这个公式的思路。</p><p>公式的核心部分是SUBSTITUTE($A2,",",REPT(" ",99))，这部分的作用是进行替换。</p><p>SUBSTITUTE函数格式为：</p><p>SUBSTITUTE（在哪里替换，替换什么，换成什么，换第几个）</p><p>例如：</p><p>公式=SUBSTITUTE($A2,",","-",3)的效果就是把A2单元格的第3个逗号换成-号。</p><div class=pgc-img><img alt=excel提取技巧：单元格部分内容提取的三种方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539583059051ed102b37d2><p class=pgc-img-caption></p></div><p>当省略第四参数的时候，代表逗号全部替换，如图：</p><div class=pgc-img><img alt=excel提取技巧：单元格部分内容提取的三种方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15395830592502a7d9498b1><p class=pgc-img-caption></p></div><p>本例中是把A2中的逗号换成了REPT(" ",99)，也就是99个空格。</p><p>REPT函数的格式为：</p><p>REPT（要重复的字符，重复次数）</p><p>例如：</p><p>REPT(“★”,5)，就是将★重复五次。</p><div class=pgc-img><img alt=excel提取技巧：单元格部分内容提取的三种方法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153958305925728904f1ba7><p class=pgc-img-caption></p></div><p>至于公式中为什么要用99个空格，完全是一种套路，继续看完公式的其他部分或许就理解了。</p><p>使用SUBSTITUTE得到的数据还需要用MID函数来进行提取。MID函数大家应该比较熟悉了，基本格式为：MID（要提取的数据，从什么位置开始取，取几个字）。在本例中要提取的数据就是SUBSTITUTE（），而要提取的容值的位置原本是在第2个逗号之后，由于我们把逗号换成了99个空格，要提取的位置前面至少有两组空格也就是2*99个字符；相应封装的提取的位置是3*99，耐压的是4*99。采用公式右拉，所以这里用COLUMN(B1)*99作为提取位置。MID的最后一个参数是要取几个字符，为了保险起见，统一提取99个字。</p><p>也就是说，经过MID（SUBSTITUTE（），COLUMN(B1)*99，99）这部分公式运算后，得到的结果是我们实际需要的容值数据包含在前后空格中。为了便于大家理解，临时将空格换成-，可以直观地看出效果：</p><div class=pgc-img><img alt=excel提取技巧：单元格部分内容提取的三种方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15395830593303ba8647f72><p class=pgc-img-caption></p></div><p>我们肯定不希望得到的结果中包含有大量无用的空格，因此在最外层套一个TRIM就可以去掉这些空格。TRIM函数只有一个参数，功能就是去掉字符串中多余的空格。</p><p>本例使用的实际上也是非常经典的一个公式组合：TRIM-MID-SUBSTITUTE-REPT组合。公式理解起来需要一定的基础，新手暂时无法理解的时候，可以先掌握公式的套路，根据自己的需要修改参数。</p><p><strong>闲言妄语：</strong></p><p>估计很多小白看不懂这个公式的套路哦~~小编心痒痒，就来现个丑，打个比方——冲水捞死鱼。</p><p>一堆死鱼，密密麻麻，一个靠一个。现在给你一个篓子（MID函数）要你从死鱼中把其中的红鱼捞出来。要求是不要碰到其它鱼。啷个办？把鱼分开（SUBSTITUTE函数替换逗号增大间距）呀！咋个分开？冲水（加空格）呀，使劲冲水（用99个空格，劲够大了），鱼分开了，然后一篓子就把红色死鱼捞起来了，虽然捞鱼的时候水（空格）肯定也会带上，但水马上就从网孔（TRIM函数）中漏掉（被排除了）了，只剩需要的红鱼。</p><p>为啥用水（空格）而不是其他东西（譬如逗号）来增加间距呀？网孔（TRIM函数）只适合滤水（逗号就滤不走）呀。为啥要冲那么多水（99个空格）？因为分得越开，越可以忽略其他鱼的影响（字符数不等的影响），篓子（MID函数）的口径（取字符的字符数）就可以越大（99），只需要给一个下篓子的大概位置（并非红鱼的准确位置，由COLUMN(B1)*99实现），就肯定只捞到水和红鱼。</p><p><strong>＊＊＊＊部落窝教育－excel互转技巧＊＊＊＊</strong></p><p>原创：老菜鸟/部落窝教育（未经同意，请勿转载）</p><p>更多教程：部落窝教育（www.itblw.com）</p><p>微信公众号：exceljiaocheng</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'提取','excel','单元格'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>