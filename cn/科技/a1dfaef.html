<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>ä½¿ç”¨åå‘ä¼ æ’­(back propagation,BP)ç®—æ³•å®ç°æ•°å­—è¯†åˆ« | æå®¢å¿«è¨Š</title><meta property="og:title" content="ä½¿ç”¨åå‘ä¼ æ’­(back propagation,BP)ç®—æ³•å®ç°æ•°å­—è¯†åˆ« - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/1529923087520190f207783"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1dfaef.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1dfaef.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a1dfaef.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1dfaef.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1dfaef.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a1dfaef.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a1dfaef.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1dfaef.html><meta property="article:published_time" content="2020-10-29T21:05:34+08:00"><meta property="article:modified_time" content="2020-10-29T21:05:34+08:00"><meta name=Keywords content><meta name=description content="ä½¿ç”¨åå‘ä¼ æ’­(back propagation,BP)ç®—æ³•å®ç°æ•°å­—è¯†åˆ«"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/a1dfaef.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>ä½¿ç”¨åå‘ä¼ æ’­(back propagation,BP)ç®—æ³•å®ç°æ•°å­—è¯†åˆ«</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><div class=pgc-img><img alt="ä½¿ç”¨åå‘ä¼ æ’­(back propagation,BP)ç®—æ³•å®ç°æ•°å­—è¯†åˆ«" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1529923087520190f207783><p class=pgc-img-caption></p></div><p>åå‘ä¼ æ’­æ˜¯ç¥ç»ç½‘ç»œçš„é‡è¦ç®—æ³•ï¼Œä¹Ÿå«åšè¯¯å·®é€†å‘ä¼ æ’­æ³•ã€‚å®ƒæ¯”è¾ƒè¾“å‡ºç»“æœå’Œå­¦ä¹ æ ·æœ¬ä¸­çš„æ ‡ç­¾ï¼Œç„¶åæŠŠè¯¯å·®åå‘ä¼ æ’­åˆ°è¾“å…¥å±‚ï¼Œå¹¶åœ¨ä¼ æ’­è¿‡ç¨‹ä¸­ä¸æ–­ä¿®æ­£æƒé‡å’Œé˜ˆå€¼ã€‚è¿™æ ·çš„åå‘ä¼ æ’­è¿›è¡Œå¤šæ¬¡ï¼Œé€æ¸æé«˜æ¨¡å‹çš„ç²¾åº¦ã€‚å…³äºåå‘ä¼ æ’­æœ‰å¾ˆå¤šå‚è€ƒèµ„æ–™ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚</p><p>åå‘ä¼ æ’­æ³•çš„ç¼ºç‚¹åŒ…æ‹¬ï¼š</p><ol><li>å¦‚æœä¸ºäº†æé«˜å­¦ä¹ é€Ÿåº¦è€Œå¢å¤§åé¦ˆåŠ›åº¦ï¼Œå¯èƒ½ä¼šå¼•èµ·æ¨¡å‹éœ‡è¡ï¼Œæ— æ³•æ”¶æ•›ã€‚æœ‰æ—¶ä¼šé™·å…¥å±€éƒ¨æœ€ä¼˜ï¼Œæ— æ³•ç»§ç»­å­¦ä¹ ã€‚</li></ol><p>é’ˆå¯¹ç¼ºç‚¹1ï¼Œå¯ä»¥è°ƒæ•´å‚æ•°alphaå’Œbetaä¸æ–­è¿›è¡Œè°ƒæ•´ã€‚é’ˆå¯¹ç¼ºç‚¹2ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è¿›è¡ŒäºŒæ¬¡å­¦ä¹ æ¥è„±ç¦»å±€éƒ¨æœ€ä¼˜ã€‚æˆ‘ä»¬ä¼šåœ¨åç»­æ–‡ç« ä¸­å±•å¼€è®¨è®ºã€‚</p><p>Alphaæ˜¯æ§åˆ¶åå‘ä¼ æ’­è¿‡ç¨‹ä¸­è°ƒæ•´æƒé‡å’Œé˜ˆå€¼çš„ä¿®æ­£ç³»æ•°ï¼ˆ>0ï¼‰ã€‚å¢å¤§è¯¥ç³»æ•°å¯ä»¥å¼ºåŒ–åé¦ˆåŠ›åº¦ï¼Œç¼©çŸ­å­¦ä¹ æ—¶é—´ã€‚Betaæ˜¯æ­£å‘è®¡ç®—ä¸­sigmoidå‡½æ•°çš„è¾“å…¥å˜é‡çš„è°ƒæ•´ç³»æ•°ï¼ˆ>0ï¼‰ã€‚å¢å¤§è¯¥ç³»æ•°å¯ä»¥å¢åŠ ç¥ç»å…ƒçš„æ”¾å¤§ç‡ï¼Œä½¿å…¶è¾“å‡ºå¿«é€Ÿåˆ°è¾¾0æˆ–è€…1ï¼Œæå‡å­¦ä¹ æ•ˆæœã€‚</p><p><strong>ç¨‹åºæ¦‚è¦</strong></p><p>ç¨‹åºä¸»è¦éƒ¨åˆ†å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚é‡å¤å­¦ä¹ æŸä¸ªæ•°å­—çš„éƒ¨åˆ†å«åšå†…éƒ¨å¾ªç¯ï¼ŒæŠŠæ‰€æœ‰æ•°å­—éƒ½ä¸€éå°±æ˜¯ä¸€æ¬¡å¤–éƒ¨å¾ªç¯ã€‚</p><p>å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ä¸åŒçš„æ•°å­—ï¼ˆsample_inï¼‰è¿›è¡Œæ­£å‘è®¡ç®—ï¼Œå­¦ä¹ ç»“æœå­˜å…¥recog_outã€‚å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œå¾—åˆ°å®é™…è¾“å‡ºä¸æ ‡ç­¾teachçš„è¯¯å·®ï¼Œç„¶åä½¿ç”¨è¯¥è¯¯å·®è¿›è¡Œåå‘ä¼ æ’­ï¼Œå¹¶ä¸æ–­ä¿®æ­£ç¥ç»ç½‘ç»œçš„æƒé‡å’Œé˜ˆå€¼ã€‚</p><div class=pgc-img><img alt="ä½¿ç”¨åå‘ä¼ æ’­(back propagation,BP)ç®—æ³•å®ç°æ•°å­—è¯†åˆ«" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/15299223531474f940c8c84><p class=pgc-img-caption></p></div><p>è¯†åˆ«æ¨¡å¼æ—¶ï¼Œä½¿ç”¨æ‰‹å†™æ•°å­—ï¼ˆwritten_inï¼‰è¿›è¡Œæ­£å‘è®¡ç®—ï¼Œç„¶åæ˜¾ç¤ºè®¡ç®—ç»“æœrecog_outã€‚</p><div class=pgc-img><img alt="ä½¿ç”¨åå‘ä¼ æ’­(back propagation,BP)ç®—æ³•å®ç°æ•°å­—è¯†åˆ«" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1529922377628ad9fb8b0bc><p class=pgc-img-caption></p></div><p>ä¸»è¦ä»£ç ç‰‡æ®µå¦‚ä¸‹ã€‚å®Œæ•´ä»£ç è¯·å‘é‚®ä»¶åˆ°wulonchia@sohu.comç´¢å–ã€‚</p><pre>// å­¦ä¹ private void doStudy(boolean ifShowResult){ //ä½¿ç”¨éšæœºæ•°è®¾ç½®é˜€å€¼å’Œæƒé‡ for(int j1 = 0; j1 &lt; HIDDEN; j1++){ thresh_h[j1] = (float)Math.random() - 0.5F; for(int j = 0; j &lt; INPUT; j++){ weight_ih[j][j1] = (float)Math.random() - 0.5F; } } // for(int i2 = 0; i2 &lt; OUTPUT; i2++){ thresh_o[i2] = (float)Math.random() - 0.5F; for(int k1 = 0; k1 &lt; HIDDEN; k1++){ weight_ho[k1][i2] = (float)Math.random() - 0.5F; } } //----------------------- study -----------------------  for(int i3 = 0; i3 &lt; OUTER_CYCLES; i3++){ float f = 0.0F;//æ¸…é™¤å¤–éƒ¨å¹³æ–¹å·® for(int k3 = 0; k3 &lt; PATTERN; k3++){ //åˆ‡æ¢æ¨¡å¼ //è®¾ç½®ä¸æ¨¡å¼å¯¹åº”çš„è¾“å…¥å’Œæ•™å¸ˆä¿¡å· sample_in = sample_array[k3]; teach = teach_array[k3]; for(int i4 = 0; i4 &lt; INNER_CYCLES; i4++){ //å†…éƒ¨å¾ªç¯ forwardNeuralNet(sample_in, recog_out); BackwardNeuralNet(); } //è®¡ç®—å†…éƒ¨å¹³æ–¹å·® float f1 = 0.0F; for(int j2 = 0; j2 &lt; OUTPUT; j2++) f1 += (teach[j2] - recog_out[j2]) * (teach[j2] - recog_out[j2]); f += f1; //ç´¯åŠ åˆ°å¤–éƒ¨å¹³æ–¹å·®ä¸Š } //æ˜¾ç¤ºå¤–éƒ¨å¾ªç¯æ¬¡æ•°å’Œå¤–éƒ¨å¹³æ–¹å·® System.out.println("OUTER_CYCLES("+i3+") and ERROR("+f+")"); } /////  HashMap StudyResult = new HashMap(); StudyResult.put("thresh_h", thresh_h); StudyResult.put("thresh_o", thresh_o); StudyResult.put("weight_ih", weight_ih); StudyResult.put("weight_ho", weight_ho); SaveStudyResult("StudyResult.dat",StudyResult); //------------------ ç¡®è®¤å­¦ä¹ ç»“æœ ------------------ System.out.println("#################### study result: ####################"); // int errsum = 0; double Max_Error = 0.0d; String Max_Error_String = ""; if(ifShowResult){ for (int i = 0; i &lt; PATTERN; i++) { StringBuffer sb = new StringBuffer(); for (int j = 0; j &lt; INPUT; j++) { //System.out.print(sample_array[i][j]); //if((j+1)%11==0)System.out.println(""); float r = sample_array[i][j]; if(r &lt; 60.0f/255.0f){ sb.append("#"); }else if(r&lt;120.f/255.0f){ sb.append("+"); }else if(r&lt;180.f/255.0f){ sb.append("-"); }else{ sb.append(" "); } if((j+1)%IMG_WIDTH==0)sb.append("\r\n"); } System.out.println(sb.toString()); System.out.println("supposed to be :"); for (int j = 0; j &lt; OUTPUT; j++) { System.out.print(teach_array[i][j]); System.out.print(" | "); } System.out.println(""); /////////// sample_in = sample_array[i]; forwardNeuralNet(sample_in, recog_out); System.out.println("recognized as :"); for (int i2 = 0; i2 &lt; OUTPUT; i2++) { float rt = recog_out[i2]; if(rt&lt;0.01){ System.out.print("0.0"); }else if(rt&gt;0.9){ System.out.print("1.0"); }else{ System.out.print("err"); } System.out.print(" | "); } System.out.println(""); } } System.out.println("Found "+errsum+" error(s) in "+PATTERN+" patterns !\r\nError ratio is "+100*errsum/PATTERN+"% !"); System.out.println("Max Error is "+Max_Error+" in "+Max_Error_String+" !");}//æ­£å‘è®¡ç®—private void forwardNeuralNet(float[] input, float[] output){ float[] out=new float[OUTPUT]; float[] hidden=new float[HIDDEN]; //è®¡ç®—éšè—å±‚çš„è¾“å‡º for(int j=0;j&lt;HIDDEN;j++){ hidden[j]=-thresh_h[j]; for(int i=0;i&lt;INPUT;i++){ hidden[j]+=input[i]*weight_ih[i][j]; } hidden_out[j]=sigmoid(hidden[j]); } //è®¡ç®—è¾“å‡ºå±‚çš„è¾“å‡º for(int k=0;k&lt;OUTPUT;k++){ out[k]=-thresh_o[k]; for(int j=0;j&lt;HIDDEN;j++){ out[k]+=hidden_out[j]*weight_ho[j][k]; } output[k]=sigmoid(out[k]); }}//åå‘ä¼ æ’­private void BackwardNeuralNet(){ int i,j,k; float[] output_error=new float[OUTPUT]; //è¾“å‡ºå±‚çš„è¯¯å·® float[] hidden_error=new float[HIDDEN]; //éšè—å±‚çš„è¯¯å·® float temp_error; //è®¡ç®—è¾“å‡ºå±‚çš„è¯¯å·® for(k=0;k&lt;OUTPUT;k++){ output_error[k]=(teach[k]-recog_out[k])*recog_out[k]*(1.0f-recog_out[k]); //s'(a(p,n)) = y(1-y)) = recog_out[k]*(1.0f-recog_out[k]) /** s'(a(p,n))*(t(p,n)-y(p,n)) */ } //è®¡ç®—éšè—å±‚çš„è¯¯å·® for(j=0;j&lt;HIDDEN;j++){ temp_error=0.0f; for(k=0;k&lt;OUTPUT;k++){ temp_error+=output_error[k]*weight_ho[j][k]; // s'(a(p,n))*(t(p,n)-y(p,n))*wi(h&gt;o) } hidden_error[j]=hidden_out[j]*(1.0f-hidden_out[j])*temp_error; //s'(a(p,n)) * sum(d(j) * W(n,j)) } //ä¿®æ­£æƒé‡ for(k=0;k&lt;OUTPUT;k++){ for(j=0;j&lt;HIDDEN;j++){ weight_ho[j][k]+=ALPHA*output_error[k]*hidden_out[j];//delta weight = alpha * s'(a(p,n)) * (t(p,n) - y(p,n)) * X(p,i,n) } } for(j=0;j&lt;HIDDEN;j++){ for(i=0;i&lt;INPUT;i++){ weight_ih[i][j]+=ALPHA*hidden_error[j]*sample_in[i]; //alpha * s'(a(p,n)) * sum(d(j) * W(n,j)) * X(p,i,n) } } //ä¿®æ­£é˜€å€¼ for(k=0;k&lt;OUTPUT;k++){ thresh_o[k]-=ALPHA*output_error[k]; } for(j=0;j&lt;HIDDEN;j++){ thresh_h[j]-=ALPHA*hidden_error[j]; }} </pre></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'ä¼ æ’­','back','propagation'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>