<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>SpringBootåˆ‡é¢Aopçš„demoç®€å•è®²è§£ | æå®¢å¿«è¨Š</title><meta property="og:title" content="SpringBootåˆ‡é¢Aopçš„demoç®€å•è®²è§£ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/ec7dea99ced1417b940a9ffe67dc81aa"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a21b0013.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a21b0013.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a21b0013.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a21b0013.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a21b0013.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a21b0013.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a21b0013.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a21b0013.html><meta property="article:published_time" content="2020-11-14T21:04:30+08:00"><meta property="article:modified_time" content="2020-11-14T21:04:30+08:00"><meta name=Keywords content><meta name=description content="SpringBootåˆ‡é¢Aopçš„demoç®€å•è®²è§£"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/a21b0013.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>SpringBootåˆ‡é¢Aopçš„demoç®€å•è®²è§£</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p>å‰è¨€</p><p>æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»çš„æ˜¯SpringBootåˆ‡é¢Aopçš„demoç®€å•è®²è§£ã€‚</p><h2 class=pgc-h-arrow-right>SpringBoot Aop</h2><p><strong>è¯´æ˜ï¼šå¦‚æœæƒ³ç›´æ¥è·å–å·¥ç¨‹é‚£ä¹ˆå¯ä»¥ç›´æ¥è·³åˆ°åº•éƒ¨ï¼Œé€šè¿‡é“¾æ¥ä¸‹è½½å·¥ç¨‹ä»£ç ã€‚</strong></p><h3 class=pgc-h-arrow-right>åˆ‡é¢(Aop)</h3><p><strong>ä¸€ã€æ¦‚å¿µ</strong></p><blockquote><p>AOPï¼ˆAspect OrientedProgrammingï¼‰ï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆä¹Ÿå«é¢å‘æ–¹é¢ç¼–ç¨‹ï¼‰ï¼Œæ˜¯ç›®å‰è½¯ä»¶å¼€å‘ä¸­çš„ä¸€ä¸ªçƒ­ç‚¹ï¼Œä¹Ÿæ˜¯Springæ¡†æ¶ä¸­çš„ä¸€ä¸ªé‡è¦å†…å®¹ã€‚åˆ©ç”¨AOPå¯ä»¥å¯¹ä¸šåŠ¡é€»è¾‘çš„å„ä¸ªéƒ¨åˆ†è¿›è¡Œéš”ç¦»ï¼Œä»è€Œä½¿å¾—ä¸šåŠ¡é€»è¾‘å„éƒ¨åˆ†ä¹‹é—´çš„è€¦åˆåº¦é™ä½ï¼Œæé«˜ç¨‹åºçš„å¯é‡ç”¨æ€§ï¼ŒåŒæ—¶æé«˜äº†å¼€å‘çš„æ•ˆç‡ã€‚</p></blockquote><p><strong>äºŒã€ç”¨é€”</strong></p><blockquote><p>æ—¥å¿—è®°å½•ï¼Œæ€§èƒ½ç»Ÿè®¡ï¼Œå®‰å…¨æ§åˆ¶ï¼Œæƒé™ç®¡ç†ï¼Œäº‹åŠ¡å¤„ç†ï¼Œå¼‚å¸¸å¤„ç†ï¼Œèµ„æºæ± ç®¡ç†ã€‚</p></blockquote><p><strong>ä¸‰ã€è¯¦è§£</strong></p><p>1.åˆ‡é¢ï¼ˆAspectï¼‰:å®˜æ–¹çš„æŠ½è±¡å®šä¹‰ä¸ºâ€œä¸€ä¸ªå…³æ³¨ç‚¹çš„æ¨¡å—åŒ–ï¼Œè¿™ä¸ªå…³æ³¨ç‚¹å¯èƒ½ä¼šæ¨ªåˆ‡å¤šä¸ªå¯¹è±¡â€ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œâ€œåˆ‡é¢â€å°±æ˜¯ç±»TestAspectæ‰€å…³æ³¨çš„å…·ä½“è¡Œä¸ºï¼Œä¾‹å¦‚ï¼šAServiceImpl.barA()çš„è°ƒç”¨å°±æ˜¯åˆ‡é¢TestAspectæ‰€å…³æ³¨çš„è¡Œä¸ºä¹‹ä¸€ã€‚â€œåˆ‡é¢â€åœ¨ApplicationContextä¸­aop:aspectæ¥é…ç½®ã€‚</p><p>2.è¿æ¥ç‚¹ï¼ˆJoinpointï¼‰:ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„æŸä¸€è¡Œä¸ºï¼Œä¾‹å¦‚ï¼ŒAServiceImpl.barA()çš„è°ƒç”¨æˆ–è€…BServiceImpl.barB(String _msg, int _type)æŠ›å‡ºå¼‚å¸¸ç­‰è¡Œä¸ºã€‚</p><p>3.é€šçŸ¥ï¼ˆAdviceï¼‰:â€œåˆ‡é¢â€å¯¹äºæŸä¸ªâ€œè¿æ¥ç‚¹â€æ‰€äº§ç”Ÿçš„åŠ¨ä½œï¼Œä¾‹å¦‚ï¼ŒTestAspectä¸­å¯¹com.spring.serviceåŒ…ä¸‹æ‰€æœ‰ç±»çš„æ–¹æ³•è¿›è¡Œæ—¥å¿—è®°å½•çš„åŠ¨ä½œå°±æ˜¯ä¸€ä¸ªAdviceã€‚å…¶ä¸­ï¼Œä¸€ä¸ªâ€œåˆ‡é¢â€å¯ä»¥åŒ…å«å¤šä¸ªâ€œAdviceâ€ï¼Œä¾‹å¦‚TestAspectã€‚Adviceå…±æœ‰å¦‚ä¸‹5ç§ç±»å‹ï¼š</p><ul><li>A å‰ç½®é€šçŸ¥ï¼ˆBefore adviceï¼‰ ï¼šåœ¨æŸè¿æ¥ç‚¹ï¼ˆJoinPointï¼‰ä¹‹å‰æ‰§è¡Œçš„é€šçŸ¥ï¼Œä½†è¿™ä¸ªé€šçŸ¥ä¸èƒ½é˜»æ­¢è¿æ¥ç‚¹å‰çš„æ‰§è¡Œã€‚xmlä¸­åœ¨aop:aspecté‡Œé¢ä½¿ç”¨aop:beforeå…ƒç´ è¿›è¡Œå£°æ˜ï¼›ä¾‹å¦‚ï¼ŒTestAspectä¸­çš„doBeforeæ–¹æ³•ã€‚æ³¨è§£ä¸­ä½¿ç”¨@Beforeå£°æ˜ï¼›ä¾‹å¦‚ï¼ŒTestAnnotationAspectä¸­çš„doBeforeæ–¹æ³•ã€‚</li><li>B åé€šçŸ¥ï¼ˆAfter adviceï¼‰ï¼šå½“æŸè¿æ¥ç‚¹é€€å‡ºçš„æ—¶å€™æ‰§è¡Œçš„é€šçŸ¥ï¼ˆä¸è®ºæ˜¯æ­£å¸¸è¿”å›è¿˜æ˜¯å¼‚å¸¸é€€å‡ºï¼‰ã€‚xmlä¸­åœ¨aop:aspecté‡Œé¢ä½¿ç”¨aop:afterå…ƒç´ è¿›è¡Œå£°æ˜ã€‚ä¾‹å¦‚ï¼ŒTestAspectä¸­çš„doAfteræ–¹æ³•ï¼Œæ‰€ä»¥AOPTestä¸­è°ƒç”¨BServiceImpl.barBæŠ›å‡ºå¼‚å¸¸æ—¶ï¼ŒdoAfteræ–¹æ³•ä»ç„¶æ‰§è¡Œã€‚æ³¨è§£ä¸­ä½¿ç”¨@Afterå£°æ˜ã€‚</li><li>C è¿”å›åé€šçŸ¥ï¼ˆAfter return adviceï¼‰ï¼šåœ¨æŸè¿æ¥ç‚¹æ­£å¸¸å®Œæˆåæ‰§è¡Œçš„é€šçŸ¥ï¼Œä¸åŒ…æ‹¬æŠ›å‡ºå¼‚å¸¸çš„æƒ…å†µã€‚xmlä¸­åœ¨aop:aspecté‡Œé¢ä½¿ç”¨å…ƒç´ è¿›è¡Œå£°æ˜ã€‚æ³¨è§£ä¸­ä½¿ç”¨@AfterReturningå£°æ˜ï¼›</li><li>D ç¯ç»•é€šçŸ¥ï¼ˆAround adviceï¼‰ ï¼šåŒ…å›´ä¸€ä¸ªè¿æ¥ç‚¹çš„é€šçŸ¥ï¼Œç±»ä¼¼Webä¸­Servletè§„èŒƒä¸­çš„Filterçš„doFilteræ–¹æ³•ã€‚å¯ä»¥åœ¨æ–¹æ³•çš„è°ƒç”¨å‰åå®Œæˆè‡ªå®šä¹‰çš„è¡Œä¸ºï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä¸æ‰§è¡Œã€‚xmlä¸­åœ¨aop:aspecté‡Œé¢ä½¿ç”¨aop:aroundå…ƒç´ è¿›è¡Œå£°æ˜ã€‚ä¾‹å¦‚ï¼ŒTestAspectä¸­çš„doAroundæ–¹æ³•ã€‚æ³¨è§£ä¸­ä½¿ç”¨@Aroundå£°æ˜ã€‚</li><li>E æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ï¼ˆAfter throwing adviceï¼‰ ï¼š åœ¨æ–¹æ³•æŠ›å‡ºå¼‚å¸¸é€€å‡ºæ—¶æ‰§è¡Œçš„é€šçŸ¥ã€‚xmlä¸­åœ¨aop:aspecté‡Œé¢ä½¿ç”¨aop:after-throwingå…ƒç´ è¿›è¡Œå£°æ˜ã€‚ä¾‹å¦‚ï¼ŒTestAspectä¸­çš„doThrowingæ–¹æ³•ã€‚æ³¨è§£ä¸­ä½¿ç”¨@AfterThrowingå£°æ˜ã€‚</li><li>é€šçŸ¥æ‰§è¡Œé¡ºåºï¼šå‰ç½®é€šçŸ¥â†’ç¯ç»•é€šçŸ¥è¿æ¥ç‚¹ä¹‹å‰â†’è¿æ¥ç‚¹æ‰§è¡Œâ†’ç¯ç»•é€šçŸ¥è¿æ¥ç‚¹ä¹‹åâ†’è¿”å›é€šçŸ¥â†’åé€šçŸ¥ â†’(å¦‚æœå‘ç”Ÿå¼‚å¸¸)å¼‚å¸¸é€šçŸ¥â†’åé€šçŸ¥ã€‚</li></ul><p>4.åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰åŒ¹é…è¿æ¥ç‚¹çš„æ–­è¨€ï¼Œåœ¨AOPä¸­é€šçŸ¥å’Œä¸€ä¸ªåˆ‡å…¥ç‚¹è¡¨è¾¾å¼å…³è”ã€‚ä¾‹å¦‚ï¼ŒTestAspectä¸­çš„æ‰€æœ‰é€šçŸ¥æ‰€å…³æ³¨çš„è¿æ¥ç‚¹ï¼Œéƒ½ç”±åˆ‡å…¥ç‚¹è¡¨è¾¾å¼execution(* com.spring.service..(..))æ¥å†³å®šã€‚</p><p><strong>æ³¨:ä»¥ä¸Šçš„ç†è®ºçŸ¥è¯†å‚è€ƒ:https://www.cnblogs.com/yepei/p/4735298.html</strong></p><h3 class=pgc-h-arrow-right>å¼€å‘å‡†å¤‡</h3><p><strong>ç¯å¢ƒè¦æ±‚</strong></p><p><strong>JDK</strong>ï¼š1.8</p><p><strong>SpringBoot</strong>ï¼š2.2.6.RELEASE</p><p>é¦–å…ˆè¿˜æ˜¯Mavençš„ç›¸å…³ä¾èµ–ï¼ŒåŸºæœ¬å’Œæ™®é€šspringbooté¡¹ç›®ä¸€æ ·ï¼Œå°±æ˜¯å¤šäº†spring-boot-starter-aopè¿™jarçš„ä¾èµ–ã€‚</p><p><strong>pom.xml</strong>æ–‡ä»¶å¦‚ä¸‹:</p><pre><code>&lt;properties&gt;	&lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;	&lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;	&lt;java.version&gt;1.8&lt;/java.version&gt;	&lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;	&lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;&lt;/properties&gt;&lt;parent&gt;	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;	&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;	&lt;version&gt;2.2.6.RELEASE&lt;/version&gt;	&lt;relativePath/&gt;&lt;/parent&gt;&lt;dependencies&gt;	&lt;dependency&gt;		&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;		&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;	&lt;/dependency&gt;	&lt;dependency&gt;		&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;		&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;		&lt;scope&gt;test&lt;/scope&gt;	&lt;/dependency&gt;	&lt;dependency&gt;		&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;		&lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;	&lt;/dependency&gt;	&lt;dependency&gt;		&lt;groupId&gt;com.alibaba&lt;/groupId&gt;		&lt;artifactId&gt;fastjson&lt;/artifactId&gt;		&lt;version&gt;1.2.68&lt;/version&gt;	&lt;/dependency&gt;     &lt;dependency&gt;        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;        &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;        &lt;optional&gt;true&lt;/optional&gt;        &lt;scope&gt;test&lt;/scope&gt;	&lt;/dependency&gt;&lt;/dependencies&gt;</code></pre><p>application.propertiesçš„æ–‡ä»¶çš„é…ç½®:</p><pre><code>banner.charset=UTF-8server.tomcat.uri-encoding=UTF-8spring.http.encoding.charset=UTF-8spring.http.encoding.enabled=truespring.http.encoding.force=truespring.messages.encoding=UTF-8spring.application.name=springboot-aspectserver.port=8180</code></pre><h3 class=pgc-h-arrow-right>ä»£ç ç¼–å†™</h3><p>SpringBootåœ¨ä½¿ç”¨åˆ‡é¢çš„æ—¶å€™ï¼Œåªéœ€è¦åœ¨è‡ªå®šä¹‰çš„ä¸€ä¸ªåˆ‡é¢ç±»ä¸­åŠ ä¸Š @Aspect æ³¨è§£è¿›è¡Œå£°æ˜ï¼Œç„¶ååœ¨è‡ªå®šä¹‰åˆ‡é¢çš„ç±»æ–¹æ³•ä¸­åŠ ä¸Šå¯¹åº”çš„æ³¨è§£å³å¯ã€‚æ¯”å¦‚è¿™é‡Œçš„ç¤ºä¾‹æˆ‘ä»¬æƒ³åšä¸€ä¸ªè¯·æ±‚å“åº”çš„åŠ è§£å¯†åˆ‡é¢å¤„ç†ï¼Œä¸šåŠ¡å±‚åªéœ€å…³å¿ƒä»£ç é€»è¾‘å®ç°ï¼Œè€Œä¸ç”¨å…³å¿ƒè¯·æ±‚å‚æ•°å’Œå“åº”å‚æ•°çš„åŠ è§£å¯†å®ç°ã€‚é‚£ä¹ˆé¦–å…ˆæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªåŠ è§£å¯†çš„åˆ‡é¢ç±»ï¼Œåœ¨è¯¥ç±»æ·»åŠ @Aspectæ³¨è§£ï¼Œç„¶ååœ¨å®šä¹‰ä¸€ä¸ªå…¬å…±çš„åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰ï¼ŒæŒ‡å‘éœ€è¦å¤„ç†çš„åŒ…ï¼Œç„¶ååœ¨å®šä¹‰ä¸€ä¸ªå‰ç½®é€šçŸ¥(æ·»åŠ @Beforeæ³¨è§£)å’Œåç½®é€šçŸ¥(æ·»åŠ @AfterReturning)æ–¹æ³•å®ç°å³å¯ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å°±å°†åˆ‡å…¥ç‚¹è®¾ç½®ä¸ºæ§åˆ¶å±‚åŒ…é‡Œæ‰€æœ‰çš„è¯·æ±‚ã€‚</p><p><strong>åˆ‡å…¥ç‚¹ä»£ç ç¤ºä¾‹:</strong></p><pre><code>	 	 @Pointcut("execution(public * com.pancm.web.*.*(..))")  			  public void doOperation() {   		 }</code></pre><p>ç„¶ååœ¨å®šä¹‰ä¸€ä¸ªå‰ç½®é€šçŸ¥ï¼Œå®ç°å¯¹è¯·æ±‚å‚æ•°çš„æ•°æ®è§£å¯†ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ç”¨Userè¿™ä¸ªå®ä½“ç±»çš„åç§°ï¼Œå¯¹è¯¥æ•°æ®è¿›è¡Œè§£å¯†ã€‚å®é™…åœ¨è¿ç”¨æ˜¯å¯ä»¥æ ¹æ®è‡ªèº«çš„æƒ…å†µæ¥ç¼–å†™ã€‚</p><p><strong>å‰ç½®é€šçŸ¥ä»£ç ç¤ºä¾‹:</strong></p><pre><code>	@Before("doOperation()")    public void before(JoinPoint joinPoint) throws Throwable{        Object[] objs = joinPoint.getArgs();        for (Object obj : objs) {            User user =(User) obj;            System.out.println("å‰ç½®é€šçŸ¥æ¥å—çš„å‚æ•°:"+user);            String name =base64DeStr(user.getName());            user.setName(name);        }    }</code></pre><p>åœ¨ç¼–å†™å®Œå‰ç½®é€šçŸ¥çš„æ–¹æ³•ä¹‹åï¼Œæˆ‘ä»¬åœ¨ç¼–å†™åç½®é€šçŸ¥çš„ä»£ç ï¼Œè¿™å—åŸºæœ¬å’Œå‰ç½®é€šçŸ¥çš„ä¸€æ ·ï¼Œå°±æ˜¯æŠŠè¿”å›çš„æ•°æ®è¿›è¡ŒåŠ å¯†è€Œå·²ã€‚</p><p><strong>åç½®é€šçŸ¥ä»£ç ç¤ºä¾‹:</strong></p><pre><code>    @AfterReturning(returning = "object", pointcut = "doOperation()")    public void doAfterReturning(Object object) {        ResultBody resultBody = (ResultBody) object;        String str =null;        try {             str=base64EnStr(resultBody.getResult());        } catch (UnsupportedEncodingException e) {            e.printStackTrace();        }        resultBody.setResult(str);        System.out.println("åé€šçŸ¥å“åº”çš„å‚æ•°:"+resultBody);    }</code></pre><p><strong>å®Œæ•´ä»£ç ç¤ºä¾‹:</strong></p><pre><code>@Aspect@Componentpublic class ParamAspect {    @Pointcut("execution(public * com.pancm.web.*.*(..))")    public void doOperation() {    }    @Before("doOperation()")    public void before(JoinPoint joinPoint) throws Throwable{        Object[] objs = joinPoint.getArgs();        for (Object obj : objs) {            User user =(User) obj;            System.out.println("å‰ç½®é€šçŸ¥æ¥å—çš„å‚æ•°:"+user);            String name =base64DeStr(user.getName());            user.setName(name);        }    }    @AfterReturning(returning = "object", pointcut = "doOperation()")    public void doAfterReturning(Object object) {        ResultBody resultBody = (ResultBody) object;        String str =null;        try {             str=base64EnStr(resultBody.getResult());        } catch (UnsupportedEncodingException e) {            e.printStackTrace();        }        resultBody.setResult(str);        System.out.println("å‰ç½®é€šçŸ¥å“åº”çš„å‚æ•°:"+resultBody);    }    public  String base64EnStr(String str) throws UnsupportedEncodingException {        return Base64.getEncoder().encodeToString(str.getBytes("UTF-8"));    }    public static String base64DeStr(String encodeStr) throws UnsupportedEncodingException {        byte[] decodeStr = Base64.getDecoder().decode(encodeStr);        return new String(decodeStr, "UTF-8");    }</code></pre><p><strong>å®ä½“ç±»ä»£ç </strong></p><pre><code>	public class User {				 private Long id;			 private String name;		 		 private Integer age;		 		//getter å’Œ setter ç•¥			}</code></pre><p>æ§åˆ¶å±‚zè¿™å—çš„ä»£ç å’Œæ™®é€šçš„ä¸€æ ·ï¼Œæˆ‘ä»¬è¿™é‡Œåªéœ€ç®€å•çš„åšä¸‹å¤„ç†å³å¯ï¼Œè¿™é‡Œä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæ²¡æœ‰ç¼–å†™serviceå±‚å’Œdaoçš„ä»£ç ã€‚:</p><p>** æ§åˆ¶å±‚ä»£ç **</p><pre><code>@RestController@RequestMapping(value = "/api")public class UserRestController {    @GetMapping("/user")    public ResultBody findByUser(User  user) {        System.out.println("ç”¨æˆ·æŸ¥è¯¢æ¥å£è¯·æ±‚çš„å‚æ•°:"+user);        ResultBody resultBody = new ResultBody();        List&lt;User&gt; userList =new ArrayList&lt;&gt;();        User user2=new User();        user2.setId(1L);        user2.setName("xuwujing");        user2.setAge(18);        userList.add(user2);        resultBody.setCode("0");        resultBody.setResult(userList.toString());        System.out.println("ç”¨æˆ·æŸ¥è¯¢æ¥å£å“åº”çš„å‚æ•°:"+resultBody);        return resultBody;    }}</code></pre><p><strong>App å…¥å£</strong></p><p>å’Œæ™®é€šçš„SpringBooté¡¹ç›®åŸºæœ¬ä¸€æ ·ï¼</p><p><strong>ä»£ç å¦‚ä¸‹:</strong></p><pre><code>	@SpringBootApplication	public class AspectApp	{	    public static void main( String[] args )	    {			SpringApplication.run(AspectApp.class, args);			System.out.println("Aspectå¯åŠ¨æˆåŠŸï¼");	    }	}</code></pre><h3 class=pgc-h-arrow-right>åŠŸèƒ½æµ‹è¯•</h3><p>ç¼–å†™å®Œä»£ç ä¹‹åï¼Œæˆ‘ä»¬å¯åŠ¨ç¨‹åºï¼Œå› ä¸ºæ˜¯Getè¯·æ±‚ï¼Œåœ¨æµè§ˆå™¨æˆ–è€…ä½¿ç”¨Postmanè¾“å…¥åœ°å€éƒ½å¯ä»¥è¿›è¡Œæµ‹è¯•ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œæˆ‘ä»¬éœ€è¦å¯¹nameçš„å€¼è¿›è¡Œbase64åŠ å¯†è¯·æ±‚ã€‚</p><p>è¾“å…¥:</p><blockquote><p>http://localhost:8180/api/user?name=eHV3dWppbmc=</p></blockquote><p>æ§åˆ¶å°æ‰“å°:</p><blockquote><p>å‰ç½®é€šçŸ¥æ¥å—çš„å‚æ•°:{"name":"eHV3dWppbmc="}ç”¨æˆ·æŸ¥è¯¢æ¥å£è¯·æ±‚çš„å‚æ•°:{"name":"xuwujing"}ç”¨æˆ·æŸ¥è¯¢æ¥å£å“åº”çš„å‚æ•°:{"code":"0","result":"[{"age":18,"id":1,"name":"xuwujing"}]"}åé€šçŸ¥å“åº”çš„å‚æ•°:{"code":"0","result":"W3siYWdlIjoxOCwiaWQiOjEsIm5hbWUiOiJ4dXd1amluZyJ9XQ=="}</p></blockquote><p>è¯·æ±‚å“åº”å‚æ•°:</p><blockquote><p>{"code": "0","message": null,"result": "W3siYWdlIjoxOCwiaWQiOjEsIm5hbWUiOiJ4dXd1amluZyJ9XQ=="}</p></blockquote><p>ç¤ºä¾‹å›¾:</p><div class=pgc-img><img alt=SpringBootåˆ‡é¢Aopçš„demoç®€å•è®²è§£ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ec7dea99ced1417b940a9ffe67dc81aa><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=SpringBootåˆ‡é¢Aopçš„demoç®€å•è®²è§£ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e4d35229e4b84e94b349da1b586b82e2><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'SpringBoot','Aop','demo'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>