<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>为什么要用规则引擎？ | 极客快訊</title><meta property="og:title" content="为什么要用规则引擎？ - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/4ba80991dc0444e490f4a9760ebae654"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a3ff676d.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a3ff676d.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a3ff676d.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a3ff676d.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a3ff676d.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a3ff676d.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a3ff676d.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a3ff676d.html><meta property="article:published_time" content="2020-11-14T20:59:54+08:00"><meta property="article:modified_time" content="2020-11-14T20:59:54+08:00"><meta name=Keywords content><meta name=description content="为什么要用规则引擎？"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/a3ff676d.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>为什么要用规则引擎？</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><pre>作者：孤独烟来源：https://www.cnblogs.com/rjzheng/p/10996186.html</pre><p>一天，朱斯参加了一场code Review研讨会。会上的一群人正在讨论着如何对祖传代码进行变更，大家你一言，我一语,场面十分热闹！</p><p>突然，只见人群中的一个人满面愁容，说道:"昨天在项目中看到下面这样一段代码，分支太多了！维护起来很烦啊！"</p><div class=pgc-img><img alt=为什么要用规则引擎？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4ba80991dc0444e490f4a9760ebae654><p class=pgc-img-caption></p></div><p>研讨会上的另一个人提道:"这个容易啊，可以用策略模式来简化if else的结构！毕竟策略模式强调的就是数据与业务逻辑分离，针对每一个分支写一个策略就好啦！"</p><p>可是，旁边的一个人说道:"用策略模式来简化if else的代码结构固然可以，但是这里有一个前提，就是分支比较少，一般就十来个分支差不多了，可以用策略模式来简化！但是如果我有上万个分支呢？你难道做上万个策略?就算这几万个策略真给你写出来了，你以后怎么维护？以后要修改策略，改完再重新部署一次么？太不灵活了啊！"</p><p>此时，刚好有一位DBA大神也参加了这场code Review研讨会！他说道:"要不考虑一下存储过程？将变化的策略放在存储过程里维护，这样至少修改了策略，不用部署原来的应用！"</p><p>听到这里，朱斯实在听不下去了，猛的回了一句:"不行！不行！用存储过程可读性更差，而且性能还不好！更可怕的是，如果你用的是MySQL，调试存储过程是会要人命的！"</p><p>"唉，这也不行，那也不行，究竟该怎么办？"人群中充斥着吵闹声！</p><p>朱斯摆了摆手,示意大家静静，说道:"我们需要明白现在的需求是什么？</p><ul><li>第一，我们要简化if else结构,让业务逻辑和数据分离！</li><li>第二，分离出的业务逻辑必须要易于编写，至少单独编写这些业务逻辑，要比写代码快！</li><li>第三，分离出的业务逻辑必须要比原来的代码更容易读懂！</li><li>第四，分离出的业务逻辑必须比原来的易于维护，至少改动这些逻辑，应用程序不用重启！</li><li>大概，就上面四点吧！"</li></ul><p>大家问道"有满足这样需求的中间件么？"</p><p>朱斯说道:"有的！那就是规则引擎!在一些强大的规则引擎中，可以像下面这样优化，使数据和逻辑分离！"</p><div class=pgc-img><img alt=为什么要用规则引擎？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2cc9440b2c9a4a568abb2448536a548d><p class=pgc-img-caption></p></div><p>朱斯补充道:"像上面这张图这样，我们将业务逻辑抽取到单独的规则文件里进行维护，实现了业务和数据分离！至于数据如何传入规则引擎呢，注意看代码里有一句叫kieSession.insert("星期一")，这样规则引擎就知道自己有一个字符串内容为星期一的入参！而且，大家注意看哦，规则文件内容是可以用中文编写的！"</p><p>"哇塞、还能用中文来表述业务逻辑！这样非技术人员也能看得懂呀！"人群中传来一阵惊叹声！</p><p>(ps:笔者的同事，当年第一次见到我写的中文业务逻辑，他一脸的神奇！~)</p><p>朱斯补充道:"不仅如此，当你新加一个条件分支的时候，直接新增一个规则文件就好啦！例如，我们要多加一个判断周二要去shopping！那我们就在规则包中新增一个文件，内容如下!"</p><div class=pgc-img><img alt=为什么要用规则引擎？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/58c308ef7bc449e9939dfa538037cd06><p class=pgc-img-caption></p></div><p>"大家看，我们在规则包中新增上述规则文件后，你只要让你的应用程序从新加载一次规则包就好啦！完全不用重启原来的应用程序！"朱斯说完话，面带笑容的看着大家。</p><p>众人看着朱斯的讲解，纷纷称奇！</p><p>突然，人群中一阵沸腾，问道"哇哇哇，真是太神奇了，快告诉我们这套规则引擎叫啥！"</p><p>"我叫朱斯(Drools)，刚才展示的那套规则语言是我的领域特殊语言(DSL)！"</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'什么','规则','引擎'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>