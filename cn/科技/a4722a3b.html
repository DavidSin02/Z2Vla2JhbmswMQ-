<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>「视频随手文档」编写泵、阀等设备的启停控制模板程序 | 极客快訊</title><meta property="og:title" content="「视频随手文档」编写泵、阀等设备的启停控制模板程序 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/2e4fabf17d884e528808fed5a908ed73"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a4722a3b.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a4722a3b.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a4722a3b.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a4722a3b.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a4722a3b.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a4722a3b.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a4722a3b.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a4722a3b.html><meta property="article:published_time" content="2020-11-14T20:59:22+08:00"><meta property="article:modified_time" content="2020-11-14T20:59:22+08:00"><meta name=Keywords content><meta name=description content="「视频随手文档」编写泵、阀等设备的启停控制模板程序"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/a4722a3b.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>「视频随手文档」编写泵、阀等设备的启停控制模板程序</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><h1>系列视频《WinCC+PLC综合实战演练》已经累计发布了十余期了，鉴于有网友要求对一些关键知识点形成文字资料，因此，特别概括性的做一些总结，以弥补视频中遗漏的、未提到的部分，供有需要的小伙伴做参考。</h1><hr><p>前文总结了WinCC画面中，沉降池水位的动态跟踪及液位超限（太高或太低）时，如何在画面中实现报警。本文把启停控制程序捋一遍（泵的启停、阀的开合用的同一套程序）。</p><div class=pgc-img><img alt=「视频随手文档」编写泵、阀等设备的启停控制模板程序 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2e4fabf17d884e528808fed5a908ed73><p class=pgc-img-caption></p></div><p>"启停"程序（on_off）写在FC1中，其调用时的管脚图如图1所示，其中定义输入管脚4个，输入/输出管脚3个，输出管脚4个。为什么要这样定义呢？接下来我们细细道来。</p><hr><h1>一、程序体分解释疑</h1><p>为了方便说明，我们先逐段说明一下程序，再解释为何要将接口定义成图1那种方式（<strong>注意，程序中所有带"#"标识的触点、线圈变量都为FC1块中定义的接口或临时变量</strong>）。</p><blockquote><p><strong>1、启停控制</strong></p></blockquote><div class=pgc-img><img alt=「视频随手文档」编写泵、阀等设备的启停控制模板程序 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/cac33f10b91441e9bf38764e02900c06><p class=pgc-img-caption></p></div><p>如图2所示，"程序段1"中的程序为"启停控制程序"。</p><ul><li><strong>"#order"为启停命令，其为图1中输出接口的一个，信号最终与Q点相连；</strong></li><li><strong>"#start"为启动信号、"#stop"为停止信号，其指令来自画面（如图3所示），用于启动或停止泵（阀）；</strong></li><li><strong>当"#order"为1时，通过"复位"指令，复位"#start"的信号，这样做的目的是使"#start"端的信号变为一个脉冲信号，方便信号处理。而由于"#start"既作为输入接收来自画面的指令，又作为"线圈"被"复位"指令复位，因此要将该信号接口定义为"输入/输出接口"；</strong></li><li><strong>"#fault"为故障信号，当其为1时，停泵、关阀。</strong></li></ul><div class=pgc-img><img alt=「视频随手文档」编写泵、阀等设备的启停控制模板程序 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/34d24f0e15404ac091de0df2ba115cdb><p class=pgc-img-caption></p></div><blockquote><p>2、"#start"、"#stop"、"#ack"信号的脉冲化处理</p></blockquote><div class=pgc-img><img alt=「视频随手文档」编写泵、阀等设备的启停控制模板程序 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b0429e4c68ff49fc9d3d256d088c59cf><p class=pgc-img-caption></p></div><p>"#start"、"#stop"及"#ack"指令均来自WinCC画面（如图3所示），画面侧通过点击相应的按钮，发过来一个高电平信号，为了简化信号处理，统一在程序使其"脉冲化"，如图4所示。</p><p>逻辑也很简单：</p><ul><li><strong>当泵（或阀）启动命令发出后（"#order"上升沿），复位"#start"；</strong></li><li><strong>当泵（或阀）停止命令发出后（"#order"下降沿），复位"#stop"；</strong></li><li><strong>"#ack"为故障确认信号，当"#ack"发出确认指令且故障清除后（"#fault"下降沿），复位"#ack"。</strong></li></ul><blockquote><p>3、状态反馈"响应时间"监控</p></blockquote><div class=pgc-img><img alt=「视频随手文档」编写泵、阀等设备的启停控制模板程序 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f612219936e847ba9b50c7babefa66f7><p class=pgc-img-caption></p></div><p>"#T_no"是定时器的形参地址，实际调用该FC块时，需要关联一个实际的定时器号。（1）"程序段4"的逻辑是，当"#order"为1时，启动定时器；</p><p>"程序段5"的逻辑是，在定时器计时完成（计时完成后，常闭触点"#T_no"）前检测到运行反馈信号"#fbk"，此时说明泵（或阀）启动正常，则复位定时器。</p><p>故障确认指令"#ack"也会复位定时器。</p><blockquote><p>4、"运行信号"判定</p></blockquote><div class=pgc-img><img alt=「视频随手文档」编写泵、阀等设备的启停控制模板程序 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6308b3ac2dd144dfb2a79b4bc975431f><p class=pgc-img-caption></p></div><p>"程序段6"和"程序段7"用于判定泵（或阀）是否正在运行。</p><ul><li><strong>当有输出命令（"#order"=1）且有反馈信号（"#fbk"=1）时，说明泵（或阀）正在运行；</strong></li><li><strong>当无输出（"#order"=0）或有故障（"#fault=1"）时，认为泵（或阀）处于停止状态。</strong></li></ul><blockquote><p>5、"故障"判定及确认</p></blockquote><div class=pgc-img><img alt=「视频随手文档」编写泵、阀等设备的启停控制模板程序 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e9c7ad030c5e4ee69ed8ea0bac16f097><p class=pgc-img-caption></p></div><p>当以下情况发生时，认为泵（或阀）有故障：</p><ul><li><strong>在正常运行（"#running=1"）时，反馈信号（"#fbk"）突然丢失，此时系统判定主回路由于某种原因失电，从而触发故障；</strong></li><li><strong>在启动命令发出后，规定的时间内（定时器"T_no"计时完成）未检测到反馈信号（"#fbk"），系统认为泵（或阀）启动失败，触发故障。</strong></li></ul><p>"#ack"接入"SR触发器"的复位端，用于做故障确认。</p><blockquote><p>6、状态字</p></blockquote><div class=pgc-img><img alt=「视频随手文档」编写泵、阀等设备的启停控制模板程序 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/7de3f2cc2831430a8f76909920519415><p class=pgc-img-caption></p></div><p>"状态字"定义的核心指令为：MOVE指令。满足不同条件时，将不同的值送给状态字"#status"。</p><hr><h1>二、接口定义</h1><div class=pgc-img><img alt=「视频随手文档」编写泵、阀等设备的启停控制模板程序 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/471b4280289f4925b072747a8543406f><p class=pgc-img-caption></p></div><p>经过前面对程序的"逐段"分析，我们对"接口"为什么做如是定义，也有了基本的了解，再补充以下几点：</p><ol><li><strong>"#start"、"#stop"和"#ack"之所以定义为"输入/输出"接口类型，是因为它们既接受外部的信号，在程序中又作为"线圈"输出。</strong></li><li><strong>"定时器号"的形式参数的数据类型为"Timer"。</strong></li><li><strong>"#sim_on"是预留的仿真用接口，目前的程序中，它是没用的。</strong></li><li><strong>FC中定义的接口变量，在本块中寻址方式为："#+符号名"，如"#start"、"#status"等。</strong></li></ol><p>相关视频：</p><p><a class=pgc-link data-content=mp href=https://www.ixigua.com/i6727286692346069511/ target=_blank>《PLC编程实现“泵”的启停控制，如何自定义运行状态及状态字》</a></p><p><a class=pgc-link data-content=mp href=https://www.ixigua.com/i6727636737662648839/ target=_blank>《程序“pumb1_FC"的勘误和优化，完善故障的类别信息》</a></p><hr><p>上一篇<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6730222235023311363/?group_id=6730222235023311363" target=_blank>《「视频随手文档」WinCC实现“液位”的动态跟踪以及超限报警》</a></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'视频','随手','文档'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>