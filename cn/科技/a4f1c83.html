<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Excel VBA 7.55按照数据区域拆分块状工作表，报表拆分玩出新花样 | 极客快訊</title><meta property="og:title" content="Excel VBA 7.55按照数据区域拆分块状工作表，报表拆分玩出新花样 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/6fd3ce7a3e9a4811921f734adf9241d5"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a4f1c83.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a4f1c83.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a4f1c83.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a4f1c83.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a4f1c83.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a4f1c83.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a4f1c83.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a4f1c83.html><meta property="article:published_time" content="2020-10-29T20:51:37+08:00"><meta property="article:modified_time" content="2020-10-29T20:51:37+08:00"><meta name=Keywords content><meta name=description content="Excel VBA 7.55按照数据区域拆分块状工作表，报表拆分玩出新花样"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/a4f1c83.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Excel VBA 7.55按照数据区域拆分块状工作表，报表拆分玩出新花样</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><blockquote><p><strong>号外</strong></p></blockquote><p>已经开通视频分享讲解，更新模式更改为一日图文，次日视频的模式，还望大家多多支持，谢谢</p><blockquote><p><strong>前景提要(文末提供源码下载）</strong></p></blockquote><p>今天我们继续来分享工作表拆分的操作，相对于昨天来说，我们今天的这个场景可能会比较常见一些，因为此类问题有几个小伙伴一起提出过类似的情况，所以今天我也是专门合并在一起来实现下，今天的这个拆分场景想比较昨天的案例，又是一个升级版，不仅仅有空行，还有空列，数据都是独立成块，我们要一块块一片片的进行拆分，来看看案例</p><blockquote><p>场景说明</p></blockquote><div class=pgc-img><img alt="Excel VBA 7.55按照数据区域拆分块状工作表，报表拆分玩出新花样" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/6fd3ce7a3e9a4811921f734adf9241d5><p class=pgc-img-caption></p></div><p>今天的数据是这样的，这里肯定会有小伙伴们抱怨了，这个数据完全看不清内容，其实今天数据源的内容反而不是主要的，主要是数据的格式，大致一眼看过去，就能够看到数据都是被分成一块一块的，一个区域一个数据源，这样的数据构造影像中是比较常见，有很多时候我们为了一次性展示数据，通常会选择这样的方式来实现，但是数据分析和保存的时候，谁都不喜欢看这样的数据，那么这样的数据如何进行拆分呢？</p><blockquote><p><strong>代码区</strong></p></blockquote><p>来看看代码吧</p><pre>Sub swws()Dim sth As Worksheet, sthn As WorksheetSet sth = ActiveSheetRowl = sth.UsedRange.Rows.CountColl = sth.UsedRange.Columns.CountFor i = 1 To Rowl For j = 1 To Coll If Cells(i, j) &lt;&gt; "" Then Rcount = Cells(i, j).CurrentRegion.Rows.Count Ccount = Cells(i, j).CurrentRegion.Columns.Count Worksheets.Add after:=Worksheets(Worksheets.Count) Set sthn = ActiveSheet sth.Cells(i, j).CurrentRegion.Copy sthn.Cells(1, 1) sth.Activate j = j + Ccount - 1 End If Next j i = i + Rcount - 1Next iEnd Sub</pre><p>简短了很多，来看看过程</p><p>额~什么都不用选择，按照当前的场景，直接执行程序就可以进行拆分了，我们来看看结果</p><div class=pgc-img><img alt="Excel VBA 7.55按照数据区域拆分块状工作表，报表拆分玩出新花样" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/32f21599a6214cfc904917019972dcaa><p class=pgc-img-caption></p></div><p>刚好8个板块的数据被拆成了8个区域，满足了我们的要求，今天的代码就比较的简单了，因为数据模式比较的规则，来看看代码的分析</p><blockquote><p><strong>代码分析</strong></p></blockquote><p>今天的代码的重点就不在代码本身，而在代码逻辑本身的思路上面</p><pre>Rowl = sth.UsedRange.Rows.CountColl = sth.UsedRange.Columns.Count</pre><p>我们这里先得到当前区域的总行数和总列数，usedrange代表的是所有的使用区域，无视空行空列</p><p>有了总行数和总列数之后，我们就可以开始构造循环了，这里的循环和我们之前的循环又有一点线不同了，这里是两个循环同时进行</p><pre>For i = 1 To Rowl For j = 1 To Coll **** Next jNext i</pre><p>i代表的是行数，j代表的则是列数，再循环行的时候，同时循环列</p><p>我们先看第一次循环</p><pre>If Cells(i, j) &lt;&gt; "" Then Rcount = Cells(i, j).CurrentRegion.Rows.Count Ccount = Cells(i, j).CurrentRegion.Columns.Count Worksheets.Add after:=Worksheets(Worksheets.Count) Set sthn = ActiveSheet sth.Cells(i, j).CurrentRegion.Copy sthn.Cells(1, 1) sth.Activate j = j + Ccount - 1 End If</pre><p>cells（1,1）不为空，是由数值的，所以这里既可以进入判断内部了，得到当前这个这个小的区域的范围，如何得到CurrentRegion</p><div class=pgc-img><img alt="Excel VBA 7.55按照数据区域拆分块状工作表，报表拆分玩出新花样" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a29fa6c1483247d0b5d892c038dad7f6><p class=pgc-img-caption></p></div><p>就是这一小块区域，以空行空列为标准，非空的填充数据的都是CurrentRegion的范围，然后我们可以得到这个单位的总行数总列数了，有了范围，直接将他们丢到新的工作表中就可以了。这里就很简单了。</p><p>然后我们继续，这个时候要注意循环的过程，这里时候我们正在进行j就是列的循环，这个时候我们的列数j是1</p><p>我们再次循环是从2开始吗？</p><p>但是第2列已经是我们第一个数据区的范围了，刚刚已经复制过去了</p><p>如果你想到这一点了，那就证明你已经理解CurrentRegion的范围了，既然已经复制过了，我们自然不能再次复制了，那么怎么办，直接跳跃</p><p>之前我们也用过跳跃式循环，j = j + Ccount - 1</p><p>当我们复制完一个区域之后，顺带的将j的数值变成我们刚刚复制的区域的总行数</p><p>然后再次循环，j就来到了空列，然后进入判断，cells(i,j)是否为空，为空，跳过j+1,就这样成功的进入了下一个数据区</p><div class=pgc-img><img alt="Excel VBA 7.55按照数据区域拆分块状工作表，报表拆分玩出新花样" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/19be0fda8fc746a8ab6950d98caf44c5><p class=pgc-img-caption></p></div><p>这样又来到了下一个循环了，这个循环和上面的循环过程值一样的，不过这个已经到了j的结尾了，所以就会自动跳出j的循环了。</p><p>然后又回到i的循环，i在前面的两个循环中一直都是1.所以这里他也要选择和j一样的操作，我们不需要再循环之前已经复制的数据区了，直接让他跳跃式前进。</p><p>i = i + Rcount - 1</p><div class=pgc-img><img alt="Excel VBA 7.55按照数据区域拆分块状工作表，报表拆分玩出新花样" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/86d9883fa15a448eb4adcfee48d9ffcf><p class=pgc-img-caption></p></div><p>所以本节的代码是很简单，关键的重点是大家要理解这个代码工作的思路和逻辑，以及各个变量的作用和跳跃范围。</p><p>=======================================================</p><p>受限于篇幅，可能有些知识讲得不够详细，感觉还有一些迷茫？没关系，明晚将会奉上相应的视频讲解，敬请期待</p><p>之前太匆忙，忘记分享附件了，今天一起分享下。</p><p>7-54，直接回复“7-54-8”</p><p>7-55，直接回复“7-55-1”</p><p>好了，明晚19:00,准时再见!</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'拆分','Excel','VBA'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>