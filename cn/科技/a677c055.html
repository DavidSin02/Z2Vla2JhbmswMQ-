<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>ä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹åŠ è½½è‡ªå®šä¹‰å›¾åƒæ•°æ®é›† | æå®¢å¿«è¨Š</title><meta property="og:title" content="ä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹åŠ è½½è‡ªå®šä¹‰å›¾åƒæ•°æ®é›† - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/2688ec63f94347f59c16e136741e70df"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a677c055.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a677c055.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a677c055.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a677c055.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a677c055.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a677c055.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a677c055.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a677c055.html><meta property="article:published_time" content="2020-11-14T21:02:25+08:00"><meta property="article:modified_time" content="2020-11-14T21:02:25+08:00"><meta name=Keywords content><meta name=description content="ä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹åŠ è½½è‡ªå®šä¹‰å›¾åƒæ•°æ®é›†"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/a677c055.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>ä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹åŠ è½½è‡ªå®šä¹‰å›¾åƒæ•°æ®é›†</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p>åœ¨æœ¬æ–‡ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•åŠ è½½è‡ªå®šä¹‰æ•°æ®å’Œåˆ›å»ºå›¾åƒåºåˆ—å’Œæµ‹è¯•æ•°æ®é›†ï¼Œä½œä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„è¾“å…¥ã€‚</p><ul><li><strong>Open CV2</strong></li><li><strong>PIL</strong></li></ul><p>è¿™é‡Œä½¿ç”¨çš„æ•°æ®é›†æ˜¯æ¥è‡ªKaggleçš„Intelå›¾åƒåˆ†ç±»ã€‚</p><p>æ•°æ®é›†é“¾æ¥ï¼šhttps://www.kaggle.com/puneet6060/intel-image-classification/version/2</p><p>â€œIntelå›¾åƒåˆ†ç±»â€æ•°æ®é›†å·²åˆ†ä¸ºtrainã€testå’ŒValï¼Œæˆ‘ä»¬å°†ä»…ä½¿ç”¨è®­ç»ƒæ•°æ®é›†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ä¸åŒçš„åº“åŠ è½½æ•°æ®é›†ã€‚</p><p><strong>ä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹åŠ è½½è‡ªå®šä¹‰æ•°æ®é›†çš„å…¸å‹æ­¥éª¤</strong></p><ol start=1><li>æ‰“å¼€å›¾åƒæ–‡ä»¶ã€‚æ–‡ä»¶çš„æ ¼å¼å¯ä»¥æ˜¯JPEGã€PNGã€BMPç­‰ã€‚</li><li>è°ƒæ•´å›¾åƒå¤§å°ä»¥åŒ¹é…æ·±åº¦å­¦ä¹ æ¨¡å‹çš„è¾“å…¥å±‚çš„è¾“å…¥å¤§å°ã€‚</li><li>å°†å›¾åƒåƒç´ è½¬æ¢ä¸ºæµ®ç‚¹æ•°æ®ç±»å‹ã€‚</li><li>å°†å›¾åƒæ ‡å‡†åŒ–ï¼Œä½¿åƒç´ å€¼åœ¨0åˆ°1ä¹‹é—´ã€‚</li><li>æ·±åº¦å­¦ä¹ æ¨¡å‹çš„å›¾åƒæ•°æ®åº”è¯¥æ˜¯ä¸€ä¸ªnumpyæ•°ç»„æˆ–ä¸€ä¸ªå¼ é‡å¯¹è±¡ã€‚</li></ol><p><strong>è‡ªå®šä¹‰å›¾åƒæ•°æ®çš„æ–‡ä»¶å¤¹ç»“æ„</strong></p><div class=pgc-img><img alt=ä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹åŠ è½½è‡ªå®šä¹‰å›¾åƒæ•°æ®é›† onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2688ec63f94347f59c16e136741e70df><p class=pgc-img-caption></p></div><p>æ¯ä¸ªç±»éƒ½æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«è¯¥ç‰¹å®šç±»çš„å›¾åƒã€‚</p><p><strong>ä½¿ç”¨CV2åŠ è½½å›¾åƒæ•°æ®</strong></p><p>å¯¼å…¥æ‰€éœ€çš„åº“</p><pre><code>import pandas as pdimport numpy as npimport osimport tensorflow as tfimport cv2from tensorflow import kerasfrom tensorflow.keras import layers, Dense, Input, InputLayer, Flattenfrom tensorflow.keras.models import Sequential, Modelfrom  matplotlib import pyplot as pltimport matplotlib.image as mpimg%matplotlib inline</code></pre><p>ä»å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­éšæœºè¾“å‡ºäº”å¼ å›¾åƒ</p><pre><code>plt.figure(figsize=(20,20))test_folder=r'CV\Intel_Images\seg_train\seg_train\forest'for i in range(5):    file = random.choice(os.listdir(img_folder))    image_path= os.path.join(img_folder, file)    img=mpimg.imread(image_path)    ax=plt.subplot(1,5,i+1)    ax.title.set_text(file)    plt.imshow(img)</code></pre><div class=pgc-img><img alt=ä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹åŠ è½½è‡ªå®šä¹‰å›¾åƒæ•°æ®é›† onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/51ad21736fcc48d6986bf0801e22296b><p class=pgc-img-caption></p></div><p><strong>è®¾ç½®ç”¨äºåŠ è½½æ•°æ®é›†çš„å›¾åƒç»´åº¦å’Œæºæ–‡ä»¶å¤¹</strong></p><pre><code>IMG_WIDTH=200IMG_HEIGHT=200img_folder=r'CV\Intel_Images\seg_train\seg_train\'</code></pre><p><strong>ä»æ–‡ä»¶å¤¹ä¸­çš„å›¾åƒåˆ›å»ºå›¾åƒæ•°æ®å’Œæ ‡ç­¾</strong></p><p>åœ¨ä¸‹é¢çš„å‡½æ•°ä¸­</p><ul><li>sourceæ–‡ä»¶å¤¹æ˜¯åŒ…å«ä¸åŒç±»çš„å›¾åƒçš„è¾“å…¥å‚æ•°ã€‚</li><li>ä»æ–‡ä»¶å¤¹ä¸­è¯»å–å›¾åƒæ–‡ä»¶å¹¶å°†å…¶è½¬æ¢ä¸ºæ­£ç¡®çš„é¢œè‰²æ ¼å¼ã€‚</li><li>æ ¹æ®æ¨¡å‹æ‰€éœ€çš„è¾“å…¥å°ºå¯¸è°ƒæ•´å›¾åƒå¤§å°</li><li>å°†å›¾åƒè½¬æ¢ä¸ºæ•°æ®ç±»å‹ä¸ºfloat32çš„Numpyæ•°ç»„</li><li>å°†å›¾åƒæ•°ç»„æ ‡å‡†åŒ–ï¼Œä½¿å€¼åœ¨0å’Œ1ä¹‹é—´ï¼Œè¿™æœ‰åŠ©äºæ›´å¿«åœ°æ”¶æ•›ã€‚</li></ul><pre><code>def create_dataset(img_folder):    img_data_array=[]    class_name=[]    for dir1 in os.listdir(img_folder):        for file in os.listdir(os.path.join(img_folder, dir1)):            image_path= os.path.join(img_folder, dir1,  file)            image= cv2.imread( image_path, cv2.COLOR_BGR2RGB)            image=cv2.resize(image, (IMG_HEIGHT, IMG_WIDTH),interpolation = cv2.INTER_AREA)            image=np.array(image)            image = image.astype('float32')            image /= 255             img_data_array.append(image)            class_name.append(dir1)    return img_data_array, class_name# extract the image array and class nameimg_data, class_name =create_dataset(r'CV\Intel_Images\seg_train\seg_train')</code></pre><p><strong>å°†æ–‡æœ¬æ ‡ç­¾è½¬æ¢ä¸ºæ•°å­—ç¼–ç </strong></p><p>ä¸ºç±»çš„æ‰€æœ‰å”¯ä¸€å€¼åˆ›å»ºå­—å…¸</p><pre><code>target_dict={k: v for v, k in enumerate(np.unique(class_name))}target_dict</code></pre><div class=pgc-img><img alt=ä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹åŠ è½½è‡ªå®šä¹‰å›¾åƒæ•°æ®é›† onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c54974e6b37a460b97cc1bfd25c91db8><p class=pgc-img-caption></p></div><p>æ ¹æ®å­—å…¸å°†ç±»åç§°è½¬æ¢ä¸ºå„è‡ªçš„æ•°å€¼</p><pre><code>target_val=  [target_dict[class_name[i]] for i in range(len(class_name))]</code></pre><p>åˆ›å»ºä¸€ä¸ªç®€å•çš„æ·±åº¦å­¦ä¹ æ¨¡å‹å¹¶ç¼–è¯‘å®ƒ</p><pre><code>model=tf.keras.Sequential(        [            tf.keras.layers.InputLayer(input_shape=(IMG_HEIGHT,IMG_WIDTH, 3)),            tf.keras.layers.Conv2D(filters=32, kernel_size=3, strides=(2, 2), activation='relu'),            tf.keras.layers.Conv2D(filters=64, kernel_size=3, strides=(2, 2), activation='relu'),            tf.keras.layers.Flatten(),            tf.keras.layers.Dense(6)        ])encoder.compile(optimizer='rmsprop', loss='sparse_categorical_crossentropy', metrics=['accuracy'])</code></pre><p>æˆ‘ä»¬æœ€ç»ˆè°ƒæ•´æ•°æ®é›†æ¥è®­ç»ƒæ¨¡å‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Numpyæ•°ç»„ä½œä¸ºè¾“å…¥</p><pre><code>history = model.fit(x=np.array(img_data, np.float32), y=np.array(list(map(int,target_val)), np.float32), epochs=5)</code></pre><p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨tf.cast()å°†è¾“å…¥æ•°æ®è½¬æ¢ä¸ºå¼ é‡æ¥è®­ç»ƒæ¨¡å‹ã€‚</p><pre><code>history = model.fit(x=tf.cast(np.array(img_data), tf.float64), y=tf.cast(list(map(int,target_val)),tf.int32), epochs=5)</code></pre><p>æˆ‘ä»¬ä½¿ç”¨ä¸åŒçš„åº“åŠ è½½å›¾åƒæ•°æ®é›†ä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨ç›¸åŒçš„æ¨¡å‹æ¥è¿›è¡Œè¿›ä¸€æ­¥çš„è®­ç»ƒ</p><h1 class=pgc-h-arrow-right>ç”¨PILåŠ è½½å›¾åƒæ•°æ®</h1><p>æ·»åŠ é™„åŠ åº“ä»¥ä½¿ç”¨PILåŠ è½½å›¾åƒæ•°æ®é›†</p><pre><code>from PIL import Image</code></pre><p>ä½¿ç”¨PILä»æ–‡ä»¶å¤¹ä¸­çš„å›¾åƒåˆ›å»ºå›¾åƒæ•°æ®å’Œæ ‡ç­¾</p><p>åœ¨ä¸‹é¢çš„å‡½æ•°ä¸­</p><ul><li>sourceæ–‡ä»¶å¤¹æ˜¯åŒ…å«ä¸åŒç±»çš„å›¾åƒçš„è¾“å…¥å‚æ•°ã€‚</li><li>ä½¿ç”¨PILä»æ–‡ä»¶å¤¹ä¸­æ‰“å¼€å›¾åƒæ–‡ä»¶ã€‚</li><li>æ ¹æ®æ¨¡å‹æ‰€éœ€çš„è¾“å…¥å°ºå¯¸è°ƒæ•´å›¾åƒå¤§å°</li><li>å°†å›¾åƒè½¬æ¢ä¸ºæ•°æ®ç±»å‹ä¸ºfloat32çš„Numpyæ•°ç»„</li><li>æ ‡å‡†åŒ–å›¾åƒæ•°ç»„ä»¥åŠ å¿«æ”¶æ•›ã€‚</li></ul><pre><code>def create_dataset_PIL(img_folder):    img_data_array=[]    class_name=[]    for dir1 in os.listdir(img_folder):        for file in os.listdir(os.path.join(img_folder, dir1)):            image_path= os.path.join(img_folder, dir1,  file)            image= np.array(Image.open(image_path))            image= np.resize(image,(IMG_HEIGHT,IMG_WIDTH,3))            image = image.astype('float32')            image /= 255              img_data_array.append(image)            class_name.append(dir1)    return img_data_array , class_namePIL_img_data, class_name=create_dataset_PIL(img_folder)</code></pre><p><strong>å°†æ–‡æœ¬æ ‡ç­¾è½¬æ¢ä¸ºæ•°å­—ç¼–ç </strong></p><p>ä¸‹é¢æ˜¯æˆ‘ä»¬åœ¨CV2ä¸­ä½¿ç”¨çš„ä»£ç </p><pre><code>target_dict={k: v for v, k in enumerate(np.unique(class_name))}target_val=  [target_dict[class_name[i]] for i in range(len(class_name))]</code></pre><p>åˆ›å»ºå’Œç¼–è¯‘ä¸€ä¸ªç®€å•çš„æ·±åº¦å­¦ä¹ æ¨¡å‹</p><pre><code>model=tf.keras.Sequential(        [            tf.keras.layers.InputLayer(input_shape=(IMG_HEIGHT,IMG_WIDTH, 3)),            tf.keras.layers.Conv2D(filters=32, kernel_size=3, strides=(2, 2), activation='relu'),            tf.keras.layers.Conv2D(filters=64, kernel_size=3, strides=(2, 2), activation='relu'),            tf.keras.layers.Flatten(),            tf.keras.layers.Dense(6)        ])encoder.compile(optimizer='rmsprop', loss='sparse_categorical_crossentropy', metrics=['accuracy'])</code></pre><p>æˆ‘ä»¬æœ€ç»ˆè°ƒæ•´æ•°æ®é›†æ¥è®­ç»ƒæ¨¡å‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Numpyæ•°ç»„ä½œä¸ºè¾“å…¥</p><pre><code>history = model.fit(x=np.array(PIL_img_data, np.float32), y=np.array(list(map(int,target_val)), np.float32), epochs=5)</code></pre><p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨tf.cast()å°†è¾“å…¥æ•°æ®è½¬æ¢ä¸ºå¼ é‡æ¥è®­ç»ƒæ¨¡å‹ã€‚</p><pre><code>history = model.fit(x=tf.cast(np.array(PIL_img_data), tf.float64), y=tf.cast(list(map(int,target_val)),tf.int32), epochs=5)</code></pre><p>é™¤äº†å‡ ä¸ªæ­¥éª¤å¤–ï¼Œä½¿ç”¨CV2å’ŒPILåŠ è½½æ•°æ®é›†çš„è¿‡ç¨‹æ˜¯ç›¸åŒçš„ã€‚</p><p>ç°åœ¨è¿™å°†å¸®åŠ©ä½ ä½¿ç”¨CV2å’ŒPILåº“åŠ è½½æ•°æ®é›†ã€‚</p><p>è¿™é‡Œæä¾›äº†ä½¿ç”¨CV2å’ŒPILåŠ è½½æ•°æ®é›†çš„ä»£ç ï¼šhttps://github.com/arshren/Load_Dataset</p><p>åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹çš„åº“æ¥åŠ è½½æ•°æ®é›†ã€‚</p><ul><li><strong>Keras</strong></li><li><strong>tf.data</strong></li></ul></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'å­¦ä¹ ','åŠ è½½','ä¹‰å›¾'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>