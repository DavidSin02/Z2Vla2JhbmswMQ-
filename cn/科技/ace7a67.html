<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>5种方法，快速地将多个符合条件的内容归类至一个单元格中 | 极客快訊</title><meta property="og:title" content="5种方法，快速地将多个符合条件的内容归类至一个单元格中 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/8fd281e705c540a093b6f017df85cde3"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ace7a67.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ace7a67.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/ace7a67.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ace7a67.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ace7a67.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/ace7a67.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/ace7a67.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ace7a67.html><meta property="article:published_time" content="2020-10-29T20:52:20+08:00"><meta property="article:modified_time" content="2020-10-29T20:52:20+08:00"><meta name=Keywords content><meta name=description content="5种方法，快速地将多个符合条件的内容归类至一个单元格中"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/ace7a67.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>5种方法，快速地将多个符合条件的内容归类至一个单元格中</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>在前几期的文章中，小必老师给大家讲解了如何使用Power Query的功能将具有相同属性/类型的单元格归纳到一个单元格中，并用间隔符将其隔开。对于这个问题呢，其实还有很多种方法，经小必老师不断地积累与思考，最终给大家归纳了五种归纳的方法，这5种方法从简单到一般，能适合每个Excel学习者及爱好者，分别是：</p><ul><li>辅助列+VLOOKUP归纳法</li><li>辅助列+LOOKUP归纳法</li><li>TEXTJOIN函数法</li><li>Excel Power Query方法</li><li>Excel Power Pivot方法</li></ul><p style=text-align:justify><br></p><p style=text-align:justify>下面是一张各个部门的人员明细表：</p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8fd281e705c540a093b6f017df85cde3><p class=pgc-img-caption></p></div><p style=text-align:justify>根据领导的要求呢，要把每个部门的人员放到一起，还要进行要数的统计，结果如下图所示：</p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/243eecf0f29a453bb2d25fe610754ca7><p class=pgc-img-caption></p></div><p style=text-align:justify><br></p><p><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#f07052;--tt-darkmode-bgcolor: #F07052">方法01</span></span></strong></p><p><br></p><p><strong>VLOOKUP函数+辅助列</strong></p><p style=text-align:justify><br></p><p style=text-align:justify>具体的操作方法如下：</p><p style=text-align:justify><strong>Step-01</strong>：选中A列的任意一个单元格，单击【数据】，选择任意一个方式进行排序（升序与降序都行），如下图所示：</p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/9cacaea44f1e4950a209d8b04ffcf51e><p class=pgc-img-caption></p></div><p style=text-align:justify><strong>注意</strong>：此处的排序是相当地重要的一个步骤，如果不排序那么后面的步骤的结果就不能正常地显示。</p><p style=text-align:justify><br></p><p style=text-align:justify><strong>Step-02</strong>：在C列建立一个辅助列，在C2单元格中输入公式：</p><p style=text-align:justify><strong>=B2&IFERROR("，"&VLOOKUP(A2,A3:C$17,3,0),"")</strong>，按确定键后向下填充。</p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1cbce66b86c14a12b188358d12b3ba73><p class=pgc-img-caption></p></div><p style=text-align:justify><strong>注意</strong>：上述公式中的<strong>A3:C$17</strong>一定在注意，就是在查询的区域一定是数据区域最后一行的下一行，那怕是多一行都行，多几行也无所谓，但是就是不能少，同时要对行标进行锁定，即在行标上加上"$"符号，如上述公式中的<strong>C$17</strong>。如果是第二行的公式，那么就从第三行的区域开始选取，如<strong>A3</strong>。</p><p style=text-align:justify><strong>解析</strong>：上述题目中使用VLOOKUP函数从当前行的下一次开始查找，如果有查找到的内容，就用”，“连接，如果没有就为空白。</p><p style=text-align:justify><br></p><p style=text-align:justify><strong>Step-03</strong>：在F12单元格中正常使用公式：<strong>=VLOOKUP(E7,A:C,3,0)</strong>，按确定键后向下填充即可得到。</p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b37f0aa0b47c4fe88eed40cf312470a6><p class=pgc-img-caption></p></div><p style=text-align:justify><span style="color:#ff4c00;--tt-darkmode-color: #FF4C00">温馨提示：除了VLOOKUP函数，LOOKUP函数也能完成上述的问题。见方法02.</span></p><p style=text-align:justify><span style="color:#ff4c00;--tt-darkmode-color: #FF4C00"><br></span></p><p style=text-align:justify><br></p><p><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#f07052;--tt-darkmode-bgcolor: #F07052">方法02</span></span></strong></p><p><br></p><p><strong><span style="background-color:#efefef;--tt-darkmode-bgcolor: #222222">LOOKUP函数+辅助列</span></strong></p><p style=text-align:justify><br></p><p style=text-align:justify>具体的操作方法如下：</p><p style=text-align:justify><strong>Step-01</strong>：选中A列的任意一个单元格，单击【数据】，选择任意一个方式进行排序（升序与降序都行），如下图所示：</p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/9cacaea44f1e4950a209d8b04ffcf51e><p class=pgc-img-caption></p></div><p style=text-align:justify><strong>注意</strong>：此处的排序是相当地重要的一个步骤，如果不排序那么后面的步骤的结果就不能正常地显示。</p><p style=text-align:justify><br></p><p style=text-align:justify><strong>Step-02</strong>：在C列建立一个辅助列，在C2单元格中输入公式：</p><p style=text-align:justify><strong>=IF(A2=A1,C1&"，"&B2,B2)</strong>，按确定键后向下填充。</p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e6e22f5492da4f18943277bd30dde705><p class=pgc-img-caption></p></div><p style=text-align:justify><strong>Step-03</strong>：在F12单元格中正常使用公式：</p><p style=text-align:justify><strong>=LOOKUP(1,0/(E7=$A$2:$A$16),$C$2:$C$16)</strong>，按确定键后向下填充即可得到。</p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ac9b08bf1d8d47a7ac6c2afdb5d8bb91><p class=pgc-img-caption></p></div><p style=text-align:justify>注意：关于以上公式的意义在这里再不给大家做过多的解释，只要大家记住套路即可。以上公式的用法属于公式的高阶用法。</p><p style=text-align:justify><br></p><p><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#f07052;--tt-darkmode-bgcolor: #F07052">方法03</span></span></strong></p><p><br></p><p><strong>TEXTJION+IF函数组合</strong></p><p style=text-align:justify><br></p><p style=text-align:justify>具体的操作方法如下：</p><p style=text-align:justify>在E7单元格中输入公式：{=TEXTJOIN("，",1,IF(D7=A:A,B:B,""))}，按组合键&lt;Ctrl+Shift+Enter>完成填充。如下图所示：</p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7ea363bf96cc441c8ca62f64cd764727><p class=pgc-img-caption></p></div><p style=text-align:justify>注意：对于以上公式的两边的大括号不是手动添加上去的，而是通过按组合键自动加上的，表示数组公式，但是加大括号的不一定是数组公式。另外，以上函数只在EXcel2019版本及Office365版本中才有的功能。</p><p style=text-align:justify><br></p><p><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#f07052;--tt-darkmode-bgcolor: #F07052">方法04</span></span></strong></p><p><br></p><p><strong>Excel Power Query</strong></p><p style=text-align:justify><br></p><p style=text-align:justify>除了以上的三种方法以外呢，还有更好的方法。那就是Power Query的方法。</p><p style=text-align:justify>具体的操作方法如下：</p><p style=text-align:justify><strong>Step-01</strong>：选中任意一个单元格，单击【数据】-【从表格/区域】，在弹出的对话框中选择【表包含行标题】-【确定】，如下图所示：</p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/082445bf8e224866945bc86b883c9f85><p class=pgc-img-caption></p></div><p style=text-align:justify><strong><br></strong></p><p style=text-align:justify><strong>Step-02</strong>：在弹出的界面中选择【分组依据】，在弹出的对话框中的【分组依据】中选择“部门”，在【操作】里选择“求和”，在【柱】里选择“姓名”，如下图所示：</p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4334641aa07a4366908c77366d04ec17><p class=pgc-img-caption></p></div><p style=text-align:justify><strong><br></strong></p><p style=text-align:justify><strong>Step-03</strong>：然后将原公式：</p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4dccd080c0b34bae8d6fd1d81ece5c10><p class=pgc-img-caption></p></div><pre><code>= Table.Group(更改的类型, {"部门"}, {{"计数", each List.Sum([姓名]), type text}})</code></pre><p style=text-align:justify>修改为：</p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/69caac0597fa4290be1e6fc478500301><p class=pgc-img-caption></p></div><pre><code>= Table.Group(更改的类型, {"部门"}, {{"计数", each Text.Combine([姓名],","), type text}})</code></pre><p style=text-align:justify>然后按Enter键确定即可。结果如上。</p><p style=text-align:justify><strong><br></strong></p><p style=text-align:justify><strong>Step-04</strong>：单击【关闭并上载至】，在弹出的对话框中选择要存放的位置。此步过程略过。全部的具体的操作见下面的动态图演示。</p><p style=text-align:justify><br></p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0f2db36cb49f40619c62244388a9f580><p class=pgc-img-caption></p></div><p style=text-align:justify><strong>注意</strong>：该方法的好处就是如果有新的数据增加或者减少的时候可以自动刷新一劳永逸的方法。上面用到了PQ的专属函数即M函数。在写M公式的时候一定要区分大小写。</p><p style=text-align:justify><br></p><p style=text-align:justify><br></p><p><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#f07052;--tt-darkmode-bgcolor: #F07052">方法05</span></span></strong></p><p><br></p><p><strong>Excel Power Pivot</strong></p><p style=text-align:justify><br></p><p style=text-align:justify>还有一种方法同Power Query是一样的神奇，那就是使用Power Pivot。具体方法如下：</p><p style=text-align:justify><strong>准备工作</strong>：如果没有【开发工具】选项卡的小伙伴们，右击任意一个选项卡，单击【自定义功能区】，在弹出的对话框中选择 【主选项卡】，在右边的选项中勾选【开发工具】，最后单击【确定】即可。如果没有有【开发工具】没有加载Power Pivot的小伙伴们可以单击【开发工具】下面的【COM加载项】，在弹出的对话框中选择【Microsoft Power Pivot for Excel】，然后单击【确定】，如下图所示：</p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/90647e0db311441c85cc78d1d5cd4d53><p class=pgc-img-caption></p></div><p style=text-align:justify><br></p><p style=text-align:justify><strong>Step-01</strong>：选中任意一个单元格，单击【数据】-【Powe Pivot】-【添加到数据模型】，如下图所示：</p><p style=text-align:justify><br></p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/99eff69c590642f7948bd403bfcbf7d4><p class=pgc-img-caption></p></div><p style=text-align:justify><br></p><p style=text-align:justify><strong>Step-02</strong>：在公式编辑栏中输入公式，按enter键完成。如下图所示：</p><pre><code>=CONCATENATEX('表2','表2'[姓名],"，")</code></pre><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/728ae70d9c3343ba852b18be4f61576c><p class=pgc-img-caption></p></div><p style=text-align:justify><br></p><p style=text-align:justify><strong>Step-03</strong>：然后单击【插入】-【数据透视表】，在弹出的对话框中选择【使用此工作簿】</p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8ce59e457016414b9f869f6a18866c8b><p class=pgc-img-caption></p></div><p style=text-align:justify><strong><br></strong></p><p style=text-align:justify><strong>Step-04</strong>：将“部门”拖放至【行】，将“度量值1”拖放至【值】，设计表格布局中取消行列合计，如下图所示：</p><p style=text-align:justify><br></p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4fa1d07b63914537abca9f441755229d><p class=pgc-img-caption></p></div><p style=text-align:justify><br></p><p style=text-align:justify>注意：如果有数据的增减修改了的，在透视表的结果中右键刷新即可。具体的操作过程如下图所示：</p><p style=text-align:justify><br></p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/bcf7859c5931409596ffe4546d17e2c7><p class=pgc-img-caption></p></div><p style=text-align:justify><br></p><p style=text-align:justify>以上5种方法呢，需要说明的呢，方法1与方法2都是适用于所有版本的Excel，而方法3是只能在Excel2019版本及Office365的版本中才能做的，因为TEXTJOIN函数属于新增函数；方法4与方法5在Excel2013版本与Excel2010版本中只能通过官方的插件来实现，大家可以在微软的官网上下载相应的插件Power Query for Excel与Power Pivot for Excel的插件，而在Excel2016版本及以上包括Office365的版本都可以在软件内置的功能中找到其功能。</p><p style=text-align:justify></p><p style=text-align:justify><strong>关于方法的选择：</strong></p><p style=text-align:justify><strong><br></strong></p><p style=text-align:justify>1、版本的使用方面：对于使用Excel2019版本以上的小伙伴们可以选择以上的所有的方法，而使用Excel2016版本及其以上的用户可以选择除方法3以外的所有的方法；而对于Excel版本在2010及以上并装有插件Power Pivot插件的可以使用上述除方法3以外的所有的方法；而对于2013版本及其以下的用户（未装有插件）的小伙伴们可以使用方法1与方法2；</p><p style=text-align:justify><br></p><p style=text-align:justify>2、效率优先：对于追求效率方面来说，建议大家使用方法4与方法5，这两种方法可以不用提取同类属性，直接可以使用，而在原始数据胡增减改动的情形下可以直接右键刷新即可，不用拖动更改；但是以上两种方法灵活性较差；</p><p style=text-align:justify><br></p><p style=text-align:justify>3、灵活性方面：对于追求灵活性方面的小伙伴可以使用前三种方法，这三种方法可以灵活地在工作表中进行处理，但是由于添加了辅助列，会造成效率低下，方法3使用了数组函数，在数据量比较大的情况下会出现Excel卡顿的现象。</p><p><br></p><div class=pgc-img><img alt=5种方法，快速地将多个符合条件的内容归类至一个单元格中 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/29028efcd7f94bbaaf5e380e4df6802f><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'地将','多个','条件'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>