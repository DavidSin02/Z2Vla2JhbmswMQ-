<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>物联网平台开发浅析和实战（一） | 极客快訊</title><meta property="og:title" content="物联网平台开发浅析和实战（一） - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/5164eced74e949afa8e4e3b705315e33"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/aef64093.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/aef64093.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/aef64093.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/aef64093.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/aef64093.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/aef64093.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/aef64093.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/aef64093.html><meta property="article:published_time" content="2020-11-14T21:00:22+08:00"><meta property="article:modified_time" content="2020-11-14T21:00:22+08:00"><meta name=Keywords content><meta name=description content="物联网平台开发浅析和实战（一）"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/aef64093.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>物联网平台开发浅析和实战（一）</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><strong><span style="color:#73777a;--tt-darkmode-color: #73777A"><span style="background-color:#f9f9f9;--tt-darkmode-bgcolor: #181818">简介：</span></span></strong><span style="color:#73777a;--tt-darkmode-color: #73777A"><span style="background-color:#f9f9f9;--tt-darkmode-bgcolor: #181818"> 物联网平台使用教程，包括设备接入，以及消息通信。</span></span></p><h1 class=pgc-h-arrow-right>1、前言</h1><p>内容：物联网平台概论、设备接入以及消息通信 官网地址<br>时长：建议学习时长整体50分钟，理论40分钟，实战10分钟<br>代码：设备端demo、服务端demo<br>约定：物联网平台已经开通并登陆 https://iot.console.aliyun.com<br>导航：下一课</p><h1 class=pgc-h-arrow-right>2、概论</h1><h1 class=pgc-h-arrow-right>2.1、物联网平台是什么、能干什么</h1><p>阿里云物联网平台为设备提供安全可靠的连接通信能力，向下连接海量设备，支撑设备数据采集上云；向上提供Open API，服务端通过调用Open API将指令下发至设备端，实现远程控制。<br>物联网平台也提供了其他增值能力，如设备管理、规则引擎等，为各类IoT场景和行业开发者赋能。</p><div class=pgc-img><img alt=物联网平台开发浅析和实战（一） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5164eced74e949afa8e4e3b705315e33><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>2.2、设备接入</h1><p>物联网平台支持海量设备连接上云，进行稳定可靠的双向通信。<br>• 支持蜂窝（2G/3G/4G/5G）、NB-IoT、LoRaWAN、Wi-Fi等不同网络设备接入，解决企业异构网络设备接入管理痛点。<br>• 支持MQTT、CoAP、HTTP/S等多种协议的接入，既满足长连接的实时性需求，也满足短连接的低功耗需求。<br>• 开源多种平台设备端SDK，提供跨平台移植指导，赋能企业基于多种平台做设备接入。</p><h1 class=pgc-h-arrow-right>2.3、设备管理</h1><p>物联网平台提供完整的设备生命周期管理功能，支持设备注册、功能定义、数据解析、在线调试、远程配置、固件升级、远程维护、实时监控、分组管理、设备删除等功能。<br>• 提供设备物模型，简化应用开发。<br>• 提供数据存储能力，方便用户海量设备数据的存储及实时访问。<br>• 提供OTA升级能力，赋能设备远程升级。<br>• 提供设备电子缓存机制，将设备与应用解耦，解决不稳定网络下的通信不可靠痛点。</p><h1 class=pgc-h-arrow-right>2.4、规则引擎</h1><p>物联网平台规则引擎包含以下功能：<br>• 服务端订阅：订阅某产品下所有设备的某个或多个类型消息，您的服务端可以通过AMQP客户端或消息服务（MNS）客户端获取订阅的消息。<br>• 云产品流转：物联网平台根据您配置的数据流转规则，将指定Topic消息的指定字段流转到目的地，进行存储和计算处理。<br>• 场景联动：配置简单规则，即可将设备数据无缝流转至其他设备，实现设备联动。</p><h1 class=pgc-h-arrow-right>2.5、Open API</h1><p>物联网平台提供丰富的API接口，方便您管理设备或者给设备发送控制指令。同样的，Open API 也有多种语言版本的SDK。</p><h1 class=pgc-h-arrow-right>3、基础概念</h1><h1 class=pgc-h-arrow-right>3.1、设备三元组</h1><p>• 一个设备包含4个信息：productKey、productSecret、deviceName、deviceSecret，其中productKey、deviceName、deviceSecret我们称为三元组信息，也叫做设备证书，在创建设备时由物联网平台颁发。<br>• productKey、productSecret 是产品信息，产品是一类设备的集合，productKey 是产品的唯一性标识符，productSecret 是产品密钥，后面动态注册会用到。<br>• deviceName、deviceSecret 是设备信息，创建产品后创建设备，productKey+deviceName 是设备的唯一性标识符，deviceSecret 是设备密钥，设备接入时进行身份验证要用到。<br>• 三元组这个概念是我们在使用物联网平台的过程中一直会出现的概念，也是阿里云iot最重要、最基础的概念。三元组是平台唯一的，是物联网平台识别一个设备的重要标识。</p><h1 class=pgc-h-arrow-right>3.2、接入协议</h1><p>物联网平台支持MQTT、CoAP、HTTP/S等多种协议的接入，其中MQTT是使用最广泛的一种接入协议，本次讲解设备接入就是基于MQTT来接入的。<br>MQTT 接入的几个概念<br>• host：设备接入的域名，${YourProductKey}.iot-as-mqtt.${YourRegionId}.aliyuncs.com:1883<br>• keepalive：心跳时间，30秒~1200秒，物联网平台 1.5 倍心跳时间内没有收到心跳会断开设备连接<br>• cleanSession：会话清除，0 或 1，设置为 1 时无法接收离线消息</p><div class=pgc-img><img alt=物联网平台开发浅析和实战（一） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a6e173201d0b4526902820ca30e1f165><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>3.3、通信机制</h1><p>MQTT 是基于对 topic 的订阅和发布（sub／pub）来通信的。<br>• topic：物联网平台提供 topic 定义功能，用户可以自定义topic的字段，也可以使用平台默认定义好的topic。消息发布者往topic发送消息，消息订阅者从topic接收消息，两者是异步的。物联网平台的topic包含productKey和deviceName，所以可以做到设备粒度的权限控制。设备只能往自己的topic发布消息，也只能订阅自己的topic。topic有发布权限和订阅权限，这个是针对设备视角的。<br>• qos：消息质量，物联网平台支持 qos=0 和 qos=1 的消息质量。qos=0 意味着消息最多到达一次，可能丢失，设备离线无法接收；qos=1 意味着消息至少到达一次，可能收到多次，设备离线期间的消息在设备上线后可以接收到。当设备端接入时设置了cleanSession=1，那么即使qos=1的消息，设备重新上线后也是收不到的。</p><div class=pgc-img><img alt=物联网平台开发浅析和实战（一） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/05fdf90156594924a900887ed8770fb5><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>4、设备接入及消息通信</h1><p>本例将完成如下步骤，涉及的demo代码包通过课程【前言】提供的链接下载即可。开发环境的搭建不再赘述，是普通 maven 工程。<br>设备端代码：com.aliyun.alink.demo.devicesdk.chapter01.HelloWorld<br>服务端代码：com.aliyun.alink.demo.openapi.chapter01.MessageDownlink<br>• 创建一个产品，名为：一个HelloWorld<br>• 创建一个设备，名为：device_0<br>• 使用设备端SDK让设备 device_0 上线<br>• 使用设备端SDK让设备 device_0 发送消息给物联网平台<br>• 使用 Open API 发送消息给设备 device_0</p><h1 class=pgc-h-arrow-right>4.1、创建产品</h1><p>官网文档：https://help.aliyun.com/document_detail/73728.html</p><div class=pgc-img><img alt=物联网平台开发浅析和实战（一） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/27434725c1ce4ab7ad49401996fc0055><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>4.2、创建设备</h1><p>官网文档：https://help.aliyun.com/document_detail/73729.html</p><div class=pgc-img><img alt=物联网平台开发浅析和实战（一） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c5ddf1c67fff4735901750cf252c7bf4><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>4.3、设备端 SDK 接入</h1><p>启动：com.aliyun.alink.demo.devicesdk.chapter01.HelloWorld，填写设备三元组信息后直接启动。<br>整体流程：初始化设备信息-->注册下行监听-->初始化SDK-->等待初始化完成-->订阅topic。<br>注意：最后一步订阅的topic是/${productKey}/${deviceName}/user/get，下面 Open API 消息下行要用到。</p><div class=pgc-img><img alt=物联网平台开发浅析和实战（一） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5c091e4805af4a99b3aff27a94735750><p class=pgc-img-caption></p></div><p><br>设备状态：<br>• 未激活：设备刚创建，从来没有连接过平台是未激活状态；设备连接到平台即可激活<br>• 在线：设备和平台建立连接<br>• 离线：设备从平台断开连接</p><h1 class=pgc-h-arrow-right>4.4、设备端 SDK 消息上报</h1><p>接上一步，设备端调用publish接口上报消息，本例发送的topic=/${productKey}/${deviceName}/user/update，消息内容为 hello iot。<br>整体流程：初始化设备信息-->注册下行监听-->初始化SDK-->等待初始化完成-->发布消息到topic<br>发送消息后查看日志。</p><div class=pgc-img><img alt=物联网平台开发浅析和实战（一） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/51b9306244534a54b37c3d35bd9db5d6><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>4.5、Open API 消息下行</h1><p>启动：com.aliyun.alink.demo.openapi.chapter01.MessageDownlink，填写账号信息和设备信息后直接启动。<br>整体流程：初始化账号信息-->初始化SDK-->发送消息给设备。<br>本例发送的topic=/${productKey}/${deviceName}/user/get，消息内容为 hello world。<br>发送消息后查看日志。</p><div class=pgc-img><img alt=物联网平台开发浅析和实战（一） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ac924de35dd64349b5044329d947ef22><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>5、开源接入</h1><p>针对不能够使用物联网平台提供的 SDK 来完成设备接入和消息通信的用户，物联网平台也提供了开源 MQTT SDK 接入以及基于 http 请求的 Open API 调用的指导。</p><h1 class=pgc-h-arrow-right>5.1、基于开源 paho 的设备端接入</h1><p>官网文档 https://help.aliyun.com/document_detail/73742.html</p><h1 class=pgc-h-arrow-right>5.2、基于 http 请求的 Open API 调用</h1><p>官网文档 https://help.aliyun.com/document_detail/30560.html</p><h1 class=pgc-h-arrow-right>6、总结</h1><p>本次课程对物联网平台及部分基础概念做了简单的介绍，对设备接入、设备消息上报（绿色线路）、Open API 消息下行（蓝色线路）的开发链路做了详细的说明。实现了一个最基本的物联网场景。</p><div class=pgc-img><img alt=物联网平台开发浅析和实战（一） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a1c165b76c414ff1a4cb6fb54e9eaff2><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>7、后续</h1><p>• 设备通过物联网平台上报了消息，那么消息如何展示到我的网页上呢？<br>• 设备只能往自己的topic发送消息，那么设备A如何发送消息给设备B呢？</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'物联','网平','开发'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../cn/%E7%A7%91%E6%8A%80/4229d006.html alt=物联网平台开发难学吗？掌握ESP32帮你1分钟入门 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/S1wjiRNGzTjXG9 style=border-radius:25px></a>
<a href=../../cn/%E7%A7%91%E6%8A%80/4229d006.html title=物联网平台开发难学吗？掌握ESP32帮你1分钟入门>物联网平台开发难学吗？掌握ESP32帮你1分钟入门</a></li><hr><li><a href=../../cn/%E7%A7%91%E6%8A%80/aa8360e3.html alt=物联网平台开发浅析和实战（二） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3e8b4b8b8ebd498b81b2057ac76ddd1b style=border-radius:25px></a>
<a href=../../cn/%E7%A7%91%E6%8A%80/aa8360e3.html title=物联网平台开发浅析和实战（二）>物联网平台开发浅析和实战（二）</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>