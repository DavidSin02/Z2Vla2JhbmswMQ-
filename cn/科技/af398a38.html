<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Springâ€”é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰è¯¦è§£ | æå®¢å¿«è¨Š</title><meta property="og:title" content="Springâ€”é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰è¯¦è§£ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/dfic-imagehandler/3ad8b3ec-d7c5-4b89-9b46-e473a4f5d570"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/af398a38.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/af398a38.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/af398a38.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/af398a38.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/af398a38.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/af398a38.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/af398a38.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/af398a38.html><meta property="article:published_time" content="2020-11-14T21:04:29+08:00"><meta property="article:modified_time" content="2020-11-14T21:04:29+08:00"><meta name=Keywords content><meta name=description content="Springâ€”é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰è¯¦è§£"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/af398a38.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Springâ€”é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰è¯¦è§£</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><pre>ä½œè€…ï¼šæˆ‘è¦è¿›é˜¿é‡Œï¼åŸæ–‡ï¼šhttps://www.cnblogs.com/liuhongchen/p/11580319.html?utm_source=tuicool&amp;utm_medium=referral</pre><p>å£°æ˜ï¼šæœ¬é—®ä»…ä»…æ˜¯ä¸€ä¸ªåˆå­¦è€…çš„å­¦ä¹ è®°å½•ã€å¿ƒå¾—æ€»ç»“ï¼Œå…¶ä¸­è‚¯å®šæœ‰è®¸å¤šé”™è¯¯ï¼Œä¸å…·æœ‰å‚è€ƒä»·å€¼ï¼Œæ¬¢è¿å¤§ä½¬æŒ‡æ­£ï¼Œè°¢è°¢ï¼</p><div class=pgc-img><img alt=Springâ€”é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰è¯¦è§£ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/3ad8b3ec-d7c5-4b89-9b46-e473a4f5d570><p class=pgc-img-caption></p></div><p><strong>ä¸€ã€é—®é¢˜å¼•å…¥</strong></p><p>â€‹ åœ¨æ—¥å¸¸å†™é¡¹ç›®çš„æ—¶å€™ï¼Œè‚¯å®šå°‘ä¸äº†è¦æ‰“å°æ—¥å¿—ã€‚ä¾‹å¦‚ï¼Œè¦å‘æ•°æ®åº“ä¸­insertä¸€ä¸ªç”¨æˆ·ï¼Œæˆ‘æƒ³åœ¨æ’å…¥å‰è¾“å‡ºä¸€ä¸‹ç›¸å…³ä¿¡æ¯ï¼Œæ€ä¹ˆå®ç°å‘¢ï¼Ÿæœ€åŸºæœ¬çš„åšæ³•æ˜¯ï¼šåœ¨insertæ–¹æ³•ä¸­å†™æ—¥å¿—è¾“å‡ºè¯­å¥ã€‚è¿™æ ·å†™å®Œå…¨èƒ½å®ç°åŠŸèƒ½ï¼Œä½†æ˜¯ä¼šä¸ä¼šæ˜¾å¾—å¾ˆå†—ä½™ï¼Ÿè€¦åˆåº¦æ˜¯ä¸æ˜¯å¾ˆé«˜ï¼Ÿç¼–ç¨‹çš„å‡†åˆ™æ˜¯â€œé«˜å†…èšï¼Œä½è€¦åˆâ€ï¼Œä½è€¦åˆçš„æ„æ€å°±æ˜¯ç±»ä¸ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»å°½é‡å°‘ã€å…³è”ç¨‹åº¦å°½é‡å°ã€‚</p><p>â€‹ è€Œå¦‚æœåœ¨ä¸Šè¿°æƒ…æ™¯ä¸­ä½¿ç”¨é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰ï¼Œå°±å¯ä»¥ä¸åœ¨insertæ–¹æ³•ä¸­å†™æ—¥å¿—è¾“å‡ºè¯­å¥å´èƒ½å®ç°æ—¥å¿—è¾“å‡ºåŠŸèƒ½ã€‚å½“ç„¶ï¼ŒAOPä¸æ­¢å¦‚æ­¤ã€‚</p><p><strong>äºŒã€æ¦‚å¿µå¼•å…¥</strong></p><p><strong>1.AOP</strong></p><p>åœ¨è½¯ä»¶ä¸šï¼ŒAOPä¸ºAspect Oriented Programmingçš„ç¼©å†™ï¼Œæ„ä¸ºï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé€šè¿‡é¢„ç¼–è¯‘æ–¹ å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°ç¨‹åºåŠŸèƒ½çš„ç»Ÿä¸€ç»´æŠ¤çš„ä¸€ç§æŠ€æœ¯ã€‚AOPæ˜¯OOPçš„å»¶ç»­ï¼Œæ˜¯è½¯ä»¶å¼€å‘ä¸­çš„ä¸€ä¸ª çƒ­ç‚¹ï¼Œä¹Ÿæ˜¯Springæ¡†æ¶ä¸­çš„ä¸€ä¸ªé‡è¦å†…å®¹ï¼Œæ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ç§è¡ç”ŸèŒƒå‹ã€‚åˆ©ç”¨AOPå¯ä»¥å¯¹ä¸šåŠ¡é€»è¾‘ çš„å„ä¸ªéƒ¨åˆ†è¿›è¡Œéš”ç¦»ï¼Œä»è€Œä½¿å¾—ä¸šåŠ¡é€»è¾‘å„éƒ¨åˆ†ä¹‹é—´çš„è€¦åˆåº¦é™ä½ï¼Œæé«˜ç¨‹åºçš„å¯é‡ç”¨æ€§ï¼ŒåŒæ—¶æé«˜ äº†å¼€å‘çš„æ•ˆç‡ã€‚</p><p><strong>2.å‡ ä¸ªåŸºæœ¬æ¦‚å¿µ</strong></p><pre>- åˆ‡å…¥ç‚¹ï¼šæ‰€æœ‰è¦æ“ä½œçš„æ–¹æ³•å®šä¹‰ï¼Œè¦æ±‚ä¸šåŠ¡å±‚æ–¹æ³•é£æ ¼ç»Ÿä¸€- åˆ†ç¦»ç‚¹ï¼šå°†ä¸å¯åˆ†å‰²çš„ç»„ä»¶å•ç‹¬æå–å‡ºå»å®šä¹‰ä¸ºå•ç‹¬çš„æ“ä½œåŠŸèƒ½- æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼šå°†æ‰€æœ‰ä¸å¼€å‘æ— å…³çš„ç¨‹åºç»„æˆç±»å•ç‹¬æå–åç»„ç»‡è¿è¡Œ- ç»‡å…¥ï¼šå°†æ‰€æœ‰åˆ‡å…¥ç‚¹ã€å…³æ³¨ç‚¹çš„ä»£ç ç»„æˆåœ¨ä¸€å¼ å®Œæ•´çš„ç¨‹åºç»“æ„ä¸­</pre><p><strong>3.é€šçŸ¥ï¼ˆAdviceï¼‰</strong></p><p>â€‹ AOPæ˜¯é€šè¿‡é€šçŸ¥æ¥å®ç°åŠŸèƒ½çš„ï¼Œæœ‰å¦‚ä¸‹äº”ç§ï¼š</p><ul><li>å‰ç½®é€šçŸ¥ï¼ˆBeforeAdviceï¼‰</li><li>åç½®é€šçŸ¥ï¼ˆAfterAdviceï¼‰</li><li>åç½®è¿”å›é€šçŸ¥ï¼ˆAfterReturningAdviceï¼‰</li><li>åç½®å¼‚å¸¸é€šçŸ¥ï¼ˆAfterThrowingAdviceï¼‰</li><li>ç¯ç»•é€šçŸ¥ï¼ˆAroundAdviceï¼‰</li></ul><p><strong>ä¸‰ã€Pointcutä¸Executionè¡¨è¾¾å¼</strong></p><p>â€‹ pointcutä½¿ç”¨executionè¡¨è¾¾å¼è¡¨ç¤ºè¦è¢«åˆ‡å…¥çš„æ–¹æ³•ï¼ˆå³å®šä¹‰åˆ‡å…¥ç‚¹ï¼‰ã€‚</p><p>â€‹ executionè¡¨è¾¾å¼ï¼ŒåŠŸèƒ½ç±»ä¼¼äºæ­£åˆ™è¡¨è¾¾å¼ï¼Œéƒ½æ˜¯ç”¨æ¥åŒ¹é…ç­›é€‰ï¼Œåªä¸è¿‡æ­£åˆ™è¡¨è¾¾å¼ç”¨æ¥ç­›é€‰å­—ç¬¦ä¸²ï¼Œè€Œexecutionè¡¨è¾¾å¼ç”¨æ¥ç­›é€‰è¦è¢«åˆ‡å…¥çš„æ–¹æ³•ã€‚</p><p>â€‹ executionè¡¨è¾¾å¼çš„æ ¼å¼ä¸ºï¼š</p><p>â€‹ execution(&lt;æ³¨è§£>? &lt;ä¿®é¥°ç¬¦>? &lt;è¿”å›å€¼ç±»å‹> &lt;æ–¹æ³•åæ¨¡å¼>(&lt;å‚æ•°æ¨¡å¼>) &lt;å¼‚å¸¸>?)) &lt;and args()>?)</p><p>â€‹ ä¾‹ï¼š execution(@Deprecated public Void aop.MyAspect.hello(int,String) throws Exception))')</p><pre>package aop;public class AspectDemo { @Deprecated public void hello(int i,String s) throws Exception{ }}</pre><p>â€‹ å…¶å®ä¸éš¾å‘ç°ï¼Œè¿™ä¸ªè¡¨è¾¾å¼å’Œæˆ‘ä»¬å£°æ˜çš„æ–¹æ³•çš„å„ä¸ªéƒ¨åˆ†ä¸€ä¸€å¯¹åº”</p><ul><li>æ³¨è§£ï¼šï¼ˆå¯çœç•¥ï¼‰ä¾‹å¦‚ä¸Šé¢ä»£ç ä¸­çš„ @Deprecated ï¼Œå°±æ˜¯ç­›é€‰å¸¦æœ‰è¯¥æ³¨è§£çš„æ–¹æ³•</li><li>ä¿®é¥°ç¬¦ï¼ˆå¯çœç•¥ï¼‰</li><li class=ql-indent-1>public</li><li class=ql-indent-1>protected</li><li class=ql-indent-1>private</li><li>å½“ç„¶ä¸€èˆ¬ç”¨é€šé…ç¬¦ *</li><li>è¿”å›å€¼ç±»å‹</li><li>å†™å„ç§è¿”å›å€¼ï¼Œä¸€èˆ¬ç”¨é€šé…ç¬¦ *</li><li>æ–¹æ³•åæ¨¡å¼</li><li>åŒ…åéƒ¨åˆ†ï¼šåœ¨ä¸Šä¾‹ä¸­ï¼ŒAspectDemoæ˜¯ä½äºaopåŒ…ä¸­çš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡åŒ…å.åŒ…å.ç±»åçš„æ ¼å¼æ¥å®šä½åˆ°æŸä¸ªç±»ï¼Œä¾‹å¦‚aop.AspectDemo ä¸­aop. å°±æ˜¯åŒ…åéƒ¨åˆ†;</li><li>å½“ç„¶ä¹Ÿå¯ä»¥ç”¨é€šé…ç¬¦</li><li class=ql-indent-2>*ï¼šåŒ¹é…ä»»ä½•æ•°é‡å­—ç¬¦ï¼Œä¾‹å¦‚service.*.UserService è¡¨ç¤ºçš„æ˜¯serviceçš„ç›´æ¥å­åŒ…</li><li class=ql-indent-2>..ï¼šåŒ¹é…ä»»ä½•æ•°é‡å­—ç¬¦çš„é‡å¤ï¼Œå¦‚åœ¨ç±»å‹æ¨¡å¼ä¸­åŒ¹é…ä»»ä½•æ•°é‡å­åŒ…ï¼Œä¾‹å¦‚service..ä»£è¡¨ç€åŒ¹é…serviceåŠå…¶åŒ…å«çš„æ‰€æœ‰åŒ…ï¼›è€Œåœ¨æ–¹æ³•å‚æ•°æ¨¡å¼ä¸­åŒ¹é…ä»»ä½•æ•°é‡å‚æ•°ã€‚</li><li class=ql-indent-1><strong>+ï¼š</strong> åŒ¹é…æŒ‡å®šç±»å‹çš„å­ç±»å‹ï¼›ä»…èƒ½ä½œä¸ºåç¼€æ”¾åœ¨ç±»å‹æ¨¡å¼åè¾¹ï¼Œä¾‹å¦‚java.lang.Number+ è¡¨ç¤ºçš„æ˜¯langåŒ…ä¸‹Numerçš„å­ç±»</li><li class=ql-indent-1>ç±»åéƒ¨åˆ†ï¼šåœ¨ä¸Šä¾‹ä¸­aop.AspectDemoä¸­aop.æ˜¯åŒ…åéƒ¨åˆ†ï¼ŒAspectDemoå°±æ˜¯ç±»åéƒ¨åˆ†ï¼Œå¯ä»¥ç”¨é€šé…ç¬¦æ¥è¡¨ç¤ºï¼Œ*ç”¨çš„æ¯”è¾ƒå¤š</li><li>å‚æ•°æ¨¡å¼</li><li class=ql-indent-1>å†™æ³•1:ç›´æ¥æŒ‰ç…§æ–¹æ³•çš„å‚æ•°åˆ—è¡¨å†™å…·ä½“ç±»å‹ï¼Œä¸Šä¾‹çš„æ–¹æ³•ä¸­å‚æ•°åˆ—è¡¨(int i,String s),å°±å¯ä»¥ç›´æ¥åœ¨è¡¨è¾¾å¼ä¸­å†™(int,String)</li><li>å†™æ³•2:ä½¿ç”¨é€šé…ç¬¦:</li><li class=ql-indent-2>â€œ()â€è¡¨ç¤ºæ–¹æ³•æ²¡æœ‰ä»»ä½•å‚æ•°ï¼›</li><li class=ql-indent-2>â€œ(..)â€è¡¨ç¤ºåŒ¹é…æ¥å—ä»»æ„ä¸ªå‚æ•°çš„æ–¹æ³•</li><li class=ql-indent-2>â€œ(..,java.lang.String)â€è¡¨ç¤ºåŒ¹é…æ¥å—java.lang.Stringç±»å‹çš„å‚æ•°ç»“æŸï¼Œä¸”å…¶å‰è¾¹å¯ä»¥æ¥å—æœ‰ä»»æ„ä¸ªå‚æ•°çš„æ–¹æ³•</li><li class=ql-indent-2>â€œ(java.lang.String,..)â€ è¡¨ç¤ºåŒ¹é…æ¥å—java.lang.Stringç±»å‹çš„å‚æ•°å¼€å§‹ï¼Œä¸”å…¶åè¾¹å¯ä»¥æ¥å—ä»»æ„ä¸ªå‚æ•°çš„æ–¹æ³•</li><li class=ql-indent-1>â€œ(*,java.lang.String)â€ è¡¨ç¤ºåŒ¹é…æ¥å—java.lang.Stringç±»å‹çš„å‚æ•°ç»“æŸï¼Œä¸”å…¶å‰è¾¹æ¥å—æœ‰ä¸€ä¸ªä»»æ„ç±»å‹å‚æ•°çš„æ–¹æ³•ï¼›</li><li>å¼‚å¸¸æ¨¡å¼ï¼ˆå¯çœç•¥ï¼‰</li><li>throws Exception1ï¼ŒException2.ã€‚ã€‚ã€‚</li><li>ä¼ å…¥å‚æ•°ï¼ˆå¯çœç•¥ï¼‰</li><li>â€‹ and args(arg-name),ä¸€èˆ¬ç”¨äºAfterAdviceå’ŒAroundé€šçŸ¥</li></ul><p><strong>å››ã€å‰æœŸå‡†å¤‡</strong></p><ol><li>åˆ›å»ºé¡¹ç›®ï¼Œå¯¼å…¥ç›¸å…³jaråŒ…ï¼Œå‚è€ƒSpringâ€”â€”IOCï¼Œæ­¤å¤–è¿˜éœ€å¯¼å…¥aopå’Œaspectjçš„jaråŒ…</li><li>åˆ›å»ºapplicationContext.xmlæ–‡ä»¶</li></ol><pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:aop="http://www.springframework.org/schema/aop" xsi:schemaLocation=" http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"&gt; &lt;aop:aspectj-autoproxy/&gt;&lt;/beans&gt;</pre><p>â€‹ æ³¨æ„ï¼šæ–°å¢äº†</p><p>â€‹ xmlns:aop="http://www.springframework.org/schema/aop"</p><p>â€‹ http://www.springframework.org/schema/aop</p><p>â€‹ http://www.springframework.org/schema/beans/spring-aop.xsd</p><p>â€‹ &lt;aop:aspectj-autoproxy/> ä¸åŠ è¿™ä¸ªå¯èƒ½ä¼šæŠ¥é”™ï¼Œå¯å‘äº†</p><ol><li>åˆ›å»ºUserServiceè¿™ä¸ªç±»ï¼Œå†…éƒ¨æœ‰insertæ–¹æ³•ç”¨æ¥æ³¨å†Œç”¨æˆ·</li></ol><pre>public class UserService {  public void insert(){ System.out.println("UserServiceæ­£åœ¨æ³¨å†Œç”¨æˆ·â€¦â€¦"); }}</pre><ol><li>åˆ›å»ºMyAspectç±»</li></ol><pre>public class MyAspect {}</pre><p><strong>äº”ã€åŸºäºXMLé…ç½®çš„AOP</strong></p><p><strong>1.BeforeAdvice</strong></p><p>â€‹ (1)åœ¨MyAspectç±»ä¸­åˆ›å»ºæ–¹æ³•beforeAdvice</p><pre>public void beforeAdvice(){ System.out.println("ã€AOPã€‘Before Adviceæ­£åœ¨æ‰§è¡Œâ€¦â€¦"); }</pre><p>â€‹ (2)åœ¨applicationContext.xmlä¸­é…ç½®</p><p>â€‹ <em>å…³äºpointcutå’Œexecutionè¡¨è¾¾å¼è§ä¸‹æ–‡</em></p><pre>&lt;!--é¦–å…ˆè¦å¼•å…¥myAspectè¿™ä¸ªbeanï¼Œå¤‡ç”¨--&gt; &lt;bean id="myAspect" class="aop.MyAspect"/&gt; &lt;bean id="userService" class="aop.UserService"/&gt; &lt;aop:config&gt; &lt;!--é…ç½®åˆ‡é¢ï¼Œä¸€ä¸ªaop:aspectæ ‡ç­¾å¯¹åº”ä¸€ä¸ªAspectç±»--&gt; &lt;aop:aspect id="beforeAdvice" ref="myAspect"&gt; &lt;!--é…ç½®é€šçŸ¥ methodå¯¹åº”MyAspectç±»ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œpointcutæ˜¯åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ç”¨äºç­›é€‰éœ€è¦è¢« åˆ‡å…¥çš„æ–¹æ³•--&gt; &lt;aop:before method="beforeAdvice" pointcut="execution(* aop..*.*(..)))"/&gt; &lt;/aop:aspect&gt; &lt;/aop:config&gt;</pre><p>â€‹ (3)ç¼–å†™æµ‹è¯•ç±»</p><pre>public class UserServiceTest { public static void main(String[] args) { ApplicationContext context= new ClassPathXmlApplicationContext("applicationContext.xml"); UserService userService = context.getBean("userService", UserService.class); userService.insert(); }}</pre><p>â€‹ (4)è¾“å‡ºç»“æœ</p><pre>ã€AOPã€‘Before Adviceæ­£åœ¨æ‰§è¡Œâ€¦â€¦ UserServiceæ­£åœ¨æ³¨å†Œç”¨æˆ·â€¦â€¦</pre><p>â€‹ å¯ä»¥å‘ç°ï¼ŒBeforeAdviceå°±å·²ç»å®ç°äº†</p><p><strong>2.AfterAdviceï¼ˆç›¸å½“äºå¼‚å¸¸é‡Œé¢çš„finallyè¯­å¥ï¼‰</strong></p><p>â€‹ (1)UserServiceç±»åŒä¸Š</p><p>â€‹ (2)åœ¨MyAspectä¸­åˆ›å»ºæ–¹æ³•afterAdvice</p><pre>public void afterAdvice(){ System.out.println("ã€AOPã€‘after Adviceâ€¦â€¦ ä¸ç®¡æ€æ ·æˆ‘éƒ½ä¼šæ‰§è¡Œ");}</pre><p>â€‹ (3)ä¿®æ”¹applicationContext.xml</p><pre>&lt;aop:config&gt; &lt;aop:aspect id="beforeAdvice" ref="myAspect"&gt; &lt;aop:after method="afterAdvice" pointcut="execution(* aop.*.insert(..)))" /&gt; &lt;/aop:aspect&gt;&lt;/aop:config&gt;</pre><p>â€‹ (4)ç¼–å†™æµ‹è¯•ç±»ï¼ˆåŒä¸Šï¼‰</p><p>â€‹ (5)è¾“å‡ºç»“æœ</p><pre>UserServiceæ­£åœ¨æ³¨å†Œç”¨æˆ·â€¦â€¦ã€AOPã€‘after Adviceâ€¦â€¦ ä¸ç®¡æ€æ ·æˆ‘éƒ½ä¼šæ‰§è¡Œ</pre><p><strong>3.AfterReturningAdvice</strong></p><p>â€‹ (1)ä¿®æ”¹UserServiceçš„insertæ–¹æ³•ï¼Œä½¿å…¶æœ‰è¿”å›å€¼</p><pre>public class UserService { public int insert(){ System.out.println("UserServiceæ­£åœ¨æ³¨å†Œç”¨æˆ·â€¦â€¦"); return 1; }}</pre><p>â€‹ (2)åœ¨MyAspectä¸­æ–°å¢afterReturningAdviceæ–¹æ³•</p><pre>public void afterReturningAdvice(int result) { System.out.println("ã€AOPã€‘after adviceâ€¦â€¦è¿”å›å€¼ä¸º"+result); }</pre><p>â€‹ (3)åœ¨applicationContext.xmlä¸­é…ç½®</p><pre>&lt;aop:config&gt; &lt;aop:aspect id="beforeAdvice" ref="myAspect"&gt; &lt;aop:after-returning method="afterReturningAdvice" pointcut="execution(* aop.*.insert(..)))" returning="result"/&gt; &lt;/aop:aspect&gt;&lt;/aop:config&gt;</pre><p>â€‹ æ³¨æ„ï¼šè¿™é‡Œè¿™ä¸ªreturning="result"ä¸MyAspectç±»ä¸­å¯¹åº”æ–¹æ³•çš„å‚æ•°åå¿…é¡»ä¿æŒä¸€è‡´ï¼Œæœ¬ä¾‹ä¸­éƒ½ä¸ºresult</p><p>â€‹ (4)ç¼–å†™æµ‹è¯•ç±»(ä»£ç åŒ1.)</p><p>â€‹ (5)è¾“å‡ºç»“æœ</p><pre>UserServiceæ­£åœ¨æ³¨å†Œç”¨æˆ·â€¦â€¦ ã€AOPã€‘after adviceâ€¦â€¦è¿”å›å€¼ä¸º1</pre><p><strong>4.AfterThrowingAdvice</strong></p><p>â€‹ (1)ä¿®æ”¹UserServiceä½¿å…¶æŠ›å¼‚å¸¸</p><pre>public int insert() throws Exception { try { System.out.println("UserServiceå¼€å§‹æ³¨å†Œç”¨æˆ·â€¦â€¦"); int i=1/0; }catch (Exception e){ throw new Exception("insertæ–¹æ³•é‡åˆ°å¼‚å¸¸â€¦â€¦"); } return 1;}</pre><p>â€‹ (2)åœ¨MyAspectä¸­æ–°å¢æ–¹æ³• afterThrowingAdvice</p><pre>//è¿™é‡Œä¼ å…¥çš„è¿™ä¸ªExceptionå°±æ˜¯æ•è·åˆ°çš„å¼‚å¸¸å¯¹è±¡public void afterThrowingAdvice(Exception e){ System.out.println("ã€AOPã€‘å¾—åˆ°å¼‚å¸¸ä¿¡æ¯ï¼š"+e.getMessage());}</pre><p>â€‹ (3)ä¿®æ”¹applicationContext.xml</p><pre>&lt;aop:config&gt; &lt;aop:aspect id="beforeAdvice" ref="myAspect"&gt; &lt;aop:after-throwing method="afterThrowingAdvice" pointcut="execution(* aop.*.insert(..)))" throwing="e"/&gt; &lt;/aop:aspect&gt;&lt;/aop:config&gt;</pre><p>â€‹ æ³¨æ„ï¼šè¿™é‡Œçš„throwing="eâ€å°±æ˜¯è·‘å‡ºçš„å¼‚å¸¸å¯¹è±¡çš„åå­—ï¼Œè¦ä¸MyAspectä¸­afterThrowingAdviceæ–¹æ³•ä¸­ä¼ å…¥çš„å‚æ•°Exception eçš„åå­—ä¿æŒä¸€è‡´ã€‚</p><p>â€‹ (4)ç¼–å†™æµ‹è¯•ç±»</p><pre>public static void main(String[] args) throws Exception { ApplicationContext context= new ClassPathXmlApplicationContext("applicationContext.xml"); UserService userService = context.getBean("userService", UserService.class); userService.insert();}</pre><p>â€‹ (5)è¾“å‡ºç»“æœ</p><pre>UserServiceå¼€å§‹æ³¨å†Œç”¨æˆ·â€¦â€¦ã€AOPã€‘å¾—åˆ°å¼‚å¸¸ä¿¡æ¯insertæ–¹æ³•é‡åˆ°å¼‚å¸¸â€¦â€¦Exception in thread "main" java.lang.Exception: insertæ–¹æ³•é‡åˆ°å¼‚å¸¸â€¦â€¦ at aop.UserService.insert(UserService.java:12) at aop.UserService$$FastClassBySpringCGLIB$$7e3b8e5e.invoke(&lt;generated&gt;) ...</pre><p><strong>5.AroundAdvice</strong></p><p>â€‹ (1)ä¿®æ”¹UserServiceä¸­çš„insertæ–¹æ³•</p><pre>public int insert(int arg) throws Exception { try { int i = 1 / 0; } catch (Exception e) { throw new Exception("insertæ–¹æ³•é‡åˆ°å¼‚å¸¸â€¦â€¦"); } return 1;}</pre><p>â€‹ (2)åœ¨MyAspectä¸­æ·»åŠ æ–¹æ³•AroundAdvice</p><pre>//è¿™é‡Œè¿™ä¸ªProceedingJointPointå¯ä»¥ç†è§£ä¸ºåˆ‡å…¥ç‚¹å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡å®ƒè·å–åˆ‡å…¥ç‚¹ï¼ˆè¢«åˆ‡å…¥çš„æ–¹æ³•ï¼‰çš„å‚æ•°ã€è¿”å›å€¼ã€æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡pjp.proceed(args);ä¸ºè¯¥åˆ‡å…¥ç‚¹è®¾ç½®å‚æ•°public int aroundAdvice(ProceedingJoinPoint pjp) throws Throwable { Object[] args = pjp.getArgs(); System.out.println("ã€AOPã€‘before Advice,è·å–åˆ°insertæ–¹æ³•ä¼ å…¥çš„å‚æ•°ä¸ºï¼š"+args[0]); Object result; try { result=pjp.proceed(args);//è¿™é‡Œæ˜¯æˆ‘ä»¬æ‰‹åŠ¨æ‰§è¡Œåˆ‡å…¥ç‚¹ï¼Œå¹¶ä¼ å…¥å‚æ•° System.out.println("ã€AOPã€‘after Returning Advice,è¿”å›å€¼ä¸ºï¼š"+result); }catch (Exception e){ //è¿™é‡Œæ•è·çš„å°±æ˜¯åˆ‡å…¥ç‚¹è¿è¡Œæ—¶æŠ›å‡ºçš„å¼‚å¸¸ System.out.println("ã€AOPã€‘after Throwing Advice,é”™è¯¯ä¿¡æ¯ä¸ºï¼š"+e.getMessage()); } System.out.println("ã€AOPã€‘after adviceâ€¦â€¦ä¸ç®¡å¼‚å¸¸ä¸å¼‚å¸¸æˆ‘éƒ½æ‰§è¡Œ"); //è¿™ä¸ªå°±è·Ÿç€è¿™æ ·å†™å§ã€‚ã€‚å¦‚æœä¸å†™è¿”å›å€¼çš„è¯ä¼šæŠ¥ null return value does not match... return 1;}</pre><p>â€‹ (3)ä¿®æ”¹applicationContext.xmlæ–‡ä»¶</p><pre>&lt;aop:config&gt; &lt;aop:aspect id="beforeAdvice" ref="myAspect"&gt; &lt;aop:around method="aroundAdvice" pointcut="execution(* aop.*.insert(..)))" /&gt; &lt;/aop:aspect&gt;&lt;/aop:config&gt;</pre><p>â€‹ (4)ç¼–å†™æµ‹è¯•ç±»</p><pre>public static void main(String[] args) throws Exception { ApplicationContext context= new ClassPathXmlApplicationContext("applicationContext.xml"); UserService userService = context.getBean("userService", UserService.class); userService.insert(2);}</pre><p>â€‹ (5)è¾“å‡ºç»“æœ</p><pre>ã€AOPã€‘before Advice,è·å–åˆ°insertæ–¹æ³•ä¼ å…¥çš„å‚æ•°ä¸ºï¼š2ã€AOPã€‘after Throwing Advice,é”™è¯¯ä¿¡æ¯ä¸ºï¼šinsertæ–¹æ³•é‡åˆ°å¼‚å¸¸â€¦â€¦ã€AOPã€‘after adviceâ€¦â€¦ä¸ç®¡å¼‚å¸¸ä¸å¼‚å¸¸æˆ‘éƒ½æ‰§è¡Œ</pre><p><strong>å…­ã€åŸºäºæ³¨è§£é…ç½®çš„AOP</strong></p><p>â€‹ å…ˆæŠŠé¡¹ç›®çŠ¶æ€æ¢å¤åˆ° â€œå››ã€å‰æœŸå‡†å¤‡â€çš„çŠ¶æ€,ç„¶ååœ¨applicationContext.xmlä¸­æ·»åŠ ä¸‹é¢çš„è¯­å¥å¼€å¯æ³¨è§£å’ŒåŒ…æ‰«æã€‚</p><pre>&lt;context:annotation-config/&gt;&lt;context:component-scan base-package="aop"/&gt;</pre><p>â€‹ æ³¨æ„ï¼Œè¿™ä¸ªbase-packageå¯ä»¥é…ç½®å¤šä¸ªåŒ…ï¼Œä»¥åŠè§’ï¼ˆè‹±æ–‡ï¼‰é€—å·éš”å¼€ï¼Œä¾‹å¦‚â€œaop,mvc,dao,serviceâ€ï¼Œå½“ç„¶ï¼Œä¸ºäº†çœäº‹ï¼Œå¯ä»¥ç›´æ¥é…ä¸€ä¸ªé¡¶çº§åŒ…ï¼Œä»–ä¼šè‡ªåŠ¨éå†æ‰«ææ‰€æœ‰çš„å­åŒ…åŠå­åŒ…çš„å­åŒ…ç­‰ç­‰ã€‚</p><p>â€‹ ç„¶åä¸ºMyAspectç±»å’ŒUserServiceç±»åŠ ä¸Šæ³¨è§£</p><pre>@Component@Aspectpublic class MyAspect {}@Servicepublic class UserService {}</pre><p><strong>1.BeforeAdvice</strong></p><p>â€‹ (1)åœ¨MyAspectç±»ä¸­åˆ›å»ºbeforeAdviceæ–¹æ³•ï¼Œå¹¶å†™å¥½æ³¨è§£</p><pre>@Before(value = "execution(* aop..*.*(..)))")public void beforeAdvice(){ System.out.println("ã€AOPã€‘Before Adviceæ­£åœ¨æ‰§è¡Œâ€¦â€¦");}</pre><p>â€‹ ä¸éœ€è¦é…ä»»ä½•beanï¼Œæ˜¯ä¸æ˜¯å¾ˆçˆ½</p><p>â€‹ (2)ç¼–å†™æµ‹è¯•ç±»</p><pre>public static void main(String[] args) { ApplicationContext context= new ClassPathXmlApplicationContext("applicationContext.xml"); UserService userService = context.getBean("userService", UserService.class); userService.insert();}</pre><p>â€‹ (3)è¾“å‡ºç»“æœ</p><pre>ã€AOPã€‘Before Adviceæ­£åœ¨æ‰§è¡Œâ€¦â€¦ UserServiceæ­£åœ¨æ³¨å†Œç”¨æˆ·â€¦â€¦</pre><p><strong>2.AfterService(æˆ‘å°±ä¸å†™æµ‹è¯•äº†)</strong></p><p>â€‹ (1)åœ¨MyAspectç±»ä¸­åˆ›å»ºafterAdviceæ–¹æ³•ï¼Œå¹¶å†™å¥½æ³¨è§£</p><pre>@After(value = "execution(* aop..*.*(..)))")public void afterAdvice(){ System.out.println("ã€AOPã€‘after Adviceæ­£åœ¨æ‰§è¡Œâ€¦â€¦");}</pre><p><strong>3.AfterReturningAdvice</strong></p><p>â€‹ (1)ä¿®æ”¹UserServiceä¸­çš„insertæ–¹æ³•</p><pre>public int insert(){ System.out.println("UserServiceæ­£åœ¨æ³¨å†Œç”¨æˆ·â€¦â€¦"); return 1;}</pre><p>â€‹ (2)åœ¨MyAspectç±»ä¸­åˆ›å»ºafterReturningAdviceæ–¹æ³•ï¼Œå¹¶å†™å¥½æ³¨è§£</p><pre>@AfterReturning(value = "execution(* aop..*.*(..))&amp;&amp; args(result))")public void afterReturningAdvice(int result){ System.out.println("ã€AOPã€‘after Returning Adviceæ­£åœ¨æ‰§è¡Œâ€¦â€¦è¿”å›å€¼ä¸ºï¼š"+result);}</pre><p>â€‹ (3)ä¸å†™æµ‹è¯•äº†</p><p><strong>4.AfterThrowingAdvice</strong></p><p>â€‹ (1)ä¿®æ”¹UserServiceä¸­çš„insertæ–¹æ³•</p><pre>public int insert() throws Exception { try { int i=1/0; }catch (Exception e){ throw new Exception("ã€UserServiceã€‘çš„inserté‡åˆ°äº†é”™è¯¯â€¦â€¦"); } return 1;}</pre><p>â€‹ (2)åœ¨MyAspectç±»ä¸­åˆ›å»ºafterThrowingAdviceæ–¹æ³•ï¼Œå¹¶å†™å¥½æ³¨è§£</p><pre>@AfterThrowing(value = "execution(* aop..*.*(..)))",throwing = "e")public void afterThrowingAdvice(Exception e){ System.out.println("ã€AOPã€‘after Throwing Adviceæ­£åœ¨æ‰§è¡Œâ€¦â€¦é”™è¯¯ä¿¡æ¯ä¸ºï¼š"+e.getMessage());}</pre><p>â€‹ (3)ä¸æµ‹è¯•äº†ã€‚ã€‚</p><p><strong>5.AroundAdvice</strong></p><p>â€‹ (1)æŠŠMyAspectä¸­ä¹‹å‰å†™çš„æ–¹æ³•æ³¨é‡Šæ‰ï¼Œä¸ç„¶ä¼šå½±å“è§‚å¯Ÿç»“æœ</p><p>â€‹ (2)ä¿®æ”¹insertæ–¹æ³•</p><pre>public int insert(int arg) throws Exception { try { int i=1/0; }catch (Exception e){ throw new Exception("ã€UserServiceã€‘çš„inserté‡åˆ°äº†é”™è¯¯â€¦â€¦"); } return 1;}</pre><p>â€‹ (3)åœ¨MyAspectç±»ä¸­åˆ›å»ºaroundAdviceæ–¹æ³•ï¼Œå¹¶å†™å¥½æ³¨è§£</p><pre>@Around(value = "execution(* aop..*.*(..)))")public int aroundAdvice(ProceedingJoinPoint pjp) throws Throwable { Object[] args = pjp.getArgs(); System.out.println("ã€AOPã€‘before Advice,è·å–åˆ°insertæ–¹æ³•ä¼ å…¥çš„å‚æ•°ä¸ºï¼š"+args[0]); Object result; try { result=pjp.proceed(args); System.out.println("ã€AOPã€‘after Returning Advice,è¿”å›å€¼ä¸ºï¼š"+result); }catch (Exception e){ System.out.println("ã€AOPã€‘after Throwing Advice,é”™è¯¯ä¿¡æ¯ä¸ºï¼š"+e.getMessage()); } System.out.println("ã€AOPã€‘after adviceâ€¦â€¦ä¸ç®¡å¼‚å¸¸ä¸å¼‚å¸¸æˆ‘éƒ½æ‰§è¡Œ"); return 1;}</pre><p><strong>å…³æ³¨ä½œè€…ï¼šJAVAé«˜çº§ç¨‹åºå‘˜</strong></p><p>ä¸“æ³¨åˆ†äº«ï¼šï¼ˆé«˜å¯ç”¨ã€é«˜å¹¶å‘ã€é«˜æ€§èƒ½åŠåˆ†å¸ƒå¼ã€Jvmæ€§èƒ½è°ƒä¼˜ã€Springæºç ï¼ŒMyBatisï¼ŒNettyï¼ŒRedisï¼ŒKafkaï¼ŒMysqlï¼ŒZookeeperï¼ŒTomcatï¼ŒDockerï¼ŒDubboï¼ŒNginxç­‰æŠ€æœ¯...ï¼‰</p><p>æ¬¢è¿è½¬å‘ï¼Œè¯„è®º~~~æ¯å¤©Javaä¸€ä¸‹ï¼Œæˆä¸ºæ¶æ„å¸ˆï¼</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Spring','ç¼–ç¨‹','AOP'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../cn/%E7%A7%91%E6%8A%80/60d27d99.html alt=Springé¢å‘åˆ‡é¢ç¼–ç¨‹AOPçš„åˆæ­¥äº†è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6eb76749eacf41f1ac8d6bb660ae18ab style=border-radius:25px></a>
<a href=../../cn/%E7%A7%91%E6%8A%80/60d27d99.html title=Springé¢å‘åˆ‡é¢ç¼–ç¨‹AOPçš„åˆæ­¥äº†è§£>Springé¢å‘åˆ‡é¢ç¼–ç¨‹AOPçš„åˆæ­¥äº†è§£</a></li><hr><li><a href=../../cn/%E7%A7%91%E6%8A%80/c98c28c3.html alt=ä½¿ç”¨æ³¨è§£æ–¹å¼é…ç½®Springä¸­çš„é¢å‘åˆ‡é¢ç¼–ç¨‹AOP class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../cn/%E7%A7%91%E6%8A%80/c98c28c3.html title=ä½¿ç”¨æ³¨è§£æ–¹å¼é…ç½®Springä¸­çš„é¢å‘åˆ‡é¢ç¼–ç¨‹AOP>ä½¿ç”¨æ³¨è§£æ–¹å¼é…ç½®Springä¸­çš„é¢å‘åˆ‡é¢ç¼–ç¨‹AOP</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>