<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>深入浅出理解神经网络 | 极客快訊</title><meta property="og:title" content="深入浅出理解神经网络 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/5e70000151f2abbd0da2"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/afbe5b3.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/afbe5b3.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/afbe5b3.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/afbe5b3.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/afbe5b3.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/afbe5b3.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/afbe5b3.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/afbe5b3.html><meta property="article:published_time" content="2020-10-29T20:53:45+08:00"><meta property="article:modified_time" content="2020-10-29T20:53:45+08:00"><meta name=Keywords content><meta name=description content="深入浅出理解神经网络"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/afbe5b3.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>深入浅出理解神经网络</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>更多腾讯海量技术文章，请关注云+社区：https://cloud.tencent.com/developer</p><h1>介绍</h1><p>如今，科学家正在努力探索人脑的奥秘，他们试图通过模仿人脑，来找到大数据的解决方案。</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/5e70000151f2abbd0da2></p><p>我感觉现在没有深入浅出的、实用的介绍神经网络(NN)的文章。我一直想弄清楚人脑是怎么工作的，但我还有很多问题没有答案，而且总是很难把握神经网络工作的细节。这篇文章中，我想回答的最关键的问题是：</p><p>1. 人脑是如何工作的？</p><p>2. “感知器”如何充当人工神经元？——前向神经网络</p><p>3. 什么是神经网络的权重？</p><p>4. 生物体内的神经元权重是多少？</p><p>5. 神经网络中激励函数起什么作用？</p><p>6. 生物体内什么东西起到了神经元激励函数的功能？</p><p>7. 反向传播如何工作？</p><p>8. 反向传播神经网络的确切的数学逻辑是什么？</p><p>9. 如何实现反向传播神经网络？</p><h1>1.人脑是如何工作的？</h1><p>要理解神经网络如何工作，最好先研究一下人脑的运作机理。人脑有约一千亿个神经元，彼此之间紧密相连。当你看到一个动物——比如猫，其大小、颜色、形状等特征会从眼睛传入大脑。然后，这些输入的信息将被一些小细胞处理，这些细胞被称作神经元，它们负责处理输入大脑的数据。</p><p>首先，神经元会搜索你以前见过的猫的图像，然后比较你记忆中的猫和新看到的猫的图像。这种比对是“监督学习”的基础，它让你的大脑就像一个比较器一样，这就是为什么人们看见什么东西都想要比较一番。经过比较后会得到结果：你看到的是一只猫——因为你之前看到过猫。</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/5b5b00034ca9302dabf3></p><p>借助眼睛，你的大脑可以每秒处理20 Mb的信息。这很神奇，因为这与你的学习能力、分辨某人声音或者听觉的能力如何没有关系。所以，你的大脑是一个难以置信的巨大的CPU。</p><p>如果把这个庞大系统的规模简化到很小，就可以解决今天不同领域的问题。比如说，用很小一部分的人脑的特征就可以解决诸如语言、面部或图像的识别问题，情感分析、观点或情绪的理解问题，自动驾驶汽车，甚至疾病诊断等问题。</p><p>下图就是神经元细胞，包括树突、轴突和细胞核。从左到右看，树突负责接收信息，细胞核负责处理数据，处理结果将从轴突传递到神经元的尾部。这一整个神经元的结构，在人工智能中被称作“感知器”。</p><p>右侧的另一个神经元细胞将受到某些化学物质的激励，从而接收左侧神经元的反应。这种激励造成了数据在细胞间的传递、转移。所以，左侧神经元的输出就是右侧神经元的输入。其他的神经单元也存在同样的过程。就这样，大脑一千亿个神经元相互协作，以达成目标。</p><p>你每天都要做这么多的信号处理来过好你的生活，而大脑做这些都毫不费力。一天结束时，你只需要7个小时来恢复这些小细胞。神经科学家发现，越是学习，你的树突就会越强，因为激发神经元细胞之间的联系也是一种锻炼，就像锻炼肌肉一样。因此，大脑用得越多，越不可能患上阿尔茨海默病。</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/5e70000151f1e3bf50a7></p><h1>2.“感知器”如何充当人工神经元？——前向神经网络</h1><p>下图是一个简单的感知器模型，以及他获得输出结果的计算操作。首先有两个输入X1和X2，然后每个连接都有相应的权重。在神经网络中，所有的处理单元都是节点。尽管计算机系统有复杂的处理单元，但在神经网络中存在着简单的处理单元。</p><p>我们先让输入(X)和权重(W)相乘，然后对所有结果求和，并把结果代入一个激励函数，最终的结果就是这个感知器的输出。</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/5e6f0001522c4eae9e30></p><p>上述过程称作神经网络的前向传播。但实际上，在神经网络学习中，我们用更多的节点和层数。我之前说过，在我们的大脑中有数十亿层，这个庞大的系统造就了我们今天的人类。所以，为了学习得更好，我们把层数增多，这样一般会提高学习、训练的结果。下图中有两个隐含层，用浅蓝色表示，每个节点都像上述的简单感知器一样工作。</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/5b5b00034ca722d68a96></p><h1>3.什么是神经网络的权重？</h1><p>权重是指节点之间的连接强度。无符号（没有正负）的权重大小取决于节点之间的连接有多强。</p><p>而权重可以是正值或负值，正值代表传递数据的可能性更大、神经元之间有强大的联系，反之亦然。一开始，我们随机选择权重，但为了让结果更合理，最好将输入数据进行如下的归一化，其中X是输入数据：</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/5b5a000371ef13d8e2c7></p><p>因为本文中的激励函数是累加型的，所以有一个简便方法来随机地选择权重值：把权重限制在一个特定的区间内——如下面的公式。这个公式取决于平均分布，其内在逻辑在此暂且不表，下一篇文章中我们会展开来说。</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/5e6f0001565c69bb9485></p><p>以上公式请参考：Deep Learning Tutorials (深度学习教程); Glorot and Bengio (2010)</p><p>我提到说，神经网络是高度互连的，而权重是实现这种互连的最重要的因素。我们在第一阶段中随机选择权重值。首先，从左到右地完成前向传播。</p><p>然后比较一下结果和真实值的误差有多大，真实值是训练数据集中的“Y”值。然后进行反向传播计算——即在相反的路径上进行计算。</p><p>前向传播是从左到右，而反向传播是从右到左，以此优化并获得新的权重，使下一次的输出值被优化。如果下一次的输出值与“Y”的误差小于之前输出值的误差，则表明我们的优化方式是正确的。</p><p>可见，权重是将节点彼此连接起来的一种工具，也是训练神经网络减少错误的一个因素。通过多次测量反向传播、前向传播并进行权重校准，可以获得新的权重和准确的输出值，从而降低误差。</p><p>为了更好地理解神经网络中的权重扮演的角色，我请您阅读我关于“机器学习和梯度下降”的文章。神经网络中的权重基本接近Y值的预测线中的斜率“a”，Y=aX+b。准确的“a”值可以帮助我们找到更好的预测线来对数据进行分类。这里神经网络的权重也是一个类似“a”的因素，我们努力找出它的精确值，以求更准确的分类。</p><h1>4. 生物体内的神经元权重是多少？</h1><p>所有的神经网络结构都是从人脑中得到灵感启发的。因此，加权的无符号值表示：神经元之间的树突连接数+树突之间的突触数+突触的前、后末端+神经元之间间隙的形状+连接强度；还有髓鞘的状态也很重要。</p><p>髓鞘是在神经元细胞轴突周围的白色的脂肪物质，它像保护膜一样保护着它们。下图中，信号在有髓鞘的右侧神经元的比在没有髓鞘的左侧神经元中传播得快得多。这种现象是由跳跃传导产生的。</p><p>频繁、快速的传播会形成更多、更强的突触，这对大脑学习能力起着重要的作用。对大脑更强大的人进行的功能性磁共振成像（FMRI）的结果表明，他们的突触和脑活化区域更多。</p><p>因此，神经网络中的权重与生物中的上述因素的组合是一样的。</p><p>https://en.wikipedia.org/wiki/Myelin</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/5e7000015200697db45c></p><h1>5.神经网络中激励函数起什么作用？</h1><p>激励函数（虽然只在一定程度上）起到“极化”和“稳定化”的效果。我想举例说明一下“极化”和数学上的“稳定化”。为方便计算，我们需要对数据做一点极化处理，尤其是对十进制数。例如，我们有1.298456，我们只需要一个数字作为小数。</p><p>为了四舍五入、极化、计算简捷，我们将1.298456化为1.3——因为小数点后2的下一个数字是9，9大于5，所以我们将2转换为3。这种情况下，四舍五入可以有更简洁的值和结果。</p><p>在神经网络中，我们希望更精确地分类和预测，而非线性函数图像有更多的弧度、弯曲。如下图，相比线性和非线性函数，显然非线性函数预测的精度更高，并且有能更好的区分两类不同事物的分界线。</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/5b5a00036e4eb6783101></p><p>我在梯度下降中使用了“误差平方和（SSE）”。神经网络的激励函数应该是像指数或正切一类的非线性函数。而因为在反向传播中，我们要找到全局最小点，所以函数也必须是可微的。实际上，正是反向传播造成了梯度下降。详情请阅读关于梯度下降的文章：https://www.codeproject.com/Articles/1196024/Machine-Learning-Gradient-Descent。</p><p>误差平方和(SSE)= ½Σ(Y真实值-Y预测值)²</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/5b5c0002ee54d16ab82f></p><p>SSE代表Y的预测值和真实值之间的误差。因此，为了获得最佳预测线而不是直接用上图的蓝线，我们要对SSE求微分，然后计算出该线的新的斜率。</p><p>您可以从下列函数中选一个作为激励函数，详情请参考https://en.wikipedia.org/wiki/Activation_function。</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/5b5a0003737db6bef0b4></p><h1>6.生物体内什么东西起到了神经元激励函数的功能？<br></h1><p>神经网络中的激励函数也称作传递函数，其根据自己的输入给出该节点的输出。激励函数在生物学中被称作动作电位，其与信号在轴突中传播方式有关。</p><p>化学物质引起电信号激励，并刺激神经元，然后刺激其轴突，以便在神经元上单向传输信号。它辅助神经元产生输出结果。详情请参考https://en.wikipedia.org/wiki/Action_potential。</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/5e70000151f870d7f223></p><h1>7.反向传播如何工作？</h1><p>为了串联起以上所有的概念，我想把反向传播工作流程分成以下几个步骤来说明：</p><ul class=list-paddingleft-2><li><p>一开始有一组训练数据，数据中既有X也有Y，X有一列或多列，而Y作为一个要考虑的参量。这样，输入和输出层单元的数量就确定了。</p></li><li><p>接着我们需要选择隐藏层的层数。隐藏层的层数代表了学习的深度，层数越多，模仿人脑就越像，结果也就越准确。但主要问题是隐藏层越多，计算量越大，内存消耗也就越大，反向传播时尤其如此。</p></li><li><p>隐藏层确定后，我们需要正态随机选择的权重值，例如在本文第三部分我解释过一个公式。</p></li><li><p>正向传播得到输出结果：</p></li></ul><p>每一层都有节点，我假设它们输出有两种值：一种是不套用Sigmoid函数的“Inputsigma”或“hiddensigma”，另一种是套用了Sigmoid函数的“hiddennode”和“outputnode”。然后我们从左到右计算，进行前向传播。</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/5e7000015929a97a7523></p><ul class=list-paddingleft-2><li><p>反向传播优化权重：</p></li></ul><p>在反向传播中，因为我们要找到最优权重值，所以我们对Sigmoid函数求微分，然后从右向左反向计算，以找到新的权重值。</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/5b5a000375ccacc110cd></p><p>(10) 如果当前误差小于之前的误差，则说明我们优化的方向正确，就用新得到的权重值重复执行1-5步。</p><p>(11) 重复步骤1到10，直到结果接近“Y”。</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/5e7100021d0a21b7594c></p><h1>8.反向传播神经网络的确切的数学逻辑是什么？</h1><p>反向传播和梯度下降作用相同，我们需要对激励函数求微分。它的计算过程如下：</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/5b5c0002ee58650cf7a1></p><p>XOR（异或运算）是测试我们神经网络的最简单的样例。XOR的真值表如下，它有两个操作数和一个结果：</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/5e70000151fa4450a108></p><p>例如我想要实现第四行操作：(1,1)=0</p><p>Y是0，输出是0.68，所以边际误差是-0.68。下一个输出是0.57，边际误差小于0.68。</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/5b5900037e574ea3629b></p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/5e7100021d0f90d4c112></p><h1>9.如何实现反向传播神经网络？</h1><p><strong>执行文件：</strong></p><p>基于上述知识，我要在Matlab中实现神经网络。首先，我创建了“execution.m”文件用来调用我的预测函数。</p><pre>%% 机器学习 - 神经网络 - 简要例程%% 初始化clear ; close all; clcinput_node = [1 1]; %1*2% 通过正态分布获得权重Weight_1 = [ -0.5 1.01 0.23 ; -0.32 -0.24 -0.12 ]; %2*3Weight_2 = [ 0.15 1.32 -0.37 ]; %1*3pred = mypredict(Weight_1, Weight_2, input_node);fprintf('反向传播最终输出: %f\n', perd);</pre><p><strong>预测文件：</strong></p><p>然后，我写了“myprerdict.m”，这是最主要的代码：</p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/5e7100022745aeaffb63></p><p><strong>Sigmoid 函数：</strong></p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/5b5c0002f9a4cb2a6ea3></p><p><strong>Sigmoid 派生函数：</strong></p><p><img alt=深入浅出理解神经网络 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/5b5900038a106fc2e3b3></p><h1>亮点</h1><p>我发现神经网络非常令人激动，我认为我们可以把它称作人工智能之母。</p><p>神经网络的最大优缺点是：</p><ol class=list-paddingleft-2><li><p>归一化的数据集和选择最优解可以使我们在海量的训练数据中得到更精确的输出；</p></li><li><p>系统性能和准确度取决于权重，如果你的权重在合适的区间中，那就可以得到性能和准确性的提高；</p></li><li><p>相比其他的方式，反向传播会消耗更多的内存。</p></li></ol><p>最后，我强烈建议您在coursera.org上加入机器学习：https://www.coursera.org/learn/machine-learning</p><p>另外，我的github可以用作学习指导：</p><p>https://github.com/Hassankashi?tab=repositories</p><h1>反馈</h1><p>欢迎对本文留言，期待看到您对此代码的意见和支持。如果您有任何问题，请直接在这里问我。</p><blockquote><p>翻译人：元卅，该成员来自云+社区翻译社</p><p>原文译题：神经网络</p><p>原文链接：https://www.codeproject.com/Articles/1200392/Neural-Network</p><p>原文作者：Mahsa Hassankashi</p></blockquote><h1>神经网络例程下载</h1><p>https://ask.qcloudimg.com/draft/1050107/d8zgt7ubrt.zip</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'浅出','神经','网络'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>