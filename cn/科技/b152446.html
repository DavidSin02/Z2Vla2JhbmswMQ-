<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>ã€Œasp.net core ç³»åˆ—ã€12 æ•°æ®åŠ å¯†ç®—æ³•ï¼ˆå¸¸è§åŠ å¯†ç®—æ³•ï¼‰ | æå®¢å¿«è¨Š</title><meta property="og:title" content="ã€Œasp.net core ç³»åˆ—ã€12 æ•°æ®åŠ å¯†ç®—æ³•ï¼ˆå¸¸è§åŠ å¯†ç®—æ³•ï¼‰ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/dfic-imagehandler/335a391e-e2b1-4ea2-b20d-51cacaf5c5f5"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b152446.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b152446.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b152446.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b152446.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b152446.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b152446.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b152446.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b152446.html><meta property="article:published_time" content="2020-10-29T20:52:29+08:00"><meta property="article:modified_time" content="2020-10-29T20:52:29+08:00"><meta name=Keywords content><meta name=description content="ã€Œasp.net core ç³»åˆ—ã€12 æ•°æ®åŠ å¯†ç®—æ³•ï¼ˆå¸¸è§åŠ å¯†ç®—æ³•ï¼‰"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/b152446.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>ã€Œasp.net core ç³»åˆ—ã€12 æ•°æ®åŠ å¯†ç®—æ³•ï¼ˆå¸¸è§åŠ å¯†ç®—æ³•ï¼‰</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><h1 class="md-end-block md-heading">0. å‰è¨€</h1><p>è¿™ä¸€ç¯‡æˆ‘ä»¬å°†ä»‹ç»ä¸€ä¸‹.net core çš„åŠ å¯†å’Œè§£å¯†ã€‚åœ¨Webåº”ç”¨ç¨‹åºä¸­ï¼Œç”¨æˆ·çš„å¯†ç ä¼šä½¿ç”¨MD5å€¼ä½œä¸ºå¯†ç æ•°æ®å­˜å‚¨èµ·æ¥ã€‚è€Œåœ¨å…¶ä»–çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¼šä½¿ç”¨åŠ å¯†å’Œè§£å¯†çš„åŠŸèƒ½ã€‚</p><p>å¸¸è§çš„åŠ å¯†ç®—æ³•åˆ†ä¸ºå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ã€‚æ‰€è°“çš„å¯¹ç§°åŠ å¯†æ˜¯æŒ‡åŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥æ˜¯åŒä¸€ä¸ªï¼Œéå¯¹ç§°åŠ å¯†æ˜¯å€¼åŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥ä¸åŒã€‚è€Œæˆ‘ä»¬å¸¸åº”ç”¨åœ¨ä¿å­˜ç”¨æˆ·ç™»å½•å¯†ç è¿™ä¸ªè¿‡ç¨‹ä¸­çš„MD5æœ¬è´¨ä¸Šå¹¶ä¸æ˜¯åŠ å¯†ç®—æ³•ï¼Œè€Œæ˜¯ä¸€ç§ä¿¡æ¯æ‘˜è¦ç®—æ³•ã€‚ä¸è¿‡MD5å°½é‡ä¿è¯äº†æ¯ä¸ªå­—ç¬¦ä¸²æœ€åè®¡ç®—å‡ºæ¥çš„å€¼éƒ½ä¸ä¸€æ ·ï¼Œæ‰€ä»¥åœ¨å¯†ç ä¿å­˜ä¸­å¸¸ç”¨MD5ä½œä¸ºä¿å¯†å€¼ã€‚</p><p><br></p><div class=pgc-img><img alt="ã€Œasp.net core ç³»åˆ—ã€12 æ•°æ®åŠ å¯†ç®—æ³•ï¼ˆå¸¸è§åŠ å¯†ç®—æ³•ï¼‰" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/335a391e-e2b1-4ea2-b20d-51cacaf5c5f5><p class=pgc-img-caption></p></div><p><br></p><h1 class="md-end-block md-heading">1. å¸¸è§å¯¹ç§°åŠ å¯†ç®—æ³•</h1><p>å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œç®€å•çš„è¯´å°±æ˜¯åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥è¿›è¡Œè¿ç®—ã€‚å¯¹äºå¤§å¤šæ•°åŠ å¯†ç®—æ³•ï¼Œè§£å¯†å’ŒåŠ å¯†æ˜¯ä¸€ä¸ªäº’é€†çš„è¿ç®—ã€‚å¯¹ç§°åŠ å¯†ç®—æ³•çš„å®‰å…¨æ€§å–å†³äºå¯†é’¥çš„é•¿åº¦ï¼Œå¯†é’¥è¶Šé•¿è¶Šå®‰å…¨ã€‚å½“ç„¶ï¼Œä¸å»ºè®®ä½¿ç”¨è¿‡é•¿çš„å¯†é’¥ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¸¸è§çš„å¯¹ç§°åŠ å¯†ç®—æ³•æœ‰å“ªäº›å§ï¼Œä»¥åŠC#è¯¥å¦‚ä½•å®ç°ã€‚</p><h2 class="md-end-block md-heading">1.1 DES å’Œ DESede ç®—æ³•</h2><p>DESç®—æ³•å’ŒDESedeç®—æ³•ï¼ˆåˆç§°ä¸‰é‡DESç®—æ³•ï¼‰ ç»Ÿç§°DESç³»åˆ—ç®—æ³•ã€‚DESå…¨ç§°ä¸ºData Encryption Standardï¼Œå³æ•°æ®åŠ å¯†æ ‡å‡†ï¼Œæ˜¯ä¸€ç§ä½¿ç”¨å¯†é’¥åŠ å¯†çš„å—ç®—æ³•ã€‚è€ŒDESedeå°±æ˜¯é’ˆå¯¹åŒä¸€å—æ•°æ®åšä¸‰æ¬¡DESåŠ å¯†ã€‚è¿™é‡Œå°±ä¸å¯¹åŸç†åšè¿‡å¤šçš„ä»‹ç»äº†ï¼Œæ¥çœ‹çœ‹.net coreé‡Œå¦‚ä½•å®ç°DESåŠ /è§£å¯†å§ã€‚</p><p>åœ¨Utilsé¡¹ç›®é‡Œï¼Œåˆ›å»ºç›®å½•Securityï¼š</p><p>åœ¨Securityç›®å½•ä¸‹ï¼Œåˆ›å»ºDESHelperç±»ï¼š</p><pre><code>namespace Utils.Security{ Â  Â public class DesHelper Â   { Â  Â  Â  Â  Â   }}</code></pre><p>åŠ å¯†è§£å¯†å®ç°ï¼š</p><pre><code>using System;using System.IO;using System.Security.Cryptography;using System.Text;â€‹namespace Utils.Security{ Â  Â public static class DesHelper Â   { Â  Â  Â  Â static DesHelper() Â  Â  Â   { Â  Â  Â  Â  Â  Â DesHandler = Â DES.Create("DES"); Â  Â  Â  Â  Â  Â DesHandler.Key = Convert.FromBase64String("L1yzjGB2sI4="); Â  Â  Â  Â  Â  Â DesHandler.IV = Convert.FromBase64String("uEcGI4JSAuY="); Â  Â  Â   }â€‹ Â  Â  Â  Â private static DES DesHandler { get; }â€‹ Â  Â  Â  Â /// &lt;summary&gt; Â  Â  Â  Â /// åŠ å¯†å­—ç¬¦ Â  Â  Â  Â /// &lt;/summary&gt; Â  Â  Â  Â /// &lt;param name="source"&gt;&lt;/param&gt; Â  Â  Â  Â /// &lt;returns&gt;&lt;/returns&gt; Â  Â  Â  Â public static string Encrypt(string source) Â  Â  Â   { Â  Â  Â  Â  Â  Â try Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â using (var memStream = new MemoryStream()) Â  Â  Â  Â  Â  Â  Â  Â using (var cryptStream = new CryptoStream(memStream, DesHandler.CreateEncryptor(DesHandler.Key, DesHandler.IV), Â  Â  Â  Â  Â  Â  Â  Â  Â  Â CryptoStreamMode.Write)) Â  Â  Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â  Â  Â var bytes = Encoding.UTF8.GetBytes(source); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â cryptStream.Write(bytes, 0, bytes.Length); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â cryptStream.FlushFinalBlock(); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return Convert.ToBase64String(memStream.ToArray()); Â  Â  Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â  Â catch (Exception e) Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â Console.WriteLine(e); Â  Â  Â  Â  Â  Â  Â  Â return null; Â  Â  Â  Â  Â   } Â  Â  Â   }â€‹ Â  Â  Â  Â /// &lt;summary&gt; Â  Â  Â  Â /// è§£å¯† Â  Â  Â  Â /// &lt;/summary&gt; Â  Â  Â  Â /// &lt;param name="source"&gt;&lt;/param&gt; Â  Â  Â  Â /// &lt;returns&gt;&lt;/returns&gt; Â  Â  Â  Â public static string Decrypt(string source) Â  Â  Â   { Â  Â  Â  Â  Â  Â try Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â using (var mStream = new MemoryStream(Convert.FromBase64String(source))) Â  Â  Â  Â  Â  Â  Â  Â using (var cryptoStream = Â  Â  Â  Â  Â  Â  Â  Â  Â  Â new CryptoStream(mStream, DesHandler.CreateDecryptor(DesHandler.Key, DesHandler.IV), CryptoStreamMode.Read)) Â  Â  Â  Â  Â  Â  Â  Â using (var reader = new StreamReader(cryptoStream)) Â  Â  Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return reader.ReadToEnd(); Â  Â  Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â  Â catch (Exception e) Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â Console.WriteLine(e); Â  Â  Â  Â  Â  Â  Â  Â return null; Â  Â  Â  Â  Â   } Â  Â  Â   } Â   }}</code></pre><p>æ¯æ¬¡è°ƒç”¨DesHandler = DES.Create("DES"); éƒ½ä¼šé‡æ–°è·å¾—ä¸€ä¸ªDESç®—æ³•å®ç°å®ä¾‹ï¼Œè¿™æ ·æ¯æ¬¡è·å–çš„å®ä¾‹ä¸­Keyã€IVè¿™ä¸¤ä¸ªå±æ€§çš„å€¼ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚å¦‚æœç›´æ¥ä½¿ç”¨ä¼šå‡ºç°è¿™æ¬¡åŠ å¯†çš„æ•°æ®ä¸‹æ¬¡å°±æ²¡æ³•è§£å¯†äº†ï¼Œä¸ºäº†å‡å°‘è¿™ç§æƒ…å†µï¼Œæ‰€ä»¥ä»£ç å¤„æ‰‹åŠ¨èµ‹å€¼äº†Keyã€IVè¿™ä¸¤ä¸ªå±æ€§ã€‚</p><p><br></p><h2 class="md-end-block md-heading">1.2 AES åŠ å¯†ç®—æ³•</h2><p>AESç®—æ³•ï¼ˆAdvanced Encryption Standardï¼‰ä¹Ÿå°±æ˜¯é«˜çº§æ•°æ®åŠ å¯†æ ‡å‡†ç®—æ³•ï¼Œæ˜¯ä¸ºäº†è§£å†³DESç®—æ³•ä¸­çš„å­˜åœ¨çš„æ¼æ´è€Œæå‡ºçš„ç®—æ³•æ ‡å‡†ã€‚ç°è¡Œçš„AESç®—æ³•æ ¸å¿ƒæ˜¯Rijndaelç®—æ³•ã€‚å½“ç„¶äº†ï¼Œè¿™ä¸ªä¸ç”¨å¤ªè¿‡äºå…³å¿ƒã€‚æˆ‘ä»¬ç›´æ¥çœ‹çœ‹æ˜¯å¦‚ä½•å®ç°å§ï¼š</p><p>åŒæ ·ï¼Œåœ¨Securityç›®å½•åˆ›å»ºä¸€ä¸ªAesHelperç±»ï¼š</p><pre><code>namespace Utils.Security{ Â  Â public static class AesHelper Â   { Â  Â  Â  Â  Â   }}</code></pre><p>å…·ä½“çš„åŠ è§£å¯†å®ç°ï¼š</p><pre><code>using System;using System.IO;using System.Security.Cryptography;â€‹namespace Utils.Security{ Â  Â public static class AesHelper Â   { Â  Â  Â  Â static AesHelper() Â  Â  Â   { Â  Â  Â  Â  Â  Â AesHandler = Aes.Create(); Â  Â  Â  Â  Â  Â AesHandler.Key = Convert.FromBase64String("lB2BxrJdI4UUjK3KEZyQ0obuSgavB1SYJuAFq9oVw0Y="); Â  Â  Â  Â  Â  Â AesHandler.IV = Convert.FromBase64String("6lra6ceX26Fazwj1R4PCOg=="); Â  Â  Â   }â€‹ Â  Â  Â  Â private static Aes AesHandler { get; }â€‹ Â  Â  Â  Â public static string Encrypt(string source) Â  Â  Â   { Â  Â  Â  Â  Â  Â using (var mem = new MemoryStream()) Â  Â  Â  Â  Â  Â using (var stream = new CryptoStream(mem, AesHandler.CreateEncryptor(AesHandler.Key, AesHandler.IV), Â  Â  Â  Â  Â  Â  Â  Â CryptoStreamMode.Write)) Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â using (var writer = new StreamWriter(stream)) Â  Â  Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â  Â  Â writer.Write(source); Â  Â  Â  Â  Â  Â  Â   } Â   Â  Â  Â  Â  Â  Â  Â  Â return Convert.ToBase64String(mem.ToArray()); Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â  Â  Â  Â  Â   }â€‹ Â  Â  Â  Â public static string Decrypt(string source) Â  Â  Â   { Â  Â  Â  Â  Â  Â var data = Convert.FromBase64String(source); Â  Â  Â  Â  Â  Â using (var mem = new MemoryStream(data)) Â  Â  Â  Â  Â  Â using (var crypto = new CryptoStream(mem, AesHandler.CreateDecryptor(AesHandler.Key, AesHandler.IV), Â  Â  Â  Â  Â  Â  Â  Â CryptoStreamMode.Read)) Â  Â  Â  Â  Â  Â using (var reader = new StreamReader(crypto)) Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â return reader.ReadToEnd(); Â  Â  Â  Â  Â   } Â  Â  Â   } Â   }}</code></pre><p><br></p><div class=pgc-img><img alt="ã€Œasp.net core ç³»åˆ—ã€12 æ•°æ®åŠ å¯†ç®—æ³•ï¼ˆå¸¸è§åŠ å¯†ç®—æ³•ï¼‰" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/72a70d8c-7e00-49fd-a447-0b03630f3d0d><p class=pgc-img-caption></p></div><p><br></p><h1 class="md-end-block md-heading">2. å¸¸è§éå¯¹ç§°åŠ å¯†ç®—æ³•</h1><p>éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼ŒæŒ‡çš„æ˜¯åŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥å¹¶ä¸ç›¸åŒã€‚éå¯¹ç§°åŠ å¯†ç®—æ³•çš„å¯†é’¥é€šå¸¸æˆå¯¹å‡ºç°ï¼Œåˆ†ä¸ºå…¬å¼€å¯†é’¥å’Œç§æœ‰å¯†é’¥ã€‚å…¬å¼€å¯†é’¥å¯ä»¥ä»¥å…¬å¼€çš„å½¢å¼å‘ç»™æ•°æ®äº¤äº’æ–¹ï¼Œè€Œä¸ä¼šäº§ç”Ÿæ³„å¯†çš„é£é™©ã€‚å› ä¸ºéå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œæ— æ³•é€šè¿‡å…¬å¼€å¯†é’¥æ¨ç®—ç§æœ‰å¯†é’¥ï¼Œåä¹‹äº¦ç„¶ã€‚</p><p>é€šå¸¸ï¼Œéå¯¹ç§°åŠ å¯†ç®—æ³•æ˜¯ç”¨å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼Œä½¿ç”¨ç§é’¥è¿›è¡Œè§£å¯†ã€‚</p><h2 class="md-end-block md-heading">2.1 RSAç®—æ³•</h2><p>RSAç®—æ³•æ˜¯æ ‡å‡†çš„éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œåå­—æ¥æºæ˜¯ä¸‰ä½å‘æ˜è€…çš„å§“æ°é¦–å­—æ¯ã€‚RSAå…¬å¼€å¯†é’¥å¯†ç ä½“åˆ¶æ˜¯ä¸€ç§ä½¿ç”¨ä¸åŒçš„åŠ å¯†å¯†é’¥ä¸è§£å¯†å¯†é’¥ï¼Œâ€œç”±å·²çŸ¥åŠ å¯†å¯†é’¥æ¨å¯¼å‡ºè§£å¯†å¯†é’¥åœ¨è®¡ç®—ä¸Šæ˜¯ä¸å¯è¡Œçš„â€å¯†ç ä½“åˆ¶ ã€‚å…¶å®‰å…¨æ€§å–å†³äºå¯†é’¥çš„é•¿åº¦ï¼Œ1024ä½çš„å¯†é’¥å‡ ä¹ä¸å¯èƒ½è¢«ç ´è§£ã€‚</p><p>åŒæ ·ï¼Œåœ¨Utils.Securityä¸‹åˆ›å»ºRSAHelperç±»ï¼š</p><pre><code>namespace Utils.Security{ Â  Â public static class RsaHelper Â   { Â  Â  Â  Â  Â   }}</code></pre><p>å…·ä½“å®ç°ï¼š</p><pre><code>using System;using System.Security.Cryptography;â€‹namespace Utils.Security{ Â  Â public static class RsaHelper Â   { Â  Â  Â  Â public static RSAParameters PublicKey { get; private set; } Â  Â  Â  Â public static RSAParameters PrivateKey { get; private set; }â€‹ Â  Â  Â  Â static RsaHelper() Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â  Â   }â€‹ Â  Â  Â  Â public static void InitWindows() Â  Â  Â   { Â  Â  Â  Â  Â  Â var parameters = new CspParameters() Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â KeyContainerName = "RSAHELPER" // é»˜è®¤çš„RSAä¿å­˜å¯†é’¥çš„å®¹å™¨åç§° Â  Â  Â  Â  Â   }; Â  Â  Â  Â  Â  Â var handle = new RSACryptoServiceProvider(parameters); Â  Â  Â  Â  Â  Â PublicKey = handle.ExportParameters(false); Â  Â  Â  Â  Â  Â PrivateKey = handle.ExportParameters(true); Â  Â  Â   }â€‹ Â  Â  Â  Â public static void ExportKeyPair(string publicKeyXmlString, string privateKeyXmlString) Â  Â  Â   { Â  Â  Â  Â  Â  Â var handle Â = new RSACryptoServiceProvider(); Â  Â  Â  Â  Â  Â handle.FromXmlString(privateKeyXmlString); Â  Â  Â  Â  Â  Â PrivateKey = handle.ExportParameters(true); Â  Â  Â  Â  Â  Â handle.FromXmlString(publicKeyXmlString); Â  Â  Â  Â  Â  Â PublicKey = handle.ExportParameters(false); Â  Â  Â   } Â  Â  Â  Â public static byte[] Encrypt(byte[] dataToEncrypt) Â  Â  Â   { Â  Â  Â  Â  Â  Â try Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â byte[] encryptedData; Â  Â  Â  Â  Â  Â  Â  Â using (RSACryptoServiceProvider RSA = new RSACryptoServiceProvider()) Â  Â  Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â  Â  Â RSA.ImportParameters(PublicKey); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â encryptedData = RSA.Encrypt(dataToEncrypt, true); Â  Â  Â  Â  Â  Â  Â   }â€‹ Â  Â  Â  Â  Â  Â  Â  Â return encryptedData; Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â  Â catch (CryptographicException e) Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â Console.WriteLine(e.Message); Â  Â  Â  Â  Â  Â  Â  Â return null; Â  Â  Â  Â  Â   } Â  Â  Â   }â€‹ Â  Â  Â  Â public static byte[] Decrypt(byte[] dataToDecrypt) Â  Â  Â   { Â  Â  Â  Â  Â  Â try Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â byte[] decryptedData; Â  Â  Â  Â  Â  Â  Â  Â using (var rsa = new RSACryptoServiceProvider()) Â  Â  Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â  Â  Â rsa.ImportParameters(PrivateKey); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â decryptedData = rsa.Decrypt(dataToDecrypt, true); Â  Â  Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â  Â  Â  Â return decryptedData; Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â  Â catch (CryptographicException e) Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â Console.WriteLine(e.ToString()); Â  Â  Â  Â  Â  Â  Â  Â return null; Â  Â  Â  Â  Â   } Â  Â  Â   } Â   }}</code></pre><p>å› ä¸ºRSAçš„ç‰¹æ®Šæ€§ï¼Œéœ€è¦é¢„å…ˆè®¾ç½®å¥½å…¬é’¥å’Œç§é’¥ã€‚C# æ”¯æŒå¤šç§æ–¹å¼å¯¼å…¥å¯†é’¥ï¼Œè¿™é‡Œå°±ä¸åšè¿‡å¤šä»‹ç»äº†ã€‚</p><p><br></p><div class=pgc-img><img alt="ã€Œasp.net core ç³»åˆ—ã€12 æ•°æ®åŠ å¯†ç®—æ³•ï¼ˆå¸¸è§åŠ å¯†ç®—æ³•ï¼‰" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/3ee51ffc-67e7-4752-a321-9fb60165d97b><p class=pgc-img-caption></p></div><p><br></p><h1 class="md-end-block md-heading">3. ä¿¡æ¯æ‘˜è¦ç®—æ³•</h1><p>è¿™ç§ç®—æ³•ä¸¥æ ¼æ„ä¹‰ä¸Šå¹¶ä¸æ˜¯åŠ å¯†ç®—æ³•ï¼Œå› ä¸ºå®ƒå®Œå…¨ä¸å¯é€†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦è¿›è¡Œä½¿ç”¨è¯¥ç±»å‹ç®—æ³•åŠ å¯†åï¼Œæ— æ³•è§£å¯†è¿˜åŸå‡ºæ•°æ®ã€‚å½“ç„¶äº†ï¼Œä¹Ÿæ­£æ˜¯å› ä¸ºè¿™ç§ç‰¹æ€§å¸¸å¸¸è¢«ç”¨æ¥åšå¯†ç çš„ä¿å­˜ã€‚å› ä¸ºè¿™æ ·å¯ä»¥é¿å…æŸäº›äººæ‹¿åˆ°æ•°æ®åº“ä¸ä»£ç åï¼Œå¯ä»¥ç®€å•åæ¨å‡ºç”¨æˆ·çš„å¯†ç ã€‚</p><h2 class="md-end-block md-heading">3.1 MD5ç®—æ³•</h2><p>æœ€å¸¸ç”¨çš„ä¿¡æ¯æ‘˜è¦ç®—æ³•å°±æ˜¯MD5 åŠ å¯†ç®—æ³•ï¼ŒMD5ä¿¡æ¯æ‘˜è¦ç®—æ³•ï¼ˆè‹±è¯­ï¼šMD5 Message-Digest Algorithmï¼‰ï¼Œä¸€ç§è¢«å¹¿æ³›ä½¿ç”¨çš„å¯†ç æ•£åˆ—å‡½æ•°ï¼Œå¯ä»¥äº§ç”Ÿå‡ºä¸€ä¸ª128ä½ï¼ˆ16å­—èŠ‚ï¼‰çš„æ•£åˆ—å€¼ï¼ˆhash valueï¼‰ï¼Œç”¨äºç¡®ä¿ä¿¡æ¯ä¼ è¾“å®Œæ•´ä¸€è‡´ã€‚</p><p>åŸç†ä¸è§£é‡Šï¼Œæˆ‘ä»¬çœ‹ä¸‹å¦‚ä½•å®ç°ï¼Œç…§ä¾‹ç°åœ¨Securityä¸‹åˆ›å»ºMD5Helperï¼š</p><pre><code>namespace Utils.Security{ Â  Â public static class Md5Helper Â   { Â  Â  Â  Â  Â   }}</code></pre><p>å…·ä½“å®ç°ï¼š</p><pre><code>using System.Security.Cryptography;using System.Text;â€‹namespace Utils.Security{ Â  Â public static class Md5Helper Â   { Â  Â  Â  Â private static MD5 Hanlder { get; } = new MD5CryptoServiceProvider();â€‹ Â  Â  Â  Â public static string GetMd5Str(string source) Â  Â  Â   { Â  Â  Â  Â  Â  Â var data = Encoding.UTF8.GetBytes(source); Â  Â  Â  Â  Â  Â var security = Hanlder.ComputeHash(data); Â  Â  Â  Â  Â  Â var sb = new StringBuilder(); Â  Â  Â  Â  Â  Â foreach (var b in security) Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â sb.Append(b.ToString("X2")); Â  Â  Â  Â  Â   }â€‹ Â  Â  Â  Â  Â  Â return sb.ToString(); Â  Â  Â   } Â   }}</code></pre><p><br></p><h1 class="md-end-block md-heading">4 æ€»ç»“</h1><p>è¿™ä¸€ç¯‡ç®€å•ä»‹ç»äº†å››ç§å¸¸ç”¨çš„åŠ å¯†ç®—æ³•çš„å®ç°ï¼Œå½“ç„¶æœ€å¸¸ç”¨çš„å°±æ˜¯ MD5ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯å¤§å¤šæ•°ç³»ç»Ÿç”¨æ¥åšå¯†ç ä¿å­˜çš„åŠ å¯†ç®—æ³•ã€‚</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'åŠ å¯†ç®—æ³•','asp','net'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>