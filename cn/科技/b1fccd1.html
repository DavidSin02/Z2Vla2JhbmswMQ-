<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>域渗透神器-AD Explorer使用指南 | 极客快訊</title><meta property="og:title" content="域渗透神器-AD Explorer使用指南 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/e83434c3211740df93ac3180677e3e9f"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b1fccd1.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b1fccd1.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b1fccd1.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b1fccd1.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b1fccd1.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b1fccd1.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b1fccd1.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b1fccd1.html><meta property="article:published_time" content="2020-10-29T21:08:07+08:00"><meta property="article:modified_time" content="2020-10-29T21:08:07+08:00"><meta name=Keywords content><meta name=description content="域渗透神器-AD Explorer使用指南"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/b1fccd1.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>域渗透神器-AD Explorer使用指南</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>Mark Russinovich的Sysinternals工具（微软）大家都听说过。多年来，它们一直是系统管理员喜欢的工具。我也很喜欢这款工具，但我更喜欢的是AD Explorer，我一直使用它进行内部系统的测试和评估。</p><p>首先需要一个域帐户 （ 任何一个域帐户都可以 ）， 可以利用该账户与域控制器通信并用它枚举域。它能够列出域组织架构，用户帐户，计算机<span>帐户</span>等。它可以帮助你寻找特权用户和数据库服务器等敏感目标。与Sysinternals工具一样，AD Explorer是独立的可执行文件，无需安装。因此，只要您在某个文件夹有写入权限，就可以从http://live.sysinternals.com下载运行这个工具。</p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/e83434c3211740df93ac3180677e3e9f><p class=pgc-img-caption></p></div><p>如果没有写入权限或者不允许下载可执行文件，也可以直接从“运行”框或“资源管理器”窗口输入下面的UNC路径，在未下载文件到磁盘的情况下执行。</p><p>\\live.sysinternals.com\tools\ADExplorer.exe</p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/209f2e7903494410aa52397844b47952><p class=pgc-img-caption></p></div><p>点击可执行文件将其直接加载到内存中</p><p>让我们看几个示例。 首先找到有价值的目标，如下面的屏幕截图所示。在这里找到了CIO笔记本电脑。 可能每个人方法都不一样，但如果我知道CIO计算机的账户名，我会想办法登陆进去并从内存中拿到密码。 毕竟这是一个权限比较高的帐<span>户。</span></p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/83533aec6d034c0bbcc89bfd8bdf1397><p class=pgc-img-caption></p></div><p>可能还有其他有用的属性信息，比如“info”属性。 在下面的示例中，我们展示了实际测试中的某个域信息。 因为数据非常敏感，图片被打码了，这些信息提供给我很多社工的突破口（想想密码重置）！</p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/69624b4b14ed4769b20cc6686e226924><p class=pgc-img-caption></p></div><p>如果想找到有价值的敏感服务器，可以看下服务器的名称。 因为服务器经常根据其功能命名。例如， 数据库服务器名称中经常带有“SQL”。</p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/7ebdb2f4e0c447dab9246c326d52fe7a><p class=pgc-img-caption></p></div><p>而AD Explorer中的搜索功能也非常出色，可以对大量数据进行分类，帮助你找到需要的内容。 例如，是否需要识别已禁用的帐<span>户？</span> 只需选择userAccountControl属性并搜索值514。（实际上，userAccountControl属性含有多个标志，其中一个标志是“禁用”标志，这里有多个值可以表示账户已禁用，一般这个值为514。）</p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fa2f39333ca34ddb88787cacd1a9babb><p class=pgc-img-caption></p></div><p>如果你具有足够高的权限，则还可以添加和修改对象和属性。 虽然它的功能还是有限，但对内网渗透仍有很大帮助。 在下图中，我在测试域中为用户Grace添加了“Comment”属性。</p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/160b940b33634b5e9e6fb9a0fd963f7e><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8a75a24517c34fab972bb22af886e5eb><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p>并且这个工具还有保存快照的功能，你可以随时保存快照并在AD Explorer中将其打开查看。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0974bb780abb48c5a1a6cd228b98b44b><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/392b11970c464880b264fc3cce9e3ecb><p class=pgc-img-caption></p></div><p>查看快照不会改变目标系统任何设置，非常适合进行信息收集。</p><p>AD Explorer还可以比较两个快照的“差异”。在渗透测试前拍摄快照，如果内部人员更改了某些系统的密码，此时再拍摄一个快照，观察谁更改了密码或哪些已被禁用。虽然AD Explorer不能修改密码或将状态从禁用更改为启用，但可以很隐蔽的监视检查帐户禁用状态。</p><p>对于外部测试，如果要使用AD Explorer连接到服务器，则需要提供域帐户。 在shodan上针对两个常见的LDAP端口和包含“DC”的主机名进行搜索，会发现有很多服务器可以直接从互联网访问。</p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5cf9ee92fdc3499897d8dceb5cff8b7f><p class=pgc-img-caption></p></div><p>或者更进一步，再添加445端口，查找可能会受到SMB漏洞攻击的域控制器。 （注意：并非所有服务器都打开了这三个端口。）</p><p>如果域控服务器被成功控制，整个域中的服务器也将被控制。检查并确保你的服务器不在shodan的搜索结果之内。</p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/98ba8ffdf6034d9fa8e36ce92a6cc979><p class=pgc-img-caption></p></div><h1>!! 2018年5月新添加的提示和技巧!!</h1><p>1.使用AD Explorer进行网络钓鱼</p><p>如果要从外部电子邮件地址向特定组发送有针对性的钓鱼邮件，则可以查询域信息以获取允许收到外部邮件的通讯组。 当 msExchRequireAuthToSendTo属性为False时，任何人都可以向该组发送邮件。</p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/acce7862c0274d478591bf844e2ef219><p class=pgc-img-caption></p></div><p>你还可以双击搜索结果中的组，然后检查组的成员属性以获取成员列表。 可以通过这种方式提取单个电子邮件地址，这么做比较麻烦，但这样可以使电子邮件中的收件人看起来更加可信。</p><p>2.从命令行创建快照</p><p>AD Explorer有图形化界面，但是图形化界面有时会报错。 你可以从shell中创建一个快照。将AD Explorer上传到目标服务器，并使用以下命令：</p><pre>adexplorer.exe -snapshot "" mysnap.dat</pre><p>或者以不写入文件的方式来执行：</p><pre>\\live.sysinternals.com\tools\adexplorer.exe -snapshot "" snap.dat</pre><p>你可以输入“adexplorer /？”来查看语法：</p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c23116c527a343609e83f37cd9adfe4d><p class=pgc-img-caption></p></div><p>3.寻找特权账户</p><p>此外，如果你想寻找特权帐户，不要忘记检查Builtin Administrators组。 里面的帐户不一定是域管理员，但可能是可以访问域控制器的本地管理员!</p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d041005b890f45e5bbda9212bb0a1610><p class=pgc-img-caption></p></div><p>4.寻找密码</p><p>在大多数域的模式中，有3-4个字段似乎很常见，UserPassword，UnixUserPassword，unicodePwd和msSFU30Password。 在大量测试中，我们发现这些字段中的一个或多个都代表了ACTUAL密码。 虽然有时会通过转换为ASCII十进制等值来进行混淆，但可以通过“man ascii”来进行破解。</p><p>以下是我们最近拍摄的快照示例。</p><div class=pgc-img><img alt="域渗透神器-AD Explorer使用指南" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4d348d7333784f4ba5226682ae7db127><p class=pgc-img-caption></p></div><p>上图中这两个密码相同，解码都为A B C D！ e f g h 1 2 3 4 5 $ 6 7 8 9 0。如果你知道使用AD Explorer的任何其他提示或技巧，请联系我们。</p><p>谢谢！</p><p>本文由白帽汇整理并翻译，不代表白帽汇任何观点和立场</p><p>来源：https://nosec.org/home/detail/2432.html</p><p>原文：https://www.blackhillsinfosec.com/domain-goodness-learned-love-ad-explorer/</p><p>白帽汇从事信息安全，专注于安全大数据、企业威胁情报。</p><p>公司产品：FOFA-网络空间安全搜索引擎、FOEYE-网络空间检索系统、NOSEC-安全讯息平台。</p><p>为您提供：网络空间测绘、企业资产收集、企业威胁情报、应急响应服务。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'渗透','AD','Explorer'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>