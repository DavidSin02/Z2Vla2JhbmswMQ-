<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>æ‰‹æŠŠæ‰‹æ•™ä½ æ·±å…¥Vue3.0(Vue-cli4)é¡¹ç›®æ‰“åŒ…æ€§èƒ½ä¼˜åŒ–å®è·µ | æå®¢å¿«è¨Š</title><meta property="og:title" content="æ‰‹æŠŠæ‰‹æ•™ä½ æ·±å…¥Vue3.0(Vue-cli4)é¡¹ç›®æ‰“åŒ…æ€§èƒ½ä¼˜åŒ–å®è·µ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/dfic-imagehandler/74bc0f6c-b499-4760-b2fa-fed55f35f7f5"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b7542fc7.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b7542fc7.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b7542fc7.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b7542fc7.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b7542fc7.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b7542fc7.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b7542fc7.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b7542fc7.html><meta property="article:published_time" content="2020-11-14T21:01:37+08:00"><meta property="article:modified_time" content="2020-11-14T21:01:37+08:00"><meta name=Keywords content><meta name=description content="æ‰‹æŠŠæ‰‹æ•™ä½ æ·±å…¥Vue3.0(Vue-cli4)é¡¹ç›®æ‰“åŒ…æ€§èƒ½ä¼˜åŒ–å®è·µ"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/b7542fc7.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>æ‰‹æŠŠæ‰‹æ•™ä½ æ·±å…¥Vue3.0(Vue-cli4)é¡¹ç›®æ‰“åŒ…æ€§èƒ½ä¼˜åŒ–å®è·µ</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p><br></p><div class=pgc-img><img alt=æ‰‹æŠŠæ‰‹æ•™ä½ æ·±å…¥Vue3.0(Vue-cli4)é¡¹ç›®æ‰“åŒ…æ€§èƒ½ä¼˜åŒ–å®è·µ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/dfic-imagehandler/74bc0f6c-b499-4760-b2fa-fed55f35f7f5><p class=pgc-img-caption></p></div><p><br></p><blockquote><p>è®°å½•äº†è‡ªå·±çš„åšå®¢åœ¨ç¦ç”¨ç¼“å­˜çš„æƒ…å†µä¸‹ï¼Œä»å…«ä¹ç§’åŠ è½½æ—¶é—´åˆ°æœ€ç»ˆ985msçš„ä¼˜åŒ–å®è·µï¼Œå¼€å¯ç¼“å­˜çš„æƒ…å†µä¸‹èƒ½è¾¾åˆ°138msçš„è®¿é—®é€Ÿåº¦</p></blockquote><h1 class=pgc-h-arrow-right>æœ¬äººçš„ä¸ªäººåšå®¢é‡‡ç”¨çš„æ˜¯Vue-cli4.1.2 + typescriptæ„å»ºçš„ï¼Œé¡¹ç›®ç›®å½•ç»“æ„å¦‚ä¸‹</h1><pre><code>â”œâ”€ src    //ä¸»æ–‡ä»¶â”‚  â”œâ”€ api    //æ¥å£æ–‡ä»¶å¤¹|  |  |- config.js    //åç«¯æ¥å£åœ°å€çš„é…ç½®,å°†æµ‹è¯•ã€å¼€å‘ã€ç”Ÿäº§ç¯å¢ƒåˆ†å¼€|  |  â””â”€ user.js      //æ¥å£æ–‡ä»¶ï¼Œé…ç½®äº†tokenè¯·æ±‚å¤´ï¼Œå…·ä½“æ¥å£æ ¹æ®éœ€æ±‚ä¿®æ”¹â”‚  â”œâ”€ assets   //èµ„æºæ–‡ä»¶   â”‚  â”œâ”€ components   //å…¬ç”¨ç»„ä»¶â”‚  â”œâ”€ directive   //vueè‡ªå®šä¹‰æŒ‡ä»¤|  â”œâ”€ filters      //å­˜æ”¾è¿‡æ»¤å™¨æ–‡ä»¶ï¼Œè‡ªå¸¦äº†æ‰‹æœºå·åŠ å¯†ï¼Œæ‰‹æœºå·æ ¼å¼åŒ–ï¼Œæ—¶é—´æ—¥æœŸå¤„ç†|  â”œâ”€ interceptors    //å­˜æ”¾axiosæ‹¦æˆªå™¨é…ç½®ï¼Œå†™å…¥äº†æ¥å£è°ƒç”¨çš„loadingåŠ è½½ä»¥åŠhttpçŠ¶æ€ç æŠ¥é”™æ‹¦æˆª|  â”œâ”€ interceptors    //æ”¾ç½®å…¬ç”¨çš„æ¥å£ï¼Œå¯¹æ•°æ®è¿›è¡Œç±»å‹é™åˆ¶|  â”œâ”€ layout      //å¸ƒå±€æ–‡ä»¶ï¼Œé€šè¿‡å­è·¯ç”±æ¸²æŸ“æ–¹å¼å®ç°ï¼Œå…·ä½“HTMLå¸ƒå±€æ ¹æ®éœ€æ±‚ä¿®æ”¹  |  â”œâ”€ mixins      //æ··å…¥æ–‡ä»¶ï¼Œé…ç½®äº†ä¸€ä¸ªå¹³æ»‘æ»šåŠ¨çš„æ–¹æ³•|  â”œâ”€ plugins     //å¤–éƒ¨æ’ä»¶æ–‡ä»¶å¤¹ï¼Œé…ç½®äº†æŒ‰éœ€å¼•å…¥çš„element-ui|  â”œâ”€ reg    //å­˜æ”¾æ­£åˆ™ä»¥åŠæ ¡éªŒçš„æ–‡ä»¶å¤¹|  |  |- reg.ts      //å­˜æ”¾æ­£åˆ™è¡¨è¾¾å¼ï¼Œè‡ªå¸¦äº†ä¼ çœŸï¼Œé‚®ç®±ï¼Œqqï¼Œæ‰‹æœºå·ï¼Œé“¶è¡Œå¡å·ï¼Œå›ºå®šç”µè¯ï¼Œå¯†ç å¼ºåº¦æ ¡éªŒæ­£åˆ™|  |  â””â”€ validator.ts      //å­˜æ”¾element-uiè‡ªå®šä¹‰æ ¡éªŒï¼Œè‡ªå¸¦äº†ä¼ çœŸï¼Œé‚®ç®±ï¼Œqqï¼Œæ‰‹æœºå·ï¼Œé“¶è¡Œå¡å·ï¼Œå›ºå®šç”µè¯ï¼Œå¯†ç å¼ºåº¦è‡ªå®šä¹‰æ ¡éªŒ|  â”œâ”€ router      //è·¯ç”±æ–‡ä»¶|  â”œâ”€ store       //vuexå…¨å±€å˜é‡æ–‡ä»¶|  |  |- index.ts      //storeä¸»æ–‡ä»¶|  |  â””â”€ module     //storeæ¨¡å—æ–‡ä»¶å¤¹|  |  |  â””â”€ user.ts      //å­˜æ”¾userç›¸å…³çš„å…¨å±€å˜é‡|  â”œâ”€ stylus   //cssé¢„å¤„ç†å™¨æ–‡ä»¶å¤¹|  |  |- reset.styl      //æ ·å¼åˆå§‹åŒ–æ–‡ä»¶,è‡ªå¸¦äº†éæ ‡å‡†ç›’å­ï¼Œaæ ‡ç­¾æ¸…é™¤ä¸‹åˆ’çº¿ï¼Œæ¸…é™¤å†…å¤–è¾¹è·ï¼Œç¦æ­¢å›¾ç‰‡æ‹–æ‹½ç­‰æ•ˆæœ|  |  â””â”€ color.styl     //é¢œè‰²å˜é‡æ–‡ä»¶|  â”œâ”€ utils   //å…¬ç”¨æ–¹æ³•æ–‡ä»¶å¤¹|  |  |- area.ts      //å­˜æ”¾çœå¸‚åŒºä¸‰çº§åœ°åŒºçš„æ•°æ®|  |  |- array.ts      //å­˜æ”¾æ•°ç»„ç›¸å…³çš„å…¬ç”¨æ–¹æ³•ï¼Œè‡ªå¸¦äº†ä¸¤ä¸ªå…ƒç´ äº¤æ¢ä½ç½®ï¼Œå…ƒç´ å‰è¿›åé€€ä¸€æ ¼ï¼Œå…ƒç´ ç½®é¡¶æˆ–æœ«å°¾ï¼Œå»é‡ï¼Œåˆ é™¤æŒ‡å®šå…ƒç´ æ“ä½œ|  |  â””â”€ object.ts    //å­˜æ”¾å¯¹è±¡ç›¸å…³çš„å…¬ç”¨æ–¹æ³•ï¼Œè‡ªå¸¦äº†å¯¹è±¡æ¸…ç©ºæ‰€æœ‰å€¼çš„æ–¹æ³•|  â”œâ”€ views   //é¡µé¢æ–‡ä»¶å¤¹|  â”œâ”€ main.ts   //ä¸»é…ç½®æ–‡ä»¶|  â”œâ”€ babel.config.js   //babelé…ç½®æ–‡ä»¶ï¼Œå†™å…¥äº†element-uiæŒ‰éœ€åŠ è½½çš„é…ç½®|  â”œâ”€ package.json   //npmçš„åŒ…ç®¡ç†æ–‡ä»¶|  â”œâ”€ tsconfig.json   //tsé…ç½®æ–‡ä»¶|  â”œâ”€ vue.config.js   //vueé…ç½®æ–‡ä»¶</code></pre><h1 class=pgc-h-arrow-right>1.å…³é—­productionSourceMap</h1><h1 class=pgc-h-arrow-right>é¦–å…ˆï¼Œç”±äºæœ€æ–°ç‰ˆçš„è„šæ‰‹æ¶ä¸è‡ªå¸¦é…ç½®æ–‡ä»¶äº†ï¼Œå…ˆåœ¨æ ¹ç›®å½•æ–°å»ºvue.config.jsæ–‡ä»¶ï¼Œå…³é—­productionSourceMapï¼Œåœ¨vue.config.jsä¸­å†™å…¥å¦‚ä¸‹å†…å®¹</h1><pre><code>module.exports = {    productionSourceMap: false}</code></pre><h1 class=pgc-h-arrow-right>2.å¼€å¯Gzipå‹ç¼©</h1><h1 class=pgc-h-arrow-right>å®‰è£…æ’ä»¶compression-webpack-pluginï¼Œæ‰“å¼€ä»£ç å‹ç¼©ï¼Œnpm install --save-dev compression-webpack-pluginï¼Œç°åœ¨çš„vue.config.jsä»£ç å¦‚ä¸‹ï¼Œä½†æ˜¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæœåŠ¡å™¨ä¸Šnginxä¹Ÿå¿…é¡»å¼€å¯gzipæ‰èƒ½ç”Ÿæ•ˆ</h1><pre><code>// æ˜¯å¦ä¸ºç”Ÿäº§ç¯å¢ƒconst isProduction = process.env.NODE_ENV !== 'development';// gzipå‹ç¼©const CompressionWebpackPlugin = require('compression-webpack-plugin')module.exports = {    productionSourceMap: false,    configureWebpack: config =&gt; {        // ç”Ÿäº§ç¯å¢ƒç›¸å…³é…ç½®        if (isProduction) {            //gzipå‹ç¼©            const productionGzipExtensions = ['html', 'js', 'css']            config.plugins.push(                new CompressionWebpackPlugin({                    filename: '[path].gz[query]',                    algorithm: 'gzip',                    test: new RegExp(                        '\\.(' + productionGzipExtensions.join('|') + ')$'                    ),                    threshold: 10240, // åªæœ‰å¤§å°å¤§äºè¯¥å€¼çš„èµ„æºä¼šè¢«å¤„ç† 10240                    minRatio: 0.8, // åªæœ‰å‹ç¼©ç‡å°äºè¿™ä¸ªå€¼çš„èµ„æºæ‰ä¼šè¢«å¤„ç†                    deleteOriginalAssets: false // åˆ é™¤åŸæ–‡ä»¶                })            )        }    }}</code></pre><h1 class=pgc-h-arrow-right>æ‰“å¼€nginxæ–‡ä»¶å¤¹ä¸‹çš„nginx.confæ–‡ä»¶ï¼Œåœ¨httpæ¨¡å—ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹</h1><pre><code>    # å¼€å¯gzip    gzip on;    # å¯ç”¨gzipå‹ç¼©çš„æœ€å°æ–‡ä»¶ï¼Œå°äºè®¾ç½®å€¼çš„æ–‡ä»¶å°†ä¸ä¼šå‹ç¼©    gzip_min_length 1k;    # gzip å‹ç¼©çº§åˆ«ï¼Œ1-9ï¼Œæ•°å­—è¶Šå¤§å‹ç¼©çš„è¶Šå¥½ï¼Œä¹Ÿè¶Šå ç”¨CPUæ—¶é—´ï¼Œåé¢ä¼šæœ‰è¯¦ç»†è¯´æ˜    gzip_comp_level 2;    # è¿›è¡Œå‹ç¼©çš„æ–‡ä»¶ç±»å‹ã€‚javascriptæœ‰å¤šç§å½¢å¼ï¼Œåé¢çš„å›¾ç‰‡å‹ç¼©ä¸éœ€è¦çš„å¯ä»¥è‡ªè¡Œåˆ é™¤    gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;    # æ˜¯å¦åœ¨http headerä¸­æ·»åŠ Vary: Accept-Encodingï¼Œå»ºè®®å¼€å¯    gzip_vary on;    # è®¾ç½®å‹ç¼©æ‰€éœ€è¦çš„ç¼“å†²åŒºå¤§å°         gzip_buffers 4 16k;</code></pre><h1 class=pgc-h-arrow-right>ç„¶åè¾“å…¥å‘½ä»¤nginx -s reloadé‡å¯nginxæœåŠ¡</h1><h1 class=pgc-h-arrow-right>å¦‚æœåç«¯nginxå¼€å¯äº†gzipï¼Œå¯ä»¥ä»networkä¸­çš„Content-Encodingä¸­çœ‹åˆ°gzip</h1><div class=pgc-img><img alt=æ‰‹æŠŠæ‰‹æ•™ä½ æ·±å…¥Vue3.0(Vue-cli4)é¡¹ç›®æ‰“åŒ…æ€§èƒ½ä¼˜åŒ–å®è·µ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e70a88ce90c24786994587a5872403e3><p class=pgc-img-caption></p></div><p>image.png</p><h1 class=pgc-h-arrow-right>3.å¼€å¯CDNåŠ é€Ÿ(å»ºè®®é€‰é…ï¼ŒCDNè™½ç„¶é€Ÿåº¦å¿«ï¼Œä½†æ²¡æœ‰æœ¬åœ°æ‰“åŒ…ç¨³å®š)</h1><h1 class=pgc-h-arrow-right>å°†ä½¿ç”¨çš„æ’ä»¶ä½¿ç”¨cdné“¾æ¥ï¼Œå¹¶ä¸”é…ç½®webpackå°†ä½¿ç”¨CDNçš„æ’ä»¶ä¸è¿›è¡Œæ‰“åŒ…ï¼Œåˆ«å¿˜è®°è¿˜è¦å†index.htmlä¸­å¼•å…¥jsä»¥åŠcss</h1><pre><code>// æ˜¯å¦ä¸ºç”Ÿäº§ç¯å¢ƒconst isProduction = process.env.NODE_ENV !== 'development';// æœ¬åœ°ç¯å¢ƒæ˜¯å¦éœ€è¦ä½¿ç”¨cdnconst devNeedCdn = false// cdné“¾æ¥const cdn = {    // cdnï¼šæ¨¡å—åç§°å’Œæ¨¡å—ä½œç”¨åŸŸå‘½åï¼ˆå¯¹åº”windowé‡Œé¢æŒ‚è½½çš„å˜é‡åç§°ï¼‰    externals: {        vue: 'Vue',        vuex: 'Vuex',        'vue-router': 'VueRouter',        'marked': 'marked',        'highlight.js': 'hljs',        'nprogress': 'NProgress'    },    // cdnçš„cssé“¾æ¥    css: [        'https://cdn.bootcss.com/nprogress/0.2.0/nprogress.min.css'    ],    // cdnçš„jsé“¾æ¥    js: [        'https://cdn.bootcss.com/vue/2.6.10/vue.min.js',        'https://cdn.bootcss.com/vuex/3.1.2/vuex.min.js',        'https://cdn.bootcss.com/vue-router/3.1.3/vue-router.min.js',        'https://cdn.bootcss.com/marked/0.8.0/marked.min.js',        'https://cdn.bootcss.com/highlight.js/9.18.1/highlight.min.js',        'https://cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js'    ]}module.exports = {    chainWebpack: config =&gt; {        // ============æ³¨å…¥cdn start============        config.plugin('html').tap(args =&gt; {            // ç”Ÿäº§ç¯å¢ƒæˆ–æœ¬åœ°éœ€è¦cdnæ—¶ï¼Œæ‰æ³¨å…¥cdn            if (isProduction || devNeedCdn) args[0].cdn = cdn            return args        })        // ============æ³¨å…¥cdn start============    },    configureWebpack: config =&gt; {        // ç”¨cdnæ–¹å¼å¼•å…¥ï¼Œåˆ™æ„å»ºæ—¶è¦å¿½ç•¥ç›¸å…³èµ„æº        if (isProduction || devNeedCdn) config.externals = cdn.externals    }}</code></pre><h1 class=pgc-h-arrow-right>æ¥ä¸‹æ¥ï¼Œåœ¨index.htmlä¸­å¼•å…¥ä½¿ç”¨äº†CDNçš„é“¾æ¥</h1><pre><code>&lt;!DOCTYPE html&gt;&lt;html lang="en" style="width: 100%;height: 100%;"&gt;  &lt;head&gt;    &lt;meta charset="utf-8"&gt;    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;    &lt;meta name="viewport" content="width=device-width,initial-scale=1.0"&gt;    &lt;link rel="icon" href="&lt;%= BASE_URL %&gt;favicon.ico"&gt;    &lt;!-- ä½¿ç”¨CDNçš„CSSæ–‡ä»¶ --&gt;    &lt;% for (var i in htmlWebpackPlugin.options.cdn &amp;&amp;    htmlWebpackPlugin.options.cdn.css) { %&gt;    &lt;link            href="&lt;%= htmlWebpackPlugin.options.cdn.css[i] %&gt;"            rel="stylesheet"    /&gt;    &lt;% } %&gt;    &lt;!-- ä½¿ç”¨CDNçš„CSSæ–‡ä»¶ --&gt;    &lt;title&gt;CoolDream&lt;/title&gt;  &lt;/head&gt;  &lt;body style="width: 100%;height: 100%;"&gt;    &lt;noscript&gt;      &lt;strong&gt;We're sorry but blog doesn't work properly without JavaScript enabled. Please enable it to continue.&lt;/strong&gt;    &lt;/noscript&gt;    &lt;div id="app"&gt;&lt;/div&gt;    &lt;!-- built files will be auto injected --&gt;    &lt;!-- ä½¿ç”¨CDNçš„JSæ–‡ä»¶ --&gt;    &lt;% for (var i in htmlWebpackPlugin.options.cdn &amp;&amp;    htmlWebpackPlugin.options.cdn.js) { %&gt;    &lt;script src="&lt;%= htmlWebpackPlugin.options.cdn.js[i] %&gt;"&gt;&lt;/script&gt;    &lt;% } %&gt;    &lt;!-- ä½¿ç”¨CDNçš„JSæ–‡ä»¶ --&gt;  &lt;/body&gt;&lt;/html&gt;</code></pre><h1 class=pgc-h-arrow-right>æ‰“åŒ…åæŠ›åˆ°æœåŠ¡å™¨ä¸Šï¼Œæ‰“å¼€å¼€å‘è€…å·¥å…·çš„networkï¼Œå¦‚æœçœ‹åˆ°httpè¯·æ±‚cdnï¼Œé‚£ä¹ˆå°±ä»£è¡¨é…ç½®æˆåŠŸäº†ï¼Œå¦‚å›¾æ‰€ç¤º</h1><div class=pgc-img><img alt=æ‰‹æŠŠæ‰‹æ•™ä½ æ·±å…¥Vue3.0(Vue-cli4)é¡¹ç›®æ‰“åŒ…æ€§èƒ½ä¼˜åŒ–å®è·µ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e665f20f5b1b4dca8b51c39ad75d6612><p class=pgc-img-caption></p></div><p>image.png</p><h1 class=pgc-h-arrow-right>4.ä»£ç å‹ç¼©</h1><h1 class=pgc-h-arrow-right>å…ˆå®‰è£…æ’ä»¶npm i -D uglifyjs-webpack-plugin</h1><h1 class=pgc-h-arrow-right>ç„¶ååœ¨æœ€ä¸Šæ–¹å¼•å…¥ä¾èµ–</h1><pre><code>// ä»£ç å‹ç¼©const UglifyJsPlugin = require('uglifyjs-webpack-plugin')</code></pre><h1 class=pgc-h-arrow-right>åœ¨configureWebpackæ¨¡å—ä¸­å¼•å…¥ä»£ç å‹ç¼©</h1><pre><code>// ä»£ç å‹ç¼©config.plugins.push(    new UglifyJsPlugin({        uglifyOptions: {            //ç”Ÿäº§ç¯å¢ƒè‡ªåŠ¨åˆ é™¤console            compress: {                drop_debugger: true,                drop_console: true,                pure_funcs: ['console.log']            }        },        sourceMap: false,        parallel: true    }))</code></pre><h1 class=pgc-h-arrow-right>5.å…¬å…±ä»£ç æŠ½ç¦»ï¼Œå†™åœ¨configureWebpackæ¨¡å—ä¸­</h1><pre><code>// å…¬å…±ä»£ç æŠ½ç¦»config.optimization = {    splitChunks: {        cacheGroups: {            vendor: {                chunks: 'all',                test: /node_modules/,                name: 'vendor',                minChunks: 1,                maxInitialRequests: 5,                minSize: 0,                priority: 100            },            common: {                chunks: 'all',                test: /[\\/]src[\\/]js[\\/]/,                name: 'common',                minChunks: 2,                maxInitialRequests: 5,                minSize: 0,                priority: 60            },            styles: {                name: 'styles',                test: /\.(sa|sc|c)ss$/,                chunks: 'all',                enforce: true            },            runtimeChunk: {                name: 'manifest'            }        }    }}</code></pre><h1 class=pgc-h-arrow-right>6.å›¾ç‰‡å‹ç¼©()</h1><h1 class=pgc-h-arrow-right>1.ä½¿ç”¨å›¾ç‰‡å‹ç¼©æ’ä»¶</h1><ul><li>å…ˆå®‰è£…æ’ä»¶npm install image-webpack-loader --save-dev</li><li>åœ¨chainWebpackä¸­æ–°å¢ä»¥ä¸‹ä»£ç </li></ul><pre><code>// ============å‹ç¼©å›¾ç‰‡ start============config.module    .rule('images')    .use('image-webpack-loader')    .loader('image-webpack-loader')    .options({ bypassOnDebug: true })    .end()// ============å‹ç¼©å›¾ç‰‡ end============</code></pre><ul><li>æ‰€ä»¥æœ€ç»ˆçš„é…ç½®å¦‚ä¸‹</li></ul><pre><code>// æ˜¯å¦ä¸ºç”Ÿäº§ç¯å¢ƒconst isProduction = process.env.NODE_ENV !== 'development';// ä»£ç å‹ç¼©const UglifyJsPlugin = require('uglifyjs-webpack-plugin')// gzipå‹ç¼©const CompressionWebpackPlugin = require('compression-webpack-plugin')// æœ¬åœ°ç¯å¢ƒæ˜¯å¦éœ€è¦ä½¿ç”¨cdnconst devNeedCdn = false// cdné“¾æ¥const cdn = {    // cdnï¼šæ¨¡å—åç§°å’Œæ¨¡å—ä½œç”¨åŸŸå‘½åï¼ˆå¯¹åº”windowé‡Œé¢æŒ‚è½½çš„å˜é‡åç§°ï¼‰    externals: {        vue: 'Vue',        vuex: 'Vuex',        'vue-router': 'VueRouter',        'marked': 'marked',        'highlight.js': 'hljs',        'nprogress': 'NProgress'    },    // cdnçš„cssé“¾æ¥    css: [        'https://cdn.bootcss.com/nprogress/0.2.0/nprogress.min.css'    ],    // cdnçš„jsé“¾æ¥    js: [        'https://cdn.bootcss.com/vue/2.6.10/vue.min.js',        'https://cdn.bootcss.com/vuex/3.1.2/vuex.min.js',        'https://cdn.bootcss.com/vue-router/3.1.3/vue-router.min.js',        'https://cdn.bootcss.com/marked/0.8.0/marked.min.js',        'https://cdn.bootcss.com/highlight.js/9.18.1/highlight.min.js',        'https://cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js'    ]}module.exports = {    productionSourceMap: false,    chainWebpack: config =&gt; {        // ============æ³¨å…¥cdn start============        config.plugin('html').tap(args =&gt; {            // ç”Ÿäº§ç¯å¢ƒæˆ–æœ¬åœ°éœ€è¦cdnæ—¶ï¼Œæ‰æ³¨å…¥cdn            if (isProduction || devNeedCdn) args[0].cdn = cdn            return args        })        // ============æ³¨å…¥cdn start============        // ============å‹ç¼©å›¾ç‰‡ start============        config.module            .rule('images')            .use('image-webpack-loader')            .loader('image-webpack-loader')            .options({ bypassOnDebug: true })            .end()        // ============å‹ç¼©å›¾ç‰‡ end============    },    configureWebpack: config =&gt; {        // ç”¨cdnæ–¹å¼å¼•å…¥ï¼Œåˆ™æ„å»ºæ—¶è¦å¿½ç•¥ç›¸å…³èµ„æº        if (isProduction || devNeedCdn) config.externals = cdn.externals        // ç”Ÿäº§ç¯å¢ƒç›¸å…³é…ç½®        if (isProduction) {            //gzipå‹ç¼©            const productionGzipExtensions = ['html', 'js', 'css']            config.plugins.push(                new CompressionWebpackPlugin({                    filename: '[path].gz[query]',                    algorithm: 'gzip',                    test: new RegExp(                        '\\.(' + productionGzipExtensions.join('|') + ')$'                    ),                    threshold: 10240, // åªæœ‰å¤§å°å¤§äºè¯¥å€¼çš„èµ„æºä¼šè¢«å¤„ç† 10240                    minRatio: 0.8, // åªæœ‰å‹ç¼©ç‡å°äºè¿™ä¸ªå€¼çš„èµ„æºæ‰ä¼šè¢«å¤„ç†                    deleteOriginalAssets: false // åˆ é™¤åŸæ–‡ä»¶                })            )            // ä»£ç å‹ç¼©            config.plugins.push(                new UglifyJsPlugin({                    uglifyOptions: {                        //ç”Ÿäº§ç¯å¢ƒè‡ªåŠ¨åˆ é™¤console                        compress: {                            drop_debugger: true,                            drop_console: true,                            pure_funcs: ['console.log']                        }                    },                    sourceMap: false,                    parallel: true                })            )        }        // å…¬å…±ä»£ç æŠ½ç¦»        config.optimization = {            splitChunks: {                cacheGroups: {                    vendor: {                        chunks: 'all',                        test: /node_modules/,                        name: 'vendor',                        minChunks: 1,                        maxInitialRequests: 5,                        minSize: 0,                        priority: 100                    },                    common: {                        chunks: 'all',                        test: /[\\/]src[\\/]js[\\/]/,                        name: 'common',                        minChunks: 2,                        maxInitialRequests: 5,                        minSize: 0,                        priority: 60                    },                    styles: {                        name: 'styles',                        test: /\.(sa|sc|c)ss$/,                        chunks: 'all',                        enforce: true                    },                    runtimeChunk: {                        name: 'manifest'                    }                }            }        }    }}</code></pre><h1 class=pgc-h-arrow-right>2.å°†é™æ€èµ„æºå­˜å‚¨åœ¨äº‘ç«¯ï¼Œä¸ªäººç”¨çš„ä¸ƒç‰›äº‘,å¯¹è±¡å­˜å‚¨ç”¨äºå­˜å‚¨æ–‡ä»¶ï¼Œä½¿ç”¨cdnåŠ é€Ÿè®©å­˜å‚¨çš„é™æ€èµ„æºè®¿é—®é€Ÿåº¦æ›´å¿«ã€‚(æ¨èï¼Œé€Ÿåº¦èƒ½å¿«æŒºå¤š)</h1><ul><li>æˆ‘ä¸ªäººç”³è¯·äº†ä¸ƒç‰›äº‘ï¼Œå®åè®¤è¯å°±æœ‰10Gç©ºé—´å¯ç”¨ï¼Œæ¯ä¸ªæœˆæœ‰10Gçš„å…è´¹æµé‡ï¼Œä¸è¿‡ä¸ç»‘å®šåŸŸåçš„è¯åªæœ‰30å¤©ä½“éªŒæœºä¼šï¼Œæˆ‘æ˜¯ç»‘å®šäº†æˆ‘çš„åŸŸåè¿›è¡ŒDNSè§£æä¸­è½¬ï¼Œå…·ä½“çš„æ“ä½œå¯ä»¥å‚è€ƒè¿™ä¸€ç¯‡åšå®¢ï¼Œhttps://www.cnblogs.com/mazhichu/p/12206785.html</li></ul><h1 class=pgc-h-arrow-right>7.nginxé…ç½®ç¼“å­˜åŒæ ·ä¹Ÿå¯ä»¥æé«˜ç½‘ç«™çš„è®¿é—®é€Ÿåº¦ï¼ˆè™½ç„¶è¿™ç‚¹æœ‰ç‚¹åç¦»å‰ç«¯æ‰“åŒ…ä¸»é¢˜äº†ï¼Œä½†æ˜¯å¯¹äºè‡ªå·±ç‹¬ç«‹å¼€å‘ä¸ªäººåšå®¢ç½‘ç«™çš„å‰ç«¯æ¥è¯´è¿˜æ˜¯éå¸¸æœ‰ç”¨çš„ï¼ï¼‰</h1><h1 class=pgc-h-arrow-right>åœ¨nginx.confçš„httpæ¨¡å—ä¸­å†™å…¥ä¸€ä¸‹å†…å®¹</h1><pre><code>     # è®¾ç½®ç¼“å­˜è·¯å¾„å¹¶ä¸”ä½¿ç”¨ä¸€å—æœ€å¤§100Mçš„å…±äº«å†…å­˜ï¼Œç”¨äºç¡¬ç›˜ä¸Šçš„æ–‡ä»¶ç´¢å¼•ï¼ŒåŒ…æ‹¬æ–‡ä»¶åå’Œè¯·æ±‚æ¬¡æ•°ï¼Œæ¯ä¸ªæ–‡ä»¶åœ¨1å¤©å†…è‹¥ä¸æ´»è·ƒï¼ˆæ— è¯·æ±‚ï¼‰åˆ™ä»ç¡¬ç›˜ä¸Šæ·˜æ±°ï¼Œç¡¬ç›˜ç¼“å­˜æœ€å¤§10Gï¼Œæ»¡äº†åˆ™æ ¹æ®LRUç®—æ³•è‡ªåŠ¨æ¸…é™¤ç¼“å­˜ã€‚    proxy_cache_path /var/cache/nginx/cache levels=1:2 keys_zone=imgcache:100m inactive=1d max_size=10g;</code></pre><h1 class=pgc-h-arrow-right>ç„¶ååœ¨nginx.confçš„serveæ¨¡å—ä¸­å†™å…¥ä¸€ä¸‹å†…å®¹ï¼Œä¿å­˜é…ç½®ï¼Œnginx -s reloadé‡å¯æœåŠ¡å³å¯çœ‹åˆ°æ•ˆæœ</h1><pre><code>location ~* ^.+\.(css|js|ico|gif|jpg|jpeg|png)$ { log_not_found off; # å…³é—­æ—¥å¿— access_log off; # ç¼“å­˜æ—¶é—´7å¤© expires 7d; # æºæœåŠ¡å™¨ proxy_pass http://localhost:8888; # æŒ‡å®šä¸Šé¢è®¾ç½®çš„ç¼“å­˜åŒºåŸŸ proxy_cache imgcache; # ç¼“å­˜è¿‡æœŸç®¡ç† proxy_cache_valid 200 302 1d; proxy_cache_valid 404 10m; proxy_cache_valid any 1h; proxy_cache_use_stale error timeout invalid_header updating http_500 http_502 http_503 http_504; }</code></pre></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Vue3.0','Vue','cli4'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>