<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Node è„šæœ¬é­é‡å¼‚å¸¸æ—¶å¦‚ä½•å®‰å…¨é€€å‡º | æå®¢å¿«è¨Š</title><meta property="og:title" content="Node è„šæœ¬é­é‡å¼‚å¸¸æ—¶å¦‚ä½•å®‰å…¨é€€å‡º - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/dfic-imagehandler/a871ebab-ec2d-4b54-9bf4-035082ee6005"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b85602e.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b85602e.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b85602e.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b85602e.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b85602e.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b85602e.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b85602e.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b85602e.html><meta property="article:published_time" content="2020-10-29T21:04:55+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:55+08:00"><meta name=Keywords content><meta name=description content="Node è„šæœ¬é­é‡å¼‚å¸¸æ—¶å¦‚ä½•å®‰å…¨é€€å‡º"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/b85602e.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Node è„šæœ¬é­é‡å¼‚å¸¸æ—¶å¦‚ä½•å®‰å…¨é€€å‡º</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div class=pgc-img><img alt="Node è„šæœ¬é­é‡å¼‚å¸¸æ—¶å¦‚ä½•å®‰å…¨é€€å‡º" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/dfic-imagehandler/a871ebab-ec2d-4b54-9bf4-035082ee6005><p class=pgc-img-caption></p></div><p class=pgc-end-literature>ä½œè€…ï¼šå±±æœˆè¡Œ</p><p class=pgc-end-literature>è½¬å‘é“¾æ¥ï¼šhttps://mp.weixin.qq.com/s/LihozvtnAcVTN8s_v_ylFg</p><h1 class=pgc-h-arrow-right>å‰è¨€</h1><p>ä¸€ä¸ª Node ç›¸å…³çš„é¡¹ç›®ä¸­ï¼Œæ€»æ˜¯å°‘ä¸äº†è·‘è„šæœ¬ã€‚è·‘ä¸€ä¸ªè„šæœ¬æ‹‰å–é…ç½®ã€å¤„ç†ä¸€äº›æ•°æ®ä»¥åŠå®šæ—¶ä»»åŠ¡æ›´æ˜¯å®¶å¸¸ä¾¿é¥­ã€‚</p><p>åœ¨ä¸€äº›é‡è¦æµç¨‹ä¸­èƒ½å¤Ÿçœ‹åˆ°è„šæœ¬çš„èº«å½±ï¼š</p><ol start=1><li><span style="color:#595959;--tt-darkmode-color: #595959">CIï¼Œç”¨äºæµ‹è¯•ã€è´¨é‡ä¿éšœåŠéƒ¨ç½²ç­‰</span></li><li><span style="color:#595959;--tt-darkmode-color: #595959">Dockerï¼Œç”¨ä»¥æ„å»ºé•œåƒ</span></li><li><span style="color:#595959;--tt-darkmode-color: #595959">Cronï¼Œç”¨äºå®šæ—¶ä»»åŠ¡</span></li></ol><p>å¦‚æœåœ¨è¿™äº›é‡è¦æµç¨‹ä¸­è„šæœ¬å‡ºé”™æ— æ³•åŠæ—¶å‘ç°é—®é¢˜ï¼Œå°†æœ‰å¯èƒ½å¼•å‘æ›´åŠ éšè”½çš„é—®é¢˜ã€‚</p><p>æœ€è¿‘è§‚å¯Ÿé¡¹ç›®é•œåƒæ„å»ºï¼Œä¼šå¶å°”å‘ç°ä¸€ä¸¤ä¸ªé•œåƒè™½ç„¶æ„å»ºæˆåŠŸï¼Œä½†å®¹å™¨å´è·‘ä¸èµ·æ¥çš„æƒ…å†µã€‚<strong><span style="color:#3594f7;--tt-darkmode-color: #3594F7">ã€Œç©¶å…¶åŸå› ï¼Œæ˜¯å› ä¸º Exit Code çš„é—®é¢˜ã€</span></strong>ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#40b8fa;--tt-darkmode-color: #40B8FA">Exit Code</span></strong></h1><blockquote><p><span style="color:#595959;--tt-darkmode-color: #595959">â</span></p><p><span style="color:#595959;--tt-darkmode-color: #595959">ä»€ä¹ˆæ˜¯ exit code?</span></p><p><span style="color:#595959;--tt-darkmode-color: #595959">â</span></p></blockquote><p><span style="color:#3594f7;--tt-darkmode-color: #3594F7">exit code</span> ä»£è¡¨ä¸€ä¸ªè¿›ç¨‹çš„è¿”å›ç ï¼Œé€šè¿‡ç³»ç»Ÿè°ƒç”¨ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">exit_group</span> æ¥è§¦å‘ã€‚åœ¨ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">POSIX</span> ä¸­ï¼Œ<span style="color:#3594f7;--tt-darkmode-color: #3594F7">0</span> ä»£è¡¨æ­£å¸¸çš„è¿”å›ç ï¼Œ<span style="color:#3594f7;--tt-darkmode-color: #3594F7">1-255</span> ä»£è¡¨å¼‚å¸¸è¿”å›ç ï¼Œä¸€èˆ¬ä¸»åŠ¨æŠ›å‡ºçš„é”™è¯¯ç éƒ½æ˜¯ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">1</span>ã€‚åœ¨ Node åº”ç”¨ä¸­ä½¿ç”¨ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">process.exitCode = 1</span> æ¥ä»£è¡¨å› ä¸æœŸæœ›çš„å¼‚å¸¸è€Œä¸­æ–­ã€‚</p><p>è¿™é‡Œæœ‰ä¸€å¼ å…³äºå¼‚å¸¸ç çš„é™„è¡¨ <span style="color:#595959;--tt-darkmode-color: #595959">Appendix E. Exit Codes With Special Meanings[1]</span>ã€‚</p><p>å¼‚å¸¸ç åœ¨æ“ä½œç³»ç»Ÿä¸­éšå¤„å¯è§ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªå…³äº <span style="color:#3594f7;--tt-darkmode-color: #3594F7">cat</span> å‘½ä»¤çš„å¼‚å¸¸ä»¥åŠå®ƒçš„ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">exit code</span>ï¼Œå¹¶ä½¿ç”¨ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">strace</span> è¿½è¸ªç³»ç»Ÿè°ƒç”¨ã€‚</p><pre><code>$Â catÂ acat:Â a:Â NoÂ suchÂ fileÂ orÂ directory#Â ä½¿ç”¨Â straceÂ æŸ¥çœ‹Â catÂ çš„ç³»ç»Ÿè°ƒç”¨#Â -eÂ åªæ˜¾ç¤ºÂ writeÂ ä¸Â exit_groupÂ çš„ç³»ç»Ÿè°ƒç”¨$Â straceÂ -eÂ write,exit_groupÂ catÂ awrite(2,Â "cat:Â ",Â 5cat:Â )Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â 5write(2,Â "a",Â 1a)Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â 1write(2,Â ":Â NoÂ suchÂ fileÂ orÂ directory",Â 27:Â NoÂ suchÂ fileÂ orÂ directory)Â =Â 27write(2,Â "\n",Â 1)Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â 1exit_group(1)Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â ?+++Â exitedÂ withÂ 1Â +++</code></pre><p>ä»ç³»ç»Ÿè°ƒç”¨çš„æœ€åä¸€è¡Œå¯ä»¥çœ‹å‡ºï¼Œè¯¥è¿›è¡Œçš„ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">exit code</span> æ˜¯ 1ï¼Œå¹¶æŠŠé”™è¯¯ä¿¡æ¯è¾“å‡ºåˆ° <span style="color:#3594f7;--tt-darkmode-color: #3594F7">stderr</span> (æ ‡å‡†é”™è¯¯çš„ fd ä¸º 2) ä¸­</p><h1 class=pgc-h-arrow-right><strong><span style="color:#40b8fa;--tt-darkmode-color: #40B8FA">å¦‚ä½•æŸ¥çœ‹ exit code</span></strong></h1><p>ä» <span style="color:#3594f7;--tt-darkmode-color: #3594F7">strace</span> ä¸­å¯ä»¥æ¥åˆ¤æ–­è¿›ç¨‹çš„ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">exit code</span>ï¼Œä½†æ˜¯ä¸å¤Ÿæ–¹ä¾¿è¿‡äºå†—ä½™ï¼Œç‰¹åˆ«èº«å¤„ shell ç¼–ç¨‹ç¯å¢ƒä¸­ã€‚</p><p><strong><span style="color:#3594f7;--tt-darkmode-color: #3594F7">ã€Œæœ‰ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼Œé€šè¿‡ echo $? æ¥ç¡®è®¤è¿”å›ç ã€</span></strong></p><pre><code>$Â catÂ acat:Â a:Â NoÂ suchÂ fileÂ orÂ directory$Â echoÂ $?1</code></pre><h1 class=pgc-h-arrow-right><strong><span style="color:#40b8fa;--tt-darkmode-color: #40B8FA">throw new Errorä¸Promise.rejectåŒºåˆ«</span></strong></h1><p>ä»¥ä¸‹æ˜¯ä¸¤æ®µä»£ç ï¼Œç¬¬ä¸€æ®µæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œç¬¬äºŒæ®µ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">Promise.reject</span>ï¼Œä¸¤æ®µä»£ç éƒ½ä¼šå¦‚ä¸‹æ‰“å°å‡ºä¸€æ®µå¼‚å¸¸ä¿¡æ¯ï¼Œé‚£ä¹ˆä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><pre><code>functionÂ errorÂ ()Â {Â Â throwÂ newÂ Error('hello,Â error')}error()//Â Output://Â /Users/shanyue/Documents/note/demo.js:2//Â Â Â throwÂ newÂ Error('hello,Â world')//Â Â Â ^////Â Error:Â hello,Â world//Â Â Â Â Â atÂ errorÂ (/Users/shanyue/Documents/note/demo.js:2:9)//Â Â Â Â Â atÂ Object.&lt;anonymous&gt;Â (/Users/shanyue/Documents/note/demo.js:5:1)//Â Â Â Â Â atÂ Module._compileÂ (internal/modules/cjs/loader.js:701:30)</code></pre><pre><code>asyncÂ functionÂ errorÂ ()Â {Â Â returnÂ newÂ Error('hello,Â error')}error()//Â Output://Â (node:60356)Â UnhandledPromiseRejectionWarning:Â Error:Â hello,Â world//Â Â Â Â atÂ errorÂ (/Users/shanyue/Documents/note/demo.js:2:9)//Â Â Â Â atÂ Object.&lt;anonymous&gt;Â (/Users/shanyue/Documents/note/demo.js:5:1)//Â Â Â Â atÂ Module._compileÂ (internal/modules/cjs/loader.js:701:30)//Â Â Â Â atÂ Object.Module._extensions..jsÂ (internal/modules/cjs/loader.js:712:10)//Â (node:2787)Â UnhandledPromiseRejectionWarning:Â UnhandledÂ promiseÂ rejection.Â ThisÂ errorÂ originatedÂ eitherÂ byÂ throwingÂ insideÂ ofÂ anÂ asyncÂ functionÂ withoutÂ aÂ catchÂ block,Â orÂ byÂ rejectingÂ aÂ promiseÂ whichÂ wasÂ notÂ handledÂ withÂ .catch().Â ToÂ terminateÂ theÂ nodeÂ processÂ onÂ unhandledÂ promiseÂ rejection,Â useÂ theÂ CLIÂ flagÂ `--unhandled-rejections=strict`Â (seeÂ https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode).Â (rejectionÂ id:Â 1)//Â (node:2787)Â [DEP0018]Â DeprecationWarning:Â UnhandledÂ promiseÂ rejectionsÂ areÂ deprecated.Â InÂ theÂ future,Â promiseÂ rejectionsÂ thatÂ areÂ notÂ handledÂ willÂ terminateÂ theÂ Node.jsÂ processÂ withÂ aÂ non-zeroÂ exitÂ code.</code></pre><p>åœ¨å¯¹ä¸Šè¿°ä¸¤ä¸ªæµ‹è¯•ç”¨ä¾‹ä½¿ç”¨ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">echo $?</span> æŸ¥çœ‹ exit codeï¼Œæˆ‘ä»¬ä¼šå‘ç°<span style="color:#3594f7;--tt-darkmode-color: #3594F7">throw new Error()</span> çš„ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">exit code</span> ä¸º 1ï¼Œè€Œ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">Promise.reject()</span> çš„ä¸º 0ã€‚</p><p><strong><span style="color:#3594f7;--tt-darkmode-color: #3594F7">ã€Œä»æ“ä½œç³»ç»Ÿçš„è§’åº¦æ¥è®²ï¼Œexit code ä¸º 0 ä»£è¡¨è¿›ç¨‹æˆåŠŸè¿è¡Œå¹¶é€€å‡ºï¼Œæ­¤æ—¶å³ä½¿æœ‰ Promise.rejectï¼Œæ“ä½œç³»ç»Ÿä¹Ÿä¼šè§†ä¸ºå®ƒæ‰§è¡ŒæˆåŠŸã€‚ã€</span></strong></p><p>è¿™åœ¨ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">Dockerfile</span> ä¸ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">CI</span> ä¸­å°†ç•™æœ‰å®‰å…¨éšæ‚£ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#40b8fa;--tt-darkmode-color: #40B8FA">Dockerfile åœ¨ node ä¸­çš„æ³¨æ„ç‚¹</span></strong></h1><p>å½“ä½¿ç”¨ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">Dockerfile</span> æ„å»ºé•œåƒæ—¶ï¼Œå¦‚æœ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">RUN</span> çš„è¿›ç¨‹è¿”å›é 0 çš„è¿”å›ç ï¼Œæ„å»ºå°±ä¼šå¤±è´¥ã€‚</p><p><strong><span style="color:#3594f7;--tt-darkmode-color: #3594F7">ã€Œè€Œåœ¨ Node ä¸­çš„é”™è¯¯å¤„ç†ä¸­ï¼Œæˆ‘ä»¬å€¾å‘äºæ‰€æœ‰çš„å¼‚å¸¸éƒ½äº¤ç”± async/await æ¥å¤„ç†ï¼Œè€Œå½“å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œç”±äºæ­¤æ—¶ exit code ä¸º 0 å¹¶ä¸ä¼šå¯¼è‡´é•œåƒæ„å»ºå¤±è´¥ã€‚ã€</span></strong></p><p>è¿™æ˜¯ä¸€ä¸ªæµ…æ˜¾æ˜“æ‡‚çš„å« <span style="color:#3594f7;--tt-darkmode-color: #3594F7">Promise.reject()</span> é—®é¢˜çš„é•œåƒã€‚</p><pre><code>FROMÂ node:12-alpineRUNÂ nodeÂ -eÂ "Promise.reject('hello,Â world')"</code></pre><p>æ„å»ºé•œåƒè¿‡ç¨‹å¦‚ä¸‹ï¼š<strong><span style="color:#3594f7;--tt-darkmode-color: #3594F7">ã€Œå³ä½¿åœ¨æ„å»ºè¿‡ç¨‹æ‰“å°å‡ºäº† unhandledPromiseRejection ä¿¡æ¯ï¼Œä½†æ˜¯é•œåƒä»ç„¶æ„å»ºæˆåŠŸã€‚ã€</span></strong></p><pre><code>$Â dockerÂ buildÂ -tÂ demoÂ .SendingÂ buildÂ contextÂ toÂ DockerÂ daemonÂ Â 33.28kBStepÂ 1/2Â :Â FROMÂ node:12-alpineÂ ---&gt;Â 18f4bc975732StepÂ 2/2Â :Â RUNÂ nodeÂ -eÂ "Promise.reject('hello,Â world')"Â ---&gt;Â RunningÂ inÂ 79a6d53c5aa6(node:1)Â UnhandledPromiseRejectionWarning:Â hello,Â world(node:1)Â UnhandledPromiseRejectionWarning:Â UnhandledÂ promiseÂ rejection.Â ThisÂ errorÂ originatedÂ eitherÂ byÂ throwingÂ insideÂ ofÂ anÂ asyncÂ functionÂ withoutÂ aÂ catchÂ block,Â orÂ byÂ rejectingÂ aÂ promiseÂ whichÂ wasÂ notÂ handledÂ withÂ .catch().Â ToÂ terminateÂ theÂ nodeÂ processÂ onÂ unhandledÂ promiseÂ rejection,Â useÂ theÂ CLIÂ flagÂ `--unhandled-rejections=strict`Â (seeÂ https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode).Â (rejectionÂ id:Â 1)(node:1)Â [DEP0018]Â DeprecationWarning:Â UnhandledÂ promiseÂ rejectionsÂ areÂ deprecated.Â InÂ theÂ future,Â promiseÂ rejectionsÂ thatÂ areÂ notÂ handledÂ willÂ terminateÂ theÂ Node.jsÂ processÂ withÂ aÂ non-zeroÂ exitÂ code.RemovingÂ intermediateÂ containerÂ 79a6d53c5aa6Â ---&gt;Â 09f07eb993feSuccessfullyÂ builtÂ 09f07eb993feSuccessfullyÂ taggedÂ demo:latest</code></pre><h1 class=pgc-h-arrow-right><strong><span style="color:#40b8fa;--tt-darkmode-color: #40B8FA">Promise.reject è„šæœ¬è§£å†³æ–¹æ¡ˆ</span></strong></h1><p>èƒ½åœ¨ç¼–è¯‘æ—¶èƒ½å‘ç°çš„é—®é¢˜ï¼Œç»ä¸è¦æ”¾åœ¨è¿è¡Œæ—¶ã€‚æ‰€ä»¥ï¼Œæ„å»ºé•œåƒæˆ– CI ä¸­éœ€è¦æ‰§è¡Œ node è„šæœ¬æ—¶ï¼Œå¯¹å¼‚å¸¸å¤„ç†éœ€è¦æ‰‹åŠ¨æŒ‡å®š <span style="color:#3594f7;--tt-darkmode-color: #3594F7">process.exitCode = 1</span> æ¥æå‰æš´éœ²é—®é¢˜</p><pre><code>runScript().catch(()Â =&gt;Â {Â Â process.exitCodeÂ =Â 1})</code></pre><p>åœ¨æ„å»ºé•œåƒæ—¶ï¼Œä¹Ÿæœ‰å…³äºå¼‚å¸¸è§£å†³æ–¹æ¡ˆçš„å»ºè®®ï¼š</p><blockquote><p><span style="color:#595959;--tt-darkmode-color: #595959">â</span></p><p><span style="color:#595959;--tt-darkmode-color: #595959">(node:1) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag </span><span style="color:#3594f7;--tt-darkmode-color: #3594F7">--unhandled-rejections=strict</span> (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 1)</p><p><span style="color:#595959;--tt-darkmode-color: #595959">â</span></p></blockquote><p>æ ¹æ®æç¤ºï¼Œ<span style="color:#3594f7;--tt-darkmode-color: #3594F7">--unhandled-rejections=strict</span> å°†ä¼šæŠŠ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">Promise.reject</span> çš„é€€å‡ºç è®¾ç½®ä¸º <span style="color:#3594f7;--tt-darkmode-color: #3594F7">1</span>ï¼Œå¹¶åœ¨å°†æ¥çš„ node ç‰ˆæœ¬ä¸­ä¿®æ­£ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">Promise</span>å¼‚å¸¸é€€å‡ºç ã€‚</p><pre><code>$Â nodeÂ --unhandled-rejections=strictÂ error.js</code></pre><p><span style="color:#3594f7;--tt-darkmode-color: #3594F7">--unhandled-rejections=strict</span> çš„é…ç½®å¯¹ node æœ‰ç‰ˆæœ¬è¦æ±‚ï¼š</p><blockquote><p><span style="color:#595959;--tt-darkmode-color: #595959">â</span></p><p><span style="color:#595959;--tt-darkmode-color: #595959">Added in: v12.0.0, v10.17.0</span></p><p><span style="color:#595959;--tt-darkmode-color: #595959">By default all unhandled rejections trigger a warning plus a deprecation warning for the very first unhandled rejection in case no unhandledRejection hook is used.</span></p><p><span style="color:#595959;--tt-darkmode-color: #595959">â</span></p></blockquote><h1 class=pgc-h-arrow-right><strong><span style="color:#40b8fa;--tt-darkmode-color: #40B8FA">æ€»ç»“</span></strong></h1><ol start=1><li><span style="color:#595959;--tt-darkmode-color: #595959">å½“è¿›ç¨‹ç»“æŸçš„ exit code ä¸ºé 0 æ—¶ï¼Œç³»ç»Ÿä¼šè®¤ä¸ºè¯¥è¿›ç¨‹æ‰§è¡Œå¤±è´¥</span></li><li><span style="color:#595959;--tt-darkmode-color: #595959">é€šè¿‡ </span><span style="color:#3594f7;--tt-darkmode-color: #3594F7">echo $?</span> å¯æŸ¥çœ‹ç»ˆç«¯ä¸Šä¸€è¿›ç¨‹çš„ exit code</li><li><span style="color:#595959;--tt-darkmode-color: #595959">Node ä¸­ </span><span style="color:#3594f7;--tt-darkmode-color: #3594F7">Promise.reject</span> æ—¶ exit code ä¸º 0</li><li><span style="color:#595959;--tt-darkmode-color: #595959">Node ä¸­å¯ä»¥é€šè¿‡ </span><span style="color:#3594f7;--tt-darkmode-color: #3594F7">process.exitCode = 1</span> æ˜¾å¼è®¾ç½® exit code</li><li><span style="color:#595959;--tt-darkmode-color: #595959">åœ¨ Node12+ ä¸­å¯ä»¥é€šè¿‡ </span><span style="color:#3594f7;--tt-darkmode-color: #3594F7">node --unhandled-rejections=strict error.js</span> æ‰§è¡Œè„šæœ¬ï¼Œè§† <span style="color:#3594f7;--tt-darkmode-color: #3594F7">Promise.reject</span> çš„ <span style="color:#3594f7;--tt-darkmode-color: #3594F7">exit code</span>ä¸º 1</li></ol><p class=pgc-end-literature>ä½œè€…ï¼šå±±æœˆè¡Œ</p><p class=pgc-end-literature>è½¬å‘é“¾æ¥ï¼šhttps://mp.weixin.qq.com/s/LihozvtnAcVTN8s_v_ylFg</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Node','è„šæœ¬','å¼‚å¸¸æ—¶'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>