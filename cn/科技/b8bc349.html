<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>「学术论文」红外成像组件中小型化处理板的设计 | 极客快訊</title><meta property="og:title" content="「学术论文」红外成像组件中小型化处理板的设计 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/RqE4Ccz3KmZHPy"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b8bc349.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b8bc349.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b8bc349.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b8bc349.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b8bc349.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b8bc349.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b8bc349.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b8bc349.html><meta property="article:published_time" content="2020-10-29T21:06:57+08:00"><meta property="article:modified_time" content="2020-10-29T21:06:57+08:00"><meta name=Keywords content><meta name=description content="「学术论文」红外成像组件中小型化处理板的设计"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/b8bc349.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>「学术论文」红外成像组件中小型化处理板的设计</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><blockquote class=pgc-blockquote-abstract toutiao-origin=p>摘要：</blockquote><p>在小型化红外成像组件中，处理板是核心。详细介绍了小型化处理板设计过程中的各项工作，包括：总体方案设计、主要器件选型、电源分配系统（PDS）设计、信号完整性和电源完整性设计方面的各项措施和LPDDR2与FPGA的接口信号之间的布线约束规则的制定，讨论了存储器接口带宽的计算方法以及Cyclone V FPGA的硬核存储器控制器对于存储器接口带宽的提高。</p><p><strong>中文引用格式：</strong>李海廷，胡鑫，曾双，等. 红外成像组件中小型化处理板的设计[J].电子技术应用，2019，45(12)：121-124，128.</p><p><strong>英文引用格式：</strong>Li Haiting，Hu Xin，Zeng Shuang，et al. The development of the miniaturizing processing board in IR imaging module[J]. Application of Electronic Technique，2019，45(12)：121-124，128.</p><p>0 引言</p><p>随着红外焦平面探测器的发展，红外成像技术在军事和民用领域的应用越来越广泛，特别是非制冷红外成像技术因其具有成本低、体积小、重量轻、使用方便等优点，在各应用领域中得到了较快发展。目前，很多领域的产品需求都向着高性能、小型化、低功耗方向发展，红外成像组件也不例外，所以，迫切需要突破小型化红外成像组件的关键技术，研制出小型化、模块化、接口电路系列化的红外成像组件，以适应各种应用领域的需求。在小型化红外成像组件中，处理板是核心，除完成红外图像的非均匀校正、计算校正参数和图像处理算法功能外，还承担着探测器时序控制、AD转换控制功能和将14位并行图像数据转换为串行LVDS信号输出、校正快门控制等功能。</p><p>1 红外成像组件总体方案介绍</p><p>本方案以实现内核机芯的标准化、系列化为目标，采用前端电路板和处理板在系统中分别布局的方案，将AD采集部分前置到驱动板上，同时实现处理板的小型化，并将其集成到前端，与驱动板、接口板一同置于平台框架上。基本方案如图1所示。</p><img alt=「学术论文」红外成像组件中小型化处理板的设计 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RqE4Ccz3KmZHPy><p>总体设计中的三块电路板——驱动板、主处理板和接口板的面积和外形尺寸相同，均为38 mm×38 mm，厚度均为1.6 mm，三块板之间采用堆叠式结构，板间距为5 mm。</p><p>2 小型化处理板方案设计</p><p>小型化处理板在保证实现全部功能的前提下，以小型化和通用化为设计目标，PCB尺寸要控制在38 mm×38 mm。</p><p>小型化处理板以FPGA为核心器件，除完成红外图像的非均匀校正、计算校正参数和图像处理算法功能(8 bit视频信号相关的图像处理计算，包括直方图均衡、滤波、锐化等)外，还承担着探测器时序控制、AD转换控制功能、将14位并行数据转换为串行LVDS信号输出、校正快门控制等功能，主处理板不承担特殊接口转换功能，相关功能由后端接口板完成。主处理板上FPGA实现的主要功能有：</p><p>(1)探测器时序控制；</p><p>(2)AD时序控制；</p><p>(3)对原始数字图像作非均匀性校正；</p><p>(4)完成校正参数的定标计算；</p><p>(5)对14 bit图像进行直方图均衡，转换为8 bit图像；</p><p>(6)图像滤波、锐化增强；</p><p>(7)输出Camera link串行数字视频图像；</p><p>(8)输出8/14 bit并行数字视频图像；</p><p>(9)视频信号合成；</p><p>(10)通过串口接收控制命令，返回状态参数。</p><p>小型化处理板总体设计方案如图2所示，为了满足设计中对资源量、存储容量和数据传输带宽等的需求，FPGA拟选用Altera的Cyclone V系列器件，存储器需要一片LPDDR2和一片Flash，采用SAMTEC的板上连接器实现与AD板、接口板的电气连接。</p><img alt=「学术论文」红外成像组件中小型化处理板的设计 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RqE4CdXI2ITU6J><p>3 主要器件选型</p><p>由于该方案设计的主要目标是实现PCB的小型化，因此在器件选型时，在保证实现所需功能的前提下，尽量选择面积较小的器件。</p><p><strong>3.1 FPGA选型</strong></p><p>FPGA选用Altera Cyclone V系列的5CEA7，MBGA484封装，芯片面积为19 mm×19 mm，LE约150K，M10K块为Cyclone III 3C120的1.6倍，达686，18×18乘法器312个，并增加精度可调DSP模块156个<sup>[1]</sup>。其中的HMC支持2个24位的LPDDR2或者一个32位的LPDDR2<sup>[2]</sup>。</p><p>如今，很多系统的性能瓶颈在于系统与外部存储器接口的实际有效带宽，而存储器控制器的效能则成为决定这种有效带宽的关键要素。利用Cyclone V FPGA 中的HMC，设计人员能够最大限度地提高存储器控制器的效率和灵活性，帮助降低应用和系统的功耗和总成本。</p><p>Cyclone V FPGA中的多端口存储器控制器硬核IP支持DDR3、DDR2、LPDDR2和移动DDR。Cyclone V FPGA还支持以上存储器接口的软核存储器控制器，但是两种控制器的性能不同，表1为两种存储器控制器接口支持和性能比较列表<sup>[2]</sup>。</p><img alt=「学术论文」红外成像组件中小型化处理板的设计 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RqE4Cdy7tKCTCk><p>设计中用到了LPDDR2，为了充分地发挥其存取速度快的优势，使用FPGA内部提供的硬核存储器控制器。</p><p>评估一个存储器接口的带宽，不仅仅取决于存储器接口的绝对速率，存储器控制器控制数据在存储器之间传送的效率，也是决定带宽的一个重要因素。存储器带宽的计算方法如式(1)所示。</p><img alt=「学术论文」红外成像组件中小型化处理板的设计 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RqE4CeYDojm8Xg><p>普通DRAM存储器接口的效率通常在70%左右，例如：一个效率为70%的32位接口，运行频率是400 MHz，带宽为17.92 Gb/s<sup>[2]</sup>。</p><p>Bandwidth=32 bit×2 Clock Edges×400 MHz×70%</p><p>=17.92 Gb/s=2.24 GB/s</p><p>而Altera Cyclone V的硬核存储器控制器的效率可高达92%。那么带宽为：</p><p>Bandwidth=32 bit×2 Clock Edges×400 MHz×92%</p><p>=23.55 Gb/s</p><p>=2.943 75 GB/s</p><p>可见，Altera Cyclone V的硬核存储器控制器对于数据传送带宽的提高是很显著的。</p><p><strong>3.2 SDARM选型</strong></p><p>SDRAM用于在图像非均匀校正和处理过程中，缓存增益校正因子、偏移校正因子和相关图像数据。为了满足设计中非均匀校正和图像处理算法对存储器容量及其接口带宽的需求，SDARM采用Micron的Mobile LPDDR2 SDRAM——MT42L 256M32D4，由于其面积小，功耗低，容量大，被广泛应用于一些高档手持设备中，其关键指标如下<sup>[5]</sup>：</p><p>(1)容量：2 Gb；</p><p>(2)位宽：32 bit；</p><p>(3)器件类型：LPDDR2 SDRAM；</p><p>(4)IO电平标准：单端为HSUL_12，差分为Differential 1.2 V HSTL Class I；</p><p>(5)时钟频率：333 MHz；</p><p>(6)数据速率：667 Mb/s/pin。</p><p><strong>3.3 Flash选型</strong></p><p>Flash用于在图像非均匀校正过程中存储IRFPA每个像素的增益校正因子Gij与偏移校正因子Oij，根据设计中的存储容量需求，选用Spansion的2 Gb容量的Parallel NOR Flash——RC28F00BM29EW。关键指标如下<sup>[6]</sup>：</p><p>(1)容量2 Gb；</p><p>(2)位宽：16 bit；</p><p>(3)器件类型：Parallel NOR Flash；</p><p>(4)随机存取时间：110 ns。</p><p><strong>3.4 处理板的电源分配系统(PDS)的设计</strong></p><p>根据电路中各种器件对电源电压的需求，电源分配系统(PDS)需要提供多种电源电压。归结起来总共需要以下几种电源：1.1 V、1.2 V、1.8 V、2.5 V、3.3 V。2.5 V的FPGA专用电源、PLL电源和辅助电源可以采用一片LT1962提供；1.8 V的LPDDR2 SDRAM内核电源所需电流较小，仅需一片LT1761。由于都是数字电路，其余电源可以采用DC-DC电源。1.1 V的FPGA的内核电源选用Enpirion的EN5339QI，最大输出电流3 A，可调输出，电压输出端内置电感，24-pin QFN封装(4 mm×6 mm)；1.2 V的FPGA IO电源和LPDDR2的内核、IO电源选用EP53A8LQI，最大输出电流为1 A，可调输出，电压输出端内置电感，设定输出电压不需要外置电阻，3 mm×3 mm QFN封装；3.3 V的FPGA IO电源、专用电源和Flash的内核、IO电源选用EP53A8LQI，最大输出电流为1 A，可调输出，电压输出端内置电感，设定输出电压不需要外置电阻，3 mm×3 mm QFN封装。</p><p>综上所述，主处理板的电源分配系统(PDS)的设计方案如图3所示。</p><img alt=「学术论文」红外成像组件中小型化处理板的设计 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RqE4Da4zilOZI><p>4 电路信号完整性和电源完整性设计</p><p><strong>4.1 信号完整性</strong></p><p>由于红外探测器对噪声极为敏感，因此在设计中必须采取严格的滤波措施，以保证输出图像质量。另外，该设计的重点和难点是LPDDR2与FPGA的接口设计，LPDDR2的时钟频率是333 MHz，数据速率高达667 Mb/s/pin，属于高速信号，所以对于时序和信号完整性有较高要求，为了保证设计的一次成功，除了满足LPDDR2接口信号的阻抗匹配、布线规则要求外，还必须对整个电路进行信号完整性和电源完整性仿真。</p><p><strong>4.1.1 滤波措施</strong></p><p>系统中噪声的主要来源有两个：一是由外部输入的电源引入的噪声；二是主处理板数字电路产生的噪声。针对这两类噪声，应采取相应的滤波措施。</p><p>针对由外部输入的电源引入的噪声，对外部电源输入都要采用两级空心电容加磁珠的方式进行滤波，如图4所示，另外，对输入的地信号也要加磁珠滤波，采用的磁珠要求在100 MHz时的阻抗为220 Ω以上。</p><img alt=「学术论文」红外成像组件中小型化处理板的设计 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RqE4DakHdcI6VA><p>针对主处理板数字电路产生的噪声，对于主处理板提供给驱动、AD板的探测器时序控制和AD采样控制等信号，根据信号具体频率范围，选用合适的磁珠进行滤波。</p><p><strong>4.1.2 阻抗匹配</strong></p><p>信号走线阻抗，单端走线50 Ω±10%，差分走线100 Ω±10%。必须对设计进行仿真以确保良好的信号完整性。</p><p><strong>4.1.3 布线规则约束</strong></p><p>(1)LPDDR2与FPGA的接口信号之间的布线约束</p><p>LPDDR2与FPGA的接口信号分组如下：</p><p>①数据信号组：数据(DQ)，数据屏蔽(DM)，数据随路时钟(DQS/DQS#)，其中每个字节又是内部的一个信道Lane组，如DQ[0:7]，DQS0/DQS0#，DM0 为一个信号组；</p><p>②命令/地址(Command/address)信号组：CA[9:0]；</p><p>③控制信号组：CS/CS#，CKE；</p><p>④时钟信号组：CK，CK#。</p><p>根据LPDDR2的时序特点，对其布线规则制定如下约束：</p><p>①数据信号组DQ与DQS/DQS#、DM的等长控制：</p><p>LPDDR2数据信号DQ的采样，是采用与DQ同步的DQS/DQS#作为采样参考源。一个DQS/DQS#与8个DQ配合使用，因此同一个DQ 组(同一信道)中的所有信号DQ和DQS/DQS#、DM(例如DQ[0:7]，DQS0/DQS0#，DM0)走线的skew控制在±10 ps或者近似±50 mils，并且需要布在同一层，在设置布线约束时将DQS/DQS#走线长度设置成同组相关数据信号DQ和数据屏蔽信号DM的目标走线长度。而组内不同信道(不同DQ组)的走线误差为±10 ps或者近似±50 mils(0.254 mm)。</p><p>②数据信号组(DQ组)与时钟信号(CK/CK#)布线长度误差不超过±50 ps或者近似±250 mils，在设置布线约束时将时钟信号(CK/CK#)布线长度设置成目标走线长度。</p><p>③地址/控制信号仍以时钟信号CK的上升沿和CK#信号的下降沿的交叉点作为参考点，将地址/控制信号组(address，CS，CKE)布线到与CK/CK#时钟所在的同一层上(理想情况下)，并保证与CK/CK#之间的skew不超过±20 ps或者近似±100 mils。两种信号线组内走线误差为不超过±10 ps或者近似±50 mils。</p><p>④差分时钟(CK/CK#) 和数据随路时钟(DQS/DQS#)的N和P走线之间的最大失配长度为±2 ps或者近似±10 mils。</p><p>(2)时钟信号布线规则</p><p>①时钟信号线必须布在内层，外层扇出长度不超过150 ps(近似500 mils，12.7 mm)；</p><p>②时钟信号应该与其他信号保持10 mil(0.254 mm)以上的间距。</p><p>③差分时钟(CK/CK#)的N和P走线之间的最大失配长度为±2 ps或者近似±10 mils。</p><p><strong>4.2 电源完整性</strong></p><p>将DGND，1.1 V，1.2 V，1.8 V和3.3 V电源都布为平面。在PCB面积允许的前提下，为各种电源网络提供充分的去耦，以保证电源分配网络的低阻抗。</p><p>5 实验结果</p><p>图5为该处理板的实物照片，本设计中采用了0.65 mm间距的BGA封装，焊盘直径为0.3 mm，两个焊盘之间的间隙仅为0.35 mm。板子上的最小线宽为4.1 mil，走线与焊盘、过孔之间的最小间距为4 mil；最小信号过孔直径为5 mil，属于高密度PCB。在PCB布局时存在BGA器件背面放置器件的情况，这就需要使用盲孔、埋孔甚至实心铜柱工艺。</p><p>图6为采用了本文中设计的处理板的红外成像组件样机照片。图7中的(a)和(b)分别为利用该样机采集到的远距离和近距离场景的图像(经单点校正)。</p><img alt=「学术论文」红外成像组件中小型化处理板的设计 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RqE4DbC4ogDS8m><img alt=「学术论文」红外成像组件中小型化处理板的设计 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RqE4Dbi64NKbIr><p>6 结论</p><p>本文详细介绍了小型化处理板设计过程中的各项工作，包括：总体方案设计、主要器件选型、电源分配系统（PDS）设计、信号完整性和电源完整性设计方面的各项措施和LPDDR2与FPGA的接口信号之间的布线约束规则的制定，重点讨论了存储器接口带宽的计算方法以及Cyclone V FPGA的硬核存储器控制器对于存储器接口数据传送带宽的提高。最后展示了处理板的实物照片，和采用了该处理板的红外成像组件样机采集到的远距离和近距离场景的图像。</p><p><strong>参考文献</strong></p><p class=pgc-end-literature>[1] Altera Corporation.Cyclone V device handbook(Version 1.0)[Z].US：Altera，2012.</p><p class=pgc-end-literature>[2] Altera Corporation.CV-52006 external memory interfaces in Cyclone V device(Version 1.0)[Z].US：Altera，2013.</p><p class=pgc-end-literature>[3] ULIS Inc.UL 04 27 2-032 640x480 LWIR UNCOOLED MICROBOLOMETER datasheet.UL 04 272-32/17.09.09/UP/DV/NTC09007-3a Revision 3a[Z].</p><p class=pgc-end-literature>[4] Altera Corporation.CV-51002-3.3 Cyclone V device datasheet(Version 3.3)[Z].US：Altera，2013.</p><p class=pgc-end-literature>[5] Micron Technology，Inc.Automotive mobile LPDDR2 SDRAM MT42L16M32D1 datasheet(Version D)[Z].US：Micron Technology，2013.</p><p class=pgc-end-literature>[6] Micron Technology，Inc.Micron parallel NOR Flash embedded memory(P30-65nm) PC28F00BP30EFx Datasheet(Version B)[Z].US：Micron Technology, 2013.</p><p>[7] 张沛，祝红彬，吕坚，等.低噪声非制冷红外焦平面阵列驱动电路的设计[J].红外与激光工程，2010，39(5)：806-810.</p><p>[8] 郑兴，蒋亚东，罗风武.基于ADN8830的非制冷红外焦平面温度控制电路设计[J].现代电子技术，2009，24：154-156.</p><p>[9] 王华伟，曹剑中，马彩文，等.具有自适应校正功能的红外成像系统设计[J].红外与激光工程, 2014，43(1)：61-65.</p><p>[10] 刘会通，易新健.红外焦平面阵列非均匀性的两点校正及依据[J].红外与激光工程，2004，33(1)：76-78.</p><p>[11] 李颖文，易新建，何兆湘，等.320×240红外焦平面驱动电路的小型化设计研究[J].红外与激光工程，2001，30(3)：230-240.</p><p>[12] 祝红彬，李伟，刘子骥，等.一种高精度非致冷红外焦平面温度控制系统的设计[J].红外技术，2009，31(3)：144-147.</p><p><strong>作者信息:</strong></p><p>李海廷，胡 鑫，曾 双，佘俊超，鲁 强，隋 峻</p><p>(西南技术物理研究所，四川 成都610041)</p><p>原创声明：此内容为AET网站原创，未经授权禁止转载。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'学术','论文','红外'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>