<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>手把手的Numpy教程，从此数据处理不再慌——reshape、转置篇 | 极客快訊</title><meta property="og:title" content="手把手的Numpy教程，从此数据处理不再慌——reshape、转置篇 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/10ab50f947f2492688dee1514bc3dd4c"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b9d032c5.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b9d032c5.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b9d032c5.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b9d032c5.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b9d032c5.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b9d032c5.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b9d032c5.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b9d032c5.html><meta property="article:published_time" content="2020-10-29T21:09:42+08:00"><meta property="article:modified_time" content="2020-10-29T21:09:42+08:00"><meta name=Keywords content><meta name=description content="手把手的Numpy教程，从此数据处理不再慌——reshape、转置篇"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/b9d032c5.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>手把手的Numpy教程，从此数据处理不再慌——reshape、转置篇</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>今天这篇是<strong>numpy专题</strong>的第四篇文章，numpy中的数组重塑与三元表达式。</p><p><br></p><p>首先我们来看数组重塑，所谓的重塑本质上就是<strong>改变数组的shape</strong>。在保证数组当中所有元素不变的前提下，变更数组形状的操作。比如常用的操作主要有两个，一个是转置，另外一个是reshape。</p><h2 class=Editable-styled><br></h2><h2 class=Editable-styled><strong>转置与reshape</strong></h2><p><br></p><p>转置操作很简单，它对应线性代数当中的转置矩阵这个概念，也就是说它的功能就是将一个<strong>矩阵进行转置</strong>。</p><p><br></p><p>转置矩阵的定义是<strong>将一个矩阵的横行写为转置矩阵的纵列</strong>，把纵列写成转置矩阵的横行。这个定义的是二维的矩阵，本质上来说，转置操作其实是将一个矩阵沿着矩阵的大对角线进行翻转。翻转之后，显然这个矩阵的各个维度都会发生变化。</p><p><br></p><p>其中二维的矩阵最直观，一个4 x 3的矩阵，转置之后得到的是3 x 4的矩阵。如果维度更多呢？如果是3 x 2 x 4的矩阵转置之后会得到什么？</p><p><br></p><p>很简单，得到的会是4 x 2 x 3的矩阵。我们都知道，如果我们把一个矩阵各个维度的大小写在一起，会得到一个元组(tuple)，这个元组称为矩阵的shape，我实在是不知道该怎么翻译这个单词，但是我觉得叫做形状不太妥当，所以就保留了英文原文。转置之后，矩阵的shape会整个翻转。比如(3, 2, 4)会变成(4, 2, 3)。</p><p><br></p><p>我们可以来看一个例子，会更加的直观。首先我们先看最简单的二维矩阵：</p><p><br></p><div class=pgc-img><img alt=手把手的Numpy教程，从此数据处理不再慌——reshape、转置篇 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/10ab50f947f2492688dee1514bc3dd4c><p class=pgc-img-caption></p></div><p><br></p><p>这是随机出来的一个3 x 4的二维矩阵，在numpy当中，有两种方式获取一个矩阵或者是数组的转置。第一种方式是通过在数组的<strong>变量名之后加上.T操作符</strong>，第二种方式是调用numpy中的<strong>transpose函数</strong>，这两种方式是一样的。我个人比较倾向于前者，写起来比较简单。</p><p><br></p><div class=pgc-img><img alt=手把手的Numpy教程，从此数据处理不再慌——reshape、转置篇 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6371d68b91dc4b0ea7e7a04552361614><p class=pgc-img-caption></p></div><p><br></p><p>我们可以看到转置之后新的矩阵的第一列其实是原矩阵的第一行，第一行是原矩阵的第一列。可以看成是原矩阵按照从左上角到右下角的一条无形的线翻转之后的结果。</p><p><br></p><p>理解了转置之后，我们再来看reshape操作。其实我们从这个单词上也能大概猜到它的意思，reshape也就是再次shape的意思，本意是<strong>根据我们想要的shape重新组装矩阵当中的元素</strong>。</p><p><br></p><p>我们来看一个例子吧，首先，我们通过arange方法来获取一个一维的数组：</p><p><br></p><div class=pgc-img><img alt=手把手的Numpy教程，从此数据处理不再慌——reshape、转置篇 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/66e611413f374dc3b7d1d01995bf8610><p class=pgc-img-caption></p></div><p><br></p><p>因为是1维的，所以我们去看它的shape也只有一维。假设我们不喜欢这样的一维数组，而想把它变成3 x 4或者是6 x 2的格式，这时候使用reshape就会很方便。</p><p><br></p><div class=pgc-img><img alt=手把手的Numpy教程，从此数据处理不再慌——reshape、转置篇 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c8d4d4e0e1d04ed3a166a0dfb73a37c7><p class=pgc-img-caption></p></div><p><br></p><p>本质上来说reshape操作其实就是按照顺序从矩阵当中获取元素，然后按照我们制定的shape填充出一个新的矩阵的操作。这个应该不难理解， 它也是非常常用的重塑操作，通过reshape和转置，我们可以很方便地操作矩阵的大小，根据我们的需要作出改变。</p><h2 class=Editable-styled><br></h2><h2 class=Editable-styled><strong>三元表达式</strong></h2><p><br></p><p>在许多编程语言当中我们经常会用到<strong>三元表达式</strong>，三元表达式其实本质就是if-else语句，只是我们用特殊的方法将它简写。</p><p><br></p><p>比如说在C++当中，我们可以把if condition A else B简写成：condition ? A : B。Python同样支持三元表达式，不过对C++的三元表达式做了一些改动，在Python当中三元表达式写成：A if condition else B。相对来说更加直观一些，我们经常会在数组初始化的时候用到三元表达式。</p><p><br></p><p>比如，我们可能会这样生成一个数组：</p><p><br></p><pre><code>arr = [1 if condition else 0 for _ in range(10)]</code></pre><p><br></p><p>我们通过条件来判断了每一位是1还是0来生成了一个数组，简化了代码。在numpy当中同样继承了这个用法，我们一样可以使用三元表达式，不过numpy将它封装进了<strong>where函数</strong>当中，我们是通过调用一个方法来实现三元表达式的功能。我们来看下具体的用法，假设我们有两个数组：</p><p><br></p><div class=pgc-img><img alt=手把手的Numpy教程，从此数据处理不再慌——reshape、转置篇 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ff234ebd098942079260c3044c450081><p class=pgc-img-caption></p></div><p><br></p><p>我们还有一个bool型的数组c，我们希望根据c数组选择从a数组或者是b数组当中获取数据。我们可以使用where写成这样：</p><p><br></p><div class=pgc-img><img alt=手把手的Numpy教程，从此数据处理不再慌——reshape、转置篇 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3c547380c82a4903a6f565393998be28><p class=pgc-img-caption></p></div><p><br></p><p>在这个例子当中，c数组中的1和0分别表示True和False。当我们调用np.where的时候，numpy会<strong>自动根据c数组当中的值去选择从a数组还是b数组当中获取数据</strong>。相当于我们执行了这么一段代码：</p><p><br></p><pre><code>[x if c else y for c, x, y in zip(c, a, b)]</code></pre><p><br></p><p>虽然两者的运行结果是一样的，但是显然使用循环的方法计算耗时更长，而<strong>使用numpy的向量做法运算速度更快</strong>。除此之外，numpy的where方法还支持高维的数组，但是循环的方法不行。并且where还有一些更高级的用法，比如说我们传入的第二个和第三个参数，可以不是数组而是一个标量。比如我们可以指定当c中的元素是True的时候填入1，否则填入-1：</p><p><br></p><div class=pgc-img><img alt=手把手的Numpy教程，从此数据处理不再慌——reshape、转置篇 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/aa5a8be220bd43bab0333c37c9ca4bf0><p class=pgc-img-caption></p></div><p><br></p><p>甚至我们还可以将标量和向量结合起来使用：</p><p><br></p><div class=pgc-img><img alt=手把手的Numpy教程，从此数据处理不再慌——reshape、转置篇 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/7525dc5c772649c7868b855ef04b34ea><p class=pgc-img-caption></p></div><p><br></p><p>并且这里的数组c也可以替换成逻辑运算：</p><p><br></p><div class=pgc-img><img alt=手把手的Numpy教程，从此数据处理不再慌——reshape、转置篇 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/ad2bada8d2844c439edf7688b851ff23><p class=pgc-img-caption></p></div><h2 class=Editable-styled><br></h2><h2 class=Editable-styled><strong>总结</strong></h2><p><br></p><p>今天的文章主要介绍了Numpy当中的reshape、转置以及where的用法，这些也是numpy的基础用法，尤其是转置、reshape，几乎是<strong>处理数据必用的方法</strong>。所以想要从事Python机器学习或者是人工智能的小伙伴，numpy的这些用法是一定要会的。</p><p><br></p><p>本文当中介绍的只是numpy的一些固定套路，但其实numpy很多的用法是可以组合的，一些看似平淡无奇的用法组合在一起之后会有神奇的效果。这一点光看书或者是资料是很难穷尽的，所以如果你已经学会了这些api的基本使用，接下来最应该做的是去<strong>读一些大牛的源码</strong>，看看大牛们是如何运用这些工具的，相信一定还会有新的收获。</p><p><br></p><p>文章就到这里，如果喜欢本文，可以的话，请<strong>点个关注</strong>。</p><p><br></p><p>本文始发于公众号：<strong>TechFlow</strong></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Numpy','从此','数据'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>