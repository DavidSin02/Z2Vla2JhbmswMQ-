<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>嵌入式电量检测设备的设计实现和应用 | 极客快訊</title><meta property="og:title" content="嵌入式电量检测设备的设计实现和应用 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/ece20d78633449bd867d8a2abd3a6753"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bb54c4d.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bb54c4d.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bb54c4d.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bb54c4d.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bb54c4d.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bb54c4d.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bb54c4d.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bb54c4d.html><meta property="article:published_time" content="2020-10-29T20:59:01+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:01+08:00"><meta name=Keywords content><meta name=description content="嵌入式电量检测设备的设计实现和应用"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/bb54c4d.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>嵌入式电量检测设备的设计实现和应用</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><strong>吉隆坡中车维保有限公司的研究人员宋杰，在2020年第2期《电气技术》杂志上撰文，介绍了一种在线实时电量检测设备，详细描述了其设计和实现过程以及车载应用案例，探讨了无线远程监测技术，并验证了该技术的实现。在该设备上挂载通用电流传感器后，通过USB接口与计算机通信，进行电量实时检测和检测数据的实时输出；通过WiFi模块，设备采用超文本传送协议与远程服务器通信技术，实现检测数据无线远程实时汇聚。</strong></p><p>电气设备工作时，其各部件的能耗情况可直观反映设备的状态。对电气设备及相关部件进行电量检测和实时监测，可以实现设备故障检测和设备状态，实时监测。基于对监测数据的处理分析，可实时判断出设备故障；基于对相关数据发展趋势的分析，还可预测并预防设备故障。</p><p>对车载设备的检测有多种应用情况。例如：①车载门控开关门操作时间很短，只有几秒钟；②一般情况下，刮雨器在下雨时才工作，存在长时间不运用及突发性运用情况；③空调工作时，存在多种运行工况，各种工况下能耗并不一致。</p><p>在这些应用中，可采用万用表、电流表、示波器等仪器进行测量，但存在系统应用受限、设备使用不便、设备价格高等因素。例如，车辆载客运营情况下，无法采用相关设备对目标设备进行实时检测，只能在车辆回库后再进行处理，此时，车辆状态与载客运行时的状态存有差异。在用电流表和万用表检测门控驱动器和电动机能耗情况时，对几秒内的电量进行检测时间太短，测试结果无法准确表征被测量物体在某一时刻的特征。</p><p>当检测空调运行时的能耗情况时，电压和电流均较大，可在屏柜内进行，但操作安全要求高；若采用实时无线方式，则在高效获取大量实时数据的同时，规避了不安全的环境，并且不影响设备运行或运营状态。因此，工业需求催生了可应用于且不限于以上多种情形的嵌入式电量检测设备。</p><h1 class=pgc-h-arrow-right>1 系统设计</h1><p>嵌入式电量检测设备实现了实时检测电量、无线传输数据、实时输出信息等功能，可应用于多种场景，如便携式应用、固定安装、蓄电池供电等。嵌入式电量检测设备由电流传感器、低功耗嵌入式处理器、WiFi模块和输入/输出模块等组成，其系统结构框图如图1所示。</p><p><br></p><div class=pgc-img><img alt=嵌入式电量检测设备的设计实现和应用 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ece20d78633449bd867d8a2abd3a6753><p class=pgc-img-caption>图1 嵌入式电量检测设备的系统结构框图</p></div><p><strong>1.1 电流传感器</strong></p><p>系统采用耀华德昌的霍尔电流传感器[1]，其接口由电源、地、信号输出等组成。传感器供电电压为+5V，额定模拟量输出为2.5V±0.625V，电流消耗小于40mA，精度为0.5%，线性度小于0.1%；输入电流测量范围可选，从10～100A，甚至更大范围。对于传感器，既可采用闭环式固定安装，也可采用开合式悬挂安装，其安装方式示意图如图2所示。</p><div class=pgc-img><img alt=嵌入式电量检测设备的设计实现和应用 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/e888d7bfbd694655a9c6b1c988090f2a><p class=pgc-img-caption>图2 电流传感器安装方式示意图</p></div><p><strong>1.2 处理器</strong></p><p>系统采用了集成ATSAMD21J18A处理器的SAM D21评估板[2]。该处理器平台集成USB接口，I/O和总线接口均通过3个标准扩展头引出。SAM D21基于ARM Cortex-M0+处理器，最高运行频率可达48MHz；提供52个可编程I/O接口；集成了一个12位，350ksps（采用点/秒）的模数转换器，可同时采样20个通道。</p><p><strong>1.3 WiFi模块</strong></p><p>系统采用WINC1500 WiFi功能模块，支持802.11 b/g/n标准，运行于2.4G ISM频段。该模块通过标准扩展头与SAM D21连接。在设备使用无线通信功能时，需要有WiFi覆盖，设备采用无线通信方式连接至公共网络上的服务器。</p><p><strong>1.4 输入/输出模块</strong></p><p>系统通过按键实现功能选择和参数设定，采用发光二极管（light emitting diode, LED）和液晶显示器（liguid crystal display, LCD）显示系统信息。输入/输出模块通过标准扩展头与SAM D21连接，如图3所示。</p><div class=pgc-img><img alt=嵌入式电量检测设备的设计实现和应用 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/daa4377a492f44b0be1991fcf0dff874><p class=pgc-img-caption>图3 输入/输出模块</p></div><p><strong>1.5 系统供电方式</strong></p><p>系统有3种供电方式。</p><ul class=list-paddingleft-2><li>方式1：采用开关电源模块，将220V 50Hz交流电源转换为5V直流电源输出。</li><li>方式2：直接通过USB接口从电脑等相关设备获取电源。采用USB连接电脑取电时，可以通过电脑超级终端采用USB接口直接从系统获取电量检测信息。</li><li>方式3：采用便携式蓄电池供电，如3.7V 5000mAh的可充电锂电池。该方式需起动设备低功耗模式功能，应用于间歇式的电量数据采集。</li></ul><h1 class=pgc-h-arrow-right>2 系统（协议、算法）实现</h1><p><strong>2.1 超文本传送协议方法</strong></p><p>系统采用RESTful架构原则，使用统一接口进行资源的访问。通信接口使用标准的超文本传送协议（hypertext transport protocol, HTTP）POST方法。</p><p>POST请求数据如下：</p><p>#Request</p><p>POST /default.ashx HTTP/1.1</p><p>Host: itw.crrcckm.com</p><p>Accept: */*</p><p>Content-Type: application/json</p><p>Content-Length: 517</p><p>"{\"project\":\"scs\",\"train\":\"scs14\",\"system\":\"cabinet\",\"saloon\":\"mc1\",\"instruction\":\"current\",\"style\":\"maximum\",\"specification\":[{\"position0\":\"1u\",\"data0\":10.01 ,\"position1\":\"1v\",\"data1\":10.01 ,\"position2\":\"1w\",\"data2\":10.01 ,\"position3\":\"2u\",\"data3\":10.01 ,\"position4\":\"2v\",\"data4\":10.01 ,\"position5\":\"2w\",\"data5\":10.01 ,\"position6\":\"3u\",\"data6\":10.01 ,\"position7\":\"3v\",\"data7\":10.01 ,\"position8\":\"3w\",\"data8\":10.01 ,\"position9\":\"4u\",\"data9\":10.01 ,\"position10\":\"4v\",\"data10\":10.01 ,\"position11\":\"4w\",\"data11\":10.01 }]}"</p><p><br></p><p>无论服务器响应成功与否，均返回相关内容。若服务器响应成功，即接收数据正确、动作被理解并接受，则返回2XX相关信息（X代表0—9中的任何一个数字）。如下所示：</p><p>#Response</p><p>HTTP/1.1 200 OK</p><p>表明该请求被成功地完成，一切正常。</p><p><strong>2.2 电流监测</strong></p><p>对于直流和交流电，监测一定周期的电流值，采用积分的方式对其进行计算，即可获得周期内的电流有效值。</p><p><br></p><div class=pgc-img><img alt=嵌入式电量检测设备的设计实现和应用 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15d4d0107bf348528ea6745db66084d7><p class=pgc-img-caption>公式1</p></div><p><strong>2.3 交流频率检测</strong></p><p>系统采用自动方式检测电流频率。在检测电流的过程中，自动对电流频率进行检测。采用过零检测方法，可以很好地检测交流电源的频率。在采用过零检测方法时，系统需要确定检测基准，即无电流情况电流传感器信号输出，如图4所示。</p><div class=pgc-img><img alt=嵌入式电量检测设备的设计实现和应用 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2d5108e2385245049253dcce6b2327bb><p class=pgc-img-caption>图4 无电流情况电流传感器信号输出</p></div><p><br></p><div class=pgc-img><img alt=嵌入式电量检测设备的设计实现和应用 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e72b92eb27ad4d389eebdb458125f1f6><p class=pgc-img-caption></p></div><p><strong>2.4 系统实现</strong></p><p>本文基于模块化的设计思想，研制了嵌入式电量检测设备，如图5所示。从图5可看出，嵌入式电量检测设备由控制盒、开关电源、处理器、WiFi模块、信号和电源接口板以及电流传感器等组成。</p><div class=pgc-img><img alt=嵌入式电量检测设备的设计实现和应用 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d871fb51d2e9465eb7ec35b162e6c02b><p class=pgc-img-caption>图5 嵌入式电量检测设备</p></div><p>对于需要输入/输出模块的应用场合，需要将输入/输出模块直接连接或通过排线连接至处理器评估板标准扩展头，并将相关程序需编写到处理器、烧录至板载存储器中，即可实现输入/输出功能的集成。</p><p>基于模块化、流程化和面向对象程序设计的思想，采用实时操作系统，使用C/C++编程语言，设计系统软件，实现设备功能。嵌入式电量检测设备状态机如图6所示。</p><p><br></p><div class=pgc-img><img alt=嵌入式电量检测设备的设计实现和应用 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c59fd7f621024121a5ae8bfea7c98183><p class=pgc-img-caption>图6 嵌入式电量检测设备状态机</p></div><h1 class=pgc-h-arrow-right>3 系统应用</h1><p><strong>3.1 对空调风机电流的实时监测</strong></p><p>车载空调由空调控制单元、空气压缩机、冷凝器风机、空气送风机和温度传感器（新风、回风、送风）等组成。其中，空调控制单元被安装在车载屏柜，其他设备被安装于车顶。送风口和回风口位于车厢顶部和座椅下方。均可将嵌入式电量检测设备及电流传感器安装于空调屏柜等设备柜内。在使用基于简易安装理念设计的嵌入式电量检测设备时，可快速安装；在使用完成后，可快速拆卸。整个过程对车载设备无影响。其安装如图7所示。</p><div class=pgc-img><img alt=嵌入式电量检测设备的设计实现和应用 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3af2f10c494347b0acb39bd795029b08><p class=pgc-img-caption>图7 设备（控制盒、传感器）安装图示</p></div><p>依据实际应用需求，还可对安装于车顶设备的各相电流进行监测，或对故障概率大的设备的各相电流进行监测。</p><p>在车辆运行过程中，对实时采集的电流数据需要无线传输至地面服务器，可通过电脑或大屏等终端实时显示电流数据。基于数据或对数据的分析，结合经验模型，既可得知空调的工作情况（如运行、停止、制冷、通风、紧急通风、火灾模式等），也可得知空调故障（如压缩机故障、风机三相不平衡等）情况。</p><p><strong>3.2 刮雨器电动机的电流检测</strong></p><p>系统电流采集速率最高可以达到350ksps。当系统采用超级终端实时显示时，限于超级终端数据传输速率，最高频率可以达到约1kHz。</p><p>车载刮雨器具备低速和快速两种工作模式。通过司机操作台上的按钮，可控制刮雨器在不同工况下工作，实现相关功能。项目中采用的刮雨器直流电动机功率为130W，额定电流为1.2A。</p><p>项目中，选择了3家供应商的雨刮条，除了雨刮条，保持其他所有变量（如控制器、雨刮臂、玻璃等）不变，分别测试了快速工况和慢速工况下的刮雨器电动机电流的情况（每次测试时，电动机工作时间约为10s/图），如图8所示。</p><p>从图8中可看出，刮雨器电动机起动时，电流峰值较大，约为正常工况状态电流峰值的100%～200%。在慢速和快速工况状态下，采用不同刮臂，刮雨器电动机平均电流的消耗情况见表1。</p><p>测试结果表明，采用不同的刮臂，对刮雨器电动机功率影响有限，刮雨器电动机电流均在额定电流范围内。</p><p><br></p><div class=pgc-img><img alt=嵌入式电量检测设备的设计实现和应用 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/97b9cf715fb3451b9c90fd23342f5fc5><p class=pgc-img-caption>图8 慢速和快速工况下刮雨器电动机电流情况图</p></div><p><br></p><div class=pgc-img><img alt=嵌入式电量检测设备的设计实现和应用 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5ce3727e4c7e4d66a0d5afc664f53ef3><p class=pgc-img-caption>表1 慢速和快速工况下刮雨器电动机平均电流的消耗情况</p></div><h1 class=pgc-h-arrow-right>4 结论</h1><p>相较于通用的电流检测装置和示波器，嵌入式电量检测设备更贴合具体实际工程的应用需求，具有系统成本低、采集精度优、速率高、安装简易和使用方便等特点。该设备具有实时数据打印和数据无线传输功能，还具有通用性，依据应用需求，可进行功能定制。</p><p>针对实时监测应用，该平台需通过WiFi节点连接至网络服务器，采用HTTP等方式实时提交监测数据。针对检测应用，可将数据通过WiFi方式提交至服务器，也可通过超级终端方式将检测数据打印至配套的电脑终端，再通过电脑软件对相应的数据进行处理，由技术人员结合相关专业知识对数据进行进一步分析。</p><p>该系统针对一定的应用场景实现了对电量检测、交流频率检测和交直流电流检测。对于更广泛的应用，还需进一步优化相关算法和验证相关参数。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'电量','检测','设备'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>