<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Lyft 基于 Flink 的大规模准实时数据分析平台 | 极客快訊</title><meta property="og:title" content="Lyft 基于 Flink 的大规模准实时数据分析平台 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/90ad212bc87c4d828c5fbe8e21dfddf7"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bd043816.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bd043816.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bd043816.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bd043816.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bd043816.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bd043816.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bd043816.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bd043816.html><meta property="article:published_time" content="2020-11-14T21:00:57+08:00"><meta property="article:modified_time" content="2020-11-14T21:00:57+08:00"><meta name=Keywords content><meta name=description content="Lyft 基于 Flink 的大规模准实时数据分析平台"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/bd043816.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Lyft 基于 Flink 的大规模准实时数据分析平台</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">如何基于 Flink 搭建大规模准实时数据分析平台？来自 Lyft 公司实时数据平台的徐赢博士和计算数据平台的高立博士分享了 Lyft 基于 Apache Flink 的大规模准实时数据分析平台。本次分享主要分为四个方面：</span></p><ul><li><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">Lyft 流数据与场景</span></li><li><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">准实时数据分析平台和架构</span></li><li><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">平台性能及容错深入分析</span></li><li><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">总结与未来展望</span></li></ul><p><strong>01</strong></p><p><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">Lyft 流数据与场景</span></strong></p><p><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">1. 关于 Lyft</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">Lyft 是位于北美的一个共享交通平台，和大家所熟知的 Uber 和国内的滴滴类似，Lyft 也为民众提供共享出行的服务。Lyft 的宗旨是提供世界最好的交通方案来改善人们的生活。</span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/90ad212bc87c4d828c5fbe8e21dfddf7><p class=pgc-img-caption></p></div><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">2. Lyft 的流数据场景</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">Lyft 的流数据可以大致分为三类，秒级别、分钟级别和不高于 5 分钟级别。分钟级别流数据中，自适应定价系统、欺诈和异常检测系统是最常用的，此外还有 Lyft 最新研发的机器学习特征工程。不高于 5 分钟级别的场景则包括准实时数据交互查询相关的系统。</span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/cc33489f54be468583f0b4443070181a><p class=pgc-img-caption></p></div><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">3. Lyft 数据分析平台架构</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">如下图所示的是 Lyft 之前的数据分析平台架构。Lyft 的大部分流数据都是来自于事件，而事件产生的来源主要有两种，分别是手机 APP 和后端服务，比如乘客、司机、支付以及保险等服务都会产生各种各样的事件，而这些事件都需要实时响应。</span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fccd7f314f3b4d0fbc7f20286e1c9336><p class=pgc-img-caption></p></div><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">在分析平台这部分，事件会流向 AWS 的 Kinesis 上面，这里的 Kinesis 与 Apache Kafka 非常类似，是一种 AWS 上专有的 PubSub 服务，而这些数据流都会量化成文件，这些文件则都会存储在 AWS 的 S3 上面，并且很多批处理任务都会弹出一些数据子集。在分析系统方面，Lyft 使用的是开源社区中比较活跃的 presto 查询引擎。Lyft 数据分析平台的用户主要有四种，即数据工程师、数据分析师以及机器学习专家和深度学习专家，他们往往都是通过分析引擎实现与数据的交互。</span></p><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">4. 既往平台的问题</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">Lyft 之所以要基于 Apache Flink 实现大规模准实时数据分析平台，是因为以往的平台存在一些问题。比如较高的延迟，导入数据无法满足准实时查询的要求；并且基于 Kinesis Client Library 的流式数据导入性能不足；导入数据存在太多小文件导致下游操作性能不足；数据 ETL 大多是高延迟多日多步的架构；此外，以往的平台对于嵌套数据提供的支持也不足。</span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/63f2052a454c4e11a18b1414a28cbf3f><p class=pgc-img-caption></p></div><p><strong>02</strong></p><p><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">准实时数据分析平台和架构</span></strong></p><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">1. 准实时平台架构</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">在新的准实时平台架构中，Lyft 采用 Flink 实现流数据持久化。Lyft 使用云端存储，而使用 Flink 直接向云端写一种叫做 Parquet 的数据格式，Parquet 是一种列数据存储格式，能够有效地支持交互式数据查询。Lyft 在 Parquet 原始数据上架构实时数仓，实时数仓的结构被存储在 Hive 的 Table 里面，Hive Table 的 metadata 存储在 Hive metastore 里面。</span></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">平台会对于原始数据做多级的非阻塞 ETL 加工，每一级都是非阻塞的 ( nonblocking )，主要是压缩和去重的操作，从而得到更高质量的数据。平台主要使用 Apache Airflow 对于 ETL 操作进行调度。所有的 Parquet 格式的原始数据都可以被 presto 查询，交互式查询的结果将能够以 BI 模型的方式显示给用户。</span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/d21a69a5df46462c9c3cdd1b1fe5a30c><p class=pgc-img-caption></p></div><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">2. 平台设计</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">Lyft 基于 Apache Flink 实现的大规模准实时数据分析平台具有几个特点：</span></p><ul><li><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">首先，平台借助 Flink 实现高速有效的流数据接入，使得云上集群规模缩减为原来的十分之一，因此大大降低了运维成本。</span></li><li><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">其次，Parquet 格式的数据支持交互式查询，当用户仅对于某几个列数据感兴趣时可以通过分区和选择列的方式过滤不必要的数据，从而提升查询的性能。</span></li><li><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">再次，基于 AWS 的云端存储，平台的数据无需特殊存储形式。</span></li><li><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">之后，多级 ETL 进程能够确保更好的性能和数据质量。</span></li><li><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">最后，还能够兼顾性能容错及可演进性。</span></li></ul><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/67e1928b19af4e9cb425be31f0ea2a64><p class=pgc-img-caption></p></div><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">3. 平台特征及应用</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">Lyft 准实时数据分析平台需要每天处理千亿级事件，能够做到数据延迟小于 5 分钟，而链路中使用的组件确保了数据完整性，同时基于 ETL 去冗余操作实现了数据单一性保证。</span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5c95ae0afac64f6bbe4a66fe22d76467><p class=pgc-img-caption></p></div><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">数据科学家和数据工程师在建模时会需要进行自发的交互式查询，此外，平台也会提供实时机器学习模型正确性预警，以及实时数据面板来监控供需市场健康状况。</span></p><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">4. 基于 Flink 的准实时数据导入</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">下图可以看到当事件到达 Kinesis 之后就会被存储成为 EventBatch。通过 Flink-Kinesis 连接器可以将事件提取出来并送到 FlatMap 和 Record Counter 上面，FlatMap 将事件</span><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">打撒</span><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">并送到下游的 Global Record Aggregator 和 Tagging Partitioning 上面，每当做 CheckPoint 时会关闭文件并做一个持久化操作，针对于 StreamingFileSink 的特征，平台设置了每三分钟做一次 CheckPoint 操作，这样可以保证当事件进入 Kinesis 连接器之后在三分钟之内就能够持久化。</span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/454560c31a9b4feaa5a236654d8e7288><p class=pgc-img-caption></p></div><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">以上的方式会造成太多数量的小文件问题，因为数据链路支持成千上万种文件，因此使用了 Subtasks 记录本地事件权重，并通过全局记录聚合器来计算事件全局权重并广播到下游去。而 Operator 接收到事件权重之后将会将事件分配给 Sink。</span></p><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">5. ETL 多级压缩和去重</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">上述的数据链路也会做 ETL 多级压缩和去重工作，主要是 Parquet 原始数据会经过每小时的智能压缩去重的 ETL 工作，产生更大的 Parquet File。同理，对于小时级别压缩去重不够的文件，每天还会再进行一次压缩去重。对于新产生的数据会有一个原子性的分区交换，也就是说当产生新的数据之后，ETL Job 会让 Hive metastore 里的表分区指向新的数据和分区。这里的过程使用了启发性算法来分析哪些事件必须要经过压缩和去重以及压缩去重的时间间隔级别。此外，为了满足隐私和合规的要求，一些 ETL 数据会被保存数以年计的时间。</span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fdfabea2a62c4800a876103ef1f6b910><p class=pgc-img-caption></p></div><p><strong>03</strong></p><p><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">平台性能及容错深入分析</span></strong></p><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">1. 事件时间驱动的分区感测</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">Flink 和 ETL 是通过事件时间驱动的分区感测实现同步的。S3 采用的是比较常见的分区格式，最后的分区是由时间戳决定的，时间戳则是基于 EventTime 的，这样的好处在于能够带来 Flink 和 ETL 共同的时间源，这样有助于同步操作。此外，基于事件时间能够使得一些回填操作和主操作实现类似的结果。Flink 处理完每个小时的事件后会向事件分区写入一个 Success 文件，这代表该小时的事件已经处理完毕，ETL 可以对于该小时的文件进行操作了。<br></span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/8eaddf85633149a8aae601fb927defdb><p class=pgc-img-caption></p></div><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">Flink 本身的水印并不能直接用到 Lyft 的应用场景当中，主要是因为当 Flink 处理完时间戳并不意味着它已经被持久化到存储当中，此时就需要引入分区水印的概念，这样一来每个 Sink Source 就能够知道当前写入的分区，并且维护一个分区 ID，并且通过 Global State Aggregator 聚合每个分区的信息。每个 Subtasks 能够知道全局的信息，并将水印定义为分区时间戳中最小的一个。</span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/84437bec524c4246b91a38a0875d779f><p class=pgc-img-caption></p></div><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">ETL 主要有两个特点，分别是及时性和去重，而 ETL 的主要功能在于去重和压缩，最重要的是在非阻塞的情况下就进行去重。前面也提到 Smart ETL，所谓 Smart 就是智能感知，需要两个相应的信息来引导 Global State Aggregator，分别是分区完整性标识 SuccessFile，在每个分区还有几个相应的 States 统计信息能够告诉下游的 ETL 怎样去重和压缩以及操作的频率和范围。</span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f324d574ac4947369098a27235280d48><p class=pgc-img-caption></p></div><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">2. Schema 演进的挑战</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">ETL 除了去重和压缩的挑战之外，还经常会遇到 Schema 的演化挑战。Schema 演化的挑战分为三个方面，即不同引擎的数据类型、嵌套结构的演变、数据类型演变对去重逻辑的影响。</span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3f41aa74764d4c43a04f4acb41ea670b><p class=pgc-img-caption></p></div><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">3. S3 深入分析</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">Lyft 的数据存储系统其实可以认为是</span><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">数据湖</span><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">，对于 S3 而言，Lyft 也有一些性能的优化考量。S3 本身内部也是有分区的，为了使其具有并行的读写性能，添加了 S3 的熵数前缀，在分区里面也增加了标记文件，这两种做法能够极大地降低 S3 的 IO 性能的影响。标识符对于能否触发 ETL 操作会产生影响，与此同时也是对于 presto 的集成，能够让 presto 决定什么情况下能够扫描多少个文件。<br></span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/299247b7bc8c40b680198300ab8590c5><p class=pgc-img-caption></p></div><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">4. Parquet 优化方案</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">Lyft 的准实时数据分析平台在 Parquet 方面做了很多优化，比如文件数据值大小范围统计信息、文件系统统计信息、基于主键数据值的排序加快 presto 的查询速度以及二级索引的生成。</span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/195441355090468bbaa69c4af5e0ea8b><p class=pgc-img-caption></p></div><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">5. 基于数据回填的平台容错机制</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">如下两个图所示的是 Lyft 准实时数据分析平台的基于数据回填的平台容错机制。对于 Flink 而言，因为平台的要求是达到准实时，而 Flink 的 Job 出现失效的时候可能会超过一定的时间，当 Job 重新开始之后就会形成两个数据流，主数据流总是从最新的数据开始往下执行，附加数据流则可以回溯到之前中断的位置进行执行直到中断结束的位置。这样的好处是既能保证主数据流的准实时特性，同时通过回填数据流保证数据的完整性。</span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b79892359b414214bfc5507ef173c19d><p class=pgc-img-caption></p></div><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">对于 ETL 而言，基于数据回填的平台容错机制则表现在 Airflow 的幂等调度系统、原子压缩和 HMS 交换操作、分区自建自修复体系和 Schema 整合。</span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ccb2894fb00b47418a5187a115d7b742><p class=pgc-img-caption></p></div><p><br></p><p><strong>04</strong></p><p><br></p><p><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">总结与未来展望</span></strong></p><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">1. 体验与经验教训</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">利用 Flink 能够准实时注入 Parquet 数据，使得交互式查询体验为可能。同时，Flink 在 Lyft 中的应用很多地方也需要提高，虽然 Flink 在大多数情况的延时都能够得到保证，但是重启和部署的时候仍然可能造成分钟级别的延时，这会对于 SLO 产生一定影响。</span></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">此外，Lyft 目前做的一件事情就是改善部署系统使其能够支持 Kubernetes，并且使得其能够接近 0 宕机时间的效果。因为 Lyft 准实时数据分析平台在云端运行，因此在将数据上传到 S3 的时候会产生一些随机的网络情况，造成 Sink Subtasks 的停滞，进而造成整个 Flink Job 的停滞。而通过引入一些 Time Out 机制来检测 Sink Subtasks 的停滞，使得整个 Flink Job 能够顺利运行下去。</span></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">ETL 分区感应能够降低成本和延迟，成功文件则能够表示什么时候处理完成。此外，S3 文件布局对性能提升的影响还是非常大的，目前而言引入</span><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">熵数</span><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">还属于经验总结，后续 Lyft 也会对于这些进行总结分析并且公开。因为使用 Parquet 数据，因此对于 Schema 的兼容性要求就非常高，如果引入了不兼容事件则会使得下游的 ETL 瘫痪，因此 Lyft 已经做到的就是在数据链路上游对于 Schema 的兼容性进行检查，检测并拒绝用户提交不兼容的 Schema。</span></p><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e6a30b18f4e344af97f6f7ff66d7cc91><p class=pgc-img-caption></p></div><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">2. 未来展望</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">Lyft 对于准实时数据分析平台也有一些设想：</span></p><ul><li><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">首先，Lyft 希望将 Flink 部署在 Kubernetes 集群环境下运行，使得 Kubernetes 能够管理这些 Flink Job，同时也能够充分利用 Kubernetes 集群的高可扩展性。</span></li><li><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">其次，Lyft 也希望实现通用的流数据导入框架，准实时数据分析平台不仅仅支持事件，也能够支持数据库以及服务日志等数据。</span></li><li><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">再次，Lyft 希望平台能够实现 ETL 智能压缩以及事件驱动 ETL，使得回填等事件能够自动触发相应的 ETL 过程，实现和以前的数据的合并，同时将延时数据导入来对于 ETL 过程进行更新。</span></li><li><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">最后，Lyft 还希望准实时数据分析平台能够实现存储过程的改进以及查询优化，借助 Parquet 的统计数据来改善 presto 的查询性能，借助表格管理相关的开源软件对存储管理进行性能改善，同时实现更多的功能。</span></li></ul><div class=pgc-img><img alt="Lyft 基于 Flink 的大规模准实时数据分析平台" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9d06515cb0c54fc8bc09aeff2e87667c><p class=pgc-img-caption></p></div><p style=text-align:justify><strong><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">作者：</span></strong></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">徐赢博士是 Lyft 数据平台流媒体平台的技术领导（Technical Lead），目前主导准实时数据分析平台的架构开发。在 Lyft 之前，他曾在领英(Linkedin)以及 IBM 担任技术领导职位，主导领英跨数据中心数据库复制的上线，以及 IBM 高速数据传输技术的研发。</span></p><p style=text-align:justify><span style="color:#3f4a59;--tt-darkmode-color: #8897AB">高立博士在 Lyft 的数据平台团队中工作，目前领导 Lyft 数据平台内的多个数据基础架构项目，包括实时数据仓库，自服务机器学习平台项目等。 曾在 Salesforce，Fitbit，Groupon 和其他初创公司担任关键技术领导职务。</span></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Lyft','Flink','大规'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>