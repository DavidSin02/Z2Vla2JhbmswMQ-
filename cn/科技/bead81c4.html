<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>AUTOSAR学习笔记之外设 | 极客快訊</title><meta property="og:title" content="AUTOSAR学习笔记之外设 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/72de206539f04c369d19eeb1d6480b0b"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bead81c4.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bead81c4.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bead81c4.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bead81c4.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bead81c4.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bead81c4.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bead81c4.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bead81c4.html><meta property="article:published_time" content="2020-11-14T20:55:07+08:00"><meta property="article:modified_time" content="2020-11-14T20:55:07+08:00"><meta name=Keywords content><meta name=description content="AUTOSAR学习笔记之外设"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/bead81c4.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>AUTOSAR学习笔记之外设</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><br></p><div class=pgc-img><img alt=AUTOSAR学习笔记之外设 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/72de206539f04c369d19eeb1d6480b0b><p class=pgc-img-caption></p></div><p><strong>1. IO硬件抽象</strong></p><p>IO硬件抽象是ECU抽象层的一部分。IO硬件抽象模块的目标是使数据通过RTE来传输，而完全不依赖于ECU硬件。这就是说软件组件设计者不需要更多的了解信号是如何影响物理层的。因此，该模块是特定于ECU的。</p><p>这主要通过把ECU信号映射到IO抽象端口上来实现。模块IO硬件抽象要提供用于初始化整个IO硬件抽象的模块。</p><p>下图显示了IO硬件抽象模块。它位于MCAL驱动之上。就是说IO硬件抽象模块要调用驱动API来管理片上设备。MCAL驱动的配置依赖于将由IO硬件抽象模块提供的ECU信号的质量。例如，当引脚层发生相关的改变时（上升沿、下降沿），需要进行通知。系统设计者不得不配置MCAL驱动，以允许对给定信号进行通知。通知来自于驱动，并在IO硬件抽象模块中进行处理。</p><p><br></p><div class=pgc-img><img alt=AUTOSAR学习笔记之外设 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/328dc7f12ea24db58c703161cb93df90><p class=pgc-img-caption></p></div><p><strong>2. ADC驱动</strong></p><p>ADC驱动初始化并控制微控制器内部的模数转换单元。该驱动包含一系列的基本功能函数。为了能够在某些特殊的应用中进行信号的频率分析（例如，快速傅立叶变换），就需要加强流式存取的功能。</p><p>ADC驱动提供以下服务：</p><p>· 信号值结果的访问模式</p><p>· 流式访问。</p><p>通常，ADC通道的变换请求通过ADC通道组来进行控制。通道组可以运行于持续的变换模式或者单触发变换模式。</p><p>变换处理和交互作用：</p><p>在同一时刻，ADC驱动要管理一个以上的被配置成不同变换模式的组。</p><p>转换过程：</p><p>通常，ADC通道的转换请求通过ADC通道组来进行控制。一个组可以运行于持续的转换模式或者单触发转换模式。单触发转换模式的触发条件也要被配置和控制。</p><p>如果通道运行于不同的模式（例如，在普通操作时采用持续的转换模式，在特定时间点的特殊转换时使用单触发或者按照命令的转换方式），通道必须被分配给拥有不同操作模式的多个组。</p><p>为了改变组间共享的通道的操作模式，应用程序必须停止任何对包含指定通道的组的当前转换，然后启动包含指定通道的新组的转换。</p><p>为了让应用程序能够在任何时候执行立即转换，就要定义一个按照命令的转换方式。它必须挂起组转换，然后在按照命令的转换活动完成后重新激活它。</p><p><strong>3. DIO驱动</strong></p><p>DIO驱动提供基于端口和通道的、对内部通用I/O断点的读和写访问。这里的读和写并不被缓冲。这个驱动的基本行为是同步的。</p><p>DIO驱动提供了用于对下列设施进行读、写的服务：</p><p>· DIO通道（引脚）</p><p>· DIO端口</p><p>· DIO通道组</p><p>这些服务的行为是同步的。该模块工作于引脚和端口上，由PORT驱动来对它进行配置。因此，在DIO驱动里面就没有对该端口结构进行配置和初始化。</p><p>端口驱动模块：</p><p>很多端口和端口引脚是由端口驱动模块分配给各种功能的，比如</p><p>· 常规I/O</p><p>· ADC</p><p>· SPI</p><p>· PWM</p><p>DIO驱动抽象了对微控制器硬件引脚的访问。此外，它还能够对这些引脚进行分组。</p><p>DIO驱动提供以下服务：</p><p>· 一个一个地修改端口或通道组的输出通道的等级。</p><p>· 一个一个地读取端口或通道组的输入和输出通道的等级。</p><p>DIO驱动中的所有读写服务必须是可重入的。理由是：这些DIO驱动可以被不同的上层处理程序或驱动程序访问。这些上层模块可以并行的访问驱动。</p><p><strong>4. GPT驱动</strong></p><p>GPT驱动允许产生单触发或持续的计时器通知。这个模块使用通用计时器的硬件计时通道，因此就为操作系统中或者其它基本软件模块（在这类模块中，OS警告服务有过多的开销）中的使用提供了精确的、短期的计时。</p><p>GPT驱动提供了用于启动和停止硬件计时模块中的功能计时实例（通道）的服务。它能够产生单个超时周期以及重复超时周期。如果必须调用一个通知，那么当所请求的超时周期过期时，用户就能够对它进行配置。可以在运行时启用或禁用通知。</p><p>不管是从上一个通知发生以来的相对时间消耗，还是到下一个通知之间的剩余时间，都可以进行查询。</p><p><br></p><div class=pgc-img><img alt=AUTOSAR学习笔记之外设 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/f9521549cbc14b5a86acfccd54362788><p class=pgc-img-caption></p></div><p>注意，GPT驱动仅产生时间基础，而不服务于时间计数器。这个功能是由另一个模块（ICU驱动）提供的。</p><p>GPT驱动可以用来唤醒ECU，不管预定义的超时周期是否过期。模式转换服务将GPT驱动在普通操作和睡眠模式之间进行转换。</p><p>该驱动不提供超时周期，这些超时周期超过了被时钟源、预定标器和计时寄存器所限制的最大值。用户必须对这个进行处理。</p><p><strong>5. ICU驱动</strong></p><p>ICU驱动控制微控制器的输入捕获单元。它提供了下列特性：</p><p>· 周期性的、低端的、高端的时间测量</p><p>· 边缘检测和通知</p><p>· 边缘计数</p><p>· 边缘时间戳</p><p>· 唤醒中断</p><p>对于信号边缘检测来说，需要使用捕获比较单元的边缘检测器或外部时间的中断控制器。</p><p>对于信号测量来说，需要一个捕获计时器以及至少一个捕获寄存器。</p><p>ICU调制PWM信号，计算脉冲，测量频率和责任（duty）周期，产生简单的中断以及唤醒中断。</p><p>ICU驱动提供以下服务：</p><p>· 信号边缘通知</p><p>· 控制唤醒中断</p><p>· 周期信号时间测量</p><p>· 边缘时间戳，可用于获取非周期的信号</p><p>· 边缘计数</p><p>为了保证数据一致性，应该提供可重入的代码。</p><p>时间单元节拍</p><p>为了从寄存器值中获得时间，需要知道振荡器频率、预定标器等等。因为这些设置是在MCU模块中或其它模块中产生的，不可能计算这些时间。因此，时间和节拍之间的转换是由上层负责的。</p><p><strong>6. MCU驱动</strong></p><p>MCU驱动提供用于基本微控制器的初始化，下电，复位和其它MCAL软件模块需要的微控制器特定功能的服务。初始化服务提供了灵活性，同时，除了启动代码之外，还提供了应用程序相关的MCU初始化。启动代码是完全特定于MCU的。MCU驱动直接访问微控制器硬件，它位于微控制器抽象层（MCAL）中。</p><p>MCU驱动的特征：</p><p>· 初始化MCU时钟，PLL，时钟预定标器和MCU时钟分布</p><p>· 初始化RAM部件</p><p>· 激活微控制器节电模式</p><p>· 激活微控制器复位</p><p>另外，还有提供一个服务来从硬件处获得复位的原因。</p><p>MCU驱动微时钟和RAM初始化提供MCU服务。在MCU配置集中，特定于MCU的时钟（例如，PLL设置）和RAM（例如，段基地址和大小）设置必须被配置。</p><p><strong>7. 端口驱动</strong></p><p>该模块初始化微控制器的整个端口结构。很多端口和端口引脚可以被分配给不同的功能，比如：</p><p>· 通用I/O</p><p>· ADC</p><p>· SPI</p><p>· SCI</p><p>· PWM</p><p>由于这个原因，必须对这个端口结构进行总的配置和初始化。这些端口引脚的配置和使用是依赖于微控制器和ECU的。</p><p>该模块应该提供用于初始化微控制器的整个端口结构的服务。很多端口和端口引脚可以被分配给各种不同的功能。由于这个原因，必须有该端口结构的全部配置和初始化。这些端口引脚的配置和模式是依赖于微控制器和ECU的。</p><p>该端口驱动模块应该完成端口结构的全部配置和初始化，该端口结构是用在DIO驱动模块中的。因此，DIO驱动工作再引脚和端口之上，由端口驱动对它进行配置。端口和端口引脚的配置顺序是由配置工具负责的。</p><p>端口驱动应该在使用DIO功能之前进行初始化。否则DIO驱动会产生未定义的行为。</p><p>端口访问的原子性：端口驱动应该通过使用原子指令或者利用OS的中断屏蔽功能来提供对端口的原子访问。</p><p><strong>8. PWM驱动</strong></p><p>每个PWM通道都连接到一个属于微控制器的硬件PWM上。该驱动提供了初始化和控制微处理器内部的PWM的服务。PWM模块产生有不同脉冲宽度的脉冲。</p><p><strong>9. SPI处理程序/驱动</strong></p><p>SPI总线是一种主从多节点总线系统，主节点设置片选（CS）来选择一个从节点来进行数据通信。SPI有一个4线的同步串行接口。使用片选线来激活数据通信。</p><p>SPI模块提供基于通道的对SPI总线上的不同设备的读、写和传输访问。SPI通道代表数据元素（8到16比特）。这些通道可能是顺序组合的，不能够被中断。通道有一个静态配置定义的波特率、片选等等。SPI设备通常由所使用的SPI硬件单元和相关的片选线来标识。这个模块能够作为SPI主节点来使用。</p><p>这个软件模块的功能范围应该是可静态配置的，以尽可能多的适应每个ECU的时间需要。那就是说，比如同步的、异步的、或者两者都有的SPI访问都可以存在于ECU。因此，两个SPI驱动可以存在，但仅有一个处理接口。</p><p>SPI处理程序/驱动提供了一些服务来对通过SPI总线连接的设备进行读写。它提供了所需的机制来配置片上SPI外设。</p><p>单片式的SPI处理程序/驱动包含处理和驱动功能。它的主要目标是充分利用每个微控制器的特性，使得依赖于静态配置的实现最优化，以尽可能多的适应ECU的需要。</p><p><strong>10. 看门狗接口</strong></p><p>内部看门狗驱动控制MCU的内部看门狗计时器。它提供触发器功能和模式选择服务。</p><p>外部看门狗驱动</p><p>外部看门狗驱动控制外部硬件看门狗。它提供触发器功能和模式选择服务。它有和内部看门狗驱动一样的功能作用域。</p><p>如果在一个ECU内使用了多于一个的看门狗设备和看门狗驱动（例如，内部软件看门狗和外部硬件看门狗），该模块就使得看门狗管理程序能够选择合适的看门狗驱动，以及看门狗设备。</p><p>看门狗驱动接口提供了对下层看门狗驱动的服务的统一访问，比如模式转换和触发。有设备索引选择适当的看门狗设备。看门狗驱动的服务的行为（同步/异步/计时）是受保护的。</p><p>看门狗驱动接口没有给看门狗驱动增加额外的功能。看门狗驱动接口也没有从看门狗属性中进行抽象，比如toggle或窗口模式，超时周期等，就是说，该驱动接口没有隐藏下层看门狗驱动和看门狗设备的任何特性。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'AUTOSAR','学习','笔记'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>