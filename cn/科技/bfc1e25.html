<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>安全扫描神器Nmap 7.8 发布，全新Npcap、NSE大量改进 | 极客快訊</title><meta property="og:title" content="安全扫描神器Nmap 7.8 发布，全新Npcap、NSE大量改进 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/f25f11fc6fac4403b03fea6f98bd9801"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bfc1e25.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bfc1e25.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bfc1e25.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bfc1e25.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bfc1e25.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bfc1e25.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bfc1e25.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bfc1e25.html><meta property="article:published_time" content="2020-10-29T21:00:27+08:00"><meta property="article:modified_time" content="2020-10-29T21:00:27+08:00"><meta name=Keywords content><meta name=description content="安全扫描神器Nmap 7.8 发布，全新Npcap、NSE大量改进"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/bfc1e25.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>安全扫描神器Nmap 7.8 发布，全新Npcap、NSE大量改进</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>上周六在拉斯维加斯举行的Defcon2019极客大会上Gordon Lyon宣布Nmap 发布新版本7.80。该版本主要包括了全新Npcap Windows数据包捕获驱动程序更新以及80多项NSE脚本和库等更新。本文虫虫就带大家一起学习Nmap7.8带来的更新和改善。</p><h1>Npcap更新</h1><p>熟悉Nmap的同学都知道，Nmap套件中有一个Windows数据抓包程序Npcap，主要用于Windows数据包嗅探和发送。包括大名鼎鼎的抓包程序Wireshark底层现在也用的是Npcap。</p><div class=pgc-img><img alt="安全扫描神器Nmap 7.8 发布，全新Npcap、NSE大量改进" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f25f11fc6fac4403b03fea6f98bd9801><p class=pgc-img-caption></p></div><p>此前版本的Npcap主要基于Winpcap（2013停更），并通过Microsoft Light-Weight Filter (NDIS 6 LWF)技术和Windows Filtering Platform (NDIS 6 WFP)对其改进和性能提高。</p><p>Npcap开源项目源于2013年由Nmap创始人Gordon Lyon和北京大学罗杨博士发起，并由Google Summer of Code计划赞助，以MIT协议发布。由于Winpcap已经停止更新，Npcap通过底层开发构建了全新自己的Npcap原始数据包捕获/发送驱动程序，在兼容WinpcapAPI的基础上，使用更加现代API接口，在功能、性能、安全性方面都完胜老版本。</p><p>此次更新迭代了15个版本的Npcap更新，Npcap最新版本为0.9982。</p><div class=pgc-img><img alt="安全扫描神器Nmap 7.8 发布，全新Npcap、NSE大量改进" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a82d4354b1114e24b53149f9c65d48e5><p class=pgc-img-caption></p></div><h1>NSE改进</h1><p>NSE (Nmap scripting Engine)是Nmap提供的扩展脚本执行引擎的脚本。可以通过NSE执行脚本进行渗透测试。NSE支持的脚本使用Lua编程语言，具有简单快捷高效的特点。如果说Nmap是最优秀的扫描器的话，那么加上NSE我们可以说Nmap就是一款集网络发现、指纹版本探测、脆弱性探测、漏洞利用等功能的全功能安全平台。</p><p>除了Npcap，Nmap 7.8还带来了80多个各种更新和改善，其中包括11个新的NSE脚本，一堆新的库，错误修复和性能改进。</p><h1>新增脚本和库</h1><p>新增11个NSE脚本后，NSE脚本总有598个，此次新增加的脚本有：</p><p><strong>broadcast-hid-discoveryd</strong>：用于发现局域网上通过发送网络广播探测的发现HID设备。 [Brendan Coles]</p><p><strong>broadcast-jenkins-discove</strong>：用于在局域网上通过发送发现广播探测发现Jenkins服务器。 [Brendan Coles]</p><p><strong>http-hp-ilo-info</strong>：用于从HP Integrated Lights-Out（iLO）服务器中提取信息。 [rajeevrmenon97]</p><p><strong>http-sap-netweaver-leak</strong>：用于从其开启匿名访问知识管理单元的匿名访问探测SAP Netweaver Portal。 [ArphanetX]</p><p><strong>https-redirect</strong>：用于探测HTTPS网站重定向到同口的HTTP服务器。一些nginx服务器执行此操作，使ssl-*脚本失效。 [Daniel Miller]</p><p><strong>lu-enum</strong>：用于枚举TN3270E服务器的逻辑单元（LU）。 [Soldier of Fortran]</p><p><strong>rdp-ntlm-info</strong>：用于从RDP中服务提取Windows域信息。 [Tom Sellers]</p><p><strong>smb-vuln-webexec</strong>：用于检查是否安装WebExService，是否允许代码执行。 [Ron Bowes]</p><p><strong>smb-webexec-exploit</strong>：通过SYSTEM权限WebExService来运行任意命令。[Ron Bowes]</p><p><strong>ubiquiti-discovery</strong>：利用Ubiquiti发现服务和协助版本检测来提取信息。[om Sellers]</p><p>利用Nmap服务和应用程序版本检测的CPE信息调用查询CVE漏洞数据库API接口。[GMedian，Daniel Miller]</p><p><strong>stringaux.lua，</strong>字符串库。字符串处理函数收集本打包到了该新库。</p><p><strong>rand.lua</strong>，随机库。使用系统上最好的随机源来生成随机字串rand.lua库使用最好的随机源。</p><p><strong>oops.lua，</strong>调试信息库。新的库使错误报告变得容易，显示必要时调试细节，拒绝杂乱的情况下。</p><p><strong>tableaux.lua，</strong>新的实用表操作和搜索的函数库。</p><p><strong>knx.lua</strong>，新的KNX/Konnex库。包含KNX/Konnex设备通信常用的函数和定义。</p><h1>其他NSE功能和改善</h1><p><strong>HTTP库，</strong>新版本响应正文（response body）对gzip编码提供透明支持。对响应正文强制执行大小限制。可以使用脚本调整默认限制参数，适用于所有脚本，可使用HTTP请求选项重设各个参数。</p><p>HTTP响应解析器现在可以无理由地容忍状态行短语，它改善了与某些HTTP服务器的兼容性。</p><p>脚本XML输出中支持CR字符，不再被视为非法。</p><p><strong>rdp-enum-encryption，</strong>添加对TLS支持。 允许针对需要TLS的服务器确定协议版本，并为某些NLA/CredSSP信息收集奠定基础工作。</p><p><strong>http-enum</strong>库，避免破坏指纹信息中"严重级"和"ignore_404"值。没有标准指纹使用这些字段。 [Kostas Milonas]</p><p>更新mongodb脚本的执行规则，使其支持非常用端口（非27017）上运行的实例。</p><p>更新<strong>TN3270.lua</strong>并添加参数以禁用TN3270E。</p><p>更新了<strong>ftp-syst</strong>脚本，以防止潜在死循环bug。</p><p><strong>HTTP Set-Cookie</strong>头的解析器现在更符合RFC 6265：对空属性容错；对cookie和/或属性值中的双引号被作为字符处理；对空值和无值属性的被解析为等值；忽略名为"name"或"value"的属性。</p><p>从ODVA列表中更新<strong>enip-info</strong>供应商。</p><p>脚本<strong>http-sql-injection</strong>添加两个可以改善MySQL检测的常见错误字符串。</p><p>脚本<strong>http-default-accounts</strong>新支持选择多个指纹类别。也可以按名称选择指纹，支持非常具体的扫描。只支持不超过一个目标主机/端口运行。</p><p>增加选项<strong>http-host</strong>允许用户强制所有HTTP请求中Host头的host值。</p><p><strong>smtp.domain</strong>脚本，改用arg或目标域名，用于替换STARTTLS的EHLO命令中的exampledotcom。</p><p><strong>dns.lua</strong>中对edns-client-subnet（ECS）的支持已得到改进，包括：</p><p><strong>tls.lua </strong>如果协议版本是SSLv3，则在创建client_hello消息时只使用SSLv3记录层。 某些TLS实现不会与提供低于TLSv1.0的客户端进行握手。 脚本必须手动回退到SSLv3才能与SLv3服务器通信</p><p><strong>vulns.lua</strong>中的新漏洞状态UNKNOWN用于表示测试无法排除漏洞。</p><p><strong>tn3270.lua</strong>添加TN3270E支持和其他改进并更新tn3270-screen.nse以显示新内容设置。</p><p><strong>enip-info.nse</strong>，更新产品代码并添加检查响应长度。该脚本现在使用string.unpack为底层库。</p><h1>Bug修复</h1><p>解决rdp-enum-encryption中的两个协议解析问题以及RDP nse库在Windows XP下扫描中断。并澄清了协议类型。</p><p>使用符合RFC 7871的ECS代码；按照RFC 7871的要求正确修剪ECS地址；修复了阻止使用相同ECS选项表的错误。</p><p>解决了<strong>http-fileupload-exploiter，</strong>非从特定目录执行脚本时无法找到其资源文件的bug。</p><p>修复<strong>SSH NSE</strong>脚本在非SSH服务运行时，由两次释放libssh2会话数据引起的崩溃。</p><p>修复<strong>NTLM</strong>测试，目标提供为域名时候导致脚本不遵守smbdomain -arg选项的逻辑错误。</p><p>修复<strong>http-grep.match</strong> 的参数选项解析的bug。</p><p>修复http-vuln-cve2006-3392中阻止脚本正确生成漏洞报告的bug。</p><p>修复NSE库TN3270中的与屏幕渲染相关的bug。此补丁还改进了暴力脚本<strong>tso-brute。</strong></p><p>修复SIP，SASL和HTTP摘要认证当算法中包含小写字符的bug。</p><p>修复了<strong>brute.lua</strong>的BruteSocket包装器，由于套接字混淆而导致Nmap崩溃：nmap:nse_nsock.cc:672: int receive_buf(lua_State*, int,</p><p>lua_KContext):Assertion `lua_gettop(L) == 7' failed.</p><p>修复由于IPS关闭连接导致的<strong>smb-vuln-ms17-010</strong>错误。</p><p>修复<strong>ssl-ccs-injectio</strong>n中的一些假阳性条件，导致一些漏洞被错误的标记为使用致命警报而不是"unexpected message"。</p><p>修复脚本<strong>traceroute-geolocation</strong>由于GeoPlugin返回空座标时崩溃的bug。</p><p>修复脚本<strong>http-phpmyadmin-dir-traversal</strong>中的对任何POST请求URI的响应码200的误报的bug。</p><p>修复对非SSH服务使用SSH脚本导致的崩溃（double-free）。</p><h1>功能删除</h1><p>从脚本中删除了OSVDB引用，并尽可能用BID引用替换它们。</p><p>bin.lua<strong>，</strong>已被正式弃用。2年前Nmap7.25BETA2增加添加了Lua 5.3，通过string.pack和string.unpack提供本地支持二进制数据打包。所有现有脚本和库都已更新。</p><p>bit.lua，完全删除。它的所有功能都通过原生Lua按位运算取代，arshift（算术移位）转移到<strong>bits.lua</strong>库。</p><p>hostmap-ip2hosts.nse，被删除。API已经失效，该服务于2019年2月17日完全关闭。</p><h1>Ncat更新</h1><p>Ncat Nmap项目套件中又一个功能丰富支持多平台的网络实用程序，具有"网络瑞士军刀"之称，支持从命令行跨网络读取和写入数据。Ncat最初是用来支持Nmap而开发的，是对古老的Netcat重新实现的一个大大改进。它使用TCP和UDP进行通信，旨在成为可靠的后端工具，可为其他应用程序和用户提供网络连接。 Ncat不仅可以使用IPv4和IPv6，还可以为用户提供几乎无限的潜在用途。</p><div class=pgc-img><img alt="安全扫描神器Nmap 7.8 发布，全新Npcap、NSE大量改进" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9c4be33bac3b44eaa7e950ad8b8fdcb8><p class=pgc-img-caption></p></div><p>Nmap 7.8中队Ncat的更新主要如下：</p><p>1、在Socket允许的情况下，允许Ncat连接服务器的0端口。 、</p><p>2、为了避免混淆并支持非默认代理端口，选项--proxy需要用方括号表示法指3、定IPv6地址，例如--proxy [2001:db8::123]:456。</p><p>4、新的ncat选项--proxy-dns控制代理目标由远程代理服务器解析还是由本地解析。可通过--proxy-dns选项设置。</p><p>5、临时RSA密钥更新为2048位，用于解决配置了安全级别2的OpenSSL库的兼容性问题，比如在Debian或Kali操作系统时候导致的问题。</p><p>6、将AF_VSOCK（Linux VM套接字）功能添加到Nsock和Ncat。Linux VM套接字用于虚拟机和虚拟机管理程序之间的通信。</p><p>7、修复Windows上Ncat -e时候导致的提前终止连接的问题。</p><p>8、修复了在Windows上使用-e或-c选项时启动的命令的通信，尤其是在使用—ssl情况下。</p><p>9、修复了通过HTTP代理连接的IPv6 URL文本格式。</p><h1>Zenmap更新</h1><p>Zenmap Nmap套件中的跨平台图形UI界面软件。Zenmap是用Python语言编写的开源免费的图形界面，支持不同操作系统，包括Windows/Linux/Unix/Mac OS等。</p><p>Zenmap旨在为用户nmap提供更加简单的操作方式。简单常用的操作命令可以保存成为profile，用户扫描时选择profile即可；可以方便地比较不同的扫描结果；</p><div class=pgc-img><img alt="安全扫描神器Nmap 7.8 发布，全新Npcap、NSE大量改进" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/766485559bb14e348b3cddc5cf535ebf><p class=pgc-img-caption></p></div><p>namp 7.8新版本中Zenmap主要修复了以下bug：</p><p>修复了无法找到Nmap可执行文件且系统PATH包含非UTF-8字节的崩溃，比如Windows上。</p><p>修复使用dir时由于结果搜索导致的崩溃：operator: AttributeError: 'SearchDB' object has no attribute 'match_dir'</p><p>修复recent_scans.txt不可写时导致崩溃。</p><p>虫虫在Window 10下测试中发现以前好用快速多了，以前扫时候常死掉。</p><h1>其他功能和安全更新</h1><p>修复<strong>CVE-2019-1552</strong>漏洞。通过对OpenSSL的地址添加"C:\Program Files (x86)\Nmap\OpenSSL"前缀，预防未经授权的用户通过编写修改OpenSSL默认值配置到此目录。</p><p>修复<strong>CVE-2018-15173</strong>漏洞。通过减少LibPCRE资源限制，以便版本检测不能使用过多的堆栈。 此前，Nmap在低内存系统上运行时可能会因故意或意外难以匹配的目标服务而崩溃。。</p><p>允许使用冗长的命令行恢复nmap扫描。</p><p>修复遇到无效输入时，RMI解析器可能会崩溃的bug。</p><p>新版中使用<strong>pcap_create</strong>而非pcap_live_open，并在pcap描述符上设置即刻模式。解决了Linux上的数据包丢失问题，并能提高在其他平台上的性能。</p><p>针对adb的新服务probe和行匹配。Android Debug Bridge，允许远程执行代码，并在许多设备上是默认启用的。</p><p>修复由于Nmap使用未知的TCP选项，可能会导致忽略TCP响应数据包，从而使得验证失败的bug。</p><p>避免在DTLS连接期间发生错误时尝试重新连接SSLv2，解决由此导致的崩溃。</p><p>避免由于收到ARP或ND响应后由于匹配probe而导致的延迟。</p><p>支持Ubiquiti Discovery协议的v1和v2的新服务probe和规则配置的支持。设备通常会使相关服务保持开放状态，这会暴露大量信息，并可能被用于DdoS攻击的。并增加了针对v1协议的新nmap-payload条目。</p><p>在搜索Lua头文件时，通过实际使用的目录，而不是不是强制搜索/usr/include。</p><p>-v，-v详细级别限制为最多10级， Nmap内部也不再使用更高级别。</p><p>第一次probe发送到主机时启动主机超时时钟，主机组启动时就启动。有时，主机直到主机组的末端才会获得probe，从而导致超时的可能。</p><p>对Nmap的生日公告进行紧急修复，使Nmap在2018年9月1日以详细模式（-v选项）祝愿自己成为"21岁生日快乐"，而不是之前的"快乐21日"。</p><p>-PR选项被弃用。并且禁用。在主机发现扫描时候，ARP ping已经在可能使用地方默认启用，而不能使用场合下-PR没有任何效果。</p><h1>下载安装</h1><p>nmap的安装也比较简单，官方提供了Linux RPM，Mac和Windows的二进制安装包，可以直接下载安装。</p><h1>Window</h1><p>直接从官方nmap.org下载页download.html下载nmap-7.80-setup.exe，并点解安装即可：</p><div class=pgc-img><img alt="安全扫描神器Nmap 7.8 发布，全新Npcap、NSE大量改进" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5a8a728751e243b892cca7ab7c715675><p class=pgc-img-caption></p></div><p>安装步骤中会提示使用全新的Npcap版本，用WinPcpAPI兼容模式，该选项会卸载WinPcp。</p><div class=pgc-img><img alt="安全扫描神器Nmap 7.8 发布，全新Npcap、NSE大量改进" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/82d3aa65b4c14aae8af6babba6ebb786><p class=pgc-img-caption></p></div><h1>Mac</h1><p>直接从官方下载页下载<strong>nmap-7.80.dmg</strong>，打开安装即可：</p><div class=pgc-img><img alt="安全扫描神器Nmap 7.8 发布，全新Npcap、NSE大量改进" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/03714ce7a24f4f83b5c93cfa48bb4321><p class=pgc-img-caption></p></div><h1>Linux二进制安装</h1><p>支持RPM包的Redhat, Mandrake, Suse,等linux可以直接下载官方的二进制RPM安装包安装。</p><div class=pgc-img><img alt="安全扫描神器Nmap 7.8 发布，全新Npcap、NSE大量改进" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b754d93e493d4341803233fc2d29db8a><p class=pgc-img-caption></p></div><h1>源码安装</h1><p>没有提供二进制安装包的平台，可以使用源码安装方式手动安装。</p><p>bzip2 -cd nmap-7.80.tar.bz2 | tar xvf -</p><p>cd nmap-7.80</p><p>./configure</p><div class=pgc-img><img alt="安全扫描神器Nmap 7.8 发布，全新Npcap、NSE大量改进" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/eabe0e605f074b5c8fbf563274158617><p class=pgc-img-caption></p></div><p>make</p><p>make install</p><p>注意如果你系统比较新，可能缺少组件，需要先安装这些组件，比如虫虫在Ubuntu下安装时候，需要安装gcc，make,g++等,直接用下面命令安装</p><p>apt install gcc make g++ flex bison</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'扫描','Nmap','7.8'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>