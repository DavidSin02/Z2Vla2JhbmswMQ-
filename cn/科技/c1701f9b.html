<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Excel提取文字数字等内容的8种函数方法，巧妙利用双字节函数特性 | 极客快訊</title><meta property="og:title" content="Excel提取文字数字等内容的8种函数方法，巧妙利用双字节函数特性 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/a3fce796d36f4210b8a6bfe8a4fdd185"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c1701f9b.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c1701f9b.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c1701f9b.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c1701f9b.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c1701f9b.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c1701f9b.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c1701f9b.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c1701f9b.html><meta property="article:published_time" content="2020-11-14T21:04:06+08:00"><meta property="article:modified_time" content="2020-11-14T21:04:06+08:00"><meta name=Keywords content><meta name=description content="Excel提取文字数字等内容的8种函数方法，巧妙利用双字节函数特性"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/c1701f9b.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Excel提取文字数字等内容的8种函数方法，巧妙利用双字节函数特性</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>LEFT、RIGHT、MID这三个可以理解为按字数提取内容，LEFTB、RIGHTB、MIDB这三个可以理解为是按字节提取内容。他们参数都是一样的，就是字数和字节的区别。</p><p><strong class=highlight-text>▼</strong><strong>一、那什么叫字节，单字节、双字节。</strong></p><p>字节（Byte ）是计算机信息技术用于计量存储容量的一种计量单位。</p><p>在半角输入状态（ASCII码），一个英文字母（不分大小写）占1个字节的空间，一个数字占1个字节，一个英文状态的标点符号占1个字节，叫单字节字符；一个中文占2个字节，一个中文标点符号占2个字节，叫双字节字符。</p><p>国内、国外绝大部分的系统软件代码都是用半角字符完成的，也就是ASCII码。所以我们在用输入法时一定要默认“半角”状态。</p><p>举例说明：图1就是用文本函数LEN和LENB来分别计算字数和单、双字节，更能清楚了解到字节和字数的概念</p><div class=pgc-img><img alt=Excel提取文字数字等内容的8种函数方法，巧妙利用双字节函数特性 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a3fce796d36f4210b8a6bfe8a4fdd185><p class=pgc-img-caption>图1：字节和字数的区别</p></div><p><strong class=highlight-text>▼</strong><strong>二、了解完单双字节，现在来了解6个提取文本内容的函数。</strong></p><p>他们分别是：LEFT、RIGHT、MID按字数提取内容；LEFTB、RIGHTB、MIDB按字节数提取内容。</p><p><strong class=highlight-text>①</strong> LEFT函数是“从左边开始按要求的字个数来提取内容”，<strong>公式模板：LEFT(文本或单元格，提取几个字）</strong>。<strong class=highlight-text>如</strong>：=LEFT("我爱中国",2) 返回的结果是“我爱”这两个字。</p><p><strong class=highlight-text>②</strong> RIGHT函数是“从右边开始按要求的字个数来提取内容”，<strong>公式模板：RIGHT(文本或单元格，提取几个字）</strong>。<strong class=highlight-text>如</strong>：=RIGHT("我爱中国",2) 返回的结果是“中国”这两个字。</p><p><strong class=highlight-text>③</strong> MID函数是“从要求的指定位置开始，按要求的字个数来提取内容”，<strong>公式模板：MID(文本或单元格，从第几个字开始，提取几个字）</strong>。<strong class=highlight-text>如</strong>：=MID("我爱美好的生活",3,4) 返回的结果是“美好的生”这四个字。</p><p><strong class=highlight-text>④</strong> LEFTB函数是“从左边开始按要求的字节数来提取内容”，<strong>公式模板：LEFTB(文本或单元格，提取几个字节）</strong>。</p><p><strong class=highlight-text>如1</strong>：=LEFTB("我爱中国",5) 返回的结果是“我爱 ”<strong>这两个字加一个空格</strong>。因为一个中文是2个字节，5个字节表示2.5个中文，因为没有半个中文字，所以用一个空格代替，最终返回就是“我爱 ”。</p><p><strong class=highlight-text>如2</strong>：=LEFTB("我爱1314你",5)返回结果“我爱1”，因为5个字节表示2个中文加1个数字。</p><p><strong class=highlight-text>⑤</strong> RIGHTB函数是“从右边开始按要求的字节数来提取内容”，<strong>公式模板：RIGHTB(文本或单元格，提取几个字节）</strong>。<strong class=highlight-text>如</strong>：=RIGHTB("我爱 中国",5) 返回的结果是“ 中国 ”，<strong>这一个空格加2个中文</strong>。因为空格也算一个字节，一个中文是2个字节。</p><p><strong class=highlight-text>⑥ </strong>MIDB函数是“从要求的字节位置开始，按要求的字节数来提取内容”，<strong>公式模板：MIDB(文本或单元格，从第几个字节开始，提取几个字节）</strong>。<strong class=highlight-text>如</strong>：=MIDB("我爱美好的?生活",6,8) 返回的结果是“ 好的?生”，这一个空格+两个中文+英文符号?+一个中文。</p><p class=pgc-end-literature>解析下⑥原因：“我爱美”是6个字节，从第6个字节开始意味着“美”这个字不完整，因为“美”的位置是第5字节和第6字节两个字节位置组合的。字不完整只能用空格代替，代表1个字节。英文符号?也是1个字节，所以8字节刚好是（一个空格+两个中文+英文符号?+一个中文）。</p><p><strong class=highlight-text>▼</strong><strong>三、6个提取内容函数一定要配合查找函数FIND、SEARCH和FINDB、SEARCHB使用才灵活。</strong></p><p>FIND、SEARCH返回的是“查找的字”所在的<strong>字个数</strong>位置，FINDB、SEARCHB返回的是“查找的字”所在的<strong>字节数</strong>位置，</p><p><strong class=highlight-text>①</strong> 公式模板：=FIND(要查找的内容或单元格，被查的内容或单元格，从第几个字数开始查）；</p><p><strong class=highlight-text>②</strong> 公式模板：=SEARCH(要查找的内容或单元格，被查的内容或单元格，从第几个字数开始查）；</p><p><strong class=highlight-text>③</strong> 公式模板：=FINDB(要查找的内容或单元格，被查的内容或单元格，从第几个字节数开始查）；</p><p><strong class=highlight-text>④</strong> 公式模板：=SEARCHB(要查找的内容或单元格，被查的内容或单元格，从第几个字节数开始查）；</p><p><strong>注意：“要查找的内容”字数一定不能超过“被查的内容”字数，“要查找的内容”一定是在“被查的内容”里的，不然结果是错误值。</strong></p><p>如图2：</p><div class=pgc-img><img alt=Excel提取文字数字等内容的8种函数方法，巧妙利用双字节函数特性 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e42fb7f6d22d41f1b0aeccea1c63274c><p class=pgc-img-caption>图2：查找函数返回的字数位置和字节数位置</p></div><p><strong class=highlight-text>▼</strong><strong>四、查找函数FIND和SEARCH参数都一样，返回的结果也一样，那这两个函数有什么区别呢？</strong></p><p><strong class=highlight-text>①</strong> 函数 FIND与 FINDB是<strong>区分大小写</strong>并且<strong>不允许使用通配符</strong>。</p><p><strong class=highlight-text>如1</strong>：=FIND("a","AAaaA",1)返回结果是3，因为在FIND和FINDB函数眼里：大写的A和小写的a是不一样的，第3参数"1"表示从第1个数开始查找a，返回的结果是第一个a的位置，第一个a是在第3个字数位置。</p><p><strong class=highlight-text>如2</strong>：=FIND("a","AAaaA",4)返回结果是4，第3参数"4"表示从第4个数开始往后面查a，第4个数刚好是小写的a，所以结果返回是4。</p><p><strong class=highlight-text>如3：</strong>=FIND(" ","我爱 你",1)返回的结果是3，因为"我爱"后面有一个"空格"，第1参数双引号里也有"空格"，返回结果是3；如果第1参数双引号里没有"空格"，则返回的结果是第3参数的数字。</p><p>FINDB也是同理，从第1字节或者第4字节开始查找。</p><p><strong class=highlight-text>② </strong>函数 SEARCH与 SEARCHB是<strong>不区分大小写</strong>并且<strong>允许使用通配符</strong>。</p><p>什么是通配符？通配符是一种特殊语句，主要有星号(*)和问号(?)，用来模糊搜索内容。</p><p>一个星号(*)可以表示一个或无数个字符；不确定具体有没有内容也可以加星号(*)。如NOTE这个单词，你可以通过*note查找到，也可以通过*te查找。</p><p>一个问号(?)仅代表一个字符，而且这个字符必须存在。如NOTE这个单词，你可以通过no?e或者no??来找到，但是note?是找不到的，因为note后面没有内容了；换成note*是没问题的，因为*代表内容可有可无。</p><p><strong>总结下FIND和SEARCH区别：就是FIND区分大小写，SEARCH能用通配符，互补关系。FINDB和SEARCHB同理。</strong></p><p><strong class=highlight-text>▼</strong><strong>五、案例讲解</strong></p><p><strong class=highlight-text>①</strong> 案例一、如图3：因为地址不是太规律，第3行有两个“市”字，第4行没有省份，如果想一条公式直接完成，要嵌套很多函数，容易出错，这里用添加辅助列的方法，快速拆分提取内容。</p><div class=pgc-img><img alt=Excel提取文字数字等内容的8种函数方法，巧妙利用双字节函数特性 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/275250add0b8403789bf4dbebf967053><p class=pgc-img-caption>图3：拆分地址内容</p></div><ol start=1><li>1 在B2单元格输入公式：=IFERROR(LEFT(A2,FIND("省",A2,1)),"")。因为第四行没有省份，不在外面嵌套IFERROR函数会出现错误值，IFERROR就是可以把错误值变成我们想要的任何值，这里变成空值“”。详见图4：</li></ol><div class=pgc-img><img alt=Excel提取文字数字等内容的8种函数方法，巧妙利用双字节函数特性 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8952a823ac6c40bbb35c80e80976e3f8><p class=pgc-img-caption>图4：提取省份</p></div><ol start=1><li>2 提取市的内容，这时用到辅助列1。在辅助列F2单元格输入=RIGHT(A2,LEN(A2)-LEN(B2))，再在市列C2单元格输入=LEFT(F2,FIND("市",F2,1))。详见图5：</li></ol><div class=pgc-img><img alt=Excel提取文字数字等内容的8种函数方法，巧妙利用双字节函数特性 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7ca09df522174299a90a638cffe564a5><p class=pgc-img-caption>图5：提取市内容</p></div><ol start=1><li>3 提取区县市的内容，这时用到辅助列2。在辅助列G2单元格输入=RIGHT(F2,LEN(F2)-LEN(C2))，再在区县市列D2单元格输入=LEFT(G2,SUM(IFERROR(FIND({"县","区","市"},G2,1),0)))，<strong>因为是数组模式，一定要按CTRL+SHIFT+回车三键，不然会出错。</strong>详见图6：</li></ol><div class=pgc-img><img alt=Excel提取文字数字等内容的8种函数方法，巧妙利用双字节函数特性 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b1d2978413144c76b65a6b7ecbe35c61><p class=pgc-img-caption>图6：提取区县市</p></div><ol start=1><li>4 提取街道的内容，在E2单元格输入公式=RIGHT(G2,LEN(G2)-LEN(D2))，直接提取街道内容，详见图7：</li></ol><div class=pgc-img><img alt=Excel提取文字数字等内容的8种函数方法，巧妙利用双字节函数特性 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9e6912a61619497b944d92939d332d0f><p class=pgc-img-caption>图7：提取街道内容</p></div><p>我们通过添加辅助列的方法，就避开了MID这个函数，用更简单的方法提取出了更复杂且不是太规律的地址内容。</p><p><strong class=highlight-text>② </strong>案例二、提取数字开始往后的内容。在B2单元格输入公式=RIGHTB(A2,LENB(A2)-(SEARCHB("?",A2,1)-1))，利用中文是双字节，数字是单字节来求出数字的位置。详见图8：</p><div class=pgc-img><img alt=Excel提取文字数字等内容的8种函数方法，巧妙利用双字节函数特性 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ea6dd81ce02349399e8823305a881283><p class=pgc-img-caption>图8：求出数字往后的内容</p></div><p>喜欢的朋友帮忙点个关注、转发、点赞、收藏，谢谢！</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Excel','数字','内容'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>