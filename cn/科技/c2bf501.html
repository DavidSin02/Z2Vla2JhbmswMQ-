<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>高速信号-交流耦合电容 | 极客快訊</title><meta property="og:title" content="高速信号-交流耦合电容 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/285fa243da7c4d929207ce134a60a186"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c2bf501.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c2bf501.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c2bf501.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c2bf501.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c2bf501.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c2bf501.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c2bf501.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c2bf501.html><meta property="article:published_time" content="2020-10-29T21:07:03+08:00"><meta property="article:modified_time" content="2020-10-29T21:07:03+08:00"><meta name=Keywords content><meta name=description content="高速信号-交流耦合电容"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/c2bf501.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>高速信号-交流耦合电容</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p class=ql-align-justify>我们在处理高速差分信号的时候，经常使用交流耦合，也会使用直流耦合， 比如PCI Express我们看到的是交流耦合， 早期光模块和芯片之间的LVPECL则更多地使用直流耦合， 这篇文章我们不打算讨论什么情况下使用交流耦合，什么情况下使用直流耦合，我们要讨论的是使用交流耦合时需要解决的问题。</p><p class=ql-align-justify>很简单的一个问题， 交流耦合的电容需要选择多大？我们最常见的有0.1uF和0.01uF, 可是我们有想过为什么吗？为什么不选更大或者更小的？今天我们试图来用最简单的方式来解释，我们先使用频域的方式。</p><p class=ql-align-justify><br></p><p>◆◆<strong>1. 频域</strong>◆◆</p><p class=ql-align-justify><br></p><p class=ql-align-justify>以PCIE为例， 我们知道PCIE内含8b/10b编码，并且我们知道它的所谓2.5Gbps (PCIE1.0)， 5Gbps （PCIE2.0），8Gbps （PCIE3.0）速率指的包含了8b/10b后的速率，也就波特率，这一点和以太网不一样，千兆以太网的SGMII接口速率其实1.25Gbps，去除8b/10b后比特率是1000M，所以这里的千兆指的payload速率，而且PCIE的速率指的是加上开销以后的速率。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=高速信号-交流耦合电容 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/285fa243da7c4d929207ce134a60a186><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>题外话不多说， 我们知道8b/10b作用是确保0和1的平衡，使得信号不会出现很长0和很长的1，防止接收端的CDR失锁，也就是去除了信号的低频部分，使得信号的频谱保持在某个频率以上。如图所示经过8b/10b编码后信号的频谱在低频段衰减了8dB</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=高速信号-交流耦合电容 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8389cf3a65bd4c31830e546ac357ba0f><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>那么我们怎么去除为什么我们要去除低频，保留高频呢？这还得从AC耦合的结构原理说起：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=高速信号-交流耦合电容 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3e0b67a68a8d428d9f0a78e24647995e><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>根据上图，我们进一步细化一下模型如下：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=高速信号-交流耦合电容 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/00c0f7d1211043c5861d6f9c58e4b666><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>我们看到耦合电容和传输线的特征阻抗组成了一个高通的滤波器， 如下面的图所示我们需要确保此High pass filter的截止频率（绿色线）要低于信号经过8b/10b后的频谱的最低点（红色线），因为只有这样才能确保信号的能量完整的通过。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=高速信号-交流耦合电容 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/add90661daf84d2ca846d895a37e8b3e><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>下面我们来计算一下：</p><p><strong>1. 传输线特征阻抗Zr=50；</strong></p><p><strong>2. AC coupling电容值为C；</strong></p><p><strong>3. PCIE信号经过8b/10b后的信号频谱也是已知的，用频谱仪测一下或者简单用速率（比如PCIE2.0的5Gbps）除以4简单估算一下， 因为8b/10b最长0或者1只有4位了；</strong></p><p><strong>下面我们就来计算电容的值：</strong></p><div class=pgc-img><img alt=高速信号-交流耦合电容 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ffe5fded4a894727902e45687c3c7afb><p class=pgc-img-caption></p></div><p class=ql-align-justify>我们很容易就能得出C的值了，简单吧。</p><p>◆◆<strong>2. 时域</strong>◆◆</p><p class=ql-align-justify><br></p><p class=ql-align-justify>从时域来解释， 如果不用8b/10b的话，问题有两个，请看下面这段英文的精妙论述：AC coupled data signals would have DC drifts depending on the data content. A long sequence of 1´s will lead into positive drift and many 0´s will drift toward negative voltage. 意思是说如果没有8b/10b的话，信号的长0和长1会使得信号本身发生直流漂移。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=高速信号-交流耦合电容 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/29b579e9e82a4d82a23bcfc7a0357313><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>而加了8b/10b以后， CDR和恢复和信号直流漂移问题解决，下面这张图我们再来看， 所谓的“constant average value”已经趋于水平而不会上下摇摆。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=高速信号-交流耦合电容 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/cec8c6c9b277437bbb64123434c45b22><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>我们继续阐述8b/10b在时域的作用，信号经过了ac coupling电容之后，相当于经过了一个高通的滤波器，会产生的问题如下，高频跳变的能量可以顺利通过， 而低频的长0和长1则不能通过， 低频信号发生了畸变，而经过了8b/10b后，信号的低频部分被消除，也不会有畸变的事情发生了。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=高速信号-交流耦合电容 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/08030aad45f24ca1a06cb6a713759113><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>那么是不是就说加了8b/10b后，使用ac coupling就什么问题都没有了呢？ 否， 我们需要仔细考虑计算我们的ac coupling电容的大小。我们先来看看经过high pass后时域信号发生的变化：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=高速信号-交流耦合电容 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/22c0253e1c4e489087525ea00945c160><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>我们看到仍然有部分低频部分被去除，这可能是由于电容选择不合理，我们先来看看电容取值如果太小会怎么样？</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=高速信号-交流耦合电容 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/91c203445d4f406f9a63e3784a412b6c><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>电容如果取值太小，高速信号在充放电的时候，很显然容易饱和，我们知道电容一旦饱和，阻抗就会变得很大，抵抗外面的高速信号的变化，为什么小电容容易饱和呢？ 我们想象一下， 电容的正负极板其实是随着信号跳变也在不停地做充放电，这样极板两边的极性才会随着信号的高低而变化，如果是小电容再加上长0长1的低频部分到来，一下就充满了。一旦充满，最终导致信号的有效低频部分被去除，如下如所示，连续三个1就会导致电容饱和，我们仔细看一下变化的步骤：</p><p><strong>1) 开关打到1；</strong></p><p><strong>2) 电容阻抗无穷小，电阻分压最大；</strong></p><p><strong>3) 随着电容充电，电容的阻抗在变大，如果饱和了，阻抗就变得无穷大，阻碍外部的交流变化，而且电阻上的分压变得很小，导致直流漂移；</strong></p><p><strong>4) 开关打到2；</strong></p><p><strong>5) 电容开始放电，如此周而复始。</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>我们可以看到直流电平缓慢下降的直流漂移会带来什么， 会带来抖动，这种特殊的抖动叫PDJ。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=高速信号-交流耦合电容 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8446814af3174f7aa72eca7aa66fb8d2><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>我们看到当出现1110的数据时，就会在1到0转变的边沿偏离，产生抖动，产生的原因很简单，就是因为直流电平的起点低了，导致下降沿比正常的周期跳变信号提前了， 这种抖动是我们不喜欢的，一方面信号变形，另外一方面CDR需要跟踪并且修复这种抖动， 是的眼图质量裂化，误码率升高。</p><p class=ql-align-justify>那么电容选太大会怎么样？ 当然很容易想明白，不能选太大的电容，因为大电容含有ESL/ESR，也会对信号有衰减。</p><p class=ql-align-justify>所以从时域和频域的两个角度，我们知道高速信号的ac coupling的电容选择需要仔细计算和考量， 不能随意。</p><p class=ql-align-justify></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'信号','电容','耦合'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>