<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>SCAT：信令收集和分析工具 | 极客快訊</title><meta property="og:title" content="SCAT：信令收集和分析工具 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c441c56.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c441c56.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c441c56.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c441c56.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c441c56.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c441c56.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c441c56.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c441c56.html><meta property="article:published_time" content="2020-10-29T20:52:44+08:00"><meta property="article:modified_time" content="2020-10-29T20:52:44+08:00"><meta name=Keywords content><meta name=description content="SCAT：信令收集和分析工具"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/c441c56.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>SCAT：信令收集和分析工具</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>SCAT是一个由python编写的信令收集和分析工具，它会通过USB解析Qualcomm和Samsung基带的诊断信息，并生成包含蜂窝控制平面消息的GSMTAP数据包流。</p><p>安装要求<strong>PC</strong></p><p>目前仅在Linux上测试过，且多数为Ubuntu的各种衍生版本。Python版本不得低于python 3，另外还需要安装以下外部模块：</p><blockquote><p>pyUSB</p><p>pySerial</p></blockquote><p>要正确解码SCAT生成的GSMTAP数据包，需要Wireshark 2.6.0或更高版本。对于老版本的Wireshark，我们提供了一个Wireshark Lua插件来帮助其扩展GSMTAP解码功能。SCAT使用的GSMTAP定义基于libosmocore 0.11.0。</p><p><strong>智能手机</strong></p><p>蜂窝设备必须通过USB暴露诊断端口。这主要取决于所使用的设备，我们无法为所有设备提供一个通用的解决方案。使用关键字（你的设备名称）qpst在网上搜索获取，基于Qualcomm的智能手机暴露诊断端口的方法。</p><blockquote><p>三星：在拨号器中输入*#0808#，选择包含DM的任意USB模式条目；</p><p>韩版：在拨号器中输入3197123580，密码为9964127764320821。</p></blockquote><p>2018年以后的某些版本的固件，将会阻止使用上述代码访问隐藏菜单。目前并无解决方案。</p><p><strong>LG：在拨号器中输入277634#*#（TODO：USB测试菜单的确切位置）</strong></p><blockquote><p>在某些LG设备上，即使启用USB测试模式诊断端口也不会在Linux中暴露。这是由于使用了多个USB设备配置导致的；建议在此类设备中更改当前USB配置的udev规则。</p></blockquote><p>索尼：需要root。获取一个有root权限的adb shell，并输入命令setprop persist.usb.eng 1。</p><p>Nexus：需要root。获取一个有root权限的adb shell，并输入命令setprop sys.usb.config diag,adb。</p><blockquote><p>不适用于Pixel设备！</p></blockquote><p>Sailfish OS：( TODO：如何修改usb-moded设置）</p><p>虽然我们建议大家直接使用USB来访问诊断端口，但如果你的智能手机的诊断端口可以通过串行端口访问，那也是个不错的选择。所有基于Qualcomm的智能手机的qcserial内核模块并没有包含有关诊断端口的信息，而基于三星的智能手机也没有这样的模块。</p><p>通过USB访问基带诊断：</p><p>$ scat.py -t qc -u -a 001:010 -i 2</p><p>-t qc 定义我们正在解析Qualcomm基带。对于Samsung基带需要将qc替换为sec，且需要我们手动提供型号，如下所示：</p><p>$ scat.py -t sec -m e333 -u -a 001:006 -i 2</p><p>可用型号类型如下：</p><blockquote><p>-m cmc221s：CMC221S，用于早期的三星LTE调制解调器/智能手机；</p><p>-m e303：调制解调器芯片Exynos Modem 303；</p><p>-m e333：调制解调器芯片Exynos Modem 333</p></blockquote><p>较新的Exynos调制解调器可与-m e333选项一起使用，YMMV。</p><p>虽然有启发式算法可以确定连接的设备，但还是建议大家能明确指定诊断节点的USB设备地址和接口编号。-a 001:010 指定地址，该地址遵循lsusb命令中可见的相同语法。-i 2 指定诊断节点的接口编号，该编号也是特定于设备的。</p><p>通过串口访问基带诊断：</p><p>$ scat.py -t qc -s /dev/ttyUSB0</p><p>将/dev/ttyUSB0替换为你的诊断设备。</p><p>默认情况下，scat将包发送到127.0.0.1，控制平面包作为gsmtap发送到udp端口4729，用户平面包作为ip发送到udp端口47290。</p><p>使用Ctrl+C退出应用程序。</p><p><strong>高级选项</strong></p><p>可以使用-H 127.0.0.2开关更改发送GSMTAP数据包的目的地。例如，以下命令将所有数据包发送到127.0.0.2：</p><p>$ scat.py -t sec -m e333 -u -a 001:006 -i 2 -H 127.0.0.2</p><p>使用以下命令，以便能够使用Wireshark轻松对其进行排序：</p><p>ifconfig ethUSB 127.0.0.2 netmask 255.255.255.0 upsudo route add -net 127.0.0.0 netmask 255.255.255.0 gw 127.0.0.1</p><p>可以使用其他命令的输出自动确定USB总线地址。以下示例适用于三星Galaxy S5 Mini：</p><p>设备名称/型号处理器基带必要参数是/否需要root</p><p>Nokia 8110 4G (TA-1048)Snapdragon 205 MSM8905X5-t qcYes</p><p>Google Nexus 5 (LG-D821)Snapdragon 800 MSM8974MDM9x25-t qcYes</p><p>Google Nexus 5X (LG-H791)Snapdragon 808 MSM8992X10-t qcYes</p><p>Google Pixel 2 (G011A)Snapdragon 835 MSM8998X16-t qcYes还需修改系统分区LG G Flex 2 (LG-H955)Snapdragon 810 MSM8994X10-t qcNo</p><p>Sierra Wireless EM7455-X7 (MDM9635)-t qc-</p><p>Sony Xperia X (F5122)Snapdragon 650 MSM8956X8-t qcYes</p><p>Samsung Galaxy S III LTE (SHW-M210K)Exynos 4412CMC221S-t sec -m cmc221sNo</p><p>Samsung Galaxy S4 LTE (GT-I9505)Snapdragon APQ8064TQualcomm MDM9215-t qcNo</p><p>Samsung Galaxy S5 Mini (SM-G800F)Exynos 3470Exynos Modem 303-t sec -m e303No</p><p>Samsung Galaxy S6 (SM-G920F)Exynos 7420Exynos Modem 333-t sec -m e333No/Yes</p><p>Samsung Galaxy S6 Edge+ (SM-G928F)Exynos 7420Exynos Modem 333-t sec -m e333No/Yes</p><p>Samsung Galaxy S8 (SM-G950F)Exynos 8895Exynos Modem 355-t sec -m e333No/Yes</p><p>注：以上列表并未列出所有基于Qualcomm的设备。</p><p>已知错误</p><blockquote><p>在某些Qualcomm设备上，退出并多次启动应用程序后初始化最终会挂起，并且不会显示任何消息。根本原因仍在调查中。解决方案：重启智能手机；</p><p>在某些三星设备上，缺少EARFCN等元数据信息或没有出现控制平面消息。如果遇到此类情况，请告知你的环境以获取解决方案。</p></blockquote><p>参考文献</p><p>Byeongdo Hong，Shinjo Park，Hongil Kim，Dongkwan Kim，Hyunwook Hong，Hyunwoo Choi，Jean-Pierre Seifert，Sung-Ju Lee，Yongdae Kim。</p><p>窥视蜂窝围墙花园 - 一种封闭式网络诊断方法<strong> - </strong>IEEE Transactions on Mobile Computing（2018.2）</p><p><strong>转载来自FreeBuf.COM</strong></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'信令','SCAT','收集'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>