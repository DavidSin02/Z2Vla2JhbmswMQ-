<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Spring æºç ç¬¬ä¸€ç¯‡å¼€æ•´ï¼é…ç½®æ–‡ä»¶æ˜¯æ€ä¹ˆåŠ è½½çš„ï¼Ÿ | æå®¢å¿«è¨Š</title><meta property="og:title" content="Spring æºç ç¬¬ä¸€ç¯‡å¼€æ•´ï¼é…ç½®æ–‡ä»¶æ˜¯æ€ä¹ˆåŠ è½½çš„ï¼Ÿ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/f84645784a434e5e925752a6dcf83cb7"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c69eb53.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c69eb53.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c69eb53.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c69eb53.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c69eb53.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c69eb53.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c69eb53.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c69eb53.html><meta property="article:published_time" content="2020-10-29T20:59:53+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:53+08:00"><meta name=Keywords content><meta name=description content="Spring æºç ç¬¬ä¸€ç¯‡å¼€æ•´ï¼é…ç½®æ–‡ä»¶æ˜¯æ€ä¹ˆåŠ è½½çš„ï¼Ÿ"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/c69eb53.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Spring æºç ç¬¬ä¸€ç¯‡å¼€æ•´ï¼é…ç½®æ–‡ä»¶æ˜¯æ€ä¹ˆåŠ è½½çš„ï¼Ÿ</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p>ä¸Šå‘¨æŠŠè¯æ’‚å‡ºæ¥ï¼Œçœ‹èµ·æ¥å°ä¼™ä¼´ä»¬éƒ½æŒºæœŸå¾…çš„ï¼Œå…¶å®æ¾å“¥ä¹Ÿè¿«ä¸åŠå¾…æƒ³è¦å¼€å¯ä¸€ä¸ªå…¨æ–°çš„ç³»åˆ—ã€‚</p><p>ä½†æ˜¯ç›®å‰çš„ Spring Security ç³»åˆ—è¿˜åœ¨è¿è½½ä¸­ï¼Œè¿˜æ²¡å†™å®Œã€‚è¿è½½è¿™äº‹ï¼Œä¸€é¼“ä½œæ°”ï¼Œå†è€Œè¡°ä¸‰è€Œç«­ï¼Œä¸€å®šè¦ä¸€æ¬¡æå®šï¼ŒSpring Security å¦‚æœè¿™æ¬¡æ”¾ä¸‹æ¥ï¼Œä»¥åå°±å¾ˆéš¾å†æ‹¾èµ·æ¥äº†ã€‚</p><p>æ‰€ä»¥ç›®å‰çš„æ›´æ–°è¿˜æ˜¯ Spring Security ä¸ºä¸»ï¼Œ<strong>åŒæ—¶ Spring æºç è§£è¯»æ¯å‘¨è‡³å°‘æ›´æ–°ä¸€ç¯‡</strong>ï¼Œç­‰ Spring Security ç³»åˆ—æ›´æ–°å®Œæ¯•åï¼Œå°±å¼€è¶³é©¬åŠ›æ›´æ–° Spring æºç ã€‚å…¶å® Spring Security ä¸­ä¹Ÿæœ‰å¾ˆå¤šå’Œ Spring ç›¸é€šçš„åœ°æ–¹ï¼ŒSpring Security å¤§å®¶æ–‡ç« è®¤çœŸçœ‹ï¼Œæ¾å“¥ä¸ä¼šè®©å¤§å®¶å¤±æœ›çš„ï¼</p><h2 class=pgc-h-arrow-right>1.ä»ä½•è¯´èµ·</h2><p>Spring è¦ä»ä½•è¯´èµ·å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜æˆ‘è€ƒè™‘äº†å¾ˆé•¿æ—¶é—´ã€‚</p><p>å› ä¸º Spring æºç å¤ªç¹æ‚äº†ï¼Œä¸€å®šè¦é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„åˆ‡å…¥ç‚¹ï¼Œå¦åˆ™ä¸€ä¸Šæ¥å°±æŠŠå„ä½å°ä¼™ä¼´æ•´æ‡µäº†ï¼Œé‚£å‰©ä¸‹çš„æ–‡ç« ä¼°è®¡å°±ä¸æƒ³çœ‹äº†ã€‚</p><p>æƒ³äº†å¾ˆä¹…ä¹‹åï¼Œæˆ‘å†³å®šå°±å…ˆä»é…ç½®æ–‡ä»¶åŠ è½½è®²èµ·ï¼Œåœ¨é€æ­¥å±•å¼€ï¼Œé…ç½®æ–‡ä»¶åŠ è½½ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨ Spring æ—¶é‡åˆ°çš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œä»Šå¤©å°±å…ˆæ¥è¯´è¯´è¿™ä¸ªè¯é¢˜ã€‚</p><h2 class=pgc-h-arrow-right>2.ç®€å•çš„æ¡ˆä¾‹</h2><p>å…ˆæ¥ä¸€ä¸ªç®€å•çš„æ¡ˆä¾‹ï¼Œå¤§å®¶æ„Ÿå—ä¸€ä¸‹ï¼Œç„¶åæˆ‘ä»¬é¡ºç€æ¡ˆä¾‹è®²èµ·ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ™®é€šçš„ Maven é¡¹ç›®ï¼Œå¼•å…¥ spring-beans ä¾èµ–ï¼š</p><pre><code>&lt;dependency&gt;Â Â Â Â &lt;groupId&gt;org.springframework&lt;/groupId&gt;Â Â Â Â &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;Â Â Â Â &lt;version&gt;5.2.6.RELEASE&lt;/version&gt;&lt;/dependency&gt;</code></pre><p>ç„¶åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®ä½“ç±»ï¼Œå†æ·»åŠ ä¸€ä¸ªç®€å•çš„é…ç½®æ–‡ä»¶ï¼š</p><pre><code>publicÂ classÂ UserÂ {Â Â Â Â privateÂ StringÂ username;Â Â Â Â privateÂ StringÂ address;Â Â Â Â //çœç•¥Â getter/setter}</code></pre><p>resources ç›®å½•ä¸‹åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š</p><pre><code>&lt;?xmlÂ version="1.0"Â encoding="UTF-8"?&gt;&lt;beansÂ xmlns="http://www.springframework.org/schema/beans"Â Â Â Â Â Â Â xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"Â Â Â Â Â Â Â xsi:schemaLocation="http://www.springframework.org/schema/beansÂ http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;Â Â Â Â &lt;beanÂ class="org.javaboy.loadxml.User"Â id="user"/&gt;&lt;/beans&gt;</code></pre><p>ç„¶åå»åŠ è½½è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼š</p><pre><code>publicÂ staticÂ voidÂ main(String[]Â args)Â {Â Â Â Â XmlBeanFactoryÂ factoryÂ =Â newÂ XmlBeanFactory(newÂ ClassPathResource("beans.xml"));Â Â Â Â UserÂ userÂ =Â factory.getBean(User.class);Â Â Â Â System.out.println("userÂ =Â "Â +Â user);}</code></pre><p>è¿™é‡Œä¸ºäº†å±•ç¤ºæ•°æ®çš„è¯»å–è¿‡ç¨‹ï¼Œæˆ‘å°±å…ˆç”¨è¿™ä¸ªå·²ç»è¿‡æœŸçš„ XmlBeanFactory æ¥åŠ è½½ï¼Œè¿™å¹¶ä¸å½±å“æˆ‘ä»¬é˜…è¯»æºç ã€‚</p><p>ä¸Šé¢è¿™ä¸ªæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ Spring å…¥é—¨æ¡ˆä¾‹ï¼Œç›¸ä¿¡å¾ˆå¤šå°ä¼™ä¼´åœ¨ç¬¬ä¸€æ¬¡æ¥è§¦ Spring çš„æ—¶å€™ï¼Œå†™å‡ºæ¥çš„å¯èƒ½éƒ½æ˜¯è¿™ä¸ª Demoã€‚</p><p>åœ¨ä¸Šé¢è¿™æ®µä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆè¦åšçš„äº‹æƒ…å°±æ˜¯å…ˆæŠŠ XML é…ç½®æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå†å»è§£æå®ƒï¼Œå†å»ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>ä¸€æ­¥ä¸€æ­¥æ¥å§ï¼Œå…ˆæ¥çœ‹ XML æ–‡ä»¶å¦‚ä½•è¢«åŠ å…¥åˆ°å†…å­˜ä¸­å»ã€‚</p><h2 class=pgc-h-arrow-right>3.æ–‡ä»¶è¯»å–</h2><p>æ–‡ä»¶è¯»å–åœ¨ Spring ä¸­å¾ˆå¸¸è§ï¼Œä¹Ÿç®—æ˜¯ä¸€ä¸ªæ¯”è¾ƒåŸºæœ¬çš„åŠŸèƒ½ï¼Œè€Œä¸” Spring æä¾›çš„æ–‡ä»¶åŠ è½½æ–¹å¼ï¼Œä¸ä»…ä»…åœ¨ Spring æ¡†æ¶ä¸­å¯ä»¥ä½¿ç”¨ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­æœ‰å…¶ä»–æ–‡ä»¶åŠ è½½éœ€æ±‚ä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚</p><p>é¦–å…ˆï¼ŒSpring ä¸­ä½¿ç”¨ Resource æ¥å£æ¥å°è£…åº•å±‚èµ„æºï¼ŒResource æ¥å£æœ¬èº«å®ç°è‡ª InputStreamSource æ¥å£ï¼š</p><div class=pgc-img><img alt="Spring æºç ç¬¬ä¸€ç¯‡å¼€æ•´ï¼é…ç½®æ–‡ä»¶æ˜¯æ€ä¹ˆåŠ è½½çš„ï¼Ÿ" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f84645784a434e5e925752a6dcf83cb7><p class=pgc-img-caption></p></div><p>æˆ‘ä»¬æ¥çœ‹ä¸‹è¿™ä¸¤ä¸ªæ¥å£çš„å®šä¹‰ï¼š</p><pre><code>publicÂ interfaceÂ InputStreamSourceÂ {Â InputStreamÂ getInputStream()Â throwsÂ IOException;}publicÂ interfaceÂ ResourceÂ extendsÂ InputStreamSourceÂ {Â booleanÂ exists();Â defaultÂ booleanÂ isReadable()Â {Â Â returnÂ exists();Â }Â defaultÂ booleanÂ isOpen()Â {Â Â returnÂ false;Â }Â defaultÂ booleanÂ isFile()Â {Â Â returnÂ false;Â }Â URLÂ getURL()Â throwsÂ IOException;Â URIÂ getURI()Â throwsÂ IOException;Â FileÂ getFile()Â throwsÂ IOException;Â defaultÂ ReadableByteChannelÂ readableChannel()Â throwsÂ IOExceptionÂ {Â Â returnÂ Channels.newChannel(getInputStream());Â }Â longÂ contentLength()Â throwsÂ IOException;Â longÂ lastModified()Â throwsÂ IOException;Â ResourceÂ createRelative(StringÂ relativePath)Â throwsÂ IOException;Â @NullableÂ StringÂ getFilename();Â StringÂ getDescription();}</code></pre><p>ä»£ç å€’ä¸éš¾ï¼Œæˆ‘æ¥ç¨å¾®è§£é‡Šä¸‹ï¼š</p><ol start=1><li>InputStreamSource ç±»åªæä¾›äº†ä¸€ä¸ª getInputStream æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª InputStreamï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒInputStreamSource ä¼šå°†ä¼ å…¥çš„ File ç­‰èµ„æºï¼Œå°è£…æˆä¸€ä¸ª InputStream å†é‡æ–°è¿”å›ã€‚</li><li>Resource æ¥å£å®ç°äº† InputStreamSource æ¥å£ï¼Œå¹¶ä¸”å°è£…äº† Spring å†…éƒ¨å¯èƒ½ä¼šç”¨åˆ°çš„åº•å±‚èµ„æºï¼Œå¦‚ Fileã€URL ä»¥åŠ classpath ç­‰ã€‚</li><li>exists æ–¹æ³•ç”¨æ¥åˆ¤æ–­èµ„æºæ˜¯å¦å­˜åœ¨ã€‚</li><li>isReadable æ–¹æ³•ç”¨æ¥åˆ¤æ–­èµ„æºæ˜¯å¦å¯è¯»ã€‚</li><li>isOpen æ–¹æ³•ç”¨æ¥åˆ¤æ–­èµ„æºæ˜¯å¦æ‰“å¼€ã€‚</li><li>isFile æ–¹æ³•ç”¨æ¥åˆ¤æ–­èµ„æºæ˜¯å¦æ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚</li><li>getURL/getURI/getFile/readableChannel åˆ†åˆ«è¡¨ç¤ºè·å–èµ„æºå¯¹åº”çš„ URL/URI/File ä»¥åŠå°†èµ„æºè½¬ä¸º ReadableByteChannel é€šé“ã€‚</li><li>contentLength è¡¨ç¤ºè·å–èµ„æºçš„å¤§å°ã€‚</li><li>lastModified è¡¨ç¤ºè·å–èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´ã€‚</li><li>createRelative è¡¨ç¤ºæ ¹æ®å½“å‰èµ„æºåˆ›å»ºä¸€ä¸ªç›¸å¯¹èµ„æºã€‚</li><li>getFilename è¡¨ç¤ºè·å–æ–‡ä»¶åã€‚</li><li>getDescription è¡¨ç¤ºåœ¨èµ„æºå‡ºé”™æ—¶ï¼Œè¯¦ç»†æ‰“å°å‡ºå‡ºé”™çš„æ–‡ä»¶ã€‚</li></ol><p>å½“æˆ‘ä»¬åŠ è½½ä¸åŒèµ„æºæ—¶ï¼Œå¯¹åº”äº† Resource çš„ä¸åŒå®ç°ç±»ï¼Œæ¥çœ‹ä¸‹ Resource çš„ç»§æ‰¿å…³ç³»ï¼š</p><div class=pgc-img><img alt="Spring æºç ç¬¬ä¸€ç¯‡å¼€æ•´ï¼é…ç½®æ–‡ä»¶æ˜¯æ€ä¹ˆåŠ è½½çš„ï¼Ÿ" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4f870e802797400dae9960fcfbc7997e><p class=pgc-img-caption></p></div><p>å¯ä»¥çœ‹åˆ°ï¼Œé’ˆå¯¹ä¸åŒç±»å‹çš„æ•°æ®æºï¼Œéƒ½æœ‰å„è‡ªçš„å®ç°ï¼Œæˆ‘ä»¬è¿™é‡Œæ¥é‡ç‚¹çœ‹ä¸‹ ClassPathResource çš„å®ç°æ–¹å¼ã€‚</p><p>ClassPathResource æºç æ¯”è¾ƒé•¿ï¼Œæˆ‘è¿™é‡ŒæŒ‘ä¸€äº›å…³é”®éƒ¨åˆ†æ¥å’Œå¤§å®¶åˆ†äº«ï¼š</p><pre><code>publicÂ classÂ ClassPathResourceÂ extendsÂ AbstractFileResolvingResourceÂ {Â privateÂ finalÂ StringÂ path;Â @NullableÂ privateÂ ClassLoaderÂ classLoader;Â @NullableÂ privateÂ Class&lt;?&gt;Â clazz;Â publicÂ ClassPathResource(StringÂ path)Â {Â Â this(path,Â (ClassLoader)Â null);Â }Â publicÂ ClassPathResource(StringÂ path,Â @NullableÂ ClassLoaderÂ classLoader)Â {Â Â Assert.notNull(path,Â "PathÂ mustÂ notÂ beÂ null");Â Â StringÂ pathToUseÂ =Â StringUtils.cleanPath(path);Â Â ifÂ (pathToUse.startsWith("/"))Â {Â Â Â pathToUseÂ =Â pathToUse.substring(1);Â Â }Â Â this.pathÂ =Â pathToUse;Â Â this.classLoaderÂ =Â (classLoaderÂ !=Â nullÂ ?Â classLoaderÂ :Â ClassUtils.getDefaultClassLoader());Â }Â publicÂ ClassPathResource(StringÂ path,Â @NullableÂ Class&lt;?&gt;Â clazz)Â {Â Â Assert.notNull(path,Â "PathÂ mustÂ notÂ beÂ null");Â Â this.pathÂ =Â StringUtils.cleanPath(path);Â Â this.clazzÂ =Â clazz;Â }Â publicÂ finalÂ StringÂ getPath()Â {Â Â returnÂ this.path;Â }Â @NullableÂ publicÂ finalÂ ClassLoaderÂ getClassLoader()Â {Â Â returnÂ (this.clazzÂ !=Â nullÂ ?Â this.clazz.getClassLoader()Â :Â this.classLoader);Â }Â @OverrideÂ publicÂ booleanÂ exists()Â {Â Â returnÂ (resolveURL()Â !=Â null);Â }Â @NullableÂ protectedÂ URLÂ resolveURL()Â {Â Â ifÂ (this.clazzÂ !=Â null)Â {Â Â Â returnÂ this.clazz.getResource(this.path);Â Â }Â Â elseÂ ifÂ (this.classLoaderÂ !=Â null)Â {Â Â Â returnÂ this.classLoader.getResource(this.path);Â Â }Â Â elseÂ {Â Â Â returnÂ ClassLoader.getSystemResource(this.path);Â Â }Â }Â @OverrideÂ publicÂ InputStreamÂ getInputStream()Â throwsÂ IOExceptionÂ {Â Â InputStreamÂ is;Â Â ifÂ (this.clazzÂ !=Â null)Â {Â Â Â isÂ =Â this.clazz.getResourceAsStream(this.path);Â Â }Â Â elseÂ ifÂ (this.classLoaderÂ !=Â null)Â {Â Â Â isÂ =Â this.classLoader.getResourceAsStream(this.path);Â Â }Â Â elseÂ {Â Â Â isÂ =Â ClassLoader.getSystemResourceAsStream(this.path);Â Â }Â Â ifÂ (isÂ ==Â null)Â {Â Â Â throwÂ newÂ FileNotFoundException(getDescription()Â +Â "Â cannotÂ beÂ openedÂ becauseÂ itÂ doesÂ notÂ exist");Â Â }Â Â returnÂ is;Â }Â @OverrideÂ publicÂ URLÂ getURL()Â throwsÂ IOExceptionÂ {Â Â URLÂ urlÂ =Â resolveURL();Â Â ifÂ (urlÂ ==Â null)Â {Â Â Â throwÂ newÂ FileNotFoundException(getDescription()Â +Â "Â cannotÂ beÂ resolvedÂ toÂ URLÂ becauseÂ itÂ doesÂ notÂ exist");Â Â }Â Â returnÂ url;Â }Â @OverrideÂ publicÂ ResourceÂ createRelative(StringÂ relativePath)Â {Â Â StringÂ pathToUseÂ =Â StringUtils.applyRelativePath(this.path,Â relativePath);Â Â returnÂ (this.clazzÂ !=Â nullÂ ?Â newÂ ClassPathResource(pathToUse,Â this.clazz)Â :Â Â Â Â newÂ ClassPathResource(pathToUse,Â this.classLoader));Â }Â @OverrideÂ @NullableÂ publicÂ StringÂ getFilename()Â {Â Â returnÂ StringUtils.getFilename(this.path);Â }Â @OverrideÂ publicÂ StringÂ getDescription()Â {Â Â StringBuilderÂ builderÂ =Â newÂ StringBuilder("classÂ pathÂ resourceÂ [");Â Â StringÂ pathToUseÂ =Â this.path;Â Â ifÂ (this.clazzÂ !=Â nullÂ &amp;&amp;Â !pathToUse.startsWith("/"))Â {Â Â Â builder.append(ClassUtils.classPackageAsResourcePath(this.clazz));Â Â Â builder.append('/');Â Â }Â Â ifÂ (pathToUse.startsWith("/"))Â {Â Â Â pathToUseÂ =Â pathToUse.substring(1);Â Â }Â Â builder.append(pathToUse);Â Â builder.append(']');Â Â returnÂ builder.toString();Â }}</code></pre><ol start=1><li>é¦–å…ˆï¼ŒClassPathResource çš„æ„é€ æ–¹æ³•æœ‰å››ä¸ªï¼Œä¸€ä¸ªå·²ç»è¿‡æœŸçš„æ–¹æ³•æˆ‘è¿™é‡Œæ²¡æœ‰åˆ—å‡ºæ¥ã€‚å¦å¤–ä¸‰ä¸ªï¼Œæˆ‘ä»¬ä¸€èˆ¬è°ƒç”¨ä¸€ä¸ªå‚æ•°çš„å³å¯ï¼Œä¹Ÿå°±æ˜¯ä¼ å…¥æ–‡ä»¶è·¯å¾„å³å¯ï¼Œå®ƒå†…éƒ¨ä¼šè°ƒç”¨å¦å¤–ä¸€ä¸ªé‡è½½çš„æ–¹æ³•ï¼Œç»™ classloader èµ‹ä¸Šå€¼ï¼ˆå› ä¸ºåœ¨åé¢è¦é€šè¿‡ classloader å»è¯»å–æ–‡ä»¶ï¼‰ã€‚</li><li>åœ¨ ClassPathResource åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œä¼šå…ˆè°ƒç”¨ StringUtils.cleanPath æ–¹æ³•å¯¹ä¼ å…¥çš„è·¯å¾„è¿›è¡Œæ¸…ç†ï¼Œæ‰€è°“çš„è·¯å¾„æ¸…ç†ï¼Œå°±æ˜¯å¤„ç†è·¯å¾„ä¸­çš„ç›¸å¯¹åœ°å€ã€Windows ç³»ç»Ÿä¸‹çš„ \\ å˜ä¸º / ç­‰ã€‚</li><li>getPath æ–¹æ³•ç”¨æ¥è¿”å›æ–‡ä»¶è·¯å¾„ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼Œä¸åŒ…å« classpathã€‚</li><li>resolveURL æ–¹æ³•è¡¨ç¤ºè¿”å›èµ„æºçš„ URLï¼Œè¿”å›çš„æ—¶å€™ä¼˜å…ˆç”¨ Class.getResource åŠ è½½ï¼Œç„¶åæ‰ä¼šç”¨ ClassLoader.getResource åŠ è½½ï¼Œå…³äº Class.getResource å’Œ ClassLoader.getResource çš„åŒºåˆ«ï¼Œåˆèƒ½å†™ä¸€ç¯‡æ–‡ç« å‡ºæ¥ï¼Œæˆ‘è¿™é‡Œå°±å¤§æ¦‚è¯´ä¸‹ï¼ŒClass.getResource æœ€ç»ˆè¿˜æ˜¯ä¼šè°ƒç”¨ ClassLoader.getResourceï¼Œåªä¸è¿‡ Class.getResource ä¼šå…ˆå¯¹è·¯å¾„è¿›è¡Œå¤„ç†ã€‚</li><li>getInputStream è¯»å–èµ„æºï¼Œå¹¶è¿”å› InputStream å¯¹è±¡ã€‚</li><li>createRelative æ–¹æ³•æ˜¯æ ¹æ®å½“å‰çš„èµ„æºï¼Œå†åˆ›å»ºä¸€ä¸ªç›¸å¯¹èµ„æºã€‚</li></ol><p>è¿™æ˜¯ ClassPathResourceï¼Œå¦å¤–ä¸€ä¸ªå¤§å®¶å¯èƒ½ä¼šæ¥è§¦åˆ°çš„ FileSystemResource ï¼Œå°ä¼™ä¼´ä»¬å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹å…¶æºç ï¼Œæ¯” ClassPathResource ç®€å•ã€‚</p><p>å¦‚æœä¸æ˜¯ä½¿ç”¨ Springï¼Œæˆ‘ä»¬ä»…ä»…æƒ³è‡ªå·±åŠ è½½ resources ç›®å½•ä¸‹çš„èµ„æºï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨è¿™ç§æ–¹å¼ï¼š</p><pre><code>ClassPathResourceÂ resourceÂ =Â newÂ ClassPathResource("beans.xml");InputStreamÂ inputStreamÂ =Â resource.getInputStream();</code></pre><p>æ‹¿åˆ° IO æµä¹‹åè‡ªè¡Œè§£æå³å¯ã€‚</p><p>åœ¨ Spring æ¡†æ¶ï¼Œæ„é€ å‡º Resource å¯¹è±¡ä¹‹åï¼Œæ¥ä¸‹æ¥è¿˜ä¼šæŠŠ Resource å¯¹è±¡è½¬ä¸º EncodedResourceï¼Œè¿™é‡Œä¼šå¯¹èµ„æºè¿›è¡Œç¼–ç å¤„ç†ï¼Œç¼–ç ä¸»è¦ä½“ç°åœ¨ getReader æ–¹æ³•ä¸Šï¼Œåœ¨è·å– Reader å¯¹è±¡æ—¶ï¼Œå¦‚æœæœ‰ç¼–ç ï¼Œåˆ™ç»™å‡ºç¼–ç æ ¼å¼ï¼š</p><pre><code>publicÂ ReaderÂ getReader()Â throwsÂ IOExceptionÂ {Â ifÂ (this.charsetÂ !=Â null)Â {Â Â returnÂ newÂ InputStreamReader(this.resource.getInputStream(),Â this.charset);Â }Â elseÂ ifÂ (this.encodingÂ !=Â null)Â {Â Â returnÂ newÂ InputStreamReader(this.resource.getInputStream(),Â this.encoding);Â }Â elseÂ {Â Â returnÂ newÂ InputStreamReader(this.resource.getInputStream());Â }}</code></pre><p>æ‰€æœ‰è¿™ä¸€åˆ‡æå®šä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯é€šè¿‡ XmlBeanDefinitionReader å»åŠ è½½ Resource äº†ã€‚</p><h2 class=pgc-h-arrow-right>4.å°ç»“</h2><p>å¥½å•¦ï¼Œä»Šå¤©ä¸»è¦å’Œå°ä¼™ä¼´ä»¬åˆ†äº«ä¸€ä¸‹ Spring ä¸­çš„èµ„æºåŠ è½½é—®é¢˜ï¼Œè¿™æ˜¯å®¹å™¨å¯åŠ¨çš„èµ·ç‚¹ï¼Œä¸‹ç¯‡æ–‡ç« æˆ‘ä»¬æ¥çœ‹ XML æ–‡ä»¶çš„è§£æã€‚</p><p>å¦‚æœå°ä¼™ä¼´ä»¬è§‰å¾—æœ‰æ”¶è·ï¼Œè®°å¾—ç‚¹ä¸ªåœ¨çœ‹é¼“åŠ±ä¸‹æ¾å“¥å“¦ï½</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'é…ç½®æ–‡ä»¶','Spring','æºç '</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>