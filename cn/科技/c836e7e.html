<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>51单片机串行口的工作方式解析 | 极客快訊</title><meta property="og:title" content="51单片机串行口的工作方式解析 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/RNxYumUJ4xFnGH"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c836e7e.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c836e7e.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c836e7e.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c836e7e.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c836e7e.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c836e7e.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c836e7e.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c836e7e.html><meta property="article:published_time" content="2020-10-29T21:05:51+08:00"><meta property="article:modified_time" content="2020-10-29T21:05:51+08:00"><meta name=Keywords content><meta name=description content="51单片机串行口的工作方式解析"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/c836e7e.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>51单片机串行口的工作方式解析</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>方式0是外接串行移位寄存器方式。工作时，数据从RXD串行地输入/输出，TXD输出移位脉冲，使外部的移位寄存器移位。波特率固定为fosc/12（即，TXD每机器周期输出一个同位脉冲时，RXD接收或发送一位数据）。每当发送或接收完一个字节，硬件置TI=1或RI=1，申请中断，但必须用软件清除中断标志。</p><p>实际应用在串行I/O口与并行I/O口之间的转换。</p><p>2）方式1</p><p>方式1是点对点的通信方式。8位异步串行通信口，TXD为发送端，RXD为接收端。一帧为10位，1位起始位、8位数据位（先低后高）、1位停止位。波特率由T1或T2的溢出率确定。</p><p>在发送或接收到一帧数据后，硬件置TI=1或RI=1，向CPU申请中断；但必须用软件清除中断标志，否则，下一帧数据无法发送或接收。</p><img alt=51单片机串行口的工作方式解析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RNxYumUJ4xFnGH><p>（1）发送：CPU执行一条写SBUF指令，启动了串行口发送，同时将1写入输出移位寄存器的第9位。发送起始位后，在每个移位脉冲的作用下，输出移位寄存器右移一位，左边移入0，在数据最高位移到输出位时，原写入的第9位1的左边全是0，检测电路检测到这一条件后，使控制电路作最后一次移位，/SEND和DATA无效，发送停止位，一帧结束，置TI=1。</p><p>（2）接收：REN=1后，允许接收。接收器以所选波特率的16倍速率采样RXD端电平，当检测到一个负跳变时，启动接收器，同时把1FFH写入输入移位寄存器（9位）。由于接、发双方时钟频率有少许误差，为此接收控制器把一位传送时间16等分采样RXD，以其中7、8、9三次采样中至少2次相同的值为接收值。接收位从移位寄存器右边进入，1左移出，当最左边是起始位0时，说明已接收8位数据，再作最后一次移位，接收停止位。此后：</p><p>A、若RI=0、SM2=0，则8位数据装入SBUF，停止位入RB8，置RI=1。</p><p>B、 若RI=0、SM2=1，则只有停止位为1时，才有上述结果。</p><p>C、若RI=0、SM2=1，且停止位为0，则所接数据丢失。</p><p>D、若RI=1，则所接收数据丢失。</p><p>无论出现那种情况，检测器都重新检测RXD的负跳变，以便接收下一帧。</p><p>3）方式2、方式3</p><p>方式2和方式3是9位异步串行通信，一般用在多机通信系统中或奇偶校验的通信过程。在通讯中，TB8和RB8位作为数据的第9位，位SM2也起作用。方式2与方式3的区别只是波特率的设置方式不同。</p><p>（1）发送</p><p>向SBUF写入一个数据就启动串口发送，同时将TB8写入输出移位寄存器第9位。开始时，SEND和DATA都是低电平，把起始位输出到TXD。DATA为高，第一次移位时，将‘1’移入输出移位寄存器的第9位，以后每次移位，左边移入‘0’，当TB8移到输出位时，其左边是一个‘1’和全‘0’。检测到此条件，再进行最后一次移位，/SEND=1，DATA=0，输出停止位，置TI=1。</p><p>（2）接收</p><p>置REN=1，与方式1类似，接收器以波特率的16倍速率采样RXD端。</p><p>起始位0移到输入寄存器的最左边时，进行最后一次移位。在RI=0，SM2=0或接收到的第9位=1时，收到的一字节数据装入SBUF，第9位进入RB8，置RI=1；然后又开始检测RXD端负跳变。</p><p>3、 多机通信</p><p>在这里，多机系统是指‘一主多从’。51系列单片机中，利用第9位TB8/RB8来区分地址与数据信息，用位SM2确定接收方是否对地址或数据帧敏感。其原则是：</p><p>1）发送方用第9位TB8=1标志地址帧，TB8=0标志数据帧。</p><p>2）接收方若设置SM2=1，则只能接收到地址信息，若设SM2=0，则不管是地址还是数据帧，都能接收到。</p><p>利用方式2、3的特点，在点对点的通讯中，在发送方可以用第9位TB8作为奇偶校验位。在接收方，SM2位必须清0。</p><p>4、波特率</p><p>1）方式0的波特率=fosc/12</p><p>2）方式2的波特率=2^smod*fosc/64</p><p>3）方式1、3的波特率由T1或T2的溢出率和SMOD位确定：</p><p>（1）用T1：波特率=2^smod*T1定时器的溢出率/32，T1为方式2T1定时器溢出率=1/（（12/fosc）*（256-X））例：已知fosc=6MHz，SMOD=0，设置波特率为2400，求T1的计数初值X。</p><p>波特率=1/（（12/fosc）*（256-X））/32=fosc/12*32（256-X）（256-X）=fosc/2400/384=6M/2400/384；256-X~=6.5104X~=250=FAH 只能近似计算。</p><p>若fosc=11.0592MHz， 则256-X=11.0592M/2400/384=4068/384=12 X=F4H；可精确算出，对其它常用的标准波特率也是能正确算出。所以这个晶振频率是最常用的。</p><p>如果SMOD=1，则同样的X初值得出的波特率加倍。</p><p>（3）用T2：</p><p>在52型单片机中，串口方式1、3的波特率发生器选择由TCLK、RCLK位确定是T1还是T2。若TCLK=1，则发送器波特率来自T2，否则来自T1。若RCLK=1，则接收器波特率来自T2，否则来自T1。</p><p>由T2产生的波特率与SMOD无关。T2定时的最小单元=2/fosc。T2的溢出脉冲16分频后作为串口的发送或接收脉冲。</p><p>波特率=（1/（（2/fosc）（65536-X）））/16=fosc/（32（65536-X））例：已知fosc=11.0592MHz，求波特率=2400时的X2400=11059200/（32（65536-X）） 65536-X=144 X=65392=FF70H计数器初值寄存器：RCAP2H=0FFH，RCAP2L=70H。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'51','单片机','串行口'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>