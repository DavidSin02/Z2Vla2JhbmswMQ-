<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬1ç« ï¼šç›‘ç£å­¦ä¹ å’Œæœ´ç´ è´å¶æ–¯åˆ†ç±»-ç¬¬2éƒ¨åˆ†ï¼ˆç¼–ç ï¼‰ | æå®¢å¿«è¨Š</title><meta property="og:title" content="æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬1ç« ï¼šç›‘ç£å­¦ä¹ å’Œæœ´ç´ è´å¶æ–¯åˆ†ç±»-ç¬¬2éƒ¨åˆ†ï¼ˆç¼–ç ï¼‰ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/a6894d2d1ea64a8eb3bad2b892648639"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c9b52b0.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c9b52b0.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c9b52b0.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c9b52b0.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c9b52b0.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c9b52b0.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c9b52b0.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c9b52b0.html><meta property="article:published_time" content="2020-10-29T21:07:51+08:00"><meta property="article:modified_time" content="2020-10-29T21:07:51+08:00"><meta name=Keywords content><meta name=description content="æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬1ç« ï¼šç›‘ç£å­¦ä¹ å’Œæœ´ç´ è´å¶æ–¯åˆ†ç±»-ç¬¬2éƒ¨åˆ†ï¼ˆç¼–ç ï¼‰"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/c9b52b0.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬1ç« ï¼šç›‘ç£å­¦ä¹ å’Œæœ´ç´ è´å¶æ–¯åˆ†ç±»-ç¬¬2éƒ¨åˆ†ï¼ˆç¼–ç ï¼‰</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p><br></p><div class=pgc-img><img alt=æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬1ç« ï¼šç›‘ç£å­¦ä¹ å’Œæœ´ç´ è´å¶æ–¯åˆ†ç±»-ç¬¬2éƒ¨åˆ†ï¼ˆç¼–ç ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a6894d2d1ea64a8eb3bad2b892648639><p class=pgc-img-caption>The question of whether a computer can think is no more interesting than the question of whether a s</p></div><p><br></p><p>æ³¨æ„ï¼šå¦‚æœæ‚¨æ²¡æœ‰é˜…è¯»è¿‡ç¬¬ä¸€éƒ¨åˆ†ï¼Œå³æœ´ç´ è´å¶æ–¯ç†è®ºï¼Œæˆ‘å»ºè®®æ‚¨é€šè¯»å®ƒã€‚</p><p>åœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢sklearnåº“ã€‚ pythonä¸­çš„sklearnæä¾›äº†å‡†å¤‡ä½¿ç”¨æµè¡Œçš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œä¾‹å¦‚Naive Bayesã€‚ ï¼ˆå®ƒæ¶‰åŠå…¶ä»–äººï¼Œä¾‹å¦‚SVMï¼Œè¿™å°†åœ¨ä»¥åçš„æ–‡ç« ä¸­ä»‹ç»ï¼‰ã€‚ æœ‰äº†è¿™ä¸ªï¼Œæ‚¨å°±ä¸å¿…æ‰‹åŠ¨ç¼–ç è‡ªå·±çš„Naive Bayeså®ç°ã€‚</p><div class=pgc-img><img alt=æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬1ç« ï¼šç›‘ç£å­¦ä¹ å’Œæœ´ç´ è´å¶æ–¯åˆ†ç±»-ç¬¬2éƒ¨åˆ†ï¼ˆç¼–ç ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/21531acc949d4084a774a2de9a017973><p class=pgc-img-caption>Give a man a program, frustrate him for a day.Teach a man to program, frustrate him for a lifetime.</p></div><h1 class=pgc-h-arrow-right><strong>ç¼–ç ç»ƒä¹ </strong></h1><p>åœ¨æœ¬ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ ‡è®°ä¸º"åƒåœ¾é‚®ä»¶"æˆ–"éåƒåœ¾é‚®ä»¶"çš„ç”µå­é‚®ä»¶é›†è®­ç»ƒæ¨¡å‹ã€‚ æœ‰702å°ç”µå­é‚®ä»¶ï¼Œå‡åˆ†ä¸ºåƒåœ¾é‚®ä»¶å’Œéåƒåœ¾é‚®ä»¶ç±»åˆ«ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åœ¨260å°ç”µå­é‚®ä»¶ä¸­æµ‹è¯•è¯¥æ¨¡å‹ã€‚ æˆ‘ä»¬å°†è¦æ±‚æ¨¡å‹é¢„æµ‹æ­¤ç”µå­é‚®ä»¶çš„ç±»åˆ«ï¼Œå¹¶å°†å‡†ç¡®æ€§ä¸æˆ‘ä»¬å·²ç»çŸ¥é“çš„æ­£ç¡®åˆ†ç±»è¿›è¡Œæ¯”è¾ƒã€‚</p><p>è¿™æ˜¯æ–‡æœ¬æ•°æ®æŒ–æ˜çš„ç»å…¸ç¤ºä¾‹ã€‚</p><h1 class=pgc-h-arrow-right><strong>å…ˆå†³æ¡ä»¶</strong></h1><p>æœ¬æ•™ç¨‹å‡å®šç¼–ç å·¥ä½œæ˜¯åœ¨åŸºäºDebiançš„Linuxä¸Šå®Œæˆçš„ã€‚ å®‰è£…è¯´æ˜å¯èƒ½ä¼šå› æ‰€ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿè€Œå¼‚ï¼Œä½†æ˜¯pythonä»£ç ä¿æŒä¸å˜ã€‚</p><p>Â· å®‰è£…Pythonã€‚</p><p>Â· å®‰è£…Pipã€‚</p><p>Â· ä¸ºpythonå®‰è£…sklearnï¼špip install scikit-learn</p><p>Â· å®‰è£…numpyï¼špip install numpy</p><p>Â· å®‰è£…SciPyï¼špip install scipy</p><h1 class=pgc-h-arrow-right><strong>0.ä¸‹è½½</strong></h1><p>æˆ‘å·²ç»ä¸ºæ•°æ®é›†å’Œç¤ºä¾‹ä»£ç åˆ›å»ºäº†ä¸€ä¸ªgitå­˜å‚¨åº“ã€‚ ã€‚ æœ¬ç« è®¨è®ºäº†ç›¸åŒçš„æ•°æ®é›†ã€‚ æˆ‘å»ºè®®æ‚¨ç»§ç»­è®¨è®ºå¹¶è‡ªå·±ç¼–å†™ä»£ç ã€‚ ä¸‡ä¸€å®ƒå¤±è´¥äº†ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨/å‚è€ƒæˆ‘çš„ç‰ˆæœ¬æ¥äº†è§£å·¥ä½œã€‚</p><h1 class=pgc-h-arrow-right><strong>1.æ¸…æ´å’Œå‡†å¤‡æ•°æ®</strong></h1><p>æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ–‡ä»¶å¤¹test-mailå’Œtrain-mailã€‚ æˆ‘ä»¬å°†ä½¿ç”¨åŸ¹è®­é‚®ä»¶æ¥è®­ç»ƒæ¨¡å‹ã€‚ æ ·æœ¬ç”µå­é‚®ä»¶æ•°æ®é›†å¦‚ä¸‹æ‰€ç¤ºï¼š</p><blockquote class=pgc-blockquote-abstract><p>Subject: re : 2 . 882 s - > np np> deat : sun , 15 dec 91 2 : 25 : 2 est > : michael &lt; mmorse @ vm1 . yorku . ca > > subject : re : 2 . 864 query > > wlodek zadrozny ask " anything interest " > construction " s > np np " . . . second , > much relate : consider construction form > discuss list late reduplication ? > logical sense " john mcnamara name " tautologous thus , > level , indistinguishable " , , here ? " . ' john mcnamara name ' tautologous support those logic-base semantics irrelevant natural language . sense tautologous ? supplies value attribute follow attribute value . fact value name-attribute relevant entity ' chaim shmendrik ' , ' john mcnamara name ' false . tautology , . ( reduplication , either . )</p></blockquote><p><br></p><p>ç¬¬ä¸€è¡Œæ˜¯ä¸»é¢˜ï¼Œå†…å®¹ä»ç¬¬ä¸‰è¡Œå¼€å§‹ã€‚</p><p>å¦‚æœæ‚¨å¯¼èˆªåˆ°ä»»ä½•åŸ¹è®­é‚®ä»¶æˆ–æµ‹è¯•é‚®ä»¶ï¼Œæ‚¨å°†çœ‹åˆ°ä¸¤ç§æ ¼å¼çš„æ–‡ä»¶å</p><pre><code>number-numbermsg[number].txt : example 3-1msg1.txt (this are non spam emails)ORspmsg[Number].txt : example spmsga162.txt (these files are of spam emails).</code></pre><p><br></p><p>æ–‡æœ¬æ•°æ®æŒ–æ˜ä»»åŠ¡çš„ç¬¬ä¸€æ­¥æ˜¯æ¸…ç†å¹¶å‡†å¤‡æ¨¡å‹æ•°æ®ã€‚ åœ¨æ¸…æ´è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä»æ–‡æœ¬ä¸­åˆ é™¤äº†ä¸éœ€è¦çš„å•è¯ï¼Œè¡¨è¾¾å¼å’Œç¬¦å·ã€‚</p><p>è€ƒè™‘ä¸€ä¸ªæ–‡æœ¬ï¼š</p><blockquote class=pgc-blockquote-abstract><p>â€œHi, this is Alice. Hope you are doing well and enjoying your vacation.â€</p></blockquote><p>è¿™é‡Œçš„"æ˜¯"ï¼Œ"è¿™ä¸ª"ï¼Œ"æ˜¯"ç­‰å­—æ ·å¹¶æ²¡æœ‰çœŸæ­£æœ‰åŠ©äºåˆ†æã€‚ è¿™æ ·çš„å•è¯ä¹Ÿç§°ä¸ºåœç”¨è¯ã€‚å› æ­¤ï¼Œåœ¨æœ¬ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬ä»…è€ƒè™‘ç”µå­é‚®ä»¶ä¸­æœ€å¸¸è§çš„3000ä¸ªå•è¯ã€‚ ä»¥ä¸‹æ˜¯ä»£ç æ®µã€‚</p><p>æ¸…ç†å®Œæˆ‘ä»¬éœ€è¦çš„æ¯ä¸ªç”µå­é‚®ä»¶æ–‡æ¡£ä¹‹åï¼Œæˆ‘ä»¬åº”è¯¥ä»¥å•è¯é¢‘ç‡çš„æŸç§çŸ©é˜µè¡¨ç¤ºå½¢å¼ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœæ–‡æ¡£åŒ…å«æ–‡æœ¬ï¼š"å—¨ï¼Œè¿™æ˜¯çˆ±ä¸½ä¸ã€‚ çˆ±ä¸½ä¸ç”Ÿæ—¥å¿«ä¹"æ¸…æ´—åï¼Œæˆ‘ä»¬æƒ³è¦ä¸€äº›ä¸œè¥¿</p><pre><code>word      :   Hi this is Alice Happy Birthdayfrequency :   1   1    1  2      1      </code></pre><p><br></p><p>æˆ‘ä»¬éœ€è¦æ¯ä¸ªæ–‡æ¡£ã€‚ ä¸‹é¢çš„extract_featuresï¼ˆç¬¬2èŠ‚ï¼‰å‡½æ•°æ‰§è¡Œæ­¤æ“ä½œï¼Œç„¶åä¸ºæ¯ä¸ªæ–‡æ¡£åˆ é™¤ä¸å¤ªå¸¸è§çš„å•è¯ã€‚</p><pre><code>def make_Dictionary(root_dir):   all_words = []   emails = [os.path.join(root_dir,f) for f in os.listdir(root_dir)]   for mail in emails:        with open(mail) as m:            for line in m:                words = line.split()                all_words += words   dictionary = Counter(all_words)   # if you have python version 3.x use commented version.   # list_to_remove = list(dictionary)   list_to_remove = dictionary.keys()   for item in list_to_remove:       # remove if numerical.        if item.isalpha() == False:            del dictionary[item]        elif len(item) == 1:            del dictionary[item]    # consider only most 3000 common words in dictionary.   dictionary = dictionary.most_common(3000)   return dictionary</code></pre><p>make_Dictionaryä»æ–‡ä»¶å¤¹ä¸­è¯»å–ç”µå­é‚®ä»¶æ–‡ä»¶ï¼Œä¸ºæ‰€æœ‰å•è¯æ„å»ºå­—å…¸ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ é™¤é•¿åº¦ä¸æ˜¯1ä¸”ä¸æ˜¯çº¯ç²¹å­—æ¯çš„å•è¯ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬åªæå–å‡º3000ä¸ªæœ€å¸¸ç”¨çš„å•è¯ã€‚</p><h1 class=pgc-h-arrow-right><strong>2.æå–ç‰¹å¾å’Œç›¸åº”çš„æ ‡ç­¾çŸ©é˜µã€‚</strong></h1><p>æ¥ä¸‹æ¥å€ŸåŠ©å­—å…¸ï¼Œæˆ‘ä»¬ç”Ÿæˆæ ‡ç­¾å’Œè¯é¢‘çŸ©é˜µ</p><pre><code>word      :   Hi this is Alice Happy Birthdayfrequency :   1   1    1  2      1      1word      :   Hi this is Alice Happy Birthdayfrequency :   1   1    1  2      1      1</code></pre><pre><code>def extract_features(mail_dir):  files = [os.path.join(mail_dir,fi) for fi in os.listdir(mail_dir)]  features_matrix = np.zeros((len(files),3000))  train_labels = np.zeros(len(files))  count = 0;  docID = 0;  for fil in files:    with open(fil) as fi:      for i,line in enumerate(fi):        if i == 2:          words = line.split()          for word in words:            wordID = 0            for i,d in enumerate(dictionary):              if d[0] == word:                wordID = i                features_matrix[docID,wordID] = words.count(word)      train_labels[docID] = 0;      filepathTokens = fil.split('/')      lastToken = filepathTokens[len(filepathTokens) - 1]      if lastToken.startswith("spmsg"):          train_labels[docID] = 1;          count = count + 1      docID = docID + 1  return features_matrix, train_labels</code></pre><p><br></p><h1 class=pgc-h-arrow-right><strong>3ï¼Œä½¿ç”¨sklearnå¤©çœŸè´å¶æ–¯è¿›è¡Œè®­ç»ƒå’Œé¢„æµ‹</strong></h1><p>sklearn Naive Bayesçš„æ–‡æ¡£ï¼ˆåœ¨æ­¤ï¼‰æ¸…æ¥šåœ°è¯´æ˜äº†ç”¨æ³•å’Œå‚æ•°ã€‚</p><p>åŸºæœ¬ä¸Šï¼Œsklearn Naive Bayesä¸ºæ¨¡å‹è®­ç»ƒæä¾›äº†ä¸‰ç§é€‰æ‹©ï¼š</p><p>Â· é«˜æ–¯ï¼šç”¨äºåˆ†ç±»ï¼Œå¹¶å‡è®¾è¦ç´ æœä»æ­£æ€åˆ†å¸ƒã€‚</p><p>Â· å¤šé¡¹å¼ï¼šç”¨äºç¦»æ•£è®¡æ•°ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡æœ¬åˆ†ç±»é—®é¢˜ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘è¿›ä¸€æ­¥è¿›è¡Œbernoulliå®éªŒï¼Œè€Œä¸æ˜¯"åœ¨æ–‡æ¡£ä¸­å‡ºç°å•è¯"ï¼Œè€Œæ˜¯"è®¡ç®—åœ¨æ–‡æ¡£ä¸­å‡ºç°å•è¯çš„é¢‘ç‡"ï¼Œæ‚¨å¯ä»¥å°†å…¶è§†ä¸º"è§‚å¯Ÿåˆ°ç»“æœæ•°x_içš„æ¬¡æ•°" åœ¨næ¬¡å®¡åˆ¤ä¸­"ã€‚</p><p>Â· ä¼¯åŠªåˆ©ï¼ˆBernoulliï¼‰ï¼šå¦‚æœæ‚¨çš„ç‰¹å¾å‘é‡æ˜¯äºŒè¿›åˆ¶ï¼ˆå³é›¶å’Œä¸€ï¼‰ï¼Œåˆ™äºŒé¡¹å¼æ¨¡å‹å¾ˆæœ‰ç”¨ã€‚ ä¸€ç§åº”ç”¨æ˜¯ä½¿ç”¨"å•è¯è¢‹"æ¨¡å‹è¿›è¡Œæ–‡æœ¬åˆ†ç±»ï¼Œå…¶ä¸­1å’Œ0åˆ†åˆ«æ˜¯"å•è¯å‡ºç°åœ¨æ–‡æ¡£ä¸­"å’Œ"å•è¯æ²¡æœ‰å‡ºç°åœ¨æ–‡æ¡£ä¸­"ã€‚</p><p>åœ¨æœ¬ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨é«˜æ–¯ã€‚ ç¤ºä¾‹ä»£ç ç‰‡æ®µå¦‚ä¸‹æ‰€ç¤º</p><pre><code>TRAIN_DIR = "../train-mails"TEST_DIR = "../test-mails"dictionary = make_Dictionary(TRAIN_DIR)# using functions mentioned above.features_matrix, labels = extract_features(TRAIN_DIR)test_feature_matrix, test_labels = extract_features(TEST_DIR)from sklearn.naive_bayes import GaussianNBmodel = GaussianNB()#train modelmodel.fit(features_matrix, labels)#predictpredicted_labels = model.predict(test_feature_matrix)</code></pre><p><br></p><h1 class=pgc-h-arrow-right><strong>4.å‡†ç¡®æ€§å¾—åˆ†</strong></h1><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¯”è¾ƒé¢„æµ‹æ ‡ç­¾çš„å‡†ç¡®æ€§å¾—åˆ†ã€‚ å‡†ç¡®æ€§åˆ†æ•°åªæ˜¯æ­£ç¡®é¢„æµ‹çš„ç™¾åˆ†æ¯”ã€‚ å†æ¬¡ï¼Œsklearnä¸ºå‡†ç¡®åº¦åˆ†æ•°è®¡ç®—æä¾›äº†ç®€æ´çš„å®ç°ã€‚</p><pre><code>from sklearn.metrics import accuracy_scoreaccuracy = accuracy_score(test_labels, predicted_labels)</code></pre><h1 class=pgc-h-arrow-right><strong>5.æ‹¼å‡‘åœ¨ä¸€èµ·</strong></h1><pre><code>import osimport numpy as npfrom collections import Counterfrom sklearn.naive_bayes import GaussianNBfrom sklearn.metrics import accuracy_scoredef make_Dictionary(root_dir):   all_words = []   emails = [os.path.join(root_dir,f) for f in os.listdir(root_dir)]    for mail in emails:        with open(mail) as m:            for line in m:                words = line.split()                all_words += words    dictionary = Counter(all_words)    list_to_remove = dictionary.keys()    for item in list_to_remove:        if item.isalpha() == False:            del dictionary[item]        elif len(item) == 1:            del dictionary[item]    dictionary = dictionary.most_common(3000)    return dictionarydef extract_features(mail_dir):  files = [os.path.join(mail_dir,fi) for fi in os.listdir(mail_dir)]  features_matrix = np.zeros((len(files),3000))  train_labels = np.zeros(len(files))  count = 0;  docID = 0;  for fil in files:    with open(fil) as fi:      for i,line in enumerate(fi):        if i == 2:          words = line.split()          for word in words:            wordID = 0            for i,d in enumerate(dictionary):              if d[0] == word:                wordID = i                features_matrix[docID,wordID] = words.count(word)      train_labels[docID] = 0;      filepathTokens = fil.split('/')      lastToken = filepathTokens[len(filepathTokens) - 1]      if lastToken.startswith("spmsg"):          train_labels[docID] = 1;          count = count + 1      docID = docID + 1  return features_matrix, train_labelsTRAIN_DIR = "../train-mails"TEST_DIR = "../test-mails"dictionary = make_Dictionary(TRAIN_DIR)print "reading and processing emails from file."features_matrix, labels = extract_features(TRAIN_DIR)test_feature_matrix, test_labels = extract_features(TEST_DIR)model = GaussianNB()print "Training model."#train modelmodel.fit(features_matrix, labels)predicted_labels = model.predict(test_feature_matrix)print "FINISHED classifying. accuracy score : "print accuracy_score(test_labels, predicted_labels)</code></pre><p><br></p><p>åœ¨ä¸‹é¢å†™ä¸‹æ‚¨è·å¾—çš„å‡†ç¡®åº¦å¾—åˆ†ï¼</p><h1 class=pgc-h-arrow-right><strong>ä»»åŠ¡ç»™ä½ </strong></h1><p>Â· è¯•ç”¨å…¶ä»–æ¨¡å‹; å¤šé¡¹å¼å’Œä¼¯åŠªåˆ©ï¼Œå¹¶æ¯”è¾ƒæ‚¨è·å¾—çš„å‡†ç¡®æ€§å¾—åˆ†ã€‚</p><p>Â· å°è¯•å°†æœ€å¸¸ç”¨è¯çš„æ•°é‡ä»3000æ›´æ”¹ä¸ºå¤§å’Œå°ï¼Œç„¶åç»˜åˆ¶è·å¾—çš„ç²¾åº¦å›¾è¡¨ã€‚</p><p>è¯·åœ¨æ‚¨çš„æƒ³æ³•ä¸‹æ–¹ç•™è¨€ã€‚</p><h1 class=pgc-h-arrow-right><strong>ç»“è®º</strong></h1><p>æœ´ç´ è´å¶æ–¯è€ƒè™‘åŠŸèƒ½çš„ç‹¬ç«‹æ€§ã€‚ ä¾‹å¦‚ï¼Œå®ƒå‡è®¾ä¸€ä¸ªå•è¯/ç‰¹å¾çš„å‡ºç°ä¸å¦ä¸€å•è¯/ç‰¹å¾æ— å…³ã€‚ ä½†æ˜¯åœ¨ç°å®ç”Ÿæ´»ä¸­å¯èƒ½å¹¶éå¦‚æ­¤ï¼ˆGoodä¹‹åï¼Œmoringçš„å‘ç”Ÿç‡å¾ˆé«˜ï¼‰ã€‚ æˆ‘å¸Œæœ›ç¬¬ä¸€ç« ï¼ˆç†è®ºå’Œè¿™ä¸€ç« ï¼‰å¯¹æœ´ç´ è´å¶æ–¯æœ‰ä¸°å¯Œçš„è§è§£ã€‚</p><p>åœ¨è¿™é‡Œï¼Œæˆ‘å¾ˆä¹æ„ä¸ºæ‚¨æä¾›å»ºè®®å’Œåé¦ˆã€‚ éšæ„è¯„è®ºæ‚¨çš„æƒ³æ³•ï¼Œåé¦ˆæˆ–æƒ³æ³•ã€‚</p><p><br></p><div class=pgc-img><img alt=æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬1ç« ï¼šç›‘ç£å­¦ä¹ å’Œæœ´ç´ è´å¶æ–¯åˆ†ç±»-ç¬¬2éƒ¨åˆ†ï¼ˆç¼–ç ï¼‰ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/b0736470d40441459f3a66f3f969d6f9><p class=pgc-img-caption>The bugs!</p></div><p><br></p><p>(æœ¬æ–‡ç¿»è¯‘è‡ªSavan Patelçš„æ–‡ç« ã€ŠChapter 1 : Supervised Learning and Naive Bayes Classification â€” Part 2 (Coding)ã€‹ï¼Œå‚è€ƒï¼šhttps://medium.com/machine-learning-101/chapter-1-supervised-learning-and-naive-bayes-classification-part-2-coding-5966f25f1475)</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'æœºå™¨','å­¦ä¹ ','å…¥é—¨'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../cn/%E7%A7%91%E6%8A%80/f71cd4af.html alt=æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç¼–ç  class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/28eb40e101e44cfb8b88aac745d012d6 style=border-radius:25px></a>
<a href=../../cn/%E7%A7%91%E6%8A%80/f71cd4af.html title=æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç¼–ç >æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç¼–ç </a></li><hr><li><a href=../../cn/%E7%A7%91%E5%AD%A6/c75c54fc.html alt=æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç†è®º class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/db2b59aa64f64e189449ae9773356bed style=border-radius:25px></a>
<a href=../../cn/%E7%A7%91%E5%AD%A6/c75c54fc.html title=æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç†è®º>æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç†è®º</a></li><hr><li><a href=../../cn/%E7%A7%91%E6%8A%80/4b5cbda.html alt=æœºå™¨å­¦ä¹ å…¥é—¨ï¼šåå·®å’Œæ–¹å·® class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e4d7bca8189b4528b0f564ee473d2a68 style=border-radius:25px></a>
<a href=../../cn/%E7%A7%91%E6%8A%80/4b5cbda.html title=æœºå™¨å­¦ä¹ å…¥é—¨ï¼šåå·®å’Œæ–¹å·®>æœºå™¨å­¦ä¹ å…¥é—¨ï¼šåå·®å’Œæ–¹å·®</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>