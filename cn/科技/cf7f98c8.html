<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>é¢è¯•é˜¿é‡Œï¼Œç¾å›¢éƒ½ä¼šè¢«é—®åˆ°çš„Spring ,ä»åŸºç¡€åˆ°æºç ç»Ÿç»Ÿå¸®ä½ æå®š | æå®¢å¿«è¨Š</title><meta property="og:title" content="é¢è¯•é˜¿é‡Œï¼Œç¾å›¢éƒ½ä¼šè¢«é—®åˆ°çš„Spring ,ä»åŸºç¡€åˆ°æºç ç»Ÿç»Ÿå¸®ä½ æå®š - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/0ca013e258664cbb94ab2d6883b0fd97"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cf7f98c8.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cf7f98c8.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cf7f98c8.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cf7f98c8.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cf7f98c8.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cf7f98c8.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cf7f98c8.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cf7f98c8.html><meta property="article:published_time" content="2020-11-14T21:04:30+08:00"><meta property="article:modified_time" content="2020-11-14T21:04:30+08:00"><meta name=Keywords content><meta name=description content="é¢è¯•é˜¿é‡Œï¼Œç¾å›¢éƒ½ä¼šè¢«é—®åˆ°çš„Spring ,ä»åŸºç¡€åˆ°æºç ç»Ÿç»Ÿå¸®ä½ æå®š"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/cf7f98c8.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>é¢è¯•é˜¿é‡Œï¼Œç¾å›¢éƒ½ä¼šè¢«é—®åˆ°çš„Spring ,ä»åŸºç¡€åˆ°æºç ç»Ÿç»Ÿå¸®ä½ æå®š</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>1 å‰è¨€</h1><ol start=1><li>Springæ˜¯ä¸€ä¸ªè½»é‡çº§å¼€æºæ¡†æ¶ï¼Œå®ƒæ˜¯ä¸ºäº†è§£å†³ä¼ä¸šåº”ç”¨å¼€å‘çš„å¤æ‚æ€§è€Œåˆ›å»ºçš„ã€‚æ¡†æ¶çš„ä¸»è¦ä¼˜åŠ¿ä¹‹ä¸€å°±æ˜¯å…¶åˆ†å±‚æ¶æ„ï¼Œåˆ†å±‚æ¶æ„å…è®¸ä½¿ç”¨è€…é€‰æ‹©ä½¿ç”¨å“ªä¸€ä¸ªç»„ä»¶ï¼ŒåŒæ—¶ä¸º J2EE åº”ç”¨ç¨‹åºå¼€å‘æä¾›é›†æˆçš„æ¡†æ¶ã€‚</li><li>Springæ˜¯ä¼—å¤šä¼˜ç§€è®¾è®¡æ¨¡å¼çš„ç»„åˆï¼ˆå·¥å‚ã€å•ä¾‹ã€ä»£ç†ã€é€‚é…å™¨ã€åŒ…è£…å™¨ã€è§‚å¯Ÿè€…ã€æ¨¡æ¿ã€ç­–ç•¥ï¼‰ã€‚</li><li>Springçš„ç”¨é€”ä¸ä»…é™äºæœåŠ¡å™¨ç«¯çš„å¼€å‘ã€‚ä»ç®€å•æ€§ã€å¯æµ‹è¯•æ€§å’Œæ¾è€¦åˆçš„è§’åº¦è€Œè¨€ï¼Œä»»ä½•Javaåº”ç”¨éƒ½å¯ä»¥ä»Springä¸­å—ç›Šã€‚</li><li>Springå¹¶æœªæ›¿ä»£ç°æœ‰æ¡†æ¶äº§å“ï¼Œè€Œæ˜¯å°†ä¼—å¤šæ¡†æ¶è¿›è¡Œæœ‰æœºæ•´åˆï¼Œç®€åŒ–ä¼ä¸šçº§å¼€å‘ï¼Œä¿—ç§°"èƒ¶æ°´æ¡†æ¶"ã€‚</li></ol><h1 class=pgc-h-arrow-right>2 Springæ¶æ„ç»„æˆ</h1><p>Springæ¶æ„ç”±è¯¸å¤šæ¨¡å—ç»„æˆï¼Œå¯åˆ†ç±»ä¸º</p><ul><li>æ ¸å¿ƒæŠ€æœ¯ï¼šä¾èµ–æ³¨å…¥ï¼Œäº‹ä»¶ï¼Œèµ„æºï¼Œi18nï¼ŒéªŒè¯ï¼Œæ•°æ®ç»‘å®šï¼Œç±»å‹è½¬æ¢ï¼ŒSpELï¼ŒAOPã€‚</li><li>æµ‹è¯•ï¼šæ¨¡æ‹Ÿå¯¹è±¡ï¼ŒTestContextæ¡†æ¶ï¼ŒSpring MVCæµ‹è¯•ï¼ŒWebTestClientã€‚</li><li>æ•°æ®è®¿é—®ï¼šäº‹åŠ¡ï¼ŒDAOæ”¯æŒï¼ŒJDBCï¼ŒORMï¼Œå°é€XMLã€‚</li><li>Spring MVCå’Œ Spring WebFlux Webæ¡†æ¶ã€‚</li><li>é›†æˆï¼šè¿œç¨‹å¤„ç†ï¼ŒJMSï¼ŒJCAï¼ŒJMXï¼Œç”µå­é‚®ä»¶ï¼Œä»»åŠ¡ï¼Œè°ƒåº¦ï¼Œç¼“å­˜ã€‚</li><li>è¯­è¨€ï¼šKotlinï¼ŒGroovyï¼ŒåŠ¨æ€è¯­è¨€ã€‚</li><li>List item</li></ul><p>Springæ¶æ„ç»„æˆå¦‚ä¸‹å›¾</p><p><br></p><div class=pgc-img><img alt="é¢è¯•é˜¿é‡Œï¼Œç¾å›¢éƒ½ä¼šè¢«é—®åˆ°çš„Spring ,ä»åŸºç¡€åˆ°æºç ç»Ÿç»Ÿå¸®ä½ æå®š" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/0ca013e258664cbb94ab2d6883b0fd97><p class=pgc-img-caption></p></div><p><br></p><h1 class=pgc-h-arrow-right>3 Springç¯å¢ƒæ­å»º</h1><h1 class=pgc-h-arrow-right>3.1 pom.xmlä¸­å¼•å…¥Springå¸¸ç”¨ä¾èµ–</h1><pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0"         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"         xsi:schemaLocation=         "http://maven.apache.org/POM/4.0.0           http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;    &lt;groupId&gt;com.qf&lt;/groupId&gt;    &lt;artifactId&gt;hello-spring&lt;/artifactId&gt;    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;    &lt;dependencies&gt;        &lt;!-- Springå¸¸ç”¨ä¾èµ– --&gt;        &lt;dependency&gt;            &lt;groupId&gt;org.springframework&lt;/groupId&gt;            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;            &lt;version&gt;5.1.6.RELEASE&lt;/version&gt;        &lt;/dependency&gt;    &lt;/dependencies&gt;&lt;/project&gt;</code></pre><h1 class=pgc-h-arrow-right>3.2 åˆ›å»ºSpringé…ç½®æ–‡ä»¶</h1><p>å‘½åæ— é™åˆ¶ï¼Œçº¦å®šä¿—æˆå‘½åæœ‰ï¼šspring-context.xmlã€applicationContext.xmlã€beans.xml</p><pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans"       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;&lt;/beans&gt;</code></pre><h1 class=pgc-h-arrow-right>4 Springå·¥å‚ç¼–ç ï¼ˆå…¥é—¨ç¨‹åºï¼‰</h1><h1 class=pgc-h-arrow-right>4.1 å®šä¹‰ç›®æ ‡Beanç±»å‹</h1><pre><code>public class MyClass{    public void show(){        System.out.println("HelloWorld");    }}</code></pre><h1 class=pgc-h-arrow-right>4.2spring-context.xmlä¸­çš„&lt; beans >å†…éƒ¨é…ç½®bean</h1><p>åœ¨spring-context.xmlä¸­é…ç½®MyClassçš„beanåï¼Œå½“é¡¹ç›®å¯åŠ¨æ—¶ï¼Œspringå®¹å™¨ä¼šè‡ªåŠ¨åˆ›å»ºMyClasså®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹åå­—å«mc</p><pre><code>&lt;!-- é…ç½®å®ä¾‹ï¼ˆid:â€œå”¯ä¸€æ ‡è¯†â€  class="éœ€è¦è¢«åˆ›å»ºçš„ç›®æ ‡å¯¹è±¡å…¨é™å®šå"ï¼‰ --&gt;&lt;bean id="mc" class="com.qf.spring.part1.factory.MyClass" /&gt;</code></pre><p>æµ‹è¯•ä»£ç </p><pre><code>public class TestFactory{    /**     * ç¨‹åºä¸­çš„å¯¹è±¡éƒ½äº¤ç”±Springçš„ApplicationContextå·¥å‚è¿›è¡Œåˆ›å»ºã€‚     */    public static void main(String[] args){        //1\. è¯»å–é…ç½®æ–‡ä»¶ä¸­æ‰€éœ€åˆ›å»ºçš„beanå¯¹è±¡ï¼Œå¹¶è·å¾—å·¥å‚å¯¹è±¡        ApplicationContext ctx = new ClassPathXmlApplicationContext("spring-context.xml");        //2\. é€šè¿‡idè·å–beanå¯¹è±¡        MyClass mc = (MyClass) ctx.getBean("mc");        //3\. ä½¿ç”¨å¯¹è±¡        mc.show();    }}</code></pre><h1 class=pgc-h-arrow-right>5 IoCï¼ˆInversion of Control ï¼‰æ§åˆ¶åè½¬</h1><p>æ§åˆ¶åè½¬æ˜¯Springæ¡†æ¶çš„æ ¸å¿ƒï¼Œæ‰€è°“æ§åˆ¶åè½¬å°±æ˜¯åº”ç”¨æœ¬èº«ä¸è´Ÿè´£ä¾èµ–å¯¹è±¡çš„åˆ›å»ºåŠç»´æŠ¤ï¼Œä¾èµ–å¯¹è±¡çš„åˆ›å»ºåŠç»´æŠ¤æ˜¯ç”±å¤–éƒ¨å®¹å™¨è´Ÿè´£çš„ï¼Œ è¿™æ ·æ§åˆ¶æƒå°±ç”±åº”ç”¨è½¬ç§»åˆ°äº†å¤–éƒ¨å®¹å™¨ï¼Œæ§åˆ¶æƒçš„è½¬ç§»å°±æ˜¯æ‰€è°“åè½¬ã€‚è¿™æ ·å°±ç”±ä¹‹å‰çš„è‡ªå·±åˆ›å»ºä¾èµ–å¯¹è±¡ï¼Œå˜ä¸ºç”±springå®¹å™¨åˆ›å»ºã€‚(å˜ä¸»åŠ¨ä¸ºè¢«åŠ¨ï¼Œå³åè½¬)ã€‚æ§åˆ¶åè½¬è§£å†³äº†å…·æœ‰ä¾èµ–å…³ç³»çš„ç»„ä»¶ä¹‹é—´çš„å¼ºè€¦åˆï¼Œä½¿å¾—é¡¹ç›®å½¢æ€æ›´åŠ ç¨³å¥ã€‚</p><h1 class=pgc-h-arrow-right>5.1 é¡¹ç›®ä¸­å¼ºè€¦åˆé—®é¢˜</h1><pre><code>public class UserDAOImpl implements UserDAO{....}</code></pre><pre><code>public class UserServiceImpl implements UserService {    // é€šè¿‡ä¼ ç»Ÿçš„newæ–¹å¼å¼ºè€¦åˆäº†UserDAOImpl!!!,ä½¿å¾—UserServiceImplå˜å¾—ä¸ç¨³å¥!!    private UserDAO userDAO= new UserDAOImpl();    @Override    public User queryUser() {        return userDAO.queryUser();    }    ....}</code></pre><h1 class=pgc-h-arrow-right>5.2 è§£å†³æ–¹æ¡ˆ</h1><pre><code>// ä¸å¼•ç”¨ä»»ä½•ä¸€ä¸ªå…·ä½“çš„ç»„ä»¶(å®ç°ç±»)ï¼Œåœ¨éœ€è¦å…¶ä»–ç»„ä»¶çš„ä½ç½®é¢„ç•™å­˜å–å€¼å…¥å£(set/get)public class UserServiceImpl implements UserService {    // !!!ä¸å†è€¦åˆä»»ä½•DAOå®ç°!!!,æ¶ˆé™¤ä¸ç¨³å¥å› ç´ !!    private UserDAO userDAOï¼›    // ä¸ºuserDAOå®šä¹‰set/get,å…è®¸userDAOå±æ€§æ¥æ”¶springèµ‹å€¼    //Getters And Setters    @Override    public User queryUser() {        return userDAO.queryUser();    }    ....}</code></pre><p>åœ¨springé…ç½®æ–‡ä»¶ä¸­é…ç½®UserDAOå’ŒUserServiceå¯¹åº”çš„bean</p><pre><code>&lt;bean id="userDAO" class="com.qf.spring.part1.injection.UserDaoImpl"&gt;&lt;/bean&gt;&lt;!-- UserServiceImplç»„ä»¶ --&gt;&lt;bean id="userService" class="com.qf.spring.part1.injection.UserServiceImpl"&gt;    &lt;!-- ç”±springä¸ºuserDAOå±æ€§èµ‹å€¼ï¼Œå€¼ä¸ºid="userDAO"çš„bean --&gt;    &lt;property name="userDAO" ref="userDAO"/&gt;&lt;/bean&gt;</code></pre><h1 class=pgc-h-arrow-right>6 DIï¼ˆDependency Injectionï¼‰ä¾èµ–æ³¨å…¥</h1><h1 class=pgc-h-arrow-right>6.1 æ¦‚å¿µ</h1><p>åœ¨Springåˆ›å»ºå¯¹è±¡çš„åŒæ—¶ï¼Œä¸ºå…¶å±æ€§èµ‹å€¼ï¼Œç§°ä¹‹ä¸ºä¾èµ–æ³¨å…¥,æ³¨å…¥æ–¹å¼ä¸»è¦æœ‰ä»¥ä¸‹2ç§</p><ul><li>æ„é€ å‡½æ•°æ³¨å…¥</li><li>Setteræ–¹æ³•æ³¨å…¥</li></ul><h1 class=pgc-h-arrow-right>6.2 Setteræ–¹æ³•æ³¨å…¥</h1><p>åˆ›å»ºå¯¹è±¡æ—¶ï¼ŒSpringå·¥å‚ä¼šé€šè¿‡Setteræ–¹æ³•ä¸ºå¯¹è±¡çš„å±æ€§èµ‹å€¼ã€‚</p><h1 class=pgc-h-arrow-right>6.2.1 å®šä¹‰ç›®æ ‡Beanç±»å‹</h1><pre><code>public class User {    private Integer id;    private String password;    private String sex;    private Integer age;    private Date bornDate;    private String[] hobbys;    private Set&lt;String&gt; phones;    private List&lt;String&gt; names;    private Map&lt;String,String&gt; countries;    private Properties files;    //Getters And Setters}</code></pre><h1 class=pgc-h-arrow-right>6.2.2 åŸºæœ¬ç±»å‹ + å­—ç¬¦ä¸²ç±»å‹ + æ—¥æœŸç±»å‹</h1><pre><code>&lt;bean id="u1" class="com.qf.spring.part1.injection.User"&gt;    &lt;!--base field--&gt;    &lt;property name="id" value="1001" /&gt;    &lt;property name="password" value="123456" /&gt;    &lt;property name="sex" value="male" /&gt;    &lt;property name="age" value="20" /&gt;    &lt;property name="bornDate" value="1990/1/1" /&gt;&lt;!--æ³¨æ„æ ¼å¼"/"--&gt;&lt;/bean&gt;</code></pre><h1 class=pgc-h-arrow-right>6.2.3 å®¹å™¨ç±»å‹ï¼ˆlist,set,map,Propertiesï¼‰</h1><pre><code>&lt;bean id="u1" class="com.qf.spring.part1.injection.User"&gt;       &lt;!--Array--&gt;    &lt;property name="hobbys"&gt;        &lt;array&gt;            &lt;value&gt;Run&lt;/value&gt;            &lt;value&gt;Swim&lt;/value&gt;            &lt;value&gt;Climb&lt;/value&gt;        &lt;/array&gt;    &lt;/property&gt;    &lt;!--Set--&gt;    &lt;property name="phones"&gt;        &lt;set&gt;            &lt;value&gt;13777777777&lt;/value&gt;            &lt;value&gt;13888888888&lt;/value&gt;            &lt;value&gt;13999999999&lt;/value&gt;        &lt;/set&gt;    &lt;/property&gt;    &lt;!--List--&gt;    &lt;property name="names"&gt;        &lt;list&gt;            &lt;value&gt;tom&lt;/value&gt;            &lt;value&gt;jack&lt;/value&gt;            &lt;value&gt;marry&lt;/value&gt;        &lt;/list&gt;    &lt;/property&gt;    &lt;!--Map--&gt;    &lt;property name="countries"&gt;        &lt;map&gt;            &lt;entry key="CN" value="China" /&gt;            &lt;entry key="US" value="America" /&gt;            &lt;entry key="KR" value="Korea" /&gt;        &lt;/map&gt;    &lt;/property&gt;    &lt;!--Properties--&gt;    &lt;property name="files"&gt;        &lt;props&gt;            &lt;prop key="first"&gt;One&lt;/prop&gt;            &lt;prop key="second"&gt;Two&lt;/prop&gt;            &lt;prop key="third"&gt;Three&lt;/prop&gt;        &lt;/props&gt;    &lt;/property&gt;&lt;/bean&gt;</code></pre><h1 class=pgc-h-arrow-right>6.2.4 è‡ªå®šä¹‰ç±»å‹</h1><pre><code>&lt;!--æ¬¡è¦beanï¼Œè¢«ä½œä¸ºå±æ€§--&gt;&lt;bean id="addr" class="com.qf.spring.part1.injection.Address"&gt;    &lt;property name="position" value="åŒ—äº¬å¸‚æµ·æ·€åŒº" /&gt;    &lt;property name="zipCode" value="100001" /&gt;&lt;/bean&gt;&lt;!--ä¸»è¦beanï¼Œæ“ä½œçš„ä¸»ä½“--&gt;&lt;bean id="u2" class="com.qf.spring.part1.injection.User"&gt;    &lt;property name="address" ref="addr" /&gt;&lt;!--addresså±æ€§å¼•ç”¨addrå¯¹è±¡--&gt;&lt;/bean&gt;</code></pre><h1 class=pgc-h-arrow-right>6.3 æ„é€ æ³¨å…¥</h1><p>åˆ›å»ºå¯¹è±¡æ—¶ï¼ŒSpringå·¥å‚ä¼šé€šè¿‡æ„é€ æ–¹æ³•ä¸ºå¯¹è±¡çš„å±æ€§èµ‹å€¼ã€‚</p><h1 class=pgc-h-arrow-right>6.3.1 å®šä¹‰ç›®æ ‡Beanç±»å‹</h1><pre><code>public class Student {    private Integer id;    private String name;    private String sex;    private Integer age;    //Constructors    public Student(Integer id , String name , String sex , Integer age){        this.id = id;        this.name = name;        this.sex = sex;        this.age = age;    }}å¤åˆ¶ä»£ç </code></pre><h1 class=pgc-h-arrow-right>6.3.2 æ³¨å…¥</h1><pre><code> &lt;!--æ„é€ æ³¨å…¥--&gt;&lt;bean id="u3" class="com.qf.zcg.spring.day1.t2.ioc.Student"&gt;    &lt;constructor-arg name="id" value="1234" /&gt; &lt;!-- é™¤æ ‡ç­¾åç§°æœ‰å˜åŒ–ï¼Œå…¶ä»–å‡å’ŒSetæ³¨å…¥ä¸€è‡´ --&gt;    &lt;constructor-arg name="name" value="tom" /&gt;    &lt;constructor-arg name="age" value="20" /&gt;    &lt;constructor-arg name="sex" value="male" /&gt;&lt;/bean&gt;</code></pre><h1 class=pgc-h-arrow-right>7 Springå·¥å‚ç‰¹æ€§</h1><h1 class=pgc-h-arrow-right>7.1 é¥¿æ±‰å¼åˆ›å»ºä¼˜åŠ¿</h1><p>å·¥å‚åˆ›å»ºä¹‹åï¼Œä¼šå°†Springé…ç½®æ–‡ä»¶ä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½åˆ›å»ºå®Œæˆï¼ˆé¥¿æ±‰å¼ï¼‰ï¼Œæé«˜ç¨‹åºè¿è¡Œæ•ˆç‡ï¼Œé¿å…å¤šæ¬¡IOï¼Œå‡å°‘å¯¹è±¡åˆ›å»ºæ—¶é—´ã€‚ï¼ˆæ¦‚å¿µæ¥è¿‘è¿æ¥æ± ï¼Œä¸€æ¬¡æ€§åˆ›å»ºå¥½ï¼Œä½¿ç”¨æ—¶ç›´æ¥è·å–ï¼‰</p><h1 class=pgc-h-arrow-right>7.2 ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</h1><ul><li>è‡ªå®šä¹‰åˆå§‹åŒ–æ–¹æ³•ï¼šæ·»åŠ â€œinit-methodâ€å±æ€§ï¼ŒSpringåˆ™ä¼šåœ¨åˆ›å»ºå¯¹è±¡ä¹‹åï¼Œè°ƒç”¨æ­¤æ–¹æ³•ã€‚</li><li>è‡ªå®šä¹‰é”€æ¯æ–¹æ³•ï¼šæ·»åŠ â€œdestroy-methodâ€å±æ€§ï¼ŒSpringåˆ™ä¼šåœ¨é”€æ¯å¯¹è±¡ä¹‹å‰ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ã€‚</li><li>é”€æ¯ï¼šå·¥å‚çš„close()æ–¹æ³•è¢«è°ƒç”¨ä¹‹åï¼ŒSpringä¼šæ¯æ‰æ‰€æœ‰å·²åˆ›å»ºçš„å•ä¾‹å¯¹è±¡ã€‚</li><li>åˆ†ç±»ï¼šSingletonå¯¹è±¡ç”±Springå®¹å™¨é”€æ¯ã€Prototypeå¯¹è±¡ç”±JVMé”€æ¯ã€‚</li></ul><h1 class=pgc-h-arrow-right>7.3 ç”Ÿå‘½å‘¨æœŸæ³¨è§£</h1><pre><code>import javax.annotation.PostConstruct;import javax.annotation.PreDestroy;@PostConstruct //åˆå§‹åŒ– public void init(){    System.out.println("init method executed");}@PreDestroy //é”€æ¯public void destroy(){    System.out.println("destroy method executed");}</code></pre><h1 class=pgc-h-arrow-right>7.4 ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ</h1><p>å•ä¾‹beanï¼šsingleton</p><p>éšå·¥å‚å¯åŠ¨åˆ›å»º ==ã€‹ æ„é€ æ–¹æ³• ==ã€‹ setæ–¹æ³•(æ³¨å…¥å€¼) ==ã€‹ init(åˆå§‹åŒ–) ==ã€‹ æ„å»ºå®Œæˆ ==ã€‹éšå·¥å‚å…³é—­é”€æ¯</p><p>å¤šä¾‹beanï¼šprototype</p><p>è¢«ä½¿ç”¨æ—¶åˆ›å»º ==ã€‹ æ„é€ æ–¹æ³• ==ã€‹ setæ–¹æ³•(æ³¨å…¥å€¼) ==ã€‹ init(åˆå§‹åŒ–) ==ã€‹ æ„å»ºå®Œæˆ ==ã€‹JVMåƒåœ¾å›æ”¶é”€æ¯</p><h1 class=pgc-h-arrow-right>8 ä»£ç†è®¾è®¡æ¨¡å¼</h1><h1 class=pgc-h-arrow-right>8.1 æ¦‚å¿µ</h1><p>å°†æ ¸å¿ƒåŠŸèƒ½ä¸è¾…åŠ©åŠŸèƒ½ï¼ˆäº‹åŠ¡ã€æ—¥å¿—ã€æ€§èƒ½ç›‘æ§ä»£ç ï¼‰åˆ†ç¦»ï¼Œè¾¾åˆ°æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½æ›´çº¯ç²¹ã€è¾…åŠ©ä¸šåŠ¡åŠŸèƒ½å¯å¤ç”¨ã€‚</p><p><br></p><div class=pgc-img><img alt="é¢è¯•é˜¿é‡Œï¼Œç¾å›¢éƒ½ä¼šè¢«é—®åˆ°çš„Spring ,ä»åŸºç¡€åˆ°æºç ç»Ÿç»Ÿå¸®ä½ æå®š" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1c33a6fb3c684f86912ca073acada557><p class=pgc-img-caption></p></div><p><br></p><h1 class=pgc-h-arrow-right>8.2 é™æ€ä»£ç†è®¾è®¡æ¨¡å¼</h1><p>é€šè¿‡ä»£ç†ç±»çš„å¯¹è±¡ï¼Œä¸ºåŸå§‹ç±»çš„å¯¹è±¡ï¼ˆç›®æ ‡ç±»çš„å¯¹è±¡ï¼‰æ·»åŠ è¾…åŠ©åŠŸèƒ½ï¼Œæ›´å®¹æ˜“æ›´æ¢ä»£ç†å®ç°ç±»ã€åˆ©äºç»´æŠ¤ã€‚</p><ul><li>ä»£ç†ç±» = å®ç°åŸå§‹ç±»ç›¸åŒæ¥å£ + æ·»åŠ è¾…åŠ©åŠŸèƒ½ + è°ƒç”¨åŸå§‹ç±»çš„ä¸šåŠ¡æ–¹æ³•ã€‚</li><li>é™æ€ä»£ç†çš„é—®é¢˜ ä»£ç†ç±»æ•°é‡è¿‡å¤šï¼Œä¸åˆ©äºé¡¹ç›®çš„ç®¡ç†ã€‚ å¤šä¸ªä»£ç†ç±»çš„è¾…åŠ©åŠŸèƒ½ä»£ç å†—ä½™ï¼Œä¿®æ”¹æ—¶ï¼Œç»´æŠ¤æ€§å·®ã€‚</li></ul><h1 class=pgc-h-arrow-right>8.3 åŠ¨æ€ä»£ç†è®¾è®¡æ¨¡å¼</h1><h1 class=pgc-h-arrow-right>8.3.1 JDKåŠ¨æ€ä»£ç†å®ç°ï¼ˆåŸºäºæ¥å£ï¼‰</h1><pre><code>//ç›®æ ‡final OrderService os = new OrderServiceImpl();//é¢å¤–åŠŸèƒ½InvocationHandler handler = new InvocationHandler(){//1.è®¾ç½®å›è°ƒå‡½æ•°ï¼ˆé¢å¤–åŠŸèƒ½ä»£ç ï¼‰    @Override    public Object invoke(Object proxy, Method method, Object[] args)        throws Throwable {        System.out.println("start...");        method.invoke(os, args);         System.out.println("end...");        return null;    }};//2.åˆ›å»ºåŠ¨æ€ä»£ç†ç±»Object proxyObj = Proxy.newProxyInstance(ClassLoader , Interfaces , InvocationHandler);</code></pre><h1 class=pgc-h-arrow-right>8.3.2 CGlibåŠ¨æ€ä»£ç†å®ç°ï¼ˆåŸºäºç»§æ‰¿ï¼‰</h1><pre><code>final OrderService os = new OrderServiceImpl();Enhancer cnh = new Enhancer();//1.åˆ›å»ºå­—èŠ‚ç æ›¾å¼ºå¯¹è±¡enh.setSuperclass(os.getClass());//2.è®¾ç½®çˆ¶ç±»ï¼ˆç­‰ä»·äºå®ç°åŸå§‹ç±»æ¥å£ï¼‰enh.setCallback(new InvocationHandler(){//3.è®¾ç½®å›è°ƒå‡½æ•°ï¼ˆé¢å¤–åŠŸèƒ½ä»£ç ï¼‰    @Override    public Object invoke(Object proxy , Method method, Object[] args) throws Throwable{        System.out.println("start...");        Object ret = method.invoke(os,args);        System.out.println("end...");        return ret;    }});OrderService proxy = (OrderService)enh.create();//4.åˆ›å»ºåŠ¨æ€ä»£ç†ç±»proxy,createOrder();</code></pre><h1 class=pgc-h-arrow-right>9 é¢å‘åˆ‡é¢ç¼–ç¨‹</h1><h1 class=pgc-h-arrow-right>9.1 æ¦‚å¿µ</h1><p>AOPï¼ˆAspect Oriented Programmingï¼‰ï¼Œå³é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œåˆ©ç”¨ä¸€ç§ç§°ä¸º"æ¨ªåˆ‡"çš„æŠ€æœ¯ï¼Œå‰–å¼€å°è£…çš„å¯¹è±¡å†…éƒ¨ï¼Œå¹¶å°†é‚£äº›å½±å“äº†å¤šä¸ªç±»çš„å…¬å…±è¡Œä¸ºå°è£…åˆ°ä¸€ä¸ªå¯é‡ç”¨æ¨¡å—ï¼Œå¹¶å°†å…¶å‘½åä¸º"Aspect"ï¼Œå³åˆ‡é¢ã€‚æ‰€è°“"åˆ‡é¢"ï¼Œç®€å•è¯´å°±æ˜¯é‚£äº›ä¸ä¸šåŠ¡æ— å…³ï¼Œå´ä¸ºä¸šåŠ¡æ¨¡å—æ‰€å…±åŒè°ƒç”¨çš„é€»è¾‘æˆ–è´£ä»»å°è£…èµ·æ¥ï¼Œä¾¿äºå‡å°‘ç³»ç»Ÿçš„é‡å¤ä»£ç ï¼Œé™ä½æ¨¡å—ä¹‹é—´çš„è€¦åˆåº¦ï¼Œå¹¶æœ‰åˆ©äºæœªæ¥çš„å¯æ“ä½œæ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><p>é€šä¿—çš„æ¦‚å¿µæ¥è®²ï¼Œæ‰€è°“çš„é¢å‘åˆ‡é¢ç¼–ç¨‹å°±æ˜¯é’ˆå¯¹è¢«ä»£ç†å¯¹è±¡çš„æ–¹æ³•åœ¨æŸä¸ªç‰¹å®šçš„æ‰§è¡Œæ—¶æœº(æ–¹æ³•è°ƒç”¨ä¹‹å‰ã€æ–¹æ³•è°ƒç”¨ä¹‹åã€æ–¹æ³•æŠ›å‡ºå¼‚å¸¸)ï¼Œåšå‡ºä¸€äº›é¢å¤–çš„æ¨ªå‘çš„å¤„ç†ã€‚å¥½å¤„åœ¨äºï¼š1. å¯ä»¥åœ¨ä¸ä¿®æ”¹åŸæœ‰ä»£ç åŸºç¡€ä¸Šæ¨ªå‘æ‰©å±•æˆ‘ä»¬çš„å†…å®¹ï¼›2. å°†ä¸€äº›æ–¹æ³•ä¸­çš„é€šç”¨é€»è¾‘è¿›è¡Œç»Ÿä¸€åŒ–çš„å¤„ç†ã€‚</p><p>OOP(é¢å‘å¯¹è±¡ç¼–ç¨‹)å’ŒAOP(é¢å‘åˆ‡é¢ç¼–ç¨‹)çš„åŒºåˆ«ï¼šoopæ˜¯å¯¹ç±»çºµå‘çš„æ‰©å±•ï¼›aopæ˜¯æ¨ªå‘çš„æ‰©å±•ã€‚</p><h1 class=pgc-h-arrow-right>9.2 AOPå¼€å‘æœ¯è¯­</h1><ul><li>è¿æ¥ç‚¹(Joinpoint)ï¼šè¿æ¥ç‚¹æ˜¯ç¨‹åºç±»ä¸­å®¢è§‚å­˜åœ¨çš„æ–¹æ³•ï¼Œå¯è¢«Springæ‹¦æˆªå¹¶åˆ‡å…¥å†…å®¹ã€‚</li><li>åˆ‡å…¥ç‚¹(Pointcut)ï¼šè¢«åˆ‡å…¥è¿æ¥ç‚¹ã€‚</li><li>é€šçŸ¥ã€å¢å¼º(Advice)ï¼šå¯ä»¥ä¸ºåˆ‡å…¥ç‚¹æ·»åŠ é¢å¤–åŠŸèƒ½ï¼Œåˆ†ä¸ºï¼šå‰ç½®é€šçŸ¥ã€åç½®é€šçŸ¥ã€å¼‚å¸¸é€šçŸ¥ã€ç¯ç»•é€šçŸ¥ç­‰ã€‚</li><li>ç›®æ ‡å¯¹è±¡(Target)ï¼šä»£ç†çš„ç›®æ ‡å¯¹è±¡</li><li>ç»‡å…¥(Weaving)ï¼šæŠŠé€šçŸ¥åº”ç”¨åˆ°å…·ä½“çš„ç±»ï¼Œè¿›è€Œåˆ›å»ºæ–°çš„ä»£ç†ç±»çš„è¿‡ç¨‹ã€‚</li><li>ä»£ç†(Proxy)ï¼šè¢«AOPç»‡å…¥é€šçŸ¥åï¼Œäº§ç”Ÿçš„ç»“æœç±»ã€‚</li><li>åˆ‡é¢(Aspect)ï¼šç”±åˆ‡ç‚¹å’Œé€šçŸ¥ç»„æˆï¼Œå°†æ¨ªåˆ‡é€»è¾‘ç»‡å…¥åˆ‡é¢æ‰€æŒ‡å®šçš„è¿æ¥ç‚¹ä¸­ã€‚</li></ul><h1 class=pgc-h-arrow-right>9.3 ä½œç”¨</h1><p>Springçš„AOPç¼–ç¨‹å³æ˜¯é€šè¿‡åŠ¨æ€ä»£ç†ç±»ä¸ºåŸå§‹ç±»çš„æ–¹æ³•æ·»åŠ è¾…åŠ©åŠŸèƒ½ã€‚</p><h1 class=pgc-h-arrow-right>9.4 ç¯å¢ƒæ­å»º</h1><p>å¼•å…¥AOPç›¸å…³ä¾èµ–</p><pre><code>&lt;dependency&gt;    &lt;groupId&gt;org.springframework&lt;/groupId&gt;    &lt;artifactId&gt;spring-aspects&lt;/artifactId&gt;    &lt;version&gt;5.1.6.RELEASE&lt;/version&gt;&lt;/dependency&gt;</code></pre><p>spring-context.xmlå¼•å…¥AOPå‘½åç©ºé—´</p><pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans"       xmlns:context="http://www.springframework.org/schema/context"       xmlns:aop="http://www.springframework.org/schema/aop"       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"       xsi:schemaLocation="       http://www.springframework.org/schema/beans       http://www.springframework.org/schema/beans/spring-beans.xsd       http://www.springframework.org/schema/aop       http://www.springframework.org/schema/aop/spring-aop.xsd       "&gt;&lt;/beans&gt;</code></pre><h1 class=pgc-h-arrow-right>9.5 å¼€å‘æµç¨‹</h1><p>å®šä¹‰åŸå§‹ç±»</p><pre><code>package com.qf.aaron.aop.basic;public interface UserService {    public void save();}å¤åˆ¶ä»£ç </code></pre><pre><code>package com.qf.aaron.aop.basic;public class UserServiceImpl implements UserService {    public void save() {        System.out.println("save method executed...");    }}</code></pre><p>å®šä¹‰é€šçŸ¥ç±»ï¼ˆæ·»åŠ é¢å¤–åŠŸèƒ½</p><pre><code>package com.qf.aaron.aop.basic;import org.springframework.aop.MethodBeforeAdvice;import java.lang.reflect.Method;public class MyAdvice implements MethodBeforeAdvice { //å®ç°å‰ç½®é€šçŸ¥æ¥å£    public void before(Method method, Object[] args, Object target) throws Throwable {        System.out.println("before advice executed...");    }}</code></pre><p>å®šä¹‰beanæ ‡ç­¾</p><pre><code>&lt;!--åŸå§‹å¯¹è±¡--&gt;&lt;bean id="us" class="com.qf.aaron.aop.basic.UserServiceImpl" /&gt;&lt;!--è¾…åŠ©å¯¹è±¡--&gt;&lt;bean id="myAdvice" class="com.qf.aaron.aop.basic.MyAdvice" /&gt;</code></pre><p>å®šä¹‰åˆ‡å…¥ç‚¹ï¼ˆPointCutï¼‰</p><p>å½¢æˆåˆ‡é¢ï¼ˆAspectï¼‰</p><pre><code>&lt;aop:config&gt;    &lt;!--åˆ‡ç‚¹--&gt;    &lt;aop:pointcut id="myPointCut" expression="execution(* save())" /&gt;&lt;/aop:config&gt;```java&lt;aop:config&gt;    &lt;!--ç»„è£…åˆ‡é¢ --&gt;    &lt;aop:advisor advice-ref="myAdvice" pointcut-ref="myPointCut" /&gt;&lt;/aop:config&gt;</code></pre><h1 class=pgc-h-arrow-right>9.6 é€šçŸ¥ç±»</h1><p>å¯å®šä¹‰çš„é€šçŸ¥ç±»æœ‰6ç§ï¼Œå¯ä»¥æŒ‰éœ€æ±‚é€‰æ‹©é€šçŸ¥ç±»ã€‚</p><pre><code>å‰ç½®é€šçŸ¥ï¼šMethodBeforeAdviceåç½®é€šçŸ¥ï¼šAfterAdviceåç½®é€šçŸ¥ï¼šAfterReturningAdvice //æœ‰å¼‚å¸¸ä¸æ‰§è¡Œï¼Œæ–¹æ³•ä¼šå› å¼‚å¸¸è€Œç»“æŸï¼Œæ— è¿”å›å€¼å¼‚å¸¸é€šçŸ¥ï¼šThrowsAdviceç¯ç»•é€šçŸ¥ï¼šMethodInterceptor</code></pre><h1 class=pgc-h-arrow-right>9.7 JDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†çš„é€‰æ‹©</h1><ul><li>springåº•å±‚ï¼ŒåŒ…å«äº†jdkä»£ç†å’Œcglibä»£ç†ä¸¤ç§åŠ¨æ€ä»£ç†ç”Ÿæˆæœºåˆ¶</li><li>åŸºæœ¬è§„åˆ™æ˜¯ï¼šç›®æ ‡ä¸šåŠ¡ç±»å¦‚æœæœ‰æ¥å£åˆ™ç”¨JDKä»£ç†ï¼Œæ²¡æœ‰æ¥å£åˆ™ç”¨CGLibä»£ç†</li></ul><p>ä½†æ˜¯springä¸­é»˜è®¤å¼€å¯JDKåŠ¨æ€ä»£ç†ï¼Œå½“éœ€è¦ä½¿ç”¨CGLIBåŠ¨æ€ä»£ç†æ—¶ï¼Œéœ€è¦åœ¨springé…ç½®æ–‡ä»¶ä¸­é…ç½®ã€‚</p><pre><code>&lt;!--  ä½¿ç”¨cglibçš„æ–¹å¼å®ç°aop --&gt;    &lt;aop:aspectj-autoproxy proxy-target-class="true"/&gt;</code></pre><h1 class=pgc-h-arrow-right>10 åŸºäºaspectJçš„AOPå®ç°</h1><p>ç¼–å†™aspectJé€šçŸ¥ä»£ç :</p><pre><code>@Aspectpublic class AspectJAdvisor {    // ç¯ç»•é€šçŸ¥    @Around("execution(* org.example.service.impl.*.*(..))")    public Object timer(ProceedingJoinPoint pjp) throws Throwable{        System.out.println("å‰ç½®é€šçŸ¥");        Object o = pjp.proceed();        System.out.println("ã€åç½®é€šçŸ¥ã€‘");        return o;    }    // åç½®é€šçŸ¥    @After("execution(* org.example.service.impl.*.*(..))")    public void after(JoinPoint jp) throws Throwable{        System.out.println("====After method invokded====");    }    // å‰ç½®é€šçŸ¥    @Before("execution(* org.example.service.impl.*.*(..))")    public void before(JoinPoint jp){        System.out.println("====before method invoked====");    }    // æ­£å¸¸è¿”å›çš„é€šçŸ¥    @AfterReturning("execution(* org.example.service.impl.*.*(..))")    public void afterReturning(JoinPoint jp){        System.out.println("====after value return====");    }    // æŠ›å‡ºå¼‚å¸¸åçš„é€šçŸ¥ï¼Œæ–¹æ³•çš„å¼‚å¸¸å¿…é¡»ä¸ä»£ç†ç±»æŠ›å‡ºçš„å¼‚å¸¸ä¸€è‡´ï¼Œthrowingçš„å€¼è¦ä¸å¼‚å¸¸çš„å½¢å‚åä¿æŒä¸€è‡´    @AfterThrowing(value = "execution(* org.example.service.impl.*.*(..))", throwing="npe")    public void afterThrowException(JoinPoint jp, NullPointerException npe){        System.out.println("====after exception throwing====");    }}</code></pre><p>é…ç½®</p><pre><code>&lt;bean id="userService" class="org.example.service.impl.UserServiceImpl"&gt;&lt;/bean&gt;&lt;bean id="throwsAdvisor" class="org.example.advisor.AspectJAdvisor"&gt;&lt;/bean&gt;&lt;!--- aspectJæ˜¯ä½¿ç”¨cglibæ¥å®ç°åŠ¨æ€ä»£ç†çš„ --&gt;&lt;aop:aspectj-autoproxy proxy-target-class="true"&gt;&lt;/aop:aspectj-autoproxy&gt;</code></pre><h1 class=pgc-h-arrow-right>11 åŸºäºæ³¨è§£å¼€å‘</h1><h1 class=pgc-h-arrow-right>11.1 å£°æ˜bean</h1><p>ç”¨äºæ›¿æ¢è‡ªå»ºç±»å‹ç»„ä»¶çš„ &lt;beanâ€¦>æ ‡ç­¾ï¼›å¯ä»¥æ›´å¿«é€Ÿçš„å£°æ˜bean</p><ul><li>@Service ä¸šåŠ¡ç±»ä¸“ç”¨ @Repository daoå®ç°ç±»ä¸“ç”¨ @Controller webå±‚ä¸“ç”¨</li><li>@Component é€šç”¨</li><li>@Scope ç”¨æˆ·æ§åˆ¶beançš„åˆ›å»ºæ¨¡å¼</li></ul><pre><code>// @Serviceè¯´æ˜ æ­¤ç±»æ˜¯ä¸€ä¸ªä¸šåŠ¡ç±»ï¼Œéœ€è¦å°†æ­¤ç±»çº³å…¥å·¥å‚  ç­‰ä»·æ›¿æ¢æ‰ &lt;bean class="xxx.UserServiceImpl"&gt;// @Serviceé»˜è®¤beanId == é¦–å­—æ¯å°å†™çš„ç±»å"userServiceImpl"// @Service("userService") è‡ªå®šä¹‰beanIdä¸º"userService"@Service //å£°æ˜beanï¼Œä¸”id="userServiceImpl"@Scope("singleton") //å£°æ˜åˆ›å»ºæ¨¡å¼ï¼Œé»˜è®¤ä¸ºå•ä¾‹æ¨¡å¼ ï¼›@Scope("prototype")å³å¯è®¾ç½®ä¸ºå¤šä¾‹æ¨¡å¼public class UserServiceImpl implements UserService {    ...   }</code></pre><h1 class=pgc-h-arrow-right>11.2 æ³¨å…¥(DI)</h1><p>ç”¨äºå®Œæˆbeanä¸­å±æ€§å€¼çš„æ³¨å…¥</p><ul><li>@Autowired åŸºäºç±»å‹è‡ªåŠ¨æ³¨å…¥</li><li>@Resource åŸºäºåç§°è‡ªåŠ¨æ³¨å…¥</li><li>@Qualifier(â€œuserDAOâ€) é™å®šè¦è‡ªåŠ¨æ³¨å…¥çš„beançš„idï¼Œä¸€èˆ¬å’Œ@Autowiredè”ç”¨</li><li>@Value æ³¨å…¥ç®€å•ç±»å‹æ•°æ® (jdk8ç§+String)</li></ul><pre><code>@Servicepublic class UserServiceImpl implements UserService {    @Autowired //æ³¨å…¥ç±»å‹ä¸ºUserDAOçš„bean    @Qualifier("userDAO2") //å¦‚æœæœ‰å¤šä¸ªç±»å‹ä¸ºUserDAOçš„beanï¼Œå¯ä»¥ç”¨æ­¤æ³¨è§£ä»ä¸­æŒ‘é€‰ä¸€ä¸ª    private UserDAO userDAO;}</code></pre><pre><code>@Servicepublic class UserServiceImpl implements UserService {    @Resource("userDAO3") //æ³¨å…¥id=â€œuserDAO3â€çš„bean    private UserDAO userDAO;    /*    @Resource //æ³¨å…¥id=â€œuserDAOâ€çš„bean    private UserDAO userDAO;    */}</code></pre><pre><code>public class XX{    @Value("100") //æ³¨å…¥æ•°å­—    private Integer id;    @Value("shine") //æ³¨å…¥String    private String name;}</code></pre><h1 class=pgc-h-arrow-right>11.3 äº‹åŠ¡æ§åˆ¶</h1><p>ç”¨äºæ§åˆ¶äº‹åŠ¡åˆ‡å…¥</p><ul><li>@Transactional</li><li>å·¥å‚é…ç½®ä¸­çš„ &lt;tx:adviceâ€¦ å’Œ &lt;aop:configâ€¦ å¯ä»¥çœç•¥ !!</li></ul><pre><code>//ç±»ä¸­çš„æ¯ä¸ªæ–¹æ³•éƒ½åˆ‡å…¥äº‹åŠ¡(æœ‰è‡ªå·±çš„äº‹åŠ¡æ§åˆ¶çš„æ–¹æ³•é™¤å¤–)@Transactional(isolation=Isolation.READ_COMMITTED,propagation=Propagation.REQUIRED,readOnly=false,rollbackFor=Exception.class,timeout = -1)public class UserServiceImpl implements UserService {    ...    //è¯¥æ–¹æ³•è‡ªå·±çš„äº‹åŠ¡æ§åˆ¶ï¼Œä»…å¯¹æ­¤æ–¹æ³•æœ‰æ•ˆ    @Transactional(propagation=Propagation.SUPPORTS)    public List&lt;User&gt; queryAll() {        return userDao.queryAll();    }    public void save(User user){        userDao.save(user);    }}</code></pre><h1 class=pgc-h-arrow-right>11.4 æ³¨è§£æ‰€éœ€é…ç½®</h1><pre><code>&lt;!-- å‘ŠçŸ¥springï¼Œå“ªäº›åŒ…ä¸­ æœ‰è¢«æ³¨è§£çš„ç±»ã€æ–¹æ³•ã€å±æ€§ --&gt;&lt;!-- &lt;context:component-scan base-package="com.qf.a,com.xx.b"&gt;&lt;/context:component-scan&gt; --&gt;&lt;context:component-scan base-package="com.qf"&gt;&lt;/context:component-scan&gt;&lt;!-- å‘ŠçŸ¥springï¼Œ@Transactionalåœ¨å®šåˆ¶äº‹åŠ¡æ—¶ï¼ŒåŸºäºtxManager=DataSourceTransactionManager --&gt;&lt;tx:annotation-driven transaction-manager="txManager"/&gt;</code></pre><h1 class=pgc-h-arrow-right>11.5 AOPå¼€å‘</h1><h1 class=pgc-h-arrow-right>11.5.1 æ³¨è§£ä½¿ç”¨</h1><pre><code>import org.aspectj.lang.JoinPoint;import org.aspectj.lang.ProceedingJoinPoint;import org.aspectj.lang.annotation.AfterThrowing;import org.aspectj.lang.annotation.Aspect;import org.aspectj.lang.annotation.Pointcut;import org.springframework.stereotype.Component;@Aspect // å£°æ˜æ­¤ç±»æ˜¯ä¸€ä¸ªåˆ‡é¢ç±»ï¼šä¼šåŒ…å«åˆ‡å…¥ç‚¹(pointcut)å’Œé€šçŸ¥(advice)@Component //å£°æ˜ç»„ä»¶ï¼Œè¿›å…¥å·¥å‚public class MyAspect {    // å®šä¹‰åˆ‡å…¥ç‚¹    @Pointcut("execution(* com.qf.spring.service.UserServiceImpl.*(..))")    public void pc(){}    @Before("pc()") // å‰ç½®é€šçŸ¥    public void mybefore(JoinPoint a) {        System.out.println("target:"+a.getTarget());        System.out.println("args:"+a.getArgs());        System.out.println("method's name:"+a.getSignature().getName());        System.out.println("before~~~~");    }    @AfterReturning(value="pc()",returning="ret") // åç½®é€šçŸ¥    public void myAfterReturning(JoinPoint a,Object ret){        System.out.println("after~~~~:"+ret);    }    @Around("pc()") // ç¯ç»•é€šçŸ¥    public Object myInterceptor(ProceedingJoinPoint p) throws Throwable {        System.out.println("interceptor1~~~~");        Object ret = p.proceed();        System.out.println("interceptor2~~~~");        return ret;    }    @AfterThrowing(value="pc()",throwing="ex") // å¼‚å¸¸é€šçŸ¥    public void myThrows(JoinPoint jp,Exception ex){        System.out.println("throws");        System.out.println("===="+ex.getMessage());    }}</code></pre><h1 class=pgc-h-arrow-right>11.5.2 é…ç½®</h1><pre><code>&lt;!-- æ·»åŠ å¦‚ä¸‹é…ç½®,å¯ç”¨aopæ³¨è§£ --&gt;&lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;</code></pre><h1 class=pgc-h-arrow-right>12 Springå•å…ƒæµ‹è¯•</h1><h1 class=pgc-h-arrow-right>12.1 å¯¼å…¥ä¾èµ–</h1><pre><code>&lt;dependency&gt;    &lt;groupId&gt;org.springframework&lt;/groupId&gt;    &lt;artifactId&gt;spring-test&lt;/artifactId&gt;    &lt;version&gt;4.3.6.RELEASE&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt;    &lt;groupId&gt;junit&lt;/groupId&gt;    &lt;artifactId&gt;junit&lt;/artifactId&gt;    &lt;version&gt;4.12&lt;/version&gt;&lt;/dependency&gt;</code></pre><h1 class=pgc-h-arrow-right>12.2 æµ‹è¯•ç¼–ç </h1><p>å¯ä»¥å…å»å·¥å‚çš„åˆ›å»ºè¿‡ç¨‹ï¼›</p><p>å¯ä»¥ç›´æ¥å°†è¦æµ‹è¯•çš„ç»„ä»¶æ³¨å…¥åˆ°æµ‹è¯•ç±»ã€‚</p><pre><code>@RunWith(SpringJUnit4ClassRunner.class) //ç”±SpringJUnit4ClassRunnerå¯åŠ¨æµ‹è¯•@ContextConfiguration("classpath:applicationContext.xml") //springçš„é…ç½®æ–‡ä»¶ä½ç½®public class SpringTest{//å½“å‰æµ‹è¯•ç±»ä¹Ÿä¼šè¢«çº³å…¥å·¥å‚ä¸­ï¼Œæ‰€ä»¥å…¶ä¸­å±æ€§å¯ä»¥æ³¨å…¥    @Autowired // æ³¨å…¥è¦æµ‹è¯•çš„ç»„ä»¶    @Qualifier("userDAO")    private UserDAO userDAO;    @Test    public void test(){        // æµ‹è¯•ä½¿ç”¨userDAO        userDAO.queryUser();        ....    }}æœ€å</code></pre><h1 class=pgc-h-arrow-right>å†…å®¹å°±å…ˆå†™åˆ°è¿™é‡Œã€‚</h1><h1 class=pgc-h-arrow-right>æœ€åè§‰å¾—æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯è®°å¾—ç»™æˆ‘ç‚¹ä¸ªèµã€‚</h1><h1 class=pgc-h-arrow-right>æ¬¢è¿å¤§å®¶<strong>å…³æ³¨</strong>å’Œ<strong>è½¬å‘</strong>æ–‡ç« ï¼</h1></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'é¢è¯•','ç¾å›¢','é—®åˆ°'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>