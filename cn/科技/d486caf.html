<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>西门子PLC 对步进电机的控制方法 调用系统功能块SFB49 | 极客快訊</title><meta property="og:title" content="西门子PLC 对步进电机的控制方法 调用系统功能块SFB49 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/bf9d9403f5ef4fe6b241a28110ddac28"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d486caf.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d486caf.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d486caf.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d486caf.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d486caf.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d486caf.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d486caf.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d486caf.html><meta property="article:published_time" content="2020-10-29T21:00:31+08:00"><meta property="article:modified_time" content="2020-10-29T21:00:31+08:00"><meta name=Keywords content><meta name=description content="西门子PLC 对步进电机的控制方法 调用系统功能块SFB49"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/d486caf.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>西门子PLC 对步进电机的控制方法 调用系统功能块SFB49</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><h1><strong>西门子PLC 对步进电机的控制方法 调用系统功能块SFB49</strong></h1><p>1. 选中项目下最后一级子菜单Blocks，并双击Blocks中的OB1进入程序编辑器，在OB1中，调用SFB49。过程如下：在指令集工具中，找到library（库） ->standardlibrary（标准库） ->system FunctionBlocks（系统功能块）菜单，并双击该菜单下的系统功能块SFB49进行调用。</p><p>如图所示</p><div class=pgc-img><img alt="西门子PLC 对步进电机的控制方法 调用系统功能块SFB49" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/bf9d9403f5ef4fe6b241a28110ddac28></div><p>在使用系统功能块时，必须指定其背景数据块。如上图，在红色问号处，指定SFB49的背景数据块（例如： DB1、DB2）。如背景数据还未建立，填写数据块后（如填DB10），则程序编辑器将自动建立DB10为SB49的背景数据块。</p><p>2.分配系统功能块SFB49的参数。</p><p>系统功能块SB49的参数很多，在使用时，用户可根据自己的控制需要进行选择性填写。其各个参数意义如下表所示。</p><div class=pgc-img><img alt="西门子PLC 对步进电机的控制方法 调用系统功能块SFB49" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1cb4a919a4104f5ba611353babec6c67></div><div class=pgc-img><img alt="西门子PLC 对步进电机的控制方法 调用系统功能块SFB49" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/59209285cb02487e88454cb3bb925b9e></div><div class=pgc-img><img alt="西门子PLC 对步进电机的控制方法 调用系统功能块SFB49" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/6562dffab44a417f809d7abbd97bf8b6></div><p>在SFB49的所有输入参数中主要有两部分，一部分是用来控制脉冲输出或作为数字量输出的控制变量；另外一部分则是用来修改脉冲参数：例如脉冲周期，延时时间，最小脉宽等。</p><p>参数LADDR：子模块的地址，数据类型为字。可在硬件组态时进行地址配置。其默认值为W#16#300，即输入输出映像区第768个字节。若通道集成在CPU模块中，则此参数可以不用设置，若通道在某个子功能模块上，则必须保证此参数的地址与模块设置的地址一致。</p><p>参数CHANNEL：通道号，数据类型为整数。此参数指定启用的通道号， CPU313C具有3个通道的高频脉冲输出，通道号分别为0、1、 2。如启动2号通道，则参数值为： 2。若通道号大于2，则在执行功能块时，将发出出错信息。</p><p>参数SW_EN：为软件控制门，数据类型为BOOL。 SFB49是通过门功能（ GateFunction）控制高频脉冲的起动输出的。门功能中包括硬件门（ hardware gate）和软件门（ software gate）两种：可根据需要设置为单独使用软件门控制或同时使用硬件门和软件门控制。门功能工作过程如下</p><p>图所示</p><div class=pgc-img><img alt="西门子PLC 对步进电机的控制方法 调用系统功能块SFB49" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/f8b17769faa14011b388bf35aa4c59ea></div><p>单独使用软件门控制时，在硬件设置时，不能启用硬件门（ hardware gate）控制。此时，高频脉冲输出单独由软件门SW_EN端控制，即SW_EN端为“1”时，脉冲输出指令开始执行（延时指定时间后输出指定周期和脉宽的高频脉冲），当SW_EN端为“0”时，高频脉冲停止输出。</p><p>采用硬件门和软件门同时控制时，需要在硬件设置中，启用硬件门控制。当软件门的状态先为“1”，同时在硬件门有一个上升沿时，将启动内部门功能，并输出高频脉冲（延时指定时间输出高频脉冲）。当硬件门的状态先为“1”，而软件门的状态后变为“1”，则门功能不启动，若软件的状态保持“1”，同时在硬件门有一个下降沿发生，也能启动门功能，输出高频脉冲。当软件门的状态变为“0”，无论硬件门的状态如何，将停止脉冲输出。</p><p>参数MAN_DO：手动输出使能端。一旦通道在硬件组态时设置为脉宽调制功能，则该通道不能使用普通的输出线圈指令对其进行写操作控制，要想控制该通道必须调用功能块SFB49对其进行控制。如果还想在该通道得到持续的高电平（非脉冲信号），则可以通过MAN_DO控制端实现。当MAN_DO端为“1”时，指定通道不能输出高频脉冲，只能作为数字量输出点使用。当MAN_DO端为“0”时，则指定通道只能作为高频脉冲输出通道使用输出指定频率的脉冲信号。</p><p>参数SET_DO：数字量输出控制端。当MAN_DO端的状态为“1”时，可通过SET_DO 端控制指定通道的状态是为高电平“1”，还是低电平“0”。如果MAN_DO端的状态为“0”，则SET_DO端的状态不起作用，不会影响通道的状态。</p><p>参数OUTP_VAL：输出值设置。输出值参数数据类型为整数。在硬件设置中我们只指定了脉冲的周期，延时时间以及最小脉宽等，并没有指定脉冲的占空比。参数OUTP_VAL就是用来指定脉冲占空比的。注意：在硬件设置时，如果选择输出形式（ Output-format）为： Per mil，则OUTP_VAL取值范围为0~1000（基数为1000），输出脉冲高电平时间长度为：</p><p>Pulse width（脉宽） =（ OUTP_VAL/1000）*period（周期）</p><p>例如：若OUTP_VAL值设置为200，则一个周期中， 200/1000的时间为高电平， 800/1000的时间为低电平：即占空比为1： 4。</p><p>如果硬件设置时，选择输出形式（ output-format）为S7模拟量值（ S7 analog value），则OUTP_VAL取值范围为0~27648（基数为27648），此时输出脉冲的脉宽为：</p><p>Pulse width（脉宽） =（ OUTP_VAL/27648） *period（周期）</p><p>此时如果OUTP_VAL值设置为200，则一个周期中200/27648的时间为高电平， 27448/27648的时间为低电平。</p><p>注意在设置占空比时，应该保证计算出的高低电平的时间都不能小于硬件设置中指定的最小脉宽值（ Minimum pulse width），否则将不能输出脉冲信号。</p><p>以上参数为控制脉冲的操作信号。如果想要修改硬件设置时，如脉冲周期，延时时间等参数，则要通过下面的参数来完成。</p><p>参数JOB_REQ：为作业操作信号，通过作业操作可以修改硬件设置时指定的某些参数如延时时间，周期，最小脉宽等的。作业初始化控制端是上升沿有效，当JOB_REQ端的状态由“0”变为“1”时将进行作业操作功能，具体事件由作业ID和作业值决定。</p><p>参数JOB_ID：为作业号，作业号决定了具体的作业事件，例如，如果想修改脉冲周期则可指定JOB_ID号为W#16#1，如果想修改延时时间则可指定JOB_ID的参数为W#16#2。如果想读取周期，则指定JOB_ID号为W#16#81。在系统功能SFB49的背景数据块中，有一个静态变量：JOB_OVAL，如图所示，变量类型为双整数，SFB49进行读作业操作时，将把读取的值放在这一区域，用户可访问这一区域得到高频脉冲相关参数的值。</p><div class=pgc-img><img alt="西门子PLC 对步进电机的控制方法 调用系统功能块SFB49" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c1c7fa1184f845c19890e2016187b13a></div><p>参数JOB_VAL：为写作业的值，参数类型为双整数，指定的值乘以硬件组态时指定的时基为定义的时间值。当JOB_REQ有上升沿发生时， JOB_VAL端定义的值将代替脉冲原有的参数。</p><p>系统功能块SFB49（符号名为PLUSE）输出参数意义如下表所示</p><div class=pgc-img><img alt="西门子PLC 对步进电机的控制方法 调用系统功能块SFB49" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/be00e2d468c04e468cc4c3c396a9fe60></div><p>参数STS_EN：状态使能端。其状态显示高频脉冲输出的条件是否成立，当STS_EN端的状态为“1”时，表示高频脉冲输出条件成立，通道处于延时或输出状态。</p><p>参数STS_STRT：硬件门状态。无论是否启动硬件门功能，参数STS_STRT的状态与通道对应的硬件门的状态一致。</p><p>参数STS_DO：为通道的输出状态，当通道作为数字量输出或高频脉冲输出时，STS_DO端的状态与通道输出的状态一致。</p><p>参数JOB_DONE：为可以启动新作业的端，正常情况下JOB_DONE端的状态为“1”，表示可以启动新作业；当JOB_REQ端有上升沿时，将执行指定作业修改对应参数，这时JOB_DONE的状态将变为“0”，当作业执行完毕，参数修改好以后，JOB_DONE的状态将自动恢复为“1”状态。注意，一般作业执行的时间很短，因此JOB_DONE为“0”的状态时间也很短。在做实验时用肉眼很难观察到JOB_DONE端的状态变化，可以在程序中用JOB_DONE输出的信号控制一个加法计数器，可以看到，作业每启动一次，计数器的值都会加1，证明在执行作业时， JOB_DONE端的状态的确发生过变化。</p><p>参数JOB_ERR：为故障作业，当JOB_ERR的状态为“0”时，表示作业执行正常，当JOB_ERR的状态为“1”时，表示有故障发生，具体故障原因可查看故障代码（由JOB_STAT端读取）</p><p>参数JOB_STAT：为作业错误代码。如果发生作业错误，则JOB_ERR = TRUE。JOB_STAT中将给出精确的错误原因。具体如下表所示</p><div class=pgc-img><img alt="西门子PLC 对步进电机的控制方法 调用系统功能块SFB49" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/7b9feb96222547c99565c67332d50049></div><p>发生系统错误后，事件类别错误代码解释如下：</p><p>W#16#8001操作模式错误或参数错误。在“组态硬件”中设置正确的操作模式，或使用与已设置的操作模式相匹配的SFB。</p><p>W#16#8009 通道号非法。例如：将通道号设置值>3 (CPU的专用值)。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'西门子','PLC','对步'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>