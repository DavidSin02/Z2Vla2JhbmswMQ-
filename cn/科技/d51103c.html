<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>以太网接口学习笔记 | 极客快訊</title><meta property="og:title" content="以太网接口学习笔记 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/dfic-imagehandler/bf9b3bee-0cfa-4111-a8ce-739683375d05"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d51103c.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d51103c.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d51103c.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d51103c.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d51103c.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d51103c.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d51103c.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d51103c.html><meta property="article:published_time" content="2020-10-29T21:08:29+08:00"><meta property="article:modified_time" content="2020-10-29T21:08:29+08:00"><meta name=Keywords content><meta name=description content="以太网接口学习笔记"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/d51103c.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>以太网接口学习笔记</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/bf9b3bee-0cfa-4111-a8ce-739683375d05><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/dfic-imagehandler/829a6e66-3bb8-4b40-94ac-ca3bbfba6796><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/14b5198a-ebe4-4407-bf0b-3171128e75ba><p class=pgc-img-caption></p></div><p>英文：Ethernet</p><p>中文：以太网</p><p>标准号：IEEE802.3/802.3u/802.3z/802.3ab/802.3ae</p><p>标准制定与维护：IEEE 国际电气和电子工程师协会</p><p>网址：<u>www.ieee.org</u></p><p>10BASE2: 采用细同轴电缆接口的IEEE 802.3 10Mb/s物理层规格 (参见 IEEE 802.3Clause 10.)</p><p>10BASE5: 采用粗同轴电缆接口的IEEE 802.3 10Mb/s物理层规格 (参见 IEEE 802.3Clause 8.)</p><p>10BASE-F:采用光纤电缆接口的IEEE 802.3 10Mb/s物理层规格 (参见 IEEE 802.3 Clause15.)</p><p>10BASE-T:采用电话双绞线的IEEE 802.3 10Mb/s物理层规格 (参见 IEEE 802.3 Clause14.)</p><p>100BASE-FX: 采用两个光纤的IEEE 802.3 100Mb/s 物理层规格 (见 802.3 clauses 24 &26.)</p><p>100BASE-T: 采用双绞线的IEEE 802.3 100Mb/s物理层规格 (参见 IEEE 802.3 Clauses 22 and 28.)</p><p>100BASE-T2: 采用两对3类线或更好的平衡线缆的IEEE 802.3 100 Mb/s 物理层规格 (参见</p><p>IEEE 802.3 Clause 32.)</p><p>100BASE-T4: 采用四对3、4、5类线非屏蔽双绞线的IEEE 802.3 100 Mb/s 物理层规格(参见</p><p>IEEE 802.3 Clause 23.)</p><p>100BASE-TX: 采用两对5类非屏蔽双绞线或屏蔽双绞线的IEEE 802.3 100 Mb/s 物理层规格 (参见</p><p>IEEE 802.3 Clauses 24 and 25.)</p><p><strong>1000BASE-CX: </strong>1000BASE-X 在特制的屏蔽电缆传输的接口规格(参见 IEEE 802.3Clause 39.)</p><p>1000BASE-LX: 1000BASE-X 采用单模或多模长波激光器的规格(参见 IEEE 802.3 Clause 38.)</p><p>1000BASE-SX: 1000BASE-X 采用多模短波激光器的规格(参见 IEEE 802.3 Clause 38.)</p><p>1000BASE-T: 采用四对五类平衡电缆的1000 Mb/s 物理层规格 (参见 IEEE 802.3 Clause 40.)</p><p>三类平衡电缆线: 传输频率特性可到16MHz的平衡100 Ω 和120 Ω 电缆，性能符合ISO/IEC 11801: 1995的C类连接性能要求。主要用在10BASE-T。</p><p>五类平衡电缆线: 传输频率特性可到100MHz的平衡100 Ω 和120 Ω 电缆，性能符合ISO/IEC 11801: 1995的C类连接性能要求。主要用在100BASE-T、10BASE-T。</p><p>以太网接口分为双绞线（电口）和光纤接口（光口）两种；电口根据速率分为三类：10BASE-T、100BASE-T和1000BASE-T（分别对应10Mbps、100Mbps和1000Mbps）.10Gbps以上一般采用光纤连接。以太网电口标准传输距离为100米，它的接口通常叫RJ45，其传输物理层介质一般分为屏蔽双绞线（STP）和非屏蔽双绞线（UTP），当前常用的UTP线根据美国线规标准AWG有3类、4类、5类及超5类等4种。</p><p>名称 10Mbps 100Mbps 1000Mbps 10Gbps</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/14519f48121640689c27c7f31d12c914><p class=pgc-img-caption></p></div><p>基础技术：CSMA/CD载波侦听多路技术/冲突检测</p><p>比特时间：不管介质速度如何，将比特发送到介质并在介质上侦听到它都需要一定的时间。这段时间称为比特时间。</p><p>碰撞槽时间Slot time: 每种介质需要检测冲突的最大时间. 碰撞槽时间是一个确定有多少设备可以共享网络的重要参数, 碰撞槽时间按照约定的最大网络体系结构上的最大电缆长度计算.</p><p>帧间隙Inter Frame Gap: 介质在发送上一个帧后将获得稳定的时间，设备也获得了处理帧的时间。此时间称为帧间隙,其长度是从一个帧的 FCS 字段最后一位到下一个帧的“前导码”第一位。</p><p>拥塞信号: 只要一检测到冲突，发送设备就会发送一个 32 位“堵塞”信号以强调该冲突.</p><p>回退定时: 冲突发生后，所有设备都让电缆变成空闲，发送有冲突的设备必须再等待一段时间，然后才可以重新发送冲突的帧。</p><p>冲突检测: 一旦发生冲突，处于侦听模式的其它设备以及所有正在发送的设备，将会检测到信号量的增长, 检测到冲突之后，各台设备将继续发送，以确保网络上的所有设备都检测到冲突。</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f0d6603606ca46fdbbfae4e42174dcd6><p class=pgc-img-caption></p></div><p><strong>一、工作原理</strong></p><p><strong>基于广播的以太网中，所有的工作站都可以收到发送到网上的信息帧。每个工作站都要确认该信息帧是不是发送给自己的，一旦确认是发送给自己的，就将它发送到高一层的协议层。当站点希望传送信息时，就侦听电缆。如果线路正忙，它就等到线路空闲为止，否则就立即传输。如果两个或多个站点同时在空闲的电缆上开始传输，它们就会冲突，于是所有冲突站点终止传送，等待一个随机的时间后，再重复上述过程。</strong></p><p>以太网是Xerox公司发明的基带LAN标准，它采用<strong>CSMA/CD（</strong>Carrier Sense Multiple Access with Collision Detection）协议，速率为10Mbps，传输介质为同轴电缆。以太网是20世纪70年代为解决网络中零散和偶然的堵塞而开发的，而IEEE802．3标准是在最初的以太网技术基础上于1980年制定，描述了运行在各种介质上CSMA／CD系统的整个家族，速率从1Mbps到10Mbps（现已至10Gbps）</p><p>以太网提供的服务对应于OSI参考模型的第一层和第二层，而IEEE802.3以太网标准位于ISO／OSl 7层标准参考模型的第1层(物理层)和第2层(数据链路层)，没有定义逻辑链路层，但定义了几个不同的物理层，而以太网只定义了一个物理层。IEEE802.3的每个物理层协议都可以从三方面说明其特征，这三方面分别是LAN的速度、信号传输方式和物理介质类型。</p><p>它包括：</p><ol start=1><li>载波侦听</li><li>多路访问</li><li>冲突检测</li><li>堵塞信号和随机回退</li></ol><p>载波侦听：要发送报文的所有网络设备在发送之前必须侦听，如果设备检测到来自其它设备的信号，就会等待指定的时间后再尝试发送。没有检测到通信时，设备将发送其报文并继续侦听。</p><p>多路访问：如果设备之间的距离导致一台设备的信号延时，则另一台设备可能没有检测到信号，信号同时发送。两者的信号就会混合，报文被毁坏。但剩余信号会混杂在一起继续沿介质传播。</p><p>冲突检测:一旦发生冲突，处于侦听模式的其它设备以及所有正在发送的设备，将会检测到信号量的增长。检测到冲突之后，各台设备将继续发送，以确保网络上的所有设备都检测到冲突。</p><p>堵塞信号:发送设备检测到冲突之后，将发出拥塞信号。通知其它设备发生了冲突，以便它们调用回退算法,延迟到期后，该设备将恢复“发送前侦听”模式.( 回退算法造成的问题：在两台涉及冲突的设备重新发送之前，第三台设备可能会先行发送。) 回退算法将使所有设备在随机时间内停止发送，以让冲突消除 .</p><p>碰撞槽时间: 每种介质需要检测冲突的最大时间.碰撞槽时间是一个确定有多少设备可以共享网络的重要参数。碰撞槽时间按照约定的最大网络体系结构上的最大电缆长度计算。</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0e62b8c87a19489492270e25672cd339><p class=pgc-img-caption></p></div><p>以太网接口有许多，包括物理层与MAC接口,如MII、GII等，也有物理层接口，如RJ45。下面先介绍一下RJ45接口，然后再介绍物理层与MAC层之间的接口。</p><p><strong>工作原理</strong>：基于广播的以太网中，所有的工作站都可以收到发送到网上的信息帧。每个工作站都要确认该信息帧是不是发送给自己的，一旦确认是发送给自己的，就将它发送到高一层的协议层。当站点希望传送信息时，就侦听电缆。如果线路正忙，它就等到线路空闲为止，否则就立即传输。如果两个或多个站点同时在空闲的电缆上开始传输，它们就会冲突，于是所有冲突站点终止传送，等待一个随机的时间后，再重复上述过程。</p><p>工作模式：半双工和全双工两种。</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/627b19bd8ca24aef8e3f1884944d1fac><p class=pgc-img-caption></p></div><p>10MBASE-T:采用曼彻斯特编码,介质为非屏蔽双绞线，拓扑结构是星型，星型中心设备是集线器，针脚1和2用于发送数据，3和6用于接收数据。</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e9b463634519413eb225a02002da9625><p class=pgc-img-caption></p></div><p>100BASE-TX（铜缆）：传输媒体为两对5类UTP电缆，拓扑结构是星型，一对连向集线器，另一对从集线器引出，支持全双工模式，星型中心设备是交换机。为减少辐射，采用三电平信号MLT-3码。为实现对数据帧的控制，采用4B/5B编码，所以实际的信号速率为125Mbps。</p><p>100BASE-FX（光纤）：参数同上，只是介质为光纤。</p><p>100BASE-T4：传输媒体为四对3类或3类以上UTP电缆，其中两对工作于半双工模式，其余两对工作於单工模式，每对线缆上的信息速率为33.3Mbps。为减少辐射的影响，采用8B/6T编码，即8比特二进制位被映射为6个三进制位(+1，0，-1)，所以每对双绞线上实际的信号速率为25Mbps。</p><p>100BASE-T2：传输媒体为两对3类或3类以上UTP电缆，每对通过双工器实现全双工通信。为减少辐射，采用PAM5x5编码，共有25个符号，其中16个符号用于传输数据，每个符号包含4比特信息，每对线缆上的信息速率为25Mbps。接收机根据两对线缆上接收信号的电平值来确定信号在PAM5x5星座图上的位置。</p><p>注：100MHz PHY基于IEEE802.3协议，发射机发送数据的速率是125Mbps，要求信号经100m以内的双绞线传输后接收机能够实现10卅以下的误码率；由于发送速率较高，又要经过100m的传输距离，接收信号的质量将会因为串扰的影响而变得非常差，类似以太网的基带通讯中通常采用时钟恢复电路来恢复数据。</p><p>1000Base-T：四对 5 类或更高规格的 UTP 电缆，1000BASE-SX 和 1000BASE-LX 以太网（光纤），接口采用4D-PAM5编码方式，采用了5类线中的所有4对差分线，在全双工模式下达到1000Mbps的传输速率。每对线速率125Mbps，每个UI就是8ns。4x125＝500M2使用4D-PAM5编码方式，2bit为1Baud传送，实现1000Mbps。</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/eba8368383364b3ab5dcef547639c8e6><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b27fa87ef38c4a0f8c82e8a8230d8cea><p class=pgc-img-caption></p></div><p>10G BASE-W/R/ X/T：使用10G Base-W（广域网）和10G Base-R（局域网）使用<strong>64B/66B编码，1</strong>0G BASE-X（局域网）使用<strong>8B/10B</strong>编码，10G BASE-T使用LDPC编码方式。支持<strong>LAN</strong>和<strong>WAN</strong>接口<strong>,</strong>有效距离可达<strong>100km.</strong> 而以往的以太网有效传输距离不超过<strong>5km.</strong></p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/52fcb42789c044688f58f599f273b041><p class=pgc-img-caption></p></div><p>电压由负到正的跳变为逻辑电平1，电压由正到负的跳变定义为逻辑电平0.</p><p>100Base-TX:PCS(Physical Coding Sublayer)负责编码，PCS通过MII接口接收100Mbps的码流，PCS将每4bit数据编译成5bit。这就是工程师常说的4B/5B变换。因此，100Base-TX接口在外部测出的速率是125Mbps，一个UI是8ns。PMA(Physical Media Attachment)采用MLT-3电平，编码遵循NRZ形式。100Base-TX接口信号逢“1”产生电平跳变，而逢“0”时信号电平保持不变。因此100Base-TX接口信号有三个电平，眼图中一个UI会出现2个“眼睛”。</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5b8fc869da2b45dcb5deb800d87dae57><p class=pgc-img-caption></p></div><p>由于分别采用了MLT-3和PAM-5的编码方式，令它们的信号基频均为31.25MHz。使EMI性能提高且传输距离远。</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/bf9873df3ae740f9a94ec91b01904c3a><p class=pgc-img-caption></p></div><p>一个Ethernet Packet format以太网包格式如下图所示。</p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b5a95208e778447fb91813f7326fd4f4><p class=pgc-img-caption></p></div><p>其传输是从上至下，从左到右。其中SFD固定为10101011.接下来就是目标地址和源地址，它们的位数均为48比特，如下图所示。</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/30164e1d03844b30848fae306afc1e44><p class=pgc-img-caption></p></div><p><strong>其</strong>位传输顺序（除FCS外）是is transmitted least significant bit first.以太网帧最短长为64字节，最长为1518字节。</p><p>40Gbps和100Gbps通过Optical Transport Network (OTN).网络传输。即</p><p>40GBASE-R：4 lane data path</p><p>100GBASE-R：10 lane data path</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/910d6eda94c74584a7b24a284dfb865d><p class=pgc-img-caption></p></div><p><strong>二、接口结构</strong></p><p>RJ45接口</p><p>标准：TIA/EIA T568A/T568B（美国电信工业联合会/美国电子工业协会）</p><p>引脚：8脚</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4d01bee0542d435ea43b767ecc18cfe2><p class=pgc-img-caption></p></div><p>从引针1至引针8对应线序为：</p><p>T568A：① 白-绿、② 绿、③ 白-橙、④ 蓝、⑤ 白-蓝、⑥ 橙、⑦ 白-棕、⑧ 棕</p><p>T568B：① 白-橙、② 橙、③ 白-绿、④ 蓝、⑤ 白-蓝、⑥ 绿、⑦ 白-棕、⑧ 棕</p><p>两种国际标准并没有本质的区别，只是颜色上的区别，需要注意的是在连接两个RJ45水晶头时必须保证：1、2脚对是一个绕对，3、6脚对是一个绕对，4、5脚对是一个绕对，7、8脚对是一个绕对。在同一个综合布线系统工程中，只能采用一种连接标准。制作连接线、插座、配线架等一般较多地使用TIA/EIA-568-B标准，否则，应标注清楚。</p><p>RJ45的性能指标：衰减、近端串扰、插入损耗、回波损耗和远端串扰等。</p><p>RJ45的性能技术说明：接触电阻为2.5mΩ，绝缘电阻为1000mΩ，抗电强度为DC1000V（AC700V）时，一分钟无击穿和飞弧现象；卡接簧片表面镀金或镀银，可接线径为0.4mm～0.6mm；插头插座可重复插拔次数不小于750次；8线接触针镀金509（inch）。</p><p><strong>以太网 10/100Base-T 接口</strong></p><p><strong>以太网 100Base-T4 接口</strong></p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/01c0b1a8c8a845799502af49a852565e><p class=pgc-img-caption></p></div><p>上述接口有时叫MDI和MDI-X，其说明如下：它们对应为DTE侧接口和DCE侧接口，MDI接口的PIN定义如下图所示。</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/7f329af130994a9b92feeb1aa5a44d48><p class=pgc-img-caption></p></div><p>而MDI－X接口的PIN定义如下图所示，其收发方向刚好与MDI接口相反。</p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/84511fa529e14366990423b97f100875><p class=pgc-img-caption></p></div><p>现在有些物理层芯片支持MDI和MDI-X自动识别功能，它可以根据与其相连的对端设备是DTE还是DCE及使用的是MDI-X还是MDI模式，也可以设成MDI或MDI-X的固定模式。</p><p><strong>下面介绍物理层与MAC层之间的常用接口。包括适用100M/10M的MII和1000M的GII接口。</strong></p><p><strong>MII接口</strong></p><p>MII：Medium Independent Interface</p><p>中文：介质独立接口</p><p>引脚：共有18根线（发送时钟TCLK、发送数据TXD[0:3]、发送使能TX_EN、发送错误TX_ERR、载波侦听CRS、冲突COL共9根信号，接收时钟RCLK、接收数据RXD[0:3]、接收数据有效RX_DV、接收错误RX_ER共7根信号，管理数据时钟MDC和管理数据输入输出MDIO 2根，类似IIC）</p><p>时钟：25MHz/2.5MHz</p><p>传输速率：100Mbps/10Mbps</p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ae35f4844aab4089a85da59cf0b1549e><p class=pgc-img-caption></p></div><p>TXD[3:0]：数据发送信号，共4根信号线；</p><p>RXD[3:0]：数据接收信号，共4根信号线；</p><p>TX_ER：Transmit Error发送数据错误提示信号。//同步于TX_CLK，高电平有效，表示TX_ER有效期内传输的数据无效。对于10Mbps速率下，TX_ER不起作用；</p><p>RX_ER：Receive Error接收数据错误提示信号。//同步于RX_CLK，高电平有效，表示RX_ER有效期内传输的数据无效。对于10Mbps速率下，RX_ER不起作用；</p><p>TX_EN：Transmit Enable发送使能信号。//只在TX_EN有效期内传的数据才有效；</p><p>RX_DV：Receive Data Valid接收数据有效信号，作用类似于发送通道的TX_EN；</p><p>TX_CLK：发送数据参考时钟。100Mbps速率下，时钟频率为25MHz；10Mbps速率下，时钟频率为2.5MHz。注意，TX_CLK时钟的方向是从PHY指向MAC的，因此它的时钟是由PHY提供的。</p><p>RX_CLK：接收数据参考时钟。100Mbps速率下，时钟频率为25MHz；10Mbps速率下，时钟频率为2.5MHz。RX_CLK也是由PHY提供的。</p><p>CRS：Carrier Sense，载波侦测信号。不需要同步于参考时钟，只要有数据传输，CRS就有效且只在半双工模式下有效。</p><p>COL：Collision Detected，冲突检测信号。不需要同步于参考时钟且只在半双工模式下有效。</p><p>管理接口信号是标准的IIC总线，总线上可以挂最多8个器件，通过地址来区分，最大数率可以达到3.4Mb/s。</p><p><br></p><p><strong>RMII接口</strong></p><p>英文：RMII，Reduced MII</p><p>中文：精简版介质独立接口</p><p>引脚：8根。时钟：50MHz，传输速率：1Gbps</p><p>管理数据接口与MII一样为IIC。</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6c72fbb292b445699f88c5d5b3dc7ec6><p class=pgc-img-caption></p></div><p>TXD[1:0]：数据发送信号线，数据位宽为2，是MII接口的一半；</p><p>RXD[1:0]：数据接收信号线，数据位宽为2，是MII接口的一半；</p><p>TX_EN：Transmit Enable数据发送使能信号，与MII接口一样；</p><p>RX_ER：Receive Error数据接收错误提示信号，与MII接口一样；</p><p>CLK_REF：Clock Reference外部参考时钟信号。是由外部时钟源提供的50MHz参考时钟，与MII接口不同，MII接口中的接收时钟和发送时钟是分开的，而且都是由PHY芯片提供给MAC芯片的。这里需要注意的是，由于数据接收时钟是由外部晶振提供而不是由载波信号提取，所以在PHY层芯片内的数据接收部分需要设计一个FIFO，用来协调两个不同的时钟。</p><p>CRS_DV：此信号是由MII接口中的RX_DV和CRS两个信号合并而成。当介质不空闲时，CRS_DV和RE_CLK相异步的方式给出。当CRS比RX_DV早结束时(即载波消失而队列中还有数据要传输时)，就会出现CRS_DV在半位元组的边界以25MHz/2.5MHz的频率在0与1之间的来回切换。因此，MAC能够从CRS_DV中精确的恢复出RX_DV和CRS。在100Mbps速率时，TX/RX每个时钟周期采样一个数据；在10Mbps速率时，TX/RX每隔10个周期采样一个数据，因而TX/RX数据需要在数据线上保留10个周期，相当于一个数据发送10次。当PHY层芯片收到有效的载波信号后，CRS_DV信号变为有效，此时如果FIFO中还没有数据，则它会发送出全0的数据给MAC，然后当FIFO中填入有效的数据帧，数据帧的开头是“101010---”交叉的前导码，当数据中出现“01”的比特时，代表正式数据传输开始，MAC芯片检测到这一变化，从而开始接收数据。当外部载波信号消失后，CRS_DV会变为无效，但如果FIFO中还有数据要发送时，CRS_DV在下一周期又会变为有效，然后再无效再有效，知道FIFO中数据发送完为止。</p><p><br></p><p><strong>SMII接口</strong></p><p>英文：Serial MII</p><p>中文：串行MII</p><p>信号线：4根， 时钟：125MHz,传输速率：1Gbps</p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e61ad14fe4d04c158542d59b39cdb5fb><p class=pgc-img-caption></p></div><p>TXD：发送数据信号，位宽为1；</p><p>RXD：接收数据信号，位宽为1；</p><p>SYNC：收发数据同步信号.每10个时钟周期置1次高电平，指示同步。</p><p>CLK_REF：所有端口共用的一个参考时钟，频率为125MHz（100Mbps速率要用125MHz时钟,因为在每8位数据中会插入2位控制信号）。</p><p>TXD/RXD以10比特为一组，以SYNC为高电平来指示一组数据的开始，在SYNC变高后的10个时钟周期内，TXD上依次输出的数据是：TXD[7:0]、TX_EN、TX_ER,控制信号的含义与MII接口中的相同；RXD上依次输出的数据是：RXD[7:0]、RX_DV、CRS, RXD[7:0]的含义与RX_DV有关，当RX_DV为有效时(高电平1)，RXD[7:0]上传输的是物理层接收的数据;当RX_DV为无效时(低电平0)，RXD[7:0]上传输的是物理层的状态信息数据。见下表：</p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/62745ab617be4824843e9c4685566428><p class=pgc-img-caption></p></div><p>当速率为10Mbps时，每一组数据要重复10次，MAC/PHY芯片每10个周期采样一次。MAC/PHY芯片在接收到数据后会进行串/并转换。</p><p><strong>SSMII接口</strong></p><p>英文：Serial Sync MII</p><p>中文：串行同步MII接口</p><p>跟SMII接口很类似，只是收发使用独立的参考时钟和同步时钟，不再像SMII那样收发共用参考时钟和同步时钟，传输距离比SMII更远。</p><p>信号线：6根，时钟：125MHz</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/5317b191d9a04ba5a6a9f2a587f76767><p class=pgc-img-caption></p></div><p>SSSMII接口</p><p>英文：Source Sync Serial MII</p><p>中文：源同步串行MII接口</p><p>SSSMII与SSMII的区别在于参考时钟和同步时钟的方向，SSMII的TX/RX参考时钟和同步时钟都是由PHY芯片提供的，而SSSMII的TX参考时钟和同步时钟是由MAC芯片提供的，RX参考时钟和同步时钟是由PHY芯片提供的，所以顾名思义叫源同步串行。</p><p>信号线：6根</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/81979f9f1aa14a80a40f38b5eb332a54><p class=pgc-img-caption></p></div><p><br></p><p><strong>GMII接口</strong></p><p>英文：Gigabits Medium Independent Interface</p><p>中文：<strong>千兆媒体独立接口</strong></p><p>信号线：24根</p><p>传输速率：1000Mbps(向下兼容10/100Mbps)</p><p>工作时钟：125MHz</p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c1396199bee248ae930f242d41f66d10><p class=pgc-img-caption></p></div><p>与MII接口相比，GMII的数据宽度由4位变为8位，GMII接口中的控制信号如TX_ER、TX_EN、RX_ER、RX_DV、CRS和COL的作用同MII接口中的一样，发送参考时钟GTX_CLK和接收参考时钟RX_CLK的频率均为125MHz(1000Mbps/8=125MHz)。</p><p>在这里有一点需要特别说明下，那就是发送参考时钟GTX_CLK，它和MII接口中的TX_CLK是不同的，MII接口中的TX_CLK是由PHY芯片提供给MAC芯片的，而GMII接口中的GTX_CLK是由MAC芯片提供给PHY芯片的，两者方向不一样。</p><p>在实际应用中，绝大多数GMII接口都是兼容MII接口的，所以，一般的GMII接口都有两个发送参考时钟：TX_CLK和GTX_CLK(两者的方向是不一样的，前面已经说过了)，在用作MII模式时，使用TX_CLK和8根数据线中的4根。</p><p><br></p><p><strong>RGMII接口</strong></p><p>R英文：Reduced GMII</p><p>中文：简化版RGMII接口</p><p>信号线：14根 传输速率：1000Mbps 时钟：125MHz(25M/2.5M)</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a8d0242d2ced41a9be0e1c17437a9698><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/dd67d3775c264f1388fd69f84bef5fec><p class=pgc-img-caption></p></div><p><br></p><p>将接口信号线数量从24根减少到14根(COL/CRS端口状态指示信号，这里没有画出)，时钟频率仍是125MHz，TX/RX数据宽度从8为变为4位，为了保持1000Mbps的传输速率不变，RGMII接口在时钟的上升沿和下降沿都采样数据。在参考时钟的上升沿发送GMII接口中TXD[3:0]/RXD[3:0]，在参考时钟的下降沿发送GMII接口中的TXD[7:4]/RXD[7:4]。RGMI同时也兼容100Mbps和10Mbps两种速率，此时参考时钟速率分别为25MHz和2.5MHz。TX_EN信号线上传送TX_EN和TX_ER两种信息，在TX_CLK的上升沿发送TX_EN，下降沿发送TX_ER；同样的，RX_DV信号线上也传送RX_DV和RX_ER两种信息，在RX_CLK的上升沿发送RX_DV，下降沿发送RX_ER。</p><p><br></p><p><strong>SGMII接口</strong></p><p>英文：Serial GMII</p><p>中文：串行GMII接口</p><p>信号线：3根</p><p>传输速率：1.25Gbps</p><p>工作时钟：625MHz 编码：8B/10b</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d6387a91ef344528a70de2290d5e9755><p class=pgc-img-caption></p></div><p>收发各一对差分信号线，时钟频率625MHz；在时钟信号的上升沿和下降沿均采样；</p><p>参考时钟RX_CLK由PHY提供，是可选的。主要用于MAC侧没有时钟的情况，一般情况下，RX_CLK不使用。收发都可以从数据中恢复出时钟。</p><p>在TXD发送的串行数据中，每8比特数据会插入TX_EN/TX_ER 两比特控制信息；同样，在RXD接收数据中，每8比特数据会插入RX_DV/RX_ER 两比特控制信息，所以总的数据速率为1.25Gbps=625Mbps*2.</p><p>其实，大多数MAC芯片的SGMII接口都可以配置成SerDes接口(在物理上完全兼容，只需配置寄存器即可)，直接外接光模块，而不需要PHY层芯片，此时时钟速率仍旧是625MHz，不过此时跟SGMII接口不同，SGMII接口速率被提高到1.25Gbps。是因为插入了控制信息，而SerDes端口速率被提高是因为进行了8B/10B变换，本来8B/10B变换是PHY芯片的工作，在SerDes接口中，因为外面不接PHY芯片，此时8B/10B变换在MAC芯片中完成了。8B/10B变换的主要作用是扰码，让信号中不出现过长的连“0”和连“1”情况，影响时钟信息的提取，关于8B/10B变换知识，我后续会单独介绍。</p><p><br></p><p><strong>TBI接口</strong></p><p>英文：Ten Bit Interface</p><p>中文：十数据位接口</p><p>工作时钟：发送参考时钟为125MHz，接收参考时钟为两个相位差为180°的62.5MHz,和GMII一样也有PHY环回控制信号LOOPEN，还有一个信号监测LOSS.</p><p>传输速率：1Gbps</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/00cd4cf1c94942ab88c26bc21c9da0c4><p class=pgc-img-caption></p></div><p>接口数据位宽由GMII接口的8位增加到10位，其实，TBI接口跟GMII接口的差别不是很大，多出来的2位数据主要是因为在TBI接口下，MAC芯片在将数据发给PHY芯片之前进行了8B/10B变换(8B/10B变换本是在PHY芯片中完成的，前面已经说过了)，另外，RX_CLK+/-是从接收数据中恢复出来的半频时钟，频率为62.5MHz，RX_CLK+/-不是差分信号，而是两个独立的信号，两者之间有180度的相位差，在这两个时钟的上升沿都采样数据。RX_CLK+/-也叫伪差分信号。除掉上面说到的之外，剩下的信号都跟GMII接口中的相同。</p><p>大多数芯片的TBI接口和GMII接口兼容。在用作TBI接口时，CRS和COL一般不用。</p><p><br></p><p><strong>RTBI</strong></p><p>英文：Reduced TBI</p><p>中文：简化版TBI</p><p>信号线：14根</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/108bf82f55944559883567d862099cf1><p class=pgc-img-caption></p></div><p>接口数据位宽为5bit，时钟频率为125MHz。在时钟的上升沿和下降沿都采样数据，同RGMII接口一样，TX_EN线上会传送TX_EN和TX_ER两种信息，在时钟的上升沿传TX_EN，下降沿传TX_ER；RX_DV线上传送RX_DV和RX_ER两种信息，在RX_CLK上升沿传RX_DV，下降沿传RX_ER。</p><p><br></p><p><strong>XGMII接口</strong></p><p>英文：<strong>Extended Gigabits Medium Independent Interface（X代表10）</strong></p><p>中文<strong>：以太网万兆媒体独立接口</strong></p><p>信号线：共74根连线</p><p>传输速率：10Gbps 时钟：156.25MHz</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/22f31660c544448192db9a58269d58d5><p class=pgc-img-caption></p></div><p>TXD[31:0]：数据发送通道，32位并行数据。</p><p>RXD[31:0]：数据接收通道，32位并行数据。</p><p>TXC[3:0]：发送通道控制信号，TXC=0时，表示TXD上传输的是数据；TXC=1时，表示TXD上传输的是控制字符。TXC[3:0]分别对应TXD[31:24], TXD[23:16], TXD[15:8], TXD[7:0]。</p><p>RXC[3:0]：接收通道控制信号，RXC=0时，表示RXD上传输的是数据；RXC=1时，表示RXD上传输的是控制字符。RXC[3:0]分别对应RXD[31:24], RXD[23:16], RXD[15:8], RXD[7:0]。</p><p>TX_CLK：TXD和TXC的参考时钟，时钟频率156.25MHz。在时钟信号的上升沿和下降沿都采样数据。</p><p>156.25MHz * 2 * 32 = 10Gbps 。</p><p>RX_CLK：RXD和RXC的参考时钟，时钟频率156.25MHz。在时钟信号的上升沿和下降沿都采样数据。</p><p>单端信号，采用HSTL/SSTL_2逻辑，端口电压1.5V/2.5V。由于SSTL_2的端口电压高，功耗大，现在已很少使用。HSTL即High Speed Transceiver Logic，高速发送逻辑的意思。SSTL，即Stub Series Terminated Logic，短路终止逻辑，主要用于高速内存接口，SSTL目前存在两种标准，SSTL_3是3.3V标准，SSTL_2是2.5V标准。</p><p><br></p><p><strong>XAUI接口</strong></p><p>英文：Ethernet attachment unit interface</p><p>中文：以太网扩展单元接口</p><p>信号线：16根（8对差分线，收/发各4对）</p><p>传输速率：12.5Gbps</p><p>由于受电气特性的影响，XGMII接口的PCB走线最大传输距离仅有7cm，并且XGMII接口的连线数量太多，给实际应用带来不便，因此，在实际应用中，XGMII接口通常被XAUI接口代替，XAUI即10 Gigabit attachment unit interface10G附属单元接口。XAUI在XGMII的基础上实现了XGMII接口的物理距离扩展，将PCB走线的传输距离增加到50cm，使背板走线成为可能。</p><p>源端XGMII把收发32位宽度数据流分为4个独立的lane通道，每个lane通道对应一个字节，经XGXS(XGMII Extender Sublayer)完成8B/10B编码后，将4个lane分别对应XAUI的4个独立通道，XAUI端口速率为：2.5Gbps * 1.25 * 4＝12.5Gbps。</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/43196d92fd5247609c7118a910deba1c><p class=pgc-img-caption></p></div><p>在发送端的XGXS模块中，将TXD[31:0]/ RXD[31:0],TXC[3:0]/ RXC[3:0], TX_CLK/ RX_CLK转换成串行数据从TX Lane[3:0]/ RX Lane[3:0]中发出去，在接收端的XGXS模块中，串行数据被转换成并行，并且进行时钟恢复和补偿，完成时钟去抖，经过5B/4B解码后，重新聚合成XGMII。</p><p>XAUI接口采用差分线，收发各四对，CML逻辑，AC耦合方式，耦合电容在10nF~100nF之间。XAUI接口可以直接接光模块，如XENPAK/X2等。也可以转换成一路10G信号XFI，接XFP/SFP+等。有些芯片不支持XAUI接口，只支持XGMII接口，这时可以用专门的芯片进行XGMIIà XAUI接口转换，如BCM8011等。</p><p><strong>三、测试验证</strong></p><p><strong>3.1.物理层接口一致性测试</strong></p><p>以太网接口的物理层一致性测试包括眼图、抖动和误码率等参数。<strong>测试原理模型如下图所示。</strong></p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0c2148e56bcd4df2a7d0a5bb2e9974ae><p class=pgc-img-caption></p></div><p><br></p><p><strong>100M Base-TX测试：</strong>IEEE802.3规范直接引用ANSI X3.184规范，要求测试FDDI Halt脉冲模板，要经过一系列复杂设定DUT才能发出码流，无论单模多模，波长都是1310nm。</p><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/111092335db14a339d66c0a9b8892510><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f6294b4071ba4364b81845e916ea0e90><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=以太网接口学习笔记 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8482cc3ee5f94a7fae039bf7cc19b6af><p class=pgc-img-caption></p></div><p><br></p><p>眼图eye diagram：将不同周期的信号叠加在一起，就可以得到眼图(Eye Diagram)。眼图是数据通信中常用的性能衡量方法，借助它可以很方便的判断时序和幅度畸变的影响，图2显示了一个眼图的示例。图中还用虚线给出了一个MASK图样，落在MASK以内的点越多，误码率自然也就越高，MASK的峰值代表了最佳抽样时刻。左侧的眼图代表不存在抖动的情况；中间的图样中存在抖动，但抖动不是特别严重；右侧的抖动则比较严重，MASK的一部分被遮盖住了，这时就会存在较大的误码率。</p><p><strong>眼图测试设备</strong>:数字存储示波器(DSO：Digital Storage Oscilloscope)。</p><p><br></p><p><strong>3.2.性能测试</strong></p><p>吞吐量（Throughput）：网络不丢帧情况下的最大帧转发速率。</p><p>时延（Latency）：存储转发和比特转发。</p><p>丢帧率（Frame Loss Rate）：在网络稳定状态下由于网络资源缺乏造成的不能转发的数据帧和总数据帧的百分比。</p><p>背靠背（Back-to-Back）：长度固定的数据包以最小间隔的速率（即对应介质的最大速率）向设备发包，不丢包的最大数目。</p><p><strong>3.3. 功能测试</strong></p><p>组播功能测试</p><p>MAC地址表深度测试</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'学习','笔记','以太'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>