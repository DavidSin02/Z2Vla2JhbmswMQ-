<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>æ”¯æŒå‘é‡æœºï¼ˆç¬¬å…«ç« ï¼‰ | æå®¢å¿«è¨Š</title><meta property="og:title" content="æ”¯æŒå‘é‡æœºï¼ˆç¬¬å…«ç« ï¼‰ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/153985032133768ee02ea64"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d61d6a42.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d61d6a42.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d61d6a42.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d61d6a42.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d61d6a42.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d61d6a42.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d61d6a42.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d61d6a42.html><meta property="article:published_time" content="2020-11-14T21:05:18+08:00"><meta property="article:modified_time" content="2020-11-14T21:05:18+08:00"><meta name=Keywords content><meta name=description content="æ”¯æŒå‘é‡æœºï¼ˆç¬¬å…«ç« ï¼‰"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/d61d6a42.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>æ”¯æŒå‘é‡æœºï¼ˆç¬¬å…«ç« ï¼‰</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><h1>ç¬¬å…«ç«  å¤šç±»SVMs</h1><p>å´å¤©æ™–/è¯‘</p><p>SVMså¯ä»¥ç”ŸæˆäºŒåˆ†åˆ†ç±»å™¨ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ç»å¸¸é¢å¯¹çš„æ•°æ®é›†å¤šäºä¸¤ç±»ã€‚ä¸¾ä¾‹ï¼ŒåŸè‘¡è„é…’æ•°æ®é›†å®é™…ä¸ŠåŒ…å«ä¸‰ç§ä¸åŒçš„äº§å“ã€‚æœ‰å¾ˆå¤šç§æ–¹æ³•å¯ä»¥è®©SVMsåœ¨å¤šç±»ä¸‹å·¥ä½œã€‚åœ¨è¿™ç« é‡Œï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€äº›éå¸¸æµè¡Œçš„å¤šç±»åˆ†ç±»æ–¹æ³•å’Œè®¨è®ºå®ƒä»¬çš„ç»†èŠ‚ã€‚</p><p>è¿™ä¸€ç« é‡Œçš„æ‰€æœ‰ä»£ç ï¼Œæˆ‘ä»¬å°†ç”¨ä»£ç è¡¨41äº§ç”Ÿçš„æ•°æ®é›†(å¦‚å›¾51æ‰€ç¤º)ã€‚</p><pre>ä»£ç è¡¨41import numpy as np def load_X():return np.array([[1, 6], [1, 7], [2, 5], [2, 8],[4, 2], [4, 3], [5, 1], [5, 2],[5, 3], [6, 1], [6, 2], [9, 4],[9, 7], [10, 5], [10, 6], [11, 6],[5, 9], [5, 10], [5, 11], [6, 9],[6, 10], [7, 10], [8, 11]])def load_y():return np.array([1, 1, 1, 1,2, 2, 2, 2, 2, 2, 2,3, 3, 3, 3, 3,4, 4, 4, 4, 4, 4, 4])</pre><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœºï¼ˆç¬¬å…«ç« ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153985032133768ee02ea64><p class=pgc-img-caption>å›¾51:4ä¸ªç±»çš„åˆ†ç±»é—®é¢˜</p></div><p><strong>è§£å¤šç±»äºŒåˆ†é—®é¢˜</strong></p><p><strong>ä¸€å¯¹å¤šï¼ˆOne-against-all ï¼‰</strong></p><p>ä¹Ÿå«ä¸€å¯¹æ‰€æœ‰ï¼ˆone-versus-the-restï¼‰ï¼Œè¿™å¯èƒ½æ˜¯æœ€ç®€å•çš„æ–¹æ³•ã€‚</p><p>ä¸ºäº†åˆ†ç±»Kä¸ªç±»ï¼Œæˆ‘ä»¬æ„é€ Kä¸ªä¸åŒçš„äºŒåˆ†åˆ†ç±»å™¨ã€‚å¯¹äºä¸€ä¸ªç»™å‡ºçš„ç±»ï¼Œè¿™ä¸ªç±»ä¸­çš„æ‰€æœ‰ç¤ºä¾‹ç‚¹éƒ½ä¸ºæ­£ï¼Œä¸åœ¨è¿™ä¸ªç±»é‡Œçš„æ‰€æœ‰ç¤ºä¾‹ç‚¹éƒ½ä¸ºè´Ÿï¼ˆä»£ç è¡¨42)ã€‚</p><p>ä»£ç è¡¨42</p><pre>import numpy as npfrom sklearn import svm# Create a simple datasetX = load_X()y = load_y()# Transform the 4 classes problem# in 4 binary classes problems.y_1 = np.where(y == 1, 1, -1)y_2 = np.where(y == 2, 1, -1)y_3 = np.where(y == 3, 1, -1)y_4 = np.where(y == 4, 1, -1)</pre><p>æ‰€æœ‰çš„é—®é¢˜æˆ‘ä»¬ç”¨äºŒåˆ†åˆ†ç±»å™¨æ¥è®­ç»ƒï¼ˆä»£ç è¡¨43ï¼‰ã€‚ç»“æœï¼Œæˆ‘ä»¬æ¯ä¸€ä¸ªåˆ†ç±»å™¨éƒ½å¾—åˆ°ä¸€ä¸ªå†³ç­–è¾¹ç¼˜ï¼ˆå¦‚å›¾52ï¼‰ã€‚</p><pre>ä»£ç è¡¨43# Train one binary classifier on each problem.y_list = [y_1, y_2, y_3, y_4]classifiers = []for y_i in y_list:clf = svm.SVC(kernel='linear', C=1000)clf.fit(X, y_i)classifiers.append(clf)</pre><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœºï¼ˆç¬¬å…«ç« ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539850321389bdd266e7d0><p class=pgc-img-caption>å›¾52:ä¸€å¯¹å¤šæ–¹æ³•ä¸ºæ¯ä¸€ä¸ªç±»å»ºä¸€ä¸ªåˆ†ç±»å™¨</p></div><p>ä¸ºäº†åšä¸€ä¸ªæ–°çš„é¢„æµ‹ï¼Œæˆ‘ä»¬ç”¨åˆ†ç±»å™¨å»é¢„æµ‹åˆ†ç±»å™¨ä¸­è¿”å›æ­£å€¼çš„ç±»ï¼ˆä»£ç è¡¨44)ã€‚ç„¶è€Œï¼Œè¿™å¯èƒ½ä¼šç»™å‡ºä¸ä¸€è‡´çš„ç»“æœï¼Œå› ä¸ºä¸€ä¸ªæ ‡é‡å¯èƒ½åŒæ—¶åˆ†é…ç»™å¤šç±»æˆ–ä¸ºç©º(Bishop, 2006)ã€‚å›¾53æ˜¾ç¤ºäº†è¿™ä¸ªé—®é¢˜ï¼›ä¸€å¯¹å¤šåˆ†ç±»å™¨ä¸èƒ½é¢„æµ‹åˆ†ç±»åˆ†å¸ƒåœ¨æ¯ä¸€è§’è½çš„è“è‰²åŒºåŸŸä¸­çš„æ•°æ®,å› ä¸ºä¸¤ä¸ªåˆ†ç±»å™¨éƒ½åŒæ—¶ç»™å‡ºæ­£å€¼é¢„æµ‹ã€‚è¿™å°†è¿”å›ä¸€ä¸ªç¤ºä¾‹æ•°æ®åŒæ—¶å±äºä¸¤ä¸ªç±»ã€‚åŒæ ·çš„é—®é¢˜ä¼šå‘ç”Ÿåœ¨ä¸­é—´ï¼Œå› ä¸ºæ¯ä¸€ä¸ªåˆ†ç±»å™¨éƒ½ç»™å‡ºæ­£å€¼ã€‚ç»“æœï¼Œåœ¨è¿™ä¸ªåŒºåŸŸæ²¡æœ‰ç±»å¯ä»¥ç”¨æ¥åˆ†é…ã€‚</p><pre>ä»£ç è¡¨44def predict_class(X, classifiers):predictions = np.zeros((X.shape[0], len(classifiers)))for idx, clf in enumerate(classifiers):predictions[:, idx] = clf.predict(X)# returns the class number if only one classifier predicted it 	# returns zero otherwise. 	return np.where((predictions == 1).sum(1) == 1,(predictions == 1).argmax(axis=1) + 1,0)</pre><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœºï¼ˆç¬¬å…«ç« ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15398503214764bb2b9ef14><p class=pgc-img-caption>å›¾53:ä¸€å¯¹å¤šå¯¼è‡´æ¨¡ç³Šçš„å†³ç­–</p></div><p>ä½œä¸ºä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆï¼ŒVladimir Vapnik å»ºè®®å“ªä¸€ä¸ªå†³ç­–å‡½æ•°è¿”å›çš„å€¼æœ€å¤§åˆ†ç±»å™¨å°±å°†å…¶åˆ†åˆ°å“ªä¸ªç±»ï¼ˆVapnik V. N., 1998 ï¼‰ã€‚ä»£ç è¡¨45æ¼”ç¤ºäº†è¿™ä¸ªå»ºè®®ã€‚æ³¨æ„è¿™é‡Œæˆ‘ä»¬ç”¨decision_function ä»£æ›¿åˆ†ç±»å™¨ä¸­çš„predictæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªæ­£çš„çœŸå®å€¼å½“è¿™ä¸ªç¤ºä¾‹è¢«åˆ†ç±»å™¨åˆ†ç±»åˆ°æ­£ç¡®çš„ä¸€è¾¹æ—¶ï¼Œå¦‚æœåœ¨å¦ä¸€è¾¹åˆ™è¿”å›è´Ÿå€¼ã€‚æœ‰è¶£çš„æ˜¯æ³¨æ„åˆ°å®ƒç”¨çš„æ˜¯æœ€å¤§å€¼ï¼Œè€Œä¸æ˜¯æœ€å¤§çš„ç»å¯¹å€¼ï¼Œå¦‚æœæ‰€æœ‰åˆ†ç±»å™¨æœ‰äº‰æ‰§çš„æƒ…å†µä¸‹è¿™ä¸ªæ–¹æ³•å°†é€‰æ‹©åˆ†ç»™æœ€æ¥è¿‘çš„è¶…å¹³é¢çš„ç±»ã€‚ä¸¾ä¾‹ï¼Œç¤ºä¾‹ç‚¹ï¼ˆ6,4)åœ¨å›¾ä¸­å°†è¢«åˆ†é…ç»™è¿™ä¸ªè“æ˜Ÿç±»ã€‚</p><pre>ä»£ç è¡¨45def predict_class(X, classifiers):predictions = np.zeros((X.shape[0], len(classifiers)))for idx, clf in enumerate(classifiers):predictions[:, idx] = clf.decision_function(X)# return the argmax of the decision function as suggested by Vapnik.return np.argmax(predictions, axis=1) + 1</pre><p>å¦‚å›¾54æ‰€ç¤ºï¼Œåº”ç”¨äº†è¿™ä¸ªå¯å‘å¼è®©æˆ‘ä»¬çš„åˆ†ç±»ç»“æœæ²¡æœ‰æ¨¡ç³Šå€¼ã€‚è¿™ä¸ªæ–¹æ³•çš„ä¸»è¦ç¼ºç‚¹æ˜¯ä¸åŒçš„åˆ†ç±»å™¨è¦è®­ç»ƒä¸åŒçš„ä»»åŠ¡ï¼Œæ‰€ä»¥ä¸èƒ½ä½†ä¿decision_function æ–¹æ³•åœ¨ç›¸åŒå˜å½¢ä¸‹è¿”å›çš„è´¨é‡ã€‚å¦‚æœä¸€ä¸ªå†³ç­–æ–¹æ³•æ¯”å…¶ä»–æ–¹æ³•è¿”å›å¤§å€¼å¤š10æ¬¡ï¼Œè¿™ä¸ªç±»å°†å¯¹åŒä¸€ä¸ªç¤ºä¾‹æ•°æ®åšé”™è¯¯çš„åˆ†é…ã€‚</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœºï¼ˆç¬¬å…«ç« ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539850321561e84aa1484b><p class=pgc-img-caption>å›¾54:åº”ç”¨ä¸€ä¸ªç®€å•çš„å¯å‘å¼é¿å…æ¨¡ç³Šå†³ç­–é—®é¢˜</p></div><p>ä¸€å¯¹å¤šæ–¹æ³•å¦ä¸€ä¸ªé—®é¢˜æ˜¯è®­ç»ƒé›†æ˜¯ä¸å‡è¡¡çš„(Bishop, 2006) ã€‚å¦‚æœä¸€ä¸ªé—®é¢˜æœ‰100ç±»ï¼Œæ¯ä¸ªç±»æœ‰10ä¸ªç¤ºä¾‹æ•°æ®ï¼Œæ¯ä¸€ä¸ªåˆ†ç±»å™¨å°†è¢«10ä¸ªæ­£å€¼ç¤ºä¾‹æ•°æ®å’Œ990ä¸ªè´Ÿå€¼ç¤ºä¾‹æ•°æ®è®­ç»ƒã€‚å› æ­¤ï¼Œè´Ÿå€¼ç¤ºä¾‹æ•°æ®å°†å¤§å¤§å½±å“å†³ç­–è¾¹ç¼˜ã€‚</p><p>å°½ç®¡å¦‚æ­¤ï¼Œä¸€å¯¹å¤šä»æ˜¯ä¸€ä¸ªæµè¡Œçš„å¤šç±»åˆ†ç±»æ–¹æ³•ï¼Œå› ä¸ºå®ƒå®¹æ˜“å®ç°å’Œç†è§£ã€‚</p><p><strong>æ³¨æ„ï¼š</strong>"[â€¦]å®é™…ä¸Šä¸€å¯¹å¤šæ–¹æ³•è¢«å¹¿æ³›ç”¨å°½ç®¡å®ƒæœ‰ç‰¹åˆ¶æ€§å’Œå®é™…å±€é™ã€‚" (Bishop, 2006)</p><p>å½“æˆ‘ä»¬ä½¿ç”¨çš„sklean,linearSVCè‡ªåŠ¨æœºæŠŠä¸€å¯¹å¤šä½œä¸ºé»˜è®¤ç­–ç•¥æ—¶ã€‚ä½ ä¹Ÿå¯ä»¥æ˜ç¡®æŒ‡å®šmulti_classå‚æ•°ä½¿ç”¨ovr(one-vs-the-rest),å¦‚ä»£ç è¡¨46æ‰€ç¤ºã€‚</p><pre>ä»£ç è¡¨46from sklearn.svm import LinearSVCimport numpy as npX = load_X()y = load_y()clf = LinearSVC(C=1000, random_state=88, multi_class='ovr')clf.fit(X,y)# Make predictions on two examples.X_to_predict = np.array([[5,5],[2,5]])print(clf.predict(X_to_predict)) # prints [2 1]</pre><p><strong>ä¸€å¯¹ä¸€(one-against-one)</strong></p><p>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬è¯•ç€å»æ‰¾åŒºåˆ†ä¸€ä¸ªç±»ä¸å¦ä¸€ä¸ªç±»æ¥ä»£æ›¿åŒºåˆ†ä¸€ä¸ªç±»ä¸æ‰€æœ‰çš„ç±»æ¥ä»£æ›¿ã€‚ç»“æœï¼Œæˆ‘ä»¬ç”¨æ¯å¯¹ç±»å»è¯•éªŒä¸€ä¸ªåˆ†ç±»å™¨ï¼Œä¼šå¯¼è‡´Kä¸ªç±»æœ‰K(K-1)/2ä¸ªåˆ†ç±»å™¨ã€‚æ¯ä¸€ä¸ªåˆ†ç±»å™¨è®­ç»ƒæ•°æ®å­é›†è€Œäº§ç”Ÿå®ƒè‡ªå·±çš„å†³ç­–è¾¹ç¼˜ï¼ˆå›¾ï¼‰ã€‚</p><p>é¢„æµ‹ä½¿ç”¨ä¸€ä¸ªç®€å•çš„æŠ•ç¥¨ç­–ç•¥ã€‚æ¯ä¸€ä¸ªå¸Œæœ›é¢„æµ‹çš„ç¤ºä¾‹é€šè¿‡æ¯ä¸€ä¸ªåˆ†ç±»å™¨åï¼Œè¿™ä¸ªé¢„æµ‹ç±»è¢«è®°å½•ä¸‹æ¥ã€‚ç„¶åï¼Œè¿™ä¸ªå…·æœ‰æœ€å¤šçš„ç¥¨æ•°çš„ç±»è¢«åˆ†é…ç»™ç¤ºä¾‹æ•°æ®ï¼ˆä»£ç è¡¨47)ã€‚</p><pre>ä»£ç è¡¨47from itertools import combinationsfrom scipy.stats import modefrom sklearn import svmimport numpy as np# Predict the class having the max number of votes.def predict_class(X, classifiers, class_pairs):predictions = np.zeros((X.shape[0], len(classifiers)))for idx, clf in enumerate(classifiers):class_pair = class_pairs[idx]prediction = clf.predict(X)predictions[:, idx] = np.where(prediction == 1,class_pair[0], class_pair[1])return mode(predictions, axis=1)[0].ravel().astype(int)X = load_X()y = load_y()# Create datasets.training_data = []class_pairs = list(combinations(set(y), 2))for class_pair in class_pairs:class_mask = np.where((y == class_pair[0]) | (y == class_pair[1]))y_i = np.where(y[class_mask] == class_pair[0], 1, -1)training_data.append((X[class_mask], y_i))# Train one classifier per class.classifiers = [] for data in training_data:clf = svm.SVC(kernel='linear', C=1000)clf.fit(data[0], data[1]) classifiers.append(clf)# Make predictions on two examples.X_to_predict = np.array([[5,5],[2,5]])print(predict_class(X_to_predict, classifiers, class_pairs))# prints [2 1]</pre><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœºï¼ˆç¬¬å…«ç« ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153985032202089454562c0><p class=pgc-img-caption>å›¾55:ä¸€å¯¹ä¸€ä¸ºæ‰€æœ‰åˆ†ç±»ä¸­çš„æ¯å¯¹ç±»æ„é€ ä¸€ä¸ªåˆ†ç±»å™¨</p></div><p>ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬ä»ç„¶è¦é¢ä¸´æ¨¡ç³Šåˆ†ç±»çš„é—®é¢˜ã€‚å¦‚æœä¸¤ä¸ªç±»æœ‰å®Œå…¨ç›¸åŒçš„ç¥¨æ•°ï¼Œç®—æ³•å»ºè®®é€‰æ‹©åºå·å°çš„å¯è¡Œçš„ï¼ˆä¸è§å¾—æ˜¯æœ€å¥½çš„ï¼‰ç­–ç•¥ï¼ˆHsu & Lin, A Comparison of Methods for Multi-class Support Vector Machines, 2002 ï¼‰ã€‚</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœºï¼ˆç¬¬å…«ç« ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/153985032213918acad5888><p class=pgc-img-caption>å›¾56: ä½¿ç”¨æŠ•ç¥¨æ¡†æ¶é¢„æµ‹</p></div><p>ä¸Šå›¾æ˜¾ç¤ºä¸€å¯¹ä¸€ç­–ç•¥ç”Ÿæˆçš„å†³ç­–åŒºåŸŸä¸ä¸€å¯¹å¤šæ‰€ç”Ÿæˆçš„ä¸åŒã€‚åœ¨å›¾57ä¸­ï¼Œæ³¨æ„ä¸€å¯¹ä¸€åˆ†ç±»å™¨æ‰€ç”Ÿæˆçš„åŒºåŸŸï¼ŒåŒºåŸŸçš„é¢œè‰²å˜åŒ–ä»…åœ¨è¶…å¹³é¢å†…ï¼ˆæ³¨æ„é»‘è‰²ç›´çº¿ï¼‰ï¼Œè¿™ä¸åŒäºä¸€å¯¹å¤šã€‚</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœºï¼ˆç¬¬å…«ç« ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15398503209016e5ae76a38><p class=pgc-img-caption>å›¾57:ä¸€å¯¹å¤šï¼ˆå·¦ï¼‰ä¸ä¸€å¯¹ä¸€ï¼ˆå³ï¼‰çš„å¯¹æ¯”</p></div><p>ä¸€å¯¹å¤šï¼ˆå·¦ï¼‰ä¸ä¸€å¯¹ä¸€ï¼ˆå³ï¼‰çš„å¯¹æ¯”ä¸€å¯¹ä¸€æ–¹æ³•æ˜¯sklearné»˜è®¤çš„å¤šç±»åˆ†ç±»æ–¹æ³•ã€‚ä½œä¸ºå–ä»£ä»£ç è¡¨47ï¼Œåœ¨ä»£ç è¡¨48ä¸­ä½ å°†å¾—åˆ°æ›´ç²¾ç¡®çš„åŒæ ·çš„ç»“æœã€‚</p><pre>ä»£ç è¡¨48from sklearn import svmimport numpy as npX = load_X()y = load_y()# Train a multi-class classifier.clf = svm.SVC(kernel='linear', C=1000)clf.fit(X,y)# Make predictions on two examples.X_to_predict = np.array([[5,5],[2,5]])print(clf.predict(X_to_predict)) # prints [2 1]</pre><p>ä¸€å¯¹å¤šæ–¹æ³•çš„æœ‰ä¸€ä¸ªä¸»è¦ç¼ºç‚¹æ˜¯åˆ†ç±»å™¨å®¹æ˜“è¶‹å‘è¿‡æ‹Ÿåˆã€‚ç„¶è€Œï¼Œå¤§é‡çš„ç±»ä¼šä½¿åˆ†ç±»å™¨çš„æ•°é‡è¶…çº¿æ€§å¢é•¿ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•åœ¨è§£å†³å¤§é—®é¢˜æ—¶å¿…ç„¶ä¼šå˜æ…¢(Platt, Cristianini, & Shawe-Taylor, 2000 )ã€‚</p><p><strong>DAGSVM</strong></p><p>DAGSVMçš„åå­—ä¸ºå•å‘æ— ç¯å›¾SVMï¼ˆDirected Acyclic Graph SVMï¼‰çš„ç¼©å†™ã€‚ç”±John Platt ç­‰åœ¨2000å¹´æå‡ºç”¨æ¥æå‡ä¸€å¯¹ä¸€æ–¹æ³•(Platt, Cristianini, & Shawe-Taylor, 2000) ã€‚</p><p>æ³¨æ„ï¼šJohn C. Platt å‘æ˜äº†SMOç®—æ³•å’Œæ™®æ‹‰ç‰¹æ ¡å‡†ç®—æ³•ï¼ˆPlatt Scaling)ï¼Œè¿˜æå‡ºäº†DAGSVMã€‚ç»™SVMsä½œå‡ºå·¨å¤§è´¡çŒ®ã€‚</p><p>DAGSVMèƒŒåçš„ç›®æ ‡æ˜¯ç”¨å’Œä¸€å¯¹ä¸€ç›¸åŒçš„è®­ç»ƒæ–¹æ³•ï¼Œä½†æ˜¯å®ƒç”¨å•å‘æ— ç¯å›¾ï¼ˆDAGï¼‰æ¥é€‰æ‹©å¯ç”¨åˆ†ç±»å™¨ä½¿æ£€æµ‹é€Ÿåº¦å¤§å¹…æé«˜ã€‚</p><p>å¦‚æœæˆ‘ä»¬æœ‰4ä¸ªç±»A,B,Cå’ŒD,åˆ™æ¯å¯¹ç±»ç»„åˆéœ€è¦å…­ä¸ªåˆ†ç±»å™¨ï¼š(A, B); (A, C); (A, D); (B, C); (B, D); å’Œ (C, D)ã€‚æˆ‘ä»¬å…ˆç”¨åˆ†ç±»å™¨ï¼ˆAï¼ŒDï¼‰ï¼Œå®ƒé¢„æµ‹ç±»Aï¼Œä¹Ÿå°±æ˜¯é¢„æµ‹éDçš„æ•°æ®ï¼Œæ¯äºŒä¸ªåˆ†ç±»å™¨åŒæ ·é¢„æµ‹A(éCï¼‰ã€‚å®ƒçš„æ„æ€æ˜¯åˆ†ç±»å™¨(B, D), (B, C) æˆ–è€… (C, D)å¯ä»¥ç•¥è¿‡ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»çŸ¥é“æ•°æ®ä¸ä¼šåœ¨ç±»Cæˆ–Dä¸­ã€‚æœ€åç”¨åˆ°åˆ†ç±»å™¨ï¼ˆAï¼ŒBï¼‰ï¼Œå¦‚æœæˆ‘ä»¬è¦é¢„æµ‹Bï¼Œæˆ‘ä»¬åˆ†é…æ•°æ®ç‚¹åˆ°ç±»Bã€‚è¿™ä¸ªç¤ºä¾‹çš„æŠ€å·§ç”¨çº¢è‰²è·¯å¾„æ ‡åœ¨å›¾58ä¸­ã€‚å›¾ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹è¡¨ç¤ºä¸€å¯¹ç±»ã€‚</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœºï¼ˆç¬¬å…«ç« ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1539850321030f96097e118><p class=pgc-img-caption>å›¾58:é¢„æµ‹è·¯å¾„æ˜¾ç¤ºä¸ºä¸€ä¸ªæœ‰å‘æ— ç¯å›¾</p></div><p>å››ä¸ªç±»ï¼Œæˆ‘ä»¬ç”¨ä¸‰ä¸ªåˆ†ç±»å™¨åšé¢„æµ‹ï¼Œä»£æ›¿ä¸€å¯¹ä¸€çš„å…­ä¸ªã€‚é€šå¸¸ï¼Œå¹³å‡Kä¸ªç±»å¯ç”¨K-1ä¸ªå†³ç­–èŠ‚ç‚¹ã€‚</p><p>æˆ‘ä»¬ç”¨ä»£ç è¡¨49æ¥å–ä»£ä»£ç è¡¨47çš„predict_class æ–¹æ³•å¯å¾—å‡ºåŒæ ·çš„ç»“æœï¼Œä½†æ˜¯å¥½å¤„æ˜¯å°‘ç”¨äº†å¾ˆå¤šåˆ†ç±»å™¨ã€‚</p><p>åœ¨ä»£ç è¡¨49ä¸­ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªListå®ç°äº†DAGSVMæ–¹æ³•ã€‚æˆ‘ä»¬ä»è¿™ä¸ªListä¸­çš„å¯ç”¨ç±»å¼€å§‹ï¼Œç»è¿‡æ¯ä¸€æ¬¡é¢„æµ‹ï¼Œæˆ‘ä»¬ç§»å»ä¸€äº›ä¸éœ€è¦çš„ã€‚æœ€åï¼Œç•™ä¸‹ä¸€ä¸ªç±»æ˜¯æˆ‘ä»¬è¦ç»™å®ƒåˆ†é…ç¤ºä¾‹æ•°æ®çš„ã€‚</p><p>æ³¨æ„ä»£ç è¡¨49,è¿™é‡Œæ˜¾ç¤ºçš„ä»£ç ä¸èƒ½ç”¨äºç”Ÿäº§ç¯å¢ƒï¼Œå› ä¸ºå½“æ•°æ®é›†ï¼ˆXï¼‰ç‰¹åˆ«å¤§æ—¶å®ƒä¼šå˜æ…¢ã€‚</p><pre>ä»£ç è¡¨49def predict_class(X, classifiers, distinct_classes, class_pairs):results = []for x_row in X:class_list = list(distinct_classes)# After each prediction, delete the rejected class# until there is only one class.while len(class_list) &gt; 1:# We start with the pair of the first and# last element in the list.class_pair = (class_list[0], class_list[-1])classifier_index = class_pairs.index(class_pair)y_pred = classifiers[classifier_index].predict(x_row)if y_pred == 1:class_to_delete = class_pair[1]else:class_to_delete = class_pair[0]class_list.remove(class_to_delete)results.append(class_list[0])return np.array(results)</pre><p><strong>æ³¨æ„ï¼š</strong>DAGSVMå¹³å‡æ¯”æŠ•ç¥¨æ–¹æ³•å¿«1.6åˆ°2.3å€ã€‚(Platt, Cristianini, & Shawe-Taylor, 2000) ã€‚</p><p><strong>è§£å•ç‹¬ä¼˜åŒ–é—®é¢˜</strong></p><p>ä¸æ˜¯è¯•ç€è§£å¤šä¸ªäºŒåˆ†é—®é¢˜ï¼Œè€Œæ˜¯å»è§£ä¸€ä¸ªå•ç‹¬ä¼˜åŒ–é—®é¢˜ï¼Œè¿™ä¸ªæ–¹æ³•è¿™äº›å¹´æ¥è¢«å¾ˆå¤šäººæå‡ºã€‚</p><p><strong>Vapnik, Weston, å’Œ Watkins</strong></p><p>è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ³›åŒ–çš„SVMsä¼˜åŒ–é—®é¢˜ç›´æ¥å»è§£å¤šç±»åˆ†ç±»é—®é¢˜ã€‚å®ƒä»¬è¢«Vapnik (Vapnik V. N., 1998) å’Œ Weston & Watkins (Weston & Watkins, 1999)ç‹¬ç«‹å‘ç°ã€‚å¯¹æ¯ä¸ªç±»ï¼Œå°±æ˜¯å¢åŠ çº¦æŸçš„ä¼˜åŒ–é—®é¢˜ã€‚ç»“æœï¼Œéšç€ç±»çš„å¢åŠ é—®é¢˜çš„æ•°é‡ä¹Ÿæˆæ¯”ä¾‹å¢åŠ å¯¼è‡´è®­ç»ƒè¶Šæ¥è¶Šæ…¢ã€‚</p><p><strong>Crammer å’Œ Singer</strong></p><p>Crammer å’Œ Singer (C&S) æå‡ºå¦ä¸€å¯ç”¨çš„å¤šç±»SVMsæ–¹æ³•ã€‚å¦‚åŒWeston å’Œ Watkinsï¼Œä»–ä»¬è§£å•ç‹¬ä¼˜åŒ–é—®é¢˜ç”¨åˆ°äº†å¤ªå¤šçš„æ–¯è±å…‹(slack)å˜é‡(Crammer & Singer, 2001)ã€‚ è¿™ä¸ªæ–¹æ³•ä¼˜ç‚¹æ˜¯èƒ½å‡å°‘å†…å­˜çš„å ç”¨å’Œè®­ç»ƒæ—¶é—´ï¼Œç„¶è€Œï¼Œæ¯”è¾ƒè¿™ä¸¤ç§ç®—æ³•ï¼ŒHsu å’ŒLinå‘ç°å½“æ­£äº¤å‚æ•°Cçš„å€¼è¾ƒå¤§æ—¶C&S æ–¹æ³•ç‰¹åˆ«æ…¢(Hsu & Lin, A Comparison of Methods for Multi-class Support Vector Machines, 2002) ã€‚</p><p>åœ¨sklearé‡Œï¼Œå½“ç”¨åˆ°LinearSVC æ—¶ä½ å¯ä»¥é€‰æ‹©C&Sç®—æ³•ï¼ˆå¦‚ä»£ç è¡¨50æ‰€ç¤ºï¼‰ã€‚åœ¨å›¾59ä¸­ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°C&Sé¢„æµ‹ä¸åŒäºä¸€å¯¹å¤šå’Œä¸€å¯¹ä¸€æ–¹æ³•ã€‚</p><pre>ä»£ç è¡¨50from sklearn import svmimport numpy as npX = load_X()y = load_y()clf = svm.LinearSVC(C=1000, multi_class='crammer_singer')clf.fit(X,y)# Make predictions on two examples.X_to_predict = np.array([[5,5],[2,5]])print(clf.predict(X_to_predict)) # prints [4 1]</pre><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœºï¼ˆç¬¬å…«ç« ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1539850321144026aca8f86><p class=pgc-img-caption>å›¾59: Crammer&Singerç®—æ³•é¢„æµ‹</p></div><p><strong>ä½ å°†è¦ç”¨é‚£ä¸€ç§æ–¹æ³•å‘¢ï¼Ÿ</strong></p><p>å¯¹äºè¿™ä¹ˆå¤šçš„å¯é€‰é¡¹ï¼Œé€‰æ‹©å“ªä¸€ä¸ªå¤šç±»æ–¹æ³•æ¯”è¾ƒé€‚åˆä½ çš„é—®é¢˜æ˜¯å› éš¾çš„ã€‚</p><p>Hsuå’ŒLinå†™äº†ä¸€ä¸ªä¸é”™çš„æ–‡ç« ä»‹ç»ä¸åŒçš„SVMsçš„å¤šç±»æ–¹æ³•(Hsu & Lin, A Comparison of Methods for Multi-class Support Vector Machines, 2002)ã€‚å®ƒä»¬åˆ¤æ–­ä¸€å¯¹ä¸€å’ŒDAGæ–¹æ³•æ¯”å…¶ä»–æ–¹æ³•è¦é€‚ç”¨å’Œå®ç”¨ã€‚å¢å¼ºçš„ä¸€å¯¹ä¸€æ–¹æ³•åœ¨sklearnä¸­å¯ç”¨ï¼Œæ‰€ä»¥å®ƒå¯èƒ½æ˜¯ä½ é»˜è®¤çš„é€‰æ‹©ã€‚</p><p>è¯·è®°ä½åœ¨linearSVCä¸­é»˜è®¤ä½¿ç”¨ä¸€å¯¹å¤šæ–¹æ³•ï¼Œä¹Ÿè®¸ç”¨Crammer&Singerç®—æ³•èƒ½æ›´å¥½çš„å¸®ä½ è¾¾åˆ°ç›®çš„ã€‚åŸºäºè¿™ä¸ªä¸»é¢˜ï¼ŒDoganç­‰å‘ç°å°½ç®¡æ¯”å…¶ä»–ç®—æ³•è¦å¿«ï¼Œä½†æ˜¯ä¸€å¯¹å¤šå‡è®¾å‡½æ•°åœ¨ç»Ÿè®¡å­¦ä¸Šç²¾ç¡®åº¦æ˜æ˜¾æ›´å·®(Dogan, Glasmachers, & Igel, 2011) ã€‚è¡¨1å±•ç¤ºäº†è¿™ä¸€ç« ä¸­çš„æ–¹æ³•çš„ç®€ä»‹å¸Œæœ›èƒ½å¸®ä½ åšå‡ºé€‰æ‹©ã€‚</p><p>è¡¨1: å¤šç±»SVMæ–¹æ³•ç®€ä»‹</p><div class=pgc-img><img alt=æ”¯æŒå‘é‡æœºï¼ˆç¬¬å…«ç« ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15398507268045b34b38b7d><p class=pgc-img-caption></p></div><p><strong>å°ç»“</strong></p><p>æ„Ÿè°¢è¿™äº›å¹´æ¥ä¼—å¤šçš„æ”¹è¿›ï¼Œç°åœ¨æœ‰å¤§é‡çš„æ–¹æ³•ç”¨æ¥ç»™SVMsåšå¤šç±»åˆ†ç±»ã€‚æ¯ä¸€ä¸ªæ–¹æ³•æœ‰ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œä½ ä½¿ç”¨ç±»åº“ä¸­çš„æ–¹æ³•ï¼Œå®ƒä»¬ç»å¤§éƒ¨ä»½éƒ½å¯ä»¥åœ¨æœ‰æ•ˆçš„æ—¶é—´ç»“æŸã€‚ç„¶è€Œï¼Œæœ‰å¿…è¦ï¼Œä½ ç°åœ¨çŸ¥é“å“ªä¸€ä¸ªæ–¹æ³•èƒ½æ›´å¥½çš„è§£å†³ä½ çš„ç‹¬ç‰¹é—®é¢˜ã€‚</p><p>å¤šç±»SVMsçš„ç ”ç©¶è¿˜æ²¡æœ‰ç»“æŸã€‚æœ€è¿‘çš„ç ”ç©¶é›†ä¸­åœ¨åˆ†å¸ƒå¼è®­ç»ƒã€‚ä¾‹å¦‚ï¼ŒHan & Berg å‘å¸ƒäº†ä¸€ä¸ªæ–°ç®—æ³•å«åšå¤šç±»åˆ†å¸ƒå¼ç»Ÿä¸€ä¼˜åŒ–SVMï¼ˆDistributed Consensus Multiclass SVMï¼‰ ï¼Œå®ƒæ˜¯Crammer å’Œ Singerå…¬å¼çš„å˜å½¢ç”¨æ¥ç»Ÿä¸€ä¼˜åŒ–ã€‚</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'ç¬¬å…«ç« ','å‘é‡','æ”¯æŒ'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>