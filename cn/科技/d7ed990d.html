<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>简明数据科学 第六部分：模型选择方法 | 极客快訊</title><meta property="og:title" content="简明数据科学 第六部分：模型选择方法 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/153232778498898c7333901"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d7ed990d.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d7ed990d.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d7ed990d.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d7ed990d.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d7ed990d.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d7ed990d.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d7ed990d.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d7ed990d.html><meta property="article:published_time" content="2020-11-14T21:02:25+08:00"><meta property="article:modified_time" content="2020-11-14T21:02:25+08:00"><meta name=Keywords content><meta name=description content="简明数据科学 第六部分：模型选择方法"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/d7ed990d.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>简明数据科学 第六部分：模型选择方法</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><div class=pgc-img><img alt="简明数据科学 第六部分：模型选择方法" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/153232778498898c7333901><p class=pgc-img-caption></p></div><p>作者丨Pradeep Menon</p><p>原文丨 https://towardsdatascience.com/data-science-simplified-part-6-model-selection-methods-2511cbdf7cb0</p><p>译者丨TalkingData 张永超</p><p>在上一篇（本系列其他文章见文末）文章中，我们介绍了多元回归模型，费尔南多构建了一个多元线性回归模型，接受五个参数来预测汽车的价格。</p><div class=pgc-img><img alt="简明数据科学 第六部分：模型选择方法" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153232776094262e71809b3><p class=pgc-img-caption></p></div><p>从最后的结果来看，费尔南多的确构建了一个很好的模型，但是他还想选择出最佳的输入参数。那么这篇文章我们将讨论模型的选择方法。</p><p>基本概念</p><p>模型选择方法的思路其实比较直观，只要回答了下面的问题即可：</p><p>如何为最优模型选择正确的输入变量？</p><p>开始之前，我们需要了解如何定义最佳模型？</p><div class=pgc-img><img alt="简明数据科学 第六部分：模型选择方法" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/153232776091224902898f5><p class=pgc-img-caption></p></div><p>最佳模型是适合评估指标最佳值的数据模型。</p><p>模型的评估有很好的指标，而调整R平方是多元回归模型的最好评价指标。</p><p>对于选择最佳参数集来说，有三种方法，他们是：</p><p>最佳子集法 前向逐步选择法 后向逐步选择法</p><p>接下来分别对这三种方法进行介绍。</p><div class=pgc-img><img alt="简明数据科学 第六部分：模型选择方法" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/15323277610277412548d96><p class=pgc-img-caption></p></div><p>如上图所示，假设我们有k个变量，那么最佳子集法的过程如下：</p><ol><li>从空模型开始，即没有预测器的模型，我们称之为M0；</li><li>用1个变量找出最佳模型，此时，该模型是一个简单的单一变量回归模型，只有一个独立变量，称之为M1；</li><li>用2个变量找出最佳模型，该模型是一个只有两个独立变量的回归模型，称之为M2；</li><li>用2个变量找出最佳模型，该模型是一个有三个独立变量的回归模型，称之为M3；</li><li>重复这些步骤，只到找出最佳模型的所有预测变量的组合。 对于k个变量，我们需要从下面的模型中找出一组表现最佳的模型：</li></ol><ul><li>M1： 具有1个预测器的最优模型；</li><li>M2： 具有2个预测器的最优模型；</li><li>M3： 具有3个预测器的最优模型；</li><li>Mk： 具有k个预测器的最优模型。</li></ul><p>然后选择M1…Mk中最优的模型，也就是最适合的模型。 最佳子集法是一个复杂的处理过程，不仅需要梳理了预测变量的列表，而且还需要选择最佳的变量组合。最佳子集法虽然看似简单，但是它有着子集的困难和挑战。</p><p>最佳子集法为每个预测变量及其组合创建一个模型，这意味着我们正在为每个变量组合创建模型。模型的数量可以是一个非常大的数字。</p><p>如果有2个变量，那么有4个可能的模型，如果有3个变量，那么有8个可能的模型。一般来说，如果有p个变量，那么就有2 ^ p个可能的模型，这是相当多的模型可供选择。想象一下，有100个变量（很常见）。将会有2 ^ 100个可能的模型。令人难以置信的数字。</p><p>在费尔南多的情况下，只有5个变量，他将不得不创造和选择2 ^ 5个模型，即32个不同的模型。</p><p>向前逐步选择法</p><div class=pgc-img><img alt="简明数据科学 第六部分：模型选择方法" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/153232776108347a5c6e3a2><p class=pgc-img-caption></p></div><p>至此，对最佳子集法已经有了一个了解了，但是它需要很多的计算能力，也相对比较耗时，而前向逐步选择法试图环节这种困难。</p><p>依然，假设我们有k个变量，则逐步前进选择法的步骤如下：</p><ol><li>从空模型开始，即没有预测器的模型，我们称之为M0。将预测变量添加到模型中，一次仅添加一个；</li><li>用1个变量找出最佳模型，此时，该模型是一个简单的单一变量回归模型，只有一个独立变量，称之为M1；</li><li>在M1的基础上，增加一个变量，用2个变量找出最佳模型，称之为M2；</li><li>在M2的基础上，增加一个变量，用3个变量找出最佳模型，称之为M3；</li><li>重复这些步骤，只到找出最佳模型Mk，即有k个变量的模型。</li></ol><p>对于k个变量，我们需要从以下一组模型中选择最优模型：</p><ul><li>M1： 具有1个预测器的最优模型；</li><li>M2： 具有2个预测器的最优模型，该模型是M1 + 一个额外的变量；</li><li>M3： 具有3个预测器的最优模型，该模型是M2 + 一个额外的变量；</li><li>Mk： 具有k个预测器的最优模型，该模型是Mk-1 + 一个额外的变量。</li></ul><p>再次选择M1 …</p><p>Mk中的最佳模型，即具有最佳拟合的模型</p><p>与最佳子集法相比，前向逐步选择法法创建更少的模型。如果有p个变量，那么将会有大约p（p + 1）/ 2 + 1个模型可供选择，远低于最佳子集方法中的模型选择。假设有100个变量，则基于前向逐步法创建的模型的数量是100×101/2 + 1，即5051个模型。</p><p>在费尔南多的情况下，只有5个变量，他将不得不创建和选择5 6/2 + 1*模型，即16个不同的模型。</p><p>后向逐步选择法</p><div class=pgc-img><img alt="简明数据科学 第六部分：模型选择方法" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15323277609758e6a1cb7b1><p class=pgc-img-caption></p></div><p>现在我们已经理解了模型选择的前向逐步选择过程，接下来看看后向逐步选择法，这是前向逐步选择法的反向。前向逐步选择从没有变量的模型即空模型开始，相比之下，后向逐步选择是从所有变量开始的。后向逐步选择法的过程如下：</p><p>假设我们有k个变量，则逐步前进选择法的步骤如下：</p><ol><li>从一个完整的模型开始，即包含所有预测变量的模型，我们称这个模型为Mk。从完整模型中删除预测变量。一次一个；</li><li>用k-1个变量找出最优模型，从Mk中删除一个变量。计算所有可能组合模型的性能。选择具有k-1个变量的最佳模型。我们称这个模型为Mk-1；</li><li>用k-2个变量找到最优模型，从Mk-1中删除一个变量。计算所有可能组合模型的性能。选择具有k-2个变量的最佳模型。我们称这个模型为Mk-2；</li><li>重复这些步骤，只到找出最佳模型M1，即有1个变量的模型。</li></ol><p>对于k个变量，我们需要从以下一组模型中选择最优模型：</p><ul><li>Mk：具有k个预测值的最优模型；</li><li>Mk-1：具有k-1个预测变量的最优模型。这个模型是 MK - 一个额外的变量；</li><li>Mk-2：具有k-2个预测变量的最优模型。这个模型是 MK - 两个额外的变量；</li><li>M1：具有1个预测器的最优模型。</li></ul><p>模型构建</p><p>了解了模型选择的方法之后，让我们回到费尔南多的问题，回想一下前一篇文章，费尔南多有6个变量发动机大小，马力，峰值RPM，长度，宽度和高度，他想通过创建一个多元回归模型来估算汽车价格。他想保持模型的平衡并选择最佳的模式。</p><p>于是，费尔南多准备使用前向逐步选择法，统计软件包计算出了所有可能的模型以及输出M1到M6的结果。</p><div class=pgc-img><img alt="简明数据科学 第六部分：模型选择方法" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15323277612643b47d116f4><p class=pgc-img-caption></p></div><p>让我们解释上述结果：</p><ul><li>Model 1：只有一个预测器，仅使用发动机的大小作为变量，调整的R平方为0.77；</li><li>Model 2：仅有两个预测器，使用发动机大小和马力作为变量，调整的R平方为0.79；</li><li>Model 3：仅有三个预测器，使用发动机大小、马力和宽度作为变量，调整的R平方为0.82；</li><li>Model 4：仅有四个预测器，使用发动机大小、马力、宽度和高度作为变量，调整的R平方为0.82；</li><li>Model 5：仅有五个预测器，使用发动机大小、马力、宽度、高度和峰值RPM作为变量，调整的R平方为0.82；</li><li>Model 6：仅有六个预测器，使用发动机大小、马力、宽度、高度、高度和峰值RPM作为变量，调整的R平方为0.82。</li></ul><p>最终，费尔南多选择了最好的、最简单的模型。在上述结果中，Model 3 使用发动机大小、马力和宽度作为变量，该模型能够得到0.82的调整R平方，即说明该模型可以解释82%的训练数据变化，其他Model 4、5、6虽然使用了更多的变量，但是得到的调整R平方依然是0.82，相对于Model 3却更加的复杂。</p><p>在费尔南多的统计软件包中，同样输出了如下的系数结果：</p><div class=pgc-img><img alt="简明数据科学 第六部分：模型选择方法" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1532327761234507a7880ac><p class=pgc-img-caption></p></div><p>根据发动机尺寸，马力和宽度估算价格。</p><p>价格 = -55089.98 + 87.34 发动机大小 + 60.93 马力+ 770.42 * 宽度</p><p>模型评估</p><p>费尔南多选择了最好的模型，该模型将使用发动机尺寸，马力和汽车宽度估算价格。他希望评估模型在训练和测试数据上的表现。</p><p>之前，他已经将数据分成了训练集和测试集，费尔南多使用训练数据训练模型，对于模型来说此时测试数据是不可见的数据。费尔南多评估模型在测试数据上的表现。</p><div class=pgc-img><img alt="简明数据科学 第六部分：模型选择方法" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153232776137013d9c9abd2><p class=pgc-img-caption></p></div><p>在训练数据上，模型表现相当好,调整的R平方为0.815，说明该模型可以解释81％的训练数据变化。但是，对于该模型来说，在测试数据集上的表现更为重要。</p><div class=pgc-img><img alt="简明数据科学 第六部分：模型选择方法" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1532327761230c120b33cc7><p class=pgc-img-caption></p></div><p>费尔南多测试了模型在测试数据集上的表现性能，得到该模型在测试数据中的调整的R平方为0.7984。这意味着即使对于看不见的数据，模型也可以解释79.84％的变化。</p><p>结语</p><p>现在，费尔南多有了一个简单而且有效的模型来预测汽车的价格。但是，发动机大小，马力和宽度的单位是不同的。于是他想到了如下的几个问题：</p><p>如何使用常见的比较单位来估算价格变化？</p><p>关于发动机尺寸、马力和宽度的对应价格有多少弹性变化？</p><p>下一篇文章我们将讨论转换多元回归模型以及计算弹性的方法。</p><p>相关阅读：</p><p>简明数据科学 第一部分：原则与过程</p><p>简明数据科学 第二部分：统计学习的关键概念</p><p>简明数据科学第三部分：假设检验</p><p>简明数据科学 第四部分：简单线性回归模型</p><p>简明数据科学 第五部分：多元回归模型</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'简明','数据','科学'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>