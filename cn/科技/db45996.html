<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>java æ‰‹å†™å¹¶å‘æ¡†æ¶ï¼ˆä¸€ï¼‰å¼‚æ­¥æŸ¥è¯¢è½¬åŒæ­¥çš„7ç§å®ç°æ–¹å¼ | æå®¢å¿«è¨Š</title><meta property="og:title" content="java æ‰‹å†™å¹¶å‘æ¡†æ¶ï¼ˆä¸€ï¼‰å¼‚æ­¥æŸ¥è¯¢è½¬åŒæ­¥çš„7ç§å®ç°æ–¹å¼ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/tos-cn-i-k3u1fbpfcp/1d3022027b8243cabafea485206c0cbe"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/db45996.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/db45996.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/db45996.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/db45996.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/db45996.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/db45996.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/db45996.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/db45996.html><meta property="article:published_time" content="2020-10-29T20:59:18+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:18+08:00"><meta name=Keywords content><meta name=description content="java æ‰‹å†™å¹¶å‘æ¡†æ¶ï¼ˆä¸€ï¼‰å¼‚æ­¥æŸ¥è¯¢è½¬åŒæ­¥çš„7ç§å®ç°æ–¹å¼"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/db45996.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>java æ‰‹å†™å¹¶å‘æ¡†æ¶ï¼ˆä¸€ï¼‰å¼‚æ­¥æŸ¥è¯¢è½¬åŒæ­¥çš„7ç§å®ç°æ–¹å¼</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right><strong>åºè¨€</strong></h1><p>æœ¬èŠ‚å°†å­¦ä¹ ä¸€ä¸‹å¦‚ä½•å®ç°å¼‚æ­¥æŸ¥è¯¢è½¬åŒæ­¥çš„æ–¹å¼ï¼Œå…±è®¡ä»‹ç»äº† 7 ç§å¸¸è§çš„å®ç°æ–¹å¼ã€‚</p><p>æ€ç»´å¯¼å›¾å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt="java æ‰‹å†™å¹¶å‘æ¡†æ¶ï¼ˆä¸€ï¼‰å¼‚æ­¥æŸ¥è¯¢è½¬åŒæ­¥çš„7ç§å®ç°æ–¹å¼" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/tos-cn-i-k3u1fbpfcp/1d3022027b8243cabafea485206c0cbe><p class=pgc-img-caption></p></div><p><span style="color:#888;--tt-darkmode-color: #888888">æ€ç»´å¯¼å›¾</span></p><h1 class=pgc-h-arrow-right><strong>å¼‚æ­¥è½¬åŒæ­¥</strong></h1><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">ä¸šåŠ¡éœ€æ±‚</span></span></strong></h1><p>æœ‰äº›æ¥å£æŸ¥è¯¢åé¦ˆç»“æœæ˜¯å¼‚æ­¥è¿”å›çš„ï¼Œæ— æ³•ç«‹åˆ»è·å–æŸ¥è¯¢ç»“æœã€‚</p><p>æ¯”å¦‚ä¸šåŠ¡å¼€å‘ä¸­æˆ‘ä»¬è°ƒç”¨å…¶ä»–ç³»ç»Ÿï¼Œä½†æ˜¯ç»“æœçš„è¿”å›ç¡®å®é€šçŸ¥çš„ã€‚</p><p>æˆ–è€… rpc å®ç°ä¸­ï¼Œclient è°ƒç”¨ server ç«¯ï¼Œç»“æœä¹Ÿæ˜¯å¼‚æ­¥è¿”å›çš„ï¼Œé‚£ä¹ˆå¦‚ä½•åŒæ­¥è·å–è°ƒç”¨ç»“æœå‘¢ï¼Ÿ</p><ul><li>æ­£å¸¸å¤„ç†é€»è¾‘</li></ul><p>è§¦å‘å¼‚æ­¥æ“ä½œï¼Œç„¶åä¼ é€’ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ã€‚</p><p>ç­‰åˆ°å¼‚æ­¥ç»“æœè¿”å›ï¼Œæ ¹æ®ä¼ å…¥çš„å”¯ä¸€æ ‡è¯†ï¼ŒåŒ¹é…æ­¤æ¬¡ç»“æœã€‚</p><ul><li>å¦‚ä½•è½¬æ¢ä¸ºåŒæ­¥</li></ul><p>æ­£å¸¸çš„åº”ç”¨åœºæ™¯å¾ˆå¤šï¼Œä½†æ˜¯æœ‰æ—¶å€™ä¸æƒ³åšæ•°æ®å­˜å‚¨ï¼Œåªæ˜¯æƒ³ç®€å•è·å–è°ƒç”¨ç»“æœã€‚</p><p>å³æƒ³è¾¾åˆ°åŒæ­¥æ“ä½œçš„ç»“æœï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">æ€è·¯</span></span></strong></h1><ol start=1><li>å‘èµ·å¼‚æ­¥æ“ä½œ</li><li>åœ¨å¼‚æ­¥ç»“æœè¿”å›ä¹‹å‰ï¼Œä¸€ç›´ç­‰å¾…(å¯ä»¥è®¾ç½®è¶…æ—¶)</li><li>ç»“æœè¿”å›ä¹‹åï¼Œå¼‚æ­¥æ“ä½œç»“æœç»Ÿä¸€è¿”å›</li></ol><h1 class=pgc-h-arrow-right><strong>å¸¸è§çš„å®ç°æ–¹å¼</strong></h1><ul><li>å¾ªç¯ç­‰å¾…</li><li>wait & notify</li><li>ä½¿ç”¨æ¡ä»¶é”</li><li>ä½¿ç”¨ CountDownLatch</li><li>ä½¿ç”¨ CyclicBarrier</li><li>Future</li><li>Spring EventListener</li></ul><p>ä¸‹é¢æˆ‘ä»¬ä¸€èµ·æ¥å­¦ä¹ ä¸‹è¿™å‡ ç§å®ç°æ–¹å¼ã€‚</p><h1 class=pgc-h-arrow-right><strong>å¾ªç¯ç­‰å¾…</strong></h1><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">è¯´æ˜</span></span></strong></h1><p>å¾ªç¯ç­‰å¾…æ˜¯æœ€ç®€å•çš„ä¸€ç§å®ç°æ€è·¯ã€‚</p><p>æˆ‘ä»¬è°ƒç”¨å¯¹æ–¹ä¸€ä¸ªè¯·æ±‚ï¼Œåœ¨æ²¡æœ‰ç»“æœä¹‹å‰ä¸€ç›´å¾ªç¯æŸ¥è¯¢å³å¯ã€‚</p><p>è¿™ä¸ªç»“æœå¯ä»¥åœ¨å†…å­˜ä¸­ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨ redis ç¼“å­˜æˆ–è€… mysql ç­‰æ•°æ®åº“ä¸­ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">ä»£ç å®ç°</span></span></strong></h1><h1 class=pgc-h-arrow-right><strong>å®šä¹‰æŠ½è±¡çˆ¶ç±»</strong></h1><p>ä¸ºäº†ä¾¿äºåé¢çš„å…¶ä»–å‡ ç§å®ç°æ–¹å¼ç»Ÿä¸€ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰ä¸€ä¸ªæŠ½è±¡çˆ¶ç±»ã€‚</p><pre><code>/**Â *Â æŠ½è±¡æŸ¥è¯¢çˆ¶ç±»Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ abstractÂ classÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(AbstractQuery.class);Â Â Â Â protectedÂ StringÂ result;Â Â Â Â publicÂ voidÂ asyncToSync()Â {Â Â Â Â Â Â Â Â startQuery();Â Â Â Â Â Â Â Â newÂ Thread(newÂ Runnable()Â {Â Â Â Â Â Â Â Â Â Â Â Â publicÂ voidÂ run()Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â remoteCall();Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â }).start();Â Â Â Â Â Â Â Â endQuery();Â Â Â Â }Â Â Â Â protectedÂ voidÂ startQuery()Â {Â Â Â Â Â Â Â Â log.info("å¼€å§‹æŸ¥è¯¢...");Â Â Â Â }Â Â Â Â /**Â Â Â Â Â *Â è¿œç¨‹è°ƒç”¨Â Â Â Â Â */Â Â Â Â protectedÂ voidÂ remoteCall()Â {Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â log.info("è¿œç¨‹è°ƒç”¨å¼€å§‹");Â Â Â Â Â Â Â Â Â Â Â Â TimeUnit.SECONDS.sleep(5);Â Â Â Â Â Â Â Â Â Â Â Â resultÂ =Â "success";Â Â Â Â Â Â Â Â Â Â Â Â log.info("è¿œç¨‹è°ƒç”¨ç»“æŸ");Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â log.error("è¿œç¨‹è°ƒç”¨å¤±è´¥",Â e);Â Â Â Â Â Â Â Â }Â Â Â Â }Â Â Â Â /**Â Â Â Â Â *Â æŸ¥è¯¢ç»“æŸÂ Â Â Â Â */Â Â Â Â protectedÂ voidÂ endQuery()Â {Â Â Â Â Â Â Â Â log.info("å®ŒæˆæŸ¥è¯¢ï¼Œç»“æœä¸ºï¼š"Â +Â result);Â Â Â Â }}</code></pre><h1 class=pgc-h-arrow-right><strong>ä»£ç å®ç°</strong></h1><p>å®ç°è¿˜æ˜¯éå¸¸ç®€å•çš„ï¼Œåœ¨æ²¡æœ‰ç»“æœä¹‹å‰ä¸€ç›´å¾ªç¯ã€‚</p><p><span style="color:#ef7060;--tt-darkmode-color: #EF7060">TimeUnit.MILLISECONDS.sleep(10);</span> è¿™é‡Œå¾ªç¯ç­‰å¾…çš„å°ç¡ä¸€ä¼šå„¿æ˜¯æ¯”è¾ƒé‡è¦çš„ï¼Œé¿å… cpu é£™å‡ï¼Œä¹Ÿå¯ä»¥é™ä½ä¸º 1msï¼Œæ ¹æ®è‡ªå·±çš„ä¸šåŠ¡è°ƒæ•´å³å¯ã€‚</p><pre><code>/**Â *Â å¾ªç¯ç­‰å¾…Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ classÂ LoopQueryÂ extendsÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(LoopQuery.class);Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ endQuery()Â {Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â whileÂ (StringUtil.isEmpty(result))Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //å¾ªç¯ç­‰å¾…ä¸€ä¸‹Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TimeUnit.MILLISECONDS.sleep(10);Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â Â Â Â Â //è·å–ç»“æœÂ Â Â Â Â Â Â Â Â Â Â Â log.info("å®ŒæˆæŸ¥è¯¢ï¼Œç»“æœä¸ºï¼š"Â +Â result);Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â }}</code></pre><h1 class=pgc-h-arrow-right><strong>æµ‹è¯•</strong></h1><pre><code>LoopQueryÂ loopQueryÂ =Â newÂ LoopQuery();loopQuery.asyncToSync();</code></pre><ul><li>æ—¥å¿—</li></ul><pre><code>[INFO]Â [2020-10-08Â 09:50:43.330]Â [main]Â [c.g.h.s.t.d.AbstractQuery.startQuery]Â -Â å¼€å§‹æŸ¥è¯¢...[INFO]Â [2020-10-08Â 09:50:43.331]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â è¿œç¨‹è°ƒç”¨å¼€å§‹[INFO]Â [2020-10-08Â 09:50:48.334]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â è¿œç¨‹è°ƒç”¨ç»“æŸ[INFO]Â [2020-10-08Â 09:50:48.343]Â [main]Â [c.g.h.s.t.d.LoopQuery.endQuery]Â -Â å®ŒæˆæŸ¥è¯¢ï¼Œç»“æœä¸ºï¼šsuccess</code></pre><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°è¿œç¨‹è°ƒç”¨æ˜¯ <span style="color:#ef7060;--tt-darkmode-color: #EF7060">Thread-0</span> çº¿ç¨‹æ‰§è¡Œçš„ï¼Œè¿œç¨‹è°ƒç”¨çš„è€—æ—¶ä¸º 5Sã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">è¶…æ—¶ç‰¹æ€§</span></span></strong></h1><h1 class=pgc-h-arrow-right><strong>ä¸ºä»€ä¹ˆéœ€è¦è¶…æ—¶æ—¶é—´</strong></h1><p>ä¸Šé¢çš„å®ç°å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯å¾ªç¯ç­‰å¾…æ²¡æœ‰è¶…æ—¶æ—¶é—´ã€‚</p><p>æˆ‘ä»¬çš„ä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼Œå¯èƒ½å­˜åœ¨å¤±è´¥ï¼Œä¹Ÿå¯èƒ½å¯¹æ–¹æ”¶åˆ°è¯·æ±‚ä¹‹åæ²¡æœ‰æ­£ç¡®å¤„ç†ã€‚</p><p>æ‰€ä»¥å¦‚æœæˆ‘ä»¬ä¸€ç›´ç­‰å¾…ï¼Œå¯èƒ½æ°¸è¿œä¹Ÿæ²¡æœ‰ç»“æœï¼Œæˆ–è€…å¾ˆä¹…ä¹‹åæ‰æœ‰ç»“æœã€‚è¿™åœ¨ä¸šåŠ¡ä¸Šæ˜¯ä¸å¯å¿å—çš„ï¼Œæ‰€ä»¥éœ€è¦æ·»åŠ ä¸€ä¸ªè¶…æ—¶æ—¶é—´ã€‚</p><h1 class=pgc-h-arrow-right><strong>ä»£ç å®ç°</strong></h1><pre><code>/**Â *Â å¾ªç¯ç­‰å¾…-åŒ…å«è¶…æ—¶æ—¶é—´Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ classÂ LoopTimeoutQueryÂ extendsÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(LoopTimeoutQuery.class);Â Â Â Â /**Â Â Â Â Â *Â è¶…æ—¶æ—¶é—´Â Â Â Â Â */Â Â Â Â privateÂ longÂ timeoutMillsÂ =Â 3000;Â Â Â Â publicÂ LoopTimeoutQuery()Â {Â Â Â Â }Â Â Â Â publicÂ LoopTimeoutQuery(longÂ timeoutMills)Â {Â Â Â Â Â Â Â Â this.timeoutMillsÂ =Â timeoutMills;Â Â Â Â }Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ endQuery()Â {Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â finalÂ longÂ endTimeMillsÂ =Â System.currentTimeMillis()Â +Â timeoutMills;Â Â Â Â Â Â Â Â Â Â Â Â whileÂ (StringUtil.isEmpty(result))Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â è¶…æ—¶åˆ¤æ–­Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if(System.currentTimeMillis()Â &gt;=Â endTimeMills)Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â throwÂ newÂ RuntimeException("è¯·æ±‚è¶…æ—¶");Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //å¾ªç¯ç­‰å¾…ä¸€ä¸‹Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TimeUnit.MILLISECONDS.sleep(10);Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â Â Â Â Â //è·å–ç»“æœÂ Â Â Â Â Â Â Â Â Â Â Â log.info("å®ŒæˆæŸ¥è¯¢ï¼Œç»“æœä¸ºï¼š"Â +Â result);Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â }}</code></pre><h1 class=pgc-h-arrow-right><strong>æµ‹è¯•</strong></h1><pre><code>LoopTimeoutQueryÂ loopQueryÂ =Â newÂ LoopTimeoutQuery();loopQuery.asyncToSync();</code></pre><p>æ—¥å¿—å¦‚ä¸‹ï¼š</p><pre><code>[INFO]Â [2020-10-08Â 10:04:58.091]Â [main]Â [c.g.h.s.t.d.AbstractQuery.startQuery]Â -Â å¼€å§‹æŸ¥è¯¢...[INFO]Â [2020-10-08Â 10:04:58.092]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â è¿œç¨‹è°ƒç”¨å¼€å§‹ExceptionÂ inÂ threadÂ "main"Â java.lang.RuntimeException:Â è¯·æ±‚è¶…æ—¶Â atÂ com.github.houbb.sync.test.demo.LoopTimeoutQuery.endQuery(LoopTimeoutQuery.java:38)Â atÂ com.github.houbb.sync.test.demo.AbstractQuery.asyncToSync(AbstractQuery.java:26)Â atÂ com.github.houbb.sync.test.demo.LoopTimeoutQuery.main(LoopTimeoutQuery.java:55)[INFO]Â [2020-10-08Â 10:05:03.097]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â è¿œç¨‹è°ƒç”¨ç»“æŸ</code></pre><p>è¶…æ—¶æ—¶é—´æ˜¯å¯ä»¥è®¾å®šçš„ï¼Œå¹³æ—¶å¼€å‘ä¸­å¯ä»¥æ ¹æ®è‡ªå·±çš„å“åº”æ—¶é—´è®¾ç½®ã€‚</p><p>å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œè€ƒè™‘å¯¹åº”çš„å…œåº•æ–¹æ¡ˆã€‚</p><h1 class=pgc-h-arrow-right><strong>åŸºäº wait() & notifyAll()</strong></h1><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">ç®€ä»‹</span></span></strong></h1><p>å®é™…ä¸Š loop å¾ªç¯è¿˜æ˜¯æ¯”è¾ƒæ¶ˆè€—æ€§èƒ½çš„ï¼Œå¯¹äºè¿™ç§ç­‰å¾…ç‰¹æ€§, jdk å®é™…ä¸Šä¸ºæˆ‘ä»¬å°è£…äº†å¤šç§ç‰¹æ€§ã€‚</p><p>æ¯”å¦‚æœ€å¸¸è§çš„ wait() è¿›å…¥ç­‰å¾…ï¼ŒnotifyAll() å”¤é†’ç­‰å¾…çš„ç»„åˆæ–¹å¼ã€‚</p><p>è¿™ä¸ªåŒæ—¶ä¹Ÿæ˜¯é˜»å¡é˜Ÿåˆ—çš„å®ç°æ€æƒ³ï¼Œé˜»å¡é˜Ÿåˆ—æˆ‘ä»¬å°±ä¸ä»‹ç»äº†ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ wait+notify çš„å®ç°æ–¹å¼ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">java å®ç°</span></span></strong></h1><pre><code>packageÂ com.github.houbb.sync.test.demo;importÂ com.github.houbb.log.integration.core.Log;importÂ com.github.houbb.log.integration.core.LogFactory;/**Â *Â wait+notifyÂ å®ç°Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ classÂ WaitNotifyQueryÂ extendsÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(WaitNotifyQuery.class);Â Â Â Â /**Â Â Â Â Â *Â å£°æ˜å¯¹è±¡Â Â Â Â Â */Â Â Â Â privateÂ finalÂ ObjectÂ lockÂ =Â newÂ Object();Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ remoteCall()Â {Â Â Â Â Â Â Â Â super.remoteCall();Â Â Â Â Â Â Â Â synchronizedÂ (lock)Â {Â Â Â Â Â Â Â Â Â Â Â Â log.info("è¿œç¨‹çº¿ç¨‹æ‰§è¡Œå®Œæˆï¼Œå”¤é†’æ‰€æœ‰ç­‰å¾…ã€‚");Â Â Â Â Â Â Â Â Â Â Â Â lock.notifyAll();Â Â Â Â Â Â Â Â }Â Â Â Â }Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ endQuery()Â {Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â //Â ç­‰å¾…Â 10sÂ Â Â Â Â Â Â Â Â Â Â Â synchronizedÂ (lock)Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log.info("ä¸»çº¿ç¨‹è¿›å…¥ç­‰å¾…");Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lock.wait(10Â *Â 1000);Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â super.endQuery();Â Â Â Â }Â Â Â Â publicÂ staticÂ voidÂ main(String[]Â args)Â {Â Â Â Â Â Â Â Â WaitNotifyQueryÂ queryÂ =Â newÂ WaitNotifyQuery();Â Â Â Â Â Â Â Â query.asyncToSync();Â Â Â Â }}</code></pre><p>æ³¨æ„ï¼šç¼–ç¨‹æ—¶éœ€è¦ä½¿ç”¨ synchronized ä¿è¯é”çš„æŒæœ‰è€…çº¿ç¨‹å®‰å…¨ï¼Œä¸ç„¶ä¼šæŠ¥é”™ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">æµ‹è¯•</span></span></strong></h1><p>æ—¥å¿—å¦‚ä¸‹ï¼š</p><pre><code>[INFO]Â [2020-10-08Â 11:05:50.769]Â [main]Â [c.g.h.s.t.d.AbstractQuery.startQuery]Â -Â å¼€å§‹æŸ¥è¯¢...[INFO]Â [2020-10-08Â 11:05:50.770]Â [main]Â [c.g.h.s.t.d.WaitNotifyQuery.endQuery]Â -Â ä¸»çº¿ç¨‹è¿›å…¥ç­‰å¾…[INFO]Â [2020-10-08Â 11:05:50.770]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â è¿œç¨‹è°ƒç”¨å¼€å§‹[INFO]Â [2020-10-08Â 11:05:55.772]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â è¿œç¨‹è°ƒç”¨ç»“æŸ[INFO]Â [2020-10-08Â 11:05:55.773]Â [Thread-0]Â [c.g.h.s.t.d.WaitNotifyQuery.remoteCall]Â -Â è¿œç¨‹çº¿ç¨‹æ‰§è¡Œå®Œæˆï¼Œå”¤é†’æ‰€æœ‰ç­‰å¾…ã€‚[INFO]Â [2020-10-08Â 11:05:55.773]Â [main]Â [c.g.h.s.t.d.AbstractQuery.endQuery]Â -Â å®ŒæˆæŸ¥è¯¢ï¼Œç»“æœä¸ºï¼šsuccess</code></pre><h1 class=pgc-h-arrow-right><strong>åŸºäºæ¡ä»¶é”çš„å®ç°</strong></h1><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">æ¡ä»¶é”ç®€ä»‹</span></span></strong></h1><p>å¦‚æœä½ æƒ³ç¼–å†™ä¸€ä¸ªå«æœ‰å¤šä¸ªæ¡ä»¶è°“è¯çš„å¹¶å‘å¯¹è±¡,æˆ–è€…ä½ æƒ³è·å¾—æ¯”æ¡ä»¶é˜Ÿåˆ—çš„å¯è§æ€§ä¹‹å¤–æ›´å¤šçš„æ§åˆ¶æƒ,é‚£ä¹ˆæ˜¾å¼çš„Lockå’ŒConditionçš„å®ç°ç±»æä¾›äº†ä¸€ä¸ª<strong>æ¯”å†…éƒ¨é”å’Œæ¡ä»¶é˜Ÿåˆ—æ›´åŠ çµæ´»çš„é€‰æ‹©ã€‚</strong></p><p>å¦‚åŒLockæä¾›äº†æ¯”å†…éƒ¨åŠ é”è¦ä¸°å¯Œå¾—å¤šçš„ç‰¹å¾é›†ä¸€æ ·,Conditionä¹Ÿæä¾›äº†æ¯”å†…éƒ¨æ¡ä»¶é˜Ÿåˆ—è¦ä¸°å¯Œå¾—å¤šçš„ç‰¹å¾é›†:</p><p>æ¯ä¸ªé”å¯ä»¥æœ‰å¤šä¸ªç­‰å¾…é›†(å› awaitæŒ‚èµ·çš„çº¿ç¨‹çš„é›†åˆ)ã€å¯ä¸­æ–­/ä¸å¯ä¸­æ–­çš„æ¡ä»¶ç­‰å¾…ã€åŸºäºæ—¶é™çš„ç­‰å¾…ä»¥åŠå…¬å¹³/éå…¬å¹³é˜Ÿåˆ—ä¹‹é—´çš„é€‰æ‹©.</p><blockquote class=pgc-blockquote-abstract><p><span style="background-color:#fff9f9;--tt-darkmode-bgcolor: #151515">Condition ä»‹ç»</span></p></blockquote><p>æ³¨æ„äº‹é¡¹:</p><p>waitã€notifyå’ŒnotifyAllåœ¨Conditionå¯¹è±¡ä¸­çš„å¯¹ç­‰ä½“æ˜¯awaitã€signalå’ŒsignalAll.</p><p>ä½†æ˜¯,Conditionç»§æ‰¿ä¸Object,è¿™æ„å‘³ç€å®ƒä¹Ÿæœ‰waitå’Œnotifyæ–¹æ³•.</p><p>ä¸€å®šè¦ç¡®ä¿ä½¿ç”¨äº†æ­£ç¡®çš„ç‰ˆæœ¬â€“awaitå’Œsignal!</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">java å®ç°</span></span></strong></h1><p>ä¸ºäº†æ¼”ç¤ºç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥é€‰æ‹©å¯é‡å…¥é”å³å¯ã€‚</p><p>ä¸€ä¸ªConditionå’Œä¸€ä¸ªå•ç‹¬çš„Lockç›¸å…³è”,å°±åƒæ¡ä»¶é˜Ÿåˆ—å’Œå•ç‹¬çš„å†…éƒ¨é”ç›¸å…³è”ä¸€æ ·;</p><p>è°ƒç”¨ä¸Conditionç›¸å…³è”çš„Lockçš„Lock.newConditionæ–¹æ³•,å¯ä»¥åˆ›å»ºä¸€ä¸ªCondition.</p><pre><code>packageÂ com.github.houbb.sync.test.demo;importÂ com.github.houbb.log.integration.core.Log;importÂ com.github.houbb.log.integration.core.LogFactory;importÂ java.util.concurrent.locks.Condition;importÂ java.util.concurrent.locks.Lock;importÂ java.util.concurrent.locks.ReentrantLock;/**Â *Â æ¡ä»¶é”å®ç°Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ classÂ LockConditionQueryÂ extendsÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(LockConditionQuery.class);Â Â Â Â privateÂ finalÂ LockÂ lockÂ =Â newÂ ReentrantLock();Â Â Â Â privateÂ finalÂ ConditionÂ conditionÂ =Â lock.newCondition();Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ remoteCall()Â {Â Â Â Â Â Â Â Â lock.lock();Â Â Â Â Â Â Â Â try{Â Â Â Â Â Â Â Â Â Â Â Â super.remoteCall();Â Â Â Â Â Â Â Â Â Â Â Â log.info("è¿œç¨‹çº¿ç¨‹æ‰§è¡Œå®Œæˆï¼Œå”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ã€‚");Â Â Â Â Â Â Â Â Â Â Â Â condition.signalAll();Â Â Â Â Â Â Â Â }Â finallyÂ {Â Â Â Â Â Â Â Â Â Â Â Â lock.unlock();Â Â Â Â Â Â Â Â }Â Â Â Â }Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ endQuery()Â {Â Â Â Â Â Â Â Â lock.lock();Â Â Â Â Â Â Â Â try{Â Â Â Â Â Â Â Â Â Â Â Â //Â ç­‰å¾…Â Â Â Â Â Â Â Â Â Â Â Â log.info("ä¸»çº¿ç¨‹è¿›å…¥ç­‰å¾…");Â Â Â Â Â Â Â Â Â Â Â Â condition.await();Â Â Â Â Â Â Â Â Â Â Â Â super.endQuery();Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â finallyÂ {Â Â Â Â Â Â Â Â Â Â Â Â lock.unlock();Â Â Â Â Â Â Â Â }Â Â Â Â }Â Â Â Â publicÂ staticÂ voidÂ main(String[]Â args)Â {Â Â Â Â Â Â Â Â LockConditionQueryÂ queryÂ =Â newÂ LockConditionQuery();Â Â Â Â Â Â Â Â query.asyncToSync();Â Â Â Â }}</code></pre><p>å®ç°ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬åœ¨æ–¹æ³•è¿›å…¥ï¼Œè°ƒç”¨ lock.lock() åŠ é”ï¼Œfinally ä¸­è°ƒç”¨ lock.unlock() é‡Šæ”¾é”ã€‚</p><p><span style="color:#ef7060;--tt-darkmode-color: #EF7060">condition.await();</span> è¿›å…¥ç­‰å¾…ï¼›<span style="color:#ef7060;--tt-darkmode-color: #EF7060">condition.signalAll();</span> å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">æµ‹è¯•æ—¥å¿—</span></span></strong></h1><pre><code>[INFO]Â [2020-10-08Â 12:33:40.985]Â [main]Â [c.g.h.s.t.d.AbstractQuery.startQuery]Â -Â å¼€å§‹æŸ¥è¯¢...[INFO]Â [2020-10-08Â 12:33:40.986]Â [main]Â [c.g.h.s.t.d.LockConditionQuery.endQuery]Â -Â ä¸»çº¿ç¨‹è¿›å…¥ç­‰å¾…[INFO]Â [2020-10-08Â 12:33:40.987]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â è¿œç¨‹è°ƒç”¨å¼€å§‹[INFO]Â [2020-10-08Â 12:33:45.990]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â è¿œç¨‹è°ƒç”¨ç»“æŸ[INFO]Â [2020-10-08Â 12:33:45.991]Â [Thread-0]Â [c.g.h.s.t.d.LockConditionQuery.remoteCall]Â -Â è¿œç¨‹çº¿ç¨‹æ‰§è¡Œå®Œæˆï¼Œå”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ã€‚[INFO]Â [2020-10-08Â 12:33:45.993]Â [main]Â [c.g.h.s.t.d.AbstractQuery.endQuery]Â -Â å®ŒæˆæŸ¥è¯¢ï¼Œç»“æœä¸ºï¼šsuccess</code></pre><h1 class=pgc-h-arrow-right><strong>CountDownLatch é—­é”å®ç°</strong></h1><p>CountDownLatch/Future/CyclicBarrier è¿™ä¸‰ä¸ªéƒ½æ˜¯ jdk ä¸ºæˆ‘ä»¬æä¾›çš„åŒæ­¥å·¥å…·ç±»ï¼Œæˆ‘ä»¬æ­¤å¤„åªåšç®€å•ä»‹ç»ã€‚</p><p>è¯¦æƒ…å‚è§ï¼š</p><blockquote class=pgc-blockquote-abstract><p><span style="background-color:#fff9f9;--tt-darkmode-bgcolor: #151515">JCIP-19-åŒæ­¥å·¥å…·ç±»ã€‚é—­é”/æ …æ /ä¿¡å·é‡/é˜»å¡é˜Ÿåˆ—/FutureTask</span></p></blockquote><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">CountDownLatch ç®€ä»‹</span></span></strong></h1><p>é—­é”æ˜¯ä¸€ç§åŒæ­¥å·¥å…·ç±»ï¼Œå¯ä»¥å»¶è¿Ÿçº¿ç¨‹çš„è¿›åº¦ç›´åˆ°å…¶è¾¾åˆ°ç»ˆæ­¢çŠ¶æ€ã€‚</p><p>é—­é”çš„ä½œç”¨ç›¸å½“äºä¸€æ‰‡é—¨ï¼šåœ¨é—­é”åˆ°è¾¾ç»“æŸçŠ¶æ€ä¹‹å‰ï¼Œè¿™æ‰‡é—¨ä¸€ç›´æ˜¯å…³é—­çš„ï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•çº¿ç¨‹èƒ½é€šè¿‡ï¼Œå½“åˆ°è¾¾ç»“æŸçŠ¶æ€æ—¶ï¼Œè¿™æ‰‡é—¨ä¼šæ‰“å¼€å¹¶å…è®¸æ‰€æœ‰çš„çº¿ç¨‹é€šè¿‡ã€‚</p><p>å½“é—­é”åˆ°è¾¾ç»“æŸçŠ¶æ€åï¼Œå°†ä¸ä¼šå†æ”¹å˜çŠ¶æ€ï¼Œå› æ­¤è¿™æ‰‡é—¨å°†æ°¸è¿œä¿æŒæ‰“å¼€çŠ¶æ€ã€‚</p><p>é—­é”å¯ä»¥ç”¨æ¥ç¡®ä¿æŸäº›æ´»åŠ¨ç›´åˆ°å…¶å®ƒæ´»åŠ¨éƒ½å®Œæˆåæ‰ç»§ç»­æ‰§è¡Œã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">java ä»£ç å®ç°</span></span></strong></h1><pre><code>importÂ com.github.houbb.log.integration.core.Log;importÂ com.github.houbb.log.integration.core.LogFactory;importÂ java.util.concurrent.CountDownLatch;importÂ java.util.concurrent.TimeUnit;/**Â *Â CountDownLatchÂ å®ç°Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ classÂ CountDownLatchQueryÂ extendsÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(CountDownLatchQuery.class);Â Â Â Â /**Â Â Â Â Â *Â é—­é”Â Â Â Â Â *Â è°ƒç”¨1æ¬¡ï¼Œåç»­æ–¹æ³•å³å¯é€šè¡Œã€‚Â Â Â Â Â */Â Â Â Â privateÂ finalÂ CountDownLatchÂ countDownLatchÂ =Â newÂ CountDownLatch(1);Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ remoteCall()Â {Â Â Â Â Â Â Â Â super.remoteCall();Â Â Â Â Â Â Â Â //Â è°ƒç”¨ä¸€æ¬¡é—­é”Â Â Â Â Â Â Â Â countDownLatch.countDown();Â Â Â Â }Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ endQuery()Â {Â Â Â Â Â Â Â Â tryÂ {//Â Â Â Â Â Â Â Â Â Â Â Â countDownLatch.await();Â Â Â Â Â Â Â Â Â Â Â Â countDownLatch.await(10,Â TimeUnit.SECONDS);Â Â Â Â Â Â Â Â Â Â Â Â log.info("å®ŒæˆæŸ¥è¯¢ï¼Œç»“æœä¸ºï¼š"Â +Â result);Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â }Â Â Â Â publicÂ staticÂ voidÂ main(String[]Â args)Â {Â Â Â Â Â Â Â Â CountDownLatchQueryÂ loopQueryÂ =Â newÂ CountDownLatchQuery();Â Â Â Â Â Â Â Â loopQuery.asyncToSync();Â Â Â Â }}</code></pre><p>æˆ‘ä»¬åœ¨è¿”å›ç»“æœä¹‹å‰è°ƒç”¨ <span style="color:#ef7060;--tt-darkmode-color: #EF7060">countDownLatch.await(10, TimeUnit.SECONDS);</span> è¿›è¡Œç­‰å¾…ï¼Œè¿™é‡Œå¯ä»¥æŒ‡å®šè¶…æ—¶æ—¶é—´ã€‚</p><p>remoteCall() è¿œç¨‹å®Œæˆåï¼Œæ‰§è¡Œä¸€ä¸‹ <span style="color:#ef7060;--tt-darkmode-color: #EF7060">countDownLatch.countDown();</span>ï¼Œè¿›è€Œå¯ä»¥è®©ç¨‹åºç»§ç»­æ‰§è¡Œä¸‹å»ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">æµ‹è¯•</span></span></strong></h1><h1 class=pgc-h-arrow-right><strong>ä»£ç </strong></h1><pre><code>CountDownLatchQueryÂ loopQueryÂ =Â newÂ CountDownLatchQuery();loopQuery.asyncToSync();</code></pre><h1 class=pgc-h-arrow-right><strong>æ—¥å¿—</strong></h1><pre><code>[INFO]Â [2020-10-08Â 10:24:03.348]Â [main]Â [c.g.h.s.t.d.AbstractQuery.startQuery]Â -Â å¼€å§‹æŸ¥è¯¢...[INFO]Â [2020-10-08Â 10:24:03.350]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â è¿œç¨‹è°ƒç”¨å¼€å§‹[INFO]Â [2020-10-08Â 10:24:08.353]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â è¿œç¨‹è°ƒç”¨ç»“æŸ[INFO]Â [2020-10-08Â 10:24:08.354]Â [main]Â [c.g.h.s.t.d.CountDownLatchQuery.endQuery]Â -Â å®ŒæˆæŸ¥è¯¢ï¼Œç»“æœä¸ºï¼šsuccess</code></pre><p>jdk æä¾›çš„é—­é”åŠŸèƒ½è¿˜æ˜¯éå¸¸çš„æ–¹ä¾¿çš„ã€‚</p><h1 class=pgc-h-arrow-right><strong>CyclicBarrier æ …æ </strong></h1><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">ç®€ä»‹</span></span></strong></h1><p>æ …æ ï¼ˆBarrierï¼‰ç±»ä¼¼äºé—­é”ï¼Œå®ƒèƒ½é˜»å¡ä¸€ç»„çº¿ç¨‹ç›´åˆ°æŸä¸ªäº‹ä»¶å‘ç”Ÿ[CPJ 4.4.3]ã€‚é—­é”æ˜¯ä¸€æ¬¡æ€§å¯¹è±¡ï¼Œä¸€æ—¦è¿›å…¥æœ€ç»ˆçŠ¶æ€ï¼Œå°±ä¸èƒ½è¢«é‡ç½®äº†ã€‚</p><p><strong>æ …æ ä¸é—­é”çš„å…³é”®åŒºåˆ«åœ¨äºï¼Œæ‰€æœ‰çº¿ç¨‹å¿…é¡»åŒæ—¶è¾¾åˆ°æ …æ ä½ç½®ï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚é—­é”ç”¨äºç­‰å¾…äº‹ä»¶ï¼Œè€Œæ …æ ç”¨äºç­‰å¾…å…¶ä»–çº¿ç¨‹ã€‚</strong></p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">java å®ç°</span></span></strong></h1><pre><code>packageÂ com.github.houbb.sync.test.demo;importÂ com.github.houbb.log.integration.core.Log;importÂ com.github.houbb.log.integration.core.LogFactory;importÂ java.util.concurrent.BrokenBarrierException;importÂ java.util.concurrent.CyclicBarrier;/**Â *Â CyclicBarrierÂ å®ç°Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ classÂ CyclicBarrierQueryÂ extendsÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(CyclicBarrierQuery.class);Â Â Â Â privateÂ CyclicBarrierÂ cyclicBarrierÂ =Â newÂ CyclicBarrier(2);Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ remoteCall()Â {Â Â Â Â Â Â Â Â super.remoteCall();Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â cyclicBarrier.await();Â Â Â Â Â Â Â Â Â Â Â Â log.info("è¿œç¨‹è°ƒç”¨è¿›å…¥ç­‰å¾…");Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ |Â BrokenBarrierExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â }Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ endQuery()Â {Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â cyclicBarrier.await();Â Â Â Â Â Â Â Â Â Â Â Â log.info("ä¸»çº¿ç¨‹è¿›å…¥ç­‰å¾…");Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ |Â BrokenBarrierExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â super.endQuery();Â Â Â Â }}</code></pre><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">æµ‹è¯•</span></span></strong></h1><h1 class=pgc-h-arrow-right><strong>ä»£ç </strong></h1><pre><code>publicÂ staticÂ voidÂ main(String[]Â args)Â {Â Â Â Â CyclicBarrierQueryÂ cyclicBarrierQueryÂ =Â newÂ CyclicBarrierQuery();Â Â Â Â cyclicBarrierQuery.asyncToSync();}</code></pre><h1 class=pgc-h-arrow-right><strong>æ—¥å¿—</strong></h1><pre><code>[INFO]Â [2020-10-08Â 10:39:00.890]Â [main]Â [c.g.h.s.t.d.AbstractQuery.startQuery]Â -Â å¼€å§‹æŸ¥è¯¢...[INFO]Â [2020-10-08Â 10:39:00.892]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â è¿œç¨‹è°ƒç”¨å¼€å§‹[INFO]Â [2020-10-08Â 10:39:05.894]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â è¿œç¨‹è°ƒç”¨ç»“æŸ[INFO]Â [2020-10-08Â 10:39:05.895]Â [Thread-0]Â [c.g.h.s.t.d.CyclicBarrierQuery.remoteCall]Â -Â è¿œç¨‹è°ƒç”¨è¿›å…¥ç­‰å¾…[INFO]Â [2020-10-08Â 10:39:05.895]Â [main]Â [c.g.h.s.t.d.CyclicBarrierQuery.endQuery]Â -Â ä¸»çº¿ç¨‹è¿›å…¥ç­‰å¾…[INFO]Â [2020-10-08Â 10:39:05.896]Â [main]Â [c.g.h.s.t.d.AbstractQuery.endQuery]Â -Â å®ŒæˆæŸ¥è¯¢ï¼Œç»“æœä¸ºï¼šsuccess</code></pre><p>å¯ä»¥çœ‹å‡ºè¿œç¨‹çº¿ç¨‹ <span style="color:#ef7060;--tt-darkmode-color: #EF7060">Thread-0</span> æ‰§è¡Œå®Œä¹‹åå°±è¿›å…¥ç­‰å¾…ï¼Œæ­¤æ—¶ä¸»çº¿ç¨‹è°ƒç”¨ï¼Œç„¶åä¹Ÿè¿›å…¥ç­‰å¾…ã€‚</p><p>ç­‰ä¸»çº¿ç¨‹ endQuery ç­‰å¾…æ—¶ï¼Œå°±æ»¡è¶³äº†ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶ç­‰å¾…ï¼Œç„¶åæ‰§è¡Œå°±ç»“æŸäº†ã€‚</p><h1 class=pgc-h-arrow-right><strong>åŸºäº Future å®ç°</strong></h1><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">Future ç®€ä»‹</span></span></strong></h1><p>Futureæ¨¡å¼å¯ä»¥è¿™æ ·æ¥æè¿°ï¼šæˆ‘æœ‰ä¸€ä¸ªä»»åŠ¡ï¼Œæäº¤ç»™äº†Futureï¼ŒFutureæ›¿æˆ‘å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚æœŸé—´æˆ‘è‡ªå·±å¯ä»¥å»åšä»»ä½•æƒ³åšçš„äº‹æƒ…ã€‚ä¸€æ®µæ—¶é—´ä¹‹åï¼Œæˆ‘å°±ä¾¿å¯ä»¥ä»Futureé‚£å„¿å–å‡ºç»“æœã€‚å°±ç›¸å½“äºä¸‹äº†ä¸€å¼ è®¢è´§å•ï¼Œä¸€æ®µæ—¶é—´åå¯ä»¥æ‹¿ç€æè®¢å•æ¥æè´§ï¼Œè¿™æœŸé—´å¯ä»¥å¹²åˆ«çš„ä»»ä½•äº‹æƒ…ã€‚å…¶ä¸­Future æ¥å£å°±æ˜¯è®¢è´§å•ï¼ŒçœŸæ­£å¤„ç†è®¢å•çš„æ˜¯Executorç±»ï¼Œå®ƒæ ¹æ®Futureæ¥å£çš„è¦æ±‚æ¥ç”Ÿäº§äº§å“ã€‚</p><p>Futureæ¥å£æä¾›æ–¹æ³•æ¥æ£€æµ‹ä»»åŠ¡æ˜¯å¦è¢«æ‰§è¡Œå®Œï¼Œç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œè·å¾—ç»“æœï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä»»åŠ¡æ‰§è¡Œçš„è¶…æ—¶æ—¶é—´ã€‚è¿™ä¸ªè®¾ç½®è¶…æ—¶çš„æ–¹æ³•å°±æ˜¯å®ç°Javaç¨‹åºæ‰§è¡Œè¶…æ—¶çš„å…³é”®ã€‚</p><p>è¯¦ç»†ä»‹ç»ï¼š</p><blockquote class=pgc-blockquote-abstract><p><span style="background-color:#fff9f9;--tt-darkmode-bgcolor: #151515">JCIP-26-Executor Future FutureTask</span></p></blockquote><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">java ä»£ç å®ç°</span></span></strong></h1><p>é‡‡ç”¨ Future è¿”å›å’Œä»¥å‰çš„å®ç°å·®å¼‚è¾ƒå¤§ï¼Œæˆ‘ä»¬ç›´æ¥è¦†å†™ä»¥å‰çš„æ–¹æ³•å³å¯ã€‚</p><pre><code>importÂ com.github.houbb.log.integration.core.Log;importÂ com.github.houbb.log.integration.core.LogFactory;importÂ java.util.concurrent.*;/**Â *Â FutureÂ å®ç°Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ classÂ FutureQueryÂ extendsÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(FutureQuery.class);Â Â Â Â privateÂ finalÂ ExecutorServiceÂ executorServiceÂ =Â Executors.newSingleThreadExecutor();Â Â Â Â @OverrideÂ Â Â Â publicÂ voidÂ asyncToSync()Â {Â Â Â Â Â Â Â Â //1.Â å¼€å§‹è°ƒç”¨Â Â Â Â Â Â Â Â super.startQuery();Â Â Â Â Â Â Â Â //2.Â è¿œç¨‹è°ƒç”¨Â Â Â Â Â Â Â Â Future&lt;String&gt;Â stringFutureÂ =Â remoteCallFuture();Â Â Â Â Â Â Â Â //3.Â å®Œæˆç»“æœÂ Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â StringÂ resultÂ =Â stringFuture.get(10,Â TimeUnit.SECONDS);Â Â Â Â Â Â Â Â Â Â Â Â log.info("è°ƒç”¨ç»“æœï¼š{}",Â result);Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ |Â TimeoutExceptionÂ |Â ExecutionExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â }Â Â Â Â /**Â Â Â Â Â *Â è¿œç¨‹è°ƒç”¨Â Â Â Â Â *Â @returnÂ FutureÂ ä¿¡æ¯Â Â Â Â Â */Â Â Â Â privateÂ Future&lt;String&gt;Â remoteCallFuture()Â {Â Â Â Â Â Â Â Â FutureTask&lt;String&gt;Â futureTaskÂ =Â newÂ FutureTask&lt;&gt;(newÂ Callable&lt;String&gt;()Â {Â Â Â Â Â Â Â Â Â Â Â Â @OverrideÂ Â Â Â Â Â Â Â Â Â Â Â publicÂ StringÂ call()Â throwsÂ ExceptionÂ {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log.info("å¼€å§‹å¼‚æ­¥è°ƒç”¨");Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TimeUnit.SECONDS.sleep(5);Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log.info("å®Œæˆå¼‚æ­¥è°ƒç”¨");Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ "success";Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â });Â Â Â Â Â Â Â Â executorService.submit(futureTask);Â Â Â Â Â Â Â Â //Â å…³é—­çº¿ç¨‹æ± Â Â Â Â Â Â Â Â executorService.shutdown();Â Â Â Â Â Â Â Â returnÂ futureTask;Â Â Â Â }Â Â Â Â publicÂ staticÂ voidÂ main(String[]Â args)Â {Â Â Â Â Â Â Â Â FutureQueryÂ queryÂ =Â newÂ FutureQuery();Â Â Â Â Â Â Â Â query.asyncToSync();Â Â Â Â }}</code></pre><p>è¿œç¨‹è°ƒç”¨æ‰§è¡Œæ—¶ï¼Œæ˜¯ä¸€ä¸ª FutureTaskï¼Œç„¶åæäº¤åˆ°çº¿ç¨‹æ± å»æ‰§è¡Œã€‚</p><p>è·å–ç»“æœçš„æ—¶å€™ï¼Œ<span style="color:#ef7060;--tt-darkmode-color: #EF7060">stringFuture.get(10, TimeUnit.SECONDS)</span> å¯ä»¥æŒ‡å®šè·å–çš„è¶…æ—¶æ—¶é—´ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">æ—¥å¿—</span></span></strong></h1><p>æµ‹è¯•æ—¥å¿—å¦‚ä¸‹:</p><pre><code>[INFO]Â [2020-10-08Â 12:52:05.175]Â [main]Â [c.g.h.s.t.d.AbstractQuery.startQuery]Â -Â å¼€å§‹æŸ¥è¯¢...[INFO]Â [2020-10-08Â 12:52:05.177]Â [pool-1-thread-1]Â [c.g.h.s.t.d.FutureQuery.call]Â -Â å¼€å§‹å¼‚æ­¥è°ƒç”¨[INFO]Â [2020-10-08Â 12:52:10.181]Â [pool-1-thread-1]Â [c.g.h.s.t.d.FutureQuery.call]Â -Â å®Œæˆå¼‚æ­¥è°ƒç”¨[INFO]Â [2020-10-08Â 12:52:10.185]Â [main]Â [c.g.h.s.t.d.FutureQuery.asyncToSync]Â -Â è°ƒç”¨ç»“æœï¼šsuccess</code></pre><h1 class=pgc-h-arrow-right><strong>Spring EventListener</strong></h1><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">spring äº‹ä»¶ç›‘å¬å™¨æ¨¡å¼</span></span></strong></h1><p>å¯¹äºä¸€ä»¶äº‹æƒ…å®Œæˆçš„ç»“æœè°ƒç”¨ï¼Œä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼æ˜¯éå¸¸é€‚åˆçš„ã€‚</p><p>spring ä¸ºæˆ‘ä»¬æä¾›äº†æ¯”è¾ƒå¼ºå¤§çš„ç›‘å¬æœºåˆ¶ï¼Œæ­¤å¤„æ¼”ç¤ºä¸‹ç»“åˆ spring ä½¿ç”¨çš„ä¾‹å­ã€‚</p><p>ps: è¿™ä¸ªä¾‹å­æ˜¯2å¹´å‰çš„è‡ªå·±å†™çš„ä¾‹å­äº†ï¼Œæ­¤å¤„ä¸ºäº†æ•´ä¸ªç³»åˆ—çš„å®Œæ•´æ€§ï¼Œç›´æ¥æ¬è¿‡æ¥ä½œä¸ºè¡¥å……ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">ä»£ç å®ç°</span></span></strong></h1><ul><li>BookingCreatedEvent.java</li></ul><p>å®šä¹‰ä¸€ä¸ªä¼ è¾“å±æ€§çš„å¯¹è±¡ã€‚</p><pre><code>publicÂ classÂ BookingCreatedEventÂ extendsÂ ApplicationEventÂ {Â Â Â Â privateÂ staticÂ finalÂ longÂ serialVersionUIDÂ =Â -1387078212317348344L;Â Â Â Â privateÂ StringÂ info;Â Â Â Â publicÂ BookingCreatedEvent(ObjectÂ source)Â {Â Â Â Â Â Â Â Â super(source);Â Â Â Â }Â Â Â Â publicÂ BookingCreatedEvent(ObjectÂ source,Â StringÂ info)Â {Â Â Â Â Â Â Â Â super(source);Â Â Â Â Â Â Â Â this.infoÂ =Â info;Â Â Â Â }Â Â Â Â publicÂ StringÂ getInfo()Â {Â Â Â Â Â Â Â Â returnÂ info;Â Â Â Â }}</code></pre><ul><li>BookingService.java</li></ul><p>è¯´æ˜ï¼šå½“ <span style="color:#ef7060;--tt-darkmode-color: #EF7060">this.context.publishEvent(bookingCreatedEvent);</span> è§¦å‘æ—¶ï¼Œ ä¼šè¢« <span style="color:#ef7060;--tt-darkmode-color: #EF7060">@EventListener</span> æŒ‡å®šçš„æ–¹æ³•ç›‘å¬åˆ°ã€‚</p><pre><code>importÂ org.springframework.beans.factory.annotation.Autowired;importÂ org.springframework.context.ApplicationContext;importÂ org.springframework.context.event.EventListener;importÂ org.springframework.stereotype.Service;importÂ java.util.concurrent.TimeUnit;@ServicepublicÂ classÂ BookingServiceÂ {Â Â Â Â @AutowiredÂ Â Â Â privateÂ ApplicationContextÂ context;Â Â Â Â privateÂ volatileÂ BookingCreatedEventÂ bookingCreatedEvent;Â Â Â Â /**Â Â Â Â Â *Â å¼‚æ­¥è½¬åŒæ­¥æŸ¥è¯¢Â Â Â Â Â *Â @paramÂ infoÂ Â Â Â Â *Â @returnÂ Â Â Â Â */Â Â Â Â publicÂ StringÂ asyncQuery(finalÂ StringÂ info)Â {Â Â Â Â Â Â Â Â query(info);Â Â Â Â Â Â Â Â newÂ Thread(newÂ Runnable()Â {Â Â Â Â Â Â Â Â Â Â Â Â @OverrideÂ Â Â Â Â Â Â Â Â Â Â Â publicÂ voidÂ run()Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â remoteCallback(info);Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â }).start();Â Â Â Â Â Â Â Â while(bookingCreatedEventÂ ==Â null)Â {Â Â Â Â Â Â Â Â Â Â Â Â //..Â ç©ºå¾ªç¯Â Â Â Â Â Â Â Â Â Â Â Â //Â çŸ­æš‚ç­‰å¾…ã€‚Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TimeUnit.MILLISECONDS.sleep(1);Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //...Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â Â Â Â Â //2.Â ä½¿ç”¨ä¸¤ä¸ªå•ç‹¬çš„Â event...Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â finalÂ StringÂ resultÂ =Â bookingCreatedEvent.getInfo();Â Â Â Â Â Â Â Â bookingCreatedEventÂ =Â null;Â Â Â Â Â Â Â Â returnÂ result;Â Â Â Â }Â Â Â Â @EventListenerÂ Â Â Â publicÂ voidÂ onApplicationEvent(BookingCreatedEventÂ bookingCreatedEvent)Â {Â Â Â Â Â Â Â Â System.out.println("ç›‘å¬åˆ°è¿œç¨‹çš„ä¿¡æ¯:Â "Â +Â bookingCreatedEvent.getInfo());Â Â Â Â Â Â Â Â this.bookingCreatedEventÂ =Â bookingCreatedEvent;Â Â Â Â Â Â Â Â System.out.println("ç›‘å¬åˆ°è¿œç¨‹æ¶ˆæ¯å:Â "Â +Â this.bookingCreatedEvent.getInfo());Â Â Â Â }Â Â Â Â /**Â Â Â Â Â *Â æ‰§è¡ŒæŸ¥è¯¢Â Â Â Â Â *Â @paramÂ infoÂ Â Â Â Â */Â Â Â Â publicÂ voidÂ query(finalÂ StringÂ info)Â {Â Â Â Â Â Â Â Â System.out.println("å¼€å§‹æŸ¥è¯¢:Â "Â +Â info);Â Â Â Â }Â Â Â Â /**Â Â Â Â Â *Â è¿œç¨‹å›è°ƒÂ Â Â Â Â *Â @paramÂ infoÂ Â Â Â Â */Â Â Â Â publicÂ voidÂ remoteCallback(finalÂ StringÂ info)Â {Â Â Â Â Â Â Â Â System.out.println("è¿œç¨‹å›è°ƒå¼€å§‹:Â "Â +Â info);Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â TimeUnit.SECONDS.sleep(2);Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â //Â é‡å‘ç»“æœäº‹ä»¶Â Â Â Â Â Â Â Â StringÂ resultÂ =Â infoÂ +Â "-result";Â Â Â Â Â Â Â Â BookingCreatedEventÂ bookingCreatedEventÂ =Â newÂ BookingCreatedEvent(this,Â result);Â Â Â Â Â Â Â Â //è§¦å‘eventÂ Â Â Â Â Â Â Â this.context.publishEvent(bookingCreatedEvent);Â Â Â Â }}</code></pre><ul><li>æµ‹è¯•æ–¹æ³•</li></ul><pre><code>@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(classesÂ =Â SpringConfig.class)publicÂ classÂ BookServiceTestÂ {Â Â Â Â @AutowiredÂ Â Â Â privateÂ BookingServiceÂ bookingService;Â Â Â Â @TestÂ Â Â Â publicÂ voidÂ asyncQueryTest()Â {Â Â Â Â Â Â Â Â bookingService.asyncQuery("1234");Â Â Â Â }}</code></pre><ul><li>æ—¥å¿—</li></ul><pre><code>2018-08-10Â 18:27:05.958Â Â INFOÂ Â [main]Â com.github.houbb.spring.lean.core.ioc.event.BookingService:84Â -Â å¼€å§‹æŸ¥è¯¢:12342018-08-10Â 18:27:05.959Â Â INFOÂ Â [Thread-2]Â com.github.houbb.spring.lean.core.ioc.event.BookingService:93Â -Â è¿œç¨‹å›è°ƒå¼€å§‹:1234æ¥æ”¶åˆ°ä¿¡æ¯:Â 1234-result2018-08-10Â 18:27:07.964Â Â INFOÂ Â [Thread-2]Â com.github.houbb.spring.lean.core.ioc.event.BookingService:73Â -Â ç›‘å¬åˆ°è¿œç¨‹çš„ä¿¡æ¯:Â 1234-result2018-08-10Â 18:27:07.964Â Â INFOÂ Â [Thread-2]Â com.github.houbb.spring.lean.core.ioc.event.BookingService:75Â -Â ç›‘å¬åˆ°è¿œç¨‹æ¶ˆæ¯å:Â 1234-result2018-08-10Â 18:27:07.964Â Â INFOÂ Â [Thread-2]Â com.github.houbb.spring.lean.core.ioc.event.BookingService:106Â -Â å·²ç»è§¦å‘event2018-08-10Â 18:27:07.964Â Â INFOÂ Â [main]Â com.github.houbb.spring.lean.core.ioc.event.BookingService:67Â -Â æŸ¥è¯¢ç»“æœ:Â 1234-result2018-08-10Â 18:27:07.968Â Â INFOÂ Â [Thread-1]Â org.springframework.context.support.GenericApplicationContext:993Â -Â ClosingÂ org.springframework.context.support.GenericApplicationContext@5cee5251:Â startupÂ dateÂ [FriÂ AugÂ 10Â 18:27:05Â CSTÂ 2018];Â rootÂ ofÂ contextÂ hierarchy</code></pre><h1 class=pgc-h-arrow-right><strong>å°ç»“</strong></h1><p>æœ¬æ–‡å…±è®¡ä»‹ç»äº† 7 ç§å¼‚æ­¥è½¬åŒæ­¥çš„æ–¹å¼ï¼Œå®é™…ä¸Šæ€æƒ³éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><p>åœ¨å¼‚æ­¥æ‰§è¡Œå®Œæˆå‰ç­‰å¾…ï¼Œæ‰§è¡Œå®Œæˆåå”¤é†’ç­‰å¾…å³å¯ã€‚</p><p>å½“ç„¶æˆ‘å†™æœ¬æ–‡é™¤äº†æ€»ç»“ä»¥ä¸Šå‡ ç§æ–¹å¼ä»¥å¤–ï¼Œè¿˜æƒ³ä¸ºåç»­å†™ä¸€ä¸ªå¼‚æ­¥è½¬åŒæ­¥çš„å·¥å…·æä¾›åŸºç¡€ã€‚</p><p>ä¸‹ä¸€èŠ‚æˆ‘ä»¬å°†ä¸€èµ·å­¦ä¹ ä¸‹å¦‚ä½•å°†è¿™ä¸ªåŠŸèƒ½å°è£…ä¸ºä¸€ä¸ªåŒæ­¥è½¬æ¢æ¡†æ¶ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å…³æ³¨ä¸€ä¸‹ï¼Œä¾¿äºå®æ—¶æ¥æ”¶æœ€æ–°å†…å®¹ã€‚</p><p>è§‰å¾—æœ¬æ–‡å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œæ¬¢è¿ç‚¹èµè¯„è®ºæ”¶è—è½¬å‘ä¸€æ³¢ã€‚ä½ çš„é¼“åŠ±ï¼Œæ˜¯æˆ‘æœ€å¤§çš„åŠ¨åŠ›~</p><p>ä¸çŸ¥é“ä½ æœ‰å“ªäº›æ”¶è·å‘¢ï¼Ÿæˆ–è€…æœ‰å…¶ä»–æ›´å¤šçš„æƒ³æ³•ï¼Œæ¬¢è¿ç•™è¨€åŒºå’Œæˆ‘ä¸€èµ·è®¨è®ºï¼ŒæœŸå¾…ä¸ä½ çš„æ€è€ƒç›¸é‡ã€‚</p><h1 class=pgc-h-arrow-right><strong>ä»£ç åœ°å€</strong></h1><p>ä¸ºäº†ä¾¿äºå­¦ä¹ ï¼Œæ–‡ä¸­çš„æ‰€æœ‰ä¾‹å­éƒ½å·²ç»å¼€æºï¼š</p><p>å®ç° 1-6ï¼š</p><blockquote class=pgc-blockquote-abstract><p><span style="background-color:#fff9f9;--tt-darkmode-bgcolor: #151515">https://github.com/houbb/sync/tree/master/sync-test/src/main/java/com/github/houbb/sync/test/demo</span></p></blockquote><blockquote class=pgc-blockquote-abstract><p><span style="background-color:#fff9f9;--tt-darkmode-bgcolor: #151515">https://github.com/houbb/spring-framework-learn/tree/master/spring-learn-core/spring-core-ioc/src/main/java/com/github/houbb/spring/lean/core/ioc/event</span></p></blockquote></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'java','æ‰‹å†™','å¼‚æ­¥æŸ¥'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>