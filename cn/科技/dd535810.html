<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–° | æå®¢å¿«è¨Š</title><meta property="og:title" content="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–° - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/66c40005d5e8c29e8c31"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/dd535810.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/dd535810.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/dd535810.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/dd535810.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/dd535810.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/dd535810.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/dd535810.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/dd535810.html><meta property="article:published_time" content="2020-10-29T21:09:21+08:00"><meta property="article:modified_time" content="2020-10-29T21:09:21+08:00"><meta name=Keywords content><meta name=description content="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/dd535810.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><h1>å‰è¨€</h1><blockquote><p>HashMap<span>åœ¨ </span>Java<span>å’Œ </span>Android<span>å¼€å‘ä¸­éå¸¸å¸¸è§è€Œ</span>HashMap 1.8<span>ç›¸å¯¹äº </span>HashMap 1.7<span>æ›´æ–°å¤š</span><span>ä»Šå¤©ï¼Œæˆ‘å°†é€šè¿‡æºç åˆ†æ</span>HashMap 1.8<span>ï¼Œä»è€Œè®²è§£</span>HashMap 1.8<span>ç›¸å¯¹äº </span>HashMap 1.7<span> çš„æ›´æ–°å†…å®¹ï¼Œå¸Œæœ›ä½ ä»¬ä¼šå–œæ¬¢ã€‚</span></p></blockquote><p>æœ¬æ–‡åŸºäºç‰ˆæœ¬ <code>JDK 1.8<span>ï¼Œå³ </span>Java 8<span>å…³äºç‰ˆæœ¬ </span>JDK 1.7<span>ï¼Œå³ </span>Java 7<span>ï¼Œ</span></code></p><h1>2. æ•°æ®ç»“æ„</h1><p>2.1 å…·ä½“æè¿°</p><p><code>HashMap<span>é‡‡ç”¨çš„æ•°æ®ç»“æ„ = æ•°ç»„ï¼ˆä¸»ï¼‰ + å•é“¾è¡¨ï¼ˆå‰¯ï¼‰ï¼Œå…·ä½“æè¿°å¦‚ä¸‹</span></code></p><br><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c40005d5e8c29e8c31></p><hr><h1></h1><p>1. ç®€ä»‹</p><ul class=list-paddingleft-2><li><p>ç±»å®šä¹‰</p></li></ul><pre>public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt; implements Map&lt;K,V&gt;, Cloneable, Serializable123</pre><ul class=list-paddingleft-2><li><p>ä¸»è¦ç®€ä»‹</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c8000464f356ad5bd6></p><p><code>HashMap<span> çš„å®ç°åœ¨ </span>JDK 1.7<span>å’Œ </span>JDK 1.8<span>å·®åˆ«è¾ƒå¤§ä»Šå¤©ï¼Œæˆ‘å°†å¯¹ç…§ </span>JDK 1.7<span>çš„æºç ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šè®²è§£ </span>JDK 1.8<span> ä¸­ </span></code><code>HashMap<span>çš„æºç è§£æ</span></code></p><h1></h1><p>2. æ•°æ®ç»“æ„ï¼šå¼•å…¥äº† çº¢é»‘æ ‘</p><p>2.1 ä¸»è¦ä»‹ç»</p><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/6c2c0000784d6002fef8></p><p class=pgc-img-caption>çº¢é»‘æ ‘</p><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/66c50005b18009e52a9b></p><p>2.2 å­˜å‚¨æµç¨‹</p><blockquote><p>æ³¨ï¼šä¸ºäº†è®©å¤§å®¶æœ‰ä¸ªæ„Ÿæ€§çš„è®¤è¯†ï¼Œåªæ˜¯ç®€å•çš„ç”»å‡ºå­˜å‚¨æµç¨‹ï¼Œæ›´åŠ è¯¦ç»† & å…·ä½“çš„å­˜å‚¨æµç¨‹ä¼šåœ¨ä¸‹é¢æºç åˆ†æä¸­ç»™å‡º</p></blockquote><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c50005b1813a94a7d6></p><p><strong>2.3 æ•°ç»„å…ƒç´  & é“¾è¡¨èŠ‚ç‚¹çš„ å®ç°ç±»</strong></p><p><code>HashMap<span>ä¸­çš„æ•°ç»„å…ƒç´  & é“¾è¡¨èŠ‚ç‚¹ é‡‡ç”¨ </span>Node<span>ç±» å®ç°</span><span>ä¸ </span>JDK 1.7<span>çš„å¯¹æ¯”ï¼ˆ</span>Entry<span>ç±»ï¼‰ï¼Œä»…ä»…åªæ˜¯æ¢äº†åå­—</span></code></p><ul class=list-paddingleft-2><li><p>è¯¥ç±»çš„æºç åˆ†æå¦‚ä¸‹</p><blockquote><p>å…·ä½“åˆ†æè¯·çœ‹æ³¨é‡Š</p></blockquote></li></ul><pre>/** * Node = HashMapçš„å†…éƒ¨ç±»ï¼Œå®ç°äº†Map.Entryæ¥å£ï¼Œæœ¬è´¨æ˜¯ = ä¸€ä¸ªæ˜ å°„(é”®å€¼å¯¹) * å®ç°äº†getKey()ã€getValue()ã€equals(Object o)å’ŒhashCode()ç­‰æ–¹æ³• **/  static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; { final int hash; // å“ˆå¸Œå€¼ï¼ŒHashMapæ ¹æ®è¯¥å€¼ç¡®å®šè®°å½•çš„ä½ç½® final K key; // key V value; // value Node&lt;K,V&gt; next;// é“¾è¡¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ // æ„é€ æ–¹æ³• Node(int hash, K key, V value, Node&lt;K,V&gt; next) { this.hash = hash; this.key = key; this.value = value; this.next = next; } public final K getKey() { return key; } // è¿”å› ä¸ æ­¤é¡¹ å¯¹åº”çš„é”® public final V getValue() { return value; } // è¿”å› ä¸ æ­¤é¡¹ å¯¹åº”çš„å€¼ public final String toString() { return key + "=" + value; }  public final V setValue(V newValue) { V oldValue = value; value = newValue; return oldValue; } /** * hashCodeï¼ˆï¼‰ */ public final int hashCode() {  return Objects.hashCode(key) ^ Objects.hashCode(value); } /** * equalsï¼ˆï¼‰ * ä½œç”¨ï¼šåˆ¤æ–­2ä¸ªEntryæ˜¯å¦ç›¸ç­‰ï¼Œå¿…é¡»keyå’Œvalueéƒ½ç›¸ç­‰ï¼Œæ‰è¿”å›true  */ public final boolean equals(Object o) {  if (o == this)  return true;  if (o instanceof Map.Entry) { Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;  if (Objects.equals(key, e.getKey()) &amp;&amp; Objects.equals(value, e.getValue()))  return true; } return false; } }</pre><p><strong>2.4 çº¢é»‘æ ‘èŠ‚ç‚¹ å®ç°ç±»</strong><br></p><p><code>HashMap<span>ä¸­çš„çº¢é»‘æ ‘èŠ‚ç‚¹ é‡‡ç”¨ </span>TreeNode<span>ç±» å®ç°</span></code></p><pre>/** * çº¢é»‘æ ‘èŠ‚ç‚¹ å®ç°ç±»ï¼šç»§æ‰¿è‡ªLinkedHashMap.Entry&lt;K,V&gt;ç±» */ static final class TreeNode&lt;K,V&gt; extends LinkedHashMap.Entry&lt;K,V&gt; {  // å±æ€§ = çˆ¶èŠ‚ç‚¹ã€å·¦å­æ ‘ã€å³å­æ ‘ã€åˆ é™¤è¾…åŠ©èŠ‚ç‚¹ + é¢œè‰² TreeNode&lt;K,V&gt; parent;  TreeNode&lt;K,V&gt; left;  TreeNode&lt;K,V&gt; right; TreeNode&lt;K,V&gt; prev;  boolean red;  // æ„é€ å‡½æ•° TreeNode(int hash, K key, V val, Node&lt;K,V&gt; next) {  super(hash, key, val, next);  }  // è¿”å›å½“å‰èŠ‚ç‚¹çš„æ ¹èŠ‚ç‚¹  final TreeNode&lt;K,V&gt; root() {  for (TreeNode&lt;K,V&gt; r = this, p;;) {  if ((p = r.parent) == null)  return r;  r = p;  }  } 12345678910111213141516171819202122232425</pre><hr><h1></h1><p>3. å…·ä½“ä½¿ç”¨</p><p>3.1 ä¸»è¦ä½¿ç”¨APIï¼ˆæ–¹æ³•ã€å‡½æ•°ï¼‰</p><blockquote><p>ä¸ <code>JDK 1.7</code> åŸºæœ¬ç›¸åŒ</p></blockquote><pre>V get(Object key); // è·å¾—æŒ‡å®šé”®çš„å€¼V put(K key, V value); // æ·»åŠ é”®å€¼å¯¹void putAll(Map&lt;? extends K, ? extends V&gt; m); // å°†æŒ‡å®šMapä¸­çš„é”®å€¼å¯¹ å¤åˆ¶åˆ° æ­¤Mapä¸­V remove(Object key); // åˆ é™¤è¯¥é”®å€¼å¯¹boolean containsKey(Object key); // åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¯¥é”®çš„é”®å€¼å¯¹ï¼›æ˜¯ åˆ™è¿”å›trueboolean containsValue(Object value); // åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¯¥å€¼çš„é”®å€¼å¯¹ï¼›æ˜¯ åˆ™è¿”å›trueSet&lt;K&gt; keySet(); // å•ç‹¬æŠ½å–keyåºåˆ—ï¼Œå°†æ‰€æœ‰keyç”Ÿæˆä¸€ä¸ªSetCollection&lt;V&gt; values(); // å•ç‹¬valueåºåˆ—ï¼Œå°†æ‰€æœ‰valueç”Ÿæˆä¸€ä¸ªCollectionvoid clear(); // æ¸…é™¤å“ˆå¸Œè¡¨ä¸­çš„æ‰€æœ‰é”®å€¼å¯¹int size(); // è¿”å›å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰ é”®å€¼å¯¹çš„æ•°é‡ = æ•°ç»„ä¸­çš„é”®å€¼å¯¹ + é“¾è¡¨ä¸­çš„é”®å€¼å¯¹boolean isEmpty(); // åˆ¤æ–­HashMapæ˜¯å¦ä¸ºç©ºï¼›size == 0æ—¶ è¡¨ç¤ºä¸º ç©º 123456789101112131415</pre><p><strong>3.2 ä½¿ç”¨æµç¨‹</strong></p><blockquote><p>ä¸ <span>JDK 1.7</span>åŸºæœ¬ç›¸åŒ</p></blockquote><ul class=list-paddingleft-2><li><p>åœ¨å…·ä½“ä½¿ç”¨æ—¶ï¼Œä¸»è¦æµç¨‹æ˜¯ï¼š</p></li></ul><p>å£°æ˜1ä¸ª <span>HashMap</span>çš„å¯¹è±¡</p><p>å‘ <span>HashMap</span><br>æ·»åŠ æ•°æ®ï¼ˆæˆå¯¹ æ”¾å…¥ é”® - å€¼å¯¹ï¼‰</p><ol class=list-paddingleft-2><li><p>è·å– <code>HashMap</code> çš„æŸä¸ªæ•°æ®</p></li><li><p>è·å– <code>HashMap</code> çš„å…¨éƒ¨æ•°æ®ï¼šéå†<code>HashMap</code></p></li></ol><ul class=list-paddingleft-2><li><p>ç¤ºä¾‹ä»£ç </p></li></ul><pre>import java.util.Collection;import java.util.HashMap;import java.util.Iterator;import java.util.Map;import java.util.Set;public class HashMapTest { public static void main(String[] args) { /** * 1. å£°æ˜1ä¸ª HashMapçš„å¯¹è±¡ */ Map&lt;String, Integer&gt; map = new HashMap&lt;String, Integer&gt;(); /** * 2. å‘HashMapæ·»åŠ æ•°æ®ï¼ˆæˆå¯¹ æ”¾å…¥ é”® - å€¼å¯¹ï¼‰ */ map.put("Android", 1); map.put("Java", 2); map.put("iOS", 3); map.put("æ•°æ®æŒ–æ˜", 4); map.put("äº§å“ç»ç†", 5); /** * 3. è·å– HashMap çš„æŸä¸ªæ•°æ® */ System.out.println("key = äº§å“ç»ç†æ—¶çš„å€¼ä¸ºï¼š" + map.get("äº§å“ç»ç†")); /** * 4. è·å– HashMap çš„å…¨éƒ¨æ•°æ®ï¼šéå†HashMap * æ ¸å¿ƒæ€æƒ³ï¼š * æ­¥éª¤1ï¼šè·å¾—key-valueå¯¹ï¼ˆEntryï¼‰ æˆ– key æˆ– valueçš„Seté›†åˆ * æ­¥éª¤2ï¼šéå†ä¸Šè¿°Seté›†åˆ(ä½¿ç”¨forå¾ªç¯ ã€ è¿­ä»£å™¨ï¼ˆIteratorï¼‰å‡å¯) * æ–¹æ³•å…±æœ‰3ç§ï¼šåˆ†åˆ«é’ˆå¯¹ key-valueå¯¹ï¼ˆEntryï¼‰ æˆ– key æˆ– value */ // æ–¹æ³•1ï¼šè·å¾—key-valueçš„Seté›†åˆ å†éå† System.out.println("æ–¹æ³•1"); // 1. è·å¾—key-valueå¯¹ï¼ˆEntryï¼‰çš„Seté›†åˆ  Set&lt;Map.Entry&lt;String, Integer&gt;&gt; entrySet = map.entrySet(); // 2. éå†Seté›†åˆï¼Œä»è€Œè·å–key-value // 2.1 é€šè¿‡forå¾ªç¯ for(Map.Entry&lt;String, Integer&gt; entry : entrySet){ System.out.print(entry.getKey()); System.out.println(entry.getValue()); } System.out.println("----------"); // 2.2 é€šè¿‡è¿­ä»£å™¨ï¼šå…ˆè·å¾—key-valueå¯¹ï¼ˆEntryï¼‰çš„Iteratorï¼Œå†å¾ªç¯éå† Iterator iter1 = entrySet.iterator(); while (iter1.hasNext()) { // éå†æ—¶ï¼Œéœ€å…ˆè·å–entryï¼Œå†åˆ†åˆ«è·å–keyã€value Map.Entry entry = (Map.Entry) iter1.next(); System.out.print((String) entry.getKey()); System.out.println((Integer) entry.getValue()); } // æ–¹æ³•2ï¼šè·å¾—keyçš„Seté›†åˆ å†éå† System.out.println("æ–¹æ³•2"); // 1. è·å¾—keyçš„Seté›†åˆ Set&lt;String&gt; keySet = map.keySet(); // 2. éå†Seté›†åˆï¼Œä»è€Œè·å–keyï¼Œå†è·å–value // 2.1 é€šè¿‡forå¾ªç¯ for(String key : keySet){ System.out.print(key); System.out.println(map.get(key)); } System.out.println("----------"); // 2.2 é€šè¿‡è¿­ä»£å™¨ï¼šå…ˆè·å¾—keyçš„Iteratorï¼Œå†å¾ªç¯éå† Iterator iter2 = keySet.iterator(); String key = null; while (iter2.hasNext()) { key = (String)iter2.next(); System.out.print(key); System.out.println(map.get(key)); } // æ–¹æ³•3ï¼šè·å¾—valueçš„Seté›†åˆ å†éå† System.out.println("æ–¹æ³•3"); // 1. è·å¾—valueçš„Seté›†åˆ Collection valueSet = map.values(); // 2. éå†Seté›†åˆï¼Œä»è€Œè·å–value // 2.1 è·å¾—values çš„Iterator Iterator iter3 = valueSet.iterator(); // 2.2 é€šè¿‡éå†ï¼Œç›´æ¥è·å–value while (iter3.hasNext()) { System.out.println(iter3.next()); } }}// æ³¨ï¼šå¯¹äºéå†æ–¹å¼ï¼Œæ¨èä½¿ç”¨é’ˆå¯¹ key-valueå¯¹ï¼ˆEntryï¼‰çš„æ–¹å¼ï¼šæ•ˆç‡é«˜// åŸå› ï¼š // 1. å¯¹äº éå†keySet ã€valueSetï¼Œå®è´¨ä¸Š = éå†äº†2æ¬¡ï¼š1 = è½¬ä¸º iterator è¿­ä»£å™¨éå†ã€2 = ä» HashMap ä¸­å–å‡º key çš„ value æ“ä½œï¼ˆé€šè¿‡ key å€¼ hashCode å’Œ equals ç´¢å¼•ï¼‰ // 2. å¯¹äº éå† entrySet ï¼Œå®è´¨ = éå†äº†1æ¬¡ = è·å–å­˜å‚¨å®ä½“Entryï¼ˆå­˜å‚¨äº†key å’Œ value ï¼‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106</pre><ul class=list-paddingleft-2><li><p>è¿è¡Œç»“æœ</p></li></ul><pre>æ–¹æ³•1Java2iOS3æ•°æ®æŒ–æ˜4Android1äº§å“ç»ç†5----------Java2iOS3æ•°æ®æŒ–æ˜4Android1äº§å“ç»ç†5æ–¹æ³•2Java2iOS3æ•°æ®æŒ–æ˜4Android1äº§å“ç»ç†5----------Java2iOS3æ•°æ®æŒ–æ˜4Android1äº§å“ç»ç†5æ–¹æ³•3</pre><p>ä¸‹é¢ï¼Œæˆ‘ä»¬æŒ‰ç…§ä¸Šè¿°çš„ä½¿ç”¨è¿‡ç¨‹ï¼Œå¯¹ä¸€ä¸ªä¸ªæ­¥éª¤è¿›è¡Œæºç è§£æ</p><hr><h1></h1><p>4. åŸºç¡€çŸ¥è¯†ï¼šHashMapä¸­çš„é‡è¦å‚æ•°ï¼ˆå˜é‡ï¼‰</p><ul class=list-paddingleft-2><li><p>åœ¨è¿›è¡ŒçœŸæ­£çš„æºç åˆ†æå‰ï¼Œå…ˆè®²è§£<code>HashMap</code>ä¸­çš„é‡è¦å‚æ•°ï¼ˆå˜é‡ï¼‰</p></li><li><p><code>HashMap</code>ä¸­çš„ä¸»è¦å‚æ•° åŒ <code>JDK 1.7</code> ï¼Œå³ï¼šå®¹é‡ã€åŠ è½½å› å­ã€æ‰©å®¹é˜ˆå€¼</p></li><li><p>ä½†ç”±äºæ•°æ®ç»“æ„ä¸­å¼•å…¥äº† çº¢é»‘æ ‘ï¼Œæ•…åŠ å…¥äº† ä¸çº¢é»‘æ ‘ç›¸å…³çš„å‚æ•°ã€‚å…·ä½“ä»‹ç»å¦‚ä¸‹ï¼š</p></li></ul><pre>/** * ä¸»è¦å‚æ•° åŒ JDK 1.7 * å³ï¼šå®¹é‡ã€åŠ è½½å› å­ã€æ‰©å®¹é˜ˆå€¼ï¼ˆè¦æ±‚ã€èŒƒå›´å‡ç›¸åŒï¼‰ */ // 1. å®¹é‡ï¼ˆcapacityï¼‰ï¼š å¿…é¡»æ˜¯2çš„å¹‚ &amp; &lt;æœ€å¤§å®¹é‡ï¼ˆ2çš„30æ¬¡æ–¹ï¼‰ static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4; // é»˜è®¤å®¹é‡ = 16 = 1&lt;&lt;4 = 00001ä¸­çš„1å‘å·¦ç§»4ä½ = 10000 = åè¿›åˆ¶çš„2^4=16 static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30; // æœ€å¤§å®¹é‡ = 2çš„30æ¬¡æ–¹ï¼ˆè‹¥ä¼ å…¥çš„å®¹é‡è¿‡å¤§ï¼Œå°†è¢«æœ€å¤§å€¼æ›¿æ¢ï¼‰ // 2. åŠ è½½å› å­(Load factor)ï¼šHashMapåœ¨å…¶å®¹é‡è‡ªåŠ¨å¢åŠ å‰å¯è¾¾åˆ°å¤šæ»¡çš„ä¸€ç§å°ºåº¦ final float loadFactor; // å®é™…åŠ è½½å› å­ static final float DEFAULT_LOAD_FACTOR = 0.75f; // é»˜è®¤åŠ è½½å› å­ = 0.75 // 3. æ‰©å®¹é˜ˆå€¼ï¼ˆthresholdï¼‰ï¼šå½“å“ˆå¸Œè¡¨çš„å¤§å° â‰¥ æ‰©å®¹é˜ˆå€¼æ—¶ï¼Œå°±ä¼šæ‰©å®¹å“ˆå¸Œè¡¨ï¼ˆå³æ‰©å……HashMapçš„å®¹é‡ï¼‰ // a. æ‰©å®¹ = å¯¹å“ˆå¸Œè¡¨è¿›è¡Œresizeæ“ä½œï¼ˆå³é‡å»ºå†…éƒ¨æ•°æ®ç»“æ„ï¼‰ï¼Œä»è€Œå“ˆå¸Œè¡¨å°†å…·æœ‰å¤§çº¦ä¸¤å€çš„æ¡¶æ•° // b. æ‰©å®¹é˜ˆå€¼ = å®¹é‡ x åŠ è½½å› å­ int threshold; // 4. å…¶ä»– transient Node&lt;K,V&gt;[] table; // å­˜å‚¨æ•°æ®çš„Nodeç±»å‹ æ•°ç»„ï¼Œé•¿åº¦ = 2çš„å¹‚ï¼›æ•°ç»„çš„æ¯ä¸ªå…ƒç´  = 1ä¸ªå•é“¾è¡¨ transient int size;// HashMapçš„å¤§å°ï¼Œå³ HashMapä¸­å­˜å‚¨çš„é”®å€¼å¯¹çš„æ•°é‡ /** * ä¸çº¢é»‘æ ‘ç›¸å…³çš„å‚æ•° */ // 1. æ¡¶çš„æ ‘åŒ–é˜ˆå€¼ï¼šå³ é“¾è¡¨è½¬æˆçº¢é»‘æ ‘çš„é˜ˆå€¼ï¼Œåœ¨å­˜å‚¨æ•°æ®æ—¶ï¼Œå½“é“¾è¡¨é•¿åº¦ &gt; è¯¥å€¼æ—¶ï¼Œåˆ™å°†é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘ static final int TREEIFY_THRESHOLD = 8; // 2. æ¡¶çš„é“¾è¡¨è¿˜åŸé˜ˆå€¼ï¼šå³ çº¢é»‘æ ‘è½¬ä¸ºé“¾è¡¨çš„é˜ˆå€¼ï¼Œå½“åœ¨æ‰©å®¹ï¼ˆresizeï¼ˆï¼‰ï¼‰æ—¶ï¼ˆæ­¤æ—¶HashMapçš„æ•°æ®å­˜å‚¨ä½ç½®ä¼šé‡æ–°è®¡ç®—ï¼‰ï¼Œåœ¨é‡æ–°è®¡ç®—å­˜å‚¨ä½ç½®åï¼Œå½“åŸæœ‰çš„çº¢é»‘æ ‘å†…æ•°é‡ &lt; 6æ—¶ï¼Œåˆ™å°† çº¢é»‘æ ‘è½¬æ¢æˆé“¾è¡¨ static final int UNTREEIFY_THRESHOLD = 6; // 3. æœ€å°æ ‘å½¢åŒ–å®¹é‡é˜ˆå€¼ï¼šå³ å½“å“ˆå¸Œè¡¨ä¸­çš„å®¹é‡ &gt; è¯¥å€¼æ—¶ï¼Œæ‰å…è®¸æ ‘å½¢åŒ–é“¾è¡¨ ï¼ˆå³ å°†é“¾è¡¨ è½¬æ¢æˆçº¢é»‘æ ‘ï¼‰ // å¦åˆ™ï¼Œè‹¥æ¡¶å†…å…ƒç´ å¤ªå¤šæ—¶ï¼Œåˆ™ç›´æ¥æ‰©å®¹ï¼Œè€Œä¸æ˜¯æ ‘å½¢åŒ– // ä¸ºäº†é¿å…è¿›è¡Œæ‰©å®¹ã€æ ‘å½¢åŒ–é€‰æ‹©çš„å†²çªï¼Œè¿™ä¸ªå€¼ä¸èƒ½å°äº 4 * TREEIFY_THRESHOLD static final int MIN_TREEIFY_CAPACITY = 64;1234567891011121314151617181920212223242526272829303132333435</pre><ul class=list-paddingleft-2><li><p>æ­¤å¤„ å†æ¬¡è¯¦ç»†è¯´æ˜ åŠ è½½å› å­</p><blockquote><p>åŒ <code>JDK 1.7</code>ï¼Œä½†ç”±äºå…¶é‡è¦æ€§ï¼Œæ•…æ­¤å¤„å†æ¬¡è¯´æ˜</p></blockquote></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c40005d5e78ac067ca></p><ul class=list-paddingleft-2><li><p>æ€»ç»“ æ•°æ®ç»“æ„ & å‚æ•°æ–¹é¢ä¸ <code>JDK 1.7</code>çš„åŒºåˆ«</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c600059db5d3b92c0b></p><hr><h1></h1><p>5. æºç åˆ†æ</p><ul class=list-paddingleft-2><li><p>æœ¬æ¬¡çš„æºç åˆ†æä¸»è¦æ˜¯æ ¹æ® ä½¿ç”¨æ­¥éª¤ è¿›è¡Œç›¸å…³å‡½æ•°çš„è¯¦ç»†åˆ†æ</p></li><li><p>ä¸»è¦åˆ†æå†…å®¹å¦‚ä¸‹ï¼š</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c50005b18388095faa></p><ul class=list-paddingleft-2><li><p>ä¸‹é¢ï¼Œæˆ‘å°†å¯¹æ¯ä¸ªæ­¥éª¤å†…å®¹çš„ä¸»è¦æ–¹æ³•è¿›è¡Œè¯¦ç»†åˆ†æ</p></li></ul><p>æ­¥éª¤1ï¼šå£°æ˜1ä¸ª HashMapçš„å¯¹è±¡</p><blockquote><p>æ­¤å¤„ä¸»è¦åˆ†æçš„æ„é€ å‡½æ•° ç±»ä¼¼ <code>JDK 1.7</code></p></blockquote><pre>/** * å‡½æ•°ä½¿ç”¨åŸå‹ */ Map&lt;String,Integer&gt; map = new HashMap&lt;String,Integer&gt;(); /** * æºç åˆ†æï¼šä¸»è¦æ˜¯HashMapçš„æ„é€ å‡½æ•° = 4ä¸ª * ä»…è´´å‡ºå…³äºHashMapæ„é€ å‡½æ•°çš„æºç  */public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt; implements Map&lt;K,V&gt;, Cloneable, Serializable{ // çœç•¥ä¸ŠèŠ‚é˜è¿°çš„å‚æ•° /** * æ„é€ å‡½æ•°1ï¼šé»˜è®¤æ„é€ å‡½æ•°ï¼ˆæ— å‚ï¼‰ * åŠ è½½å› å­ &amp; å®¹é‡ = é»˜è®¤ = 0.75ã€16 */ public HashMap() { this.loadFactor = DEFAULT_LOAD_FACTOR; } /** * æ„é€ å‡½æ•°2ï¼šæŒ‡å®šâ€œå®¹é‡å¤§å°â€çš„æ„é€ å‡½æ•° * åŠ è½½å› å­ = é»˜è®¤ = 0.75 ã€å®¹é‡ = æŒ‡å®šå¤§å° */ public HashMap(int initialCapacity) { // å®é™…ä¸Šæ˜¯è°ƒç”¨æŒ‡å®šâ€œå®¹é‡å¤§å°â€å’Œâ€œåŠ è½½å› å­â€çš„æ„é€ å‡½æ•° // åªæ˜¯åœ¨ä¼ å…¥çš„åŠ è½½å› å­å‚æ•° = é»˜è®¤åŠ è½½å› å­ this(initialCapacity, DEFAULT_LOAD_FACTOR); } /** * æ„é€ å‡½æ•°3ï¼šæŒ‡å®šâ€œå®¹é‡å¤§å°â€å’Œâ€œåŠ è½½å› å­â€çš„æ„é€ å‡½æ•° * åŠ è½½å› å­ &amp; å®¹é‡ = è‡ªå·±æŒ‡å®š */ public HashMap(int initialCapacity, float loadFactor) { // æŒ‡å®šåˆå§‹å®¹é‡å¿…é¡»éè´Ÿï¼Œå¦åˆ™æŠ¥é”™  if (initialCapacity &lt; 0)  throw new IllegalArgumentException("Illegal initial capacity: " +  initialCapacity); // HashMapçš„æœ€å¤§å®¹é‡åªèƒ½æ˜¯MAXIMUM_CAPACITYï¼Œå“ªæ€•ä¼ å…¥çš„ &gt; æœ€å¤§å®¹é‡ if (initialCapacity &gt; MAXIMUM_CAPACITY) initialCapacity = MAXIMUM_CAPACITY; // å¡«å……æ¯”å¿…é¡»ä¸ºæ­£  if (loadFactor &lt;= 0 || Float.isNaN(loadFactor))  throw new IllegalArgumentException("Illegal load factor: " +  loadFactor);  // è®¾ç½® åŠ è½½å› å­ this.loadFactor = loadFactor; // è®¾ç½® æ‰©å®¹é˜ˆå€¼ // æ³¨ï¼šæ­¤å¤„ä¸æ˜¯çœŸæ­£çš„é˜ˆå€¼ï¼Œä»…ä»…åªæ˜¯å°†ä¼ å…¥çš„å®¹é‡å¤§å°è½¬åŒ–ä¸ºï¼š&gt;ä¼ å…¥å®¹é‡å¤§å°çš„æœ€å°çš„2çš„å¹‚ï¼Œè¯¥é˜ˆå€¼åé¢ä¼šé‡æ–°è®¡ç®— // ä¸‹é¢ä¼šè¯¦ç»†è®²è§£ -&gt;&gt; åˆ†æ1 this.threshold = tableSizeFor(initialCapacity); } /** * æ„é€ å‡½æ•°4ï¼šåŒ…å«â€œå­Mapâ€çš„æ„é€ å‡½æ•° * å³ æ„é€ å‡ºæ¥çš„HashMapåŒ…å«ä¼ å…¥Mapçš„æ˜ å°„å…³ç³» * åŠ è½½å› å­ &amp; å®¹é‡ = é»˜è®¤ */ public HashMap(Map&lt;? extends K, ? extends V&gt; m) { // è®¾ç½®å®¹é‡å¤§å° &amp; åŠ è½½å› å­ = é»˜è®¤ this.loadFactor = DEFAULT_LOAD_FACTOR; // å°†ä¼ å…¥çš„å­Mapä¸­çš„å…¨éƒ¨å…ƒç´ é€ä¸ªæ·»åŠ åˆ°HashMapä¸­ putMapEntries(m, false); }} /** * åˆ†æ1ï¼štableSizeFor(initialCapacity) * ä½œç”¨ï¼šå°†ä¼ å…¥çš„å®¹é‡å¤§å°è½¬åŒ–ä¸ºï¼š&gt;ä¼ å…¥å®¹é‡å¤§å°çš„æœ€å°çš„2çš„å¹‚ * ä¸JDK 1.7å¯¹æ¯”ï¼šç±»ä¼¼äºJDK 1.7 ä¸­ inflateTable()é‡Œçš„ roundUpToPowerOf2(toSize) */ static final int tableSizeFor(int cap) { int n = cap - 1; n |= n &gt;&gt;&gt; 1; n |= n &gt;&gt;&gt; 2; n |= n &gt;&gt;&gt; 4; n |= n &gt;&gt;&gt; 8; n |= n &gt;&gt;&gt; 16; return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;}12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394</pre><ul class=list-paddingleft-2><li><p>æ³¨ï¼šï¼ˆåŒ<code>JDK 1.7</code>ç±»ä¼¼ï¼‰</p></li></ul><ol class=list-paddingleft-2><li><p>æ­¤å¤„ä»…ç”¨äºæ¥æ”¶åˆå§‹å®¹é‡å¤§å°ï¼ˆ<code>capacity</code>ï¼‰ã€åŠ è½½å› å­(<code>Load factor</code>)ï¼Œä½†ä»æ— çœŸæ­£åˆå§‹åŒ–å“ˆå¸Œè¡¨ï¼Œå³åˆå§‹åŒ–å­˜å‚¨æ•°ç»„<code>table</code></p></li><li><p>æ­¤å¤„å…ˆç»™å‡ºç»“è®ºï¼šçœŸæ­£åˆå§‹åŒ–å“ˆå¸Œè¡¨ï¼ˆåˆå§‹åŒ–å­˜å‚¨æ•°ç»„<code>table</code>ï¼‰æ˜¯åœ¨ç¬¬1æ¬¡æ·»åŠ é”®å€¼å¯¹æ—¶ï¼Œå³ç¬¬1æ¬¡è°ƒç”¨<code>putï¼ˆï¼‰</code>æ—¶ã€‚ä¸‹é¢ä¼šè¯¦ç»†è¯´æ˜</p></li></ol><p>è‡³æ­¤ï¼Œå…³äº<code>HashMap</code>çš„æ„é€ å‡½æ•°è®²è§£å®Œæ¯•ã€‚</p><hr><p>æ­¥éª¤2ï¼šå‘HashMapæ·»åŠ æ•°æ®ï¼ˆæˆå¯¹ æ”¾å…¥ é”® - å€¼å¯¹ï¼‰</p><ul class=list-paddingleft-2><li><p>åœ¨è¯¥æ­¥éª¤ä¸­ï¼Œä¸<code>JDK 1.7</code>çš„å·®åˆ«è¾ƒå¤§ï¼š</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c40005d5e94511f385></p><blockquote><p>ä¸‹é¢ä¼šå¯¹ä¸Šè¿°åŒºåˆ«è¿›è¡Œè¯¦ç»†è®²è§£</p></blockquote><ul class=list-paddingleft-2><li><p>æ·»åŠ æ•°æ®çš„æµç¨‹å¦‚ä¸‹</p></li></ul><blockquote><p>æ³¨ï¼šä¸ºäº†è®©å¤§å®¶æœ‰ä¸ªæ„Ÿæ€§çš„è®¤è¯†ï¼Œåªæ˜¯ç®€å•çš„ç”»å‡ºå­˜å‚¨æµç¨‹ï¼Œæ›´åŠ è¯¦ç»† & å…·ä½“çš„å­˜å‚¨æµç¨‹ä¼šåœ¨ä¸‹é¢æºç åˆ†æä¸­ç»™å‡º</p></blockquote><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c50005b1824587d233></p><ul class=list-paddingleft-2><li><p>æºç åˆ†æ</p></li></ul><pre>/** * å‡½æ•°ä½¿ç”¨åŸå‹ */ map.put("Android", 1); map.put("Java", 2); map.put("iOS", 3); map.put("æ•°æ®æŒ–æ˜", 4); map.put("äº§å“ç»ç†", 5); /** * æºç åˆ†æï¼šä¸»è¦åˆ†æHashMapçš„putå‡½æ•° */ public V put(K key, V value) { // 1. å¯¹ä¼ å…¥æ•°ç»„çš„é”®Keyè®¡ç®—Hashå€¼ -&gt;&gt;åˆ†æ1 // 2. å†è°ƒç”¨putValï¼ˆï¼‰æ·»åŠ æ•°æ®è¿›å» -&gt;&gt;åˆ†æ2 return putVal(hash(key), key, value, false, true); }1234567891011121314151617</pre><p>ä¸‹é¢ï¼Œå°†è¯¦ç»†è®²è§£ ä¸Šé¢çš„2ä¸ªä¸»è¦åˆ†æç‚¹</p><p>åˆ†æ1ï¼šhashï¼ˆkeyï¼‰</p><pre> /** * åˆ†æ1ï¼šhash(key) * ä½œç”¨ï¼šè®¡ç®—ä¼ å…¥æ•°æ®çš„å“ˆå¸Œç ï¼ˆå“ˆå¸Œå€¼ã€Hashå€¼ï¼‰ * è¯¥å‡½æ•°åœ¨JDK 1.7 å’Œ 1.8 ä¸­çš„å®ç°ä¸åŒï¼Œä½†åŸç†ä¸€æ · = æ‰°åŠ¨å‡½æ•° = ä½¿å¾—æ ¹æ®keyç”Ÿæˆçš„å“ˆå¸Œç ï¼ˆhashå€¼ï¼‰åˆ†å¸ƒæ›´åŠ å‡åŒ€ã€æ›´å…·å¤‡éšæœºæ€§ï¼Œé¿å…å‡ºç°hashå€¼å†²çªï¼ˆå³æŒ‡ä¸åŒkeyä½†ç”ŸæˆåŒ1ä¸ªhashå€¼ï¼‰ * JDK 1.7 åšäº†9æ¬¡æ‰°åŠ¨å¤„ç† = 4æ¬¡ä½è¿ç®— + 5æ¬¡å¼‚æˆ–è¿ç®— * JDK 1.8 ç®€åŒ–äº†æ‰°åŠ¨å‡½æ•° = åªåšäº†2æ¬¡æ‰°åŠ¨ = 1æ¬¡ä½è¿ç®— + 1æ¬¡å¼‚æˆ–è¿ç®— */ // JDK 1.7å®ç°ï¼šå°† é”®key è½¬æ¢æˆ å“ˆå¸Œç ï¼ˆhashå€¼ï¼‰æ“ä½œ = ä½¿ç”¨hashCode() + 4æ¬¡ä½è¿ç®— + 5æ¬¡å¼‚æˆ–è¿ç®—ï¼ˆ9æ¬¡æ‰°åŠ¨ï¼‰ static final int hash(int h) { h ^= k.hashCode(); h ^= (h &gt;&gt;&gt; 20) ^ (h &gt;&gt;&gt; 12); return h ^ (h &gt;&gt;&gt; 7) ^ (h &gt;&gt;&gt; 4); } // JDK 1.8å®ç°ï¼šå°† é”®key è½¬æ¢æˆ å“ˆå¸Œç ï¼ˆhashå€¼ï¼‰æ“ä½œ = ä½¿ç”¨hashCode() + 1æ¬¡ä½è¿ç®— + 1æ¬¡å¼‚æˆ–è¿ç®—ï¼ˆ2æ¬¡æ‰°åŠ¨ï¼‰ // 1. å–hashCodeå€¼ï¼š h = key.hashCode() // 2. é«˜ä½å‚ä¸ä½ä½çš„è¿ç®—ï¼šh ^ (h &gt;&gt;&gt; 16)  static final int hash(Object key) { int h; return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16); // a. å½“key = nullæ—¶ï¼Œhashå€¼ = 0ï¼Œæ‰€ä»¥HashMapçš„key å¯ä¸ºnull  // æ³¨ï¼šå¯¹æ¯”HashTableï¼ŒHashTableå¯¹keyç›´æ¥hashCodeï¼ˆï¼‰ï¼Œè‹¥keyä¸ºnullæ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæ‰€ä»¥HashTableçš„keyä¸å¯ä¸ºnull // b. å½“key â‰  nullæ—¶ï¼Œåˆ™é€šè¿‡å…ˆè®¡ç®—å‡º keyçš„ hashCode()ï¼ˆè®°ä¸ºhï¼‰ï¼Œç„¶å å¯¹å“ˆå¸Œç è¿›è¡Œ æ‰°åŠ¨å¤„ç†ï¼š æŒ‰ä½ å¼‚æˆ–ï¼ˆ^ï¼‰ å“ˆå¸Œç è‡ªèº«å³ç§»16ä½åçš„äºŒè¿›åˆ¶ } /** * è®¡ç®—å­˜å‚¨ä½ç½®çš„å‡½æ•°åˆ†æï¼šindexFor(hash, table.length) * æ³¨ï¼šè¯¥å‡½æ•°ä»…å­˜åœ¨äºJDK 1.7 ï¼ŒJDK 1.8ä¸­å®é™…ä¸Šæ— è¯¥å‡½æ•°ï¼ˆç›´æ¥ç”¨1æ¡è¯­å¥åˆ¤æ–­å†™å‡ºï¼‰ï¼Œä½†åŸç†ç›¸åŒ * ä¸ºäº†æ–¹ä¾¿è®²è§£ï¼Œæ•…æå‰åˆ°æ­¤è®²è§£ */ static int indexFor(int h, int length) {  return h &amp; (length-1); // å°†å¯¹å“ˆå¸Œç æ‰°åŠ¨å¤„ç†åçš„ç»“æœ ä¸è¿ç®—(&amp;) ï¼ˆæ•°ç»„é•¿åº¦-1ï¼‰ï¼Œæœ€ç»ˆå¾—åˆ°å­˜å‚¨åœ¨æ•°ç»„tableçš„ä½ç½®ï¼ˆå³æ•°ç»„ä¸‹æ ‡ã€ç´¢å¼•ï¼‰ }1234567891011121314151617181920212223242526272829303132333435</pre><ul class=list-paddingleft-2><li><p>æ€»ç»“ è®¡ç®—å­˜æ”¾åœ¨æ•°ç»„ table ä¸­çš„ä½ç½®ï¼ˆå³æ•°ç»„ä¸‹æ ‡ã€ç´¢å¼•ï¼‰çš„è¿‡ç¨‹</p></li></ul><ol class=list-paddingleft-2><li><p>æ­¤å¤„ä¸ <code>JDK 1.7</code>çš„åŒºåˆ«åœ¨äºï¼š<code>hash</code>å€¼çš„æ±‚è§£è¿‡ç¨‹ä¸­ å“ˆå¸Œç çš„äºŒæ¬¡å¤„ç†æ–¹å¼ï¼ˆæ‰°åŠ¨å¤„ç†ï¼‰</p></li><li><p>æ­¥éª¤1ã€2 = <code>hash</code>å€¼çš„æ±‚è§£è¿‡ç¨‹</p></li></ol><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/6c2c0000784ee1c19294></p><ul class=list-paddingleft-2><li><p>è®¡ç®—ç¤ºæ„å›¾</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/66c600059db69a50fddc></p><hr><p>åœ¨äº†è§£ å¦‚ä½•è®¡ç®—å­˜æ”¾æ•°ç»„<code>table</code> ä¸­çš„ä½ç½® åï¼Œæ‰€è°“ çŸ¥å…¶ç„¶ è€Œ éœ€çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œä¸‹é¢æˆ‘å°†è®²è§£ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¡ç®—ï¼Œå³ä¸»è¦è§£ç­”ä»¥ä¸‹3ä¸ªé—®é¢˜ï¼š</p><p>1. ä¸ºä»€ä¹ˆä¸ç›´æ¥é‡‡ç”¨ç»è¿‡<code>hashCodeï¼ˆï¼‰</code>å¤„ç†çš„å“ˆå¸Œç  ä½œä¸º å­˜å‚¨æ•°ç»„<code>table</code>çš„ä¸‹æ ‡ä½ç½®ï¼Ÿ</p><p>2. ä¸ºä»€ä¹ˆé‡‡ç”¨ å“ˆå¸Œç  ä¸è¿ç®—(&) ï¼ˆæ•°ç»„é•¿åº¦-1ï¼‰ è®¡ç®—æ•°ç»„ä¸‹æ ‡ï¼Ÿ</p><p>3. ä¸ºä»€ä¹ˆåœ¨è®¡ç®—æ•°ç»„ä¸‹æ ‡å‰ï¼Œéœ€å¯¹å“ˆå¸Œç è¿›è¡ŒäºŒæ¬¡å¤„ç†ï¼šæ‰°åŠ¨å¤„ç†ï¼Ÿ</p><p>åœ¨å›ç­”è¿™3ä¸ªé—®é¢˜å‰ï¼Œè¯·å¤§å®¶è®°ä½ä¸€ä¸ªæ ¸å¿ƒæ€æƒ³ï¼š</p><blockquote><p>æ‰€æœ‰å¤„ç†çš„æ ¹æœ¬ç›®çš„ï¼Œéƒ½æ˜¯ä¸ºäº†æé«˜ å­˜å‚¨<code>key-value</code>çš„æ•°ç»„ä¸‹æ ‡ä½ç½® çš„éšæœºæ€§ & åˆ†å¸ƒå‡åŒ€æ€§ï¼Œå°½é‡é¿å…å‡ºç°hashå€¼å†²çªã€‚å³ï¼šå¯¹äºä¸åŒ<code>key</code>ï¼Œå­˜å‚¨çš„æ•°ç»„ä¸‹æ ‡ä½ç½®è¦å°½å¯èƒ½ä¸ä¸€æ ·</p></blockquote><p>é—®é¢˜1ï¼šä¸ºä»€ä¹ˆä¸ç›´æ¥é‡‡ç”¨ç»è¿‡hashCodeï¼ˆï¼‰å¤„ç†çš„å“ˆå¸Œç  ä½œä¸º å­˜å‚¨æ•°ç»„tableçš„ä¸‹æ ‡ä½ç½®ï¼Ÿ</p><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c900036919c401d7ea></p><ul class=list-paddingleft-2><li><p>ä¸ºäº†è§£å†³ â€œå“ˆå¸Œç ä¸æ•°ç»„å¤§å°èŒƒå›´ä¸åŒ¹é…â€ çš„é—®é¢˜ï¼Œ<code>HashMap</code>ç»™å‡ºäº†è§£å†³æ–¹æ¡ˆï¼šå“ˆå¸Œç  ä¸è¿ç®—ï¼ˆ&ï¼‰ ï¼ˆæ•°ç»„é•¿åº¦-1ï¼‰ï¼Œå³é—®é¢˜3</p></li></ul><p>é—®é¢˜2ï¼šä¸ºä»€ä¹ˆé‡‡ç”¨ å“ˆå¸Œç  ä¸è¿ç®—(&) ï¼ˆæ•°ç»„é•¿åº¦-1ï¼‰ è®¡ç®—æ•°ç»„ä¸‹æ ‡ï¼Ÿ</p><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c700053e563f1db8b8></p><p>é—®é¢˜3ï¼šä¸ºä»€ä¹ˆåœ¨è®¡ç®—æ•°ç»„ä¸‹æ ‡å‰ï¼Œéœ€å¯¹å“ˆå¸Œç è¿›è¡ŒäºŒæ¬¡å¤„ç†ï¼šæ‰°åŠ¨å¤„ç†ï¼Ÿ</p><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c90003691a9f82af6b></p><p>è‡³æ­¤ï¼Œå…³äºæ€ä¹ˆè®¡ç®— <code>key-value</code> å€¼å­˜å‚¨åœ¨<code>HashMap</code>æ•°ç»„ä½ç½® & ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¡ç®—ï¼Œè®²è§£å®Œæ¯•ã€‚</p><hr><p>åˆ†æ2ï¼šputVal(hash(key), key, value, false, true);</p><p>æ­¤å¤„æœ‰2ä¸ªä¸»è¦è®²è§£ç‚¹ï¼š</p><ul class=list-paddingleft-2><li><p>è®¡ç®—å®Œå­˜å‚¨ä½ç½®åï¼Œå…·ä½“è¯¥å¦‚ä½• å­˜æ”¾æ•°æ® åˆ°å“ˆå¸Œè¡¨ä¸­</p></li><li><p>å…·ä½“å¦‚ä½•æ‰©å®¹ï¼Œå³ æ‰©å®¹æœºåˆ¶</p></li></ul><p>ä¸»è¦è®²è§£ç‚¹1ï¼šè®¡ç®—å®Œå­˜å‚¨ä½ç½®åï¼Œå…·ä½“è¯¥å¦‚ä½•å­˜æ”¾æ•°æ®åˆ°å“ˆå¸Œè¡¨ä¸­</p><p>ç”±äºæ•°æ®ç»“æ„ä¸­åŠ å…¥äº†çº¢é»‘æ ‘ï¼Œæ‰€ä»¥åœ¨å­˜æ”¾æ•°æ®åˆ°å“ˆå¸Œè¡¨ä¸­æ—¶ï¼Œéœ€è¿›è¡Œå¤šæ¬¡æ•°æ®ç»“æ„çš„åˆ¤æ–­ï¼šæ•°ç»„ã€çº¢é»‘æ ‘ã€é“¾è¡¨</p><blockquote><p>åªéœ€åˆ¤æ–­ æ•°ç»„ & é“¾è¡¨</p></blockquote><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6c2c000078500a45662f></p><pre> /** * åˆ†æ2ï¼šputVal(hash(key), key, value, false, true) */ final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) { Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i; // 1. è‹¥å“ˆå¸Œè¡¨çš„æ•°ç»„tabä¸ºç©ºï¼Œåˆ™ é€šè¿‡resize() åˆ›å»º // æ‰€ä»¥ï¼Œåˆå§‹åŒ–å“ˆå¸Œè¡¨çš„æ—¶æœº = ç¬¬1æ¬¡è°ƒç”¨putå‡½æ•°æ—¶ï¼Œå³è°ƒç”¨resize() åˆå§‹åŒ–åˆ›å»º // å…³äºresizeï¼ˆï¼‰çš„æºç åˆ†æå°†åœ¨ä¸‹é¢è®²è§£æ‰©å®¹æ—¶è¯¦ç»†åˆ†æï¼Œæ­¤å¤„å…ˆè·³è¿‡ if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; // 2. è®¡ç®—æ’å…¥å­˜å‚¨çš„æ•°ç»„ç´¢å¼•iï¼šæ ¹æ®é”®å€¼keyè®¡ç®—çš„hashå€¼ å¾—åˆ° // æ­¤å¤„çš„æ•°ç»„ä¸‹æ ‡è®¡ç®—æ–¹å¼ = i = (n - 1) &amp; hashï¼ŒåŒJDK 1.7ä¸­çš„indexForï¼ˆï¼‰ï¼Œä¸Šé¢å·²è¯¦ç»†æè¿° // 3. æ’å…¥æ—¶ï¼Œéœ€åˆ¤æ–­æ˜¯å¦å­˜åœ¨Hashå†²çªï¼š // è‹¥ä¸å­˜åœ¨ï¼ˆå³å½“å‰table[i] == nullï¼‰ï¼Œåˆ™ç›´æ¥åœ¨è¯¥æ•°ç»„ä½ç½®æ–°å»ºèŠ‚ç‚¹ï¼Œæ’å…¥å®Œæ¯• // å¦åˆ™ï¼Œä»£è¡¨å­˜åœ¨Hashå†²çªï¼Œå³å½“å‰å­˜å‚¨ä½ç½®å·²å­˜åœ¨èŠ‚ç‚¹ï¼Œåˆ™ä¾æ¬¡å¾€ä¸‹åˆ¤æ–­ï¼ša. å½“å‰ä½ç½®çš„keyæ˜¯å¦ä¸éœ€æ’å…¥çš„keyç›¸åŒã€b. åˆ¤æ–­éœ€æ’å…¥çš„æ•°æ®ç»“æ„æ˜¯å¦ä¸ºçº¢é»‘æ ‘ or é“¾è¡¨ if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null); // newNode(hash, key, value, null)çš„æºç  = new Node&lt;&gt;(hash, key, value, next) else { Node&lt;K,V&gt; e; K k; // a. åˆ¤æ–­ table[i]çš„å…ƒç´ çš„keyæ˜¯å¦ä¸ éœ€æ’å…¥çš„keyä¸€æ ·ï¼Œè‹¥ç›¸åŒåˆ™ ç›´æ¥ç”¨æ–°value è¦†ç›– æ—§value // åˆ¤æ–­åŸåˆ™ï¼šequalsï¼ˆï¼‰ if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) e = p; // b. ç»§ç»­åˆ¤æ–­ï¼šéœ€æ’å…¥çš„æ•°æ®ç»“æ„æ˜¯å¦ä¸ºçº¢é»‘æ ‘ or é“¾è¡¨ // è‹¥æ˜¯çº¢é»‘æ ‘ï¼Œåˆ™ç›´æ¥åœ¨æ ‘ä¸­æ’å…¥ or æ›´æ–°é”®å€¼å¯¹ else if (p instanceof TreeNode) e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value); -&gt;&gt;åˆ†æ3 // è‹¥æ˜¯é“¾è¡¨,åˆ™åœ¨é“¾è¡¨ä¸­æ’å…¥ or æ›´æ–°é”®å€¼å¯¹ // i. éå†table[i]ï¼Œåˆ¤æ–­Keyæ˜¯å¦å·²å­˜åœ¨ï¼šé‡‡ç”¨equalsï¼ˆï¼‰ å¯¹æ¯”å½“å‰éå†èŠ‚ç‚¹çš„key ä¸ éœ€æ’å…¥æ•°æ®çš„keyï¼šè‹¥å·²å­˜åœ¨ï¼Œåˆ™ç›´æ¥ç”¨æ–°value è¦†ç›– æ—§value // ii. éå†å®Œæ¯•åä»æ— å‘ç°ä¸Šè¿°æƒ…å†µï¼Œåˆ™ç›´æ¥åœ¨é“¾è¡¨å°¾éƒ¨æ’å…¥æ•°æ® // æ³¨ï¼šæ–°å¢èŠ‚ç‚¹åï¼Œéœ€åˆ¤æ–­é“¾è¡¨é•¿åº¦æ˜¯å¦&gt;8ï¼ˆ8 = æ¡¶çš„æ ‘åŒ–é˜ˆå€¼ï¼‰ï¼šè‹¥æ˜¯ï¼Œåˆ™æŠŠé“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ else { for (int binCount = 0; ; ++binCount) { // å¯¹äºiiï¼šè‹¥æ•°ç»„çš„ä¸‹1ä¸ªä½ç½®ï¼Œè¡¨ç¤ºå·²åˆ°è¡¨å°¾ä¹Ÿæ²¡æœ‰æ‰¾åˆ°keyå€¼ç›¸åŒèŠ‚ç‚¹ï¼Œåˆ™æ–°å»ºèŠ‚ç‚¹ = æ’å…¥èŠ‚ç‚¹ // æ³¨ï¼šæ­¤å¤„æ˜¯ä»é“¾è¡¨å°¾æ’å…¥ï¼Œä¸JDK 1.7ä¸åŒï¼ˆä»é“¾è¡¨å¤´æ’å…¥ï¼Œå³æ°¸è¿œéƒ½æ˜¯æ·»åŠ åˆ°æ•°ç»„çš„ä½ç½®ï¼ŒåŸæ¥æ•°ç»„ä½ç½®çš„æ•°æ®åˆ™å¾€åç§»ï¼‰ if ((e = p.next) == null) { p.next = newNode(hash, key, value, null); // æ’å…¥èŠ‚ç‚¹åï¼Œè‹¥é“¾è¡¨èŠ‚ç‚¹&gt;æ•°é˜ˆå€¼ï¼Œåˆ™å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ if (binCount &gt;= TREEIFY_THRESHOLD - 1) treeifyBin(tab, hash); // æ ‘åŒ–æ“ä½œ break; } // å¯¹äºi if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) break; // æ›´æ–°pæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç»§ç»­éå† p = e; } } // å¯¹iæƒ…å†µçš„åç»­æ“ä½œï¼šå‘ç°keyå·²å­˜åœ¨ï¼Œç›´æ¥ç”¨æ–°value è¦†ç›– æ—§value &amp; è¿”å›æ—§value if (e != null) { V oldValue = e.value; if (!onlyIfAbsent || oldValue == null) e.value = value; afterNodeAccess(e); // æ›¿æ¢æ—§å€¼æ—¶ä¼šè°ƒç”¨çš„æ–¹æ³•ï¼ˆé»˜è®¤å®ç°ä¸ºç©ºï¼‰ return oldValue; } } ++modCount; // æ’å…¥æˆåŠŸåï¼Œåˆ¤æ–­å®é™…å­˜åœ¨çš„é”®å€¼å¯¹æ•°é‡size &gt; æœ€å¤§å®¹é‡threshold // è‹¥ &gt; ï¼Œåˆ™è¿›è¡Œæ‰©å®¹ -&gt;&gt;åˆ†æ4ï¼ˆä½†å•ç‹¬è®²è§£ï¼Œè¯·ç›´æ¥è·³å‡ºè¯¥ä»£ç å—ï¼‰ if (++size &gt; threshold) resize(); afterNodeInsertion(evict);// æ’å…¥æˆåŠŸæ—¶ä¼šè°ƒç”¨çš„æ–¹æ³•ï¼ˆé»˜è®¤å®ç°ä¸ºç©ºï¼‰ return null;} /** * åˆ†æ3ï¼šputTreeVal(this, tab, hash, key, value) * ä½œç”¨ï¼šå‘çº¢é»‘æ ‘æ’å…¥ or æ›´æ–°æ•°æ®ï¼ˆé”®å€¼å¯¹ï¼‰ * è¿‡ç¨‹ï¼šéå†çº¢é»‘æ ‘åˆ¤æ–­è¯¥èŠ‚ç‚¹çš„keyæ˜¯å¦ä¸éœ€æ’å…¥çš„key ç›¸åŒï¼š * a. è‹¥ç›¸åŒï¼Œåˆ™æ–°valueè¦†ç›–æ—§value * b. è‹¥ä¸ç›¸åŒï¼Œåˆ™æ’å…¥ */ final TreeNode&lt;K,V&gt; putTreeVal(HashMap&lt;K,V&gt; map, Node&lt;K,V&gt;[] tab, int h, K k, V v) { Class&lt;?&gt; kc = null; boolean searched = false; TreeNode&lt;K,V&gt; root = (parent != null) ? root() : this;  for (TreeNode&lt;K,V&gt; p = root;;) {  int dir, ph; K pk;  if ((ph = p.hash) &gt; h) dir = -1;  else if (ph &lt; h) dir = 1;  else if ((pk = p.key) == k || (k != null &amp;&amp; k.equals(pk))) return p; else if ((kc == null &amp;&amp; (kc = comparableClassFor(k)) == null) || (dir = compareComparables(kc, k, pk)) == 0) {  if (!searched) { TreeNode&lt;K,V&gt; q, ch; searched = true;  if (((ch = p.left) != null &amp;&amp; (q = ch.find(h, k, kc)) != null) || ((ch = p.right) != null &amp;&amp; (q = ch.find(h, k, kc)) != null)) return q; } dir = tieBreakOrder(k, pk); } TreeNode&lt;K,V&gt; xp = p;  if ((p = (dir &lt;= 0) ? p.left : p.right) == null) { Node&lt;K,V&gt; xpn = xp.next; TreeNode&lt;K,V&gt; x = map.newTreeNode(h, k, v, xpn); if (dir &lt;= 0) xp.left = x; else xp.right = x; xp.next = x; x.parent = x.prev = xp; if (xpn != null) ((TreeNode&lt;K,V&gt;)xpn).prev = x; moveRootToFront(tab, balanceInsertion(root, x)); return null; } } }</pre><ul class=list-paddingleft-2><li><p>æ€»ç»“</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c8000464f47a3041c4></p><p>ä¸»è¦è®²è§£ç‚¹2ï¼šæ‰©å®¹æœºåˆ¶ï¼ˆå³ resizeï¼ˆï¼‰å‡½æ•°æ–¹æ³•ï¼‰</p><ul class=list-paddingleft-2><li><p>æ‰©å®¹æµç¨‹å¦‚ä¸‹</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/6c2c0000784fefc81fd8></p><ul class=list-paddingleft-2><li><p>æºç åˆ†æ</p></li></ul><pre> /** * åˆ†æ4ï¼šresizeï¼ˆï¼‰ * è¯¥å‡½æ•°æœ‰2ç§ä½¿ç”¨æƒ…å†µï¼š1.åˆå§‹åŒ–å“ˆå¸Œè¡¨ 2.å½“å‰æ•°ç»„å®¹é‡è¿‡å°ï¼Œéœ€æ‰©å®¹ */ final Node&lt;K,V&gt;[] resize() { Node&lt;K,V&gt;[] oldTab = table; // æ‰©å®¹å‰çš„æ•°ç»„ï¼ˆå½“å‰æ•°ç»„ï¼‰ int oldCap = (oldTab == null) ? 0 : oldTab.length; // æ‰©å®¹å‰çš„æ•°ç»„çš„å®¹é‡ = é•¿åº¦ int oldThr = threshold;// æ‰©å®¹å‰çš„æ•°ç»„çš„é˜ˆå€¼ int newCap, newThr = 0; // é’ˆå¯¹æƒ…å†µ2ï¼šè‹¥æ‰©å®¹å‰çš„æ•°ç»„å®¹é‡è¶…è¿‡æœ€å¤§å€¼ï¼Œåˆ™ä¸å†æ‰©å…… if (oldCap &gt; 0) { if (oldCap &gt;= MAXIMUM_CAPACITY) { threshold = Integer.MAX_VALUE; return oldTab; } // é’ˆå¯¹æƒ…å†µ2ï¼šè‹¥æ— è¶…è¿‡æœ€å¤§å€¼ï¼Œå°±æ‰©å……ä¸ºåŸæ¥çš„2å€ else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp; oldCap &gt;= DEFAULT_INITIAL_CAPACITY) newThr = oldThr &lt;&lt; 1; // é€šè¿‡å³ç§»æ‰©å……2å€ } // é’ˆå¯¹æƒ…å†µ1ï¼šåˆå§‹åŒ–å“ˆå¸Œè¡¨ï¼ˆé‡‡ç”¨æŒ‡å®š or é»˜è®¤å€¼ï¼‰ else if (oldThr &gt; 0) // initial capacity was placed in threshold newCap = oldThr; else { // zero initial threshold signifies using defaults newCap = DEFAULT_INITIAL_CAPACITY; newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY); } // è®¡ç®—æ–°çš„resizeä¸Šé™ if (newThr == 0) { float ft = (float)newCap * loadFactor; newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ? (int)ft : Integer.MAX_VALUE); } threshold = newThr; @SuppressWarnings({"rawtypes","unchecked"}) Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap]; table = newTab; if (oldTab != null) { // æŠŠæ¯ä¸ªbucketéƒ½ç§»åŠ¨åˆ°æ–°çš„bucketsä¸­ for (int j = 0; j &lt; oldCap; ++j) { Node&lt;K,V&gt; e; if ((e = oldTab[j]) != null) { oldTab[j] = null; if (e.next == null) newTab[e.hash &amp; (newCap - 1)] = e; else if (e instanceof TreeNode) ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap); else { // é“¾è¡¨ä¼˜åŒ–é‡hashçš„ä»£ç å— Node&lt;K,V&gt; loHead = null, loTail = null; Node&lt;K,V&gt; hiHead = null, hiTail = null; Node&lt;K,V&gt; next; do { next = e.next; // åŸç´¢å¼• if ((e.hash &amp; oldCap) == 0) { if (loTail == null) loHead = e; else loTail.next = e; loTail = e; } // åŸç´¢å¼• + oldCap else { if (hiTail == null) hiHead = e; else hiTail.next = e; hiTail = e; } } while ((e = next) != null); // åŸç´¢å¼•æ”¾åˆ°bucketé‡Œ if (loTail != null) { loTail.next = null; newTab[j] = loHead; } // åŸç´¢å¼•+oldCapæ”¾åˆ°bucketé‡Œ if (hiTail != null) { hiTail.next = null; newTab[j + oldCap] = hiHead; } } } } } return newTab;}1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495</pre><ul class=list-paddingleft-2><li><p>æ‰©å®¹æµç¨‹ï¼ˆå« ä¸ <code>JDK 1.7</code> çš„å¯¹æ¯”ï¼‰</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c8000464f5f18ae0f4></p><p>æ­¤å¤„ä¸»è¦è®²è§£ï¼š <code>JDK 1.8</code>æ‰©å®¹æ—¶ï¼Œæ•°æ®å­˜å‚¨ä½ç½®é‡æ–°è®¡ç®—çš„æ–¹å¼</p><ul class=list-paddingleft-2><li><p>è®¡ç®—ç»“è®º & åŸå› è§£æ</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c600059db8588bc1be></p><ul class=list-paddingleft-2><li><p>ç»“è®ºç¤ºæ„å›¾</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/66c40005d5ece5607bb5></p><ul class=list-paddingleft-2><li><p>æ•°ç»„ä½ç½®è½¬æ¢çš„ç¤ºæ„å›¾</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6c2c00007853b79b150c></p><ul class=list-paddingleft-2><li><p><code>JDK 1.8</code>æ ¹æ®æ­¤ç»“è®ºä½œå‡ºçš„æ–°å…ƒç´ å­˜å‚¨ä½ç½®è®¡ç®—è§„åˆ™ éå¸¸ç®€å•ï¼Œæé«˜äº†æ‰©å®¹æ•ˆç‡ï¼Œå…·ä½“å¦‚ä¸‹å›¾</p><blockquote>è¿™ä¸ <code>JDK 1.7</code>åœ¨è®¡ç®—æ–°å…ƒç´ çš„å­˜å‚¨ä½ç½®æœ‰å¾ˆå¤§åŒºåˆ«ï¼š<code>JDK 1.7</code>åœ¨æ‰©å®¹åï¼Œéƒ½éœ€æŒ‰ç…§åŸæ¥æ–¹æ³•é‡æ–°è®¡ç®—ï¼Œå³<p><code>hashCodeï¼ˆï¼‰</code>->> æ‰°åŠ¨å¤„ç† ->><code>ï¼ˆh & length-1ï¼‰</code>ï¼‰</p></blockquote></li></ul><p>æ€»ç»“</p><ul class=list-paddingleft-2><li><p>æ·»åŠ æ•°æ®çš„æµç¨‹</p></li><li><p>ä¸ <code>JDK 1.7</code>çš„åŒºåˆ«</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6c2c0000785214ec7ce5></p><ul class=list-paddingleft-2><li></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c8000464f67f07873a></p><p>è‡³æ­¤ï¼Œå…³äº <code>HashMap</code>çš„æ·»åŠ æ•°æ®æºç åˆ†æ åˆ†æå®Œæ¯•ã€‚</p><hr><h1></h1><p>æ­¥éª¤3ï¼šä»HashMapä¸­è·å–æ•°æ®</p><ul class=list-paddingleft-2><li><p>å‡å¦‚ç†è§£äº†ä¸Šè¿°<code>putï¼ˆï¼‰</code>å‡½æ•°çš„åŸç†ï¼Œé‚£ä¹ˆ<code>getï¼ˆï¼‰</code>å‡½æ•°éå¸¸å¥½ç†è§£ï¼Œå› ä¸ºäºŒè€…çš„è¿‡ç¨‹åŸç†å‡ ä¹ç›¸åŒ</p></li><li><p><code>getï¼ˆï¼‰</code>å‡½æ•°çš„æµç¨‹å¦‚ä¸‹ï¼š</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6c2c000078512e4cac62></p><ul class=list-paddingleft-2><li><p>æºç åˆ†æ</p></li></ul><pre>/** * å‡½æ•°åŸå‹ * ä½œç”¨ï¼šæ ¹æ®é”®keyï¼Œå‘HashMapè·å–å¯¹åº”çš„å€¼ */ map.get(key)ï¼› /** * æºç åˆ†æ */ public V get(Object key) { Node&lt;K,V&gt; e; // 1. è®¡ç®—éœ€è·å–æ•°æ®çš„hashå€¼ // 2. é€šè¿‡getNodeï¼ˆï¼‰è·å–æ‰€æŸ¥è¯¢çš„æ•°æ® -&gt;&gt;åˆ†æ1 // 3. è·å–åï¼Œåˆ¤æ–­æ•°æ®æ˜¯å¦ä¸ºç©º return (e = getNode(hash(key), key)) == null ? null : e.value;}/** * åˆ†æ1ï¼šgetNode(hash(key), key)) */ final Node&lt;K,V&gt; getNode(int hash, Object key) { Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; int n; K k; // 1. è®¡ç®—å­˜æ”¾åœ¨æ•°ç»„tableä¸­çš„ä½ç½® if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp; (first = tab[(n - 1) &amp; hash]) != null) { // 4. é€šè¿‡è¯¥å‡½æ•°ï¼Œä¾æ¬¡åœ¨æ•°ç»„ã€çº¢é»‘æ ‘ã€é“¾è¡¨ä¸­æŸ¥æ‰¾ï¼ˆé€šè¿‡equalsï¼ˆï¼‰åˆ¤æ–­ï¼‰ // a. å…ˆåœ¨æ•°ç»„ä¸­æ‰¾ï¼Œè‹¥å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å› if (first.hash == hash &amp;&amp; // always check first node ((k = first.key) == key || (key != null &amp;&amp; key.equals(k)))) return first; // b. è‹¥æ•°ç»„ä¸­æ²¡æœ‰ï¼Œåˆ™åˆ°çº¢é»‘æ ‘ä¸­å¯»æ‰¾ if ((e = first.next) != null) { // åœ¨æ ‘ä¸­get if (first instanceof TreeNode) return ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key); // c. è‹¥çº¢é»‘æ ‘ä¸­ä¹Ÿæ²¡æœ‰ï¼Œåˆ™é€šè¿‡éå†ï¼Œåˆ°é“¾è¡¨ä¸­å¯»æ‰¾ do { if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) return e; } while ((e = e.next) != null); } } return null;}1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950</pre><p>è‡³æ­¤ï¼Œå…³äº â€œå‘ <code>HashMap</code> è·å–æ•°æ® â€œè®²è§£å®Œæ¯•ã€‚</p><hr><p>æ­¥éª¤4ï¼šå¯¹HashMapçš„å…¶ä»–æ“ä½œ</p><blockquote><p>å³ å¯¹å…¶ä½™ä½¿ç”¨<code>API</code>ï¼ˆå‡½æ•°ã€æ–¹æ³•ï¼‰çš„æºç åˆ†æ</p><p>- <code>HashMap</code>é™¤äº†æ ¸å¿ƒçš„<code>putï¼ˆï¼‰</code>ã€<code>getï¼ˆï¼‰</code>å‡½æ•°ï¼Œè¿˜æœ‰ä»¥ä¸‹ä¸»è¦ä½¿ç”¨çš„å‡½æ•°æ–¹æ³•</p></blockquote><pre>void clear(); // æ¸…é™¤å“ˆå¸Œè¡¨ä¸­çš„æ‰€æœ‰é”®å€¼å¯¹int size(); // è¿”å›å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰ é”®å€¼å¯¹çš„æ•°é‡ = æ•°ç»„ä¸­çš„é”®å€¼å¯¹ + é“¾è¡¨ä¸­çš„é”®å€¼å¯¹boolean isEmpty(); // åˆ¤æ–­HashMapæ˜¯å¦ä¸ºç©ºï¼›size == 0æ—¶ è¡¨ç¤ºä¸º ç©º void putAll(Map&lt;? extends K, ? extends V&gt; m); // å°†æŒ‡å®šMapä¸­çš„é”®å€¼å¯¹ å¤åˆ¶åˆ° æ­¤Mapä¸­V remove(Object key); // åˆ é™¤è¯¥é”®å€¼å¯¹boolean containsKey(Object key); // åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¯¥é”®çš„é”®å€¼å¯¹ï¼›æ˜¯ åˆ™è¿”å›trueboolean containsValue(Object value); // åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¯¥å€¼çš„é”®å€¼å¯¹ï¼›æ˜¯ åˆ™è¿”å›true1234567891011</pre><ul class=list-paddingleft-2><li><p>å…³äºä¸Šè¿°æ–¹æ³•çš„æºç çš„åŸç† åŒ <code>JDK 1.7</code>ï¼Œæ­¤å¤„ä¸ä½œè¿‡å¤šæè¿°</p><blockquote><p>æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒæ–‡ç«  ç¬¬5å°èŠ‚ è¿›è¡Œç±»æ¯”ã€‚</p></blockquote></li></ul><p>è‡³æ­¤ï¼Œå…³äº <code>HashMap</code>çš„åº•å±‚åŸç† & ä¸»è¦ä½¿ç”¨<code>API</code>ï¼ˆå‡½æ•°ã€æ–¹æ³•ï¼‰è®²è§£å®Œæ¯•ã€‚</p><hr><h1></h1><p>6. æºç æ€»ç»“</p><p>ä¸‹é¢ï¼Œç”¨3ä¸ªå›¾æ€»ç»“æ•´ä¸ªæºç å†…å®¹ï¼š</p><blockquote><p>æ€»ç»“å†…å®¹ = æ•°æ®ç»“æ„ã€ä¸»è¦å‚æ•°ã€æ·»åŠ  & æŸ¥è¯¢æ•°æ®æµç¨‹ã€æ‰©å®¹æœºåˆ¶</p></blockquote><ul class=list-paddingleft-2><li><p>æ•°æ®ç»“æ„ & ä¸»è¦å‚æ•°</p></li><li><p>æ·»åŠ  & æŸ¥è¯¢æ•°æ®æµç¨‹</p></li><li><p>æ‰©å®¹æœºåˆ¶</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c50005b185a373c7e6></p><ul class=list-paddingleft-2><li></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c700053e58208851f2></p><ul class=list-paddingleft-2><li></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/6c2c00007854f33eff3d></p><hr><h1></h1><p>7. ä¸ <code>JDK 1.7</code> çš„åŒºåˆ«</p><p><code>HashMap</code> çš„å®ç°åœ¨ <code>JDK 1.7</code> å’Œ <code>JDK 1.8</code> å·®åˆ«è¾ƒå¤§ï¼Œå…·ä½“åŒºåˆ«å¦‚ä¸‹</p><blockquote><ol class=list-paddingleft-2><li><p><code>JDK 1.8</code> çš„ä¼˜åŒ–ç›®çš„ä¸»è¦æ˜¯ï¼šå‡å°‘ <code>Hash</code>å†²çª & æé«˜å“ˆå¸Œè¡¨çš„å­˜ã€å–æ•ˆç‡</p></li><li><p>å…³äº <code>JDK 1.7</code> ä¸­ <code>HashMap</code> çš„æºç è§£æè¯·çœ‹æ–‡ç« ï¼šJavaï¼šæ‰‹æŠŠæ‰‹å¸¦ä½ æºç åˆ†æ HashMap 1.7</p></li></ol></blockquote><p><strong>7.1 æ•°æ®ç»“æ„</strong></p><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c8000464f75719a4c8></p><p>7.2 è·å–æ•°æ®æ—¶ï¼ˆè·å–æ•°æ® ç±»ä¼¼ï¼‰</p><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c600059dba17f56073></p><p>7.3 æ‰©å®¹æœºåˆ¶</p><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c40005d5ee8d724415></p><hr><h1></h1><p>8. é¢å¤–è¡¥å……ï¼šå…³äºHashMapçš„å…¶ä»–é—®é¢˜</p><ul class=list-paddingleft-2><li><p>æœ‰å‡ ä¸ªå°é—®é¢˜éœ€è¦åœ¨æ­¤è¡¥å……</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/6c2c00007855d2c3ee07></p><ul class=list-paddingleft-2><li><p>å…·ä½“å¦‚ä¸‹</p></li></ul><p>8.1 å“ˆå¸Œè¡¨å¦‚ä½•è§£å†³Hashå†²çª</p><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c40005d5eff1932cc1></p><p>8.2 ä¸ºä»€ä¹ˆHashMapå…·å¤‡ä¸‹è¿°ç‰¹ç‚¹ï¼šé”®-å€¼ï¼ˆkey-valueï¼‰éƒ½å…è®¸ä¸ºç©ºã€çº¿ç¨‹ä¸å®‰å…¨ã€ä¸ä¿è¯æœ‰åºã€å­˜å‚¨ä½ç½®éšæ—¶é—´å˜åŒ–</p><ul class=list-paddingleft-2><li><p>å…·ä½“è§£ç­”å¦‚ä¸‹</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c8000464f8ddda1c6b></p><ul class=list-paddingleft-2><li><p>ä¸‹é¢ä¸»è¦è®²è§£ <code>HashMap</code> çº¿ç¨‹ä¸å®‰å…¨çš„å…¶ä¸­ä¸€ä¸ªé‡è¦åŸå› ï¼šå¤šçº¿ç¨‹ä¸‹å®¹æ˜“å‡ºç°<code>resizeï¼ˆï¼‰</code>æ­»å¾ªç¯</p><p>æœ¬è´¨ = å¹¶å‘ æ‰§è¡Œ <code>putï¼ˆï¼‰</code>æ“ä½œå¯¼è‡´è§¦å‘ æ‰©å®¹è¡Œä¸ºï¼Œä»è€Œå¯¼è‡´ ç¯å½¢é“¾è¡¨ï¼Œä½¿å¾—åœ¨è·å–æ•°æ®éå†é“¾è¡¨æ—¶å½¢æˆæ­»å¾ªç¯ï¼Œå³<code>Infinite Loop</code></p></li><li><p>å…ˆçœ‹æ‰©å®¹çš„æºç åˆ†æ<code>resizeï¼ˆï¼‰</code></p><blockquote><p>å…³äºresizeï¼ˆï¼‰çš„æºç åˆ†æå·²åœ¨ä¸Šæ–‡è¯¦ç»†åˆ†æï¼Œæ­¤å¤„ä»…ä½œé‡ç‚¹åˆ†æï¼štransferï¼ˆï¼‰</p></blockquote></li></ul><pre>/** * æºç åˆ†æï¼šresize(2 * table.length) * ä½œç”¨ï¼šå½“å®¹é‡ä¸è¶³æ—¶ï¼ˆå®¹é‡ &gt; é˜ˆå€¼ï¼‰ï¼Œåˆ™æ‰©å®¹ï¼ˆæ‰©åˆ°2å€ï¼‰ */ void resize(int newCapacity) {  // 1. ä¿å­˜æ—§æ•°ç»„ï¼ˆold tableï¼‰ Entry[] oldTable = table;  // 2. ä¿å­˜æ—§å®¹é‡ï¼ˆold capacity ï¼‰ï¼Œå³æ•°ç»„é•¿åº¦ int oldCapacity = oldTable.length; // 3. è‹¥æ—§å®¹é‡å·²ç»æ˜¯ç³»ç»Ÿé»˜è®¤æœ€å¤§å®¹é‡äº†ï¼Œé‚£ä¹ˆå°†é˜ˆå€¼è®¾ç½®æˆæ•´å‹çš„æœ€å¤§å€¼ï¼Œé€€å‡º  if (oldCapacity == MAXIMUM_CAPACITY) {  threshold = Integer.MAX_VALUE;  return;  }  // 4. æ ¹æ®æ–°å®¹é‡ï¼ˆ2å€å®¹é‡ï¼‰æ–°å»º1ä¸ªæ•°ç»„ï¼Œå³æ–°table  Entry[] newTable = new Entry[newCapacity];  // 5. ï¼ˆé‡ç‚¹åˆ†æï¼‰å°†æ—§æ•°ç»„ä¸Šçš„æ•°æ®ï¼ˆé”®å€¼å¯¹ï¼‰è½¬ç§»åˆ°æ–°tableä¸­ï¼Œä»è€Œå®Œæˆæ‰©å®¹ -&gt;&gt;åˆ†æ1.1 transfer(newTable); // 6. æ–°æ•°ç»„tableå¼•ç”¨åˆ°HashMapçš„tableå±æ€§ä¸Š table = newTable;  // 7. é‡æ–°è®¾ç½®é˜ˆå€¼  threshold = (int)(newCapacity * loadFactor);}/** * åˆ†æ1.1ï¼štransfer(newTable); * ä½œç”¨ï¼šå°†æ—§æ•°ç»„ä¸Šçš„æ•°æ®ï¼ˆé”®å€¼å¯¹ï¼‰è½¬ç§»åˆ°æ–°tableä¸­ï¼Œä»è€Œå®Œæˆæ‰©å®¹ * è¿‡ç¨‹ï¼šæŒ‰æ—§é“¾è¡¨çš„æ­£åºéå†é“¾è¡¨ã€åœ¨æ–°é“¾è¡¨çš„å¤´éƒ¨ä¾æ¬¡æ’å…¥ */ void transfer(Entry[] newTable) { // 1. srcå¼•ç”¨äº†æ—§æ•°ç»„ Entry[] src = table; // 2. è·å–æ–°æ•°ç»„çš„å¤§å° = è·å–æ–°å®¹é‡å¤§å°  int newCapacity = newTable.length; // 3. é€šè¿‡éå† æ—§æ•°ç»„ï¼Œå°†æ—§æ•°ç»„ä¸Šçš„æ•°æ®ï¼ˆé”®å€¼å¯¹ï¼‰è½¬ç§»åˆ°æ–°æ•°ç»„ä¸­ for (int j = 0; j &lt; src.length; j++) { // 3.1 å–å¾—æ—§æ•°ç»„çš„æ¯ä¸ªå…ƒç´   Entry&lt;K,V&gt; e = src[j];  if (e != null) { // 3.2 é‡Šæ”¾æ—§æ•°ç»„çš„å¯¹è±¡å¼•ç”¨ï¼ˆforå¾ªç¯åï¼Œæ—§æ•°ç»„ä¸å†å¼•ç”¨ä»»ä½•å¯¹è±¡ï¼‰ src[j] = null; do { // 3.3 éå† ä»¥è¯¥æ•°ç»„å…ƒç´ ä¸ºé¦– çš„é“¾è¡¨ // æ³¨ï¼šè½¬ç§»é“¾è¡¨æ—¶ï¼Œå› æ˜¯å•é“¾è¡¨ï¼Œæ•…è¦ä¿å­˜ä¸‹1ä¸ªç»“ç‚¹ï¼Œå¦åˆ™è½¬ç§»åé“¾è¡¨ä¼šæ–­å¼€ Entry&lt;K,V&gt; next = e.next; // 3.3 é‡æ–°è®¡ç®—æ¯ä¸ªå…ƒç´ çš„å­˜å‚¨ä½ç½® int i = indexFor(e.hash, newCapacity); // 3.4 å°†å…ƒç´ æ”¾åœ¨æ•°ç»„ä¸Šï¼šé‡‡ç”¨å•é“¾è¡¨çš„å¤´æ’å…¥æ–¹å¼ = åœ¨é“¾è¡¨å¤´ä¸Šå­˜æ”¾æ•°æ® = å°†æ•°ç»„ä½ç½®çš„åŸæœ‰æ•°æ®æ”¾åœ¨å1ä¸ªæŒ‡é’ˆã€å°†éœ€æ”¾å…¥çš„æ•°æ®æ”¾åˆ°æ•°ç»„ä½ç½®ä¸­ // å³ æ‰©å®¹åï¼Œå¯èƒ½å‡ºç°é€†åºï¼šæŒ‰æ—§é“¾è¡¨çš„æ­£åºéå†é“¾è¡¨ã€åœ¨æ–°é“¾è¡¨çš„å¤´éƒ¨ä¾æ¬¡æ’å…¥ e.next = newTable[i]; newTable[i] = e;  // è®¿é—®ä¸‹1ä¸ªEntryé“¾ä¸Šçš„å…ƒç´ ï¼Œå¦‚æ­¤ä¸æ–­å¾ªç¯ï¼Œç›´åˆ°éå†å®Œè¯¥é“¾è¡¨ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹ e = next;  } while (e != null); // å¦‚æ­¤ä¸æ–­å¾ªç¯ï¼Œç›´åˆ°éå†å®Œæ•°ç»„ä¸Šçš„æ‰€æœ‰æ•°æ®å…ƒç´  } }}</pre><p>ä»ä¸Šé¢å¯çœ‹å‡ºï¼šåœ¨æ‰©å®¹<code>resizeï¼ˆï¼‰</code>è¿‡ç¨‹ä¸­ï¼Œåœ¨å°†æ—§æ•°ç»„ä¸Šçš„æ•°æ® è½¬ç§»åˆ° æ–°æ•°ç»„ä¸Šæ—¶ï¼Œè½¬ç§»æ•°æ®æ“ä½œ = æŒ‰æ—§é“¾è¡¨çš„æ­£åºéå†é“¾è¡¨ã€åœ¨æ–°é“¾è¡¨çš„å¤´éƒ¨ä¾æ¬¡æ’å…¥ï¼Œå³åœ¨è½¬ç§»æ•°æ®ã€æ‰©å®¹åï¼Œå®¹æ˜“å‡ºç°é“¾è¡¨é€†åºçš„æƒ…å†µ</p><blockquote><p>è®¾é‡æ–°è®¡ç®—å­˜å‚¨ä½ç½®åä¸å˜ï¼Œå³æ‰©å®¹å‰ = 1->2->3ï¼Œæ‰©å®¹å = 3->2->1</p></blockquote><ul class=list-paddingleft-2><li><p>æ­¤æ—¶è‹¥ï¼ˆå¤šçº¿ç¨‹ï¼‰å¹¶å‘æ‰§è¡Œ <code>putï¼ˆï¼‰</code>æ“ä½œï¼Œä¸€æ—¦å‡ºç°æ‰©å®¹æƒ…å†µï¼Œåˆ™ å®¹æ˜“å‡ºç° ç¯å½¢é“¾è¡¨ï¼Œä»è€Œåœ¨è·å–æ•°æ®ã€éå†é“¾è¡¨æ—¶ å½¢æˆæ­»å¾ªç¯ï¼ˆ<code>Infinite Loop</code>ï¼‰ï¼Œå³ æ­»é”çš„çŠ¶æ€ï¼Œå…·ä½“è¯·çœ‹ä¸‹å›¾ï¼š</p></li></ul><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c8000464f97b483cfd></p><p>æ³¨ï¼šç”±äº <code>JDK 1.8</code> è½¬ç§»æ•°æ®æ“ä½œ = æŒ‰æ—§é“¾è¡¨çš„æ­£åºéå†é“¾è¡¨ã€åœ¨æ–°é“¾è¡¨çš„å°¾éƒ¨ä¾æ¬¡æ’å…¥ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°é“¾è¡¨ é€†åºã€å€’ç½®çš„æƒ…å†µï¼Œæ•…ä¸å®¹æ˜“å‡ºç°ç¯å½¢é“¾è¡¨çš„æƒ…å†µã€‚</p><blockquote><p>ä½† <span>JDK 1.8</span>è¿˜æ˜¯çº¿ç¨‹ä¸å®‰å…¨ï¼Œå› ä¸º æ— åŠ åŒæ­¥é”ä¿æŠ¤</p></blockquote><p>8.3 ä¸ºä»€ä¹ˆ HashMap ä¸­ Stringã€Integer è¿™æ ·çš„åŒ…è£…ç±»é€‚åˆä½œä¸º key é”®</p><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c50005b186d4ee703e></p><p>8.4 HashMap ä¸­çš„ <code>key<span>è‹¥ </span>Object</code>ç±»å‹ï¼Œ åˆ™éœ€å®ç°å“ªäº›æ–¹æ³•ï¼Ÿ</p><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c90003691b39127b61></p><p>è‡³æ­¤ï¼Œå…³äº<span>HashMap</span>çš„æ‰€æœ‰çŸ¥è¯†è®²è§£å®Œæ¯•ã€‚</p><h1></h1><p>9. æ€»ç»“</p><p>æœ¬æ–‡ä¸»è¦è®²è§£ <code>Java<span>çš„ </span>HashMap</code>æºç  & ç›¸å…³çŸ¥è¯†ä¸‹é¢æˆ‘å°†ç»§ç»­å¯¹<span>Java</span><span>ã€ </span><span>Android</span></p><p><img alt="Javaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c40005d6c8a8474faa></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Java','æºç ','å…³äº'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>