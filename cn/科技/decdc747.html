<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>PPP协议（点对点协议）详解 | 极客快訊</title><meta property="og:title" content="PPP协议（点对点协议）详解 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/888a1b78159844579e62e13ed788ff33"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/decdc747.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/decdc747.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/decdc747.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/decdc747.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/decdc747.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/decdc747.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/decdc747.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/decdc747.html><meta property="article:published_time" content="2020-11-14T21:08:02+08:00"><meta property="article:modified_time" content="2020-11-14T21:08:02+08:00"><meta name=Keywords content><meta name=description content="PPP协议（点对点协议）详解"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/decdc747.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>PPP协议（点对点协议）详解</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div class=pgc-img><img alt=PPP协议（点对点协议）详解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/888a1b78159844579e62e13ed788ff33><p class=pgc-img-caption></p></div><p>在介绍PPP协议之前，我们先简单介绍下数据链路层信道的类型，以及数据链路层协议的三个基本问题。</p><p><strong>数据链路层</strong>使用的信道主要有以下两种类型：</p><ul><li><strong>点对点信道</strong> 这种信道使用一对一的点对点通信方式。</li><li><strong>广播信道 </strong>这种信道使用一对多的广播通信方式。广播信道上连接的主机很多，使用专用的共享信道协议来协调这些主机的数据发送。</li></ul><hr><p><strong>使用点对点信道的数据链路层</strong></p><p><strong>概念：</strong></p><ul><li><strong>链路（物理链路）：</strong>一个节点到相邻节点的一段物理线路</li><li><strong>数据链路（逻辑链路）：</strong>物理线路加上必要的通信协议（用于控制数据的传输）</li></ul><p><strong>点对点信道的数据链路层的协议数据单元--帧</strong></p><p>数据链路层把网络层交下来的数据构成帧发送到链路上，以及把接收到的帧中的数据取出并上交给网络层。网络层中的协议数据单元则是IP数据报（或称为数据报，分组，包）。如下图所示：</p><div class=pgc-img><img alt=PPP协议（点对点协议）详解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/790ad38d75ff4ce6bf69395130d1d0c1><p class=pgc-img-caption></p></div><p><strong>数据链路层在通信时的主要步骤如下：</strong></p><ol start=1><li>结点A的数据链路层把网络层交下来的IP数据报添加首部和尾部封装成帧。</li><li>结点A把封装好的帧发送给结点B的数据链路层。</li><li>若结点B的数据链路层收到的帧无差错，则从收到的帧中提取出IP数据报上交给上面的网络层，否则丢弃这个帧。</li></ol><p>由于在OSI模型中，各层之间是相互独立的，下层单元向上层单元提供接口函数。因此，我们并不需要去考虑数据链路层如何将数据下交给物理层转换成比特数据流，以及如何在物理层传输的细节。</p><hr><p>数据链路层的协议有很多种，但是有三个基本问题是共同的：</p><ul><li><strong>帧封装</strong></li><li><strong>透明传输</strong></li><li><strong>差错检测</strong></li></ul><p>帧封装，简单的说，就是将网络层传下来的IP数据报进一步打包封装成适合在数据链路层传输的数据帧。大致如下图所示：</p><div class=pgc-img><img alt=PPP协议（点对点协议）详解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/111a56819f6e4b469a7c37379039c60f><p class=pgc-img-caption></p></div><p>我们使用帧定界符来表示一帧数据的开始和结束（上图的帧开始和帧结束）</p><div class=pgc-img><img alt=PPP协议（点对点协议）详解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/13a5fde672d646e4a4c3d212a8ceaf20><p class=pgc-img-caption></p></div><p>帧定界符的作用主要是当数据在传输到一半的时候出现差错（例如物理链路断开），数据链路层的接收端可以依次判断接收到的数据是否是一个完整的帧。</p><p><strong>透明传输</strong></p><p>上述的帧定界符，一般使用专门指明的控制字符。因此，我们需要保证传输的有效数据中不能出现已经被指明为帧定界符的控制字符。否则，就会出现有效数据被误识别为帧定界符而导致数据丢失的情况。</p><p>举个例子：</p><div class=pgc-img><img alt=PPP协议（点对点协议）详解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d06b11fa50354d40b609ef9af77c648a><p class=pgc-img-caption></p></div><p>图中，我们采用字符SOH和字符EOT作为帧开始符合帧结束符。但是，如果我们要传输的有效字符中出现了字符EOT（如上图所示），那么，我们传输的数据在传输到一半的时候就会被接收端误认为一帧数据已经结束，而后半部分的帧数据就会被丢弃。</p><p><strong>那么，假如说我们传输的数据中有被指定为帧定界符的控制字符，如何处理上述可能会出现的问题呢？</strong></p><p>在数据链路层中，解决这个问题的方法就是<strong>字节填充（字符填充）</strong>。</p><p><strong>字节填充</strong>，就是说当我们需要传输控制字符时，我们可以在控制字符前面插入一个<strong>转义字符“ESC”</strong>，而在接收端将数据送往网络层前删除此转义字符。若是转义字符也出现在数据当中，解决方法仍然是在转义字符中插入转义字符（如下图）</p><div class=pgc-img><img alt=PPP协议（点对点协议）详解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/eaac16f90349458caa2f539a6d0db29e><p class=pgc-img-caption></p></div><p><strong>差错检测</strong></p><p>在数据链路层中，广泛使用的是<strong>循环冗余检验CRC</strong>。</p><p>CRC校验的具体实现方法就不在这里介绍了。<strong>这里说下另外需要注意的一些问题：</strong></p><p>我们只能认为，采用CRC校验后，数据链路层接收端接收到的数据均无差错，但这并不能说明传输没有出现差错。因为这种校验方法并不能预防<strong>帧重复，帧丢失，帧失序</strong>的情况。</p><hr><p>在OSI标准里，数据链路层应该向网络层提供可靠的传输服务，因此在某些数据链路层的传输协议中会要求增加帧编号，确认和重传机制（如高级数据链路控制HDLC）。但是，在如今通信线路质量可以得到有效保证的前提下，大部分被广泛使用的数据链路层协议都不再要求向上提供可靠的传输服务了。这个任务自然而然地交给了上层协议（如运输层TCP协议）来完成。目前，对于点对点的链路，被广泛使用的是相对简单得多的<strong>点对点协议PPP</strong>。</p><p><strong>PPP协议的特点</strong></p><ul><li><strong>简单</strong> 我们上述提到的，现数据链路层协议不要求向上提供可靠的传输服务，因此实际数据链路层的功能首要要求就是简单：接收方接收到一个数据帧，进行CRC检测，正确则收下这个帧，反之则丢弃这个帧。简单的设计可以使得不同产商对协议的不同实现的互操作性提高了。</li><li><strong>封装成帧</strong> PPP协议必须规定特殊的字符作为帧定界符，以便接收端可以从收到的比特流中准确找出帧的开始和结束位置</li><li><strong>透明性</strong> PPP必须保证数据传输的透明性（具体见上文透明传输的相关内容）</li><li><strong>多种网络层协议</strong> PPP协议必须能够在同一条物理链路上同时支持多种网络层协议的运行。</li><li><strong>多种类型链路</strong> PPP协议还必须能够在多种类型的链路上运行。</li><li><strong>差错检测</strong> PPP协议必须能够对接收端收到的帧进行检测，并丢弃有差错的帧。</li><li><strong>检测连接状态</strong> PPP协议必须具有一种机制能够及时自动检测出链路是否处于正常工作状态。</li><li><strong>最大传送单元</strong> PPP协议必须对每一种类型的点对点链路设置最大传送单元MTU的标准默认值。若高层协议发送的分组过长并超过MTU的值，PPP则丢弃这样的帧，并返回差错。MTU指的是数据链路层的帧可以载荷的数据部分的最大长度，而不是帧的总长度。</li><li><strong>网络层地址协商</strong> PPP协议必须提供一种机制使通信的两个网络层（例如，两个IP层）的实体能够通过协商知道或能够配置彼此的网络层地址。这对拨号连接的链路特别重要，因为仅仅在链路层建立了连接而不知道对方网络层地址时，则还不能够保证网络层能够传送分组。</li><li><strong>数据压缩协商</strong> PPP协议必须提供一种方法来协商使用数据压缩算法。但PPP协议并不要求将数据压缩算法进行标准化。</li></ul><p><strong>PPP协议不需要的功能</strong></p><ul><li><strong>纠错</strong> PPP协议是不可靠传输协议</li><li><strong>流量控制 </strong>在TCP/IP协议族中，端到端的流量控制由TCP负责。</li><li><strong>序号</strong></li><li><strong>多点线路 </strong>PPP协议不知道多点线路（即一个主站轮流和链路上的多个从站进行通信），只支持点对点的链路通信</li><li><strong>半双工或单工链路</strong> PPP协议只支持全双工链路</li></ul><p><strong>PPP协议的组成</strong></p><p>PPP协议主要由三部分组成：</p><ol start=1><li><strong>一个将IP</strong><strong>数据报</strong><strong>封装到串行链路的方法。</strong></li><li><strong>一个用来建立、配置和测试数据链路连接的链路控制协议LCP。</strong></li><li><strong>一套网络控制协议NCP，能够支持不同的网络层协议，如IP、OSI的网络层、DECnet，以及AppleTalk等。</strong></li></ol><p><strong>PPP协议的帧格式</strong></p><div class=pgc-img><img alt=PPP协议（点对点协议）详解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1fd9bbb097624ce19dcbc1aa85d3befd><p class=pgc-img-caption></p></div><p>如图所示，PPP协议的帧格式主要由三部分组成：<strong>首部，信息字段，尾部</strong>。</p><p><strong>首部</strong></p><p>首部字段由五个字节构成。</p><ul><li><strong>标志字段F</strong>，占一个字节，规定为0x7E，表示一个帧的开始或结束。此标志字段就是PPP帧的定界符。连续两帧之间只需要用一个标志字段。若出现连续两个标志字段，则表示这是一个空帧，应当丢弃。</li><li><strong>地址字段A</strong>，占一个字节，规定为0xFF</li><li><strong>控制字段C</strong>，占一个字节，规定为0x03</li><li><strong>协议字段</strong>，表示信息字段数据所使用的协议。当协议字段为0x0021时，PPP帧的信息字段就是IP数据报。若为0xC021，则信息字段是PPP链路控制协议LCP的数据，而0x8021表示这是网络层的控制数据。</li></ul><p><strong>信息字段</strong></p><p>信息字段的长度是可变的，但不超过1500个字节。</p><p><strong>尾部</strong></p><p>尾部由三个字节构成</p><ul><li><strong>使用CRC的帧检验序列FCS，占两个字节</strong></li><li><strong>标志字段F，占一个字节（首部标志字段）</strong></li></ul><p><strong>字节填充</strong></p><p>上述介绍过此概念，这里不再赘述。</p><p><strong>零比特填充</strong></p><p>在PPP协议中，除了使用字节填充的方法来保证透明传输外，还有一种零比特填充同样也可以保证透明传输。零比特填充的具体做法是：在发送端，先扫描整个信息字段，只要发现连续5个1，则立即插入一个0。经过这种零比特填充后的数据，可以保证在信息字段不会出现6个连续的1。接收端再收到一个帧时，先找到标志位F确定帧的边界，接着就对帧的信息字段进行扫描，当发现连续5个1时，就把5个连续1后面的0删除，还原成原来的数据比特流。这样就可以保证透明传输。大致过程如下：</p><div class=pgc-img><img alt=PPP协议（点对点协议）详解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/748a58c822b64a49948ac58385baceff><p class=pgc-img-caption></p></div><hr><p><br></p><p><strong>PPP协议的工作状态</strong></p><p>上面我们介绍了PPP协议帧格式，下面我们来简单讲讲PPP链路的建立过程。</p><div class=pgc-img><img alt=PPP协议（点对点协议）详解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b635bc541dba4b529089e91ed8f18337><p class=pgc-img-caption></p></div><p>一开始，PPP链路处于“<strong>链路静止</strong>”状态。当用户PC机通过调制解调器呼叫路由器时，路由器检测到调制解调器发出来的载波信号。双方建立了物理层连接。PPP链路进入了“<strong>链路建立</strong>”的状态。</p><p>接着，LCP开始协商一些配置选项，即发送<strong>LCP的配置请求帧</strong>。这个LCP配置请求帧是一个PPP帧，其协议字段置为LCP对应的代码，信息字段包含特定的配置请求。链路另一端可以发送以下几种响应中的一种：</p><ul><li><strong>配置确认帧：</strong>所有选项都能接受</li><li><strong>配置否认帧：</strong>所有选项都理解但不接受</li><li><strong>配置拒绝帧：</strong>选项有的无法识别或不能接受，需要协商</li></ul><p>LCP协商配置后，双方就建立了LCP链路。接着，就开始进入了“<strong>鉴别</strong>”状态。在这一状态，只允许传送LCP协议的分组，鉴别协议的分组以及监测链路质量的分组。若使用<strong>口令鉴别协议PAP</strong>，则需要通信发起的一方发送身份标识符和口令（系统支持用于多次重试）。如果需要更高的安全性，可以使用更加复杂的<strong>口令握手鉴别协议CHAP</strong>。若鉴别身份失败，则进入“链路终止”状态。若鉴别成功，则进入“<strong>网络层协议</strong>”状态。</p><p>在“<strong>网络层协议</strong>”状态，PPP链路的两端的网络控制协议NCP根据网络层的不同协议互相交换网络层特定的网络控制分组。</p><p>当网络层配置完毕后，链路就进入可进行数据通信的“<strong>链路打开</strong>”状态。链路的两个PPP端点可以彼此向对方发送分组。两个PPP端点还可以发送<strong>回送请求LCP分组</strong>和回送<strong>应答LCP分组</strong>，以检查链路的状态。</p><p>数据传输结束后，可以由链路的一端发出终止请求LCP分组，用于请求终止链路连接，在收到对方发来的终止确认LCP分组后，转到“<strong>链路终止</strong>”状态。若链路出现故障，或调制解调器的载波停止后，链路状态都会从“<strong>链路打开</strong>”转到“<strong>链路终止</strong>”状态。</p><p>关于PPP协议这部分的内容暂时先介绍到这里，喜欢的朋友点个关注，感谢大家的支持。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'协议','PPP','点对点'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>