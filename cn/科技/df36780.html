<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>åœ¨Pythonä¸­å®ç°SIFT | æå®¢å¿«è¨Š</title><meta property="og:title" content="åœ¨Pythonä¸­å®ç°SIFT - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/4d54a888a82a417f9de8881a364524ef"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/df36780.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/df36780.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/df36780.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/df36780.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/df36780.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/df36780.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/df36780.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/df36780.html><meta property="article:published_time" content="2020-10-29T20:51:13+08:00"><meta property="article:modified_time" content="2020-10-29T20:51:13+08:00"><meta name=Keywords content><meta name=description content="åœ¨Pythonä¸­å®ç°SIFT"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/df36780.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>åœ¨Pythonä¸­å®ç°SIFT</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><p>å…³äºSIFTæœ‰å¾ˆå¤šå†…å®¹ã€‚æœ‰å¾ˆå¤šå¾ˆå¥½çš„æ•™ç¨‹ï¼Œä½†æ¯ä¸ªéƒ½ä¼¼ä¹ç¼ºå°‘ä¸€äº›ä¸œè¥¿ï¼Œæ— è®ºæ˜¯å…³äºç®—æ³•è¿˜æ˜¯å®ç°çš„ç»†èŠ‚ã€‚å› æ­¤ï¼Œå½“æˆ‘å†³å®šä¸ºè‡ªå·±å®æ–½SIFTæ—¶ï¼Œæˆ‘å‘ç°è‡ªå·±å¾ˆéš¾ä»è®¸å¤šæ¥æºä¸­æå–å†…å®¹ã€‚æˆ‘å®Œæˆäº†ä¸€éƒ¨åˆ†ä»»åŠ¡ï¼Œç°åœ¨åˆ†äº«æˆ‘çš„è¿‡ç¨‹ä»¥åŠå…¶ä»–æ•™ç¨‹æœªæåŠçš„ä¸€äº›ç»†èŠ‚ã€‚</p><p><strong>ä»‹ç»</strong></p><p>å¯¹äºåˆå­¦è€…æ¥è¯´ï¼ŒSIFTæ˜¯ä»€ä¹ˆï¼ŸSIFTæ˜¯å°ºåº¦ä¸å˜ç‰¹å¾å˜æ¢ï¼Œæ˜¯ä¸€ç§ç”¨äºæå–æè¿°å›¾åƒçš„å±€éƒ¨æ–‘å—çš„ç‰¹å¾å‘é‡çš„æ–¹æ³•ã€‚è¿™äº›ç‰¹å¾å‘é‡ä¸ä»…å…·æœ‰å°ºåº¦ä¸å˜æ€§ï¼Œè€Œä¸”å¯¹äºå¹³ç§»ï¼Œæ—‹è½¬å’Œå…‰ç…§åº¦ä¹Ÿæ˜¯ä¸å˜çš„ã€‚å‡ ä¹æ˜¯æè¿°ç¬¦çš„åœ£æ¯ã€‚</p><p>è¿™äº›æè¿°ç¬¦å¯¹äºåŒ¹é…å¯¹è±¡æ˜¯å›¾åƒä¹‹é—´çš„è¡¥ä¸éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘åˆ›å»ºå…¨æ™¯å›¾ã€‚å‡è®¾æ¯ä¸ªå›¾åƒéƒ½æœ‰ä¸€äº›é‡å çš„éƒ¨åˆ†ï¼Œä½ éœ€è¦ä¸€äº›æ–¹æ³•æ¥å¯¹é½å®ƒä»¬ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°†å®ƒä»¬æ‹¼æ¥åœ¨ä¸€èµ·ã€‚å¦‚æœæˆ‘ä»¬çŸ¥é“æ¯ä¸ªå›¾åƒä¸­æœ‰ä¸€äº›ç‚¹å¯¹åº”ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å•åº”æ€§æ¥æ‰­æ›²å…¶ä¸­ä¸€ä¸ªå›¾åƒã€‚SIFTä¸ä»…å¯ä»¥è‡ªåŠ¨æŸ¥æ‰¾æ¯ä¸ªå›¾åƒä¸­çš„å¯¹åº”ç‚¹ï¼Œè¿˜å¯ä»¥è‡ªåŠ¨æŸ¥æ‰¾æ˜“äºåŒ¹é…çš„ç‚¹ã€‚</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å®ç°SIFT onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4d54a888a82a417f9de8881a364524ef><p class=pgc-img-caption>ä¸¤ä¸ªå›¾åƒå…·æœ‰é‡å åŒºåŸŸ</p></div><div class=pgc-img><img alt=åœ¨Pythonä¸­å®ç°SIFT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7705b63956514d88b71dc2e07d36a437><p class=pgc-img-caption>ä½¿ç”¨SIFTç‰¹å¾ç‚¹çš„å•åº”æ€§è½¬æ¢ä¸€ä¸ªå›¾åƒåçš„ç»“æœ</p></div><p><strong>ç®—æ³•æè¿°</strong></p><p>SIFTç®—æ³•æœ‰äº”ä¸ªä¸»è¦æ­¥éª¤ï¼š</p><ol><li>å°ºåº¦ç©ºé—´æå€¼æ£€æµ‹</li><li>å…³é”®ç‚¹æœ¬åœ°åŒ–</li><li>æ¶ˆé™¤è¾¹ç¼˜å“åº”</li><li>æ–¹å‘åˆ†é…</li><li>æœ¬åœ°æè¿°ç¬¦åˆ›å»º</li></ol><p>å°ºåº¦ç©ºé—´æå€¼æ£€æµ‹</p><p>å¯ä»¥ä½¿ç”¨æ ‡åº¦å½’ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯é«˜æ–¯ï¼ˆLoGï¼‰æ»¤æ³¢å™¨æ¥æ£€æµ‹ç‰¹å¾çš„ç‰¹å¾å°ºåº¦ã€‚è¿™å°±æ˜¯LoGè¿‡æ»¤å™¨çš„æ ·å­ï¼š</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å®ç°SIFT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/27e9d3b8b67640e3862a3b836294e2b2><p class=pgc-img-caption></p></div><p><strong>è´Ÿé¢çš„</strong></p><p>LoGæ»¤æ³¢å™¨åœ¨ä¸­å¿ƒå¤„å…·æœ‰é«˜å³°å€¼ï¼ŒåŒæ—¶å˜ä¸ºç•¥å¾®è´Ÿçš„ï¼Œç„¶ååœ¨è·ç¦»ä¸­å¿ƒä¸€å®šè·ç¦»å¤„ä¸ºé›¶ï¼Œå…¶ç‰¹å¾åœ¨äºé«˜æ–¯çš„æ ‡å‡†åå·®sigmaï¼ˆâˆ‘ï¼ŒÏƒï¼‰ã€‚</p><p>å› æ­¤ï¼ŒLoGæ»¤æ³¢å™¨ç”±åœ†æˆ–blobæœ€é«˜åº¦æ¿€æ´»ï¼ŒåŠå¾„ä¸sigmaæˆæ¯”ä¾‹ã€‚ç„¶è€Œï¼Œé«˜æ–¯æ˜¯æ ‡å‡†åŒ–çš„åˆ†å¸ƒï¼Œå³å¦‚æœä½ å°†å®ƒæ•´åˆåˆ°æ‰€æœ‰ç©ºé—´ï¼Œå®ƒæ€»å’Œä¸º1ã€‚å› æ­¤ï¼Œå¯¹äºæ›´é«˜çš„sigmaå¹¶å› æ­¤æ›´å®½çš„é«˜æ–¯ï¼ŒLoGæ»¤æ³¢å™¨å¯¹è¯¥é«˜æ–¯çš„å“åº”å°†ä½äºè¾ƒå°çš„sigmaã€‚å› æ­¤ï¼ŒSIFTä½¿ç”¨<strong>æ ‡å‡†å½’ä¸€åŒ–çš„</strong> LoGæ»¤æ³¢å™¨ï¼Œå®ƒæ˜¯å¸¸è§„LoGä¹˜ä»¥æ–¹å·®ï¼ˆsigmaå¹³æ–¹ï¼‰ã€‚</p><p>DoGï¼ˆDifference of Gaussianï¼‰è¿‘ä¼¼</p><p>è™½ç„¶è§„æ¨¡æ ‡å‡†åŒ–çš„LoGå¾ˆå¥½ï¼Œä½†è®¡ç®—æˆæœ¬å¾ˆé«˜ï¼Œç‰¹åˆ«æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦åœ¨è®¸å¤šä¸åŒçš„å°ºåº¦ä¸Šè¿›è¡Œè®¡ç®—ã€‚ä¸è¿‡ï¼ŒSIFTçš„ä½œè€…æå‡ºäº†ä¸€ç§å·§å¦™çš„æ–¹æ³•æ¥æœ‰æ•ˆåœ°è®¡ç®—è®¸å¤šå°ºåº¦çš„LoGã€‚</p><p>äº‹å®è¯æ˜ï¼Œå…·æœ‰ç›¸ä¼¼æ–¹å·®çš„ä¸¤ä¸ªé«˜æ–¯çš„å·®å¼‚äº§ç”Ÿçš„æ»¤æ³¢å™¨éå¸¸æ¥è¿‘äºå°ºåº¦æ ‡å‡†åŒ–çš„LoGï¼š</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å®ç°SIFT onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/7ff08a5cd79d4805b93c2ff9306fab2a><p class=pgc-img-caption>ä¸¤ä¸ªé«˜æ–¯çš„å·®å¼‚è¿‘ä¼¼äºé«˜æ–¯çš„æ‹‰æ™®æ‹‰æ–¯ç®—å­</p></div><p>DoGï¼ˆDifference of Gaussianï¼‰é‡‘å­—å¡”</p><p>æ—¢ç„¶æˆ‘ä»¬æœ‰ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•æ¥é€¼è¿‘LoGï¼Œæˆ‘ä»¬éœ€è¦åœ¨å¤šä¸ªå°ºåº¦ä¸Šè¿›è¡Œè®¡ç®—ã€‚SIFTä½¿ç”¨å¤šä¸ªOctaveæ¥è®¡ç®—DoGã€‚å¤§å¤šæ•°äººä¼šè®¤ä¸ºè®¡ç®—å…«ä¸ªå›¾åƒéœ€è¦å…«ä¸ªOctaveæ¥ä½¿ç”¨ã€‚ç„¶è€Œï¼ŒOctaveå®é™…ä¸Šæ˜¯ä¸€ç»„å›¾åƒï¼Œå…¶ä¸­æœ€åä¸€ä¸ªå›¾åƒçš„æ¨¡ç³Šæ˜¯ç¬¬ä¸€ä¸ªå›¾åƒçš„æ¨¡ç³Šçš„<strong>ä¸¤å€</strong>ã€‚</p><p>è¦åˆ›å»ºè¿™ä¸ªOctaveï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦é€‰æ‹©æ¯ä¸ªOctaveä¸­æƒ³è¦çš„å›¾åƒæ•°é‡ã€‚è¿™ç”±sè¡¨ç¤ºã€‚ç„¶åé€‰æ‹©é«˜æ–¯æ»¤æ³¢å™¨çš„sigmaä¸º2 ^ï¼ˆ1 / sï¼‰ã€‚ç”±äºæ¨¡ç³Šç´¯ç§¯ç´¯åŠ ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨æ­¤æ»¤é•œsæ¬¡æ¨¡ç³ŠåŸå§‹å›¾åƒæ—¶ï¼Œç»“æœå°†å…·æœ‰æ¨¡ç³Š= 2 *åŸå§‹æ¨¡ç³Šã€‚</p><p>æˆ‘å¾ˆå°‘çœ‹åˆ°çš„å…¶ä»–å†…å®¹ä¸­çš„ä¸€ä¸ªç»†èŠ‚æ˜¯ï¼Œåœ¨æ¯ä¸ªOctaveä¸­ï¼Œä½ å®é™…ä¸Šéœ€è¦äº§ç”Ÿs + 3ä¸ªå›¾åƒï¼ˆåŒ…æ‹¬åŸå§‹å›¾åƒï¼‰ã€‚è¿™æ˜¯å› ä¸ºå½“å‡å»ç›¸é‚»çº§åˆ«ä»¥è·å¾—è¿‘ä¼¼çš„LoG Octaveæ—¶ï¼Œæˆ‘ä»¬å°†è·å¾—æ¯”Gaussian octaveå°‘ä¸€ä¸ªçš„å›¾åƒï¼š</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å®ç°SIFT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/41425698049946cf831a239b5d9dad21><p class=pgc-img-caption>ç”¨äºSIFTçš„é«˜æ–¯é‡‘å­—å¡”</p></div><p>ç°åœ¨æˆ‘ä»¬åœ¨DoG Octaveä¸­æœ‰s + 2ä¸ªå›¾åƒã€‚ä½†æ˜¯ï¼Œç¨åå½“æˆ‘ä»¬åœ¨DoGä¸­æŸ¥æ‰¾æå€¼æ—¶ï¼Œæˆ‘ä»¬å°†æŸ¥æ‰¾å½“å‰å’Œç›¸é‚»çº§åˆ«æŒ‡å®šçš„é‚»åŸŸçš„æœ€å°å€¼æˆ–æœ€å¤§å€¼ã€‚æ˜¾ç„¶ï¼Œè¿™ä¸ªé‚»åŸŸä¸èƒ½åœ¨é¡¶å±‚æˆ–åº•å±‚è·å¾—ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰è¿™ä¸¤ä¸ªé¢å¤–çš„å±‚æ¬¡ï¼Œä»¥ä¾¿åœ¨ç¼©æ”¾ç©ºé—´ä¸­å®šä¹‰ä¸€ä¸ªå®Œæ•´çš„Octaveã€‚</p><p>åœ¨æˆ‘ä»¬ç”ŸæˆGaussian octaveä¹‹åï¼Œæˆ‘ä»¬å°†é¡¶çº§ä¸‹é‡‡æ ·2å¹¶å°†å…¶ç”¨ä½œæ–°Octaveçš„åº•å±‚ã€‚è¿™äº›Octaveç»„æˆäº†æˆ‘æ‰€è¯´çš„é«˜æ–¯é‡‘å­—å¡”ã€‚</p><p>å±¥è¡Œ</p><p>æœ€åæˆ‘ä»¬å¾—åˆ°äº†ä¸€äº›ä»£ç ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æ˜¾ç„¶éœ€è¦ä¸€ä¸ªé«˜æ–¯æ»¤æ³¢å™¨æ¥åˆ›å»ºGaussian octaveï¼š</p><pre>def gaussian_filter(sigma):size = 2*np.ceil(3*sigma)+1x, y = np.mgrid[-size//2 + 1:size//2 + 1, -size//2 + 1:size//2 + 1] g = np.exp(-((x**2 + y**2)/(2.0*sigma**2))) / (2*np.pi*sigma**2)return g/g.sum() </pre><p>è¿™å‡è®¾numpyå·²ç»ä½œä¸ºnpå¯¼å…¥ï¼ˆå› ä¸ºå®ƒæ€»æ˜¯åº”è¯¥ï¼‰ã€‚æˆ‘ä¹ŸæŠŠå®ƒæ”¾åœ¨ä¸€ä¸ªåä¸ºçš„æ–‡ä»¶ä¸­gaussian_filter.pyã€‚æ¥ä¸‹æ¥ï¼Œä¸ºäº†ç”ŸæˆGaussian octaveï¼Œæˆ‘ä»¬åªéœ€è¦é€‰æ‹©sigmaå¹¶ç”¨è¿™ä¸ªé«˜æ–¯æ»¤æ³¢å™¨é‡å¤å·ç§¯ï¼š</p><pre>from scipy.ndimage.filters import convolvefrom gaussian_filter import gaussian_filter  def generate_octave(init_level, s, sigma):octave = [init_level]k = 2**(1/s)kernel = gaussian_filter(k * sigma)  for _in range(s+2):next_level = convolve(octave[-1], kernel)octave.append(next_level) return octave</pre><p>æ­£å¦‚åœ¨æ–‡ä¸­ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯5ã€‚å¦ä¸€ä¸ªéœ€è¦æ³¨æ„çš„æ˜¯sigmaå‚æ•°ã€‚æ­¤å‚æ•°ç”¨äºç¼©æ”¾kï¼Œä»¥ä¾¿æ¯ä¸ªDoG octaveä¸­çš„æ¨¡ç³Šæ¥è‡ªsigma - > 2 * sigmaã€‚æˆ‘ä¸ºsigmaä½¿ç”¨å€¼1.6ã€‚ç„¶åç”Ÿæˆæ•´ä¸ªé«˜æ–¯é‡‘å­—å¡”ï¼š</p><pre> def generate_gaussian_pyramid(im, num_octave, s, sigma):pyr = [] for _ in range(num_octave):octave = generate_octave(im, s, sigma)pyr.append(octave)im = octave[-3][::2, ::2] return pyr</pre><p>ç”±äºæˆ‘ä»¬æ¯ä¸ªOctaveç”Ÿæˆs + 3ä¸ªå›¾åƒï¼Œæˆ‘ä»¬ä½¿ç”¨ç¬¬ä¸‰ä¸ªåˆ°æœ€åä¸€ä¸ªå›¾åƒä½œä¸ºä¸‹ä¸€ä¸ªOctaveçš„åŸºç¡€ï¼Œå› ä¸ºé‚£æ˜¯ä¸€ä¸ªæ¨¡ç³Šä¸º2 * sigmaçš„å›¾åƒã€‚</p><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†é«˜æ–¯é‡‘å­—å¡”ï¼Œåˆ›å»ºDoGé‡‘å­—å¡”æ˜¯å¾ˆç®€å•çš„ï¼š</p><pre> def generate_DoG_octave(gaussian_octave):octave = [] for i in range(1, len(gaussian_octave)):octave.append(gaussian_octave[i] â€” gaussian_octave[i-1]) return np.concatenate([o[:,:,np.newaxis] for o in octave], axis=2ï¼‰ def generate_DoG_pyramid(gaussian_pyramid):pyr = [] for gaussian_octave in gaussian_pyramid:pyr.append(generate_DoG_octave(gaussian_octave)) return pyr</pre><p>ç°åœ¨æˆ‘ä»¬æœ‰å››ä¸ªDoG octaveï¼Œæ¯ä¸ªéƒ½æœ‰s + 2çº§æ¨¡ç³Šã€‚æˆ‘ä»¬ç°åœ¨å¯ä»¥ç»§ç»­æ£€æµ‹å°ºåº¦ç©ºé—´ä¸­çš„æå€¼ã€‚</p><p>æå€¼æ£€æµ‹</p><p>æå€¼æ£€æµ‹çš„ç¬¬ä¸€æ­¥æ˜¯æ‰«ææ¯ä¸ªæ ‡åº¦ç©ºé—´DoG octaveçš„ Då€¼ï¼Œå¹¶å°†æ¯ä¸ª3x3x3é‚»åŸŸçš„ä¸­å¿ƒä½œä¸ºå…³é”®ç‚¹ï¼Œå¦‚æœå®ƒæ˜¯é‚»åŸŸä¸­çš„æœ€å°å€¼æˆ–æœ€å¤§å€¼ã€‚</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å®ç°SIFT onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e4070c372c6d452a9e6ae55c1d72e3e0><p class=pgc-img-caption>åˆå§‹å°ºåº¦ç©ºé—´æå€¼æ£€æµ‹çš„é‚»åŸŸ</p></div><p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨DoG octaveä¸­ç”Ÿæˆs + 2çº§åˆ«çš„åŸå› ï¼Œå› ä¸ºæˆ‘ä»¬æ— æ³•æ‰«æé¡¶éƒ¨æˆ–åº•éƒ¨çš„ç‚¹ï¼Œä½†æˆ‘ä»¬ä»ç„¶æƒ³è¦åœ¨æ•´ä¸ªOctaveæ¨¡ç³Šç‚¹ä¸Šè·å¾—å…³é”®ç‚¹ã€‚</p><p>å±¥è¡Œ</p><p>ç»™å®šDoG octaveï¼Œæˆ‘ä»¬è·å¾—åˆå§‹å€™é€‰å…³é”®ç‚¹ï¼š</p><pre> def get_candidate_keypoints(D, w=16):candidates = []D[:,:,0] = 0D[:,:,-1] = 0 for i in range(w//2+1, D.shape[0]-w//2â€“1):for j in range(w//2+1, D.shape[1]-w//2â€“1):for k in range(1, D.shape[2]-1):patch = D[i-1:i+2, j-1:j+2, k-1:k+2]if np.argmax(patch) == 13 or np.argmin(patch) == 13:candidates.append([i, j, k]) return candidates</pre><p>è¿™æ®µä»£ç çš„å†…å®¹è§£é‡Šï¼š</p><p>æˆ‘å°†é¡¶éƒ¨å’Œåº•éƒ¨çš„é¢å¤–çº§åˆ«è®¾ç½®ä¸º0ï¼Œå› ä¸ºæˆ‘æœ€åˆåªæ˜¯åœ¨è¿™äº›çº§åˆ«ä¸­è·å¾—æå€¼ã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºDoG octaveçš„æ„é€ ä¸æ­£ç¡®ï¼Œä½†å´è¿è¡Œå¾—è¿˜å¯ä»¥ã€‚</p><ol><li>æˆ‘ä»¬æœ‰ä¸€ä¸ªw / 2çš„å¡«å……ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªçº§åˆ«ä¸Šä½¿ç”¨ä¸€ä¸ªå¡«å……è¿›è¡Œæ‰«æï¼Œå…¶ä¸­wæ˜¯åˆ›å»ºå±€éƒ¨æè¿°ç¬¦æ—¶ä½¿ç”¨çš„è¡¥ä¸çš„è¾¹é•¿ã€‚æ²¡æœ‰è¿™ä¸ªï¼Œå°±ä¼šå‡ºé”™è¯¯ã€‚</li><li>è°ƒç”¨argmaxæˆ–argminä¸è°ƒç”¨è½´å‚æ•°åœ¨å±•å¹³çš„æ•°ç»„ä¸Šè¿è¡Œã€‚ç”±äºæˆ‘ä»¬çš„é‚»åŸŸæ˜¯3x3x3æˆ–27ä¸ªå…ƒç´ é•¿ï¼Œå½“æå€¼æ˜¯æˆ‘ä»¬æ£€æŸ¥çš„åƒç´ æ—¶ï¼Œargmaxæˆ–argminçš„å€¼å°†æ˜¯13ã€‚</li></ol><p>è¿™äº›å€™é€‰å…³é”®ç‚¹ä¼šäº§ç”Ÿè®¸å¤šç³Ÿç³•çš„é€‰æ‹©å’Œå™ªå£°ï¼Œå› æ­¤åœ¨ä¸‹ä¸€èŠ‚ä¸­æˆ‘ä»¬å°†é€‰æ‹©å¥½çš„å…³é”®ç‚¹å¹¶æŠ›å¼ƒéƒ¨åˆ†ä¸å¥½çš„ç‚¹ã€‚</p><p>å…³é”®ç‚¹å®šä½</p><p>æˆ‘ä»¬å°†æ‰§è¡Œä¸‰ä¸ªæ­¥éª¤æ¥è·å¾—æ›´å¥½çš„å…³é”®ç‚¹ï¼š</p><ol><li>è®¡ç®—æ¯ä¸ªå…³é”®ç‚¹çš„å­åƒç´ ä½ç½®</li><li>å¦‚æœå­åƒç´ å¤„çš„æ¯”ä¾‹ç©ºé—´å€¼ä½äºé˜ˆå€¼ï¼Œåˆ™ä¸¢å¼ƒè¯¥å…³é”®ç‚¹</li><li>ä½¿ç”¨å›´ç»•æ¯ä¸ªå­åƒç´ å…³é”®ç‚¹çš„Hessianæ¶ˆé™¤è¾¹ç¼˜ä¸Šçš„å…³é”®ç‚¹</li></ol><p>å­åƒç´ å®šä½</p><p>åœ¨è®¸å¤šå›¾åƒä¸­ï¼Œåœ¨åˆ†è¾¨ç‡ä¸å¤Ÿç²¾ç¡®çš„æ—¶å€™å¾ˆéš¾æ‰¾åˆ°ç¨³å®šçš„å…³é”®ç‚¹ï¼Œå³åœ¨å¤šä¸ªæ¡ä»¶ä¸‹åœ¨å¤šä¸ªå›¾åƒä¸­çš„ç›¸åŒä½ç½®ã€‚å› æ­¤ï¼ŒSIFTçš„åˆ›å»ºè€…ä½¿ç”¨DoG octaveçš„äºŒé˜¶Taylorå±•å¼€æ¥è¿›ä¸€æ­¥å®šä½æ¯ä¸ªå…³é”®ç‚¹ã€‚</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å®ç°SIFT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a23102a79fed48f890482e07047e3844><p class=pgc-img-caption>DoG octaveçš„äºŒé˜¶Taylorå±•å¼€</p></div><p>è¿™é‡Œï¼Œxæ˜¯ä¸å¤‡é€‰å…³é”®ç‚¹çš„åƒç´ ä½ç½®å¯¹åº”çš„ä¸‰ç»´çŸ¢é‡[xï¼Œyï¼Œsigma]ã€‚å°†è¯¥ç­‰å¼çš„å¯¼æ•°ç›¸å¯¹äºxå¹¶å°†å…¶è®¾ç½®ä¸ºç­‰äºé›¶ï¼Œå¾—åˆ°å…³é”®ç‚¹çš„å­åƒç´ åç§»ï¼š</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å®ç°SIFT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/99b0dd8272db43a19961885f74056026><p class=pgc-img-caption>å¤‡é€‰å…³é”®ç‚¹åç§»ï¼ˆäºŒé˜¶ï¼‰</p></div><p>å°†æ­¤åç§»æ·»åŠ åˆ°åŸå§‹å…³é”®ç‚¹ä½ç½®ä»¥å®ç°å­åƒç´ ç²¾åº¦ã€‚</p><p><strong>å®ç°</strong></p><p>æˆ‘ä»¬éœ€è¦å›´ç»•æ¯ä¸ªå€™é€‰å…³é”®ç‚¹è®¡ç®—Jacobianå’ŒHessianä»¥è·å¾—åç§»é‡ï¼š</p><pre>def localize_keypoint(D, x, y, s):dx = (D[y,x+1,s]-D[y,x-1,s])/2.dy = (D[y+1,x,s]-D[y-1,x,s])/2.ds = (D[y,x,s+1]-D[y,x,s-1])/2. dxx = D[y,x+1,s]-2*D[y,x,s]+D[y,x-1,s] dxy = ((D[y+1,x+1,s]-D[y+1,x-1,s]) â€” (D[y-1,x+1,s]-D[y-1,x-1,s]))/4. dxs = ((D[y,x+1,s+1]-D[y,x-1,s+1]) â€” (D[y,x+1,s-1]-D[y,x-1,s-1]))/4. dyy = D[y+1,x,s]-2*D[y,x,s]+D[y-1,x,s]dys = ((D[y+1,x,s+1]-D[y-1,x,s+1]) â€” (D[y+1,x,s-1]-D[y-1,x,s-1]))/4.dss = D[y,x,s+1]-2*D[y,x,s]+D[y,x,s-1] J = np.array([dx, dy, ds])HD = np.array([ [dxx, dxy, dxs], [dxy, dyy, dys], [dxs, dys, dss]]) offset = -LA.inv(HD).dot(J)return offset, J, HD[:2,:2], x, y, s</pre><p>é¦–å…ˆï¼Œè®¡ç®—é›…å¯æ¯”è¡Œåˆ—å¼çš„ä¸€é˜¶å¯¼æ•°ã€‚ç„¶åï¼Œæˆ‘ä»¬è®¡ç®—Hessiançš„äºŒé˜¶å¯¼æ•°ã€‚Hessianæ˜¯å¯¹ç§°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è®¡ç®—å…­ä¸ªå¯¼æ•°è€Œä¸æ˜¯ä¹ä¸ªã€‚æˆ‘ä»¬è¿”å›Jå’ŒHå› ä¸ºæˆ‘ä»¬ä»¥åä¼šéœ€è¦å®ƒä»¬ã€‚</p><p>ä½œä¸ºæ—æ³¨ï¼Œå½“åç§»çš„ç»´åº¦å¤§äº0.5æ—¶ï¼Œè¿™æ„å‘³ç€å®ƒå®é™…ä¸Šæ›´æ¥è¿‘å¦ä¸€ä¸ªåƒç´ çº§å…³é”®ç‚¹ã€‚</p><p><strong>ä¸¢å¼ƒä½å¯¹æ¯”åº¦å…³é”®ç‚¹</strong></p><p>ç°åœ¨å¯ä»¥å°†æ¯ä¸ªå­åƒç´ å…³é”®ç‚¹çš„å¯¹æ¯”åº¦è®¡ç®—ä¸ºï¼š</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å®ç°SIFT onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e58678d970304374821c292894431d8a><p class=pgc-img-caption>å­åƒç´ å…³é”®ç‚¹å¯¹æ¯”åº¦</p></div><p>å“ªä¸ªå­åƒç´ åç§»æ·»åŠ åˆ°åƒç´ çº§ä½ç½®ã€‚å¦‚æœç»å¯¹å€¼ä½äºé˜ˆå€¼ï¼Œæˆ‘ä»¬å°±ä¼šæŠ›å‡ºè¿™ä¸€ç‚¹ã€‚æˆ‘ä»¬è¿™æ ·åšæ˜¯å› ä¸ºæˆ‘ä»¬æƒ³è¦æç«¯ï¼Œæç«¯ï¼Œæç«¯ã€‚</p><p>æ¶ˆé™¤è¾¹ç¼˜å“åº”</p><p>å°ºåº¦æ ‡å‡†åŒ–çš„LoGå°†åœ¨è§’è½å’Œè¾¹ç¼˜å¤„åˆ›å»ºé«˜å¯¹æ¯”åº¦å“åº”ã€‚ä½†æ˜¯ï¼Œè¾¹ç¼˜ä¸Šçš„å…³é”®ç‚¹åº”è¯¥è¢«ä¸¢å¼ƒï¼Œå› ä¸ºå®ƒä»¬çš„æ–¹å‘æ˜¯æ¨¡ç³Šçš„ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨è®¡ç®—å­åƒç´ åç§»æ—¶è®¡ç®—çš„Hessianã€‚è¿™ä¸ªè¿‡ç¨‹éå¸¸ç±»ä¼¼äºä½¿ç”¨Harrisè§’ç‚¹æ¢æµ‹å™¨å¯»æ‰¾è§’ç‚¹ã€‚</p><p>æˆ‘ä»¬è¿”å›çš„Hessian localize_keypointçš„å½¢å¼å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å®ç°SIFT onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/390ca2d7b19344338b2c787548646359><p class=pgc-img-caption>Hessianåœ¨è§„æ¨¡ç©ºé—´ä¸æ›²ç‡æˆæ¯”ä¾‹</p></div><p>å¦‚æœä½ ç†Ÿæ‚‰Harrisæ¢æµ‹å™¨ï¼Œå¦‚æœHçš„ç‰¹å¾å€¼ï¼ˆæ¯”å¦‚Aå’ŒBï¼‰éƒ½å¾ˆâ€‹â€‹å¤§ï¼Œé‚£ä¹ˆå…³é”®ç‚¹å¾ˆå¯èƒ½æ˜¯ä¸€ä¸ªè§’ã€‚ç›¸åï¼Œå¦‚æœä¸€ä¸ªå¤§å¾—å¤šï¼Œé‚£ä¹ˆå®ƒå¾ˆå¯èƒ½æ˜¯è¾¹ç¼˜ã€‚</p><p>å³ä½¿è®¡ç®—è¿™ä¸ªçŸ©é˜µçš„ç‰¹å¾å€¼æ˜¯å¾ˆä¾¿å®œçš„ï¼Œè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•å¯ä»¥ç”¨æ¥è·å–Hçš„è·Ÿè¸ªå’Œè¡Œåˆ—å¼ã€‚æˆ‘ä»¬å°†æ”¾å¼ƒåœ¨è¿™é‡Œè®¨è®ºã€‚</p><p>å®ç°</p><p>æˆ‘ä»¬åœ¨ä»¥ä¸‹åŠŸèƒ½ä¸­æ‰§è¡Œä¸Šè¿°æ­¥éª¤ï¼š</p><pre> def find_keypoints_for_DoG_octave(D, R_th, t_c, w):candidates = get_candidate_keypoints(D, w)keypoints = [] for i, cand in enumerate(candidates):y, x, s = cand[0], cand[1], cand[2]offset, J, H, x, y, s = localize_keypoint(D, x, y, s) contrast = D[y,x,s] + .5*J.dot(offset)if abs(contrast) &lt; t_c: continue w, v = LA.eig(H)r = w[1]/w[0] R = (r+1)**2 / rif R &gt; R_th: continue kp = np.array([x, y, s]) + offsetkeypoints.append(kp) return np.array(keypoints)</pre><p>æˆ‘ä½¿ç”¨æ¥è‡ªpaperçš„å€¼t_cå’ŒR_thå³åˆ†åˆ«ä¸º0.03å’Œï¼ˆ10 + 1ï¼‰2/10ã€‚</p><p>ç°åœ¨è®¡ç®—æ•´ä¸ªDoGé‡‘å­—å¡”çš„å…³é”®ç‚¹æ˜¯å¾®ä¸è¶³é“çš„ï¼š</p><pre> def get_keypoints(DoG_pyr, R_th, t_c, w):kps = [] for D in DoG_pyr:kps.append(find_keypoints_for_DoG_octave(D, R_th, t_c, w)) return kps</pre><p><strong>æ–¹å‘åˆ†é…</strong></p><p>è·å¾—å…³é”®ç‚¹åªæ˜¯æˆåŠŸçš„ä¸€åŠã€‚ç°åœ¨æˆ‘ä»¬å¿…é¡»è·å¾—å®é™…çš„æè¿°ç¬¦ã€‚ä½†åœ¨æˆ‘ä»¬è¿™æ ·åšä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿å¦ä¸€ç§ä¸å˜æ€§ï¼šæ—‹è½¬ã€‚</p><p>æˆ‘ä»¬æœ‰å¹³ç§»ä¸å˜æ€§ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨å›¾åƒä¸Šå¯¹æ»¤æ³¢å™¨è¿›è¡Œå·ç§¯ã€‚ç”±äºæˆ‘ä»¬ä½¿ç”¨äº†æ ‡åº¦å½’ä¸€åŒ–çš„LoGæ»¤æ³¢å™¨ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿå…·æœ‰å°ºåº¦ä¸å˜æ€§ã€‚ç°åœ¨ä¸ºäº†æ–½åŠ æ—‹è½¬ä¸å˜æ€§ï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªå…³é”®ç‚¹å‘¨å›´åˆ†é…ä¸€ä¸ªä¸å…¶ä¸»è¦æ¢¯åº¦æ–¹å‘ç›¸å¯¹åº”çš„æ–¹å‘ã€‚å½“æˆ‘ä»¬ä½¿ç”¨æ¢¯åº¦ç›´æ–¹å›¾æè¿°ç¬¦æ¥æè¿°æ¯ä¸ªè¡¥ä¸æ—¶ï¼Œè¿™ä¼šæœ‰ç‚¹ç”¨çš„ã€‚</p><p>ä¸ºäº†åˆ†é…æ–¹å‘ï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªå…³é”®ç‚¹å‘¨å›´é‡‡ç”¨ä¸€ä¸ªè¡¥ä¸ï¼Œå…¶å¤§å°ä¸è¯¥å…³é”®ç‚¹çš„æ¯”ä¾‹æˆæ­£æ¯”ã€‚ç„¶åï¼Œæˆ‘ä»¬ä¸ºè¯¥è¡¥ä¸ä¸­çš„æ¯ä¸ªåƒç´ åˆ›å»ºæ¸å˜çš„ç›´æ–¹å›¾ã€‚</p><p>ç›´æ–¹å›¾æ˜¯åœ¨è§’åº¦ä¸Šåˆ›å»ºçš„ï¼ˆæ¢¯åº¦åœ¨æåº§æ ‡ä¸­æŒ‡å®šï¼‰å¹¶ä¸”å…·æœ‰36ä¸ªç®±ï¼ˆæ¯ä¸ªç®±å…·æœ‰10åº¦çš„å®½åº¦ï¼‰ã€‚å½“è®¡ç®—åƒç´ å¤„çš„æ¢¯åº¦çš„å¤§å°å’Œè§’åº¦æ—¶ï¼Œæˆ‘ä»¬çš„ç›´æ–¹å›¾ä¸­çš„å¯¹åº”åŒºé—´å¢é•¿äº†ç”±é«˜æ–¯çª—å£åŠ æƒçš„æ¢¯åº¦å¤§å°ã€‚</p><p>ä¸€æ—¦æˆ‘ä»¬å¾—åˆ°ç›´æ–¹å›¾ï¼Œæˆ‘ä»¬å°±ä¸ºè¯¥å…³é”®ç‚¹æŒ‡å®šæœ€å¤§ç›´æ–¹å›¾binçš„æ–¹å‘ã€‚</p><p>å®ç°</p><pre> def assign_orientation(kps, octave, num_bins=36):new_kps = []bin_width = 360//num_bins for kp in kps:cx, cy, s = int(kp[0]), int(kp[1]), int(kp[2])s = np.clip(s, 0, octave.shape[2]-1)sigma = kp[2]*1.5w = int(2*np.ceil(sigma)+1)kernel = gaussian_filter(sigma)L = octave[â€¦,s]hist = np.zeros(num_bins, dtype=np.float32) for oy in range(-w, w+1):for ox in range(-w, w+1):x, y = cx+ox, cy+oyif x &lt; 0 or x &gt; octave.shape[1]-1: continueelif y &lt; 0 or y &gt; octave.shape[0]-1: continue m, theta = get_grad(L, x, y)weight = kernel[oy+w, ox+w] * mbin = quantize_orientation(theta, num_bins)hist[bin] += weight max_bin = np.argmax(hist)new_kps.append([kp[0], kp[1], kp[2], max_bin])max_val = np.max(hist) for binno, val in enumerate(hist):if binno == max_bin: continueif .8 * max_val &lt;= val:new_kps.append([kp[0], kp[1], kp[2], binno*bin_width]) return np.array(new_kps)</pre><p>å…³äºè¿™ä¸ªå‡½æ•°æˆ‘æƒ³æåˆ°çš„ä¸€ä»¶äº‹æ˜¯æœ€åä¸€ä¸ªå¾ªç¯ã€‚æœ¬æ–‡è§„å®šï¼Œå¯¹äºä»»ä½•ç›´æ–¹å›¾binï¼Œå…¶å€¼å¤§äºæœ€å¤§å€¼çš„80ï¼…ï¼Œä»¥åœ¨è¯¥ä½ç½®åˆ›å»ºæ–°å…³é”®ç‚¹å¹¶è¿›è¡Œç¼©æ”¾ä½†å…·æœ‰æ–°æ–¹å‘ã€‚</p><p>æ­¤å¤–ï¼Œæœ¬æ–‡è¿˜è¯´æ‚¨åº”è¯¥å°†æŠ›ç‰©çº¿æ‹Ÿåˆåˆ°æœ€æ¥è¿‘æœ€å¤§å€¼çš„ä¸‰ä¸ªç›´æ–¹å›¾å€¼ï¼Œä½†åœ¨æ­¤å®ç°ä¸­çœç•¥äº†è¿™ä¸€ç‚¹ã€‚</p><p>æ­¤ä»£ç ä¸­è¿˜åŒ…å«ä¸€äº›åŠŸèƒ½ã€‚é¦–å…ˆget_grads ï¼Œå®ƒè·å¾—Lä¸­åƒç´ çš„æåº§æ ‡æ¢¯åº¦ï¼š</p><pre> def cart_to_polar_grad(dx, dy):m = np.sqrt(dx**2 + dy**2)theta = (np.arctan2(dy, dx)+np.pi) * 180/np.pireturn m, theta def get_grad(L, x, y):dy = L[min(L.shape[0]-1, y+1),x] â€” L[max(0, y-1),x]dx = L[y,min(L.shape[1]-1, x+1)] â€” L[y,max(0, x-1)]return cart_to_polar_grad(dx, dy)</pre><p>ç„¶åæœ‰quantize_orientationï¼Œå®ƒåªæ˜¯å°†æ¸å˜çš„è¿ç»­è§’åº¦è½¬æ¢ä¸ºç›´æ–¹å›¾ç®±ï¼š</p><pre> </pre><p>def quantize_orientation(theta, num_bins):</p><p>bin_width = 360//num_bins</p><p>return int(np.floor(theta)//bin_width)</p><p>å®šä½æè¿°ç¬¦åˆ›å»º</p><p><em>æœ€å</em>ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸ªå…³é”®ç‚¹åˆ›å»ºå®šä½æè¿°ç¬¦ã€‚å¦‚å‰æ‰€è¿°ï¼Œæˆ‘ä»¬ä½¿ç”¨â€œæ¢¯åº¦ç›´æ–¹å›¾â€æ–¹æ³•ä»æ¯ä¸ªå…³é”®ç‚¹çš„å‘¨å›´åˆ›å»ºä¸€ä¸ªç‰¹å¾å‘é‡ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œåœ¨æ¯ä¸ªå…³é”®ç‚¹å‘¨å›´æ£€æŸ¥16x16è¡¥ä¸ã€‚ç„¶åå°†è¯¥è¡¥ä¸åˆ†æˆ16ä¸ª4x4å­åŒºåŸŸã€‚ç„¶åå°†æ¯ä¸ªå­åŒºåŸŸçš„æ¢¯åº¦ï¼ˆåœ¨æåº§æ ‡ä¸­ï¼‰åˆ†ç®±æˆ8ç®±ç›´æ–¹å›¾ã€‚æœ€åï¼Œæ‰€æœ‰è¿™äº›ç›´æ–¹å›¾è¢«è¿æ¥æˆ4x4x8 = 128ä¸ªå…ƒç´ çš„é•¿ç‰¹å¾å‘é‡ã€‚</p><p>ç„¶åå¯¹è¯¥æœ€ç»ˆç‰¹å¾å‘é‡è¿›è¡Œå½’ä¸€åŒ–ï¼Œé˜ˆå€¼åŒ–å’Œé‡æ–°å½’ä¸€åŒ–ä»¥å°è¯•å¹¶ç¡®ä¿å¯¹æ¬¡è¦å…‰ç…§å˜åŒ–çš„ä¸å˜æ€§ã€‚</p><p>å®ç°</p><pre> def get_local_descriptors(kps, octave, w=16, num_subregion=4, num_bin=8):descs = [] for kp in kps:cx, cy, s = int(kp[0]), int(kp[1]), int(kp[2])s = np.clip(s, 0, octave.shape[2]-1)kernel = gaussian_filter(w/6) # gaussian_filter multiplies sigma by 3 L = octave[â€¦,s] t, l = max(0, cy-w//2), max(0, cx-w//2) b, r = min(L.shape[0], cy+w//2+1), min(L.shape[1], cx+w//2+1) patch = L[t:b, l:r] dx, dy = get_patch_grads(patch) if dx.shape[0] &lt; w+1:if t == 0: kernel = kernel[kernel.shape[0]-dx.shape[0]:]else: kernel = kernel[:dx.shape[0]]if dx.shape[1] &lt; w+1:if l == 0: kernel = kernel[kernel.shape[1]-dx.shape[1]:]else: kernel = kernel[:dx.shape[1]]if dy.shape[0] &lt; w+1:if t == 0: kernel = kernel[kernel.shape[0]-dy.shape[0]:]else: kernel = kernel[:dy.shape[0]]if dy.shape[1] &lt; w+1:if l == 0: kernel = kernel[kernel.shape[1]-dy.shape[1]:]else: kernel = kernel[:dy.shape[1]] m, theta = cart_to_polar_grad(dx, dy)dx, dy = dx*kernel, dy*kernel subregion_w = w//num_subregion featvec = np.zeros(num_bin * num_subregion**2, dtype=np.float32) for i in range(0, subregion_w):for j in range(0, subregion_w):t, l = i*subregion_w, j*subregion_wb, r = min(L.shape[0], (i+1)*subregion_w), min(L.shape[1], (j+1)*subregion_w) hist = get_histogram_for_subregion(m[t:b, l:r].ravel(), theta[t:b, l:r].ravel(), num_bin, kp[3]) featvec[i*subregion_w*num_bin + j*num_bin:i*subregion_w*num_bin + (j+1)*num_bin] = hist.flatten()descs.append(featvec) return np.array(descs)</pre><p>å¯¹ä¸­é—´å½¢çŠ¶dxå’Œdyä¸­é—´å½¢çŠ¶çš„æ£€æŸ¥æ˜¯ä¸ºäº†é¿å…æˆ‘ä¹‹å‰é‡åˆ°çš„è¶Šç•Œé”™è¯¯ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ª/æˆ–å°äºw+1é‚£ä¹ˆç›¸åº”åœ°åˆ‡æ–­é«˜æ–¯çª—å£ä»¥é¿å…å½¢çŠ¶ä¸åŒ¹é…ã€‚</p><p>é¦–å…ˆï¼Œè®¡ç®—æ•´ä¸ªè´´ç‰‡çš„ææ€§æ¢¯åº¦ã€‚ç„¶åä¸ºæ¯ä¸ªå­åŒºåŸŸåˆ›å»ºç›´æ–¹å›¾ã€‚</p><p>è¦è®¡ç®—è¡¥ä¸ä¸­çš„æ¸å˜ï¼š</p><pre> def get_patch_grads(p):r1 = np.zeros_like(p)r1[-1] = p[-1]r1[:-1] = p[1:] r2 = np.zeros_like(p)r2[0] = p[0]r2[1:] = p[:-1] dy = r1-r2 r1[:,-1] = p[:,-1]r1[:,:-1] = p[:,1:]r2[:,0] = p[:,0]r2[:,1:] = p[:,:-1] dx = r1-r2 return dx, dy</pre><p>åªéœ€è·å–å‰ä¸€ä¸ªå’Œå½“å‰åƒç´ ä¹‹é—´çš„å·®å¼‚ã€‚è¿™æ¯”ä»¥å‰åšåŒé¢è¡ç”Ÿæ›´å®¹æ˜“ã€‚ç„¶åä¸ºæ¯ä¸ªå­åŒºåŸŸåˆ›å»ºç›´æ–¹å›¾ï¼š</p><pre> def get_histogram_for_subregion(m, theta, num_bin, reference_angle):hist = np.zeros(num_bin, dtype=np.float32) for mag, angle in zip(m, theta):binno = quantize_orientation(angle-reference_angle, num_bin)hist[binno] += mag hist /= max(1e-6, LA.norm(hist)) hist[hist&gt;0.2] = 0.2 hist /= max(1e-6, LA.norm(hist))return hist</pre><p>è¿™æ®µä»£ç ä¸å‰é¢çš„HoGä»£ç éå¸¸ç›¸ä¼¼ï¼Œä½†æ˜¯æˆ‘ä»¬å¯¹ç›´æ–¹å›¾ä¸­çš„æ¯ä¸ªæ¡ç›®æ‰§è¡Œä¸‰çº¿æ€§æ’å€¼ã€‚è¿™ä¸ªæ’å€¼æ˜¯ä¸ºäº†æä¾›é²æ£’æ€§ï¼Œå½“ä¸€ä¸ªåƒç´ çš„æ¢¯åº¦ä»ä¸€ä¸ªç®±å­åˆ°å¦ä¸€ä¸ªæˆ–åœ¨ä¸€ä¸ªå­åŒºåŸŸçš„è¾¹ç¼˜è¿›å…¥ä¸€ä¸ªä¸åŒçš„å­åŒºåŸŸã€‚</p><p>å› æ­¤ï¼Œå¯¹äºxå’Œyæ–¹å‘ï¼Œæ¡ç›®çš„æƒé‡ä¸1-(åˆ°å®¹å™¨ä¸­å¿ƒçš„è·ç¦»)å’Œ1-(åˆ°å­åŒºåŸŸä¸­å¿ƒçš„è·ç¦»)æˆæ­£æ¯”ã€‚</p><p><strong>æŠŠå®ƒæ”¾åœ¨ä¸€èµ·</strong></p><p>æˆ‘ä»¬ç°åœ¨å¯ä»¥åˆ›å»ºä¸€ä¸ªSIFTå¯¹è±¡æ¥å°è£…æ‰€æœ‰ä¸Šè¿°æ“ä½œï¼š</p><pre> class SIFT(object):def __init__(self, im, s=3, num_octave=4, s0=1.3, sigma=1.6, r_th=10, t_c=0.03, w=16):self.im = convolve(rgb2gray(im), gaussian_filter(s0))self.s = sself.sigma = sigmaself.num_octave = num_octaveself.t_c = t_cself.R_th = (r_th+1)**2 / r_thself.w = w def get_features(self):gaussian_pyr = generate_gaussian_pyramid(self.im, self.num_octave, self.s, self.sigma)DoG_pyr = generate_DoG_pyramid(gaussian_pyr)kp_pyr = get_keypoints(DoG_pyr, self.R_th, self.t_c, self.w)feats = [] for i, DoG_octave in enumerate(DoG_pyr): kp_pyr[i] =assign_orientation(kp_pyr[i], DoG_octave)feats.append(get_local_descriptors(kp_pyr[i], DoG_octave)) self.kp_pyr = kp_pyrself.feats = feats return feats</pre><p>æœ€åä¸€ä¸ªå°ç»†èŠ‚æ˜¯æˆ‘ç”¨1.3çš„sigmaæ¨¡ç³Šåˆå§‹å›¾åƒã€‚</p><p>ç»“è®º</p><p>æ–‡ç« è®²çš„å¯èƒ½å¹¶ä¸æ˜¯é‚£ä¹ˆæ¸…æ¥šï¼Œä½†æˆ‘å¸Œæœ›ä½ èƒ½å­¦åˆ°ä¸€äº›å…³äºç†è®ºå’Œå¦‚ä½•å®ç°SIFTçš„çŸ¥è¯†ã€‚</p><p>åªæ˜¯ä¸ªäººå­¦ä¹ æ–‡ç« ã€‚</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Python','ä¸­å®ç°','SIFT'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>