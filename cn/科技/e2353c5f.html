<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>自适应双边滤波的Retinex图像增强算法 | 极客快訊</title><meta property="og:title" content="自适应双边滤波的Retinex图像增强算法 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/78aa0001c87767137868"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e2353c5f.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e2353c5f.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e2353c5f.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e2353c5f.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e2353c5f.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e2353c5f.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e2353c5f.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e2353c5f.html><meta property="article:published_time" content="2020-11-14T20:55:22+08:00"><meta property="article:modified_time" content="2020-11-14T20:55:22+08:00"><meta name=Keywords content><meta name=description content="自适应双边滤波的Retinex图像增强算法"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/e2353c5f.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>自适应双边滤波的Retinex图像增强算法</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><strong>摘 要：</strong>针对现有的Retinex算法不能自动调节参数，提出一种基于参数估计的双边滤波Retinex算法。该算法首先利用主成份分析和Canny边缘检测算法分别进行噪声估计和边缘强度估计；然后通过线性相关运算计算双边滤波的空间几何标准差参数和亮度标准差参数；再利用参数估计的双边滤波把图像分解出照度图像和反射图像；最后将照度图像和反射图像通过不同方法的压缩和增强并合成一幅新的图像。通过实验表明，它不仅能够自动设置参数，还能有效抑制光晕现象。</p><p>TP391.4</p><p>A</p><p>10.16157/j.issn.0258-7998.172770</p><p><strong>中文引用格式：</strong>李大军，杜神斌，郭丙轩，等. 自适应双边滤波的Retinex图像增强算法[J].电子技术应用，2018，44(3)：117-121.</p><p><strong>英文引用格式：</strong>Li Dajun，Du Shenbin，Guo Bingxuan，et al. Retinex algorithm for image enhancement based on adaptive bilateral filtering[J]. Application of Electronic Technique，2018，44(3)：117-121.</p><p><strong>0 引言</strong></p><p>图像增强是图像预处理环节中一项非常重要的工作，它是利用各种数学方法和特定的变换手段以增强图像的对比度、目视效果和清晰度。其中Retinex方法<sup>[1]</sup>是应用比较广泛的一种图像增强算法。而MSR(多尺度Retinex)和中心/环绕的Retinex算法是其最常用的两种方法。</p><p>近年来，研究者们针对Retinex算法提出了不同的改进方法。2001年，OGATA M<sup>[2]</sup>等人通过考虑到人眼视觉系统的特征，提出一种ε-滤波器为模板内的像素比较设定阈值，来更为精确地提取照度分量；2011年，JANG J H<sup>[3]</sup>等人提出一种基于MSR算法对遥感图像和航空图像进行对比度增强，通过利用MSR将Retinex分解成几乎不重叠的光谱子带，然后根据每个子带的特征，对对比度进行不同程度增强；2015年，王小鹏<sup>[4]</sup>等人提出了一种利用三高斯模型和高斯滤波相结合的Retinex算法，以提高图像的对比度，抑制图像光晕现象；2016年，秦绪佳<sup>[5]</sup>等人提出一种HSV色彩空间中Retinex结构光图像增强算法，通过将彩色图像从RGB空间转换到HSV颜色空间，再对V分量用传统的MSR算法进行增强，以改善图像的色彩饱和度；2016年，张雪峰<sup>[6]</sup>等人提出了一种通过MSR对图像的照度分量和反射分量进行分解的Retinex算法。</p><p>以上各种对Retinex算法的改进都是需要人工调节参数，对此，本文提出一种基于参数估计的双边滤波Retinex图像增强算法：从文献[7]出发，对图像的噪声方差进行估算，从而自动调节双边滤波的空间几何标准差参数；同时，从文献[8]出发，对图像进行边缘检测，得出边缘强度，从而自动调节双边滤波的亮度标准差参数；最后实现了双边滤波的参数的自动获取，避免了手工调节参数。本文算法不仅具有自适应参数，而且对边缘信息保留完整，不会出现“光晕移影”现象，计算量不是很大。</p><p><strong>1 基于自适应双边滤波的Retinex图像增强策略</strong></p><p><strong>1.1 Retinex算法原理</strong></p><p>1971年LAND E H等人提出了Retinex理论，它是一种模拟人类视觉系统调节图像颜色和亮度的图像增强算法。根据Retinex理论可以假设原始图像I是光照图像L和反射图像R的乘积，即得到：</p><p>用Retinex算法进行图像增强的目的主要是从原始图像I中估算出光照L，然后分解出反射图像R，从而消除光照不均匀造成的影响，改善图像的视觉效果。由于数域模型更加符合人眼视觉模型，所以在处理图像时，一般将图像转换到对数域，即i=logI，l=logL，r=logR，从而得到：</p><p>一般情况下，Retinex算法先对原始图像进行高斯平滑，从而估算出光照图像，然后再通过式(2)解算出反射图像，在获得光照图像和反射图像之后，对这两个图像进行不同的策略处理，最后合成新的一幅图像。</p><p><strong>1.2 照度估计</strong></p><p>照度估计为本文的核心算法，本文采用双边滤波器对图像进行照度估计。1998年TOMASI C等人<sup>[9]</sup>提出了双边滤波算法，它在处理邻域间像素灰度值或者RGB值时，不但处理空间几何的邻近关系，还处理了亮度上的相似性。因此它由两个函数构成：空间几何函数和亮度函数。然后对这两个函数的非线性组合得到平滑图像。表达式如下：</p><img alt=自适应双边滤波的Retinex图像增强算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/78aa0001c87767137868><p><strong>1.3 噪声方差估计算法</strong></p><p>本文认为所处理的自然噪声图像都是零均值高斯噪声图像<sup>[10]</sup>，并且图像与噪声不相关。将其看作欧式空间中的向量运算，假设空间中的单位向量为v，即得到v方向上的方差：</p><p>本文采用主成份分析(PCA)算法求出图像I的方差。主成份分析是利用降维的思想，将多个变量转换为少数几个主要的变量，其中每个主要的变量都是利用原始变量的线性组合，每个主要变量之间都是不相关的，所以大多数原始变量的信息都是可以由这些主要变量反映出，并且之间的信息都不重复。即：</p><img alt=自适应双边滤波的Retinex图像增强算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/7575000f078aaa39f467><p>可以得出协方差矩阵对角上的特征值具有一样的概率分布，所以只需要解算左上角的特征值即可。</p><p><strong>1.4 图像边缘检测</strong></p><p>在图像明暗度差异突出地区的边缘信息，本文采用Canny算法进行检测，该方法利用一阶微分算子对图像梯度的幅值和方位角进行估算，然后对幅值进行非极大值约束，最后利用双阈值法提取图像的边缘信息，即可以得到图像边缘像素的总和：</p><img alt=自适应双边滤波的Retinex图像增强算法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/78a90001c9cc70ce81ba><p><strong>2 本文算法</strong></p><p>由于传统Retinex算法利用高斯函数进行照度估计，只是考虑了像素之间的空间几何标准差参数σ<sub>s</sub>，并没有考虑图像边缘明暗度差异突出的地区，使得图像边缘明暗度差异突出的地区的像素相互影响，导致出现光晕现象。双边滤波弥补了高斯函数的缺点，它在高斯函数的基础上加了一个亮度标准差参数σ<sub>r</sub>。</p><p>从式(4)、式(5)可以看出，随着σ<sub>s</sub>增大，空间几何函数的作用就会变得很大，使得图像去噪效果变强，但σ<sub>s</sub>过大又会使得图像变得模糊；随着σ<sub>r</sub>增大，亮度函数变得平滑而稳定，它可以保持图像明暗度差异，突出地区的边缘信息，但σ<sub>r</sub>过大时双边滤波会转变成高斯低通滤波，从而失去边缘保持的功能。因此，选择合理有效的空间几何标准差参数σ<sub>s</sub>和亮度标准差参数σ<sub>r</sub>是达到最佳效果的关键。</p><p>本文将噪声方差σ<sub>n</sub>、可见边缘强度e分别和空间几何标准差参数σ<sub>s</sub>、亮度标准差参数σ<sub>r</sub>进行线性相关运算，通过最优计算来寻求图像效果最佳时的参数。流程图如图1。</p><img alt=自适应双边滤波的Retinex图像增强算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/7578000dad5d56f5bb90><p><strong>2.1 自适应空间几何标准差参数</strong></p><p>具体步骤：</p><p>(1)对导入的图像随机加入噪声，I=I+0.05·randn(size(I))；</p><p>(2)从图像像素左上角开始，设置搜索区域为5×5；</p><p>(3)把初始输入的图像看作弱纹理图像，计算出它的噪声方差初值σ<sub>n始</sub>；</p><p>(4)通过式(15)计算分布函数F(x)，将梯度函数协方差矩阵均值中左上角特征值小于或等于分布函数F(x)的区域看作成弱纹理区域，可以得到一个新的弱纹理区域集合ω。</p><img alt=自适应双边滤波的Retinex图像增强算法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/78aa0001c878a0cd24c9><p><strong>2.2 自适应亮度标准差参数</strong></p><p>图像边缘的强度直接影响着人眼视觉对图像质量的判断。具体步骤：</p><p>(1)采用Canny算子对图像进行边缘检测，得出边缘强度e；</p><p>(2)采用公式σ<sub>r</sub>=be约束亮度标准差参数，b反映了σ<sub>r</sub>与e之间的线性关系。</p><p><strong>2.3 参数估计双边滤波的Retinex图像增强</strong></p><p>具体步骤：</p><p>(1)对已经求出参数的双边滤波对图像进行照度估计，并利用Gamma校正对照度图像进行校正，可以得出照度图像l；</p><p>(2)然后利用式(2)求出反射图像r；</p><p>(3)再利用求出参数的双边滤波对反射图像进行平滑去噪，得到去噪后的反射图像r′；</p><p>(4)再利用校正后的照度图像l对反射图像r′进行改正，得到改正后的反射图像r″；</p><p>(5)最后利用对数操作符对反射图像r″进行反变换，就可以得出图像的真实颜色。</p><p>为了更合理的算出有效的参数，本文分别对100张图像加入不同的随机噪声，并对它进行双边滤波的Retinex图像增强，最后可以发现当a=9、b=14时，增强后的图像得到最佳的效果。</p><p><strong>3 实验结果与分析</strong></p><p>本文分别采用MSR算法<sup>[12]</sup>、NASA所提出的一种中心环绕Retinex算法<sup>[13]</sup>和本文算法进行对比，并分别从主观和客观两个方面对本文算法的性能进行评价和分析。</p><p><strong>3.1 主观视觉评价</strong></p><p>主观评价图像是一种简单、快捷、直观且有效的评价方法。本文实验主要针对低照度图像，为了更能说明本文算法的有效性，为此选取了4组图像进行图像增强，如图2~图5所示。</p><img alt=自适应双边滤波的Retinex图像增强算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/757900041c3d06a2e957><img alt=自适应双边滤波的Retinex图像增强算法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/7578000dad5ed9b60139><img alt=自适应双边滤波的Retinex图像增强算法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/78a90001c9cd7b51dcad><img alt=自适应双边滤波的Retinex图像增强算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/78a90001c9cefabf49bc><p>由于所选的图像都是因为天气和光照等条件所造成图像质量各异的现实场景的彩色图像。可以发现，经过MSR算法处理后，虽然图像整体颜色得到一定的改善，但图像过亮，其对比度没有很好地得到增强，另外图像的噪声被放大，整体饱和度下降。经过NASA处理后，虽然图像的颜色得到很好的改善，且图像的细节信息得到较好的保留，但NASA处理后的图像容易出现“光晕移影现象”，如图2(c)中小男孩头顶和背景木板处出现一个黑圈；图3(c)中木板出现不协调色块；图4(c)中房子一楼靠近树的一块呈黑色，看不到房子的信息；图5(c)中塔和天空的交界处出现灰色一块，与整片天空颜色不协调。经过本文算法处理后，图像颜色的改善都优于前两种算法，且没有出现NASA处理后的“光晕移影现象”，整幅图像看起来亮度适中，色彩饱和更符合人眼观察和细节信息保留完整。</p><p><strong>3.2 客观数据评价</strong></p><p>主观视觉评价虽然可以比较快速准确地评价图像增强的效果，但这种方法在一定程度上依靠观察者经验、专业素养和主观感受等因素，所以这肯定会影响评价结果的可靠性。因此，对图像增强的效果的评价还需要客观数据的支持。本文选取图像的峰值信噪比、标准差和熵作为客观评价标准。</p><p>(1)峰值信噪比(PSNR)</p><p>峰值信噪比反映了图像的失真大小，峰值信噪比越大，代表图像失真越小。其表达式为：</p><img alt=自适应双边滤波的Retinex图像增强算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/7576000f0f5a6a1d6d72><p>图像的客观标准比较结果如表1～表3，从中可以看出，经过本文算法处理过后的图像，其峰值信噪比、标准差和熵的值均优于其他两种算法，这直接地揭示出本文算法的优越性。</p><img alt=自适应双边滤波的Retinex图像增强算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/78a90001c9cf112fa2b6><img alt=自适应双边滤波的Retinex图像增强算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/7577000e88aebae50e31><img alt=自适应双边滤波的Retinex图像增强算法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/78a90001c9d0c828cfc3><p><strong>4 结论</strong></p><p>针对以前的Retinex算法不能自动调节参数，本文提出一种自适应双边滤波的Retinex图像增强算法，通过估算出图像的噪声方差和边缘强度，然后与空间几何标准差参数和亮度标准差参数做线性相关运算，寻求最优参数。最后通过实验表明，该算法可以有效地保留边缘细节信息，抑制了光晕现象，同时增强了图像的对比度，且算法计算量也不是很大。</p><p><strong>参考文献</strong></p><p>[1] LAND E H.The retinex theory of color vision[J].Scientific American，1977，237(6)：108.</p><p>[2] OGATA M，TSUCHIYA T，KUBOZONO T，et al.Dynamic range compression based on illumination compensation[J].IEEE Transactions on Consumer Electronics，2001，47(3)：548-558.</p><p>[3] JANG J H，KIM S D，RA J B.Enhancement of optical remote sensing images by subband-decomposed multiscale retinex with hybrid intensity transfer function[J].IEEE Geoscience & Remote Sensing Letters，2011，8(5)：983-987.</p><p>[4] 王小鹏，陈璐，魏冲冲，等.一种改进的Retinex彩色图像增强方法[J].兰州交通大学学报，2015，34(1)：55-59.</p><p>[5] 秦绪佳，程燕飞，范颖琳，等.基于三边滤波的HSV色彩空间Retinex图像增强算法[J].小型微型计算机系统，2016，37(1)：168-172.</p><p>[6] 张雪峰，赵莉.基于改进Retinex的图像增强算法[J].南京理工大学学报(自然科学版)，2016，40(1)：24-28.</p><p>[7] LIU X，TANAKA M，OKUTOMI M.Noise level estimation using weak textured patches of a single noisy image[C].IEEE International Conference on Image Processing.IEEE，2012：665-668.</p><p>[8] HAUTI?魬RE N，TAREL J P，AUBERT D，et al.Blind contrast enhancement assessment by gradient ratioing at visible edges[J].Image Analysis&Stereology，2008，27(2)：87-95.</p><p>[9] TOMASI C，MANDUCHI R.Bilateral filtering for gray and color images[C].International Conference on Computer Vision.IEEE，1998：839.</p><p>[10] LI B，LIU Q，XU J，et al.A new method for removing mixed noises[J].Science China Information Sciences，2011，54(1)：51-59.</p><p>[11] 邵宇，孙富春，刘莹.基于局部结构张量的无参考型图像质量评价方法[J].电子与信息学报，2012，34(8)：1779-1785.</p><p>[12] YAO K，TIAN D.Shadow removal from images using an improved single-scale Retinex color restoration algorithm[C].International Joint Conference on Computational Sciences and Optimization.IEEE，2009：934-938.</p><p>[13] RAHMAN Z U，JOBSON D J，WOODELL G A.Retinex processing for automatic image enhancement[J].Journal of Electronic Imaging，2002，13(1)：100-110.</p><p><strong>作者信息:</strong></p><p>李大军1，杜神斌1，郭丙轩2，聂欣然1，杨力伟3</p><p>（1.东华理工大学 测绘工程学院，江西 南昌330013；2.武汉大学 测绘遥感信息工程国家重点实验室，湖北 武汉430079；</p><p>3.安徽省地勘局第一水文工程地质勘查院，安徽 蚌埠233000）</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'自适','双边','滤波'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>