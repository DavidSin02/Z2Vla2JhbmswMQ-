<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>PHPè¿›é˜¶æ•™ç¨‹-ä¸€æ–‡ç†è§£å’Œå®ç°ç°ä»£PHPæ¡†æ¶é‡Œçš„IOCå®¹å™¨ | æå®¢å¿«è¨Š</title><meta property="og:title" content="PHPè¿›é˜¶æ•™ç¨‹-ä¸€æ–‡ç†è§£å’Œå®ç°ç°ä»£PHPæ¡†æ¶é‡Œçš„IOCå®¹å™¨ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/423ce7eefc5d433f86a14589b1ba0043"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e3b6719c.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e3b6719c.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e3b6719c.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e3b6719c.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e3b6719c.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e3b6719c.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e3b6719c.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e3b6719c.html><meta property="article:published_time" content="2020-11-14T21:07:27+08:00"><meta property="article:modified_time" content="2020-11-14T21:07:27+08:00"><meta name=Keywords content><meta name=description content="PHPè¿›é˜¶æ•™ç¨‹-ä¸€æ–‡ç†è§£å’Œå®ç°ç°ä»£PHPæ¡†æ¶é‡Œçš„IOCå®¹å™¨"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/e3b6719c.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>PHPè¿›é˜¶æ•™ç¨‹-ä¸€æ–‡ç†è§£å’Œå®ç°ç°ä»£PHPæ¡†æ¶é‡Œçš„IOCå®¹å™¨</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><h3 class=pgc-h-arrow-right><strong>â€‹å®¹å™¨æ˜¯ä»€ä¹ˆï¼Ÿ</strong></h3><p>ç›¸ä¿¡å¾ˆå¤šäººå¬è¯´è¿‡ä¾èµ–æ³¨å…¥ï¼Œä¾èµ–æ³¨å…¥å®ç°çš„åŸºç¡€æ¡ä»¶ç¦»ä¸å¼€å®¹å™¨ï¼Œå®¹å™¨å°±æ˜¯ç”¨æ¥ç®¡ç†ç±»ä¾èµ–å’Œæ³¨å…¥çš„ï¼Œè´Ÿè´£æœåŠ¡çš„ç®¡ç†å’Œè§£è€¦ç»„ä»¶ï¼Œæœ€ç®€å•çš„ç†è§£æˆ‘ä»¬å¯ä»¥æŠŠå®¹å™¨ç†è§£æˆä¸€ä¸ªè¶…çº§å¤§ã€ä¸“é—¨å­˜å¯¹è±¡çš„æ•°ç»„ã€‚</p><div class=pgc-img><img alt=PHPè¿›é˜¶æ•™ç¨‹-ä¸€æ–‡ç†è§£å’Œå®ç°ç°ä»£PHPæ¡†æ¶é‡Œçš„IOCå®¹å™¨ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/423ce7eefc5d433f86a14589b1ba0043><p class=pgc-img-caption></p></div><p>å›¾1</p><p>å¦‚å›¾æ‰€ç¤ºè°ƒç”¨è€…é€šè¿‡å®¹å™¨çš„æ ‡ç¤ºè·å–åˆ°å¯¹è±¡å®ä¾‹ï¼Œå›¾é‡Œå¯ä»¥çœ‹å‡ºæ¥ï¼Œå¯ä»¥é€šè¿‡ ::class çš„æ–¹å¼æ¥è·å–ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡å¯¹è±¡æ ‡ç¤ºè·å–å®ä¾‹å¯¹è±¡ã€‚</p><p><br></p><p><strong>IOCæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><p>å¤§å®¶å¯èƒ½éƒ½å¬è¯´è¿‡IOCå®¹å™¨ï¼ŒIOCçš„å…¨ç§°æ˜¯ï¼š(Inversion Of Controlï¼Œåè½¬æ§åˆ¶)ã€‚</p><p>æˆ‘ä»¬æ¥ç†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯åè½¬æ§åˆ¶ï¼Œåœ¨æˆ‘ä»¬ä¼ ç»Ÿç¼–ç ä¸­æˆ‘ä»¬åœ¨ç±»ä¸ç±»ä¹‹é—´çš„ä¾èµ–é€šå¸¸æ˜¯æˆ‘ä»¬é€šè¿‡ç¼–ç çš„æ–¹å¼newå‡ºæ¥å¯¹è±¡å†ä¼ é€’çš„ï¼Œè€Œä½¿ç”¨æ§åˆ¶åè½¬æˆ‘ä»¬å¯ä»¥æŠŠå¯¹è±¡çš„æ§åˆ¶æƒäº¤ç»™å®¹å™¨æˆ–è€…æ¡†æ¶å»å®ç°ã€‚ç›®çš„æ˜¯ä¸ºäº†è®©æˆ‘ä»¬ä¸éœ€è¦ç¡¬ç¼–ç å»åˆ›å»ºå¯¹è±¡ï¼Œçœ‹å›¾1å¯ä»¥çŸ¥é“ï¼Œå®¹å™¨é‡Œé¢å­˜æ”¾ç€å¾ˆå¤šå¯¹è±¡ï¼Œå½“æˆ‘ä»¬è¦ä½¿ç”¨çš„æ—¶å€™å¯ä»¥ç›´æ¥å»ç”¨ã€‚è€Œå®¹å™¨é‡Œé¢çš„å¯¹è±¡ä¸éœ€è¦æˆ‘ä»¬åœ¨ä»£ç ä¸­ç¼–ç åˆ›å»ºã€‚åœ¨éœ€è¦æŸä¸ªç±»å¯¹è±¡çš„æ—¶å€™ä¼šå»å®¹å™¨é‡Œé¢è·å–å¯¹è±¡ï¼Œå¦‚æœå¯¹è±¡ä¸å­˜åœ¨åˆ™ä¼šè‡ªåŠ¨åˆ›å»ºã€‚è¿™å°±æ˜¯çœç•¥äº†æˆ‘ä»¬åœ¨ä»£ç é‡Œé¢å»åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹ï¼Œç”±å®¹å™¨å»å¸®æˆ‘ä»¬å®ç°è¿™ä¸ªåˆ›å»ºçš„è¿‡ç¨‹ï¼Œè¿™å°±å«åè½¬æ§åˆ¶ã€‚ä¸€å¥è¯æ€»ç»“IOCï¼šæŠŠåˆ›å»ºå¯¹è±¡çš„æ§åˆ¶æƒè½¬ç§»ç»™å®¹å™¨å®ç°ç±»çš„å®ä¾‹åŒ–ã€‚</p><p>ä¾‹å¦‚ï¼šæ²¡æœ‰ä½¿ç”¨IOCçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æƒ³è¦åˆ›å»ºç±»</p><pre><code>&lt;?phpclass Sunny{}$sunny = new Sunny();</code></pre><p>æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å»newä¸€ä¸ªç±»ï¼Œè¿™ç§æƒ…å†µå°±æ˜¯ç¡¬ç¼–ç åœ¨ä»£ç é‡Œé¢å»å®ç°çš„ã€‚</p><p>è€Œä½¿ç”¨IOCå®¹å™¨çš„ä»£ç åˆ™å¯ä»¥è¿™æ ·å†™ã€‚</p><pre><code>&lt;?phpclass Sunny{}$sunny = Container::getBean(Sunny::class);</code></pre><p>åœ¨å®¹å™¨çš„å†…éƒ¨å»å¸®æˆ‘ä»¬å®ç°è¿™ä¸ªç±»ï¼Œæœ‰åŒå­¦çœ‹åˆ°è¿™é‡Œå¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œæˆ‘ä½¿ç”¨ new Sunny ä¸æ˜¯ä»£ç å†™å¾—æ›´çŸ­æ›´ç®€å•å—ï¼Ÿæˆ‘ä»¬çœ‹å®Œä¾èµ–æ³¨å…¥å†çœ‹ä¸€ä¸ªä¾‹å­ã€‚</p><p><strong>ä¾èµ–æ³¨å…¥</strong></p><p>ç°åœ¨çŸ¥é“äº†IOCæ˜¯ä»€ä¹ˆï¼Œé‚£ä¹ˆä¸€ä¸ªæ–°çš„é—®é¢˜å‡ºæ¥äº†ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºç±»çš„æ—¶å€™æœ‰äº›ç±»çš„æ„é€ æ–¹æ³•ä¼šéœ€è¦æˆ‘ä»¬ä¼ é€’å‚æ•°æ€ä¹ˆåŠï¼Ÿé€šè¿‡IOCçš„å­¦ä¹ æˆ‘ä»¬çŸ¥é“äº†IOCå®¹å™¨ä¼šå¸®æˆ‘ä»¬è§£å†³è¿™ä¸ªå¯¹è±¡å®ä¾‹åˆ›å»ºçš„é—®é¢˜ï¼Œé‚£ä¹ˆåœ¨å®¹å™¨é‡Œé¢åˆ›å»ºå¯¹è±¡çš„æ—¶å€™å‘ç°ç±»æœ‰å…¶ä»–ä¾èµ–åˆ™ä¼šè¿›è¡Œä¾èµ–æŸ¥æ‰¾ï¼Œå®¹å™¨å¯»æ‰¾éœ€è¦å¯¹è±¡çš„è¿‡ç¨‹ï¼Œç§°ä¸ºDL(Dependency Lookup, ä¾èµ–æŸ¥æ‰¾)ã€‚è€ŒæŠŠéœ€è¦çš„ä¾èµ–æ³¨å…¥åˆ°ä»£ç ç‰‡æ®µä¸­è¿™ä¸ªç§°ä¸ºDI(Dependency Injection,ä¾èµ–æ³¨å…¥)ã€‚</p><p>ä¾‹å¦‚IOCé‡Œé¢è¯´åˆ°çš„ new Sunny è¿™ä¸ªä¾‹å­ã€‚å¦‚æœåœ¨ç±»ä¸ç±»ä¹‹é—´æœ‰å¤šé‡ä¾èµ–ã€‚</p><pre><code>&lt;?phpclass Computer{    public function run(){        echo "ç¼–ç¨‹ä¸­....\n";    }}class Sunny{    private $computer;    public function __construct(Computer $computer){        $this-&gt;computer = $computer;    }    public function program(){        $this-&gt;computer-&gt;run();    }}$sunny = new Sunny(new Computer());$sunny-&gt;program();</code></pre><p>è¿™é‡Œå¯ä»¥çœ‹åˆ° Sunny è¿™ä¸ªç±»æƒ³è¦ç¼–ç¨‹ä¾èµ–ç±» Computer è¿™ä¸ªç±»ï¼Œè€Œå¦‚æœä½¿ç”¨IOCå®¹å™¨å®ç°ä¾èµ–æ³¨å…¥çš„è¯ï¼Œä»£ç å°±ç®€å•äº†ã€‚</p><pre><code>&lt;?phpclass Computer{    public function run(){        echo "ç¼–ç¨‹ä¸­....\n";    }}class Sunny{    private $computer;    public function __construct(Computer $computer){        $this-&gt;computer = $computer;    }    public function program(){        $this-&gt;computer-&gt;run();    }}$sunny = Container::getBean(Sunny::class);$sunny-&gt;program();</code></pre><h3 class=pgc-h-arrow-right>ä¸€å¥è¯æ€»ç»“ï¼šè§£å†³åˆ›å»ºç±»å®ä¾‹å½“ä¸­å¯¹å…¶ä»–ç±»çš„ä¾èµ–ï¼ŒåŠ¨æ€çš„å‘æŸä¸ªå¯¹è±¡æä¾›å®ƒæ‰€éœ€è¦çš„å…¶ä»–å¯¹è±¡ã€‚</h3><h3 class=pgc-h-arrow-right><strong>ä¾èµ–å€’ç½®</strong></h3><p>ä¾èµ–å€’ç½®è§£å†³çš„é—®é¢˜æ˜¯æ¾è€¦å„ä¸ªæ¨¡å—ä¹‹é—´çš„é‡åº¦ä¾èµ–ï¼Œä¸Šå±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–åº•å±‚æ¨¡å—ï¼Œå®ƒä»¬éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚é€šå¸¸ç®€å•çš„ç†è§£ä¾èµ–å€’ç½®å°±æ˜¯é¢å‘æ¥å£æˆ–è€…é¢å‘æŠ½è±¡æ¥è¿›è¡Œç¼–ç¨‹ã€‚æˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä¾‹å­æ¥çœ‹çœ‹é¢å‘æ¥å£ç¼–ç¨‹ã€‚</p><pre><code>class Cache{    public function set($key,$value){        $redis = new CFile();        $redis-&gt;set($key,$value);    }}class CFile{    public function set($key,$value){        echo "file:{$key}-&gt;{$value}\n";    }}$cache = new Cache();$cache-&gt;set("name","sunny");</code></pre><p>ä¸Šé¢çš„è¿™æ®µä»£ç çœ‹ä¼¼æ²¡æœ‰ä»€ä¹ˆå¤§é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœæœ‰ä¸€å¤©æŠŠæ–‡ä»¶ç¼“å­˜æ”¹æˆRedisç¼“å­˜å‘¢ï¼Ÿ</p><pre><code>class Cache{    public function set($key,$value){        $redis = new CRedis();        $redis-&gt;set($key,$value);    }}class CRedis{    public function set($key,$value){        echo "redis:{$key}-&gt;{$value}\n";    }}$cache = new Cache();$cache-&gt;set("name","sunny");</code></pre><p>é€šè¿‡è¿™æ®µä»£ç å¯ä»¥çœ‹å‡ºæ¥å½“ä¸€ä¸ªç¼“å­˜ä½¿ç”¨çš„é©±åŠ¨æ”¹å˜äº†çš„æ—¶å€™ï¼ŒCacheçš„ä»£ç ä¹Ÿå¿…é¡»ä½œå‡ºç›¸åº”çš„æ”¹å˜ï¼Œå› ä¸ºä»£ç å†™æ­»åœ¨è°ƒç”¨è€…èº«ä¸Šäº†ï¼Œè€¦åˆåº¦å˜å¾—é«˜äº†ã€‚å†å¯¹ä»£ç è¿›è¡Œæ”¹é€ ä¸€æ ·ï¼Œè®©ç¨‹åºå‘˜é¢å‘interfaceç¼–ç¨‹ï¼Œè®©ä»£ç å˜å¾—æ›´é€šç”¨ï¼Œæ›´è§„èŒƒã€‚</p><pre><code>interface ICache{    public function set($key,$value);}class CRedis implements ICache {    public function set($key,$value){        echo "redis:{$key}-&gt;{$value}\n";    }}class CFile implements ICache{    public function set($key,$value){        echo "file:{$key}-&gt;{$value}\n";    }}class Cache{    private $drive;    public function __construct(ICache $drive){        $this-&gt;drive = $drive;    }    public function set($key,$value){        $this-&gt;drive-&gt;set($key,$value);    }}$cache = new Cache(new CFile());$cache-&gt;set("name","sunny");</code></pre><p>å¾ˆå¤šäººçœ‹åˆ°è¿™æ®µä»£ç çš„æ—¶å€™æƒ³ç€ï¼Œé‚£æˆ‘åœ¨æ„é€ æ–¹æ³•ç›´æ¥æŠŠè¦çš„å¯¹è±¡ä¼ è¿›å»ä¸å°±å¥½äº†å—ï¼Ÿä¸ºä»€ä¹ˆè¿˜è¦å®šä¹‰ä¸€ä¸ªinterfaceå‘¢ï¼Ÿå…¶å®å®šä¹‰interfaceæ˜¯ä¸ºäº†è§„èŒƒä»£ç ï¼Œä¸ç®¡ä½ ä½¿ç”¨å“ªä¸ªé©±åŠ¨ï¼Œåªè¦å®ç°äº†æˆ‘è¿™ä¸ªinterfaceçš„éƒ½å¯ä»¥ç”¨ï¼Œæ²¡æœ‰interfaceå¼€å‘è€…åœ¨å¼€å‘é©±åŠ¨çš„æ—¶å€™å°±ä¼šä¸çŸ¥é“è¿™ä¸ªé©±åŠ¨é‡Œé¢è¯¥æœ‰ä»€ä¹ˆæ–¹æ³•ã€‚å½“æˆ‘ä»¬ä½¿ç”¨interfaceä¹‹åå¤§å®¶åªè¦é¢å‘æ¥å£ç¼–ç¨‹ï¼ŒCacheå®Œå…¨ä¸ç®¡ç±»æ˜¯æ€ä¹ˆå®ç°çš„ï¼ŒCacheåªæ˜¯æ ¹æ®interfaceçš„æ–¹æ³•è¿›è¡Œæ“ä½œã€‚</p><p>ä¸€å¥è¯æ€»ç»“ï¼šä¾èµ–å€’ç½®å®ç°æ¾è€¦åˆ</p><p><br></p><h1 class=pgc-h-arrow-right><strong>å®æˆ˜ï¼šæ ¹æ®å®¹å™¨åŸç†å®ç°å®¹å™¨</strong></h1><pre><code>&lt;?phpclass Container{    // å½“å‰å®¹å™¨å¯¹è±¡    private static $instance;    // å­˜æ”¾åœ¨å®¹å™¨é‡Œé¢åˆ°å®ä¾‹    protected $instances = [];    private function __construct(){    }    public static function getInstance(){        if (!self::$instance) {            self::$instance = new static();        }        return self::$instance;    }    /**     * è·å–å¯¹è±¡å®ä¾‹     * @param $key     * @return mixed     */    public function get($key){        if (isset($this-&gt;instances[$key])) {            return $this-&gt;instances[$key];        }    }    /**     * ç»‘å®šå¯¹è±¡ã€é—­åŒ…ã€ç±»åˆ°å®¹å™¨     * @param $key     * @param null $concrete     * @return Container     */    public function bind($key, $concrete = null){        if ($concrete instanceof Closure) {            $this-&gt;instances[$key] = $concrete;        } elseif (is_object($concrete)) {            $this-&gt;instances[$key] = $concrete;        }        return $this;    }}class Sunny{    public function getName(){        echo time() . "\n";    }}$app = Container::getInstance();$sunny = $app-&gt;bind(Sunny::class,new Sunny());$sunny = $app-&gt;get(Sunny::class);$sunny-&gt;getName();</code></pre><p><br></p><h1 class=pgc-h-arrow-right><strong>å®æˆ˜ï¼šå®ç°ä¾èµ–æ³¨å…¥</strong></h1><h3 class=pgc-h-arrow-right>Container.php</h3><pre><code>&lt;?phpclass Container{    // å½“å‰å®¹å™¨å¯¹è±¡    private static $instance;    // å­˜æ”¾åœ¨å®¹å™¨é‡Œé¢åˆ°å®ä¾‹    protected $instances = [];    private function __construct(){    }    public static function getInstance(){        if (!self::$instance) {            self::$instance = new static();        }        return self::$instance;    }    /**     * è·å–å¯¹è±¡å®ä¾‹     * @param $key     * @return mixed     * @throws ReflectionException     */    public function get($key){        if (isset($this-&gt;instances[$key])) {            return $this-&gt;instances[$key];        }        return $this-&gt;make($key);    }    /**     * ç»‘å®šå¯¹è±¡ã€é—­åŒ…ã€ç±»åˆ°å®¹å™¨     * @param $key     * @param null $concrete     * @return Container     * @throws ReflectionException     */    public function bind($key, $concrete = null){        if ($concrete instanceof Closure) {            $this-&gt;instances[$key] = $concrete;        } elseif (is_object($concrete)) {            $this-&gt;instances[$key] = $concrete;        } else {            $this-&gt;make($key, $concrete);        }        return $this;    }    /**     * åˆ›å»ºç±»ç»‘å®šåˆ°ç±»å®ä¾‹     * @param $abstract     * @param null $atgs     * @return mixed     * @throws ReflectionException     */    public function make($abstract, $atgs = null){        if (isset($this-&gt;instances[$abstract])) {            return $this-&gt;instances[$abstract];        }        $object = $this-&gt;invokeClass($abstract);        $this-&gt;instances[$abstract] = $object;        return $object;    }    /**     * åå°„è§£æç±»     * @param $abstract     * @return object     * @throws ReflectionException     */    public function invokeClass($abstract){        $reflectionClass = new \ReflectionClass($abstract);        // è·å–æ„é€ æ–¹æ³•        $construct = $reflectionClass-&gt;getConstructor();        // è·å–å‚æ•°å¾—åˆ°å®ä¾‹        $params = $construct ? $this-&gt;parserParams($construct) : [];        $object = $reflectionClass-&gt;newInstanceArgs($params);        return $object;    }    /**     * è§£ææ„é€ æ–¹æ³•å‚æ•°     * @param $reflect     * @return array     * @throws ReflectionException     */    public function parserParams(ReflectionMethod $reflect){        $args = [];        $params = $reflect-&gt;getParameters();        if (!$params) {            return $args;        }        if (count($params) &gt; 0) {            foreach ($params as $param) {                $class = $param-&gt;getClass();                if ($class) {                    $args[] = $this-&gt;make($class-&gt;getName());                    continue;                }                // è·å–å˜é‡çš„åç§°                $name = $param-&gt;getName();                // é»˜è®¤å€¼                $def = null;                // å¦‚æœæœ‰é»˜è®¤å€¼ï¼Œä»é»˜è®¤å€¼è·å–ç±»å‹                if ($param-&gt;isOptional()) {                    $def = $param-&gt;getDefaultValue();                }                $args[] = $_REQUEST[$name] ?? $def;            }        }        return $args;    }}</code></pre><h3 class=pgc-h-arrow-right>Test.php</h3><pre><code>&lt;?phpclass Test{    public $name;    private $test1;    public function __construct(Test1 $test1){        $this-&gt;test1 = $test1;        $this-&gt;name = $this-&gt;test1-&gt;getName();    }}</code></pre><h3 class=pgc-h-arrow-right>Test1.php</h3><pre><code>&lt;?phpclass Test1{    public function getName(){        return "test1è¿”å›çš„åå­—";    }}</code></pre><h3 class=pgc-h-arrow-right>Sunny.php</h3><pre><code>&lt;?phprequire_once "./Container.php";require_once "./Test.php";require_once "./Test1.php";class Sunny{    private $test;    public function __construct(Test $test){        $this-&gt;test = $test;    }    public function getName(){        echo "è·å–testé‡Œé¢çš„nameï¼š{$this-&gt;test-&gt;name}\n";    }}$app = Container::getInstance();$sunny = $app-&gt;get(Sunny::class);$sunny-&gt;getName();</code></pre><p>å¦‚æœå–œæ¬¢æˆ‘ä»¬çš„æ–‡ç« è¯·å…³æ³¨ + è½¬å‘ è®©æ›´å¤šäººçœ‹åˆ°ï¼Œæˆ‘ä»¬ä¹Ÿä¼šæŒç»­æä¾›æ›´å¤šåŸåˆ›çš„å¥½æ–‡ç« ã€‚</p><div class=pgc-img><img alt=PHPè¿›é˜¶æ•™ç¨‹-ä¸€æ–‡ç†è§£å’Œå®ç°ç°ä»£PHPæ¡†æ¶é‡Œçš„IOCå®¹å™¨ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/379e095c9bd843c3b958f1b161a81130><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'PHP','è¿›é˜¶','å®ç°'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../cn/%E7%A7%91%E6%8A%80/fe9184d7.html alt=PHPè¿›é˜¶æ•™ç¨‹-å®ç°ä¸€ä¸ªç®€å•çš„MySQLè¿æ¥æ±  class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/aa2df096a4274ba1b5c8540bcb5b5c73 style=border-radius:25px></a>
<a href=../../cn/%E7%A7%91%E6%8A%80/fe9184d7.html title=PHPè¿›é˜¶æ•™ç¨‹-å®ç°ä¸€ä¸ªç®€å•çš„MySQLè¿æ¥æ± >PHPè¿›é˜¶æ•™ç¨‹-å®ç°ä¸€ä¸ªç®€å•çš„MySQLè¿æ¥æ± </a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>