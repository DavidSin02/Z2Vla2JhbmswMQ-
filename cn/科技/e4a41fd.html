<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码 | 极客快訊</title><meta property="og:title" content="Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/dfic-imagehandler/2f75687e-3404-4611-82f7-00afcb68a95c"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e4a41fd.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e4a41fd.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e4a41fd.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e4a41fd.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e4a41fd.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e4a41fd.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e4a41fd.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e4a41fd.html><meta property="article:published_time" content="2020-10-29T20:52:15+08:00"><meta property="article:modified_time" content="2020-10-29T20:52:15+08:00"><meta name=Keywords content><meta name=description content="Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/e4a41fd.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><blockquote class=pgc-blockquote-abstract><p>二次注入攻击属于SQL注入的一种高级手法，学习web渗透，此法必学！</p></blockquote><h1 class=pgc-h-arrow-right>什么是二次注入？</h1><p>恶意数据插入到数据库时被处理的数据又被还原并存储在数据库中，当Web程序调用存储在数据库中的恶意数据并执行SQL查询时，就发生了SQL二次注入。</p><div class=pgc-img><img alt=Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/dfic-imagehandler/2f75687e-3404-4611-82f7-00afcb68a95c><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>本课二次注入思路</h1><ul><li>使用注册页面注册新用户：往数据库存储恶意用户名；</li></ul><ul><li>再次访问数据库数据，并利用第一次的恶意用户数据实现SQL注入；</li></ul><p><strong>这就是二次注入（不是注入两次），下面为你将演示在不知道对方密码的情况下实现sql注入恶意更改用户的密码！</strong></p><div class=pgc-img><img alt=Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/dfic-imagehandler/e59addf7-b070-4eaf-b32f-d71c14ef180f><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>二次注入实战</h1><p>首先我们得有一个用于Web渗透的SQL测试页面地址，这里我们以SQLlib进行测试，关注<a class=tteditor-mention data-concern-id data-id data-name=小白嘿客 data-uid=52005185484>@小白嘿客</a>，前往下方<a class=pgc-link data-content=mp href="https://learning.snssdk.com/feoffline/toutiao_wallet_bundles/toutiao_learning_wap/online/album_detail.html?content_id=6802506876576596238" rel="noopener noreferrer" target=_blank>《从新手到Web白帽黑客》</a>视频课程获取完整学习！</p><div class=tt-column-card data-content='{"new_thumb_url": "http://sf6-ttcdn-tos.pstatp.com/img/pgc-image/14a99217a29349bfba57a67fc353d250", "title": "\u4ece\u65b0\u624b\u5230Web\u767d\u5e3d\u9ed1\u5ba2", "url": "", "price": 109, "column_id": "6802506876576596238", "content": "", "author_description": "\u5c0f\u767d\u563f\u5ba2", "share_price": 26.16, "thumb_url": "http://p9.pstatp.com/large/pgc-image/14a99217a29349bfba57a67fc353d250", "sold": 29}'><p class=column-placeholder></p></div><p>注册用户的地址是：</p><pre><code>192.168.31.16/sql/Less-24/index.php</code></pre><p>这里我们需要自己再创建一个用户密码修改php文件，用于直接访问数据库并修改用户密码的2.php；加入上方<a class=pgc-link data-content=mp href="https://learning.snssdk.com/feoffline/toutiao_wallet_bundles/toutiao_learning_wap/online/album_detail.html?content_id=6802506876576596238" rel="noopener noreferrer" target=_blank>web专栏</a>即可前往专栏资料库下载对应的2.php文件，然后放到win7靶机的下面路径位置！</p><div class=pgc-img><img alt=Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/29711e910a3643d6bc08b5c7f5330cfa><p class=pgc-img-caption></p></div><p>代码如下：</p><div class=pgc-img><img alt=Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ed32923ca38543f692aa534b01c13ee4><p class=pgc-img-caption></p></div><p>大概的意思就是：接收用户的三个参数输入（要改密码的用户名，新密码，原始密码），这是一个只能修改已知用户名和已知密码的php文件。但是下面我们可以利用第一次注册的恶意用户名来躲避这个php文件没有过滤单引号导的机制来实现sql二次注入！</p><p>火狐访问：</p><pre><code>192.168.31.16/sql/Less-24/index.php</code></pre><p>然后点击右下角注册新用户！</p><div class=pgc-img><img alt=Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ab125eea974148dbbb9a74de03b59537><p class=pgc-img-caption></p></div><p>这里我们注册一个正常的用户，假设这个用户是别人的，我们不知道密码！</p><pre><code>用户名：yang密码：111111</code></pre><p>再次使用注册页面，注册一个新的用户：</p><pre><code>用户名：yang' -- -密码：222222</code></pre><p>有空格，<strong class=highlight-text>--</strong>代表注释后面，但是为了看得清楚，又使用一个空格和<strong class=highlight-text>-</strong>，但是这个空格和-本身包括后面所有的语句都会被前面的<strong class=highlight-text>--</strong>给注释掉！</p><div class=pgc-img><img alt=Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ee4c7531d37647619f8aa39311805d29><p class=pgc-img-caption></p></div><p>此时前往win7靶机的phpmyadmin查看下：</p><p>已经注册在数据库里了！</p><div class=pgc-img><img alt=Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/09b4bab84f5d42ca8a38281eeb98cdb4><p class=pgc-img-caption></p></div><p>既然注册，我们来访问2.php，修改yang' -- -这个恶意用户的密码，然后你就会发现我们要修改yang' -- -这个用户名的密码，没想到却将yang用户名的密码给修改了！</p><p><strong>这样我们就能在不知道yang的密码下，就能登录yang用户了，从而造成数据泄露！</strong></p><p>访问2.php需要指定用户名，新密码，旧密码！</p><p>火狐浏览：</p><pre><code>192.168.31.16/sql/Less-24/2.php?username=yang' -- -&amp;newpass=999999&amp;cpass=222222</code></pre><p>意思是：将已知用户名<strong class=highlight-text>yang' -- -</strong>的原始密码222222改成新密码999999！真的会如愿以偿吗？</p><p>肯定不会的，先看下图：</p><div class=pgc-img><img alt=Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/3eea1f071c314ed1b891102add1d0610><p class=pgc-img-caption></p></div><p>你会发现：被执行sql更新密码的语句时，先要找到用户名<strong class=highlight-text>'yang'-- -'</strong>，但是由于用户名是恶意的<strong class=highlight-text>yang'-- -</strong>，sql语句本身的前后单引号会形成前面<strong class=highlight-text>'yang'</strong>的闭合！后面的都被<strong class=highlight-text>-- -</strong>注释掉了！这样明摆着就是修改yang这个不是我们自己的用户密码了，现在你得到的用户名是yang，密码是999999，登陆肯定也是yang的所有资料！但自己创建的<strong class=highlight-text>yang'-- -</strong>密码依然没有被修改，真是隔山打牛啊！</p><p>我们执行看看，显示成功！</p><div class=pgc-img><img alt=Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/434ecbd6db074cf9ab692ec50f02ddd6><p class=pgc-img-caption></p></div><p>不信？我们去数据库看看有没有修改成功！</p><p>发现yang的密码无形被我们修改成功999999了。</p><div class=pgc-img><img alt=Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dda9989f3ef946a8aab8e10066e2dc31><p class=pgc-img-caption></p></div><p>那我们来登录下yang的用户，登录成功！当然自己的yang'-- -还是能用原来的密码登陆的。</p><div class=pgc-img><img alt=Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5e7a1f4936974fa692682dd244d32993><p class=pgc-img-caption></p></div><p><strong>总结：二次注入重点是，第一次需要往数据库存入数据，这一步不是注入！但是存入的数据是恶意的。第二次我们来提取数据，比如我们修改这个恶意用户名，导致将他人的用户名密码修改了，这就是二次注入的一种实现方式！</strong></p><h1 class=pgc-h-arrow-right>小白嘿客我想说</h1><p>关注<a class=tteditor-mention data-concern-id data-id data-name=小白嘿客 data-uid=52005185484>@小白嘿客</a>，加入专栏<a class=pgc-link data-content=mp href="https://learning.snssdk.com/feoffline/toutiao_wallet_bundles/toutiao_learning_wap/online/album_detail.html?content_id=6802388743123632398" rel="noopener noreferrer" target=_blank>《白帽黑客kali初学指南》</a>，你也能从入门到渗透实战！</p><div class=tt-column-card data-content='{"new_thumb_url": "http://sf6-ttcdn-tos.pstatp.com/img/pgc-image/e95745b381914bdc96149f07adf2ec60", "title": "\u767d\u5e3d\u9ed1\u5ba2Kali\u521d\u5b66\u6307\u5357", "url": "", "price": 139, "column_id": "6802388743123632398", "content": "", "author_description": "\u5c0f\u767d\u563f\u5ba2", "share_price": 33.36, "thumb_url": "http://p4.pstatp.com/large/pgc-image/e95745b381914bdc96149f07adf2ec60", "sold": 81}'><p class=column-placeholder></p></div><p>想和更多白帽黑客爱好者一起学习交流，可以进入<a class=pgc-link data-content=mp href="https://ic.snssdk.com/market/v1/tpl/landing/community/community.html?community_id=6828174437896946183&tt_from=copy_link&utm_source=copy_link&utm_medium=toutiao_android&utm_campaign=client_share" rel="noopener noreferrer" target=_blank>《网络安全训练营》</a>圈子，获得更多kali黑客渗透干货！</p><div class=tt-community-card data-content='{"media_name": "\u5c0f\u767d\u563f\u5ba2", "member_count": 45, "title": "\u7f51\u7edc\u5b89\u5168\u8bad\u7ec3\u8425", "price": 99, "period": 3, "community_id": "6828174437896946183", "square_cover": "pgc-image/27914233eb8146459fdb6ff14ac5fdac", "share_price": 0, "media_id": 1634041560245252, "renew_price": 19.9}'><div class=community-placeholder>（此处已添加圈子卡片，请到今日头条客户端查看）</div></div><div class=pgc-img><img alt=Web渗透实战进阶：利用SQL二次注入渗透服务器，修改用户密码 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/9e69c2da-e0d7-4a7b-b9b8-1e55d132881e><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'渗透','Web','实战'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>