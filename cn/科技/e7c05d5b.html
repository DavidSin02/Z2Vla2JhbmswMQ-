<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>ä½¿ç”¨ Amazon SageMaker è¿è¡ŒåŸºäº TensorFlow çš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ« | æå®¢å¿«è¨Š</title><meta property="og:title" content="ä½¿ç”¨ Amazon SageMaker è¿è¡ŒåŸºäº TensorFlow çš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ« - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/f6b15f58c21a453f8a2f53b7d1b78bb8"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e7c05d5b.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e7c05d5b.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e7c05d5b.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e7c05d5b.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e7c05d5b.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e7c05d5b.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e7c05d5b.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e7c05d5b.html><meta property="article:published_time" content="2020-11-14T20:59:54+08:00"><meta property="article:modified_time" content="2020-11-14T20:59:54+08:00"><meta name=Keywords content><meta name=description content="ä½¿ç”¨ Amazon SageMaker è¿è¡ŒåŸºäº TensorFlow çš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/e7c05d5b.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>ä½¿ç”¨ Amazon SageMaker è¿è¡ŒåŸºäº TensorFlow çš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p>ä¸€ã€èƒŒæ™¯</p><p>åˆ©ç”¨ä¸šå†…æ•°æ®æ„å»ºçŸ¥è¯†å›¾è°±æ˜¯å¾ˆå¤šå®¢æˆ·æ­£åœ¨é¢ä¸´çš„é—®é¢˜ï¼Œå…¶ä¸­ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«ï¼ˆNamed Entity Recognitionï¼Œç®€ç§°NERï¼‰æ˜¯æ„å»ºçŸ¥è¯†å›¾è°±çš„ä¸€ä¸ªé‡è¦ç¯èŠ‚ã€‚æˆ‘ä»¬åœ¨ä¸å®¢æˆ·çš„äº¤æµä¸­å‘ç°ï¼Œç°æœ‰çš„NERå·¥å…·ï¼ˆæ¯”å¦‚Jiaguï¼‰å¯¹äºç‰¹å®šé¢†åŸŸçš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«æ•ˆæœéš¾ä»¥æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ï¼Œè€Œä¸”è¿™äº›å·¥å…·å¾ˆéš¾ä½¿ç”¨è‡ªå®šä¹‰æ•°æ®é›†è®­ç»ƒã€‚å› æ­¤å®¢æˆ·è¿«åˆ‡æƒ³ä½¿ç”¨ä¸šå†…æœ€å…ˆè¿›çš„ç®—æ³•åœ¨è¡Œä¸šå†…æ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒï¼Œä»¥æ”¹è¿›ç°æœ‰NERå·¥å…·çš„ä¸è¶³ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨Amazon SageMakerè¿è¡ŒåŸºäºTensorFlowçš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«ã€‚</p><p>å‘½åå®ä½“è¯†åˆ«ï¼Œæ˜¯æŒ‡è¯†åˆ«æ–‡æœ¬ä¸­å…·æœ‰ç‰¹å®šæ„ä¹‰çš„å®ä½“ï¼Œä¸»è¦åŒ…æ‹¬äººåã€åœ°åã€æœºæ„åã€ä¸“æœ‰åè¯ç­‰ã€‚å‘½åå®ä½“è¯†åˆ«æ˜¯ä¿¡æ¯æå–ã€é—®ç­”ç³»ç»Ÿã€å¥æ³•åˆ†æã€æœºå™¨ç¿»è¯‘ã€çŸ¥è¯†å›¾è°±ç­‰åº”ç”¨é¢†åŸŸçš„é‡è¦åŸºç¡€å·¥å…·ã€‚</p><p>è‹±è¯­ä¸­çš„å‘½åå®ä½“å…·æœ‰æ¯”è¾ƒæ˜æ˜¾çš„å½¢å¼æ ‡å¿—ï¼ˆå³å®ä½“ä¸­çš„æ¯ä¸ªè¯çš„ç¬¬ä¸€ä¸ªå­—æ¯è¦å¤§å†™ï¼‰ï¼Œæ‰€ä»¥å®ä½“è¾¹ç•Œè¯†åˆ«ç›¸å¯¹å®¹æ˜“ï¼Œä»»åŠ¡çš„é‡ç‚¹æ˜¯ç¡®å®šå®ä½“çš„ç±»åˆ«ã€‚å’Œè‹±è¯­ç›¸æ¯”ï¼Œä¸­æ–‡å‘½åå®ä½“è¯†åˆ«ä»»åŠ¡æ›´åŠ å¤æ‚ï¼Œè€Œä¸”ç›¸å¯¹äºå®ä½“ç±»åˆ«æ ‡æ³¨å­ä»»åŠ¡ï¼Œå®ä½“è¾¹ç•Œçš„è¯†åˆ«æ›´åŠ å›°éš¾ã€‚</p><p>äºŒã€ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«ç®—æ³•</p><p>NERä¸€ç›´æ˜¯è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰é¢†åŸŸä¸­çš„ç ”ç©¶çƒ­ç‚¹ï¼Œä»æ—©æœŸåŸºäºè¯å…¸å’Œè§„åˆ™çš„æ–¹æ³•ï¼Œåˆ°ä¼ ç»Ÿæœºå™¨å­¦ä¹ çš„æ–¹æ³•ï¼Œåˆ°è¿‘å¹´æ¥åŸºäºæ·±åº¦å­¦ä¹ çš„æ–¹æ³•ï¼ŒNERç ”ç©¶è¿›å±•çš„å¤§æ¦‚è¶‹åŠ¿å¤§è‡´å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><div class=pgc-img><img alt="ä½¿ç”¨ Amazon SageMaker è¿è¡ŒåŸºäº TensorFlow çš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f6b15f58c21a453f8a2f53b7d1b78bb8><p class=pgc-img-caption></p></div><p></p><p>æ—©æœŸçš„å‘½åå®ä½“è¯†åˆ«æ–¹æ³•åŸºæœ¬éƒ½æ˜¯åŸºäºè§„åˆ™çš„ã€‚ä¹‹åç”±äºåŸºäºå¤§è§„æ¨¡çš„è¯­æ–™åº“çš„ç»Ÿè®¡æ–¹æ³•åœ¨è‡ªç„¶è¯­è¨€å¤„ç†å„ä¸ªæ–¹é¢å–å¾—ä¸é”™çš„æ•ˆæœä¹‹åï¼Œä¸€å¤§æ‰¹æœºå™¨å­¦ä¹ çš„æ–¹æ³•ä¹Ÿå‡ºç°åœ¨å‘½åå®ä½“ç±»è¯†åˆ«ä»»åŠ¡ã€‚</p><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç”±äºæ·±åº¦å­¦ä¹ åœ¨è‡ªç„¶è¯­è¨€çš„å¹¿æ³›åº”ç”¨ï¼ŒåŸºäºæ·±åº¦å­¦ä¹ çš„å‘½åå®ä½“è¯†åˆ«æ–¹æ³•ä¹Ÿå±•ç°å‡ºä¸é”™çš„æ•ˆæœï¼Œæ­¤ç±»æ–¹æ³•åŸºæœ¬è¿˜æ˜¯æŠŠå‘½åå®ä½“è¯†åˆ«å½“åšåºåˆ—æ ‡æ³¨ä»»åŠ¡æ¥åšï¼Œæ¯”è¾ƒç»å…¸çš„æ–¹æ³•æ˜¯LSTM+CRFã€BiLSTM+CRFã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œé¢„è®­ç»ƒæ¨¡å‹å¯ä»¥å¤§å¹…æå‡è®¡ç®—æœºè§†è§‰çš„æ·±åº¦å­¦ä¹ ç®—æ³•è¡¨ç°ï¼Œè€Œåœ¨NLPé¢†åŸŸä¹Ÿæ˜¯åŒç†ï¼Œé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹å¯ä»¥æœ‰æ•ˆæå‡æ–‡æœ¬åˆ†ç±»ã€æœºå™¨ç¿»è¯‘ã€å‘½åå®ä½“è¯†åˆ«ç­‰ä»»åŠ¡çš„æ•ˆæœã€‚é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ç»å†äº†ä»è¯åµŒå…¥ï¼ˆWord Embeddingï¼‰ï¼Œåˆ°BERTï¼Œå†åˆ°ALBERTçš„æ¼”è¿›ã€‚</p><p>BERTçš„å…¨ç§°æ˜¯Bidirectional Encoder Representation from Transformersï¼Œå³åŒå‘Transformerçš„ç¼–ç å™¨ï¼ˆEncoderï¼‰ï¼Œå› ä¸ºè§£ç å™¨ï¼ˆDecoderï¼‰æ˜¯ä¸èƒ½è·å¾—è¦é¢„æµ‹çš„ä¿¡æ¯çš„ã€‚æ¨¡å‹çš„ä¸»è¦åˆ›æ–°ç‚¹éƒ½åœ¨é¢„è®­ç»ƒæ–¹æ³•ä¸Šï¼Œå³ç”¨äº†Masked LMå’ŒNext Sentence Predictionä¸¤ç§æ–¹æ³•åˆ†åˆ«æ•æ‰è¯è¯­å’Œå¥å­çº§åˆ«çš„è¡¨ç¤ºã€‚</p><p>ALBERTï¼ˆè§å‚è€ƒèµ„æ–™4ï¼‰åŸºäºBERTï¼Œä½†æœ‰ä¸€äº›æ”¹è¿›ï¼Œå®ƒå¯ä»¥åœ¨ä¸»è¦åŸºå‡†æµ‹è¯•ä¸Šè·å¾—æœ€å…ˆè¿›çš„æ€§èƒ½ï¼Œè€Œå‚æ•°å´å‡å°‘äº†30ï¼…ã€‚æ¯”å¦‚ï¼Œå¯¹äºalbert_base_zhï¼Œå®ƒåªæœ‰åŸå§‹BERTæ¨¡å‹çš„10%çš„å‚æ•°ï¼Œä½†æ˜¯ä¿ç•™äº†ä¸»è¦ç²¾åº¦ã€‚</p><p>æœ¬æ–‡å°†ä½¿ç”¨é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ALBERTåšä¸­æ–‡å‘½åå®ä½“è¯†åˆ«ï¼Œè¯¥é¡¹ç›®åŸºäºå¼€æºçš„ä»£ç ä¿®æ”¹è€Œæ¥ï¼ˆæœ¬æ–‡ä»£ç è§å‚è€ƒèµ„æ–™1ï¼ŒåŸå§‹ä»£ç è§å‚è€ƒèµ„æ–™2ï¼‰ï¼Œä½¿ç”¨TensorFlowæ¡†æ¶å¼€å‘ï¼Œåœ¨ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•åœ¨Amazon SageMakerä¸­è¿›è¡Œè¯¥æ¨¡å‹çš„è®­ç»ƒã€‚</p><p>ä¸‰ã€åœ¨Amazon SageMakerä¸­è¿è¡ŒTensorFlow</p><p>æœ¬èŠ‚å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨Amazon SageMakerçš„è‡ªå®šä¹‰å®¹å™¨ ï¼ˆBring Your Own Containerï¼Œç®€ç§°BYOCï¼‰å’Œè‡ªå®šä¹‰è„šæœ¬ï¼ˆBring Your Own Scriptï¼Œç®€ç§°BYOSï¼‰ä¸¤ç§æ–¹å¼æ¥è¿è¡ŒTensorFlowç¨‹åºçš„è®­ç»ƒä»»åŠ¡ã€‚é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸‹å¦‚ä½•åœ¨Amazon SageMaker Notebookä¸Šè¿è¡Œè¿™ä¸ªé¡¹ç›®ï¼Œç„¶åå†æŠŠå®ƒè¿è¡Œåœ¨Amazon SageMakerä¸Šã€‚</p><h3 class=pgc-h-arrow-right>1. åœ¨Amazon SageMaker Notebookä¸Šè¿è¡ŒTensorFlowå¼€æºä»£ç </h3><p>æˆ‘ä»¬é¦–å…ˆè¦åˆ›å»ºAmazon SageMaker Notebookï¼Œç„¶åä¸‹è½½ä»£ç å’Œæ•°æ®ï¼Œæœ€åè¿è¡Œä»£ç ã€‚å¦‚æœä¸€åˆ‡è¿è¡Œæ­£å¸¸ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥å·¥ä½œâ€”â€”å°†è¯¥TensorFlowä»£ç è¿è¡Œåˆ°Amazon SageMakerä¸­äº†ã€‚</p><p>1.1 åˆ›å»ºAmazon SageMaker Notebook</p><p>æˆ‘ä»¬é¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªAmazon SageMaker Notebookï¼Œç¬”è®°æœ¬å®ä¾‹ç±»å‹æœ€å¥½é€‰æ‹©ml.p2.xlargeï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨GPUè¿›è¡Œè®­ç»ƒçš„æµ‹è¯•äº†ï¼Œå·å¤§å°å»ºè®®æ”¹æˆ10GBæˆ–ä»¥ä¸Šï¼Œå› ä¸ºè¿è¡Œè¯¥é¡¹ç›®éœ€è¦ä¸‹è½½ä¸€äº›é¢å¤–çš„æ•°æ®ã€‚</p><div class=pgc-img><img alt="ä½¿ç”¨ Amazon SageMaker è¿è¡ŒåŸºäº TensorFlow çš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/21b2153c0cc04b02997a9a350cdc20d0><p class=pgc-img-caption></p></div><p>1.2 ä¸‹è½½ä»£ç å’Œæ•°æ®</p><p>ç¬”è®°æœ¬å¯åŠ¨åï¼Œæ‰“å¼€é¡µé¢ä¸Šçš„ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¸‹è½½ä»£ç ï¼š</p><pre><code>cd ~/SageMakergit clone https://github.com/whn09/albert-chinese-ner.git</code></pre><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¸‹è½½å’Œè§£å‹æ•°æ®ï¼ˆæ•°æ®æ¥æºè§å‚è€ƒèµ„æ–™3ï¼‰ï¼š</p><pre><code>cd ~/SageMaker/albert-chinese-nerwget https://storage.googleapis.com/albert_zh/albert_base_zh_additional_36k_steps.zipunzip albert_base_zh_additional_36k_steps.zip -d albert_base_zh</code></pre><p>1.3 è¿è¡Œä»£ç </p><p>æˆ‘ä»¬éœ€è¦è¿›å…¥ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒtensorflow_p36ï¼Œè¯¥ç¯å¢ƒé¢„åˆ¶äº†è¿è¡ŒTensorFlowæ‰€éœ€è¦çš„å¸¸ç”¨ç»„ä»¶ï¼Œè¿è¡Œrun_train.shè¿›è¡Œè®­ç»ƒï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><pre><code>cd ~/SageMaker/albert-chinese-nersource activate tensorflow_p36./run_train.sh</code></pre><p>å¦‚æœå‡ºç°ä¸‹é¢çš„è¾“å‡ºï¼Œè¯´æ˜è¿è¡Œç»“æœæ­£å¸¸ï¼Œåœ¨å®ä¾‹ç±»å‹ä¸ºml.p2.xlargeçš„ç¬”è®°æœ¬ä¸­ï¼Œè®­ç»ƒé€Ÿåº¦å¯ä»¥è¾¾åˆ°23ä¸ªæ ·æœ¬/ç§’ï¼Œå¦‚æœæ˜¯å…¶ä»–ç±»å‹å®ä¾‹ï¼Œé€Ÿåº¦å¯èƒ½æœ‰å·®å¼‚ã€‚</p><div class=pgc-img><img alt="ä½¿ç”¨ Amazon SageMaker è¿è¡ŒåŸºäº TensorFlow çš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/807f6b05e157440db68805544df985d5><p class=pgc-img-caption></p></div><p></p><p>2. è‡ªå®šä¹‰å®¹å™¨ï¼ˆBYOCï¼‰</p><p>è‡ªå®šä¹‰å®¹å™¨éœ€è¦ç»å†å‡†å¤‡Dockerfileï¼Œåˆ›å»ºè®­ç»ƒçš„å¯åŠ¨è„šæœ¬ï¼Œåˆ›å»ºé•œåƒå¹¶ä¸Šä¼ åˆ°Amazon ECRï¼Œæœ¬åœ°æµ‹è¯•å’ŒAmazon SageMakeræµ‹è¯•ç­‰æ­¥éª¤ã€‚å®Œæ•´æ‰§è¡Œè¿‡ç¨‹è§tensorflow_bring_your_own.ipynbã€‚</p><p>2.1 å‡†å¤‡Dockerfile</p><p>æˆ‘ä»¬é¦–å…ˆéœ€è¦å‡†å¤‡Dockerfileï¼Œåœ¨å…¶ä¸­å®‰è£…TensorFlowç¨‹åºè¿è¡Œå¿…é¡»çš„ç¯å¢ƒï¼Œæ‹·è´æ‰€æœ‰ä»£ç åˆ°é•œåƒä¸­ã€‚</p><pre><code>FROM tensorflow/tensorflow:1.15.2-gpu-py3ENV PATH="/opt/ml/code:${PATH}"COPY ./ /opt/ml/codeWORKDIR /opt/ml/code</code></pre><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦äº†è§£Amazon SageMakerå¯¹äºå®¹å™¨å†…ç›®å½•ç»“æ„çš„è¦æ±‚ï¼Œå…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè®­ç»ƒæ‰€éœ€ä»£ç æ”¾åˆ°/opt/ml/codeç›®å½•ä¸‹ï¼Œè®­ç»ƒæ‰€éœ€æ•°æ®æ”¾åˆ°/opt/ml/input/dataç›®å½•ä¸‹ï¼Œè®­ç»ƒè¾“å‡ºçš„æ¨¡å‹æ”¾åˆ°/opt/ml/modelç›®å½•ä¸‹ï¼Œè®­ç»ƒç»“æœæ–‡ä»¶æˆ–è€…æ—¥å¿—æ–‡ä»¶æ”¾åˆ°/opt/ml/outputç›®å½•ä¸‹ï¼Œè®­ç»ƒè¶…å‚æ•°æ–‡ä»¶æ˜¯ç”±Amazon SageMakerè‡ªåŠ¨ç”Ÿæˆçš„ï¼Œåœ¨/opt/ml/input/configç›®å½•ä¸‹ã€‚</p><div class=pgc-img><img alt="ä½¿ç”¨ Amazon SageMaker è¿è¡ŒåŸºäº TensorFlow çš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/029edcc1141247d9a3bf74cadd8473ad><p class=pgc-img-caption></p></div><p></p><p>2.2 åˆ›å»ºè®­ç»ƒçš„å¯åŠ¨è„šæœ¬</p><p>Amazon SageMakeråœ¨è®­ç»ƒæ—¶é»˜è®¤çš„å¯åŠ¨è„šæœ¬æ˜¯trainï¼Œæ‚¨å¯ä»¥å°†è‡ªå·±ä»£ç ä¸­çš„å¯åŠ¨è„šæœ¬å‘½åä¸ºtrainï¼Œä½†æˆ‘ä»¬æ›´å»ºè®®æ‚¨ä½¿ç”¨æˆ‘ä»¬æä¾›çš„å¯åŠ¨è„šæœ¬trainï¼Œè¯¥è„šæœ¬æ˜¯åŸºäºPythonçš„ï¼Œå¯ä»¥å¸®åŠ©æ‚¨è§£æä¼ å…¥çš„è¶…å‚æ•°ï¼Œå¹¶è°ƒç”¨æ‚¨ä»£ç ä¸­çš„å®é™…å¯åŠ¨è„šæœ¬ã€‚</p><p>2.3 åˆ›å»ºé•œåƒå¹¶ä¸Šä¼ åˆ°Amazon ECR</p><p>åœ¨å‡†å¤‡å¥½Dockerfileå’Œå¯åŠ¨è„šæœ¬åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨build_and_push.shè¿™ä¸ªè„šæœ¬åˆ›å»ºé•œåƒå¹¶ä¸Šä¼ åˆ°Amazon ECRã€‚æ³¨æ„è¿™ä¸ªè¿‡ç¨‹å¯èƒ½éœ€è¦è¿›è¡Œå¾ˆå¤šæ¬¡ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¯é¿å…åœ°è¦ä¿®æ”¹Dockerfileæˆ–è€…TensorFlowç¨‹åºä»¥ä½¿å¾—å®ƒä»¬å¯ä»¥æ­£å¸¸å·¥ä½œã€‚å¦‚æœå°šæœªè°ƒè¯•å®Œæˆï¼Œæˆ‘ä»¬å¯ä»¥æš‚æ—¶ä¸æ‰§è¡Œè¯¥è„šæœ¬çš„æœ€åä¸€å¥docker push ${fullname}ï¼Œä»¥é¿å…é¢‘ç¹ä¸Šä¼ é•œåƒåˆ°Amazon ECRã€‚</p><p>2.4 æœ¬åœ°æµ‹è¯•</p><p>åœ¨åˆ›å»ºé•œåƒå®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Amazon SageMakerçš„æœ¬åœ°æ¨¡å¼è¿›è¡Œæœ¬åœ°æµ‹è¯•ï¼šç¬¬ä¸€æ­¥ï¼Œæ‰§è¡Œutils/setup.shæ¥åˆå§‹åŒ–æœ¬åœ°æ¨¡å¼ã€‚ç¬¬äºŒæ­¥ï¼ŒæŒ‡å®šæ‰§è¡Œçš„è§’è‰²ï¼Œè¿™é‡Œæˆ‘ä»¬å‡è®¾æ‚¨æ˜¯åœ¨Amazon SageMaker Notebookä¸Šæ‰§è¡Œçš„ï¼Œå¦‚æœæ˜¯å…¶ä»–ç¯å¢ƒï¼Œæ‚¨å¯èƒ½éœ€è¦æ‰‹åŠ¨æŒ‡å®šè§’è‰²çš„ARNã€‚ç¬¬ä¸‰æ­¥ï¼Œè®¾å®šè¶…å‚æ•°ï¼Œè¿™é‡Œéœ€è¦å¯¹åº”åˆ°æ‚¨ç¨‹åºä¸­æ‰€éœ€çš„è¶…å‚æ•°ã€‚ç¬¬å››æ­¥ï¼Œè®¾å®šè®­ç»ƒæœºå‹ä¸ºlocalæˆ–è€…local_gpuï¼ˆæ”¯æŒGPUï¼‰ã€‚ç¬¬äº”æ­¥ï¼Œåˆ›å»ºEstimatorï¼Œè¿™é‡Œéœ€è¦ä¼ å…¥ä¹‹å‰è·å¾—çš„è§’è‰²ã€è®­ç»ƒæœºå‹ã€æœºå™¨æ•°é‡ã€é•œåƒåç§°ã€è¶…å‚æ•°ç­‰ã€‚ç¬¬å…­æ­¥ï¼Œå¯åŠ¨è®­ç»ƒï¼Œè¿™é‡Œéœ€è¦ä¼ å…¥è®­ç»ƒæ•°æ®çš„ä½ç½®ï¼Œåœ¨æœ¬åœ°æ¨¡å¼ä¸‹ï¼Œè®­ç»ƒæ•°æ®çš„ä½ç½®å¯ä»¥è®¾ç½®æˆæœ¬åœ°è·¯å¾„ã€‚</p><pre><code>role = get_execution_role()hyperparameters = {'task_name': 'ner', 'do_train': 'true', 'do_eval': 'true',  'data_dir': '/opt/ml/input/data/training', 'output_dir': '/opt/ml/model',                    'vocab_file': './albert_config/vocab.txt', 'bert_config_file': './albert_base_zh/albert_config_base.json', _seq_length': 128, 'train_batch_size': 64, 'learning_rate': 2e-5, 'num_train_epochs': 1}instance_type = 'local'if subprocess.call('nvidia-smi') == 0:    instance_type = 'local_gpu'    estimator = Estimator(role=role,                      train_instance_count=1,                      train_instance_type=instance_type,                      image_name='sagemaker-tf-albert-chinese-ner:latest',                      hyperparameters=hyperparameters)estimator.fit('file:///home/ec2-user/SageMaker/albert-chinese-ner/data/')</code></pre><p>è®­ç»ƒå¯åŠ¨åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è®­ç»ƒçš„æ—¥å¿—è¾“å‡ºï¼Œä»¥åŠç›‘æ§æœ¬æœºçš„GPUã€CPUã€å†…å­˜ç­‰çš„ä½¿ç”¨ç‡ç­‰æƒ…å†µï¼Œä»¥ç¡®è®¤ç¨‹åºå¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p><p>å¦‚æœåœ¨æ­¤è¿‡ç¨‹ä¸­éœ€è¦è¿›å…¥æ­£åœ¨è¿è¡Œçš„å®¹å™¨å†…è°ƒè¯•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨docker pså‘½ä»¤è·å–å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨IDï¼Œå¹¶ä½¿ç”¨docker exec -it &lt;CONTAINER ID> /bin/bashè¿›å…¥å®¹å™¨å†…è¿›è¡Œè°ƒè¯•ã€‚</p><p>2.5 Amazon SageMakeræµ‹è¯•</p><p>åœ¨æœ¬åœ°æµ‹è¯•å’Œä¸Šä¼ é•œåƒåˆ°Amazon ECRå®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Amazon SageMakerè¿›è¡Œæµ‹è¯•ï¼šç¬¬ä¸€æ­¥ï¼Œä¸Šä¼ æ•°æ®åˆ°Amazon S3ï¼Œè·å–é•œåƒåœ¨Amazon ECRçš„åœ°å€ã€‚ç¬¬äºŒæ­¥ï¼ŒæŒ‡å®šæ‰§è¡Œçš„è§’è‰²ï¼Œè¿™é‡Œæˆ‘ä»¬å‡è®¾æ‚¨æ˜¯åœ¨Amazon SageMaker Notebookä¸Šæ‰§è¡Œçš„ï¼Œå¦‚æœæ˜¯å…¶ä»–ç¯å¢ƒï¼Œæ‚¨å¯èƒ½éœ€è¦æ‰‹åŠ¨æŒ‡å®šè§’è‰²çš„ARNã€‚ç¬¬ä¸‰æ­¥ï¼Œè®¾å®šè¶…å‚æ•°ï¼Œè¿™é‡Œéœ€è¦å¯¹åº”åˆ°æ‚¨ç¨‹åºä¸­æ‰€éœ€çš„è¶…å‚æ•°ã€‚ç¬¬å››æ­¥ï¼Œè®¾å®šè®­ç»ƒæœºå‹ä¸ºml.p2.xlargeï¼ˆæ”¯æŒGPUï¼‰ã€‚ç¬¬äº”æ­¥ï¼Œåˆ›å»ºEstimatorï¼Œè¿™é‡Œéœ€è¦ä¼ å…¥ä¹‹å‰è·å¾—çš„è§’è‰²ã€è®­ç»ƒæœºå‹ã€æœºå™¨æ•°é‡ã€é•œåƒåœ°å€ã€è¶…å‚æ•°ç­‰ã€‚ç¬¬å…­æ­¥ï¼Œå¯åŠ¨è®­ç»ƒï¼Œè¿™é‡Œéœ€è¦ä¼ å…¥è®­ç»ƒæ•°æ®çš„ä½ç½®ï¼Œåœ¨Amazon SageMakeræ¨¡å¼ä¸‹ï¼Œè®­ç»ƒæ•°æ®çš„ä½ç½®éœ€è¦è®¾ç½®æˆAmazon S3è·¯å¾„ã€‚</p><pre><code>prefix = 'DEMO-tensorflow-albert-chinese-ner'sess = sage.Session()WORK_DIRECTORY = '/home/ec2-user/SageMaker/albert-chinese-ner/data'data_location = sess.upload_data(WORK_DIRECTORY, key_prefix=prefix)client = boto3.client('sts')account = client.get_caller_identity()['Account']my_session = boto3.session.Session()region = my_session.region_namealgorithm_name = 'sagemaker-tf-albert-chinese-ner'ecr_image = '{}.dkr.ecr.{}.amazonaws.com/{}:latest'.format(account, region, algorithm_name)hyperparameters = {'task_name': 'ner', 'do_train': 'true', 'do_eval': 'true', 'data_dir': '/opt/ml/input/data/training', 'output_dir': '/opt/ml/model', 'vocab_file': './albert_config/vocab.txt', 'bert_config_file': './albert_base_zh/albert_config_base.json', 'max_seq_length': 128, 'train_batch_size': 64, 'learning_rate': 2e-5, 'num_train_epochs': 3}instance_type = 'ml.p2.xlarge'estimator = Estimator(role=role,                      train_instance_count=1,                      train_instance_type=instance_type,                      image_name=ecr_image,                      hyperparameters=hyperparameters)estimator.fit(data_location)</code></pre><p></p><p>è®­ç»ƒå¯åŠ¨åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Amazon SageMakeræ§åˆ¶å°çœ‹åˆ°è¿™ä¸ªè®­ç»ƒä»»åŠ¡ï¼Œç‚¹è¿›è¯¦æƒ…å¯ä»¥çœ‹åˆ°è®­ç»ƒçš„è¯¦æƒ…ï¼Œæ—¥å¿—è¾“å‡ºï¼Œä»¥åŠç›‘æ§æœºå™¨çš„GPUã€CPUã€å†…å­˜ç­‰çš„ä½¿ç”¨ç‡ç­‰æƒ…å†µï¼Œä»¥ç¡®è®¤ç¨‹åºå¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p><div class=pgc-img><img alt="ä½¿ç”¨ Amazon SageMaker è¿è¡ŒåŸºäº TensorFlow çš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/952dd49836cb4bfcb082216aed9703cd><p class=pgc-img-caption></p></div><div class=pgc-img><img alt="ä½¿ç”¨ Amazon SageMaker è¿è¡ŒåŸºäº TensorFlow çš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/29c8f49e297a40e0bf7e08047d837203><p class=pgc-img-caption></p></div><div class=pgc-img><img alt="ä½¿ç”¨ Amazon SageMaker è¿è¡ŒåŸºäº TensorFlow çš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c96b466644834aeb8c6d32bd478c28a4><p class=pgc-img-caption></p></div><div class=pgc-img><img alt="ä½¿ç”¨ Amazon SageMaker è¿è¡ŒåŸºäº TensorFlow çš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/c3feee2ce548429ba668d48dc107a6ac><p class=pgc-img-caption></p></div><p></p><p>åœ¨æ­¤è¿‡ç¨‹ä¸­æˆ‘ä»¬æ— æ³•è¿›å…¥æ­£åœ¨è¿è¡Œçš„å®¹å™¨å†…è°ƒè¯•ï¼Œæ‚¨å¯ä»¥å°†å°½é‡å¤šçš„æ—¥å¿—æ‰“å°å‡ºæ¥ï¼Œæˆ–è€…è¾“å‡ºåˆ°/opt/ml/outputè·¯å¾„ä¸‹ï¼Œè¯¥è·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åœ¨è®­ç»ƒå®Œæˆåä¼šè¢«è‡ªåŠ¨æ‰“åŒ…æˆoutput.tar.gzæ”¾åˆ°è®¾å®šå¥½çš„ä½äºAmazon S3çš„è¾“å‡ºè·¯å¾„ä¸‹ã€‚</p><p>2.6 è®­ç»ƒç»“æœ</p><p>æœ¬æ–‡æ‰€ç¤ºç¨‹åºä½¿ç”¨äº†MSRAå…¬å¼€çš„ä¸­æ–‡å®ä½“è¯†åˆ«æ•°æ®é›†è¿›è¡Œè®­ç»ƒï¼Œåœ¨è®­ç»ƒ3è½®ä¹‹åï¼Œæœ€ä¼˜çš„F1å€¼å°±å¯ä»¥è¾¾åˆ°0.948345ï¼Œå±äºæ¯”è¾ƒé¢†å…ˆçš„ç»“æœã€‚</p><pre><code>***** Eval results albert_base_ner_checkpoints/model.ckpt-0 *****eval_f = 0.01672106eval_precision = 0.010008455eval_recall = 0.10698523global_step = 0loss = 2367.2935***** Eval results albert_base_ner_checkpoints/model.ckpt-1000 *****eval_f = 0.9256434eval_precision = 0.95667034eval_recall = 0.8976247global_step = 1000loss = 17.80814***** Eval results albert_base_ner_checkpoints/model.ckpt-2000 *****eval_f = 0.9444123eval_precision = 0.94401eval_recall = 0.9452899global_step = 2000loss = 10.842231***** Eval results albert_base_ner_checkpoints/model.ckpt-2374 *****eval_f = 0.948345eval_precision = 0.9542561eval_recall = 0.94261235global_step = 2374loss = 10.520088</code></pre><h3 class=pgc-h-arrow-right>3. è‡ªå®šä¹‰è„šæœ¬ï¼ˆBYOSï¼‰</h3><p>ä½¿ç”¨BYOSçš„æ–¹æ³•å’ŒBYOCçš„ä¸åŒä¹‹å¤„åœ¨äºï¼šBYOCæ˜¯ä½¿ç”¨ç”¨æˆ·è‡ªå·±åˆ›å»ºçš„é•œåƒæ¥è¿è¡Œç¨‹åºï¼Œæ›´é€‚ç”¨äºç”¨æˆ·å¯¹é•œåƒè‡ªå®šä¹‰ç¨‹åº¦è¾ƒé«˜çš„ä½¿ç”¨æƒ…æ™¯ï¼›è€ŒBYOSæ˜¯ä½¿ç”¨é¢„å…ˆæ„å»ºå¥½çš„é•œåƒï¼Œåªæ˜¯ä¼ å…¥ç”¨æˆ·è‡ªå·±çš„ä»£ç æ¥è¿è¡Œç¨‹åºï¼Œä¸éœ€è¦ç”¨æˆ·è‡ªå·±è°ƒè¯•é•œåƒï¼Œæ›´é€‚ç”¨äºæ¯”è¾ƒç®€å•çš„ä½¿ç”¨æƒ…æ™¯ã€‚</p><p>ç”±äºä¸éœ€è¦ç¼–è¯‘è‡ªå®šä¹‰é•œåƒï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿›è¡Œæœ¬åœ°æµ‹è¯•å’ŒAmazon SageMakeræµ‹è¯•ï¼Œå®Œæ•´æµç¨‹è§tensorflow_script_mode_quickstart.ipynbã€‚</p><p>3.1 æœ¬åœ°æµ‹è¯•</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Amazon SageMakerçš„æœ¬åœ°æ¨¡å¼è¿›è¡Œæœ¬åœ°æµ‹è¯•ï¼šç¬¬ä¸€æ­¥ï¼Œæ‰§è¡Œutils/setup.shæ¥åˆå§‹åŒ–æœ¬åœ°æ¨¡å¼ã€‚ç¬¬äºŒæ­¥ï¼ŒæŒ‡å®šæ‰§è¡Œçš„è§’è‰²ï¼Œè¿™é‡Œæˆ‘ä»¬å‡è®¾æ‚¨æ˜¯åœ¨Amazon SageMaker Notebookä¸Šæ‰§è¡Œçš„ï¼Œå¦‚æœæ˜¯å…¶ä»–ç¯å¢ƒï¼Œæ‚¨å¯èƒ½éœ€è¦æ‰‹åŠ¨æŒ‡å®šè§’è‰²çš„ARNã€‚ç¬¬ä¸‰æ­¥ï¼Œè®¾å®šè¶…å‚æ•°ï¼Œè¿™é‡Œéœ€è¦å¯¹åº”åˆ°æ‚¨ç¨‹åºä¸­æ‰€éœ€çš„è¶…å‚æ•°ã€‚ç¬¬å››æ­¥ï¼Œè®¾å®šè®­ç»ƒæœºå‹ä¸ºlocalæˆ–è€…local_gpuï¼ˆæ”¯æŒGPUï¼‰ã€‚ç¬¬äº”æ­¥ï¼Œåˆ›å»ºä¸€ä¸ªåä¸ºTensorFlowçš„Estimatorï¼Œè¿™é‡Œéœ€è¦ä¼ å…¥è®­ç»ƒå…¥å£è„šæœ¬ï¼ˆentry_pointï¼‰ã€æºä»£ç è·¯å¾„ï¼ˆsource_dirï¼‰ã€ä¹‹å‰è·å¾—çš„è§’è‰²ã€è®­ç»ƒæœºå‹ã€æœºå™¨æ•°é‡ã€TensorFlowç‰ˆæœ¬ã€Pythonç‰ˆæœ¬ã€è¶…å‚æ•°ç­‰ã€‚ç¬¬å…­æ­¥ï¼Œå¯åŠ¨è®­ç»ƒï¼Œè¿™é‡Œéœ€è¦ä¼ å…¥è®­ç»ƒæ•°æ®çš„ä½ç½®ï¼Œåœ¨æœ¬åœ°æ¨¡å¼ä¸‹ï¼Œè®­ç»ƒæ•°æ®çš„ä½ç½®å¯ä»¥è®¾ç½®æˆæœ¬åœ°è·¯å¾„ã€‚</p><pre><code>role = get_execution_role()hyperparameters = {'task_name': 'ner', 'do_train': 'true', 'do_eval': 'true', _dir': '/opt/ml/input/data/training', 'output_dir': '/opt/ml/model', 'vocab_file': './albert_config/vocab.txt', 'bert_config_file': './albert_base_zh/albert_config_base.json', _seq_length': 128, 'train_batch_size': 64, 'learning_rate': 2e-5, 'num_train_epochs': 1}train_instance_type='local'if subprocess.call('nvidia-smi') == 0:    train_instance_type = 'local_gpu'estimator = TensorFlow(entry_point='albert_ner.py',                       source_dir='.',                       train_instance_type=train_instance_type,                       train_instance_count=1,                       hyperparameters=hyperparameters,                       role=role,                       framework_version='1.15.2',                       py_version='py3',                       script_mode=True)inputs = {'training': f'file:///home/ec2-user/SageMaker/albert-chinese-ner/data/'}estimator.fit(inputs)</code></pre><p></p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°estimator.fit()ä¼ å…¥çš„å‚æ•°ä¸BYOCç•¥æœ‰ä¸åŒï¼Œè¿™ä¸¤ä¸ªå†™æ³•å…¶å®æ˜¯ç­‰ä»·çš„ï¼Œäº‹å®ä¸Šï¼Œè¿™é‡Œçš„å†™æ³•æ›´è§„èŒƒä¸€äº›ï¼ŒæŒ‰ç…§Amazon SageMakerçš„æ–‡æ¡£ï¼Œè¾“å…¥æ•°æ®å¯ä»¥æœ‰å¤šä¸ªé€šé“ï¼ˆChannelï¼‰ï¼Œé»˜è®¤çš„é€šé“æ˜¯trainingï¼Œåœ¨æœ¬æ–‡çš„ä»£ç ä¸­ï¼Œè®­ç»ƒã€éªŒè¯ç­‰è¿‡ç¨‹å…¶å®éƒ½æ˜¯ä»trainingé€šé“ä¸­è¯»å–çš„æ•°æ®ï¼Œæ‰€ä»¥æ›´è§„èŒƒçš„åšæ³•æ˜¯ï¼Œæˆ‘ä»¬åº”è¯¥é¢å¤–å¢åŠ ä¸€ä¸ªé€šé“validationï¼Œç”¨æ¥å­˜æ”¾éªŒè¯æ•°æ®ã€‚</p><p>è®­ç»ƒå¯åŠ¨åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è®­ç»ƒçš„æ—¥å¿—è¾“å‡ºï¼Œä»¥åŠç›‘æ§æœ¬æœºçš„GPUã€CPUã€å†…å­˜ç­‰çš„ä½¿ç”¨ç‡ç­‰æƒ…å†µï¼Œä»¥ç¡®è®¤ç¨‹åºå¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p><p>å¦‚æœåœ¨æ­¤è¿‡ç¨‹ä¸­éœ€è¦è¿›å…¥æ­£åœ¨è¿è¡Œçš„å®¹å™¨å†…è°ƒè¯•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨docker pså‘½ä»¤è·å–å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨IDï¼Œå¹¶ä½¿ç”¨docker exec -it &lt;CONTAINER ID> /bin/bashè¿›å…¥å®¹å™¨å†…è¿›è¡Œè°ƒè¯•ã€‚å¦å¤–ï¼Œæˆ‘ä»¬ä½¿ç”¨docker imageså‘½ä»¤å¯ä»¥çœ‹åˆ°Amazon SageMakerè‡ªåŠ¨ä¸‹è½½äº†ä¸€ä¸ªåä¸º763104351884.dkr.ecr.us-east-1.amazonaws.com/tensorflow-training:1.15.2-gpu-py3çš„é•œåƒï¼Œè¯¥é•œåƒæ˜¯ç”±Amazon SageMakeré¢„ç¼–è¯‘çš„ã€‚</p><div class=pgc-img><img alt="ä½¿ç”¨ Amazon SageMaker è¿è¡ŒåŸºäº TensorFlow çš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4956502f431b4d748dcfe8e3c1f15a5b><p class=pgc-img-caption></p></div><p></p><p>3.2 Amazon SageMakeræµ‹è¯•</p><p>åœ¨æœ¬åœ°æµ‹è¯•å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Amazon SageMakerè¿›è¡Œæµ‹è¯•ï¼šç¬¬ä¸€æ­¥ï¼Œä¸Šä¼ æ•°æ®åˆ°Amazon S3ã€‚ç¬¬äºŒæ­¥ï¼ŒæŒ‡å®šæ‰§è¡Œçš„è§’è‰²ï¼Œè¿™é‡Œæˆ‘ä»¬å‡è®¾æ‚¨æ˜¯åœ¨Amazon SageMaker Notebookä¸Šæ‰§è¡Œçš„ï¼Œå¦‚æœæ˜¯å…¶ä»–ç¯å¢ƒï¼Œæ‚¨å¯èƒ½éœ€è¦æ‰‹åŠ¨æŒ‡å®šè§’è‰²çš„ARNã€‚ç¬¬ä¸‰æ­¥ï¼Œè®¾å®šè¶…å‚æ•°ï¼Œè¿™é‡Œéœ€è¦å¯¹åº”åˆ°æ‚¨ç¨‹åºä¸­æ‰€éœ€çš„è¶…å‚æ•°ã€‚ç¬¬å››æ­¥ï¼Œè®¾å®šè®­ç»ƒæœºå‹ä¸ºml.p2.xlargeï¼ˆæ”¯æŒGPUï¼‰ã€‚ç¬¬äº”æ­¥ï¼Œåˆ›å»ºä¸€ä¸ªåä¸ºTensorFlowçš„Estimatorï¼Œè¿™é‡Œéœ€è¦ä¼ å…¥è®­ç»ƒå…¥å£è„šæœ¬ï¼ˆentry_pointï¼‰ã€æºä»£ç è·¯å¾„ï¼ˆsource_dirï¼‰ã€ä¹‹å‰è·å¾—çš„è§’è‰²ã€è®­ç»ƒæœºå‹ã€æœºå™¨æ•°é‡ã€TensorFlowç‰ˆæœ¬ã€Pythonç‰ˆæœ¬ã€è¶…å‚æ•°ç­‰ã€‚ç¬¬å…­æ­¥ï¼Œå¯åŠ¨è®­ç»ƒï¼Œè¿™é‡Œéœ€è¦ä¼ å…¥è®­ç»ƒæ•°æ®çš„ä½ç½®ï¼Œåœ¨Amazon SageMakeræ¨¡å¼ä¸‹ï¼Œè®­ç»ƒæ•°æ®çš„ä½ç½®éœ€è¦è®¾ç½®æˆAmazon S3è·¯å¾„ã€‚</p><pre><code>inputs = sagemaker.Session().upload_data(path='/home/ec2-user/SageMaker/albert-chinese-ner/data', key_prefix='DEMO-tensorflow-albert-chinese-ner')estimator = TensorFlow(entry_point='albert_ner.py',                       source_dir='.',                       train_instance_type='ml.p2.xlarge',                       train_instance_count=1,                       hyperparameters=hyperparameters,                       role=role,                       framework_version='1.15.2',                       py_version='py3',                       script_mode=True)             estimator.fit({'training': inputs})</code></pre><p></p><p>è®­ç»ƒå¯åŠ¨åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Amazon SageMakeræ§åˆ¶å°çœ‹åˆ°è¿™ä¸ªè®­ç»ƒä»»åŠ¡ï¼Œç‚¹è¿›è¯¦æƒ…å¯ä»¥çœ‹åˆ°è®­ç»ƒçš„è¯¦æƒ…ï¼Œæ—¥å¿—è¾“å‡ºï¼Œä»¥åŠç›‘æ§æœºå™¨çš„GPUã€CPUã€å†…å­˜ç­‰çš„ä½¿ç”¨ç‡ç­‰æƒ…å†µï¼Œä»¥ç¡®è®¤ç¨‹åºå¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p><p></p><p>åœ¨è¿™é‡Œï¼Œsource_diræˆ‘ä»¬è®¾ç½®çš„æ˜¯æœ¬åœ°ä»£ç è·¯å¾„ï¼ŒAmazon SageMakerä¼šè‡ªåŠ¨å°†è¯¥è·¯å¾„ä¸‹çš„æ‰€æœ‰ä»£ç å’Œæ•°æ®æ‹·è´è¿›å®¹å™¨ä¸­ã€‚æ­¤å¤–ï¼ŒBYOSæ¨¡å¼è¿˜æ”¯æŒgitè·¯å¾„ä½œä¸ºä»£ç è·¯å¾„ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><pre><code>git_config = {'repo': 'https://github.com/whn09/albert-chinese-ner.git', 'branch': 'master'}estimator = TensorFlow(entry_point='albert_ner.py',                       source_dir='.',                       git_config=git_config,                       train_instance_type='ml.p2.xlarge',                       train_instance_count=1,                       hyperparameters=hyperparameters,                       role=role,                       framework_version='1.15.2',                       py_version='py3',                       script_mode=True)estimator.fit({'training': inputs})</code></pre><p>ä½†æ˜¯ï¼Œç”±äºæœ¬æ–‡æ‰€ç”¨ä»£ç éœ€è¦ALBERTé¢„è®­ç»ƒæ•°æ®ï¼Œè€Œè¯¥æ•°æ®ä¸åŒ…å«åœ¨gitå†…ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹ä»£ç è¿›è¡Œæ”¹é€ ï¼Œä»¥ä½¿å¾—åœ¨ä»£ç å†…ä¸‹è½½å¹¶è§£å‹æ•°æ®ï¼Œæ‰èƒ½å¤Ÿæ­£å¸¸è®­ç»ƒã€‚è¿™é‡Œæˆ‘ä»¬ä¸å†å±•ç¤ºå¦‚ä½•æ“ä½œï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥è‡ªè¡Œå°è¯•ã€‚</p><p>å››ã€ç»“è®º</p><p>æœ¬æ–‡è®²è§£äº†å¦‚ä½•ä½¿ç”¨Amazon SageMakerè¿è¡ŒåŸºäºTensorFlowçš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«ï¼Œå…¶ä¸­ç®—æ³•éƒ¨åˆ†æ˜¯ä½¿ç”¨é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ALBERTåšä¸­æ–‡å‘½åå®ä½“è¯†åˆ«ã€‚</p><p>æœ¬æ–‡å±•ç¤ºäº†å¦‚ä½•æŠŠä¸€ä¸ªå·²æœ‰é¡¹ç›®å¿«é€Ÿè¿è¡Œåˆ°Amazon SageMakerä¸Šï¼Œå¦‚æœæ‚¨æƒ³ä½¿ç”¨åˆ°Amazon SageMakerçš„æ›´å¤šé«˜çº§ç”¨æ³•ï¼Œéœ€è¦å¯¹å·²æœ‰é¡¹ç›®è¿›è¡Œæ”¹é€ ï¼Œæ¯”å¦‚æ”¯æŒå®æ—¶æ¨ç†ã€æ‰¹é‡æ¨ç†ã€æ–­ç‚¹é‡æ–°è®­ç»ƒç­‰ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹Amazon SageMakerçš„æ–‡æ¡£ã€‚</p><p>æœ¬æ–‡æ‰€æ¼”ç¤ºçš„ä½¿ç”¨æ–¹æ³•æ˜¯åŸºæ–¼å•æœºå•å¡çš„ï¼ŒAmazon SageMaker æä¾›åŸºäº Docker çš„ç®€åŒ–åˆ†å¸ƒå¼ TensorFlow è®­ç»ƒå¹³å°ï¼Œå¦‚æœè¦å°†ç¨‹åºæ‰©å±•åˆ°å¤šæœºå¤šå¡è¿›è¡Œè®­ç»ƒï¼Œå¯ä»¥å‚è€ƒå…¶ä»–ç›¸å…³åšå®¢ã€‚</p><p><strong>æœ¬ç¯‡ä½œè€…</strong></p><div class=pgc-img><img alt="ä½¿ç”¨ Amazon SageMaker è¿è¡ŒåŸºäº TensorFlow çš„ä¸­æ–‡å‘½åå®ä½“è¯†åˆ«" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/786dd0a3c9714e72a3efb0558eb77004><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Amazon','SageMaker','è¿è¡ŒåŸº'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>