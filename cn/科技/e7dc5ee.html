<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>ç”¨äºç”µå½±æ¨èçš„æ·±åº¦è‡ªåŠ¨ç¼–ç å™¨-ä¸€ç§å®ç”¨çš„æ–¹æ³• | æå®¢å¿«è¨Š</title><meta property="og:title" content="ç”¨äºç”µå½±æ¨èçš„æ·±åº¦è‡ªåŠ¨ç¼–ç å™¨-ä¸€ç§å®ç”¨çš„æ–¹æ³• - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/15378625194763ffb073139"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e7dc5ee.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e7dc5ee.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e7dc5ee.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e7dc5ee.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e7dc5ee.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e7dc5ee.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e7dc5ee.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e7dc5ee.html><meta property="article:published_time" content="2020-10-29T21:05:26+08:00"><meta property="article:modified_time" content="2020-10-29T21:05:26+08:00"><meta name=Keywords content><meta name=description content="ç”¨äºç”µå½±æ¨èçš„æ·±åº¦è‡ªåŠ¨ç¼–ç å™¨-ä¸€ç§å®ç”¨çš„æ–¹æ³•"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/e7dc5ee.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>ç”¨äºç”µå½±æ¨èçš„æ·±åº¦è‡ªåŠ¨ç¼–ç å™¨-ä¸€ç§å®ç”¨çš„æ–¹æ³•</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><p>ç”¨äºæ¨èçš„è‡ªåŠ¨ç¼–ç å™¨çš„å¤§å¤šæ•°ç¤ºä¾‹ä»…è€ƒè™‘ç”¨æˆ·å’Œç”¨æˆ·ç»™å‡ºçš„è¯„çº§ã€‚è¿™äº›å»ºè®®æ²¡æœ‰è€ƒè™‘å…¶ä»–å±æ€§ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘è€ƒè™‘100k movielens datasetï¼ˆhttps://grouplens.org/datasets/movielens/100k/ï¼‰ï¼Œå®ƒåŒ…å«å„ç§å…¶ä»–å±æ€§ï¼Œå¦‚ç”¨æˆ·çš„æ€§åˆ«å’Œå¹´é¾„ã€‚ç”µå½±è¿˜åŒ…å«æµæ´¾ä¿¡æ¯ã€‚è€ƒè™‘åˆ°è¿™äº›å±æ€§ï¼Œå¯ä»¥å¸®åŠ©æ·±å±‚ç¥ç»ç½‘ç»œæ¨å¯¼å‡º18 - 25å²å¹´é¾„æ®µçš„ç”·æ€§ç”¨æˆ·æ›´å–œæ¬¢çœ‹åŠ¨ä½œç‰‡å’Œææ€–ç‰‡ï¼Œæˆ–è€…åŒä¸€å¹´é¾„æ®µçš„å¥³æ€§ç”¨æˆ·æ›´å–œæ¬¢çœ‹çˆ±æƒ…ç‰‡ã€‚</p><p>æˆ‘ä»¬å°†ç›´æ¥æ·±å…¥ç ”ç©¶è¿™ç§æ–¹æ³•çš„ä»£ç ï¼Œå¹¶åœ¨æ­¤è¿‡ç¨‹ä¸­è§£é‡Šä¸€äº›æ¦‚å¿µã€‚</p><h1>ç¬¬1æ­¥ï¼šæˆ‘ä»¬ä½¿ç”¨pytorchæ„å»ºç¥ç»ç½‘ç»œï¼Œå¯¼å…¥Pythonåº“å’Œæ•°æ®é›†çš„ä»£ç å¦‚ä¸‹ï¼š</h1><pre># Importing the librariesimport numpy as npimport pandas as pdimport torchimport torch.nn as nnimport torch.optim as optimimport torch.utils.datafrom torch.autograd import Variable# Importing the datasetprint('Importing Dataset =====&gt;')movies = pd.read_csv('ml-1m/movies.dat', sep = '::', header = None, engine = 'python', encoding = 'latin-1')users = pd.read_csv('ml-1m/users.dat', sep = '::', header = None, engine = 'python', encoding = 'latin-1')ratings = pd.read_csv('ml-1m/ratings.dat', sep = '::', header = None, engine = 'python', encoding = 'latin-1')# Preparing the training set and the test setprint('Reading testing and training datasets =====&gt;')# Training and test set for 100k userstraining_set_df = pd.read_csv('ml-100k/u1.base', delimiter = '\t', header=None)test_set_df = pd.read_csv('ml-100k/u1.test', delimiter = '\t', header=None)</pre><h1>æ­¥éª¤2ï¼šå°†è®­ç»ƒé›†å’Œæµ‹è¯•é›†è½¬æ¢ä¸ºnumpyæ•°ç»„ï¼Œå¹¶è·å–ç”¨æˆ·æ•°ï¼Œç”µå½±æ•°å’Œç”¨æˆ·å±æ€§æ•°ï¼ŒPythonä»£ç å¦‚ä¸‹ï¼š</h1><pre># Convert training set and test set in numpy arraystraining_set_ar = np.array(training_set_df, dtype = 'int')test_set_ar = np.array(test_set_df, dtype = 'int')# Getting the number of users and moviesnb_users = int(max(max(training_set_ar[:,0]), max(test_set_ar[:,0])))nb_movies = int(max(max(training_set_ar[:,1]), max(test_set_ar[:,1])))nb_userAttributes = 4</pre><p>è¿™é‡Œæœ‰4ä¸ªç”¨æˆ·å±æ€§å¯¹åº”äºä»¥ä¸‹å†…å®¹ï¼š</p><ul><li>å¦‚æœç”¨æˆ·æ˜¯å¥³æ€§åˆ™æ ‡è®°</li><li>å¦‚æœç”¨æˆ·æ˜¯ç”·æ€§åˆ™æ ‡è®°</li><li>ç”¨æˆ·å¹´é¾„</li><li>ç”¨æˆ·æ³¨å†Œæœˆä»½</li></ul><h1>ç¬¬3æ­¥ï¼šè·å–æ€§åˆ«æ ‡å¿—çš„æ•°ç»„ï¼ŒPythonä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</h1><pre>users['female_user'] = (users[1] == 'F').astype(int)users['male_user'] = (users[1] == 'M').astype(int)</pre><h1>ç¬¬å››æ­¥:ä¸ºæ‰€æœ‰çš„ç”µå½±æå–æµæ´¾ï¼ŒPythonå®ç°å¦‚ä¸‹ï¼š</h1><div class=pgc-img><img alt=ç”¨äºç”µå½±æ¨èçš„æ·±åº¦è‡ªåŠ¨ç¼–ç å™¨-ä¸€ç§å®ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15378625194763ffb073139><p class=pgc-img-caption></p></div><pre># extract unique genre valuesprint('Extracting unique genres =====&gt;')genre = movies[2]unique_genre = genre.unique()genre_values = []for movie_genre in unique_genre: mg = movie_genre.split("|") for g in mg: if g not in genre_values: genre_values.append(g) genre_values = sorted(genre_values, key=str.lower)print(genre_values)print(len(genre_values))</pre><h1>æ­¥éª¤5ï¼šåŸºäºæå–çš„æµæ´¾ç±»å‹åˆ›å»ºç±»å‹å‘é‡ï¼ŒPythonä»£ç å¦‚ä¸‹ï¼š</h1><div class=pgc-img><img alt=ç”¨äºç”µå½±æ¨èçš„æ·±åº¦è‡ªåŠ¨ç¼–ç å™¨-ä¸€ç§å®ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1537862568201862fd982cf><p class=pgc-img-caption></p></div><pre># get genre vectordef get_genre_vector(genre_row_val): mg = genre_row_val.split("|") gen_vec = np.zeros(len(genre_values)) gen_index = 0 for g in genre_values: if g in mg: gen_vec[gen_index] = 1 gen_index += 1return gen_vec# unit tests for above function'''print(get_genre_vector("Action|Adventure|Romance"))print(get_genre_vector("Animation|Children's|Comedy"))print(get_genre_vector("Thriller"))print(get_genre_vector("Animation|Children's|Comedy|Romance"))'''</pre><h1>æ­¥éª¤6ï¼šå°†ç±»å‹å‘é‡æ·»åŠ åˆ°ç”µå½±dataframe</h1><div class=pgc-img><img alt=ç”¨äºç”µå½±æ¨èçš„æ·±åº¦è‡ªåŠ¨ç¼–ç å™¨-ä¸€ç§å®ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15378626255035ad0869b0c><p class=pgc-img-caption></p></div><pre># Add Genre Vector to movies dataframeprint('Creating Genre vector on movies df ====&gt;')movie_data = movies[2]movie_col = []gen_index = 0for movie_gen in movie_data: gen_vec = get_genre_vector(movie_gen) movie_col.append(gen_vec) gen_index += 1 movies['genre_vector'] = movie_col</pre><h1>æ­¥éª¤7ï¼šå°†ç±»å‹å‘é‡æ·»åŠ åˆ°è®­ç»ƒå’Œæµ‹è¯•datafrmeå¹¶å°†dataframesè½¬æ¢ä¸ºnumpyæ•°ç»„</h1><div class=pgc-img><img alt=ç”¨äºç”µå½±æ¨èçš„æ·±åº¦è‡ªåŠ¨ç¼–ç å™¨-ä¸€ç§å®ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153786265471461eb8d57f7><p class=pgc-img-caption></p></div><pre>def addgenrevector(data): genre_array = [] movie_id_list = data[1].tolist() for movie_id in movie_id_list: genre_array.append(movies.loc[movies[0] == movie_id]['genre_vector']) data['genre_vector'] = genre_array return data print('Adding Genre Vector to training and testing datasets =====&gt;')training_set_gen_df = addgenrevector(training_set_df)training_set_gen_ar = np.array(training_set_gen_df)test_set_gen_df = addgenrevector(test_set_df)test_set_gen_ar = np.array(test_set_gen_df)</pre><h1>æ­¥éª¤8ï¼šè¿™æ˜¯ä»¥ä¸‹åˆ—æ ¼å¼æ’åˆ—æ•°æ®çš„æœ€é‡è¦æ­¥éª¤</h1><div class=pgc-img><img alt=ç”¨äºç”µå½±æ¨èçš„æ·±åº¦è‡ªåŠ¨ç¼–ç å™¨-ä¸€ç§å®ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1537861367228d9151198ff><p class=pgc-img-caption>ç”¨äºè®­ç»ƒæ·±åº¦è‡ªåŠ¨ç¼–ç å™¨çš„2DçŸ©é˜µ</p></div><p>æ•°æ®åº”è¡¨ç¤ºäºŒç»´æ•°ç»„ï¼Œå…¶ä¸­æ¯è¡Œä»£è¡¨ç”¨æˆ·ã€‚åˆ—åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š</p><ol><li>å‰nåˆ—æ˜¯æŒ‡ç”¨æˆ·è¯„ä»·ç”µå½±çš„néƒ¨ç”µå½±ã€‚å¦‚æœç”¨æˆ·æ²¡æœ‰ä¸ºç”µå½±è¯„çº§ï¼Œå®ƒå°†åŒ…å«å€¼0</li><li>æ¥ä¸‹æ¥çš„nåˆ—è¡¨ç¤ºç±»å‹çš„æ•°é‡ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªç”¨æˆ·å¯èƒ½ä¼šè§‚çœ‹çš„ç”µå½±æ¨èã€‚å› æ­¤ï¼Œueser 1å’ŒGenre 1çš„å•å…ƒæ ¼è¡¨ç¤ºuser 1å¯¹Genre 1ç±»åˆ«çš„è¯„åˆ†è¶…è¿‡3æˆ–ä»¥ä¸Šçš„ç”µå½±æ•°é‡ã€‚æˆ‘ä»¬å¯ä»¥åº”ç”¨å¤šç§è§„åˆ™ï¼Œä½†æ˜¯æˆ‘é€‰æ‹©äº†è¿™ä¸ªè§„åˆ™æ¥ç¡®å®šç”¨æˆ·å¯¹ç‰¹å®šç±»å‹çš„å–œå¥½ã€‚</li><li>æœ€åå‡ è¡Œè¡¨ç¤ºç”¨æˆ·å±æ€§ï¼Œå¦‚ç”¨æˆ·æ€§åˆ«ï¼Œå¹´é¾„ï¼Œæ³¨å†Œæœˆæ•°ç­‰ã€‚</li></ol><p>åœ¨äºŒç»´æ•°ç»„ä¸­æ’åˆ—æ•°æ®çš„Pythonå‡½æ•°å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt=ç”¨äºç”µå½±æ¨èçš„æ·±åº¦è‡ªåŠ¨ç¼–ç å™¨-ä¸€ç§å®ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1537862684401e00afa0852><p class=pgc-img-caption></p></div><pre>def createmultidimensionalmatrix(data): print(data.shape) gen_data = [] for id_users in range(1, nb_users + 1): id_movies = data[1][data[0] == id_users] id_ratings = data[2][data[0] == id_users] user_genre_list = data['genre_vector'][data[0] == id_users][data[2] &gt;= 3] female_user = float(users['female_user'][users[0] == id_users]) male_user = float(users['male_user'][users[0] == id_users]) user_age = float(users[2][users[0] == id_users]) reg_months = float(users[3][users[0] == id_users]) user_genre_sum = np.zeros(len(genre_values)) for usr_gen_vec in user_genre_list: if len(usr_gen_vec): user_genre_sum = user_genre_sum + np.array(usr_gen_vec) data_reshaped = np.zeros(nb_movies) # Create a matrix with users in rows and ratings for each movie in columns data_reshaped[id_movies - 1] = id_ratings # Add columns of user genre only for good ratings if user_genre_sum[0].shape: data_reshaped = np.append(data_reshaped, user_genre_sum[0]) else: data_reshaped = np.append(data_reshaped, user_genre_sum)  data_reshaped = np.append(data_reshaped, [female_user]) data_reshaped = np.append(data_reshaped, [male_user]) data_reshaped = np.append(data_reshaped, [user_age]) data_reshaped = np.append(data_reshaped, [reg_months]) gen_data.append(list(data_reshaped)) return gen_data  print('Creating 2D matrix ======&gt;') training_gen_data = createmultidimensionalmatrix(training_set_gen_df)test_gen_data = createmultidimensionalmatrix(test_set_gen_df)</pre><h1>æ­¥éª¤9ï¼šå°†2Dé˜µåˆ—è½¬æ¢ä¸ºtorch å¼ é‡</h1><pre># Converting the data into Torch tensorsprint('Creating torch tensors ======&gt;')training_set_1 = torch.FloatTensor(training_gen_data)test_set_1 = torch.FloatTensor(test_gen_data)</pre><h1>ç¬¬10æ­¥ï¼šåˆ›å»ºç¥ç»ç½‘ç»œã€‚</h1><p>è¿™é‡Œæˆ‘ä¸ä¼šä»‹ç»è‡ªåŠ¨ç¼–ç å™¨çš„åŸºç¡€çŸ¥è¯†ï¼Œä½†æ˜¯åªä¼šæåˆ°è‡ªåŠ¨ç¼–ç å™¨çš„å…¸å‹ç”¨ä¾‹æ˜¯æ•°æ®å‹ç¼©ï¼Œç„¶åæ˜¯data recreationã€‚ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯å›¾åƒå†ç”Ÿã€‚æˆ‘ä»¬å°†åˆ›å»ºçš„ç¥ç»ç½‘ç»œç±»å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><div class=pgc-img><img alt=ç”¨äºç”µå½±æ¨èçš„æ·±åº¦è‡ªåŠ¨ç¼–ç å™¨-ä¸€ç§å®ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15378614294384f31f7395b><p class=pgc-img-caption>è‡ªåŠ¨ç¼–ç å™¨æ·±åº¦ç¥ç»ç½‘ç»œ</p></div><p>è¯·æ³¨æ„ï¼Œæˆ‘å·²ç»å°è¯•äº†3å±‚ï¼Œ5å±‚å’Œ7å±‚çš„æ·±åº¦ç¥ç»ç½‘ç»œã€‚æˆ‘é€‰æ‹©äº†3å±‚ï¼Œå› ä¸ºè®¡ç®—éšç€å±‚æ¬¡å’Œç¥ç»å…ƒçš„å¢åŠ å‘ˆæŒ‡æ•°å¢é•¿ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œç”±5å±‚å’Œ7å±‚ç¥ç»ç½‘ç»œæä¾›çš„ç»“æœä»…æ¯”3å±‚ç½‘ç»œç¨å¾®å¥½ä¸€ç‚¹ã€‚åˆ›å»ºç¥ç»ç½‘ç»œçš„Pythonä»£ç å¦‚ä¸‹ã€‚æˆ‘ä»¬ä½¿ç”¨RMS prop ä¼˜åŒ–å™¨å’Œsigmoidæ¿€æ´»å‡½æ•°é€‰æ‹©å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°ã€‚</p><div class=pgc-img><img alt=ç”¨äºç”µå½±æ¨èçš„æ·±åº¦è‡ªåŠ¨ç¼–ç å™¨-ä¸€ç§å®ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1537862712632585d952f5e><p class=pgc-img-caption></p></div><pre>class SAE(nn.Module): def __init__(self, ): super(SAE, self).__init__() self.fc1 = nn.Linear(input_columns, 20) self.fc2 = nn.Linear(20, 10) self.fc3 = nn.Linear(10, 20) self.fc4 = nn.Linear(20, input_columns) self.activation = nn.Sigmoid()  def forward(self, x): x = self.activation(self.fc1(x)) x = self.activation(self.fc2(x)) x = self.activation(self.fc3(x)) x = self.fc4(x) return xsae = SAE()criterion = nn.MSELoss()optimizer = optim.RMSprop(sae.parameters(), lr=0.01, weight_decay=0.5)</pre><h1>æ­¥éª¤11ï¼šè®­ç»ƒç½‘ç»œå¹¶æµ‹é‡æŸå¤±ä»¥è¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ã€‚</h1><p>è¿™é‡Œæˆ‘åªä½¿ç”¨äº†è¯„çº§åˆ—æ¥è®¡ç®—æŸå¤±ï¼Œå› ä¸ºæˆ‘ä»¬ä¼šæ ¹æ®ç”¨æˆ·å¯èƒ½ç»™ç”µå½±çš„é¢„æµ‹è¯„çº§å‘ç”¨æˆ·æ¨èç‰¹å®šçš„ç”µå½±ã€‚è®­ç»ƒå’Œæµ‹è¯•é›†çš„Pythonä»£ç å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt=ç”¨äºç”µå½±æ¨èçš„æ·±åº¦è‡ªåŠ¨ç¼–ç å™¨-ä¸€ç§å®ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/153786274842801b952edcf><p class=pgc-img-caption></p></div><pre>nb_epoch = 200for epoch in range(1, nb_epoch+1): train_loss = 0 s = 0. for id_user in range(nb_users): input = Variable(training_set_1[id_user]).unsqueeze(0) target = input.clone() #Select only rating related columns to compute loss target_ratings = target[:, :nb_movies] if torch.sum(target.data &gt; 0) &gt; 0: output = sae(input) output_ratings = output[:, :nb_movies] target.require_grad = False output[target == 0] = 0 loss = criterion(output_ratings, target_ratings) mean_corrector = nb_movies/float(torch.sum(target.data &gt; 0) + 1e-10) loss.backward() train_loss += np.sqrt(loss.data[0]*mean_corrector) s += 1. optimizer.step() print('epoch: '+str(epoch)+' loss: '+str(train_loss/s))  # Testing the SAEtest_loss = 0s = 0.for id_user in range(nb_users): input = Variable(training_set_1[id_user]).unsqueeze(0) target = Variable(test_set_1[id_user]).unsqueeze(0) target_ratings = target[:, :nb_movies] if torch.sum(target.data &gt; 0) &gt; 0: output = sae(input) output_ratings = output[:, :nb_movies] target.require_grad = False output[target == 0] = 0 loss = criterion(output_ratings, target_ratings) mean_corrector = nb_movies/float(torch.sum(target.data &gt; 0) + 1e-10) test_loss += np.sqrt(loss.data[0]*mean_corrector) s += 1.print('test loss: '+str(test_loss/s))</pre><p>ç»“æœï¼šæˆ‘å°è¯•ä½¿ç”¨ä¸åŒæ•°é‡çš„å±æ€§å’Œä¸åŒçš„æ¶æ„ç”¨äºç¥ç»ç½‘ç»œã€‚è·å¾—çš„ç»“æœå¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt=ç”¨äºç”µå½±æ¨èçš„æ·±åº¦è‡ªåŠ¨ç¼–ç å™¨-ä¸€ç§å®ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1537861470643a42cce0f11><p class=pgc-img-caption>è®­ç»ƒç»“æœ</p></div><p>æˆ‘ä»¬å¯ä»¥è¯´è·å¾—çš„æœ€ä½³ç»“æœæ˜¯ä½¿ç”¨å…·æœ‰3å±‚æ·±åº¦ç¥ç»ç½‘ç»œå’Œ200ä¸ªepochsçš„ç”µå½±è¯„çº§ï¼Œç±»å‹è®¡æ•°å’Œç”¨æˆ·å±æ€§ã€‚</p><p>ä½œä¸ºå‚è€ƒï¼Œæˆ‘ä½¿ç”¨çš„5å±‚æ·±åº¦ç¥ç»ç½‘ç»œçš„æ¶æ„å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt=ç”¨äºç”µå½±æ¨èçš„æ·±åº¦è‡ªåŠ¨ç¼–ç å™¨-ä¸€ç§å®ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15378627894095040f97480><p class=pgc-img-caption></p></div><pre>class SAE(nn.Module): def __init__(self, ): super(SAE, self).__init__() self.fc1 = nn.Linear(input_columns, 300) self.fc2 = nn.Linear(300, 100) self.fc22 = nn.Linear(100, 50) self.fc23 = nn.Linear(50, 20) self.fc24 = nn.Linear(20, 10) self.fc3 = nn.Linear(10, 20) self.fc31 = nn.Linear(20, 50) self.fc32 = nn.Linear(50, 100) self.fc33 = nn.Linear(100, 300) self.fc4 = nn.Linear(300, input_columns) self.activation = nn.Sigmoid()  def forward(self, x): x = self.activation(self.fc1(x)) x = self.activation(self.fc2(x)) x = self.activation(self.fc22(x)) x = self.activation(self.fc23(x)) x = self.activation(self.fc24(x)) x = self.activation(self.fc3(x)) x = self.activation(self.fc31(x)) x = self.activation(self.fc32(x)) x = self.activation(self.fc33(x)) x = self.fc4(x) return x</pre></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'ç”µå½±','æ¨è','è‡ªåŠ¨'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>