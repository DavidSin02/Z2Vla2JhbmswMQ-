<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>æœºå™¨ä¸å­¦ä¹ ï¼šFastTextå…¥é—¨ä¸å®æˆ˜ | æå®¢å¿«è¨Š</title><meta property="og:title" content="æœºå™¨ä¸å­¦ä¹ ï¼šFastTextå…¥é—¨ä¸å®æˆ˜ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/153344935537075eee4d9a3"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/eb2b749.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/eb2b749.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/eb2b749.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/eb2b749.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/eb2b749.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/eb2b749.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/eb2b749.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/eb2b749.html><meta property="article:published_time" content="2020-10-29T21:07:51+08:00"><meta property="article:modified_time" content="2020-10-29T21:07:51+08:00"><meta name=Keywords content><meta name=description content="æœºå™¨ä¸å­¦ä¹ ï¼šFastTextå…¥é—¨ä¸å®æˆ˜"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/eb2b749.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>æœºå™¨ä¸å­¦ä¹ ï¼šFastTextå…¥é—¨ä¸å®æˆ˜</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><h1><strong>æœºå™¨ä¸å­¦ä¹  www.jqbxx.com : æ·±åº¦èšåˆæœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ç®—æ³•åŠæŠ€æœ¯å®æˆ˜</strong></h1><div class=pgc-img><img alt=æœºå™¨ä¸å­¦ä¹ ï¼šFastTextå…¥é—¨ä¸å®æˆ˜ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153344935537075eee4d9a3><p class=pgc-img-caption></p></div><p>æœ¬æ–‡ä¸»è¦ä»‹ç»FastTextçš„æ¥é¾™å»è„‰å’ŒåŸç†åˆ†æï¼Œå¤§æ¦‚ç›®å½•å¦‚ä¸‹ï¼š</p><ul><li>ä¸€ã€ç®€ä»‹</li><li>äºŒã€FastTextåŸç†</li><li>2.1 æ¨¡å‹æ¶æ„</li><li>2.2 å±‚æ¬¡SoftMax</li><li>2.3 N-gramç‰¹å¾</li><li>ä¸‰ã€ åŸºäºfastTextå®ç°æ–‡æœ¬åˆ†ç±»</li><li>3.1 fastTextæœ‰ç›‘ç£å­¦ä¹ åˆ†ç±»</li><li>3.2 fastTextæœ‰ç›‘ç£å­¦ä¹ åˆ†ç±»</li><li>ä¸‰ã€æ€»ç»“</li><li>3.1 fastTextå’Œword2vecçš„åŒºåˆ«</li><li>3.2 å°ç»“</li></ul><h1><strong>ä¸€ã€ç®€ä»‹</strong></h1><p>fasttextæ˜¯facebookå¼€æºçš„ä¸€ä¸ªè¯å‘é‡ä¸æ–‡æœ¬åˆ†ç±»å·¥å…·ï¼Œåœ¨2016å¹´å¼€æºï¼Œå…¸å‹åº”ç”¨åœºæ™¯æ˜¯â€œå¸¦ç›‘ç£çš„æ–‡æœ¬åˆ†ç±»é—®é¢˜â€ã€‚æä¾›ç®€å•è€Œé«˜æ•ˆçš„æ–‡æœ¬åˆ†ç±»å’Œè¡¨å¾å­¦ä¹ çš„æ–¹æ³•ï¼Œæ€§èƒ½æ¯”è‚©æ·±åº¦å­¦ä¹ è€Œä¸”é€Ÿåº¦æ›´å¿«ã€‚</p><p>fastTextç»“åˆäº†è‡ªç„¶è¯­è¨€å¤„ç†å’Œæœºå™¨å­¦ä¹ ä¸­æœ€æˆåŠŸçš„ç†å¿µã€‚è¿™äº›åŒ…æ‹¬äº†ä½¿ç”¨è¯è¢‹ä»¥åŠn-gramè¢‹è¡¨å¾è¯­å¥ï¼Œè¿˜æœ‰ä½¿ç”¨å­å­—(subword)ä¿¡æ¯ï¼Œå¹¶é€šè¿‡éšè—è¡¨å¾åœ¨ç±»åˆ«é—´å…±äº«ä¿¡æ¯ã€‚æˆ‘ä»¬å¦å¤–é‡‡ç”¨äº†ä¸€ä¸ªsoftmaxå±‚çº§(åˆ©ç”¨äº†ç±»åˆ«ä¸å‡è¡¡åˆ†å¸ƒçš„ä¼˜åŠ¿)æ¥åŠ é€Ÿè¿ç®—è¿‡ç¨‹ã€‚</p><p>è¿™äº›ä¸åŒæ¦‚å¿µè¢«ç”¨äºä¸¤ä¸ªä¸åŒä»»åŠ¡ï¼š</p><ul><li><strong>æœ‰æ•ˆæ–‡æœ¬åˆ†ç±»</strong> ï¼šæœ‰ç›‘ç£å­¦ä¹ </li><li><strong>å­¦ä¹ è¯å‘é‡è¡¨å¾</strong>ï¼šæ— ç›‘ç£å­¦ä¹ </li></ul><p>ä¸¾ä¾‹æ¥è¯´ï¼šfastTextèƒ½å¤Ÿå­¦ä¼šâ€œç”·å­©â€ã€â€œå¥³å­©â€ã€â€œç”·äººâ€ã€â€œå¥³äººâ€æŒ‡ä»£çš„æ˜¯ç‰¹å®šçš„æ€§åˆ«ï¼Œå¹¶ä¸”èƒ½å¤Ÿå°†è¿™äº›æ•°å€¼å­˜åœ¨ç›¸å…³æ–‡æ¡£ä¸­ã€‚ç„¶åï¼Œå½“æŸä¸ªç¨‹åºåœ¨æå‡ºä¸€ä¸ªç”¨æˆ·è¯·æ±‚ï¼ˆå‡è®¾æ˜¯â€œæˆ‘å¥³å‹ç°åœ¨åœ¨å„¿ï¼Ÿâ€ï¼‰ï¼Œå®ƒèƒ½å¤Ÿé©¬ä¸Šåœ¨fastTextç”Ÿæˆçš„æ–‡æ¡£ä¸­è¿›è¡ŒæŸ¥æ‰¾å¹¶ä¸”ç†è§£ç”¨æˆ·æƒ³è¦é—®çš„æ˜¯æœ‰å…³å¥³æ€§çš„é—®é¢˜ã€‚</p><h1><strong>äºŒã€FastTextåŸç†</strong></h1><p>fastTextæ–¹æ³•åŒ…å«ä¸‰éƒ¨åˆ†ï¼Œ<strong>æ¨¡å‹æ¶æ„ï¼Œå±‚æ¬¡SoftMaxå’ŒN-gramç‰¹å¾ã€‚</strong></p><p><strong>2.1 æ¨¡å‹æ¶æ„</strong></p><p>fastTextçš„æ¶æ„å’Œword2vecä¸­çš„CBOWçš„æ¶æ„ç±»ä¼¼ï¼Œå› ä¸ºå®ƒä»¬çš„ä½œè€…éƒ½æ˜¯Facebookçš„ç§‘å­¦å®¶Tomas Mikolovï¼Œè€Œä¸”ç¡®å®fastTextä¹Ÿç®—æ˜¯words2vecæ‰€è¡ç”Ÿå‡ºæ¥çš„ã€‚</p><p>Continuous Bog-Of-Wordsï¼š</p><div class=pgc-img><img alt=æœºå™¨ä¸å­¦ä¹ ï¼šFastTextå…¥é—¨ä¸å®æˆ˜ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153344953341462c4cdd065><p class=pgc-img-caption></p></div><p><strong>fastText</strong></p><div class=pgc-img><img alt=æœºå™¨ä¸å­¦ä¹ ï¼šFastTextå…¥é—¨ä¸å®æˆ˜ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15334495564343533e51ef8><p class=pgc-img-caption></p></div><p>fastText æ¨¡å‹è¾“å…¥ä¸€ä¸ªè¯çš„åºåˆ—ï¼ˆä¸€æ®µæ–‡æœ¬æˆ–è€…ä¸€å¥è¯)ï¼Œè¾“å‡ºè¿™ä¸ªè¯åºåˆ—å±äºä¸åŒç±»åˆ«çš„æ¦‚ç‡ã€‚</p><p>åºåˆ—ä¸­çš„è¯å’Œè¯ç»„ç»„æˆç‰¹å¾å‘é‡ï¼Œç‰¹å¾å‘é‡é€šè¿‡çº¿æ€§å˜æ¢æ˜ å°„åˆ°ä¸­é—´å±‚ï¼Œä¸­é—´å±‚å†æ˜ å°„åˆ°æ ‡ç­¾ã€‚</p><p>fastText åœ¨é¢„æµ‹æ ‡ç­¾æ—¶ä½¿ç”¨äº†éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œä½†åœ¨ä¸­é—´å±‚ä¸ä½¿ç”¨éçº¿æ€§æ¿€æ´»å‡½æ•°ã€‚fastText æ¨¡å‹æ¶æ„å’Œ Word2Vec ä¸­çš„ CBOW æ¨¡å‹å¾ˆç±»ä¼¼ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼ŒfastText é¢„æµ‹æ ‡ç­¾ï¼Œè€Œ CBOW æ¨¡å‹é¢„æµ‹ä¸­é—´è¯ã€‚</p><p><strong>2.2 å±‚æ¬¡SoftMax</strong></p><p>å¯¹äºæœ‰å¤§é‡ç±»åˆ«çš„æ•°æ®é›†ï¼ŒfastTextä½¿ç”¨äº†ä¸€ä¸ªåˆ†å±‚åˆ†ç±»å™¨ï¼ˆè€Œéæ‰å¹³å¼æ¶æ„ï¼‰ã€‚ä¸åŒçš„ç±»åˆ«è¢«æ•´åˆè¿›æ ‘å½¢ç»“æ„ä¸­ï¼ˆæƒ³è±¡ä¸‹äºŒå‰æ ‘è€Œé listï¼‰ã€‚åœ¨æŸäº›æ–‡æœ¬åˆ†ç±»ä»»åŠ¡ä¸­ç±»åˆ«å¾ˆå¤šï¼Œè®¡ç®—çº¿æ€§åˆ†ç±»å™¨çš„å¤æ‚åº¦é«˜ã€‚ä¸ºäº†æ”¹å–„è¿è¡Œæ—¶é—´ï¼ŒfastText æ¨¡å‹ä½¿ç”¨äº†å±‚æ¬¡ Softmax æŠ€å·§ã€‚å±‚æ¬¡ Softmax æŠ€å·§å»ºç«‹åœ¨å“ˆå¼—æ›¼ç¼–ç çš„åŸºç¡€ä¸Šï¼Œå¯¹æ ‡ç­¾è¿›è¡Œç¼–ç ï¼Œèƒ½å¤Ÿæå¤§åœ°ç¼©å°æ¨¡å‹é¢„æµ‹ç›®æ ‡çš„æ•°é‡ã€‚</p><p>fastText ä¹Ÿåˆ©ç”¨äº†ç±»åˆ«ï¼ˆclassï¼‰ä¸å‡è¡¡è¿™ä¸ªäº‹å®ï¼ˆä¸€äº›ç±»åˆ«å‡ºç°æ¬¡æ•°æ¯”å…¶ä»–çš„æ›´å¤šï¼‰ï¼Œé€šè¿‡ä½¿ç”¨ Huffman ç®—æ³•å»ºç«‹ç”¨äºè¡¨å¾ç±»åˆ«çš„æ ‘å½¢ç»“æ„ã€‚å› æ­¤ï¼Œé¢‘ç¹å‡ºç°ç±»åˆ«çš„æ ‘å½¢ç»“æ„çš„æ·±åº¦è¦æ¯”ä¸é¢‘ç¹å‡ºç°ç±»åˆ«çš„æ ‘å½¢ç»“æ„çš„æ·±åº¦è¦å°ï¼Œè¿™ä¹Ÿä½¿å¾—è¿›ä¸€æ­¥çš„è®¡ç®—æ•ˆç‡æ›´é«˜ã€‚</p><div class=pgc-img><img alt=æœºå™¨ä¸å­¦ä¹ ï¼šFastTextå…¥é—¨ä¸å®æˆ˜ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15334496003899cec119d1f><p class=pgc-img-caption></p></div><p><strong>2.3 N-gramç‰¹å¾</strong></p><p>fastText å¯ä»¥ç”¨äºæ–‡æœ¬åˆ†ç±»å’Œå¥å­åˆ†ç±»ã€‚ä¸ç®¡æ˜¯æ–‡æœ¬åˆ†ç±»è¿˜æ˜¯å¥å­åˆ†ç±»ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„ç‰¹å¾æ˜¯è¯è¢‹æ¨¡å‹ã€‚ä½†è¯è¢‹æ¨¡å‹ä¸èƒ½è€ƒè™‘è¯ä¹‹é—´çš„é¡ºåºï¼Œå› æ­¤ fastText è¿˜åŠ å…¥äº† N-gram ç‰¹å¾ã€‚â€œæˆ‘ çˆ± å¥¹â€ è¿™å¥è¯ä¸­çš„è¯è¢‹æ¨¡å‹ç‰¹å¾æ˜¯ â€œæˆ‘â€ï¼Œâ€œçˆ±â€, â€œå¥¹â€ã€‚è¿™äº›ç‰¹å¾å’Œå¥å­ â€œå¥¹ çˆ± æˆ‘â€ çš„ç‰¹å¾æ˜¯ä¸€æ ·çš„ã€‚å¦‚æœåŠ å…¥ 2-Ngramï¼Œç¬¬ä¸€å¥è¯çš„ç‰¹å¾è¿˜æœ‰ â€œæˆ‘-çˆ±â€ å’Œ â€œçˆ±-å¥¹â€ï¼Œè¿™ä¸¤å¥è¯ â€œæˆ‘ çˆ± å¥¹â€ å’Œ â€œå¥¹ çˆ± æˆ‘â€ å°±èƒ½åŒºåˆ«å¼€æ¥äº†ã€‚å½“ç„¶å•¦ï¼Œä¸ºäº†æé«˜æ•ˆç‡ï¼Œæˆ‘ä»¬éœ€è¦è¿‡æ»¤æ‰ä½é¢‘çš„ N-gramã€‚</p><h1><strong>ä¸‰ã€ åŸºäºfastTextå®ç°æ–‡æœ¬åˆ†ç±»</strong></h1><p><strong>3.1 fastTextæœ‰ç›‘ç£å­¦ä¹ åˆ†ç±»</strong></p><p>fastTextåšæ–‡æœ¬åˆ†ç±»è¦æ±‚æ–‡æœ¬æ˜¯å¦‚ä¸‹çš„å­˜å‚¨å½¢å¼ï¼š</p><p>__label__2 , birchas chaim , yeshiva birchas chaim is a orthodox jewish mesivta high school in lakewood township new jersey . it was founded by rabbi shmuel zalmen stein in 2001 after his father rabbi chaim stein asked him to open a branch of telshe yeshiva in lakewood . as of the 2009-10 school year the school had an enrollment of 76 students and 6 . 6 classroom teachers ( on a fte basis ) for a studentâ€“teacher ratio of 11 . 5 1 .</p><p>__label__6 , motor torpedo boat pt-41 , motor torpedo boat pt-41 was a pt-20-class motor torpedo boat of the united states navy built by the electric launch company of bayonne new jersey . the boat was laid down as motor boat submarine chaser ptc-21 but was reclassified as pt-41 prior to its launch on 8 july 1941 and was completed on 23 july 1941 .</p><p>__label__11 , passiflora picturata , passiflora picturata is a species of passion flower in the passifloraceae family .</p><p>__label__13 , naya din nai raat , naya din nai raat is a 1974 bollywood drama film directed by a . bhimsingh . the film is famous as sanjeev kumar reprised the nine-role epic performance by sivaji ganesan in navarathri ( 1964 ) which was also previously reprised by akkineni nageswara rao in navarathri ( telugu 1966 ) . this film had enhanced his status and reputation as an actor in hindi cinema .</p><p>å…¶ä¸­å‰é¢çš„<strong>label</strong>æ˜¯å‰ç¼€ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰ï¼Œ<strong>label</strong>åæ¥çš„ä¸ºç±»åˆ«ã€‚</p><p>å…·ä½“ä»£ç ï¼š</p><p># -*- coding:utf-8 -*-</p><p>import pandas as pd</p><p>import random</p><p>import fasttext</p><p>import jieba</p><p>from sklearn.model_selection import train_test_split</p><p>cate_dic = {'technology': 1, 'car': 2, 'entertainment': 3, 'military': 4, 'sports': 5}</p><p>"""</p><p>å‡½æ•°è¯´æ˜ï¼šåŠ è½½æ•°æ®</p><p>"""</p><p>def loadData():</p><p>#åˆ©ç”¨pandasæŠŠæ•°æ®è¯»è¿›æ¥</p><p>df_technology = pd.read_csv("./data/technology_news.csv",encoding ="utf-8")</p><p>df_technology=df_technology.dropna() #å»ç©ºè¡Œå¤„ç†</p><p>df_car = pd.read_csv("./data/car_news.csv",encoding ="utf-8")</p><p>df_car=df_car.dropna()</p><p>df_entertainment = pd.read_csv("./data/entertainment_news.csv",encoding ="utf-8")</p><p>df_entertainment=df_entertainment.dropna()</p><p>df_military = pd.read_csv("./data/military_news.csv",encoding ="utf-8")</p><p>df_military=df_military.dropna()</p><p>df_sports = pd.read_csv("./data/sports_news.csv",encoding ="utf-8")</p><p>df_sports=df_sports.dropna()</p><p>technology=df_technology.content.values.tolist()[1000:21000]</p><p>car=df_car.content.values.tolist()[1000:21000]</p><p>entertainment=df_entertainment.content.values.tolist()[:20000]</p><p>military=df_military.content.values.tolist()[:20000]</p><p>sports=df_sports.content.values.tolist()[:20000]</p><p>return technology,car,entertainment,military,sports</p><p>"""</p><p>å‡½æ•°è¯´æ˜ï¼šåœç”¨è¯</p><p>å‚æ•°è¯´æ˜ï¼š</p><p>datapathï¼šåœç”¨è¯è·¯å¾„</p><p>è¿”å›å€¼ï¼š</p><p>stopwords:åœç”¨è¯</p><p>"""</p><p>def getStopWords(datapath):</p><p>stopwords=pd.read_csv(datapath,index_col=False,quoting=3,sep="\t",names=['stopword'], encoding='utf-8')</p><p>stopwords=stopwords["stopword"].values</p><p>return stopwords</p><p>"""</p><p>å‡½æ•°è¯´æ˜ï¼šå»åœç”¨è¯</p><p>å‚æ•°ï¼š</p><p>content_lineï¼šæ–‡æœ¬æ•°æ®</p><p>sentencesï¼šå­˜å‚¨çš„æ•°æ®</p><p>categoryï¼šæ–‡æœ¬ç±»åˆ«</p><p>"""</p><p>def preprocess_text(content_line,sentences,category,stopwords):</p><p>for line in content_line:</p><p>try:</p><p>segs=jieba.lcut(line) #åˆ©ç”¨ç»“å·´åˆ†è¯è¿›è¡Œä¸­æ–‡åˆ†è¯</p><p>segs=filter(lambda x:len(x)>1,segs) #å»æ‰é•¿åº¦å°äº1çš„è¯</p><p>segs=filter(lambda x:x not in stopwords,segs) #å»æ‰åœç”¨è¯</p><p>sentences.append("__lable__"+str(category)+" , "+" ".join(segs)) #æŠŠå½“å‰çš„æ–‡æœ¬å’Œå¯¹åº”çš„ç±»åˆ«æ‹¼æ¥èµ·æ¥ï¼Œç»„åˆæˆfasttextçš„æ–‡æœ¬æ ¼å¼</p><p>except Exception as e:</p><p>print (line)</p><p>continue</p><p>"""</p><p>å‡½æ•°è¯´æ˜ï¼šæŠŠå¤„ç†å¥½çš„å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œå¤‡ç”¨</p><p>å‚æ•°è¯´æ˜ï¼š</p><p>"""</p><p>def writeData(sentences,fileName):</p><p>print("writing data to fasttext format...")</p><p>out=open(fileName,'w')</p><p>for sentence in sentences:</p><p>out.write(sentence.encode('utf8')+"\n")</p><p>print("done!")</p><p>"""</p><p>å‡½æ•°è¯´æ˜ï¼šæ•°æ®å¤„ç†</p><p>"""</p><p>def preprocessData(stopwords,saveDataFile):</p><p>technology,car,entertainment,military,sports=loadData()</p><p>#å»åœç”¨è¯ï¼Œç”Ÿæˆæ•°æ®é›†</p><p>sentences=[]</p><p>preprocess_text(technology,sentences,cate_dic["technology"],stopwords)</p><p>preprocess_text(car,sentences,cate_dic["car"],stopwords)</p><p>preprocess_text(entertainment,sentences,cate_dic["entertainment"],stopwords)</p><p>preprocess_text(military,sentences,cate_dic["military"],stopwords)</p><p>preprocess_text(sports,sentences,cate_dic["sports"],stopwords)</p><p>random.shuffle(sentences) #åšä¹±åºå¤„ç†ï¼Œä½¿å¾—åŒç±»åˆ«çš„æ ·æœ¬ä¸è‡³äºæ‰å †</p><p>writeData(sentences,saveDataFile)</p><p>if __name__=="__main__":</p><p>stopwordsFile=r"./data/stopwords.txt"</p><p>stopwords=getStopWords(stopwordsFile)</p><p>saveDataFile=r'train_data.txt'</p><p>preprocessData(stopwords,saveDataFile)</p><p>#fasttext.supervised():æœ‰ç›‘ç£çš„å­¦ä¹ </p><p>classifier=fasttext.supervised(saveDataFile,'classifier.model',lable_prefix='__lable__')</p><p>result = classifier.test(saveDataFile)</p><p>print("P@1:",result.precision) #å‡†ç¡®ç‡</p><p>print("R@2:",result.recall) #å¬å›ç‡</p><p>print("Number of examples:",result.nexamples) #é¢„æµ‹é”™çš„ä¾‹å­</p><p>#å®é™…é¢„æµ‹</p><p>lable_to_cate={1:'technology'.1:'car',3:'entertainment',4:'military',5:'sports'}</p><p>texts=['ä¸­æ–°ç½‘ æ—¥ç”µ 2018 é¢„èµ› äºšæ´²åŒº å¼ºèµ› ä¸­å›½é˜Ÿ éŸ©å›½é˜Ÿ è¾ƒé‡ æ¯”èµ› ä¸ŠåŠåœº åˆ†é’Ÿ ä¸»åœº ä½œæˆ˜ ä¸­å›½é˜Ÿ ç‡å…ˆ æ‰“ç ´ åœºä¸Š åƒµå±€ åˆ©ç”¨ è§’çƒ æœºä¼š å¤§å® å‰ç‚¹ æ”»é—¨ å¾—æ‰‹ ä¸­å›½é˜Ÿ é¢†å…ˆ']</p><p>lables=classifier.predict(texts)</p><p>print(lables)</p><p>print(lable_to_cate[int(lables[0][0])])</p><p>#è¿˜å¯ä»¥å¾—åˆ°ç±»åˆ«+æ¦‚ç‡</p><p>lables=classifier.predict_proba(texts)</p><p>print(lables)</p><p>#è¿˜å¯ä»¥å¾—åˆ°å‰kä¸ªç±»åˆ«</p><p>lables=classifier.predict(textsï¼Œk=3)</p><p>print(lables)</p><p>#è¿˜å¯ä»¥å¾—åˆ°å‰kä¸ªç±»åˆ«+æ¦‚ç‡</p><p>lables=classifier.predict_proba(textsï¼Œk=3)</p><p>print(lables)</p><p><strong>3.2 fastTextæœ‰ç›‘ç£å­¦ä¹ åˆ†ç±»</strong></p><p># -*- coding:utf-8 -*-</p><p>import pandas as pd</p><p>import random</p><p>import fasttext</p><p>import jieba</p><p>from sklearn.model_selection import train_test_split</p><p>cate_dic = {'technology': 1, 'car': 2, 'entertainment': 3, 'military': 4, 'sports': 5}</p><p>"""</p><p>å‡½æ•°è¯´æ˜ï¼šåŠ è½½æ•°æ®</p><p>"""</p><p>def loadData():</p><p>#åˆ©ç”¨pandasæŠŠæ•°æ®è¯»è¿›æ¥</p><p>df_technology = pd.read_csv("./data/technology_news.csv",encoding ="utf-8")</p><p>df_technology=df_technology.dropna() #å»ç©ºè¡Œå¤„ç†</p><p>df_car = pd.read_csv("./data/car_news.csv",encoding ="utf-8")</p><p>df_car=df_car.dropna()</p><p>df_entertainment = pd.read_csv("./data/entertainment_news.csv",encoding ="utf-8")</p><p>df_entertainment=df_entertainment.dropna()</p><p>df_military = pd.read_csv("./data/military_news.csv",encoding ="utf-8")</p><p>df_military=df_military.dropna()</p><p>df_sports = pd.read_csv("./data/sports_news.csv",encoding ="utf-8")</p><p>df_sports=df_sports.dropna()</p><p>technology=df_technology.content.values.tolist()[1000:21000]</p><p>car=df_car.content.values.tolist()[1000:21000]</p><p>entertainment=df_entertainment.content.values.tolist()[:20000]</p><p>military=df_military.content.values.tolist()[:20000]</p><p>sports=df_sports.content.values.tolist()[:20000]</p><p>return technology,car,entertainment,military,sports</p><p>"""</p><p>å‡½æ•°è¯´æ˜ï¼šåœç”¨è¯</p><p>å‚æ•°è¯´æ˜ï¼š</p><p>datapathï¼šåœç”¨è¯è·¯å¾„</p><p>è¿”å›å€¼ï¼š</p><p>stopwords:åœç”¨è¯</p><p>"""</p><p>def getStopWords(datapath):</p><p>stopwords=pd.read_csv(datapath,index_col=False,quoting=3,sep="\t",names=['stopword'], encoding='utf-8')</p><p>stopwords=stopwords["stopword"].values</p><p>return stopwords</p><p>"""</p><p>å‡½æ•°è¯´æ˜ï¼šå»åœç”¨è¯</p><p>å‚æ•°ï¼š</p><p>content_lineï¼šæ–‡æœ¬æ•°æ®</p><p>sentencesï¼šå­˜å‚¨çš„æ•°æ®</p><p>categoryï¼šæ–‡æœ¬ç±»åˆ«</p><p>"""</p><p>def preprocess_text(content_line,sentences,stopwords):</p><p>for line in content_line:</p><p>try:</p><p>segs=jieba.lcut(line) #åˆ©ç”¨ç»“å·´åˆ†è¯è¿›è¡Œä¸­æ–‡åˆ†è¯</p><p>segs=filter(lambda x:len(x)>1,segs) #å»æ‰é•¿åº¦å°äº1çš„è¯</p><p>segs=filter(lambda x:x not in stopwords,segs) #å»æ‰åœç”¨è¯</p><p>sentences.append(" ".join(segs))</p><p>except Exception as e:</p><p>print (line)</p><p>continue</p><p>"""</p><p>å‡½æ•°è¯´æ˜ï¼šæŠŠå¤„ç†å¥½çš„å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œå¤‡ç”¨</p><p>å‚æ•°è¯´æ˜ï¼š</p><p>"""</p><p>def writeData(sentences,fileName):</p><p>print("writing data to fasttext format...")</p><p>out=open(fileName,'w')</p><p>for sentence in sentences:</p><p>out.write(sentence.encode('utf8')+"\n")</p><p>print("done!")</p><p>"""</p><p>å‡½æ•°è¯´æ˜ï¼šæ•°æ®å¤„ç†</p><p>"""</p><p>def preprocessData(stopwords,saveDataFile):</p><p>technology,car,entertainment,military,sports=loadData()</p><p>#å»åœç”¨è¯ï¼Œç”Ÿæˆæ•°æ®é›†</p><p>sentences=[]</p><p>preprocess_text(technology,sentences,stopwords)</p><p>preprocess_text(car,sentences,stopwords)</p><p>preprocess_text(entertainment,sentences,stopwords)</p><p>preprocess_text(military,sentences,stopwords)</p><p>preprocess_text(sports,sentences,stopwords)</p><p>random.shuffle(sentences) #åšä¹±åºå¤„ç†ï¼Œä½¿å¾—åŒç±»åˆ«çš„æ ·æœ¬ä¸è‡³äºæ‰å †</p><p>writeData(sentences,saveDataFile)</p><p>if __name__=="__main__":</p><p>stopwordsFile=r"./data/stopwords.txt"</p><p>stopwords=getStopWords(stopwordsFile)</p><p>saveDataFile=r'unsupervised_train_data.txt'</p><p>preprocessData(stopwords,saveDataFile)</p><p>#fasttext.load_model:ä¸ç®¡æ˜¯æœ‰ç›‘ç£è¿˜æ˜¯æ— ç›‘ç£çš„ï¼Œéƒ½æ˜¯è½½å…¥ä¸€ä¸ªæ¨¡å‹</p><p>#fasttext.skipgram(),fasttext.cbow()éƒ½æ˜¯æ— ç›‘ç£çš„ï¼Œç”¨æ¥è®­ç»ƒè¯å‘é‡çš„</p><p>model=fasttext.skipgram('unsupervised_train_data.txt','model')</p><p>print(model.words) #æ‰“å°è¯å‘é‡</p><p>#cbow model</p><p>model=fasttext.cbow('unsupervised_train_data.txt','model')</p><p>print(model.words) #æ‰“å°è¯å‘é‡</p><h1><strong>ä¸‰ã€æ€»ç»“</strong></h1><p><strong>3.1 fastTextå’Œword2vecçš„åŒºåˆ«</strong></p><p>ç›¸ä¼¼å¤„ï¼š</p><ol><li>å›¾æ¨¡å‹ç»“æ„å¾ˆåƒï¼Œéƒ½æ˜¯é‡‡ç”¨embeddingå‘é‡çš„å½¢å¼ï¼Œå¾—åˆ°wordçš„éšå‘é‡è¡¨è¾¾ã€‚</li><li>éƒ½é‡‡ç”¨å¾ˆå¤šç›¸ä¼¼çš„ä¼˜åŒ–æ–¹æ³•ï¼Œæ¯”å¦‚ä½¿ç”¨Hierarchical softmaxä¼˜åŒ–è®­ç»ƒå’Œé¢„æµ‹ä¸­çš„æ‰“åˆ†é€Ÿåº¦ã€‚</li></ol><p>ä¸åŒå¤„ï¼š</p><ol><li>æ¨¡å‹çš„è¾“å‡ºå±‚ï¼šword2vecçš„è¾“å‡ºå±‚ï¼Œå¯¹åº”çš„æ˜¯æ¯ä¸€ä¸ªtermï¼Œè®¡ç®—æŸtermçš„æ¦‚ç‡æœ€å¤§ï¼›è€Œfasttextçš„è¾“å‡ºå±‚å¯¹åº”çš„æ˜¯ åˆ†ç±»çš„labelã€‚ä¸è¿‡ä¸ç®¡è¾“å‡ºå±‚å¯¹åº”çš„æ˜¯ä»€ä¹ˆå†…å®¹ï¼Œèµ·å¯¹åº”çš„vectoréƒ½ä¸ä¼šè¢«ä¿ç•™å’Œä½¿ç”¨ï¼›</li><li>æ¨¡å‹çš„è¾“å…¥å±‚ï¼šword2vecçš„è¾“å‡ºå±‚ï¼Œæ˜¯ context window å†…çš„termï¼›è€Œfasttext å¯¹åº”çš„æ•´ä¸ªsentenceçš„å†…å®¹ï¼ŒåŒ…æ‹¬termï¼Œä¹ŸåŒ…æ‹¬ n-gramçš„å†…å®¹ï¼›</li></ol><p>ä¸¤è€…æœ¬è´¨çš„ä¸åŒï¼Œä½“ç°åœ¨ h-softmaxçš„ä½¿ç”¨ï¼š</p><ul><li>Wordvecçš„ç›®çš„æ˜¯å¾—åˆ°è¯å‘é‡ï¼Œè¯¥è¯å‘é‡ æœ€ç»ˆæ˜¯åœ¨è¾“å…¥å±‚å¾—åˆ°ï¼Œè¾“å‡ºå±‚å¯¹åº”çš„ h-softmax</li><li>ä¹Ÿä¼šç”Ÿæˆä¸€ç³»åˆ—çš„å‘é‡ï¼Œä½†æœ€ç»ˆéƒ½è¢«æŠ›å¼ƒï¼Œä¸ä¼šä½¿ç”¨ã€‚</li><li>fasttextåˆ™å……åˆ†åˆ©ç”¨äº†h-softmaxçš„åˆ†ç±»åŠŸèƒ½ï¼Œéå†åˆ†ç±»æ ‘çš„æ‰€æœ‰å¶èŠ‚ç‚¹ï¼Œæ‰¾åˆ°æ¦‚ç‡æœ€å¤§çš„labelï¼ˆä¸€ä¸ªæˆ–è€…Nä¸ªï¼‰</li></ul><p><strong>3.2 å°ç»“</strong></p><p>æ€»çš„æ¥è¯´ï¼ŒfastTextçš„å­¦ä¹ é€Ÿåº¦æ¯”è¾ƒå¿«ï¼Œæ•ˆæœè¿˜ä¸é”™ã€‚fastTexté€‚ç”¨ä¸åˆ†ç±»ç±»åˆ«éå¸¸å¤§è€Œä¸”æ•°æ®é›†è¶³å¤Ÿå¤šçš„æƒ…å†µï¼Œå½“åˆ†ç±»ç±»åˆ«æ¯”è¾ƒå°æˆ–è€…æ•°æ®é›†æ¯”è¾ƒå°‘çš„è¯ï¼Œå¾ˆå®¹æ˜“è¿‡æ‹Ÿåˆã€‚</p><p>å¯ä»¥å®Œæˆæ— ç›‘ç£çš„è¯å‘é‡çš„å­¦ä¹ ï¼Œå¯ä»¥å­¦ä¹ å‡ºæ¥è¯å‘é‡ï¼Œæ¥ä¿æŒä½è¯å’Œè¯ä¹‹é—´ï¼Œç›¸å…³è¯ä¹‹é—´æ˜¯ä¸€ä¸ªè·ç¦»æ¯”è¾ƒè¿‘çš„æƒ…å†µï¼›</p><p>ä¹Ÿå¯ä»¥ç”¨äºæœ‰ç›‘ç£å­¦ä¹ çš„æ–‡æœ¬åˆ†ç±»ä»»åŠ¡ï¼Œï¼ˆæ–°é—»æ–‡æœ¬åˆ†ç±»ï¼Œåƒåœ¾é‚®ä»¶åˆ†ç±»ã€æƒ…æ„Ÿåˆ†æä¸­æ–‡æœ¬æƒ…æ„Ÿåˆ†æï¼Œç”µå•†ä¸­ç”¨æˆ·è¯„è®ºçš„è¤’è´¬åˆ†æï¼‰</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'æœºå™¨','ä¸å­¦ä¹ ','FastText'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>