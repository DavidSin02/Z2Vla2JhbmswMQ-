<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>python自动化办公：玩转word之页眉页脚秘笈 | 极客快訊</title><meta property="og:title" content="python自动化办公：玩转word之页眉页脚秘笈 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/dfic-imagehandler/fc19d46c-ce11-44c6-bff3-ad95969a640b"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/eb41e5b.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/eb41e5b.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/eb41e5b.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/eb41e5b.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/eb41e5b.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/eb41e5b.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/eb41e5b.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/eb41e5b.html><meta property="article:published_time" content="2020-10-29T21:06:55+08:00"><meta property="article:modified_time" content="2020-10-29T21:06:55+08:00"><meta name=Keywords content><meta name=description content="python自动化办公：玩转word之页眉页脚秘笈"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/eb41e5b.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>python自动化办公：玩转word之页眉页脚秘笈</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>接上节<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6683481468951331341/?group_id=6683481468951331341" target=_blank>python办公自动化:自动进行word文档处理和排版</a>,本节将就python操作word的页眉页脚技巧做深入介绍。</p><p><strong>使用页眉和页脚</strong></p><div class=pgc-img><img alt=python自动化办公：玩转word之页眉页脚秘笈 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/dfic-imagehandler/fc19d46c-ce11-44c6-bff3-ad95969a640b><p class=pgc-img-caption>python操作word的页眉页脚技巧做深入介绍</p></div><p>Word支持<em>页眉</em>和<em>页脚</em>。页眉是出现在每个页面的上边距区域中的文本，与文本主体分开，并且通常传达上下文信息，例如文档标题，作者，创建日期或页码。文档中的页眉在页面之间是相同的，内容上只有很小的差异，例如更改部分标题或页码。页眉也称为<em>运行头</em>。</p><p>一个<em>页面页脚</em>中的每个日日夜夜，只不过它出现在页面底部的页头类似。它不应与脚注混淆，脚注在页面之间不一致。为了简洁起见，这里经常使用术语<em>标题</em>来指代可以是页眉或页脚对象的内容，信任读者以理解它对两种对象类型的适用性。</p><p><strong>访问节的标题</strong></p><p>页眉和页脚与一个<em>部分</em>相关联; 这允许每个部分具有不同的页眉和/或页脚。例如，横向部分可能具有比纵向部分更宽的标题。</p><p>每个section对象都有一个.header属性，提供对该节的对象的访问：</p><p><strong>>>> </strong>document = Document()</p><p><strong>>>> </strong>section = document.sections[0]</p><p><strong>>>> </strong>header = section.header</p><p><strong>>>> </strong>header</p><p>&lt;docx.section._Header object at 0x...></p><p>甲目的是<em>总是</em>存在于Section.header，即使当没有报头该节限定。实际标头定义的存在表示为_Header.is_linked_to_previous：</p><p><strong>>>> </strong>header.is_linked_to_previous</p><p>True</p><p>值为True表示对象不包含标题定义，该节将显示与上一节相同的标题。这种"继承"行为是递归的，因此"链接"标题实际上从具有标题定义的第一个前一部分获得其定义。此"链接"状态在Word UI中显示为 <em>"与以前相同"</em>。</p><p>新文档没有标题（在它包含的单个部分），因此 .is_linked_to_previous就是True这种情况。请注意，这种情况可能有点违反直觉，因为<em>没有</em>要链接的<em>前一个节头</em>。在此"无前一个标题"的情况下，不显示标题。</p><p><strong>添加标题（简单情况）</strong></p><p>只需编辑 对象的内容即可将标题添加到新文档中。一个对象是一个"故事"容器及其内容进行编辑，就像一个对象。请注意，与新文档一样，新标题已包含单个（空）段落：</p><p><strong>>>> </strong>paragraph = header.paragraphs[0]</p><p><strong>>>> </strong>paragraph.text = "Title of my document"</p><div class=pgc-img><img alt=python自动化办公：玩转word之页眉页脚秘笈 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3a8d8676995540949453576792b8d1a0><p class=pgc-img-caption>添加内容（甚至只是访问header.paragraphs）的行为添加了标头定义并</p></div><p>另请注意，添加内容（甚至只是访问header.paragraphs）的行为添加了标头定义并更改了以下状态.is_linked_to_previous：</p><p><strong>>>> </strong>header.is_linked_to_previous</p><p>False</p><p><strong>添加"分区"标题内容</strong></p><p>具有多个"区域"的标题通常使用精心放置的制表位来完成。中心和右对齐"区域"所需的制表位是HeaderWord中潜在样式的一部分 ，但该样式不存在于默认python-docx 模板中，需要添加：</p><p><strong>>>> from</strong> <strong>docx.enum.style</strong> <strong>import</strong> WD_STYLE_TYPE</p><p><strong>>>> from</strong> <strong>docx.enum.text</strong> <strong>import</strong> WD_TAB_ALIGNMENT</p><p><strong>>>> </strong>styles = document.styles</p><p><strong>>>> </strong>style = styles.add_style("Header", WD_STYLE_TYPE.PARAGRAPH)</p><p><strong>>>> </strong>style.base_style = styles["Normal"]</p><p><strong>>>> </strong>tab_stops = style.paragraph_format.tab_stops</p><p><strong>>>> </strong>tab_stops.add_tab_stop(Inches(3.25), WD_TAB_ALIGNMENT.CENTER)</p><p><strong>>>> </strong>tab_stops.add_tab_stop(Inches(6.5), WD_TAB_ALIGNMENT.RIGHT)</p><p>如果您使用的是自定义模板而不是<em>python-docx</em>默认模板，那么在模板中定义该样式可能是有意义的。</p><p>一旦Header式存在时，突片用于分离左，中和右对齐头内容：</p><p><strong>>>> </strong>paragraph = header.paragraphs[0]</p><p><strong>>>> </strong>paragraph.text = "Left Text<strong>\t</strong>Center Text<strong>\t</strong>Right Text"</p><p><strong>>>> </strong>paragraph.style = document.styles["Header"]</p><div class=pgc-img><img alt=python自动化办公：玩转word之页眉页脚秘笈 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2a8004d8fa754138a00882c5e02ac4c2><p class=pgc-img-caption>突片用于分离左，中和右对齐头内容：</p></div><p><strong>删除标题</strong></p><p>可以通过分配True其 .is_linked_to_previous属性来删除不需要的标头：</p><p><strong>>>> </strong>header.is_linked_to_previous = <strong>True</strong></p><p><strong>>>> </strong>header.is_linked_to_previous</p><p>True</p><p>True分配给 标题时，标题的内容将被不可逆转地删除.is_linked_to_previous。</p><p><strong>理解多节文档中的标题</strong></p><p>"刚开始编辑"方法适用于简单的情况，但为了理解多节文档中的标题行为，一些简单的概念将有所帮助。简而言之：</p><p>1. 每个部分都可以有自己的标头定义（但不必）。</p><p>2. 缺少标头定义的部分会继承之前部分的标头。当存在定义而不存在_Header.is_linked_to_previous定义时，该属性仅反映标头定义的False存在True。</p><p>3. 缺少标头定义是默认状态。新文档没有已定义的标题，也没有新插入的部分。.is_linked_to_previous报告 True这两种情况。</p><p>4. 如果_Header对象的内容具有标题定义，则它是自己的内容。如果不是，它的内容是第一现有节的<em>不</em>具有标题的定义。如果没有节具有标题定义，则在第一节中添加新节，并且所有其他节继承该节。这种添加标头定义是在第一次访问标头内容时发生的，可能是通过引用 header.paragraphs。</p><p><strong>添加标题定义（一般情况）</strong></p><p>可以通过赋予False其.is_linked_to_previous属性来为缺少一个节的节提供显式标头定义 ：</p><p><strong>>>> </strong>header.is_linked_to_previous</p><p>True</p><p><strong>>>> </strong>header.is_linked_to_previous = <strong>False</strong></p><p><strong>>>> </strong>header.is_linked_to_previous</p><p>False</p><p>新添加的标头定义包含一个空段落。请注意，以这种方式保留标题偶尔会有用，因为它有效地"关闭"该部分的标题以及之后的标题，直到具有已定义标题的下一部分。</p><p>分配False给.is_linked_to_previous已具有标头定义的标头不会执行任何操作。</p><p><strong>自动定位继承的内容</strong></p><p>编辑标题的内容会编辑<em>源</em>标题的内容，同时考虑任何"继承"。因此，例如，如果第2节标题继承自第1节并且您编辑第2节标题，则实际上更改了第1节标题的内容。除非您首先明确指定False其.is_linked_to_previous属性，否则不会为第2节添加新的标头定义。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'python','自动化','办公'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>