<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Excel用定义名称、万金油公式制作查询器，可模糊、不同字段查找 | 极客快訊</title><meta property="og:title" content="Excel用定义名称、万金油公式制作查询器，可模糊、不同字段查找 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/9489eafdf0fc4fb184fe7cbfbc4f6f8a"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ec4cea87.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ec4cea87.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/ec4cea87.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ec4cea87.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ec4cea87.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/ec4cea87.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/ec4cea87.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ec4cea87.html><meta property="article:published_time" content="2020-11-14T21:01:02+08:00"><meta property="article:modified_time" content="2020-11-14T21:01:02+08:00"><meta name=Keywords content><meta name=description content="Excel用定义名称、万金油公式制作查询器，可模糊、不同字段查找"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/ec4cea87.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Excel用定义名称、万金油公式制作查询器，可模糊、不同字段查找</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>之前写过一篇文章<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6823645775445099011/?group_id=6823645775445099011" rel="noopener noreferrer" target=_blank>Excel表格使用公式制作信息查询器（可模糊查找、不同字段查找）</a>，有粉丝朋友说公式太长太复杂看不太明白，希望我可以分享一个更容易理解的方法制作一个信息查询器。今天就为朋友们分享一种使用定义名称和万金油公式制作信息查询器的方法。</p><p><strong>一.效果图</strong></p><p>还是先给朋友们看一张动态效果图看看这个信息查询器的神奇之处（与之前的效果一样只是公式更简单容易理解）。</p><div class=pgc-img><img alt=Excel用定义名称、万金油公式制作查询器，可模糊、不同字段查找 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9489eafdf0fc4fb184fe7cbfbc4f6f8a><p class=pgc-img-caption></p></div><p><br></p><p><strong>二.主要相关函数用法介绍</strong></p><p>1.Offset函数</p><p>(1)语法：</p><p>Offset(reference,rows,cols,height,width)</p><p>(2)各参数意义：</p><p>Reference：作为参照系的引用区域，其左上角单元格是是偏移量的起始位置；</p><p>Rows：相对于参照系左上角单元格，上下偏移的行数（向下为正，向上为负）；</p><p>Cols：相对于参照系左上角单元格，左右偏移的行数（向右为正，向左为负）；</p><p>Height：新引用区域的行数；</p><p>Width：新引用区域的列数。</p><p>（3）用法演示（本演示参考系为A1单元格，向下偏移2，向右偏移2，返回一个3行2列的单元格区域。）</p><div class=pgc-img><img alt=Excel用定义名称、万金油公式制作查询器，可模糊、不同字段查找 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b3c1a85acb6142afb895977063c27cfb><p class=pgc-img-caption></p></div><p><br></p><p>2.MATCH函数（在这里只用到第三个参数为0的精确匹配）</p><p>（1）语法：</p><p>MATCH(lookup_value, lookup_array, [match_type])</p><p>（2）各参数意义：</p><p>lookup_value 查找值，参数可以为值（数字、文本或逻辑值）或对数字、文本或逻辑值的单元格引用。</p><p>lookup_array 必需。 要搜索的单元格区域。</p><p>match_type 可选。 数字 -1、0 或 1。</p><p>3.INDEX函数（在这里只用到第一个参数为array形势，也就是数组形式）</p><p>（1）功能：</p><p>返回表或数组中元素的值，由行号和列号索引选择。</p><p>当函数 INDEX 的第一个参数为数组常量时，使用数组形式。</p><p>（2）语法</p><p>INDEX(array, row_num, [column_num])</p><p>(3)各参数意义：</p><p>array 必需。 单元格区域或数组常量。</p><p>如果数组只包含一行或一列，则相应的 row_num 或 column_num 参数是可选的。</p><p>（4）在这里只用到根据row_num返回一列数组里的元素。</p><p>（5）用法演示（本演示利用ROW()函数构造一个数字1、2、3...的序列返回A列对应的单元格内容）</p><div class=pgc-img><img alt=Excel用定义名称、万金油公式制作查询器，可模糊、不同字段查找 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8abfba98b2ed4877995a95511aad1bab><p class=pgc-img-caption></p></div><p><br></p><p>4.SMALL函数</p><p>语法：SMALL(array,k)</p><p>功能：返回array（通常是一个数组）中第K个最小值。</p><p>5.row（）函数</p><p>语法：ROW([reference])</p><p>功能：返回引用单元所在的行</p><p>6.ISNUMBER( )函数</p><p>语法：ISNUMBER([reference])</p><p>功能：判断是否为数字</p><p>7.FIND( )函数</p><p>(1)语法：FIND(find_text,within_text,start_num)</p><p>(2)各参数意义：</p><p>Find_text 是要查找的字符串。</p><p>Within_text 是包含要查找关键字的单元格。就是说要在这个单元格内查找关键字。</p><p>Start_num 指定开始进行查找的字符数。如果忽略 start_num，则假设其为 1。</p><p>（3）说明：找不到查找内容时返回错误值#VALUE!</p><p><br></p><p><strong>三.制作方法</strong></p><div class=pgc-img><img alt=Excel用定义名称、万金油公式制作查询器，可模糊、不同字段查找 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/50b4171aba714506971784c4cca9733b><p class=pgc-img-caption></p></div><p><br></p><p><strong>1.根据查找依据的字段值定义一个名称</strong></p><div class=pgc-img><img alt=Excel用定义名称、万金油公式制作查询器，可模糊、不同字段查找 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6ea758fbd87c4bbfab49850d94ad3c73><p class=pgc-img-caption></p></div><p><br></p><p>（1）在H2输入公式：</p><p>=OFFSET($A$1,0,MATCH($G$1,$A$1:$D$1,0)-1,COUNTA($A:$A),1)</p><p>（2）公式解析：</p><p>COUNTA($A:$A)函数返回A列非空单元格的个数；</p><p>MATCH($G$1,$A$1:$D$1,0)函数返回查找依据字段在原始数据表头的列数；</p><p>整个函数返回的是一个查找字段所在列所有数据构成的数组。</p><p>（3）定义名称时要在引用单元格的位置之前加上“工作表名！”</p><div class=pgc-img><img alt=Excel用定义名称、万金油公式制作查询器，可模糊、不同字段查找 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e606a82fed0e45ab9ceb4502434c486c><p class=pgc-img-caption></p></div><p><br></p><p>定义名称名字为：查找依据数组。</p><p>输入的公式为：</p><p>=OFFSET(信息表!$A$1,0,MATCH(信息表!$G$1,信息表!$A$1:$D$1,0)-1,COUNTA(信息表!$A:$A),1)</p><p><strong>2.输入公式查找</strong></p><p>（1）在H2输入公式：</p><p>=INDEX(A:A,SMALL(IF(ISNUMBER(FIND($G$2,查找依据数组)),ROW(查找依据数组),1000000),ROW(A1))) &""</p><p>（2）公式解析：</p><div class=pgc-img><img alt=Excel用定义名称、万金油公式制作查询器，可模糊、不同字段查找 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c8c5585d35264337854a84e8a733bd23><p class=pgc-img-caption></p></div><p><br></p><p>1.FIND($G$2,查找依据数组)，如果查找依据数组元素内包含G2单元格内容返回其位置，否则返回错误值，最终返回一个由数字和错误值构成的数组。</p><p>2.ISNUMBER(FIND($G$2,查找依据数组)，返回的是由逻辑值构成的数组。</p><p>3.IF(ISNUMBER(FIND($G$2,查找依据数组)),ROW(查找依据数组),1000000)，根据逻辑值构成的数组，当数值中的元素为true时，返回对应元素所在的行，当数值中的元素为FLASE时，返回对一个较大的数值1000000.（<strong class=highlight-text>这一步构造了数组元素与查找值匹配时返回其行数，否则返回一个较大值1000000</strong>）</p><div class=pgc-img><img alt=Excel用定义名称、万金油公式制作查询器，可模糊、不同字段查找 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/eb39c95a9ce74225b80f9b97d5044103><p class=pgc-img-caption></p></div><p><br></p><p>4.SMALL(IF(ISNUMBER(FIND($G$2,查找依据数组)),ROW(查找依据数组),1000000),ROW(A1))，ROW(A1)向下填充时返回一个数字1、2、3构成的序列，用SMALL函数依次返回数组中第1、2、3个最小值。（<strong class=highlight-text>这一步构造了数组元素与查找值匹配时其对应行数构造成的数组</strong>）</p><p>5.INDEX(A:A,SMALL(IF(ISNUMBER(FIND($G$2,查找依据数组)),ROW(查找依据数组),1000000),ROW(A1))) ，最终由INDEX分别提取之前构造的数组所对应的所有值。</p><p>6.公式最后的&””是所有元素匹配完成后继续向下填充公式会显示数字0，&””可以避免数字0的出现。</p><div class=pgc-img><img alt=Excel用定义名称、万金油公式制作查询器，可模糊、不同字段查找 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/af405cdeb3294fdfaceaa2409e2ec7b7><p class=pgc-img-caption></p></div><p><br></p><p><strong>四.注意事项：</strong></p><p><strong class=highlight-text>1.这里涉及众多数组公式，所以在确定公式时要同时按住Ctrl+Shift+Enter。</strong></p><p><strong class=highlight-text>2.注意单元格的引用方式，不要混淆绝对引用和相对引用。</strong></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Excel','用定','义名'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>