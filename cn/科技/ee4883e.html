<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>基于STM32和PCL6045BL的经编机电子横移系统设计 | 极客快訊</title><meta property="og:title" content="基于STM32和PCL6045BL的经编机电子横移系统设计 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/RCBj0rUWxdLEI"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ee4883e.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ee4883e.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/ee4883e.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ee4883e.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ee4883e.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/ee4883e.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/ee4883e.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ee4883e.html><meta property="article:published_time" content="2020-10-29T20:51:54+08:00"><meta property="article:modified_time" content="2020-10-29T20:51:54+08:00"><meta name=Keywords content><meta name=description content="基于STM32和PCL6045BL的经编机电子横移系统设计"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/ee4883e.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>基于STM32和PCL6045BL的经编机电子横移系统设计</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>梳栉横移机构作为经编机五大基本机构之一，其动作性能直接决定着成圈编织过程的成败与产品品质的优劣，对经编产品的花式效果、性能和档次，以及花型研发的创作空间都有着重要的影响<sup>[1]</sup>。电子横移的应用，顺应了目前全新的个性化小批量、订制化多品种的短周期经编产品市场竞争需求，为经编操作提供了极大的便利和灵活性<sup>[2]</sup>。目前，国外经编企业已开发出了多种适用于不同机型的电子横移产品，但其价格相对比较昂贵，因此，开发适合国内经编企业成本低廉、性能稳定的高性价比电子横移系统有着深远的意义。本文结合并发挥嵌入式微控制器和专用运动控制芯片的特点及优势，设计了一套嵌入式经编机电子横移系统。</p><p><strong>1 系统总体设计方案</strong></p><p>经编机梳栉横移运动具有大加速启停、高精度定位和高频率往复等特点，因此所设计的系统必须满足运动平稳、定位精确、响应快速等要求<sup>[3-4]</sup>。系统设计采用三层架构进行规划，依次是：运动管理层、运动控制层和运动执行层，图1即为系统总体结构框图。运动管理层，采用工控机作为系统管理支持，配备编写或组态的上位机软件向上与操作用户直接交互，向下与运动控制层经由通信网络进行数据通信。运动控制层，作为系统控制核心，其主要任务是完成对多轴伺服驱动机构的实时运动控制，并与上位机进行通信，获取并存储工艺数据、系统参数，执行上位机控制或反馈上位机监测等。运动执行层，主要包括由伺服驱动器与伺服电动机、电缸组成的电气伺服执行机构和由导纱梳栉、撑杆与拉簧组成的机械传动机构两部分。</p><img alt=基于STM32和PCL6045BL的经编机电子横移系统设计 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RCBj0rUWxdLEI><p><strong>2 运动管理层设计</strong></p><p>选用工控机作为系统管理支持，有着运行稳定和数据处理能力强等优点。本文采用北京昆仑通态的MCGSE进行系统的上位机软件组态开发，应用Modbus TCP协议与运动控制层进行数据通信。设计的上位机软件主界面如图2所示，其他内部界面根据功能需求开发设计。</p><img alt=基于STM32和PCL6045BL的经编机电子横移系统设计 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RCBj0rn3mMvjD0><p><strong>3 运动控制层设计</strong></p><p>经编机电子横移系统涉及的关键技术即为运动控制技术，运动控制技术是制造业自动化前进的旋律，是推动新的产业革命的关键技术<sup>[5]</sup>。随着微电子技术的不断发展，基于嵌入式系统的运动控制日益增多。本文结合嵌入式微控制器STM32与专用运动控制芯片PCL6045BL两者的特点及优势，设计了一套嵌入式经编机电子横移控制器，满足系统对复杂的控制功能和高速、高精度运动控制的要求，同时兼顾系统成本和结构。</p><p><strong>3.1 运动控制器硬件设计</strong></p><p>运动控制器硬件结构主要包含两大部分：STM32主控板和PCL6045BL运动控制板，两块板之间通过STM32的FSMC(Flexible Static Memory Controller)总线进行通信，系统硬件总体结构框图如图3所示。其中，主控芯片STM32F103ZET6是ST公司生产的基于ARM Cortex-M3内核的32位微控制器，主频可达72 MHz，具有高性能、低成本、稳定等诸多优点<sup>[6]</sup>。运动控制芯片PCL6045BL是日本NPM公司设计的一款功能强大的专用运动控制芯片，是一种CMOS大规模集成电路，专门用于提供驱动步进马达或伺服马达所需的高速振荡脉冲，可提供多种脉冲输出功能，可以控制多达4个运动轴，采用总线方式接收MCU命令，同时可向MCU提供PCL的工作状态，使得MCU通过简单的指令便可实现多种运动控制，这种智能化设计理念很好地减少了MCU的负担<sup>[7-8]</sup>。双针床经编机为增强花型变换能力，梳栉数一般在4~8把之间，因此该系统采用两块运动控制器来完成对伺服执行系统的控制，两块控制器通过交换机转换，与上位机之间采用Modbus TCP协议进行通信。</p><img alt=基于STM32和PCL6045BL的经编机电子横移系统设计 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RCBj0rwIzQ4iPn><p><strong>3.2 运动控制器软件设计</strong></p><p>控制器软件设计主要包括PCL6045BL运动控制器驱动程序及运动控制功能程序设计、Modbus TCP通信设计和系统主体程序设计三大部分。</p><p><strong>3.2.1 PCL6045BL的控制</strong></p><p>PCL6045BL通过将IF0端子拉高、IF1端子置低配置其与STM32的接口模式为16位的H8接口。STM32通过FSMC总线来驱动PCL6045BL，将PCL6045BL当作16位的SRAM来控制，FSMC的工作模式配置为模式A。由于外扩的SRAM、以太网接口芯片DM9000A和PCL6045BL均挂载在FSMC总线上，它们使用不同的片选进行区分，SRAM接FSMC_NE3，对FSMC_NE2配合FSMC_A19和FSMC_A20通过74HC138进行地址译码输出，DM9000A接74HC138的Y2#输出端，PCL6045BL接Y4#输出端，如此一来，便可计算得到其对应的基地址分别为0x64100006（注：DM9000采用FSMC_A2作命令和数据区分线）和0x64200000，然后每个轴的内部寄存器地址由A1、A2地址线确定（注：A0接地），轴地址范围由输入端子A3和A4进行选择，从而各轴控制地址映射范围依次为：X轴=基地址、Y轴=基地址+0x10、Z轴=基地址+0x20、U轴=基地址+0x30。STM32对PCL6045BL的访问实际上是对寄存器的操作。图4(a)和(b)分别给出了STM32读写操作PCL6045BL寄存器的流程图。</p><img alt=基于STM32和PCL6045BL的经编机电子横移系统设计 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RCBj0sNGMzmFcf><p>在实现基本的读写操作后，就可利用这些基本的读写操作函数编写所需要的运动控制API，这里只对重点使用到的相对(即增量)定长运动模式作简单介绍。首先，写入相对定长运动指令到运动模式寄存器PRMD，接着配置运动速度相关寄存器，然后写入运动偏移量到运动距离寄存器PRMV，最后写入启动指令等待完成即可。</p><p><strong>3.2.2 Modbus TCP通信</strong></p><p>Modbus通信协议是工业领域通信协议的业界标准，是应用于电子控制器上的一种通用语言，通过此协议可以实现控制器与控制器之间、控制器经由网络与其他设备之间的通信<sup>[9]</sup>。Modbus主从式或CS（Client/Server）架构很好地满足了确定性的要求，目前世界上绝大部分网络都使用TCP/IP，通过在应用层使用Modbus协议，将Modbus信息帧嵌入到TCP帧的数据段中，就可以实现工业以太网的数据交换，具有很高的性价比，是一种很好的解决方案<sup>[10]</sup>。控制器软件移植LWIP到平台上实现嵌入式TCP/IP协议栈，在通信应用层上将Modbus帧嵌入到TCP帧中简单可靠地实现嵌入式Modbus TCP协议。所设计的系统中运动控制器作为服务器（Server），上位机作为客户端（Client）经由交换机与两块控制器建立通信连接。控制器端Modbus服务器设计流程如图5所示。</p><img alt=基于STM32和PCL6045BL的经编机电子横移系统设计 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RCBj0sXA0tnRrU><p><strong>3.2.3 系统主程序</strong></p><p>在上电完成系统初始化后，读取花型重要参数如花型高度、当前横列等，开启服务器端，等待上位机建立网络通信连接，接收由上位机传入的花型工艺数据或参数修改信息，然后在经编机运行过程当中，实时采集主轴绝对值编码器获取主轴位置信息，根据主轴位置信息和当前横列，获取并计算出相应的横移驱动指令，横移角度到达时发送给伺服驱动器，进而使伺服电动机驱动电缸带动导纱梳栉完成横移垫纱运动。系统主体程序实现流程图如图6所示。</p><img alt=基于STM32和PCL6045BL的经编机电子横移系统设计 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RCBj1enFnHXzFe><p><strong>4 运动执行层设计</strong></p><p>运动执行层作为最终的输出，对系统的精度有着重要的影响，该层在设计过程中主要是对一些器件的选型。伺服电动机选用的是松下的低惯量MSMF082L1U2M交流伺服电动机，其额定输出功率为750 W，额定转速3 000 rpm，最大转矩为2.39 N·m。伺服驱动器选择的是松下MINAS A6系列MCDLN35SG通用通信型驱动器，采用位置控制模式，具有控制简单且定位精确的优势。伺服电动缸选用的是常州博控自动化科技有限公司的BKB060伺服电动缸，行程60 mm，导程10 mm，传动精度高，安装方便，使用寿命长。</p><p><strong>5 测试结果</strong></p><p>系统以企业生产的RD7-EL-138-E22双针床拉舍尔经编机（针距1.155mm）为实用对象，系统平台搭建实物图如图7所示，测定的梳栉横移起始角度如表1所示，使用的是8位绝对值编码器所对应的实际值而非实际的角度值。根据花型工艺要求所使用到的梳栉为GB3~GB7，本文以GB5为主要测试对象，其对应的工艺垫纱数码值如表2所示。图8为使用松下伺服PANATERM测试软件实测的在主轴转速300 r/min运行条件下的GB5伺服系统的绝对式单圈数据(即位置)波形图，图中标注的数字即为对应的工艺垫纱数码。测试结果和现场实际应用都表明，系统横移定位精确，响应速度较高，运行平稳，布面质量良好，满足正常生产需求。</p><img alt=基于STM32和PCL6045BL的经编机电子横移系统设计 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RCBj1f9BlB1IiY><p><strong>6 结论</strong></p><p>本文采用三层架构完成系统设计，着重对运动控制层主要模块的软硬件设计做了介绍，充分发挥了嵌入式微处理器和专用运动控制芯片的特点及优势，实现了系统的稳定可靠运行，并在实际现场应用中取得了成功的验证，满足双针床拉舍尔经编机800横列/分钟的生产能力。</p><p><strong>参考文献</strong></p><p>[1] 郑宝平.基于旋转电机控制的高速经编机梳栉横移研究[D].无锡：江南大学，2012.</p><p>[2] 黄丽.高速经编机电子横移系统优化设计[D].无锡：江南大学，2014.</p><p>[3] 夏风林.基于直线伺服控制的经编电子横移系统研究[D].无锡：江南大学，2010.</p><p>[4] 张琦.高动态响应的经编机电子横移系统研究[D].无锡：江南大学，2013.</p><p>[5] 江卫华.PC机+伺服驱动在高速高精运动系统中的应用[J].机电一体化，2006，12(3)：81-83.</p><p>[6] 李宁.基于MDK的STM32处理器开发应用[M].北京：北京航空航天大学出版社，2008.</p><p>[7] 徐海林，惠晶.基于ARM和PCL6045BL的四轴运动控制器设计[J].服装学报，2014，13(2)：132-136.</p><p>[8] 许忠燕.基于ARM与PCL6045B的嵌入式运动控制器的设计[D].重庆：重庆大学，2010.</p><p>[9] 徐凤亮，王宜怀.嵌入式Modbus/TCP网关的设计与实现[J].电子技术应用，2010，36(3)：104-106.</p><p>[10] 张益南.嵌入式Modbus/TCP协议的研究与实现[D].杭州：浙江大学，2008.</p><p><strong>作者信息:</strong></p><p>郭伟军，章国青，孙以泽</p><p>（东华大学 机械工程学院，上海201620）</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'STM32','PCL6045BL','经编'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>