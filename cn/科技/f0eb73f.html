<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Excel-VBA：9、单元格信息 | 极客快訊</title><meta property="og:title" content="Excel-VBA：9、单元格信息 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0eb73f.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0eb73f.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f0eb73f.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0eb73f.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0eb73f.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f0eb73f.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f0eb73f.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0eb73f.html><meta property="article:published_time" content="2020-10-29T21:05:00+08:00"><meta property="article:modified_time" content="2020-10-29T21:05:00+08:00"><meta name=Keywords content><meta name=description content="Excel-VBA：9、单元格信息"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/f0eb73f.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Excel-VBA：9、单元格信息</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><h1><strong>1、单元格的值</strong></h1><p><strong>Value 属性</strong></p><p>返回单元格的实际内容</p><p><strong>Text 属性</strong></p><p>返回单元格的显示内容</p><p><strong>Formula 属性</strong></p><p>返回单元格的公式，类型为String</p><h1><strong>2、单元格的地址</strong></h1><p><strong>Address 属性</strong></p><p>以宏语言返回区域引用。String 类型，只读。</p><p><strong>语法</strong></p><p>expression.Address(RowAbsolute, ColumnAbsolute, ReferenceStyle, External, RelativeTo)</p><p><strong>参数</strong></p><p>expression 必需。该表达式返回上面的对象之一。</p><p>RowAbsolute Variant 类型，可选。如果为 True，则以绝对引用方式返回对行的引用。默认值为 True，也可以使用0，1代表Ture和False。</p><p>ColumnAbsolute Variant 类型，可选。如果为 True，则以绝对引用方式返回对列的引用。默认值为 True，也可以使用0，1代表Ture和False。</p><p>ReferenceStyle XlReferenceStyle 类型，可选。</p><pre>XlReferenceStyle 可为以下 XlReferenceStyle 常量之一。  xlA1 默认值。如果用 xlA1，则返回 A1 样式的引用。  xlR1C1。如果用 xlR1C1，则返回 R1C1 样式的引用。 </pre><p>External Variant 类型，可选。如果为 True，则返回外部引用。如果为 False，则返回局部引用。默认值为 False。</p><p>RelativeTo Variant 类型，可选。如果 RowAbsolute 和 ColumnAbsolute 为 False, ReferenceStyle 为 xlR1C1, 则必须指定相对引用的起始点。本参数即为定义起始点的 Range 对象。</p><p><strong>说明</strong></p><p>1、如果引用包含多个单元格，RowAbsolute 和 ColumnAbsolute 将应用于所有的行和列。</p><p>2、如果省略所有参数，默认返回绝对引用</p><p>3、单元格的行列信息</p><p><strong>Row 属性</strong></p><p>返回区域中第一个子区域的第一行的行号。Long 类型，只读。</p><p><strong>示例</strong></p><p>[a8:a10].row</p><p>结果：8</p><p><strong>Rows 属性</strong></p><p>对于 Application 对象，返回代表活动工作表所有行的 Range 对象。如果活动文档不是工作表，Rows 属性无效。对于 Range 对象，返回代表指定区域所有行的 Range 对象。对于 Worksheet 对象，返回代表指定工作表所有行的 Range 对象。Range 对象，只读。</p><p><strong>说明</strong></p><p>有关返回集合中单个成员的详细信息，请参阅返回集合中的对象。</p><p>在不用对象识别符的情况下使用此属性等价于 ActiveSheet.Rows。</p><p>当应用于含多个选定区域的 Range 对象时，该属性只返回该区域中第一个子区域内的行。例如，如果 Range 对象有两个子区域：A1:B2 和 C3:D4，则 Selection.Rows.Count 返回 2 而不是 4。若要在一个可能包含多个选定区域的区域中使用该属性，请测试 Areas.Count 来判断该区域是否包含多个选择区域。如果是，则像第 3 个示例中所示，在该区域中的每个子区域上循环。</p><p><strong>示例</strong></p><pre>Sub test()Dim h As RangeSet h = [a8:a10].RowsEnd Sub</pre><p><strong>Column 属性</strong></p><p>返回指定区域中第一块中的第一列的列号。Long 类型，只读。</p><p><strong>说明</strong></p><p>A 列返回 1，B 列返回 2，依次类推。</p><p><strong>Columns 属性</strong></p><p>返回 Range 对象，该对象代表指定单元格区域中的列。只读。</p><p><strong>说明</strong></p><p>当对一个多重选定区域的 Range 对象应用属性时，此属性返回的只是所选区域的第一个子区域中的列。例如，如果 Range 对象有两个子区域 A1:B2 和 C3:D4，那么，Selection.Columns.Count 的返回值是 2，而不是 4。若要对一个可能包含多重选定区域的区域使用此属性，请用 Areas.Count 方法测试一下此区域内是否包含多个子区域。如果确实包含多个子区域，可对此区域内的每一子区域进行循环。</p><h1><strong>4、单元格的格式信息</strong></h1><p><strong>Font 属性/对象</strong></p><p>返回一个 Font 对象，该对象允许用户设置或返回基於单元格字体格式的搜索条件。</p><p><strong>语法</strong></p><p>expression Font</p><p><strong>参数</strong></p><p>expression 必需。该表达式返回上面的对象之一。</p><p><strong>Font 对象</strong></p><p>包含以下属性：</p><pre>Application 属性Background 属性 返回或设置文本背景类型。本属性用于图表中的文本。Variant 类型，可读写。  语法  expression Background  参数  expression 必需。该表达式返回一个 Font 对象。  说明 以下常量可与应用于 Font 对象的 Background 属性一起使用：xlBackgroundAutomatic、xlBackgroundOpaque 和 xlBackgroundTransparent。 Bold 属性 如果字体设为加粗格式，则该值为 True。Variant 类型，可读写。 Color 属性 设置对象的主要颜色，可用 RGB 函数创建颜色值。Variant 类型，可读写。  语法 expression.Color  参数  expression 必需。该表达式返回“应用于”列表中的对象之一。  示例  Sub test() Dim h As Range, g Set h = [a8:a10].Rows h.Font.Color = RGB(255, 0, 0) End Sub  ColorInex 属性 返回或设置字体的颜色。该颜色可指定为当前调色板中颜色的编号，或下列 XlColorIndex 常量之一。Variant 类型，可读写。  XlColorIndex 可为以下 XlColorIndex 常量之一。  xlColorIndexAutomatic 指定自动设置颜色。  xlColorIndexNone.   语法  expression.ColorIndex  参数  expression 必需。该表达式返回“应用于”列表中的对象之一。  示例 本示例将 Sheet1 的 A1 单元格的字体颜色改为红色。  Worksheets("Sheet1").Range("A1").Font.ColorIndex = 3   Creator 属性FontStyle 属性 返回或设置字体样式。String 类型，可读写。  说明 修改本属性可能会影响其他 Font 属性（例如 Bold 和 Italic）。  示例 本示例将 Sheet1 中 A1 单元格的字体样式设为加粗和倾斜。  Worksheets("Sheet1").Range("A1").Font.FontStyle = "Bold Italic" Italic 属性 如果字形为倾斜，则该值为 True。Boolean 类型，可读写。  示例 本示例将 Sheet1 中 A1:A5 区域的字形设为倾斜。  Worksheets("Sheet1").Range("A1:A5").Font.Italic = True Name 属性 返回字体的名称  示例 [a8].Font.Name  结果：等线 OutlineFont 属性 如果指定的字体是空心字体，则该值为 True。Boolean 类型，可读写。  说明 本属性在 Windows 中无效，但保留其值（可被设置和返回）。 Parent 属性 返回指定对象的父对象。  语法  expression.Parent  参数  expression 必需。该表达式返回“应用于”列表中的对象之一。 Shadow 属性 如果字体为带阴影字体或者对象有阴影，则该值为 True。Boolean 类型，可读写。  说明 对于 Font 对象，该属性在 Microsoft Windows 中无效，但保留其值（可被设置或返回）。 Size 属性 返回或设置字体的大小。Variant 类型，可读写。 Strikethrough 属性 如果文字中间有一条水平删除线，则该值为 True。Boolean 类型，可读写。 Subscript 属性 如果字体格式设为加下标，则该值为 True，默认值为 False。Variant 类型，可读写。 Superscript 属性 如果字体格式设为上标字符，则该值为 True，默认值为 False。Variant 类型，可读写。 Underline 属性。 返回或设置应用于字体的下划线类型。可为以下 XlUnderlineStyle 常量之一。Variant 类型，可读写。  XlUnderlineStyle 可为以下 XlUnderlineStyle 常量之一。  xlUnderlineStyleNone  xlUnderlineStyleSingle  xlUnderlineStyleDouble  xlUnderlineStyleSingleAccounting  xlUnderlineStyleDoubleAccounting   语法  expression.Underline  参数  expression 必需。该表达式返回“应用于”列表中的对象之一。   示例 本示例将 Sheet1 中活动单元格的字体设为单下划线。  Worksheets("Sheet1").Activate ActiveCell.Font.Underline = xlUnderlineStyleSingle</pre><p><strong>Interior 属性</strong></p><p>返回一个 Interior 对象，该对象允许用户设置或返回基於单元格内部格式。</p><p><strong>Interior 对象</strong></p><pre>Application 属性Color 属性ColorIndex 属性Creator 属性InvertIfNegative属性Parent 属性Pattern 属性PatternColor 属性PatternColorIndex 属性</pre><p><strong>Borders 属性</strong></p><p>允许用户设置或返回基於单元格边框格式</p><p><strong>Borders 对象</strong></p><pre>Application 属性Color 属性ColorIndex 属性Count 属性Creator 属性Item 属性LineStyle 属性Parent 属性Value 属性Weight 属性</pre><h1><strong>5、单元格批注信息</strong></h1><p>Comment 属性</p><p>返回一个 Comment 对象，该对象代表与该区域左上角单元格相关联的批注。Comment 对象，只读。</p><p><strong>Comment 对象</strong></p><p>属性列表：</p><pre>ApplicationAuthorCreatorParentShapeVisible</pre><p>方法列表：</p><pre>DeleteNext 返回一个 Comment 对象，该对象代表下一条批注。Previous 返回一个 Comment 对象，该对象代表前一条批注。Text 设置批注文字</pre><p>语法</p><p>expression.Text(Text, Start, Overwrite)</p><p>参数</p><p>expression 必需。该表达式返回上面的对象之一。</p><p>Text Variant 类型，可选。要添加的文字。</p><p>Start Variant 类型，可选。添加的文字的起始位置（字符数）。如果省略该参数，则删除批注中的所有现有文字。</p><p>Overwrite Variant 类型，可选。如果该值为 True，则覆盖现有的文字，默认值为 False（新文字插入到现有文字中）。</p><h1><strong>6、单元格的位置信息</strong></h1><p><strong>Top 属性</strong></p><p><strong>Left 属性</strong></p><p><strong>Height 属性</strong></p><p><strong>Width 属性</strong></p><p>用例</p><p>[a8].Top</p><p>结果： 99.75</p><p>[a8].Left</p><p>结果： 0</p><h1><strong>7、单元格的上级信息</strong></h1><p><strong>Parent 属性</strong></p><p>返回指定对象的父对象。</p><h1><strong>8、内容判断</strong></h1><p>Has等属性，如HasFormula,如果区域中所有单元格均包含公式，则该值为 True；如果所有单元格均不包含公式，则该值为 False；其他情况下为 Null。Variant 类型，只读。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Excel','VBA','单元格'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../cn/%E7%A7%91%E6%8A%80/2ddd476.html alt="Excel VBA常用技巧之单元格区域添加边框进行设置，你需要Get it" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1531050705663659c18793f style=border-radius:25px></a>
<a href=../../cn/%E7%A7%91%E6%8A%80/2ddd476.html title="Excel VBA常用技巧之单元格区域添加边框进行设置，你需要Get it">Excel VBA常用技巧之单元格区域添加边框进行设置，你需要Get it</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>