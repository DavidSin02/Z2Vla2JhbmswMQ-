<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>“后浪”日志框架logback的使用和配置文件详解 | 极客快訊</title><meta property="og:title" content="“后浪”日志框架logback的使用和配置文件详解 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/a24a21ca714d4e7a8a6ab2fcf9f66cc0"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0fbe99.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0fbe99.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f0fbe99.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0fbe99.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0fbe99.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f0fbe99.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f0fbe99.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0fbe99.html><meta property="article:published_time" content="2020-10-29T20:59:53+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:53+08:00"><meta name=Keywords content><meta name=description content="“后浪”日志框架logback的使用和配置文件详解"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/f0fbe99.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>“后浪”日志框架logback的使用和配置文件详解</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><blockquote class=pgc-blockquote-abstract><p>原文链接：https://www.cnblogs.com/warking/p/5710303.html</p><p>作者：行走在云端的愚公</p></blockquote><p><strong>说明：</strong>用过了不少日志框架或包，但最近发现还是slf4j和logback是黄金组合。昨天写了篇快速上手的贴文，本来想再写一篇关于logback日志框架的文章，就查看到了这篇，写得比较不错，就转载于此，并修改了部分错别字等（如果英文好，可以去官网：http://logback.qos.ch/一探究竟）。</p><p>可以结合我昨天发布的<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6834775665250664967/?group_id=6834775665250664967" rel="noopener noreferrer" target=_blank>如何快速实现SL4J和logback日志框架的Web项目整合配置？</a>深入的来理解logback日志框架。</p><p><br></p><div class=pgc-img><img alt=“后浪”日志框架logback的使用和配置文件详解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a24a21ca714d4e7a8a6ab2fcf9f66cc0><p class=pgc-img-caption></p></div><p><br></p><p><strong>转发内容如下：</strong></p><p><strong>一、logback的介绍</strong></p><p>Logback是由log4j创始人设计的另一个开源日志组件,官方网站： http://logback.qos.ch。它当前分为下面下个模块：</p><ul><li>logback-core：其它两个模块的基础模块</li><li>logback-classic：它是log4j的一个改良版本，同时它完整实现了slf4j API使你可以很方便地更换成其它日志系统如log4j或JDK14 Logging</li><li>logback-access：访问模块与Servlet容器集成提供通过Http来访问日志的功能</li></ul><p><strong>二、logback取代log4j的理由：</strong></p><ol start=1><li>更快的实现：Logback的内核重写了，在一些关键执行路径上性能提升10倍以上。而且logback不仅性能提升了，初始化内存加载也更小了。</li><li>非常充分的测试：Logback经过了几年，数不清小时的测试。Logback的测试完全不同级别的。</li><li>Logback-classic非常自然实现了SLF4j：Logback-classic实现了SLF4j。在使用SLF4j中，你都感觉不到logback-classic。而且因为logback-classic非常自然地实现了slf4j ， 所 以切换到log4j或者其它，非常容易，只需要提供成另一个jar包就OK，根本不需要去动那些通过SLF4JAPI实现的代码。</li><li>非常充分的文档 官方网站有两百多页的文档。</li><li>自动重新加载配置文件，当配置文件修改了，Logback-classic能自动重新加载配置文件。扫描过程快且安全，它并不需要另外创建一个扫描线程。这个技术充分保证了应用程序能跑得很欢在JEE环境里面。</li><li>Lilith是log事件的观察者，和log4j的chainsaw类似。而lilith还能处理大数量的log数据 。</li><li>谨慎的模式和非常友好的恢复，在谨慎模式下，多个FileAppender实例跑在多个JVM下，能 够安全地写道同一个日志文件。RollingFileAppender会有些限制。Logback的FileAppender和它的子类包括 RollingFileAppender能够非常友好地从I/O异常中恢复。</li><li>配置文件可以处理不同的情况，开发人员经常需要判断不同的Logback配置文件在不同的环境下（开发，测试，生产）。而这些配置文件仅仅只有一些很小的不同，可以通过,和来实现，这样一个配置文件就可以适应多个环境。</li><li>Filters（过滤器）有些时候，需要诊断一个问题，需要打出日志。在log4j，只有降低日志级别，不过这样会打出大量的日志，会影响应用性能。在Logback，你可以继续 保持那个日志级别而除掉某种特殊情况，如alice这个用户登录，她的日志将打在DEBUG级别而其他用户可以继续打在WARN级别。要实现这个功能只需加4行XML配置。可以参考MDCFIlter 。</li><li>SiftingAppender（一个非常多功能的Appender）：它可以用来分割日志文件根据任何一个给定的运行参数。如，SiftingAppender能够区别日志事件跟进用户的Session，然后每个用户会有一个日志文件。</li><li>自动压缩已经打出来的log：RollingFileAppender在产生新文件的时候，会自动压缩已经打出来的日志文件。压缩是个异步过程，所以甚至对于大的日志文件，在压缩过程中应用不会受任何影响。</li><li>堆栈树带有包版本：Logback在打出堆栈树日志时，会带上包的数据。</li><li>自动去除旧的日志文件：通过设置TimeBasedRollingPolicy或者SizeAndTimeBasedFNATP的maxHistory属性，你可以控制已经产生日志文件的最大数量。如果设置maxHistory 12，那那些log文件超过12个月的都会被自动移除。</li></ol><p><strong>三、logback的配置介绍</strong></p><ul><li>Logger、appender及layout</li></ul><p>　　Logger作为日志的记录器，把它关联到应用的对应的context上后，主要用于存放日志对象，也可以定义日志类型、级别。　　Appender主要用于指定日志输出的目的地，目的地可以是控制台、文件、远程套接字服务器、 MySQL、PostreSQL、 Oracle和其他数据库、 JMS和远程UNIX Syslog守护进程等。　　Layout 负责把事件转换成字符串，格式化的日志信息的输出。</p><ul><li>logger context</li></ul><p>　　各个logger 都被关联到一个 LoggerContext，LoggerContext负责制造logger，也负责以树结构排列各logger。其他所有logger也通过org.slf4j.LoggerFactory 类的静态方法getLogger取得。 getLogger方法以 logger名称为参数。用同一名字调用LoggerFactory.getLogger 方法所得到的永远都是同一个logger对象的引用。</p><ul><li>有效级别及级别的继承</li></ul><p>　　Logger 可以被分配级别。级别包括：TRACE、DEBUG、INFO、WARN 和 ERROR，定义于ch.qos.logback.classic.Level类。如果 logger没有被分配级别，那么它将从有被分配级别的最近的祖先那里继承级别。root logger 默认级别是 DEBUG。</p><ul><li>打印方法与基本的选择规则</li></ul><p>　　打印方法决定记录请求的级别。例如，如果 L 是一个 logger 实例，那么，语句 L.info("..")是一条级别为 INFO的记录语句。记录请求的级别在高于或等于其 logger 的有效级别时被称为被启用，否则，称为被禁用。记录请求级别为 p，其 logger的有效级别为 q，只有则当 p>=q时，该请求才会被执行。该规则是 logback 的核心。级别排序为： TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR<strong>四、logback的默认配置</strong></p><p>如果配置文件 logback-test.xml 和 logback.xml 都不存在，那么 logback 默认地会调用BasicConfigurator ，创建一个最小化配置。最小化配置由一个关联到根 logger 的ConsoleAppender 组成。输出用模式为%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n 的 PatternLayoutEncoder 进行格式化。root logger 默认级别是 DEBUG。</p><ul><li>Logback的配置文件</li></ul><p>　　Logback 配置文件的语法非常灵活。正因为灵活，所以无法用 DTD 或 XML schema 进行定义。尽管如此，可以这样描述配置文件的基本结构：以&lt;configuration>开头，后面有零个或多个&lt;appender>元素，有零个或多个&lt;logger>元素，有最多一个&lt;root>元素。</p><ul><li>Logback默认配置的步骤</li></ul><ol start=1><li>尝试在 classpath下查找文件logback-test.xml；</li><li>如果文件不存在，则查找文件logback.xml；</li><li>如果两个文件都不存在，logback用BasicConfigurator自动对自己进行配置，这会导致记录输出到控制台。</li></ol><p><strong>五、logback.xml常用配置详解</strong></p><p></p><div class=pgc-img><img alt=“后浪”日志框架logback的使用和配置文件详解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/10ab836e85f1493fbc006c45948a0b92><p class=pgc-img-caption></p></div><p><br></p><li>(1) 根节点&lt;configuration>，包含下面三个属性：</li><p>　　　　scan: 当此属性设置为true时，配置文件如果发生改变，将会被重新加载，默认值为true。　　　　</p><p>　　　　scanPeriod: 设置监测配置文件是否有修改的时间间隔，如果没有给出时间单位，默认单位是毫秒。当scan为true时，此属性生效。默认的时间间隔为1分钟。</p><p>　　　　debug: 当此属性设置为true时，将打印出logback内部日志信息，实时查看logback运行状态。默认值为false。　　例如：</p><pre><code>&lt;configuration scan="true" scanPeriod="60 seconds" debug="false"&gt; 　　  &lt;!--其他配置省略--&gt; &lt;/configuration&gt;　</code></pre><ul><li>(2) 子节点&lt;contextName>：用来设置上下文名称，每个logger都关联到logger上下文，默认上下文名称为default。但可以使用&lt;contextName>设置成其他名字，用于区分不同应用程序的记录。一旦设置，不能修改。</li></ul><p>　　例如：</p><pre><code>&lt;configuration scan="true" scanPeriod="60 seconds" debug="false"&gt;      &lt;contextName&gt;myAppName&lt;/contextName&gt; 　　  &lt;!--其他配置省略--&gt;&lt;/configuration&gt;    </code></pre><ul><li>(3) 子节点&lt;property> ：用来定义变量值，它有两个属性name和value，通过&lt;property>定义的值会被插入到logger上下文中，可以使“${}”来使用变量。</li></ul><p>　　　　name: 变量的名称;</p><p>　　　　value: 的值时变量定义的值</p><p>　　例如：</p><pre><code>&lt;configuration scan="true" scanPeriod="60 seconds" debug="false"&gt; 　　　&lt;property name="APP_Name" value="myAppName" /&gt; 　　　&lt;contextName&gt;${APP_Name}&lt;/contextName&gt; 　　　&lt;!--其他配置省略--&gt; &lt;/configuration&gt;</code></pre><ul><li>(4) 子节点&lt;timestamp>：获取时间戳字符串，它有两个属性key和datePattern</li></ul><p>　　　　key: 标识此&lt;timestamp> 的名字；</p><p>　　　　datePattern: 设置将当前时间（解析配置文件的时间）转换为字符串的模式，遵循java.txt.SimpleDateFormat的格式。　　例如：</p><pre><code>&lt;configuration scan="true" scanPeriod="60 seconds" debug="false"&gt; 　　&lt;timestamp key="bySecond" datePattern="yyyyMMdd'T'HHmmss"/&gt; 　　&lt;contextName&gt;${bySecond}&lt;/contextName&gt; 　　&lt;!-- 其他配置省略--&gt; &lt;/configuration&gt;</code></pre><ul><li>(5) 子节点&lt;appender>：负责写日志的组件，它有两个必要属性name和class。</li><li>name指定appender名称，</li><li>class指定appender的全限定名</li></ul><p>　　　　5.1、ConsoleAppender 把日志输出到控制台，有以下子节点：</p><p>　　　　　　&lt;encoder>：对日志进行格式化。（具体参数稍后讲解 ）</p><p>　　　　　　&lt;target>：字符串System.out(默认)或者System.err（区别不多说了）</p><p>例如：</p><pre><code>&lt;configuration&gt; 　　　&lt;appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender"&gt; 　　　　　 &lt;encoder&gt; 　　　　　　　　　&lt;pattern&gt;%-4relative [%thread] %-5level %logger{35} - %msg %n&lt;/pattern&gt; 　　　　　 &lt;/encoder&gt; 　　　&lt;/appender&gt; 　　　&lt;root level="DEBUG"&gt; 　　　　　　&lt;appender-ref ref="STDOUT" /&gt; 　　　&lt;/root&gt; &lt;/configuration&gt;</code></pre><p>上述配置表示把>=DEBUG级别的日志都输出到控制台</p><p>　　　　5.2、FileAppender：把日志添加到文件，有以下子节点：</p><p>　　　　　　&lt;file>：被写入的文件名，可以是相对目录，也可以是绝对目录，如果上级目录不存在会自动创建，没有默认值。</p><p>　　　　　　&lt;append>：如果是 true，日志被追加到文件结尾，如果是 false，清空现存文件，默认是true。</p><p>　　　　　　&lt;encoder>：对记录事件进行格式化。（具体参数稍后讲解 ）</p><p>　　　　　　&lt;prudent>：如果是 true，日志会被安全的写入文件，即使其他的FileAppender也在向此文件做写入操作，效率低，默认是 false。</p><p>　　　　例如：</p><pre><code>&lt;configuration&gt; 　　&lt;appender name="FILE" class="ch.qos.logback.core.FileAppender"&gt; 　　　　&lt;file&gt;testFile.log&lt;/file&gt; 　　　　&lt;append&gt;true&lt;/append&gt; 　　　　&lt;encoder&gt; 　　　　　　&lt;pattern&gt;%-4relative [%thread] %-5level %logger{35} - %msg%n&lt;/pattern&gt; 　　　　&lt;/encoder&gt; 　　&lt;/appender&gt; 　　&lt;root level="DEBUG"&gt; 　　　　&lt;appender-ref ref="FILE" /&gt; 　　&lt;/root&gt; &lt;/configuration&gt;</code></pre><p>上述配置表示把>=DEBUG级别的日志都输出到testFile.log</p><p>　　　　5.3、RollingFileAppender：滚动记录文件，先将日志记录到指定文件，当符合某个条件时，将日志记录到其他文件。有以下子节点：</p><p>　　　　　　&lt;file>：被写入的文件名，可以是相对目录，也可以是绝对目录，如果上级目录不存在会自动创建，没有默认值。</p><p>　　　　　　&lt;append>：如果是 true，日志被追加到文件结尾，如果是 false，清空现存文件，默认是true。</p><p>　　　　　　&lt;rollingPolicy>:当发生滚动时，决定RollingFileAppender的行为，涉及文件移动和重命名。</p><p>属性class定义具体的滚动策略类　　　　　　class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"： 最常用的滚动策略，它根据时间来制定滚动策略，既负责滚动也负责触发滚动。有以下子节点：</p><p>　　　　　　　　&lt;fileNamePattern>：必要节点，包含文件名及“%d”转换符，“%d”可以包含一个java.text.SimpleDateFormat指定的时间格式，如：%d{yyyy-MM}。如果直接使用 %d，默认格式是 yyyy-MM-dd。RollingFileAppender的file字节点可有可无，通过设置file，可以为活动文件和归档文件指定不同位置，当前日志总是记录到file指定的文件（活动文件），活动文件的名字不会改变；如果没设置file，活动文件的名字会根据fileNamePattern 的值，每隔一段时间改变一次。“/”或者“\”会被当做目录分隔符。</p><p>　　　　　　　　&lt;maxHistory>:可选节点，控制保留的归档文件的最大数量，超出数量就删除旧文件。假设设置每个月滚动，且&lt;maxHistory>是6，则只保存最近6个月的文件，删除之前的旧文件。注意，删除旧文件时，那些为了归档而创建的目录也会被删除。　　　　　　class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy"： 查看当前活动文件的大小，如果超过指定大小会告知RollingFileAppender 触发当前活动文件滚动。只有一个节点:</p><p>　　　　　　　　&lt;maxFileSize>:这是活动文件的大小，默认值是10MB。</p><p>　　　　　　　　&lt;prudent>：当为true时，不支持FixedWindowRollingPolicy。支持TimeBasedRollingPolicy，但是有两个限制，1不支持也不允许文件压缩，2不能设置file属性，必须留空。</p><p>　　　　　　&lt;triggeringPolicy >: 告知 RollingFileAppender 合适激活滚动。　　　　　　class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy" 根据固定窗口算法重命名文件的滚动策略。有以下子节点：</p><p>　　　　　　　　&lt;minIndex>:窗口索引最小值</p><p>　　　　　　　　&lt;maxIndex>:窗口索引最大值，当用户指定的窗口过大时，会自动将窗口设置为12。</p><p>　　　　　　　　&lt;fileNamePattern>:必须包含“%i”例如，假设最小值和最大值分别为1和2，命名模式为 mylog%i.log,会产生归档文件mylog1.log和mylog2.log。还可以指定文件压缩选项，例如，mylog%i.log.gz 或者 没有log%i.log.zip例如： 　　　　　　　　</p><pre><code>&lt;configuration&gt; 　　　&lt;appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt; 　　　　　　&lt;rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt; 　　　　　　　　　&lt;fileNamePattern&gt;logFile.%d{yyyy-MM-dd}.log&lt;/fileNamePattern&gt; 　　　　　　　　　&lt;maxHistory&gt;30&lt;/maxHistory&gt; 　　　　　　&lt;/rollingPolicy&gt; 　　　　　　&lt;encoder&gt; 　　　　　　　　　&lt;pattern&gt;%-4relative [%thread] %-5level %logger{35} - %msg%n&lt;/pattern&gt; 　　　　　　&lt;/encoder&gt; 　　　&lt;/appender&gt; 　　　&lt;root level="DEBUG"&gt; 　　　　　　&lt;appender-ref ref="FILE" /&gt; 　　　&lt;/root&gt; &lt;/configuration&gt;</code></pre><p>备注：上述配置表示每天生成一个日志文件，保存30天的日志文件。　　　　　　　　</p><pre><code>&lt;configuration&gt; 　　　&lt;appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt; 　　　　　　&lt;file&gt;test.log&lt;/file&gt; 　　　　　　&lt;rollingPolicy class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy"&gt; 　　　　　　　　　　&lt;fileNamePattern&gt;tests.%i.log.zip&lt;/fileNamePattern&gt; 　　　　　　　　　　&lt;minIndex&gt;1&lt;/minIndex&gt; 　　　　　　　　　　&lt;maxIndex&gt;3&lt;/maxIndex&gt; 　　　　　　&lt;/rollingPolicy&gt; 　　　　　　&lt;triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy"&gt; 　　　　　　　　　　&lt;maxFileSize&gt;5MB&lt;/maxFileSize&gt; 　　　　　　&lt;/triggeringPolicy&gt; 　　　　　　&lt;encoder&gt; 　　　　　　　　　&lt;pattern&gt;%-4relative [%thread] %-5level %logger{35} - %msg%n&lt;/pattern&gt; 　　　　　　&lt;/encoder&gt; 　　　&lt;/appender&gt; 　　　&lt;root level="DEBUG"&gt; 　　　　　　&lt;appender-ref ref="FILE" /&gt; 　　　&lt;/root&gt; &lt;/configuration&gt;</code></pre><p>备注：上述配置表示按照固定窗口模式生成日志文件，当文件大于5MB时，生成新的日志文件。窗口大小是1到3，当保存了3个归档文件后，将覆盖最早的日志。&lt;encoder>：对记录事件进行格式化。负责两件事，一是把日志信息转换成字节数组，二是把字节数组写入到输出流。PatternLayoutEncoder 是唯一有用的且默认的encoder ，有一个&lt;pattern>节点，用来设置日志的输入格式。使用“%”加“转换符”方式，如果要输出“%”，则必须用“\”对“\%”进行转义。</p><p>　　　　5.4、还有SocketAppender、SMTPAppender、DBAppender、SyslogAppender、SiftingAppender，并不常用，这里就不详解了。大家可以参考官方文档（http://logback.qos.ch/documentation.html），还可以编写自己的Appender。</p><ul><li>（6）子节点&lt;loger>：用来设置某一个包或具体的某一个类的日志打印级别、以及指定&lt;appender>。&lt;loger>仅有一个name属性，一个可选的level和一个可选的additivity属性。</li></ul><p>可以包含零个或多个&lt;appender-ref>元素，标识这个appender将会添加到这个loger</p><p>　　　　name: 用来指定受此loger约束的某一个包或者具体的某一个类。</p><p>　　　　level: 用来设置打印级别，大小写无关：TRACE, DEBUG, INFO, WARN, ERROR, ALL和OFF，还有一个特殊值INHERITED或者同义词NULL，代表强制执行上级的级别。 如果未设置此属性，那么当前loger将会继承上级的级别。</p><p>additivity: 是否向上级loger传递打印信息。默认是true。同&lt;loger>一样，可以包含零个或多个&lt;appender-ref>元素，标识这个appender将会添加到这个loger。</p><ul><li>（7）子节点&lt;root>:它也是&lt;loger>元素，但是它是根loger,是所有&lt;loger>的上级。只有一个level属性，因为name已经被命名为"root",且已经是最上级了。</li></ul><p>　　　　level: 用来设置打印级别，大小写无关：TRACE, DEBUG, INFO, WARN, ERROR, ALL和OFF，不能设置为INHERITED或者同义词NULL。 默认是DEBUG。</p><p><strong>六、常用logger配置</strong></p><pre><code>&lt;!-- show parameters for hibernate sql 专为 Hibernate 定制 --&gt;&lt;logger name="org.hibernate.type.descriptor.sql.BasicBinder" level="TRACE" /&gt;&lt;logger name="org.hibernate.type.descriptor.sql.BasicExtractor" level="DEBUG" /&gt;&lt;logger name="org.hibernate.SQL" level="DEBUG" /&gt;&lt;logger name="org.hibernate.engine.QueryParameters" level="DEBUG" /&gt;&lt;logger name="org.hibernate.engine.query.HQLQueryPlan" level="DEBUG" /&gt;&lt;!--myibatis log configure--&gt;&lt;logger name="com.apache.ibatis" level="TRACE"/&gt;&lt;logger name="java.sql.Connection" level="DEBUG"/&gt;&lt;logger name="java.sql.Statement" level="DEBUG"/&gt;&lt;logger name="java.sql.PreparedStatement" level="DEBUG"/&gt;</code></pre><p><strong>七、Demo</strong></p><ul><li>（1）添加依赖包logback使用需要和slf4j一起使用，所以总共需要添加依赖的包有slf4j-api</li></ul><p>logback使用需要和slf4j一起使用，所以总共需要添加依赖的包有slf4j-api.jar，logback-core.jar，logback-classic.jar，logback-access.jar这个暂时用不到所以不添加依赖了，maven配置</p><pre><code>　　&lt;properties&gt;　　　　&lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;　　　　&lt;logback.version&gt;1.1.7&lt;/logback.version&gt;　　　　&lt;slf4j.version&gt;1.7.21&lt;/slf4j.version&gt;　　&lt;/properties&gt;　　&lt;dependencies&gt;　　　　&lt;dependency&gt;　　　　　　&lt;groupId&gt;org.slf4j&lt;/groupId&gt;　　　　　　&lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;　　　　　　&lt;version&gt;${slf4j.version}&lt;/version&gt;　　　　　　&lt;scope&gt;compile&lt;/scope&gt;　　　　&lt;/dependency&gt;　　　　&lt;dependency&gt;　　　　　　&lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;　　　　　　&lt;artifactId&gt;logback-core&lt;/artifactId&gt;　　　　　　&lt;version&gt;${logback.version}&lt;/version&gt;　　　　&lt;/dependency&gt;　　　　&lt;dependency&gt;　　　　　　&lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;　　　　　　&lt;artifactId&gt;logback-classic&lt;/artifactId&gt;　　　　　　&lt;version&gt;${logback.version}&lt;/version&gt;　　　　　　&lt;/dependency&gt;　　&lt;/dependencies&gt;</code></pre><ul><li>（2）logback.xml配置</li></ul><pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;configuration debug="false"&gt;&lt;!--定义日志文件的存储地址 勿在 LogBack 的配置中使用相对路径--&gt;&lt;property name="LOG_HOME" value="/home" /&gt;&lt;!-- 控制台输出 --&gt;&lt;appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender"&gt;&lt;encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder"&gt;&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;&lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/pattern&gt;&lt;/encoder&gt;&lt;/appender&gt;&lt;!-- 按照每天生成日志文件 --&gt;&lt;appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt;&lt;rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt;&lt;!--日志文件输出的文件名--&gt;&lt;FileNamePattern&gt;${LOG_HOME}/TestWeb.log.%d{yyyy-MM-dd}.log&lt;/FileNamePattern&gt;&lt;!--日志文件保留天数--&gt;&lt;MaxHistory&gt;30&lt;/MaxHistory&gt;&lt;/rollingPolicy&gt;&lt;encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder"&gt;&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;&lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/pattern&gt;&lt;/encoder&gt;&lt;!--日志文件最大的大小--&gt;&lt;triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy"&gt;&lt;MaxFileSize&gt;10MB&lt;/MaxFileSize&gt;&lt;/triggeringPolicy&gt;&lt;/appender&gt;&lt;!-- 日志输出级别 --&gt;&lt;root level="INFO"&gt;&lt;appender-ref ref="STDOUT" /&gt;&lt;/root&gt;&lt;/configuration&gt;</code></pre><ul><li>（3）java代码</li></ul><pre><code>/**　　* Hello world!　　*/　　public class App {　　private final static Logger logger = LoggerFactory.getLogger(App.class);　　　　public static void main(String[] args) {　　　　　　logger.info("logback 成功了");　　　　　　logger.error("logback 成功了");　　　　　　logger.debug("logback 成功了");　　　　}　　}</code></pre><ul><li>（4）输出</li></ul><div class=pgc-img><img alt=“后浪”日志框架logback的使用和配置文件详解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6952abc0607d49ac8e0969fc990ab769><p class=pgc-img-caption></p></div><p><strong>八、总结</strong></p><p>logback的配置，需要配置输出源appender，打日志的loger（子节点）和root（根节点）。实际上，它输出日志是从子节点开始，子节点如果有输出源直接输出，如果无，判断配置的additivity，是否向上级传递，即是否向root传递，传递则采用root的输出源，否则不输出日志。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'配置文件','日志','logback'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>