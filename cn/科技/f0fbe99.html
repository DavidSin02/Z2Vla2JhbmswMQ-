<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>â€œåæµªâ€æ—¥å¿—æ¡†æ¶logbackçš„ä½¿ç”¨å’Œé…ç½®æ–‡ä»¶è¯¦è§£ | æå®¢å¿«è¨Š</title><meta property="og:title" content="â€œåæµªâ€æ—¥å¿—æ¡†æ¶logbackçš„ä½¿ç”¨å’Œé…ç½®æ–‡ä»¶è¯¦è§£ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/a24a21ca714d4e7a8a6ab2fcf9f66cc0"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0fbe99.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0fbe99.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f0fbe99.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0fbe99.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0fbe99.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f0fbe99.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f0fbe99.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0fbe99.html><meta property="article:published_time" content="2020-10-29T20:59:53+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:53+08:00"><meta name=Keywords content><meta name=description content="â€œåæµªâ€æ—¥å¿—æ¡†æ¶logbackçš„ä½¿ç”¨å’Œé…ç½®æ–‡ä»¶è¯¦è§£"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/f0fbe99.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>â€œåæµªâ€æ—¥å¿—æ¡†æ¶logbackçš„ä½¿ç”¨å’Œé…ç½®æ–‡ä»¶è¯¦è§£</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><blockquote class=pgc-blockquote-abstract><p>åŸæ–‡é“¾æ¥ï¼šhttps://www.cnblogs.com/warking/p/5710303.html</p><p>ä½œè€…ï¼šè¡Œèµ°åœ¨äº‘ç«¯çš„æ„šå…¬</p></blockquote><p><strong>è¯´æ˜ï¼š</strong>ç”¨è¿‡äº†ä¸å°‘æ—¥å¿—æ¡†æ¶æˆ–åŒ…ï¼Œä½†æœ€è¿‘å‘ç°è¿˜æ˜¯slf4jå’Œlogbackæ˜¯é»„é‡‘ç»„åˆã€‚æ˜¨å¤©å†™äº†ç¯‡å¿«é€Ÿä¸Šæ‰‹çš„è´´æ–‡ï¼Œæœ¬æ¥æƒ³å†å†™ä¸€ç¯‡å…³äºlogbackæ—¥å¿—æ¡†æ¶çš„æ–‡ç« ï¼Œå°±æŸ¥çœ‹åˆ°äº†è¿™ç¯‡ï¼Œå†™å¾—æ¯”è¾ƒä¸é”™ï¼Œå°±è½¬è½½äºæ­¤ï¼Œå¹¶ä¿®æ”¹äº†éƒ¨åˆ†é”™åˆ«å­—ç­‰ï¼ˆå¦‚æœè‹±æ–‡å¥½ï¼Œå¯ä»¥å»å®˜ç½‘ï¼šhttp://logback.qos.ch/ä¸€æ¢ç©¶ç«Ÿï¼‰ã€‚</p><p>å¯ä»¥ç»“åˆæˆ‘æ˜¨å¤©å‘å¸ƒçš„<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6834775665250664967/?group_id=6834775665250664967" rel="noopener noreferrer" target=_blank>å¦‚ä½•å¿«é€Ÿå®ç°SL4Jå’Œlogbackæ—¥å¿—æ¡†æ¶çš„Webé¡¹ç›®æ•´åˆé…ç½®ï¼Ÿ</a>æ·±å…¥çš„æ¥ç†è§£logbackæ—¥å¿—æ¡†æ¶ã€‚</p><p><br></p><div class=pgc-img><img alt=â€œåæµªâ€æ—¥å¿—æ¡†æ¶logbackçš„ä½¿ç”¨å’Œé…ç½®æ–‡ä»¶è¯¦è§£ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a24a21ca714d4e7a8a6ab2fcf9f66cc0><p class=pgc-img-caption></p></div><p><br></p><p><strong>è½¬å‘å†…å®¹å¦‚ä¸‹ï¼š</strong></p><p><strong>ä¸€ã€logbackçš„ä»‹ç»</strong></p><p>Logbackæ˜¯ç”±log4jåˆ›å§‹äººè®¾è®¡çš„å¦ä¸€ä¸ªå¼€æºæ—¥å¿—ç»„ä»¶,å®˜æ–¹ç½‘ç«™ï¼š http://logback.qos.chã€‚å®ƒå½“å‰åˆ†ä¸ºä¸‹é¢ä¸‹ä¸ªæ¨¡å—ï¼š</p><ul><li>logback-coreï¼šå…¶å®ƒä¸¤ä¸ªæ¨¡å—çš„åŸºç¡€æ¨¡å—</li><li>logback-classicï¼šå®ƒæ˜¯log4jçš„ä¸€ä¸ªæ”¹è‰¯ç‰ˆæœ¬ï¼ŒåŒæ—¶å®ƒå®Œæ•´å®ç°äº†slf4j APIä½¿ä½ å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ›´æ¢æˆå…¶å®ƒæ—¥å¿—ç³»ç»Ÿå¦‚log4jæˆ–JDK14 Logging</li><li>logback-accessï¼šè®¿é—®æ¨¡å—ä¸Servletå®¹å™¨é›†æˆæä¾›é€šè¿‡Httpæ¥è®¿é—®æ—¥å¿—çš„åŠŸèƒ½</li></ul><p><strong>äºŒã€logbackå–ä»£log4jçš„ç†ç”±ï¼š</strong></p><ol start=1><li>æ›´å¿«çš„å®ç°ï¼šLogbackçš„å†…æ ¸é‡å†™äº†ï¼Œåœ¨ä¸€äº›å…³é”®æ‰§è¡Œè·¯å¾„ä¸Šæ€§èƒ½æå‡10å€ä»¥ä¸Šã€‚è€Œä¸”logbackä¸ä»…æ€§èƒ½æå‡äº†ï¼Œåˆå§‹åŒ–å†…å­˜åŠ è½½ä¹Ÿæ›´å°äº†ã€‚</li><li>éå¸¸å……åˆ†çš„æµ‹è¯•ï¼šLogbackç»è¿‡äº†å‡ å¹´ï¼Œæ•°ä¸æ¸…å°æ—¶çš„æµ‹è¯•ã€‚Logbackçš„æµ‹è¯•å®Œå…¨ä¸åŒçº§åˆ«çš„ã€‚</li><li>Logback-classicéå¸¸è‡ªç„¶å®ç°äº†SLF4jï¼šLogback-classicå®ç°äº†SLF4jã€‚åœ¨ä½¿ç”¨SLF4jä¸­ï¼Œä½ éƒ½æ„Ÿè§‰ä¸åˆ°logback-classicã€‚è€Œä¸”å› ä¸ºlogback-classicéå¸¸è‡ªç„¶åœ°å®ç°äº†slf4j ï¼Œ æ‰€ ä»¥åˆ‡æ¢åˆ°log4jæˆ–è€…å…¶å®ƒï¼Œéå¸¸å®¹æ˜“ï¼Œåªéœ€è¦æä¾›æˆå¦ä¸€ä¸ªjaråŒ…å°±OKï¼Œæ ¹æœ¬ä¸éœ€è¦å»åŠ¨é‚£äº›é€šè¿‡SLF4JAPIå®ç°çš„ä»£ç ã€‚</li><li>éå¸¸å……åˆ†çš„æ–‡æ¡£ å®˜æ–¹ç½‘ç«™æœ‰ä¸¤ç™¾å¤šé¡µçš„æ–‡æ¡£ã€‚</li><li>è‡ªåŠ¨é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼Œå½“é…ç½®æ–‡ä»¶ä¿®æ”¹äº†ï¼ŒLogback-classicèƒ½è‡ªåŠ¨é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ã€‚æ‰«æè¿‡ç¨‹å¿«ä¸”å®‰å…¨ï¼Œå®ƒå¹¶ä¸éœ€è¦å¦å¤–åˆ›å»ºä¸€ä¸ªæ‰«æçº¿ç¨‹ã€‚è¿™ä¸ªæŠ€æœ¯å……åˆ†ä¿è¯äº†åº”ç”¨ç¨‹åºèƒ½è·‘å¾—å¾ˆæ¬¢åœ¨JEEç¯å¢ƒé‡Œé¢ã€‚</li><li>Lilithæ˜¯logäº‹ä»¶çš„è§‚å¯Ÿè€…ï¼Œå’Œlog4jçš„chainsawç±»ä¼¼ã€‚è€Œlilithè¿˜èƒ½å¤„ç†å¤§æ•°é‡çš„logæ•°æ® ã€‚</li><li>è°¨æ…çš„æ¨¡å¼å’Œéå¸¸å‹å¥½çš„æ¢å¤ï¼Œåœ¨è°¨æ…æ¨¡å¼ä¸‹ï¼Œå¤šä¸ªFileAppenderå®ä¾‹è·‘åœ¨å¤šä¸ªJVMä¸‹ï¼Œèƒ½ å¤Ÿå®‰å…¨åœ°å†™é“åŒä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚RollingFileAppenderä¼šæœ‰äº›é™åˆ¶ã€‚Logbackçš„FileAppenderå’Œå®ƒçš„å­ç±»åŒ…æ‹¬ RollingFileAppenderèƒ½å¤Ÿéå¸¸å‹å¥½åœ°ä»I/Oå¼‚å¸¸ä¸­æ¢å¤ã€‚</li><li>é…ç½®æ–‡ä»¶å¯ä»¥å¤„ç†ä¸åŒçš„æƒ…å†µï¼Œå¼€å‘äººå‘˜ç»å¸¸éœ€è¦åˆ¤æ–­ä¸åŒçš„Logbacké…ç½®æ–‡ä»¶åœ¨ä¸åŒçš„ç¯å¢ƒä¸‹ï¼ˆå¼€å‘ï¼Œæµ‹è¯•ï¼Œç”Ÿäº§ï¼‰ã€‚è€Œè¿™äº›é…ç½®æ–‡ä»¶ä»…ä»…åªæœ‰ä¸€äº›å¾ˆå°çš„ä¸åŒï¼Œå¯ä»¥é€šè¿‡,å’Œæ¥å®ç°ï¼Œè¿™æ ·ä¸€ä¸ªé…ç½®æ–‡ä»¶å°±å¯ä»¥é€‚åº”å¤šä¸ªç¯å¢ƒã€‚</li><li>Filtersï¼ˆè¿‡æ»¤å™¨ï¼‰æœ‰äº›æ—¶å€™ï¼Œéœ€è¦è¯Šæ–­ä¸€ä¸ªé—®é¢˜ï¼Œéœ€è¦æ‰“å‡ºæ—¥å¿—ã€‚åœ¨log4jï¼Œåªæœ‰é™ä½æ—¥å¿—çº§åˆ«ï¼Œä¸è¿‡è¿™æ ·ä¼šæ‰“å‡ºå¤§é‡çš„æ—¥å¿—ï¼Œä¼šå½±å“åº”ç”¨æ€§èƒ½ã€‚åœ¨Logbackï¼Œä½ å¯ä»¥ç»§ç»­ ä¿æŒé‚£ä¸ªæ—¥å¿—çº§åˆ«è€Œé™¤æ‰æŸç§ç‰¹æ®Šæƒ…å†µï¼Œå¦‚aliceè¿™ä¸ªç”¨æˆ·ç™»å½•ï¼Œå¥¹çš„æ—¥å¿—å°†æ‰“åœ¨DEBUGçº§åˆ«è€Œå…¶ä»–ç”¨æˆ·å¯ä»¥ç»§ç»­æ‰“åœ¨WARNçº§åˆ«ã€‚è¦å®ç°è¿™ä¸ªåŠŸèƒ½åªéœ€åŠ 4è¡ŒXMLé…ç½®ã€‚å¯ä»¥å‚è€ƒMDCFIlter ã€‚</li><li>SiftingAppenderï¼ˆä¸€ä¸ªéå¸¸å¤šåŠŸèƒ½çš„Appenderï¼‰ï¼šå®ƒå¯ä»¥ç”¨æ¥åˆ†å‰²æ—¥å¿—æ–‡ä»¶æ ¹æ®ä»»ä½•ä¸€ä¸ªç»™å®šçš„è¿è¡Œå‚æ•°ã€‚å¦‚ï¼ŒSiftingAppenderèƒ½å¤ŸåŒºåˆ«æ—¥å¿—äº‹ä»¶è·Ÿè¿›ç”¨æˆ·çš„Sessionï¼Œç„¶åæ¯ä¸ªç”¨æˆ·ä¼šæœ‰ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚</li><li>è‡ªåŠ¨å‹ç¼©å·²ç»æ‰“å‡ºæ¥çš„logï¼šRollingFileAppenderåœ¨äº§ç”Ÿæ–°æ–‡ä»¶çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨å‹ç¼©å·²ç»æ‰“å‡ºæ¥çš„æ—¥å¿—æ–‡ä»¶ã€‚å‹ç¼©æ˜¯ä¸ªå¼‚æ­¥è¿‡ç¨‹ï¼Œæ‰€ä»¥ç”šè‡³å¯¹äºå¤§çš„æ—¥å¿—æ–‡ä»¶ï¼Œåœ¨å‹ç¼©è¿‡ç¨‹ä¸­åº”ç”¨ä¸ä¼šå—ä»»ä½•å½±å“ã€‚</li><li>å †æ ˆæ ‘å¸¦æœ‰åŒ…ç‰ˆæœ¬ï¼šLogbackåœ¨æ‰“å‡ºå †æ ˆæ ‘æ—¥å¿—æ—¶ï¼Œä¼šå¸¦ä¸ŠåŒ…çš„æ•°æ®ã€‚</li><li>è‡ªåŠ¨å»é™¤æ—§çš„æ—¥å¿—æ–‡ä»¶ï¼šé€šè¿‡è®¾ç½®TimeBasedRollingPolicyæˆ–è€…SizeAndTimeBasedFNATPçš„maxHistoryå±æ€§ï¼Œä½ å¯ä»¥æ§åˆ¶å·²ç»äº§ç”Ÿæ—¥å¿—æ–‡ä»¶çš„æœ€å¤§æ•°é‡ã€‚å¦‚æœè®¾ç½®maxHistory 12ï¼Œé‚£é‚£äº›logæ–‡ä»¶è¶…è¿‡12ä¸ªæœˆçš„éƒ½ä¼šè¢«è‡ªåŠ¨ç§»é™¤ã€‚</li></ol><p><strong>ä¸‰ã€logbackçš„é…ç½®ä»‹ç»</strong></p><ul><li>Loggerã€appenderåŠlayout</li></ul><p>ã€€ã€€Loggerä½œä¸ºæ—¥å¿—çš„è®°å½•å™¨ï¼ŒæŠŠå®ƒå…³è”åˆ°åº”ç”¨çš„å¯¹åº”çš„contextä¸Šåï¼Œä¸»è¦ç”¨äºå­˜æ”¾æ—¥å¿—å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥å®šä¹‰æ—¥å¿—ç±»å‹ã€çº§åˆ«ã€‚ã€€ã€€Appenderä¸»è¦ç”¨äºæŒ‡å®šæ—¥å¿—è¾“å‡ºçš„ç›®çš„åœ°ï¼Œç›®çš„åœ°å¯ä»¥æ˜¯æ§åˆ¶å°ã€æ–‡ä»¶ã€è¿œç¨‹å¥—æ¥å­—æœåŠ¡å™¨ã€ MySQLã€PostreSQLã€ Oracleå’Œå…¶ä»–æ•°æ®åº“ã€ JMSå’Œè¿œç¨‹UNIX Syslogå®ˆæŠ¤è¿›ç¨‹ç­‰ã€‚ã€€ã€€Layout è´Ÿè´£æŠŠäº‹ä»¶è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œæ ¼å¼åŒ–çš„æ—¥å¿—ä¿¡æ¯çš„è¾“å‡ºã€‚</p><ul><li>logger context</li></ul><p>ã€€ã€€å„ä¸ªlogger éƒ½è¢«å…³è”åˆ°ä¸€ä¸ª LoggerContextï¼ŒLoggerContextè´Ÿè´£åˆ¶é€ loggerï¼Œä¹Ÿè´Ÿè´£ä»¥æ ‘ç»“æ„æ’åˆ—å„loggerã€‚å…¶ä»–æ‰€æœ‰loggerä¹Ÿé€šè¿‡org.slf4j.LoggerFactory ç±»çš„é™æ€æ–¹æ³•getLoggerå–å¾—ã€‚ getLoggeræ–¹æ³•ä»¥ loggeråç§°ä¸ºå‚æ•°ã€‚ç”¨åŒä¸€åå­—è°ƒç”¨LoggerFactory.getLogger æ–¹æ³•æ‰€å¾—åˆ°çš„æ°¸è¿œéƒ½æ˜¯åŒä¸€ä¸ªloggerå¯¹è±¡çš„å¼•ç”¨ã€‚</p><ul><li>æœ‰æ•ˆçº§åˆ«åŠçº§åˆ«çš„ç»§æ‰¿</li></ul><p>ã€€ã€€Logger å¯ä»¥è¢«åˆ†é…çº§åˆ«ã€‚çº§åˆ«åŒ…æ‹¬ï¼šTRACEã€DEBUGã€INFOã€WARN å’Œ ERRORï¼Œå®šä¹‰äºch.qos.logback.classic.Levelç±»ã€‚å¦‚æœ loggeræ²¡æœ‰è¢«åˆ†é…çº§åˆ«ï¼Œé‚£ä¹ˆå®ƒå°†ä»æœ‰è¢«åˆ†é…çº§åˆ«çš„æœ€è¿‘çš„ç¥–å…ˆé‚£é‡Œç»§æ‰¿çº§åˆ«ã€‚root logger é»˜è®¤çº§åˆ«æ˜¯ DEBUGã€‚</p><ul><li>æ‰“å°æ–¹æ³•ä¸åŸºæœ¬çš„é€‰æ‹©è§„åˆ™</li></ul><p>ã€€ã€€æ‰“å°æ–¹æ³•å†³å®šè®°å½•è¯·æ±‚çš„çº§åˆ«ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ L æ˜¯ä¸€ä¸ª logger å®ä¾‹ï¼Œé‚£ä¹ˆï¼Œè¯­å¥ L.info("..")æ˜¯ä¸€æ¡çº§åˆ«ä¸º INFOçš„è®°å½•è¯­å¥ã€‚è®°å½•è¯·æ±‚çš„çº§åˆ«åœ¨é«˜äºæˆ–ç­‰äºå…¶ logger çš„æœ‰æ•ˆçº§åˆ«æ—¶è¢«ç§°ä¸ºè¢«å¯ç”¨ï¼Œå¦åˆ™ï¼Œç§°ä¸ºè¢«ç¦ç”¨ã€‚è®°å½•è¯·æ±‚çº§åˆ«ä¸º pï¼Œå…¶ loggerçš„æœ‰æ•ˆçº§åˆ«ä¸º qï¼Œåªæœ‰åˆ™å½“ p>=qæ—¶ï¼Œè¯¥è¯·æ±‚æ‰ä¼šè¢«æ‰§è¡Œã€‚è¯¥è§„åˆ™æ˜¯ logback çš„æ ¸å¿ƒã€‚çº§åˆ«æ’åºä¸ºï¼š TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR<strong>å››ã€logbackçš„é»˜è®¤é…ç½®</strong></p><p>å¦‚æœé…ç½®æ–‡ä»¶ logback-test.xml å’Œ logback.xml éƒ½ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆ logback é»˜è®¤åœ°ä¼šè°ƒç”¨BasicConfigurator ï¼Œåˆ›å»ºä¸€ä¸ªæœ€å°åŒ–é…ç½®ã€‚æœ€å°åŒ–é…ç½®ç”±ä¸€ä¸ªå…³è”åˆ°æ ¹ logger çš„ConsoleAppender ç»„æˆã€‚è¾“å‡ºç”¨æ¨¡å¼ä¸º%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n çš„ PatternLayoutEncoder è¿›è¡Œæ ¼å¼åŒ–ã€‚root logger é»˜è®¤çº§åˆ«æ˜¯ DEBUGã€‚</p><ul><li>Logbackçš„é…ç½®æ–‡ä»¶</li></ul><p>ã€€ã€€Logback é…ç½®æ–‡ä»¶çš„è¯­æ³•éå¸¸çµæ´»ã€‚æ­£å› ä¸ºçµæ´»ï¼Œæ‰€ä»¥æ— æ³•ç”¨ DTD æˆ– XML schema è¿›è¡Œå®šä¹‰ã€‚å°½ç®¡å¦‚æ­¤ï¼Œå¯ä»¥è¿™æ ·æè¿°é…ç½®æ–‡ä»¶çš„åŸºæœ¬ç»“æ„ï¼šä»¥&lt;configuration>å¼€å¤´ï¼Œåé¢æœ‰é›¶ä¸ªæˆ–å¤šä¸ª&lt;appender>å…ƒç´ ï¼Œæœ‰é›¶ä¸ªæˆ–å¤šä¸ª&lt;logger>å…ƒç´ ï¼Œæœ‰æœ€å¤šä¸€ä¸ª&lt;root>å…ƒç´ ã€‚</p><ul><li>Logbacké»˜è®¤é…ç½®çš„æ­¥éª¤</li></ul><ol start=1><li>å°è¯•åœ¨ classpathä¸‹æŸ¥æ‰¾æ–‡ä»¶logback-test.xmlï¼›</li><li>å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™æŸ¥æ‰¾æ–‡ä»¶logback.xmlï¼›</li><li>å¦‚æœä¸¤ä¸ªæ–‡ä»¶éƒ½ä¸å­˜åœ¨ï¼Œlogbackç”¨BasicConfiguratorè‡ªåŠ¨å¯¹è‡ªå·±è¿›è¡Œé…ç½®ï¼Œè¿™ä¼šå¯¼è‡´è®°å½•è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</li></ol><p><strong>äº”ã€logback.xmlå¸¸ç”¨é…ç½®è¯¦è§£</strong></p><p></p><div class=pgc-img><img alt=â€œåæµªâ€æ—¥å¿—æ¡†æ¶logbackçš„ä½¿ç”¨å’Œé…ç½®æ–‡ä»¶è¯¦è§£ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/10ab836e85f1493fbc006c45948a0b92><p class=pgc-img-caption></p></div><p><br></p><li>(1) æ ¹èŠ‚ç‚¹&lt;configuration>ï¼ŒåŒ…å«ä¸‹é¢ä¸‰ä¸ªå±æ€§ï¼š</li><p>ã€€ã€€ã€€ã€€scan: å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œé…ç½®æ–‡ä»¶å¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œå°†ä¼šè¢«é‡æ–°åŠ è½½ï¼Œé»˜è®¤å€¼ä¸ºtrueã€‚ã€€ã€€ã€€ã€€</p><p>ã€€ã€€ã€€ã€€scanPeriod: è®¾ç½®ç›‘æµ‹é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰ä¿®æ”¹çš„æ—¶é—´é—´éš”ï¼Œå¦‚æœæ²¡æœ‰ç»™å‡ºæ—¶é—´å•ä½ï¼Œé»˜è®¤å•ä½æ˜¯æ¯«ç§’ã€‚å½“scanä¸ºtrueæ—¶ï¼Œæ­¤å±æ€§ç”Ÿæ•ˆã€‚é»˜è®¤çš„æ—¶é—´é—´éš”ä¸º1åˆ†é’Ÿã€‚</p><p>ã€€ã€€ã€€ã€€debug: å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œå°†æ‰“å°å‡ºlogbackå†…éƒ¨æ—¥å¿—ä¿¡æ¯ï¼Œå®æ—¶æŸ¥çœ‹logbackè¿è¡ŒçŠ¶æ€ã€‚é»˜è®¤å€¼ä¸ºfalseã€‚ã€€ã€€ä¾‹å¦‚ï¼š</p><pre><code>&lt;configuration scan="true" scanPeriod="60 seconds" debug="false"&gt; ã€€ã€€  &lt;!--å…¶ä»–é…ç½®çœç•¥--&gt; &lt;/configuration&gt;ã€€</code></pre><ul><li>(2) å­èŠ‚ç‚¹&lt;contextName>ï¼šç”¨æ¥è®¾ç½®ä¸Šä¸‹æ–‡åç§°ï¼Œæ¯ä¸ªloggeréƒ½å…³è”åˆ°loggerä¸Šä¸‹æ–‡ï¼Œé»˜è®¤ä¸Šä¸‹æ–‡åç§°ä¸ºdefaultã€‚ä½†å¯ä»¥ä½¿ç”¨&lt;contextName>è®¾ç½®æˆå…¶ä»–åå­—ï¼Œç”¨äºåŒºåˆ†ä¸åŒåº”ç”¨ç¨‹åºçš„è®°å½•ã€‚ä¸€æ—¦è®¾ç½®ï¼Œä¸èƒ½ä¿®æ”¹ã€‚</li></ul><p>ã€€ã€€ä¾‹å¦‚ï¼š</p><pre><code>&lt;configuration scan="true" scanPeriod="60 seconds" debug="false"&gt;      &lt;contextName&gt;myAppName&lt;/contextName&gt; ã€€ã€€  &lt;!--å…¶ä»–é…ç½®çœç•¥--&gt;&lt;/configuration&gt;    </code></pre><ul><li>(3) å­èŠ‚ç‚¹&lt;property> ï¼šç”¨æ¥å®šä¹‰å˜é‡å€¼ï¼Œå®ƒæœ‰ä¸¤ä¸ªå±æ€§nameå’Œvalueï¼Œé€šè¿‡&lt;property>å®šä¹‰çš„å€¼ä¼šè¢«æ’å…¥åˆ°loggerä¸Šä¸‹æ–‡ä¸­ï¼Œå¯ä»¥ä½¿â€œ${}â€æ¥ä½¿ç”¨å˜é‡ã€‚</li></ul><p>ã€€ã€€ã€€ã€€name: å˜é‡çš„åç§°;</p><p>ã€€ã€€ã€€ã€€value: çš„å€¼æ—¶å˜é‡å®šä¹‰çš„å€¼</p><p>ã€€ã€€ä¾‹å¦‚ï¼š</p><pre><code>&lt;configuration scan="true" scanPeriod="60 seconds" debug="false"&gt; ã€€ã€€ã€€&lt;property name="APP_Name" value="myAppName" /&gt; ã€€ã€€ã€€&lt;contextName&gt;${APP_Name}&lt;/contextName&gt; ã€€ã€€ã€€&lt;!--å…¶ä»–é…ç½®çœç•¥--&gt; &lt;/configuration&gt;</code></pre><ul><li>(4) å­èŠ‚ç‚¹&lt;timestamp>ï¼šè·å–æ—¶é—´æˆ³å­—ç¬¦ä¸²ï¼Œå®ƒæœ‰ä¸¤ä¸ªå±æ€§keyå’ŒdatePattern</li></ul><p>ã€€ã€€ã€€ã€€key: æ ‡è¯†æ­¤&lt;timestamp> çš„åå­—ï¼›</p><p>ã€€ã€€ã€€ã€€datePattern: è®¾ç½®å°†å½“å‰æ—¶é—´ï¼ˆè§£æé…ç½®æ–‡ä»¶çš„æ—¶é—´ï¼‰è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„æ¨¡å¼ï¼Œéµå¾ªjava.txt.SimpleDateFormatçš„æ ¼å¼ã€‚ã€€ã€€ä¾‹å¦‚ï¼š</p><pre><code>&lt;configuration scan="true" scanPeriod="60 seconds" debug="false"&gt; ã€€ã€€&lt;timestamp key="bySecond" datePattern="yyyyMMdd'T'HHmmss"/&gt; ã€€ã€€&lt;contextName&gt;${bySecond}&lt;/contextName&gt; ã€€ã€€&lt;!-- å…¶ä»–é…ç½®çœç•¥--&gt; &lt;/configuration&gt;</code></pre><ul><li>(5) å­èŠ‚ç‚¹&lt;appender>ï¼šè´Ÿè´£å†™æ—¥å¿—çš„ç»„ä»¶ï¼Œå®ƒæœ‰ä¸¤ä¸ªå¿…è¦å±æ€§nameå’Œclassã€‚</li><li>nameæŒ‡å®šappenderåç§°ï¼Œ</li><li>classæŒ‡å®šappenderçš„å…¨é™å®šå</li></ul><p>ã€€ã€€ã€€ã€€5.1ã€ConsoleAppender æŠŠæ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œæœ‰ä»¥ä¸‹å­èŠ‚ç‚¹ï¼š</p><p>ã€€ã€€ã€€ã€€ã€€ã€€&lt;encoder>ï¼šå¯¹æ—¥å¿—è¿›è¡Œæ ¼å¼åŒ–ã€‚ï¼ˆå…·ä½“å‚æ•°ç¨åè®²è§£ ï¼‰</p><p>ã€€ã€€ã€€ã€€ã€€ã€€&lt;target>ï¼šå­—ç¬¦ä¸²System.out(é»˜è®¤)æˆ–è€…System.errï¼ˆåŒºåˆ«ä¸å¤šè¯´äº†ï¼‰</p><p>ä¾‹å¦‚ï¼š</p><pre><code>&lt;configuration&gt; ã€€ã€€ã€€&lt;appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender"&gt; ã€€ã€€ã€€ã€€ã€€ &lt;encoder&gt; ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;pattern&gt;%-4relative [%thread] %-5level %logger{35} - %msg %n&lt;/pattern&gt; ã€€ã€€ã€€ã€€ã€€ &lt;/encoder&gt; ã€€ã€€ã€€&lt;/appender&gt; ã€€ã€€ã€€&lt;root level="DEBUG"&gt; ã€€ã€€ã€€ã€€ã€€ã€€&lt;appender-ref ref="STDOUT" /&gt; ã€€ã€€ã€€&lt;/root&gt; &lt;/configuration&gt;</code></pre><p>ä¸Šè¿°é…ç½®è¡¨ç¤ºæŠŠ>=DEBUGçº§åˆ«çš„æ—¥å¿—éƒ½è¾“å‡ºåˆ°æ§åˆ¶å°</p><p>ã€€ã€€ã€€ã€€5.2ã€FileAppenderï¼šæŠŠæ—¥å¿—æ·»åŠ åˆ°æ–‡ä»¶ï¼Œæœ‰ä»¥ä¸‹å­èŠ‚ç‚¹ï¼š</p><p>ã€€ã€€ã€€ã€€ã€€ã€€&lt;file>ï¼šè¢«å†™å…¥çš„æ–‡ä»¶åï¼Œå¯ä»¥æ˜¯ç›¸å¯¹ç›®å½•ï¼Œä¹Ÿå¯ä»¥æ˜¯ç»å¯¹ç›®å½•ï¼Œå¦‚æœä¸Šçº§ç›®å½•ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œæ²¡æœ‰é»˜è®¤å€¼ã€‚</p><p>ã€€ã€€ã€€ã€€ã€€ã€€&lt;append>ï¼šå¦‚æœæ˜¯ trueï¼Œæ—¥å¿—è¢«è¿½åŠ åˆ°æ–‡ä»¶ç»“å°¾ï¼Œå¦‚æœæ˜¯ falseï¼Œæ¸…ç©ºç°å­˜æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯trueã€‚</p><p>ã€€ã€€ã€€ã€€ã€€ã€€&lt;encoder>ï¼šå¯¹è®°å½•äº‹ä»¶è¿›è¡Œæ ¼å¼åŒ–ã€‚ï¼ˆå…·ä½“å‚æ•°ç¨åè®²è§£ ï¼‰</p><p>ã€€ã€€ã€€ã€€ã€€ã€€&lt;prudent>ï¼šå¦‚æœæ˜¯ trueï¼Œæ—¥å¿—ä¼šè¢«å®‰å…¨çš„å†™å…¥æ–‡ä»¶ï¼Œå³ä½¿å…¶ä»–çš„FileAppenderä¹Ÿåœ¨å‘æ­¤æ–‡ä»¶åšå†™å…¥æ“ä½œï¼Œæ•ˆç‡ä½ï¼Œé»˜è®¤æ˜¯ falseã€‚</p><p>ã€€ã€€ã€€ã€€ä¾‹å¦‚ï¼š</p><pre><code>&lt;configuration&gt; ã€€ã€€&lt;appender name="FILE" class="ch.qos.logback.core.FileAppender"&gt; ã€€ã€€ã€€ã€€&lt;file&gt;testFile.log&lt;/file&gt; ã€€ã€€ã€€ã€€&lt;append&gt;true&lt;/append&gt; ã€€ã€€ã€€ã€€&lt;encoder&gt; ã€€ã€€ã€€ã€€ã€€ã€€&lt;pattern&gt;%-4relative [%thread] %-5level %logger{35} - %msg%n&lt;/pattern&gt; ã€€ã€€ã€€ã€€&lt;/encoder&gt; ã€€ã€€&lt;/appender&gt; ã€€ã€€&lt;root level="DEBUG"&gt; ã€€ã€€ã€€ã€€&lt;appender-ref ref="FILE" /&gt; ã€€ã€€&lt;/root&gt; &lt;/configuration&gt;</code></pre><p>ä¸Šè¿°é…ç½®è¡¨ç¤ºæŠŠ>=DEBUGçº§åˆ«çš„æ—¥å¿—éƒ½è¾“å‡ºåˆ°testFile.log</p><p>ã€€ã€€ã€€ã€€5.3ã€RollingFileAppenderï¼šæ»šåŠ¨è®°å½•æ–‡ä»¶ï¼Œå…ˆå°†æ—¥å¿—è®°å½•åˆ°æŒ‡å®šæ–‡ä»¶ï¼Œå½“ç¬¦åˆæŸä¸ªæ¡ä»¶æ—¶ï¼Œå°†æ—¥å¿—è®°å½•åˆ°å…¶ä»–æ–‡ä»¶ã€‚æœ‰ä»¥ä¸‹å­èŠ‚ç‚¹ï¼š</p><p>ã€€ã€€ã€€ã€€ã€€ã€€&lt;file>ï¼šè¢«å†™å…¥çš„æ–‡ä»¶åï¼Œå¯ä»¥æ˜¯ç›¸å¯¹ç›®å½•ï¼Œä¹Ÿå¯ä»¥æ˜¯ç»å¯¹ç›®å½•ï¼Œå¦‚æœä¸Šçº§ç›®å½•ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œæ²¡æœ‰é»˜è®¤å€¼ã€‚</p><p>ã€€ã€€ã€€ã€€ã€€ã€€&lt;append>ï¼šå¦‚æœæ˜¯ trueï¼Œæ—¥å¿—è¢«è¿½åŠ åˆ°æ–‡ä»¶ç»“å°¾ï¼Œå¦‚æœæ˜¯ falseï¼Œæ¸…ç©ºç°å­˜æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯trueã€‚</p><p>ã€€ã€€ã€€ã€€ã€€ã€€&lt;rollingPolicy>:å½“å‘ç”Ÿæ»šåŠ¨æ—¶ï¼Œå†³å®šRollingFileAppenderçš„è¡Œä¸ºï¼Œæ¶‰åŠæ–‡ä»¶ç§»åŠ¨å’Œé‡å‘½åã€‚</p><p>å±æ€§classå®šä¹‰å…·ä½“çš„æ»šåŠ¨ç­–ç•¥ç±»ã€€ã€€ã€€ã€€ã€€ã€€class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"ï¼š æœ€å¸¸ç”¨çš„æ»šåŠ¨ç­–ç•¥ï¼Œå®ƒæ ¹æ®æ—¶é—´æ¥åˆ¶å®šæ»šåŠ¨ç­–ç•¥ï¼Œæ—¢è´Ÿè´£æ»šåŠ¨ä¹Ÿè´Ÿè´£è§¦å‘æ»šåŠ¨ã€‚æœ‰ä»¥ä¸‹å­èŠ‚ç‚¹ï¼š</p><p>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;fileNamePattern>ï¼šå¿…è¦èŠ‚ç‚¹ï¼ŒåŒ…å«æ–‡ä»¶ååŠâ€œ%dâ€è½¬æ¢ç¬¦ï¼Œâ€œ%dâ€å¯ä»¥åŒ…å«ä¸€ä¸ªjava.text.SimpleDateFormatæŒ‡å®šçš„æ—¶é—´æ ¼å¼ï¼Œå¦‚ï¼š%d{yyyy-MM}ã€‚å¦‚æœç›´æ¥ä½¿ç”¨ %dï¼Œé»˜è®¤æ ¼å¼æ˜¯ yyyy-MM-ddã€‚RollingFileAppenderçš„fileå­—èŠ‚ç‚¹å¯æœ‰å¯æ— ï¼Œé€šè¿‡è®¾ç½®fileï¼Œå¯ä»¥ä¸ºæ´»åŠ¨æ–‡ä»¶å’Œå½’æ¡£æ–‡ä»¶æŒ‡å®šä¸åŒä½ç½®ï¼Œå½“å‰æ—¥å¿—æ€»æ˜¯è®°å½•åˆ°fileæŒ‡å®šçš„æ–‡ä»¶ï¼ˆæ´»åŠ¨æ–‡ä»¶ï¼‰ï¼Œæ´»åŠ¨æ–‡ä»¶çš„åå­—ä¸ä¼šæ”¹å˜ï¼›å¦‚æœæ²¡è®¾ç½®fileï¼Œæ´»åŠ¨æ–‡ä»¶çš„åå­—ä¼šæ ¹æ®fileNamePattern çš„å€¼ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´æ”¹å˜ä¸€æ¬¡ã€‚â€œ/â€æˆ–è€…â€œ\â€ä¼šè¢«å½“åšç›®å½•åˆ†éš”ç¬¦ã€‚</p><p>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;maxHistory>:å¯é€‰èŠ‚ç‚¹ï¼Œæ§åˆ¶ä¿ç•™çš„å½’æ¡£æ–‡ä»¶çš„æœ€å¤§æ•°é‡ï¼Œè¶…å‡ºæ•°é‡å°±åˆ é™¤æ—§æ–‡ä»¶ã€‚å‡è®¾è®¾ç½®æ¯ä¸ªæœˆæ»šåŠ¨ï¼Œä¸”&lt;maxHistory>æ˜¯6ï¼Œåˆ™åªä¿å­˜æœ€è¿‘6ä¸ªæœˆçš„æ–‡ä»¶ï¼Œåˆ é™¤ä¹‹å‰çš„æ—§æ–‡ä»¶ã€‚æ³¨æ„ï¼Œåˆ é™¤æ—§æ–‡ä»¶æ—¶ï¼Œé‚£äº›ä¸ºäº†å½’æ¡£è€Œåˆ›å»ºçš„ç›®å½•ä¹Ÿä¼šè¢«åˆ é™¤ã€‚ã€€ã€€ã€€ã€€ã€€ã€€class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy"ï¼š æŸ¥çœ‹å½“å‰æ´»åŠ¨æ–‡ä»¶çš„å¤§å°ï¼Œå¦‚æœè¶…è¿‡æŒ‡å®šå¤§å°ä¼šå‘ŠçŸ¥RollingFileAppender è§¦å‘å½“å‰æ´»åŠ¨æ–‡ä»¶æ»šåŠ¨ã€‚åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹:</p><p>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;maxFileSize>:è¿™æ˜¯æ´»åŠ¨æ–‡ä»¶çš„å¤§å°ï¼Œé»˜è®¤å€¼æ˜¯10MBã€‚</p><p>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;prudent>ï¼šå½“ä¸ºtrueæ—¶ï¼Œä¸æ”¯æŒFixedWindowRollingPolicyã€‚æ”¯æŒTimeBasedRollingPolicyï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªé™åˆ¶ï¼Œ1ä¸æ”¯æŒä¹Ÿä¸å…è®¸æ–‡ä»¶å‹ç¼©ï¼Œ2ä¸èƒ½è®¾ç½®fileå±æ€§ï¼Œå¿…é¡»ç•™ç©ºã€‚</p><p>ã€€ã€€ã€€ã€€ã€€ã€€&lt;triggeringPolicy >: å‘ŠçŸ¥ RollingFileAppender åˆé€‚æ¿€æ´»æ»šåŠ¨ã€‚ã€€ã€€ã€€ã€€ã€€ã€€class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy" æ ¹æ®å›ºå®šçª—å£ç®—æ³•é‡å‘½åæ–‡ä»¶çš„æ»šåŠ¨ç­–ç•¥ã€‚æœ‰ä»¥ä¸‹å­èŠ‚ç‚¹ï¼š</p><p>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;minIndex>:çª—å£ç´¢å¼•æœ€å°å€¼</p><p>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;maxIndex>:çª—å£ç´¢å¼•æœ€å¤§å€¼ï¼Œå½“ç”¨æˆ·æŒ‡å®šçš„çª—å£è¿‡å¤§æ—¶ï¼Œä¼šè‡ªåŠ¨å°†çª—å£è®¾ç½®ä¸º12ã€‚</p><p>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;fileNamePattern>:å¿…é¡»åŒ…å«â€œ%iâ€ä¾‹å¦‚ï¼Œå‡è®¾æœ€å°å€¼å’Œæœ€å¤§å€¼åˆ†åˆ«ä¸º1å’Œ2ï¼Œå‘½åæ¨¡å¼ä¸º mylog%i.log,ä¼šäº§ç”Ÿå½’æ¡£æ–‡ä»¶mylog1.logå’Œmylog2.logã€‚è¿˜å¯ä»¥æŒ‡å®šæ–‡ä»¶å‹ç¼©é€‰é¡¹ï¼Œä¾‹å¦‚ï¼Œmylog%i.log.gz æˆ–è€… æ²¡æœ‰log%i.log.zipä¾‹å¦‚ï¼š ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€</p><pre><code>&lt;configuration&gt; ã€€ã€€ã€€&lt;appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt; ã€€ã€€ã€€ã€€ã€€ã€€&lt;rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt; ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;fileNamePattern&gt;logFile.%d{yyyy-MM-dd}.log&lt;/fileNamePattern&gt; ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;maxHistory&gt;30&lt;/maxHistory&gt; ã€€ã€€ã€€ã€€ã€€ã€€&lt;/rollingPolicy&gt; ã€€ã€€ã€€ã€€ã€€ã€€&lt;encoder&gt; ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;pattern&gt;%-4relative [%thread] %-5level %logger{35} - %msg%n&lt;/pattern&gt; ã€€ã€€ã€€ã€€ã€€ã€€&lt;/encoder&gt; ã€€ã€€ã€€&lt;/appender&gt; ã€€ã€€ã€€&lt;root level="DEBUG"&gt; ã€€ã€€ã€€ã€€ã€€ã€€&lt;appender-ref ref="FILE" /&gt; ã€€ã€€ã€€&lt;/root&gt; &lt;/configuration&gt;</code></pre><p>å¤‡æ³¨ï¼šä¸Šè¿°é…ç½®è¡¨ç¤ºæ¯å¤©ç”Ÿæˆä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œä¿å­˜30å¤©çš„æ—¥å¿—æ–‡ä»¶ã€‚ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€</p><pre><code>&lt;configuration&gt; ã€€ã€€ã€€&lt;appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt; ã€€ã€€ã€€ã€€ã€€ã€€&lt;file&gt;test.log&lt;/file&gt; ã€€ã€€ã€€ã€€ã€€ã€€&lt;rollingPolicy class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy"&gt; ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;fileNamePattern&gt;tests.%i.log.zip&lt;/fileNamePattern&gt; ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;minIndex&gt;1&lt;/minIndex&gt; ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;maxIndex&gt;3&lt;/maxIndex&gt; ã€€ã€€ã€€ã€€ã€€ã€€&lt;/rollingPolicy&gt; ã€€ã€€ã€€ã€€ã€€ã€€&lt;triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy"&gt; ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;maxFileSize&gt;5MB&lt;/maxFileSize&gt; ã€€ã€€ã€€ã€€ã€€ã€€&lt;/triggeringPolicy&gt; ã€€ã€€ã€€ã€€ã€€ã€€&lt;encoder&gt; ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&lt;pattern&gt;%-4relative [%thread] %-5level %logger{35} - %msg%n&lt;/pattern&gt; ã€€ã€€ã€€ã€€ã€€ã€€&lt;/encoder&gt; ã€€ã€€ã€€&lt;/appender&gt; ã€€ã€€ã€€&lt;root level="DEBUG"&gt; ã€€ã€€ã€€ã€€ã€€ã€€&lt;appender-ref ref="FILE" /&gt; ã€€ã€€ã€€&lt;/root&gt; &lt;/configuration&gt;</code></pre><p>å¤‡æ³¨ï¼šä¸Šè¿°é…ç½®è¡¨ç¤ºæŒ‰ç…§å›ºå®šçª—å£æ¨¡å¼ç”Ÿæˆæ—¥å¿—æ–‡ä»¶ï¼Œå½“æ–‡ä»¶å¤§äº5MBæ—¶ï¼Œç”Ÿæˆæ–°çš„æ—¥å¿—æ–‡ä»¶ã€‚çª—å£å¤§å°æ˜¯1åˆ°3ï¼Œå½“ä¿å­˜äº†3ä¸ªå½’æ¡£æ–‡ä»¶åï¼Œå°†è¦†ç›–æœ€æ—©çš„æ—¥å¿—ã€‚&lt;encoder>ï¼šå¯¹è®°å½•äº‹ä»¶è¿›è¡Œæ ¼å¼åŒ–ã€‚è´Ÿè´£ä¸¤ä»¶äº‹ï¼Œä¸€æ˜¯æŠŠæ—¥å¿—ä¿¡æ¯è½¬æ¢æˆå­—èŠ‚æ•°ç»„ï¼ŒäºŒæ˜¯æŠŠå­—èŠ‚æ•°ç»„å†™å…¥åˆ°è¾“å‡ºæµã€‚PatternLayoutEncoder æ˜¯å”¯ä¸€æœ‰ç”¨çš„ä¸”é»˜è®¤çš„encoder ï¼Œæœ‰ä¸€ä¸ª&lt;pattern>èŠ‚ç‚¹ï¼Œç”¨æ¥è®¾ç½®æ—¥å¿—çš„è¾“å…¥æ ¼å¼ã€‚ä½¿ç”¨â€œ%â€åŠ â€œè½¬æ¢ç¬¦â€æ–¹å¼ï¼Œå¦‚æœè¦è¾“å‡ºâ€œ%â€ï¼Œåˆ™å¿…é¡»ç”¨â€œ\â€å¯¹â€œ\%â€è¿›è¡Œè½¬ä¹‰ã€‚</p><p>ã€€ã€€ã€€ã€€5.4ã€è¿˜æœ‰SocketAppenderã€SMTPAppenderã€DBAppenderã€SyslogAppenderã€SiftingAppenderï¼Œå¹¶ä¸å¸¸ç”¨ï¼Œè¿™é‡Œå°±ä¸è¯¦è§£äº†ã€‚å¤§å®¶å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼ˆhttp://logback.qos.ch/documentation.htmlï¼‰ï¼Œè¿˜å¯ä»¥ç¼–å†™è‡ªå·±çš„Appenderã€‚</p><ul><li>ï¼ˆ6ï¼‰å­èŠ‚ç‚¹&lt;loger>ï¼šç”¨æ¥è®¾ç½®æŸä¸€ä¸ªåŒ…æˆ–å…·ä½“çš„æŸä¸€ä¸ªç±»çš„æ—¥å¿—æ‰“å°çº§åˆ«ã€ä»¥åŠæŒ‡å®š&lt;appender>ã€‚&lt;loger>ä»…æœ‰ä¸€ä¸ªnameå±æ€§ï¼Œä¸€ä¸ªå¯é€‰çš„levelå’Œä¸€ä¸ªå¯é€‰çš„additivityå±æ€§ã€‚</li></ul><p>å¯ä»¥åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ª&lt;appender-ref>å…ƒç´ ï¼Œæ ‡è¯†è¿™ä¸ªappenderå°†ä¼šæ·»åŠ åˆ°è¿™ä¸ªloger</p><p>ã€€ã€€ã€€ã€€name: ç”¨æ¥æŒ‡å®šå—æ­¤logerçº¦æŸçš„æŸä¸€ä¸ªåŒ…æˆ–è€…å…·ä½“çš„æŸä¸€ä¸ªç±»ã€‚</p><p>ã€€ã€€ã€€ã€€level: ç”¨æ¥è®¾ç½®æ‰“å°çº§åˆ«ï¼Œå¤§å°å†™æ— å…³ï¼šTRACE, DEBUG, INFO, WARN, ERROR, ALLå’ŒOFFï¼Œè¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šå€¼INHERITEDæˆ–è€…åŒä¹‰è¯NULLï¼Œä»£è¡¨å¼ºåˆ¶æ‰§è¡Œä¸Šçº§çš„çº§åˆ«ã€‚ å¦‚æœæœªè®¾ç½®æ­¤å±æ€§ï¼Œé‚£ä¹ˆå½“å‰logerå°†ä¼šç»§æ‰¿ä¸Šçº§çš„çº§åˆ«ã€‚</p><p>additivity: æ˜¯å¦å‘ä¸Šçº§logerä¼ é€’æ‰“å°ä¿¡æ¯ã€‚é»˜è®¤æ˜¯trueã€‚åŒ&lt;loger>ä¸€æ ·ï¼Œå¯ä»¥åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ª&lt;appender-ref>å…ƒç´ ï¼Œæ ‡è¯†è¿™ä¸ªappenderå°†ä¼šæ·»åŠ åˆ°è¿™ä¸ªlogerã€‚</p><ul><li>ï¼ˆ7ï¼‰å­èŠ‚ç‚¹&lt;root>:å®ƒä¹Ÿæ˜¯&lt;loger>å…ƒç´ ï¼Œä½†æ˜¯å®ƒæ˜¯æ ¹loger,æ˜¯æ‰€æœ‰&lt;loger>çš„ä¸Šçº§ã€‚åªæœ‰ä¸€ä¸ªlevelå±æ€§ï¼Œå› ä¸ºnameå·²ç»è¢«å‘½åä¸º"root",ä¸”å·²ç»æ˜¯æœ€ä¸Šçº§äº†ã€‚</li></ul><p>ã€€ã€€ã€€ã€€level: ç”¨æ¥è®¾ç½®æ‰“å°çº§åˆ«ï¼Œå¤§å°å†™æ— å…³ï¼šTRACE, DEBUG, INFO, WARN, ERROR, ALLå’ŒOFFï¼Œä¸èƒ½è®¾ç½®ä¸ºINHERITEDæˆ–è€…åŒä¹‰è¯NULLã€‚ é»˜è®¤æ˜¯DEBUGã€‚</p><p><strong>å…­ã€å¸¸ç”¨loggeré…ç½®</strong></p><pre><code>&lt;!-- show parameters for hibernate sql ä¸“ä¸º Hibernate å®šåˆ¶ --&gt;&lt;logger name="org.hibernate.type.descriptor.sql.BasicBinder" level="TRACE" /&gt;&lt;logger name="org.hibernate.type.descriptor.sql.BasicExtractor" level="DEBUG" /&gt;&lt;logger name="org.hibernate.SQL" level="DEBUG" /&gt;&lt;logger name="org.hibernate.engine.QueryParameters" level="DEBUG" /&gt;&lt;logger name="org.hibernate.engine.query.HQLQueryPlan" level="DEBUG" /&gt;&lt;!--myibatis log configure--&gt;&lt;logger name="com.apache.ibatis" level="TRACE"/&gt;&lt;logger name="java.sql.Connection" level="DEBUG"/&gt;&lt;logger name="java.sql.Statement" level="DEBUG"/&gt;&lt;logger name="java.sql.PreparedStatement" level="DEBUG"/&gt;</code></pre><p><strong>ä¸ƒã€Demo</strong></p><ul><li>ï¼ˆ1ï¼‰æ·»åŠ ä¾èµ–åŒ…logbackä½¿ç”¨éœ€è¦å’Œslf4jä¸€èµ·ä½¿ç”¨ï¼Œæ‰€ä»¥æ€»å…±éœ€è¦æ·»åŠ ä¾èµ–çš„åŒ…æœ‰slf4j-api</li></ul><p>logbackä½¿ç”¨éœ€è¦å’Œslf4jä¸€èµ·ä½¿ç”¨ï¼Œæ‰€ä»¥æ€»å…±éœ€è¦æ·»åŠ ä¾èµ–çš„åŒ…æœ‰slf4j-api.jarï¼Œlogback-core.jarï¼Œlogback-classic.jarï¼Œlogback-access.jarè¿™ä¸ªæš‚æ—¶ç”¨ä¸åˆ°æ‰€ä»¥ä¸æ·»åŠ ä¾èµ–äº†ï¼Œmavené…ç½®</p><pre><code>ã€€ã€€&lt;properties&gt;ã€€ã€€ã€€ã€€&lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;ã€€ã€€ã€€ã€€&lt;logback.version&gt;1.1.7&lt;/logback.version&gt;ã€€ã€€ã€€ã€€&lt;slf4j.version&gt;1.7.21&lt;/slf4j.version&gt;ã€€ã€€&lt;/properties&gt;ã€€ã€€&lt;dependencies&gt;ã€€ã€€ã€€ã€€&lt;dependency&gt;ã€€ã€€ã€€ã€€ã€€ã€€&lt;groupId&gt;org.slf4j&lt;/groupId&gt;ã€€ã€€ã€€ã€€ã€€ã€€&lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;ã€€ã€€ã€€ã€€ã€€ã€€&lt;version&gt;${slf4j.version}&lt;/version&gt;ã€€ã€€ã€€ã€€ã€€ã€€&lt;scope&gt;compile&lt;/scope&gt;ã€€ã€€ã€€ã€€&lt;/dependency&gt;ã€€ã€€ã€€ã€€&lt;dependency&gt;ã€€ã€€ã€€ã€€ã€€ã€€&lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;ã€€ã€€ã€€ã€€ã€€ã€€&lt;artifactId&gt;logback-core&lt;/artifactId&gt;ã€€ã€€ã€€ã€€ã€€ã€€&lt;version&gt;${logback.version}&lt;/version&gt;ã€€ã€€ã€€ã€€&lt;/dependency&gt;ã€€ã€€ã€€ã€€&lt;dependency&gt;ã€€ã€€ã€€ã€€ã€€ã€€&lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;ã€€ã€€ã€€ã€€ã€€ã€€&lt;artifactId&gt;logback-classic&lt;/artifactId&gt;ã€€ã€€ã€€ã€€ã€€ã€€&lt;version&gt;${logback.version}&lt;/version&gt;ã€€ã€€ã€€ã€€ã€€ã€€&lt;/dependency&gt;ã€€ã€€&lt;/dependencies&gt;</code></pre><ul><li>ï¼ˆ2ï¼‰logback.xmlé…ç½®</li></ul><pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;configuration debug="false"&gt;&lt;!--å®šä¹‰æ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨åœ°å€ å‹¿åœ¨ LogBack çš„é…ç½®ä¸­ä½¿ç”¨ç›¸å¯¹è·¯å¾„--&gt;&lt;property name="LOG_HOME" value="/home" /&gt;&lt;!-- æ§åˆ¶å°è¾“å‡º --&gt;&lt;appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender"&gt;&lt;encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder"&gt;&lt;!--æ ¼å¼åŒ–è¾“å‡ºï¼š%dè¡¨ç¤ºæ—¥æœŸï¼Œ%threadè¡¨ç¤ºçº¿ç¨‹åï¼Œ%-5levelï¼šçº§åˆ«ä»å·¦æ˜¾ç¤º5ä¸ªå­—ç¬¦å®½åº¦%msgï¼šæ—¥å¿—æ¶ˆæ¯ï¼Œ%næ˜¯æ¢è¡Œç¬¦--&gt;&lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/pattern&gt;&lt;/encoder&gt;&lt;/appender&gt;&lt;!-- æŒ‰ç…§æ¯å¤©ç”Ÿæˆæ—¥å¿—æ–‡ä»¶ --&gt;&lt;appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt;&lt;rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt;&lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºçš„æ–‡ä»¶å--&gt;&lt;FileNamePattern&gt;${LOG_HOME}/TestWeb.log.%d{yyyy-MM-dd}.log&lt;/FileNamePattern&gt;&lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt;&lt;MaxHistory&gt;30&lt;/MaxHistory&gt;&lt;/rollingPolicy&gt;&lt;encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder"&gt;&lt;!--æ ¼å¼åŒ–è¾“å‡ºï¼š%dè¡¨ç¤ºæ—¥æœŸï¼Œ%threadè¡¨ç¤ºçº¿ç¨‹åï¼Œ%-5levelï¼šçº§åˆ«ä»å·¦æ˜¾ç¤º5ä¸ªå­—ç¬¦å®½åº¦%msgï¼šæ—¥å¿—æ¶ˆæ¯ï¼Œ%næ˜¯æ¢è¡Œç¬¦--&gt;&lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/pattern&gt;&lt;/encoder&gt;&lt;!--æ—¥å¿—æ–‡ä»¶æœ€å¤§çš„å¤§å°--&gt;&lt;triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy"&gt;&lt;MaxFileSize&gt;10MB&lt;/MaxFileSize&gt;&lt;/triggeringPolicy&gt;&lt;/appender&gt;&lt;!-- æ—¥å¿—è¾“å‡ºçº§åˆ« --&gt;&lt;root level="INFO"&gt;&lt;appender-ref ref="STDOUT" /&gt;&lt;/root&gt;&lt;/configuration&gt;</code></pre><ul><li>ï¼ˆ3ï¼‰javaä»£ç </li></ul><pre><code>/**ã€€ã€€* Hello world!ã€€ã€€*/ã€€ã€€public class App {ã€€ã€€private final static Logger logger = LoggerFactory.getLogger(App.class);ã€€ã€€ã€€ã€€public static void main(String[] args) {ã€€ã€€ã€€ã€€ã€€ã€€logger.info("logback æˆåŠŸäº†");ã€€ã€€ã€€ã€€ã€€ã€€logger.error("logback æˆåŠŸäº†");ã€€ã€€ã€€ã€€ã€€ã€€logger.debug("logback æˆåŠŸäº†");ã€€ã€€ã€€ã€€}ã€€ã€€}</code></pre><ul><li>ï¼ˆ4ï¼‰è¾“å‡º</li></ul><div class=pgc-img><img alt=â€œåæµªâ€æ—¥å¿—æ¡†æ¶logbackçš„ä½¿ç”¨å’Œé…ç½®æ–‡ä»¶è¯¦è§£ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6952abc0607d49ac8e0969fc990ab769><p class=pgc-img-caption></p></div><p><strong>å…«ã€æ€»ç»“</strong></p><p>logbackçš„é…ç½®ï¼Œéœ€è¦é…ç½®è¾“å‡ºæºappenderï¼Œæ‰“æ—¥å¿—çš„logerï¼ˆå­èŠ‚ç‚¹ï¼‰å’Œrootï¼ˆæ ¹èŠ‚ç‚¹ï¼‰ã€‚å®é™…ä¸Šï¼Œå®ƒè¾“å‡ºæ—¥å¿—æ˜¯ä»å­èŠ‚ç‚¹å¼€å§‹ï¼Œå­èŠ‚ç‚¹å¦‚æœæœ‰è¾“å‡ºæºç›´æ¥è¾“å‡ºï¼Œå¦‚æœæ— ï¼Œåˆ¤æ–­é…ç½®çš„additivityï¼Œæ˜¯å¦å‘ä¸Šçº§ä¼ é€’ï¼Œå³æ˜¯å¦å‘rootä¼ é€’ï¼Œä¼ é€’åˆ™é‡‡ç”¨rootçš„è¾“å‡ºæºï¼Œå¦åˆ™ä¸è¾“å‡ºæ—¥å¿—ã€‚</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'é…ç½®æ–‡ä»¶','æ—¥å¿—','logback'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>