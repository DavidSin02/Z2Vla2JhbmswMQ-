<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>系统设计硬核知识（4）——操作系统的设备管理 | 极客快訊</title><meta property="og:title" content="系统设计硬核知识（4）——操作系统的设备管理 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/1f793466987142cdae563f1db5911020"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f1a871a.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f1a871a.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f1a871a.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f1a871a.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f1a871a.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f1a871a.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f1a871a.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f1a871a.html><meta property="article:published_time" content="2020-10-29T20:59:28+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:28+08:00"><meta name=Keywords content><meta name=description content="系统设计硬核知识（4）——操作系统的设备管理"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/f1a871a.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>系统设计硬核知识（4）——操作系统的设备管理</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>在计算机系统中，除了处理器和内存之外，其他的大部分硬设备称为外部设备。它包括输入/输出设备，辅存设备及终端设备等。这些设备种类繁多，特性各异，操作方式的差异很大，从而使操作系统的设备管理变得十分繁杂。</p><p>设备管理程序一般要提供下述功能：</p><ol start=1><li>提供和进程管理系统的接口，当进程要求设备资源时，该接口将进程要求转达给设备管理程序 。</li><li>进行设备分配。按照设备类型和相应的分配算法把设备和其他有关的硬件分配给请求该设备的进程，并把未分配到所请求设备或其他有关硬件的进程放入等待队列 。</li><li>实现设备和设备 、 设备和 CPU 等之间的并行操作。</li><li>进行缓冲区管理。主要减少外部设备和内存与 CPU 之间的数据速度不匹配的问题，系统中一般设有缓冲区 ( 器 ) 来暂放数据。设备管理程序负责进行缓冲区分配 、 释放及有关的管理工作 。</li></ol><h2 class=pgc-h-arrow-right>1 数据传输控制方式</h2><p>设备管理的主要任务之一是控制设备和内存或 CPU 之间的数据传送。</p><p>选择和衡量控制方式的原则如下： （1）数据传送速度足够高，能满足用户的需要但又不丢失数据。 （2）系统开销小，所需的处理控制程序少。 （3）能充分发挥硬件资源的能力，使得 I/O 设备尽量处于使用状态中，而 CPU 等待时间少。</p><p>外围设备和内存之间常用的数据传送控制方式：</p><p>（1）程序控制方式。处理器启动数据传输，然后等设备完成。此方式不能实现并发。 （2）中断方式。中断方式的数据传输过程是这样的，进程启动数据传输（如读）后，该进程放弃处理器，当数据传输完成，设备控制器产生中断请求，中断处理程序对数据传输工作处理之后，让相应进程成为就绪状态。以后，该进程就可以得到所需要的数据。 （3）直接存储访问（Direct Memory Access， DMA）方式。指外部设备和内存之间开辟直接的数据交换通路。除了控制状态寄存器和数据缓冲寄存器外， DMA 控制器中还包括传输字节计数器、内存地址寄存器等。 DMA 方式采用窃取（或挪用）处理器的工作周期和控制总线而实现辅助存储器和内存之间的数据交换。有的 DMA 方式也采用总线浮起方式传输 大批量数据。 （4）通道方式。通道又称为输入/输出处理器（Input/Output Processor， IOP），可以独立完成系统交付的输入/输出任务，通过执行自身的输入/输出专用程序（称通道程序）进行内存和外设之间的数据传输。主要有 3 种通道：字节多路通道、选择通道和成组多路通道。 （5）输入输出处理机。输入输出处理机也称为外围处理机，它是一个专用处理机，也可以是一个通用的处理机，具有丰富的指令系统和完善的中断系统。专用于大型 、 高效的计算机系统处理外围设备的输入输出，并利用共享存储器或其他共享手段与主机交换信息。从而使大型 、 高效的计算机系统更加高效地工作。与通道相比，输入输出处理机具有比较丰富的指令系统，结构接近于一般的处理机，有自己的局部存储器。</p><h2 class=pgc-h-arrow-right>2 磁盘调度算法</h2><p>访问磁盘的时间由3部分构成，它们是寻道 ( 查找数据所在的磁道 ) 时间 、 等待 ( 旋转等待扇区 ) 时间和数据传输时间，其中寻道时间 ( 查找时间 ) 是决定因素。</p><p>( 1 ) FCFS （first come first service）算法 : 有些文献称为 FIFO 算法 。FCFS 是一种最简单的磁盘调度算法，按先来先服务的次序，未作优化。这种算法的优点是公平 、 简单，且每个进程的请求都能依次得到处理，不会出现某一进程的请求长期得不到满足的情况。此算法未对寻道进行优化，致使平均寻道时间可能较长。</p><p>( 2 ) SSTF ( ShortestSeekTimeFirst，最短寻道时间优先 ) 算法 : 选择这样的进程，其要求访问的磁道距当前磁头所在的磁道距离最近，以使每次寻道的时间最短 。FCFS 会引起读写头在盘面上的大范围移动， SSTF 查找距离磁头最短 ( 也就是查找时间最短 ) 的请求作为下一次服务的对象。 SSTF 查找模式有高度局部化的倾向，会推迟一些请求的服务，甚至引起无限拖延 ( 这种现象称为 “ 饥饿” )</p><p>( 3 ) SCAN ( 电梯 ) 算法 : 不仅考虑到欲访问的磁道与当前磁道的距离，而且优先考虑的是磁头的当前移动方向，是在磁头前进方向上的最短查找时间优先算法，它排除了磁头在盘面局部位置上的往复移动 。SCAN 算法在很大程度上消除了 SSTF 算法的不公平性，但仍有利于对中间磁道的请求 。SCAN 算法的缺陷是当磁头刚由里向外移动过某一磁道时，恰有一进程请求访向此磁道，这时进程必须等待，待磁头由里向外，然后再从外向里扫描完所有要访问的磁道后，才处理该进程的请求，致使该进程的请求被严重地推迟。</p><p>（4 ) N - SCAN ( N 步 SCAN ) 算法 : 这是对 SCAN 算法的改良，磁头的移动与 SCAN 算法是一样的，不同的是扫描期间只对那些在扫描开始前已等待服务的请求提供服务。在服务期间，新到达的请求即使在磁头前进方向上也得不到服务，直到下一个新扫描周期开始。 N - SCAN 算法的实质是把 FCFS 和 SCAN 的优点结合起来，以便取得较好的性能。如果新到达的请求按优化次序排列，则下一个扫描周期必然花费最少的磁头移动时间。</p><p>（5 ) C- SCAN (循环扫描 ) 算法 : 这是对 SCAN 算法的另一种改良，是单向服务的 N 步 SCAN 算法，C- SCAN 算法规定磁头单向移动。C- SCAN 算法彻底消除了对两端磁道请求的不公平。</p><h2 class=pgc-h-arrow-right>3 虚设备与 SPOOLING 技术</h2><p>采用假脱机技术，可以将低速的独占设备改造成一种可共享的设备，而且一台物理设备可以对应若干台虚拟的同类设备。假脱机（ Simultaneous Peripheral Operation On Line，SPOOLING）的意思是外部设备同时联机操作，又称为假脱机输入/输出操作，采用一组程序或进程模拟一台输入/输出处理器。</p><p>SPOOLING 系统的组成如图 1 所示。该技术利用了专门的外围控制机将低速 I/O 设备上的数据传送到高速设备上，或者相反。但是当引入多道程序后，完全可以利用其中的一道程序来模拟脱机输入时的外围控制机的功能，把低速的 I/O 设备上的数据传送到高速磁盘上；再利用另一道程序来模拟脱机输出时外围控制机的功能，把高速磁盘上的数据传送到低速的 I/O 设备上。这样便可以在主机的控制下实现脱机输入、输出的功能。此时的外围操作与 CPU 对数据的处理同时进行。</p><div class=pgc-img><img alt=系统设计硬核知识（4）——操作系统的设备管理 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1f793466987142cdae563f1db5911020><p class=pgc-img-caption></p></div><p>从图 1 可以看出， Spooling 系统主要包括以下3个部分 :</p><ol start=1><li>输入井和输出井 : 这是在磁盘上开辟出来的两个存储区域。输入井模拟脱机输入时的磁盘，用于存放 IO 设备输入的数据 : 输出井模拟脱机输出时的磁盘，用于存放用户程序的输出数据。因此， Spooling 系统必须有高速 、 大容量 、 随机存取的外存的支持。</li><li>输入缓冲区和输出缓冲区 : 这是在内存中开辟的两个缓冲区。输入缓冲区用于暂存有输入设备送来的数据，以后再传送到输出井。输出缓冲区用于暂存从输出井送来的数据，以后再传送到输出设备 。</li><li>输入进程和输出进程 : 输入进程模拟脱机输入时的外围控制机，将用户要求的数据有输入设备到输入缓冲区，再送到输入井。当 CPU 需要输入设备时，直接从输入井读入内存。输出进程模拟脱机输出时的外围控制机，把用户要求输入的数据，先从内存送到输出井，待输出设备空闲时，再将输出井中的数据，经过输出缓冲区送到输出设备上 。</li></ol><p>采用假脱机技术，可以将低速的独占设备改造成一种可共享的设备，而且一台物理设备可以对应若干台虚拟的同类设备。 SPOOLING 系统必须有高速、大容量并且可随机存取的外存（例如，磁盘或磁鼓）支持。</p><blockquote><p>在现代计算机系统中，还可以用一台设备来模拟自身。例如，常见 的多窗口技术，即在一个终端上开多个窗口，每个窗口可以独立地进行显示，以监视用户不同任务的执行情况。这是通过缩小显示区域、平铺或重叠显示来模拟多个显示器的。</p></blockquote><p><br>作者：deniro<br>链接：https://www.jianshu.com/p/c3cfbe59babf<br>来源：简书<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'系统','硬核','设计'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../cn/%E7%A7%91%E6%8A%80/2afaa51.html alt=系统设计硬核知识（3）——操作系统的存储管理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a2c9937a2cbb43779cc2c22c10f83199 style=border-radius:25px></a>
<a href=../../cn/%E7%A7%91%E6%8A%80/2afaa51.html title=系统设计硬核知识（3）——操作系统的存储管理>系统设计硬核知识（3）——操作系统的存储管理</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>