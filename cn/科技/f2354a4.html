<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>一种基于物联网技术的氦质谱检漏系统 | 极客快訊</title><meta property="og:title" content="一种基于物联网技术的氦质谱检漏系统 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/RQzOoNFBUlDMUi"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f2354a4.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f2354a4.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f2354a4.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f2354a4.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f2354a4.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f2354a4.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f2354a4.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f2354a4.html><meta property="article:published_time" content="2020-10-29T20:53:40+08:00"><meta property="article:modified_time" content="2020-10-29T20:53:40+08:00"><meta name=Keywords content><meta name=description content="一种基于物联网技术的氦质谱检漏系统"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/f2354a4.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>一种基于物联网技术的氦质谱检漏系统</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>氦质谱检漏技术，用于内部充压容器和管路的无损检测，一直是国防工业领域的重要检测手段，具备自动化功能的充氦检漏系统是该领域的研制热点之一。现有的氦质谱检漏系统普遍存在以下问题：(1)利用检漏仪监测被检部位氦分压信号变化情况时，一般采用人工现场观测记录的方式，对于某些大体积容器，氦信号的稳定周期较长，候检时间长，不利于人力资源的合理分配；(2)系统核心控制器多采用PLC(Programmable Logic Controller)，控制器与当前较流行的物理接口兼容性不强，布线繁琐，内存资源和编程模式有限，算法实现与交互方式不够灵活。</p><p>为克服上述现有技术缺陷，本系统拟提出一种基于技术的氦质谱检漏系统设计与实现方案。该系统由主控模块、信息采集模块、执行模块组成，各模块间采用无线方式进行通信，由主控模块根据采集到的信息对检漏流程执行步骤进行合理控制，并通过在现场快速预测反应时间，提高候检效率，最后，将测量数据备份至云平台，便于后期的查询和分析，从而实现了氦质谱检漏过程的便捷化、自动化、智能化。</p><p><strong>1 系统方案</strong></p><p><strong>1.1 背景原理</strong></p><p>如图1所示，氦质谱检漏技术<sup>[1]</sup>需要首先将一定压强的氦气充入被检工件，被检工件外面是具有一定真空度要求的真空箱，真空箱与氦质谱检漏仪的检漏口相接。若被检工件有漏，则漏入真空箱的氦分压可通过氦质谱检漏仪测出，满足公式<sup>[2]</sup>：</p><p>式中P<sub>He</sub>为被检工件的氦分压，单位为Pa；S<sub>He</sub>为真空系统对氦的抽速，单位为m<sup>3</sup>/s；Q<sub>He</sub>为单位时间内进入检漏仪质谱室的氦气量，即漏孔的漏率，单位为Pa·m<sup>3</sup>/s；V为被检工件的体积。</p><img alt=一种基于物联网技术的氦质谱检漏系统 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RQzOoNFBUlDMUi><p>从式(1)可看出，真空度变化速度与系统抽速和容积有关。式(1)中令τ=V/S<sub>He</sub>为系统反应时间常数。当t到达1倍时间常数（t=τ）时，真空度为初始值的36.8%；当到达5倍反应时间后，氦分压信号P<sub>He</sub>下降到初始值的1%，认为检漏信号达到稳定状态，可以读取工件漏率,根据漏率判定工件的密封性。</p><p><strong>1.2 灰度预测算法</strong></p><p>灰度预测算法<sup>[3]</sup>非常适合处理指数类型的数据，符合氦分压P<sub>He</sub>的反应规律，并只需要较少的数据样本就能进行预测运算，能够较快地得到反应时间常数τ，以5τ的时间点作为漏率读取时机，算法自身的叠加递减运算滤除了信号噪声，可以提高预测精度，原理如下：</p><p>设有原始序列：x<sup>(0)</sup>=(x<sup>(0)</sup>(1)，x<sup>(0)</sup>(2)，…，x<sup>(0)</sup>(n))，x<sup>(1)</sup>(k)表示数列x<sup>(0)</sup>对应前k项数据的累加：</p><img alt=一种基于物联网技术的氦质谱检漏系统 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RQzOoNS2isUfOZ><p><strong>1.3 氦检漏系统整体设计</strong></p><p>本系统共设计三类信息采集节点：涉及压力、真空度、氦分压三个参数；两类执行机构：电磁阀和罗茨泵，分别靠继电器和接触器控制，罗茨泵接触器处安装有三相保护。主控板上的协调器与采集节点和执行机构采用ZigBee树状网络通信，利用无线网卡的AP热点模式配合工控机接入，实现更复杂的上位机程序，也可通过无线路由方式将数据转存至云平台，以备远程调用和分析。</p><p>采集节点的数值会周期性上传至协调器，经SPI接口汇总到主控制器进行分析处理和故障报警，按照作业流程和时机，主控制器会向执行机构发送命令，执行机构根据约定的数据帧格式解析命令，完成电磁阀与罗茨泵的联动，最终，主控制器执行灰度算法预测氦分压稳定时机，择机完成工件漏率的读取。同时，主控制模块还能实现数据的本地SD卡备份，通过液晶屏进行简单的参数设置和曲线绘制。具体结构如图2所示。</p><img alt=一种基于物联网技术的氦质谱检漏系统 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RQzOoNgE18FzJa><p><strong>2 系统硬件设计</strong></p><p><strong>2.1 主控模块硬件设计</strong></p><p>主控模块采用ARM Linux架构，芯片采用S5PV210，32 KB一级缓存，512 KB二级缓存，主频高达1 GHz，可胜任一般的算法需求，外设丰富，选用Linux2.6.35.7内核版本开发。通过SPI接口控制ZigBee协调器，完成信息的采集和命令下发，氦分压值及预测后的稳定反应时间会通过液晶屏实时显示，历史数据存储到本地SD卡中，USB无线网卡完成数据的网络上传与共享。具体硬件设计如图3所示。</p><img alt=一种基于物联网技术的氦质谱检漏系统 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RQzOoNtlwfKFW><p><strong>2.2 信息采集节点硬件设计</strong></p><p>压力采集节点的压力变送器选用麦克MPM4780，RS485接口，量程10 MPa，通过MAX485接入ZigBee模块，模块芯片CC2530利用IO口P1_4控制MAX485的收发工作，当UART发送完成产生中断时，P1_4需延时3 ms(9 600波特率下)再输出低电平，等待缓冲器内的数据发送完毕。</p><p>氦质谱检漏仪为莱宝公司的L200型，和真空度计都具有RS232接口，通过常见的MAX232芯片接入ZigBee模块。</p><p><strong>2.3 执行机构硬件设计</strong></p><p>采用驱动继电器控制三相交流接触器线圈的吸合，达到控制罗茨泵启停的目的，如图4所示。继电器由ULN2003A驱动，使用12 V锂电池供电，控制信号由CC2530的GPIO口经反相器74HC14接入ULN2003A，电磁阀的控制与接触器线圈类似。</p><img alt=一种基于物联网技术的氦质谱检漏系统 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RQzOoWvI5BZvGn><p><strong>2.4 电源模块硬件设计</strong></p><p>如图5所示，普通220 V交流电源经过220 V/15 V的变压器之后变为15 V的交流电，再经过KBP307G整流桥进行整流，稳压之后变成了稳定的直流电输出，由开关型稳压芯片RT7272将直流电压降压成5 V，最后通过低压差线性稳压电源AMS1086-3.3为主控模块供电。</p><p><strong>3 系统软件设计</strong></p><p><strong>3.1 主控制板软件设计</strong></p><p>主控板采用Ubuntu14.04+QT4.8.3开发环境，主要负责WiFi网络通信、SPI设备的交互与管理、工作流程的控制和灰度预测算法的实现，此外，移植编写了Qt界面程序，可以通过液晶屏，现场进行参数设置和曲线实时观测。软件具体工作流程如图6所示。</p><img alt=一种基于物联网技术的氦质谱检漏系统 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RQzOoXKFj4wY2D><p><strong>3.2 Linux驱动层开发</strong></p><p><strong>3.2.1 无线网卡驱动的移植</strong></p><p>主控芯片通过USB接口控制MT7601无线网卡，需要进行驱动的移植。移植步骤如下：在源码包中rtusb_dev_id.c文件中的rtusb_dev_id中确认MT7601的PID、VID与硬件信息是否匹配，标准值应为{USB_DEVICE(0x148f,0x7601)}；修改Makefile，设置平台、内核源码树路径和交叉编译工具链路径；确保config.mk文件中WPA_SUPPLICANT=y来添加wpa_supplicant支持，用来WiFi联网配置；修改include/rtmp_def.h文件中的INF_MAIN_DEV_NAME和INF_MBSSID_DEV_NAME，为网卡改名，之后编译安装即可。</p><p><strong>3.2.2 SPI驱动编写</strong></p><p>主控芯片与CC2530通过SPI接口进行高速全双工通信，相应的驱动实现依靠Linux的SPI驱动框架，该框架分为SPI核心层、SPI控制器驱动层和SPI设备驱动层。编写主要集中在SPI设备驱动层，分为两部分：先调用接口函数spi_new_device在SPI总线上利用板载资源信息注册设备；再调用接口函数spi_register_driver在SPI总线注册设备驱动里的各类方法，当设备与驱动的名称参数匹配时，会调用探测函数probe，在该函数中，把SPI设备注册成一个字符设备，申请相应硬件资源，定义硬件接口方法ioctl，构造ioctl命令：如参数设置、开关量控制等，为应用层提供文件接口，数据的发送与接收流程基本一致，都需利用spi_message和spi_transfer结构体，依次调用spi_message_init函数、spi_message_add_tail函数、spi_sync函数，区别在于发送和接收的缓冲区定义。</p><p><strong>3.3 监测与执行节点软件设计</strong></p><p>监测与执行节点使用ZigBee通信，需要使用ZStack协议栈，该协议栈定义了操作系统抽象层（Operating System Abstraction Layer），采用轮询的方式，并引入了优先级的概念。其中，taskArr[taskID]存储了任务处理函数，taskEvents[taskID]存储了各任务对应的事件，taskID代表了各任务的优先级，系统在各层初始化完成后，会轮询调用osal_run_systerm函数根据优先级运行所有任务，并判断各任务对应的事件是否发生，执行相应的事件处理函数。各前端ZigBee节点程序基于ZStack协议栈的SAPI（Simple Application Interface）框架进行开发，利用框架内的无线数据包命令键值提取函数_process_command_call对接收到的命令进行解析处理。此外，用户事件由定时器触发，优先级取最低，taskID=6，相应的事件处理函数为MyEventProcess，完成监测值的周期性上传。此外，在F8wConfig.cfg文件选择信道，可规避WiFi信号对ZigBee的同频干扰，本文选择11信道。具体程序流程如图7所示。</p><img alt=一种基于物联网技术的氦质谱检漏系统 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RQzOoXXEccyQgm><p><strong>3.4 通信协议数据格式</strong></p><p>本系统使用的智云物联网接入平台是基于云计算与互联网的平台，具有免应用编程的BS项目发布系统，Android组态系统，LabVIEW数据接入系统，支持手机和Web远程访问及控制，能够提供免费的物联网大数据存储服务。为保证与该平台的数据兼容性，本系统无线类通信协议数据格式为“{[参数]=[值]，[参数]=[值]，}”，每条数据以“{}”为起止符，如果“{}”内有多个参数，用“，”分隔。通信协议参数为A0～A7：传感器数值；D0：Bit0～Bit7分别对应A0～A7的状态（上传或设置？）；D1：开关量控制；V0～V3：传感器承参数。</p><p>氦质谱检漏仪和真空计数据格式参考常见的Modbus-RTU协议格式，由设备地址、功能码、数据、结束符组成，采用求和校验方式。</p><p><strong>4 评测</strong></p><p>为进一步验证该系统灰度预测反应时间算法的有效性，开展了一系列反应时间测量实验及数据对比。利用真空检漏系统分别检测容积为6L、11L、20L和41L的工件容器，由系统自主完成检漏流程，并通过算法预测四种体积状态下的系统反应时间数据，对比传统人工肉眼观测到的反应时间数据。每个体积状态下反复测量3次取均值，实验数据如表1所示。</p><img alt=一种基于物联网技术的氦质谱检漏系统 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RQzOoXkzN7Xjp><p>通过结果对比可知，系统的灰度预测算法可以有效地预测的系统反应时间，在大体积容器检漏的工况下，能够实现提高候检效率的目标。</p><p><strong>参考文献</strong></p><p>[1] LAFFERTY J M，RUBIN L G.Foundations of vacuum science and technology[M].Foundations of Vacuum Science and Technology.Wiley，1998：86-88.</p><p>[2] 陈涛，廖旭东，黄颖军，等.一种快速准确获取真空氦质谱检漏系统反应时间的方法研究[J].真空科学与技术学报，2016，36(5)：542-546.</p><p>[3] 余修武，张可，周利兴，等.基于无偏灰色马尔科夫预测WSN数据融合算法[J].传感技术学报，2018，31(8)：130-133.</p><p><strong>作者信息:</strong></p><p>付良瑞，朱宝良，邓金球，陈 涛，白国云</p><p>(西北核技术研究所，陕西 西安710024)</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'一种','物联网','技术'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>