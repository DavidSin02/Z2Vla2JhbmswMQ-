<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>零基础学C语言（7）：存储类型 | 极客快訊</title><meta property="og:title" content="零基础学C语言（7）：存储类型 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/d4475d28cb274ff7941c31682ecc9a91"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f51eb589.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f51eb589.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f51eb589.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f51eb589.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f51eb589.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f51eb589.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f51eb589.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f51eb589.html><meta property="article:published_time" content="2020-11-14T20:59:55+08:00"><meta property="article:modified_time" content="2020-11-14T20:59:55+08:00"><meta name=Keywords content><meta name=description content="零基础学C语言（7）：存储类型"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/f51eb589.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>零基础学C语言（7）：存储类型</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>前四节，我们从编写一个计算器的角度，讨论出编程语言需要数据类型、变量和常量，并详细介绍了这三个概念。那么编写一个计算器还需要哪些东西呢？</p><p>我们想想看，当我们想设计一个比较复杂的程序，例如开发一款游戏时，我们不可能写在一个文件下吧，那这个文件得多庞大。</p><p>比如说王者荣耀，是一个团队共同开发的，例如我设计韩信的动作和技能介绍，他设计李白的凤求凰皮肤，另一个人设计镜的出装。用膝盖想一想，这么多人不可能围在一起对一个文件指指点点，否则策划与程序员之间，岂不是天天“你在教我做事？”</p><p>虽然不在一块，但各个文件之间没有交流么？</p><p>有时候李白和王昭君在同一局游戏碰到，会产生一些奇怪的台词，所以不同文教是有交流的，那怎么产生联系呢？</p><p>这就是今天的重点——<strong>存储类型</strong>。</p><p>存储类型是干嘛的呢？</p><p>简单来说，<strong>存储类型是用来定义C程序变量/函数的范围（可见性）和生命周期的。具体分为四类：auto、register、static、extern</strong>。</p><p>我们挨个来看：</p><h1 class=pgc-h-center-line><strong>auto存储类</strong></h1><p><strong>auto是用来修饰局部变量的</strong>，如果局部变量前没有存储类型，默认为auto类型，例如我们通常看到的int a;，实际是auto int a;。</p><h1 class=pgc-h-center-line><strong>register存储类</strong></h1><p><strong>register是寄存器类型，顾名思义，是把修饰的变量放到寄存器中，目的是为了提高程序的运行效率</strong>。但要记住，不管是单片机也好，计算机也罢，任何CPU的寄存器资源都是有限的，如果寄存器满了，被修饰的变量就会默认回到auto类型。</p><p><strong>一般格式：register 数据类型 变量；</strong></p><h1 class=pgc-h-center-line><strong>extern存储类</strong></h1><p>前面提过，如何在不同文件之间交流？</p><p>嘿嘿，extern就是一个很好的方法。</p><p><strong>extern是外部引用类型，主要是引用统一工程中的全局变量或函数</strong>，什么意思呢？就是说，我想用其他文件的变量或函数，那么就需要使用extern这个关键字。</p><p>我们上一节提到过，定义在内存上是分配空间的，而<strong>使用extern是在声明，意思是告诉编译器该变量存在空间，但并不是在声明处开辟的空间</strong>。</p><p>怎么去用呢？</p><p>假设在第一个c文件，我们定义：int a;在另一个文件我们想要使用第一个文件中的a，我们就需要在第二个c文件中加上extern int a;这样这个a就在这两个文件共享。</p><h1 class=pgc-h-center-line><strong>static存储类</strong></h1><p>static这个关键字非常重要，为啥呢？因为面试题经常考。</p><p><strong>当static修饰全局变量或函数时，限制变量或函数的作用域，表示只能在本文中使用；当static修饰局部变量时，改变局部变量的存放位置，延长局部变量的生命周期，运算的结果保留上一次的结果</strong>。</p><p>“改变局部变量的存放位置”，怎么理解这句话呢？</p><p>这就要提到C语言的内存管理了，这个我们后面详细说，这里我们简单提一下：</p><p>首先，<strong>我们要知道计算机中的内存是分区来管理的，程序和程序之间的内存是独立的，不能互相访问，比如QQ和王者荣耀分别所占的内存区域是不能相互访问的。而每个程序的内存也是分区管理的，一个应用程序所占的内存可以分为很多个区域。</strong></p><p>我们需要了解的区域有四个，分别是栈区、堆区、静态区和代码区。通常我们定义的局部变量，是存放在栈区的，并且局部变量的生命周期在该语句块执行结束时便结束了。</p><p>但我们用static修饰，该变量便存放在静态数据区，其生命周期一直持续到整个程序执行结束。但是其作用域并没有改变，它仍然是一个局部变量，作用域仅限于该语句块。</p><p>而当static修饰全局变量或函数时，该变量或函数仅在本文使用，就没法和其他文件产生交流，用extern关键字都不行。</p><p>这个我们一般什么时候用呢？</p><p>因为每一个大工程都不是一个人完成的，当某人在某一文件使用一个全局变量时，另一个人在其他文件可能也定义了一个相同的全局变量，这样会发生冲突，所以干脆用static修饰，以防发生奇怪的BUG。</p><p>因为有了static这个关键字，变量从全局变量和局部变量这两种，就变成了全局变量、局部变量、静态全局变量、静态局部变量四种。</p><p>他们之间怎么区别呢？</p><h1 class=pgc-h-center-line><strong>全局变量、局部变量、静态全局变量、静态局部变量的区别</strong></h1><div class=pgc-img><img alt=零基础学C语言（7）：存储类型 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d4475d28cb274ff7941c31682ecc9a91><p class=pgc-img-caption></p></div><p><strong>从作用域看：</strong></p><p><strong>1、全局变量具有全局作用域。全局变量只需在一个源文件中定义，就可以作用于所有的源文件。当然，其他不包含全局变量定义的源文件需要用extern 关键字再次声明这个全局变量。</strong></p><p><strong>2、静态局部变量具有局部作用域，它只被初始化一次，自从第一次被初始化直到程序运行结束都一直存在，它和全局变量的区别在于全局变量对所有的函数都是可见的，而静态局部变量只对定义自己的函数体始终可见。</strong></p><p><strong>3、局部变量也只有局部作用域，它是自动对象（auto），函数的一次调用执行结束后，变量被撤销，其所占用的内存也被收回。</strong></p><p><strong>4、静态全局变量也具有全局作用域，它作用于定义它的文件里，不能作用到其它文件里，即被static关键字修饰过的变量具有文件作用域。这样即使两个不同的源文件都定义了相同名字的静态全局变量，它们也是不同的变量。</strong></p><p><strong>从分配内存空间看：</strong></p><p><strong>1、全局变量，静态局部变量，静态全局变量都在静态存储区分配空间，而局部变量在栈里分配空间。</strong></p><p><strong>2、全局变量本身就是静态存储方式， 静态全局变量当然也是静态存储方式。这两者的区别虽在于非静态全局变量的作用域是整个源程序。而静态全局变量则限制了其作用域，即只在定义该变量的源文件内有效，在同一源程序的其它源文件中不能使用它。</strong></p><p><strong>· 1)静态变量会被放在程序的静态数据存储区(全局可见)中，这样可以在下一次调用的时候还可以保持原来的赋值。这一点是它与堆栈变量和堆栈变量和堆变量的区别。</strong></p><p><strong>· 2)变量用static告知编译器，自己仅仅在变量的作用范围内可见。这一点是它与全局变量的区别。</strong></p><h1 class=pgc-h-center-line><strong>总结</strong></h1><p><strong>本节介绍了auto、register、static、extern这四种存储类型，并介绍了全局变量、局部变量、静态全局变量、静态局部变量这四种变量的区别，对于内存管理这一块的知识点大家能看懂最好，不能看懂也没关系，后面我们会详述。存储类型到这里就是说完了，下一节将进入到运算符的学习。</strong></p><h1 class=pgc-h-center-line><strong>上节作业分析</strong></h1><p>1.下列程序的输出结果是16.00，请填空</p><p>#include &lt;stdio.h></p><p>int main（）</p><p>{</p><p>int a = 9, b = 2;</p><p>float x = _____,y = 1.1, z;</p><p>z = a/2 + b*x/y + 1/2;</p><p>printf("%5.2f\n", z);</p><p>return 0;</p><p>}</p><p>已知a = 9，b = 2；z = 9/2 + 2*x/1.1 + 1/2;在C语言中，如果运算时，浮点型向整型进行强制转换时注意精度丢失的问题</p><p>怎么理解呢？定义的a和b是整数，9/2 = 4.5，但由于a是int型，得到的结果为整数，即4，而1/2则为0，所以z = 4+2*x/1.1 = 16，解方程得x = 6.6</p><p>2.以下程序运行后的输出结果是：（ ）</p><p>#include &lt;stdio.h></p><p>#define S(x) 4*x*(x)+1</p><p>int main()</p><p>{</p><p>int i=6,j=8;</p><p>printf("%d\n",S(i+j));</p><p>return 0;</p><p>}</p><p>根据上一节我们说的，遇到这种宏定义问题要整体代入，S(i+j) = 4*i+j*(i+j)+1 = 4*6+8*(6+8)+1 = 137</p><h1 class=pgc-h-center-line><strong>本节作业</strong></h1><p>下面程序输出结果是什么？</p><div class=pgc-img><img alt=零基础学C语言（7）：存储类型 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f319b8d728824c5a80edfd4fe9ef2b28><p class=pgc-img-caption></p></div><p><strong>温馨提示：第一节有一个很奇怪的链接，大家记得保存哦~</strong></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'零基','语言','存储类'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>