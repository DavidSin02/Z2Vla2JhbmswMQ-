<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>5组常用的函数嵌套 | 极客快訊</title><meta property="og:title" content="5组常用的函数嵌套 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/1f57ca0840244f2ab3d1faf07ee066a9"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f682f19.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f682f19.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f682f19.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f682f19.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f682f19.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f682f19.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f682f19.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f682f19.html><meta property="article:published_time" content="2020-10-29T20:51:17+08:00"><meta property="article:modified_time" content="2020-10-29T20:51:17+08:00"><meta name=Keywords content><meta name=description content="5组常用的函数嵌套"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/f682f19.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>5组常用的函数嵌套</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>Excel有400多个函数，在实际工作中，运用单一函数并不能解决所有的数据处理与分析问题。</p><p>更多的时候，我们需要对函数进行嵌套来实现更复杂的数据计算。</p><p>今天给大家分享5组常用的函数嵌套，非常适合收藏噢~</p><p>1</p><p><strong>if函数的嵌套</strong></p><p>函数的嵌套，简单地说，就是一个函数中含有其他函数。</p><p>嵌套函数最常用的方法就是拆分，就像剥洋葱一样，一层层剥开。</p><p>括号是函数的一个重要组成部分，一对括号就是一层函数，顺着括号，由外向内一层层剥开，就能看出函数的结构了。</p><p>下面就以if函数为例介绍单独if函数的嵌套及if函数与其他函数的嵌套。<br></p><p><strong>❶ 单独if函数的嵌套</strong></p><p>if函数的嵌套可以解决年终考核等级的问题，例如，下面这个例子。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1f57ca0840244f2ab3d1faf07ee066a9><p class=pgc-img-caption></p></div><p>这是本月几名员工的业绩，公司规定，超过300000元的为“优秀”，超过250000元的为“良 好”，超过200000元的为“合格”，其他为“不合格”，那该如何计算等级呢？这就需要使用if函数的嵌套了，如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8f9d18401b4644c18cba5d3ded26038e><p class=pgc-img-caption></p></div><p>也许有人会说函数太长了，看不懂，没关系，把这个函数的格式调一下，如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3637749ca4ef4cb0bb0d477c450ae793><p class=pgc-img-caption></p></div><p>这样就比较好理解了，意思是大于300000元就是“优秀”，大于250000元就是“良好”，大于200000元就是“合格”，剩下的就是“不合格”了。<br></p><p><strong>❷ if函数与or函数的嵌套</strong></p><p>例如，某公司考核员工业绩，如果3个月中有任意1个月超过30万元，本季度考核就算合格，否则为不合格。那这该怎么做呢？</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dabbf0025791460fb712176c94bec6e2><p class=pgc-img-caption></p></div><p>因为是三选一，所以需要使用到or函数，or函数的基本格式如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/42c91227fb4248878c79c1a1ee41d314><p class=pgc-img-caption></p></div><p>or函数可以有30个参数，只要有1个为真，整个函数的返回值即为true，如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f0c164044963469ea1f885db68a1dc39><p class=pgc-img-caption></p></div><p><strong>❸ if函数与and函数的嵌套</strong></p><p>如果公司要求只有每个月都合格，最终才能算合格怎么办呢？这时就要用and函数。and函数的基本格式，如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1d82db44afaf41e3880cf5e56f4c4ec7><p class=pgc-img-caption></p></div><p>and函数可以有30个参数，当所有参数都为真时，结果为true，如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/819aa48323da418488b447129cd3123b><p class=pgc-img-caption></p></div><p>使用if函数时需注意以下几点。<br></p><p>（1）函数看不懂，可以换行理解。</p><p>（2）单方向梳理逻辑，思路更清晰。</p><p>（3）嵌套可以无限制，但头脑要清醒。</p><p>（4）必要时，可以与其他函数配合使用。<br></p><p>2</p><p><strong>不同函数的嵌套</strong></p><p>现在又有一个问题，看下面的例子，如果想要求出表中“小A”“小C”和“小G”的“员工号” 及“工资”，该怎么办？</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2afbb544deb048e7bd87b3296b3829a4><p class=pgc-img-caption></p></div><p>有人说，这太简单了，用两个vlookup函数就可以解决，如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/628caaf6d02542a8a59903b17b0b031b><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/bdd568c586e34542b0087a098eee9441><p class=pgc-img-caption></p></div><p>但能不能用一个函数完成呢？当然可以，不过，需要用到一个新的函数：match函数。<br></p><p><strong>❶ vlookup函数与match函数的嵌套</strong><br></p><p>match函数用于查找对象在一组数据中的具体位置，返回一个数值结果，match函数的语法结构如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/60ed24501d84420e9901cfb02916d9a1><p class=pgc-img-caption></p></div><p>想查找【员工号】字段和【工资】字段分别在表中的哪一列，如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e251d59103e04c3eadaa2d55d93e8e1a><p class=pgc-img-caption></p></div><p>会用match函数了，接下来，就回到开头的那个问题，怎么一次性求出多个列值，先求出一个值，如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8d8cda28944f4dceade4b28c9105c06e><p class=pgc-img-caption></p></div><p>然后向右拖曳填充柄复制公式，结果如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b9a3cba14d7542b6a3e94508ec24b231><p class=pgc-img-caption></p></div><p>再向下拖曳填充柄复制公式，结果如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/66ceb7b4bd264045886c9bef7f80b964><p class=pgc-img-caption></p></div><p>将vlookup函数和match函数嵌套，可以让vlookup函数返回多列结果。<br></p><p><strong>❷ match函数与index函数的嵌套</strong></p><p>使用vlookup函数查找匹配，一个前提条件是查找对象必须在匹配范围的首列。如果查找对象不在首列，有以下两种方法。</p><p><strong>第一种：</strong>设置匹配范围，让查找对象成为首列。</p><p>例如，如下图所示，查找对象肯定是“员工号”，那么匹配范围本来应该是A:D列，但是，可以将匹配范围设置为B:D列，也就是不用A列，这样，查找对象“员工号”就在匹配范围的首列了。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/61ec410f8a6540c5b2dff42b109308c2><p class=pgc-img-caption></p></div><p>但是，如果上面的方法不能用，出现下图所示的情况，应该怎么办？</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/651262a773234387b987457d4cb1de62><p class=pgc-img-caption></p></div><p><br>那就只能是<strong>第二种</strong>情况了，这时需要使用index函数，index函数的基本格式如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6f9adc78709f4f78ac2d1db8cf41ecdf><p class=pgc-img-caption></p></div><p>index函数的功能是，在给定的区域内返回第几行第几列的值。如下图所示，先求某一列数据中某行的值。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9ff233168c6b45869094a359a4e95e1d><p class=pgc-img-caption></p></div><p>再求某行数据中某列的值，如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4ad2508e336e4902b65cd20dcc9b7785><p class=pgc-img-caption></p></div><p>然后，求一片区域内某行某列的值，如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/71c6f01d645647bd9ea5930176ab8b6e><p class=pgc-img-caption></p></div><p>清楚了index函数的用法，下面联合使用match函数和index函数，如下图所示。</p><div class=pgc-img><img alt=5组常用的函数嵌套 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/227549dacc04489d8cbc1f2e72bddb26><p class=pgc-img-caption></p></div><p>这个知识点你都学会了吗？</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'函数','嵌套','常用'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>