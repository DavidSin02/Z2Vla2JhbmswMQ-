<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç¼–ç  | æå®¢å¿«è¨Š</title><meta property="og:title" content="æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç¼–ç  - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/28eb40e101e44cfb8b88aac745d012d6"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f71cd4af.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f71cd4af.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f71cd4af.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f71cd4af.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f71cd4af.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f71cd4af.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f71cd4af.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f71cd4af.html><meta property="article:published_time" content="2020-11-14T21:06:24+08:00"><meta property="article:modified_time" content="2020-11-14T21:06:24+08:00"><meta name=Keywords content><meta name=description content="æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç¼–ç "><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/f71cd4af.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç¼–ç </h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p><br></p><div class=pgc-img><img alt=æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç¼–ç  onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/28eb40e101e44cfb8b88aac745d012d6><p class=pgc-img-caption>It's not a bug â€” it's an undocumented feature.</p></div><p>ä¸æœ´ç´ è´å¶æ–¯ç›¸æ¯”ï¼Œæ”¯æŒå‘é‡æœºçš„æ€§èƒ½å¦‚ä½•ï¼Ÿ è®­ç»ƒæ…¢å—ï¼Ÿ è®©æˆ‘ä»¬æ¢ç´¢ä¸€ä¸‹æ­¤ç¼–ç ç»ƒä¹ ä¸­çš„æ‰€æœ‰æ­¤ç±»é—®é¢˜ã€‚ è¿™æ˜¯ç¬¬äºŒç« ï¼šæ”¯æŒå‘é‡æœºæˆ–æ”¯æŒå‘é‡åˆ†ç±»å™¨çš„ç¬¬äºŒéƒ¨åˆ†ã€‚ å¦‚æœæ‚¨è¿˜æ²¡æœ‰è¯»æ‡‚è¯¥ç†è®ºï¼ˆç¬¬ä¸€éƒ¨åˆ†ï¼‰ï¼Œæˆ‘å»ºè®®æ‚¨åœ¨<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6787361765123424771/?group_id=6787361765123424771" target=_blank>è¿™é‡Œ</a>ä»”ç»†é˜…è¯»ã€‚ å¼ºçƒˆå»ºè®®æ‚¨äº†è§£SVMåˆ†ç±»å™¨çš„åŸºæœ¬çŸ¥è¯†ã€‚</p><blockquote class=pgc-blockquote-abstract><p>é€šè¿‡é˜…è¯»æ‚¨å°†å¯¹å®ç°æœ‰è¶³å¤Ÿçš„äº†è§£ï¼Œä½†æˆ‘å¼ºçƒˆå»ºè®®æ‚¨ä¸æ•™ç¨‹ä¸€èµ·æ‰“å¼€ç¼–è¾‘å™¨å’Œä»£ç ã€‚ æˆ‘å°†ä¸ºæ‚¨æä¾›æ›´å¥½çš„è§è¯†å’Œé•¿æœŸçš„å­¦ä¹ ã€‚</p></blockquote><h1 class=pgc-h-arrow-right><strong>0.æˆ‘ä»¬è¦åšä»€ä¹ˆã€‚</strong></h1><p>åˆ«å¿˜äº†ç‚¹å‡»â¤ã€‚ :)</p><p>ç¼–ç ç»ƒä¹ æ˜¯ä»¥å‰çš„Naive Bayesåˆ†ç±»ç¨‹åºçš„æ‰©å±•ï¼Œè¯¥ç¨‹åºå°†ç”µå­é‚®ä»¶åˆ†ä¸ºåƒåœ¾é‚®ä»¶å’Œéåƒåœ¾é‚®ä»¶ã€‚ ä¸ç”¨æ‹…å¿ƒï¼Œå¦‚æœæ‚¨è¿˜æ²¡æœ‰å®Œæˆè¿‡æœ´ç´ è´å¶æ–¯è¯¾ç¨‹ï¼ˆç¬¬1ç« ï¼‰ï¼ˆå°½ç®¡æˆ‘å»ºè®®æ‚¨å…ˆå®Œæˆï¼‰ã€‚ ç›¸åŒçš„ä»£ç æ®µä¹Ÿå°†åœ¨æ­¤å¤„ä»¥æŠ½è±¡æ–¹å¼è¿›è¡Œè®¨è®ºã€‚</p><p>æˆ‘ä»¬å°†å°è¯•é€šè¿‡å°†è®­ç»ƒæ•°æ®é›†å¤§å°å‡å°‘åŸå§‹å¤§å°çš„10ï¼…æ¥å‡å°‘è®­ç»ƒæ—¶é—´ã€‚ ç„¶åï¼Œæˆ‘ä»¬æ›´æ”¹è°ƒæ•´å‚æ•°ä»¥æé«˜å‡†ç¡®æ€§ã€‚ æˆ‘ä»¬å°†çœ‹åˆ°å˜åŒ–çš„å†…æ ¸ï¼ŒCå’Œä¼½ç›å¦‚ä½•æ”¹å˜å‡†ç¡®æ€§å’Œæ—¶åºã€‚</p><div class=pgc-img><img alt=æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç¼–ç  onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b639586ada474a4992dbadf5045223d9><p class=pgc-img-caption>The side effects!</p></div><h1 class=pgc-h-arrow-right><strong>1.ä¸‹è½½</strong></h1><p>æˆ‘å·²ç»ä¸ºæ•°æ®é›†å’Œç¤ºä¾‹ä»£ç åˆ›å»ºäº†ä¸€ä¸ªgitå­˜å‚¨åº“ã€‚ æ‚¨å¯ä»¥ä»æ­¤å¤„ä¸‹è½½ï¼ˆä½¿ç”¨ç¬¬2ç« æ–‡ä»¶å¤¹ï¼‰ã€‚ ä¸‡ä¸€å®ƒå¤±è´¥äº†ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨/å‚è€ƒæˆ‘çš„ç‰ˆæœ¬ï¼ˆç¬¬2ç« æ–‡ä»¶å¤¹ä¸­çš„classifier.pyï¼‰æ¥äº†è§£å…¶å·¥ä½œåŸç†ã€‚ å¿½ç•¥plot.pyæ–‡ä»¶ã€‚</p><h1 class=pgc-h-arrow-right><strong>2.å…³äºæ•°æ®æ¸…ç†çš„ä¸€ç‚¹</strong></h1><blockquote class=pgc-blockquote-abstract><p>å¦‚æœæ‚¨å·²ç»å®Œæˆäº†æœ´ç´ è´å¶æ–¯çš„ç¼–ç éƒ¨åˆ†ï¼Œåˆ™å¯ä»¥è·³è¿‡è¿™ä¸€éƒ¨åˆ†ã€‚ï¼ˆè¿™æ˜¯é’ˆå¯¹ç›´æ¥è·³åˆ°æ­¤å¤„çš„è¯»è€…çš„ï¼‰ã€‚</p></blockquote><p>åœ¨åº”ç”¨sklearnåˆ†ç±»å™¨ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»æ¸…ç†æ•°æ®ã€‚ æ¸…ç†åŒ…æ‹¬åˆ é™¤åœç”¨è¯ï¼Œä»æ–‡æœ¬ä¸­æå–æœ€å¸¸ç”¨çš„è¯ç­‰ã€‚åœ¨ç›¸å…³çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p><p>è¦è¯¦ç»†äº†è§£ï¼Œè¯·å†æ¬¡å‚è€ƒæ­¤å¤„çš„ç¬¬1ç« ç¼–ç éƒ¨åˆ†ã€‚</p><p>Â· ä»è®­ç»ƒé›†ä¸­çš„ç”µå­é‚®ä»¶æ–‡æ¡£æ„å»ºå•è¯è¯å…¸ã€‚</p><p>Â· è€ƒè™‘æœ€å¸¸è§çš„3000ä¸ªå•è¯ã€‚</p><p>Â· å¯¹äºè®­ç»ƒé›†ä¸­çš„æ¯ä¸ªæ–‡æ¡£ï¼Œä¸ºå­—å…¸ä¸­çš„è¿™äº›å•è¯å’Œç›¸åº”çš„æ ‡ç­¾åˆ›å»ºä¸€ä¸ªé¢‘ç‡çŸ©é˜µã€‚ [åƒåœ¾é‚®ä»¶çš„æ–‡ä»¶åä»¥" spmsg"å¼€å¤´ã€‚</p><pre><code>The code snippet below does this:def make_Dictionary(root_dir):   all_words = []   emails = [os.path.join(root_dir,f) for f in os.listdir(root_dir)]   for mail in emails:        with open(mail) as m:            for line in m:                words = line.split()                all_words += words   dictionary = Counter(all_words)   # if you have python version 3.x use commented version.   # list_to_remove = list(dictionary)   list_to_remove = dictionary.keys()for item in list_to_remove:       # remove if numerical.        if item.isalpha() == False:            del dictionary[item]        elif len(item) == 1:            del dictionary[item]    # consider only most 3000 common words in dictionary.dictionary = dictionary.most_common(3000)return dictionarydef extract_features(mail_dir):  files = [os.path.join(mail_dir,fi) for fi in os.listdir(mail_dir)]  features_matrix = np.zeros((len(files),3000))  train_labels = np.zeros(len(files))  count = 0;  docID = 0;  for fil in files:    with open(fil) as fi:      for i,line in enumerate(fi):        if i == 2:          words = line.split()          for word in words:            wordID = 0            for i,d in enumerate(dictionary):              if d[0] == word:                wordID = i                features_matrix[docID,wordID] = words.count(word)      train_labels[docID] = 0;      filepathTokens = fil.split('/')      lastToken = filepathTokens[len(filepathTokens) - 1]      if lastToken.startswith("spmsg"):          train_labels[docID] = 1;          count = count + 1      docID = docID + 1  return features_matrix, train_labels</code></pre><h1 class=pgc-h-arrow-right><strong>3.è¿›å…¥SVCä¸–ç•Œ</strong></h1><p>ä½¿ç”¨svcçš„ä»£ç ä¸æœ´ç´ è´å¶æ–¯çš„ä»£ç ç›¸ä¼¼ã€‚ æˆ‘ä»¬é¦–å…ˆä»åº“ä¸­å¯¼å…¥svcã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æå–è®­ç»ƒåŠŸèƒ½å’Œæ ‡ç­¾ã€‚ æœ€åï¼Œæˆ‘ä»¬è¦æ±‚æ¨¡å‹é¢„æµ‹æµ‹è¯•é›†çš„æ ‡ç­¾ã€‚ åŸºæœ¬çš„ä»£ç å—ç‰‡æ®µå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>from sklearn import svmfrom sklearn.metrics import accuracy_scoreTRAIN_DIR = "../train-mails"TEST_DIR = "../test-mails"dictionary = make_Dictionary(TRAIN_DIR)print "reading and processing emails from file."features_matrix, labels = extract_features(TRAIN_DIR)test_feature_matrix, test_labels = extract_features(TEST_DIR)model = svm.SVC()print "Training model."#train modelmodel.fit(features_matrix, labels)predicted_labels = model.predict(test_feature_matrix)print "FINISHED classifying. accuracy score : "print accuracy_score(test_labels, predicted_labels)</code></pre><p><br></p><p>ç»“åˆåœ¨ä¸€èµ·ï¼š</p><pre><code>import osimport numpy as npfrom collections import Counterfrom sklearn import svmfrom sklearn.metrics import accuracy_scoredef make_Dictionary(root_dir):    all_words = []    emails = [os.path.join(root_dir,f) for f in os.listdir(root_dir)]    for mail in emails:        with open(mail) as m:            for line in m:                words = line.split()                all_words += words    dictionary = Counter(all_words)    list_to_remove = dictionary.keys()for item in list_to_remove:        if item.isalpha() == False:            del dictionary[item]        elif len(item) == 1:            del dictionary[item]    dictionary = dictionary.most_common(3000)return dictionarydef extract_features(mail_dir):    files = [os.path.join(mail_dir,fi) for fi in os.listdir(mail_dir)]    features_matrix = np.zeros((len(files),3000))    train_labels = np.zeros(len(files))    count = 0;    docID = 0;    for fil in files:      with open(fil) as fi:        for i,line in enumerate(fi):          if i == 2:            words = line.split()            for word in words:              wordID = 0              for i,d in enumerate(dictionary):                if d[0] == word:                  wordID = i                  features_matrix[docID,wordID] = words.count(word)        train_labels[docID] = 0;        filepathTokens = fil.split('/')        lastToken = filepathTokens[len(filepathTokens) - 1]        if lastToken.startswith("spmsg"):            train_labels[docID] = 1;            count = count + 1        docID = docID + 1    return features_matrix, train_labelsTRAIN_DIR = "../train-mails"TEST_DIR = "../test-mails"dictionary = make_Dictionary(TRAIN_DIR)print "reading and processing emails from file."features_matrix, labels = extract_features(TRAIN_DIR)test_feature_matrix, test_labels = extract_features(TEST_DIR)model = svm.SVC()print "Training model."#train modelmodel.fit(features_matrix, labels)predicted_labels = model.predict(test_feature_matrix)print "FINISHED classifying. accuracy score : "print accuracy_score(test_labels, predicted_labels)</code></pre><p><br></p><p>è¿™æ˜¯éå¸¸åŸºæœ¬çš„å®ç°ã€‚ å‡å®šè°ƒæ•´å‚æ•°ä¸ºé»˜è®¤å€¼ï¼ˆkernel = linear, C = 1 and gamma = 1ï¼‰</p><p>Â· çœ‹çœ‹åœ¨è¿™ç§æƒ…å†µä¸‹æ‚¨å¾—åˆ°ä»€ä¹ˆç²¾åº¦ï¼Ÿ</p><p>Â· è®­ç»ƒæ—¶é—´å¦‚ä½•ï¼Ÿ å®ƒæ¯”æœ´ç´ è´å¶æ–¯å¿«/æ…¢å—ï¼Ÿ</p><p>Â· ä¸æœ´ç´ è´å¶æ–¯ç›¸æ¯”ï¼Œå‡†ç¡®æ€§å¦‚ä½•ï¼Ÿ</p><h1 class=pgc-h-arrow-right><strong>å—¯...æˆ‘ä»¬å¦‚ä½•å‡å°‘è®­ç»ƒæ—¶é—´ï¼Ÿ</strong></h1><p>ä¸€ç§æ–¹æ³•æ˜¯å‡å°‘è®­ç»ƒé›†çš„å¤§å°ã€‚ æˆ‘ä»¬å°†å…¶å‡å°ä¸ºåŸå§‹å¤§å°çš„1/10ï¼Œç„¶åæ£€æŸ¥å‡†ç¡®æ€§ã€‚ å½“ç„¶å®ƒä¼šå‡å°‘ã€‚</p><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æœ‰702å°ç”µå­é‚®ä»¶ç”¨äºåŸ¹è®­ã€‚ 1/10æ„å‘³ç€70å°ç”µå­é‚®ä»¶ç”¨äºåŸ¹è®­ï¼Œè¿™æ˜¯éå¸¸å°‘çš„ã€‚ ï¼ˆå°½ç®¡ç»“å¸ä½¿æˆ‘ä»¬æ„Ÿåˆ°æƒŠå¥‡ï¼‰ã€‚</p><p>åœ¨è®­ç»ƒæ¨¡å‹ä¹‹å‰ï¼Œæ·»åŠ ä»¥ä¸‹è¡Œã€‚ ï¼ˆå®ƒå°†feature_matrixå’Œæ ‡ç­¾å‡å°‘1/10ï¼‰ã€‚</p><pre><code>features_matrix = features_matrix[:len(features_matrix)/10]labels = labels[:len(labels)/10]</code></pre><p><br></p><p>ç°åœ¨ä»€ä¹ˆæ˜¯è®­ç»ƒæ—¶é—´å’Œå‡†ç¡®æ€§ï¼Ÿ</p><h1 class=pgc-h-arrow-right><strong>å‚æ•°è°ƒæ•´</strong></h1><div class=pgc-img><img alt=æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç¼–ç  onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8cdc14fb13de4c1fb48cc2adaa475794><p class=pgc-img-caption></p></div><p>æˆ‘æƒ³æ‚¨ä¼šæ”¶åˆ°å¤§çº¦56ï¼…çš„å‡†ç¡®æ€§ã€‚ å¤ªä½äº†</p><p>ç°åœ¨å°†è®­ç»ƒé›†ä¿æŒä¸º1/10ï¼Œè®©æˆ‘ä»¬å°è¯•è°ƒæ•´ä¸‰ä¸ªå‚æ•°ï¼škernelï¼ŒCå’Œgammaã€‚</p><h1 class=pgc-h-arrow-right><strong>1.å†…æ ¸</strong></h1><p>å°†å†…æ ¸æ›´æ”¹ä¸ºrbfã€‚ å³åœ¨æ¨¡å‹= SVCï¼ˆï¼‰ä¸­æ·»åŠ å†…æ ¸å‚æ•°</p><pre><code>model = svm.SVC(kernel="rbf", C = 1)</code></pre><p><br></p><h1 class=pgc-h-arrow-right><strong>2. C</strong></h1><p>æ¥ä¸‹æ¥ï¼Œå°†Cï¼ˆæ­£åˆ™åŒ–å‚æ•°ï¼‰æ›´æ”¹ä¸º10ã€100ã€1000ã€10000ã€‚ç¡®å®šç²¾åº¦æ˜¯å¢åŠ è¿˜æ˜¯å‡å°‘ï¼Ÿ</p><p>æ‚¨ä¼šæ³¨æ„åˆ°ï¼Œåœ¨C = 100æ—¶ï¼Œå‡†ç¡®åº¦åˆ†æ•°æé«˜åˆ°85.38ï¼…ï¼Œå¹¶ä¸”åœ¨æ­¤ä¹‹ä¸Šå‡ ä¹ä¿æŒç›¸åŒã€‚</p><h1 class=pgc-h-arrow-right><strong>3.ä¼½ç›</strong></h1><p>æœ€åï¼Œè®©æˆ‘ä»¬ç©ä¼½ç›ã€‚ å†å¢åŠ ä¸€ä¸ªå‚æ•°gamma = 1.0</p><pre><code>model = svm.SVC(kernel="rbf", C=100, gamma=1)</code></pre><p>ç³Ÿç³•ï¼ å‡†ç¡®æ€§å¾—åˆ†ä¸‹é™ã€‚ å¯¹ï¼Ÿ å°è¯•å°†gamma = 10è®¾ä¸ºæ›´é«˜çš„å€¼ã€‚ å°è¯•å‡å°‘ã€‚ ä½¿ç”¨å€¼0.1ã€0.01ã€0.001ã€‚ ç°åœ¨çš„ç²¾åº¦æ˜¯å¤šå°‘ï¼Ÿ å®ƒåœ¨å¢åŠ å—ï¼Ÿ</p><p>æ‚¨ä¼šæ³¨æ„åˆ°ï¼Œåœ¨è¿™ç§è¿åŠ¨æƒ…å†µä¸‹ï¼Œè¾ƒä½çš„ä¼½ç›å€¼ä½¿æˆ‘ä»¬å…·æœ‰å¾ˆé«˜çš„å‡†ç¡®æ€§ã€‚ ï¼ˆç›´è§‰ï¼šè¿™æ„å‘³ç€æ•°æ®ç‚¹ç¨€ç–ï¼Œç¦»å›¾å½¢å›¾ä¸­çš„å†³ç­–è¾¹ç•Œè¶³å¤Ÿè¿œï¼‰ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°å‡å°è®­ç»ƒé›†å¤§å°å¯ä»¥è¾¾åˆ°85.4çš„æœ€ä½³æ•ˆæœã€‚ ï¼ˆPSï¼šæœ´ç´ è´å¶æ–¯çš„å‡†ç¡®åº¦å¾—åˆ†æ˜¯å¤šå°‘ï¼Ÿï¼‰</p><h1 class=pgc-h-arrow-right><strong>å¿«é€Ÿè¿è¡Œè„šæœ¬[å¯é€‰]</strong></h1><p>æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œæ¯æ¬¡è„šæœ¬èŠ±è´¹å¤§é‡æ—¶é—´æ¥æ¸…ç†å’Œè¯»å–ç”µå­é‚®ä»¶ä¸­çš„æ•°æ®ï¼ˆåŠŸèƒ½å’Œæ ‡ç­¾ï¼‰ã€‚ é€šè¿‡ä¿å­˜ä»é¦–æ¬¡è¿è¡Œä¸­æå–çš„æ•°æ®ï¼Œå¯ä»¥åŠ å¿«å¤„ç†é€Ÿåº¦ã€‚</p><p>è¿™å°†ä¸ºæ‚¨èŠ‚çœæ›´å¤šæ—¶é—´æ¥å­¦ä¹ è°ƒæ•´å‚æ•°ã€‚</p><p>ä½¿ç”¨ä»¥ä¸‹ä»£ç æ®µä¿å­˜å’ŒåŠ è½½ä»£ç ã€‚</p><pre><code>import cPickleimport gzipdef load(file_name):    # load the model    stream = gzip.open(file_name, "rb")    model = cPickle.load(stream)    stream.close()    return modeldef save(file_name, model):    # save the model    stream = gzip.open(file_name, "wb")    cPickle.dump(model, stream)    stream.close()#To savesave("/tmp/features_matrix", features_matrix)save("/tmp/labels", labels)save("/tmp/test_feature_matrix", test_feature_matrix)save("/tmp/test_labels", test_labels)#To loadfeatures_matrix = load("/tmp/features_matrix")labels = load("/tmp/labels")test_feature_matrix = load("/tmp/test_feature_matrix")test_labels = load("/tmp/test_labels")</code></pre><h1 class=pgc-h-arrow-right><strong>æœ€åçš„æƒ³æ³•</strong></h1><p>é€šå¸¸ï¼ŒSVCæ¯”æœ´ç´ è´å¶æ–¯éœ€è¦æ›´å¤šçš„è®­ç»ƒæ—¶é—´ï¼Œä½†é¢„æµ‹é€Ÿåº¦æ›´å¿«ã€‚ åœ¨ä¸Šé¢çš„ç¼–ç ç»ƒä¹ ä¸­ï¼Œæœ´ç´ è´å¶æ–¯çš„è¡¨ç°ä¼˜äºSVCã€‚ ä½†æ˜¯ï¼Œè¿™å®Œå…¨å–å†³äºæ€§èƒ½æœ€ä½³çš„æ–¹æ¡ˆå’Œæ•°æ®é›†ã€‚</p><p>å³ä½¿å°†è®­ç»ƒæ•°æ®é›†å‡å°‘åˆ°1/10ï¼Œä¹Ÿå¯ä»¥è·å¾—æ›´é«˜çš„å‡†ç¡®æ€§å¾—åˆ†ã€‚</p><h1 class=pgc-h-arrow-right><strong>ä½†æ˜¯ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å‡å°‘è®­ç»ƒé‡å‘¢ï¼Ÿ</strong></h1><p>è®­ç»ƒæ—¶é—´æ›´é•¿ï¼ŒSVCçš„è®­ç»ƒæ—¶é—´é€šå¸¸æ˜¯æœ´ç´ è´å¶æ–¯çš„3å€ã€‚ åœ¨æŸäº›åº”ç”¨ä¸­ï¼Œä¸å‡†ç¡®åº¦ç›¸æ¯”ï¼Œæˆ‘ä»¬éœ€è¦æ›´å¿«çš„é¢„æµ‹ã€‚</p><p>Â· æƒ³æƒ³ä¿¡ç”¨å¡äº¤æ˜“ã€‚ å¿«é€Ÿå“åº”äº¤æ˜“æ¬ºè¯ˆæ ‡è®°æ¯”99ï¼…çš„å‡†ç¡®æ€§æ›´ä¸ºé‡è¦ã€‚ åœ¨è¿™é‡Œå¯ä»¥å®¹å¿90ï¼…çš„ç²¾åº¦ã€‚</p><p>Â· å¦ä¸€æ–¹é¢ï¼Œåªæœ‰å°†ç”µå­é‚®ä»¶æ ‡è®°ä¸ºåƒåœ¾é‚®ä»¶å¯ä»¥å¿å—å»¶è¿Ÿï¼Œæˆ‘ä»¬å°†åŠªåŠ›æé«˜å‡†ç¡®æ€§ã€‚</p><h1 class=pgc-h-arrow-right><strong>æˆ‘ä»¬æ˜¯å¦éœ€è¦å§‹ç»ˆè°ƒæ•´å‚æ•°ï¼Ÿ</strong></h1><p>å¹¶ä¸æ˜¯çš„ã€‚ sklearnå·¥å…·å¥—ä»¶ä¸­æœ‰å†…ç½®åŠŸèƒ½å¯ä»¥ä¸ºæˆ‘ä»¬å®Œæˆä»»åŠ¡ã€‚ æˆ‘ä»¬å°†åœ¨ä»¥åçš„æ–‡ç« ä¸­æ¢è®¨å®ƒä»¬ã€‚</p><p>å¸Œæœ›æœ¬æ•™ç¨‹ä¸ºæ‚¨æä¾›æœ‰å…³SVCç¼–ç çš„åŸºæœ¬æ¦‚å¿µã€‚ å³ä½¿å¯¹äºè¾ƒå°çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬å¦‚ä½•è°ƒæ•´å‚æ•°å¹¶å®ç°åˆç†çš„ç²¾åº¦ã€‚ ï¼ˆæˆ‘ä»¬åœ¨åŸ¹è®­é›†ä¸­åªæœ‰70å°ç”µå­é‚®ä»¶ï¼Œåœ¨é’ˆå¯¹350å°ç”µå­é‚®ä»¶çš„æµ‹è¯•ä¸­è¾¾åˆ°äº†85ï¼…çš„å‡†ç¡®æ€§ï¼‰ã€‚</p><h1 class=pgc-h-arrow-right><strong>æ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆï¼Ÿ</strong></h1><p>åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å†³ç­–æ ‘ã€‚ ï¼ˆå¿«æ¥äº†ï¼‰</p><p><br></p><div class=pgc-img><img alt=æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç¼–ç  onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/839932bff1634e7180704414e16c36ad><p class=pgc-img-caption></p></div><p>(æœ¬æ–‡ç¿»è¯‘è‡ªSavan Patelçš„æ–‡ç« ã€ŠChapter 2 : SVM (Support Vector Machine) â€” Codingã€‹ï¼Œå‚è€ƒï¼šhttps://medium.com/machine-learning-101/chapter-2-svm-support-vector-machine-coding-edd8f1cf8f2d)</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'æœºå™¨','å­¦ä¹ ','å…¥é—¨'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../cn/%E7%A7%91%E5%AD%A6/c75c54fc.html alt=æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç†è®º class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/db2b59aa64f64e189449ae9773356bed style=border-radius:25px></a>
<a href=../../cn/%E7%A7%91%E5%AD%A6/c75c54fc.html title=æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç†è®º>æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰â€”ç†è®º</a></li><hr><li><a href=../../cn/%E7%A7%91%E6%8A%80/c9b52b0.html alt=æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬1ç« ï¼šç›‘ç£å­¦ä¹ å’Œæœ´ç´ è´å¶æ–¯åˆ†ç±»-ç¬¬2éƒ¨åˆ†ï¼ˆç¼–ç ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a6894d2d1ea64a8eb3bad2b892648639 style=border-radius:25px></a>
<a href=../../cn/%E7%A7%91%E6%8A%80/c9b52b0.html title=æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬1ç« ï¼šç›‘ç£å­¦ä¹ å’Œæœ´ç´ è´å¶æ–¯åˆ†ç±»-ç¬¬2éƒ¨åˆ†ï¼ˆç¼–ç ï¼‰>æœºå™¨å­¦ä¹ å…¥é—¨ç¬¬1ç« ï¼šç›‘ç£å­¦ä¹ å’Œæœ´ç´ è´å¶æ–¯åˆ†ç±»-ç¬¬2éƒ¨åˆ†ï¼ˆç¼–ç ï¼‰</a></li><hr><li><a href=../../cn/%E7%A7%91%E6%8A%80/4b5cbda.html alt=æœºå™¨å­¦ä¹ å…¥é—¨ï¼šåå·®å’Œæ–¹å·® class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e4d7bca8189b4528b0f564ee473d2a68 style=border-radius:25px></a>
<a href=../../cn/%E7%A7%91%E6%8A%80/4b5cbda.html title=æœºå™¨å­¦ä¹ å…¥é—¨ï¼šåå·®å’Œæ–¹å·®>æœºå™¨å­¦ä¹ å…¥é—¨ï¼šåå·®å’Œæ–¹å·®</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>