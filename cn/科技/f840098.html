<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 | 极客快訊</title><meta property="og:title" content="这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/5d8dd62208b84b8bb6026ec91beaca25"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f840098.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f840098.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f840098.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f840098.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f840098.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f840098.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f840098.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f840098.html><meta property="article:published_time" content="2020-10-29T20:58:21+08:00"><meta property="article:modified_time" content="2020-10-29T20:58:21+08:00"><meta name=Keywords content><meta name=description content="这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/f840098.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><blockquote><p><strong>文|傅一平</strong></p></blockquote><p>今天跟着我来学学数据仓库的基础知识，希望你结合案例可以把它吃透。</p><h1><strong>一、数据仓库建模的意义</strong></h1><p>如果把数据看作图书馆里的书，我们希望看到它们在书架上分门别类地放置；如果把数据看作城市的建筑，我们希望城市规划布局合理；如果把数据看作电脑文件和文件夹，我们希望按照自己的习惯有很好的文件夹组织方式，而不是糟糕混乱的桌面，经常为找一个文件而不知所措。</p><p>数据模型就是数据组织和存储方法，它强调从业务、数据存取和使用角度合理存储数据。Linux的创始人Torvalds有一段关于“什么才是优秀程序员”的话：“烂程序员关心的是代码，好程序员关心的是数据结构和它们之间的关系”，最能够说明数据模型的重要性。</p><p>只有数据模型将数据有序的组织和存储起来之后，大数据才能得到高性能、低成本、高效率、高质量的使用。</p><p><strong>性能</strong>：帮助我们快速查询所需要的数据，减少数据的I/O吞吐，提高使用数据的效率，如宽表。</p><p><strong>成本</strong>：极大地减少不必要的数据冗余，也能实现计算结果复用，极大地降低存储和计算成本。</p><p><strong>效率</strong>：在业务或系统发生变化时，可以保持稳定或很容易扩展，提高数据稳定性和连续性。</p><p><strong>质量</strong>：良好的数据模型能改善数据统计口径的不一致性，减少数据计算错误的可能性。</p><p>数据模型能够促进业务与技术进行有效沟通，形成对主要业务定义和术语的统一认识，具有跨部门、中性的特征，可以表达和涵盖所有的业务。</p><p>大数据系统需要数据模型方法来帮助更好地组织和存储数据，以便在<strong>性能、成本、效率和质量</strong>之间取得最佳平衡！</p><p>下图是个示例，通过统一数据模型，屏蔽数据源变化对业务的影响，保证业务的稳定，表述了数据仓库模型的一种价值：</p><div class=pgc-img><img alt=这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5d8dd62208b84b8bb6026ec91beaca25><p class=pgc-img-caption></p></div><h1><strong>二、数据仓库分层的设计</strong></h1><p>为了实现以上的目的，数据仓库一般要进行分层的设计，其能带来五大好处：</p><p><strong>清晰数据结构</strong>：每一个数据分层都有它的作用域，这样我们在使用表的时候能更方便地定位和理解。</p><p><strong>数据血缘追踪</strong>：能够快速准确地定位到问题，并清楚它的危害范围。</p><p><strong>减少重复开发</strong>：规范数据分层，开发一些通用的中间层数据，能够减少极大的重复计算。</p><p><strong>把复杂问题简单化</strong>：将复杂的任务分解成多个步骤来完成，每一层只处理单一的步骤，比较简单和容易理解。当数据出现问题之后，不用修复所有的数据，只需要从有问题的步骤开始修复。</p><p><strong>屏蔽原始数据的异常</strong>：不必改一次业务就需要重新接入数据。</p><p>以下是我们的一种分层设计方法，数据缓冲区（ODS）的数据结构与源系统完全一致。基础数据模型(DWD)和融合数据模型（DWI与DWA）是大数据平台重点建设的数据模型。应用层模型由各应用按需自行建设，其中基础数据模型一般采用ER模型，融合数据模型采用维度建模思路。</p><div class=pgc-img><img alt=这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f6b239ec95164591a6532d06a475cd99><p class=pgc-img-caption></p></div><h1><strong>三、两种经典的数据仓库建模方法</strong></h1><p>前面的分层设计中你会发现有两种设计方法，关系建模和维度建模，下面分别简单介绍其特点和适用场景。</p><p><strong>1、维度建模</strong></p><p><strong>（1）定义</strong></p><p>维度模型是数据仓库领域另一位大师Ralph Kimball 所倡导的。维度建模以分析决策的需求出发构建模型，构建的数据模型为分析需求服务，因此它重点解决用户如何更快速完成分析需求，同时还有较好的大规模复杂查询的响应性能，更直接面向业务。典型的代表是我们比较熟知的星形模型。</p><div class=pgc-img><img alt=这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f6b3d1e552ae48869090476b7eae822a><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/07820eaf8e4243d79aa172fd33a8da17><p class=pgc-img-caption>维度退化</p></div><p>星型模型由一个事实表和一组维表组成。每个维表都有一个维作为主键，所有这些维的主键组合成事实表的主键。强调的是对维度进行预处理，将多个维度集合到一个事实表，形成一个宽表。</p><p>这也是我们在使用hive时，经常会看到一些大宽表的原因，大宽表一般都是事实表，包含了维度关联的主键和一些度量信息，而维度表则是事实表里面维度的具体信息，使用时候一般通过join来组合数据，相对来说对OLAP的分析比较方便。</p><p><strong>（2）建模方法</strong></p><p>通常需要选择某个业务过程，然后围绕该过程建立模型，其一般采用自底向上的方法，从明确关键业务过程开始，再到明确粒度，再到明确维度，最后明确事实，非常简单易懂。</p><div class=pgc-img><img alt=这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/352a427f3f8a40d88816943f114cdfd0><p class=pgc-img-caption></p></div><p>以下是阿里的OneData的建模工作流，可以参考。</p><div class=pgc-img><img alt=这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3988ddd744944741a004c334e72afdf2><p class=pgc-img-caption></p></div><p><strong>（3）优缺点</strong></p><p><strong>优点</strong>：技术要求不高，快速上手，敏捷迭代，快速交付；更快速完成分析需求，较好的大规模复杂查询的响应性能</p><p><strong>缺点</strong>：维度表的冗余会较多，视野狭窄</p><p><strong>2、关系建模</strong></p><p><strong>（1）定义</strong></p><p>是数据仓库之父Inmon推崇的、从全企业的高度设计一个3NF模型的方法，用实体加关系描述的数据模型描述企业业务架构，在范式理论上符合3NF，站在企业角度面向主题的抽象，而不是针对某个具体业务流程的实体对象关系抽象。</p><p>它更多是面向数据的整合和一致性治理，正如Inmon所希望达到的“single version of the truth”。</p><div class=pgc-img><img alt=这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/3147aa42e7184434a5d847fb81b5a1ce><p class=pgc-img-caption></p></div><p>当有一个或多个维表没有直接连接到事实表上，而是通过其他维表连接到事实表上时，其图解就像多个雪花连接在一起，故称雪花模型。</p><p>雪花模型是对星型模型的扩展。它对星型模型的维表进一步层次化，原有的各维表可能被扩展为小的事实表，形成一些局部的 "层次 " 区域，这些被分解的表都连接到主维度表而不是事实表。</p><p>雪花模型更加符合数据库范式，减少数据冗余，但是在分析数据的时候，操作比较复杂，需要join的表比较多所以其性能并不一定比星型模型高。</p><p><strong>（2）建模方法</strong></p><p>关系建模常常需要全局考虑，要对上游业务系统的进行信息调研，以做到对其业务和数据的基本了解，要做到主题划分，让模型有清晰合理的实体关系体系，以下是方法的示意：</p><div class=pgc-img><img alt=这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7144fa30f7554e329c8fec9aea1d1e2e><p class=pgc-img-caption></p></div><p>以下是中国移动的概念模型的一种示例，如果没有自顶向下的视野，基本是总结不出来的：</p><div class=pgc-img><img alt=这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b50dbc2ae840417ca298ff301c1f986a><p class=pgc-img-caption></p></div><p><strong>（3）优缺点</strong></p><p><strong>优点</strong>：规范性较好，冗余小，数据集成和数据一致性方面得到重视，比如运营商可以参考国际电信运营业务流程规范（ETOM），有所谓的最佳实践。</p><p><strong>缺点</strong>：需要全面了解企业业务、数据和关系；实施周期非常长，成本昂贵；对建模人员的能力要求也非常高，容易烂尾。</p><p><strong>3、建模方法比较</strong></p><p>一般来讲，维度模型简单直观，适合业务模式快速变化的行业，关系模型实现复杂，适合业务模式比较成熟的行业，阿里原来用关系建模，现在基本都是维度建模的方式了。</p><p>运营商以前都是关系建模，现在其实边界越来越模糊，很多大数据业务变化很快，采用维度建模也比较方便，不需要顶层设计。</p><div class=pgc-img><img alt=这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/70da766cc94047b18b5d00903ded9c3c><p class=pgc-img-caption></p></div><h1><strong>四、企业建模的三点经验</strong></h1><p>维度建模就不说了，只要能理解业务过程和其中涉及的相关数据、维度就可以，但自顶向下的关系建模难度很大，以下是关系建模的三个建设要点。</p><p><strong>1、业务的理解</strong>：找到企业内最理解业务和源系统的人，梳理出现状，比如运营商就要深刻理解三域（O/B/M），概念建模的挑战就很大，现在做到B域的概念建模已经很不容易。</p><div class=pgc-img><img alt=这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/76badae5385046f4b57615e78182012a><p class=pgc-img-caption></p></div><p><strong>2、数据及关系的理解</strong>：各个域的系统建设的时候没有统一文档和规范，要梳理出逻辑模型不容易，比如运营商的事件主题下的逻辑模型就非常复杂。</p><div class=pgc-img><img alt=这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d7a2e8d1f598497fa26474226dba4eef><p class=pgc-img-caption></p></div><p><strong>3、标准化的推进</strong>：数据仓库建模的任何实体都需要标准化命名，否则未来的管理成本巨大，也是后续数据有效治理的基础，以下是我们的一个命名规范示例：</p><div class=pgc-img><img alt=这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/00cee90e5ac443ed8e73aa18b8984eaf><p class=pgc-img-caption></p></div><h1><strong>五、推荐三本书</strong></h1><div class=pgc-img><img alt=这种思路讲解数据仓库建模，你见过吗？数据人与架构师必看 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/43c1fe587cf443d1b451ca21501050f5><p class=pgc-img-caption></p></div><p>总而言之，你可以把我的文章当成一个指引，具体还是要结合企业的实际去推进，但做事的时候要不忘建模的初心：即数据如何摆布才能提高支撑应用的效率，手段上不用区分什么先进不先进，好用就成。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'数据','必看','这种'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>