<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>五分钟看穿Java并发相关概念，并发原来如此简单 | 极客快訊</title><meta property="og:title" content="五分钟看穿Java并发相关概念，并发原来如此简单 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/36f0aa2cc4a4479a92295be7f09a92db"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f845ffe5.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f845ffe5.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f845ffe5.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f845ffe5.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f845ffe5.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f845ffe5.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f845ffe5.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f845ffe5.html><meta property="article:published_time" content="2020-11-14T21:06:36+08:00"><meta property="article:modified_time" content="2020-11-14T21:06:36+08:00"><meta name=Keywords content><meta name=description content="五分钟看穿Java并发相关概念，并发原来如此简单"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/f845ffe5.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>五分钟看穿Java并发相关概念，并发原来如此简单</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>本文主要对Java并发(Concurrent)相关的概念进行说明。</p><h1 class=pgc-h-arrow-right>1.进程(Process)与线程(Thread)</h1><ol start=1><li>进程是系统资源分配的最小单元。线程是CPU调度的最小单元。</li><li>一个 进程至少包含一个线程，可以包含多个线程。这些线程共享这个进程的资源。</li><li>每个线程都拥有独立的运行栈和程序计数器，线程切换开销小。</li><li>多进程指的是操作系统同时运行多个程序，如当前操作系统中同时运行着QQ、IE、微信等程序。</li><li>多线程指的是同一进程中同时运行多个线程，如迅雷运行时，可以开启多个线程，同时进行多个文件的下载。</li></ol><h1 class=pgc-h-arrow-right>2.并行(Parallel)、并发(Concurrent)与多线程(Multithreading)</h1><ol start=1><li>并行是指多个任务在同一时刻进行。并发是指多个任务在同一时间段内发生。</li><li>并行是物理上的同时发生，而并发是逻辑上的同时发生。</li><li>体现在程序上： 并行是指多个CPU内核在同一时刻，同时运行多个任务。并发是指单个CPU内，通过CPU调度算法，让用户感觉在同时运行多个任务。</li><li>更形象的说法： 并行是指两队人员同时使用两台咖啡机。并发是指两队人员交替使用同一台咖啡机。—-Erlang 之父 Joe Armstrong。</li></ol><div class=pgc-img><img alt=五分钟看穿Java并发相关概念，并发原来如此简单 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/36f0aa2cc4a4479a92295be7f09a92db><p class=pgc-img-caption></p></div><ol start=5><li>多线程即多个线程，一般只多个同时在运行的单线程。</li><li>如果是在单核CPU上，多线程肯定是并发运行的。如果是在多核CPU上，这些多线程也可能是并行运行。</li></ol><h1 class=pgc-h-arrow-right>3.线程安全</h1><p>线程安全，指的是在并发的情况之下，线程的调度顺序不影响运行结果。</p><p>如不加锁控制的转账操作，在单线程运行中是安全的，但是在多线程环境中，肯定是不安全的。这里只给出示例，具体逻辑就没不解释了。</p><pre><code>void transferMoney(User from, User to, float amount){    to.setMoney(to.getBalance() + amount);    from.setMoney(from.getBalance() - amount);}</code></pre><h1 class=pgc-h-arrow-right>4.死锁</h1><p>死锁是指两个或更多线程阻塞着等待其它处于死锁状态的线程所持有的锁。</p><p>例如，</p><ul><li>如果线程1锁住了A，然后尝试对B进行加锁，同时线程2已经锁住了B，接着尝试对A进行加锁，这时死锁就发生了。</li><li>线程1永远得不到B，线程2也永远得不到A，并且它们永远也不会知道发生了这样的事情。</li><li>为了得到彼此的对象（A和B），它们将永远阻塞下去。这种情况就是一个死锁。</li></ul><h1 class=pgc-h-arrow-right>5.并发优点</h1><h1 class=pgc-h-arrow-right>5.1.资源利用率高</h1><p>假定场景：需要从本地读取和处理两个文件，读取一个文件需要5秒，处理一个文件需要2秒。单线程：</p><pre><code>5秒读取文件A2秒处理文件A5秒读取文件B2秒处理文件B---------------------总共需要14秒</code></pre><p>多线程：</p><pre><code>5秒读取文件A5秒读取文件B + 2秒处理文件A2秒处理文件B---------------------总共需要12秒</code></pre><p>总结：</p><ul><li>在等待磁盘读取文件的时候，CPU大部分时间是空闲的。</li><li>利用多线程编程，可以在磁盘读取文件的CPU空闲时间内做一些其他的事情。</li><li>所以说， 使用多线程资源利用率更高。</li></ul><h1 class=pgc-h-arrow-right>5.2.程序响应更快</h1><p>一个桌面应用程序存在多个按钮。点击这些按钮，可以分别进行一些耗时的工作。</p><p><strong>单线程：</strong></p><p>每次点击一个按钮，都会进行一项耗时的工作。必须等待此项工作完成之后，才能继续监听用户操作。这时，用户才能点击其他按钮，进行其他的工作。这样的应用程序，对用户而言，响应十分慢，体验度很差。</p><p><strong>多线程：</strong></p><p>每次点击一个按钮，都会启动一个子线程去进行这项耗时的工作，主线程继续监听用户操作。这种情况下，用户可以快速的分别点击需要处理的按钮。这样的应用程序，对用户而言，响应很快，体验度很好。</p><h1 class=pgc-h-arrow-right>6.并发缺点</h1><p><strong>6.1.设计开发更复杂</strong></p><p>线程之间的交互往往非常复杂。 不正确的线程同步产生的错误非常难以发现，并且难以重现、难以修复。</p><p><strong>6.2.增加额外资源消耗</strong></p><p>多线程开发会产生额外的资源消耗，主要来源于三个方面：</p><ul><li>线程本身需要消耗一些资源进行本地堆栈的维持与管理。</li><li>线程之间切换会导致的上下文切换(Context Switch)开销。</li><li>多线程的管理对CPU来说又是一笔开销。</li></ul><p>所以，由于多线程会增加额外的资源消耗，对多线程程序而言，线程并不是越多就会越快，过多的线程返回会导致程序变慢。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Java','发相关','发原'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>