<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>STM32单片机最小系统详解 | 极客快訊</title><meta property="og:title" content="STM32单片机最小系统详解 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/75ad69f7d93b410e9e6cd05be42771b5"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f910ccb.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f910ccb.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f910ccb.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f910ccb.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f910ccb.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f910ccb.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f910ccb.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f910ccb.html><meta property="article:published_time" content="2020-10-29T20:58:46+08:00"><meta property="article:modified_time" content="2020-10-29T20:58:46+08:00"><meta name=Keywords content><meta name=description content="STM32单片机最小系统详解"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/f910ccb.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>STM32单片机最小系统详解</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right><strong>STM32F103RCT6简介：</strong></h1><p>STM32F103RCT6是一种嵌入式-微控制器的集成电路(IC)，32位 Cortex-M3内核处理器，速度是72MHz，程序存储器容量是256KB，程序存储器类型是FLASH，RAM容量是48K，封装LQFP64。</p><p><br></p><div class=pgc-img><img alt=STM32单片机最小系统详解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/75ad69f7d93b410e9e6cd05be42771b5><p class=pgc-img-caption>STM32F103RCT6芯片外观</p></div><p><br></p><div class=pgc-img><img alt=STM32单片机最小系统详解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/987cd430c9f14d6288356d194f4619ed><p class=pgc-img-caption>STM32F103RCT6引脚图</p></div><p><br></p><div class=pgc-img><img alt=STM32单片机最小系统详解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/06dbfcb3da8648e2983b5e561fbd1d42><p class=pgc-img-caption>STM32单片机命名规则</p></div><p><br></p><h1 class=pgc-h-arrow-right><strong>STM32单片机最小系统：</strong></h1><p>所谓单片机最小系统，就是让单片机能够正常运行，最少且必须的器件所组成的系统。</p><p><br></p><p>单片机最小系统上电之后，单片机可以正常复位，下载程序，除此之外没有其他任何功能。</p><p><br></p><p>在最小系统保证正确的基础上，可以依次添加其他功能模块或器件，使之单片机具有实际功能。</p><p><br></p><p>STM32单片机最小系统包括一个复位电路和一个时钟电路。如下图所示。</p><p>图中复位电路使用的是上电复位电路，STM32单片机NRST引脚输入低电平，则发生复位。</p><div class=pgc-img><img alt=STM32单片机最小系统详解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/25ffd37ea2fa497bb42939460edc79ee><p class=pgc-img-caption>STM32F103单片机最小系统</p></div><h1 class=pgc-h-arrow-right>电源引脚：</h1><p>VDD是单片机的数字电源正极，VSS是数字电源负极，共有5个VDD引脚，5个VSS引脚。VDDA是单片机的模拟电源正极，负责给内部的ADC、DAC模块供电，VSSA是模拟电源负极。</p><p><br></p><p>还有一个电源引脚，就是VBAT，BAT就是Battery（电池），这个引脚用来连接电池的正极的。STM32带RTC功能（实时时钟），所以有VBAT引脚。</p><p><br></p><p>原理图上预留了一个CR1220纽扣锂电池，当主电源供电存在的情况下，由系统中的VCC3.3给VBAT供电；</p><p><br></p><p>当主电源断电之后，由CR1220纽扣电池给STM32自带的RTC模块供电，从而能够保证实时时钟模块在主电源掉电的情况下还能够正常工作。</p><p><br></p><p>但是这样设计的话，这里有一个矛盾需要解决。如果VBAT引脚直接与VCC3.3和CR1220连接的话，会存在下面问题：</p><ol start=1><li>当电池电压高于3.3V，电池就会输出电流到AMS1117，使得芯片发烫，还会很快消耗电池电量。</li></ol><ol start=2><li>如果电池电压低于3.3V，AMS1117产生的3.3V，就会给电池充电，而这种CR1220电池是不能够充电的。</li></ol><p><br></p><p>为了解决上面问题，我们将VBAT引脚的供电电路设计如下：</p><p><br></p><div class=pgc-img><img alt=STM32单片机最小系统详解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6d60b5ef43654229a6e76422f74ba822><p class=pgc-img-caption>RTC实时时钟电源供电电路</p></div><p>D1防止电池的电流流向AMS1117，D2防止AMS1117产生的3.3V流向电池。</p><p>之所以这样设计，用的就是“二极管的单向导通性”。</p><p><br></p><p>正常产品设计的时候，每个电源引脚旁边，最好放置一个0.1uF的电容滤波，用来滤除电源的噪声杂波。</p><p><br></p><h1 class=pgc-h-arrow-right><strong>复位引脚NRST</strong></h1><p><br></p><p>复位就是重启。STM32复位引脚是低电平复位，正常工作状态，复位引脚是高电平。</p><p><br></p><div class=pgc-img><img alt=STM32单片机最小系统详解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9e36a43f15b84f8fbbc31bf3defcbd6c><p class=pgc-img-caption>STM32复位电路</p></div><p><br></p><p>单片机的置位和复位，其目的都是为了把电路初始化到一个确定状态。复位时在单片机内部单片机是将存储设备和一些寄存器装入生产厂商预设的一个值。一般来说，单片机复位电路的作用是把一个状态机初始化到一个空的状态。</p><p><br></p><h1 class=pgc-h-arrow-right><strong>单片机实现上电复位的原理：</strong></h1><p>在复位引脚NRST上外接电容和电阻。</p><p><br></p><p>当复位电平（低电平）持续两个机器周期以上时复位有效，系统上电后由于电容的充电，会保持一段时间的低电平来使单片机复位。</p><p><br></p><p>刚上电，电容两端电压为0，即低电平复位，RC电路有个充电曲线（即电容两端电压变化曲线），单片机识别外部电平有一个连接电压，保证rc电路电容电压充到单片机临界电压的时间在两个机器周期以上就能满足单片机复位条件;</p><p><br></p><p>当3.3V电源加到VCC3.3时，RC电路导通，NRST与地的电位差为电容与地的电位差。NRST与地的电位差只有电容充电完毕后才会达到3.3V，所以在电容的充电过程中，给芯片引脚的信号都是低电平。根据RC电路充电方程式V(t)=U+A*e-(t/RC)，只要合理的选择好R跟C的值就可以保证充电时间大于芯片复位所要求的时间。我们一般R选择10K电阻，C选择0.1uF电容。</p><p><br></p><h1 class=pgc-h-arrow-right><strong>晶振引脚</strong></h1><p>STM32有两组晶振，一组用来给单片机提供主时钟（5:OSC_IN,6:OSC_OUT），主时钟晶振使用8MHz的晶振（为了程序内部倍频方便，一般选用8MHz的晶振）。</p><p><br></p><p>一组用来给RTC提供时钟(3:OSC32_IN,4:OSC32_OUT)，RTC时钟晶振，需要连接32.768K的晶振，关于为什么要用32.768KHz，大家可以去百度了解一下哈。</p><blockquote class=pgc-blockquote-abstract><p>实际应用中，如果不用RTC功能的话，RTC的晶振不必连接。</p></blockquote><p><br></p><p>STM32的时钟电路又分为<u>内时钟</u>和<u>外时钟</u>两种模式。</p><p><br></p><p>外部时钟是在OSC_IN和OSC_OUT之间加上一个晶振，单片机内部振荡器便能产生自激震荡，产生时钟信号，在晶振的两侧加上20～30pF的瓷片电容起到了微调时钟频率的作用，让频率更加稳定。</p><p><br></p><p>内部时钟是STM32内部有时钟产生，所以如果不用外部晶振的话，也可以不用连接，内部时钟是用芯片内部振荡电路，精度不高，温飘也较大，不需要外部振荡器件。</p><p><br></p><div class=pgc-img><img alt=STM32单片机最小系统详解 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/a9ebe065e5814c53ab32b61aed99c609><p class=pgc-img-caption>晶振电路</p></div><p><br></p><h1 class=pgc-h-arrow-right><strong>BOOT引脚</strong></h1><p>STM32有两个BOOT引脚，分别是BOOT0和BOOT1，这两个引脚的高低电平，决定了单片机的启动方式和运行方式。</p><p><br></p><div class=pgc-img><img alt=STM32单片机最小系统详解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f05920fa755a4fc5bc8a80b8b3b61cfe><p class=pgc-img-caption></p></div><ul><li>第一种（BOOT1=X，BOOT0=0）启动方式是最常用的用户FLASH启动。<strong>默认启动方式</strong>。</li></ul><p><br></p><ul><li>第二种（BOOT1=0，BOOT0=1）启动方式是系统存储器启动方式。STM32中自带的BootLoader（ 就是通常说的ISP程序）就是在这种启动方式中，如果出现程序硬件错误的话可以切换BOOT0=1到该模式下重新烧写Flash即可恢复正常。 BootLoader所在区域的内容在芯片出厂后没有人能够修改或擦除，即它是一个ROM区。</li></ul><p><br></p><ul><li>第三种（BOOT1=1，BOOT0=1）启动方式是STM32内嵌的SRAM启动。该模式用于调试。</li></ul><p><br></p><div class=pgc-img><img alt=STM32单片机最小系统详解 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/6e1a98e6556a48f1b2b23ec36174a3e0><p class=pgc-img-caption>BOOT1接地</p></div><div class=pgc-img><img alt=STM32单片机最小系统详解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e1997e28013d42d0be4e2652789a4eda><p class=pgc-img-caption>BOOT0接地</p></div><p>一般我都是将BOOT0和BOOT1接地。</p><p><br></p><p>上面就是最小系统的全部内容，当然只有上面的部分还不行，一般最小系统还包括下面几部分：</p><p></p><h1 class=pgc-h-arrow-right><strong>电源电路：</strong></h1><p>因为STM32单片机一般都是3.3V供电，而生活中一般常见的都是5V电源（电脑的USB口，手机充电器，移动电源...），所以一般使用AMS1117-3.3V 稳压电源芯片将5V降压为3.3V，该芯片的封装一般为SOT223。</p><div class=pgc-img><img alt=STM32单片机最小系统详解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d7f81f0ca0904b3bafd204c31231971f><p class=pgc-img-caption>电源转换电路</p></div><p><br></p><h1 class=pgc-h-arrow-right><strong>下载电路：</strong></h1><p>另外还需要一个下载电路，STM32的下载方式有如下几种：</p><p><br></p><p><strong>（1）串口下载</strong></p><p>使用串口下载需要单片机内有相应的程序的支持，而系统存储器中就放了这么一段程序，由ST 在生产线上写入，用于通过可用的串行接口对闪存存储器进行重新编程。（在系统存储器启动模式下下载，因为在厂家提供的BootLoader中，提供了串口下载程序的固件，可以通过这个BootLoader将程序下载到系统的Flash中。程序烧录在FLASH）。</p><blockquote class=pgc-blockquote-abstract><p>注意：使用此种方式需要BOOT0=1，即需要有外部电路支持才可以实现串口下载。</p></blockquote><p><br></p><p><strong>（2）JLINK或者STLINK下载</strong></p><p>一般我们使用JTAG或者SWD模式下载程序。</p><p><br></p><p>推荐使用SWD模式下载，SWD模式只需要三个引脚（GND、SWCLK、SWDIO）即可实现程序的下载功能。</p><p><br></p><div class=pgc-img><img alt=STM32单片机最小系统详解 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/c5f89ec4c6d346419daa2036389b7531><p class=pgc-img-caption>STM32下载电路</p></div><p><br></p><hr><div class=pgc-img><img alt=STM32单片机最小系统详解 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/8cb2f23ad2e04a768c71cb065bcc7375><p class=pgc-img-caption></p></div><p><br></p><blockquote class=pgc-blockquote-abstract><p>喜欢请关注微信公众号：程序员小哈</p><p>有啥想玩的模块，留言给我，咱们一起玩</p><p>若觉得本次分享的文章对您有帮助，随手能够转发分享，也是对我的支持。</p></blockquote></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'STM32','单片机','系统'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>