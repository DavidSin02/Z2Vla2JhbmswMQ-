<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>手把手教你使用Python爬取西刺代理数据（下篇） | 极客快訊</title><meta property="og:title" content="手把手教你使用Python爬取西刺代理数据（下篇） - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/31a9a052021343dc9441b5ec6f2f539a"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fc8af71.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fc8af71.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/fc8af71.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fc8af71.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fc8af71.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/fc8af71.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/fc8af71.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fc8af71.html><meta property="article:published_time" content="2020-10-29T20:59:31+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:31+08:00"><meta name=Keywords content><meta name=description content="手把手教你使用Python爬取西刺代理数据（下篇）"><meta name=author content="极客快訊"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/fc8af71.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快讯 Geek Bank</a></h1><p class=description>为你带来最全的科技知识 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>手把手教你使用Python爬取西刺代理数据（下篇）</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><strong>/1 前言/</strong></p><p>前几天小编发布了手把手教你使用Python爬取西次代理数据（上篇），木有赶上车的小伙伴，可以戳进去看看。今天小编带大家进行网页结构的分析以及网页数据的提取，具体步骤如下。</p><p><strong>/2 首页分析及提取/</strong></p><p>首先进入网站主页，如下图所示。</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/31a9a052021343dc9441b5ec6f2f539a><p class=pgc-img-caption></p></div><p>简单分析下页面，其中后面的 1 是页码的意思，分析后发现每一页有100 多条数据，然后网站底部总共有 2700+页 的链接，所以总共ip 代理加起来超过 27 万条数据，但是后面的数据大部分都是很多年前的数据了，比如 2012 年，大概就前 5000 多条是最近一个月的，所以决定爬取前面100 页。通 过网站 url 分析，可以知道这 100 页的 url 为:</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9173a44f832042429bceab81bca29f63><p class=pgc-img-caption></p></div><p>规律显而易见，在程序中，我们使用一个 for 循环即可完整这个操作：</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ddf99135a58c4565b968634099b84523><p class=pgc-img-caption></p></div><p>其中 scrapy 函数是爬取的主要逻辑，对应的代码为：</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/028cfe1b0815404f855b6f52a76c80ea><p class=pgc-img-caption></p></div><p>通过这个方式，我们可以得到每一页的数据。</p><p>/3 网页元素分析及提取/</p><p>接下来就是对页面内的元素进行分析，提取其中的代理信息。</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/851f6e10a53c47d48ea8f527fed9af10><p class=pgc-img-caption></p></div><p>如上图，我们目的是进行代理地域分布分析，同时，在爬取过程中需要使用爬取的数据进行代 理更新，所以需要以下几个字段的信息：</p><p>Ip 地址、端口、服务器位置、类型</p><p>为此，先构建一个类，用于保存这些信息：</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/76cef2fdd2544306adcca22c9012e7cd><p class=pgc-img-caption></p></div><p>这样，每爬取一条信息，只要实例化一个 ProxyBean 类即可，非常方便。</p><p>接下来就是提取元素过程了，在这个过程我使用了正则表达式和 BeautifulSoup 库进行关键数据提取。</p><p>首先，通过分析网页发现，所有的条目实际上都是放在一个标签中。</p><p><br></p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e21b1de2dc354a8aa0c6254d1831b05d><p class=pgc-img-caption></p></div><p>该便签内容如下：</p><p>…… 我们首先通过正则表达式将该标签的内容提取出来：</p><p><br></p><p>正则表达式为：([\S\s]*)</p><p>， 表示搜索到之 间的任意字符组成的数据。Python 中的实现如下：</p><p><br></p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/24be33d8e59f4047a11eddd6f46e273f><p class=pgc-img-caption></p></div><p>其中得到的 data 就是这个标签的内容了。下面进一步分析。</p><p>进入到 table 中，发现每一个代理分别站 table 的一列，但是这些标签分为两类，一 类包含属性 class="odd", 另一类不包含。</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3ed5fbd93a2b4d129cbd1af394345a6e><p class=pgc-img-caption></p></div><p>这个时候，可以使用 BeautifulSoup 对标签进行提取：</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/7f9e1d5ca399416bb1920d81cec81393><p class=pgc-img-caption></p></div><p>通过这种方式，就能获取到每一个列的列表了。</p><p>接下来就是从每个列中获取 ip、端口、位置、类型等信息了。进一步分析页面：</p><p>1、IP 字段：</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/7a851f32bc9343f2b4de28098ac994d3><p class=pgc-img-caption></p></div><p>我们使用正则表达式对 IP 进行解析，IP 正则如下：</p><p>** (2[0-5]{2}|[0-1]?\d{1,2})(.(2[0-5]{2}|[0-1]?\d{1,2})){3}**</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ca081c331eb2448a9ebb5b19b0e60630><p class=pgc-img-caption></p></div><p>2、 端口字段</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/30fc6dc1fb534070a8a1eccd5626759c><p class=pgc-img-caption></p></div><p>端口由包裹，并且中间全部是数字，故可构造如下正则进行提取：</p><pre><code>&lt;td&gt;([0-9]+)&lt;/td&gt;</code></pre><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2dadc2a8927e4ef1b50fa34285c41d59><p class=pgc-img-caption></p></div><p>3、 位置字段</p><p>位置字段如下：</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4a215c3b9d9f41578c0b6f0d30246334><p class=pgc-img-caption></p></div><p>由 便签包裹，构造如下正则即可提取：</p><p>&lt;a href="([^>])>([^&lt;])</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5c8345c80cbf450cbcc39dc7a29b070d><p class=pgc-img-caption></p></div><p>4、类型字段</p><p>类型字段如下：</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/adedc91aa9a849ceac03dfc11feb8659><p class=pgc-img-caption></p></div><p>由包裹，中间为字母，构造正则如下：</p><p>([A-Za-z]+)</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/390406669bcd47ec98684352d8f82ebc><p class=pgc-img-caption></p></div><p>数据全部获取完之后，将其保存到文件中即可：</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0cb8dba33a764ac5ae1eb345da1b200c><p class=pgc-img-caption></p></div><p>最后爬取的数据集如下图所示:</p><div class=pgc-img><img alt=手把手教你使用Python爬取西刺代理数据（下篇） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/faf8bd392deb4e4b893251f092816669><p class=pgc-img-caption></p></div><p>此次总共爬取了前面 5300 多条数据。</p><p><strong>/4 小结/</strong></p><p>本次任务主要爬取了代理网站上的代理数据。主要做了以下方面的工作：</p><p>1、学习 requests 库的使用以及爬虫程序的编写；</p><p>2、学习使用反爬虫技术手段，并在实际应用中应用这些技术，如代理池技术；</p><p>3、学习使用正则表达式，并通过正则表达式进行网页元素提取；</p><p>4、学习使用 beautifulsoup 库，并使用该库进行网页元素的提取。</p><p>Python爬虫是一项综合技能，在爬取网站的过程中能够学到很多知识，希望大家多多专研，需要代码的小伙伴，可以在[Python爬虫与数据挖掘]公众号后台回复“<strong>代理</strong>”二字，即可获取。</p><p>想学习更多关于Python的知识，可以参考Python爬虫与数据挖掘网站：http://pdcfighting.com/</p><blockquote><p>本文由博客群发一文多发等运营工具平台 OpenWrite 发布</p></blockquote></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'Python','取西','数据'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>