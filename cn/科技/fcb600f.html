<!doctype html><html lang=cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>SpringBootè‡ªå®šä¹‰é”™è¯¯é¡µé¢ | æå®¢å¿«è¨Š</title><meta property="og:title" content="SpringBootè‡ªå®šä¹‰é”™è¯¯é¡µé¢ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="cn"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/17a417ace8b24067bdb1d528e6bc6be2"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fcb600f.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fcb600f.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/fcb600f.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fcb600f.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fcb600f.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/fcb600f.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/fcb600f.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fcb600f.html><meta property="article:published_time" content="2020-10-29T21:04:55+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:55+08:00"><meta name=Keywords content><meta name=description content="SpringBootè‡ªå®šä¹‰é”™è¯¯é¡µé¢"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/cn/%E7%A7%91%E6%8A%80/fcb600f.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è®¯ Geek Bank</a></h1><p class=description>ä¸ºä½ å¸¦æ¥æœ€å…¨çš„ç§‘æŠ€çŸ¥è¯† ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>SpringBootè‡ªå®šä¹‰é”™è¯¯é¡µé¢</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=cn/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">SpringBootè¯·æ±‚é”™è¯¯å¦‚404å¯èƒ½çœ‹åˆ°å¦‚ä¸‹é¡µé¢ï¼š</span></p><div class=pgc-img><img alt=SpringBootè‡ªå®šä¹‰é”™è¯¯é¡µé¢ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/17a417ace8b24067bdb1d528e6bc6be2><p class=pgc-img-caption></p></div><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999"><br>æœ‰æ—¶å¯èƒ½éœ€è¦è‡ªå®šä¹‰é”™è¯¯é¡µé¢é’ˆå¯¹ä¸åŒçš„http.status,å¦‚404/400ã€‚</span></p><h1 class=pgc-h-arrow-right><strong><span style="color:#35b378;--tt-darkmode-color: #35B378">ã€1ã€‘è§£å†³æ–¹æ³•</span></strong></h1><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">â‘  æ³¨å†Œé”™è¯¯é¡µé¢</span></h1><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å¦‚ä¸‹æ‰€ç¤ºï¼š</span></p><pre><code>@ComponentpublicÂ classÂ ErrorPageConfigÂ implementsÂ ErrorPageRegistrarÂ {Â Â Â Â @OverrideÂ Â Â Â publicÂ voidÂ registerErrorPages(ErrorPageRegistryÂ registry)Â {Â Â Â Â Â Â Â Â ErrorPageÂ error400PageÂ =Â newÂ ErrorPage(HttpStatus.BAD_REQUEST,Â "/error/404");Â Â Â Â Â Â Â Â ErrorPageÂ error404PageÂ =Â newÂ ErrorPage(HttpStatus.NOT_FOUND,Â "/error/404");Â Â Â Â Â Â Â Â ErrorPageÂ error500PageÂ =Â newÂ ErrorPage(HttpStatus.INTERNAL_SERVER_ERROR,Â "/error/500");Â Â Â Â Â Â Â Â registry.addErrorPages(error400Page,error404Page,error500Page);Â Â Â Â }}</code></pre><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">â‘¡ controllerè¿›è¡Œæ‹¦æˆª</span></h1><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç„¶åä½ åªéœ€è¦å†™ä¸ªcontrolleræ‹¦æˆªä¸åŒè¯·æ±‚ç„¶åè·³åˆ°ä¸åŒçš„è‡ªå®šä¹‰é”™è¯¯é¡µé¢å³å¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</span></p><pre><code>@RequestMapping("/error/{status}")publicÂ StringÂ errorPage(@PathVariableÂ IntegerÂ status){Â Â Â Â switchÂ (status){Â Â Â Â Â Â Â Â caseÂ 401:Â Â Â Â Â Â Â Â caseÂ 400:returnÂ "/error/404";Â Â Â Â Â Â Â Â caseÂ 500:returnÂ "/error/500";Â Â Â Â Â Â Â Â default:returnÂ "/error/default";Â Â Â Â }}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é‚£ä¹ˆåŸç†å‘¢ï¼Ÿ</span></p><h1 class=pgc-h-arrow-right><strong><span style="color:#35b378;--tt-darkmode-color: #35B378">ã€2ã€‘åŸç†è®²è§£</span></strong></h1><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">â‘  å¯åŠ¨SpringBoot,æ³¨å†Œé”™è¯¯é¡µé¢</span></h1><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯åŠ¨é¡¹ç›®æ—¶å€™</span><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å†</span><span style="color:#4d4d4d;--tt-darkmode-color: #999999">onRefreshæ–¹æ³•ä¸­ä¼šåˆ›å»ºä¸€ä¸ªWebServerï¼Œç»§è€Œè·å–ServletWebServerFactoryã€‚<br></span></p><div class=pgc-img><img alt=SpringBootè‡ªå®šä¹‰é”™è¯¯é¡µé¢ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/91eddc54888145afbe81dd38af9f57ad><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">1.1AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInitialization</span></h1><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åœ¨åˆ›å»ºbean-tomcatServletWebServerFactoryæ—¶ä¼šè°ƒç”¨AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInitialization,å¦‚ä¸‹æ‰€ç¤ºï¼š</span></p><pre><code>@OverridepublicÂ ObjectÂ applyBeanPostProcessorsBeforeInitialization(ObjectÂ existingBean,Â StringÂ beanName)Â throwsÂ BeansExceptionÂ {ObjectÂ resultÂ =Â existingBean;forÂ (BeanPostProcessorÂ processorÂ :Â getBeanPostProcessors())Â {Â ObjectÂ currentÂ =Â processor.postProcessBeforeInitialization(result,Â beanName);Â ifÂ (currentÂ ==Â null)Â {Â Â returnÂ result;Â }Â resultÂ =Â current;}returnÂ result;}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è¯¥æ–¹æ³•ä¼šè·å–beanåç½®å¤„ç†å™¨ï¼Œç„¶åå¾ªç¯éå†è°ƒç”¨æ¯ä¸ªbeanåç½®å¤„ç†å™¨çš„postProcessBeforeInitializationæ–¹æ³•ã€‚</span></p><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">1.2 ErrorPageRegistrarBeanPostProcessor.postProcessBeforeInitialization</span></h1><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å½“éå†åˆ°ErrorPageRegistrarBeanPostProcessoræ—¶ä¼šè°ƒç”¨å…¶postProcessBeforeInitializationæ–¹æ³•ï¼Œæ–¹æ³•æºç å¦‚ä¸‹æ‰€ç¤ºï¼š</span></p><pre><code>@OverridepublicÂ ObjectÂ postProcessBeforeInitialization(ObjectÂ bean,Â StringÂ beanName)Â throwsÂ BeansExceptionÂ {Â ifÂ (beanÂ instanceofÂ ErrorPageRegistry)Â {Â Â postProcessBeforeInitialization((ErrorPageRegistry)Â bean);Â }Â returnÂ bean;}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•ä¼šåˆ¤æ–­å½“å‰beanæ˜¯å¦ErrorPageRegistryç±»å‹ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è°ƒç”¨postProcessBeforeInitializationæ–¹æ³•ï¼Œæºç å¦‚ä¸‹æ‰€ç¤ºï¼š</span></p><pre><code>privateÂ voidÂ postProcessBeforeInitialization(ErrorPageRegistryÂ registry)Â {Â forÂ (ErrorPageRegistrarÂ registrarÂ :Â getRegistrars())Â {Â Â registrar.registerErrorPages(registry);Â }}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è¯¥æ–¹æ³•ä¼šè·å–Registrarsï¼Œç„¶åå¾ªç¯éå†è°ƒç”¨æ¯ä¸€ä¸ªæ³¨å†Œå™¨çš„registerErrorPagesæ–¹æ³•ã€‚è·å–æ³¨å†Œå…¶æºç å¦‚ä¸‹æ‰€ç¤ºï¼š</span></p><pre><code>privateÂ Collection&lt;ErrorPageRegistrar&gt;Â getRegistrars()Â {Â ifÂ (this.registrarsÂ ==Â null)Â {Â Â //Â LookÂ upÂ doesÂ notÂ includeÂ theÂ parentÂ contextÂ Â this.registrarsÂ =Â newÂ ArrayList&lt;&gt;(Â Â Â Â this.beanFactory.getBeansOfType(ErrorPageRegistrar.class,Â false,Â false).values());Â Â this.registrars.sort(AnnotationAwareOrderComparator.INSTANCE);Â Â this.registrarsÂ =Â Collections.unmodifiableList(this.registrars);Â }Â returnÂ this.registrars;}</code></pre><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ•…è€Œï¼Œå½“æˆ‘ä»¬çš„ErrorPageConfig å®ç°äº†ErrorPageRegistraræ—¶ï¼Œä¼šè¢«æ£€æµ‹åˆ°å¹¶æ‰§è¡ŒregisterErrorPagesæ–¹æ³•ã€‚<br></span></p><div class=pgc-img><img alt=SpringBootè‡ªå®šä¹‰é”™è¯¯é¡µé¢ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f2acf0716f764b8588ed95460a50b43c><p class=pgc-img-caption></p></div><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999"><br></span></p><div class=pgc-img><img alt=SpringBootè‡ªå®šä¹‰é”™è¯¯é¡µé¢ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ebf0d787620348d5bf6f47723bec3562><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">â‘¡ æŠŠé”™è¯¯é¡µé¢æ”¾åˆ°StandardContext.errorPageSupportä¸­</span></h1><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">StandardContextæ˜¯ä»€ä¹ˆï¼Ÿæˆ‘ä»¬å¯ä»¥çœ‹ä¸‹å¦‚ä¸‹ç±»ç»§æ‰¿ç¤ºæ„å›¾ã€‚<br></span></p><div class=pgc-img><img alt=SpringBootè‡ªå®šä¹‰é”™è¯¯é¡µé¢ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c5efd62c68654576a57ee060423d7563><p class=pgc-img-caption></p></div><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åœ¨â‘ ä¸­æˆ‘ä»¬æåˆ°ä¼šæ³¨å†Œé”™è¯¯é¡µé¢</span><span style="color:#c7254e;--tt-darkmode-color: #C7254E"><span style="background-color:#f9f2f4;--tt-darkmode-bgcolor: #C2BCBE">registrar.registerErrorPages(registry);</span></span>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºæ­¤æ—¶çš„registryä¸ºTomcatServletWebServerFactoryï¼š<br></p><div class=pgc-img><img alt=SpringBootè‡ªå®šä¹‰é”™è¯¯é¡µé¢ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fe9984a0acf0444cbe00df175cb42deb><p class=pgc-img-caption></p></div><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æˆ‘ä»¬å†æ¥çœ‹ä¸‹TomcatServletWebServerFactoryç»§æ‰¿ç¤ºæ„å›¾(å¯ä»¥çœ‹åˆ°å…¶çˆ¶ç±»AbstractConfigurableWebServerFactoryå®ç°äº†ErrorPageRegistryæ¥å£)ï¼š<br></span></p><div class=pgc-img><img alt=SpringBootè‡ªå®šä¹‰é”™è¯¯é¡µé¢ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/18765abf12a345fd8f6acb028b97ffb7><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">2.1 AbstractConfigurableWebServerFactory.addErrorPages</span></h1><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•æºç å¦‚ä¸‹ï¼š</span></p><pre><code>@OverridepublicÂ voidÂ addErrorPages(ErrorPage...Â errorPages)Â {Â Assert.notNull(errorPages,Â "ErrorPagesÂ mustÂ notÂ beÂ null");Â this.errorPages.addAll(Arrays.asList(errorPages));}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ä¹Ÿå°±è¯´é”™è¯¯é¡µé¢ç°åœ¨è¢«æ”¾åˆ°äº†å±æ€§</span><span style="color:#c7254e;--tt-darkmode-color: #C7254E"><span style="background-color:#f9f2f4;--tt-darkmode-bgcolor: #C2BCBE">private Set&lt;ErrorPage> errorPages = new LinkedHashSet&lt;>();</span></span>ä¸­ã€‚</p><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">2.2 TomcatServletWebServerFactory.configureContext</span></h1><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åˆ›å»ºå®ŒTomcatServletWebServerFactoryåä¼šè°ƒç”¨configureContextæ–¹æ³•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br></span></p><div class=pgc-img><img alt=SpringBootè‡ªå®šä¹‰é”™è¯¯é¡µé¢ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9f92456aaf744aa0937c33a86fd06f64><p class=pgc-img-caption></p></div><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999"><br>åœ¨configureContextæ–¹æ³•ä¸­ä¼šè·å–é”™è¯¯é¡µé¢ç„¶åé€ä¸ªè°ƒç”¨StandardContext.addErrorPageæ–¹æ³•æ·»åŠ åˆ°å…¶</span><span style="color:#c7254e;--tt-darkmode-color: #C7254E"><span style="background-color:#f9f2f4;--tt-darkmode-bgcolor: #C2BCBE">ErrorPageSupport errorPageSupport</span></span>ä¸­ã€‚</p><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">configureContextæ–¹æ³•ä¸­éå†é”™è¯¯é¡µé¢å¦‚ä¸‹æ‰€ç¤ºï¼š</span></p><pre><code>forÂ (ErrorPageÂ errorPageÂ :Â getErrorPages())Â {Â org.apache.tomcat.util.descriptor.web.ErrorPageÂ tomcatErrorPageÂ =Â newÂ org.apache.tomcat.util.descriptor.web.ErrorPage();Â tomcatErrorPage.setLocation(errorPage.getPath());Â tomcatErrorPage.setErrorCode(errorPage.getStatusCode());Â tomcatErrorPage.setExceptionType(errorPage.getExceptionName());Â context.addErrorPage(tomcatErrorPage);}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">StandardContext.addErrorPageæ–¹æ³•æºç å¦‚ä¸‹æ‰€ç¤ºï¼š</span></p><pre><code>@OverrideÂ publicÂ voidÂ addErrorPage(ErrorPageÂ errorPage)Â {Â Â Â Â Â //Â ValidateÂ theÂ inputÂ parametersÂ Â Â Â Â ifÂ (errorPageÂ ==Â null)Â Â Â Â Â Â Â Â Â throwÂ newÂ IllegalArgumentExceptionÂ Â Â Â Â Â Â Â Â Â Â Â Â (sm.getString("standardContext.errorPage.required"));Â Â Â Â Â StringÂ locationÂ =Â errorPage.getLocation();Â Â Â Â Â ifÂ ((locationÂ !=Â null)Â &amp;&amp;Â !location.startsWith("/"))Â {Â Â Â Â Â Â Â Â Â ifÂ (isServlet22())Â {Â Â Â Â Â Â Â Â Â Â Â Â Â if(log.isDebugEnabled())Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log.debug(sm.getString("standardContext.errorPage.warning",Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â location));Â Â Â Â Â Â Â Â Â Â Â Â Â errorPage.setLocation("/"Â +Â location);Â Â Â Â Â Â Â Â Â }Â elseÂ {Â Â Â Â Â Â Â Â Â Â Â Â Â throwÂ newÂ IllegalArgumentExceptionÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (sm.getString("standardContext.errorPage.error",Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â location));Â Â Â Â Â Â Â Â Â }Â Â Â Â Â }//è°ƒç”¨errorPageSupport.addÂ Â Â Â Â errorPageSupport.add(errorPage);Â Â Â Â Â fireContainerEvent("addErrorPage",Â errorPage);Â }</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ErrorPageSupport.addæ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</span></p><pre><code>publicÂ voidÂ add(ErrorPageÂ errorPage)Â {Â Â Â Â Â StringÂ exceptionTypeÂ =Â errorPage.getExceptionType();Â Â Â Â Â ifÂ (exceptionTypeÂ ==Â null)Â {Â Â Â Â Â Â Â Â Â statusPages.put(Integer.valueOf(errorPage.getErrorCode()),Â errorPage);Â Â Â Â Â }Â elseÂ {Â Â Â Â Â Â Â Â Â exceptionPages.put(exceptionType,Â errorPage);Â Â Â Â Â }Â }</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é€šè¿‡è¯¥æ–¹æ³•å¯ä»¥çœ‹åˆ°ï¼Œä¸æ­¢å¯ä»¥é€šè¿‡HTTPçŠ¶æ€ç å®šä¹‰é”™è¯¯é¡µé¢ï¼Œè¿˜å¯ä»¥é€šè¿‡å¼‚å¸¸ç±»å‹è¿›è¡Œå®šä¹‰ã€‚</span></p><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é‚£ä¹ˆErrorPageSupportã€statusPagesã€exceptionPagesåˆ†åˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸‹å›¾ç¤ºæ„ï¼š<br></span></p><div class=pgc-img><img alt=SpringBootè‡ªå®šä¹‰é”™è¯¯é¡µé¢ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/565704a33eed4c588ee4c4970d8779f4><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">â‘¢ é”™è¯¯é¡µé¢å¦‚ä½•è¢«ç”¨åˆ°</span></h1><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åœ¨ResourceHttpRequestHandler.handleRequestæ–¹æ³•å¤„ç†è¯·æ±‚æ—¶ï¼Œæ‰¾ä¸åˆ°èµ„æºä¼šè°ƒç”¨</span><span style="color:#c7254e;--tt-darkmode-color: #C7254E"><span style="background-color:#f9f2f4;--tt-darkmode-bgcolor: #C2BCBE">response.sendError</span></span>æ–¹æ³•ï¼š<br></p><div class=pgc-img><img alt=SpringBootè‡ªå®šä¹‰é”™è¯¯é¡µé¢ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3796e031aa06495693df31eb1b1778c1><p class=pgc-img-caption></p></div><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999"><br>è¿™é‡Œåªéœ€è¦å…³æ³¨è¿™ä¸€ç‚¹ï¼Œæ— éœ€å…³æ³¨ç»†èŠ‚ï¼Œæˆ‘ä»¬ç»§ç»­å¾€ä¸‹èµ°ã€‚ã€‚ã€‚ã€‚ä¸€ç›´èµ°åˆ°StandardHostValve.statusæ–¹æ³•ã€‚</span></p><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">StandardHostValve.statusä¸­ä¼šå¯¹å“åº”çŠ¶æ€ç è¿›è¡Œå¤„ç†ã€‚</span></p><pre><code>privateÂ voidÂ status(RequestÂ request,Â ResponseÂ response)Â {Â Â Â Â Â intÂ statusCodeÂ =Â response.getStatus();Â Â Â Â Â //Â HandleÂ aÂ customÂ errorÂ pageÂ forÂ thisÂ statusÂ codeÂ Â Â Â Â ContextÂ contextÂ =Â request.getContext();Â Â Â Â Â ifÂ (contextÂ ==Â null)Â {Â Â Â Â Â Â Â Â Â return;Â Â Â Â Â }Â Â Â Â Â /*Â OnlyÂ lookÂ forÂ errorÂ pagesÂ whenÂ isError()Â isÂ set.Â Â Â Â Â Â *Â isError()Â isÂ setÂ whenÂ response.sendError()Â isÂ invoked.Â ThisÂ Â Â Â Â Â *Â allowsÂ customÂ errorÂ pagesÂ withoutÂ relyingÂ onÂ defaultÂ fromÂ Â Â Â Â Â *Â web.xml.Â Â Â Â Â Â */Â Â Â Â Â ifÂ (!response.isError())Â {Â Â Â Â Â Â Â Â Â return;Â Â Â Â Â }//è¿™é‡Œä¼šä»errorPageSupport.find(errorCode)è·å–åˆ°é”™è¯¯é¡µ//æ ¹æ®é”™è¯¯ç ï¼Œæ¯”å¦‚404ä»statusPagesè·å–å¯¹åº”çš„ErrorPageå¯¹è±¡Â Â Â Â Â ErrorPageÂ errorPageÂ =Â context.findErrorPage(statusCode);Â Â Â Â Â ifÂ (errorPageÂ ==Â null)Â {Â Â Â Â Â Â Â Â Â //Â LookÂ forÂ aÂ defaultÂ errorÂ pageÂ Â Â Â Â Â Â Â Â errorPageÂ =Â context.findErrorPage(0);Â Â Â Â Â }Â Â Â Â Â ifÂ (errorPageÂ !=Â nullÂ &amp;&amp;Â response.isErrorReportRequired())Â {Â Â Â Â Â Â Â Â Â response.setAppCommitted(false);Â Â Â Â Â Â Â Â Â request.setAttribute(RequestDispatcher.ERROR_STATUS_CODE,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Integer.valueOf(statusCode));Â Â Â Â Â Â Â Â Â StringÂ messageÂ =Â response.getMessage();Â Â Â Â Â Â Â Â Â ifÂ (messageÂ ==Â null)Â {Â Â Â Â Â Â Â Â Â Â Â Â Â messageÂ =Â "";Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â Â request.setAttribute(RequestDispatcher.ERROR_MESSAGE,Â message);Â Â Â Â Â Â Â Â Â request.setAttribute(Globals.DISPATCHER_REQUEST_PATH_ATTR,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â errorPage.getLocation());Â Â Â Â Â Â Â Â Â request.setAttribute(Globals.DISPATCHER_TYPE_ATTR,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â DispatcherType.ERROR);Â Â Â Â Â Â Â Â Â WrapperÂ wrapperÂ =Â request.getWrapper();Â Â Â Â Â Â Â Â Â ifÂ (wrapperÂ !=Â null)Â {Â Â Â Â Â Â Â Â Â Â Â Â Â request.setAttribute(RequestDispatcher.ERROR_SERVLET_NAME,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â wrapper.getName());Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â Â request.setAttribute(RequestDispatcher.ERROR_REQUEST_URI,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â request.getRequestURI());Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //è¿™é‡Œå¾ˆé‡è¦ï¼Œå°†ä¼šå°è¯•è·³è½¬åˆ°æˆ‘ä»¬è‡ªå®šä¹‰é”™è¯¯è¯·æ±‚é¡µé¢Â Â Â Â Â Â Â Â Â ifÂ (custom(request,Â response,Â errorPage))Â {Â Â Â Â Â Â Â Â Â Â Â Â Â response.setErrorReported();Â Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â response.finishResponse();Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ClientAbortExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â IgnoreÂ Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (IOExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â container.getLogger().warn("ExceptionÂ ProcessingÂ "Â +Â errorPage,Â e);Â Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â Â }Â Â Â Â Â }Â }</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨StandardHostValve.customæ–¹æ³•ä¸­å°†ä¼šè°ƒç”¨ApplicationDispatcher.forwarè¿›è¡Œè¯·æ±‚è½¬å‘ã€‚</span></p><div class=pgc-img><img alt=SpringBootè‡ªå®šä¹‰é”™è¯¯é¡µé¢ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/08876ba39cb343c887a38c5e6436d34e><p class=pgc-img-caption></p></div><p style=text-align:justify><br></p><p style=text-align:justify>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p><p style=text-align:justify>æœ¬æ–‡é“¾æ¥ï¼š</p><p style=text-align:justify>https://blog.csdn.net/j080624/article/details/109197726</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>'SpringBoot','ä¹‰é”™','è¯¯é¡µ'</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-146415161-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>