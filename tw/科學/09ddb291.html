<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>計算機網絡基礎知識--日常工作的寶庫，收藏必備 | 极客快訊</title><meta property="og:title" content="計算機網絡基礎知識--日常工作的寶庫，收藏必備 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/b25621c28cb24220b71c32b4e2c0d0b9"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/09ddb291.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/09ddb291.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/09ddb291.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/09ddb291.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/09ddb291.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/09ddb291.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/09ddb291.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/09ddb291.html><meta property="article:published_time" content="2020-11-14T20:50:24+08:00"><meta property="article:modified_time" content="2020-11-14T20:50:24+08:00"><meta name=Keywords content><meta name=description content="計算機網絡基礎知識--日常工作的寶庫，收藏必備"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E5%AD%B8/09ddb291.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>計算機網絡基礎知識--日常工作的寶庫，收藏必備</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E5%AD%B8.html>科學</a></span></div><div class=post-content><p><strong>一、概述</strong></p><p><strong>網絡的網絡</strong></p><p>網絡把主機連接起來，而互聯網是把多種不同的網絡連接起來，因此互聯網是網絡的網絡。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b25621c28cb24220b71c32b4e2c0d0b9><p class=pgc-img-caption></p></div><p><strong>ISP</strong></p><p>互聯網服務提供商 ISP 可以從互聯網管理機構獲得許多 IP 地址，同時擁有通信線路以及路由器等聯網設備，個人或機構向 ISP 繳納一定的費用就可以接入互聯網。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/719e5d67f2764a98b51ffe0d7b313ea5><p class=pgc-img-caption></p></div><p>目前的互聯網是一種多層次 ISP 結構，ISP 根據覆蓋面積的大小分為第一層 ISP、區域 ISP 和接入 ISP。互聯網交換點 IXP 允許兩個 ISP 直接相連而不用經過第三個 ISP。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0f287841836046fb80cdc098c9d103f8><p class=pgc-img-caption></p></div><p><strong>主機之間的通信方式</strong></p><ul class=list-paddingleft-2><li>客戶-服務器（C/S）：客戶是服務的請求方，服務器是服務的提供方。</li><li>對等（P2P）：不區分客戶和服務器。</li></ul><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0d696c11c0e149e79d28e48dbf7086c8><p class=pgc-img-caption></p></div><p><strong>電路交換與分組交換</strong></p><p><strong>1. 電路交換</strong></p><p>電路交換用於電話通信系統，兩個用戶要通信之前需要建立一條專用的物理鏈路，並且在整個通信過程中始終佔用該鏈路。由於通信的過程中不可能一直在使用傳輸線路，因此電路交換對線路的利用率很低，往往不到 10%。</p><p><strong>2. 分組交換</strong></p><p>每個分組都有首部和尾部，包含了源地址和目的地址等控制信息，在同一個傳輸線路上同時傳輸多個分組互相不會影響，因此在同一條傳輸線路上允許同時傳輸多個分組，也就是說分組交換不需要佔用傳輸線路。</p><p>在一個郵局通信系統中，郵局收到一份郵件之後，先存儲下來，然後把相同目的地的郵件一起轉發到下一個目的地，這個過程就是存儲轉發過程，分組交換也使用了存儲轉發過程。</p><p><strong>時延</strong></p><p>總時延 = 傳輸時延 + 傳播時延 + 處理時延 + 排隊時延</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/04e6759ae30741bc9db2e8de60c8b891><p class=pgc-img-caption></p></div><p><br></p><p><strong>1. 傳輸時延</strong></p><p>主機或路由器傳輸數據幀所需要的時間。</p><p>其中 l 表示數據幀的長度，v 表示傳輸速率。</p><p><strong>2. 傳播時延</strong></p><p>電磁波在信道中傳播所需要花費的時間，電磁波傳播的速度接近光速。</p><p>其中 l 表示信道長度，v 表示電磁波在信道上的傳播速度。</p><p><strong>3. 處理時延</strong></p><p>主機或路由器收到分組時進行處理所需要的時間，例如分析首部、從分組中提取數據、進行差錯檢驗或查找適當的路由等。</p><p><strong>4. 排隊時延</strong></p><p>分組在路由器的輸入隊列和輸出隊列中排隊等待的時間，取決於網絡當前的通信量。</p><p><strong>計算機網絡體系結構</strong></p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/83b478e7584644be86fcf313cde34f8a><p class=pgc-img-caption></p></div><p><strong>1. 五層協議</strong></p><ul class=list-paddingleft-2><li><strong>應用層</strong> ：為特定應用程序提供數據傳輸服務，例如 HTTP、DNS 等。數據單位為報文。</li><li><strong>傳輸層</strong> ：為進程提供通用數據傳輸服務。由於應用層協議很多，定義通用的傳輸層協議就可以支持不斷增多的應用層協議。運輸層包括兩種協議：傳輸控制協議 TCP，提供面向連接、可靠的數據傳輸服務，數據單位為報文段；用戶數據報協議 UDP，提供無連接、盡最大努力的數據傳輸服務，數據單位為用戶數據報。TCP 主要提供完整性服務，UDP 主要提供及時性服務。</li><li><strong>網絡層</strong> ：為主機提供數據傳輸服務。而傳輸層協議是為主機中的進程提供數據傳輸服務。網絡層把傳輸層傳遞下來的報文段或者用戶數據報封裝成分組。</li><li><strong>數據鏈路層</strong> ：網絡層針對的還是主機之間的數據傳輸服務，而主機之間可以有很多鏈路，鏈路層協議就是為同一鏈路的主機提供數據傳輸服務。數據鏈路層把網絡層傳下來的分組封裝成幀。</li><li><strong>物理層</strong> ：考慮的是怎樣在傳輸媒體上傳輸數據比特流，而不是指具體的傳輸媒體。物理層的作用是儘可能屏蔽傳輸媒體和通信手段的差異，使數據鏈路層感覺不到這些差異。</li></ul><p><strong>2. OSI</strong></p><p>其中表示層和會話層用途如下：</p><ul class=list-paddingleft-2><li><strong>表示層</strong> ：數據壓縮、加密以及數據描述，這使得應用程序不必關心在各臺主機中數據內部格式不同的問題。</li><li><strong>會話層</strong> ：建立及管理會話。</li></ul><p>五層協議沒有表示層和會話層，而是將這些功能留給應用程序開發者處理。</p><p><strong>3. TCP/IP</strong></p><p>它只有四層，相當於五層協議中數據鏈路層和物理層合併為網絡接口層。</p><p>TCP/IP 體系結構不嚴格遵循 OSI 分層概念，應用層可能會直接使用 IP 層或者網絡接口層。</p><p>TCP/IP 協議族是一種沙漏形狀，中間小兩邊大，IP 協議在其中佔據舉足輕重的地位。</p><p><strong>4. 數據在各層之間的傳遞過程</strong></p><p>在向下的過程中，需要添加下層協議所需要的首部或者尾部，而在向上的過程中不斷拆開首部和尾部。</p><p>路由器只有下面三層協議，因為路由器位於網絡核心中，不需要為進程或者應用程序提供服務，因此也就不需要傳輸層和應用層。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9a3d481f632d4ca09d66581d2269816e><p class=pgc-img-caption></p></div><p><strong>二、物理層</strong></p><p><strong>通信方式</strong></p><p>根據信息在傳輸線上的傳送方向，分為以下三種通信方式：</p><ul class=list-paddingleft-2><li>單工通信：單向傳輸</li><li>半雙工通信：雙向交替傳輸</li><li>全雙工通信：雙向同時傳輸</li></ul><p><strong>帶通調製</strong></p><p>模擬信號是連續的信號，數字信號是離散的信號。帶通調製把數字信號轉換為模擬信號。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/30f0792401f248aaaf1c352d2d4b80c4><p class=pgc-img-caption></p></div><p><strong>三、數據鏈路層</strong></p><p><strong>基本問題</strong></p><p><strong>1. 封裝成幀</strong></p><p>將網絡層傳下來的分組添加首部和尾部，用於標記幀的開始和結束。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/3d02d2ce91be42b188161dc6e9bffd7f><p class=pgc-img-caption></p></div><p><strong>2. 透明傳輸</strong></p><p>透明表示一個實際存在的事物看起來好像不存在一樣。</p><p>幀使用首部和尾部進行定界，如果幀的數據部分含有和首部尾部相同的內容，那麼幀的開始和結束位置就會被錯誤的判定。需要在數據部分出現首部尾部相同的內容前面插入轉義字符。如果數據部分出現轉義字符，那麼就在轉義字符前面再加個轉義字符。在接收端進行處理之後可以還原出原始數據。這個過程透明傳輸的內容是轉義字符，用戶察覺不到轉義字符的存在。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1be4a4b9c85647c1a67915fae4921f54><p class=pgc-img-caption></p></div><p><strong>3. 差錯檢測</strong></p><p>目前數據鏈路層廣泛使用了循環冗餘檢驗（CRC）來檢查比特差錯。</p><p><strong>信道分類</strong></p><p><strong>1. 廣播信道</strong></p><p>一對多通信，一個節點發送的數據能夠被廣播信道上所有的節點接收到。</p><p>所有的節點都在同一個廣播信道上發送數據，因此需要有專門的控制方法進行協調，避免發生衝突（衝突也叫碰撞）。</p><p>主要有兩種控制方法進行協調，一個是使用信道複用技術，一是使用 CSMA/CD 協議。</p><p><strong>2. 點對點信道</strong></p><p>一對一通信。</p><p>因為不會發生碰撞，因此也比較簡單，使用 PPP 協議進行控制。</p><p><strong>信道複用技術</strong></p><p><strong>1. 頻分複用</strong></p><p>頻分複用的所有主機在相同的時間佔用不同的頻率帶寬資源。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9996e114a849462d8d24915159c8943b><p class=pgc-img-caption></p></div><p><strong>2. 時分複用</strong></p><p>時分複用的所有主機在不同的時間佔用相同的頻率帶寬資源。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/baf44f62bc28466a928604a7aa278590><p class=pgc-img-caption></p></div><p>使用頻分複用和時分複用進行通信，在通信的過程中主機會一直佔用一部分信道資源。但是由於計算機數據的突發性質，通信過程沒必要一直佔用信道資源而不讓出給其它用戶使用，因此這兩種方式對信道的利用率都不高。</p><p><strong>3. 統計時分複用</strong></p><p>是對時分複用的一種改進，不固定每個用戶在時分複用幀中的位置，只要有數據就集中起來組成統計時分複用幀然後發送。</p><p><br></p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e2ab89a51c084e68b88a51d943c6745a><p class=pgc-img-caption></p></div><p><strong>4. 波分複用</strong><br></p><p>光的頻分複用。由於光的頻率很高，因此習慣上用波長而不是頻率來表示所使用的光載波。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f62f3bac3c924ab1a112d1d4534d95e9><p class=pgc-img-caption></p></div><p><strong>5. 碼分複用</strong></p><p>為每個用戶分配 m bit 的碼片，並且所有的碼片正交，對於任意兩個碼片 s 和 t有</p><p>為了討論方便，取 m=8，設碼片 為 00011011。在擁有該碼片的用戶發送比特 1 時就發送該碼片，發送比特 0 時就發送該碼片的反碼 11100100。</p><p>在計算時將 00011011 記作 (-1 -1 -1 +1 +1 -1 +1 +1)，可以得到其中 s'為 s的反碼。</p><p>利用上面的式子我們知道，當接收端使用碼片 對接收到的數據進行內積運算時，結果為 0 的是其它用戶發送的數據，結果為 1 的是用戶發送的比特 1，結果為 -1 的是用戶發送的比特 0。</p><p>碼分複用需要發送的數據量為原先的 m 倍。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/11dc2fc41b7f49b7854ad3aaea8df52a><p class=pgc-img-caption></p></div><p><strong>CSMA/CD 協議</strong></p><p>CSMA/CD 表示載波監聽多點接入 / 碰撞檢測。</p><ul class=list-paddingleft-2><li><strong>多點接入</strong> ：說明這是總線型網絡，許多主機以多點的方式連接到總線上。</li><li><strong>載波監聽</strong> ：每個主機都必須不停地監聽信道。在發送前，如果監聽到信道正在使用，就必須等待。</li><li><strong>碰撞檢測</strong> ：在發送中，如果監聽到信道已有其它主機正在發送數據，就表示發生了碰撞。雖然每個主機在發送數據之前都已經監聽到信道為空閒，但是由於電磁波的傳播時延的存在，還是有可能會發生碰撞。</li></ul><p>記端到端的傳播時延為 τ，最先發送的站點最多經過 2τ 就可以知道是否發生了碰撞，稱 2τ 為 <strong>爭用期</strong> 。只有經過爭用期之後還沒有檢測到碰撞，才能肯定這次發送不會發生碰撞。</p><p>當發生碰撞時，站點要停止發送，等待一段時間再發送。這個時間採用 <strong>截斷二進制指數退避算法</strong> 來確定。從離散的整數集合 {0, 1, .., (2k-1)} 中隨機取出一個數，記作 r，然後取 r 倍的爭用期作為重傳等待時間。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8e010bd71eef4d0dadfecebc702c7257><p class=pgc-img-caption></p></div><p><strong>PPP 協議</strong></p><p>互聯網用戶通常需要連接到某個 ISP 之後才能接入到互聯網，PPP 協議是用戶計算機和 ISP 進行通信時所使用的數據鏈路層協議。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/df5024dce4c44e42a91ea9a6b25e9699><p class=pgc-img-caption></p></div><p>PPP 的幀格式：</p><ul class=list-paddingleft-2><li>F 字段為幀的定界符</li><li>A 和 C 字段暫時沒有意義</li><li>FCS 字段是使用 CRC 的檢驗序列</li><li>信息部分的長度不超過 1500</li></ul><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/44a4dec4b5ba4329ba33e71ceff3192b><p class=pgc-img-caption></p></div><p><strong>MAC 地址</strong></p><p>MAC 地址是鏈路層地址，長度為 6 字節（48 位），用於唯一標識網絡適配器（網卡）。</p><p>一臺主機擁有多少個網絡適配器就有多少個 MAC 地址。例如筆記本電腦普遍存在無線網絡適配器和有線網絡適配器，因此就有兩個 MAC 地址。</p><p><strong>局域網</strong></p><p>局域網是一種典型的廣播信道，主要特點是網絡為一個單位所擁有，且地理範圍和站點數目均有限。</p><p>主要有以太網、令牌環網、FDDI 和 ATM 等局域網技術，目前以太網佔領著有線局域網市場。</p><p>可以按照網絡拓撲結構對局域網進行分類：</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d9f95dea944f42eb9d69a40ac6465fe2><p class=pgc-img-caption></p></div><p><strong>以太網</strong></p><p>以太網是一種星型拓撲結構局域網。</p><p>早期使用集線器進行連接，集線器是一種物理層設備， 作用於比特而不是幀，當一個比特到達接口時，集線器重新生成這個比特，並將其能量強度放大，從而擴大網絡的傳輸距離，之後再將這個比特發送到其它所有接口。如果集線器同時收到兩個不同接口的幀，那麼就發生了碰撞。</p><p>目前以太網使用交換機替代了集線器，交換機是一種鏈路層設備，它不會發生碰撞，能根據 MAC 地址進行存儲轉發。</p><p>以太網幀格式：</p><ul class=list-paddingleft-2><li><strong>類型</strong> ：標記上層使用的協議；</li><li><strong>數據</strong> ：長度在 46-1500 之間，如果太小則需要填充；</li><li><strong>FCS</strong> ：幀檢驗序列，使用的是 CRC 檢驗方法；</li><li><strong>前同步碼</strong> ：只是為了計算 FCS 臨時加入的，計算結束之後會丟棄。</li></ul><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/af73692acbcf486ebffb9ab4eea2b7f3><p class=pgc-img-caption></p></div><p><strong>交換機</strong></p><p>交換機具有自學習能力，學習的是交換表的內容，交換表中存儲著 MAC 地址到接口的映射。</p><p>正是由於這種自學習能力，因此交換機是一種即插即用設備，不需要網絡管理員手動配置交換表內容。</p><p>下圖中，交換機有 4 個接口，主機 A 向主機 B 發送數據幀時，交換機把主機 A 到接口 1 的映射寫入交換表中。為了發送數據幀到 B，先查交換表，此時沒有主機 B 的表項，那麼主機 A 就發送廣播幀，主機 C 和主機 D 會丟棄該幀。主機 B 收下之後，查找交換表得到主機 A 映射的接口為 1，就發送數據幀到接口 1，同時交換機添加主機 B 到接口 3 的映射。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/e54bb23f6ce0424bb41721e56a8f5446><p class=pgc-img-caption></p></div><p><strong>虛擬局域網</strong></p><p>虛擬局域網可以建立與物理位置無關的邏輯組，只有在同一個虛擬局域網中的成員才會收到鏈路層廣播信息。</p><p>例如下圖中 (A1, A2, A3, A4) 屬於一個虛擬局域網，A1 發送的廣播會被 A2、A3、A4 收到，而其它站點收不到。</p><p>使用 VLAN 幹線連接來建立虛擬局域網，每臺交換機上的一個特殊接口被設置為幹線接口，以互連 VLAN 交換機。IEEE 定義了一種擴展的以太網幀格式 802.1Q，它在標準以太網幀上加進了 4 字節首部 VLAN 標籤，用於表示該幀屬於哪一個虛擬局域網。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/b37c1ced750644ab884244caa4d8c1f9><p class=pgc-img-caption></p></div><p><br></p><p><strong>四、網絡層</strong></p><p><strong>概述</strong></p><p>因為網絡層是整個互聯網的核心，因此應當讓網絡層儘可能簡單。網絡層向上只提供簡單靈活的、無連接的、盡最大努力交互的數據報服務。</p><p>使用 IP 協議，可以把異構的物理網絡連接起來，使得在網絡層看起來好像是一個統一的網絡。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2d9c712c80b44d1fb684d90af97c1492><p class=pgc-img-caption></p></div><p>與 IP 協議配套使用的還有三個協議：</p><ul class=list-paddingleft-2><li>地址解析協議 ARP（Address Resolution Protocol）</li><li>網際控制報文協議 ICMP（Internet Control Message Protocol）</li><li>網際組管理協議 IGMP（Internet Group Management Protocol）</li></ul><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3d6049d265c3450c89bd2081df839a88><p class=pgc-img-caption></p></div><p><strong>IP 數據報格式</strong></p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ce468ec7ecd44d7e804c71eeddbc891e><p class=pgc-img-caption></p></div><ul class=list-paddingleft-2><li><strong>版本</strong> : 有 4（IPv4）和 6（IPv6）兩個值；</li><li><strong>首部長度</strong> : 佔 4 位，因此最大值為 15。值為 1 表示的是 1 個 32 位字的長度，也就是 4 字節。因為首部固定長度為 20 字節，因此該值最小為 5。如果可選字段的長度不是 4 字節的整數倍，就用尾部的填充部分來填充。</li><li><strong>區分服務</strong> : 用來獲得更好的服務，一般情況下不使用。</li><li><strong>總長度</strong> : 包括首部長度和數據部分長度。</li><li><strong>生存時間</strong> ：TTL，它的存在是為了防止無法交付的數據報在互聯網中不斷兜圈子。以路由器跳數為單位，當 TTL 為 0 時就丟棄數據報。</li><li><strong>協議</strong> ：指出攜帶的數據應該上交給哪個協議進行處理，例如 ICMP、TCP、UDP 等。</li><li><strong>首部檢驗和</strong> ：因為數據報每經過一個路由器，都要重新計算檢驗和，因此檢驗和不包含數據部分可以減少計算的工作量。</li><li><strong>標識</strong> : 在數據報長度過長從而發生分片的情況下，相同數據報的不同分片具有相同的標識符。</li><li><strong>片偏移</strong> : 和標識符一起，用於發生分片的情況。片偏移的單位為 8 字節。</li></ul><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fdc7a46d76fe4db1963f948d49b55214><p class=pgc-img-caption></p></div><p><strong>IP 地址編址方式</strong></p><p>IP 地址的編址方式經歷了三個歷史階段：</p><ul class=list-paddingleft-2><li>分類</li><li>子網劃分</li><li>無分類</li></ul><p><strong>1. 分類</strong></p><p>由兩部分組成，網絡號和主機號，其中不同分類具有不同的網絡號長度，並且是固定的。</p><p>IP 地址 ::= {&lt; 網絡號 >, &lt; 主機號 >}</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/87df7e76841a405a9d65b4a069834fe3><p class=pgc-img-caption></p></div><p><strong>2. 子網劃分</strong></p><p>通過在主機號字段中拿一部分作為子網號，把兩級 IP 地址劃分為三級 IP 地址。</p><p>IP 地址 ::= {&lt; 網絡號 >, &lt; 子網號 >, &lt; 主機號 >}</p><p>要使用子網，必須配置子網掩碼。一個 B 類地址的默認子網掩碼為 255.255.0.0，如果 B 類地址的子網佔兩個比特，那麼子網掩碼為 11111111 11111111 11000000 00000000，也就是 255.255.192.0。</p><p>注意，外部網絡看不到子網的存在。</p><p><strong>3. 無分類</strong></p><p>無分類編址 CIDR 消除了傳統 A 類、B 類和 C 類地址以及劃分子網的概念，使用網絡前綴和主機號來對 IP 地址進行編碼，網絡前綴的長度可以根據需要變化。</p><p>IP 地址 ::= {&lt; 網絡前綴號 >, &lt; 主機號 >}</p><p>CIDR 的記法上採用在 IP 地址後面加上網絡前綴長度的方法，例如 128.14.35.7/20 表示前 20 位為網絡前綴。</p><p>CIDR 的地址掩碼可以繼續稱為子網掩碼，子網掩碼首 1 長度為網絡前綴的長度。</p><p>一個 CIDR 地址塊中有很多地址，一個 CIDR 表示的網絡就可以表示原來的很多個網絡，並且在路由表中只需要一個路由就可以代替原來的多個路由，減少了路由表項的數量。把這種通過使用網絡前綴來減少路由表項的方式稱為路由聚合，也稱為 <strong>構成超網</strong> 。</p><p>在路由表中的項目由“網絡前綴”和“下一跳地址”組成，在查找時可能會得到不止一個匹配結果，應當採用最長前綴匹配來確定應該匹配哪一個。</p><p><strong>地址解析協議 ARP</strong></p><p>網絡層實現主機之間的通信，而鏈路層實現具體每段鏈路之間的通信。因此在通信過程中，IP 數據報的源地址和目的地址始終不變，而 MAC 地址隨著鏈路的改變而改變。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/bd8576d031be4d23b4a130ec0c79e1af><p class=pgc-img-caption></p></div><p>ARP 實現由 IP 地址得到 MAC 地址。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/2b20941ec6f4474995c14d4e11c5199f><p class=pgc-img-caption></p></div><p>每個主機都有一個 ARP 高速緩存，裡面有本局域網上的各主機和路由器的 IP 地址到 MAC 地址的映射表。</p><p>如果主機 A 知道主機 B 的 IP 地址，但是 ARP 高速緩存中沒有該 IP 地址到 MAC 地址的映射，此時主機 A 通過廣播的方式發送 ARP 請求分組，主機 B 收到該請求後會發送 ARP 響應分組給主機 A 告知其 MAC 地址，隨後主機 A 向其高速緩存中寫入主機 B 的 IP 地址到 MAC 地址的映射。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/60082cec2a4a46ff8ea4aa3bd6de83f7><p class=pgc-img-caption></p></div><p><strong>網際控制報文協議 ICMP</strong></p><p>ICMP 是為了更有效地轉發 IP 數據報和提高交付成功的機會。它封裝在 IP 數據報中，但是不屬於高層協議。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6cc54c075377403184711639d7d10956><p class=pgc-img-caption></p></div><p>ICMP 報文分為差錯報告報文和詢問報文。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/23f25bc747d84391bf6431573f50c45d><p class=pgc-img-caption></p></div><p><strong>1. Ping</strong></p><p>Ping 是 ICMP 的一個重要應用，主要用來測試兩臺主機之間的連通性。</p><p>Ping 的原理是通過向目的主機發送 ICMP Echo 請求報文，目的主機收到之後會發送 Echo 回答報文。Ping 會根據時間和成功響應的次數估算出數據包往返時間以及丟包率。</p><p><strong>2. Traceroute</strong></p><p>Traceroute 是 ICMP 的另一個應用，用來跟蹤一個分組從源點到終點的路徑。</p><p>Traceroute 發送的 IP 數據報封裝的是無法交付的 UDP 用戶數據報，並由目的主機發送終點不可達差錯報告報文。</p><ul class=list-paddingleft-2><li>源主機向目的主機發送一連串的 IP 數據報。第一個數據報 P1 的生存時間 TTL 設置為 1，當 P1 到達路徑上的第一個路由器 R1 時，R1 收下它並把 TTL 減 1，此時 TTL 等於 0，R1 就把 P1 丟棄，並向源主機發送一個 ICMP 時間超過差錯報告報文；</li><li>源主機接著發送第二個數據報 P2，並把 TTL 設置為 2。P2 先到達 R1，R1 收下後把 TTL 減 1 再轉發給 R2，R2 收下後也把 TTL 減 1，由於此時 TTL 等於 0，R2 就丟棄 P2，並向源主機發送一個 ICMP 時間超過差錯報文。</li><li>不斷執行這樣的步驟，直到最後一個數據報剛剛到達目的主機，主機不轉發數據報，也不把 TTL 值減 1。但是因為數據報封裝的是無法交付的 UDP，因此目的主機要向源主機發送 ICMP 終點不可達差錯報告報文。</li><li>之後源主機知道了到達目的主機所經過的路由器 IP 地址以及到達每個路由器的往返時間。</li></ul><p><strong>虛擬專用網 VPN</strong></p><p>由於 IP 地址的緊缺，一個機構能申請到的 IP 地址數往往遠小於本機構所擁有的主機數。並且一個機構並不需要把所有的主機接入到外部的互聯網中，機構內的計算機可以使用僅在本機構有效的 IP 地址（專用地址）。</p><p>有三個專用地址塊：</p><ul class=list-paddingleft-2><li>10.0.0.0 ~ 10.255.255.255</li><li>172.16.0.0 ~ 172.31.255.255</li><li>192.168.0.0 ~ 192.168.255.255</li></ul><p>VPN 使用公用的互聯網作為本機構各專用網之間的通信載體。專用指機構內的主機只與本機構內的其它主機通信；虛擬指好像是，而實際上並不是，它有經過公用的互聯網。</p><p>下圖中，場所 A 和 B 的通信經過互聯網，如果場所 A 的主機 X 要和另一個場所 B 的主機 Y 通信，IP 數據報的源地址是 10.1.0.1，目的地址是 10.2.0.3。數據報先發送到與互聯網相連的路由器 R1，R1 對內部數據進行加密，然後重新加上數據報的首部，源地址是路由器 R1 的全球地址 125.1.2.3，目的地址是路由器 R2 的全球地址 194.4.5.6。路由器 R2 收到數據報後將數據部分進行解密，恢復原來的數據報，此時目的地址為 10.2.0.3，就交付給 Y。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/eed5356dffa14660847ea3a44934d254><p class=pgc-img-caption></p></div><p><strong>網絡地址轉換 NAT</strong></p><p>專用網內部的主機使用本地 IP 地址又想和互聯網上的主機通信時，可以使用 NAT 來將本地 IP 轉換為全球 IP。</p><p>在以前，NAT 將本地 IP 和全球 IP 一一對應，這種方式下擁有 n 個全球 IP 地址的專用網內最多只可以同時有 n 臺主機接入互聯網。為了更有效地利用全球 IP 地址，現在常用的 NAT 轉換表把傳輸層的端口號也用上了，使得多個專用網內部的主機共用一個全球 IP 地址。使用端口號的 NAT 也叫做網絡地址與端口轉換 NAPT。</p><p><br></p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/053edc31ca02499ca59ebb3a08da9263><p class=pgc-img-caption></p></div><p><strong>路由器的結構</strong></p><p>路由器從功能上可以劃分為：路由選擇和分組轉發。</p><p>分組轉發結構由三個部分組成：交換結構、一組輸入端口和一組輸出端口。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/35833e0d07fe4a078fa4395d200ef7c9><p class=pgc-img-caption></p></div><p><strong>路由器分組轉發流程</strong></p><ul class=list-paddingleft-2><li>從數據報的首部提取目的主機的 IP 地址 D，得到目的網絡地址 N。</li><li>若 N 就是與此路由器直接相連的某個網絡地址，則進行直接交付；</li><li>若路由表中有目的地址為 D 的特定主機路由，則把數據報傳送給表中所指明的下一跳路由器；</li><li>若路由表中有到達網絡 N 的路由，則把數據報傳送給路由表中所指明的下一跳路由器；</li><li>若路由表中有一個默認路由，則把數據報傳送給路由表中所指明的默認路由器；</li><li>報告轉發分組出錯。</li></ul><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6a9aa922b2834cf0a53590bc13f5cb29><p class=pgc-img-caption></p></div><p><strong>路由選擇協議</strong></p><p>路由選擇協議都是自適應的，能隨著網絡通信量和拓撲結構的變化而自適應地進行調整。</p><p>互聯網可以劃分為許多較小的自治系統 AS，一個 AS 可以使用一種和別的 AS 不同的路由選擇協議。</p><p>可以把路由選擇協議劃分為兩大類：</p><ul class=list-paddingleft-2><li>自治系統內部的路由選擇：RIP 和 OSPF</li><li>自治系統間的路由選擇：BGP</li></ul><p><strong>1. 內部網關協議 RIP</strong></p><p>RIP 是一種基於距離向量的路由選擇協議。距離是指跳數，直接相連的路由器跳數為 1。跳數最多為 15，超過 15 表示不可達。</p><p>RIP 按固定的時間間隔僅和相鄰路由器交換自己的路由表，經過若干次交換之後，所有路由器最終會知道到達本自治系統中任何一個網絡的最短距離和下一跳路由器地址。</p><p>距離向量算法：</p><ul class=list-paddingleft-2><li>對地址為 X 的相鄰路由器發來的 RIP 報文，先修改報文中的所有項目，把下一跳字段中的地址改為 X，並把所有的距離字段加 1；</li><li>對修改後的 RIP 報文中的每一個項目，進行以下步驟：</li><li>若原來的路由表中沒有目的網絡 N，則把該項目添加到路由表中；</li><li>否則：若下一跳路由器地址是 X，則把收到的項目替換原來路由表中的項目；否則：若收到的項目中的距離 d 小於路由表中的距離，則進行更新（例如原始路由表項為 Net2, 5, P，新表項為 Net2, 4, X，則更新）；否則什麼也不做。</li><li>若 3 分鐘還沒有收到相鄰路由器的更新路由表，則把該相鄰路由器標為不可達，即把距離置為 16。</li></ul><p>RIP 協議實現簡單，開銷小。但是 RIP 能使用的最大距離為 15，限制了網絡的規模。並且當網絡出現故障時，要經過比較長的時間才能將此消息傳送到所有路由器。</p><p><strong>2. 內部網關協議 OSPF</strong></p><p>開放最短路徑優先 OSPF，是為了克服 RIP 的缺點而開發出來的。</p><p>開放表示 OSPF 不受某一家廠商控制，而是公開發表的；最短路徑優先表示使用了 Dijkstra 提出的最短路徑算法 SPF。</p><p>OSPF 具有以下特點：</p><ul class=list-paddingleft-2><li>向本自治系統中的所有路由器發送信息，這種方法是洪泛法。</li><li>發送的信息就是與相鄰路由器的鏈路狀態，鏈路狀態包括與哪些路由器相連以及鏈路的度量，度量用費用、距離、時延、帶寬等來表示。</li><li>只有當鏈路狀態發生變化時，路由器才會發送信息。</li></ul><p>所有路由器都具有全網的拓撲結構圖，並且是一致的。相比於 RIP，OSPF 的更新過程收斂的很快。</p><p><strong>3. 外部網關協議 BGP</strong></p><p>BGP（Border Gateway Protocol，邊界網關協議）</p><p>AS 之間的路由選擇很困難，主要是由於：</p><ul class=list-paddingleft-2><li>互聯網規模很大；</li><li>各個 AS 內部使用不同的路由選擇協議，無法準確定義路徑的度量；</li><li>AS 之間的路由選擇必須考慮有關的策略，比如有些 AS 不願意讓其它 AS 經過。</li></ul><p>BGP 只能尋找一條比較好的路由，而不是最佳路由。</p><p>每個 AS 都必須配置 BGP 發言人，通過在兩個相鄰 BGP 發言人之間建立 TCP 連接來交換路由信息。</p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1f67491c2bfa40f9ae25a4456025644e><p class=pgc-img-caption></p></div><p><strong>五、傳輸層</strong></p><p>網絡層只把分組發送到目的主機，但是真正通信的並不是主機而是主機中的進程。傳輸層提供了進程間的邏輯通信，傳輸層向高層用戶屏蔽了下面網絡層的核心細節，使應用程序看起來像是在兩個傳輸層實體之間有一條端到端的邏輯通信信道。</p><p><strong>UDP 和 TCP 的特點</strong></p><ul class=list-paddingleft-2><li>用戶數據報協議 UDP（User Datagram Protocol）是無連接的，盡最大可能交付，沒有擁塞控制，面向報文（對於應用程序傳下來的報文不合並也不拆分，只是添加 UDP 首部），支持一對一、一對多、多對一和多對多的交互通信。</li><li>傳輸控制協議 TCP（Transmission Control Protocol）是面向連接的，提供可靠交付，有流量控制，擁塞控制，提供全雙工通信，面向字節流（把應用層傳下來的報文看成字節流，把字節流組織成大小不等的數據塊），每一條 TCP 連接只能是點對點的（一對一）。</li></ul><p><strong>UDP 首部格式</strong></p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/439c06998bb645b39d385c4212668351><p class=pgc-img-caption></p></div><p>首部字段只有 8 個字節，包括源端口、目的端口、長度、檢驗和。12 字節的偽首部是為了計算檢驗和臨時添加的。</p><p><strong>TCP 首部格式</strong></p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0333876b40cb4b79b5611b6ae4e7e11e><p class=pgc-img-caption></p></div><ul class=list-paddingleft-2><li><strong>序號</strong> ：用於對字節流進行編號，例如序號為 301，表示第一個字節的編號為 301，如果攜帶的數據長度為 100 字節，那麼下一個報文段的序號應為 401。</li><li><strong>確認號</strong> ：期望收到的下一個報文段的序號。例如 B 正確收到 A 發送來的一個報文段，序號為 501，攜帶的數據長度為 200 字節，因此 B 期望下一個報文段的序號為 701，B 發送給 A 的確認報文段中確認號就為 701。</li><li><strong>數據偏移</strong> ：指的是數據部分距離報文段起始處的偏移量，實際上指的是首部的長度。</li><li><strong>確認 ACK</strong> ：當 ACK=1 時確認號字段有效，否則無效。TCP 規定，在連接建立後所有傳送的報文段都必須把 ACK 置 1。</li><li><strong>同步 SYN</strong> ：在連接建立時用來同步序號。當 SYN=1，ACK=0 時表示這是一個連接請求報文段。若對方同意建立連接，則響應報文中 SYN=1，ACK=1。</li><li><strong>終止 FIN</strong> ：用來釋放一個連接，當 FIN=1 時，表示此報文段的發送方的數據已發送完畢，並要求釋放連接。</li><li><strong>窗口</strong> ：窗口值作為接收方讓發送方設置其發送窗口的依據。之所以要有這個限制，是因為接收方的數據緩存空間是有限的。</li></ul><p><strong>TCP 的三次握手</strong></p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/16b2765547494312b6b3b2aff80ac49a><p class=pgc-img-caption></p></div><p>假設 A 為客戶端，B 為服務器端。</p><ul class=list-paddingleft-2><li>首先 B 處於 LISTEN（監聽）狀態，等待客戶的連接請求。</li><li>A 向 B 發送連接請求報文，SYN=1，ACK=0，選擇一個初始的序號 x。</li><li>B 收到連接請求報文，如果同意建立連接，則向 A 發送連接確認報文，SYN=1，ACK=1，確認號為 x+1，同時也選擇一個初始的序號 y。</li><li>A 收到 B 的連接確認報文後，還要向 B 發出確認，確認號為 y+1，序號為 x+1。</li><li>B 收到 A 的確認後，連接建立。</li></ul><p><strong>三次握手的原因</strong></p><p>第三次握手是為了防止失效的連接請求到達服務器，讓服務器錯誤打開連接。</p><p>客戶端發送的連接請求如果在網絡中滯留，那麼就會隔很長一段時間才能收到服務器端發回的連接確認。客戶端等待一個超時重傳時間之後，就會重新請求連接。但是這個滯留的連接請求最後還是會到達服務器，如果不進行三次握手，那麼服務器就會打開兩個連接。如果有第三次握手，客戶端會忽略服務器之後發送的對滯留連接請求的連接確認，不進行第三次握手，因此就不會再次打開連接。</p><p><strong>TCP 的四次揮手</strong></p><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8026d39f273246fc90c1f0885f74360f><p class=pgc-img-caption></p></div><p>以下描述不討論序號和確認號，因為序號和確認號的規則比較簡單。並且不討論 ACK，因為 ACK 在連接建立之後都為 1。</p><ul class=list-paddingleft-2><li>A 發送連接釋放報文，FIN=1。</li><li>B 收到之後發出確認，此時 TCP 屬於半關閉狀態，B 能向 A 發送數據但是 A 不能向 B 發送數據。</li><li>當 B 不再需要連接時，發送連接釋放報文，FIN=1。</li><li>A 收到後發出確認，進入 TIME-WAIT 狀態，等待 2 MSL（最大報文存活時間）後釋放連接。</li><li>B 收到 A 的確認後釋放連接。</li></ul><p><strong>四次揮手的原因</strong></p><p>客戶端發送了 FIN 連接釋放報文之後，服務器收到了這個報文，就進入了 CLOSE-WAIT 狀態。這個狀態是為了讓服務器端發送還未傳送完畢的數據，傳送完畢之後，服務器會發送 FIN 連接釋放報文。</p><p><strong>TIME_WAIT</strong></p><p>客戶端接收到服務器端的 FIN 報文後進入此狀態，此時並不是直接進入 CLOSED 狀態，還需要等待一個時間計時器設置的時間 2MSL。這麼做有兩個理由：</p><ul class=list-paddingleft-2><li>確保最後一個確認報文能夠到達。如果 B 沒收到 A 發送來的確認報文，那麼就會重新發送連接釋放請求報文，A 等待一段時間就是為了處理這種情況的發生。</li><li>等待一段時間是為了讓本連接持續時間內所產生的所有報文都從網絡中消失，使得下一個新的連接不會出現舊的連接請求報文。</li></ul><p><strong>TCP 可靠傳輸</strong></p><p>TCP 使用超時重傳來實現可靠傳輸：如果一個已經發送的報文段在超時時間內沒有收到確認，那麼就重傳這個報文段。</p><p>一個報文段從發送再到接收到確認所經過的時間稱為往返時間 RTT，加權平均往返時間 RTTs 計算如下：</p><p>超時時間 RTO 應該略大於 RTTs，TCP 使用的超時時間計算如下：</p><p>其中 RTTd 為偏差。</p><p><strong>TCP 滑動窗口</strong></p><p>窗口是緩存的一部分，用來暫時存放字節流。發送方和接收方各有一個窗口，接收方通過 TCP 報文段中的窗口字段告訴發送方自己的窗口大小，發送方根據這個值和其它信息設置自己的窗口大小。</p><p>發送窗口內的字節都允許被髮送，接收窗口內的字節都允許被接收。如果發送窗口左部的字節已經發送並且收到了確認，那麼就將發送窗口向右滑動一定距離，直到左部第一個字節不是已發送並且已確認的狀態；接收窗口的滑動類似，接收窗口左部字節已經發送確認並交付主機，就向右滑動接收窗口。</p><p>接收窗口只會對窗口內最後一個按序到達的字節進行確認，例如接收窗口已經收到的字節為 {31, 34, 35}，其中 {31} 按序到達，而 {34, 35} 就不是，因此只對字節 31 進行確認。發送方得到一個字節的確認之後，就知道這個字節之前的所有字節都已經被接收。</p><p><strong>TCP 流量控制</strong></p><p>流量控制是為了控制發送方發送速率，保證接收方來得及接收。</p><p>接收方發送的確認報文中的窗口字段可以用來控制發送方窗口大小，從而影響發送方的發送速率。將窗口字段設置為 0，則發送方不能發送數據。</p><p><strong>TCP 擁塞控制</strong></p><p>如果網絡出現擁塞，分組將會丟失，此時發送方會繼續重傳，從而導致網絡擁塞程度更高。因此當出現擁塞時，應當控制發送方的速率。這一點和流量控制很像，但是出發點不同。流量控制是為了讓接收方能來得及接收，而擁塞控制是為了降低整個網絡的擁塞程度。</p><p>TCP 主要通過四個算法來進行擁塞控制：慢開始、擁塞避免、快重傳、快恢復。</p><p>發送方需要維護一個叫做擁塞窗口（cwnd）的狀態變量，注意擁塞窗口與發送方窗口的區別：擁塞窗口只是一個狀態變量，實際決定發送方能發送多少數據的是發送方窗口。</p><p>為了便於討論，做如下假設：</p><ul class=list-paddingleft-2><li>接收方有足夠大的接收緩存，因此不會發生流量控制；</li><li>雖然 TCP 的窗口基於字節，但是這裡設窗口的大小單位為報文段。</li></ul><p><strong>1. 慢開始與擁塞避免</strong></p><p>發送的最初執行慢開始，令 cwnd = 1，發送方只能發送 1 個報文段；當收到確認後，將 cwnd 加倍，因此之後發送方能夠發送的報文段數量為：2、4、8 ...</p><p>注意到慢開始每個輪次都將 cwnd 加倍，這樣會讓 cwnd 增長速度非常快，從而使得發送方發送的速度增長速度過快，網絡擁塞的可能性也就更高。設置一個慢開始門限 ssthresh，當 cwnd >= ssthresh 時，進入擁塞避免，每個輪次只將 cwnd 加 1。</p><p>如果出現了超時，則令 ssthresh = cwnd / 2，然後重新執行慢開始。</p><p><strong>2. 快重傳與快恢復</strong></p><p>在接收方，要求每次接收到報文段都應該對最後一個已收到的有序報文段進行確認。例如已經接收到 M1 和 M2，此時收到 M4，應當發送對 M2 的確認。</p><p>在發送方，如果收到三個重複確認，那麼可以知道下一個報文段丟失，此時執行快重傳，立即重傳下一個報文段。例如收到三個 M2，則 M3 丟失，立即重傳 M3。</p><p>在這種情況下，只是丟失個別報文段，而不是網絡擁塞。因此執行快恢復，令 ssthresh = cwnd / 2 ，cwnd = ssthresh，注意到此時直接進入擁塞避免。</p><p>慢開始和快恢復的快慢指的是 cwnd 的設定值，而不是 cwnd 的增長速率。慢開始 cwnd 設定為 1，而快恢復 cwnd 設定為 ssthresh。</p><p><strong>六、應用層</strong></p><p><strong>域名系統</strong></p><p>DNS 是一個分佈式數據庫，提供了主機名和 IP 地址之間相互轉換的服務。這裡的分佈式數據庫是指，每個站點只保留它自己的那部分數據。</p><p>域名具有層次結構，從上到下依次為：根域名、頂級域名、二級域名。</p><p>DNS 可以使用 UDP 或者 TCP 進行傳輸，使用的端口號都為 53。大多數情況下 DNS 使用 UDP 進行傳輸，這就要求域名解析器和域名服務器都必須自己處理超時和重傳來保證可靠性。在兩種情況下會使用 TCP 進行傳輸：</p><ul class=list-paddingleft-2><li>如果返回的響應超過的 512 字節（UDP 最大隻支持 512 字節的數據）。</li><li>區域傳送（區域傳送是主域名服務器向輔助域名服務器傳送變化的那部分數據）。</li></ul><p><strong>文件傳送協議</strong></p><p>FTP 使用 TCP 進行連接，它需要兩個連接來傳送一個文件：</p><ul class=list-paddingleft-2><li>控制連接：服務器打開端口號 21 等待客戶端的連接，客戶端主動建立連接後，使用這個連接將客戶端的命令傳送給服務器，並傳回服務器的應答。</li><li>數據連接：用來傳送一個文件數據。</li></ul><p>根據數據連接是否是服務器端主動建立，FTP 有主動和被動兩種模式：</p><ul class=list-paddingleft-2><li>主動模式：服務器端主動建立數據連接，其中服務器端的端口號為 20，客戶端的端口號隨機，但是必須大於 1024，因為 0~1023 是熟知端口號。</li></ul><div class=pgc-img><img alt=計算機網絡基礎知識--日常工作的寶庫，收藏必備 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3260dda0ff04402998dc886c5bfafc4f><p class=pgc-img-caption></p></div><ul class=list-paddingleft-2><li>被動模式：客戶端主動建立數據連接，其中客戶端的端口號由客戶端自己指定，服務器端的端口號隨機。</li></ul><p>主動模式要求客戶端開放端口號給服務器端，需要去配置客戶端的防火牆。被動模式只需要服務器端開放端口號即可，無需客戶端配置防火牆。但是被動模式會導致服務器端的安全性減弱，因為開放了過多的端口號。</p><p><strong>動態主機配置協議</strong></p><p>DHCP (Dynamic Host Configuration Protocol) 提供了即插即用的連網方式，用戶不再需要去手動配置 IP 地址等信息。</p><p>DHCP 配置的內容不僅是 IP 地址，還包括子網掩碼、網關 IP 地址。</p><p>DHCP 工作過程如下：</p><ol start=1><li>客戶端發送 Discover 報文，該報文的目的地址為 255.255.255.255:67，源地址為 0.0.0.0:68，被放入 UDP 中，該報文被廣播到同一個子網的所有主機上。如果客戶端和 DHCP 服務器不在同一個子網，就需要使用中繼代理。</li><li>DHCP 服務器收到 Discover 報文之後，發送 Offer 報文給客戶端，該報文包含了客戶端所需要的信息。因為客戶端可能收到多個 DHCP 服務器提供的信息，因此客戶端需要進行選擇。</li><li>如果客戶端選擇了某個 DHCP 服務器提供的信息，那麼就發送 Request 報文給該 DHCP 服務器。</li><li>DHCP 服務器發送 Ack 報文，表示客戶端此時可以使用提供給它的信息。</li></ol><p><strong>遠程登錄協議</strong></p><p>TELNET 用於登錄到遠程主機上，並且遠程主機上的輸出也會返回。</p><p>TELNET 可以適應許多計算機和操作系統的差異，例如不同操作系統系統的換行符定義。</p><p><strong>電子郵件協議</strong></p><p>一個電子郵件系統由三部分組成：用戶代理、郵件服務器以及郵件協議。</p><p>郵件協議包含發送協議和讀取協議，發送協議常用 SMTP，讀取協議常用 POP3 和 IMAP。</p><p><strong>1. SMTP</strong></p><p>SMTP 只能發送 ASCII 碼，而互聯網郵件擴充 MIME 可以發送二進制文件。MIME 並沒有改動或者取代 SMTP，而是增加郵件主體的結構，定義了非 ASCII 碼的編碼規則。</p><p><strong>2. POP3</strong></p><p>POP3 的特點是隻要用戶從服務器上讀取了郵件，就把該郵件刪除。</p><p><strong>3. IMAP</strong></p><p>IMAP 協議中客戶端和服務器上的郵件保持同步，如果不手動刪除郵件，那麼服務器上的郵件也不會被刪除。IMAP 這種做法可以讓用戶隨時隨地去訪問服務器上的郵件。</p><p><strong>常用端口</strong></p><p><strong>應用</strong></p><p><strong>應用層協議</strong></p><p><strong>端口號</strong></p><p><strong>傳輸層協議</strong></p><p><strong>備註</strong></p><p>域名解析</p><p>DNS</p><p>53</p><p>UDP/TCP</p><p>長度超過 512 字節時使用 TCP</p><p>動態主機配置協議</p><p>DHCP</p><p>67/68</p><p>UDP</p><p><br></p><p>簡單網絡管理協議</p><p>SNMP</p><p>161/162</p><p>UDP</p><p><br></p><p>文件傳送協議</p><p>FTP</p><p>20/21</p><p>TCP</p><p>控制連接 21，數據連接 20</p><p>遠程終端協議</p><p>TELNET</p><p>23</p><p>TCP</p><p><br></p><p>超文本傳送協議</p><p>HTTP</p><p>80</p><p>TCP</p><p><br></p><p>簡單郵件傳送協議</p><p>SMTP</p><p>25</p><p>TCP</p><p><br></p><p>郵件讀取協議</p><p>POP3</p><p>110</p><p>TCP</p><p><br></p><p>網際報文存取協議</p><p>IMAP</p><p>143</p><p>TCP</p><p><br></p><p><strong>Web 頁面請求過程</strong></p><p><strong>1. DHCP 配置主機信息</strong></p><ul class=list-paddingleft-2><li>假設主機最開始沒有 IP 地址以及其它信息，那麼就需要先使用 DHCP 來獲取。</li><li>主機生成一個 DHCP 請求報文，並將這個報文放入具有目的端口 67 和源端口 68 的 UDP 報文段中。</li><li>該報文段則被放入在一個具有廣播 IP 目的地址(255.255.255.255) 和源 IP 地址（0.0.0.0）的 IP 數據報中。</li><li>該數據報則被放置在 MAC 幀中，該幀具有目的地址 FF:FF:FF:FF:FF:FF，將廣播到與交換機連接的所有設備。</li><li>連接在交換機的 DHCP 服務器收到廣播幀之後，不斷地向上分解得到 IP 數據報、UDP 報文段、DHCP 請求報文，之後生成 DHCP ACK 報文，該報文包含以下信息：IP 地址、DNS 服務器的 IP 地址、默認網關路由器的 IP 地址和子網掩碼。該報文被放入 UDP 報文段中，UDP 報文段有被放入 IP 數據報中，最後放入 MAC 幀中。</li><li>該幀的目的地址是請求主機的 MAC 地址，因為交換機具有自學習能力，之前主機發送了廣播幀之後就記錄了 MAC 地址到其轉發接口的交換表項，因此現在交換機就可以直接知道應該向哪個接口發送該幀。</li><li>主機收到該幀後，不斷分解得到 DHCP 報文。之後就配置它的 IP 地址、子網掩碼和 DNS 服務器的 IP 地址，並在其 IP 轉發表中安裝默認網關。</li></ul><p><strong>2. ARP 解析 MAC 地址</strong></p><ul class=list-paddingleft-2><li>主機通過瀏覽器生成一個 TCP 套接字，套接字向 HTTP 服務器發送 HTTP 請求。為了生成該套接字，主機需要知道網站的域名對應的 IP 地址。</li><li>主機生成一個 DNS 查詢報文，該報文具有 53 號端口，因為 DNS 服務器的端口號是 53。</li><li>該 DNS 查詢報文被放入目的地址為 DNS 服務器 IP 地址的 IP 數據報中。</li><li>該 IP 數據報被放入一個以太網幀中，該幀將發送到網關路由器。</li><li>DHCP 過程只知道網關路由器的 IP 地址，為了獲取網關路由器的 MAC 地址，需要使用 ARP 協議。</li><li>主機生成一個包含目的地址為網關路由器 IP 地址的 ARP 查詢報文，將該 ARP 查詢報文放入一個具有廣播目的地址（FF:FF:FF:FF:FF:FF）的以太網幀中，並向交換機發送該以太網幀，交換機將該幀轉發給所有的連接設備，包括網關路由器。</li><li>網關路由器接收到該幀後，不斷向上分解得到 ARP 報文，發現其中的 IP 地址與其接口的 IP 地址匹配，因此就發送一個 ARP 回答報文，包含了它的 MAC 地址，發回給主機。</li></ul><p><strong>3. DNS 解析域名</strong></p><ul class=list-paddingleft-2><li>知道了網關路由器的 MAC 地址之後，就可以繼續 DNS 的解析過程了。</li><li>網關路由器接收到包含 DNS 查詢報文的以太網幀後，抽取出 IP 數據報，並根據轉發表決定該 IP 數據報應該轉發的路由器。</li><li>因為路由器具有內部網關協議（RIP、OSPF）和外部網關協議（BGP）這兩種路由選擇協議，因此路由表中已經配置了網關路由器到達 DNS 服務器的路由表項。</li><li>到達 DNS 服務器之後，DNS 服務器抽取出 DNS 查詢報文，並在 DNS 數據庫中查找待解析的域名。</li><li>找到 DNS 記錄之後，發送 DNS 回答報文，將該回答報文放入 UDP 報文段中，然後放入 IP 數據報中，通過路由器反向轉發回網關路由器，並經過以太網交換機到達主機。</li></ul><p><strong>4. HTTP 請求頁面</strong></p><ul class=list-paddingleft-2><li>有了 HTTP 服務器的 IP 地址之後，主機就能夠生成 TCP 套接字，該套接字將用於向 Web 服務器發送 HTTP GET 報文。</li><li>在生成 TCP 套接字之前，必須先與 HTTP 服務器進行三次握手來建立連接。生成一個具有目的端口 80 的 TCP SYN 報文段，並向 HTTP 服務器發送該報文段。</li><li>HTTP 服務器收到該報文段之後，生成 TCP SYN ACK 報文段，發回給主機。</li><li>連接建立之後，瀏覽器生成 HTTP GET 報文，並交付給 HTTP 服務器。</li><li>HTTP 服務器從 TCP 套接字讀取 HTTP GET 報文，生成一個 HTTP 響應報文，將 Web 頁面內容放入報文主體中，發回給主機。</li><li>瀏覽器收到 HTTP 響應報文後，抽取出 Web 頁面內容，之後進行渲染，顯示 Web 頁面。</li></ul></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>計算機</a></li><li><a>網絡</a></li><li><a>基礎</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/aecf487e.html alt=計算機網絡基礎：局域網協議相關知識 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b843ca1dae9a4662aa8b04d696310359 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/aecf487e.html title=計算機網絡基礎：局域網協議相關知識>計算機網絡基礎：局域網協議相關知識</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/0f4669bf.html alt=計算機網絡基礎：網絡分類和拓撲結構知識筆記 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9e4e39f3d95e4793a789034fa72d6081 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/0f4669bf.html title=計算機網絡基礎：網絡分類和拓撲結構知識筆記>計算機網絡基礎：網絡分類和拓撲結構知識筆記</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/629a5eb3.html alt=計算機網絡基礎之OSI七層參考模型（一、基本介紹） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b9cba7c8573b4c93ab0a1248281348c2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/629a5eb3.html title=計算機網絡基礎之OSI七層參考模型（一、基本介紹）>計算機網絡基礎之OSI七層參考模型（一、基本介紹）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0c46dcdd.html alt=計算機網絡基礎總結，如果你想成為黑客，那你還不趕緊了解一下 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/239bcd8f524e4253b1f03681762dac2a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0c46dcdd.html title=計算機網絡基礎總結，如果你想成為黑客，那你還不趕緊了解一下>計算機網絡基礎總結，如果你想成為黑客，那你還不趕緊了解一下</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e4b544df.html alt=計算機網絡通信基礎概念介紹和問題描述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1538184177058b18ef97641 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e4b544df.html title=計算機網絡通信基礎概念介紹和問題描述>計算機網絡通信基礎概念介紹和問題描述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/173684d8.html alt=計算機網絡基礎知識總結 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f8f3be6848954fafa804b2059693f26e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/173684d8.html title=計算機網絡基礎知識總結>計算機網絡基礎知識總結</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b1a87cb.html alt=計算機網絡基礎：IP地址，子網掩碼，網段表示法，默認網關詳解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/6f0a477d-a77a-438d-a023-9ff71d143d9c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b1a87cb.html title=計算機網絡基礎：IP地址，子網掩碼，網段表示法，默認網關詳解>計算機網絡基礎：IP地址，子網掩碼，網段表示法，默認網關詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8b16f98.html alt=計算機網絡基礎知識介紹 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8b16f98.html title=計算機網絡基礎知識介紹>計算機網絡基礎知識介紹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2a9a3956.html alt="100 個網絡基礎知識普及，看完成半個網絡高手！" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/955ea722-be77-4b2d-b87a-64a8a04c8ea8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2a9a3956.html title="100 個網絡基礎知識普及，看完成半個網絡高手！">100 個網絡基礎知識普及，看完成半個網絡高手！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2b6ecb90.html alt=網絡基礎知識術語你知道哪些？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2b6ecb90.html title=網絡基礎知識術語你知道哪些？>網絡基礎知識術語你知道哪些？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1267d3e8.html alt=計算機網絡-數據鏈路層 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/125a70d9a286430b8d5aabb35a77904a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1267d3e8.html title=計算機網絡-數據鏈路層>計算機網絡-數據鏈路層</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/09972eef.html alt="計算機網絡: 鏈路層(入門)" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/e50e09971c3a4165866d14abf2df9da4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/09972eef.html title="計算機網絡: 鏈路層(入門)">計算機網絡: 鏈路層(入門)</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/915806de.html alt=計算機基礎--什麼是編碼？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f866a4b5dc3c4467b261c93342e48805 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/915806de.html title=計算機基礎--什麼是編碼？>計算機基礎--什麼是編碼？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d469ff43.html alt=計算機網絡之碼分多址技術 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1be327daace445728399d2409f694a17 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d469ff43.html title=計算機網絡之碼分多址技術>計算機網絡之碼分多址技術</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c624a086.html alt=計算機網絡自學筆記：IP數據報格式與編址 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/7aa7f2180be1441c8bd9393af4355c9b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c624a086.html title=計算機網絡自學筆記：IP數據報格式與編址>計算機網絡自學筆記：IP數據報格式與編址</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>