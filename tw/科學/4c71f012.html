<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>對隨機數的追求，是人類最樸實的公正 | 极客快訊</title><meta property="og:title" content="對隨機數的追求，是人類最樸實的公正 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/RX7b5CH3X9ikP7"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/4c71f012.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/4c71f012.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/4c71f012.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/4c71f012.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/4c71f012.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/4c71f012.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/4c71f012.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/4c71f012.html><meta property="article:published_time" content="2020-11-14T20:51:44+08:00"><meta property="article:modified_time" content="2020-11-14T20:51:44+08:00"><meta name=Keywords content><meta name=description content="對隨機數的追求，是人類最樸實的公正"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E5%AD%B8/4c71f012.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>對隨機數的追求，是人類最樸實的公正</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E5%AD%B8.html>科學</a></span></div><div class=post-content><img alt=對隨機數的追求，是人類最樸實的公正 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RX7b5CH3X9ikP7><p>作者：BlockPunk</p><p>社區：果殼宇宙（ID:DfinityFun）</p><p></p><h2>前言</h2><p>4000年前的東方大陸，薩滿緩慢的從篝火的灰燼中扒出龜甲，龜甲上隨機的裂紋會決定部落下一次狩獵的時機；3000年前的地中海，尊貴的雅典神官主持著抽籤儀式，他們要隨機選出五百位優秀公民，來參與城邦政務的討論；2000年前的中東，行商圍坐在一張賭桌旁，緊張的注視著桌面上轉動的四面骰子，它的最終結果會決定一大筆財富的歸屬。</p><p>在上千年的人類歷史裡，我們一直不斷地探尋著可靠的隨機數，並將隨機數用在生活的各個方面，民主與共和的抽籤制度，戰爭時期的軍情傳遞、生產上的模型計算，以及賭博娛樂時的可信參照。</p><p>對可靠隨機數的追求，更是人類對公平的追求，對隨機數的承認，可以說是人類最早的關於公正的共識。而在2000多年後的現代，人類發明了計算機，開始了嶄新的數字紀元，隨機數成為了整個虛擬世界的基礎。</p><p></p><h2>真隨機數</h2><p>我們祖先樸實的技術而言，人類創造了很多生成隨機數的方法，但這些隨機數的隨機強度與不可預測程度，並不比燒龜甲來的更高。</p><p>這裡就要講到真隨機數與偽隨機數了。古代的人類觀察物理世界時，會發現到處都存在著隨機的波動，這種隨機性在他們看來，是上天的旨意，你完全沒法預測未來會怎麼樣。真正的隨機性，只存在於物理世界，大氣噪聲、宇宙背景輻射、放射物的衰變期、量子塌縮現象，通過觀測這些現象，得到的隨機數是完全無規律可循的。</p><img alt=對隨機數的追求，是人類最樸實的公正 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RX7b5CeDGm55R1><p>《百萬亂數表》圖片來自網絡</p><p>上世紀40年代，蘭德公司利用模擬電路製成的電脈衝發生器生成了100萬個隨機數，並將其出版為《百萬亂數表》，一直銷售到今天。現在看來這似乎是一個異想天開的行為藝術，但在當時卻是非常重大的突破。</p><img alt=對隨機數的追求，是人類最樸實的公正 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RX7b5D3IXw7Oia><p>熔岩燈圖片來自網絡</p><p>有趣的是，在互聯網時代的今天，仍有人在使用這種方法。一家名叫Cloudflare的雲服務商，通過圖像識別實時處理熔岩燈中蠟的形狀，計算量化來獲取真隨機數，從而對數據進行高強度的加密。這聽起來好像有些愚蠢，但其實它的隨機強度，卻遠強於現在主流的隨機數。</p><p></p><h2>假隨機數</h2><p>我們可以從物理現象中得到神祕而無窮的隨機性，但有些現象並不能精確量化。但同時我們需要巨量的隨機數來加密數據、訓練模型、公平仲裁，僅依靠自然界的隨機數是遠遠不夠的。</p><p>這也是計算機之父，馮諾依曼思考過的。在1946年， 馮諾依曼參與了美軍氫彈的設計，他在一臺名為ENIAC的計算機上，模擬計算核聚變的過程。而這個模型的訓練，需要對隨機數進行快速的存取，但ENIAC的內存不夠大，無法保存長真隨機數，因此馮諾依曼設計了一個算法，來模擬一個隨機性的混亂狀態。</p><img alt=對隨機數的追求，是人類最樸實的公正 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RX7b5E26XmKhbM><p>ENIAC計算機 | 圖片來自網絡</p><p>這個算法是這樣的：首先獲得一個很短的隨機值，比如操作時刻的毫秒數，作為這個算法的“種子”，然後將“種子”平方，輸出平方結果的中間部分數字，再作為“種子”重複上述操作。重複足夠的次數後，就獲得了一個“隨機數”。</p><p>這被稱為平方取中法，這也只是無數假隨機數算法中的一種，這個算法輸出的序列，只取決於最初種子的隨機性。由於機器的確定性，同樣的種子，就可以計算出同樣的隨機數。</p><p>種子的位數決定了隨機數的隨機度，當你設定一個兩位的種子生成一個10位隨機數，在函數產生重複循環之前，最多隻能得到100個可用的隨機數；而在自然界中，10位隨機數應該存在一百億種可能。這兩者之間巨大的數量級差別，就是隨機數真與假的區別。</p><p>只要你使用基於“種子”的假隨機數，必然會出現重複循環的過程，也就是說，只要知曉了你的隨機數算法，另一臺計算機遲早能暴力嘗試出相同的隨機數。這就是區塊鏈錢包的密鑰生成隨機函數被攻破後，暴力盜取密鑰的手段。</p><img alt=對隨機數的追求，是人類最樸實的公正 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RX7b5ELHOlCxMt><p>圖片來自網絡</p><p>假隨機數存在規律的週期，點集中表現為脈絡</p><p>當然這種隨機數是足夠使用的，我們必須引入計算機科學中非常重要的一個概念，時間邊界，也就是在多長的時間裡，這個隨機數是安全不重複的。和我們使用密碼車鎖一樣，我們知道正確的密碼必在一萬種的組合方式之中，但一個個嘗試需要花費好幾天時間，這個時間邊界內都算是安全，假隨機數也是如此。</p><p>我們閉眼敲鍵盤的隨機字符串，其實也有規律可循，這就是QWER的鍵盤佈局，通過分析後破解隨機數的可能性就會很大</p><p>這依然無法滿足區塊鏈的使用要求，因為我們需要一個能在固定時間內，分佈式的獲取隨機數的方法，而不能依賴於任何一箇中心主體。</p><p></p><h2>區塊鏈為什麼需要隨機數</h2><p>在傳統互聯網中，隨機數是作為密碼學與隱私安全的基礎，通過共享隨機的密鑰，兩個節點間就可以進行加密的私人通訊，而在區塊鏈中，就是使用私鑰密鑰傳輸財產；同時隨機數還廣泛應用於有限帶寬下的多節點通訊，可以利用隨機數來決定數據發送的合理順序，來協調多方節點，在區塊鏈上，就是利用基於隨機數的共識算法，協調交易確認者，保證一段時間內大家只對部分節點的消息進行反饋更新，從而在網絡消息數有限的情況下獲得一致。</p><p>而在區塊鏈與加密的世界裡，隨機數上再次投射出了人類對公平的追求。我們的世界是隨機的，過去無法更改，但未來不可預測，這是對生命最大的公平。區塊鏈上一樣，我們通過隨機數的可信，脫離人性的干擾，獲得鏈上的公正性，保證整個系統的去中心化程度與可信性。特別是權益證明PoS越來越火的現在，我們比以往任何時候都需要一個安全、穩定、可信的隨機數，來保證密鑰對的生成、鏈上數據的加密、出塊權力的裁定、智能合約的運行。</p><p></p><h3>總結</h3><ul><li><p>公平的決定出塊權力，維持一致性共識。部分PoW與PoS機制下，依靠隨機數選定出塊者或者出塊組的，包括DPoS機制下的循環出塊的順序，也是依靠隨機數決定。</p></li><li><p>私鑰的生成。目前私鑰只要由各錢包自定隨機數方法生成，存在較大安全隱患。</p></li><li><p>鏈上應用的隨機數源。保證博彩、遊戲、抽獎、分發、調查等應用的公平公正，此類容易被黑客攻擊。</p></li><li><p>數據加密。鏈上數據因為是公開審查的，需要強度較高的加密，通過足夠強的隨機數確保鏈上數據的隱私與安全。</p></li></ul><p></p><h2>鏈上隨機數的難點</h2><p>雖然區塊鏈還是基於過去的互聯網技術，但是在隨機數生成部分卻有著非常大區別。</p><p>傳統的隨機數產生方式是中心化的，產出的隨機數，與特定機器的狀態值、物理狀態相關，而同一個隨機數算法，在不同的節點上得到的隨機數是不同的，並且也沒法針對每一個隨機數進行驗證，因此傳統的方式無法產生一致性的隨機性，這和區塊鏈不兼容。</p><p>因此區塊鏈上的隨機數，需要重頭開始設計機制，從而來獲得滿足分佈式特點的結果。因此到目前為止，沒有真正意義上完美的方案，區塊鏈上的真隨機數是缺失的，連假隨機數都很難獲得。</p><p></p><h3>鏈上隨機數的原則</h3><p>1.不可預測</p><p>因為隨機數決定著整個協議層包括所有以上層級的公正性，如果這個隨機數是能提前預見的，那麼就可以伺機發動攻擊。當然這個不可預測性是存在時間邊界的，一般以區塊鏈時間為邊界，通過控制計算難度，或設置等待，來增加預測的難度。簡而言之，有兩種方案：</p><ul><li><p>保證隨機數從區塊時間上看是串行的（VRF/VDF）</p></li><li><p>保證隨機數產生的難度，並按情況調節難度（哈希碰撞）</p></li></ul><p>2.不可干擾</p><p>隨機數決定著區塊（非拜占庭容錯系統中）的共識確認，因此如果能干擾到隨機數的發生，無需掌握超越上限的節點/算力，就可以間接的控制區塊鏈未來的走向，雖然干擾可能很微小，但多次干擾積累下來就會出現較嚴重的問題（“放大攻擊”）。有兩種解決方案：</p><ul><li><p>保證隨機數生成是非交互的（閥值簽名方案），或完全根據節點本身狀態計算（哈希碰撞）</p></li><li><p>設置隨機數生成時延，需要等待長時間的複雜計算才能得出隨機數，讓干擾者無法預估自己施加的影響</p></li></ul><p>3.可驗證</p><p>應該詳細表述為，可被簡單驗證，這表示隨機數必須能夠被任何節點快速進行驗證其合法性，這樣分佈式的節點才能通過檢驗隨機數，確認某一節點的出塊資格，從而達成一致性。如果驗證效率很低，需要很長時間，那麼節點間共識的達成就會遙遙無期，區塊鏈無法使用。</p><p></p><h3>不符合上述原則的一些解決方案</h3><p>為了解決區塊鏈上的隨機數難點，自發的產生了許多解決方案，以下簡述以下不符合上述三個原則的方案，雖然他們各自都有自洽的邏輯與一定的安全性，但在現階段還是存在問題的，在對安全需求不是那麼高的地方仍可以使用。這不不針對某個項目，而是指出相似範式的問題。</p><p>1.使用鏈下真隨機數</p><p>不在鏈上計算隨機數，而是使用從物理現象中獲得的真隨機數，比如大氣噪聲、電子脈衝，以及依賴包含熱噪聲電路的芯片組。但是對區塊鏈來說，鏈下部分是不可見的，默認就是不可信的，鏈下獲得隨機數一定需要一個第三方上傳至鏈上，這不僅違背了區塊鏈的去中心化精神，完全無法驗證，且存在篡改與提前預知的風險。就算使用預言機來去中心化的獲取鏈下的真隨機數，但仍存在物理上的人為干擾。因此這種方案非常不可取。</p><p>2.將當前塊的數據作為隨機源</p><p>很多的鏈上博彩類Dapp，都習慣直接引用最近區塊的哈希根值等作為合約的隨機種子，再來產生隨機數。雖說簡介的藉助了鏈上算力的保證，如此產生的隨機數看似足夠有公信力，但需要考慮到多維度的安全性。首先，區塊上的數據是透明的，所有節點都能獲取，攻擊者同樣能用來攻擊合約，唯一的障礙就是不開源的隨機數算法。第二點，出塊人獲得出塊資格後，可以嘗試變更打包交易順序、嘗試打包不同交易，來產生最有利於他的哈希根值，從而擴大自己中獎的概率，這對其他參與者是不公平的。</p><p>3.藉助分佈式組織產生隨機數</p><p>因為隨機數的強度來源於種子的隨機性，因此就有人提出由一個分佈式組織來產生足夠隨機的種子，依賴與本地節點的特殊狀態或控制者的“自由意志”，向鏈上上傳祕密與驗證，以特殊算法組合種子，再在鏈上產生隨機數。先不論鏈下的合謀可能（有經濟設計制約），這種方案還是存在“最後參與者攻擊”的可能，也就是最後一個上傳祕密的參與者，可以知道此前的全部祕密，他可以控制自己的祕密來干擾最終隨機數的產生。且在掌握了函數算法後，可以預測影響的規律，如此可以多次施加干擾，進而不斷擴大自己的影響，這就是“放大攻擊”。</p><p></p><h2>三類方案</h2><p>雖然區塊鏈上的隨機數並不完美，但隨這越來越多的項目認識到了隨機數對效率和冗餘度的巨大優化，隨機數的可信與高效顯得越來越重要。因此這裡總結了三類相對成熟方案，並指出了相關項目與方案優缺點。</p><p></p><h3>哈希碰撞</h3><p>在PoW系統中，礦工的客戶端有一個基於本節點狀態的隨機數發生器，可以輸出隨機數序列，然後再計算其哈希值，一但生成的哈希值在規定的大小範圍內，就是為獲得了出塊資格，其他節點獲取這個隨機數值，計算一次哈希值即可進行驗證，因此它的驗證是十分簡潔的。</p><p>因此這個隨機數得經歷數百兆億次隨機數發生後，才有機會獲得一個符合要求的隨機數，因此它的隨機程度非常的高；同時由於得出隨機數消耗的資源非常大，想要提前幾個區塊預測這個隨機數幾乎是不可能的；由於隨機數完全根據節點本身狀態輸出隨機數，因此這個隨機數不會其他攻擊者干擾；即時的難度調整（調整哈希值的大小範圍），在安全時間邊界內不會出現被攻破的情況。</p><p>PoW的共識特點，使得其天然具備隨機性的（randomness for free）。</p><p>優點：</p><ul><li><p>隨機性最強，安全性號，非常適合驅動共識層；</p></li><li><p>產生隨機數時不需要使用網絡帶寬。</p></li></ul><p>缺點：</p><ul><li><p>計算冗餘度，計算消耗大，資源浪費；</p></li><li><p>難以在應用層使用；</p></li><li><p>不具備唯一性，可以同時存在多個滿足要求的隨機數，可能導致區塊分叉；</p></li><li><p>無法抵抗並行加速破解，計算機持有多的人可以連續預測多個隨機數。</p></li></ul><p></p><h3>可驗證隨機函數（VRF）</h3><p>VRF（Verifiable Random Function）算法於1999年由莫卡利教授提出，由於其較好的安全性與效率，被越來越多區塊鏈項目拿來優化共識過程，讓共識的隨機數部分佔用計算資源變少，讓資源更多地被交易的確認與合約的運行所佔用。</p><img alt=對隨機數的追求，是人類最樸實的公正 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RX7b5VmEf6Md36><p>集合上圖簡述生成步驟：</p><p>0.生成隨機數簽名專用公私鑰對；</p><p>1.獲得一個足夠隨機的種子，可以直接使用上一輪結果，與區塊高度、時間的變量等進行組合；</p><p>2.用隨機數私鑰對之進行簽名（共同參與隨機數生成），或是先簽名再組合；</p><p>3.對簽名後的值做哈希摘要，得出最新的隨機數；</p><p>4.檢查隨機數是否在合法範圍中，判斷是否抽籤成功進入出塊組（部分項目不需要這個過程）</p><p>5.根據公鑰與輪次等輸入，計算證明，接受隨機數後驗證者使用函數進行驗證。</p><p>因此這樣產生的隨機數，節點可以輕鬆驗證其是否合乎算法，"Verifiable"就這樣做到了；而經過足夠複雜的算法，加上哈希摘要過程，獲得足夠隨機分佈的結果，“Random”得到了保證。</p><p>VRF主要結合PoS機制一起使用，來進行出塊人（群）的隨機選擇，個別項目中直接決定區塊的一致性選擇。這個隨機數的生成過程可以完全在一個節點的鏈下運行，同時也可以整個運行在鏈上。</p><p>需要注意的是簽名隨機的部分，VRF的這個簽名隨機算法應當具備唯一性，也就是說用同一把密鑰，對同一個數據簽名隨機多次，只有唯一的一個隨機數能被公鑰驗證，這就能防止產生隨機數時，多次運行簽名隨機部分，來獲得最有利於自己的隨機數。</p><p>優點：</p><ul><li><p>算力要求低，產出隨機數效率高；</p></li><li><p>產生唯一性、確定性的隨機數，不易出現分叉；</p></li><li><p>驗證可滯後於隨機數產生，適合進行祕密選舉；</p></li><li><p>可設置為（輸入為上輪結果）抗並行加速破解，礦機多者也無法連續預測隨機數。</p></li></ul><p>缺點：</p><ul><li><p>驗證步驟較多，祕密選舉下需要多次驗證；</p></li><li><p>隨機數分佈均勻性不好，因為是根據特點密鑰計算的；</p></li><li><p>帶寬佔用高，延時長，是為讓祕密選舉的節點互相確認，BLS項目問題不大；</p></li></ul><p>Algorand</p><p>每一個節點都獲取前一輪確認區塊上的隨機種子，集合輪次時間等，在鏈下單獨運行VRF函數，然後對結果進行哈希摘要，節點將結果與網絡中哈希值範圍進行比較（比較類似於PoW哈希比對），範圍內的成員便有資格參與驗證與出塊。</p><p>因為VRF是在網絡邊界，也就是節點鏈下部分運行的，對整個網絡來說，究竟抽出哪些節點是不可知的，抽中節點不清楚那些節點也被選中，需要互相發送隨機數與證明，並收集驗證來判斷其他節點身份，因此這個過程被稱其為“祕密選舉”。</p><p>而至於區塊的選擇，是根據抽中的出塊節點隨機數的“資質”決定，同時節點需要對其他的區塊進行投票，這過程是一個改進過的拜占庭容錯協議，並且投票需要兩輪，每一輪都需要進行一次“祕密選舉”。</p><p>可見，algo是節點各自運行VRF，然後全網根據拜占庭容錯的過程，獲得了唯一的隨機數。</p><p>優點：</p><ul><li><p>“祕密選舉”，無法第一時間知曉所有被選中節點，因此無法提前串通或定點攻擊；</p></li><li><p>每一輪次共識，隨機生成驗證組，組的規模與成員都無法預知；</p></li></ul><p>缺點：</p><ul><li><p>抽中的節點需要很長時間互相確認身份，需要遍歷全網，帶寬使用率太高，這使得一般人無法參與共識，影響去中心程度；</p></li><li><p>由於驗證組大小根據概率範圍分佈，網絡規模小時選不出足夠多的節點，網絡規模大時驗證組過大性能太低；</p></li></ul><p>（還有其他缺點，比如拜占庭共識輪次過多，不過這不屬於VRF使用的問題，在此不表）</p><p></p><h3>DFINITY</h3><p>節點第一次進行抵押加入網絡，就會根據分佈式密鑰生成協議，隨機為每個節點專屬的“隨機數密鑰”。</p><p>這個分佈式密鑰協議會生成符合要求的總密鑰對，並根據系統規定的委員會組大小，對總密鑰對進行切分，分給組內的節點。節點會獲得一個專用簽名密鑰，但是誰都不知道總密鑰是什麼。</p><p>組的分配是隨機的，一個節點能同時存在於多個組中，但是組的成員是事先固定已知的，這一點與Algorand的“祕密選舉”有所不同——DFINITY是“先驗”，Algorand是“後驗”。</p><p>DFINITY的隨機數生成過程是完全在鏈上的，你無法對這個隨機數過程進行控制。上一輪的隨機數，會在多個組中選出本輪的委員會組，整個過程的公開的。委員會組會履行出塊、公證的義務，公證過程時，節點會不斷尋找“權重”最高的那個區塊，這個“權重”也是上一輪的隨機數決定的，找到一個區塊，就會使用“隨機數密鑰”簽名並廣播。</p><img alt=對隨機數的追求，是人類最樸實的公正 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RX7b5VzB4FPP78><p>而有一個運行在鏈上的程序，叫做隨機數信標，它在不斷地接受當前輪的簽名數據，當有一個區塊的簽名的簽名超過驗證組節點數的50%，它就會將簽名聚合起來，產生一個唯一確認的隨機數。這個隨機數的出現，就預示著本輪共識的結束，將會繼續選擇下一輪共識的參與者。</p><p>整個隨機數生成過程中，沒有任何一個節點可以控制這個隨機數信標，並且不需要節點間互相交流來獲得唯一確認性（拜占庭容錯過程），而神奇的是，在不需要節點交流共識的情況下，只要隨機數信標收集了足夠多的簽名， 不管這些簽名來自哪50%，它一定會生成一個唯一合法且確定的隨機數，目前唯一能現在這個功能的算法，就是BLS閥值簽名算法，也是DFINITY最大的特色。（具體共識過程參考文章）</p><p>優點：</p><ul><li><p>共識與隨機數生成階段節點無需交互，自動執行，無需拜占庭容錯，效率高，帶寬佔用較低；</p></li><li><p>隨機數的生成過程時不可操作的，非交互式的，因此無法施加影響，隨機數更公正；</p></li><li><p>閥值組已經確定，而不隨共識變化，天生適合分片，因此擴展性很好；</p></li><li><p>簽名體積小，共識敲定快，TPS、最短確認時間與最終確認時間，都比同類VRF+PoS項目要好。</p></li></ul><p>缺點：</p><ul><li><p>後驗性，組員在共識前就已確定好，可能存在串通勾結的可能；</p></li><li><p>完全由隨機數驅動，勾結節點雖無法控制區塊鏈，但可以使系統宕機停止；</p></li><li><p>BLS算法學術基礎已經足夠，但缺少工程實現，並無開源案例。</p></li></ul><p>Cardano</p><p>此項目是著名的銜尾蛇（Ouroboros）算法的首個實現，共識階段以時代（epoch）為週期，每個輪次存在多個插槽（slot），每一個插都會產生一個區塊，如果出現問題可以跳過一個插槽。而每一個插槽該由誰來進行出塊，是需要使用本輪時代的起源（genesis）區塊給出的隨機數種子、有資格參與共識節點的抵押權益、節點公鑰、插槽列表（index）等數據，集合節點公佈的公鑰，計算最終結，數就決定了哪個節點(slot leaders)能進行出塊。</p><p>因此Cardano的關鍵就在於每一個時代，起源區塊上包含了決定出塊者的隨機數，實則在這狀態機下的節點裡，在起源區塊生成之初就已經決定了本時代的出塊者都是誰，這個選擇從算法需要計算一陣子，這個計算出塊者的過程可以看作是VRF的後驗證過程，因此Cardano也可以近似的看作“祕密選舉”。</p><p>關鍵就在於起源（genesis）區塊中隨機數的產生，他需要足夠隨機，且能被節點們共同認可。Cardano以承諾揭祕的過程來讓每一個節點上傳他們自根基自機器狀態產生的隨機數，在祕密揭露後，將這些隨機數組合起來共同產生一個隨機字符串。這就是隨機數的生成過程。</p><p>揭祕的過程比較複雜，首先在插槽出塊階段前，所有根據權益（按照抵押大小）選上的節點，會祕密的計算一個隨機字符串，然後把這個字符串進行復雜加密，將加密後的密文廣播全網（不廣播視為在下一時代中棄權），並承諾會解釋祕密。隨後在插槽出塊過程中，節點會公開一個揭示數據Open，這個Open包含了解密與原隨機數，可以用於檢驗節點的這個隨機數。如此便可以保證在產生隨機數之前，節點早就準備好了隨機數並沒有修改過，而不是在收到他人祕密後才生成的，因為那樣可以間接的干擾隨機數的生成，從而間接控制區塊鏈。</p><p>但是有一個問題，節點可以在揭露階段不發送Open和隨機數，這有機率導致手機不到足夠多的節點隨機數，起源（genesis）區塊無法產生，最終區塊鏈宕機。為了抵抗這種風險，Cardano規定節點必須在發送加密密文階段，就把Open根據算法分成好幾份，使用本時代出塊者公鑰加密。一但有節點跑路，出塊節點就可以用自己的私鑰解密Open的碎片，然後拼合起Open。</p><p>而這個分割Open的算法，被稱為可驗證的密鑰分享VSS (verifiable secret sharing) 。再把Open分割後，吃有一個碎片是無法窺探Open全貌的，因此這個隨機數，即使是出塊者也沒法提前獲得。同時這個VSS算法優點類似於DFINITY使用的BLS算法，不需要全部碎片拼合起來，只要部分碎片就可以恢復出完整的Open。</p><p>可見上述的VSS、拆分揭示等多種容錯，保證了因節點跑路掉線導致宕機的可能性降得很低。</p><img alt=對隨機數的追求，是人類最樸實的公正 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RX7b5WGItVQwNu><p>優點：</p><ul><li><p>隨機性較好，安全性較高；</p></li><li><p>不會因為VRF的緣故發生宕機。</p></li></ul><p>缺點：</p><ul><li><p>驗證組是先確定的，根據權益大小排序，因此去中心化略差；</p></li><li><p>節點間可以串通勾結；</p></li><li><p>獲取隨機數是需要多次通訊，帶寬佔用高（因為組小，比Algo好一點）。</p></li></ul><p></p><h2>VDF+Randao</h2><p>之前有哈希碰撞中有講到，因為區塊數據的透明，PoW機制下的隨機數很難在上層的合約中作為種子應用，以太坊1.0也存在這個問題。因此就有人考慮使用去中心化的組織來分佈式的收集種子，從而在合約上實現一個安全不可預測的隨機數，這就是Randao。上文中也提到了，雖然其使用經濟上的設計限制了串通，但是卻依然存在“最後參與者攻擊”與“放大攻擊”的風險。</p><p>最後參與者攻擊：最後一個參與Randao的人可以預測部分未來隨機數，因此可以選擇不公開祕密，對其施加干擾。</p><p>放大攻擊：多次執行最後參與者攻擊，將對隨機數的干擾擴大，從而簡介掌控組織。</p><p>而在最近公佈的以太坊2.0的方案中，為了性能的考慮，需要使用PoS來替代PoW，因此需要隨機數來選定出塊資格。隨機數運行在一條稱為“信標鏈”的單鏈上，其產生的隨機數來隨機控制分片的組成，進而實現多片並行，擴展以太坊性能。因此隨機數又成為了以太坊升級的重要基礎，涉及到分片的公正性，與最終確認的可能性。</p><p>PoW的分片方案太過複雜，因此以太坊2.0的分片基於PoS實現，隨機數也是如此，無法再用過哈希碰撞來獲取共識層的隨機數了，因此以太坊2.0借鑑了Randao的想法，但為了解決上面講的兩個問題，引入了一個可驗證延遲函數VDF（Verifiable Delay Function），讓通過Randao產生的隨機數需要經歷一段很長的時間，才能得出結果，這個計算難度比較高，且必須等待多個區塊，是串行運行的，這樣一開始像Randao中傳送祕密時，攻擊者無法預測吃自己的祕密對最終最技術的影響，也就無法發動上述攻擊了。</p><p>首先介紹一下Randao，以太坊2.0上的節點通過抵押32的ETH，獲得加入Randao的資格，每一獲取隨機數種子時，參與Randao的節點會在心裡默唸一個祕密的數字，然後加密後廣播出去。在所有人都獲取了其他人的密文後，節點會相繼公開這個祕密，隨機數使用某種方式合併，就可作為隨機數種子，來生成最終的隨機數。這就像玩橋牌，先牌面朝下的發牌給玩家，然後開牌時一個個進行揭露、為了不讓最後一個參與者預測結果，來施加干擾，選擇使用VDF來生成最終的隨機數。</p><p>而這個VDF存在以下特點：</p><p>1.計算難度高，結果有延遲。VDF的計算過程較為複雜，需要等待很長的時間才能得出結果，因此將延遲時間設置的足夠長，想快速預測結果是十分困難的；</p><p>2.驗證簡單。VDF的運行過程可以是困難且耗時的，但是檢驗結果時必須足夠快捷；</p><p>3.串行性。VDF的計算是一步一步執行的，想要計算最終結果必須按部就班的來，沒法進行並行加速，即使攻擊者手持多臺機器也無法短時間裡預測結果。</p><p>就比如對一個長整數，連續取10次方後，對某一個大素數求餘數，然後連續進行上述步驟幾百次，這就是一個VDF的函數。因此計算次方的算法是有難度的，且多次循環下，必須知道前一次結果才能進行後一次的運算，因次這個算法的最終結果沒法很快的計算出來，必須老老實實一步一步的進行。同時由於人類的計算機架構，即使是算你差別非常大，這個計算難度也不會有指數級的變化，依舊十分難解。這個不可預測性，就保證了隨機數的安全性。</p><p>其實上述部只是一個計算結果的算法，VDF還應包含一個用於驗證結果的算法，VDF的結果不僅只是一個隨機數，還產生一個對隨機數的驗證，任何節點都可以快速的驗證。</p><img alt=對隨機數的追求，是人類最樸實的公正 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RX7b5WV7lSnfra><p>在以太坊2.0階段 ，這個VDF的延遲被設定為102分鐘。每100區塊稱為一個世代（epoch)，也就是6分鐘左右，每經歷一個世代，就會揭露一次Randao的祕密，每次揭露都要運行一個VDF。因此計算得知，任何時間總會有16個VDF同時在鏈上運行。</p><p>優點：</p><ul><li><p>目前區塊鏈上最難預測的假隨機數，隨機數強度非常高，但弱於POW；</p></li><li><p>隨機數嚴格遵序串行，抗並行加速運算；</p></li><li><p>得到隨機數過程不需要過多的交互，帶寬專用率低於VRF。</p></li></ul><p>缺點：</p><ul><li><p>VDF計算過程難度很高，獲取隨機數的效率很低，對計算性能有較大浪費；</p></li><li><p>雖然計算難度很高，但不像PoW一樣抗量子計算，有攻破可能；</p></li><li><p>不能立刻生成隨機數，需要等待長時間延遲；</p></li></ul><p></p><h2>總結</h2><p>統計學家弗朗西斯 · 加爾頓在1890年的《自然》雜誌上寫道：“作為一個選擇隨機的工具，我發現沒有什麼優於骰子。”</p><p>人類不斷的試圖用規律總結隨機性，但新的隨機性又會出現在新的規律之下，我們驚訝於量子世界的無序與隨機，這又激發了我們探索的好奇心。可以說對隨機數的認識，就是人類的進步史，對隨機數的追求，不僅是對科學的訴求，更是對宿命論的反駁。</p><p>同時，我們創造了二進制的虛擬世界，我們想在這個世界上，儘可能地模擬複製我們的宇宙，也獲得大自然中那美妙而神祕的隨機數，這個意義是巨大的——有了機器上的真隨機數，我們是不是就可以給虛擬世界賦予生命了？我們是不是就能模擬一個“自由意志”了？我們人類是不是也有可能虛擬化的生存了？</p><p>宇宙間的隨機性，是對生命最大的公平性，區塊鏈上的隨機數，會成為人類對公平的最直觀也是最根本的追尋。過去已經決定，現在正在發生，未來總體是隨機的，區塊鏈上的世界也應該如此。</p><p>一個運行在01機器上，能被世間萬物所認可的隨機數，在區塊鏈之前，從來都沒有這麼迷人過。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>隨機數</a></li><li><a>人類</a></li><li><a>最樸實</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/47facbb9.html alt=SVHACKS--偽隨機數 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/10b87c79-8837-4bfd-9418-b994acbf0174 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/47facbb9.html title=SVHACKS--偽隨機數>SVHACKS--偽隨機數</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b8bda645.html alt=「Java」隨機數詳解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b471807e699b44c2b1dedc580ea3f3af style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b8bda645.html title=「Java」隨機數詳解>「Java」隨機數詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/15f60fea.html alt=此地無人生還：區塊鏈隨機數的原罪與救贖 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/153820081912869d8e48468 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/15f60fea.html title=此地無人生還：區塊鏈隨機數的原罪與救贖>此地無人生還：區塊鏈隨機數的原罪與救贖</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3e0ec310.html alt=當一名黑客進入賭場——“偽隨機數”讓他們贏得盤滿缽滿！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/43890002fb2bafa5fa43 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3e0ec310.html title=當一名黑客進入賭場——“偽隨機數”讓他們贏得盤滿缽滿！>當一名黑客進入賭場——“偽隨機數”讓他們贏得盤滿缽滿！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0cdba029.html alt=C++｜徹底弄清偽隨機數與隨機數 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0cdba029.html title=C++｜徹底弄清偽隨機數與隨機數>C++｜徹底弄清偽隨機數與隨機數</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9a7b7719.html alt=基於混沌系統的偽隨機數發生器設計 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9a7b7719.html title=基於混沌系統的偽隨機數發生器設計>基於混沌系統的偽隨機數發生器設計</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b1245e7f.html alt=科普：真隨機數和偽隨機數 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RsQAnMc9J7nq07 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b1245e7f.html title=科普：真隨機數和偽隨機數>科普：真隨機數和偽隨機數</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/75382aee.html alt=隨機數不隨機，那麼它們到底是怎麼產生的呢？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RWoAWjpTrh9Z1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/75382aee.html title=隨機數不隨機，那麼它們到底是怎麼產生的呢？>隨機數不隨機，那麼它們到底是怎麼產生的呢？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/60ad5b8a.html alt=人類設計中的類型之愛：如何差異化的去愛一個顯示者 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/58da3f72-531a-4ad2-ae30-5dd26405db02 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/60ad5b8a.html title=人類設計中的類型之愛：如何差異化的去愛一個顯示者>人類設計中的類型之愛：如何差異化的去愛一個顯示者</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7522a9b6.html alt=這個實驗，讓人類等了一百年 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/82a860a9d16a4246981c66589357e4b5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7522a9b6.html title=這個實驗，讓人類等了一百年>這個實驗，讓人類等了一百年</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4ff64f7d.html alt=人類究竟能不能完全避免火災？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1537952167138b457b20252 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4ff64f7d.html title=人類究竟能不能完全避免火災？>人類究竟能不能完全避免火災？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/db7286bd.html alt=「隨筆」人類信息存儲的進化史 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e07a434e77164bb69afc8a33a77cffcf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/db7286bd.html title=「隨筆」人類信息存儲的進化史>「隨筆」人類信息存儲的進化史</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/504e628f.html alt=人類創造的所有數據，需要用多少存儲器才能全部裝得下？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8791f9a968d14c60b89256cebf81d696 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/504e628f.html title=人類創造的所有數據，需要用多少存儲器才能全部裝得下？>人類創造的所有數據，需要用多少存儲器才能全部裝得下？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c2b1d5a6.html alt=人類最大的採礦行動即將開始 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7d6ea3446da84402babeb023213986ed style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c2b1d5a6.html title=人類最大的採礦行動即將開始>人類最大的採礦行動即將開始</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/714ea0e1.html alt=深海採礦是人類發展的新曙光？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/cc1c75c3b6134bf8ae6ca5d2a1c61f3e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/714ea0e1.html title=深海採礦是人類發展的新曙光？>深海採礦是人類發展的新曙光？</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>