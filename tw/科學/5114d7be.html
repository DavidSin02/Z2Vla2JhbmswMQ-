<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>QML中各種代理的用法 | 极客快訊</title><meta property="og:title" content="QML中各種代理的用法 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p9.pstatp.com/large/dfic-imagehandler/18cf8a25-df84-437f-bc60-dea2c524da29"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/5114d7be.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/5114d7be.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/5114d7be.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/5114d7be.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/5114d7be.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/5114d7be.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/5114d7be.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/5114d7be.html><meta property="article:published_time" content="2020-11-14T20:54:01+08:00"><meta property="article:modified_time" content="2020-11-14T20:54:01+08:00"><meta name=Keywords content><meta name=description content="QML中各種代理的用法"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E5%AD%B8/5114d7be.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>QML中各種代理的用法</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E5%AD%B8.html>科學</a></span></div><div class=post-content><div class=pgc-img><img alt=QML中各種代理的用法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/dfic-imagehandler/18cf8a25-df84-437f-bc60-dea2c524da29><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>前言</h1><p>當使用模型與視圖來自定義用戶界面時，代理在創建顯示時扮演了大量的角色。在模型中的每個元素通過代理來實現可視化，用戶真實可見的是這些代理元素。</p><h1 class=pgc-h-arrow-right>代理</h1><p>每個代理訪問的索引號或者或綁定屬性一部分來自數據模型，一部分來自視圖。來自模型的數據將會通過屬性傳遞到代理。來自視圖的數據將會通過屬性傳遞視圖中與代理相關的狀態信息。</p><p>通常使用的視圖綁定屬性是ListView.isCurrentItem和ListView.view。第一個是一個布爾值，標識這個元素是否是視圖當前元素，這個值是隻讀的，引用自當前視圖。通過訪問視圖，可以創建可複用的代理，這些代理在被包含時會自動匹配視圖的大小。在下面這個例子中，每個代理的width與視圖的width屬性綁定，每個代理的背景顏色color依賴於綁定的屬性ListView.isCurrentItem屬性。</p><pre><code>import QtQuick 2.3import QtQuick.Window 2.2Window {    id: root    visible: true    width: 120    height: 300    color: "white"    ListView {        anchors.fill: parent        anchors.margins: 20        clip: true        model: 100        delegate: numberDelegate        spacing: 5        focus: true    }    Component {        id: numberDelegate        Rectangle {            width: ListView.view.width            height: 40            color: ListView.isCurrentItem ? "green" : "lightGreen"            Text {                anchors.centerIn: parent                font.pixelSize: 10                text: index            }        }    }}</code></pre><p>運行效果如下：</p><div class=pgc-img><img alt=QML中各種代理的用法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/534321434b5b488d98a48fc2a2b068bf><p class=pgc-img-caption></p></div><p>如果在模型中的每個元素與一個動作相關，例如點擊作用於一個元素時，這個功能是代理完成的。這是由事件管理分配給視圖的，這個操作控制了視圖中元素的導航，代理控制了特定元素上的動作。最基礎的方法是在每個代理中創建一個MouseArea並且響應onClicked信號，在後面的文章中會演示相關的例子。</p><h1 class=pgc-h-arrow-right>動畫添加與移除元素</h1><p>在某些情況下，視圖中的顯示內容會隨著時間而改變。由於模型數據的改變，元素會添加或移除。在這種情況下，一個比較好的方法是使用可視化隊列給用戶一個方向的感覺，來幫助用戶知道哪些數據被加入或者移除。</p><p>為了方便使用，QML視圖為每個代理綁定了兩個信號，onAdd和onRemove。使用動畫連接它們，可以方便創建識別哪些內容被添加或者刪除的動畫。</p><p>下面這個例子演示瞭如何動態填充一個ListModel。在屏幕下方，有一個添加新元素的按鈕。當點擊它時，會調用模型的append方法來添加一個新的元素。這個操作會觸發視圖創建一個新的代理，併發送GridView.onAdd信號。SequentialAnimation隊列動畫與這個信號連接綁定，使用代理的scale屬性來放大視圖元素。</p><p>當視圖中的一個代理點擊時，將會調用模型的remove方法將一個元素從模型中移除。這個操作將會導致GridView.onRemove信號的發送，觸發另一個SequentialAnimation。這時，代理的銷燬將會延遲直到動畫完成。為了完成這個操作，PropertyAction元素需要在動畫前設置GridView.delayRemove屬性為true，並在動畫後設置為false。這樣確保了動畫在代理項移除前完成。</p><pre><code>GridView.onRemove: SequentialAnimation {                PropertyAction { target: wrapper; property: "GridView.delayRemove"; value: true }                NumberAnimation { target: wrapper; property: "scale"; to: 0; duration: 250; easing.type: Easing.InOutQuad }                PropertyAction { target: wrapper; property: "GridView.delayRemove"; value: false }            }            GridView.onAdd: SequentialAnimation {                NumberAnimation { target: wrapper; property: "scale"; from: 0; to: 1; duration: 250; easing.type: Easing.InOutQuad }            }</code></pre><p>運行效果如下：</p><div class=pgc-img><img alt=QML中各種代理的用法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6cb2eb8730a740a08f950d309c4ca624><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>形變代理</h1><p>在使用鏈表時通常會使用當前項激活時展開的機制。這個操作可以被用於動態的將當前的項目填充到整個屏幕來添加一個新的用戶界面，或者為鏈表中的當前項提供更多的信息。</p><p>在下面的例子中，當點擊鏈表項時，鏈表項都會展開填充整個ListView。額外的間隔區域被用於添加更多的信息，這種機制使用了一個狀態來控制，當一個鏈表項展開時，代理項都能輸入expanded狀態，在這種狀態下一些屬性被改變。</p><p>首先wrapper的height被設置為ListView的高度。標籤圖片被方法並且下移，使圖片從小圖片的位置移動到大圖片的位置。除了這些之外，兩個隱藏項，實際視圖（factView）與關閉按鍵（closeButton）切換它的opacity（透明度）顯示出來。最後設置ListView。</p><p>設置ListView包含了設置內容Y座標，這是視圖頂部可見的部分代理的Y軸座標。另一個變化是設置視圖的交互（interactive）為false。這個操作阻止了視圖的移動，用戶不再能夠通過滾動條切換當前項。</p><p>由於設置第一個鏈表項為可點擊，向它輸入一個expanded狀態，導致了它的代理項被填充到整個鏈表並且內容重置。當點擊關閉按鈕時，清空狀態，導致它的代理項返回上一個狀態，並且重新設置ListView有效。</p><pre><code>import QtQuick 2.3import QtQuick.Window 2.2Window {    id: root    visible: true    width: 480    height: 300    color: "white"    Item {        width: 300        height: 480        Rectangle {            anchors.fill: parent            gradient: Gradient {                GradientStop { position: 0.0; color: "#4a4a4a" }                GradientStop { position: 1.0; color: "#2b2b2b" }            }        }        ListView {            id: listView            anchors.fill: parent            delegate: detailsDelegate            model: planets        }        ListModel {            id: planets            ListElement { name: "Mercury"; imageSource: "image/mercury.jpg"; facts: "Mercury is the smallest planet in the Solar System. It is the closest planet to the sun. It makes one trip around the Sun once every 87.969 days." }            ListElement { name: "Venus"; imageSource: "image/venus.jpg"; facts: "Venus is the second planet from the Sun. It is a terrestrial planet because it has a solid, rocky surface. The other terrestrial planets are Mercury, Earth and Mars. Astronomers have known Venus for thousands of years." }            ListElement { name: "Earth"; imageSource: "image/earth.jpg"; facts: "The Earth is the third planet from the Sun. It is one of the four terrestrial planets in our Solar System. This means most of its mass is solid. The other three are Mercury, Venus and Mars. The Earth is also called the Blue Planet, 'Planet Earth', and 'Terra'." }            ListElement { name: "Mars"; imageSource: "image/mars.jpg"; facts: "Mars is the fourth planet from the Sun in the Solar System. Mars is dry, rocky and cold. It is home to the largest volcano in the Solar System. Mars is named after the mythological Roman god of war because it is a red planet, which signifies the colour of blood." }        }        Component {            id: detailsDelegate            Item {                id: wrapper                width: listView.width                height: 30                Rectangle {                    anchors.left: parent.left                    anchors.right: parent.right                    anchors.top: parent.top                    height: 30                    color: "#333"                    border.color: Qt.lighter(color, 1.2)                    Text {                        anchors.left: parent.left                        anchors.verticalCenter: parent.verticalCenter                        anchors.leftMargin: 4                        font.pixelSize: parent.height-4                        color: '#fff'                        text: name                    }                }                Rectangle {                    id: image                    width: 26                    height: 26                    anchors.right: parent.right                    anchors.top: parent.top                    anchors.rightMargin: 2                    anchors.topMargin: 2                    color: "black"                    Image {                        anchors.fill: parent                        fillMode: Image.PreserveAspectFit                        source: imageSource                    }                }                MouseArea {                    anchors.fill: parent                    onClicked: parent.state = "expanded"                }                Item {                    id: factsView                    anchors.top: image.bottom                    anchors.left: parent.left                    anchors.right: parent.right                    anchors.bottom: parent.bottom                    opacity: 0                    Rectangle {                        anchors.fill: parent                        gradient: Gradient {                            GradientStop { position: 0.0; color: "#fed958" }                            GradientStop { position: 1.0; color: "#fecc2f" }                        }                        border.color: '#000000'                        border.width: 2                        Text {                            anchors.fill: parent                            anchors.margins: 5                            clip: true                            wrapMode: Text.WordWrap                            color: '#1f1f21'                            font.pixelSize: 12                            text: facts                        }                    }                }                Rectangle {                    id: closeButton                    anchors.right: parent.right                    anchors.top: parent.top                    anchors.rightMargin: 2                    anchors.topMargin: 2                    width: 26                    height: 26                    color: "#157efb"                    border.color: Qt.lighter(color, 1.1)                    opacity: 0                    MouseArea {                        anchors.fill: parent                        onClicked: wrapper.state = ""                    }                }                states: [                    State {                        name: "expanded"                        PropertyChanges { target: wrapper; height: listView.height }                        PropertyChanges { target: image; width: listView.width; height: listView.width; anchors.rightMargin: 0; anchors.topMargin: 30 }                        PropertyChanges { target: factsView; opacity: 1 }                        PropertyChanges { target: closeButton; opacity: 1 }                        PropertyChanges { target: wrapper.ListView.view; contentY: wrapper.y; interactive: false }                    }                ]                transitions: [                    Transition {                        NumberAnimation {                            duration: 200;                            properties: "height,width,anchors.rightMargin,anchors.topMargin,opacity,contentY"                        }                    }                ]            }        }    }}</code></pre><p>運行效果如下：</p><div class=pgc-img><img alt=QML中各種代理的用法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b5a09884f2484b5480a6c66fe0055ac0><p class=pgc-img-caption></p></div><p>這個例子展示了展開代理來填充視圖能夠簡單的通過代理的形變來完成。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>QML</a></li><li><a>各種</a></li><li><a>用法</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/0fc448f5.html alt=各種門窗知識大全，是我見過最全的了 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/15349013240149cf1ef5531 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0fc448f5.html title=各種門窗知識大全，是我見過最全的了>各種門窗知識大全，是我見過最全的了</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/93727dba.html alt="技術帖 | 3分鐘搞定各種測試分析技術" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/f055e0a4477240088de2abb7cd696cfa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/93727dba.html title="技術帖 | 3分鐘搞定各種測試分析技術">技術帖 | 3分鐘搞定各種測試分析技術</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/90a2f47a.html alt=識別各種各樣的電纜電線 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/3e680001e11c782e8928 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/90a2f47a.html title=識別各種各樣的電纜電線>識別各種各樣的電纜電線</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a6a1aa5c.html alt=腹肌輪的正確用法，幫你練腹肌 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/f6e41f0952784d6dbca16297383a3cc7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a6a1aa5c.html title=腹肌輪的正確用法，幫你練腹肌>腹肌輪的正確用法，幫你練腹肌</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4df1d2c4.html alt=飛行裡的各種“高度”小總結 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/895f051cf5e2438aa63b08f44bd1cbff style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4df1d2c4.html title=飛行裡的各種“高度”小總結>飛行裡的各種“高度”小總結</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/12c5d155.html alt=防控新冠病毒的的各種“新”方法，靠譜不 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/987bbc71-1082-4586-875c-b97870275bbb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/12c5d155.html title=防控新冠病毒的的各種“新”方法，靠譜不>防控新冠病毒的的各種“新”方法，靠譜不</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0903fbf9.html alt=常見的調整浪：三角形的各種變形圖解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/57c439a06ccf4f9f93d01541668817b6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0903fbf9.html title=常見的調整浪：三角形的各種變形圖解>常見的調整浪：三角形的各種變形圖解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8b0e37c6.html alt=解三角形公式及變形與用法歸納 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a22382c7358040269d6d1719f77690f9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8b0e37c6.html title=解三角形公式及變形與用法歸納>解三角形公式及變形與用法歸納</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9210b27d.html alt=18元四合一手擀麵有7兩面，各種臊子搭配鋪滿，碗大得像個小盆子 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/70ddd39f91a344bbb30981e2d3bb8671 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9210b27d.html title=18元四合一手擀麵有7兩面，各種臊子搭配鋪滿，碗大得像個小盆子>18元四合一手擀麵有7兩面，各種臊子搭配鋪滿，碗大得像個小盆子</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8c2db1e0.html alt=各種美味麵條的18種做法，麵食控們福利來了，好面不怕香過頭 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/061f13052d2c4499aa7fe4c1f95c426c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8c2db1e0.html title=各種美味麵條的18種做法，麵食控們福利來了，好面不怕香過頭>各種美味麵條的18種做法，麵食控們福利來了，好面不怕香過頭</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9f674acb.html alt=你必須掌握各種特殊體型的量體技巧 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7fded122d37c4048a34968909add59bb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9f674acb.html title=你必須掌握各種特殊體型的量體技巧>你必須掌握各種特殊體型的量體技巧</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2cbf8e6e.html alt=各種電路圖，太實用了！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/b0e0005860fc89c577e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2cbf8e6e.html title=各種電路圖，太實用了！>各種電路圖，太實用了！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5f6825c6.html alt="各種家電常見功率、電流、耗電量彙總， 希望對裝修中的你有幫助" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1520318671327a3e71c1a8d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5f6825c6.html title="各種家電常見功率、電流、耗電量彙總， 希望對裝修中的你有幫助">各種家電常見功率、電流、耗電量彙總， 希望對裝修中的你有幫助</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d802e0d7.html alt=挖土黨挖出來各種武器彈藥，從衝鋒槍到迫擊炮應有盡有 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/9a92710aa78c4b77a49a14328467fc0a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d802e0d7.html title=挖土黨挖出來各種武器彈藥，從衝鋒槍到迫擊炮應有盡有>挖土黨挖出來各種武器彈藥，從衝鋒槍到迫擊炮應有盡有</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c9eb3d63.html alt=PHP實現各種經典算法詳解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/15357595091626cf296dc3e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c9eb3d63.html title=PHP實現各種經典算法詳解>PHP實現各種經典算法詳解</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>