<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>圖之強連通、強連通圖、強連通分量 Tarjan算法 | 极客快訊</title><meta property="og:title" content="圖之強連通、強連通圖、強連通分量 Tarjan算法 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/77b9020301e3492786373509cf5fab10"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/55e8874e.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/55e8874e.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/55e8874e.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/55e8874e.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/55e8874e.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/55e8874e.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/55e8874e.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/55e8874e.html><meta property="article:published_time" content="2020-11-14T20:53:56+08:00"><meta property="article:modified_time" content="2020-11-14T20:53:56+08:00"><meta name=Keywords content><meta name=description content="圖之強連通、強連通圖、強連通分量 Tarjan算法"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E5%AD%B8/55e8874e.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>圖之強連通、強連通圖、強連通分量 Tarjan算法</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E5%AD%B8.html>科學</a></span></div><div class=post-content><div><h1>一、解釋</h1><p>在有向圖G中，如果兩個頂點間至少存在一條互相可達路徑，稱兩個頂點強連通(strongly connected)。如果有向圖G的每兩個頂點都強連通，稱G是一個強連通圖。非強連通圖有向圖的極大強連通子圖，稱為強連通分量(strongly connected components)。</p><p>求解有向圖的強連通分量算法有很多，例如Kosaraju，Gabow和Tarjan算法，其中Gabow和Tarjan算法時間複雜度要優於Kosaraju。</p><p>理解：</p><p>如果單純將其看出圖的話有點難以理解，但是當我們將其看成樹，就很容易了。</p><div class=pgc-img><img alt="圖之強連通、強連通圖、強連通分量 Tarjan算法" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/77b9020301e3492786373509cf5fab10><p class=pgc-img-caption></p></div><p>如上圖，如果兩個點成強聯通，那麼顯然在樹中就會存在一個環，圖中L-M-J-L和A-L-M-B-A成環所以組成的強聯通分量。</p><h1>二、Tarjan算法</h1><p>Tarjan算法基於深度優先搜索樹，其有兩個重要變量DFN[u]：表示在深度搜索中遍歷到該節點的次序。LOW(u)表示以u節點為樹根，u及u以下樹節點所能找到的最小次序號。注意Tarjan認為單個節點自身就是一個強聯通分量，在處理數據時注意屏蔽。以上圖為例，我們從A開始，</p><p>A：DFN[1] = 1； LOW(1)=1</p><p>L：DFN[2] = 2； LOW(2)=2</p><p>M：DFN[3] = 3； LOW(3)=3</p><p>J：DFN[4] = 4； LOW(4)=4</p><p>這時我們在J節點繼續往下搜索時，發現L節點我們已經搜索過了，且L：LOW(2)=2，我們發現J：LOW(4)=4>L：LOW(2)=2,因此我們將其賦值LOW(4)=2，這說明此時我們發現了一個環，代表一個強聯通分量。</p><p>下面繼續：</p><p>J：DFN[4] = 4； LOW(4)=2</p><p>M：DFN[3] = 3； LOW(3)=2</p><p>B：DFN[5] = 4； LOW(5)=5</p><p>發現B到A：</p><p>B：DFN[5] = 4； LOW(5)=1</p><p>開始返回更新：</p><p>M：DFN[3] = 3； LOW(3)=1</p><p>L：DFN[2] = 2； LOW(2)=1</p><p>A：DFN[1] = 1； LOW(1)=1</p><p>發現DFN=LOW(1)，彈出棧。</p><p>算法：</p><pre>void tarjan(int u){ DFN[u]=LOW[u]=++time; //次序從1開始，初始時由於默認將DFN[u]=LOW[u]都置為次序號 // 將當前節點壓棧，置位在棧中，已訪問。 visit[u]=1; s.push(u); instack[u]=1; //取u節點的下一路徑節點v,當沒有v可取時也說明深度搜索已經到達當前最底部，這是我們函數返回尋找另一條路徑。 for(int j=0;j&lt;G[u].size();j++){ int v=G[u][j]; if(visit[v]==0){ tarjan(v); // 在深度搜索返回時，如果v節點下存在子樹，要將u節點的LOW[u]更新。 LOW[u]=min(LOW[u],LOW[v]); } else if(instack[v]){ // v節點已經被訪問，並且在棧中，說明在當前路徑上存在環，此處只是賦值，但並不代表在u子樹的底下的多個節點沒有比當前環更大的環。無法作為深度終止條件。 LOW[u]=min(LOW[u],DFN[v]); } } int m; int num=0; //對一個環計數計數 // 在深度搜索完結後返回時，判斷DFN[u]==LOW[u]，相等說明找到了一個環，將棧中節點彈出。注意tarjan算法認為單個節點也為環。 if(DFN[u]==LOW[u]){ // 將棧中節點彈出，並計數 do{ m=s.top(); s.pop(); instack[m]=0; num++; }while(m!=u); // 只有環內節點數大於兩個才是真正環。 if(num&gt;1){ // n個點兩兩相交（互相到達），則有n*(n-1)/2條連接線 total+=num*(num-1)/2; } }}</pre><p>關於為啥只用訪問一次：</p><p>開始疑惑，肯定會多條路徑通過某一點，如果用visit記錄訪問記錄的話，下一條路徑不就會不能訪問該點了嗎？遂繪製醜圖：</p><div class=pgc-img><img alt="圖之強連通、強連通圖、強連通分量 Tarjan算法" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b2603bafabe844ce9da5a1d901766ad6><p class=pgc-img-caption></p></div><p>如圖當我們訪問到6節點時發現有環，且到達底點，這時根據算法開始返回，同時將2-6-5這條環也遍歷掉（此時5號已訪問壓棧且有LOW=1）。也就是說在返回到1號節點開始出棧時，我們已經把1號節點的子樹全部訪問了一遍，該成環的也做了標記。在1號節點下的子節點不會通向1號節點以上的節點，比如0號節點，不然1號只能算一個類似於2-6-5這條環。至於從0號到5號就不用再判斷了。所以遍歷一遍就行。我覺得巧妙之處在於在深度向前搜索過程並沒有處理數據，而在深度返回過程中開始更新數據，記錄找到的迴路，並且到達子樹根節點DFN[u]==LOW[u]才開始出棧。</p><p>---------------------</p><pre>作者：青盞 原文：https://blog.csdn.net/qq_16234613/article/details/77431043 </pre></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>圖之強</a></li><li><a>連通</a></li><li><a>強連</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/e802fefa.html alt=“連通”入場短期難撼銀聯主導格局 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e802fefa.html title=“連通”入場短期難撼銀聯主導格局>“連通”入場短期難撼銀聯主導格局</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4243a9ad.html alt="“連通”將落地杭州 銀行卡清算邁出重要一步" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4243a9ad.html title="“連通”將落地杭州 銀行卡清算邁出重要一步">“連通”將落地杭州 銀行卡清算邁出重要一步</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d37bb4e2.html alt=央行向連通公司核發銀行卡清算業務許可證 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d37bb4e2.html title=央行向連通公司核發銀行卡清算業務許可證>央行向連通公司核發銀行卡清算業務許可證</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/01e8e7b6.html alt=強監管｜水利部就水系連通專項稽察發現問題約談湖南寧夏水利廳負責人 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/682c167201534521bd459a81afa62319 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/01e8e7b6.html title=強監管｜水利部就水系連通專項稽察發現問題約談湖南寧夏水利廳負責人>強監管｜水利部就水系連通專項稽察發現問題約談湖南寧夏水利廳負責人</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/20d528f3.html alt=美國運通公佈連通首批合作機構，微信支付將率先支持綁定其人民幣信用卡 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/20d528f3.html title=美國運通公佈連通首批合作機構，微信支付將率先支持綁定其人民幣信用卡>美國運通公佈連通首批合作機構，微信支付將率先支持綁定其人民幣信用卡</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/528ce045.html alt=走進越秀公園，初探“連通工程”之美 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/RczRLN3GUM1T66 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/528ce045.html title=走進越秀公園，初探“連通工程”之美>走進越秀公園，初探“連通工程”之美</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/1947b61b.html alt=這根血管連通大腦，千萬不能堵 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/56d57ac779ee4ea3a4ba7b8931050568 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/1947b61b.html title=這根血管連通大腦，千萬不能堵>這根血管連通大腦，千萬不能堵</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/c8badb53.html alt=「算法基礎」圖的基礎—連通和尋路 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/9f7db909-e157-45e2-9a21-493829e36c8b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/c8badb53.html title=「算法基礎」圖的基礎—連通和尋路>「算法基礎」圖的基礎—連通和尋路</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e4153888.html alt=新型中空光纖：“連通”下一代科學儀器的開發之路 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5eb76fb3c2574d4199d8902dbef3642a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e4153888.html title=新型中空光纖：“連通”下一代科學儀器的開發之路>新型中空光纖：“連通”下一代科學儀器的開發之路</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/eacaeee3.html alt=金寨：小小竹節連通脫貧致富路 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/bf4df5b4a95d4a36b6580eb1e03b78b1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/eacaeee3.html title=金寨：小小竹節連通脫貧致富路>金寨：小小竹節連通脫貧致富路</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/a2e221f.html alt=韓朝連通江原道非軍事區內的軍用道路 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/a2e221f.html title=韓朝連通江原道非軍事區內的軍用道路>韓朝連通江原道非軍事區內的軍用道路</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>