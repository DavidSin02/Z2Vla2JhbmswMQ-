<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>快速開發基於 HTML5 網絡拓撲圖應用——入門篇（一） | 极客快訊</title><meta property="og:title" content="快速開發基於 HTML5 網絡拓撲圖應用——入門篇（一） - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/199ab4c89df745d2b1f93d79e2ece5e7"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/568a9c34.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/568a9c34.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/568a9c34.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/568a9c34.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/568a9c34.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/568a9c34.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/568a9c34.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/568a9c34.html><meta property="article:published_time" content="2020-11-14T20:53:13+08:00"><meta property="article:modified_time" content="2020-11-14T20:53:13+08:00"><meta name=Keywords content><meta name=description content="快速開發基於 HTML5 網絡拓撲圖應用——入門篇（一）"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E5%AD%B8/568a9c34.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>快速開發基於 HTML5 網絡拓撲圖應用——入門篇（一）</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E5%AD%B8.html>科學</a></span></div><div class=post-content><div><p>計算機網絡的拓撲結構是引用拓撲學中研究與大小，形狀無關的點、線關係的方法。把網絡中的計算機和通信設備抽象為一個點，把傳輸介質抽象為一條線，由點和線組成的幾何圖形就是計算機網絡的拓撲結構。網絡的拓撲結構反映出網中各實體的結構關係，是建設計算機網絡的第一步，是實現各種網絡協議的基礎，它對網絡的性能，系統的可靠性與通信費用都有重大影響。拓撲在計算機網絡中即是指連接各結點的形式與方法；在網絡中的工作站和服務器等網絡單元抽象為“點”；網絡中的電纜等抽象為“線”。影響網絡性能、系統可靠性、通信費用。</p><p>拓撲還分為：總線拓撲、星型拓撲、環形拓撲樹形拓撲以及網狀拓撲。這篇文章寫的案例就是總線拓撲中的一個分支，我們一步一步來搭建這個拓撲圖形。</p><p>示例圖片：</p><div class=pgc-img><img alt="快速開發基於 HTML5 網絡拓撲圖應用——入門篇（一）" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/199ab4c89df745d2b1f93d79e2ece5e7><p class=pgc-img-caption></p></div><p>拓撲圖形組件 ht.graph.GraphView (以下簡稱 GarphView)是 HT 框架中 2D功能最豐富的組件，其相關類庫都在 ht.graph包下。 GarphView 具有基本圖形的呈現和編輯功能，拓撲節點連線及自動佈局功能，電力和電信等行業預定義對象，具有動畫渲染等特效， 因此其應用面很廣泛，可作為監控領域的繪圖工具和人機界面，可作為一般性的圖形化編輯工具，可擴展成工作流和組織圖等企業應用。</p><p>HT 框架的組件指的是可視化可交互的視圖控件，HT 框架基於 HTML5 技術，因此HT組件的可視化部分本質就是 HTML 的元素， 大部分 HT 組件與 DataModel 數據模型綁定，用戶通過操作純 js 的語言即可驅動可視化組件，這樣屏蔽了 HTML 底層圖形技術複雜性。 HT 對 HTML5 技術封裝的目的在於提高開發效率和可維護性，但並不意味著不允許用戶直接操作 HTML 原生元素， 有 HTML5 開發經驗的程序員，在瞭解 HT 系統機制的前提下，大可運用各種 HTML5 的技術對 HT 組件做自定義擴展。</p><div class=pgc-img><img alt="快速開發基於 HTML5 網絡拓撲圖應用——入門篇（一）" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9af27f8ed7634405a6978183b9e89932><p class=pgc-img-caption></p></div><p>我們就是用 ht.graph.GraphView 組件作為場景的，具體代碼只有兩行：</p><pre>graphView = new ht.graph.GraphView();graphView.addToDOM();</pre><p>首先聲明變量，然後將這個組件實例變量添加進 body 體中。所有 HT 組件最根層都為一個 div 組件，可通過組件的 getView() 函數獲得， 默認和自定義交互事件監聽一般添加在該 div 上(getView().addEventListener(type, func, false))， 渲染層一般由 canvas 提供。 用戶可直接對根 div 和 canvas 層設置css背景等樣式， 也可以添加新的 HTML 組件到根 div 層上，作為 canvas 的兄弟組件一起呈現。 HT 組件一般都以設置 position 為 absolute 的絕對定位方式。HT 的組件一般都會嵌入BorderPane、SplitView 和 TabView等容器中使用，而最外層的 HT 組件則需要用戶手工將 getView()返回的底層 div 元素添加到頁面的 DOM元素中，這裡需要注意的是，當父容器大小變化時，如果父容器是 BorderPane和 SplitView 等這些 HT 預定義的容器組件，則 HT 的容器會自動遞歸調用孩子組件 invalidate函數通知更新。但如果父容器是原生的 html元素， 則 HT 組件無法獲知需要更新，因此最外層的 HT 組件一般需要監聽 window的窗口大小變化事件，調用最外層組件 invalidate函數進行更新。</p><p>為了最外層組件加載填充滿窗口的方便性，HT 的所有組件都有 addToDOM 函數，其實現邏輯如下，其中 iv 是 invalidate的簡寫：</p><pre>addToDOM = function(){  var self = this, view = self.getView(), //獲取底層 div  style = view.style; document.body.appendChild(view); //將組件底層 div 添加進 body 體中  style.left = '0';//ht 的組件默認將 position 設置為 absolute 絕對定位 style.right = '0'; style.top = '0'; style.bottom = '0';  window.addEventListener('resize', function () { self.iv(); }, false); }</pre><p>接下來我們要引入“數據容器”的概念，顧名思義，就是裝載數據的容器，數據容器 ht.DataModel(以下簡稱 DataModel)作為承載 Data 數據的模型，管理著 Data 數據的增刪以及變化事件派發， HT 框架所有組件都是通過綁定 DataModel，以不同的形式呈現到用戶界面，可以通過 view.getDataModel() （簡寫為 view.dm()）方式獲取數據容器；同時組件也會監聽 DataModel 模型的變化事件（view.getSelectionModel()，簡寫為 view.sm()）， 實時同步更新界面數據信息，掌握了 DataModel 的操作就掌握了所有組件的模型驅動方式。</p><p>我們要創建兩個節點 ht.Node（繼承於 ht.Data 類），一個服務器，一個客戶端，中間連線兩條以及一條自環的連線，這些都是 Data 數據，都需要添加進 DataModel 數據容器中。但是我們得先創建這個數據節點，用 HT 只需要兩句話就能將節點添加進數據容器中了，方法跟上面創建拓撲組件的方法很像，拓撲組件是添加進 body 體中，而節點是添加進數據容器中：</p><pre>var server = new ht.Node();//創建“服務器”數據節點graphView.dm().add(server);//將節點添加進數據容器 graphView.dm() 中</pre><p>客戶端也是一樣的創建方式，節點名為 client。為了美觀，我給服務器和客戶端的節點都設置了圖片，設置圖片有兩種方式：</p><ul><li>直接將圖片相對或絕對路徑，設置到數據模型的相應屬性上，server.setImage('images/server.png')</li><li>先通過 ht.Default.setImage('server', 'images/server.png') 進行註冊，再將註冊名稱設置到模型上 server.setImage('server')</li></ul><p>直接設置路徑方式開發方便，無需提前註冊圖片，但數據模型序列化時圖片路徑佔用內存較多，將來圖片路徑變化後不利於管理維護，兩種方式都是正確的使用方式，可根據項目情況選中不同方式或混合使用。 如果採用 url 的路徑方式 HT 內部會自動加載圖片，並在 onload 之後自動更新相應的視圖組件。</p><p>HT 的框架下圖片被賦予了更廣泛的含義，HT提供了自定義 JSON 格式的矢量描述形式，以 HT 標準定義的 JSON 矢量格式， 也可以作為圖片進行註冊和使用，HT 的矢量方式比傳統圖片格式更節省空間，縮放不失真，最強大之處在於矢量的所有圖形參數， 皆可與 Data 模型上的數據動態綁定，具體說明參見矢量手冊，現在我這邊的講解還沒到這個步驟，感興趣的可以自行了解。</p><p>接著是創建兩個節點之間的連線，ht.Edge 類型用於連接起始和目標兩個 Node 節點，兩個節點間可以有多條 Edge 存在，也允許起始和目標為同一節點。為同一節點的情況就是形成自環的情況啦~這裡有三條連線，由於有兩條類似，我就只將直線連線和自環的連線代碼貼出來進行解釋：</p><pre>var edge = new ht.Edge(server, client);//創建連線節點，參數為起始節點和目標節點graphView.dm().add(edge);//將連線節點添加進數據容器中var cirEdge = new ht.Edge(server, server);//這個連線的起始節點和目標節點都為同一個節點，形成自環graphView.dm().add(cirEdge);</pre><p>連線節點也繼承於 Data 類，所以添加進數據容器的方式也是一樣的。至於連線上面的字，則是通過 setStyle 方法來實現的。</p><p>HT 的數據 Data 可分為三種屬性類型：</p><ul><li>get/set 或 is/set類型，例如 getName(0/setName('ht') 和 isExpanded()，用於常用屬性操作</li><li>attr 類型，通過 getAttr(name)和 setAttr(key, value) 存取，該類型是 HT 預留給用戶存儲業務數據</li><li>style 類型，通過 getStyle(name)和 setStyle(key, value) 進行操作，GraphView 上圖元樣式由該類型屬性控制</li></ul><p>這裡我是通過 style 類型來添加的文字說明，通過 ‘label’ 屬性設置顯示的文字：</p><pre>edge.s({//setStyle 的簡寫 'label': '請求',//設置文字 'label.position': 3//設置文字位置});</pre><p>最終顯示文字由 GraphView.getLabel 函數決定：</p><pre>getLabel: function (data) { var label = data.getStyle('label');//獲取 style 樣式中的 label 屬性的 value return label === undefined ? data.getName() : label; }</pre><p>上面還有一個文字位置，是 HT 封裝的位置，具體顯示位置如下：</p><div class=pgc-img><img alt="快速開發基於 HTML5 網絡拓撲圖應用——入門篇（一）" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/eb3be210978341a5a8ab6481a35e18e4><p class=pgc-img-caption></p></div><p>其中 17 為中心位置，大家可根據這個位置自行調整看看效果，位置的具體說明請參考 HT for Web 位置手冊。</p><p>至此，全部代碼解析完畢，下一節我會給大家介紹如何添加連線中的流動哦，記得圍觀哦~</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>開發基</a></li><li><a>HTML5</a></li><li><a>網絡拓</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/d2cc8f8b.html alt=認識計算機網絡拓撲圖 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1539944135471e88b874ecd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d2cc8f8b.html title=認識計算機網絡拓撲圖>認識計算機網絡拓撲圖</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/6beeefdd.html alt=智能配電網之配電網絡拓撲分析 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3a3e66ea5d674b8a95cb958a3bf9eee8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/6beeefdd.html title=智能配電網之配電網絡拓撲分析>智能配電網之配電網絡拓撲分析</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/3e19a3a3.html alt=網絡拓撲結構 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/e179d7fc433a41f4b88364ff27af28e7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/3e19a3a3.html title=網絡拓撲結構>網絡拓撲結構</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/17ac69bb.html alt=手把手教你畫出好看的網絡拓撲圖 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8df67bed16c44181a4e82b0f004383b4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/17ac69bb.html title=手把手教你畫出好看的網絡拓撲圖>手把手教你畫出好看的網絡拓撲圖</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/7a58565b.html alt=詳解：構建大型公司網絡拓撲圖 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/2c18d21c71a1475d8566432ac2514ebd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/7a58565b.html title=詳解：構建大型公司網絡拓撲圖>詳解：構建大型公司網絡拓撲圖</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/2c3cc426.html alt=新手必看｜網絡拓撲圖要這樣設計 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ae2c8758ed2a45299f9554c15b76aa88 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/2c3cc426.html title=新手必看｜網絡拓撲圖要這樣設計>新手必看｜網絡拓撲圖要這樣設計</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/c59d6f88.html alt=網絡拓撲圖怎麼畫？零基礎拓撲圖繪製教程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/879f6cd62cdb4b2597e76edb30941343 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/c59d6f88.html title=網絡拓撲圖怎麼畫？零基礎拓撲圖繪製教程>網絡拓撲圖怎麼畫？零基礎拓撲圖繪製教程</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/4af8f9d1.html alt=網絡拓撲就是這幾種，然後各種混搭，記住基礎的，萬變不離其中 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/6cc34d00e4cc4d8fb50171c248f0e946 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/4af8f9d1.html title=網絡拓撲就是這幾種，然後各種混搭，記住基礎的，萬變不離其中>網絡拓撲就是這幾種，然後各種混搭，記住基礎的，萬變不離其中</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/9d75280f.html alt=乾貨：無線網絡拓撲 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ac470fc6dd5c446b9f0b6562994dc833 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/9d75280f.html title=乾貨：無線網絡拓撲>乾貨：無線網絡拓撲</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/9dd93827.html alt=畫出精美網絡拓撲，讀懂這一篇就行 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/addf166b58734d6c83163ef8eae11438 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/9dd93827.html title=畫出精美網絡拓撲，讀懂這一篇就行>畫出精美網絡拓撲，讀懂這一篇就行</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/60bab311.html alt=網絡拓撲圖：網絡拓撲圖介紹及在線製作 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d102c5e952a544aaa9ef43388fe22e84 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/60bab311.html title=網絡拓撲圖：網絡拓撲圖介紹及在線製作>網絡拓撲圖：網絡拓撲圖介紹及在線製作</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/a7446a09.html alt=網絡拓撲結構大全和實例 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1539060615219ec6d013ca8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/a7446a09.html title=網絡拓撲結構大全和實例>網絡拓撲結構大全和實例</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/92ca189.html alt=HTML5實時語音通話聊天，MP3壓縮傳輸3KB每秒 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/25a0ddd4db484af5b2d832decfc18d4e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/92ca189.html title=HTML5實時語音通話聊天，MP3壓縮傳輸3KB每秒>HTML5實時語音通話聊天，MP3壓縮傳輸3KB每秒</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/159c812.html alt="基於 HTML5 Canvas 的簡易 2D 3D 編輯器" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8a0a10ae0db9431c8e2cdf7d935e3dcd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/159c812.html title="基於 HTML5 Canvas 的簡易 2D 3D 編輯器">基於 HTML5 Canvas 的簡易 2D 3D 編輯器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5f860b5.html alt="基於 HTML5 的工業互聯網雲平臺監控機房U位" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/286953756c0f4ff6b48ef8aba65d9038 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5f860b5.html title="基於 HTML5 的工業互聯網雲平臺監控機房U位">基於 HTML5 的工業互聯網雲平臺監控機房U位</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>