<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>掌握算法-圖論-深度優先搜索的應用-無向圖和雙連通性 | 极客快訊</title><meta property="og:title" content="掌握算法-圖論-深度優先搜索的應用-無向圖和雙連通性 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/d282a5920a22456b96fa252333159b6f"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/8f7064d3.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/8f7064d3.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/8f7064d3.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/8f7064d3.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/8f7064d3.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/8f7064d3.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/8f7064d3.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/8f7064d3.html><meta property="article:published_time" content="2020-11-14T20:53:57+08:00"><meta property="article:modified_time" content="2020-11-14T20:53:57+08:00"><meta name=Keywords content><meta name=description content="掌握算法-圖論-深度優先搜索的應用-無向圖和雙連通性"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E5%AD%B8/8f7064d3.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>掌握算法-圖論-深度優先搜索的應用-無向圖和雙連通性</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E5%AD%B8.html>科學</a></span></div><div class=post-content><p>深度優先搜索（depth-first search）是對先序遍歷（preorder traversal）的推廣。我們從某個頂點v開始處理v，然後遞歸的便利所有與v鄰接的頂點。如果這種過程是對一棵樹進行，那麼該樹所有的頂點都將被系統地訪問到。如果我們對任意的圖行駛該過程，為了避免圈，我們需要小心仔細。為此，當我們訪問一個頂點v的時候，由於我們已經到了該點處，因此可以標記該點是訪問過的，並且對於尚未標記的所有鄰接頂點遞歸調用深度優先搜索。</p><p>這裡我們假設，對於無向圖，每條邊（v，w)在鄰接表裡出現兩次，一次是（v，w)，另一次是（w，v）。下圖是一個深度優先搜索的通用風格模板。</p><pre><code>void Dfs(Vertex V){    Visited[V] = True;    for each W adjancent to V        if(!Visited[W])            Dfs(W)}</code></pre><h1 class=pgc-h-arrow-right>無向圖</h1><p>無向圖是連通的，當且僅當從任一節點開始的深度優先搜索訪問到每一個節點。如果我們處理的圖不是連通的，那麼我們可以找出所有的連通分支並將我們的算法依次應用於每個分支。</p><div class=pgc-img><img alt=掌握算法-圖論-深度優先搜索的應用-無向圖和雙連通性 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d282a5920a22456b96fa252333159b6f><p class=pgc-img-caption>一個無向圖</p></div><p>設我們從上圖A開始作為深度優先搜索的一個例子。</p><p>此時標記A為訪問過的並遞歸調用Dfs(B)。</p><p>Dfs(B)標記B為訪問過的並遞歸調用Dfs(C)。</p><p>Dfs(C)標記C為訪問過的並遞歸調用Dfs(D)。</p><p>Dfs(D)遇到A和B，但是這兩個節點都已經訪問過了，因此沒有遞歸調用可以進行。</p><p>Dfs(D）也看到C是臨接的頂點，但C也訪問過了，因此在這裡也沒有遞歸調用進行，</p><p>於是Dfs(D)返回到Dfs(C)。</p><p>Dfs(C)看到B是鄰接點，忽略它，並發現以前沒看見過的頂點E也是鄰接點，因此調用Dfs(E)。</p><p>Dfs(E)將E作為標記，忽略A和C，並返回到Dfs(C)。</p><p>Dfs(C)返回到Dfs(B)。Dfs(B)忽略A和D並返回。Dfs(A)忽略D和E返回。</p><hr><p>現在我們以圖形來描述<strong>深度優先生成樹（depth-first spanning tree）</strong>的步驟。該樹的根是A，是第一個被訪問到的頂點。圖中的每一條邊（v，w都出現在樹上。我們當我們處理（v，w)時，發現w是未被標記的，或當我們處理（w，v)時發現v是未標記的，那麼我們就用樹的一條邊表示它。如果當我們處理（v，w)時發現w已被標記，並且當我們處理（w，v）時發現v也已有標記，那麼我們就畫一條虛線，並稱之為<strong>背向邊（back edge)</strong>，表示這條邊實際上不是樹的一部分。</p><div class=pgc-img><img alt=掌握算法-圖論-深度優先搜索的應用-無向圖和雙連通性 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4359d58fb28f41df86f925df730a5e10><p class=pgc-img-caption></p></div><p>樹將模擬我們執行的遍歷。只使用樹的邊對該樹的先序編號告訴我們這些頂點被標記的順序。</p><p>如果圖不是連通的，那麼處理所有節點（和邊）則需要多次調用Dfs，每次都生成一棵樹，整個集合就是<strong>深度優先生成森林（depth-first spanning forest）。</strong></p><h1 class=pgc-h-arrow-right>雙連通性</h1><p>如果一個連通的無向圖中的任一頂點刪除之後，剩下的圖仍然連通，那麼這樣的無向連通圖就稱為<strong>雙連通的（biconnected）。</strong>之前的圖就是雙連通的。如果例中的節點是計算機，邊是鏈路，那麼若有任何一臺計算機故障不能運行，則網絡郵件並不受影響，當然，與這臺計算機有關的郵件除外。類似地，如果一個公共運輸系統是雙連通的，那麼，若某個站點被破壞，則用戶總可以選擇另外的旅行路徑。</p><p>如果一個圖不是雙連通的，那麼將其刪除後圖將不再連通的那些頂點叫做<strong>割點（articulation point）。</strong>這些節點在許多應用中是很重要的。下圖就不是雙連通的：頂點C和D是割點。</p><div class=pgc-img><img alt=掌握算法-圖論-深度優先搜索的應用-無向圖和雙連通性 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d42b426c289d42cb91a4df27c0ae5d07><p class=pgc-img-caption></p></div><p>深度優先搜索提供一種找出連通圖中的所有割點的線性時間算法。</p><p>首先，在圖中任一頂點開始，執行深度優先搜索並在頂點被訪問時給它們編號。對於每一個頂點v我們稱其為先序編號Num(v)。然後，對於<strong>深度優先搜索生成樹</strong>上的每一個頂點v，計算編號最低的頂點，我們稱之為Low(v）--- 從點v開始，通過樹的零條或多條邊且可能還有一條背向邊而（以該序）達到。</p><div class=pgc-img><img alt=掌握算法-圖論-深度優先搜索的應用-無向圖和雙連通性 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2091996ed8e44dcb9c62079215d38f40><p class=pgc-img-caption>上圖的深度優先樹，節點標有Num和Low</p></div><p>從A，B，C開始的可達到的最低邊號定點為1（A），因為他們能夠通過樹的邊D，然後在由一條背向邊回到A。我們可以通過對該深度優先生成樹執行一次後續遍歷有效的算出Low。根據low的定義可知Low(v)是：</p><ul><li>Num(v)</li><li>所有背向邊（v，w)中的最低Num(w)</li><li>樹的所有邊（v，w)中的最低Low(w)</li></ul><p>中的最小者。</p><p>剩下要做的就是利用這些信息找出所有的割點。根是割點當且僅當它有多於一個的兒子，因為如果他有兩個兒子，那麼刪除根則使得節點不連通而分佈在不同的子樹上；如果根只有一個兒子，那麼除去該根只不過是斷離該根。對於任何頂點v，它是割點當且僅當它有某個兒子w使得Low(w)>= Num(v)。需要注意的是這個條件在根處總是滿足的了因此需要特別的測試。</p><p>當我們考察算法確定的割點。D有一個兒子E，且Low(E)>=Num(D)，二者都是4。因此，對E來說只有一種方法到達D上面的任何一點，那就是要通過D。類似的C也是一個割點，因為Low(G)>=Num(C)。</p><div class=pgc-img><img alt=掌握算法-圖論-深度優先搜索的應用-無向圖和雙連通性 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d00e494796e34211ac09aa22720e1869><p class=pgc-img-caption>在C開始深度優先搜索所得到的深度優先樹</p></div><p>偽代碼如下：</p><p>為使程序簡單，這裡這數組Visited[], Num[], Low[]和Parent[]為全局變量。我們還有一個全局變量叫做Counter，為給先序遍歷變好Num[]賦值。</p><hr><p>對頂點的Num賦值</p><pre><code>void AssignNum(Vertex V){    Vertex W;    Num[V] = Counter++;    Visited[V] = True;    for each W adjancent to V        if(!Visited[W]){            Parent[W] = V;            AssignNum(W);        }}</code></pre><p><br></p><hr><p><br></p><p>計算Low並檢驗是否是割點的偽代碼</p><pre><code>void AssignNum(Vertex V){    Vertex W;    Num[V] = Counter++;    Visited[V] = True;    for each W adjancent to V        if(!Visited[W]){            Parent[W] = V;            AssignNum(W);        }}void AssignLow(Vertex V){    Vertex W;    Low[V] = Num[V];    for each W adjancent to V    {        if(Num[W] &gt; Num[V]){            AssignLow(W);            if(Low[W] &gt;= Num[V]){                printf("%v is an articulation point\n");            }            Low[V] = Min(Low[V], LOW[W]]);        }    }    else{        if(Parent[V] != W){            Low[V] = Min(Low[v], Num[W]);        }    }}</code></pre><p><br></p><hr><p>對上面兩個的結合</p><pre><code>void FindArt(Vertex V){    Vertex W;    Visited[V] = True;    Low[V] = Num[V] = Counter++;    for(each W adjancent to V)    {        if(!Visited[W]){            Parent[W] = V;            FindArt(W);            if(Low[W] &gt;= Num[V])                printf("%v is an articulation point\n");            Low[V] = Min(Low[V], LOW[W]);            }        else{            if(Parent[V] != W){                LOW[V] = Min(LOW[V], Num[W]);            }        }    }}</code></pre></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>通性</a></li><li><a>圖論</a></li><li><a>優先</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/d9582413.html alt=「建設工程」建設工程價款優先受償權的行使期限 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/0c5dd9e8-18e6-4bd7-8443-122b7f20b61e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d9582413.html title=「建設工程」建設工程價款優先受償權的行使期限>「建設工程」建設工程價款優先受償權的行使期限</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3920fedb.html alt=常用網絡連通性測試工具（上） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ce7d050d685944e3a977a41d4520d20e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3920fedb.html title=常用網絡連通性測試工具（上）>常用網絡連通性測試工具（上）</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/25a9f8cd.html alt=一起看看啥是圖論算法-第一期：圖的基本表示 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1dcb968132c34dcdbb855dac6472e42e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/25a9f8cd.html title=一起看看啥是圖論算法-第一期：圖的基本表示>一起看看啥是圖論算法-第一期：圖的基本表示</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/160a8715.html alt=圖論的各種基本算法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/30080011575364d6b24c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/160a8715.html title=圖論的各種基本算法>圖論的各種基本算法</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/13ac8d6c.html alt=數學圖論中的一筆畫問題與抖音神題5×5點陣缺一點時的連線問題 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/23da8430b0c14c549c5fc6d6a4ffb4a2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/13ac8d6c.html title=數學圖論中的一筆畫問題與抖音神題5×5點陣缺一點時的連線問題>數學圖論中的一筆畫問題與抖音神題5×5點陣缺一點時的連線問題</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/4c240fab.html alt="智能運維 | 你的機房不通或者內網異常，用這個連通性矩陣圖試試" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/762657a5-93a3-4744-afae-0b2af6d4cf8f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/4c240fab.html title="智能運維 | 你的機房不通或者內網異常，用這個連通性矩陣圖試試">智能運維 | 你的機房不通或者內網異常，用這個連通性矩陣圖試試</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/bfe17281.html alt=“4+7”競標品種獲優先審評；正大天晴、石藥歐意重磅首仿來襲 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/e40a2175afed4a208c7b49009381b1e4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/bfe17281.html title=“4+7”競標品種獲優先審評；正大天晴、石藥歐意重磅首仿來襲>“4+7”競標品種獲優先審評；正大天晴、石藥歐意重磅首仿來襲</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/10f9a70f.html alt=博雅生物：人凝血酶原複合物納入優先審評程序 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/10f9a70f.html title=博雅生物：人凝血酶原複合物納入優先審評程序>博雅生物：人凝血酶原複合物納入優先審評程序</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/3e3afc6e.html alt=軍人依法優先的實戰化意義 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9ae88ecc8fa14619bbaded51340d3750 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/3e3afc6e.html title=軍人依法優先的實戰化意義>軍人依法優先的實戰化意義</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9506f9ec.html alt=優先改進哪個點：捏軟柿子還是啃硬骨頭？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/0a40c91737134a61b4a39d029f05cdd9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9506f9ec.html title=優先改進哪個點：捏軟柿子還是啃硬骨頭？>優先改進哪個點：捏軟柿子還是啃硬骨頭？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a94fbf80.html alt="半月談 |“優先使用”會不會成畫餅？一線扶貧幹部心態調查" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/S3RmIxe70FPPiu style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a94fbf80.html title="半月談 |“優先使用”會不會成畫餅？一線扶貧幹部心態調查">半月談 |“優先使用”會不會成畫餅？一線扶貧幹部心態調查</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/14038e9.html alt=HTML中，閉合優先的神奇標籤 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/3ecb00024a310d6311ec style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/14038e9.html title=HTML中，閉合優先的神奇標籤>HTML中，閉合優先的神奇標籤</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/655c4d7.html alt=初中物理所有公式的通性！學電學時若不注意必錯無疑！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9d1830be0b274ab8b634e09873aca4cf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/655c4d7.html title=初中物理所有公式的通性！學電學時若不注意必錯無疑！>初中物理所有公式的通性！學電學時若不注意必錯無疑！</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/aa76824.html alt="紅嶺創投：本金優先兌付方案投票再延期 不存在收割" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RL9l2uc7v06J64 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/aa76824.html title="紅嶺創投：本金優先兌付方案投票再延期 不存在收割">紅嶺創投：本金優先兌付方案投票再延期 不存在收割</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/8b66833.html alt=紅嶺就本金優先兌付方案徵求意見：已兌付19.2億 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RLEhvsHFWKc0Eo style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/8b66833.html title=紅嶺就本金優先兌付方案徵求意見：已兌付19.2億>紅嶺就本金優先兌付方案徵求意見：已兌付19.2億</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>