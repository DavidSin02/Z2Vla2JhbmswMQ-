<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>支持向量機（第四章） | 极客快訊</title><meta property="og:title" content="支持向量機（第四章） - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/153914838549618d2616eb5"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/9816751.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/9816751.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/9816751.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/9816751.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/9816751.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/9816751.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/9816751.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/9816751.html><meta property="article:published_time" content="2020-10-29T20:56:37+08:00"><meta property="article:modified_time" content="2020-10-29T20:56:37+08:00"><meta name=Keywords content><meta name=description content="支持向量機（第四章）"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E5%AD%B8/9816751.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>支持向量機（第四章）</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E5%AD%B8.html>科學</a></span></div><div class=post-content><div><h1>第四章 解最優化問題</h1><p>譯/吳天暉</p><p>按語：請多批評。</p><h1>拉格朗日乘</h1><p>意大利-法國數學家<strong>Giuseppe Lodovico Lagrangia，也就是大家知道的JosephLouis Lagrange，他發明了一個策略來尋找一個有等式約束的函數的局部最大值和最小值。這個方法叫拉格朗日乘。</strong></p><h1>拉格朗日乘數法</h1><p>拉格朗日注意到當我們求如下最優化問題時：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153914838549618d2616eb5><p class=pgc-img-caption></p></div><p>找到<em>f</em>的最小值也就是找到一個同一方向的梯度點同時符合條件<em>g。可以寫成，當：</em></p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539148385566602d9e7395><p class=pgc-img-caption></p></div><p>所以我們想要找到<em>f</em>在約束<em>g</em>下的最小值，也就是要求出：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1539148378587b69b3e2ca9><p class=pgc-img-caption></p></div><p>這裡，常數<em>a</em>稱為拉格朗日乘子<em>。</em></p><p>簡化這個方法，我們發現如果我們定義一個方程<em>(x, a)=f(x)- ag(x)</em>，這時他們的梯度是<em>(x, a)=</em> <em>f(x)-</em> <em>ag(x)</em>。之後，<em>(x, a)=0</em>的解就是我們找到這個最小值<em>。</em></p><p>拉格朗日乘數法能總結為以下三步：</p><p>1．通過每一個帶乘子的約束條件來構造拉格朗日函數</p><p>2．給出拉格朗日函數的梯度</p><p>3．解函數<em>(x, a)=0</em></p><h1>SVM 拉格朗日問題</h1><p>我們看到上一章介紹的SVM優化問題是：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15391483788081e8e0200b0><p class=pgc-img-caption></p></div><p>讓我們回到這個問題。我們有一個需求最小值的目標函數：</p><p>和約束條件函數m:</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15391483789564f03dff72f><p class=pgc-img-caption></p></div><p>我們得出拉格朗日函數：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15391483792116c080496e8><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15391483794573dfe432ffc><p class=pgc-img-caption></p></div><p>注意在這裡我們給每一個約束函數配了一個拉格朗日乘子<em>ai</em>。</p><p>我們可以嘗試去求<em>(w,b, a)=</em>0,但是這個問題僅能在用例少的情況下能分析求出（Tyson Smith,2004）。所以我們不得不用對偶原理重寫這個問題。</p><p>要解答這個原問題，我們需要去解下面的拉格朗日問題：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15391483795883e6daafe9a><p class=pgc-img-caption></p></div><p>有意思的是我們在這裡要得到w和b的最小時值同時要得到a的最大值。</p><p><strong><em>提示：</em></strong><em>你可能注意到拉格朗日乘數法是用來解決帶等式約束的問題的，但在這兒我們用它來處理不等式約束，用這個方法來處理不等式約束，還需要附加一些條件（KKT條件）。我們之後將介紹這些條件。</em></p><h1>烏爾夫對偶問題</h1><p>拉格朗日問題有一個不等式約束<em>m</em>（<em>m</em>是指訓練用例），他的典型解法是用對偶形。對偶原理告訴我們一個優化問題可以看成是兩個透視圖。第一個是原問題，我們關心的優化問題，另一個是對偶問題，一個求最大值的問題。有意思的是對偶問題中的最大值常常小於或等同於原問題的最小值（我們說它提供一個降低解原問題難度的方法）。</p><p>在我們這裡，我們試著去解決一個凸優化問題，和仿射約束下的斯萊德條件（Gretton,2016）, 斯萊德定理告訴我們強對偶問題成立。意思是對偶問題中的求最大值等價於原問題中的求最小值。求對偶問題也就是求原問題，但是更簡單。</p><p>重新列出拉格朗日函數：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15391483798714a9de75246><p class=pgc-img-caption></p></div><p>這個拉格朗日原問題是：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1539152172373d557cd5c3a><p class=pgc-img-caption></p></div><p>求這個最小值問題演化為在的偏導數中求<em>w</em>和<em>b</em>。</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539148380025dc6c20f3ee><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539148380133813d1a05fa><p class=pgc-img-caption></p></div><p>從第一個式子中，我們發現：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153914838031196084da742><p class=pgc-img-caption></p></div><p>讓我們用下面的值代替<em>w</em>：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539148380588909f3d5fa6><p class=pgc-img-caption></p></div><p>我們成功的去掉了<em>w</em>,但是b還是留在了式子的最後部分：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15391483808049bdec8f73c><p class=pgc-img-caption></p></div><p>我們注意到</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539148380880022bcc4526><p class=pgc-img-caption></p></div><p>意味著</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539148381683a60f85c7be><p class=pgc-img-caption></p></div><p>，因此上式的最後部分等於0,於是我們可以寫成：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/153914838188696f6d39f4f><p class=pgc-img-caption></p></div><p>這就是烏爾夫拉格朗日對偶函數。</p><p>優化問題至此就被稱為烏爾夫對偶問題：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539148382097a01c207c6a><p class=pgc-img-caption></p></div><p>通常烏爾夫對偶拉格朗日問題會強制梯度等於0。理論上，我們需增加約束</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1539148382211d2dcf96f81><p class=pgc-img-caption></p></div><p>和</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1539148382286384c15a89e><p class=pgc-img-caption></p></div><p>。然而，我們僅僅增加後面的項。就是我們增加約束</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15391522198417135205ec7><p class=pgc-img-caption></p></div><p>因為它能在函數中去掉<em>b。</em></p><p>無論如何，我們可以在沒有約束</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15391483823322e1655f6f6><p class=pgc-img-caption></p></div><p>下來解決問題。</p><p>基於烏爾夫對偶的拉格朗日問題的優勢是目標函數<em>W</em>現在僅僅只依賴拉格朗日乘子。並且，這個公式將幫我們在下一節裡用Python來解決問題而且當我們之後學習核方式時也非常有用。</p><h1>Karush-Kuhn-Tucker 條件</h1><p>因為我們要解決不等式約束，有一個附加條件：解決方法中必須滿足Karush-Kuhn-Tucker (KKT)條件。</p><p>KKT條件首先需要的條件是能解優化問題的最值。進而，這個問題要滿足一些規則條件。幸運的是，規則條件中有一個叫斯萊特條件，我們可以看到它能支持SVMs。因為我們的原問題是要試著去解決一個凸問題，KKT條件能充分滿足求原問題和對偶問題的最值，他們是零對偶間隙。</p><p>總之，如果一個解法滿足KKT條件，我們可以認為它是最優的解法。</p><p>這個KKT條件是：</p><p>穩定條件：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15391522885733f698a549a><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539152297817823fde5e91><p class=pgc-img-caption></p></div><p>原可行條件：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539148382457317b19b7ae><p class=pgc-img-caption></p></div><p>對偶可行條件：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1539148382568deda773aa0><p class=pgc-img-caption></p></div><p>互補鬆馳條件：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1539148382678c5b09c3a86><p class=pgc-img-caption></p></div><p><strong><em>提示：</em></strong><em>……解決支持向量機的問題等價於尋找一個KKT條件。</em></p><p>到此我們找到了所有的必要條件。讓我們來一點一點實踐吧。</p><h1>穩定條件</h1><p>這個穩定條件告訴我們被選點必須是一個駐點。它是一個函數遞增或遞減的停止點。如果沒有約束，穩定條件下的駐點就是目標函數梯度為0的點。如果我們有約束，我們將把梯度用在拉格朗日函數上。</p><h1>原可行條件</h1><p>盯著這個條件，你應該看出來這就是原問題的約束。它要使我們必須求出這個函數在約束下的最小值。</p><h1>對偶可行條件</h1><p>同樣，這個條件代表的是對偶問題的約束。</p><h1>互補鬆馳條件</h1><p>從互補鬆馳條件中，我們可以看到</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1539148382850406ce80568><p class=pgc-img-caption></p></div><p>或</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539148382965ba5054bf29><p class=pgc-img-caption></p></div><p>。</p><p>支持向量是一個正拉格朗日乘子的示例。它們是約束</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/153914838305436bfb500e0><p class=pgc-img-caption></p></div><p>其中之一。（我們看見這個約束</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153915242407489a7627b34><p class=pgc-img-caption></p></div><p>是可用的）。</p><p><strong><em>技巧：</em></strong>從互補鬆馳條件中，我們看到支持向量是正拉格朗日乘子的示例。</p><h1>我們如何使用這個乘子？</h1><p>當我們解烏爾夫對偶問題時，我們得到一個向量<em>a</em>包含所有的拉格朗日乘子。可是，當我們首先提到原問題時，我們的目標是尋找<strong><em>w</em></strong>和<em>b</em>。讓我們看我們怎樣去從拉格朗日乘子中提取這些數值。</p><h1>計算w</h1><p>計算w是相當簡單的，從梯度</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15391483831228c856d3f4c><p class=pgc-img-caption></p></div><p>得到公式：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539152473654cee15efe10><p class=pgc-img-caption></p></div><p>。</p><h1>計算b</h1><p>一量我們已知w,我們可以從原問題的約束中計算<em>b</em>：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153915249863361fa29e259><p class=pgc-img-caption></p></div><p>事實上，這個約束一直是正確的，因為這新的公式是與原問題等價的一種變形。它說明這些臨近超平面的點將被一個函數限制在1內（這個值1是我們選的用來讓我們決定如何去變形W）：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1539148383202b7870b9283><p class=pgc-img-caption></p></div><p>到這裡，我們知道所有的其他變量,求<em>b</em>就變得很容易開始了。我們在等式兩邊都乘以<em>yi</em>，又因為</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1539148383238b8b72bb145><p class=pgc-img-caption></p></div><p>，我們得到：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153914838336320578d9337><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15391483834266c995f5716><p class=pgc-img-caption></p></div><p>然而，在文獻模式識別與機器學習（<em>Pattern Recognition and Machine Learning </em>(Bishop, 2006)）中，我們用提供的支持向量的平均值來代替隨機支持向量xi是更穩健的方法：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15391483835275d52af6ccc><p class=pgc-img-caption></p></div><p>這裡S是支量向量的個數。</p><p>其他作者，像(Cristianini & Shawe-Taylor, 2000) 和(Ng),用另一個公式：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1539148383654540760b452><p class=pgc-img-caption></p></div><p>它們都主要是取最近的正支持向量和最近的負支持向量的平均值。最後的公式最初是統計學習理論（<em>Statistical Learning Theory </em>(Vapnik V. N., 1998)）用來定義最優超平面的。</p><h1>假設函數</h1><p>SVMs用與感知器得到的相同的假設函數。分類示例點xi 函數：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539148383753df0d4fe1db><p class=pgc-img-caption></p></div><p>當我們使用對偶公式，它可以僅用支持向量計算：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15391483838952aed0e2dee><p class=pgc-img-caption></p></div><h1>用QP方法來處理SVMs</h1><p>QP方法是一個用來處理二次型編程問題的程序。在接下來的例子中，我們將wgket用一個叫CVXOPT的Python包。</p><p>這個軟件包提供一個方法來解決類似下面的二次型問題：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15391483840440d814a05b0><p class=pgc-img-caption></p></div><p>這看起來不像我們的優化問題，所以我們將要去改寫它，讓它能用這個軟件包來處理。</p><p>首先，我們注意到烏爾夫對偶優化問題中，我們要去最小化<em>a，所以我們可以改寫二次型問題，用a來代替x，看來會讓兩個問題的關係近一些。</em></p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539148384153f42cfb3a00><p class=pgc-img-caption></p></div><p>這裡的</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15391483842277c015c2026><p class=pgc-img-caption></p></div><p>符號代表分量式不等式。意思是矩陣Gλ的每一行都必須滿足不等關係。</p><p>我們來改變烏爾夫對偶問題。首先，我們轉化最大值問題：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15391483844611022232ad8><p class=pgc-img-caption></p></div><p>乘以-1轉化成最小值問題。</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1539152544181c7c2d60faf><p class=pgc-img-caption></p></div><p>然後我們讓向量</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1539148384707b86c0c743d><p class=pgc-img-caption></p></div><p>和</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539148384827da377f0904><p class=pgc-img-caption></p></div><p>及克萊姆矩陣K都與向量xi作點積運算：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15391483850260fcc202991><p class=pgc-img-caption></p></div><p>我們用它們構造一個向量化的烏爾夫對偶問題，</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539148385096be5b285b0d><p class=pgc-img-caption></p></div><p>表示y的外積。</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15391483852543616a74d43><p class=pgc-img-caption></p></div><p>我們現在可以求用CVXOP qp函數求出P，q，G，h，A和b等等所有參數的值。如代碼表24所示。</p><pre>代碼表24# See Appendix A for more information about the dataset from succinctly.datasets import get_dataset, linearly_separable as lsimport cvxopt.solvers X, y = get_dataset(ls.get_training_examples) m = X.shape[0] # Gram matrix - The matrix of all possible inner products of X. K = np.array([np.dot(X[i], X[j]) for j in range(m) for i in range(m)]).reshape((m, m)) P = cvxopt.matrix(np.outer(y, y) * K) q = cvxopt.matrix(-1 * np.ones(m)) # Equality constraints A = cvxopt.matrix(y, (1, m)) b = cvxopt.matrix(0.0) # Inequality constraints G = cvxopt.matrix(np.diag(-1 * np.ones(m))) h = cvxopt.matrix(np.zeros(m)) # Solve the problem solution = cvxopt.solvers.qp(P, q, G, h, A, b) # Lagrange multipliers multipliers = np.ravel(solution['x']) # Support vectors have positive multipliers. has_positive_multiplier = multipliers &gt; 1e-7 sv_multipliers = multipliers[has_positive_multiplier] support_vectors = X[has_positive_multiplier] support_vectors_y = y[has_positive_multiplier]</pre><p>代碼表24初始化所有要求的參數並且將其傳給qp方法，它會給我們一個結果。這個結果包含很多無素，但是我們只關心x，它在我們這裡相當於就是拉格朗日乘子。</p><p>當我看到上面，我們可以用拉格朗日乘子重算w：</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15391525834465875f43a21><p class=pgc-img-caption></p></div><p>。代碼表25顯示計算w的函數代碼。</p><pre>代碼表25def compute_w(multipliers, X, y):  return np.sum(multipliers[i] * y[i] * X[i]  for i in range(len(y))) </pre><p>因為拉格朗日乘子對於非支持向量的結果近似為零，所以我們只用支持向量數據來計算w，見代碼表26。</p><pre>代碼表26w = compute_w(multipliers, X, y) w_from_sv=compute_w(sv_multipliers, support_vectors, support_vectors_y) print(w) # [0.44444446 1.11111114] print(w_from_sv) # [0.44444453 1.11111128] </pre><p>當我們用均值方法計算b時：</p><pre>代碼表27def compute_b(w, X, y):  return np.sum([y[i] - np.dot(w, X[i])  for i in range(len(X))])/len(X)代碼表28b = compute_b(w, support_vectors, support_vectors_y) # -9.666668268506335 </pre><p>當我們將結果用圖32來表示時，我們發現這個超平面就是最優超平面。與感知器不同，SVM總能得到相同的結果。</p><div class=pgc-img><img alt=支持向量機（第四章） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15391529761156a144762b6><p class=pgc-img-caption>圖32: 用CVXOPT求出超平面</p></div><p>我們介紹的這種SVM被稱為硬邊界SVM。它面對非線性可分的數據不能工作。有幾個時髦的支持向量機的方法。在下一章我們將介紹另一種被稱為軟邊界SVM的方法，它能夠在有非線性可分的異常據數據下工作。</p><h1>小結</h1><p>w的範式的最小值是一個凸優化問題，它可以用拉格朗日乘數法解決。當我們有更多的這類問題時，我喜歡用凸優化包，它可以幫我們做這些艱苦的工作。</p><p>我們發現原優化問題可以用拉格朗日函數來改寫成，謝謝對偶規則，我們可以將拉格朗日問題轉成烏爾夫對偶問題。我們還用了CVXOPT包來求解烏爾夫對偶。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>向量</a></li><li><a>第四章</a></li><li><a>支持</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/d61d6a42.html alt=支持向量機（第八章） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/153985032133768ee02ea64 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d61d6a42.html title=支持向量機（第八章）>支持向量機（第八章）</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/0ad6da61.html alt=一文解釋支持向量機 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3d38e71602404ee1bf306ccc937d4289 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/0ad6da61.html title=一文解釋支持向量機>一文解釋支持向量機</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/58f11d6c.html alt=初識支持向量機 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/593c00005f9561757b88 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/58f11d6c.html title=初識支持向量機>初識支持向量機</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/7885fca7.html alt=一文看懂支持向量機 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b14f689acfb94e968e379121dee31bbb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/7885fca7.html title=一文看懂支持向量機>一文看懂支持向量機</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e1a84312.html alt=127：平面向量(基底法，容易掉坑裡) class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/798fe5150f7e41db847e88330e26f9d1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e1a84312.html title=127：平面向量(基底法，容易掉坑裡)>127：平面向量(基底法，容易掉坑裡)</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a6560bc0.html alt=“孃家”支持！他的創業路越走越穩！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a0c141c4347841cb8c41c9097bb352cc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a6560bc0.html title=“孃家”支持！他的創業路越走越穩！>“孃家”支持！他的創業路越走越穩！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/62900ef0.html alt=一文了解邏輯迴歸和支持向量機的異同 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1539671186198856310f156 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/62900ef0.html title=一文了解邏輯迴歸和支持向量機的異同>一文了解邏輯迴歸和支持向量機的異同</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7c54da7d.html alt=關於向量你所不知道的那1、2、3、4件事 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/3afd00000309c31b9722 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7c54da7d.html title=關於向量你所不知道的那1、2、3、4件事>關於向量你所不知道的那1、2、3、4件事</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f6469ee4.html alt=高中數學必修四-平面向量突破點（二）平面向量的線性運算 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/46cb0002bbea1028e85d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f6469ee4.html title=高中數學必修四-平面向量突破點（二）平面向量的線性運算>高中數學必修四-平面向量突破點（二）平面向量的線性運算</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/500b25d2.html alt="第四章: 數組" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/c82f2b85-5aa7-44d0-85c2-a69f88ee668e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/500b25d2.html title="第四章: 數組">第四章: 數組</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/eb3ceb40.html alt=一建市政白皮書！第四章（給排水）上 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/cda1e3fae44a447492101743786d60a0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/eb3ceb40.html title=一建市政白皮書！第四章（給排水）上>一建市政白皮書！第四章（給排水）上</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/d35eb131.html alt=向量組的線性相關性 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/42878bb02cfd49a5bff27706934f48f2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/d35eb131.html title=向量組的線性相關性>向量組的線性相關性</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/1f3617bb.html alt="GroC 組合式詞向量生成算法" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a720bf73a52548348f6095c3ce6bd920 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/1f3617bb.html title="GroC 組合式詞向量生成算法">GroC 組合式詞向量生成算法</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/98922e26.html alt="「曲線弧長，單位切向量，主單位法向量」圖解高等數學 下-07" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/4b000000f1313245125e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/98922e26.html title="「曲線弧長，單位切向量，主單位法向量」圖解高等數學 下-07">「曲線弧長，單位切向量，主單位法向量」圖解高等數學 下-07</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/33284c83.html alt=平面向量最值問題 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/08de805129af4d4795d0fa7a88eff4c1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/33284c83.html title=平面向量最值問題>平面向量最值問題</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>