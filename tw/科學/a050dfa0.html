<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>JDK9的新特性：JVM的xlog | 极客快訊</title><meta property="og:title" content="JDK9的新特性：JVM的xlog - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/a050dfa0.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/a050dfa0.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/a050dfa0.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/a050dfa0.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/a050dfa0.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/a050dfa0.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/a050dfa0.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/a050dfa0.html><meta property="article:published_time" content="2020-10-29T21:13:10+08:00"><meta property="article:modified_time" content="2020-10-29T21:13:10+08:00"><meta name=Keywords content><meta name=description content="JDK9的新特性：JVM的xlog"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E5%AD%B8/a050dfa0.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>JDK9的新特性：JVM的xlog</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E5%AD%B8.html>科學</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>簡介</h1><p>在java程序中，我們通過日誌來定位和發現項目中可能出現的問題。在現代java項目中，我們使用log4j或者slf4j，Logback等日誌記錄框架來處理日誌問題。</p><p>JVM是java程序運行的基礎，JVM中各種事件比如：GC,class loading,JPMS,heap,thread等等其實都可以有日誌來記錄。通過這些日誌，我們可以監控JVM中的事件，並可以依次來對java應用程序進行調優。</p><p>在JDK9中引入的Xlog日誌服務就是為這個目的而創建的。</p><p>通過xlog，JDK將JVM中的各種事件統一起來，以統一的形式對外輸出。通過tag參數來區分子系統，通過log level來區分事件的緊急性，通過logging output來配置輸出的地址。</p><blockquote><p>更多內容請訪問 flydean.com</p></blockquote><h1 class=pgc-h-arrow-right>xlog的使用</h1><p>先看一個最簡單的xlog的使用例子：</p><pre><code>java -Xlog -version</code></pre><p>輸出結果：</p><pre><code>[0.016s][info][os] Use of CLOCK_MONOTONIC is supported[0.016s][info][os] Use of pthread_condattr_setclock is not supported[0.016s][info][os] Relative timed-wait using pthread_cond_timedwait is associated with the default clock[0.017s][info][os] SafePoint Polling address, bad (protected) page:0x0000000108901000, good (unprotected) page:0x0000000108902000[0.022s][info][biasedlocking] Aligned thread 0x00007f983e008200 to 0x00007f983e008800[0.023s][info][os,thread    ] Thread attached (tid: 10499, pthread id: 123145571979264).</code></pre><p>日誌非常非常長，這裡就不全部列出來了。從輸出的日誌我們可以看到java -verson命令中JVM執行了諸多的操作。</p><p>我們可以看到日誌中對每一個操作都列出了操作花費的時間，日誌級別和操作所屬的分類。</p><p>通過這些日誌，我們對於JVM的運行可以有更加深入的理解。</p><p>使用java -Xlog:help命令我們看一下xlog的基本格式：</p><pre><code>-Xlog Usage: -Xlog[:[selections][:[output][:[decorators][:output-options]]]]     where &#39;selections&#39; are combinations of tags and levels of the form tag1[+tag2...][*][=level][,...]     NOTE: Unless wildcard (*) is specified, only log messages tagged with exactly the tags specified will be matched.</code></pre><h1 class=pgc-h-arrow-right>selections</h1><p>selections表示的是到底需要輸出哪些信息。是以tag=level來表示的。</p><p>tag表示的是JVM中的事件或者子系統：</p><pre><code>Available log tags: add, age, alloc, annotation, aot, arguments, attach, barrier, biasedlocking, blocks, bot, breakpoint, bytecode, cds, census, class, classhisto, cleanup, codecache, compaction, compilation, constantpool, constraints, container, coops, cpu, cset, data, datacreation, dcmd, decoder, defaultmethods, director, dump, dynamic, ergo, event, exceptions, exit, fingerprint, free, freelist, gc, handshake, hashtables, heap, humongous, ihop, iklass, init, inlining, install, interpreter, itables, jfr, jit, jni, jvmti, liveness, load, loader, logging, malloc, mark, marking, membername, memops, metadata, metaspace, methodcomparator, mirror, mmu, module, monitorinflation, monitormismatch, nestmates, nmethod, normalize, numa, objecttagging, obsolete, oldobject, oom, oopmap, oops, oopstorage, os, pagesize, parser, patch, path, perf, periodic, phases, plab, preorder, preview, promotion, protectiondomain, ptrqueue, purge, record, redefine, ref, refine, region, reloc, remset, resolve, safepoint, sampling, scavenge, setting, smr, stackmap, stacktrace, stackwalk, start, startuptime, state, stats, streaming, stringdedup, stringtable, subclass, survivor, sweep, symboltable, system, table, task, thread, time, timer, tlab, tracking, unload, unshareable, update, verification, verify, vmmutex, vmoperation, vmthread, vtables, vtablestubs, workgang Specifying &#39;all&#39; instead of a tag combination matches all tag combinations</code></pre><p>levels表示的是日誌的級別：</p><pre><code>Available log levels: off, trace, debug, info, warning, error</code></pre><p>下面舉個例子：</p><pre><code>java -Xlog:os,class=info -version</code></pre><p>輸出結果：</p><pre><code>[0.002s][info][os] Use of CLOCK_MONOTONIC is supported[0.002s][info][os] Use of pthread_condattr_setclock is not supported[0.002s][info][os] Relative timed-wait using pthread_cond_timedwait is associated with the default clock[0.003s][info][os] SafePoint Polling address, bad (protected) page:0x0000000109543000, good (unprotected) page:0x0000000109544000[0.006s][info][os] attempting shared library load of /Library/Java/JavaVirtualMachines/jdk-14.0.1.jdk/Contents/Home/lib/libjava.dylib[0.007s][info][os] shared library load of /Library/Java/JavaVirtualMachines/jdk-14.0.1.jdk/Contents/Home/lib/libjava.dylib was successful[0.007s][info][os] attempting shared library load of /Library/Java/JavaVirtualMachines/jdk-14.0.1.jdk/Contents/Home/lib/libzip.dylib[0.010s][info][os] shared library load of /Library/Java/JavaVirtualMachines/jdk-14.0.1.jdk/Contents/Home/lib/libzip.dylib was successful</code></pre><h1 class=pgc-h-arrow-right>output</h1><p>output表示將日誌輸出到什麼地方。</p><p>output的可選項：</p><pre><code> stdout/stderr file=&lt;filename&gt; ~~~ stdout表示標準輸出，stderr表示標準錯誤。file表示輸出到文件裡面。 舉個例子： ~~~java java -Xlog:all=debug:file=debug.log -version</code></pre><h1 class=pgc-h-arrow-right>decorators</h1><p>decorators表示輸出哪些內容到日誌中。</p><pre><code>time (t), utctime (utc), uptime (u), timemillis (tm), uptimemillis (um), timenanos (tn), uptimenanos (un), hostname (hn), pid (p), tid (ti), level (l), tags (tg) Decorators can also be specified as &#39;none&#39; for no decoration</code></pre><p>看下這個例子：</p><pre><code> java -Xlog:gc*=debug:stdout:time,uptimemillis,tid -version</code></pre><p>輸出結果：</p><pre><code> [2020-05-05T16:12:06.871-0800][32ms][9475] Heap region size: 1M[2020-05-05T16:12:06.871-0800][32ms][9475] Minimum heap 8388608  Initial heap 134217728  Maximum heap 2147483648[2020-05-05T16:12:06.872-0800][33ms][9475] Heap address: 0x0000000780000000, size: 2048 MB, Compressed Oops mode: Zero based, Oop shift amount: 3[2020-05-05T16:12:06.872-0800][33ms][9475] ConcGCThreads: 1 offset 8[2020-05-05T16:12:06.872-0800][33ms][9475] ParallelGCThreads: 4</code></pre><h1 class=pgc-h-arrow-right>總結</h1><p>xlog是JDK9中提供的非常有用的一個功能。大家可以在日常的工作中使用。</p><blockquote><p>本文作者：flydean程序那些事</p><p>本文來源：flydean的博客</p><p>歡迎關注我的公眾號:程序那些事，更多精彩等著您！</p></blockquote></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>JDK9</a></li><li><a>JVM</a></li><li><a>xlog</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/816b04b7.html alt=從JVM層面帶你分析Java的Object類源碼第一部分 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/816b04b7.html title=從JVM層面帶你分析Java的Object類源碼第一部分>從JVM層面帶你分析Java的Object類源碼第一部分</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fd1246b1.html alt=JVM—深入理解內存模型與垃圾收集機制 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/574c706db69f4c53802c093d6e7023d4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fd1246b1.html title=JVM—深入理解內存模型與垃圾收集機制>JVM—深入理解內存模型與垃圾收集機制</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/030e9343.html alt="JVM 垃圾收集器細節補充" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/97bc94b0a276433a809abd99b14bd724 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/030e9343.html title="JVM 垃圾收集器細節補充">JVM 垃圾收集器細節補充</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/59d7c87e.html alt=JVM/併發/MySQL/Java/網絡等一個都沒肝完，想擠BAT你說難不難？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/80833d07a23e4e4c8677376189188e4d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/59d7c87e.html title=JVM/併發/MySQL/Java/網絡等一個都沒肝完，想擠BAT你說難不難？>JVM/併發/MySQL/Java/網絡等一個都沒肝完，想擠BAT你說難不難？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/84aac9b.html alt=JVM診斷之查看運行參數 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/e73276f3125b4ad995d634b8b2462b74 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/84aac9b.html title=JVM診斷之查看運行參數>JVM診斷之查看運行參數</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9891406.html alt=程序員：深入理解JVM，從JVM層面來講Java多態 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/dde11845-76d0-4452-af65-97e0e223c1cf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9891406.html title=程序員：深入理解JVM，從JVM層面來講Java多態>程序員：深入理解JVM，從JVM層面來講Java多態</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f553981.html alt=一次完整的JVM堆外內存洩漏故障排查記錄 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/15784a09582b430cb43ff878ec7c1d82 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f553981.html title=一次完整的JVM堆外內存洩漏故障排查記錄>一次完整的JVM堆外內存洩漏故障排查記錄</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c3cb200.html alt=「Java的JVM分析」JDK監控和故障處理工具，學會分析程序 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/fb7c5a5f91ff439cbd458318d4316adf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c3cb200.html title=「Java的JVM分析」JDK監控和故障處理工具，學會分析程序>「Java的JVM分析」JDK監控和故障處理工具，學會分析程序</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2a1c957.html alt="JVM 線上故障排查基本操作" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/d91a35d9-8b39-4cc8-bc3c-f1da50244409 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2a1c957.html title="JVM 線上故障排查基本操作">JVM 線上故障排查基本操作</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>