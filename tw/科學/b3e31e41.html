<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>徹底理解回溯法的精要 | 极客快訊</title><meta property="og:title" content="徹底理解回溯法的精要 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/b3e31e41.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/b3e31e41.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/b3e31e41.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/b3e31e41.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/b3e31e41.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/b3e31e41.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/b3e31e41.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/b3e31e41.html><meta property="article:published_time" content="2020-11-14T20:53:57+08:00"><meta property="article:modified_time" content="2020-11-14T20:53:57+08:00"><meta name=Keywords content><meta name=description content="徹底理解回溯法的精要"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E5%AD%B8/b3e31e41.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>徹底理解回溯法的精要</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E5%AD%B8.html>科學</a></span></div><div class=post-content><p>目錄</p><ul><li>問題分析使用什麼方法？什麼是回溯法？怎麼使用回溯法？回溯法的具體實施回溯法的延伸</li></ul><p>給定一個沒有重複數字的序列，返回其所有可能的全排列。<br>示例:</p><pre><code>Copy輸入: [1,2,3]輸出:[  [1,2,3],  [1,3,2],  [2,1,3],  [2,3,1],  [3,1,2],  [3,2,1]]</code></pre><h2 class=pgc-h-arrow-right>問題分析#</h2><h3 class=pgc-h-arrow-right>使用什麼方法？#</h3><p>全排列很明顯使用回溯法來進行解答</p><h3 class=pgc-h-arrow-right>什麼是回溯法？#</h3><blockquote><p>回溯法（探索與回溯法）是一種選優搜索法，又稱為試探法，按選優條件向前搜索，以達到目標。但當探索到某一步時，發現原先選擇並不優或達不到目標，就退回一步重新選擇，這種走不通就退回再走的技術為回溯法，而滿足回溯條件的某個狀態的點稱為“回溯點”。</p></blockquote><h3 class=pgc-h-arrow-right>怎麼使用回溯法？#</h3><p>運用回溯法解題的關鍵要素有以下三點：</p><ol start=1><li>針對給定的問題，定義問題的解空間；</li><li>確定易於搜索的解空間結構；</li><li>以<strong>深度優先方式</strong>搜索解空間，並且在搜索過程中用剪枝函數避免無效搜索。<strong>什麼是深度優先搜索？#</strong>深度優先搜索（縮寫DFS）有點類似廣度優先搜索，也是對一個連通圖進行遍歷的算法。它的思想是從一個頂點V0開始，沿著一條路一直走到底，如果發現不能到達目標解，那就返回到上一個節點，然後從另一條路開始走到底，這種儘量往深處走的概念即是深度優先的概念。</li></ol><h4 class=pgc-h-arrow-right>代碼模板是什麼樣子的？#</h4><pre><code>Copyvoid BackTrace(int t) {    if(t&gt;n)        Output(x);    else    for(int i = f (n, t); i &lt;= g (n, t); i++ ) {        x[t] = h(i);        if(Constraint(t) &amp;&amp; Bound (t))        BackTrace(t+1);    }}</code></pre><p>其中，t表示遞歸深度，即當前擴展結點在解空間樹中的深度；n用來控制遞歸深度，即解空間樹的高度。當t>n時，算法已搜索到一個葉子結點，此時由函數Output(x)對得到的可行解x進行記錄或輸出處理</p><p>用 f(n, t)和 g(n, t)分別表示在當前擴展結點處未搜索過的子樹的起始編號和終止編號；h(i)表示在當前擴展結點處x[t]的第i個可選值；函數Constraint(t)和 Bound(t)分別表示當前擴展結點處的約束函數和限界函數。若函數Constraint(t)的返回值為真，則表示當前擴展結點處x[1:t]的取值滿足問題的約束條件；否則不滿足問題的約束條件。若函數Bound(t)的返回值為真，則表示在當前擴展結點處x[1:t]的取值尚未使目標函數越界，還需由BackTrace(t+1)對其相應的子樹做進一步地搜索；否則，在當前擴展結點處x[1:t]的取值已使目標函數越界，可剪去相應的子樹。</p><h3 class=pgc-h-arrow-right>回溯法的具體實施#</h3><pre><code>Copyclass Solution {    public List&lt;List&lt;Integer&gt;&gt; permute(int[] nums) {      //LeetCode代碼模板      }}</code></pre><h4 class=pgc-h-arrow-right>step 1 定義問題的解空間#</h4><h5 class=pgc-h-arrow-right>什麼是解空間？</h5><blockquote><p>應用回溯法求解問題時，首先應明確定義問題的解空間，該解空間應至少包含問題的一個最優解。例如，對於有n種物品的 0-1 揹包問題，其解空間由長度為n的 0-1 向量組成，該解空間包含了對變量的所有可能的0-1 賦值。當n=3時，其解空間是{ (0, 0, 0), (0, 0, 1), (0, 1, 0), (0, 1, 1), (1, 0, 0), (1, 0, 1), (1, 1, 0), (1, 1, 1) }<br>在定義了問題的解空間後，還需要將解空間有效地組織起來，使得回溯法能方便地搜索整個解空間，通常將解空間組織成樹或圖的形式。例如，對於n= 3的0-1 揹包問題，其解空間可以用一棵完全二叉樹表示，從樹根到葉子結點的任意一條路徑可表示解空間中的一個元素，如從根結點A到結點J的路徑對應於解空間中的一個元素(1, 0, 1)。</p></blockquote><h5 class=pgc-h-arrow-right>定義本題的解空間</h5><p>全排列問題，因為輸入數組的長度為n = nums.length，解空間就是一個森林：</p><blockquote><p>這裡需要一個森林的圖<br>假設n=4且nums[]={1,2,3,4}則解空間應該是<br>第一層：1 2 3 4<br>第二層：12 13 14 /21 23 24/31 32 34<br>第三層：123 124/132 134/213 214/231 234/241 243/312 314/.....<br>第四層：略</p></blockquote><h5 class=pgc-h-arrow-right>確定易於搜索的解空間結構</h5><blockquote><p>解空間主要對應的是子集樹和排列樹，依據題意進行選擇。（根據題意畫個圖，就知道了）</p></blockquote><p>什麼是子集樹？？？</p><blockquote><p>子集樹是一個數學學科詞彙，屬於函數類，當所給問題是從n個元素的集合S中找出S滿足某種性質的子集時，相應的解空間稱為子集樹。<br>當所給問題是從n個元素的集合S中找出S滿足某種性質的子集時，相應的解空間稱為子集樹。例如：n個物品的0-1揹包問題所相應的解空間是一棵子集樹，這類子集樹通常有2^n個葉結點，其結點總數為(2^(n+1))-1。遍歷子集樹的算法通常需O(2^n)計算時間。</p></blockquote><p>什麼是排列樹？？</p><blockquote><p>當所給問題是確定n個元素滿足某種性質的排列時，相應的解空間樹稱為排列樹。排列樹通常有n!個葉子節點。因此遍歷排列樹需要O(n!)的計算時間。</p></blockquote><p>上面已經確定，要將解空間構建成子集樹的形式</p><h4 class=pgc-h-arrow-right>step 2 回溯法的精髓#</h4><h5 class=pgc-h-arrow-right>回溯的精髓</h5><p><strong>退回原狀態</strong><br>如何回退是回溯的精髓，什麼時候回退<br>就本題而言，第一躺全排列應該是1->2->3->4 ,當走到最後一步4之後，應該回退一步到1->2->3因為3只有一個分支4，再回退一步到1->2，然後滿足了約束函數可以進行下一步1->2->4;<br>對於本題，回退到方法在於，標記未被訪問的數組下標，回退則重製標記<br>因此可以使用一個visited[]數組，數組的長度為nums.length，被訪問則對應的下標標記為true，否則標記為false；</p><h4 class=pgc-h-arrow-right>step 3 回溯函數的設計#</h4><p>void BackTrace(int t)只傳遞一個參數的話顯然是無法滿足本題的，因為本題包含了一下5個需要傳遞的參數：</p><ol start=1><li>visited[] 數組；</li><li>t 遞歸深度；</li><li>List&lt;List&lt;Integer>> output 保存所有解的大容器</li><li>List&lt;Integer> save 保存解的小容器</li><li>nums[]原始數據</li></ol><p>因此，BackTrace應設計為：</p><pre><code>Copypublic static void BackTrace( List&lt;Integer&gt; save, List&lt;List&lt;Integer&gt;&gt; out, boolean visited[], int nums[]) {        if (save.size() == nums.length) {            out.add(new ArrayList&lt;&gt;(save));            return;        } else            for (int i = 0; i &lt; nums.length; i++) {                if (visited[i]) continue;                visited[i] = true;                save.add(nums[i]);                BackTrace( save, out, visited, nums);                save.remove(save.size() - 1);                visited[i] = false;            }    }</code></pre><p>怎麼寫出這段代碼需要結合前面的內容反覆的思考 =-= 我想了好久才理清楚回溯的思路</p><h3 class=pgc-h-arrow-right>回溯法的延伸#</h3><p><strong>子集問題</strong><br>題目：</p><blockquote><p>給定一組不含重複元素的整數數組 nums，返回該數組所有可能的子集（冪集）。<br>說明：解集不能包含重複的子集。<br>示例：<br>輸入: nums = [1,2,3] 輸出: [ [3], [1], [2], [1,2,3], [1,3], [2,3], [1,2], [] ]<br>從上題中我們可以得出結論，這仍然是一道需要使用回溯法的題目。</p></blockquote><h4 class=pgc-h-arrow-right>解空間與解空間結構#</h4><p>很明顯這是一個子集數的解空間結構</p><blockquote><p>假設n=3且nums[]={1,2,3}則解空間應該是<br>第一層：1 2 3<br>第二層：12 13/21 23/31 32<br>第三層：123 132/213 231/312 321/</p></blockquote><h4 class=pgc-h-arrow-right>關鍵性問題#</h4><ol start=1><li>通過什麼方法回退？</li><li>約束條件是什麼？</li><li>去除重複對象</li></ol><h5 class=pgc-h-arrow-right>檢測重複</h5><p>檢測重複首先想到的會是哈希表HashMap.因此每一次添加都應該在添加之前查找，如果找到重複則不存入；</p><h5 class=pgc-h-arrow-right>約束條件是什麼</h5><p>約束條件應該還是當遍歷到最後一個元素時退出？</p><h5 class=pgc-h-arrow-right>通過什麼方法回退？</h5><p>由於集合的特殊性。不需要回退；</p><h4 class=pgc-h-arrow-right>函數的設計：#</h4><pre><code>Copypublic static void BackTrack(int t,int[] nums, List&lt;List&lt;Integer&gt;&gt; out, List&lt;Integer&gt; save) {        out.add(new ArrayList&lt;&gt;(save));        for (int i = t; i &lt; nums.length; i++) {            save.add(nums[i]);            BackTrack(i+1,nums, out, save);            save.remove(save.size()-1);        }    } </code></pre><p>作者：Nikura44</p><p>出處：https://www.cnblogs.com/samanian/p/12194520.html</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>徹底</a></li><li><a>精要</a></li><li><a>回溯</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/0cdba029.html alt=C++｜徹底弄清偽隨機數與隨機數 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0cdba029.html title=C++｜徹底弄清偽隨機數與隨機數>C++｜徹底弄清偽隨機數與隨機數</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d2e1ceb0.html alt="縱橫談｜徹底清除基層治理中的'灰色手段'" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d2e1ceb0.html title="縱橫談｜徹底清除基層治理中的'灰色手段'">縱橫談｜徹底清除基層治理中的'灰色手段'</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bd423c48.html alt=口罩產業鏈徹底亂了！丙烯週末瘋狂上漲，價格兩日翻倍，PP期價暴力拉昇；多廠家發緊急聲明…… class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/Rw0qyU6Ao0YcN0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bd423c48.html title=口罩產業鏈徹底亂了！丙烯週末瘋狂上漲，價格兩日翻倍，PP期價暴力拉昇；多廠家發緊急聲明……>口罩產業鏈徹底亂了！丙烯週末瘋狂上漲，價格兩日翻倍，PP期價暴力拉昇；多廠家發緊急聲明……</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4a687640.html alt=寶興縣開展“徹底清理層層加碼、堅決真切為基層減負”專項行動 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4a687640.html title=寶興縣開展“徹底清理層層加碼、堅決真切為基層減負”專項行動>寶興縣開展“徹底清理層層加碼、堅決真切為基層減負”專項行動</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6d451ce4.html alt=熔斷14次！房多多徹底撕開房產平臺暗傷 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0fa1fe78f52a407186f92787addf5ae3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6d451ce4.html title=熔斷14次！房多多徹底撕開房產平臺暗傷>熔斷14次！房多多徹底撕開房產平臺暗傷</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c78b6d52.html alt=8分鐘看完，徹底掌握Java正則表達式的十大問題 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/14ae145d-0620-476a-8a82-7912b192e9b5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c78b6d52.html title=8分鐘看完，徹底掌握Java正則表達式的十大問題>8分鐘看完，徹底掌握Java正則表達式的十大問題</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/006333f2.html alt=一篇文讓你徹底瞭解java多線程併發 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/fbdb8be32a094b448c052c5058d1d2f2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/006333f2.html title=一篇文讓你徹底瞭解java多線程併發>一篇文讓你徹底瞭解java多線程併發</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6c172832.html alt=一文徹底掌握二叉查找樹，（多組動圖）史上最全總結 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/f9d23b4550d741b8b8c0a156d712f69d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6c172832.html title=一文徹底掌握二叉查找樹，（多組動圖）史上最全總結>一文徹底掌握二叉查找樹，（多組動圖）史上最全總結</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bedd02a9.html alt=Access徹底隱藏表顯示錶 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/3b0200038f286f1db52e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bedd02a9.html title=Access徹底隱藏表顯示錶>Access徹底隱藏表顯示錶</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6c0c417f.html alt=粉絲徹底怒了，T1大樓被緊急關閉！你們不配擁有Faker class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/3522a4f2aeeb479bbc5a1b3a8580232a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6c0c417f.html title=粉絲徹底怒了，T1大樓被緊急關閉！你們不配擁有Faker>粉絲徹底怒了，T1大樓被緊急關閉！你們不配擁有Faker</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c85ab63d.html alt=依靠立法徹底解決二手菸問題？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/02cea07b-7716-45f3-b9a5-efe0f9dd9498 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c85ab63d.html title=依靠立法徹底解決二手菸問題？>依靠立法徹底解決二手菸問題？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d258b9eb.html alt="徹底凍結Android 應用後臺活動 讓他們不耗電、不聯網、不啟動" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/e4fd87bc-b2e5-40e2-841d-2e3dc5f9a2b9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d258b9eb.html title="徹底凍結Android 應用後臺活動 讓他們不耗電、不聯網、不啟動">徹底凍結Android 應用後臺活動 讓他們不耗電、不聯網、不啟動</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/89977530.html alt=一鍵生成文章，徹底告別討厭的形式主義 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/191fe4c4beb143b3b81d5ee01a5d10d9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/89977530.html title=一鍵生成文章，徹底告別討厭的形式主義>一鍵生成文章，徹底告別討厭的形式主義</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/37854077.html alt=文章自動生成器！徹底告別形式主義 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/827d0970b0af4527a6834c4e048a85d0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/37854077.html title=文章自動生成器！徹底告別形式主義>文章自動生成器！徹底告別形式主義</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/97ccf6de.html alt=硬盤數據真能徹底沒了？談數據恢復與徹底刪除 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/4a410007c1a3da476dc2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/97ccf6de.html title=硬盤數據真能徹底沒了？談數據恢復與徹底刪除>硬盤數據真能徹底沒了？談數據恢復與徹底刪除</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>