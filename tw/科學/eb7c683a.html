<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>路由器與交換機的工作原理 | 极客快訊</title><meta property="og:title" content="路由器與交換機的工作原理 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/eb7c683a.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/eb7c683a.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/eb7c683a.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/eb7c683a.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/eb7c683a.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/eb7c683a.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/eb7c683a.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/eb7c683a.html><meta property="article:published_time" content="2020-11-14T20:50:25+08:00"><meta property="article:modified_time" content="2020-11-14T20:50:25+08:00"><meta name=Keywords content><meta name=description content="路由器與交換機的工作原理"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E5%AD%B8/eb7c683a.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>路由器與交換機的工作原理</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E5%AD%B8.html>科學</a></span></div><div class=post-content><p>計算機網絡往往由許多種不同類型的網絡互連連接而成。如果幾個計算機網絡只是在物理上連接在一起，它們之間並不能進行通信，那麼這種“互連”並沒有什麼實際意義。因此通常在談到“互連”時，就已經暗示這些相互連接的計算機是可以進行通信的，也就是說，從功能上和邏輯上看，這些計算機網絡已經組成了一個大型的計算機網絡，或稱為互聯網絡，也可簡稱為互聯網、互連網。<br>將網絡互相連接起來要使用一些中間設備(或中間系統)，ISO的術語稱之為中繼(relay)系統。根據中繼系統所在的層次，可以有以下五種中繼系統：<br>1.物理層(即常說的第一層、層L1)中繼系統，即轉發器(repeater)。<br>2.數據鏈路層(即第二層，層L2)，即網橋或橋接器(bridge)。<br>3.網絡層(第三層，層L3)中繼系統，即路由器(router)。<br>4.網橋和路由器的混合物橋路器(brouter)兼有網橋和路由器的功能。<br>5.在網絡層以上的中繼系統，即網關(gateway).<br>當中繼系統是轉發器時，一般不稱之為網絡互聯，因為這僅僅是把一個網絡擴大了，而這仍然是一個網絡。高層網關由於比較複雜，目前使用得較少。因此一般討論網絡互連時都是指用交換機和路由器進行互聯的網絡。本文主要闡述交換機和路由器及其區別。<br><strong>交換機和路由器</strong><br>“交換”是今天網絡裡出現頻率最高的一個詞，從橋接到路由到ATM直至電話系統，無論何種場合都可將其套用，搞不清到底什麼才是真正的交換。其實交換一詞最早出現於電話系統，特指實現兩個不同電話機之間話音信號的交換，完成該工作的設備就是電話交換機。所以從本意上來講，交換隻是一種技術概念，即完成信號由設備入口到出口的轉發。因此，只要是和符合該定義的所有設備都可被稱為交換設備。由此可見，“交換”是一個涵義廣泛的詞語，當它被用來描述數據網絡第二層的設備時，實際指的是一個橋接設備;而當它被用來描述數據網絡第三層的設備時，又指的是一個路由設備。<br>我們經常說到的以太網交換機實際是一個基於網橋技術的多端口第二層網絡設備，它為數據幀從一個端口到另一個任意端口的轉發提供了低時延、低開銷的通路。<br>由此可見，交換機內部核心處應該有一個交換矩陣，為任意兩端口間的通信提供通路，或是一個快速交換總線，以使由任意端口接收的數據幀從其他端口送出。在實際設備中，交換矩陣的功能往往由專門的芯片(ASIC)完成。另外，以太網交換機在設計思想上有一個重要的假設，即交換核心的速度非常之快，以致通常的大流量數據不會使其產生擁塞，換句話說，交換的能力相對於所傳信息量而無窮大(與此相反，ATM交換機在設計上的思路是，認為交換的能力相對所傳信息量而言有限)。<br>雖然以太網第二層交換機是基於多端口網橋發展而來，但畢竟交換有其更豐富的特性，使之不但是獲得更多帶寬的最好途徑，而且還使網絡更易管理。<br>而路由器是OSI協議模型的網絡層中的分組交換設備(或網絡層中繼設備)，路由器的基本功能是把數據(IP報文)傳送到正確的網絡，包括<br>1.IP數據報的轉發，包括數據報的尋徑和傳送;<br>2.子網隔離，抑制廣播風暴;<br>3.維護路由表，並與其他路由器交換路由信息，這是IP報文轉發的基礎。<br>4.IP數據報的差錯處理及簡單的擁塞控制;<br>5.實現對IP數據報的過濾和記帳。<br>路由器---所謂路由就是指通過相互連接的網絡把信息從源地點移動到目標地點的活動。一般來說，在路由過程中，信息至少會經過一個或多箇中間節點。通常，人們會把路由和交換進行對比，這主要是因為在普通用戶看來兩者所實現的功能是完全一樣的。其實，路由和交換之間的主要區別就是交換髮生在OSI參考模型的第二層(數據鏈路層)，而路由發生在第三層，即網絡層。這一區別決定了路由和交換在移動信息的過程中需要使用不同的控制信息，所以兩者實現各自功能的方式是不同的。<br>交換機---交換(switching)是按照通信兩端傳輸信息的需要，用人工或設備自動完成的方法，把要傳輸的信息送到符合要求的相應路由上的技術統稱。廣義的交換機(switch)就是一種在通信系統中完成信息交換功能的設備。<br>在計算機網絡系統中，交換概念的提出是對於共享工作模式的改進。我們以前介紹過的HUB集線器就是一種共享設備，HUB本身不能識別目的地址，當同一局域網內的A主機給B主機傳輸數據時，數據包在以HUB為架構的網絡上是以廣播方式傳輸的，由每一臺終端通過驗證數據包頭的地址信息來確定是否接收。也就是說，在這種工作方式下，同一時刻網絡上只能傳輸一組數據幀的通訊，如果發生碰撞還得重試。這種方式就是共享網絡帶寬。<br>交換機擁有一條很高帶寬的背部總線和內部交換矩陣。交換機的所有的端口都掛接在這條背部總線上，控制電路收到數據包以後，處理端口會查找內存中的地址對照表以確定目的mac(網卡的硬件地址)的NIC(網卡)掛接在哪個端口上，通過內部交換矩陣迅速將數據包傳送到目的端口，目的MAC若不存在才廣播到所有的端口，接收端口迴應後交換機會“學習”新的地址，並把它添加入內部MAC地址表中。<br>使用交換機也可以把網絡“分段”，通過對照MAC地址表，交換機只允許必要的網絡流量通過交換機。通過交換機的過濾和轉發，可以有效的隔離廣播風暴，減少誤包和錯包的出現，避免共享衝突。<br>交換機在同一時刻可進行多個端口對之間的數據傳輸。每一端口都可視為獨立的網段，連接在其上的網絡設備獨自享有全部的帶寬，無須同其他設備競爭使用。當節點A向節點D發送數據時，節點B可同時向節點C發送數據，而且這兩個傳輸都享有網絡的全部帶寬，都有著自己的虛擬連接。假使這裡使用的是10Mbps的以太網交換機，那麼該交換機這時的總流通量就等於2×10Mbps=20Mbps，而使用10Mbps的共享式HUB時，一個HUB的總流通量也不會超出10Mbps。<br>總之，交換機是一種基於MAC地址識別，能完成封裝轉發數據包功能的網絡設備。交換機可以“學習”MAC地址，並把其存放在內部地址表中，通過在數據幀的始發者和目標接收者之間建立臨時的交換路徑，使數據幀直接由源地址到達目的地址<br>說明二層交換機、三層交換機和路由器的基本工作原理和三者之間的主要區別。<br><strong>1.二層交換技術</strong><br>二層交換機是數據鏈路層的設備，它能夠讀取數據包中的MAC地址信息並根據MAC地址來進行交換。<br>交換機內部有一個地址表，這個地址表標明瞭MAC地址和交換機端口的對應關係。當交換機從某個端口收到一個數據包，它首先讀取包頭中的源MAC地址，這樣它就知道源MAC地址的機器是連在哪個端口上的，它再去讀取包頭中的目的MAC地址，並在地址表中查找相應的端口，如果表中有與這目的MAC地址對應的端口，則把數據包直接複製到這端口上，如果在表中找不到相應的端口則把數據包廣播到所有端口上，當目的機器對源機器迴應時，交換機又可以學習一目的MAC地址與哪個端口對應，在下次傳送數據時就不再需要對所有端口進行廣播了。<br>二層交換機就是這樣建立和維護它自己的地址表。由於二層交換機一般具有很寬的交換總線帶寬，所以可以同時為很多端口進行數據交換。如果二層交換機有N個端口，每個端口的帶寬是M，而它的交換機總線帶寬超過N×M，那麼這交換機就可以實現線速交換。二層交換機對廣播包是不做限制的，把廣播包複製到所有端口上。<br>二層交換機一般都含有專門用於處理數據包轉發的ASIC (Application specific Integrated Circuit)芯片，因此轉發速度可以做到非常快。<br><strong>2.路由技術</strong><br>路由器是在OSI七層網絡模型中的第三層——網絡層操作的。<br>路由器內部有一個路由表，這表標明瞭如果要去某個地方，下一步應該往哪走。路由器從某個端口收到一個數據包，它首先把鏈路層的包頭去掉(拆包)，讀取目的IP地址，然後查找路由表，若能確定下一步往哪送，則再加上鏈路層的包頭(打包)，把該數據包轉發出去;如果不能確定下一步的地址，則向源地址返回一個信息，並把這個數據包丟掉。<br>路由技術和二層交換看起來有點相似，其實路由和交換之間的主要區別就是交換髮生在OSI參考模型的第二層(數據鏈路層)，而路由發生在第三層。這一區別決定了路由和交換在傳送數據的過程中需要使用不同的控制信息，所以兩者實現各自功能的方式是不同的。<br>路由技術其實是由兩項最基本的活動組成，即決定最優路徑和傳輸數據包。其中，數據包的傳輸相對較為簡單和直接，而路由的確定則更加複雜一些。路由算法在路由表中寫入各種不同的信息，路由器會根據數據包所要到達的目的地選擇最佳路徑把數據包發送到可以到達該目的地的下一臺路由器處。當下一臺路由器接收到該數據包時，也會查看其目標地址，並使用合適的路徑繼續傳送給後面的路由器。依次類推，直到數據包到達最終目的地。<br>路由器之間可以進行相互通訊，而且可以通過傳送不同類型的信息維護各自的路由表。路由更新信息主是這樣一種信息，一般是由部分或全部路由表組成。通過分析其它路由器發出的路由更新信息，路由器可以掌握整個網絡的拓撲結構。鏈路狀態廣播是另外一種在路由器之間傳遞的信息，它可以把信息發送方的鏈路狀態及進的通知給其它路由器。<br><strong>3.三層交換技術</strong><br>一個具有第三層交換功能的設備是一個帶有第三層路由功能的第二層交換機，但它是二者的有機結合，並不是簡單的把路由器設備的硬件及軟件簡單地疊加在局域網交換機上。<br>從硬件上看，第二層交換機的接口模塊都是通過高速背板/總線(速率可高達幾十Gbit/s)交換數據的，在第三層交換機中，與路由器有關的第三層路由硬件模塊也插接在高速背板/總線上，這種方式使得路由模塊可以與需要路由的其他模塊間高速的交換數據，從而突破了傳統的外接路由器接口速率的限制。在軟件方面，第三層交換機也有重大的舉措，它將傳統的基於軟件的路由器軟件進行了界定。<br>其做法是：<br>對於數據包的轉發：如IP/IPX包的轉發，這些規律的過程通過硬件得以高速實現。<br>對於第三層路由軟件：如路由信息的更新、路由表維護、路由計算、路由的確定等功能，用優化、高效的軟件實現。<br>假設兩個使用IP協議的機器通過第三層交換機進行通信的過程，機器A在開始發送時，已知目的IP地址，但尚不知道在局域網上發送所需要的MAC地址。要採用地址解析(ARP)來確定目的MAC地址。機器A把自己的IP地址與目的IP地址比較，從其軟件中配置的子網掩碼提取出網絡地址來確定目的機器是否與自己在同一子網內。若目的機器B與機器A在同一子網內，A廣播一個ARP請求，B返回其MAC地址，A得到目的機器B的MAC地址後將這一地址緩存起來，並用此MAC地址封包轉發數據，第二層交換模塊查找MAC地址表確定將數據包發向目的端口。若兩個機器不在同一子網內，如發送機器A要與目的機器C通信，發送機器A要向“缺省網關”發出ARP包，而“缺省網關”的IP地址已經在系統軟件中設置。這個IP地址實際上對應第三層交換機的第三層交換模塊。所以當發送機器A對“缺省網關”的IP地址廣播出一個ARP請求時，若第三層交換模塊在以往的通信過程中已得到目的機器C的MAC地址，則向發送機器A回覆C的MAC地址;否則第三層交換模塊根據路由信息向目的機器廣播一個ARP請求，目的機器C得到此ARP請示後向第三層交換模塊回覆其MAC地址，第三層交換模塊保存此地址並回復給發送機器A。以後，當再進行A與C之間數據包轉發進，將用最終的目的機器的MAC地址封裝，數據轉發過程全部交給第二層交換處理，信息得以高速交換。既所謂的一次選路，多次交換。<br>第三層交換具有以下突出特點<br>有機的硬件結合使得數據交換加速;<br>優化的路由軟件使 得路由過程效率提高;<br>除了必要的路由決定過程外，大部分數據轉發過程由第二層交換處理;<br>多個子網互連時只是與第三層交換模塊的邏輯連接，不象傳統的外接路由器那樣需增加端口，保護了用戶的投資。<br><strong>1、交換機的定義</strong><br>局域網交換機擁有許多端口，每個端口有自己的專用帶寬，並且可以連接不同的網段。交換機各個端口之間的通信是同時的、並行的，這就大大提高了信息吞吐量。為了進一步提高性能，每個端口還可以只連接一個設備。<br>為了實現交換機之間的互連或與高檔服務器的連接，局域網交換機一般擁有一個或幾個高速端口，如100MB以太網端口、FDDI端口或155MB ATM端口，從而保證整個網絡的傳輸性能。<br><strong>2、交換機的特性</strong><br>通過集線器共享局域網的用戶不僅是共享帶寬，而且是競爭帶寬。可能由於個別用戶需要更多的帶寬而導致其他用戶的可用帶寬相對減少，甚至被迫等待，因而也就耽誤了通信和信息處理。利用交換機的網絡微分段技術，可以將一個大型的共享式局域網的用戶分成許多獨立的網段，減少競爭帶寬的用戶數量，增加每個用戶的可用帶寬，從而緩解共享網絡的擁擠狀況。由於交換機可以將信息迅速而直接地送到目的地能大大提高速度和帶寬，能 保護用戶以前在介質方面的投資，並提供良好的可擴展性，因此交換機不但是網橋的理想替代物，而且是集線器的理想替代物。<br>與網橋和集線器相比，交換機從下面幾方面改進了性能：<br>(1)通過支持並行通信，提高了交換機的信息吞吐量。<br>(2)將傳統的一個大局域網上的用戶分成若干工作組，每個端口連接一臺設備 或連接一個工作組，有效地解決擁擠現像。這種方法人們稱之為網絡微分 段(Micro一segmentation)技術。<br>(3)虛擬網(VirtuaI LAN)技術的出現，給交換機的使用和管理帶來了更大 的靈活性。我們將在後面專門介紹虛擬網。<br>(4)端口密度可以與集線器相媲美,一般的網絡系統都是有一個或幾個服務器，而絕大部分都是普通的客戶機。客戶機都需要訪問服務器，這樣就導致服務器的通信和事務處理能力成為整個網絡性能好壞的關鍵。<br>交換機就主要從提高連接服務器的端口的速率以及相應的幀緩衝區的大小，來提高整個網絡的性能，從而滿足用戶的要求。一些高檔的交換機還採用全雙工技術進一步提高端口的帶寬。以前的網絡設備基本上都是採用半雙工的工作方式，即當一臺主機發送數據包的時候， 它就不能接收數據包，當接收數據包的時候，就不能發送數據包。由於採用全雙工技術，即主機在發送數據包的同時，還可以接收數據包，普通的10M端口就可以變成20M端口，普通的100M端口就可以變成200M 端口，這樣就進一步提高了信息吞吐量。<br><strong>3、交換機的工作原理</strong><br>傳統的交換機本質上是具有流量控制能力的多端口網橋，即傳統的(二層) 交換機。把路由技術引入交換機，可以完成網絡層路由選擇，故稱為三層交換，這是交換機的新進展。交換機(二層交換)的工作原理交換機和網橋一樣，是工作在鏈路層的聯網設備，它的各個端口都具有橋接功能，每個端口可以連接一個LAN或一臺高性能網站或服務器，能夠通過自學習來了解每個端口的設備連接情況。所有端口由專用處理器進行控制，並經過控制管理總線轉發信息。<br>同時可以用專門的網管軟件進行集中管理。 除此之外，交換機為了提高數據交換的速度和效率，一般支持多種方式。<br>(1)存儲轉發<br>所有常規網橋都使用這種方法。它們在將數據幀發柱其他端口之前，要把收到的幀完全存儲在內部的存儲器中，對其檢驗後再發往其他端口，這樣其延時等於接收一個完整的數據幀的時間及處理時間的總和。如果級聯很長時，會導致嚴重的性能問題，但這種方法可以過濾掉錯誤的數據幀。<br>(2)切入法：<br>這種方法只檢驗數據幀的目標地址，這使得數據幀幾乎馬上就 可以傳出去，從而大大降低延時。<br>其缺點是：錯誤幀也會被傳出去。錯誤幀的概率較小的情況下，可以採用切入法以提高傳輸速度。而錯誤幀的概率較大的情況下，可以採用存儲轉發法/以減少錯誤幀的重傳。<br><strong>4、交換機的配置</strong><br>我們下面以Cisco公司的Catlystl900交換機為例，介紹交換機的一般配置過程。<br>對一臺新的Catlystl900交換機，使用它的缺省配置就可以工作了。這因為它是一種將軟件裝在FlashMemory中的硬件設備，當加電時，它首先要進行一系列自檢，對所有端口進行測試之後，交換機就處於工作狀態。這時它的交換表是空的，它可以通過自學習來了解各個端口的設備連接情況，並將設備的 MAC地址記錄在交換表中，當有信息交換時，交換機就根據交換表來進行數據轉發。<br>但為了便於對它進行網絡管理，Catlystl900交換機自己有一個MAC地址，這樣就可以為它分配一個IP地址和屏蔽碼。網絡管理員須通過交換機的串口接一臺終端或仿真終端，才能為它指定一個IP地址，其缺省值是0.0.0.0。指定IP地址以後，網絡管理員就可以通過網絡進行遠程管理了。Catlystl900交換機的配置界面是菜單形式，缺省配置下，它的所有端口都屬於同一個VLAN，很多情況下都不需要作什麼修改。<br>(1)將微機串口通過RS一232電纜與Cata1yst1900的Console口連接，運行仿真終端軟件，Catalyst 1900 啟動後。<br>(2)回車後，進入主菜單。<br>(3)按“S”鍵，進入系統配置菜單：(配置系統名，位置，日期)。<br>(4)在主菜單中按“N”鍵進入網絡管理菜單。<br>(5)配置IP地置。<br>(6)配置SNMP參數。<br><strong>5、交換機的種類</strong><br>交換機是數據鏈路層設備，它可將多個物理LAN網段連接到一個大型網絡上，與網絡類似交換機傳輸和溢出也是基於MAC地址的傳輸。由於交換機是用硬件實現的，因此，傳輸速度很快。傳輸數據包時，交換機要麼使用存儲---轉發交換方式，要麼使用斷---通交換方式。目前有許多類型的交換機，其中包括ATM交換機，LAN交換機和不同類型的WAN交換機。<br><strong>ATM交換機</strong><br>ATM(Asynchronous Transfer Mode)交換機為工作組，企業網絡中樞以及其它眾多領域提供了高速交換信息和可伸縮帶寬的能力。ATM交換機支持語音，視頻和文本數據應用，並可用來交換固定長度的信息單位(有時也稱元素)。企業網絡是通過ATM中樞鏈路連接多個LAN組成的。<br>局域網交換機<br>LAN交換機用於多LAN網段的相互連接，它在網絡設備之間進行專用的無衝突的通信，同時支持多個設備間的對話。LAN交換機主要是用於高速交換數據幀。通過LAN交換機將一個0Mbps以太網與一個100Mbps 以太網互聯。<br><strong>路由器工作原理</strong><br>傳統地，路由器工作於OSI七層協議中的第三層，其主要任務是接收來自一個網絡接口的數據包，根據其中所含的目的地址，決定轉發到下一個目的地址。因此，路由器首先得在轉發路由表中查找它的目的地址，若找到了目的地址，就在數據包的幀格前添加下一個MAC地址，同時IP數據包頭的TTL(Time To Live)域也開始減數，並重新計算校驗和。當數據包被送到輸出端口時，它需要按順序等待，以便被傳送到輸出鏈路上。<br>路由器在工作時能夠按照某種路由通信協議查找設備中的路由表。如果到某一特定節點有一條以上的路徑，則基本預先確定的路由準則是選擇最優(或最經濟)的傳輸路徑。由於各種網絡段和其相互連接情況可能會因環境變化而變化，因此路由情況的信息一般也按所使用的路由信息協議的規定而定時更新。<br>網絡中，每個路由器的基本功能都是按照一定的規則來動態地更新它所保持的路由表，以便保持路由信息的有效性。為了便於在網絡間傳送報文，路由器總是先按照預定的規則把較大的數據分解成適當大小的數據包，再將這些數據包分別通過相同或不同路徑發送出去。當這些數據包按先後秩序到達目的地後，再把分解的數據包按照一定順序包裝成原有的報文形式。路由器的分層尋址功能是路由器的重要功能之一，該功能可以幫助具有很多節點站的網絡來存儲尋址信息，同時還能在網絡間截獲發送到遠地網段的報文，起轉發作用;選擇最合理的路由，引導通信也是路由器基本功能;多協議路由器還可以連接使用不同通信協議的網絡段，成為不同通信協議網絡段之間的通信平臺。<br>一般來說，路由器的主要工作是對數據包進行存儲轉發，具體過程如下：<br>第一步：當數據包到達路由器，根據網絡物理接口的類型，路由器調用相應的鏈路層功能模塊，以解釋處理此數據包的鏈路層協議報頭。這一步處理比較簡單，主要是對數據的完整性進行驗證，如CRC校驗、幀長度檢查等。<br>第二步：在鏈路層完成對數據幀的完整性驗證後，路由器開始處理此數據幀的IP層。這一過程是路由器功能的核心。根據數據幀中IP包頭的目的IP地址，路由器在路由表中查找下一跳的IP地址;同時，IP數據包頭的TTL(Time To Live)域開始減數，並重新計算校驗和(Checksum)。<br>第三步：根據路由表中所查到的下一跳IP地址，將IP數據包送往相應的輸出鏈路層，被封裝上相應的鏈路層包頭，最後經輸出網絡物理接口發送出去。<br>簡單地說，路由器的主要工作就是為經過路由器的每個數據包尋找一條最佳傳輸路徑，並將該數據包有效地傳送到目的站點。由此可見，選擇最佳路徑策略或叫選擇最佳路由算法是路由器的關鍵所在。為了完成這項工作，在路由器中保存著各種傳輸路徑的相關數據——路由表(Routing Table)，供路由選擇時使用。上述過程描述了路由器的主要而且關鍵的工作過程，但沒有說明其它附加性能，例如訪問控制、網絡地址轉換、排隊優先級等。<br>ARP全稱 地址解析協議在局域網內信息是以幀傳輸的。要記住地址就要有一個ARP緩存表，大概是幾分鐘刷新一次我忘記了。保存的就是當前局域網內與你連接的機器的IP和MAC的地址。ARP—a就可以查看到這個表。第一個是IP。第二個是網卡地址。第三個是連接類型。<br><strong>交換機如何學習MAC地址的？</strong><br>假設一個交換機剛剛啟動，MAC表完全是空的，局域網內有兩臺主機PC1和PC2，IP地址為192.168.0.1和192.168.0.2：那麼交換機接到1端口的PC1的第一個數據幀，因為PC1只知道PC2的IP地址而不知道PC2的MAC地址，所以源IP地址為192.168.0.1源MAC地址是0000-0000-0001，目標IP地址為192.168.0.2而目標MAC地址是FFFF-FFFF-FFFF(此報文為ARP請求報文，是二層廣播報問)，交換機首先將源MAC地址和相對應的端口記錄在MAC表中，然後把這個數據幀從所有活動的端口轉發出去，;假設PC2在2端口接收到數據幀對數據進行迴應時，則目標MAC地址為0000-0000-0001源MAC地址為0000-0000-0002。此時交換機收到數據幀後，首先學習PC2的MAC地址和對應端口到MAC表，然後查找MAC地址表中是否有PC1的MAC地址，發現目標MAC地址對應端口1，則將此數據幀由交換機的1端口轉發出去。此時PC1和PC2的MAC地址都已記錄在交換機MAC表中，數據在開始正常轉發。所以，交換機在轉發數據幀的過程，就是查找目標MAC地址，學習源地址的過程，希望能理解!</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>交換機</a></li><li><a>路由器</a></li><li><a>原理</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/361e99f.html alt=交換機的工作原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/361e99f.html title=交換機的工作原理>交換機的工作原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4adca96d.html alt=不鏽鋼旋轉樓梯—不鏽鋼旋轉樓梯的原理和尺寸介紹 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1532917894689e20edadba9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4adca96d.html title=不鏽鋼旋轉樓梯—不鏽鋼旋轉樓梯的原理和尺寸介紹>不鏽鋼旋轉樓梯—不鏽鋼旋轉樓梯的原理和尺寸介紹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/798c35eb.html alt=鼠標滾輪工作原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a32f01002df34196a3ca95824a0705c9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/798c35eb.html title=鼠標滾輪工作原理>鼠標滾輪工作原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0fe7a863.html alt=土壤採樣器的工作原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/3591b04ce0ef4b24b7f04dcf6d4f0e5a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0fe7a863.html title=土壤採樣器的工作原理>土壤採樣器的工作原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1c9afde0.html alt="一起來談談ThreadLocal 原理吧！你需要了解！" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/499a403f2b63464db8e3e12298c1a3e5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1c9afde0.html title="一起來談談ThreadLocal 原理吧！你需要了解！">一起來談談ThreadLocal 原理吧！你需要了解！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/203dfed4.html alt=和麵機的原理及運用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1bd01e6484624601ae66ef141b0cdbd7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/203dfed4.html title=和麵機的原理及運用>和麵機的原理及運用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2537ec20.html alt=和麵機的工作原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/01f3205782f045a2a5aec20d70b9efc8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2537ec20.html title=和麵機的工作原理>和麵機的工作原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4ac331a0.html alt=功率因素表的工作原理及接線方式 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/470a0003e8a9a1d2d829 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4ac331a0.html title=功率因素表的工作原理及接線方式>功率因素表的工作原理及接線方式</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/504d903f.html alt=疊加原理及其應用（第1集） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/504d903f.html title=疊加原理及其應用（第1集）>疊加原理及其應用（第1集）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b9eda782.html alt=製冷原理和製冷循環原理，製冷劑在循環中什麼狀態？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/304eeaadf64047798a7c26b9d06a7987 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b9eda782.html title=製冷原理和製冷循環原理，製冷劑在循環中什麼狀態？>製冷原理和製冷循環原理，製冷劑在循環中什麼狀態？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bd0589ca.html alt=溼式報警閥組工作原理及火警聯動 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/54f715f0f1cf45ec93d3be6f2e77be54 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bd0589ca.html title=溼式報警閥組工作原理及火警聯動>溼式報警閥組工作原理及火警聯動</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1d18ac0b.html alt=你不一定知道的工程打樁機的種類及工作原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/882fb864bd2f476093b3d723dae73249 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1d18ac0b.html title=你不一定知道的工程打樁機的種類及工作原理>你不一定知道的工程打樁機的種類及工作原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d0e82f0c.html alt=打樁基的種類及工作原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b68907eaa7fb4c3f8929cd20c2d34655 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d0e82f0c.html title=打樁基的種類及工作原理>打樁基的種類及工作原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b297e72b.html alt=PVC混料的作用與原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b297e72b.html title=PVC混料的作用與原理>PVC混料的作用與原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1111cfff.html alt=「基礎1」交換機端口鏈路類型介紹 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/c9a8c0c5c9004d65ad879d1ac6001ba8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1111cfff.html title=「基礎1」交換機端口鏈路類型介紹>「基礎1」交換機端口鏈路類型介紹</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>