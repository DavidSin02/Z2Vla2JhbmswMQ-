<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>VLOOKUP說他是最強的，LOOKUP表示不服 | 极客快訊</title><meta property="og:title" content="VLOOKUP說他是最強的，LOOKUP表示不服 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/321c000324abe52b29e1"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/f7759d3.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/f7759d3.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/f7759d3.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/f7759d3.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/f7759d3.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/f7759d3.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/f7759d3.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/f7759d3.html><meta property="article:published_time" content="2020-10-29T21:03:51+08:00"><meta property="article:modified_time" content="2020-10-29T21:03:51+08:00"><meta name=Keywords content><meta name=description content="VLOOKUP說他是最強的，LOOKUP表示不服"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E5%AD%B8/f7759d3.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>VLOOKUP說他是最強的，LOOKUP表示不服</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E5%AD%B8.html>科學</a></span></div><div class=post-content><div><p><img alt=VLOOKUP說他是最強的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/321c000324abe52b29e1></p><p class=pgc-img-caption>圖\文 | 朱莉</p><p>說起查找與引用函數，大家最熟悉的莫過於VLOOKUP了。其實它一個家族中的另一個兄弟，LOOKUP函數比它的功能更為強大，想要更好的處理數據的查找與引用，千萬不要錯過它！<br></p><h1><strong>01、</strong><strong>LOOKUP函數語法</strong></h1><p>LOOKUP函數的語法有兩種：</p><p><strong>1、向量式：</strong></p><p>向量式是使用的更多的一種形式：</p><p>第一參數是要查找的值；</p><p>第二參數為一行或者一列，是被查找的區域。</p><p>第三參數是返回哪行或者哪列的結果，這裡第三參數要求與第二參數有一樣的尺寸。</p><p>比如第二參數是一列，B2到B5，第三參數是C1到C6，這樣就是不可以的。</p><p><img alt=VLOOKUP說他是最強的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/321c000324ac05fbefb2></p><p><strong>2、數組式：</strong></p><p>=LOOKUP(lookup_value,array)</p><p>第二參數array, 是一個多行多列的區域。<strong>這個區域的首列須包含要查找的值，返回對應最後一列的值。</strong></p><p>這兩種方式，有的時候可以實現相同的功能，區別只是寫法不同； 也有的功能只能用其中一種的寫法。下面用栗子來給大家詳細展現。</p><h1><strong>02、</strong><strong>LOOKUP模糊查找</strong></h1><p><strong>個人所得稅稅率查詢：</strong></p><p>（模糊匹配，類似VLOOKUP）</p><p>應納稅的工資（減去3500之後），查找應使用的稅率時，沒有完全一樣的數值，將<strong>返回小於它的最大值</strong>。</p><p>F2單元格中的公式為（向量式）：</p><p>=LOOKUP(E2,$A$2:$A$5,$C$2:$C$5)</p><p>$A$2:$A$5 是要查找的區域；</p><p>$C$2:$C$5 是對應返回的結果。</p><p>例子中工資5000在左邊的表格中找不到，將返回小於它的最大值，也就是4500對應的結果，20%（虛構數值，僅供參考）。</p><p><img alt=VLOOKUP說他是最強的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/321c00032856eeaa5dc5></p><p>這個例子中，還可以使用數組的方式，結果是一樣的：</p><p>=LOOKUP(E2,$A$2:$C$5)</p><p><img alt=VLOOKUP說他是最強的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/321c000324ad7199deb2></p><p><strong>注意：在用LOOKUP進行模糊匹配的查詢時，第二參數須以升序排列。</strong></p><h1><strong>03、</strong><strong>LOOKUP反向查找</strong></h1><p>由於LOOKUP函數向量式的寫法中，被查找的區域，和結果返回的區域是分開寫的，所以可以應用在，要返回的結果在被查找區域之前的情況。</p><p>例如，知道員工工號的情況下，要在左邊的表中查找員工的姓名。</p><p><img alt=VLOOKUP說他是最強的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/32260002fdd574c0ba81></p><p>E2中的公式為：</p><p>=LOOKUP(D2,$B$2:$B$8,$A$2:$A$8)</p><p>B2至B8是要查找的區域，返回A2至A8對應的結果。</p><p>需要注意的是，LOOKUP函數默認在找不到完全一致的值時，會按模糊匹配來處理，返回一個接近的值（小於它的最大值對應的結果）。</p><p>所以，如果要查找的值，可能在被查找區域不存在，又需要精確匹配時，不要使用這種方式。</p><h1><strong>04、</strong><strong>條件查詢</strong></h1><p>0/條件 其實是一大類用法的總結。</p><p>公式寫作：</p><p><strong>=LOOKUP(1,0/(條件),目標區域或數組)</strong></p><p>這裡的“條件”可以是多種多樣的。我們可以根據不同的需求，構建不同的“條件”。利用“<strong>0除以任何數都得0</strong>”和“<strong>0除以錯誤值還是錯誤值</strong>”的原理，得到一串0和錯誤值組成的數組。</p><p>我們要找的是“1”，在找不到“1”時，返回最後一個“0”對應的值。（LOOKUP自動屏蔽錯誤值）</p><p>“條件”如何構建，決定能發揮怎樣的作用。下面幾種常見用法的舉例。</p><p><strong>①</strong> <strong>求同一值最後一次出現的情況：</strong></p><p>我們想求某值最後一次出現的結果<strong>，可以先通過使用一個條件，將出現這個值的情況挑選出來。</strong></p><p><img alt=VLOOKUP說他是最強的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/32260002fdd74f16e44d></p><p>這個例子中用到的“條件”就是：</p><p>=FIND(E3,$B$3:$B$11)</p><p><strong>這個FIND函數的作用是，在B3到B11區域中，挨個單元格去查找，E3的值在這個單元格中的位置。</strong></p><p>E3中是“張三”，B3中“張三”是從第一個字符開始的，所以返回1.</p><p>同理，B4和B5都會返回1。在找不到我們要的結果的時候，會返回錯誤值：#VALUE!.</p><p>也就是，<strong>符合條件時會返回一個非零數字，不符合條件時會返回錯誤值。</strong></p><p>所以剛才的“條件”就會得到：</p><p>=FIND(E3,$B$3:$B$11)</p><p>={1,1,1,#VALUE!,#VALUE!,#VALUE!,#VALUE!,#VALUE!,#VALUE!}</p><p>=0/FIND(E3,$B$3:$B$11)</p><p>={0,0,0,#VALUE!,#VALUE!,#VALUE!,#VALUE!,#VALUE!,#VALUE!}</p><p>錯誤值會被LOOKUP函數排除掉，剩下就是在符合條件的值中進行運算。</p><p>最原始的公式就會變成：</p><p>=LOOKUP(1,0/FIND(E3,$B$3:$B$11),$C$3:$C$11)</p><p>=LOOKUP(1,{0,0,0},$C$3:$C$11)</p><p>由於我們要找1，而查找區域只有0，找不到1時，會返回最後一個0對應的結果。這個案例中就是第3個0對應的值，也就是B5單元格對應的結果C5。</p><p>總結一下0/[條件]的用法就是，通過構建一個“條件”，所有符合條件的值返回一個非零數字， 不符合條件的值返回一個錯誤值。</p><p>此案例中，“條件”同樣可以用別的方式來構建。</p><p>比如：</p><p>=LOOKUP(1,0/<strong>($B$3:$B$11=E3)</strong>,$C$3:$C$11)</p><p>這個公式中：</p><p>$B$3:$B$11=E3，作為一個判斷條件，當單元格等於E3時返回TRUE（1）,不等於時返回FALSE(0)。這些結果被0除以後，得到跟前面一樣的數組。</p><p>{0,0,0,#VALUE!,#VALUE!,#VALUE!,#VALUE!,#VALUE!,#VALUE!}</p><p><strong>② 多條件查找：</strong></p><p>多條件查找其實就是上面公式的一個變種。</p><p>寫作：</p><p><strong>=LOOKUP(1,0/((條件1)*(條件2)*……*(條件N)),目標區域）</strong></p><p>多個條件之間使用乘號連接，表示當列出的條件同時滿足時的結果。如果有多個行出現同時滿足條件，則返回最後一個。</p><p>下面這個例子中，我們需要班級和姓名兩個條件同時滿足時，對應的結果。</p><p><img alt=VLOOKUP說他是最強的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/321c000324af029851f6></p><p>I2中的公式為：</p><p>=LOOKUP(1,0/(($B$3:$B$8=F3)*($C$3:$C$8=G3)),$D$3:$D$8)</p><p>這兩個條件分別是：</p><p>B3到B8中等於F3，和C3到C8中等於G3。</p><p>同時滿足時，將返回D3到D8對應的結果。</p><p><strong>③ 某列最後一個值（非空單元格）：</strong></p><p>下面表格中，記錄了顧客每個月到店的次數。現在我們要統計每個顧客最後一次到店的時間。</p><p><img alt=VLOOKUP說他是最強的，LOOKUP表示不服 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/32260003029fba6b700e></p><p>B15單元格中的公式為：</p><p>=LOOKUP(1,0/<strong>(B3:B14&lt;>"")</strong>,$A$3:$A$14)</p><p>其中，</p><p>B3:B14&lt;>"" 表示B3到B14不為空的單元格。滿足條件為TRUE（1），不滿足為FALSE（0）。原理跟上面的相同。</p><p>最後一個不是空的單元格是B10，對應返回結果A10，也就是2016年8月。</p><p>公式向右複製，第二參數B3:B14是相對引用，會向右跟著改變。第三參數$A$3:$A$14為絕對引用，無論公式複製到哪，都會返回這一列中的內容。</p><blockquote><p>關於LOOKUP函數的原理，到目前為止我相信已經夠大家套用公式來使用了。如果想進一步瞭解它查找的原理，需要了解二分法的原理。</p></blockquote><p><strong>-END-</strong></p><blockquote><p><strong>作者：</strong>安偉星，微軟Office認證大師，領英中國專欄作者，《競爭力：玩轉職場Excel，從此不加班》圖書作者。</p></blockquote></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>VLOOKUP</a></li><li><a>最強</a></li><li><a>LOOKUP</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/11182ecf.html alt=史上最強虹吸溢流，恆定水位不開孔改底濾的福音！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1851b5ed1cf54db3ae191d3e69a77bc3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/11182ecf.html title=史上最強虹吸溢流，恆定水位不開孔改底濾的福音！>史上最強虹吸溢流，恆定水位不開孔改底濾的福音！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/efac688d.html alt=被內飾毀掉的歐藍德：擁最強四驅，三種扭矩分配，性價比也夠高了 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9ba8c34dc58145e9942dc6555ccc901e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/efac688d.html title=被內飾毀掉的歐藍德：擁最強四驅，三種扭矩分配，性價比也夠高了>被內飾毀掉的歐藍德：擁最強四驅，三種扭矩分配，性價比也夠高了</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/408d3387.html alt=EXCEL:VLOOKUP函數綜合運用，實現供應商每月數據自動查詢 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/03e79d133c994f9f8a386b20b04b3da1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/408d3387.html title=EXCEL:VLOOKUP函數綜合運用，實現供應商每月數據自動查詢>EXCEL:VLOOKUP函數綜合運用，實現供應商每月數據自動查詢</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b74be616.html alt=VLOOKUP多列求和 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/153176249716393f5fb0e37 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b74be616.html title=VLOOKUP多列求和>VLOOKUP多列求和</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7d65aa7b.html alt=全網最強軍工股，13連陽逆勢漲停20.04%！後市何去何從？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/76ac70f31cde4c3f8b3f073b28660a91 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7d65aa7b.html title=全網最強軍工股，13連陽逆勢漲停20.04%！後市何去何從？>全網最強軍工股，13連陽逆勢漲停20.04%！後市何去何從？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3e1e20c8.html alt=遇到危險怎麼辦？最強女性自我保護指南 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3e1e20c8.html title=遇到危險怎麼辦？最強女性自我保護指南>遇到危險怎麼辦？最強女性自我保護指南</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/373b86f7.html alt=EXCEL微課堂：LOOKUP函數查詢一列一行中的最後一個單元格內容 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1540356248901cd51434f5d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/373b86f7.html title=EXCEL微課堂：LOOKUP函數查詢一列一行中的最後一個單元格內容>EXCEL微課堂：LOOKUP函數查詢一列一行中的最後一個單元格內容</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/162f6d2d.html alt=國產最強125，豪爵DK125S，高製作工藝，成熟TSR發動機是最大亮點 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/43352e8478ed4b13bfc4f92767f827dc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/162f6d2d.html title=國產最強125，豪爵DK125S，高製作工藝，成熟TSR發動機是最大亮點>國產最強125，豪爵DK125S，高製作工藝，成熟TSR發動機是最大亮點</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/df513ed2.html alt=全球十大最強現役航母 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/50e9bf7eeb054b05b13f919c515b9fbf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/df513ed2.html title=全球十大最強現役航母>全球十大最強現役航母</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/45385682.html alt=大腦：最原始、最強大的存儲器？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/Rmdbiqu5GXppZP style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/45385682.html title=大腦：最原始、最強大的存儲器？>大腦：最原始、最強大的存儲器？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f5380d83.html alt=「工程技術」地下連續強最強總結 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/741804d9fdd341259b0697448b54595c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f5380d83.html title=「工程技術」地下連續強最強總結>「工程技術」地下連續強最強總結</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8cdaee5d.html alt=王者榮耀單挑誰最強？典韋貂蟬上榜，第一名上場率極低 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/e00cbe656fef4d28905225c764b4880d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8cdaee5d.html title=王者榮耀單挑誰最強？典韋貂蟬上榜，第一名上場率極低>王者榮耀單挑誰最強？典韋貂蟬上榜，第一名上場率極低</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6d3445ec.html alt=王者榮耀：單挑誰最強？除了呂布，我只服他們四個！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/c3cf49758ae0453d8b389459192a89c9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6d3445ec.html title=王者榮耀：單挑誰最強？除了呂布，我只服他們四個！>王者榮耀：單挑誰最強？除了呂布，我只服他們四個！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/00950bdd.html alt="重排NBA現役單挑最強的5大球星，字母哥墊底 萊昂納德第3" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ef4f648c532f4d7e91ecad825be93505 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/00950bdd.html title="重排NBA現役單挑最強的5大球星，字母哥墊底 萊昂納德第3">重排NBA現役單挑最強的5大球星，字母哥墊底 萊昂納德第3</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/97d888e5.html alt=科學家最新研製世界上最強大的激光器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/46ce00054201192b2385 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/97d888e5.html title=科學家最新研製世界上最強大的激光器>科學家最新研製世界上最強大的激光器</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>