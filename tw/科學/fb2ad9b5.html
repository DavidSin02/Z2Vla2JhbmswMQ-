<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>支持向量機算法如何調參（有哪些參數可調，調參總結） | 极客快訊</title><meta property="og:title" content="支持向量機算法如何調參（有哪些參數可調，調參總結） - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/fb2ad9b5.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/fb2ad9b5.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/fb2ad9b5.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/fb2ad9b5.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/fb2ad9b5.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/fb2ad9b5.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/fb2ad9b5.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/fb2ad9b5.html><meta property="article:published_time" content="2020-10-29T21:13:00+08:00"><meta property="article:modified_time" content="2020-10-29T21:13:00+08:00"><meta name=Keywords content><meta name=description content="支持向量機算法如何調參（有哪些參數可調，調參總結）"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E5%AD%B8/fb2ad9b5.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>支持向量機算法如何調參（有哪些參數可調，調參總結）</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E5%AD%B8.html>科學</a></span></div><div class=post-content><p>我們構造svm模型的時候是有如下的參數可以設置的。</p><p>SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,</p><p>decision_function_shape='ovr', degree=3, gamma='auto', kernel='rbf',</p><p>max_iter=-1, probability=False, random_state=None, shrinking=True,</p><p>tol=0.001, verbose=False)</p><p>我們先來看一下這些參數的含義：</p><p>（1）C: 目標函數的懲罰係數C，用來平衡分類間隔margin和錯分樣本的，default C = 1.0；</p><p>（2）kernel：參數選擇有RBF（高斯核）, Linear（線性核函數）, Poly（多項式核函數）, Sigmoid（sigmoid核函數）, 默認的是"RBF";</p><p>（3）degree：如果kernel使用多項式核函數, degree決定了多項式的最高次冪；</p><p>（4）gamma：核函數的係數('Poly', 'RBF' and 'Sigmoid'), 默認是gamma = 1 / n_features;</p><p>（5）coef0：核函數中的獨立項，'RBF' and 'sigmoid'有效；</p><p>（6）probablity: 可能性估計是否使用(true or false)；</p><p>（7）shrinking：是否進行啟發式；</p><p>（8）tol（default = 1e - 3）: svm結束標準的精度;</p><p>（9）cache_size: 制定訓練所需要的內存（以MB為單位），在大樣本的時候，緩存大小會影響訓練速度，因此如果機器內存大，推薦用500MB甚至1000MB。默認是200，即200MB.</p><p>（10）class_weight: 指定樣本各類別的的權重，主要是為了防止訓練集某些類別的樣本過多，導致訓練的決策過於偏向這些類別。這裡可以自己指定各個樣本的權重，或者用“balanced”，如果使用“balanced”，則算法會自己計算權重，樣本量少的類別所對應的樣本權重會高。當然，如果你的樣本類別分佈沒有明顯的偏倚，則可以不管這個參數，選擇默認的"None"（11）verbose: 跟多線程有關，不大明白啥意思具體；</p><p>（12）max_iter: 最大迭代次數，default = 1， if max_iter = -1, no limited;</p><p>（13）decision_function_shape ： 分類決策</p><p>‘ovo’ 一對一, ‘ovr’ 多對多 or None 無, default=ovr</p><p>OvR(one ve rest)的思想很簡單，無論你是多少元分類，我們都可以看做二元分類。具體做法是，對於第K類的分類決策，我們把所有第K類的樣本作為正例，除了第K類樣本以外的所有樣本都作為負例，然後在上面做二元分類，得到第K類的分類模型。其他類的分類模型獲得以此類推。</p><p>OvO(one-vs-one)則是每次每次在所有的T類樣本里面選擇兩類樣本出來，不妨記為T1類和T2類，把所有的輸出為T1和T2的樣本放在一起，把T1作為正例，T2作為負例，進行二元分類，得到模型參數。我們一共需要T(T-1)/2次分類。</p><p>從上面的描述可以看出OvR相對簡單，但分類效果相對略差（這裡指大多數樣本分佈情況，某些樣本分佈下OvR可能更好）。而OvO分類相對精確，但是分類速度沒有OvR快。一般建議使用OvO以達到較好的分類效果。</p><p>（14）random_state ：用於概率估計的數據重排時的偽隨機數生成器的種子。</p><p>1）線性核函數（Linear Kernel）表達式為：K(x,z)=x∙zK(x,z)=x∙z，就是普通的內積，LinearSVC 和 LinearSVR 只能使用它。</p><p>2) 多項式核函數（Polynomial Kernel）是線性不可分SVM常用的核函數之一，表達式為：K(x,z)=（γx∙z+r)dK(x,z)=（γx∙z+r)d ，其中，γ,r,dγ,r,d都需要自己調參定義,比較麻煩。</p><p>3）高斯核函數（Gaussian Kernel），在SVM中也稱為徑向基核函數（Radial Basis Function,RBF），它是libsvm默認的核函數，當然也是scikit-learn默認的核函數。表達式為：K(x,z)=exp(−γ||x−z||2)K(x,z)=exp(−γ||x−z||2)， 其中，γγ大於0，需要自己調參定義。</p><p>4）Sigmoid核函數（Sigmoid Kernel）也是線性不可分SVM常用的核函數之一，表達式為：K(x,z)=tanh（γx∙z+r)K(x,z)=tanh（γx∙z+r)， 其中，γ,rγ,r都需要自己調參定義。</p><p>雖然有這麼多的核函數，但是實際上我們常用的只有兩個一個是線性核函數，還是有一個是高斯核函數，原因是它們的效果往往最好，調參數量也比較少，不是很麻煩。當我們使用線性核函數的時候我們的主要的調參的目標就是C，當我們使用高斯核函數的時候我們的主要的調參的目標就是C和gamma。</p><p>要就是調節兩個參數，一個是C，一個是gamma</p><p>C是懲罰係數也就是鬆弛變量的係數。它在優化函數裡主要是平衡支持向量的複雜度和誤分類率這兩者之間的關係，可以理解為正則化係數。當比較大時，我們的損失函數也會越大，這意味著我們不願意放棄比較遠的離群點。這樣我們會有更加多的支持向量，也就是說支持向量和超平面的模型也會變得越複雜，也容易過擬合。反之，當比較小時，意味我們不想理那些離群點，會選擇較少的樣本來做支持向量，最終的支持向量和超平面的模型也會簡單。scikit-learn中默認值是1。</p><p>另一個超參數是RBF核函數的參數。回憶下RBF 核函數 ，主要定義了單個樣本對整個分類超平面的影響，當比較大時，單個樣本對整個分類超平面的影響比較小，不容易被選擇為支持向量，或者說整個模型的支持向量也會少。scikit-learn中默認值是'auto'</p><p>實際上我們最常見的就是調整這兩個參數。下面案例就是實際使用高斯核函數時的調參的案例。它使用sklearn封裝好的調參庫進行網格調參，也叫暴力調參。</p><pre>from sklearn import svm</pre><pre>from sklearn.model_selection import GridSearchCV</pre><pre>from sklearn import metrics</pre><pre>import numpy as np</pre><pre>import pandas as pd</pre><pre>import scipy.io as sio</pre><pre>mat = sio.loadmat(&#39;ex6data3.mat&#39;)</pre><pre>print(mat.keys())</pre><pre>training = pd.DataFrame(mat.get(&#39;X&#39;), columns=[&#39;X1&#39;, &#39;X2&#39;])</pre><pre>training[&#39;y&#39;] = mat.get(&#39;y&#39;)</pre><pre>cv = pd.DataFrame(mat.get(&#39;Xval&#39;), columns=[&#39;X1&#39;, &#39;X2&#39;])</pre><pre>cv[&#39;y&#39;] = mat.get(&#39;yval&#39;)</pre><pre>candidate = [0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30, 100]</pre><pre>combination = [(C, gamma) for C in candidate for gamma in candidate]</pre><pre>if __name__ == &#34;__main__&#34;:</pre><pre> parameters = {&#39;C&#39;: candidate, &#39;gamma&#39;: candidate}</pre><pre> svc = svm.SVC()</pre><pre> clf = GridSearchCV(svc, parameters, n_jobs=-1)</pre><pre> clf.fit(training[[&#39;X1&#39;, &#39;X2&#39;]], training[&#39;y&#39;])</pre><pre> print (clf.best_params_)</pre><pre> print (clf.best_score_)</pre><pre> ypred = clf.predict(cv[[&#39;X1&#39;, &#39;X2&#39;]])</pre><pre> print(metrics.classification_report(cv[&#39;y&#39;], ypred))</pre></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>調參</a></li><li><a>參數</a></li><li><a>可調</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/25bebf48.html alt=關於齒輪的參數及計算公式大全 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/54cfb37ea965443daf82a218b503ddbc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/25bebf48.html title=關於齒輪的參數及計算公式大全>關於齒輪的參數及計算公式大全</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0e83a16d.html alt=聚四氟乙烯材料如何合理選取切削參數？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0e83a16d.html title=聚四氟乙烯材料如何合理選取切削參數？>聚四氟乙烯材料如何合理選取切削參數？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3d825106.html alt=記不住先收藏！結構設計參數中易踩的85個坑 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/12418666dc2f40db9e2a39a0903494e9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3d825106.html title=記不住先收藏！結構設計參數中易踩的85個坑>記不住先收藏！結構設計參數中易踩的85個坑</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d30ee216.html alt=功率電感：參數圖文對比與選型 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/dc7193bbd2b542d2ada80995bab5a82c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d30ee216.html title=功率電感：參數圖文對比與選型>功率電感：參數圖文對比與選型</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b06da4c5.html alt=圖解功率MOS管的參數 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1940284f671c4b559a1db4ef0e83976c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b06da4c5.html title=圖解功率MOS管的參數>圖解功率MOS管的參數</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5018a90e.html alt=常用功率相關參數及計算公式 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/78b2cd3039c54c8cab6ce78964e2ee98 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5018a90e.html title=常用功率相關參數及計算公式>常用功率相關參數及計算公式</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/49a31767.html alt=混凝土配合比參數-砂率 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/49a31767.html title=混凝土配合比參數-砂率>混凝土配合比參數-砂率</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dce40492.html alt="必收藏 | 30+種塑料性能參數大彙總（附高清ppt）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/af56af0f33964775b01c79755a464679 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dce40492.html title="必收藏 | 30+種塑料性能參數大彙總（附高清ppt）">必收藏 | 30+種塑料性能參數大彙總（附高清ppt）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b4c7a094.html alt=AMD系列CPU和主板參數對照表20200524 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4e358b60ba0b47538a09117a67bfab03 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b4c7a094.html title=AMD系列CPU和主板參數對照表20200524>AMD系列CPU和主板參數對照表20200524</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b4568212.html alt="一百多套CPU基本參數及參考價 臺式機新裝先收藏" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/57687a2864914584b2e98ce18dc5f255 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b4568212.html title="一百多套CPU基本參數及參考價 臺式機新裝先收藏">一百多套CPU基本參數及參考價 臺式機新裝先收藏</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1e581ef6.html alt=三菱發那科常用參數對照表，喜歡的關注+收藏 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/67ed749a8d95427399e16ad9dfe4fb22 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1e581ef6.html title=三菱發那科常用參數對照表，喜歡的關注+收藏>三菱發那科常用參數對照表，喜歡的關注+收藏</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2b40eede.html alt=教你看懂汽車配置表：車身參數你到底瞭解多少？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1521536618752ed39932626 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2b40eede.html title=教你看懂汽車配置表：車身參數你到底瞭解多少？>教你看懂汽車配置表：車身參數你到底瞭解多少？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ea52fc17.html alt=買車之前，首先要搞清楚這些參數，想找輛好車真不難！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/717bbd4653ec4efe93c8e702b46848f9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ea52fc17.html title=買車之前，首先要搞清楚這些參數，想找輛好車真不難！>買車之前，首先要搞清楚這些參數，想找輛好車真不難！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/53915422.html alt=機組滑參數停機各專業注意事項彙編 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/53915422.html title=機組滑參數停機各專業注意事項彙編>機組滑參數停機各專業注意事項彙編</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3bdd6f28.html alt=手機射頻參數校準 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1528511288100a170f56e77 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3bdd6f28.html title=手機射頻參數校準>手機射頻參數校準</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>