<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>來！一起捋一捋機器學習分類算法 | 极客快訊</title><meta property="og:title" content="來！一起捋一捋機器學習分類算法 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/8f0965f78eb04e789106c97a827365f6"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/ff476d2b.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/ff476d2b.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/ff476d2b.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/ff476d2b.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/ff476d2b.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/ff476d2b.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e5%ad%b8/ff476d2b.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e5%ad%b8/ff476d2b.html><meta property="article:published_time" content="2020-11-14T20:56:35+08:00"><meta property="article:modified_time" content="2020-11-14T20:56:35+08:00"><meta name=Keywords content><meta name=description content="來！一起捋一捋機器學習分類算法"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E5%AD%B8/ff476d2b.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>來！一起捋一捋機器學習分類算法</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E5%AD%B8.html>科學</a></span></div><div class=post-content><div><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8f0965f78eb04e789106c97a827365f6><p class=pgc-img-caption></p></div><p><strong>大數據文摘出品</strong></p><p><strong>來源：builtin</strong></p><p><strong>編譯：邢暢、劉兆娜、李雷、錢天培</strong></p><p>說起分類算法，相信學過機器學習的同學都能侃上一二。</p><p>可是，你能夠如數家珍地說出所有常用的分類算法，以及他們的特徵、優缺點嗎？比如說，你可以快速地回答下面的問題麼:</p><ul><li>KNN算法的優缺點是什麼？</li><li>Naive Bayes算法的基本假設是什麼？</li><li>entropy loss是如何定義的？</li><li>最後，分類算法調參常用的圖像又有哪些？</li></ul><p>答不上來？別怕！一起來通過這篇文章回顧一下機器學習分類算法吧（本文適合已有機器學習分類算法基礎的同學）。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3a228c9da9c846aaaf7574e1269bcdfe><p class=pgc-img-caption></p></div><p>機器學習是一種能從數據中學習的計算機編程科學以及藝術，就像下面這句話說得一樣。</p><blockquote><p>機器學習是使計算機無需顯式編程就能學習的研究領域。</p><p>——阿瑟·塞繆爾，1959年</p></blockquote><p>不過還有一個更好的定義：</p><blockquote><p>“如果一個程序在使用既有的經驗（E）執行某類任務（T）的過程中被認為是“具備學習能力的”，那麼它一定需要展現出:利用現有的經驗（E），不斷改善其完成既定任務（T）的性能（P）的特性。”</p><p>——Tom Mitchell, 1997</p></blockquote><p>例如，你的垃圾郵件過濾器是一個機器學習程序，通過學習用戶標記好的垃圾郵件和常規非垃圾郵件示例，它可以學會標記垃圾郵件。系統用於學習的示例稱為訓練集。在此案例中，任務（T）是標記新郵件是否為垃圾郵件，經驗（E）是訓練數據，性能度量（P） 需要定義。例如，你可以定義正確分類的電子郵件的比例為P。這種特殊的性能度量稱為準確度，這是一種有監督的學習方法，常被用於分類任務。</p><p>機器學習入門指南：</p><p>https://builtin.com/data-science/introduction-to-machine-learning</p><p><strong>監督學習</strong></p><p>在監督學習中，算法從有標記數據中學習。在理解數據之後，該算法通過將模式與未標記的新數據關聯來確定應該給新數據賦哪種標籤。</p><p>監督學習可以分為兩類：<strong>分類</strong>和<strong>迴歸</strong>。</p><p><strong>分類問題預測數據所屬的類別；</strong></p><p>分類的例子包括垃圾郵件檢測、客戶流失預測、情感分析、犬種檢測等。</p><p><strong>迴歸問題根據先前觀察到的數據預測數值；</strong></p><p>迴歸的例子包括房價預測、股價預測、身高-體重預測等。</p><p>機器學習新手的十大算法之旅：</p><p>https://builtin.com/data-science/tour-top-10-algorithms-machine-learning-newbies</p><p><strong>分類問題</strong></p><p>分類是一種基於一個或多個自變量確定因變量所屬類別的技術。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/32141c437ac4401d99cd787c17cdc9ba><p class=pgc-img-caption></p></div><p>分類用於預測離散響應</p><p><strong>邏輯迴歸</strong></p><p>邏輯迴歸類似於線性迴歸，適用於因變量不是一個數值字的情況 (例如，一個“是/否”的響應)。它雖然被稱為迴歸，但卻是基於根據迴歸的分類，將因變量分為兩類。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ec917e17a51c45dca489a29610660bbb><p class=pgc-img-caption></p></div><p>如上所述，邏輯迴歸用於預測二分類的輸出。例如，如果信用卡公司構建一個模型來決定是否通過向客戶的發行信用卡申請，它將預測客戶的信用卡是否會“違約”。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c99f3e67909f4aefa80b48ddfab35d8d><p class=pgc-img-caption></p></div><p>首先對變量之間的關係進行線性迴歸以構建模型，分類的閾值假設為0.5。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c3cbbd4156d948a196e932c773dab752><p class=pgc-img-caption></p></div><p>然後將Logistic函數應用於迴歸分析，得到兩類的概率。</p><p>該函數給出了事件發生和不發生概率的對數。最後，根據這兩類中較高的概率對變量進行分類。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/147d596511464d1490f6d16a6f83da78><p class=pgc-img-caption></p></div><p><strong>K-近鄰算法（K-NN）</strong></p><p>K-NN算法是一種最簡單的分類算法，通過識別被分成若干類的數據點，以預測新樣本點的分類。K-NN是一種非參數的算法，是“懶惰學習”的著名代表，它根據相似性（如，距離函數）對新數據進行分類。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0b1befa848ec4fabbccf57cb3cac2f45><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/dae3f200dc3c4f3eb1d29b3356660c36><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e7e9f25c7ebf421a83fa2d1259ee87be><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b91318412c2b40ce9708e3be323617f9><p class=pgc-img-caption></p></div><p>K-NN能很好地處理少量輸入變量（p）的情況，但當輸入量非常大時就會出現問題。</p><p><strong>支持向量機（SVM）</strong></p><p>支持向量機既可用於迴歸也可用於分類。它基於定義決策邊界的決策平面。決策平面（超平面）可將一組屬於不同類的對象分離開。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/af1323b2cf71497d8be11ae8006c16d8><p class=pgc-img-caption></p></div><p>在支持向量的幫助下，SVM通過尋找超平面進行分類，並使兩個類之間的邊界距離最大化。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4966155991ad4de08e29d59e808d87a1><p class=pgc-img-caption></p></div><p>SVM中超平面的學習是通過將問題轉化為使用一些某種線性代數轉換問題來完成的。（上圖的例子是一個線性核，它在每個變量之間具有線性可分性）。</p><p>對於高維數據，使用可使用其他核函數，但高維數據不容易進行分類。具體方法將在下一節中闡述。</p><p><strong>核支持向量機</strong></p><p>核支持向量機將核函數引入到SVM算法中，並將其轉換為所需的形式，將數據映射到可分的高維空間。</p><p>核函數的類型包括：</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5fb2dfca2db046eb87ab137425f912bd><p class=pgc-img-caption></p></div><ul><li>前文討論的就是<strong>線性SVM</strong>。</li><li><strong>多項式核</strong>中需要指定多項式的次數。它允許在輸入空間中使用曲線進行分割。</li><li><strong>徑向基核</strong>（radial basis function, RBF）可用於非線性可分變量。使用平方歐幾里德距離，參數的典型值會導致過度擬合。sklearn中默認使用RBF。</li><li>類似於與邏輯迴歸類似，<strong>sigmoid核</strong>用於二分類問題。</li></ul><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b47f254488d1443ebf7188567a0ad7e8><p class=pgc-img-caption></p></div><p><strong>徑向基核（RBF：Radial Basis Function ）</strong></p><p>RBF核支持向量機的決策區域實際上也是一個線性決策區域。RBF核支持向量機的實際作用是構造特徵的非線性組合，將樣本映射到高維特徵空間，再利用線性決策邊界分離類。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/767fcbcddacf4426a501805a59669b00><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p>因此，可以得出經驗是：對線性問題使用線性支持向量機，對非線性問題使用非線性核函數，如RBF核函數。</p><p><strong>樸素貝葉斯</strong></p><p>樸素貝葉斯分類器建立在貝葉斯定理的基礎上，基於特徵之間互相獨立的假設（假定類中存在一個與任何其他特徵無關的特徵）。即使這些特徵相互依賴，或者依賴於其他特徵的存在，樸素貝葉斯算法都認為這些特徵都是獨立的。這樣的假設過於理想，樸素貝葉斯因此而得名。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/049efbed2b664096b47d94f5c8072b11><p class=pgc-img-caption></p></div><p>在樸素貝葉斯的基礎上，高斯樸素貝葉斯根據二項（正態）分佈對數據進行分類。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/dfeccf316c104ab0ba294140f11394d5><p class=pgc-img-caption></p></div><p><strong>P(class|data)</strong> 表示給定特徵（屬性）後數據屬於某類（目標）的後驗概率。給定數據，其屬於各類的概率大小就是我們要計算的值。</p><p><strong>P(class)</strong>表示某類的先驗概率。</p><p><strong>P(data|class)</strong>表示似然，是指定類別時特徵出現的概率。</p><p><strong>P(data)</strong>表示特徵或邊際似然的先驗概率。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5d098e5ab8c84031bd37f440a03e2747><p class=pgc-img-caption></p></div><p><strong>步驟</strong></p><p><strong>1、計算先驗概率</strong></p><p>P(class) = 類中數據點的數量/觀測值的總數量</p><p>P(yellow) = 10/17</p><p>P(green) = 7/17</p><p><strong>2、計算邊際似然</strong></p><p>P(data) = 與觀測值相似的數據點的數量/觀測值的總數量</p><p>P(?) = 4/17</p><p>該值用於檢查各個概率。</p><p><strong>3、計算似然</strong></p><p>P(data/class) = 類中與觀測值相似的數量/類中點的總數量</p><p>P(?/yellow) = 1/7</p><p>P(?/green) = 3/10</p><p><strong>4、計算各類的後驗概率</strong></p><p class=ql-align-center><br></p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/58d1561f2ca44c30824568828c0d58c2><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p><strong>5、分類</strong></p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/22915d1ea1824621a330398308795797><p class=pgc-img-caption></p></div><p>某一點歸於後驗概率高的類別，因為從上可知其屬於綠色類的概率是75%根據其75%的概率這個點屬於綠色類。</p><p>多項式、伯努利樸素貝葉斯是計算概率的其他模型。樸素貝葉斯模型易於構建，不需要複雜的參數迭代估計，這使得它對非常大的數據集特別有用。</p><p><strong>決策樹分類</strong></p><p><strong>決策樹以樹狀結構構建分類或迴歸模型。</strong>它通過將數據集不斷拆分為更小的子集來使決策樹不斷生長。最終長成具有決策節點（包括根節點和內部節點）和葉節點的樹。最初決策樹算法它採用採用<strong>Iterative Dichotomiser 3（ID3）</strong>算法來確定分裂節點的順序。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/78ea3b1820bd420886628b5bda33ac89><p class=pgc-img-caption></p></div><p>信息熵和信息增益用於被用來構建決策樹。</p><p><strong>信息熵</strong></p><p>信息熵是衡量元素無序狀態程度的一個指標，即衡量信息的不純度。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1b1db1b2a31241f680155743951e96d0><p class=pgc-img-caption></p></div><p>信息熵是衡量元素的無序狀態的程度的一個指標，或者說，衡量信息的不純度。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1b1db1b2a31241f680155743951e96d0><p class=pgc-img-caption></p></div><p>直觀上說地理解，信息熵表示一個事件的確定性程度。信息熵度量樣本的同一性，如果樣本全部屬於同一類，則信息熵為0；如果樣本等分成不同的類別，則信息熵為1。</p><p><strong>信息增益</strong></p><p>信息增益測量獨立屬性間信息熵的變化。它試圖估計每個屬性本身包含的信息，構造決策樹就是要找到具有最高信息增益的屬性（即純度最高的分支）。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3be7d293837c4ae5adaf22c35b095993><p class=pgc-img-caption></p></div><p>信息增益測量獨立屬性間的信息熵的變化。它試圖估計每個屬性本身包含的信息，構造決策樹就是要找到具有最高信息增益的屬性（即純度最高的分支）。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3be7d293837c4ae5adaf22c35b095993><p class=pgc-img-caption></p></div><p>其中Gain（(T,X）)是特徵X的信息增益。Entropy(T)是整個集合的信息熵，第二項Entropy(T,X)是特徵X的信息熵。</p><p>採用信息熵進行節點選擇時，通過對該節點各個屬性信息增益進行排序，選擇具有最高信息增益的屬性作為劃分節點，過濾掉其他屬性。</p><p>決策樹模型存在的一個問題是容易過擬合。因為在其決策樹構建過程中試圖通過生成長一棵完整的樹來擬合訓練集，因此卻降低了測試集的準確性。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1ebe418961244d76a2758beb3b5a4210><p class=pgc-img-caption></p></div><p>通過剪枝技術可以減少小決策樹的過擬合問題。</p><p><strong>分類的集成算法</strong></p><p>集成算法是一個模型組。從技術上說，集成算法是單獨訓練幾個有監督模型，並將訓練好的模型以不同的方式進行融合，從而達到最終的得預測結果。集成後的模型比其中任何一個單獨的模型都有更高的預測能力。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/aec9b78d83e949c39a1b8799c2a0d63f><p class=pgc-img-caption></p></div><p><strong>隨機森林分類器</strong></p><p>隨機森林分類器是一種基於<strong>裝袋（bagging）</strong>的集成算法，即<strong>自舉助聚合法(bootstrap aggregation)</strong>。集成算法結合了多個相同或不同類型的算法來對對象進行分類（例如，SVM的集成，基於樸素貝葉斯的集成或基於決策樹的集成）。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/60785b7e029247dbbf076117ed191620><p class=pgc-img-caption></p></div><p>集成的基本思想是算法的組合提升了最終的結果。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/aa7b2fad720643ff91bf5cb453f01225><p class=pgc-img-caption></p></div><p>深度太大的決策樹容易受過擬合的影響。但是隨機森林通過在隨機子集上構建決策樹防止過擬合，主要原因是它會對所有樹的結果進行投票的結果是所有樹的分類結果的投票，從而消除了單棵樹的偏差。</p><p>隨機森林在決策樹生增長的同時為模型增加了額外的隨機性。它在分割節點時，不是搜索全部樣本最重要的特徵，而是在隨機特徵子集中搜索最佳特徵。這種方式使得決策樹具有多樣性，從而能夠得到更好的模型。</p><p><strong>梯度提升分類器</strong></p><p>梯度提升分類器是一種提升集成算法。提升(boosting)算法是為了減少偏差而對弱分類器的而進行的一種集成方法。與裝袋（bagging）方法構建預測結果池不同，提升算法是一種分類器的串行方法，它把每個輸出作為下一個分類器的輸入。通常，在裝袋算法中，每棵樹在原始數據集的子集上並行訓練，並用所有樹預測結果的均值作為模型最終的預測結果；梯度提升模型，採用串行方式而非並行模式獲得預測結果。每棵決策樹預測前一棵決策樹的誤差，因而使誤差獲得提升。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/57ba6c17e0e146738f4a23769f191bb0><p class=pgc-img-caption></p></div><p>梯度提升樹的工作流程</p><ul><li>使用淺層決策樹初始化預測結果。</li><li>計算殘差值（實際預測值）。</li><li>構建另一棵淺層決策樹，將上一棵樹的殘差作為輸入進行預測。</li><li>用新預測值和學習率的乘積作為最新預測結果，更新原有預測結果。</li><li>重複步驟2-4，進行一定次數的迭代（迭代的次數即為構建的決策樹的個數）。</li></ul><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ad4d29e833a44205b3dff147a24b928e><p class=pgc-img-caption></p></div><p>如果想了解更多關於梯度提升分類器的知識，可參考：</p><p>https://medium.com/mlreview/gradient-boosting-from-scratch-1e317ae4587d%20/t%20_blank</p><p><strong>分類器的性能</strong></p><p><strong>混淆矩陣</strong></p><p>混淆矩陣是一張表，這張表通過對比已知分類結果的測試數據的預測值和真實值表來描述衡量分類器的性能。在二分類的情況下，混淆矩陣是展示預測值和真實值四種不同結果組合的表。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/af22f2981c0e4d8295755ab74d1dfbc0><p class=pgc-img-caption></p></div><p>多分類問題的混淆矩陣可以幫助你確認錯誤模式。</p><p>對於二元分類器：</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/70beea0d60ac486f81476bf89b16ae76><p class=pgc-img-caption></p></div><p><strong>假正例&假負例</strong></p><p>假正例和假負例用來衡量模型預測的分類效果。假正例是指模型錯誤地將負例預測為正例。假負例是指模型錯誤地將正例預測為負例。主對角線的值越大（主對角線為真正例和真負例），模型就越好；副對角線給出模型的最差預測結果。</p><p><strong>假正例</strong></p><p>下面給出一個假正例的例子。比如：模型將一封郵件分類為垃圾郵件（正例），但這封郵件實際並不是垃圾郵件。這就像一個警示，錯誤如果能被修正就更好，但是與假負例相比，它並不是一個嚴重的問題。</p><p>作者注：個人觀點，這個例子舉的不太好，對垃圾郵件來說，相比於錯誤地將垃圾郵件分類為正常郵件（假負例），將正常郵件錯誤地分類為垃圾郵件（假正例）是更嚴重的問題。</p><p><strong>假正例（I型錯誤）</strong>——原假設正確而拒絕原假設。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2909d834caea4b828ae1e4ac0572f7e4><p class=pgc-img-caption></p></div><p><strong>假負例</strong></p><p>假負例的一個例子。例如，該模型預測一封郵件不是垃圾郵件（負例），但實際上這封郵件是垃圾郵件。這就像一個危險的信號，錯誤應該被及早糾正，因為它比假正例更嚴重。</p><p><strong>假負例（II型錯誤）</strong>——原假設錯誤而接受原假設</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/6b507270c1e445d79b58bd5277ca1d1a><p class=pgc-img-caption></p></div><p>上圖能夠很容易地說明上述指標。左圖男士的測試結果是假正例因為男性不能懷孕；右圖女士是假負例因為很明顯她懷孕了。</p><p>從混淆矩陣，我們能計算出準確率、精度、召回率和F-1值。</p><p><strong>準確率</strong></p><p>準確率是模型預測正確的部分。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/982248a41e5441ebb96e5a60a17d3249><p class=pgc-img-caption></p></div><p>準確率的公式為：</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9445a02d8ebf4f668ab8f321d8949cba><p class=pgc-img-caption></p></div><p>當數據集不平衡，也就是正樣本和負樣本的數量存在顯著差異時，單獨依靠準確率不能評價模型的性能。精度和召回率是衡量不平衡數據集的更好的指標。</p><p><strong>精度</strong></p><p>精度是指在所有預測為正例的分類中，預測正確的程度為正例的效果。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3e8f5377d52c4c7a97666fbc355c5270><p class=pgc-img-caption></p></div><p>精度越高越好。</p><p><strong>召回率</strong></p><p>召回率是指在所有預測為正例（被正確預測為真的和沒被正確預測但為真的）的分類樣本中，召回率是指預測正確的程度。它，也被稱為敏感度或真正率（TPR）。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7fbe3e107ee44536b56eacf8b7e1f0c9><p class=pgc-img-caption></p></div><p>召回率越高越好。</p><p><strong>F-1值</strong></p><p>通常實用的做法是將精度和召回率合成一個指標F-1值更好用，特別是當你需要一種簡單的方法來衡量兩個分類器性能時。F-1值是精度和召回率的調和平均值。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7c6eb9606608498f8aeb787f9b136b8e><p class=pgc-img-caption></p></div><p>普通的通常均值將所有的值平等對待，而調和平均值給予較低的值更高的權重，從而能夠更多地懲罰極端值。所以，如果精度和召回率都很高，則分類器將得到很高的F-1值。</p><p><strong>接受者操作曲線（ROC）和曲線下的面積（AUC）</strong></p><p>ROC曲線是衡量分類器性能的一個很重要指標，它代表模型準確預測的程度。ROC曲線通過繪製真正率和假正率的關係來衡量分類器的敏感度。如果分類器性能優越，則真正率將增加，曲線下的面積會接近於1.如果分類器類似於隨機猜測，真正率將隨假正率線性增加。AUC值越大，模型效果越好。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f9c9fe8ece8c4cd98e78f5f67109d129><p class=pgc-img-caption></p></div><p><strong>累積精度曲線</strong></p><p>CAP代表一個模型沿y軸為真正率的累積百分比與沿x軸的該分類樣本累積百分比。CAP不同於接受者操作曲線（ROC，繪製的是真正率與假正率的關係）。與ROC曲線相比，CAP曲線很少使用。</p><div class=pgc-img><img alt=來！一起捋一捋機器學習分類算法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d9cec66c71c54210a9b68f20b068d00f><p class=pgc-img-caption></p></div><p>以考慮一個預測客戶是否會購買產品的模型為例，如果隨機選擇客戶，他有50%的概率會購買產品。客戶購買產品的累積數量會線性地增長到對應客戶總量的最大值，這個曲線稱為CAP隨機曲線，為上圖中的藍色線。而一個完美的預測，準確地確定預測了哪些客戶會購買產品，這樣，在所有樣本中只需選擇最少的客戶就能達到最大購買量。這在CAP曲線上產生了一條開始陡峭一旦達到最大值就會維持在1的折線，稱為CAP的完美曲線，也被稱為理想曲線，為上圖中灰色的線。</p><p>最後，一個真實的模型應該能儘可能最大化地正確預測，接近於理想模型曲線。</p><p>參考鏈接：</p><p>http://www.semspirit.com/artificial-intelligence/machine-learning/classification/classifier-evaluation/classifier-evaluation-with-cap-curve-in-python/" \t "_blank"</p><p>分類器的代碼見：</p><p>https://github.com/BadreeshShetty/Supervised-ML-Classification"\t "_blank"Github Repo</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>機器</a></li><li><a>學習</a></li><li><a>分類</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/dc2af9c9.html alt=機器學習筆記(七)——初識邏輯迴歸、不同方法推導梯度公式 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/13adbab9c7f94c7fa81d49a98861b051 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dc2af9c9.html title=機器學習筆記(七)——初識邏輯迴歸、不同方法推導梯度公式>機器學習筆記(七)——初識邏輯迴歸、不同方法推導梯度公式</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e214e6d7.html alt=深度學習/機器學習入門數學知識整理（二）梯度與導數，泰勒展開 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1540372101455de0fb74774 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e214e6d7.html title=深度學習/機器學習入門數學知識整理（二）梯度與導數，泰勒展開>深度學習/機器學習入門數學知識整理（二）梯度與導數，泰勒展開</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f3767255.html alt=講透機器學習中的梯度下降 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5c80301e53424671bc22755be2e4ee33 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f3767255.html title=講透機器學習中的梯度下降>講透機器學習中的梯度下降</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ce278cf4.html alt=機器學習時代的哈希算法，將如何更高效地索引數據 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1525617261534ad07c6455c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ce278cf4.html title=機器學習時代的哈希算法，將如何更高效地索引數據>機器學習時代的哈希算法，將如何更高效地索引數據</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/346037ff.html alt=淺談機器學習時代的哈希算法（一） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1525788510275af3193bcdc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/346037ff.html title=淺談機器學習時代的哈希算法（一）>淺談機器學習時代的哈希算法（一）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f71cd4af.html alt=機器學習入門第2章：SVM（支持向量機）—編碼 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/28eb40e101e44cfb8b88aac745d012d6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f71cd4af.html title=機器學習入門第2章：SVM（支持向量機）—編碼>機器學習入門第2章：SVM（支持向量機）—編碼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a55cbbea.html alt=機器學習總結（基礎）：偏差和方差、iid、分佈 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a9681e5f716547e288303eae292c5b3e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a55cbbea.html title=機器學習總結（基礎）：偏差和方差、iid、分佈>機器學習總結（基礎）：偏差和方差、iid、分佈</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/41b2e34d.html alt=機器學習數學篇—基礎數學知識清單 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/59470000766ddb369113 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/41b2e34d.html title=機器學習數學篇—基礎數學知識清單>機器學習數學篇—基礎數學知識清單</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fee3515e.html alt=機器學習之線性代數速查表 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/153089168574158dba8fa5a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fee3515e.html title=機器學習之線性代數速查表>機器學習之線性代數速查表</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6cc52e2b.html alt=使用機器學習的手寫數字識別 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1f78eeb0e00a46b789e4bcb4ad07d97b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6cc52e2b.html title=使用機器學習的手寫數字識別>使用機器學習的手寫數字識別</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f575bcd3.html alt=專為機器學習打造的半導體器件：可進行任意邏輯運算 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4654f6d6a6dd496ebbf6787bb43a7231 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f575bcd3.html title=專為機器學習打造的半導體器件：可進行任意邏輯運算>專為機器學習打造的半導體器件：可進行任意邏輯運算</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fc9d01d7.html alt=機器學習降維技術（PCA，ICA和流形學習）及醫學中流形學習的應用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ebc79c3aa76541b393374cc521297870 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fc9d01d7.html title=機器學習降維技術（PCA，ICA和流形學習）及醫學中流形學習的應用>機器學習降維技術（PCA，ICA和流形學習）及醫學中流形學習的應用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dd736e73.html alt=基於機器學習在雙光子光刻過程中進行自動探測產品的質量 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/7550407fa66941b2991e53b5a9ec4071 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dd736e73.html title=基於機器學習在雙光子光刻過程中進行自動探測產品的質量>基於機器學習在雙光子光刻過程中進行自動探測產品的質量</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a8622e86.html alt=深度學習之圖像分類-----VGG class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/93a1ccf97a2f4277b9c68a06f44e4ccc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a8622e86.html title=深度學習之圖像分類-----VGG>深度學習之圖像分類-----VGG</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e33110be.html alt=機器學習中模型評估和選擇的一些問題 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/6c3b00005e98772353a5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e33110be.html title=機器學習中模型評估和選擇的一些問題>機器學習中模型評估和選擇的一些問題</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>