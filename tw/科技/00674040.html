<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>CC++語言16｜通過繼承、虛函數、指針來實現動態多態 | 极客快訊</title><meta property="og:title" content="CC++語言16｜通過繼承、虛函數、指針來實現動態多態 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/00674040.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/00674040.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/00674040.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/00674040.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/00674040.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/00674040.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/00674040.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/00674040.html><meta property="article:published_time" content="2020-11-14T21:08:07+08:00"><meta property="article:modified_time" content="2020-11-14T21:08:07+08:00"><meta name=Keywords content><meta name=description content="CC++語言16｜通過繼承、虛函數、指針來實現動態多態"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/00674040.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>CC++語言16｜通過繼承、虛函數、指針來實現動態多態</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>多態性可分為運行時的多態性（虛函數重寫），和編譯時的多態性（重載，包括構造函數多態）。</p><p>1) 編譯時多態性：同一對象在收到相同的消息卻產生不同的函數調用，一般通過函數重載來實現，在編譯時就實現了綁定，屬於靜態綁定。</p><p>2) 運行時多態性：不同對象在收到相同消息時產生不同的動作，一般通過虛函數來實現。運行時的多態性是通過virtual函數重寫和動態綁定實現的。</p><p>virtual就是告訴編譯器，函數不是使用靜態綁定，而是要使用動態綁定。</p><p>實現多態主要採用引用和指針。傳值這種方式是複製數據，其類型編譯器就已決定，而多態是類型要等到執行期才能決定，所以不使用傳值方式來實現多態參數傳遞。</p><h1><strong>1 多態的作用</strong></h1><p>對於封裝，可以使代碼模塊化。</p><p>對於繼承，可以擴展已經存在的代碼。</p><p><strong>而多態，是為了接口重用。</strong>同樣的功能不要再增加雜七雜八的名字。</p><h1><strong>2 多態最常見的用法</strong></h1><p>多態最常見的用法就是聲明基類的指針，利用該指針指向任意一個子類對象，調用相應的虛函數，可以根據指向的子類的不同而實現不同的方法。如果沒有使用虛函數的話，即沒有利用C++多態性，則利用基類指針調用相應的函數的時候，將總被限制在基類函數本身，而無法調用到子類中被重寫過的函數。因為沒有多態性，函數調用的地址將是一定的，而固定的地址將始終調用到同一個函數，這就無法實現一個接口，多種方法的目的了。</p><h1><strong>3 擴展瞭解隱藏規則</strong></h1><p>本來僅僅區別重載與覆蓋並不算困難，但是C++的隱藏規則使問題複雜性陡然增加。</p><p>這裡“隱藏”是指派生類的函數屏蔽了與其同名的基類函數，規則如下：</p><p>1) 如果派生類的函數與基類的函數同名，但是參數不同。此時，不論有無virtual關鍵字，基類的函數將被隱藏。(注意別和重載混淆)</p><p>2) 如果派生類的函數與基類的函數相同，但是基類沒有virtual關鍵字，那麼基類的函數將被隱藏。(注意別和覆蓋混淆)。</p><h1><strong>4 多態實現過程</strong></h1><p>動態多態性發生在程序運行期，是動態綁定。動態多態則是通過繼承、虛函數、<strong>指針</strong>來實現。程序在運行時才決定調用的函數，通過父類指針調用子類的函數，可以讓父類指針具有多種形態。</p><p>4.1 在基類中的某成員函數被聲明為虛函數後，在之後的派生類中可以重新來定義它。但定義時，其函數原型、函數名、參數個數、參數類型的順序，都必須和基類中的原型完全相同。</p><p>4.2 必須通過基類指針指向派生類對象，才能通過虛函數實現運行時的多態性。</p><p>4.3 虛函數具有繼承性，只要在基類中顯式聲明瞭虛函數，在派生類中函數名前的virtual可以略去，因為系統會根據其是否和基類中虛函數原型完全相同來判斷是不是虛函數。一個虛函數無論被公有繼承了多少次，它仍然是虛函數。</p><p>4.4 使用虛函數，派生類必須是基類公有派生的。</p><p>4.5 虛函數必須是所在類的成員函數，而不能是友元函數，也不能是靜態成員函數。因為虛函數調用要靠特定的對象類決定應該激活哪一個函數。</p><p>4.6 構造函數不能是虛函數，但析構函數可以是虛函數。</p><h1><strong>5 多態中的虛函數</strong></h1><p>虛函數只是定義一類相同的行為，通過重載成具體的個體的函數實現個體不同的行為方式。</p><p>名字相同，代表共同的行為，但重載後的派生類有了差異性，但由於虛函數的指針有了不同的指向（不同的派生類對象），因而可以產生不同的行為。</p><p>虛函數的主要作用是將其類和各個派生類的通用功能抽象出來，實現通用部分，而在派生類中寫特定代碼。因此，從多個對象抽象出功能交集是非常重要的，而交集中的功能使用虛函數實現。有時基類會為這些虛函數提供一個默認的實現函數。</p><h1><strong>6 純虛函數與抽象類</strong></h1><p>為了方便使用多態特性，編程者常常需要在基類中定義虛擬函數。在很多情況下，基類本身生成對象是不合情理的。例如，動物作為一個基類可以派生出猴子、犀牛等子類， 但動物本身生成對象明顯不合常理。</p><p>為了解決上述問題，引入了純虛函數的概念，將函數定義為純虛函數，則編譯器要求在派生類中必須予以重載以實現多態性。同時含有純虛擬函數的類稱為抽象類，它不能生成對象。這樣就很好地解決了上述兩個問題。</p><p>純虛函數是指不指定任何實現的函數。如果類只包含純虛函數，或從純虛函數繼承而來，並且沒有提供任何實現，則該類為抽象類。程序中不能創建抽象類對象，只能使用抽象類進行派生，而所有從抽象類派生而來的類必須實現純虛函數。線虛函數使用純指示符(=0)聲明，代碼如下：</p><pre>virtual CalArea() = 0;</pre><p>抽象類提供通用功能，但是因為太通用而無法實現具體的功能。</p><p>引入抽象基類和純虛函數的主要目的是為了實現一種接口的效果。在面向對象的編程語言中，為了更好的表示客觀世界。所以有些類可以什麼都不實現只是提供一個共享的接口。這就是純虛函數，而含有純虛函數的基類即為抽象基類。</p><h1><strong>7 多態性是如何實現程序的可擴展性？</strong></h1><p>派生類是一類特殊的基類，例如本科生、碩士生和博士生都是從學生類派生的。由於所有學生都要寫論文，所以基類（學生類）中有一個“寫論文”的虛函數。但每類學生寫論文的要求是不一樣的，因此在本科生、碩士生和博士生類中都有一個對應於虛函數的“寫論文”函數。當需要向所有學生布置寫論文的任務時，可以用一個學生類的指針遍歷所有的學生。由於多態性，每類學生執行的是自己類新增的“寫論文”函數，按照自己類規定的要求寫論文。如果學校決定要招收工程碩士，那麼系統中必須有一個“工程碩士”的類。工程碩士也是一類學生，所以也從學生類派生。工程碩士也要寫論文，論文要求和其他幾類學生不同，所以工程碩士類也要有一個“寫論文”的函數。如果建好了工程碩士這個類，向全校學生布置寫論文的工作流程還和以前一樣。由此可見，當擴展系統時，只需要增加一些新的類，而主程序不變。</p><p>多態的關鍵在於編譯器行為：建立虛函數表、為對象建立虛函數指針。</p><h1><strong>8 動態多態實例</strong></h1><pre>#include &lt;iostream&gt;#include &lt;string&gt;using namespace std;class Graph{protected:	double x;	double y;public:	Graph(double x, double y);	virtual void showArea();};Graph::Graph(double x,double y){	this-&gt;x=x;	this-&gt;y=y;}void Graph::showArea(){	cout&lt;&lt;"couting Graph's Area"&lt;&lt;endl;}class Rectangle:public Graph{public:	Rectangle(double x, double y):Graph(x,y){};	void showArea();};void Rectangle::showArea(){	cout&lt;&lt;"Rectangle's area: "&lt;&lt;x*y&lt;&lt;endl;}class Triangle:public Graph{public:	Triangle(double d, double h):Graph(d,h){};	void showArea();};void Triangle::showArea(){	cout&lt;&lt;"Triangle's area: "&lt;&lt;x*y*0.5&lt;&lt;endl;}class Circle:public Graph{public:	Circle(double r):Graph(r,r){};	void showArea();};void Circle::showArea(){	cout&lt;&lt;"Circle's Area: "&lt;&lt;3.14*x*y&lt;&lt;endl;}int main(){	Graph * g;	Rectangle rec(8,5);	g = &amp;rec;	g-&gt;showArea();	Triangle tri(6,5);	g = &amp;tri;	g-&gt;showArea();	Circle cir(2);	g = &amp;cir;	g-&gt;showArea();	system("pause");	return 0;}/*Rectangle's area: 40Triangle's area: 15Circle's Area: 12.56*/</pre><p>－end－</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>C++</a></li><li><a>語言</a></li><li><a>16</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/7267cf45.html alt=CC++語言19｜靜態成員（對象共享數據成員及其成員函數） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7267cf45.html title=CC++語言19｜靜態成員（對象共享數據成員及其成員函數）>CC++語言19｜靜態成員（對象共享數據成員及其成員函數）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a5a90058.html alt=C語言C++中assert的用法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/800dbdf4-3783-4992-8b82-525f32e81100 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a5a90058.html title=C語言C++中assert的用法>C語言C++中assert的用法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0e7c6ad4.html alt=CC++語言15｜類的繼承和派生實現代碼重用、擴充 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/4983def52247451589ab482f2921c1aa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0e7c6ad4.html title=CC++語言15｜類的繼承和派生實現代碼重用、擴充>CC++語言15｜類的繼承和派生實現代碼重用、擴充</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8b84bf7a.html alt=CC++語言21｜函數模板與類模板 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8b84bf7a.html title=CC++語言21｜函數模板與類模板>CC++語言21｜函數模板與類模板</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/35303b23.html alt=C語言/C++程序員內存基礎知識 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/c0f5c3aa694341fba131408a23e133b1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/35303b23.html title=C語言/C++程序員內存基礎知識>C語言/C++程序員內存基礎知識</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/82646fb0.html alt=C/C++編程筆記：C語言編程知識要點總結！大一C語言知識點（全） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d208ccdc7f074f67a257d52df74e4f48 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/82646fb0.html title=C/C++編程筆記：C語言編程知識要點總結！大一C語言知識點（全）>C/C++編程筆記：C語言編程知識要點總結！大一C語言知識點（全）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/69fc84d9.html alt=一些經典的C/C++語言基礎算法及代碼 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/69fc84d9.html title=一些經典的C/C++語言基礎算法及代碼>一些經典的C/C++語言基礎算法及代碼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a76b6a9f.html alt=年薪百萬的程序員C++/C語言實現了MFC窗口的自動縮放 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/826bd92ea024450a85fa65541d1a3eeb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a76b6a9f.html title=年薪百萬的程序員C++/C語言實現了MFC窗口的自動縮放>年薪百萬的程序員C++/C語言實現了MFC窗口的自動縮放</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/96a2a610.html alt=CC++語言5｜控制檯和文件的輸入、輸出 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/727f098418fe48e99a1a53ebe74aab7e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/96a2a610.html title=CC++語言5｜控制檯和文件的輸入、輸出>CC++語言5｜控制檯和文件的輸入、輸出</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8709aab.html alt=C語言/C++和程序設計，編程知識 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/61590001663cc8dc9852 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8709aab.html title=C語言/C++和程序設計，編程知識>C語言/C++和程序設計，編程知識</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/83d3e1c8.html alt=16口LC單模滿配機架式光纖終端盒16芯光纜尾纖熔接電信級 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0421b2ab8733422e8729972e9dd9486e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/83d3e1c8.html title=16口LC單模滿配機架式光纖終端盒16芯光纜尾纖熔接電信級>16口LC單模滿配機架式光纖終端盒16芯光纜尾纖熔接電信級</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e18c5b5e.html alt=2019年正在流行的16個網頁設計趨勢 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RPgQdSQEjBTN6Z style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e18c5b5e.html title=2019年正在流行的16個網頁設計趨勢>2019年正在流行的16個網頁設計趨勢</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/65d2605f.html alt=什麼是梯度：用形象的語言解讀梯度的本質原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/557c7b377c5449bb885df35b2d354e03 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/65d2605f.html title=什麼是梯度：用形象的語言解讀梯度的本質原理>什麼是梯度：用形象的語言解讀梯度的本質原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4b2ac18d.html alt=我國首部較少民族語言工具書《鄂倫春語常用語發音詞典》出版發行 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/S5YRqTH6awaqmG style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4b2ac18d.html title=我國首部較少民族語言工具書《鄂倫春語常用語發音詞典》出版發行>我國首部較少民族語言工具書《鄂倫春語常用語發音詞典》出版發行</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/10c7d8fd.html alt=神州泰嶽：公司在自然語言處理領域的基礎技術研究和應用落地均走在行業前列 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/10c7d8fd.html title=神州泰嶽：公司在自然語言處理領域的基礎技術研究和應用落地均走在行業前列>神州泰嶽：公司在自然語言處理領域的基礎技術研究和應用落地均走在行業前列</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>