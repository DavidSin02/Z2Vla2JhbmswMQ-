<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>NLP任務中的文本預處理步驟、工具和示例 | 极客快訊</title><meta property="og:title" content="NLP任務中的文本預處理步驟、工具和示例 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/RqSgmP9HojtMNK"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/02a71e69.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/02a71e69.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/02a71e69.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/02a71e69.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/02a71e69.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/02a71e69.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/02a71e69.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/02a71e69.html><meta property="article:published_time" content="2020-11-14T21:00:59+08:00"><meta property="article:modified_time" content="2020-11-14T21:00:59+08:00"><meta name=Keywords content><meta name=description content="NLP任務中的文本預處理步驟、工具和示例"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/02a71e69.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>NLP任務中的文本預處理步驟、工具和示例</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><img alt=NLP任務中的文本預處理步驟、工具和示例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RqSgmP9HojtMNK><img alt=NLP任務中的文本預處理步驟、工具和示例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/SEcNnQO5cGc6EE><p>作者 | Viet Hoang Tran Duong</p><p>來源 | DeepHub IMBA</p><p>頭圖 | CSDN付費下載於視覺中國</p><p>數據是新的石油，文本是我們需要更深入鑽探的油井。文本數據無處不在，在實際使用之前，我們必須對其進行預處理，以使其適合我們的需求。對於數據也是如此，我們必須清理和預處理數據以符合我們的目的。這篇文章將包括一些簡單的方法來清洗和預處理文本數據以進行文本分析任務。</p><p>我們將在Covid-19 Twitter數據集上對該方法進行建模。這種方法有3個主要組成部分：</p><p>首先，我們要清理和過濾所有非英語的推文/文本，因為我們希望數據保持一致。</p><p>其次，我們為複雜的文本數據創建一個簡化的版本。</p><p>最後，我們將文本向量化並保存其嵌入以供將來分析。</p><img alt=NLP任務中的文本預處理步驟、工具和示例 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/SEcNnS282M9iw3><img alt=NLP任務中的文本預處理步驟、工具和示例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RqMqLxPCXik3SR><p></p><h1 toutiao-origin=h2>清理和過濾文本</h1><p>首先，為了簡化文本，我們要將文本標準化為僅為英文字符。此函數將刪除所有非英語字符。</p><pre><div><pre><div><pre><code>def clean_non_english(txt):<br>txt = re.sub(r'\W+', ' ', txt)<br>txt = txt.lower<br>txt = txt.replace("[^a-zA-Z]", " ")<br>word_tokens = word_tokenize(txt)<br>filtered_word = [w for w in word_tokens if all(ord(c) &lt; 128 for c in w)]<br>filtered_word = [w + " " for w in filtered_word]<br>return "".join(filtered_word)</code></pre></div></pre></div></pre><p>我們甚至可以通過刪除停止詞來做得更好。停詞是出現在英語句子中對意思沒有多大幫助的常見詞。我們將使用nltk包來過濾stopwords。由於我們的主要任務是使用word cloud將tweet的主題可視化，所以這一步需要避免使用“the，”“a，”等常見單詞。但是，如果你的任務需要完整的句子結構，比如下一個單詞預測或語法檢查，你可以跳過這一步。</p><pre><div><pre><div><pre><code>import nltk<br>nltk.download('punkt') # one time execution<br>nltk.download('stopwords')<br>from nltk.corpus import stopwords<br>stop_words = set(stopwords.words('english'))def clean_text(english_txt):<br>try:<br>word_tokens = word_tokenize(english_txt)<br>filtered_word = [w for w in word_tokens if not w in stop_words]<br>filtered_word = [w + " " for w in filtered_word]<br>return "".join(filtered_word)<br>except:<br>return np.nan</code></pre></div></pre></div></pre><p>對於tweets，在清理之前我們需要考慮一個特殊的特性:提及@。您的數據可能具有這樣的特殊特性(也可能沒有)，這是具體情況，而不是普遍要求。因此，在盲目地清理和預處理數據之前，要充分了解您的數據!</p><pre><code>def get_mention(txt):<br>mention = <br>for i in txt.split(" "):<br>if len(i) &gt; 0 and i[0] == "@":<br>mention.append(i)<br>return "".join([mention[i] + ", " if i != len(mention) - 1 else mention[i] for i in range(len(mention))]<br></code></pre><p>以前，我們清理非英文字符。現在，我們刪除非英語文本(語義上)。Langdetect是一個python包，它允許檢查文本的語言。它是谷歌的語言檢測庫從Java到Python的直接端移植。</p><pre><div><pre><code>from langdetect import detect<br>def detect_lang(txt):<br>try:<br>return detect(txt)<br>except:<br>return np.nan</code></pre></div></pre><p>然後我們過濾掉所有不是“en”語言的列。</p><img alt=NLP任務中的文本預處理步驟、工具和示例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RqMqLy93x95UEx><p><strong class=highlight-text toutiao-origin=span>簡化複雜的數據</strong></p><p>對於數值數據，良好的處理方法是縮放，標準化和規範化。此資源有助於理解並將這些方法應用於您的數據。在本文的討論範圍內，由於其他資源在此方面做得很好，因此我將不做進一步討論。</p><p>對於分類數據，有許多方法。兩種名義上的方法是標籤編碼器（為每個標籤分配一個不同的編號）和一種熱編碼（以0和1的向量表示）。有關這些分類值的方法的更多詳細信息，請參見此處。與我提到的這兩種資源相比，此資源非常豐富，具有更多類型的編碼。</p><p>這篇文章將介紹一些減少數據特別是位置數據複雜性的方法。在我的數據集中，有一列位置，帶有作者的地址。但是，由於這些原始數據過於混亂和複雜（具有城市，縣，州，國家/地區），因此我無法對其進行太多分析。因此，我們可以將文本標準化，並將其縮小到“國家”級別。處理位置數據的程序包是geopy。它可以識別正確的地址並將這些位置重新格式化為標準格式。然後，您可以選擇保留所需的任何信息。對我來說，國家，國家足夠體面。</p><pre><div><pre><code>from geopy.geocoders import Nominatim<br>geolocator = Nominatim(user_agent="twitter")def get_nation(txt):<br>try:<br>location = geolocator.geocode(txt)<br>x = location.address.split(",")[-1]<br>return x<br>except:<br>return np.nan<br></code></pre></div><br></pre><img alt=NLP任務中的文本預處理步驟、工具和示例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RqMqMYY7LcGio6><p></p><h1 toutiao-origin=h2>向量化和嵌入</h1><p>文本向量化將文本轉換為值的向量以表示其含義。早些時候，我們有一種熱編碼方法，其向量的大小與我們的詞彙量相同，在出現文本的任何地方都為1，在其他地方為0。如今，我們擁有更高級的方法，例如spacy，GloVe甚至bert嵌入。對於本項目的範圍，我將向您介紹python和Jupiter筆記本中的GloVe。</p><p>首先，我們下載嵌入向量。您可以在此處手動下載或直接在筆記本中進行下載。</p><pre><div><pre><code>!wget http://nlp.stanford.edu/data/glove.6B.zip<br>!unzip glove*.zip</code></pre></div></pre><p>然後，我們創建一個向量矢量化每個數據點的函數。句子是每個單詞的平均表示。對於空句子，我們將其默認為零向量。</p><pre><div><pre><code>def vectorize(value, word_embeddings, dim = 100):<br>sentences = value.to_list<br>sentence_vectors = <br>for i in sentences:<br>if len(i) != 0:<br>v = sum([word_embeddings.get(w, np.zeros((dim,))) for w in i.split()])/(len(i.split)+0.001)<br>else:<br>v = np.zeros((dim,))<br>sentence_vectors.append(v)<br>sentence_vectors = np.array(sentence_vectors)<br>return sentence_vectors</code></pre></div></pre><p>最後，我們對整個數據集進行矢量化處理，並將矢量化的numpy數組另存為文件，因此我們不必在每次運行代碼時都再次進行此過程。矢量化版本將以.npy文件的形式保存為numpy數組。Numpy包方便存儲和處理海量數組數據。</p><p>作為我的個人標準做法，我嘗試將每個部分之後的所有數據保存為單獨的文件，以評估數據並更靈活地更改代碼。</p><pre><div><pre><code>def vectorize_data(data = data, value = 'english_text', dim = 100):<br># Extract word vectors<br>word_embeddings = {}<br>f = open('glove.6B.{}d.txt'.format(str(dim)), encoding='utf-8')<br>for line in f:<br>values = line.split<br>word = values[0]<br>coefs = np.asarray(values[1:], dtype='float32')<br>word_embeddings[word] = coefs<br>f.close text_vec = vectorize(data[value], word_embeddings, dim)<br>np.save("vectorized_{}.npy".format(str(dim)), text_vec)<br>print("Done. Data:", text_vec.shape)<br>return True<br></code></pre></div><br></pre><img alt=NLP任務中的文本預處理步驟、工具和示例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RqMqMZM85xvsbJ><p></p><h1 toutiao-origin=h2>總結</h1><p>數據預處理，特別是文本預處理，可能是一個非常麻煩的過程。機器學習工程師工作流程的很大一部分將用於這些清理和格式化數據（如果您的數據已經完全清理好了，那麼，幸運的是，對於所有實現這一目標的工程師來說，他們都感到很榮幸）。</p><p>這篇文章中的所有代碼都是非常抽象的，可以應用於許多數據項目（您只需更改列名，所有代碼都可以正常工作）。在筆記本中，我還添加了異常功能來處理故障情況，以確保您的代碼不會在中途崩潰。我希望它對您的項目有幫助，就像對我的幫助一樣。</p><p>最後，所有的代碼可以在這裡找到：</p><p><strong toutiao-origin=em>https://github.com/viethoangtranduong/covid19-tweets</strong></p><img alt=NLP任務中的文本預處理步驟、工具和示例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/R69FpRH4d90a7d><img alt=NLP任務中的文本預處理步驟、工具和示例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/SEcNnBuCwlcZyE></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>示例</a></li><li><a>NLP</a></li><li><a>任務中</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/a2847433.html alt=常用JavaScript正則表達式彙編與示例詳解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/dca255e6-9611-4395-afc6-7e9fa5ac5e38 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a2847433.html title=常用JavaScript正則表達式彙編與示例詳解>常用JavaScript正則表達式彙編與示例詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/48f7c5e6.html alt=Java工具類教程：詳解正則表達式及應用示例 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/4002000140fde581089b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/48f7c5e6.html title=Java工具類教程：詳解正則表達式及應用示例>Java工具類教程：詳解正則表達式及應用示例</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/115806c0.html alt=Java正則表達式教程及示例 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/07559bf8adcd496d8267aad619be8a94 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/115806c0.html title=Java正則表達式教程及示例>Java正則表達式教程及示例</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/33d04d4d.html alt=2020年各大頂會NLP、ML優質論文分類整理分享 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/fb47112700b049aa88994c8949ec9403 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/33d04d4d.html title=2020年各大頂會NLP、ML優質論文分類整理分享>2020年各大頂會NLP、ML優質論文分類整理分享</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/971dc36b.html alt="Java集合 - TreeSet詳解和使用示例" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/f01f6ccf89994943be8d054a21c1a3fe style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/971dc36b.html title="Java集合 - TreeSet詳解和使用示例">Java集合 - TreeSet詳解和使用示例</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/65535165.html alt=mysql教程:MySQL多表查詢大全,18個示例總有你需要的 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/43cf07c314554ea0887eaa8fd25c178f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/65535165.html title=mysql教程:MySQL多表查詢大全,18個示例總有你需要的>mysql教程:MySQL多表查詢大全,18個示例總有你需要的</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/95e15a9d.html alt=9張人像照片示例，看懂攝影背景的重要性，讓好背景為人像加分 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1d639296ed584fc0b1b0ac0dae10b512 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/95e15a9d.html title=9張人像照片示例，看懂攝影背景的重要性，讓好背景為人像加分>9張人像照片示例，看懂攝影背景的重要性，讓好背景為人像加分</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bec17221.html alt=11張前景人像示例圖，避開3個錯誤，前景為照片加分畫面更唯美 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/edaa851f-b857-4333-8d1d-4d1951d8e517 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bec17221.html title=11張前景人像示例圖，避開3個錯誤，前景為照片加分畫面更唯美>11張前景人像示例圖，避開3個錯誤，前景為照片加分畫面更唯美</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7a11c4af.html alt=圖解BERT（NLP中的遷移學習） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b29b82aef73748bd9fc0a049212fba09 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7a11c4af.html title=圖解BERT（NLP中的遷移學習）>圖解BERT（NLP中的遷移學習）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/420d4250.html alt="用示例代碼講解：Python assert關鍵字原理及實例解析（已收藏）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9f44073603504c64b4064170f4b047ae style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/420d4250.html title="用示例代碼講解：Python assert關鍵字原理及實例解析（已收藏）">用示例代碼講解：Python assert關鍵字原理及實例解析（已收藏）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/30177cc2.html alt=NLP中的遷移學習 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1534906754727755a6a6964 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/30177cc2.html title=NLP中的遷移學習>NLP中的遷移學習</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/45cbe488.html alt=NLP基礎-通用句子向量漫談 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/db54188d47524055b7a45d90aed407ac style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/45cbe488.html title=NLP基礎-通用句子向量漫談>NLP基礎-通用句子向量漫談</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/760de6b8.html alt=NLP領域中的遷移學習現狀 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/RayMFst8jYuQgG style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/760de6b8.html title=NLP領域中的遷移學習現狀>NLP領域中的遷移學習現狀</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f34d1055.html alt="ACL 2019 | 南大NLP，知識庫問答中的表示映射學習" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RdGewJX7BKaFVS style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f34d1055.html title="ACL 2019 | 南大NLP，知識庫問答中的表示映射學習">ACL 2019 | 南大NLP，知識庫問答中的表示映射學習</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a73c5785.html alt="「NLP 必備知識點」自然語言理解 NLU（概念+應用+3種實現方式）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8cc2bb8a2c0f4d529fd624f5df2fc70c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a73c5785.html title="「NLP 必備知識點」自然語言理解 NLU（概念+應用+3種實現方式）">「NLP 必備知識點」自然語言理解 NLU（概念+應用+3種實現方式）</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>