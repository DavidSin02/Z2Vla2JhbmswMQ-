<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>產品經理也能動手實踐的AI（七）- 正規化&深入卷積神經網絡 | 极客快訊</title><meta property="og:title" content="產品經理也能動手實踐的AI（七）- 正規化&深入卷積神經網絡 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/c4717cfbf47c4426a6c37eeac5818da6"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0572573.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0572573.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0572573.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0572573.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0572573.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0572573.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0572573.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0572573.html><meta property="article:published_time" content="2020-10-29T20:59:29+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:29+08:00"><meta name=Keywords content><meta name=description content="產品經理也能動手實踐的AI（七）- 正規化&深入卷積神經網絡"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/0572573.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>產品經理也能動手實踐的AI（七）- 正規化&深入卷積神經網絡</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>正文共： 3002字 8圖</p><p>預計閱讀時間： 8分鐘</p><div class=pgc-img><img alt="產品經理也能動手實踐的AI（七）- 正規化&深入卷積神經網絡" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c4717cfbf47c4426a6c37eeac5818da6><p class=pgc-img-caption></p></div><p>好久沒更新了，Lesson5是個坎，也不是裡面內容有多難，可能是知識點比較雜亂，所以一直沒有產出，今天把Lesson6看完了，視頻1遍，練習一遍，文字一遍（Transcript），算是基本都理解了，所以上一課的內容之後更新吧。</p><p>1.概覽</p><p>本節主要圍繞兩個例子：1.根據Rossmann商店運營數據預測未來銷量 2.用寵物識別的例子講解CNN原理</p><p>講解了正則化 Regularization 的 dropout 和卷積神經網絡 CNN</p><p>2.1核心概念</p><ol><li>連續變量和非連續變量：很多看起來的連續變量作為類別效果更好，比如一週的第N天</li><li>Dropout：一種Regularization方法，可以避免過度擬合，原理是類似於隨機抽一部分老師來監考，防止內外勾結，通過P值來控制挑選的概率</li><li>Batch Normalization：通過小批次的Normalization，加速訓練，因為可以把問題簡化到每個批次上</li><li>Transform：對圖片進行亮度、飽和度、灰度、扭曲、翻轉等操作，從而提高訓練效果，因為相當於多了N倍的訓練圖像</li><li>Convolution & Kernel：類似於PS中的濾鏡，通過一個N*N的kernel，將每個小塊的圖像重新加工成新圖像上的點。最上面的這個3*3的就是Kernel，像一個過濾器，針對圖像上的3*3的一個塊，矩陣乘積後，生成新圖像的一個點。http://setosa.io/ev/image-kernels</li></ol><div class=pgc-img><img alt="產品經理也能動手實踐的AI（七）- 正規化&深入卷積神經網絡" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/286b1995898441ab87a83ca809fedc0e><p class=pgc-img-caption></p></div><ol><li><br></li><li>特徵點熱力圖：讓ML變得可以解釋，通過熱力圖，顯示機器是根據圖像上的哪部分的特徵點判斷屬於哪個類別，效果如下</li></ol><div class=pgc-img><img alt="產品經理也能動手實踐的AI（七）- 正規化&深入卷積神經網絡" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/7117e4cbea554aa9ac720cd171d19289><p class=pgc-img-caption></p></div><p>2.2機器學習概念</p><ul><li>Normalization：將數據轉換到[0,1]區間，如下圖公式，還有其他變種</li></ul><div class=pgc-img><img alt="產品經理也能動手實踐的AI（七）- 正規化&深入卷積神經網絡" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/179e0895ec094cb286a228eeaa085b04><p class=pgc-img-caption></p></div><ul><li><br></li><li>Regularization：loss function的懲罰機制，防止overfit</li><li>Weight Decay：L2 regularization 的升級版</li><li>Model 內部結構，一個基礎的block，2d就是二階向量</li><li class=ql-indent-1>Conv2d</li><li class=ql-indent-1>BatchNorm2d</li><li class=ql-indent-1>ReLu</li><li class=ql-indent-1>Conv2d</li><li class=ql-indent-1>BatchNorm2d</li><li>Data argumentation：數據增強，通過transform把圖片各種變形，以達到更好的訓練效果</li><li>卷積：一個用RGB顯示的圖片，會存儲為一個3階張量，於是也需要把Kernel變為一個3階張量</li></ul><div class=pgc-img><img alt="產品經理也能動手實踐的AI（七）- 正規化&深入卷積神經網絡" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/edd936124d794459a6acdc0d8b279c84><p class=pgc-img-caption></p></div><ul><li><br></li><li>Channel：用了多少個Kernel，就會產生多少channel，近似於feature，如圖生成了16個channel，</li><li>Stride：步伐，為了降低內存佔用，如果步伐為2，則每次和Kernel的運算會跳過一個，所以生成的tensor高寬會/2,channel會*2</li><li>Average pooling：相當於求縱向的平均值，比如最後生成了11*11*512的tensor，那就求11*11平面上每個點的縱向512個值的均值，這樣得到的11*11的值就可以用於熱力圖的顯示</li></ul><p>2.3 FastAI命令</p><ul><li>add_datepart：可以將日期轉化成每週的第N天，每月每年的第N天，是否是月初或月末等</li><li>label class (label_cls=FloatList)：設置label值為float，因為int會被當成分類任務，本節課是要預測銷量</li><li>procs=[FillMissing, Categorify, Normalize]：數據訓練前的一次性處理，process設置的簡寫</li><li>data.one_item(x)：創建一個mini-batch的數據</li><li>data.cuda()：放到GPU上</li></ul><p>2.4 Pandas命令</p><ul><li>train_df.head().T：可以轉置表格數據</li><li>small_train_df.PromoInterval.cat.categories：查看類別</li><li>small_train_df['PromoInterval'].cat.codes[:5]：查看類別對應的編號，-1就是不存在的意思</li></ul><p>2.5 PyTorch命令</p><ul><li>hook：可以調取訓練過程的任意環節</li><li>hook.store()：存下來</li><li>t[None]：維度+1</li></ul><p>3.1實例詳細分析</p><p>根據Rossmann商店數據，還有競爭對手數據，預測銷量</p><ol><li>數據有點老，所以專門有個data_clean的文件先把數據處理一遍，主要是把需要的數據提煉出來合成一張表</li><li>先小範圍測試下數據</li><li class=ql-indent-1>主要是區分類別變量和連續變量，會把類別變量都映射成數字</li><li class=ql-indent-1>空數據用類別方式標註</li><li class=ql-indent-1>數據歸一化Normalization</li><li>在準備完整數據</li><li>然後用tabular_learner跑數據</li></ol><pre>data = (TabularList.from_df(df, path=path, cat_names=cat_vars, cont_names=cont_vars, procs=procs,) .split_by_idx(valid_idx) .label_from_df(cols=dep_var, label_cls=FloatList, log=True) .add_test(TabularList.from_df(test_df, path=path, cat_names=cat_vars, cont_names=cont_vars)) .databunch())</pre><pre>learn = tabular_learner(data, layers=[1000,500], ps=[0.001,0.01], emb_drop=0.04, y_range=y_range, metrics=exp_rmspe)</pre><p>3.2實例詳細分析</p><p>寵物圖片增強，找到cnn是通過哪部分的特徵，識別了這張圖，熱力圖</p><ol><li>創建databunch</li><li>變形transform</li><li>cnn訓練模型</li><li>卷積內核</li><li>熱力圖</li><li>grad-cam</li></ol><pre>src = ImageList.from_folder(path).split_by_rand_pct(0.2,seed=2)def get_data(size, bs, padding_mode='reflection'): return (src.label_from_re(r'([^/]+)_\d+.jpg$') .transform(tfms, size=size, padding_mode=padding_mode) .databunch(bs=bs).normalize(imagenet_stats))</pre><pre>learn = cnn_learner(data,models.resnet34,metrics=error_rate,bn_final=True)</pre><pre>def show_heatmap(hm): _,ax = plt.subplots() xb_im.show(ax) ax.imshow(hm, alpha=0.8, extent=(0,352,352,0), interpolation='bilinear', cmap='magma');show_heatmap(avg_acts)</pre><p>4.最後</p><p>本課還講了platform.ai和AI的倫理，platform.ai是一個快速訓練未打標籤的數據的網站，AI倫理講的是很多性別偏見，以及過度滿足人性的推薦系統，釀成的悲劇，號召從業者用技術將生活變得更好，而不是製造更多衝突。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>產品</a></li><li><a>經理</a></li><li><a>能動手</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/79a9527e.html alt=產品經理如何做好“接盤俠” class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/S6Z8jBPBOAgM0J style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/79a9527e.html title=產品經理如何做好“接盤俠”>產品經理如何做好“接盤俠”</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6c710068.html alt=產品經理如何把控產品開發的進度 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RRaRlDtIbV7LEn style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6c710068.html title=產品經理如何把控產品開發的進度>產品經理如何把控產品開發的進度</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fcfef6ea.html alt=產品經理必學UML（二）：用例圖 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RWXs3qRANozueo style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fcfef6ea.html title=產品經理必學UML（二）：用例圖>產品經理必學UML（二）：用例圖</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/0773daa8.html alt=AI產品經理需要了解的線性代數通識 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/RZBinQl1iTKfi5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/0773daa8.html title=AI產品經理需要了解的線性代數通識>AI產品經理需要了解的線性代數通識</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/752da4f4.html alt=IVD產品經理系列——實驗室運營分類知識文庫（8）生化 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/43490001d5eba238bfba style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/752da4f4.html title=IVD產品經理系列——實驗室運營分類知識文庫（8）生化>IVD產品經理系列——實驗室運營分類知識文庫（8）生化</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/4523a341.html alt=IVD產品經理系列-生化知識細說之性激素 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/43610002bc9f448860c4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/4523a341.html title=IVD產品經理系列-生化知識細說之性激素>IVD產品經理系列-生化知識細說之性激素</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5a4c09c5.html alt=產品經理需要了解的接口知識 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ResiLEP7Fs6Vgz style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5a4c09c5.html title=產品經理需要了解的接口知識>產品經理需要了解的接口知識</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c126e804.html alt=產品經理必會：項目管理流程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/S6mYp6b2gXAllh style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c126e804.html title=產品經理必會：項目管理流程>產品經理必會：項目管理流程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bb19b86c.html alt=產品經理的古典主義：交互設計和信息架構 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/RjSPv0E1g4aHlS style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bb19b86c.html title=產品經理的古典主義：交互設計和信息架構>產品經理的古典主義：交互設計和信息架構</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e7f5b1bf.html alt=產品經理的價值輸出：需求分析 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/S3Acsjl5gH1vPK style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e7f5b1bf.html title=產品經理的價值輸出：需求分析>產品經理的價值輸出：需求分析</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0e028b3b.html alt=產品經理需要掌握的需求管理三要素：真偽需求，優先級，需求池 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/c396bbc4657c462cb99d572329f60414 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0e028b3b.html title=產品經理需要掌握的需求管理三要素：真偽需求，優先級，需求池>產品經理需要掌握的需求管理三要素：真偽需求，優先級，需求池</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e77593e0.html alt=淺談“產品定型”以及“產品迭代”｜產品經理筆記05 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/594900031fbfd03932dd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e77593e0.html title=淺談“產品定型”以及“產品迭代”｜產品經理筆記05>淺談“產品定型”以及“產品迭代”｜產品經理筆記05</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7d55282.html alt=AI產品經理，如何從零開始打造專業領域的停用詞庫 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RJtwhbx4rLzC0a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7d55282.html title=AI產品經理，如何從零開始打造專業領域的停用詞庫>AI產品經理，如何從零開始打造專業領域的停用詞庫</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7f1f9c6.html alt=產品經理的技術修行筆記——數據結構篇 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/78b20001fcb05ffd8217 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7f1f9c6.html title=產品經理的技術修行筆記——數據結構篇>產品經理的技術修行筆記——數據結構篇</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/71e3431.html alt=產品經理要是再惹你就用這個腳本，隨機刪除系統一半文件 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0582ea48d4824485b950850a38bba8c0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/71e3431.html title=產品經理要是再惹你就用這個腳本，隨機刪除系統一半文件>產品經理要是再惹你就用這個腳本，隨機刪除系統一半文件</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>