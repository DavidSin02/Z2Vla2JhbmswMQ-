<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>單片機學習問題集，都搞懂你就厲害了 | 极客快訊</title><meta property="og:title" content="單片機學習問題集，都搞懂你就厲害了 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/1528167865539cef4f5fa12"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0d56a2ff.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0d56a2ff.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0d56a2ff.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0d56a2ff.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0d56a2ff.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0d56a2ff.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0d56a2ff.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0d56a2ff.html><meta property="article:published_time" content="2020-11-14T20:55:07+08:00"><meta property="article:modified_time" content="2020-11-14T20:55:07+08:00"><meta name=Keywords content><meta name=description content="單片機學習問題集，都搞懂你就厲害了"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/0d56a2ff.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>單片機學習問題集，都搞懂你就厲害了</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><div class=pgc-img><img alt=單片機學習問題集，都搞懂你就厲害了 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1528167865539cef4f5fa12><p class=pgc-img-caption></p></div><ol><li>單片機的最小系統？內部的主要結構？</li><li>答：最小系統：電源、晶振（為系統提供基本的時鐘信號）、復位電路；內部結構：ROM/RAM、計時器、中斷、I/O串並行口、總線擴展控制。</li><li>RAM和ROM的區別？</li><li>答：ROM（只讀存儲器）：它的信息一次寫入後只能被讀出，而不能被操作者修改或者刪除。一般用於存放固定的程序或數據表格。但是，“只讀”這個概念有時候可以被一些新特性的器件顛覆。</li><li>RAM（隨機存儲器）：它就是我們平時說的內存，主要用來存放各種現場的輸入/輸出數據、中間計算結果，以及與外部存儲器交換信息，或者作堆棧（特點：先進後出，後進先出）用。它的存儲單元根據具體需要可以讀出或者改寫。</li><li>兩者區別：RAM只能用於暫時存放程序與數據。一旦電源關閉或發生斷電，RAM中的數據就會丟失。而ROM中的數據在電源關閉或者斷電後仍然會保留下來。</li><li>簡而言之：相同點它們都是用來存儲數據的</li><li>不同點存儲數據的方式與數據能不能在二次加工不同</li><li>單片機I/O口有什麼作用？I/0口的驅動能力？上拉電阻與下拉電阻的作用？</li><li>答：I/O口最主要的功能用來與外部器件實現數據信息的交互、速度匹配、數據傳送方式和增強單片機的負載能力。它在兩者之間扮演橋樑的作用，單片機擁有著串行與並行接口。每個種類的單片機的不同並行口也有著各自不同的功能。</li><li>單片機輸出低電平時，將允許外部器件，向單片機引腳內灌入電流，這個電流，稱為“灌電流”，外部電路稱為“灌電流負載”。</li><li>單片機輸出高電平時，則允許外部器件，從單片機的引腳拉出電流，這個電流，稱為“拉電流”，外部電路稱為“拉電流負載”。</li><li>單片機輸出驅動能力的問題：每個單個的引腳，輸出低電平的時候，允許外部電路，向引腳灌入的最大電流為 10 mA；每個 8 位的接口（P1、P2 以及 P3），允許向引腳灌入的總電流最大為 15 mA，而 P0 的能力強一些，允許向引腳灌入的最大總電流為26 mA；全部的四個接口所允許的灌電流之和，最大為 71 mA。而當這些引腳“輸出高電平”的時候，單片機的“拉電流”能力呢？可以說是太差了，竟然不到 1 mA。</li></ol><div class=pgc-img><img alt=單片機學習問題集，都搞懂你就厲害了 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528167968961390a93f6e8><p class=pgc-img-caption></p></div><ol><li><br></li><li>結論就是：單片機輸出低電平的時候，驅動能力尚可，而輸出高電平的時候，就沒有輸出電流的能力。</li><li>綜上所述：灌電流負載，是合理的；而“拉電流負載”和“上拉電阻”會產生很大的無效電流，並且功耗大。</li><li>設計單片機的負載電路，應該採用“灌電流負載”的電路形式，以避免無謂的電流消耗。</li><li>在數字電路中，只有二種狀態，要麼是高電平，要麼是低電平，在通電初期，這些輸出狀態是不確定的，為了使電路確定狀態，必需使用上拉電阻或下拉電阻，使一個原來不確定電平變高的叫上拉電阻，否則就是下拉電阻，上拉電阻就是從電源上接一隻電阻到這個狀態口上就可以了，（就是把高的電壓加到這個點上去，這個點的電位就高了）下拉電阻的接法，從這個狀態口接一隻電阻到負極（或數字接地），因電路形式與類別不同，當輸入端有信號，這種變化會反應到輸出口，從輸出口得到了一個狀態，本來應該完成任務了，但這會兒輸入口已沒信號了，可輸出端還是這個狀態（這個人習慣不好，開門後總是不關門，加一隻彈簧，（電阻）讓它自己關門，）這時候也要用到上下拉電阻，這裡有復位的作用。</li><li>常見的時鐘電路有哪些？為什麼要使用PLL？</li></ol><p>答：先了解一下什麼是時鐘電路？</p><p>時鐘電路就是產生像時鐘一樣準確運動的振盪電路，任何工作都按時間順序。用於產生這個時間的電路就是時鐘電路。</p><p>組成：晶體振盪器、晶震控制芯片和電容組成。</p><p>現在流行的串行時鐘電路有：DS1302、DS1307、PCF8485等</p><p>它們的特點：接口簡單、價格低廉、使用方便。</p><p>DS1302：具有涓細電流充電能力的電路，主要特點：採用串行數據傳輸，可為掉電保護電源提供可編程的充電功能，並且可以關閉充電功能。採用普通32.768KHz晶振。</p><p>PLL（PhaseLocked Loop）:鎖相環電路。用來統一整合時脈訊號，使高頻器件正常工作。如：內存的存取資料等。PLL用於振盪器中的反饋技術。許多電子設備要正常工作，通常需要外部的輸入信號與內部的振盪信號同步。一般的晶振由於工藝與成本原因，做不到很高的頻率，而在需要高頻應用時，有相應的器件VCO，實現轉成高頻，但不穩定，故利用鎖相環路就可以實現穩定且高頻的時脈衝訊號。</p><div class=pgc-img><img alt=單片機學習問題集，都搞懂你就厲害了 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15281679913150cdb69af64><p class=pgc-img-caption></p></div><p>什麼是時脈：指同步電路中時鐘的基礎頻率，它以（若千次週期每秒）來度量，單位是（Hz）</p><p>總之：PLL可以同步頻率，相位正交。倍頻、變頻。</p><ol><li>單片機的尋址方式有哪些？</li><li>答：80C51有七種尋址方式：</li></ol><p>1、立即尋址，尋址空間為ROM；</p><p>2、直接尋址，尋址空間為片內RAM的低128B和特殊功能寄存器；</p><p>3、寄存器尋址，尋址空間為A、B、DPTR、CY、通用工作寄存器等；</p><p>4、寄存器間接尋址，片內RAM低128B、片外RAM；</p><p>5、相對尋址，尋址空間為ROM；</p><p>6、變址尋址，尋址空間為ROM；</p><p>7、位尋址，尋址空間為片內RAM低128B的位尋址區的128個位，其字節地址為20H~2FH；以及部分可以位尋址的特殊功能寄存器。</p><p>參考：AT89C51單片機能直接認識和執行的機器指令有255條，有7種尋址方式，即立即尋址、直接尋址、寄存器尋址、寄存器間接尋址、變址尋址、相對尋址和位尋址。</p><p>1. 直接尋址：</p><p>指令中直接給出參與操作的數據的地址，該地址一般用direct表示。</p><p>彙編指令：MOV A,direct</p><p>該指令的功能是將片內RAM地址direct單元中的內容（參與操作的數據）傳送到累加器A中，雙字節指令。</p><p>2. 立即尋址：</p><p>指令中直接給出參與操作的數據，稱立即數，用data表示。在彙編語言中，為標明立即數，為data加前綴”#”。立即數可以是8位和16位二進制數，分別用#data和#data16表示。</p><p>彙編語言指令：MOV A,#data</p><p>該指令將立即數data傳送到累加器A中，雙字節指令。</p><p>3. 寄存器尋址：</p><p>參與操作的數據存放在寄存器中，彙編指令中直接以寄存器名來表示參與操作的數據地址，寄存器包括工作寄存器R0～R7、累加器A、AB、數據指針DPTR和位運算寄存器C。</p><p>彙編語言指令：MOV A,Rn ;n=0~7</p><p>該指令將Rn中的內容傳送到累加器A中，單字節指令。</p><p>4. 寄存器間接尋址：</p><p>寄存器間接尋址為二次尋址，第一次尋址得到寄存器的內容為(Ri)或(DPTR)，第二次尋址是將第一次尋址得到的寄存器內容作為地址，並在其中存、取參與操作的數據。彙編語言中，寄存器前綴@是寄存器間接尋址的標誌，有@Ri、@DPTR等。</p><p>彙編語言指令：MOV A,@Ri ;i=0、1</p><p>該指令是將Ri中的內容作為地址，再將該地址中的內容傳送到累加器A中，單字節指令。</p><div class=pgc-img><img alt=單片機學習問題集，都搞懂你就厲害了 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/152816801606683293a4e3a><p class=pgc-img-caption></p></div><p>5. 變址尋址：</p><p>間接尋址由兩個寄存器提供。若由A、PC提供，在彙編語言指令中尋址地址表示為@A+PC；若由A和DPTR提供，在彙編語言指令中尋址地址為@A+DPTR。其中，PC或DPTR被稱為基址寄存器，A被稱為變址寄存器，基址與變址相加為16位無符號加法。若變址寄存器A中內容加基址寄存器DPTR(或PC)中內容時，低8位有進位，則該進位直接加到高位，不影響進位標誌。因變址尋址指令多用於查表，故常稱為查表指令。</p><p>彙編語言指令：MOVC A,@A+DPTR</p><p>該指令將DPTR中的內容加上A中的內容作為地址，再將該地址中的內容傳送到累加器A中，單字節指令。</p><p>6. 相對尋址：</p><p>相對尋址是以相對尋址指令的下一條指令的程序計數器PC的內容為基值，加上指令機器代碼中的“相對地址”，形成新的PC值（要轉移的指令地址）的尋址方式。指令機器代碼中“相對地址”指的是用一個帶符號的8位二進制補碼錶示的偏移字節數，其取值範圍為-128～+127，負數表示向後轉移，正數表示向前轉移。</p><p>若(PC)表示該指令在ROM中的首地址，該指令字節數為2，執行時分兩步操作：(PC)←(PC)+2，(PC)←(PC)+相對地址。第一步完成後，PC中的值為該指令的下一條指令的首地址；第二步完成後，PC中的內容(PC)為轉移的目標地址。所以，轉移的目標地址範圍是該相對尋址指令的下一條指令首址加上-128～—+127字節的地址。</p><p>彙編語言指令：SJMP rel</p><p>彙編語言相對尋址指令中的”rel”往往是一個標號地址，表示ROM中某轉移目標地址。彙編軟件對該彙編語言指令進行彙編時，自動算出“相對地址”並填入機器代碼中，應將”rel”理解為“帶有相對意義的轉移目標地址”。</p><p>Rel=(PC)+相對尋址指令字節數+相對地址</p><p>其中，(PC)為該指令所在ROM中的首地址。</p><p>7. 位尋址：</p><p>參與操作的數據為“位”，而不是字節，是對片內數據存儲器RAM和SFR中可位尋址單元的位進行操作的尋址方式。</p><p>彙編語言指令：ANL C,bit</p><p>該指令將bit（位地址）中的內容（0或1）與C中的內容進行與操作，再將結果傳送到PSW中的進位標誌C中。</p><ol><li>什麼是時鐘週期？機器週期？指令週期？它們之間的關係？</li><li>答：1、時鐘週期又叫做振盪週期；單片機內部時鐘電路產生（或外部時鐘電路送入）的信號週期，單片機的時序信號是以時鐘週期信號為基礎而形成的，在它的基礎上形成了機器週期、指令週期和各種時序信號。定義為時鐘脈衝的倒數（可以這樣理解：時鐘週期就是單片機外接晶振的倒數，例如：12M的晶振，它的時鐘週期就是1/12us），是計算機中最基本的、最小的時間單位。在一個時鐘週期內，CPU僅完成一個最基本的動作。</li><li>2、計算機中，為了便於管理，常把一條指令的執行過程劃分為若干個階段，每一個階段完成一項工作。例如：取指令、存儲器讀、存儲器寫等，這每一項工作稱為一個基本操作。完成一項基本操作所需要的時間成為機器週期。一般情況，一個機器週期由若干個S週期（狀態週期）組成。機器週期是單片機的基本操作週期，每個機器週期包含S1、S2、……S6這6個狀態，每個狀態包含兩拍P1和P2，每個拍為一個時鐘週期（振盪週期）。因此，一個機器週期包含12個時鐘週期。依次可表示為S1P1、S1P2、S2P1、S2P2……、S6P1、S6P2。</li><li>3、指令週期：計算機從取一條指令開始，到執行完該指令所需要的時間稱為指令週期。不同的指令，指令長度不同，指令週期也不一樣。但指令週期以機器週期為單位，指令不同，所需的機器指令也不同。</li><li>51單片機指令根據指令長度與執行週期分為：</li><li>1） 單字節單週期指令</li><li>2） 單字節雙週期指令</li><li>3） 雙字節單週期指令</li><li>4） 雙字節雙週期指令</li><li>5） 三字節雙週期指令</li><li>6） 一字節四周期指令</li><li>總結：時鐘週期是最小單位，機器週期需要1個或者多個時鐘週期，指令週期需要1個或者多個機器週期；機器週期是指完成一個基本操作的時間。指令週期是CPU的關鍵指標，指取出並執行一條指令的時間。一般以機器週期為單位，分單指令執行週期、雙指令執行週期等。機器週期是完成一個基本操作的時間單元。時鐘週期是CPU的晶振的工作頻率的倒數。</li><li>單片機有哪些接口，各模塊有哪些特性及應用環境?</li><li>答：接口電路——用於銜接外設與總線，實現存儲空間擴展、I/O口線擴展、類型轉換（電平轉換、串並轉換、A/D轉換）、功能模塊、通信擴展、總線擴展等。</li><li>外圍設備——工作設備，連接在接口電路上，主要有輸出設備和輸入設備。</li></ol><p><strong>看門狗相關問題</strong>:</p><ol><li>看門狗的原理?</li><li>答：工作原理：在系統運行以後就啟動看門狗計數器，此時看門狗就開始自動計時，如果達到一定的時間還不去給它進行清零，看門狗計數器就會溢出從而引起看門狗中斷，造成系統的復位。</li><li>為什麼會溢出呢？</li><li>因為看門狗是一個計數器，而計數器位數有限。能夠裝的數值也就有限（比如8位的最多裝256個數，16位的最多裝65536個數），從開啟看門狗那刻起，它就開始不停的數機器週期，數一個機器週期就計數器加1，加到計數器盛不下了（這就是溢出）就產生一個復位信號，重啟系統。</li><li>看門狗分為軟件看門狗和硬件看門狗,在什麼情況下軟件看門狗失效?</li><li>答：硬件看門狗是利用一個定時器電路，其定時輸出連接到電路的復位端，程序在一定時間範圍內對定時器清零，因此程序正常工作時，定時器總不能溢出，也就不能產生復位信號。如果程序出現故障，不在定時週期內復位看門狗，就使得看門狗定時器溢出產生復位信號並重啟系統。</li><li>軟件看門狗原理上一樣，只是將硬件電路上的定時器用處理器的內部定時器代替，這樣可以簡化硬件電路設計，但是在可靠性方面不如硬件定時器。</li><li>1、系統內部定時器自身發生故障看門狗就會失效（當然可以通過雙定時器相互監視，成本高）；</li><li>2、中斷系統故障導致定時器中斷失效。</li><li>3、整個程序死機。主程序出現異常。</li><li>什麼時候喂狗？怎麼喂狗?喂狗的注意事項?</li><li>答：在實際的單片機應用系統中，到底選用哪種型號的看門狗，採用何種喂狗方式和看門狗連接方式以及在編程中喂狗命令應該放在程序中什麼位置，這要根據現場干擾源的特點、已採用的干擾措施、單片機硬件資源和軟件結構特點以及對單片機系統的可靠性等具體情況而定。</li><li>看門狗一般應用到程序的那些位置?</li><li>答： 一些重要的程序，必須讓它一直跑著；而且還要時時關心它的狀態——不能讓它出現死鎖現象。（當然，如果一個主程序會出現死鎖，肯定是設計或者編程上的失誤。首要做的事是Debug。）但如果時間緊迫可以用軟件看門狗，暫時應急。</li><li>喂狗命令放置位置：</li><li>定時中斷服務子程序中；</li><li>主程序中.</li></ol><p><strong>復位相關問題</strong>:</p><ol><li>復位時單片機有什麼動作?</li><li>答：主要做的就是初始化每個寄存器，包括最重要的PC指針，不包括RAM，然後單片機從復位地址開始執行程序。</li><li>必須使RST引腳（9）加上持續兩個機器週期（即24個振盪週期）的高電平。單片機就執行復位操作。如果RST持續為高電平，單片機就處於循環復位狀態。</li><li>單片機有哪些復位源，什麼情況下會導致各個復位源</li><li>答：</li><li>6個復位源</li><li>TM4C123GH6PM微控制器有6個復位源：</li><li>（1）上電覆位（POR）；</li><li>（2）外部復位輸入引腳有效（RST）；</li><li>（3）掉電檢測可以用於由以下任一事件引起：① 低於BOR0，觸發值是BOR0的 最高電壓值；② 低於BOR1，觸發值是BOR1的最高 電壓值。</li><li>（4）軟件啟動復位（利用軟件復位寄存器）；</li><li>（5）違反看門狗復位條件；</li><li>（6）MOSC故障。</li><li></li><li>STM8S共有9個復位源：</li><li>NRST引腳產生的外部復位</li><li>上電覆位(POR)</li><li>掉電覆位(BOR)</li><li>獨立看門狗復位</li><li>窗口看門狗復位</li><li>軟件復位</li><li>SWIM復位</li><li>非法操作碼復位</li><li>EMS復位：當一些關鍵的寄存器被破壞或錯誤加載時產生的復位</li><li>所有的復位源最終都作用於NRST管腳，並在復位過程中保持低電平。復位入口向量在內存映射中位於固定的地址6000h。</li><li>復位的兩種啟動方式?</li><li>答：1、上電覆位：要求接通電源後，自動實現復位操作。</li><li>2、按鈕復位：要求接通電源後，單片機自動復位，並且在單片機運行期間，使用開關也可以實現復位。</li><li>復位存在哪些問題?</li><li>答：採用上電覆位：復位信號上電過程中有掉電現象，可能會造成邏輯方面的錯誤導致相關芯片復位時間不夠、二次復位等、從而不能夠正常工作起來。原因：產生的復位信號給了幾個芯片用，導致這個復位信號的負載壓力比較大，驅動能力不夠從而往下調電，此現象常常出現在RC復位上。</li><li>復位信號上電前有毛刺與復位信號上電時有毛刺，可能會造成邏輯方面的錯誤導致相關芯片復位時間不夠。方案：加大上拉電阻的阻值。</li><li>復位電路有哪些?那種比較好?</li><li>答：單片機復位電路主要有四種類型:</li><li>(1)微分型復位電路：</li><li>(2)積分型復位電路：</li><li>(3)比較器型復位電路：</li><li>比較器型復位電路的基本原理。上電覆位時,由於組成了一個RC低通網絡,所以比較器的正相輸入端的電壓比負相端輸入電壓延遲一定時間.而比較器的負相端網絡的時間常數遠遠小於正相端RC網絡的時間常數,因此在正端電壓還沒有超過負端電壓時,比較器輸出低電平,經反相器後產生高電平.復位脈衝的寬度主要取決於正常電壓上升的速度.由於負端電壓放電迴路時間常數較大,因此對電源電壓的波動不敏感.但是容易產生以下二種不利現象：</li><li>1)電源二次開關間隔太短時,復位不可靠：</li><li>2)當電源電壓中有浪湧現象時,可能在浪湧消失後不能產生復位脈衝。</li><li>為此,將改進比較器重定電路,可以利用數字邏輯的方法和比較器配合,設計的比較器重定電路。此電路稍加改進即可作為上電覆位和看門狗復位電路共同復位的電路,大大提高了復位的可靠性。</li><li>(4)看門狗型復位電路.</li><li>看門狗型復位電路主要利用CPU正常工作時,定時復位計數器,使得計數器的值不超過某一設定的值;當CPU不能正常工作時,由於計數器不能被複位,因此其計數會超過某一值,從而產生復位脈衝,使得CPU恢復正常工作狀態。此復位電路的可靠性主要取決於軟件設計,即將定時向復位電路發出脈衝的程序放在何處是最優的設計。一般設計，將此段程序放在定時器中斷服務子程序中。然而，有時這種設計仍然會引起程序走飛或工作不正常。原因主要是：當程序"走飛"發生時，定時器初始化以及開中斷之後的話,這種"走飛"情況就有可能不能由Watchdog復位電路校正回來.因為定時器中斷一真在產生,即使程序不正常,Watchdog也能被正常復位.為此提出定時器加預設的設計方法.即在初始化時壓入堆棧一個地址,在此地址內執行的是一條關中斷和一條死循環語句.在所有不被程序代碼佔用的地址儘可能地用子程序返回指令RET代替.這樣,當程序走飛後,其進入陷阱的可能性將大大增加.而一旦進入陷阱,定時器停止工作並且關閉中斷,從而使Watchdog復位電路會產生一個復位脈衝將CPU復位.當然這種技術用於實時性較強的控制或處理軟件中有一定的困難。</li><li>由此可見,四種復位電路中,看門狗型復位電路較其他三中復位電路更加適合。</li></ol><p><strong>堆棧相關問題</strong>:</p><ol><li>堆棧的原理？過程怎麼操作？</li><li>答：單片機RAM中，常常會指定一個專門的區域來存放某些特別的數據，它遵循先進後出、後進先出的原則。這個RAM區就是堆棧。堆棧是一種數據結構（數據項按序排列：堆，順序隨意。棧，後進先出）。使用一個稱作堆棧指針的專用寄存器指示前的操作位置，堆棧指針總是指向棧頂。</li><li>操作過程：</li><li>1） 堆棧的建立（初始化）</li><li>2） 參數入棧（push）</li><li>3） 參數出棧（pop）(後進先出)</li><li>堆棧應用在什麼地方？存在什麼問題？怎麼解決？</li><li>答：在80C51單片機中，堆棧在子程序調用和中斷時會把斷點地址自動進棧和出棧。進棧和出棧的指令(PUSH、POP)操作可用於保護現場和恢復現場。由於子程序調用和中斷都允許嵌套，並可以多級嵌套，而現場的保護也往往使用堆棧，所以一定要注意給堆棧以一定的深度，以免造成堆棧內容的破壞而引起程序執行的“跑飛”。</li><li></li><li>堆棧指針SP在80C51中存放當前的堆棧棧頂所指存儲單元地址的一個8位寄存器。80C51單片機的堆棧是向上生成的，即進棧時SP的內容是增加的；出棧時SP的內容是減少的。</li><li>系統復位後。80C51的SP內容為07H。若不重新定義，則以07H為棧底，壓棧的內容從08H單元開始存放。但工作寄存器R0～R7有4組，佔有內部RAM地址為00H～1FH，位尋址區佔有內部RAM地址為20H～2FH。若程序中使用了工作寄存器1～3組或位尋址區，則必須通過軟件對SP的內容重新定義，使堆棧區設定在片內數據RAM區中的某一區域內(如30H)，堆棧深度不能超過片內RAM空間。</li><li></li><li>學習堆棧的作用？</li><li>答：在片內RAM中，常常要指定一個專門的區域來存放某些特別的數據,它遵循順序存取和後進先出(LIFO/FILO)的原則,這個RAM區叫堆棧。</li><li>1.子程序調用和中斷服務時CPU自動將當前PC值壓棧保存，返回時自動將PC值彈棧。</li><li>2.保護現場/恢復現場</li><li>3.數據傳輸</li><li></li><li>也就是說，堆棧是進入中斷的時候用到的，單片機一旦遇到中斷請求，就會去處理中斷，處理完後再回來處理主程序，這樣就涉及到了一個問題，單片機要保存中斷之前的信息，以便處理完後能夠回到主程序中，單片機會在響應中斷前，把單片機現在的指針地址（也就是處理完要返回的地址），以及一些必要的數據壓入堆棧（沒有這些數據，單片機處理完中斷後就無法確定主程序的狀態）。</li><li></li></ol><p><strong>中斷相關問題</strong>:</p><ol><li>中斷的響應過程?優先級?</li><li>答：1、響應過程：</li><li>1）根據響應的中斷源的中斷優先級，使相應的優先級狀態觸發器置1；</li><li>2） 執行硬件中斷服務子程序調用，並把當前程序計數器PC的內容壓入堆棧，保護斷點，尋找中斷源。</li><li>3） 清除相應的中斷請求標誌位（串行口中斷請求標誌RI和TI除外）；</li><li>4） 把被響應的中斷源所對應的中斷服務程序的入口地址（中斷矢量）送入PC，從而轉入相應的中斷服務程序。</li><li>5） 中斷返回，程序返回斷點處進行執行。</li><li>2、優先級：中斷的優先級有兩個：查詢優先級與執行優先級</li><li>查詢優先級：查詢優先級是不可以更改和設置的</li><li>1）系統默認的優先級（邏輯上）：</li><li>外部中斷0 > 定時器中斷0 > 外部中斷1 > 定時器中斷1 > 串行中斷</li><li>2）由IP寄存器來決定優先級。當IP對應位置為1時，該中斷級別提高。同為1是按默認級別</li><li>中斷嵌套的好處與壞處?</li><li>答：中斷嵌套：CPU在處理級別較低的中斷過程中，出現了級別較高的中斷請求。CPU停止執行低級別中斷，執行高級別的中斷處理程序後，再接著執行低級別的未被處理完的中斷程序。</li><li>使用中斷嵌套可以使高優先級別的中斷得到及時的響應和處理。</li><li>1） CPU與外部設備並行工作</li><li>2） 能夠處理例外事件</li><li>3） 實現實時處理</li><li>4） 實現人機聯繫</li><li>5） 實現用戶程序與操作系統的聯繫</li><li>6） 實現多道程序並行執行</li><li>7） 在多處理機系統中，實現處理機之間的聯繫</li><li>壞處：高級別的中斷一直持續的話會影響低級別中斷的處理。</li><li>中斷向量表的理解</li><li>答：中斷源的識別標誌，可用來形成相應的中斷服務程序的入口地址或存放中斷服務程序的首地址稱為中斷向量。把所有的中斷向量集中起來，按中斷類型號從小到大的順序存放到存儲器的某一區域內，這個存放中斷向量的存儲區叫做中斷向量表，即中斷服務程序入口地址表。</li><li>中斷在單片機中起到什麼作用?</li><li>答：中斷能實現快速的CPU與慢速的外設同步工作，實現數據傳送、故障檢測與處理、人機聯繫、多機系統、多道程序分時操作、實時信息處理等。</li></ol><p><strong>其它</strong>：</p><ol><li>什麼是臨界段，哪些情況下會存在臨界段的問題，如何進行臨界段保護。</li><li>答：1.臨界段代碼，也叫臨界區，是指那些必須完整連續運行，不可被打斷的代碼段。</li><li>2. ①讀取或者修改變量（特別是用於任務間通信的全局變量）的代碼，一般來說這是最常見的臨界代碼。</li><li>②調用公共函數的代碼，特別是不可重入的函數，如果多個任務都訪問這個函數，結果是可想而知的。總之，對於臨界段要做到執行時間越短越好，否則會影響系統的實時性。</li><li>3.中斷處理程序和任務都會訪問的臨界段代碼，需要使用關中斷的方法加以保護；僅由任務訪問的臨界段代碼，可以通過給調度器上鎖的方法來保護。</li><li>什麼是可重入型函數，使用時需要注意哪些問題</li><li>答：可重入函數</li><li>不為連續的調用持有靜態數據。</li><li>不返回指向靜態數據的指針；所有數據都由函數的調用者提供。</li><li>使用本地數據，或者通過製作全局數據的本地拷貝來保護全局數據。</li><li>如果必須訪問全局變量，記住利用互斥信號量來保護全局變量。</li><li>絕不調用任何不可重入函數。</li><li></li><li>注意事項：</li><li>1 ：編寫可重入函數時，應注意局部變量的使用（如編寫C/C++ 語言的可重入函數時，應使用auto 即缺省態局部變量或寄存器變量）</li><li>說明：編寫C/C++語言的可重入函數時，不應使用static局部變量，否則必須經過特殊處理，才能使函數具有可重入性。</li><li>2 ：編寫可重入函數時，若使用全局變量，則應通過關中斷、信號量（即P 、V 操作）等手段對其加以保護</li><li>說明：若對所使用的全局變量不加以保護，則此函數就不具有可重入性，即當多個進程調用此函數時，很有可能使有關全局變量變為不可知狀態。</li><li>專用詞彙解釋：</li><li>VCC：C=circuit 表示電路的意思, 即接入電路的電壓；</li><li>VDD：D=device 表示器件的意思, 即器件 內部的工作電壓；</li><li>對於數字電路來說，VCC是電路的供電電壓,VDD是芯片的工作電壓（通常Vcc>Vdd），VSS是接地點；有些IC既有VDD引腳又有VCC引腳，說明這種器件自身帶有電壓轉換功能。</li><li>VEE：發射極電源電壓, Emitter Voltage, 一般用於 ECL 電路的負電源電壓.</li><li>VSS：S=series 表示公共連接的意思，通常是指電路公共接地端電壓。</li><li>VPP：不同芯片對Vpp的定義稍有不同,比如電壓峰峰值,單片機中Vpp多數定義為編程電壓</li><li>在場效應管（或COMS器件）中，VDD為漏極，VSS為源極，VDD和VSS指的是元件引腳，而不表示供電電壓。一般來說VCC=模擬電源,VDD=數字電源,VSS=數字地,VEE=負電源</li></ol></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>搞懂</a></li><li><a>單片</a></li><li><a>機學習</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/b49977fa.html alt=20個機械設計知識點總結，搞懂也是半個行家 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b49977fa.html title=20個機械設計知識點總結，搞懂也是半個行家>20個機械設計知識點總結，搞懂也是半個行家</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/319bc575.html alt=電工最常見的幾個電路圖，全都搞懂的才是老師傅，你搞懂了幾個？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/47783c95e3a34185be9ff00f54b4fe7e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/319bc575.html title=電工最常見的幾個電路圖，全都搞懂的才是老師傅，你搞懂了幾個？>電工最常見的幾個電路圖，全都搞懂的才是老師傅，你搞懂了幾個？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4c45fc11.html alt=軸承保持架斷裂原因，終於搞懂了！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/926568ad42794eac8db9ccfc13716933 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4c45fc11.html title=軸承保持架斷裂原因，終於搞懂了！>軸承保持架斷裂原因，終於搞懂了！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/edb28816.html alt=「工程造價」搞懂這41個問題，你就是造價大神 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/61e6d766-6c64-42b0-8adc-44437be425ee style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/edb28816.html title=「工程造價」搞懂這41個問題，你就是造價大神>「工程造價」搞懂這41個問題，你就是造價大神</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dccc27aa.html alt=搞懂鋰電池阻抗譜(EIS)不容易，這篇文章值得收藏 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/45dfe66dfe2b42088ca53ab0c5d316b2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dccc27aa.html title=搞懂鋰電池阻抗譜(EIS)不容易，這篇文章值得收藏>搞懂鋰電池阻抗譜(EIS)不容易，這篇文章值得收藏</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/142b983a.html alt=一文搞懂常用鋼材型號、性能特性，收藏隨時查看！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1533653259067c6eef0dcc2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/142b983a.html title=一文搞懂常用鋼材型號、性能特性，收藏隨時查看！>一文搞懂常用鋼材型號、性能特性，收藏隨時查看！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/00a88a85.html alt="沒搞懂承重牆or非承重牆，你就敢胡亂拆？| 最家計劃" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/Rd1uElWC8gP2we style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/00a88a85.html title="沒搞懂承重牆or非承重牆，你就敢胡亂拆？| 最家計劃">沒搞懂承重牆or非承重牆，你就敢胡亂拆？| 最家計劃</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/187187bc.html alt="技術趣講 | 60 分鐘搞懂「正則表達式」" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/eaee8d2e512c44168627b8f244fb5e43 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/187187bc.html title="技術趣講 | 60 分鐘搞懂「正則表達式」">技術趣講 | 60 分鐘搞懂「正則表達式」</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1538e7d2.html alt=搞懂配電箱，安全你我他！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/153058170941381af740af4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1538e7d2.html title=搞懂配電箱，安全你我他！>搞懂配電箱，安全你我他！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e9f5a569.html alt=搞懂給排水專業的100個問題 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/66c9000136849b38a4a2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e9f5a569.html title=搞懂給排水專業的100個問題>搞懂給排水專業的100個問題</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d3d9f3d8.html alt=搞懂Linux內存管理，僅此一篇 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0ae3e7cee0234c4cb9cdef0039d2c4d0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d3d9f3d8.html title=搞懂Linux內存管理，僅此一篇>搞懂Linux內存管理，僅此一篇</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a3e9fc64.html alt=一次相親經歷，我徹底搞懂了阻塞非阻塞、同步異步 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/e008b77db962482cb7bdad71f78cf103 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a3e9fc64.html title=一次相親經歷，我徹底搞懂了阻塞非阻塞、同步異步>一次相親經歷，我徹底搞懂了阻塞非阻塞、同步異步</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1c53bc93.html alt=搞懂這些複雜的機械結構，你一定是個高工 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/30681751f7694dd0b8136a10fb9dc5d6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1c53bc93.html title=搞懂這些複雜的機械結構，你一定是個高工>搞懂這些複雜的機械結構，你一定是個高工</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7b329986.html alt=原來10張圖就可以搞懂分佈式鏈路追蹤系統原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/8dbe10a35c1a45cba7a211d07fbecf24 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7b329986.html title=原來10張圖就可以搞懂分佈式鏈路追蹤系統原理>原來10張圖就可以搞懂分佈式鏈路追蹤系統原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cbdef0bc.html alt=「進口知識」一篇搞懂瀝青進口那些事兒 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/22cf002555424c1e8692a166cf1c9339 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cbdef0bc.html title=「進口知識」一篇搞懂瀝青進口那些事兒>「進口知識」一篇搞懂瀝青進口那些事兒</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>