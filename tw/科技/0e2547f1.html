<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>「數據結構」Hash表 | 极客快訊</title><meta property="og:title" content="「數據結構」Hash表 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/617a6d43032e4efbac6b996c9bb5ab11"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0e2547f1.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0e2547f1.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0e2547f1.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0e2547f1.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0e2547f1.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0e2547f1.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/0e2547f1.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/0e2547f1.html><meta property="article:published_time" content="2020-11-14T21:07:42+08:00"><meta property="article:modified_time" content="2020-11-14T21:07:42+08:00"><meta name=Keywords content><meta name=description content="「數據結構」Hash表"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/0e2547f1.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>「數據結構」Hash表</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p><strong>數據結構】Hash表</strong></p><p>Hash表也叫散列表，是一種線性數據結構。在一般情況下，可以用o(1)的時間複雜度進行數據的增刪改查。在Java開發語言中，HashMap的底層就是一個散列表。</p><p><strong>1. 什麼是Hash表</strong></p><p>Hash表是一種線性數據結構，這種數據結構的底層一般是通過數組來實現的。在進行數據增刪改查的時候，Hash表首先通過Hash函數對某個鍵值進行Hash操作，這個Hash操作會將這個鍵映射到數組的某個下標，獲得下標以後就可以直接對數組中的數據進行操作了。理論上講，Hash表數據操作的時間複雜度都是O(1)。</p><div class=pgc-img><img alt=「數據結構」Hash表 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/617a6d43032e4efbac6b996c9bb5ab11><p class=pgc-img-caption></p></div><p>Hash表的底層是通過數組實現的。數據有個特點就是：必須在初始化的時候指定其長度。所以當Hash表中的數據填滿之後想繼續向裡面放數據的話就必須再創建一個容量更大的數組，然後將之前數組中的數組copy到這個新數組中。這個過程是一個耗費性能的操作，因此我們在使用Hash表之前最好估算下數據的容量，儘量避免擴容操作。</p><p><strong>2. Hash函數</strong></p><p>哈希函數又稱為散列函數，就是把任意長度的輸入（又叫做預映射， pre-image），通過散列算法，變換成固定長度的輸出，該輸出就是散列值。這種轉換是一種壓縮映射，也就是，散列值的空間通常遠小於輸入的空間，不同的輸入可能會散列成相同的輸出，而不可能從散列值來唯一的確定輸入值。假設輸出值域為S，哈希函數的性質如下：</p><ul><li>典型的哈希函數都有無限的輸入值域；</li><li>當哈希函數輸入一致時，輸出必相同；</li><li>當哈希函數傳入不同的輸入值時，返回值可能一樣，也可能不一樣；</li><li>對於不同的輸入所得的輸出值會均勻的分佈；</li></ul><p>另外，Hash函數還具有如下兩個性質：</p><ul><li>免碰撞：即不會出現輸入 x≠y ，但是H(x)=H(y) 的情況，其實這個特點在理論上並不成立，比如目前比特幣使用的 SHA256 算法，會有2^256種輸出，如果我們進行2^256 + 1 次輸入，那麼必然會產生一次碰撞，事實上，通過 理論證明 ，通過2^130次輸入就會有99%的可能性發生一次碰撞，不過即使如此，即便是人類製造的所有計算機自宇宙誕生開始一直運算到今天，發生一次碰撞的機率也是極其微小的。</li><li>隱匿性：也就是說，對於一個給定的輸出結果 H(x) ，想要逆推出輸入 x ，在計算上是不可能的。如果想要得到 H(x) 的可能的原輸入，不存在比窮舉更好的方法。</li></ul><p>常用的Hash函數有：SHA1、MD5、SHA2等</p><p><strong>3. Hash衝突</strong></p><p><strong>對於不同的輸入值，Hash函數可能會給出相同的輸出，這種情況就叫做Hash衝突。</strong></p><p>哈希衝突是不可避免的，我們常用解決哈希衝突的方法有 <strong>開放地址法</strong> 和** 拉鍊法**。</p><p><strong>3.1 拉鍊法</strong></p><p>拉鍊法的核心思想是：如果Hash表的某個位置上發生了Hash衝突（也就是說在將一個元素放置到數組中某個位置的時候，這個位置上已經有其他元素佔據了），那麼將這些元素以鏈表的形式存放。</p><div class=pgc-img><img alt=「數據結構」Hash表 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1cd41772c2d9499aac9c1890d7008fcb><p class=pgc-img-caption></p></div><p>鏈表的查詢效率是比較低的，所以如果在Hash表的某個位置上發生衝突的次數太多的話，那麼這個位置就是一個很長的鏈表。查詢速度較慢。在Java 8中，HashMap做了一個優化，就是當鏈表長度達到8時，會自動將鏈表轉換成紅黑樹，查詢效率較高（紅黑樹是一種自平衡的二叉查找樹）。</p><p><strong>3.2 開放地址法</strong></p><p>在開放地址法中，若數據不能直接存放在哈希函數計算出來的數組下標時，就需要尋找其他位置來存放。在開放地址法中有三種方式來尋找其他的位置，分別是 <strong>線性探測、二次探測、再哈希法</strong> 。</p><p><strong>3.2.1 線性探測法</strong></p><p>線性探測的插入比較簡單，做法是：首先將元素進行hash映射，如果映射的位置上沒有其他元素，就直接在這個位置上插入數據；如果這個位置上已經有數據了，那麼判斷下個位置上有無數據，如果沒有直接插入如果有數據再進行下一次判斷，直到找到空位。</p><p>線性探測的查找：先通過鍵值定位到數組下標位置，然後將這個位置上數據的值和你要查找數據的值對比，如果相等就直接找到了，如果不相等則繼續判斷下個元素，所有元素遍歷完都沒找到的話，則不存在。</p><p>線性探測的刪除：首先還是通過鍵值映射到數組某個下標的位置，然後通過數組中元素的值和你要刪除的元素的值進行比較，找出你要刪除的那個元素。然後將這個位置上的元素刪除並設置一個標誌位說明這個位置上曾經有過數據（這步大家自己想想為什麼要這麼做）</p><p><strong>3.2.2 二次探測法</strong></p><p>在線性探測哈希表中，數據會發生聚集，一旦聚集形成，它就會變的越來越大，那些哈希函數後落在聚集範圍內的數據項，都需要一步一步往後移動，並且插入到聚集的後面，因此聚集變的越大，聚集增長的越快。這個就像我們在逛超市一樣，當某個地方人很多時，人只會越來越多，大家都只是想知道這裡在幹什麼。</p><p>二次探測是防止聚集產生的一種嘗試，思想是探測相隔較遠的單元，而不是和原始位置相鄰的單元。在線性探測中，如果哈希函數得到的原始下標是x,線性探測就是x+1,x+2,x+3......，以此類推，而在二次探測中，探測過程是x+1,x+4,x+9,x+16,x+25......,以此類推，到原始距離的步數平方。</p><p><strong>3.2.3 雙哈希法</strong></p><p>雙哈希是為了消除原始聚集和二次聚集問題，不管是線性探測還是二次探測，每次的探測步長都是固定的。雙哈希是除了第一個哈希函數外再增加一個哈希函數用來根據關鍵字生成探測步長，這樣即使第一個哈希函數映射到了數組的同一下標，但是探測步長不一樣，這樣就能夠解決聚集的問題。</p><p>第二個哈希函數必須具備如下特點</p><ul><li>和第一個哈希函數不一樣；</li><li>不能輸出為0，因為步長為0，每次探測都是指向同一個位置，將進入死循環，經過試驗得出 stepSize=constant-(key%constant);形式的哈希函數效果非常好，constant是一個質數並且小於數組容量。</li></ul><p>雙hash的核心思想是，第二步生成一個隨機的探測步長。</p><p><strong>4. Hash表的相關應用</strong></p><p>電腦只有2G內存，怎麼在20億個數據中找到出現次數最多的整數</p><p>首先我們需要確定value的範圍，因為這個20億個數有可能是同一個數，那麼value就為20億次。因此我們最少需要用一個int型的數據來存這個數（Java中int佔4個字節）；</p><p>同時我們還要確定下這個20億整數的取值範圍是多少。如果取值範圍是1~20億的話，我們也可以用int來存key，如果是更大的取值範圍的話，就需要考慮用long來存了。我們以極端壞的情況來考慮下這個問題：也就是20一個數據全是不同的數據，這些數據的取值範圍是超過20億的，因此我們需要用long類型來存key值，應int類型來存value值，20億條記錄的話大概需要26G左右的內存空間。這樣的話顯然內存不足，因此一次性統計20億個數風險很大。</p><p>解決方案：將包含有20億個數的大文件分成16個小文件，利用哈希函數，這樣的話，同一個重複的數肯定不會分到不同的文件中去，並且，如果哈希函數足夠好，那麼這16個文件中不同的數也不會大於2億（20 / 16）。然後我們在這16個文件中依次統計就可以了，最後進行彙總得到重複數最多的數。（彙總的時候我只需要取出每個小文件中出現次數最多的數，然後將這16個數進行比較就行了）</p><p>問題：如果這個20億個數都相同怎麼判斷呢？</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>數據</a></li><li><a>結構</a></li><li><a>Hash</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/385a3c55.html alt="數據結構中的 Hash 表" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/0e43812c-6f05-4cf6-af7e-18011d0a316a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/385a3c55.html title="數據結構中的 Hash 表">數據結構中的 Hash 表</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/37396ded.html alt=數據結構系列：哈希表？這涉及的是“加密/區塊鏈”等技術的核心 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3609570de59a49a9be5667dd9a637f65 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/37396ded.html title=數據結構系列：哈希表？這涉及的是“加密/區塊鏈”等技術的核心>數據結構系列：哈希表？這涉及的是“加密/區塊鏈”等技術的核心</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b37254e1.html alt=備戰秋招——算法與數據結構（5） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ab6859411bd8435bb2616d6fef468556 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b37254e1.html title=備戰秋招——算法與數據結構（5）>備戰秋招——算法與數據結構（5）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f605b4b8.html alt=懂了數據結構框架思維，一切算法不過是紙老虎 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ad2c8a60d9634e0aa36b5d8a664de355 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f605b4b8.html title=懂了數據結構框架思維，一切算法不過是紙老虎>懂了數據結構框架思維，一切算法不過是紙老虎</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e03941dc.html alt=數據結構一(哈希表)想進大廠的必備知識點 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/86ad7a2f62cc48f98bbe53b42ca4bf9a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e03941dc.html title=數據結構一(哈希表)想進大廠的必備知識點>數據結構一(哈希表)想進大廠的必備知識點</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/629e95d1.html alt=常用數據結構之二叉樹的特性以及適用場景總結 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d8521175c2eb416e97ccf5747b8a6033 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/629e95d1.html title=常用數據結構之二叉樹的特性以及適用場景總結>常用數據結構之二叉樹的特性以及適用場景總結</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/13fb0203.html alt=數據結構23｜二叉樹基礎上：什麼樣的二叉樹適合用數組來存儲？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/c9a031d4534f4363963c1ad02aac937f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/13fb0203.html title=數據結構23｜二叉樹基礎上：什麼樣的二叉樹適合用數組來存儲？>數據結構23｜二叉樹基礎上：什麼樣的二叉樹適合用數組來存儲？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a85e2fa9.html alt=數據結構系列：面試常問的二叉樹的遍歷和基本應用，不進來看看嗎 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/02b77c3c1c434606997aa740529d8b17 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a85e2fa9.html title=數據結構系列：面試常問的二叉樹的遍歷和基本應用，不進來看看嗎>數據結構系列：面試常問的二叉樹的遍歷和基本應用，不進來看看嗎</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0f931f71.html alt=數據結構：二叉樹及存儲結構，學生時代的難點嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/0e88a207beca45d08824aaf262458b25 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0f931f71.html title=數據結構：二叉樹及存儲結構，學生時代的難點嗎？>數據結構：二叉樹及存儲結構，學生時代的難點嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f662790b.html alt=「算法與數據結構」二叉樹之美 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/73093d13178e4fa1a45d2babe9d1a54b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f662790b.html title=「算法與數據結構」二叉樹之美>「算法與數據結構」二叉樹之美</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b53da776.html alt=數據結構和算法之二叉樹 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/e887f7fd870a4d7ea59cbbfdc132450f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b53da776.html title=數據結構和算法之二叉樹>數據結構和算法之二叉樹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/059fc3b0.html alt=C語言：數據結構-歸併排序 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/539294f811964720923157c1a6eba72c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/059fc3b0.html title=C語言：數據結構-歸併排序>C語言：數據結構-歸併排序</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b67e3584.html alt=一文看懂編程中的基本數據結構與算法思想 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/44d2fdc7ecf6447a860128c60e5cfe5b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b67e3584.html title=一文看懂編程中的基本數據結構與算法思想>一文看懂編程中的基本數據結構與算法思想</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/48215327.html alt=數據結構與算法（7）遞歸 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/6548910d67bb4d6e82fb33f08f496622 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/48215327.html title=數據結構與算法（7）遞歸>數據結構與算法（7）遞歸</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/062bbe77.html alt=軟考自查：數據結構與算法基礎（內容有點多！！！） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/60f8235323314304b4dac050f8cb1e7d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/062bbe77.html title=軟考自查：數據結構與算法基礎（內容有點多！！！）>軟考自查：數據結構與算法基礎（內容有點多！！！）</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>