<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>如何在觀測數據下進行因果效應評估 | 极客快訊</title><meta property="og:title" content="如何在觀測數據下進行因果效應評估 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/6c798d747a3a450696959275c78713f9"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/10bc5350.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/10bc5350.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/10bc5350.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/10bc5350.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/10bc5350.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/10bc5350.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/10bc5350.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/10bc5350.html><meta property="article:published_time" content="2020-10-29T21:11:12+08:00"><meta property="article:modified_time" content="2020-10-29T21:11:12+08:00"><meta name=Keywords content><meta name=description content="如何在觀測數據下進行因果效應評估"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/10bc5350.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>如何在觀測數據下進行因果效應評估</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><br></p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6c798d747a3a450696959275c78713f9><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><strong>導語</strong></h1><p>什麼是因果？因果性與相關性的區別是什麼？相關性有哪幾種來源？如何評估因果效應？在2020年集智-凱風研讀營中，浙江大學計算機學院助理教授況琨就上述問題做了系統梳理，本篇是文字整理版。 自9月20日（週日）開始，集智俱樂部聯合北京智源人工智能研究院還將舉行一系列有關因果推理的讀書會，歡迎更多的有興趣的同學和相關研究者參加，一起迎接因果科學的新時代。 <strong>1. 因果性與相關性</strong></p><h1 class=pgc-h-arrow-right><strong>1.1 什麼是因果</strong></h1><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/766f6b19c4494c25ba868487f3b48ced><p class=pgc-img-caption></p></div><p>什麼是因果呢？“因”其實就是引起某種現象發生的原因，而“果”就是某種現象發生後產生的結果。因果問題在我們日常生活中十分常見。</p><p>首先在醫療方面。比如在這次新冠疫情中，各個國家都在爭先恐後地研發疫苗，但在疫苗上市之前還需要做很多次單盲實驗、雙盲實驗，其背後就是基於隨機對照實驗的一些因果推理和因果效應評估，確定藥物於病人康復之間的因果效應。</p><p>其次在社會科學方面。比如在國家出臺新的政策前，就要利用因果推理手段來估計這個政策會給民眾、經濟效應和社會效應帶來多大影響。</p><p>最後在市場營銷方面。比如在推廣告之前，就需要使用隨機對照試驗或者A/B測試，選擇廣告推送的策略以實現效益最大化。</p><h1 class=pgc-h-arrow-right><strong>1.2 因果性與相關性的區別</strong></h1><p>相關性比因果性更缺乏<strong>可解釋性</strong>（Explainability）。這張圖中，黑線是肯塔基州的結婚率，而紅線是漁船事故死亡人數，兩者具有很高的相關性，但兩者之間卻沒有任何因果關係。我們在使用數據的時候就需要知道，這裡的相關性是不可靠的、不可解釋的。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/44a9835a752a4020b234a97786ad791d><p class=pgc-img-caption></p></div><p>另外一個例子是太陽鏡與冰淇淋的銷售量之間的關係，兩者之間呈現著明顯的正相關性。但如果我們直接關閉太陽鏡商店，進行干預，會影響冰淇淋的銷量嗎？並不會。因為兩者之間的虛假相關性是由天氣引發的，在太陽炎熱時兩者的消費量都會提升，強制干預其中一個的銷量並不會直接影響另一個。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c9ebd0a0da484c8db685a71baae98484><p class=pgc-img-caption></p></div><p>相關性比因果性更缺乏<strong>穩定性</strong>（Stability）。比如我們訓練模型去識別圖片中的狗，但數據集中90%的狗都是在草地上的，那麼在這個數據集中草地與狗就十分相關。那麼如果我們利用傳統機器學習的方法，無論是邏輯斯蒂迴歸還是深度模型，大概率會把草地識別為重要的特徵。但如果測試數據集中的狗是在沙灘上或者水中，模型就有很大概率會失敗。</p><p>傳統機器學習使基於關聯驅動的，對於未知的測試數據集很難達到穩定預測。傳統機器學習在關聯挖掘中會發現一些非因果特徵，比如草地背景與標籤的關係，並利用這種強的虛假相關（Spurious Correlation）進行預測。如果我們能夠發現特徵與標籤之間的因果關係，比如我們人類在識別狗的時候就會去關注夠的鼻子、眼睛和耳朵這些因果特徵，那麼無論狗是在什麼背景下，我們都可以正確識別。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/567dfbf53d5d4d91af6c3326996d1ce8><p class=pgc-img-caption></p></div><p>第三個區別是<strong>可行動性</strong>（Actionability）。比如某個電商在推廣某個商品時，需要從兩個廣告推薦算法中進行選擇，看哪個算法能帶來的收益更大。</p><p>如圖所示，前期的試驗發現，新算法B比舊算法 A 的總體成功率更高。但如果將用戶按收入分為兩層，卻會發現算法A在低收入人群和高收入人群中的效果反而都優於 B 。兩個算法的試驗對象中，收入分佈的差別很大，如果不進行控制，就會產生錯誤的結果。而除了收入之外，可能還需要考慮地域、年齡等多個變量，否則就會產生算法與成功率之間的虛假相關。</p><p>這些虛假相關是由混淆變量產生的混雜偏倚（Confounding Bias）。這種決策問題實際上是反事實問題，而不是預測問題。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/78a80f95bd7141cea693b7d91a940ab3><p class=pgc-img-caption></p></div><p><br></p><p>第四個區別是<strong>公平性</strong>（Fairness）。Google曾開發了根據人像判斷犯罪率的軟件，輸入為黑人時犯罪率就會比白人更高。而膚色與犯罪率之間不應該存在因果關係，這就出現了公平性的問題。實際上如圖所示，真正起決定性作用的變量是“收入”，黑人的收入普遍偏低，而低收入人群的犯罪率較高，因此膚色和犯罪率之間出現了虛假相關。</p><p>而通過因果評估的框架，我們可以利用Do-演算（Do-Calculus）等工具，干預收入的多少，來計算膚色與犯罪率之間真正的因果效應大小。實際上，收入和犯罪率才是強因果相關的，而膚色和犯罪率之間因果效應可以弱到忽略不計。</p><h1 class=pgc-h-arrow-right><strong>1.3 相關性的三種來源</strong></h1><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1cdb3f1b23fd4e1c9bf6afcdb217e200><p class=pgc-img-caption></p></div><p>相關性有三種來源：因果、混淆和樣本選擇。</p><p>因果關聯例子就是天下雨地面會溼，這種關係是能夠被人類所理解的、是可解釋的、穩定的（無論在任何國家或城市，天下雨地都會溼）。</p><p>混淆關聯是由混淆偏差（Confounding Bias）造成的。比如圖中X是T和Y的共同原因，但如果不對X進行觀察，就會發現T和Y是具有相關性的，但T和Y之間是沒有直接因果效應的，這就是產生了虛假相關。</p><p>樣本選擇偏差（Selection Bias）也會產生相關性，比如之前的例子中，如果數據集中的狗都出現在沙灘上，而沒有狗的圖片都是草地，那麼訓練處的模型就會發現草地與狗之間是負相關的，這也產生了虛假相關。</p><p>虛假相關與因果關聯相比，缺乏可解釋性，且容易隨著環境變化。在工業界和學術界中，我們都希望能判斷兩個變量之間的相關究竟是因果關聯還是虛假相關。如果是虛假相關的話，可能會給實際的系統帶來風險。</p><p>所以說，恢復因果可以提高可解釋性，幫助我們做出決策，並在未來的數據集中做出穩定而魯棒的預測，防止算法產生的偏差。無論數據集中有什麼樣的偏差，我們都希望能挖掘出沒有偏差的因果關係，來指導算法。</p><h1 class=pgc-h-arrow-right><strong>1.4 符號定義</strong></h1><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/29ea02151b044547b0edde53c0af7cbf><p class=pgc-img-caption></p></div><p>這裡給出關於因果的一個比較實際的定義：變量 T 的變量 Y 的原因，變量 Y 是變量 T 的結果，當且僅當在控制其他所有變量不變時，改變 T 會引發 Y 的變化。而因果效應（Causal Effect）就是改變變量 T 一個單位時，變量 Y 發生改變的大小。這裡的兩個重點是：一、只修改 T 的值，二、保持其他變量不變。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/cf1ccefbb8be435ab4ac8cc7ba6824de><p class=pgc-img-caption></p></div><p>這裡給出因果效應評估（Causal Effect Estimation）的數學形式。以評估藥物的因果效應為例，干預變量（Treatment Variable）T 的值為1時代表吃了藥，0代表沒吃藥，而這對應了兩者不同的潛在結果。平均因果效應（Average Causal Effect, ATE）就是吃藥的潛在結果與不吃藥的潛在結果在所有病人上的差值平均值。個體因果效應（Individual Causal Effect, ICE）就是吃藥的潛在結果與不吃藥的潛在結果在某個病人上的差值。</p><p>這裡還涉及反事實的問題：對於某個病人，我們只能觀測到他吃藥或不吃藥其中一種情況的結果，想要探究未發生的另一種情況的結果，就需要假象存在一個平行世界，這個世界裡病人做出了與之前不同的選擇，除此之外都保持完全一致，對比兩個世界的結果進行求解。</p><p>在實際應用中，隨機化實驗（Randomized Experiments）是因果效應評估的金標準。比如在疫苗研發中，就需要做雙盲實驗和單盲實驗以評估因果效應。在足夠大的實驗人群中，通過完全隨機的方法使其中一半人接種疫苗，這樣就排除了其他變量的影響，求得平均因果效應。這種方法在政策評估、健康醫療和市場營銷等多個領域都有重要應用，但這種方法的花銷巨大，且可能涉及倫理道德問題。那麼我們可否在巨量的歷史觀測數據中進行挖掘，評估出因果效應呢？</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b5a23f8cd84d467da216031f0cd7f618><p class=pgc-img-caption></p></div><p>比如在一個數據集中，有吃藥和未吃藥的兩群人。如果在數據收集時是使用單盲或雙盲實驗，那麼就可以直接去計算平均因果效應。但如果沒有保證分配藥物的隨機性，就可能會有體質、性別、年齡等混雜因子 X 使結果產生偏倚。因果推理的本質就是去控制吃藥和不吃藥的兩群人之間其他特徵的分佈。 <strong>2. 因果效應評估的方法</strong></p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/277f80813d084779aeb47236b2e27994><p class=pgc-img-caption></p></div><p>現在我們考慮干預變量為二值的情況，要去平衡其他變量的分佈，再做因果效應評估。在這裡介紹三種方法：Matching、Propensity Score Based Methods 和 Directly Confounder Balancing。</p><p>首先給出在觀測數據下做因果推理的三個假設：</p><p>一、Stable Unit Treatment Value(SUTV)變量之間是獨立的：我是否吃藥的結果不受別人是否吃藥的影響。</p><p>二、Unconfounderness 所有混淆變量都被觀測到了。</p><p>三、Overlap 各種干預變量的取值概率都應該在0到1之間。</p><h1 class=pgc-h-arrow-right><strong>2.1 Matching</strong></h1><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9dde470c9a3b4e3db9aff3d359a5ba27><p class=pgc-img-caption></p></div><p>第一種方法叫 Mathching。在兩個不同的處理群體之間，逐一尋找並匹配其他特徵變量都相同的個體，如果找不到就捨棄此個體，這樣就可以保證有匹配的那些樣本中其他特徵的分佈在一定範圍內是相似的，進而初步去評估因果效應。</p><p>Matching 的問題就是如何去評估兩個個體的相似度，並需要設定可以接受的差異閾值，在捨棄樣本數和相似度之間進行平衡。其次對於高維數據，很難找到相似樣本：比如有10個二值變量，就需要至少1025個樣本才能保證找到相同個體。</p><h1 class=pgc-h-arrow-right><strong>2.2 Propensity Score Based Methods</strong></h1><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/64e5909904a6460b96ae32eec1fca5ea><p class=pgc-img-caption></p></div><p>第二類方法是基於傾向指數/傾向得分（Propensity Score）的。傾向指數的定義就是在干預變量之外的其他特徵變量為一定值的條件下，個體被處理的概率。Rubin 證明了在給定傾向指數的情況下，Unconfounderness 假設就可以滿足。傾向指數其實概括了群體的特徵變量，如果兩個群體的傾向指數相同，那他們的干預變量就是與其他特徵變量相獨立的。</p><p>比如說，如果能保證兩群人的他吃藥的概率完全一樣，那麼可以說這兩群人其他特徵分佈也是一樣。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b4ea8f3304ac4f49a50f2b9ae215d026><p class=pgc-img-caption></p></div><p>傾向指數在實際應用中是觀測不到的，但可以使用有監督學習的方法進行估計。根據估計到的傾向指數，第一種方法就是去做 Matching，這樣能解決在高維數據中難以找到相似樣本的問題。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/821fb63daf654afc87ff9194adf0cd62><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/bc890042ac9e4d34ab1e068c54cc1552><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0973529302294f0dbc33651a0af34f9b><p class=pgc-img-caption></p></div><p>第二種是使用 Inverse of Propensity Weighting 方法，對於干預變量為1的樣本使用傾向指數的倒數進行加權，而對於為0的樣本使用（1-傾向指數）的倒數進行加權，兩類樣本的加權平均值之差就是平均因果效應的大小。這裡有一個假設，就是估計出的傾向指數與真實的傾向指數是相等的。</p><p>因此這個方法有兩個弱點，一是需要對傾向指數的估計足夠精確；二是如果傾向指數過於趨近0或1，就會導致某些權重的值過高，使估計出的平均因果效應的方差過大。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/acf24ccc63d649e08365f57717d844b5><p class=pgc-img-caption></p></div><p>第三種方法叫 Doubly Robust。這個方法需要根據已有數據，再學習一個預測的模型，反事實評估某個個體在干預變量變化後，結果變量的期望值。只要傾向指數的估計模型和反事實預測模型中有一個是對的，計算出的平均因果效應就是無偏的；但如果兩個模型估計都是錯誤的，那產生的誤差可能會非常大。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1208957d4b3041e298310364bc7de2c8><p class=pgc-img-caption></p></div><p>以上的這三種基於傾向指數的方法比較粗暴，把干預變量和結果變量之外的所有變量都當作混淆變量。而在高維數據中，我們需要精準地找出那些真正需要控制的混淆變量。我們提出了一種數據驅動的變量分解算法（D²VD），將干預變量和結果變量之外的其他變量分為了三類：</p><p>1. 混淆變量（Confounders）：既會影響到干預變量，還會影響到結果變量</p><p>2. 調整變量（Adjustment Variables）：與干預變量獨立，但會影響到結果變量</p><p>3. 無關變量：不會直接影響到干預變量與結果變量</p><p><br></p><p>進行分類之後，就可以只用混淆變量集去估計傾向指數。而調整變量集會被視為對結果變量的噪聲，進行消減。最後使用經過調整的結果，去估計平均因果效應。我們從理論上證明了，使用這種方法可以得到無偏的平均因果效應估計，而且估計結果的方差不會大於 Inverse of Propensity Weighting 方法。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e87017e51e71445e9d51778a521186a0><p class=pgc-img-caption></p></div><p>我的學生又拓展了我的工作，與表徵學習相結合，提出了 Decomposed Representation。其中增加了一類變量：</p><p>4. 工具變量：與結果變量獨立，但會影響到干預變量</p><p>通過實驗發現，與傳統方法相比，此方法可以很準確地把變量分離出來，提高平均因果效應的準確性。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ebbb142582474899b3044e9b3d268e6b><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><strong>2.3 Directly Confounder Balancing</strong></h1><p>總的來說，基於傾向指數的方法還是需要估計傾向指數的模型是準確的。既然傾向指數就是用於計算權重的，我們可不可以直接去估計權重呢？</p><p>第三類方法就是 Directly Confounder Balancing，直接對樣本權重進行學習。這類方法的動機就是去控制在干預變量下其他特徵變量的分佈。而一個變量的所有階的矩（moment）可以唯一確定它的分佈，所以只需要去控制它所有階的矩（比如一階矩就是均值，二階矩就是方差）就可了。在實驗中我們發現，只考慮一階矩就可以達到很好的效果，因此這裡先不考慮二階及以上的矩。通過這個手段就可以直接學習樣本權重，進行平均因果效應估計了。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/9a51ccd1fcac477b98ee79616117c0c9><p class=pgc-img-caption></p></div><p>這個概念首先出現於 Entrophy Balancing 方法之中，通過學習樣本權重，使特徵變量的分佈在一階矩上一致，同時還約束了權重的熵（Entropy）。但這個方法的問題也是將所有變量都同等對待了，把過多變量考慮為混雜變量。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6cb774417cda41fbb753b165828c4539><p class=pgc-img-caption></p></div><p>第二種方法叫 Approximate Residual Balancing。第一步也是通過計算樣本權重使得一階矩一致，第二步與 Doubly Robust 的思想一致，加入了迴歸模型，並在第三步結合了前兩步的結果估計平均因果效應。只要樣本權重的估計和反事實預測模型中有一個是對的，計算出的平均因果效應就是無偏的。但這裡也是將所有變量都同等對待了。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/918fbdb308ca43beb3d244d3baea1362><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a360fceee322425092e9cd494b966872><p class=pgc-img-caption></p></div><p>我們提出的方法叫做混淆變量區分性平衡（Differentiated Confounder Balancing, DCB），考慮到的就是不同的特徵變量對於平均因果效應的影響是不同的。我們在傳統方法上加入了混淆變量權重（Confounder Weights）β：當β為0時，代表所對應的變量不是混淆變量，對因果效應不會帶來影響；當β較大時，說明此變量對因果效應的影響較大。其中的β正好是從干預變量的增廣到結果變量的迴歸係數。通過一系列實驗發現，我們的方法在高維數據下對平均因果效應的估計偏差幾乎為0，優於其他方法。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/48cc92b01b0945788d94ad0d23943401><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><strong>2.4 Generative Adversial De-confounding</strong></h1><p>上述的所有方法中，干預變量都是二值的，那如何去處理多值的或者連續的干預變量呢？我們今年的一個工作 Generative Adversial De-confounding 就嘗試估計這類複雜情況下干預變量與結果變量之間的因果效應。這裡的核心思想就是如何保證干預變量與其他特徵變量的分佈相獨立。我們利用了 GAN 的思想，去憑空構造出另一個干預變量與其他特徵變量相獨立的分佈。</p><div class=pgc-img><img alt=如何在觀測數據下進行因果效應評估 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/93e8385dd971447193182fd32eed1433><p class=pgc-img-caption></p></div><p>我們使用了隨機打亂（Random Shuffle）的方法，只打亂干預變量，這樣就可以使干預變量與其他特徵變量相獨，並保留了兩者的分佈。我們再使用樣本權重估計的方法，使原來數據集的加權分佈結果與構造出的分佈相一致。在實驗中，可以發現我們的方法成功降低了干預變量與其他特徵變量的相關性，並有效提高了因果效應評估的準確性。</p><h1 class=pgc-h-arrow-right><strong>參考文獻：</strong></h1><p>[1] Kuang, K., Cui, P., Zou, H., Li, B., Tao, J., Wu, F., & Yang, S. (2020). Data-Driven Variable Decomposition for Treatment Effect Estimation. IEEE Transactions on Knowledge and Data Engineering.</p><p>[2] Wu, A., Kuang, K., Yuan, J., Li, B., Zhou, P., Tao, J., ... & Wu, F. (2020). Learning Decomposed Representation for Counterfactual Inference. arXiv preprint arXiv:2006.07040.</p><p>[3] Kuang, K., Li, L., Geng, Z., Xu, L., Zhang, K., Liao, B., ... & Jiang, Z. (2020). Causal Inference. Engineering, 6(3), 253-263.</p><p>[4] Kuang, K., Cui, P., Li, B., Jiang, M., Wang, Y., Wu, F., & Yang, S. (2019). Treatment Effect Estimation via Differentiated Confounder Balancing and Regression. ACM Transactions on Knowledge Discovery from Data (TKDD), 14(1), 1-25.</p><p>[5] Kuang, K., Cui, P., Li, B., Jiang, M., & Yang, S. (2017, August). Estimating treatment effect in the wild via differentiated confounder balancing. In Proceedings of the 23rd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining (pp. 265-274).</p><p>[6] Kuang, K., Cui, P., Li, B., Jiang, M., Yang, S., & Wang, F. (2017,February). Treatment effect estimation with data-driven variable decomposition. In Proceedings of the Thirty-First AAAI Conference on Artificial Intelligence.</p><blockquote class=pgc-blockquote-abstract><p><span style="color:#646464;--tt-darkmode-color: #646464">作者：況琨 編輯：鄧一雪</span></p></blockquote></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>觀測</a></li><li><a>數據</a></li><li><a>進行</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/f0cd1d45.html alt=時序數據該如何進行可視化 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4483ef0315ca4687ba01da69a3fd09f6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f0cd1d45.html title=時序數據該如何進行可視化>時序數據該如何進行可視化</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e4c04e83.html alt=如何進行有效的數據管理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/153595574970039c9d1de82 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e4c04e83.html title=如何進行有效的數據管理>如何進行有效的數據管理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4f0f10d.html alt=如何高效地進行數據建模 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4f0f10d.html title=如何高效地進行數據建模>如何高效地進行數據建模</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1b1f4a3.html alt=如何進行數據建模？方法，步驟！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/03ce6a4ebd4f4f90bc0a3789154f8cf6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1b1f4a3.html title=如何進行數據建模？方法，步驟！>如何進行數據建模？方法，步驟！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0a5bd36.html alt=計算機在程序指令的控制下對數據進行處理，形成機讀數據庫 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/07ba94ceac544f1eaf8b735d7f3eed2c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0a5bd36.html title=計算機在程序指令的控制下對數據進行處理，形成機讀數據庫>計算機在程序指令的控制下對數據進行處理，形成機讀數據庫</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1209c08.html alt=如何有效的進行數據交換管理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/fbb3bc2be1e04318bc25ab6d95ff4d03 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1209c08.html title=如何有效的進行數據交換管理>如何有效的進行數據交換管理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/72139afe.html alt=怎樣對臍橙樹進行扭枝（彎枝）促花？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/fe6ea8ad111f421c9673e3f61072fa1f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/72139afe.html title=怎樣對臍橙樹進行扭枝（彎枝）促花？>怎樣對臍橙樹進行扭枝（彎枝）促花？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e0c52137.html alt=作文裡面怎麼進行場面描寫？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/230976bf-ee1d-44c0-8ce9-4a4714b8ad40 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e0c52137.html title=作文裡面怎麼進行場面描寫？>作文裡面怎麼進行場面描寫？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cc683c38.html alt=怎樣進行場面描寫？中小學生高分作文技巧，作文快速提分 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7559326b0b254462970a98290ef15e9f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cc683c38.html title=怎樣進行場面描寫？中小學生高分作文技巧，作文快速提分>怎樣進行場面描寫？中小學生高分作文技巧，作文快速提分</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/862b0119.html alt=庭院景觀進行分類，分析其設計手法及景觀元素 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0b2a23998d02489a9f65c5ac190e0ab1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/862b0119.html title=庭院景觀進行分類，分析其設計手法及景觀元素>庭院景觀進行分類，分析其設計手法及景觀元素</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/862c99dd.html alt=數據告訴你，為什麼要在上升趨勢買入和下降趨勢賣出 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3e507bb24abc482fb28df1121a7ee097 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/862c99dd.html title=數據告訴你，為什麼要在上升趨勢買入和下降趨勢賣出>數據告訴你，為什麼要在上升趨勢買入和下降趨勢賣出</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1f742b21.html alt="數據科學家常犯的 10 個編程錯誤" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1f742b21.html title="數據科學家常犯的 10 個編程錯誤">數據科學家常犯的 10 個編程錯誤</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d5773fc2.html alt=數據科學家常遇到的10個錯誤 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/59f660bac8b541888e71459b604ba733 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d5773fc2.html title=數據科學家常遇到的10個錯誤>數據科學家常遇到的10個錯誤</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9aacad8d.html alt=四子王旗著陸場進行夜間返回器回收演練 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/SGCsDGZChiSE1J style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9aacad8d.html title=四子王旗著陸場進行夜間返回器回收演練>四子王旗著陸場進行夜間返回器回收演練</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5ff7d77e.html alt=WORD表格的數據老闆讓增加合計，同事用計算器計算，我3秒鐘搞定 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f120ed2c1ed549e39bfa60bb3a86d591 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5ff7d77e.html title=WORD表格的數據老闆讓增加合計，同事用計算器計算，我3秒鐘搞定>WORD表格的數據老闆讓增加合計，同事用計算器計算，我3秒鐘搞定</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>