<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>C# 基礎知識系列- 14 IO篇 文件的操作（2） | 极客快訊</title><meta property="og:title" content="C# 基礎知識系列- 14 IO篇 文件的操作（2） - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/94228adcc29149689b6b45658262e74b"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/12844cc3.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/12844cc3.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/12844cc3.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/12844cc3.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/12844cc3.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/12844cc3.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/12844cc3.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/12844cc3.html><meta property="article:published_time" content="2020-11-14T20:59:46+08:00"><meta property="article:modified_time" content="2020-11-14T20:59:46+08:00"><meta name=Keywords content><meta name=description content="C# 基礎知識系列- 14 IO篇 文件的操作（2）"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/12844cc3.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>C# 基礎知識系列- 14 IO篇 文件的操作（2）</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><blockquote><p>前接上一篇內容。</p><p>如果是第一次捧場的小夥伴，為了您閱讀的連貫性，煩請掃一眼《C# 基礎知識系列- 14 IO篇 文件的操作（1）》。本篇是IO之文件操作的第二篇，介紹一下目錄和路徑的相關類。下一篇介紹如何通過流來操作文件。</p></blockquote><p><br></p><div class=pgc-img><img alt="C# 基礎知識系列- 14 IO篇 文件的操作（2）" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/94228adcc29149689b6b45658262e74b><p class=pgc-img-caption></p></div><p><br></p><h2 class="md-end-block md-heading">1.2 Directory和DirectoryInfo</h2><h3 class="md-end-block md-heading">1.2.1 Directory</h3><p><strong>d. 返回目錄下的所有子目錄：</strong></p><pre><code>public static string[] GetDirectories (string path);public static string[] GetDirectories (string path, string searchPattern);public static string[] GetDirectories (string path, string searchPattern, System.IO.EnumerationOptions enumerationOptions);public static string[] GetDirectories (string path, string searchPattern, System.IO.SearchOption searchOption);</code></pre><p>除了上文提到的 GetDirectories 方法可以直接返回目錄下所有子目錄以外，還有一組方法也可以<strong>枚舉</strong>出當前目錄下的子目錄：</p><pre><code>public static System.Collections.Generic.IEnumerable&lt;string&gt; EnumerateDirectories (string path);</code></pre><p>枚舉 path 目錄下的所有子目錄。</p><pre><code>public static System.Collections.Generic.IEnumerable&lt;string&gt; EnumerateDirectories (string path, string searchPattern);</code></pre><p>searchPattern，搜索名稱字符串，可以包含有效文本路徑和通配符（* 和 ?）的組合，但不支持正則表達式。</p><pre><code>public static System.Collections.Generic.IEnumerable&lt;string&gt; EnumerateDirectories (string path, string searchPattern, System.IO.EnumerationOptions enumerationOptions);public static System.Collections.Generic.IEnumerable&lt;string&gt; EnumerateDirectories (string path, string searchPattern, System.IO.SearchOption searchOption);</code></pre><p>這兩個方法放在一起講，這兩個是對上一個方法的增強和補充。其中 EnumerationOptions 是類，可以配置查詢的條件；SearchOption 是個枚舉，選擇只查詢當前目錄的子目錄名稱還是繼續深入查詢子孫目錄。</p><p><br></p><div class=pgc-img><img alt="C# 基礎知識系列- 14 IO篇 文件的操作（2）" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/eb666144-ffaa-4e48-831c-ebca47a078ea><p class=pgc-img-caption></p></div><p><br></p><p><strong>e.查看目錄下的所有文件-補充</strong></p><p>與子目錄查詢相同，Directory也支持這麼幾組查詢方法：</p><pre><code>public static string[] GetFiles (string path);public static string[] GetFiles (string path, string searchPattern);public static string[] GetFiles (string path, string searchPattern, System.IO.EnumerationOptions enumerationOptions);public static string[] GetFiles (string path, string searchPattern, System.IO.SearchOption searchOption);</code></pre><p>從參數上看，可以看出來這是返回子目錄下的文件列表。其中使用 searchPattern查詢名稱，enumerationOptions 作為查詢條件，searchOption 作為查詢的深度。</p><p>同樣，查詢文件也可以使用枚舉方法：</p><pre><code>public static System.Collections.Generic.IEnumerable&lt;string&gt; EnumerateFiles (string path);public static System.Collections.Generic.IEnumerable&lt;string&gt; EnumerateFiles (string path, string searchPattern);public static System.Collections.Generic.IEnumerable&lt;string&gt; EnumerateFiles (string path, string searchPattern, System.IO.EnumerationOptions enumerationOptions);public static System.Collections.Generic.IEnumerable&lt;string&gt; EnumerateFiles (string path, string searchPattern, System.IO.SearchOption searchOption);</code></pre><p><strong>f.獲取當前目錄</strong></p><pre><code>public static string GetCurrentDirectory ();</code></pre><p>在程序中調用這個方法可以獲取程序執行時的目錄，如果是在調試階段，目錄是指程序的主方法所在目錄；如果在發佈之後，也就是運行階段，該目錄指程序所在目錄。</p><p><strong>g.獲取上級目錄</strong></p><pre><code>public static System.IO.DirectoryInfo GetParent (string path);</code></pre><p>獲取傳入目錄的上級目錄信息。</p><p><br></p><div class=pgc-img><img alt="C# 基礎知識系列- 14 IO篇 文件的操作（2）" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/dfic-imagehandler/cbf2a1cc-a032-4592-9f9e-1fa41460ae62><p class=pgc-img-caption></p></div><p><br></p><p><strong>h.目錄移動</strong></p><pre><code>public static void Move (string sourceDirName, string destDirName);</code></pre><p>sourceDirName 移動到 destDirName，其中destDirName所代表的目錄不能存在。這個方法有個很有意思的特點，它也支持移動文件。也就是說，如果sourceDirNanme指向的是一個文件，那麼destDirName也必須是一個文件類型的路徑字符串。</p><p><strong>i.刪除目錄</strong></p><pre><code>public static void Delete (string path);//刪除 path所代表的目錄，如果目錄非空則提示無法刪除public static void Delete (string path, bool recursive);// recursive指示是否同時刪除子目錄和文件</code></pre><p>以上是Directory類的一些常用方法，當然還有更多的內容留待小夥伴一起發掘。傳送門==>https://docs.microsoft.com/zh-cn/dotnet/api/system.io.directory?view=netcore-3.1</p><p><br></p><div class=pgc-img><img alt="C# 基礎知識系列- 14 IO篇 文件的操作（2）" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/dfic-imagehandler/bec082d4-c8d2-4ea0-8faf-e78d555fbf55><p class=pgc-img-caption></p></div><p><br></p><h3 class="md-end-block md-heading">1.2.2 DirectoryInfo</h3><p>之前的篇幅我們介紹了Directory的工具類所支持的方法，接下來我們看一下 DirectoryInfo有哪些屬性和方法吧。</p><pre><code>public DirectoryInfo (string path);</code></pre><p>初始化的方式很簡單，直接傳遞一個目錄的路徑字符串，就可以獲取一個目錄信息類了。</p><p>接下來看看，DirectoryInfo支持的屬性：</p><pre><code>public override bool Exists { get; }// 目錄是否存在public override string Name { get; }// 目錄名稱，不是路徑public System.IO.DirectoryInfo Parent { get; }//如果有上級目錄，則返回上級目錄，如果沒有則返回 nullpublic System.IO.DirectoryInfo Root { get; }//獲取目錄的根目錄</code></pre><p>我們路過了DirectoryInfo的屬性，看到了它一部分特點，那麼我們該怎麼使用呢?</p><pre><code>public void Create ();</code></pre><p>創建目錄信息所代表的目錄，如果目錄已存在，則不會有任何變化 。如果這個目錄的父目錄也不存在，則自動創建父目錄</p><pre><code>public System.IO.DirectoryInfo CreateSubdirectory (string path);</code></pre><p>創建 pathi指定的子目錄。</p><pre><code>public override void Delete ();</code></pre><p>如果當前目錄是空目錄，調用可直接刪除，如果非空則會提示錯誤。</p><pre><code>public void Delete (bool recursive);</code></pre><p>根據參數 recursive指定是否刪除當前目錄的子目錄。</p><pre><code>public System.IO.DirectoryInfo[] GetDirectories ();public System.IO.DirectoryInfo[] GetDirectories (string searchPattern);public System.IO.DirectoryInfo[] GetDirectories (string searchPattern, System.IO.EnumerationOptions enumerationOptions);public System.IO.DirectoryInfo[] GetDirectories (string searchPattern, System.IO.SearchOption searchOption);</code></pre><p>獲取子目錄的數組，參數與 Directory 的同名方法一致。</p><pre><code>public System.Collections.Generic.IEnumerable&lt;System.IO.DirectoryInfo&gt; EnumerateDirectories ();public System.Collections.Generic.IEnumerable&lt;System.IO.DirectoryInfo&gt; EnumerateDirectories (string searchPattern);public System.Collections.Generic.IEnumerable&lt;System.IO.DirectoryInfo&gt; EnumerateDirectories (string searchPattern, System.IO.EnumerationOptions enumerationOptions);public System.Collections.Generic.IEnumerable&lt;System.IO.DirectoryInfo&gt; EnumerateDirectories (string searchPattern, System.IO.SearchOption searchOption);</code></pre><p>返回一個子目錄信息的可枚舉集合。</p><pre><code>public System.IO.FileInfo[] GetFiles ();public System.IO.FileInfo[] GetFiles (string searchPattern);public System.IO.FileInfo[] GetFiles (string searchPattern, System.IO.EnumerationOptions enumerationOptions);public System.IO.FileInfo[] GetFiles (string searchPattern, System.IO.SearchOption searchOption);</code></pre><p>嗯，依舊類似的寫法，獲取文件信息的數組</p><pre><code>public System.Collections.Generic.IEnumerable&lt;System.IO.FileInfo&gt; EnumerateFiles ();public System.Collections.Generic.IEnumerable&lt;System.IO.FileInfo&gt; EnumerateFiles (string searchPattern);public System.Collections.Generic.IEnumerable&lt;System.IO.FileInfo&gt; EnumerateFiles (string searchPattern, System.IO.EnumerationOptions enumerationOptions);public System.Collections.Generic.IEnumerable&lt;System.IO.FileInfo&gt; EnumerateFiles (string searchPattern, System.IO.SearchOption searchOption);</code></pre><p>返回文件的可枚舉集合。</p><pre><code>public void MoveTo (string destDirName);</code></pre><p>把當前目錄移動到對應的目錄。</p><p><br></p><blockquote><p>依舊未完待續，下一篇將為大家介紹一下 Path類和FileInfo與DirectoryInfo的父類 FileSystemInfo 這兩個類的API，然後演示一下如何使用流來讀寫文件。在文件和目錄這塊內容裡，我故意忽略了權限的介紹，這部分我將會放在進階篇中介紹。</p><p>API的介紹總是這麼枯燥乏味，不過請期待一下，在IO篇完成後，我會演示一下如何做一個簡單的文件查找工具。</p><p>簡單介紹一下這個工具的內容：它會遍歷系統裡所有文件的路徑信息，然後記錄到一個緩存文件中，用戶輸入一個要查詢的文件名時，我們可以通過讀取緩存文件確認文件所在目錄。</p></blockquote><p><br></p><div class=pgc-img><img alt="C# 基礎知識系列- 14 IO篇 文件的操作（2）" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/51e06223-b125-48f7-978a-8031f3d6e9b0><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>C#</a></li><li><a>基礎</a></li><li><a>知識</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/775df7fb.html alt=素描五官基礎知識，學素描的同學可參考 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/99b7762898d34e2f9a667c431fc7da6b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/775df7fb.html title=素描五官基礎知識，學素描的同學可參考>素描五官基礎知識，學素描的同學可參考</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/18bd39d8.html alt=齒輪基礎知識 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b8e178319e2c4b88a1865f903306a26b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/18bd39d8.html title=齒輪基礎知識>齒輪基礎知識</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c6e14bc6.html alt=SQL基礎知識——事務 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/773e21df09dc4e3e8403a0a62994039d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c6e14bc6.html title=SQL基礎知識——事務>SQL基礎知識——事務</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a12da43e.html alt="金屬材料學 一些基礎知識" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/50ac00002279849cb698 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a12da43e.html title="金屬材料學 一些基礎知識">金屬材料學 一些基礎知識</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/09bdf3b9.html alt=高考數學基礎知識鞏固專題：同角三角函數的基本關係和誘導公式 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/4ad700017a27db3c428d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/09bdf3b9.html title=高考數學基礎知識鞏固專題：同角三角函數的基本關係和誘導公式>高考數學基礎知識鞏固專題：同角三角函數的基本關係和誘導公式</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/72199127.html alt=「鋼筋知識」0基礎學鋼筋 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/9e06a03e-e475-4bc2-8bf9-539c7335c2cc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/72199127.html title=「鋼筋知識」0基礎學鋼筋>「鋼筋知識」0基礎學鋼筋</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ade09ce0.html alt=電工基礎知識電路圖 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5b7d7f6b7a8746e48eb6e87875924731 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ade09ce0.html title=電工基礎知識電路圖>電工基礎知識電路圖</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6e0965e2.html alt=電路圖的基礎知識 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/089a32c7bb1e4cb7aa6d83ee18113344 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6e0965e2.html title=電路圖的基礎知識>電路圖的基礎知識</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/75a3b95c.html alt=配電房佈置的基礎知識詳解（一） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ad303237b614457bba8b5db81c06cf4a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/75a3b95c.html title=配電房佈置的基礎知識詳解（一）>配電房佈置的基礎知識詳解（一）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cef7ae85.html alt=工程造價基礎知識你瞭解多少？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/046439fc0e5a4cd7a5cdcadb9000d8cb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cef7ae85.html title=工程造價基礎知識你瞭解多少？>工程造價基礎知識你瞭解多少？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/02e2580a.html alt=工程造價基礎知識，新手務必人手一份 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/7cc086b6b2a047b0a023233e5d8c4f16 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/02e2580a.html title=工程造價基礎知識，新手務必人手一份>工程造價基礎知識，新手務必人手一份</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/57302aed.html alt=電工基礎知識-配電室安全須知 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a653289e83ba4c59b0416ab25e9b0d1e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/57302aed.html title=電工基礎知識-配電室安全須知>電工基礎知識-配電室安全須知</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b5bd339f.html alt=數組基礎知識：100萬成員的數組取第一和最後一個有性能差距嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/dfc9869dbc274741b7ff68e0877cb33a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b5bd339f.html title=數組基礎知識：100萬成員的數組取第一和最後一個有性能差距嗎？>數組基礎知識：100萬成員的數組取第一和最後一個有性能差距嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/38e1fe15.html alt=靜物素描基礎知識大全 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a272ae873f5f46cca4b5f6493eb23a22 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/38e1fe15.html title=靜物素描基礎知識大全>靜物素描基礎知識大全</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8219b41f.html alt=管道與閥門基礎知識大全 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/926d5fb10aa74560a8712dbacd6d86f8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8219b41f.html title=管道與閥門基礎知識大全>管道與閥門基礎知識大全</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>