<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>50個ggplot2可視化案例 | 极客快訊</title><meta property="og:title" content="50個ggplot2可視化案例 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/RTBO8cK9mJlDy3"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/131bb7f.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/131bb7f.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/131bb7f.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/131bb7f.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/131bb7f.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/131bb7f.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/131bb7f.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/131bb7f.html><meta property="article:published_time" content="2020-10-29T20:59:29+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:29+08:00"><meta name=Keywords content><meta name=description content="50個ggplot2可視化案例"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/131bb7f.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>50個ggplot2可視化案例</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><blockquote><p>什麼類型的可視化用於什麼類型的問題？本文可幫助您為特定分析目標選擇正確的圖表類型，以及如何使用ggplot2在R中實現它。</p></blockquote><p>本文轉載自“R友舍”，已獲授權，點我跳轉原文鏈接</p><p>本文翻譯自：http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html</p><p><strong>一個有效的圖標:</strong></p><ul><li><p>在不歪曲事實的情況下傳達正確的信息</p></li><li><p>簡單而優雅的表達信息內容</p></li><li><p>通過美學表達信息，而不是掩蓋信息</p></li><li><p>沒有信息負載</p></li></ul><p>下面介紹了八類常見的圖表可視化情景。在繪圖之前，請仔細考慮你準備如何通過可視化的方式表達統計事實或事件關係。也許就是這八類情景中的一個。</p><p></p><h2>類型一：相關性 Correlation</h2><p>以及幾個圖用於檢查兩個變量見的相關性</p><p></p><h3>散點圖 Scatterplot</h3><p>散點圖是數據分析過程中使用最多的圖標之一。當你想了解兩個變量間的相關性時，首先想到的就是散點圖。我們可以用ggplot2裡的geom_point繪製散點圖。另外，還可以用geom_smooth來繪製平滑曲線，通過設置methon='lm'來繪製最佳擬合曲線。</p><pre><code>options(scipen=999) <br>library(ggplot2)<br>theme_set(theme_bw)<br>data("midwest", package = "ggplot2")<br># midwest &lt;- read.csv("http://goo.gl/G1K41K")<br><br># Scatterplot<br>gg &lt;- ggplot(midwest, aes(x=area, y=poptotal)) +<br>geom_point(aes(col=state, size=popdensity)) +<br>geom_smooth(method="loess", se=F) +<br>xlim(c(0, 0.1)) +<br>ylim(c(0, 500000)) +<br>labs(subtitle="Area Vs Population",<br>y="Population",<br>x="Area",<br>title="Scatterplot",<br>caption = "Source: midwest")<br><br>plot(gg)</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RTBO8cK9mJlDy3><p></p><h3>帶有環繞的散點圖 Scatterplot With Encircling</h3><p>在展示結果時，有時可以將某個特殊的區域包圍起來，從而達到突出展示的效果。</p><p>我們可以通過ggalt包裡的geom_encircle實現。</p><p>在geom_encircle中，我們可以指定需要突出的數據集，此外還可以擴展曲線，以便在點之外傳遞；以及修改曲線的顏色及大小。</p><pre><code># install 'ggalt' pkg<br># devtools::install_github("hrbrmstr/ggalt")<br>options(scipen = 999)<br>library(ggplot2)<br>library(ggalt)<br>midwest_select &lt;- midwest[midwest$poptotal &gt; 350000 &amp;<br>midwest$poptotal &lt;= 500000 &amp;<br>midwest$area &gt; 0.01 &amp;<br>midwest$area &lt; 0.1, ]<br><br># Plot<br>ggplot(midwest, aes(x=area, y=poptotal)) +<br>geom_point(aes(col=state, size=popdensity)) + # draw points<br>geom_smooth(method="loess", se=F) +<br>xlim(c(0, 0.1)) +<br>ylim(c(0, 500000)) + # draw smoothing line<br>geom_encircle(aes(x=area, y=poptotal),<br>data=midwest_select,<br>color="red",<br>size=2,<br>expand=0.08) + # encircle<br>labs(subtitle="Area Vs Population",<br>y="Population",<br>x="Area",<br>title="Scatterplot + Encircle",<br>caption="Source: midwest")<br></code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO8cV3reNN4t><p></p><h3>抖動圖 Jitter Plot</h3><p>我們看看先用一組新的數據繪製散點圖。這次，我將使用mpg數據集來繪製城市裡程（cty）與公路里程。</p><pre><code># load package and data<br>library(ggplot2)<br></code><p><code>data(mpg, package="ggplot2") </code></p><p><code># alternate source: "http://goo.gl/uEeRGu")</code></p><code>theme_set(theme_bw) # pre-set the bw theme.<br><br>g &lt;- ggplot(mpg, aes(cty, hwy))<br><br># Scatterplot<br>g + geom_point +<br>geom_smooth(method="lm", se=F) +<br>labs(subtitle="mpg: city vs highway mileage",<br>y="hwy",<br>x="cty",<br>title="Scatterplot with overlapping points",<br>caption="Source: midwest")<br></code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO8cf97vTMGQ><p>雖然我們能夠從圖中看出，兩個變量存在相關性。但是不難發現，很多散點被隱藏了，因為數據存在重疊的問題。由於cty和hvy兩個變量都是整數，所以數據重疊的現象更加嚴重。對於這類數據集的散點圖，展示過程中應該格外小心。那麼應該如何解決一個問題呢？我們可以使用jitter_geom對數據增加抖動，通過設置width，使得重疊的點在原始位置隨機抖動。</p><pre><code> # load package and data<br>library(ggplot2)<br>data(mpg, package="ggplot2")<br># mpg &lt;- read.csv("http://goo.gl/uEeRGu")<br><br># Scatterplot<br>theme_set(theme_bw) # pre-set the bw theme.<br>g &lt;- ggplot(mpg, aes(cty, hwy))<br>g + geom_jitter(width = .5, size=1) +<br>labs(subtitle="mpg: city vs highway mileage",<br>y="hwy",<br>x="cty",<br>title="Jittered Points")<br></code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RTBO8cp87yIJOE><p></p><h3>計數圖 Counts Chart</h3><p>第二種解決散點重疊的方法是使用計數圖。當數據存在散點重疊時，我們可以用散點大小來表達數據重疊的程度。</p><pre><code># load package and data<br>library(ggplot2)<br>data(mpg, package="ggplot2")<br># mpg &lt;- read.csv("http://goo.gl/uEeRGu")<br><br># Scatterplot<br>theme_set(theme_bw) # pre-set the bw theme.<br>g &lt;- ggplot(mpg, aes(cty, hwy))<br>g + geom_count(col="tomato3", show.legend=F) +<br>labs(subtitle="mpg: city vs highway mileage",<br>y="hwy",<br>x="cty",<br>title="Counts Plot")</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO8cy7ETcBuA><p></p><h3>氣泡圖 Bubble plot</h3><p>雖然散點圖能夠表示兩個連續變量間的相關關係。但如果想在以下兩個方面瞭解數據間的潛在關係時，氣泡圖會更有用：</p><p>1.基於分類變量，修改散點顏色2.基於另一個連續變量，表示散點的大小</p><p>簡單來說，如果你有一個四維變量的數據，兩個連續變量，一個分類變量用以表示顏色，一個連續變量表示點的大小，那麼氣泡圖就非常適合了。</p><p>比如下面這個例子，氣泡圖清楚地區分了製造商之間的差異以及最佳擬合曲線的斜率變化，從而能夠更好的比較不同組群間的差異。</p><pre><code># load package and data<br>library(ggplot2)<br>data(mpg, package="ggplot2")<br># mpg &lt;- read.csv("http://goo.gl/uEeRGu")<br><br>mpg_select &lt;- mpg[mpg$manufacturer %in% c("audi", "ford", "honda", "hyundai"), ]<br><br># Scatterplot<br>theme_set(theme_bw) # pre-set the bw theme.<br>g &lt;- ggplot(mpg_select, aes(displ, cty)) +<br>labs(subtitle="mpg: Displacement vs City Mileage",<br>title="Bubble chart")<br><br>g + geom_jitter(aes(col=manufacturer, size=hwy)) +<br>geom_smooth(aes(col=manufacturer), method="lm", se=F)</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO8kG9KXx6of><p></p><h3>動態氣泡圖 Animated Bubble chart</h3><p>對於動態氣泡圖的實現，可以使用gganimate包。動態氣泡圖和普通氣泡圖的區別就在於使用第五維數據(一般是時間)來展示數據間的變化。動態氣泡圖的處理方法和其它圖形基本一致，不同的是需要在aes層指定動畫展示的變量。構建繪圖後，可以使用gganimate通過設置動畫的時間間隔。</p><pre><code># Source: https://github.com/dgrtwo/gganimate<br># install.packages("cowplot") # a gganimate dependency<br># devtools::install_github("dgrtwo/gganimate")<br>library(ggplot2)<br>library(gganimate)<br>library(gapminder)<br>theme_set(theme_bw) # pre-set the bw theme.<br><br></code><p><code>g &lt;- ggplot(gapminder, aes(gdpPercap, lifeExp, size = pop, </code></p><p><code>frame = year)) +</code></p><code> geom_point +<br>geom_smooth(aes(group = year),<br>method = "lm",<br>show.legend = FALSE) +<br>facet_wrap(~continent, scales = "free") +<br>scale_x_log10 # convert to log scale<br><br>gganimate(g, interval=0.2)</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO8l0A6CyS74><p></p><h3>邊緣分佈的直方圖／箱型圖 Marginal Histogram / Boxplot</h3><p>如果你想在用一張圖表中顯示兩個變量的關係以及分佈，那麼可以使用邊緣分佈直方圖。它可以在散點圖的X、Y周，顯示變量的直方圖。邊緣分佈直方圖可以通過ggExtra包的ggMarginal函數實現。除了繪製直方圖外，還支持繪製邊緣分佈的箱型圖和密度函數。</p><pre><code># load package and data<br>library(ggplot2)<br>library(ggExtra)<br>data(mpg, package="ggplot2")<br># mpg &lt;- read.csv("http://goo.gl/uEeRGu")<br><br># Scatterplot<br>theme_set(theme_bw) # pre-set the bw theme.<br>mpg_select &lt;- mpg[mpg$hwy &gt;= 35 &amp; mpg$cty &gt; 27, ]<br>g &lt;- ggplot(mpg, aes(cty, hwy)) +<br>geom_count +<br>geom_smooth(method="lm", se=F)<br><br>ggMarginal(g, type = "histogram", fill="transparent")<br>ggMarginal(g, type = "boxplot", fill="transparent")<br># ggMarginal(g, type = "density", fill="transparent")</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO8lC1XdPjgL><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RTBO8lKQaQ20W><p></p><h3>相關關係圖 Correlogram</h3><p>相關關係圖可以同時顯示統一組數據中多個變量間的相關性。通過ggcorrplot包可以很方便的實現它。</p><pre><code># devtools::install_github("kassambara/ggcorrplot")<br>library(ggplot2)<br>library(ggcorrplot)<br><br># Correlation matrix<br>data(mtcars)<br>corr &lt;- round(cor(mtcars), 1)<br><br># Plot<br>ggcorrplot(corr, hc.order = TRUE,<br>type = "lower",<br>lab = TRUE,<br>lab_size = 3,<br>method="circle",<br>colors = c("tomato2", "white", "springgreen3"),<br>title="Correlogram of mtcars",<br>ggtheme=theme_bw)</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO8lTHI0ZwZX><p></p><h2>類型二: 偏差 Deviation</h2><h3>發散型條形圖 Diverging bars</h3><p>發散型條形圖，是一種可以同時處理正負值的條形圖表。一般通過geom<em>bar函數就能實現，但是使用geom</em>bar函數時，往往會出現概念上的混淆。因為該函數既可以畫直方圖也可以畫條形圖。</p><p>比如，geom_bar函數的stat參數默認值是count，這也意味著，當指定的數據是連續變量時，系統會生成直方圖。為了創建條形圖而不是直方圖，需要作如下修改：</p><ul><li><p>設置參數stat=identity</p></li><li><p>在aes中提供x和y兩維變量，其中x是字符或因子型變量，y是數值型變量</p></li></ul><p>在下面的示例中，首先對mtcars數據集的mpg進行標準化。將那些mpg大於零的車輛標記為綠色，小於零的車輛標記為紅色。</p><pre><code>library(ggplot2)<br>theme_set(theme_bw)<br><br># Data Prep<br>data("mtcars") # load data<br>mtcars$`car name` &lt;- rownames(mtcars)<br>mtcars$mpg_z &lt;- round((mtcars$mpg - mean(mtcars$mpg))/sd(mtcars$mpg), 2)<br>mtcars$mpg_type &lt;- ifelse(mtcars$mpg_z &lt; 0, "below", "above")<br>mtcars &lt;- mtcars[order(mtcars$mpg_z), ] # sort<br></code><p><code>mtcars$`car name` &lt;- factor(mtcars$`car name`, </code></p><p><code>levels = mtcars$`car name`) </code></p><code>#Diverging Barcharts<br>ggplot(mtcars, aes(x=`car name`, y=mpg_z, label=mpg_z)) +<br>geom_bar(stat='identity', aes(fill=mpg_type), width=.5) +<br>scale_fill_manual(name="Mileage",<br>labels = c("Above Average", "Below Average"),<br>values = c("above"="#00ba38", "below"="#f8766d")) +<br>labs(subtitle="Normalised mileage from 'mtcars'",<br>title= "Diverging Bars") +<br>coord_flip</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO8oJHpbPnnb><p></p><h3>發散型棒棒糖圖 Diverging Lollipop Chart</h3><p>棒棒糖圖與條形圖類似。一般可以使用geom_<em>point和geom_</em>segment來畫棒棒糖圖。借用條形圖的數據，我們這裡用棒棒糖圖來實現它。</p><pre><code>library(ggplot2)<br>theme_set(theme_bw)<br><br>ggplot(mtcars, aes(x=`car name`, y=mpg_z, label=mpg_z)) +<br>geom_point(stat='identity', fill="black", size=6) +<br>geom_segment(aes(y = 0,<br>x = `car name`,<br>yend = mpg_z,<br>xend = `car name`),<br>color = "black") +<br>geom_text(color="white", size=2) +<br>labs(title="Diverging Lollipop Chart",<br>subtitle="Normalized mileage from 'mtcars': Lollipop") +<br>ylim(-2.5, 2.5) +<br>coord_flip</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RTBO8oV86TBa7d><p></p><h3>發散型點圖 Diverging Dot Plot</h3><p>點圖與條形圖原理一致，只是表達形式不同。</p><pre><code>library(ggplot2)<br>theme_set(theme_bw)<br><br># Plot<br>ggplot(mtcars, aes(x=`car name`, y=mpg_z, label=mpg_z)) +<br>geom_point(stat='identity', aes(col=mpg_type), size=6) +<br>scale_color_manual(name="Mileage",<br>labels = c("Above Average", "Below Average"),<br>values = c("above"="#00ba38", "below"="#f8766d")) +<br>geom_text(color="white", size=2) +<br>labs(title="Diverging Dot Plot",<br>subtitle="Normalized mileage from 'mtcars': Dotplot") +<br>ylim(-2.5, 2.5) +<br>coord_flip</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO8pSBKru5pz><p></p><h3>面積圖 Area Chart</h3><p>面積圖一般用來表示某指標與基準指標相比的變化情況。通常可以用geom_area函數實現它。</p><pre><code>library(ggplot2)<br>library(quantmod)<br>data("economics", package = "ggplot2")<br><br># Compute % Returns<br></code><p><code>economics$returns_perc &lt;- c(0, diff(economics$psavert)/</code></p><p><code>economics$psavert[-length(economics$psavert)])</code></p><code><br># Create break points and labels for axis ticks<br>brks &lt;- economics$date[seq(1, length(economics$date), 12)]<br></code><p><code>lbls &lt;- lubridate::year(economics$date[seq(1, </code></p><p><code>length(economics$date), 12)])</code></p><code><br># Plot<br>ggplot(economics[1:100, ], aes(date, returns_perc)) +<br>geom_area +<br>scale_x_date(breaks=brks, labels=lbls) +<br>theme(axis.text.x = element_text(angle=90)) +<br>labs(title="Area Chart",<br>subtitle = "Perc Returns for Personal Savings",<br>y="% Returns for Personal savings",<br>caption="Source: economics")</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RTBO8paG6i0J4g><p></p><h2>三: 排序 Ranking</h2><p>排序圖一般用於比較多個項目之間的指標大小。</p><p></p><h3>有序條形圖 Ordered Bar Chart</h3><p>有序條形圖是按照Y軸變量大小進行排序的條形圖。讓我們用mpg數據集繪製每個製造商的平均城市裡程數的有序條形圖。</p><pre><code>cty_mpg &lt;- aggregate(mpg$cty, by=list(mpg$manufacturer), FUN=mean) <br>colnames(cty_mpg) &lt;- c("make", "mileage")<br>cty_mpg &lt;- cty_mpg[order(cty_mpg$mileage), ]<br>cty_mpg$make &lt;- factor(cty_mpg$make, levels = cty_mpg$make)<br>library(ggplot2)<br>theme_set(theme_bw)<br><br># Draw plot<br>ggplot(cty_mpg, aes(x=make, y=mileage)) +<br>geom_bar(stat="identity", width=.5, fill="tomato3") +<br>labs(title="Ordered Bar Chart",<br>subtitle="Make Vs Avg. Mileage",<br>caption="source: mpg") +<br>theme(axis.text.x = element_text(angle=65, vjust=0.6))</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO8r25UnCr1P><p></p><h3>棒棒糖圖 Lollipop Chart</h3><p>與條形圖類似，棒棒糖圖也具備類似的圖形展示效果。通過將條形改為細線，可以讓圖形顯得更簡潔，更美觀。</p><pre><code>library(ggplot2)<br>theme_set(theme_bw)<br><br># Plot<br>ggplot(cty_mpg, aes(x=make, y=mileage)) +<br>geom_point(size=3) +<br>geom_segment(aes(x=make,<br>xend=make,<br>y=0,<br>yend=mileage)) +<br>labs(title="Lollipop Chart",<br>subtitle="Make Vs Avg. Mileage",<br>caption="source: mpg") +<br>theme(axis.text.x = element_text(angle=65, vjust=0.6))</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO8v14dkoVDh><p></p><h3>點圖 Dot Plot</h3><p>點圖其實和棒棒糖圖類似，但是沒有線條，並且指標被反轉到了X軸。</p><pre><code>library(ggplot2)<br>library(scales)<br>theme_set(theme_classic)<br><br># Plot<br>ggplot(cty_mpg, aes(x=make, y=mileage)) +<br>geom_point(col="tomato2", size=3) + # Draw points<br>geom_segment(aes(x=make,<br>xend=make,<br>y=min(mileage),<br>yend=max(mileage)),<br>linetype="dashed",<br>size=0.1) + # Draw dashed lines<br>labs(title="Dot Plot",<br>subtitle="Make Vs Avg. Mileage",<br>caption="source: mpg") +<br>coord_flip</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO8vAHYzgptK><p></p><h3>傾斜圖 Slope Chart</h3><p>斜率圖是比較2個時間點之間位置的絕佳方法，既能展示值的大小變化，也能同時展示排名的變化。下圖可以作為傾斜圖的一個展示。</p><pre><code>library(ggplot2)<br>library(scales)<br>theme_set(theme_classic)<br><br># prep data<br>df &lt;- read.csv("https://raw.githubusercontent.com/<br>selva86/datasets/master/gdppercap.csv")<br>colnames(df) &lt;- c("continent", "1952", "1957")<br>left_label &lt;- paste(df$continent, round(df$`1952`),sep=", ")<br>right_label &lt;- paste(df$continent, round(df$`1957`),sep=", ")<br>df$class &lt;- ifelse((df$`1957` - df$`1952`) &lt; 0, "red", "green")<br><br># Plot<br>p &lt;- ggplot(df) +<br>geom_segment(aes(x=1, xend=2,<br>y=`1952`, yend=`1957`,<br>col=class), size=.75,<br>show.legend=F) +<br>geom_vline(xintercept=1, linetype="dashed", size=.1) +<br>geom_vline(xintercept=2, linetype="dashed", size=.1) +<br>scale_color_manual(labels = c("Up", "Down"),<br>values = c("green"="#00ba38",<br>"red"="#f8766d")) +<br>labs(x="", y="Mean GdpPerCap") +<br>xlim(.5, 2.5) + ylim(0,(1.1*(max(df$`1952`, df$`1957`))))<br><br># Add texts<br>p &lt;- p + geom_text(label=left_label, y=df$`1952`,<br>x=rep(1, NROW(df)), hjust=1.1, size=3.5)<br>p &lt;- p + geom_text(label=right_label, y=df$`1957`,<br>x=rep(2, NROW(df)), hjust=-0.1, size=3.5)<br>p &lt;- p + geom_text(label="Time 1", x=1, y=1.1*(max(df$`1952`,<br>df$`1957`)), hjust=1.2, size=5)<br>p &lt;- p + geom_text(label="Time 2", x=2, y=1.1*(max(df$`1952`,<br>df$`1957`)), hjust=-0.1, size=5)<br><br># Minify theme<br>p + theme(panel.background = element_blank,<br>panel.grid = element_blank,<br>axis.ticks = element_blank,<br>axis.text.x = element_blank,<br>panel.border = element_blank,<br>plot.margin = unit(c(1,2,1,2), "cm"))</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO8vJ958MHlv><p></p><h3>啞鈴圖 Dumbbell Plot</h3><p>啞鈴圖適合展示兩個時間點之間的相對位置，比較兩個類別之間的距離。正確的啞鈴圖要求Y軸變量是一個因子，並且因子水平與指標順序相同。</p><pre><code># devtools::install_github("hrbrmstr/ggalt")<br>library(ggplot2)<br>library(ggalt)<br>theme_set(theme_classic)<br><br>health &lt;- read.csv("https://raw.githubusercontent.com/<br>selva86/datasets/master/health.csv")<br>health$Area &lt;- factor(health$Area, levels=as.character(health$Area))<br><br># health$Area &lt;- factor(health$Area)<br>gg &lt;- ggplot(health, aes(x=pct_2013, xend=pct_2014,<br>y=Area, group=Area)) +<br>geom_dumbbell(color="#a3c4dc",<br>size=0.75,<br>point.colour.l="#0e668b") +<br>scale_x_continuous(label=percent) +<br>labs(x=,<br>y=,<br>title="Dumbbell Chart",<br>subtitle="Pct Change: 2013 vs 2014",<br>caption="Source: https://github.com/hrbrmstr/ggalt") +<br>theme(plot.title = element_text(hjust=0.5, face="bold"),<br>plot.background=element_rect(fill="#f7f7f7"),<br>panel.background=element_rect(fill="#f7f7f7"),<br>panel.grid.minor=element_blank,<br>panel.grid.major.y=element_blank,<br>panel.grid.major.x=element_line,<br>axis.ticks=element_blank,<br>legend.position="top",<br>panel.border=element_blank)<br>plot(gg)</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO8vS9jPQkX2><p></p><h2>四: 分佈 Distribution</h2><p>當擁有大量數據點並想要研究數據點的分佈特點時，則可以畫分佈圖。</p><p></p><h3>直方圖 Histogram</h3><p>連續變量直方圖一般可以通過geom_bar或者geom_histogram來實現。當使用geom_histogram時，可以選擇使用bin參數來控制柱子的數量。或者也可以通過設置binwidth來設置bin的範圍。因為geom_<em>histogram提供了控制箱數和binwidth的功能，因此一般可以選擇geom_</em>histogram來繪製直方圖。</p><pre><code>library(ggplot2)<br>theme_set(theme_classic)<br><br># Histogram on a Continuous (Numeric) Variable<br></code><p><code>g &lt;- ggplot(mpg, aes(displ)) + </code></p><p><code>scale_fill_brewer(palette = "Spectral")</code></p><code><br>g + geom_histogram(aes(fill=class),<br>binwidth = .1,<br>col="black",<br>size=.1) + # change binwidth<br>labs(title="Histogram with Auto Binning",<br>subtitle="Engine Displacement across Vehicle Classes")<br><br>g + geom_histogram(aes(fill=class),<br>bins=5,<br>col="black",<br>size=.1) + # change number of bins<br>labs(title="Histogram with Fixed Bins",<br>subtitle="Engine Displacement across Vehicle Classes")</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO8vb58w9Iof><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO8zbAQE2HZ3><p></p><h3>分類變量直方圖 Histogram on a categorical variable</h3><p>分類變量上的直方圖將生成顯示每個類別的條形圖的頻率圖表。通過調整寬度，可以調整條形的厚度。</p><pre><code>library(ggplot2)<br>theme_set(theme_classic)<br><br># Histogram on a Categorical variable<br>g &lt;- ggplot(mpg, aes(manufacturer))<br>g + geom_bar(aes(fill=class), width = 0.5) +<br>theme(axis.text.x = element_text(angle=65, vjust=0.6)) +<br>labs(title="Histogram on Categorical Variable",<br>subtitle="Manufacturer across Vehicle Classes")</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO8zpAKn93tK><p></p><h3>密度函數圖 Density plot</h3><pre><code>library(ggplot2)<br>theme_set(theme_classic)<br><br># Plot<br>g &lt;- ggplot(mpg, aes(cty))<br>g + geom_density(aes(fill=factor(cyl)), alpha=0.8) +<br>labs(title="Density plot",<br>subtitle="City Mileage Grouped by Number of cylinders",<br>caption="Source: mpg",<br>x="City Mileage",<br>fill="# Cylinders")</code><br></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO9047kFKUgM><p></p><h3>箱型圖 Box Plot</h3><p>箱形圖是研究數據分佈的一個好工具。它還可以顯示多個組內的分佈，以及中位數，範圍和異常值。</p><p>箱型圖框內的黑線代表數據的中位數，箱子的頂部和底部分佈時數據的75%和25%的分位數。線條的終點距離為1.5*IQR，IQR為第25和第75百分位數之間的距離。線條以外的點襯之為異常點。</p><pre><code>library(ggplot2)<br>theme_set(theme_classic)<br><br># Plot<br>g &lt;- ggplot(mpg, aes(class, cty))<br>g + geom_boxplot(varwidth=T, fill="plum") +<br>labs(title="Box plot",<br>subtitle="City Mileage grouped by Class of vehicle",<br>caption="Source: mpg",<br>x="Class of Vehicle",<br>y="City Mileage")</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO90GGCyIOXJ><pre><code>library(ggthemes)<br>g &lt;- ggplot(mpg, aes(class, cty))<br>g + geom_boxplot(aes(fill=factor(cyl))) +<br>theme(axis.text.x = element_text(angle=65, vjust=0.6)) +<br>labs(title="Box plot",<br>subtitle="City Mileage grouped by Class of vehicle",<br>caption="Source: mpg",<br>x="Class of Vehicle",<br>y="City Mileage")</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO90j7xd68pa><p></p><h3>帶點的箱型圖 Dot + Box Plot</h3><p>除了箱型圖的基本信息外，點圖可以為箱型圖提供更多的信息，在圖中每個點代表一個觀察點。</p><pre><code>library(ggplot2)<br>theme_set(theme_bw)<br><br># plot<br>g &lt;- ggplot(mpg, aes(manufacturer, cty))<br>g + geom_boxplot +<br>geom_dotplot(binaxis='y',<br>stackdir='center',<br>dotsize = .5,<br>fill="red") +<br>theme(axis.text.x = element_text(angle=65, vjust=0.6)) +<br>labs(title="Box plot + Dot plot",<br></code><p><code>subtitle="City Mileage vs Class: Each dot represents 1 row</code></p><p><code>in source data",</code></p><code> caption="Source: mpg",<br>x="Class of Vehicle",<br>y="City Mileage")</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO94p8Zme5Mw><p></p><h3>塔夫特箱型圖 Tufte Boxplot</h3><pre><code>library(ggthemes)<br>library(ggplot2)<br>theme_set(theme_tufte) # from ggthemes<br><br># plot<br>g &lt;- ggplot(mpg, aes(manufacturer, cty))<br>g + geom_tufteboxplot +<br>theme(axis.text.x = element_text(angle=65, vjust=0.6)) +<br>labs(title="Tufte Styled Boxplot",<br>subtitle="City Mileage grouped by Class of vehicle",<br>caption="Source: mpg",<br>x="Class of Vehicle",<br>y="City Mileage")</code><br></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO9506i94JbW><p></p><h3>小提琴圖 Violin Plot</h3><p>小提琴圖與箱型圖類似，但是小提琴圖還包含了數據的密度函數圖。</p><pre><code>library(ggplot2)<br>theme_set(theme_bw)<br><br># plot<br>g &lt;- ggplot(mpg, aes(class, cty))<br>g + geom_violin +<br>labs(title="Violin plot",<br>subtitle="City Mileage vs Class of vehicle",<br>caption="Source: mpg",<br>x="Class of Vehicle",<br>y="City Mileage")</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO958HTIDN9I><p></p><h3>人口金字塔圖 Population Pyramid</h3><p>人口金字塔提供了一種獨特的方式來可視化人口數量或人口百分比。下面的金字塔圖，反映了在電子郵件營銷活動渠道的每個階段用戶數。</p><pre><code>library(ggplot2)<br>library(ggthemes)<br>options(scipen = 999) # turns of scientific notations like 1e+40<br><br># Read data<br></code><p><code>email_campaign_funnel &lt;- read.csv("https://raw.githubusercontent.com</code></p><p><code>/selva86/datasets/master/email_campaign_funnel.csv")</code></p><code><br># X Axis Breaks and Labels<br>brks &lt;- seq(-15000000, 15000000, 5000000)<br>lbls = paste0(as.character(c(seq(15, 0, -5),<br>seq(5, 15, 5))), "m")<br><br># Plot<br>ggplot(email_campaign_funnel, aes(x = Stage,<br>y = Users, fill = Gender)) + # Fill column<br>geom_bar(stat = "identity", width = .6) + # draw the bars<br>scale_y_continuous(breaks = brks, # Breaks<br>labels = lbls) + # Labels<br>coord_flip + # Flip axes<br>labs(title="Email Campaign Funnel") +<br>theme_tufte + # Tufte theme from ggfortify<br>theme(plot.title = element_text(hjust = .5),<br>axis.ticks = element_blank) + # Centre plot title<br>scale_fill_brewer(palette = "Dark2") # Color palette</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO95HCix9x0t><p></p><h2>五: 組成 Composition</h2><h3>華夫餅圖 Waffle Chart</h3><p>華夫餅圖通常可以用來顯示總人口分類。我們可以通過ggplot2的geom_tile函數實現華夫餅圖。</p><pre><code>var &lt;- mpg$class # the categorical data <br><br>nrows &lt;- 10<br>df &lt;- expand.grid(y = 1:nrows, x = 1:nrows)<br>categ_table &lt;- round(table(var) * ((nrows*nrows)/(length(var))))<br>categ_table<br><br>df$category &lt;- factor(rep(names(categ_table), categ_table))<br><br>## Plot<br>ggplot(df, aes(x = x, y = y, fill = category)) +<br>geom_tile(color = "black", size = 0.5) +<br>scale_x_continuous(expand = c(0, 0)) +<br>scale_y_continuous(expand = c(0, 0), trans = 'reverse') +<br>scale_fill_brewer(palette = "Set3") +<br>labs(title="Waffle Chart", subtitle="'Class' of vehicles",<br>caption="Source: mpg")</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO95PFHagvoO><p></p><h3>餅圖 Pie Chart</h3><p>餅圖是顯示數據組成的一種重要方式，在ggplot中，需要通過coord_polar函數來實現。</p><pre><code>library(ggplot2)<br>theme_set(theme_classic)<br><br># Source: Frequency table<br>df &lt;- as.data.frame(table(mpg$class))<br>colnames(df) &lt;- c("class", "freq")<br>pie &lt;- ggplot(df, aes(x = "", y=freq, fill = factor(class))) +<br>geom_bar(width = 1, stat = "identity") +<br>theme(axis.line = element_blank,<br>plot.title = element_text(hjust=0.5)) +<br>labs(fill="class",<br>x=,<br>y=,<br>title="Pie Chart of class",<br>caption="Source: mpg")<br><br>pie + coord_polar(theta = "y", start=0)<br><br># Source: Categorical variable.<br># mpg$class<br>pie &lt;- ggplot(mpg, aes(x = "", fill = factor(class))) +<br>geom_bar(width = 1) +<br>theme(axis.line = element_blank,<br>plot.title = element_text(hjust=0.5)) +<br>labs(fill="class",<br>x=,<br>y=,<br>title="Pie Chart of class",<br>caption="Source: mpg")<br><br>pie + coord_polar(theta = "y", start=0)</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RTBO99W8OzuXKu><p></p><h3>樹形圖 Treemap</h3><p>樹形圖是現實分層數據的好方法。在ggplot中，treemapify包含有樹形圖所需要的數據處理及繪圖方法。</p><p>為了創建樹形圖，需要先將數據轉換成treemapify需要的數據格式。</p><p>此圖測試沒通過！！！</p><pre><code> library(ggplot2) <br>library(treemapify)<br></code><p><code>proglangs &lt;- read.csv("https://raw.githubusercontent.com/</code></p><p><code>selva86/datasets/master/proglanguages.csv")</code></p><code><br># plot<br>treeMapCoordinates &lt;- treemapify(proglangs,<br>area = "value",<br>fill = "parent",<br>label = "id",<br>group = "parent")<br><br>treeMapPlot &lt;- ggplotify(treeMapCoordinates) +<br>scale_x_continuous(expand = c(0, 0)) +<br>scale_y_continuous(expand = c(0, 0)) +<br>scale_fill_brewer(palette = "Dark2")<br><br>print(treeMapPlot)</code></pre><p></p><h3>條形圖 Bar Chart</h3><pre><code>freqtable &lt;- table(mpg$manufacturer)<br>df &lt;- as.data.frame.table(freqtable)<br>library(ggplot2)<br>theme_set(theme_classic)<br><br># Plot<br>g &lt;- ggplot(df, aes(Var1, Freq))<br>g + geom_bar(stat="identity", width = 0.5, fill="tomato2") +<br>labs(title="Bar Chart",<br>subtitle="Manufacturer of vehicles",<br></code><p><code>caption="Source: Frequency of Manufacturers from </code></p><p><code>'mpg' dataset") +</code></p><code> theme(axis.text.x = element_text(angle=65, vjust=0.6)) <br></code><br></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO9A21CPeCR1><pre><code># From on a categorical column variable<br>g &lt;- ggplot(mpg, aes(manufacturer))<br>g + geom_bar(aes(fill=class), width = 0.5) +<br>theme(axis.text.x = element_text(angle=65, vjust=0.6)) +<br>labs(title="Categorywise Bar Chart",<br>subtitle="Manufacturer of vehicles",<br>caption="Source: Manufacturers from 'mpg' dataset")</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO9AB6MuxMn3><p></p><h2>六:時序變化 Change</h2><h3>時間序列圖 Time Series</h3><p>ggfortify包支持autoplot函數直接從時間序列對象中自動繪製時間序列圖。</p><pre><code>## From Timeseries object (ts)<br>library(ggplot2)<br>library(ggfortify)<br>theme_set(theme_classic)<br><br># Plot<br>autoplot(AirPassengers) +<br>labs(title="AirPassengers")</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO9AKBP2djux><p></p><h3>數據框格式的時間序列圖 Time Series Plot From a Data Frame</h3><pre><code>library(ggplot2)<br>theme_set(theme_classic)<br><br># Allow Default X Axis Labels<br>ggplot(economics, aes(x=date)) +<br>geom_line(aes(y=returns_perc)) +<br>labs(title="Time Series Chart",<br>subtitle="Returns Percentage from 'Economics' Dataset",<br>caption="Source: Economics",<br>y="Returns %")</code><br></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO9Gh1u3wLnt><p></p><h3>關於月度數據的時間序列圖 <em>Monthly</em>Time</h3><pre><code>library(ggplot2)<br>library(lubridate)<br>theme_set(theme_bw)<br><br>economics_m &lt;- economics[1:24, ]<br><br># labels and breaks for X axis text<br>lbls &lt;- paste0(month.abb[month(economics_m$date)], " ",<br>lubridate::year(economics_m$date))<br>brks &lt;- economics_m$date<br><br># plot<br>ggplot(economics_m, aes(x=date)) +<br>geom_line(aes(y=uempmed)) +<br>labs(title="Monthly Time Series",<br>subtitle="Returns Percentage from Economics Dataset",<br>caption="Source: Economics",<br>y="Returns %") + # title and caption<br>scale_x_date(labels = lbls,<br>breaks = brks) +<br>theme(axis.text.x = element_text(angle = 90, vjust=0.5),<br>panel.grid.minor = element_blank)</code><br></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO9Gt5P68Dza><p></p><h3>關於年度數據的時間序列圖 <em>Yearly</em>Time</h3><pre><code>library(ggplot2)<br>library(lubridate)<br>theme_set(theme_bw)<br><br>economics_y &lt;- economics[1:90, ]<br><br># labels and breaks for X axis text<br>brks &lt;- economics_y$date[seq(1, length(economics_y$date), 12)]<br>lbls &lt;- lubridate::year(brks)<br><br># plot<br>ggplot(economics_y, aes(x=date)) +<br>geom_line(aes(y=uempmed)) +<br>labs(title="Yearly Time Series",<br>subtitle="uempmed Percentage from Economics Dataset",<br>caption="Source: Economics",<br>y="uempmed %") + # title and caption<br>scale_x_date(labels = lbls,<br>breaks = brks) +<br></code><p><code>theme(axis.text.x = element_text(angle = 90, vjust=0.5), </code></p><p><code>panel.grid.minor = element_blank) </code></p><br></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO9HxFtguo1c><p></p><h3>同時展示多個時間序列 Long Data Format: Multiple Time Series</h3><pre><code>data(economics_long, package = "ggplot2")<br>head(economics_long)<br>library(ggplot2)<br>library(lubridate)<br>theme_set(theme_bw)<br><br>df &lt;- economics_long[economics_long$variable %in%<br>c("psavert", "uempmed"), ]<br>df &lt;- df[lubridate::year(df$date) %in% c(1967:1981), ]<br><br># labels and breaks for X axis text<br>brks &lt;- df$date[seq(1, length(df$date), 12)]<br>lbls &lt;- lubridate::year(brks)<br><br># plot<br>ggplot(df, aes(x=date)) +<br>geom_line(aes(y=value, col=variable)) +<br>labs(title="Time Series of Returns Percentage",<br>subtitle="Drawn from Long Data format",<br>caption="Source: Economics",<br>y="Returns %",<br>color=) + # title and caption<br>scale_x_date(labels = lbls, breaks = brks) +<br>scale_color_manual(labels = c("psavert", "uempmed"),<br>values = c("psavert"="#00ba38",<br>"uempmed"="#f8766d")) +<br>theme(axis.text.x = element_text(angle = 90, vjust=0.5, size = 8),<br>panel.grid.minor = element_blank)</code><br></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO9I7H6exAUQ><p></p><h3>堆積圖 Stacked Area Chart</h3><pre><code>library(ggplot2)<br>library(lubridate)<br>theme_set(theme_bw)<br><br>df &lt;- economics[, c("date", "psavert", "uempmed")]<br>df &lt;- df[lubridate::year(df$date) %in% c(1967:1981), ]<br><br># labels and breaks for X axis text<br>brks &lt;- df$date[seq(1, length(df$date), 12)]<br>lbls &lt;- lubridate::year(brks)<br><br># plot<br>ggplot(df, aes(x=date)) +<br>geom_area(aes(y=psavert+uempmed, fill="psavert")) +<br>geom_area(aes(y=uempmed, fill="uempmed")) +<br>labs(title="Area Chart of Returns Percentage",<br>subtitle="From Wide Data format",<br>caption="Source: Economics",<br>y="Returns %") +<br>scale_x_date(labels = lbls, breaks = brks) +<br>scale_fill_manual(name="",<br>values = c("psavert"="#00ba38", "uempmed"="#f8766d")) +<br>theme(panel.grid.minor = element_blank)</code><br></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RTBO9IH2Vao5YX><p></p><h3>日曆熱圖 Calendar Heatmap</h3><p>當你想強調在日曆格式中，數據變化情況(如股票數據)，那麼就可以使用日曆熱圖。通過數據準備，我們可以用geom_tile函數來實現日曆熱圖。</p><pre><code>library(ggplot2)<br>library(plyr)<br>library(scales)<br>library(zoo)<br><br></code><p><code>df &lt;- read.csv("https://raw.githubusercontent.com/selva86/datasets</code></p><p><code>/master/yahoo.csv")</code></p><code>df$date &lt;- as.Date(df$date) # format date<br>df &lt;- df[df$year &gt;= 2012, ] # filter reqd years<br><br># Create Month Week<br>df$yearmonth &lt;- as.yearmon(df$date)<br>df$yearmonthf &lt;- factor(df$yearmonth)<br>df &lt;- ddply(df,.(yearmonthf), transform, monthweek=1+week-min(week))<br>df &lt;- df[, c("year", "yearmonthf", "monthf",<br>"week", "monthweek", "weekdayf", "VIX.Close")]<br><br><br># Plot<br>ggplot(df, aes(monthweek, weekdayf, fill = VIX.Close)) +<br>geom_tile(colour = "white") +<br>facet_grid(year~monthf) +<br>scale_fill_gradient(low="red", high="green") +<br>labs(x="Week of Month",<br>y="",<br>title = "Time-Series Calendar Heatmap",<br>subtitle="Yahoo Closing Price",<br>fill="Close")</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO9Ok9IyCWaD><p></p><h3>季節性時間序列 Seasonal Plot</h3><pre><code>library(ggplot2)<br>library(forecast)<br>theme_set(theme_classic)<br><br># Subset data<br></code><p><code>nottem_small &lt;- window(nottem, start=c(1920, 1), end=c(1925, 12)) </code></p><p><code># subset a smaller timewindow</code></p><code><br># Plot<br></code><p><code>ggseasonplot(AirPassengers) + </code></p><p><code>labs(title="Seasonal plot: International Airline Passengers")</code></p><p><code>ggseasonplot(nottem_small) + </code></p><p><code>labs(title="Seasonal plot: Air temperatures at Nottingham Castle") </code></p><br><br></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO9OvGn99Im3><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO9P42zLyB8y><p></p><h2>七: 分組 Groups</h2><h3>分層樹形圖 Hierarchical Dendrogram</h3><pre><code># install.packages("ggdendro")<br>library(ggplot2)<br>library(ggdendro)<br>theme_set(theme_bw)<br><br>hc &lt;- hclust(dist(USArrests), "ave") # hierarchical clustering<br><br># plot<br>ggdendrogram(hc, rotate = TRUE, size = 2)</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO9PE7ASIt8m><p></p><h3>聚類 Clusters</h3><p>對於不同的數據簇，我們可以用geom_<em>encircle來顯示。如果數據存在多維特徵，可以考慮採用PCA降維，並將第一主成分與第二主成分作為圖形的X、Y軸。geom</em>encircle將需要突出的數據簇包圍起來，從而達到突出數據的作用。</p><pre><code># devtools::install_github("hrbrmstr/ggalt")<br>library(ggplot2)<br>library(ggalt)<br>library(ggfortify)<br>theme_set(theme_classic)<br><br>df &lt;- iris[c(1, 2, 3, 4)]<br>pca_mod &lt;- prcomp(df)<br><br>df_pc &lt;- data.frame(pca_mod$x, Species=iris$Species)<br>df_pc_vir &lt;- df_pc[df_pc$Species == "virginica", ]<br>df_pc_set &lt;- df_pc[df_pc$Species == "setosa", ]<br>df_pc_ver &lt;- df_pc[df_pc$Species == "versicolor", ]<br><br># Plot ----------------------------------------------------<br>ggplot(df_pc, aes(PC1, PC2, col=Species)) +<br>geom_point(aes(shape=Species), size=2) +<br>labs(title="Iris Clustering",<br>subtitle="With principal components PC1 and<br>PC2 as X and Y axis",<br>caption="Source: Iris") +<br>coord_cartesian(xlim = 1.2 * c(min(df_pc$PC1), max(df_pc$PC1)),<br>ylim = 1.2 * c(min(df_pc$PC2), max(df_pc$PC2))) +<br>geom_encircle(data = df_pc_vir, aes(x=PC1, y=PC2)) +<br>geom_encircle(data = df_pc_set, aes(x=PC1, y=PC2)) +<br>geom_encircle(data = df_pc_ver, aes(x=PC1, y=PC2))</code></pre><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RTBO9Q2AfwRL5m><p></p><h2>八: 空間可視化Spatial</h2><p>ggmap包提供了與google maps api交互的工具，並獲取要繪製的地點的座標 。</p><p>Error: Google now requires an API key. See ?register_google for details.</p><p>目前使用需要註冊API key，而且國內也無法直連，以下沒有測試。</p><pre><code># Better install the dev versions ----------<br># devtools::install_github("dkahle/ggmap")<br># devtools::install_github("hrbrmstr/ggalt")<br><br># load packages<br>library(ggplot2)<br>library(ggmap)<br>library(ggalt)<br><br># Get Chennai's Coordinates --------------------------------<br>chennai &lt;- geocode("Chennai")<br><br># Get the Map ----------------------------------------------<br># Google Satellite Map<br>chennai_ggl_sat_map &lt;- qmap("chennai", zoom=12,<br>source = "google", maptype="satellite")<br><br># Google Road Map<br>chennai_ggl_road_map &lt;- qmap("chennai", zoom=12,<br>source = "google", maptype="roadmap")<br><br># Google Hybrid Map<br>chennai_ggl_hybrid_map &lt;- qmap("chennai", zoom=12,<br>source = "google", maptype="hybrid")<br><br># Open Street Map<br>chennai_osm_map &lt;- qmap("chennai", zoom=12, source = "osm")<br><br># Get Coordinates for Chennai's Places ---------------------<br>chennai_places &lt;- c("Kolathur",<br>"Washermanpet",<br>"Royapettah",<br>"Adyar",<br>"Guindy")<br><br>places_loc &lt;- geocode(chennai_places)<br><br><br># Plot Open Street Map -------------------------------------<br>chennai_osm_map + geom_point(aes(x=lon, y=lat),<br>data = places_loc,<br>alpha = 0.7,<br>size = 7,<br>color = "tomato") +<br>geom_encircle(aes(x=lon, y=lat),<br>data = places_loc, size = 2, color = "blue")<br><br># Plot Google Road Map -------------------------------------<br>chennai_ggl_road_map + geom_point(aes(x=lon, y=lat),<br>data = places_loc,<br>alpha = 0.7,<br>size = 7,<br>color = "tomato") +<br>geom_encircle(aes(x=lon, y=lat),<br>data = places_loc, size = 2, color = "blue")<br><br># Google Hybrid Map ----------------------------------------<br>chennai_ggl_hybrid_map + geom_point(aes(x=lon, y=lat),<br>data = places_loc,<br>alpha = 0.7,<br>size = 7,<br>color = "tomato") +<br>geom_encircle(aes(x=lon, y=lat),<br>data = places_loc, size = 2, color = "blue")</code></pre><p></p><h3>街道地圖</h3><img alt=50個ggplot2可視化案例 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RTBO9VP1Gc2QMh><p><strong>測試環境</strong></p><p>sessionInfo</p><p>## R version 3.6.0 (2019-04-26)</p><p>## Platform: x86_64-w64-mingw32/x64 (64-bit)</p><p>## Running under: Windows 10 x64 (build 17134)</p><p>##</p><p>## Matrix products: default</p><p>##</p><p>## locale:</p><p>## [1] LC_COLLATE=Chinese (Simplified)_China.936</p><p>## [2] LC_CTYPE=Chinese (Simplified)_China.936</p><p>## [3] LC_MONETARY=Chinese (Simplified)_China.936</p><p>## [4] LC_NUMERIC=C</p><p>## [5] LC_TIME=Chinese (Simplified)_China.936</p><p>##</p><p>## attached base packages:</p><p>## [1] stats graphics grDevices utils datasets methods base</p><p>##</p><p>## other attached packages:</p><p>## [1] ggdendro_0.1-20 forecast_8.7 reshape2_1.4.3 dplyr_0.8.1</p><p>## [5] plyr_1.8.4 lubridate_1.7.4 ggfortify_0.4.7 ggthemes_4.2.0</p><p>## [9] scales_1.0.0 quantmod_0.4-14 TTR_0.23-4 xts_0.11-2</p><p>## [13] zoo_1.8-6 ggcorrplot_0.1.3 ggExtra_0.8 gifski_0.8.6</p><p>## [17] gganimate_1.0.3 ggalt_0.4.0 ggplot2_3.1.1</p><p>##</p><p>## loaded via a namespace (and not attached):</p><p>## [1] tseries_0.10-47 maps_3.3.0 tidyr_0.8.3</p><p>## [4] shiny_1.3.2 assertthat_0.2.1 yaml_2.2.0</p><p>## [7] progress_1.2.2 backports_1.1.4 Rttf2pt1_1.3.7</p><p>## [10] pillar_1.4.0 lattice_0.20-38 quadprog_1.5-7</p><p>## [13] glue_1.3.1 extrafontdb_1.0 digest_0.6.19</p><p>## [16] RColorBrewer_1.1-2 promises_1.0.1 colorspace_1.4-1</p><p>## [19] htmltools_0.3.6 httpuv_1.5.1 timeDate_3043.102</p><p>## [22] pkgconfig_2.0.2 purrr_0.3.2 xtable_1.8-4</p><p>## [25] tweenr_1.0.1 later_0.8.0 tibble_2.1.1</p><p>## [28] farver_1.1.0 withr_2.1.2 urca_1.3-0</p><p>## [31] nnet_7.3-12 lazyeval_0.2.2 cli_1.1.0</p><p>## [34] magrittr_1.5 crayon_1.3.4 mime_0.6</p><p>## [37] evaluate_0.13 ash_1.0-15 fansi_0.4.0</p><p>## [40] nlme_3.1-139 MASS_7.3-51.4 tools_3.6.0</p><p>## [43] prettyunits_1.0.2 hms_0.4.2 stringr_1.4.0</p><p>## [46] munsell_0.5.0 compiler_3.6.0 rlang_0.3.4</p><p>## [49] grid_3.6.0 miniUI_0.1.1.1 labeling_0.3</p><p>## [52] rmarkdown_1.13 proj4_1.0-8 fracdiff_1.4-2</p><p>## [55] gtable_0.3.0 curl_3.3 R6_2.4.0</p><p>## [58] gridExtra_2.3 knitr_1.23 zeallot_0.1.0</p><p>## [61] extrafont_0.17 utf8_1.1.4 KernSmooth_2.23-15</p><p>## [64] stringi_1.4.3 parallel_3.6.0 Rcpp_1.0.1</p><p>## [67] vctrs_0.1.0 png_0.1-7 lmtest_0.9-37</p><p>## [70] tidyselect_0.2.5 xfun_0.7</p><p><strong>後臺回覆“ggplot2”獲得本文原代碼。</strong></p><p></p><h2>猜你喜歡</h2><p>10000+：菌群分析寶寶與貓狗 梅毒狂想曲 提DNA發Nature Cell專刊 腸道指揮大腦</p><p>系列教程：微生物組入門 Biostar 微生物組 宏基因組</p><p>專業技能：學術圖表高分文章生信寶典 不可或缺的人</p><p>一文讀懂：宏基因組 寄生蟲益處 進化樹</p><p>必備技能：提問 搜索 Endnote</p><p>文獻閱讀 熱心腸 SemanticScholar Geenmedical</p><p>擴增子分析：圖表解讀 分析流程 統計繪圖</p><p>16S功能預測 PICRUSt FAPROTAX Bugbase Tax4Fun</p><p>在線工具：16S預測培養基 生信繪圖</p><p>科研經驗：雲筆記 雲協作 公眾號</p><p>編程模板: Shell R Perl</p><p>生物科普: 腸道細菌人體上的生命生命大躍進 細胞暗戰 人體奧祕</p><p></p><h2>寫在後面</h2><p>為鼓勵讀者交流、快速解決科研困難，我們建立了“宏基因組”專業討論群，目前己有國內外5000+ 一線科研人員加入。參與討論，獲得專業解答，歡迎分享此文至朋友圈，並掃碼加主編好友帶你入群，務必備註“姓名-單位-研究方向-職稱/年級”。PI請明示身份，另有海內外微生物相關PI群供大佬合作交流。技術問題尋求幫助，首先閱讀《如何優雅的提問》學習解決問題思路，仍未解決群內討論，問題不私聊，幫助同行。</p><p>學習16S擴增子、宏基因組科研思路和分析實戰，關注“宏基因組”</p><p>點擊閱讀原文，跳轉最新文章目錄閱讀</p><p>https://mp.weixin.qq.com/s/5jQspEvH5_4Xmart22gjMA</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>50</a></li><li><a>ggplot2</a></li><li><a>可視化</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/a8aed1d9.html alt=魔性又健康！淄博50多名老人每天聚在一起哈哈大笑 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/SBb090Q36smG7Y style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a8aed1d9.html title=魔性又健康！淄博50多名老人每天聚在一起哈哈大笑>魔性又健康！淄博50多名老人每天聚在一起哈哈大笑</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d7b1999c.html alt=中國有一條長達50公里內陸戈壁腹地，竟然深藏一個巨大迷宮 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1538199204255b651f767a1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d7b1999c.html title=中國有一條長達50公里內陸戈壁腹地，竟然深藏一個巨大迷宮>中國有一條長達50公里內陸戈壁腹地，竟然深藏一個巨大迷宮</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bff930d4.html alt=50張實用電路圖，看懂這些，其他電路不攻自破 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/203d9178a98c41dda81f5ca2637faa4f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bff930d4.html title=50張實用電路圖，看懂這些，其他電路不攻自破>50張實用電路圖，看懂這些，其他電路不攻自破</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8afcf30e.html alt="北汽株洲公司享受檢定費減免50萬元  其它企業也可這樣申請" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a845614a41984085a76be7211341ad10 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8afcf30e.html title="北汽株洲公司享受檢定費減免50萬元  其它企業也可這樣申請">北汽株洲公司享受檢定費減免50萬元 其它企業也可這樣申請</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7739dc7a.html alt=Python數據可視化Matplotlib，如何在一副圖像中顯示多組柱形圖？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/5d4a0000046e1bea8b90 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7739dc7a.html title=Python數據可視化Matplotlib，如何在一副圖像中顯示多組柱形圖？>Python數據可視化Matplotlib，如何在一副圖像中顯示多組柱形圖？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1d62be41.html alt=兩臺就能驅動航母！國產50兆瓦燃氣輪機攻克，超055萬噸大驅動力 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b6f60291080c424296462ab0c2a2505c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1d62be41.html title=兩臺就能驅動航母！國產50兆瓦燃氣輪機攻克，超055萬噸大驅動力>兩臺就能驅動航母！國產50兆瓦燃氣輪機攻克，超055萬噸大驅動力</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8ac280bd.html alt=50年的時間過去，我國的電子計算機發展到了什麼地步？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/460e4566-11a4-41c4-84f2-c7ac027f57ef style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8ac280bd.html title=50年的時間過去，我國的電子計算機發展到了什麼地步？>50年的時間過去，我國的電子計算機發展到了什麼地步？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8182c7ef.html alt=加速新基建，優鍩科技的數字孿生可視化運營平臺迎來最好時代 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/57b433f28912474b8f051f552e2728d9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8182c7ef.html title=加速新基建，優鍩科技的數字孿生可視化運營平臺迎來最好時代>加速新基建，優鍩科技的數字孿生可視化運營平臺迎來最好時代</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fab386c5.html alt="可視化了解一下？ECharts 4.0最全技術攻略" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/7888000304ef1b538617 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fab386c5.html title="可視化了解一下？ECharts 4.0最全技術攻略">可視化了解一下？ECharts 4.0最全技術攻略</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/df53d8fc.html alt="可視化在線繪圖引擎 Topology" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4904a8e500d04576a068ffc81201f9af style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/df53d8fc.html title="可視化在線繪圖引擎 Topology">可視化在線繪圖引擎 Topology</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8fc4f50d.html alt=這些讓人驚豔的數據可視化工具，各個都好用！還不趕緊收藏起來？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/cc68ade3fb8b4f52b79ea84252e967a6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8fc4f50d.html title=這些讓人驚豔的數據可視化工具，各個都好用！還不趕緊收藏起來？>這些讓人驚豔的數據可視化工具，各個都好用！還不趕緊收藏起來？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1531f919.html alt=超實用！50個非常實用的PS快捷鍵命令大全分享 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/6d11d0bcd997456b828eb55bc85fa4dc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1531f919.html title=超實用！50個非常實用的PS快捷鍵命令大全分享>超實用！50個非常實用的PS快捷鍵命令大全分享</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5f345cc5.html alt=王德順50週年結婚紀念晒幸福照！王思聰：這才是秀恩愛的最高境界 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/5b580001943945b00dcd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5f345cc5.html title=王德順50週年結婚紀念晒幸福照！王思聰：這才是秀恩愛的最高境界>王德順50週年結婚紀念晒幸福照！王思聰：這才是秀恩愛的最高境界</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e8d1a5bf.html alt=看到王德順的《我的青春從50歲開始》，今年50歲的我倍感鼓舞 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/58e57b9811f14d28a8efbd4a4ec4da53 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e8d1a5bf.html title=看到王德順的《我的青春從50歲開始》，今年50歲的我倍感鼓舞>看到王德順的《我的青春從50歲開始》，今年50歲的我倍感鼓舞</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/aa664476.html alt=高清金相圖譜之鋁及鋁合金（50+，彩色） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a66052027c96434ba60f9091c938808b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/aa664476.html title=高清金相圖譜之鋁及鋁合金（50+，彩色）>高清金相圖譜之鋁及鋁合金（50+，彩色）</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>