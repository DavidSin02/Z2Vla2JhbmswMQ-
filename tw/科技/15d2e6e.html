<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>緩存——瀏覽器緩存 | 极客快訊</title><meta property="og:title" content="緩存——瀏覽器緩存 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/71f982dd86e2410ca1af5d9c57e0df91"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/15d2e6e.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/15d2e6e.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/15d2e6e.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/15d2e6e.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/15d2e6e.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/15d2e6e.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/15d2e6e.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/15d2e6e.html><meta property="article:published_time" content="2020-10-29T21:08:41+08:00"><meta property="article:modified_time" content="2020-10-29T21:08:41+08:00"><meta name=Keywords content><meta name=description content="緩存——瀏覽器緩存"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/15d2e6e.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>緩存——瀏覽器緩存</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>一.概述</h1><ul><li>瀏覽器緩存即http緩存，將數據緩存在瀏覽器(即客戶端)。</li><li>服務端通過設置HTTP響應頭來決定緩存策略，將資源緩存到本地瀏覽器。</li></ul><h1 class=pgc-h-arrow-right>二.工作流程</h1><p>http緩存都是從第二次請求開始的。</p><ul><li>第一次請求資源，服務器返回對應資源，並在response header響應頭中添加緩存策略。</li><li>第二次請求時，瀏覽器判斷請求參數，命中強緩存就直接200，從本地緩存中拿數據。否則把響應參數存在request header請求頭中，看是否命中協商緩存，命中則返回304，否則服務器會返回全新資源。</li></ul><p><strong>強緩存與協商緩存</strong></p><ul><li>強緩存：無需與服務端發生交互</li><li>協商緩存：需要與服務端發生交互，判斷是否使用本地緩存的文件。</li></ul><h1 class=pgc-h-arrow-right>三.緩存示例</h1><p><br></p><div class=pgc-img><img alt=緩存——瀏覽器緩存 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/71f982dd86e2410ca1af5d9c57e0df91><p class=pgc-img-caption></p></div><p><strong>分析</strong></p><ul><li>無緩存時，狀態碼200，傳輸size為6.9MB，傳輸時間8.63s。</li><li>設置協商緩存後，狀態碼304，傳輸size為350B，時間100ms，造成差異的原因時協商緩存發送的是304請求判斷是否使用本地緩存，如果緩存命中，瀏覽器直接從本地拿緩存的文件，6.9MB的文件就不需要走網絡傳輸了，因此響應時間會極大的縮短。</li><li>設置強緩存，傳輸時間為0ms。因為不需要走網絡傳輸了，直接走本地緩存，因此響應時間為0。</li></ul><h1 class=pgc-h-arrow-right>四.幾個控制緩存策略的響應頭</h1><h1 class=pgc-h-arrow-right>強緩存</h1><p><strong>4.1 Expires</strong></p><p>Expires是HTTP/1.0控制網頁緩存的字段，其值為服務器返回該請求的結果緩存的到期時間，即再次發送請求時，如果客戶端的時間小於Expires的值時，直接使用緩存結果。 到了HTTP/1.1，Expires已經被Cache-Control替代，原因在於Expires控制緩存的原理是使用客戶端的時間與服務端返回的時間做對比，如果客戶端與服務端的時間由於某些原因（時區不同；客戶端和服務端有一方的時間不準確）發生誤差，那麼強制緩存將直接失效</p><p><strong>4.2 Cache-Control</strong></p><p>在HTTP/1.1中，Cache-Control是最重要的規則，主要用於控制網頁緩存，主要取值為：</p><ul><li>public：所有內容都將被緩存（客戶端和代理服務器都可緩存）</li><li>private：所有內容只有客戶端可以緩存，Cache-Control的默認取值</li><li>no-cache：客戶端緩存內容，但是是否使用緩存則需要經過協商緩存來驗證決定</li><li>no-store：所有內容都不會被緩存，即不使用強制緩存，也不使用協商緩存</li><li>max-age=xxx (xxx is numeric)：緩存內容將在xxx秒後失效</li><li>must-revalidate：告訴瀏覽器、緩存服務器，本地副本過期前，可以使用本地副本；本地副本一旦過期，必須去源服務器進行有效性校驗。</li></ul><p>在無法確定客戶端的時間是否與服務端的時間同步的情況下，Cache-Control相比於expires是更好的選擇。</p><p><strong>4.3 Pragma</strong></p><p>Pragma 是HTTP/1.0標準中定義的一個header屬性，請求中包含Pragma的效果跟在頭信息中定義Cache-Control: no-cache相同，但是HTTP的響應頭沒有明確定義這個屬性，所以它不能拿來完全替代HTTP/1.1中定義的Cache-control頭。通常定義Pragma以向後兼容基於HTTP/1.0的客戶端。</p><p>注：以上三個響應頭，優先級順序為：Pragma>Cache-Control>Expires</p><h1 class=pgc-h-arrow-right>協商緩存</h1><p><strong>4.4 ETag</strong></p><p>ETag 值是一個字符串，其內容通常是數據的哈希值，每個數據都有一個單獨的標誌，只要這個文件發生了改變，這個標誌就會發生變化。</p><p>服務器可以在響應中返回 ETag，然後瀏覽器會在後續的請求中攜帶上這個參數來確定緩存是否需要更新。如果 ETag 值相同，說明資源未更改，服務器會返回 304（Not Modified） 響應碼，瀏覽器就知道本地緩存仍然是可以使用的。</p><p><strong>4.5 Last-Modified</strong></p><p>服務器可以通過配置這個響應頭，來向瀏覽器發送一個數據上次被修改的時間標籤，例如：Last-Modified:Wed, 24 Apr 2019 02:54:16 GMT</p><p>這樣瀏覽器就知道了該數據最後被修改的時間，後續請求中，會和服務器進行時間的比較，如果服務器上的時間比本地時間要新，說明數據有更改，瀏覽器需要重新下載數據。</p><h1 class=pgc-h-arrow-right>五.實例</h1><p>禁用緩存：</p><p><br></p><div class=pgc-img><img alt=緩存——瀏覽器緩存 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3dea73ede321405b936ba9d7c71b97ac><p class=pgc-img-caption></p></div><p><br></p><p>啟用協商緩存：</p><p><br></p><div class=pgc-img><img alt=緩存——瀏覽器緩存 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/03427f40c6cc4d34b9f3ccb0d8ae1717><p class=pgc-img-caption></p></div><p><br></p><p>強緩存：</p><p><br></p><div class=pgc-img><img alt=緩存——瀏覽器緩存 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0589c18be68a4b31a2ebb5d1af138a8c><p class=pgc-img-caption></p></div><p><br></p><p><strong>分析</strong></p><p><br></p><ul><li>禁用緩存，就是設置響應頭Cache-Control: no-store，max-age=0。瀏覽器收到響應頭，就會指定製定禁止緩存的策略，下一次請求該資源，就會直接發送200請求。</li><li>協商緩存，圖片中Cache-Controll設置的實際是強緩存，但Pragma:no-cache是協商緩存，且Pragma優先級更高，因此這裡執行的是協商緩存的策略，發送304請求，把本地資源的版本號、過期時間等信息拼裝到請求頭，來確定是否使用本地緩存。</li><li>強緩存，這裡幹掉了Pragma響應頭，瀏覽器就可以執行強緩存策略了，直接from memory cache。</li></ul><p><br></p><p><strong>瀏覽器緩存的優點</strong></p><p>1、減少了冗餘的數據傳輸</p><p>2、減少了服務器的負擔，大大提升了網站的性能</p><p>3、加快了客戶端加載網頁的速度</p><div class=pgc-img><img alt=緩存——瀏覽器緩存 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a41cca88c14e432ba48aae110c88051c><p class=pgc-img-caption></p></div><p><br></p><blockquote class=pgc-blockquote-abstract><p>狀態碼為灰色的請求則代表使用了強制緩存，請求對應的Size值則代表該緩存存放的位置，分別為from memory cache 和 from disk cache。</p><p>from memory cache代表使用內存中的緩存，特點：快速讀取「雖然讀取速度高效，但內存必硬盤容量小的多，操作系統需要精打細算內存的使用，所以能讓我們使用的內存必然不多」和時效性「一旦該進程關閉，則該進程的內容則會清空。」</p><p>from disk cache則代表使用的是硬盤中的緩存。瀏覽器讀取緩存的順序為memory –> disk。</p></blockquote><p>內存緩存中有一塊重要的緩存資源是 preloader 相關指令（例如&lt;link rel="prefetch">）下載的資源。眾所周知 preloader 的相關指令已經是頁面優化的常見手段之一，它可以一邊解析 js/css 文件，一邊網絡請求下一個資源。</p><p>在瀏覽器中，瀏覽器會在<strong>js和圖片等文件解析執行後直接存入內存緩存中</strong>，那麼當刷新頁面時只需直接從內存緩存中讀取(from memory cache)；而<strong>css文件則會存入硬盤文件</strong>中，所以每次渲染頁面都需要從硬盤讀取緩存(from disk cache)。</p><p><strong>瀏覽器會把哪些文件丟進內存中？哪些丟進硬盤中？</strong><br>關於這點，網上說法不一，不過以下觀點比較靠得住：</p><ul><li>對於大文件來說，大概率是不存儲在內存中的，反之優先</li><li>當前系統內存使用率高的話，文件優先存儲進硬盤</li></ul><p>瀏覽器緩存是後端還是前端控制呢？</p><p>答：的確是服務器設置，但是前端也要知道怎麼設置的。 比如哪些資源緩存，採用何種緩存方式，更新策略如何。</p><blockquote class=pgc-blockquote-abstract><p>來自：鏈接：https://juejin.im/post/6862711686705938445</p></blockquote></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>緩存</a></li><li><a>瀏覽器</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/33ce90a.html alt=關於瀏覽器緩存你知道多少 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f8dea2db19d749d1b0203de3763c8f6c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/33ce90a.html title=關於瀏覽器緩存你知道多少>關於瀏覽器緩存你知道多少</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f3cb692f.html alt=JS獲取瀏覽器地址欄的多個參數值的任意值實例代碼 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f3cb692f.html title=JS獲取瀏覽器地址欄的多個參數值的任意值實例代碼>JS獲取瀏覽器地址欄的多個參數值的任意值實例代碼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2da35c7f.html alt=圖文講解瀏覽器執行JS過程中的微任務和宏任務 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/cac571560581419eaddd55a13a939a99 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2da35c7f.html title=圖文講解瀏覽器執行JS過程中的微任務和宏任務>圖文講解瀏覽器執行JS過程中的微任務和宏任務</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a5729241.html alt="面試官問：瀏覽器輸入 URL 回車之後發生了什麼？" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/bb73188609ae4838af5ddfaf87140f91 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a5729241.html title="面試官問：瀏覽器輸入 URL 回車之後發生了什麼？">面試官問：瀏覽器輸入 URL 回車之後發生了什麼？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/911da3b3.html alt=HTML基礎教程：瀏覽器中符號是怎麼顯示出來的 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4f09001c7ecf4fa8b2a860b46fb39210 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/911da3b3.html title=HTML基礎教程：瀏覽器中符號是怎麼顯示出來的>HTML基礎教程：瀏覽器中符號是怎麼顯示出來的</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b96f6964.html alt=在多個瀏覽器中添加IDM插件 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/7a235092f6244f0db94a546bc46d2bdf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b96f6964.html title=在多個瀏覽器中添加IDM插件>在多個瀏覽器中添加IDM插件</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d6b4ad6d.html alt=你知道如何更新緩存嗎？如何保證緩存和數據庫雙寫一致性？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/c7adc4a4b9b745c0ae541bf87a51dd85 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d6b4ad6d.html title=你知道如何更新緩存嗎？如何保證緩存和數據庫雙寫一致性？>你知道如何更新緩存嗎？如何保證緩存和數據庫雙寫一致性？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c53d08ba.html alt=如何保證數據庫和緩存的雙寫一致性？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/4b019f823cd84b72a0ac1d7b7d54e259 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c53d08ba.html title=如何保證數據庫和緩存的雙寫一致性？>如何保證數據庫和緩存的雙寫一致性？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8661033e.html alt=淺析數據庫與緩存的雙寫一致性問題 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2050ed7e40ed40779b7aae6c6e1882f2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8661033e.html title=淺析數據庫與緩存的雙寫一致性問題>淺析數據庫與緩存的雙寫一致性問題</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f1086463.html alt=面試必知Redis面試題—緩存雪崩+穿透+緩存與數據庫雙寫一致問題 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/53ecc71093ef411499a588ebbe940a1c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f1086463.html title=面試必知Redis面試題—緩存雪崩+穿透+緩存與數據庫雙寫一致問題>面試必知Redis面試題—緩存雪崩+穿透+緩存與數據庫雙寫一致問題</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2c1f4605.html alt=面試：如何保證緩存與數據庫的雙寫一致性？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/cb653c36-6808-4f69-be82-df4f21a4a39c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2c1f4605.html title=面試：如何保證緩存與數據庫的雙寫一致性？>面試：如何保證緩存與數據庫的雙寫一致性？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dcba474b.html alt=高併發架構系列：Redis緩存和MySQL數據一致性方案詳解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/c71c1aad-32fd-4370-a372-8d2231bde9ea style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dcba474b.html title=高併發架構系列：Redis緩存和MySQL數據一致性方案詳解>高併發架構系列：Redis緩存和MySQL數據一致性方案詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ab465595.html alt=Memcached之緩存雪崩，緩存穿透，緩存預熱，緩存算法........... class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ab465595.html title=Memcached之緩存雪崩，緩存穿透，緩存預熱，緩存算法...........>Memcached之緩存雪崩，緩存穿透，緩存預熱，緩存算法...........</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/26c71b2e.html alt=db緩存雙寫一致性企業級解決方案 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/85f113d58f6f49638f070fff35d3f1e0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/26c71b2e.html title=db緩存雙寫一致性企業級解決方案>db緩存雙寫一致性企業級解決方案</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/83ffff02.html alt="redis緩存穿透, 緩存雪崩, 熱點緩存以及緩存雙寫一致性問題" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/83ffff02.html title="redis緩存穿透, 緩存雪崩, 熱點緩存以及緩存雙寫一致性問題">redis緩存穿透, 緩存雪崩, 熱點緩存以及緩存雙寫一致性問題</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>