<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>講透了RS485通訊接口的所有問題！ | 极客快訊</title><meta property="og:title" content="講透了RS485通訊接口的所有問題！ - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/c3392cf756574fe2bab25a96e6126877"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/18c4cc30.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/18c4cc30.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/18c4cc30.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/18c4cc30.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/18c4cc30.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/18c4cc30.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/18c4cc30.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/18c4cc30.html><meta property="article:published_time" content="2020-11-14T21:01:51+08:00"><meta property="article:modified_time" content="2020-11-14T21:01:51+08:00"><meta name=Keywords content><meta name=description content="講透了RS485通訊接口的所有問題！"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/18c4cc30.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>講透了RS485通訊接口的所有問題！</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div class=pgc-img><img alt=講透了RS485通訊接口的所有問題！ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c3392cf756574fe2bab25a96e6126877><p class=pgc-img-caption></p></div><p>RS485接口組成的半雙工網絡，一般是兩線制，多采用屏蔽雙絞線傳輸，這種接線方式為總線式拓撲結構在同一總線上最多可以掛接32個結點。我們知道，最初數據是模擬信號輸出簡單過程量，後來儀表接口是RS232接口，這種接口可以實現點對點的通信方式，但這種方式不能實現聯網功能，隨後出現的RS485解決了這個問題。為此本文通過問答的形式詳細介紹RS485接口。</p><p>一、什麼是RS-485接口？它比RS-232-C接口相比有何特點？</p><p>答：由於RS-232-C接口標準出現較早，難免有不足之處，主要有以下四點：</p><p>（1）接口的信號電平值較高，易損壞接口電路的芯片，又因為與TTL電平不兼容故需使用電平轉換電路方能與TTL電路連接。</p><p>（2）傳輸速率較低，在異步傳輸時，波特率為20Kbps。</p><p>（3）接口使用一根信號線和一根信號返回線而構成共地的傳輸形式，這種共地傳輸容易產生共模干擾，所以抗噪聲干擾性弱。</p><p>（4）傳輸距離有限，最大傳輸距離標準值為50英尺，實際上也只能用在50米左右。針對RS-232-C的不足，於是就不斷出現了一些新的接口標準，RS-485就是其中之一，它具有以下特點：</p><div class=pgc-img><img alt=講透了RS485通訊接口的所有問題！ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5d5304f89c08469ab6cb6d99d8fbb796><p class=pgc-img-caption></p></div><p>1）RS-485的電氣特性：邏輯“1”以兩線間的電壓差為+（2-6）V表示；邏輯“0”以兩線間的電壓差為-（2-6）V表示。接口信號電平比RS-232-C降低了，就不易損壞接口電路的芯片，且該電平與TTL電平兼容，可方便與TTL電路連接。</p><p>2）RS-485的數據最高傳輸速率為10Mbps</p><p>3）RS-485接口是採用平衡驅動器和差分接收器的組合，抗共模幹能力增強，即抗噪聲干擾性好。</p><p>4）RS-485接口的最大傳輸距離標準值為4000英尺，實際上可達3000米，另外RS-232-C接口在總線上只允許連接1個收發器，即單站能力。而RS-485接口在總線上是允許連接多達128個收發器。即具有多站能力，這樣用戶可以利用單一的RS-485接口方便地建立起設備網絡。</p><p>5）因RS-485接口具有良好的抗噪聲干擾性，長的傳輸距離和多站能力等上述優點就使其成為首選的串行接口。因為RS485接口組成的半雙工網絡，一般只需二根連線，所以RS485接口均採用屏蔽雙絞線傳輸。RS485接口連接器採用DB-9的9芯插頭座，與智能終端RS485接口採用DB-9（孔），與鍵盤連接的鍵盤接口RS485採用DB-9（針）。</p><p>二、RS-422與RS-485串行接口標準</p><p>1、平衡傳輸</p><p>RS-422、RS-485與RS-232不一樣，數據信號採用差分傳輸方式，也稱作平衡傳輸，它使用一對雙絞線，將其中一線定義為A，另一線定義為B</p><p>通常情況下，發送驅動器A、B之間的正電平在+2～+6V，是一個邏輯狀態，負電平在-2～6V，是另一個邏輯狀態。另有一個信號地C，在RS-485中還有一“使能”端，而在RS-422中這是可用可不用的。“使能”端是用於控制發送驅動器與傳輸線的切斷與連接。當“使能”端起作用時，發送驅動器處於高阻狀態，稱作“第三態”，即它是有別於邏輯“1”與“0”的第三態。</p><p>接收器也作與發送端相對的規定，收、發端通過平衡雙絞線將AA與BB對應相連，當在收端AB之間有大於+200mV的電平時，輸出正邏輯電平，小於-200mV時，輸出負邏輯電平。接收器接收平衡線上的電平範圍通常在200mV至6V之間。</p><p>2、RS-422電氣規定</p><p>RS-422標準全稱是“平衡電壓數字接口電路的電氣特性”，它定義了接口電路的特性。圖2是典型的RS-422四線接口。實際上還有一根信號地線，共5根線。圖1是其DB9連接器引腳定義。由於接收器採用高輸入阻抗和發送驅動器比RS232更強的驅動能力，故允許在相同傳輸線上連接多個接收節點，最多可接10個節點。即一個主設備（Master），其餘為從設備（Salve），從設備之間不能通信，所以RS-422支持點對多的雙向通信。接收器輸入阻抗為4k，故發端最大負載能力是10×4k+100Ω（終接電阻）。RS-422四線接口由於採用單獨的發送和接收通道，因此不必控制數據方向，各裝置之間任何必須的信號交換均可以按軟件方式（XON/XOFF握手）或硬件方式（一對單獨的雙絞線）實現。RS-422的最大傳輸距離為4000英尺（約1219米），最大傳輸速率為10Mb/s。其平衡雙絞線的長度與傳輸速率成反比，在100kb/s速率以下，才可能達到最大傳輸距離。只有在很短的距離下才能獲得最高速率傳輸。一般100米長的雙絞線上所能獲得的最大傳輸速率僅為1Mb/s。</p><p>RS-422需要一終接電阻，要求其阻值約等於傳輸電纜的特性阻抗。在矩距離傳輸時可不需終接電阻，即一般在300米以下不需終接電阻。終接電阻接在傳輸電纜的最遠端。</p><p>3、RS-485電氣規定</p><p>由於RS-485是從RS-422基礎上發展而來的，所以RS-485許多電氣規定與RS-422相仿。如都採用平衡傳輸方式、都需要在傳輸線上接終接電阻等。RS-485可以採用二線與四線方式，二線制可實現真正的多點雙向通信。</p><p>而採用四線連接時，與RS-422一樣只能實現點對多的通信，即只能有一個主（Master）設備，其餘為從設備，但它比RS-422有改進，無論四線還是二線連接方式總線上可多接到32個設備。</p><p>RS-485與RS-422的不同還在於其共模輸出電壓是不同的，RS-485是-7V至+12V之間，而RS-422在-7V至+7V之間，RS-485接收器最小輸入阻抗為12k劍鳵S-422是4k健；舊峽梢運礡S-485滿足所有RS-422的規範，所以RS-485的驅動器可以用在RS-422網絡中應用。</p><p>RS-485與RS-422一樣，其最大傳輸距離約為1219米，最大傳輸速率為10Mb/s。平衡雙絞線的長度與傳輸速率成反比，在100kb/s速率以下，才可能使用規定最長的電纜長度。只有在很短的距離下才能獲得最高速率傳輸。一般100米長雙絞線最大傳輸速率僅為1Mb/s。</p><p>RS-485需要2個終接電阻，其阻值要求等於傳輸電纜的特性阻抗。在矩距離傳輸時可不需終接電阻，即一般在300米以下不需終接電阻。終接電阻接在傳輸總線的兩端。</p><p>三、RS-422與RS-485的網絡安裝注意要點</p><p>RS-422可支持10個節點，RS-485支持32個節點，因此多節點構成網絡。網絡拓撲一般採用終端匹配的總線型結構，不支持環形或星形網絡。在構建網絡時，應注意如下幾點：</p><div class=pgc-img><img alt=講透了RS485通訊接口的所有問題！ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/619b9c73b2cb4c8da834fd5553544538><p class=pgc-img-caption></p></div><p>1、採用一條雙絞線電纜作總線，將各個節點串接起來，從總線到每個節點的引出線長度應儘量短，以便使引出線中的反射信號對總線信號的影響最低。所示為實際應用中常見的一些錯誤連接方式（a，c，e）和正確的連接方式（b，d，f）。a，c，e這三種網絡連接儘管不正確，在短距離、低速率仍可能正常工作，但隨著通信距離的延長或通信速率的提高，其不良影響會越來越嚴重，主要原因是信號在各支路末端反射後與原信號疊加，會造成信號質量下降。</p><p>2、應注意總線特性阻抗的連續性，在阻抗不連續點就會發生信號的反射。下列幾種情況易產生這種不連續性：總線的不同區段採用了不同電纜，或某一段總線上有過多收發器緊靠在一起安裝，再者是過長的分支線引出到總線。</p><p>總之，應該提供一條單一、連續的信號通道作為總線。</p><p>四、RS-422與RS-485傳輸線上匹配的一些說明</p><p>對RS-422與RS-485總線網絡一般要使用終接電阻進行匹配。但在短距離與低速率下可以不用考慮終端匹配。那麼在什麼情況下不用考慮匹配呢？理論上，在每個接收數據信號的中點進行採樣時，只要反射信號在開始採樣時衰減到足夠低就可以不考慮匹配。但這在實際上難以掌握，美國MAXIM公司有篇文章提到一條經驗性的原則可以用來判斷在什麼樣的數據速率和電纜長度時需要進行匹配：當信號的轉換時間（上升或下降時間）超過電信號沿總線單向傳輸所需時間的3倍以上時就可以不加匹配。例如具有限斜率特性的RS-485接口MAX483輸出信號的上升或下降時間最小為250ns，典型雙絞線上的信號傳輸速率約為0.2m/ns（24AWGPVC電纜），那麼只要數據速率在250kb/s以內、電纜長度不超過16米，採用MAX483作為RS-485接口時就可以不加終端匹配。</p><p>一般終端匹配採用終接電阻方法，前文已有提及，RS-422在總線電纜的遠端並接電阻，RS-485則應在總線電纜的開始和末端都需並接終接電阻。終接電阻一般在RS-422網絡中取100Ω，在RS-485網絡中取120Ω。相當於電纜特性阻抗的電阻，因為大多數雙絞線電纜特性阻抗大約在100～120Ω。這種匹配方法簡單有效，但有一個缺點，匹配電阻要消耗較大功率，對於功耗限制比較嚴格的系統不太適合。</p><p>另外一種比較省電的匹配方式是RC匹配，利用一隻電容C隔斷直流成分可以節省大部分功率。但電容C的取值是個難點，需要在功耗和匹配質量間進行折衷。</p><p>還有一種採用二極管的匹配方法，這種方案雖未實現真正的“匹配”，但它利用二極管的鉗位作用能迅速削弱反射信號，達到改善信號質量的目的。節能效果顯著。</p><p>五、RS-422與RS-485的接地問題</p><p>電子系統接地是很重要的，但常常被忽視。接地處理不當往往會導致電子系統不能穩定工作甚至危及系統安全。RS-422與RS-485傳輸網絡的接地同樣也是很重要的，因為接地系統不合理會影響整個網絡的穩定性，尤其是在工作環境比較惡劣和傳輸距離較遠的情況下，對於接地的要求更為嚴格。否則接口損壞率較高。很多情況下，連接RS-422、RS-485通信鏈路時只是簡單地用一對雙絞線將各個接口的“A”、“B”端連接起來。而忽略了信號地的連接，這種連接方法在許多場合是能正常工作的，但卻埋下了很大的隱患，這有下面二個原因：</p><p>1、共模干擾問題：正如前文已述，RS-422與RS-485接口均採用差分方式傳輸信號方式，並不需要相對於某個參照點來檢測信號，系統只需檢測兩線之間的電位差就可以了。但人們往往忽視了收發器有一定的共模電壓範圍，如RS-422共模電壓範圍為-7～+7V，而RS-485收發器共模電壓範圍為-7～+12V，只有滿足上述條件，整個網絡才能正常工作。當網絡線路中共模電壓超出此範圍時就會影響通信的穩定可靠，甚至損壞接口。以圖1為例，當發送驅動器A向接收器B發送數據時，發送驅動器A的輸出共模電壓為VOS，由於兩個系統具有各自獨立的接地系統，存在著地電位差VGPD。那麼，接收器輸入端的共模電壓VCM就會達到VCM=VOS+VGPD。RS-422與RS-485標準均規定VOS≤3V，但VGPD可能會有很大幅度（十幾伏甚至數十伏），並可能伴有強幹擾信號，致使接收器共模輸入VCM超出正常範圍，並在傳輸線路上產生干擾電流，輕則影響正常通信，重則損壞通信接口電路。</p><p>2、（EMI）問題：發送驅動器輸出信號中的共模部分需要一個返回通路，如沒有一個低阻的返回通道（信號地），就會以輻射的形式返回源端，整個總線就會像一個巨大的天線向外輻射電磁波。</p><p>由於上述原因，RS-422、RS-485儘管採用差分平衡傳輸方式，但對整個RS-422或RS-485網絡，必須有一條低阻的信號地。一條低阻的信號地將兩個接口的工作地連接起來，使共模干擾電壓VGPD被短路。</p><p>這條信號地可以是額外的一條線（非屏蔽雙絞線），或者是屏蔽雙絞線的屏蔽層。這是最通常的接地方法。</p><p>值得注意的是，這種做法僅對高阻型共模干擾有效，由於干擾源內阻大，短接後不會形成很大的接地環路電流，對於通信不會有很大影響。當共模干擾源內阻較低時，會在接地線上形成較大的環路電流，影響正常通信。筆者認為，可以採取以下三種措施：</p><p>（1）如果幹擾源內阻不是非常小，可以在接地線上加限流電阻以限制干擾電流。接地電阻的增加可能會使共模電壓升高，但只要控制在適當的範圍內就不會影響正常通信。</p><p>（2）採用浮地技術，隔斷接地環路。這是較常用也是十分有效的一種方法，當共模干擾內阻很小時上述方法已不能奏效，此時可以考慮將引入干擾的節點（例如處於惡劣的工作環境的現場設備）浮置起來（也就是系統的電路地與機殼或大地隔離），這樣就隔斷了接地環路，不會形成很大的環路電流。</p><p>（3）採用隔離接口。有些情況下，出於安全或其它方面的考慮，電路地必須與機殼或大地相連，不能懸浮，這時可以採用隔離接口來隔斷接地迴路，但是仍然應該有一條地線將隔離側的公共端與其它接口的工作地相連。</p><p>六、RS-422與RS-485的網絡失效保護</p><p>RS-422與RS-485標準都規定了接收器門限為±200mV。這樣規定能夠提供比較高的噪聲抑制能力，如前文所述，當接收器A電平比B電平高+200mV以上時，輸出為正邏輯，反之，則輸出為負邏輯。但由於第三態的存在，即在主機在發端發完一個信息數據後，將總線置於第三態，即總線空閒時沒有任何信號驅動總線，使AB之間的電壓在-200～+200mV直至趨於0V，這帶來了一個問題：接收器輸出狀態不確定。如果接收機的輸出為0V，網絡中從機將把其解釋為一個新的啟動位，並試圖讀取後續字節，由於永遠不會有停止位，產生一個幀錯誤結果，不再有設備請求總線，網絡陷於癱瘓狀態。除上述所述的總線空閒會造成兩線電壓差低於200mV的情況外，開路或短路時也會出現這種情況。故應採取一定的措施避免接收器處於不確定狀態。</p><p>通常是在總線上加偏置，當總線空閒或開路時，利用偏置電阻將總線偏置在一個確定的狀態（差分電壓≥-200mV）。如圖1。將A上拉到地，B下拉到5V，電阻的典型值是1kΩ，具體數值隨電纜的電容變化而變化。</p><p>上述方法是比較經典的方法，但它仍然不能解決總線短路時的問題，有些廠家將接收門限移到-200mV/-50mV，可解決這個問題。</p><p>七、RS-422與RS-485的瞬態保護</p><p>前文提到的信號接地措施，只對低頻率的共模干擾有保護作用，對於頻率很高的瞬態干擾就無能為力了。由於傳輸線對高頻信號而言就是相當於電感，因此對於高頻瞬態干擾，接地線實際等同於開路。這樣的瞬態干擾雖然持續時間短暫，但可能會有成百上千伏的電壓。</p><p>實際應用環境下還是存在高頻瞬態干擾的可能。一般在切換大功率感性負載如電機、變壓器、繼電器等或閃電過程中都會產生幅度很高的瞬態干擾，如果不加以適當防護就會損壞RS-422或RS-485通信接口。對於這種瞬態干擾可以採用隔離或旁路的方法加以防護。</p><p>1、隔離保護方法。這種方案實際上將瞬態高壓轉移到隔離接口中的電隔離層上，由於隔離層的高絕緣電阻，不會產生損害性的浪湧電流，起到保護接口的作用。通常採用高頻變壓器、光耦等元件實現接口的電氣隔離，已有器件廠商將所有這些元件集成在一片IC中，使用起來非常簡便。這種方案的優點是可以承受高電壓、持續時間較長的瞬態干擾，實現起來也比較容易，缺點是成本較高。</p><p>2、旁路保護方法。這種方案利用瞬態抑制元件（如TVS、MOV、氣體放電管等）將危害性的瞬態能量旁路到大地，優點是成本較低，缺點是保護能力有限，只能保護一定能量以內的瞬態干擾，持續時間不能很長，而且需要有一條良好的連接大地的通道，實現起來比較困難。實際應用中是將上述兩種方案結合起來靈活加以運用，如圖1。在這種方法中，隔離接口對大幅度瞬態干擾進行隔離，旁路元件則保護隔離接口不被過高的瞬態電壓擊穿。</p><p>八、採用RS485接口時，傳輸電纜的長度如何考慮？</p><p>在使用RS485接口時，對於特定的傳輸線經，從發生器到負載其數據信號傳輸所允許的最大電纜長度是數據信號速率的函數，這個長度數據主要是受信號失真及噪聲等影響所限制。最大電纜長度與信號速率的關係曲線是使用24AWG銅芯雙絞電話電纜（線徑為0。51mm），線間旁路電容為52。5PF/M，終端負載電阻為100歐時所得出。當數據信號速率降低到90Kbit/S以下時，假定最大允許的信號損失為6dBV時，則電纜長度被限制在1200M。在實用時是完全可以取得比它大的電纜長度。當使用不同線徑的電纜。則取得的最大電纜長度是不相同的。</p><p>九、如何實現RS-485/422多點通訊</p><p>RS-485總線上任何時候只能有一發送器發送。半雙工方式，主從只能一個發。全雙工方式，主站總可發送，從站只能有一個發送。</p><p>十、RS-485/RS422接口通訊時，在什麼條件下需要採用終端匹配？電阻值如何確定？如何配置終端匹配電阻？</p><p>在長線信號傳輸時，一般為了避免信號的反射和回波，需要在接收端接入終端匹配電阻。其終端匹配電阻值取決於電纜的阻抗特性，與電纜的長度無關。</p><p>RS-485/RS-422一般採用雙絞線（屏蔽或非屏蔽）連接，終端電阻一般介於100至140Ω之間，典型值為120Ω。在實際配置時，在電纜的兩個終端節點上，即最近端和最遠端，各接入一個終端電阻，而處於中間部分的節點則不能接入終端電阻，否則將導致通訊出錯。</p><p>十一、RS-485網不知道最遠站點是哪一個，應該如何接匹配電阻呢？</p><p>會出現這種情況，是由於用戶組成RS-485網時，沒有遵循站點至總線的連線應儘可能短的原則。如果總線佈線遵循這一原則，就不存在不知道哪個站點是最遠的問題。而且要注意，這樣的佈線，系統將會工作得不好。</p><p>十二、RS-485/RS-422接口為何在停止通信時接收器仍有數據輸出？</p><p>由於RS-485/RS-422在發送數據完成後，要求所有的發送使能控制信號關閉且保持接收使能有效，此時，總線驅動器進入高阻狀態且接收器能夠監測總線上是否有新的通信數據。但是由於此時總線處於無源驅動狀態（若總線有終端匹配電阻時，A和B線的差分電平為0，接收器的輸出不確定，且對AB線上的差分信號的變化很敏感；若無終端匹配，則總線處於高阻態，接收器的輸出不確定），容易受到外界的噪聲干擾。當噪聲電壓超過輸入信號門限時（典型值±200mV），接收器將輸出數據，導致對應的UART接收無效的數據，使緊接著的正常通訊出錯；另外一種情況可能發生在打開/關閉發送使能控制的瞬間，使接收器輸出信號，也會導致UART錯誤地接收。</p><p>解決方法：</p><p>1）在通訊總線上採用同相輸入端上拉（A線）、反相輸入端下拉（B線）的方法對總線進行鉗位，保證接收器輸出為固定的“1”電平；</p><p>2）採用內置防故障模式的MAX308x系列的接口產品替換該接口電路；</p><p>3）通過軟件方式消除，即在通信數據包內增加2-5個起始同步字節，只有在滿足同步頭後才開始真正的數據通訊。</p><p>十三、影響RS-485總線通訊速度和通信可靠性的三個因素</p><p>1、在通信電纜中的信號反射</p><p>在通信過程中，有兩種信號因導致信號反射：阻抗不連續和阻抗不匹配。阻抗不連續，信號在傳輸線末端突然遇到電纜阻抗很小甚至沒有，信號在這個地方就會引起反射，如圖1所示。這種信號反射的原理，與光從一種媒質進入另一種媒質要引起反射是相似的。消除這種反射的方法，就必須在電纜的末端跨接一個與電纜的特性阻抗同樣大小的終端電阻，使電纜的阻抗連續。由於信號在電纜上的傳輸是雙向的，因此，在通訊電纜的另一端可跨接一個同樣大小的終端電阻從理論上分析，在傳輸電纜的末端只要跨接了與電纜特性阻抗相匹配的終端電阻，就再也不會出現信號反射現象。但是，在實現應用中，由於傳輸電纜的特性阻抗與通訊波特率等應用環境有關，特性阻抗不可能與終端電阻完全相等，因此或多或少的信號反射還會存在。</p><p>引起信號反射的另個原因是數據收發器與傳輸電纜之間的阻抗不匹配。這種原因引起的反射，主要表現在通訊線路處在空閒方式時，整個網絡數據混亂。</p><p>信號反射對數據傳輸的影響，歸根結底是因為反射信號觸發了接收器輸入端的比較器，使接收器收到了錯誤的信號，導致CRC校驗錯誤或整個數據幀錯誤。</p><p>在信號分析，衡量反射信號強度的參數是RAF（RefectionAttenuationFactor反射衰減因子）。它的計算公式如式（1）。</p><p>RAF=20lg（Vref/Vinc）（1）</p><p>式中：Vref-反射信號的電壓大小；Vinc-在電纜與收發器或終端電阻連接點的入射信號的電壓大小。</p><p>具體的測量方法如圖3所示。例如，由實驗測得2.5MHz的入射信號正弦波的峰-峰值為+5V，反射信號的峰-峰值為+0.297V，則該通訊電纜在2.5MHz的通訊速率時，它的反射衰減因子為：RAF=20lg（0.297/2.5）=-24.52dB</p><p>要減弱反射信號對通訊線路的影響，通常採用噪聲抑制和加偏置電阻的方法。在實際應用中，對於比較小的反射信號，為簡單方便，經常採用加偏置電阻的方法。在通訊線路中，如何通過加偏置電阻提高通訊可靠性的原理，後面將做詳細介紹。</p><p>十四、在通訊電纜中的信號衰減</p><p>第二個影響信號傳輸的因素是信號在電纜的傳輸過程中衰減。一條傳輸電纜可以把它看出由分佈電容、分佈電感和電阻聯合組成的等效電路。</p><p>電纜的分佈電容C主要是由雙絞線的兩條平行導線產生。導線的電阻在這裡對信號的影響很小，可以忽略不計。信號的損失主要是由於電纜的分佈電容和分佈電感組成的LC低通濾波器。PROFIBUS用的LAN標準型二芯電感（西門子為DP總線選用的標準電纜），在不同波特率時的衰減係數。</p><p>十五、在通訊電纜中的純阻負載</p><p>影響通訊性能的第三個因素是純阻性負載（也叫直流負載）的大小。這裡指的純阻性負載主要由終端電阻、偏置電阻和RS-485收發器三者構成。</p><p>在敘述EIARS-485規範時曾提到過RS-485驅動器在帶了32個節點，配置了150Ω終端電阻的情況下，至少能輸出1.5V的差分電壓。一個接收器的輸入電阻為12kΩ，整個網絡的等效電路如圖5所示。按這樣計算，RS-485驅動器的負載能力為：RL=32個輸入電阻並聯||2個終端電阻=（（12000/32）×（150/2））/（12000/32）+（150/2））≈51.7Ω</p><p>現在比較常用的RS-485驅動器有MAX485、DS3695、MAX1488/1489以及和利時公司使用的SN75176A/D等，其中有的RS-485驅動器負載能力可以達到20Ω。在不考慮其它諸多因素的情況下，按照驅動能力和負載的關係計算，一個驅動器可帶節點的最大數量將遠遠大於32個。</p><div class=pgc-img><img alt=講透了RS485通訊接口的所有問題！ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/799864c6eaff45169fcc129d26e330c6><p class=pgc-img-caption></p></div><p>在通訊波特率比較高的時候，在線路上偏置電阻是很有必要的。偏置電阻的連接方法。它的作用是在線路進入空閒狀態後，把總線上沒有數據時（空閒方式）的電平拉離0電平。這樣一來，即使線路中出現了比較小的反射信號或干擾，掛接在總線上的數據接收器也不會由於這些信號的到來而產生誤動作。通過下面後例子了，可以計算出偏置電阻的大小：終端電阻Rt1=Rr2=120Ω；</p><p>假設反射信號最大的峰-峰值Vref≤0.3Vp-p，則負半周的電壓Vref≤0.15V;終端的電阻上由反射信號引起的反射電流Iref≤0.15/（120||120）=2.5mA。一般RS-485收發器（包括SN75176）的滯後電壓值（hysteresisvalue）為50mV，即：</p><p>（Ibias-Iref）×（Rt1||Rt2）≥50mV</p><p>於是可以計算出偏置電阻產生的偏置電流Ibias≥3.33mA</p><p>+5V=Ibias（R上拉+R下拉+（Rt1||Rt2））（2）</p><p>通過式2可以計算出R上拉=R下拉=720Ω</p><p>在實際應用中，RS-485總線加偏置電阻有兩種方法：</p><p>（1）把偏置電阻平衡分配給總線上的每一個收發器。這種方法給掛接在RS-485總線上的每一個收發器加了偏置電阻，給每一個收發器都加了一個偏置電壓。</p><p>（2）在一段總線上只用一對偏置電阻。這種方法對總線上存在大的反射信號或干擾信號比較有效。值得注意的是偏置電阻的加入，增加了總線的負載。</p><p>十六、RS-485總線的負載能力和通訊電纜長度之間的關係</p><p>在設計RS-485總線組成的網絡配置（總線長度和帶負載個數）時，應該考慮到三個參數：純阻性負載、信號衰減和噪聲容限。純阻性負載、信號衰減這兩個參數，在前面已經討論過，現在要討論的是噪聲容限（NoiseMargin）。RS-485總線接收器的噪聲容限至少應該大於200mV。前面的論述者是在假設噪聲容限為0的情況下進行的。</p><p>在實際應用中，為了提高總線的抗干擾能力，總希望系統的噪聲容限比EIARS-485標準中規定的好一些。從下面的公式能看出總線帶負載的多少和通訊電纜長度之間的關係：Vend=0.8（Vdriver-Vloss-Vnoise-Vbias）（3）</p><p>其中：Vend為總線末端的信號電壓，在標準測定時規定為0.2V；Vdriver為驅動器的輸出電壓（與負載數有關。負載數在5～35個之間，Vdriver=2.4V；當負載數小於5，Vdriver=2.5V；當負載數大於35，Vdriver≤2.3V）；Vloss為信號在總線中的傳輸過程中的損耗（與通訊電纜的規格和長度有關），由表1提供的標準電纜的衰減係數，根據公式衰減係數b=20lg（Vout/Vin）可以計算出Vloss=Vin-Vout=0.6V（注：通訊波特率為9.6kbps，電纜長度1km，如果特率增加，Vloss會相應增大）；Vnoise為噪聲容限，在標準測定時規定為0.1V；Vbias是由偏置電阻提供的偏置電壓（典型值為0.4V）。</p><p>式（3）中乘以0.8是為了使通信電纜不進入滿載狀態。從式（3）可以看出，Vdriver的大小和總線上帶負載數的多少成反比，Vloss的大小和總線長度成反比，其他幾個參數只和用的驅動器類型有關。因此，在選定了驅動器的RS-495總線上，在通信波特率一定的情況下，帶負載數的多少，與信號能傳輸的最大距離是直接相關的。具體關係是：</p><p>在總線允許的範圍內，帶負載數越多，信號能傳輸的距離就越小；帶負載數據少，信號能傳輸的距離就發越遠。</p><p>十七、分佈電容對RS-485總線傳輸性能的影響</p><p>電纜的分佈電容主是由雙絞線的兩條平行導線產生。另外，導線和地之間也存在分佈電容，雖然很小，但在分析時也不能忽視。分佈電容對總線傳輸性能的影響，主要是因為總線上傳輸的是基波信號，信號的表達方式只有“1”和“0”。在特殊的字節中，例如0x01，信號“0”使得分佈電容有足夠的充電時間，而信號“1”到來時，由於分佈電容中的電荷，來不及放電，（Vin+）-（Vin-）-還大於200mV，結果使接愛誤認為是“0”，而最終導致CRC校驗錯誤，整個數據幀傳輸錯誤。</p><p>由於總線上分佈影響，導致數據傳輸錯誤，從而使整個網絡性能降低。解決這個問題有兩種方法：</p><p>（1）降低數據傳輸的波特率；</p><p>（2）使用分佈電容小的電纜，提高傳輸線的質量。</p><p>十八、單工、半雙工和全雙工的定義</p><p>1、如果在通信過程的任意時刻，信息只能由一方A傳到另一方B，則稱為單工。</p><p>2、如果在任意時刻，信息既可由A傳到B，又能由B傳A，但只能由一個方向上的傳輸存在，稱為半雙工傳輸。</p><p>3、如果在任意時刻，線路上存在A到B和B到A的雙向信號傳輸，則稱為全雙工。</p><p>電話線就是二線全雙工信道。由於採用了回波抵消技術，雙向的傳輸信號不致混淆不清。雙工信道有時也將收、發信道分開，採用分離的線路或頻帶傳輸相反方向的信號，如回線傳輸。</p><div class=pgc-img><img alt=講透了RS485通訊接口的所有問題！ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/baa163495a0147308bc01434e30d2029><p class=pgc-img-caption></p></div><p><a class=pgc-link data-content=mp href="https://www.toutiao.com/i6811997683146818052/?group_id=6811997683146818052" rel="noopener noreferrer" target=_blank>弱電工程RS485總線知識彙總</a></p><div class=pgc-img><img alt=講透了RS485通訊接口的所有問題！ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a32eb19499de43818b2eb57ef46abbe0><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>講透</a></li><li><a>RS485</a></li><li><a>通訊</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/e623c02.html alt=終於有人把RS485通訊的正確接線方式講明白了，網友：這下好辦了 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3b4c450a0c934c928cd48b18ac8690eb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e623c02.html title=終於有人把RS485通訊的正確接線方式講明白了，網友：這下好辦了>終於有人把RS485通訊的正確接線方式講明白了，網友：這下好辦了</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f3767255.html alt=講透機器學習中的梯度下降 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5c80301e53424671bc22755be2e4ee33 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f3767255.html title=講透機器學習中的梯度下降>講透機器學習中的梯度下降</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/17eee2b1.html alt="小蜜團隊萬字長文 | 講透對話管理模型最新研究進展" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/249d781057744bdcb94e007250ac41bc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/17eee2b1.html title="小蜜團隊萬字長文 | 講透對話管理模型最新研究進展">小蜜團隊萬字長文 | 講透對話管理模型最新研究進展</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/36e9a98b.html alt=點到點和端到端通訊 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6c566b69dce94ff7bb8baa7ad4e509eb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/36e9a98b.html title=點到點和端到端通訊>點到點和端到端通訊</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d7304ae3.html alt=12個問答，講透鈦合金加工問題！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/bc0aed600ff24c2e886f021f808436b7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d7304ae3.html title=12個問答，講透鈦合金加工問題！>12個問答，講透鈦合金加工問題！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/aa058a92.html alt="物聯網常見通信協議與通訊協議梳理【下】- 通訊協議A2" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4350ec391836485fa56bc2a5a8bb004c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/aa058a92.html title="物聯網常見通信協議與通訊協議梳理【下】- 通訊協議A2">物聯網常見通信協議與通訊協議梳理【下】- 通訊協議A2</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/00100b1c.html alt=一作+通訊，不用做實驗也能發Nature，羨慕嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ca7fc55c34b34529881eea7628c2d697 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/00100b1c.html title=一作+通訊，不用做實驗也能發Nature，羨慕嗎？>一作+通訊，不用做實驗也能發Nature，羨慕嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/27041db9.html alt=終於有人把Elasticsearch原理講透了（二） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/6ea3a93e5f194b1da3eb797ab1c0e090 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/27041db9.html title=終於有人把Elasticsearch原理講透了（二）>終於有人把Elasticsearch原理講透了（二）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7b29400d.html alt=一文講透什麼是數據治理和數據管理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/f41e85be27464ed898e9ecbdc2b6666a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7b29400d.html title=一文講透什麼是數據治理和數據管理>一文講透什麼是數據治理和數據管理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e13c717e.html alt=ModBus通訊協議：傳輸模式+地址、功能碼、數據域+數據格式 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b65f601857ff492baab523f1063e2adc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e13c717e.html title=ModBus通訊協議：傳輸模式+地址、功能碼、數據域+數據格式>ModBus通訊協議：傳輸模式+地址、功能碼、數據域+數據格式</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7e3e2644.html alt=[業務課堂]通訊寫作中的順敘、倒敘、插敘 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7e3e2644.html title=[業務課堂]通訊寫作中的順敘、倒敘、插敘>[業務課堂]通訊寫作中的順敘、倒敘、插敘</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a6b67cfa.html alt="疫情期間信息通訊服務得到廣泛應用 積極支撐復工復產復學" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a6b67cfa.html title="疫情期間信息通訊服務得到廣泛應用 積極支撐復工復產復學">疫情期間信息通訊服務得到廣泛應用 積極支撐復工復產復學</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c50cba30.html alt=RS485與RS232的特點與區別 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1541064565016b936e4c642 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c50cba30.html title=RS485與RS232的特點與區別>RS485與RS232的特點與區別</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/17ceb107.html alt=還搞不懂RS485？18個問答徹底講明白RS485 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d24428bcd32741f8b3478b386af626ec style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/17ceb107.html title=還搞不懂RS485？18個問答徹底講明白RS485>還搞不懂RS485？18個問答徹底講明白RS485</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d086bf2a.html alt=18個問答，講透了RS485接口 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RwHvZez9J0TjHz style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d086bf2a.html title=18個問答，講透了RS485接口>18個問答，講透了RS485接口</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>