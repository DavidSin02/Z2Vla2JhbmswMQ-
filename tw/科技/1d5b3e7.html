<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>程序靜態分析第一課 | 极客快訊</title><meta property="og:title" content="程序靜態分析第一課 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/153130891604092c6b2bfb0"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/1d5b3e7.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/1d5b3e7.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/1d5b3e7.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/1d5b3e7.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/1d5b3e7.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/1d5b3e7.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/1d5b3e7.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/1d5b3e7.html><meta property="article:published_time" content="2020-10-29T21:04:01+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:01+08:00"><meta name=Keywords content><meta name=description content="程序靜態分析第一課"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/1d5b3e7.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>程序靜態分析第一課</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p><strong>奇技指南：</strong>今天來講講程序靜態分析。</p><p>本文首發於Qtest之道，已授權轉載。</p><div class=pgc-img><img alt=程序靜態分析第一課 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/153130891604092c6b2bfb0><p class=pgc-img-caption></p></div><ul><li>事例一</li></ul><p>飛機為了保證飛行安全，在很多設備上會設置冗餘設備，一般來說都是<strong>一主二備三應急</strong>，一架飛機上同樣功能的設備設施，會安裝起碼三套或更多來應付其中一套出故障而導致飛機飛行安全出問題。</p><ul><li>事例二</li></ul><p>以電控為例，高可靠度的工業系統一般會選擇傳感器<strong>3取2</strong>或<strong>5取3</strong>方式輸入。</p><p><strong>Q：</strong>什麼是3取2呢？</p><p><strong>A：</strong>以平行方式連接三個一樣的傳感器，輸入同一個數據處理設備。</p><p>那麼當其中任一個出現損壞時，該傳感器就會出現異常，和其他兩個傳感器衝突。</p><p>這時候處理設備會取另外2個傳感器的數據，拋棄掉異常數據，從而<strong>保證數據準確</strong>。</p><p>為了高可靠性、安全性，我們要付出很多額外的成本和精力。</p><p>為什麼這些缺陷、異常或者故障無法避免？</p><p>為什麼這些設備系統無法保證完全可靠？</p><h1><strong>哥德爾不完備定理</strong></h1><p><strong>一致性</strong>（consistency）：對於一個命題，你不能證明它既是真的也是假的。</p><p><strong>完備性</strong>（completeness）： 對於任意一個命題，你要麼可以證明它是對的，要麼你可以證明它是錯的。</p><p><strong>第一定理</strong></p><p>一個足夠複雜的公理體系如果具備一致性，那麼就不具備完備性。也就是說，完備性和一致性不可能同時獲得。</p><p>大白話解釋一下:</p><p>即一個沒有矛盾的公理體系內，總有一些命題是說不清楚對還是錯的。</p><p><strong>第二定理</strong></p><p>公理體系的一致性不能在這個公理體系內被推導出來。</p><p>也就是說不僅完備性和一致性有矛盾，即使是一致性本身，也不能在公理體系內得到證明。</p><p>哥德爾不完全性定理一舉粉碎了數學家兩千年來的信念，所有邏輯體系都存在有不能被證明或否定的命題。</p><p>因此，所有邏輯體系都 “<strong>不完備</strong>”。</p><p>同理，我們可以推導出任何複雜的系統或設備或軟件程序，都是不完備的，即無法保證完全可靠的，可能會存在問題的。</p><p>既然問題一定存在，我們繼續探究，是否存在一些方法，能讓我們來判定這些問題的存在？</p><h1><strong>停機問題證明</strong></h1><p><strong>判定問題</strong>（Decision Problem）：回答是/否的問題。</p><p><strong>可判定問題</strong>（Decidable Problem）是指一個判定問題，該問題存在一個算法，使得對於該問題的每一個實例都能給出是/否的答案。</p><p><strong>停機問題</strong>（英語：halting problem）是邏輯數學中可計算性理論的一個問題。</p><p>通俗地說，停機問題就是判斷任意一個程序是否能在有限的時間之內結束運行的問題。</p><p>該問題等價於如下的判定問題：</p><p>是否存在一個程序A，對於任意輸入的程序B，能夠判斷B會在有限時間內結束或者死循環。</p><p><strong>圖靈於1936年證明，不存在一個算法能回答停機問題。</strong></p><p>假設存在停機問題判斷算法：bool Halt(p), true為停機，false為死循環，p表示特定程序。</p><div class=pgc-img><img alt=程序靜態分析第一課 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153130911798355a055baf3><p class=pgc-img-caption></p></div><p>Halt(Evil)的返回值是什麼？</p><p>如果返回true，表示停機，而實際Evil()是死循環狀態。</p><p>如果返回false，表示死循環，而實際Evil()是停機狀態。</p><p>類似於理髮師悖論：理髮師給那些不給自己理髮的人理髮，那麼理髮師給自己理髮麼？</p><p><strong>結論</strong>：不存在一個判定一切程序的程序，因為這個程序本身也是程序，即停機問題是一個<strong>不可判定問題</strong>。</p><p>並不是所有的問題都是可以判定的，並且不管是用人去檢查程序，還是用程序去檢測程序，都無法保證找出所有的問題。</p><p>所以我們是不是就會放棄對問題的判定檢測？</p><p>不可能的。</p><p>正確的思路應該是：</p><p>基於目前我們已知的現狀，應該如何更好的發揮我們有限的能力去儘可能的找出更多的問題？</p><p>引出我們的課程</p><p>Q：如何利用程序去檢測程序中的問題？</p><p>A：程序靜態分析</p><p>程序靜態分析（program static analysis）是指在不運行代碼的方式下，通過詞法分析、語法分析、控制流、數據流分析等技術對程序代碼進行掃描，驗證代碼是否滿足規範性、安全性、可靠性、可維護性等指標的一種代碼分析技術。</p><p>程序分析技術最早源自編譯器優化，至今已經發展了幾十年，在學術界已經有了<strong>數據流分析</strong>、<strong>過程間分析</strong>、<strong>指針分析</strong>、<strong>約束求解</strong>和<strong>符號執行</strong>等多個研究方向。</p><p>但是由於專業知識的門檻太高，導致學術界的一些研究成果很難落地到工業界，這中間需要一大批既懂學術研究又懂工業界應用的人來作為傳輸的紐帶。</p><p>這也是作者開始寫這個系列課程的原因，我希望大家在看完系列課程後，能夠對學術界的專業知識有個整體的基本瞭解。如果恰巧有人非常有興趣，可以一起來做更深入的探索，將學術界的研究吸收消化並輸出到工業界中，也是一大幸事。</p><h1>通過統計獲得啟發式規則</h1><p>這是工業界的常規手段，即我們日常熟知的代碼靜態分析主要使用的方法。</p><p>例如針對File.Open的啟發式規則：</p><p>如果被調用函數名為java.io.File.Open，則假設該函數返回一個指向新內存位置的指針，並且不影響已有指向關係。</p><ul><li>該規則不能保證正確</li><li>如果用戶用了不同的JDK實現</li><li>如果用戶自己的函數命名為java.io.File.Open</li><li>如果Java未來升級新版本引入了不同的行為</li><li>啟發式規則通常不容易定義</li><li>File.Open只是JDK的一個函數，人工為JDK所有函數建模需要大量時間</li><li>對於涉及具體應用程序的未知量無法提前定義</li><li>應用程序需求、軟件設計上的約束</li><li>採用統計的方法獲得啟發式規則</li><li>例1：對於File.Open函數的大量執行進行統計，發現該函數始終不改變任何已有指向關係，於是認為該函數不改變指向關係。</li><li>例2：對於大量代碼分析發現99.9%的情況下調用File.Open()之後都會調用File.Close()，於是可以將該要求記錄為一條設計約束，剩下0.1%的情況就是潛在Bug。</li></ul><p>目前市面上開源的靜態掃描掃描工具，例如<strong>PMD</strong>、<strong>Sonar</strong>、<strong>Lint</strong>和<strong>阿里P3C</strong>等都是啟發式規則的典型代表。</p><h1>近似求解+抽象</h1><p>此乃學術界的研究。</p><p>近似法：允許在得不到精確值的時候，給出不精確的答案。</p><p>原始判定問題：輸出“是”或者“否”， 近似求解判定問題：輸出“是”、“否”或者“不知道”。</p><p>求近似解基本原則——抽象，這個不做過多解釋，我們用一個例子來幫助大家理解：</p><ul><li>正 ={所有的正數}</li><li>零={0}</li><li>負= {所有的負數}</li></ul><p>正+負=？</p><p>解決方案：增加抽象符號表示“不知道”——槑</p><p>槑= {所有整數}</p><p>我們來填寫以下抽象後加法運算表：</p><div class=pgc-img><img alt=程序靜態分析第一課 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1531309798032f31755f481><p class=pgc-img-caption></p></div><p>基於這種抽象，如果我們在代碼中遇到了變量運算和賦值，就可以給出一個大概的判斷，使整個程序具有一定的可分析性。</p><p>同理，我們把程序進行不同程度的抽象，然後求出近似解，就是程序分析。</p><p>基於抽象的程序分析有以下四大類：</p><p>1. 數據流分析</p><ul><li>如何對分支、循環等控制結構進行抽象</li></ul><p>2. 過程間分析</p><ul><li>如何對函數調用關係進行抽象</li></ul><p>3. 指針分析</p><ul><li>如何對堆上的指向結構進行抽象</li></ul><p>4. 約束求解和符號執行</p><ul><li>如何確定某條路徑的可執行性</li></ul><p>看到這裡是不是覺得依然很難理解程序怎麼抽象的？</p><p>沒關係，我們會在後續的文章中依次詳細講解這四類程序分析。</p><p>延伸問題思考：</p><p>問題1：測試人員能否找出軟件中所有的BUG？</p><p>問題2：人工智能駕駛技術能否徹底避免車禍？</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>靜態</a></li><li><a>程序</a></li><li><a>第一</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/a9b102a8.html alt=彙編語言之我的第一個彙編程序 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1539083351400f739f99b07 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a9b102a8.html title=彙編語言之我的第一個彙編程序>彙編語言之我的第一個彙編程序</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e39c08d7.html alt=動態網站和靜態網站有什麼區別 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6a06f21d115b4b93a7934a7075691503 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e39c08d7.html title=動態網站和靜態網站有什麼區別>動態網站和靜態網站有什麼區別</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5f3a2646.html alt=第一文，起源 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1525685347385f1b0134887 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5f3a2646.html title=第一文，起源>第一文，起源</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/87ec6d9d.html alt=管理評審程序（IAO9001程序文件範本） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/87ec6d9d.html title=管理評審程序（IAO9001程序文件範本）>管理評審程序（IAO9001程序文件範本）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0fd25820.html alt=質量管理體系程序文件-FMEA程序 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0fd25820.html title=質量管理體系程序文件-FMEA程序>質量管理體系程序文件-FMEA程序</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e0ffb976.html alt=不合格、糾正措施程序文件（ISO9001程序文件範本） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e0ffb976.html title=不合格、糾正措施程序文件（ISO9001程序文件範本）>不合格、糾正措施程序文件（ISO9001程序文件範本）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/16c259de.html alt=什麼是程序文件？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/16c259de.html title=什麼是程序文件？>什麼是程序文件？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a8c41b36.html alt=今天聊聊程序的文件的概念 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a8c41b36.html title=今天聊聊程序的文件的概念>今天聊聊程序的文件的概念</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9cd79f8d.html alt=程序文件-ISO9001 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/2e673ba29f5545fd8aea4073e1c638c3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9cd79f8d.html title=程序文件-ISO9001>程序文件-ISO9001</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e56d2fb8.html alt=程序文件主要包括哪些內容？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e56d2fb8.html title=程序文件主要包括哪些內容？>程序文件主要包括哪些內容？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4526bc23.html alt=程序文件沒有用？管理全靠你盯著？也許是你對程序文件有誤解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/25f214b9-177d-4e1e-8ccd-1c3fe7c07fe5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4526bc23.html title=程序文件沒有用？管理全靠你盯著？也許是你對程序文件有誤解>程序文件沒有用？管理全靠你盯著？也許是你對程序文件有誤解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c81e50df.html alt=程序文件流程圖 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/3a0300041dc3570ffec5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c81e50df.html title=程序文件流程圖>程序文件流程圖</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/300f6ba5.html alt=程序文件的管理主要有哪些方面的內容？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/300f6ba5.html title=程序文件的管理主要有哪些方面的內容？>程序文件的管理主要有哪些方面的內容？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5ad5161d.html alt=食品企業程序文件範本 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/6cb0d535ec904fa2ac5d54a06cea18b4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5ad5161d.html title=食品企業程序文件範本>食品企業程序文件範本</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d4d77858.html alt=動、靜態扭矩在汽車裝配緊固件中的應用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/21327d489e004cc7bcd527476b85fe20 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d4d77858.html title=動、靜態扭矩在汽車裝配緊固件中的應用>動、靜態扭矩在汽車裝配緊固件中的應用</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>