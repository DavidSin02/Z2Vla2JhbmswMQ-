<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>åŸºæ–¼Canalå’ŒKafkaå¯¦ç¾MySQLçš„Binlogè¿‘å¯¦æ™‚åŒæ­¥ | æå®¢å¿«è¨Š</title><meta property="og:title" content="åŸºæ–¼Canalå’ŒKafkaå¯¦ç¾MySQLçš„Binlogè¿‘å¯¦æ™‚åŒæ­¥ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/dafc2ca594c643728ee9361b349265ae"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/20559cc7.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/20559cc7.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/20559cc7.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/20559cc7.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/20559cc7.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/20559cc7.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/20559cc7.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/20559cc7.html><meta property="article:published_time" content="2020-11-14T21:00:58+08:00"><meta property="article:modified_time" content="2020-11-14T21:00:58+08:00"><meta name=Keywords content><meta name=description content="åŸºæ–¼Canalå’ŒKafkaå¯¦ç¾MySQLçš„Binlogè¿‘å¯¦æ™‚åŒæ­¥"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/20559cc7.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>åŸºæ–¼Canalå’ŒKafkaå¯¦ç¾MySQLçš„Binlogè¿‘å¯¦æ™‚åŒæ­¥</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p>ä½œè€…ï¼šThrowable</p><h2 class=heading>å‰æ</h2><p>è¿‘æ®µæ™‚é–“ï¼Œæ¥­å‹™ç³»çµ±æ¶æ§‹åŸºæœ¬å®Œå‚™ï¼Œæ•¸æ“šå±¤é¢çš„å»ºè¨­æ¯”è¼ƒè–„å¼±ï¼Œå› ç‚ºç­†è€…ç›®å‰å·¥ä½œé‡å¿ƒåœ¨æ–¼æ­å»ºä¸€å€‹å°å‹çš„æ•¸æ“šå¹³è‡ºã€‚å„ªå…ˆç´šæ¯”è¼ƒé«˜çš„ä¸€å€‹ä»»å‹™å°±æ˜¯éœ€è¦è¿‘å¯¦æ™‚åŒæ­¥æ¥­å‹™ç³»çµ±çš„æ•¸æ“šï¼ˆåŒ…æ‹¬ä¿å­˜ã€æ›´æ–°æˆ–è€…è»Ÿåˆªé™¤ï¼‰åˆ°ä¸€å€‹å¦ä¸€å€‹æ•¸æ“šæºï¼ŒæŒä¹…åŒ–ä¹‹å‰éœ€è¦æ¸…æ´—æ•¸æ“šä¸¦ä¸”æ§‹å»ºä¸€å€‹ç›¸å°åˆç†çš„ä¾¿æ–¼å¾ŒçºŒæ¥­å‹™æ•¸æ“šçµ±è¨ˆã€æ¨™ç±¤ç³»çµ±æ§‹å»ºç­‰æ“´å±•åŠŸèƒ½çš„æ•¸æ“šæ¨¡å‹ã€‚åŸºæ–¼ç•¶å‰åœ˜éšŠçš„è³‡æºå’Œèƒ½åŠ›ï¼Œå„ªå…ˆèª¿ç ”äº†Alibabaé–‹æºä¸­é–“ä»¶Canalçš„ä½¿ç”¨ã€‚</p><p><br></p><div class=pgc-img><img alt=åŸºæ–¼Canalå’ŒKafkaå¯¦ç¾MySQLçš„Binlogè¿‘å¯¦æ™‚åŒæ­¥ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dafc2ca594c643728ee9361b349265ae><p class=pgc-img-caption></p></div><p><br></p><p>é€™ç¯‡æ–‡ç« ç°¡å–®ä»‹ç´¹ä¸€ä¸‹å¦‚ä½•å¿«é€Ÿåœ°æ­å»ºä¸€å¥—Canalç›¸é—œçš„çµ„ä»¶ã€‚</p><h2 class=heading>é—œæ–¼Canal</h2><h3 class=heading>ç°¡ä»‹</h3><p>ä¸‹é¢çš„ç°¡ä»‹å’Œä¸‹ä¸€ç¯€çš„åŸç†å‡ä¾†è‡ªæ–¼Canalé …ç›®çš„READMEï¼š</p><div class=pgc-img><img alt=åŸºæ–¼Canalå’ŒKafkaå¯¦ç¾MySQLçš„Binlogè¿‘å¯¦æ™‚åŒæ­¥ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/969b5fe5dfc14744870ccae0a9e78c58><p class=pgc-img-caption></p></div><p>Canal[kÉ™'nÃ¦l]ï¼Œè­¯æ„ç‚ºæ°´é“/ç®¡é“/æºæ¸ ï¼Œä¸»è¦ç”¨é€”æ˜¯åŸºæ–¼MySQLæ•¸æ“šåº«å¢é‡æ—¥èªŒè§£æï¼Œæä¾›å¢é‡æ•¸æ“šè¨‚é–±å’Œæ¶ˆè²»ã€‚æ—©æœŸé˜¿é‡Œå·´å·´å› ç‚ºæ­å·å’Œç¾åœ‹é›™æ©Ÿæˆ¿éƒ¨ç½²ï¼Œå­˜åœ¨è·¨æ©Ÿæˆ¿åŒæ­¥çš„æ¥­å‹™éœ€æ±‚ï¼Œå¯¦ç¾æ–¹å¼ä¸»è¦æ˜¯åŸºæ–¼æ¥­å‹™triggerç²å–å¢é‡è®Šæ›´ã€‚å¾ 2010 å¹´é–‹å§‹ï¼Œæ¥­å‹™é€æ­¥å˜—è©¦æ•¸æ“šåº«æ—¥èªŒè§£æç²å–å¢é‡è®Šæ›´é€²è¡ŒåŒæ­¥ï¼Œç”±æ­¤è¡ç”Ÿå‡ºäº†å¤§é‡çš„æ•¸æ“šåº«å¢é‡è¨‚é–±å’Œæ¶ˆè²»æ¥­å‹™ã€‚</p><p>åŸºæ–¼æ—¥èªŒå¢é‡è¨‚é–±å’Œæ¶ˆè²»çš„æ¥­å‹™åŒ…æ‹¬ï¼š</p><ul><li>æ•¸æ“šåº«é¡åƒ</li><li>æ•¸æ“šåº«å¯¦æ™‚å‚™ä»½</li><li>ç´¢å¼•æ§‹å»ºå’Œå¯¦æ™‚ç¶­è­·ï¼ˆæ‹†åˆ†ç•°æ§‹ç´¢å¼•ã€å€’æ’ç´¢å¼•ç­‰ï¼‰</li><li>æ¥­å‹™Cacheåˆ·æ–°</li><li>å¸¶æ¥­å‹™é‚è¼¯çš„å¢é‡æ•¸æ“šè™•ç†</li></ul><h3 class=heading>Canalçš„å·¥ä½œåŸç†</h3><p>MySQLä¸»å‚™è¤‡è£½åŸç†ï¼š</p><p><br></p><div class=pgc-img><img alt=åŸºæ–¼Canalå’ŒKafkaå¯¦ç¾MySQLçš„Binlogè¿‘å¯¦æ™‚åŒæ­¥ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4de3b09b89e74cb789e4b02070568158><p class=pgc-img-caption></p></div><p><br></p><ul><li>MySQLçš„Masterå¯¦ä¾‹å°‡æ•¸æ“šè®Šæ›´å¯«å…¥äºŒé€²åˆ¶æ—¥èªŒï¼ˆbinary logï¼Œå…¶ä¸­è¨˜éŒ„å«åšäºŒé€²åˆ¶æ—¥èªŒäº‹ä»¶binary log eventsï¼Œå¯ä»¥é€šéshow binlog eventsé€²è¡ŒæŸ¥çœ‹ï¼‰</li><li>MySQLçš„Slaveå¯¦ä¾‹å°‡masterçš„binary log eventsæ‹·è²åˆ°å®ƒçš„ä¸­ç¹¼æ—¥èªŒï¼ˆrelay logï¼‰</li><li>MySQLçš„Slaveå¯¦ä¾‹é‡æ”¾relay logä¸­çš„äº‹ä»¶ï¼Œå°‡æ•¸æ“šè®Šæ›´åæ˜ å®ƒåˆ°è‡ªèº«çš„æ•¸æ“š</li></ul><p>Canalçš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š</p><ul><li>Canalæ¨¡æ“¬MySQL Slaveçš„äº¤äº’å”è­°ï¼Œå½è£è‡ªå·±ç‚ºMySQL Slaveï¼Œå‘MySQL Masterç™¼é€dumpå”è­°</li><li>MySQL Masteræ”¶åˆ°dumpè«‹æ±‚ï¼Œé–‹å§‹æ¨é€binary logçµ¦Slaveï¼ˆå³Canalï¼‰</li><li>Canalè§£æbinary logå°è±¡ï¼ˆåŸå§‹ç‚ºbyteæµï¼‰ï¼Œä¸¦ä¸”å¯ä»¥é€šéé€£æ¥å™¨ç™¼é€åˆ°å°æ‡‰çš„æ¶ˆæ¯éšŠåˆ—ç­‰ä¸­é–“ä»¶ä¸­</li></ul><h3 class=heading>é—œæ–¼Canalçš„ç‰ˆæœ¬å’Œéƒ¨ä»¶</h3><p>æˆªæ­¢ç­†è€…é–‹å§‹ç·¨å¯«æœ¬æ–‡çš„æ™‚å€™ï¼ˆ2020-03-05ï¼‰ï¼ŒCanalçš„æœ€æ–°ç™¼å¸ƒç‰ˆæœ¬æ˜¯v1.1.5-alpha-1ï¼ˆ2019-10-09ç™¼ä½ˆçš„ï¼‰ï¼Œæœ€æ–°çš„æ­£å¼ç‰ˆæ˜¯v1.1.4ï¼ˆ2019-09-02ç™¼ä½ˆçš„ï¼‰ã€‚å…¶ä¸­ï¼Œv1.1.4ä¸»è¦æ·»åŠ äº†é‘‘æ¬Šã€ç›£æ§çš„åŠŸèƒ½ï¼Œä¸¦ä¸”åšäº†ä¸€äº›åˆ—çš„æ€§èƒ½å„ªåŒ–ï¼Œæ­¤ç‰ˆæœ¬é›†æˆçš„é€£æ¥å™¨æ˜¯Tcpã€Kafkaå’ŒRockerMQã€‚è€Œv1.1.5-alpha-1ç‰ˆæœ¬å·²ç¶“æ–°å¢äº†RabbitMQé€£æ¥å™¨ï¼Œä½†æ˜¯æ­¤ç‰ˆæœ¬çš„RabbitMQé€£æ¥å™¨æš«æ™‚ä¸èƒ½å®šç¾©é€£æ¥RabbitMQçš„ç«¯å£è™Ÿï¼Œä¸éæ­¤å•é¡Œå·²ç¶“åœ¨masteråˆ†æ”¯ä¸­ä¿®å¾©ï¼ˆå…·é«”å¯ä»¥åƒçœ‹æºç¢¼ä¸­çš„CanalRabbitMQProduceré¡çš„æäº¤è¨˜éŒ„ï¼‰ã€‚æ›è¨€ä¹‹ï¼Œv1.1.4ç‰ˆæœ¬ä¸­ç›®å‰èƒ½ä½¿ç”¨çš„å…§ç½®é€£æ¥å™¨åªæœ‰Tcpã€Kafkaå’ŒRockerMQä¸‰ç¨®ï¼Œå¦‚æœæƒ³åšé®®ä½¿ç”¨RabbitMQé€£æ¥å™¨ï¼Œå¯ä»¥é¸ç”¨ä¸‹é¢çš„å…©ç¨®æ–¹å¼ä¹‹ä¸€ï¼š</p><ul><li>é¸ç”¨v1.1.5-alpha-1ç‰ˆæœ¬ï¼Œä½†æ˜¯ç„¡æ³•ä¿®æ”¹RabbitMQçš„portå±¬æ€§ï¼Œé»˜èªç‚º5672ã€‚</li><li>åŸºæ–¼masteråˆ†æ”¯è‡ªè¡Œæ§‹å»ºCanalã€‚</li></ul><p>ç›®å‰ï¼ŒCanalé …ç›®çš„æ´»èºåº¦æ¯”è¼ƒé«˜ï¼Œä½†æ˜¯è€ƒæ…®åˆ°åŠŸèƒ½çš„ç©©å®šæ€§å•é¡Œï¼Œç­†è€…å»ºè­°é¸ç”¨ç©©å®šç‰ˆæœ¬åœ¨ç”Ÿç”¢ç’°å¢ƒä¸­å¯¦æ–½ï¼Œç•¶å‰å¯ä»¥é¸ç”¨v1.1.4ç‰ˆæœ¬ï¼Œ<strong>æœ¬æ–‡çš„ä¾‹å­ç”¨é¸ç”¨çš„å°±æ˜¯v1.1.4ç‰ˆæœ¬ï¼Œé…åˆKafkaé€£æ¥å™¨ä½¿ç”¨</strong>ã€‚Canalä¸»è¦åŒ…æ‹¬ä¸‰å€‹æ ¸å¿ƒéƒ¨ä»¶ï¼š</p><ul><li>canal-adminï¼šå¾Œè‡ºç®¡ç†æ¨¡å¡Šï¼Œæä¾›é¢å‘WebUIçš„Canalç®¡ç†èƒ½åŠ›ã€‚</li><li>canal-adapterï¼šé©é…å™¨ï¼Œå¢åŠ å®¢æˆ¶ç«¯æ•¸æ“šè½åœ°çš„é©é…åŠå•Ÿå‹•åŠŸèƒ½ï¼ŒåŒ…æ‹¬RESTã€æ—¥èªŒé©é…å™¨ã€é—œä¿‚å‹æ•¸æ“šåº«çš„æ•¸æ“šåŒæ­¥ï¼ˆè¡¨å°éŒ¶åŒæ­¥ï¼‰ã€HBaseæ•¸æ“šåŒæ­¥ã€ESæ•¸æ“šåŒæ­¥ç­‰ç­‰ã€‚</li><li>canal-deployerï¼šç™¼ä½ˆå™¨ï¼Œæ ¸å¿ƒåŠŸèƒ½æ‰€åœ¨ï¼ŒåŒ…æ‹¬binlogè§£æã€è½‰æ›å’Œç™¼é€å ±æ–‡åˆ°é€£æ¥å™¨ä¸­ç­‰ç­‰åŠŸèƒ½éƒ½ç”±æ­¤æ¨¡å¡Šæä¾›ã€‚</li></ul><p>ä¸€èˆ¬æƒ…æ³ä¸‹ï¼Œcanal-deployeréƒ¨ä»¶æ˜¯å¿…é ˆçš„ï¼Œå…¶ä»–å…©å€‹éƒ¨ä»¶æŒ‰éœ€é¸ç”¨å³å¯ã€‚</p><h2 class=heading>éƒ¨ç½²æ‰€éœ€çš„ä¸­é–“ä»¶</h2><p>æ­å»ºä¸€å¥—å¯ä»¥ç”¨çš„çµ„ä»¶éœ€è¦éƒ¨ç½²MySQLã€Zookeeperã€Kafkaå’ŒCanalå››å€‹ä¸­é–“ä»¶çš„å¯¦ä¾‹ï¼Œä¸‹é¢ç°¡å–®åˆ†æä¸€ä¸‹éƒ¨ç½²éç¨‹ã€‚é¸ç”¨çš„è™›æ“¬æ©Ÿç³»çµ±æ˜¯CentOS7ã€‚</p><h3 class=heading>å®‰è£MySQL</h3><p>ç‚ºäº†ç°¡å–®èµ·è¦‹ï¼Œé¸ç”¨yumæºå®‰è£ï¼ˆå®˜æ–¹éˆæ¥æ˜¯https://dev.mysql.com/downloads/repo/yumï¼‰ï¼š</p><p><br></p><div class=pgc-img><img alt=åŸºæ–¼Canalå’ŒKafkaå¯¦ç¾MySQLçš„Binlogè¿‘å¯¦æ™‚åŒæ­¥ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/71b780cac0f44cc2923c3c6db7b92944><p class=pgc-img-caption></p></div><p><br></p><p>::: info mysql80-community-release-el7-3é›–ç„¶åŒ…åå¸¶äº†mysql80é—œéµå­—ï¼Œå…¶å¯¦å·²ç¶“é›†æˆäº†MySQLä¸»æµç‰ˆæœ¬5.6ã€5.7å’Œ8.xç­‰ç­‰çš„æœ€æ–°å®‰è£åŒ…å€‰åº« :::</p><p>é¸ç”¨çš„æ˜¯æœ€æ–°ç‰ˆçš„MySQL8.xç¤¾å€ç‰ˆï¼Œä¸‹è¼‰CentOS7é©ç”¨çš„rpmåŒ…ï¼š</p><pre><code>cd /data/mysqlwget https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm// ä¸‹è¼‰å®Œç•¢ä¹‹å¾Œsudo rpm -Uvh mysql80-community-release-el7-3.noarch.rpm</code></pre><p>æ­¤æ™‚åˆ—èˆ‰ä¸€ä¸‹yumå€‰åº«è£¡é¢çš„MySQLç›¸é—œçš„åŒ…ï¼š</p><pre><code>[root@localhost mysql]# yum repolist all | grep mysqlmysql-cluster-7.5-community/x86_64 MySQL Cluster 7.5 Community   disabledmysql-cluster-7.5-community-source MySQL Cluster 7.5 Community - disabledmysql-cluster-7.6-community/x86_64 MySQL Cluster 7.6 Community   disabledmysql-cluster-7.6-community-source MySQL Cluster 7.6 Community - disabledmysql-cluster-8.0-community/x86_64 MySQL Cluster 8.0 Community   disabledmysql-cluster-8.0-community-source MySQL Cluster 8.0 Community - disabledmysql-connectors-community/x86_64  MySQL Connectors Community    enabled:    141mysql-connectors-community-source  MySQL Connectors Community -  disabledmysql-tools-community/x86_64       MySQL Tools Community         enabled:    105mysql-tools-community-source       MySQL Tools Community - Sourc disabledmysql-tools-preview/x86_64         MySQL Tools Preview           disabledmysql-tools-preview-source         MySQL Tools Preview - Source  disabledmysql55-community/x86_64           MySQL 5.5 Community Server    disabledmysql55-community-source           MySQL 5.5 Community Server -  disabledmysql56-community/x86_64           MySQL 5.6 Community Server    disabledmysql56-community-source           MySQL 5.6 Community Server -  disabledmysql57-community/x86_64           MySQL 5.7 Community Server    disabledmysql57-community-source           MySQL 5.7 Community Server -  disabledmysql80-community/x86_64           MySQL 8.0 Community Server    enabled:    161mysql80-community-source           MySQL 8.0 Community Server -  disabled</code></pre><p>ç·¨è¼¯/etc/yum.repos.d/mysql-community.repoæ–‡ä»¶ï¼ˆ[mysql80-community]å¡Šä¸­enabledè¨­ç½®ç‚º1ï¼Œå…¶å¯¦é»˜èªå°±æ˜¯é€™æ¨£å­ï¼Œä¸ç”¨æ”¹ï¼Œå¦‚æœè¦é¸ç”¨5.xç‰ˆæœ¬å‰‡éœ€è¦ä¿®æ”¹å°æ‡‰çš„å¡Šï¼‰ï¼š</p><pre><code>[mysql80-community]name=MySQL 8.0 Community Serverbaseurl=http://repo.mysql.com/yum/mysql-8.0-community/el/7/$basearch/enabled=1gpgcheck=1gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql</code></pre><p>ç„¶å¾Œå®‰è£MySQLæœå‹™ï¼š</p><pre><code>sudo yum install mysql-community-server</code></pre><p>é€™å€‹éç¨‹æ¯”è¼ƒæ¼«é•·ï¼Œå› ç‚ºéœ€è¦ä¸‹è¼‰å’Œå®‰è£5å€‹rpmå®‰è£åŒ…ï¼ˆæˆ–è€…æ˜¯æ‰€æœ‰å®‰è£åŒ…çµ„åˆçš„å£“ç¸®åŒ…mysql-8.0.18-1.el7.x86_64.rpm-bundle.tarï¼‰ã€‚å¦‚æœç¶²çµ¡æ¯”è¼ƒå·®ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å¾å®˜ç¶²æ‰‹å‹•ä¸‹è¼‰å¾Œå®‰è£ï¼š</p><p><br></p><div class=pgc-img><img alt=åŸºæ–¼Canalå’ŒKafkaå¯¦ç¾MySQLçš„Binlogè¿‘å¯¦æ™‚åŒæ­¥ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6b7b87630ee04b41b5221133a5af75ce><p class=pgc-img-caption></p></div><p><br></p><pre><code>// ä¸‹è¼‰ä¸‹é¢5å€‹rpmåŒ… common --&gt; libs --&gt; libs-compat --&gt; client --&gt; servermysql-community-commonmysql-community-libsmysql-community-libs-compatmysql-community-clientmysql-community-server// å¼·åˆ¶å®‰è£rpm -ivh mysql-community-common-8.0.18-1.el7.x86_64.rpm --force --nodepsrpm -ivh mysql-community-libs-8.0.18-1.el7.x86_64.rpm --force --nodepsrpm -ivh mysql-community-libs-compat-8.0.18-1.el7.x86_64.rpm --force --nodepsrpm -ivh mysql-community-client-8.0.18-1.el7.x86_64.rpm --force --nodepsrpm -ivh mysql-community-server-8.0.18-1.el7.x86_64.rpm --force --nodeps</code></pre><p>å®‰è£å®Œç•¢ä¹‹å¾Œï¼Œå•Ÿå‹•MySQLæœå‹™ï¼Œç„¶å¾Œæœç´¢MySQLæœå‹™çš„rootè³¬è™Ÿçš„è‡¨æ™‚å¯†ç¢¼ç”¨æ–¼é¦–æ¬¡ç™»é™¸ï¼ˆmysql -u root -pï¼‰ï¼š</p><pre><code>// å•Ÿå‹•æœå‹™ï¼Œé—œé–‰æœå‹™å°±æ˜¯service mysqld stopservice mysqld start// æŸ¥çœ‹è‡¨æ™‚å¯†ç¢¼ cat /var/log/mysqld.log[root@localhost log]# cat /var/log/mysqld.log 2020-03-02T06:03:53.996423Z 0 [System] [MY-013169] [Server] /usr/sbin/mysqld (mysqld 8.0.18) initializing of server in progress as process 227802020-03-02T06:03:57.321447Z 5 [Note] [MY-010454] [Server] A temporary password is generated for root@localhost: &gt;kjYaXENK6li2020-03-02T06:04:00.123845Z 0 [System] [MY-010116] [Server] /usr/sbin/mysqld (mysqld 8.0.18) starting as process 22834// ç™»éŒ„è‡¨æ™‚rootç”¨æˆ¶ï¼Œä½¿ç”¨è‡¨æ™‚å¯†ç¢¼[root@localhost log]# mysql -u root -p</code></pre><p>æ¥ä¸‹ä¾†åšä¸‹é¢çš„æ“ä½œï¼š</p><ul><li>ä¿®æ”¹rootç”¨æˆ¶çš„å¯†ç¢¼ï¼šALTER USER 'root'@'localhost' IDENTIFIED BY 'QWqw12!@';ï¼ˆæ³¨æ„å¯†ç¢¼è¦å‰‡å¿…é ˆåŒ…å«å¤§å°å¯«å­—æ¯ã€æ•¸å­—å’Œç‰¹æ®Šå­—ç¬¦ï¼‰</li><li>æ›´æ–°rootçš„hostï¼Œåˆ‡æ›æ•¸æ“šåº«use mysql;ï¼ŒæŒ‡å®šhostç‚º%ä»¥ä¾¿å¯ä»¥è®“å…¶ä»–æœå‹™å™¨é ç¨‹è¨ªå•UPDATE USER SET HOST = '%' WHERE USER = 'root';</li><li>è³¦äºˆ'root'@'%'ç”¨æˆ¶ï¼Œæ‰€æœ‰æ¬Šé™ï¼ŒåŸ·è¡ŒGRANT ALL PRIVILEGES ON *.* TO 'root'@'%';</li><li>æ”¹è®Šroot'@'%ç”¨æˆ¶çš„å¯†ç¢¼æ ¡é©—è¦å‰‡ä»¥ä¾¿å¯ä»¥ä½¿ç”¨Navicatç­‰å·¥å…·è¨ªå•ï¼šALTER USER 'root'@'%' IDENTIFIED WITH mysql_native_password BY 'QWqw12!@';</li></ul><p><br></p><div class=pgc-img><img alt=åŸºæ–¼Canalå’ŒKafkaå¯¦ç¾MySQLçš„Binlogè¿‘å¯¦æ™‚åŒæ­¥ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/25e8556a69604d4d9e8575b64dbe8b3d><p class=pgc-img-caption></p></div><p><br></p><p>æ“ä½œå®Œæˆä¹‹å¾Œï¼Œå°±å¯ä»¥ä½¿ç”¨rootç”¨æˆ¶é ç¨‹è¨ªå•æ­¤è™›æ“¬æ©Ÿä¸Šçš„MySQLæœå‹™ã€‚æœ€å¾Œç¢ºèªæ˜¯å¦é–‹å•Ÿäº†binlogï¼ˆæ³¨æ„ä¸€é»æ˜¯MySQL8.xé»˜èªé–‹å•Ÿbinlogï¼‰SHOW VARIABLES LIKE '%bin%';ï¼š</p><p><br></p><div class=pgc-img><img alt=åŸºæ–¼Canalå’ŒKafkaå¯¦ç¾MySQLçš„Binlogè¿‘å¯¦æ™‚åŒæ­¥ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4aa6d8b4465d49f2b0903f0cc8201adf><p class=pgc-img-caption></p></div><p><br></p><p>æœ€å¾Œåœ¨MySQLçš„ShellåŸ·è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œæ–°å»ºä¸€å€‹ç”¨æˆ¶åcanalå¯†ç¢¼ç‚ºQWqw12!@çš„æ–°ç”¨æˆ¶ï¼Œè³¦äºˆREPLICATION SLAVEå’Œ REPLICATION CLIENTæ¬Šé™ï¼š</p><pre><code>CREATE USER canal IDENTIFIED BY 'QWqw12!@';GRANT SELECT, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO 'canal'@'%';FLUSH PRIVILEGES;ALTER USER 'canal'@'%' IDENTIFIED WITH mysql_native_password BY 'QWqw12!@';</code></pre><p>åˆ‡æ›å›å»rootç”¨æˆ¶ï¼Œå‰µå»ºä¸€å€‹æ•¸æ“šåº«testï¼š</p><pre><code>CREATE DATABASE `test` CHARSET `utf8mb4` COLLATE `utf8mb4_unicode_ci`;</code></pre><h3 class=heading>å®‰è£Zookeeper</h3><p>Canalå’ŒKafkaé›†ç¾¤éƒ½ä¾è³´æ–¼Zookeeperåšæœå‹™å”èª¿ï¼Œç‚ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œä¸€èˆ¬æœƒç¨ç«‹éƒ¨ç½²Zookeeperæœå‹™æˆ–è€…Zookeeperé›†ç¾¤ã€‚ç­†è€…é€™è£¡é¸ç”¨2020-03-04ç™¼ä½ˆçš„3.6.0ç‰ˆæœ¬ï¼š</p><pre><code>midkr /data/zk# å‰µå»ºæ•¸æ“šç›®éŒ„midkr /data/zk/datacd /data/zkwget http://mirror.bit.edu.cn/apache/zookeeper/zookeeper-3.6.0/apache-zookeeper-3.6.0-bin.tar.gztar -zxvf apache-zookeeper-3.6.0-bin.tar.gzcd apache-zookeeper-3.6.0-bin/confcp zoo_sample.cfg zoo.cfg &amp;&amp; vim zoo.cfg</code></pre><p>æŠŠzoo.cfgæ–‡ä»¶ä¸­çš„dataDirè¨­ç½®ç‚º/data/zk/dataï¼Œç„¶å¾Œå•Ÿå‹•Zookeeperï¼š</p><pre><code>[root@localhost conf]# sh /data/zk/apache-zookeeper-3.6.0-bin/bin/zkServer.sh start/usr/bin/javaZooKeeper JMX enabled by defaultUsing config: /data/zk/apache-zookeeper-3.6.0-bin/bin/../conf/zoo.cfgStarting zookeeper ... STARTED</code></pre><p>é€™è£¡æ³¨æ„ä¸€é»ï¼Œè¦å•Ÿå‹•æ­¤ç‰ˆæœ¬çš„Zookeeperæœå‹™å¿…é ˆæœ¬åœ°å®‰è£å¥½JDK8+ï¼Œé€™ä¸€é»éœ€è¦è‡ªè¡Œè™•ç†ã€‚å•Ÿå‹•çš„é»˜èªç«¯å£æ˜¯2181ï¼Œå•Ÿå‹•æˆåŠŸå¾Œçš„æ—¥èªŒå¦‚ä¸‹ï¼š</p><p><br></p><div class=pgc-img><img alt=åŸºæ–¼Canalå’ŒKafkaå¯¦ç¾MySQLçš„Binlogè¿‘å¯¦æ™‚åŒæ­¥ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/543903be42b74908819c43e17de120a2><p class=pgc-img-caption></p></div><p><br></p><h3 class=heading>å®‰è£Kafka</h3><p>Kafkaæ˜¯ä¸€å€‹é«˜æ€§èƒ½åˆ†ä½ˆå¼æ¶ˆæ¯éšŠåˆ—ä¸­é–“ä»¶ï¼Œå®ƒçš„éƒ¨ç½²ä¾è³´æ–¼Zookeeperã€‚ç­†è€…åœ¨æ­¤é¸ç”¨2.4.0ä¸¦ä¸”Scalaç‰ˆæœ¬ç‚º2.13çš„å®‰è£åŒ…ï¼š</p><pre><code>mkdir /data/kafkamkdir /data/kafka/datawget http://mirrors.tuna.tsinghua.edu.cn/apache/kafka/2.4.0/kafka_2.13-2.4.0.tgztar -zxvf kafka_2.13-2.4.0.tgz</code></pre><p>ç”±æ–¼è§£å£“å¾Œ/data/kafka/kafka_2.13-2.4.0/config/server.propertiesé…ç½®ä¸­å°æ‡‰çš„zookeeper.connect=localhost:2181å·²ç¶“ç¬¦åˆéœ€è¦ï¼Œä¸å¿…ä¿®æ”¹ï¼Œéœ€è¦ä¿®æ”¹æ—¥èªŒæ–‡ä»¶çš„ç›®éŒ„log.dirsç‚º/data/kafka/dataã€‚ç„¶å¾Œå•Ÿå‹•Kafkaæœå‹™ï¼š</p><pre><code>sh /data/kafka/kafka_2.13-2.4.0/bin/kafka-server-start.sh /data/kafka/kafka_2.13-2.4.0/config/server.properties</code></pre><p><br></p><div class=pgc-img><img alt=åŸºæ–¼Canalå’ŒKafkaå¯¦ç¾MySQLçš„Binlogè¿‘å¯¦æ™‚åŒæ­¥ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/548bd02dfbae4c0f88490da266b4a8e4><p class=pgc-img-caption></p></div><p><br></p><p>é€™æ¨£å•Ÿå‹•ä¸€æ—¦é€€å‡ºæ§åˆ¶æª¯å°±æœƒçµæŸKafkaé€²ç¨‹ï¼Œå¯ä»¥æ·»åŠ -daemonåƒæ•¸ç”¨æ–¼æ§åˆ¶Kafkaé€²ç¨‹å¾Œè‡ºä¸æ›æ–·é‹è¡Œã€‚</p><pre><code>sh /data/kafka/kafka_2.13-2.4.0/bin/kafka-server-start.sh -daemon /data/kafka/kafka_2.13-2.4.0/config/server.properties</code></pre><h3 class=heading>å®‰è£å’Œä½¿ç”¨Canal</h3><p>çµ‚æ–¼åˆ°äº†ä¸»è§’ç™»å ´ï¼Œé€™è£¡é¸ç”¨Canalçš„v1.1.4ç©©å®šç™¼ä½ˆç‰ˆï¼Œåªéœ€è¦ä¸‹è¼‰deployeræ¨¡å¡Šï¼š</p><pre><code>mkdir /data/canalcd /data/canal# é€™è£¡æ³¨æ„ä¸€é»ï¼ŒGithubåœ¨åœ‹å…§è¢«ç‰†ï¼Œä¸‹è¼‰é€Ÿåº¦æ¥µæ…¢ï¼Œå¯ä»¥å…ˆç”¨å…¶ä»–ä¸‹è¼‰å·¥å…·ä¸‹è¼‰å®Œå†ä¸Šå‚³åˆ°æœå‹™å™¨ä¸­wget https://github.com/alibaba/canal/releases/download/canal-1.1.4/canal.deployer-1.1.4.tar.gztar -zxvf canal.deployer-1.1.4.tar.gz</code></pre><p>è§£å£“å¾Œçš„ç›®éŒ„å¦‚ä¸‹ï¼š</p><pre><code>- bin   # é‹ç¶­è…³æœ¬- conf  # é…ç½®æ–‡ä»¶  canal_local.properties  # canalæœ¬åœ°é…ç½®ï¼Œä¸€èˆ¬ä¸éœ€è¦å‹•  canal.properties        # canalæœå‹™é…ç½®  logback.xml             # logbackæ—¥èªŒé…ç½®  metrics                 # åº¦é‡çµ±è¨ˆé…ç½®  spring                  # spring-å¯¦ä¾‹é…ç½®ï¼Œä¸»è¦å’Œbinlogä½ç½®è¨ˆç®—ã€ä¸€äº›ç­–ç•¥é…ç½®ç›¸é—œï¼Œå¯ä»¥åœ¨canal.propertiesé¸ç”¨å…¶ä¸­çš„ä»»æ„ä¸€å€‹é…ç½®æ–‡ä»¶  example                 # å¯¦ä¾‹é…ç½®æ–‡ä»¶å¤¾ï¼Œä¸€èˆ¬èªç‚ºå–®å€‹æ•¸æ“šåº«å°æ‡‰ä¸€å€‹ç¨ç«‹çš„å¯¦ä¾‹é…ç½®æ–‡ä»¶å¤¾    instance.properties   # å¯¦ä¾‹é…ç½®ï¼Œä¸€èˆ¬æŒ‡å–®å€‹æ•¸æ“šåº«çš„é…ç½®- lib   # æœå‹™ä¾è³´åŒ…- logs  # æ—¥èªŒæ–‡ä»¶è¼¸å‡ºç›®éŒ„</code></pre><p>åœ¨é–‹ç™¼å’Œæ¸¬è©¦ç’°å¢ƒå»ºè­°æŠŠlogback.xmlçš„æ—¥èªŒç´šåˆ¥ä¿®æ”¹ç‚ºDEBUGæ–¹ä¾¿å®šä½å•é¡Œã€‚é€™è£¡éœ€è¦é—œæ³¨canal.propertieså’Œinstance.propertieså…©å€‹é…ç½®æ–‡ä»¶ã€‚canal.propertiesæ–‡ä»¶ä¸­ï¼Œéœ€è¦ä¿®æ”¹ï¼š</p><ul><li>å»æ‰canal.instance.parser.parallelThreadSize = 16é€™å€‹é…ç½®é …çš„<strong>è¨»é‡‹</strong>ï¼Œä¹Ÿå°±æ˜¯å•Ÿç”¨æ­¤é…ç½®é …ï¼Œå’Œå¯¦ä¾‹è§£æå™¨çš„ç·šç¨‹æ•¸ç›¸é—œï¼Œä¸é…ç½®æœƒè¡¨ç¾ç‚ºé˜»å¡æˆ–è€…ä¸é€²è¡Œè§£æã€‚</li><li>canal.serverModeé…ç½®é …æŒ‡å®šç‚ºkafkaï¼Œå¯é¸å€¼æœ‰tcpã€kafkaå’Œrocketmqï¼ˆmasteråˆ†æ”¯æˆ–è€…æœ€æ–°çš„çš„v1.1.5-alpha-1ç‰ˆæœ¬ï¼Œå¯ä»¥é¸ç”¨rabbitmqï¼‰ï¼Œé»˜èªæ˜¯kafkaã€‚</li><li>canal.mq.serversé…ç½®éœ€è¦æŒ‡å®šç‚ºKafkaæœå‹™æˆ–è€…é›†ç¾¤Brokerçš„åœ°å€ï¼Œé€™è£¡é…ç½®ç‚º127.0.0.1:9092ã€‚</li></ul><blockquote><p>canal.mq.serversåœ¨ä¸åŒçš„canal.serverModeæœ‰ä¸åŒçš„æ„ç¾©ã€‚ kafkaæ¨¡å¼ä¸‹ï¼ŒæŒ‡Kafkaæœå‹™æˆ–è€…é›†ç¾¤Brokerçš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯bootstrap.servers rocketmqæ¨¡å¼ä¸‹ï¼ŒæŒ‡NameServeråˆ—è¡¨ rabbitmqæ¨¡å¼ä¸‹ï¼ŒæŒ‡RabbitMQæœå‹™çš„Hostå’ŒPort</p></blockquote><p>å…¶ä»–é…ç½®é …å¯ä»¥åƒè€ƒä¸‹é¢å…©å€‹å®˜æ–¹Wikiçš„éˆæ¥ï¼š</p><ul><li>Canal-Kafka-RocketMQ-QuickStart</li><li>AdminGuide</li></ul><p>instance.propertiesä¸€èˆ¬æŒ‡ä¸€å€‹æ•¸æ“šåº«å¯¦ä¾‹çš„é…ç½®ï¼ŒCanalæ¶æ§‹æ”¯æŒä¸€å€‹Canalæœå‹™å¯¦ä¾‹ï¼Œè™•ç†å¤šå€‹æ•¸æ“šåº«å¯¦ä¾‹çš„binlogç•°æ­¥è§£æã€‚instance.propertieséœ€è¦ä¿®æ”¹çš„é…ç½®é …ä¸»è¦åŒ…æ‹¬ï¼š</p><ul><li>canal.instance.mysql.slaveIdéœ€è¦é…ç½®ä¸€å€‹å’ŒMasterç¯€é»çš„æœå‹™IDå®Œå…¨ä¸åŒçš„å€¼ï¼Œé€™è£¡ç­†è€…é…ç½®ç‚º654321ã€‚</li><li>é…ç½®æ•¸æ“šæºå¯¦ä¾‹ï¼ŒåŒ…æ‹¬åœ°å€ã€ç”¨æˆ¶ã€å¯†ç¢¼å’Œç›®æ¨™æ•¸æ“šåº«ï¼š canal.instance.master.addressï¼Œé€™è£¡æŒ‡å®šç‚º127.0.0.1:3306ã€‚ canal.instance.dbUsernameï¼Œé€™è£¡æŒ‡å®šç‚ºcanalã€‚ canal.instance.dbPasswordï¼Œé€™è£¡æŒ‡å®šç‚ºQWqw12!@ã€‚ æ–°å¢canal.instance.defaultDatabaseNameï¼Œé€™è£¡æŒ‡å®šç‚ºtestï¼ˆéœ€è¦åœ¨MySQLä¸­å»ºç«‹ä¸€å€‹testæ•¸æ“šåº«ï¼Œè¦‹å‰é¢çš„æµç¨‹ï¼‰ã€‚</li><li>Kafkaç›¸é—œé…ç½®ï¼Œé€™è£¡æš«æ™‚ä½¿ç”¨éœæ…‹topicå’Œå–®å€‹partitionï¼š canal.mq.topicï¼Œé€™è£¡æŒ‡å®šç‚ºtestï¼Œ<strong>ä¹Ÿå°±æ˜¯è§£æå®Œçš„binlogçµæ§‹åŒ–æ•¸æ“šæœƒç™¼é€åˆ°Kafkaçš„å‘½åç‚ºtestçš„topicä¸­</strong>ã€‚ canal.mq.partitionï¼Œé€™è£¡æŒ‡å®šç‚º0ã€‚</li></ul><p>é…ç½®å·¥ä½œåšå¥½ä¹‹å¾Œï¼Œå¯ä»¥å•Ÿå‹•Canalæœå‹™ï¼š</p><pre><code>sh /data/canal/bin/startup.sh # æŸ¥çœ‹æœå‹™æ—¥èªŒtail -100f /data/canal/logs/canal/canal# æŸ¥çœ‹å¯¦ä¾‹æ—¥èªŒ  -- ä¸€èˆ¬æƒ…æ³ä¸‹ï¼Œé—œæ³¨å¯¦ä¾‹æ—¥èªŒå³å¯tail -100f /data/canal/logs/example/example.log</code></pre><p>å•Ÿå‹•æ­£å¸¸å¾Œï¼Œè¦‹å¯¦ä¾‹æ—¥èªŒå¦‚ä¸‹ï¼š</p><p><br></p><div class=pgc-img><img alt=åŸºæ–¼Canalå’ŒKafkaå¯¦ç¾MySQLçš„Binlogè¿‘å¯¦æ™‚åŒæ­¥ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5d899e1984b5448a97c88876f8f44b69><p class=pgc-img-caption></p></div><p><br></p><p>åœ¨testæ•¸æ“šåº«å‰µå»ºä¸€å€‹è¨‚å–®è¡¨ï¼Œä¸¦ä¸”åŸ·è¡Œå¹¾å€‹ç°¡å–®çš„DMLï¼š</p><pre><code>use `test`;CREATE TABLE `order`(    id          BIGINT UNIQUE PRIMARY KEY AUTO_INCREMENT COMMENT 'ä¸»éµ',    order_id    VARCHAR(64)    NOT NULL COMMENT 'è¨‚å–®ID',    amount      DECIMAL(10, 2) NOT NULL DEFAULT 0 COMMENT 'è¨‚å–®é‡‘é¡',    create_time DATETIME       NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'å‰µå»ºæ™‚é–“',    UNIQUE uniq_order_id (`order_id`)) COMMENT 'è¨‚å–®è¡¨';INSERT INTO `order`(order_id, amount) VALUES ('10086', 999);UPDATE `order` SET amount = 10087 WHERE order_id = '10086';DELETE  FROM `order` WHERE order_id = '10086';</code></pre><p>é€™å€‹æ™‚å€™ï¼Œå¯ä»¥åˆ©ç”¨Kafkaçš„kafka-console-consumeræˆ–è€…Kafka ToolsæŸ¥çœ‹testé€™å€‹topicçš„æ•¸æ“šï¼š</p><pre><code>sh /data/kafka/kafka_2.13-2.4.0/bin/kafka-console-consumer.sh --bootstrap-server 127.0.0.1:9092 --from-beginning --topic test</code></pre><p><br></p><div class=pgc-img><img alt=åŸºæ–¼Canalå’ŒKafkaå¯¦ç¾MySQLçš„Binlogè¿‘å¯¦æ™‚åŒæ­¥ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/86a283a62c6d4cf3a87cabf4085ea0c1><p class=pgc-img-caption></p></div><p><br></p><p>å…·é«”çš„æ•¸æ“šå¦‚ä¸‹ï¼š</p><pre><code>// testæ•¸æ“šåº«å»ºåº«è…³æœ¬{"data":null,"database":"`test`","es":1583143732000,"id":1,"isDdl":false,"mysqlType":null,"old":null,"pkNames":null,"sql":"CREATE DATABASE `test` CHARSET `utf8mb4` COLLATE `utf8mb4_unicode_ci`","sqlType":null,"table":"","ts":1583143930177,"type":"QUERY"}// orderè¡¨å»ºè¡¨DDL{"data":null,"database":"test","es":1583143957000,"id":2,"isDdl":true,"mysqlType":null,"old":null,"pkNames":null,"sql":"CREATE TABLE `order`\n(\n    id          BIGINT UNIQUE PRIMARY KEY AUTO_INCREMENT COMMENT 'ä¸»éµ',\n    order_id    VARCHAR(64)    NOT NULL COMMENT 'è¨‚å–®ID',\n    amount      DECIMAL(10, 2) NOT NULL DEFAULT 0 COMMENT 'è¨‚å–®é‡‘é¡',\n    create_time DATETIME       NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'å‰µå»ºæ™‚é–“',\n    UNIQUE uniq_order_id (`order_id`)\n) COMMENT 'è¨‚å–®è¡¨'","sqlType":null,"table":"order","ts":1583143958045,"type":"CREATE"}// INSERT{"data":[{"id":"1","order_id":"10086","amount":"999.0","create_time":"2020-03-02 05:12:49"}],"database":"test","es":1583143969000,"id":3,"isDdl":false,"mysqlType":{"id":"BIGINT","order_id":"VARCHAR(64)","amount":"DECIMAL(10,2)","create_time":"DATETIME"},"old":null,"pkNames":["id"],"sql":"","sqlType":{"id":-5,"order_id":12,"amount":3,"create_time":93},"table":"order","ts":1583143969460,"type":"INSERT"}// UPDATE{"data":[{"id":"1","order_id":"10086","amount":"10087.0","create_time":"2020-03-02 05:12:49"}],"database":"test","es":1583143974000,"id":4,"isDdl":false,"mysqlType":{"id":"BIGINT","order_id":"VARCHAR(64)","amount":"DECIMAL(10,2)","create_time":"DATETIME"},"old":[{"amount":"999.0"}],"pkNames":["id"],"sql":"","sqlType":{"id":-5,"order_id":12,"amount":3,"create_time":93},"table":"order","ts":1583143974870,"type":"UPDATE"}// DELETE{"data":[{"id":"1","order_id":"10086","amount":"10087.0","create_time":"2020-03-02 05:12:49"}],"database":"test","es":1583143980000,"id":5,"isDdl":false,"mysqlType":{"id":"BIGINT","order_id":"VARCHAR(64)","amount":"DECIMAL(10,2)","create_time":"DATETIME"},"old":null,"pkNames":["id"],"sql":"","sqlType":{"id":-5,"order_id":12,"amount":3,"create_time":93},"table":"order","ts":1583143981091,"type":"DELETE"}</code></pre><p>å¯è¦‹Kafkaçš„åç‚ºtestçš„topicå·²ç¶“å¯«å…¥äº†å°æ‡‰çš„çµæ§‹åŒ–binlogäº‹ä»¶æ•¸æ“šï¼Œå¯ä»¥ç·¨å¯«æ¶ˆè²»è€…ç›£è½Kafkaå°æ‡‰çš„topicç„¶å¾Œå°ç²å–åˆ°çš„æ•¸æ“šé€²è¡Œå¾ŒçºŒè™•ç†ã€‚</p><h2 class=heading>å°çµ</h2><p>é€™ç¯‡æ–‡ç« å¤§éƒ¨åˆ†ç¯‡å¹…ç”¨æ–¼ä»‹ç´¹å…¶ä»–ä¸­é–“ä»¶æ˜¯æ€éº¼éƒ¨ç½²çš„ï¼Œé€™å€‹å•é¡Œå´é¢èªªæ˜äº†Canalæœ¬èº«éƒ¨ç½²ä¸¦ä¸è¤‡é›œï¼Œå®ƒçš„é…ç½®æ–‡ä»¶å±¬æ€§é …æ¯”è¼ƒå¤šï¼Œä½†æ˜¯å¯¦éš›ä¸Šéœ€è¦è‡ªå®šç¾©å’Œæ”¹å‹•çš„é…ç½®é …æ˜¯æ¯”è¼ƒå°‘çš„ï¼Œä¹Ÿå°±æ˜¯èªªæ˜äº†å®ƒçš„é‹ç¶­æˆæœ¬å’Œå­¸ç¿’æˆæœ¬ä¸¦ä¸é«˜ã€‚å¾Œé¢æœƒåˆ†æåŸºæ–¼çµæ§‹åŒ–binlogäº‹ä»¶åšELTå’ŒæŒä¹…åŒ–ç›¸é—œå·¥ä½œä»¥åŠCanalçš„ç”Ÿç”¢ç’°å¢ƒå¯ç”¨ç´šåˆ¥HAé›†ç¾¤çš„æ­å»ºã€‚</p><blockquote><p>ä¾†æºï¼šæ˜é‡‘ éˆæ¥ï¼šhttps://juejin.im/post/5e6a6746f265da575c16d678</p></blockquote></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Canal</a></li><li><a>Kafka</a></li><li><a>å¯¦ç¾</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/41e067fa.html alt="Canal å¦‚ä½•å¯¦ç¾æ•¸æ“šåº«åº«äº‹å‹™çš„ä¸€è‡´æ€§" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/c46cdca193864806be3dd7d81af2ccaf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/41e067fa.html title="Canal å¦‚ä½•å¯¦ç¾æ•¸æ“šåº«åº«äº‹å‹™çš„ä¸€è‡´æ€§">Canal å¦‚ä½•å¯¦ç¾æ•¸æ“šåº«åº«äº‹å‹™çš„ä¸€è‡´æ€§</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5c087c4.html alt=æ¶ˆæ¯ä¸­é–“ä»¶ï¼šKafkaå†ªç­‰æ€§åŸç†åŠå¯¦ç¾å‰–æ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4d0f8561c45c48fca5c067226e6cc913 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5c087c4.html title=æ¶ˆæ¯ä¸­é–“ä»¶ï¼šKafkaå†ªç­‰æ€§åŸç†åŠå¯¦ç¾å‰–æ>æ¶ˆæ¯ä¸­é–“ä»¶ï¼šKafkaå†ªç­‰æ€§åŸç†åŠå¯¦ç¾å‰–æ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f09ac34c.html alt=å½©è‰²é›»å­æ›¸åœ¨å»£å·ç‡å…ˆå¯¦ç¾é‡ç”¢ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RkPMb9G6tipobr style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f09ac34c.html title=å½©è‰²é›»å­æ›¸åœ¨å»£å·ç‡å…ˆå¯¦ç¾é‡ç”¢>å½©è‰²é›»å­æ›¸åœ¨å»£å·ç‡å…ˆå¯¦ç¾é‡ç”¢</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2d12804e.html alt=[ç©è½‰MySQLä¹‹ä¹]MySQLå¯¦ç¾ACIDä¹‹åŸå­æ€§ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/bdb044d821f74107a3fd9119fc34c642 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2d12804e.html title=[ç©è½‰MySQLä¹‹ä¹]MySQLå¯¦ç¾ACIDä¹‹åŸå­æ€§>[ç©è½‰MySQLä¹‹ä¹]MySQLå¯¦ç¾ACIDä¹‹åŸå­æ€§</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fb2bc471.html alt="ã€Œè­¯ã€ Spring çš„åˆ†ä½ˆå¼äº‹å‹™å¯¦ç¾â€”ä½¿ç”¨å’Œä¸ä½¿ç”¨ XAâ€”ç¬¬äºŒéƒ¨åˆ†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fb2bc471.html title="ã€Œè­¯ã€ Spring çš„åˆ†ä½ˆå¼äº‹å‹™å¯¦ç¾â€”ä½¿ç”¨å’Œä¸ä½¿ç”¨ XAâ€”ç¬¬äºŒéƒ¨åˆ†">ã€Œè­¯ã€ Spring çš„åˆ†ä½ˆå¼äº‹å‹™å¯¦ç¾â€”ä½¿ç”¨å’Œä¸ä½¿ç”¨ XAâ€”ç¬¬äºŒéƒ¨åˆ†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e41fd8de.html alt="æ’«é †å„é …é˜²æ±›å·¥ä½œå¯¦ç¾â€œå…­åˆ°ä½â€ ç¢ºä¿å…¨å¸‚å®‰å…¨åº¦æ±›" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e41fd8de.html title="æ’«é †å„é …é˜²æ±›å·¥ä½œå¯¦ç¾â€œå…­åˆ°ä½â€ ç¢ºä¿å…¨å¸‚å®‰å…¨åº¦æ±›">æ’«é †å„é …é˜²æ±›å·¥ä½œå¯¦ç¾â€œå…­åˆ°ä½â€ ç¢ºä¿å…¨å¸‚å®‰å…¨åº¦æ±›</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f22ee5ad.html alt="Redis è¨­è¨ˆèˆ‡å¯¦ç¾ : Lua è…³æœ¬" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f22ee5ad.html title="Redis è¨­è¨ˆèˆ‡å¯¦ç¾ : Lua è…³æœ¬">Redis è¨­è¨ˆèˆ‡å¯¦ç¾ : Lua è…³æœ¬</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/56e2a065.html alt=é€™ä½å¤§å”åœ¨éš¨æ©Ÿçš„å½©ç¥¨ä¸Šå¯¦ç¾äº†90%çš„ä¸­çç‡ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/50ab0003166decded7e4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/56e2a065.html title=é€™ä½å¤§å”åœ¨éš¨æ©Ÿçš„å½©ç¥¨ä¸Šå¯¦ç¾äº†90%çš„ä¸­çç‡>é€™ä½å¤§å”åœ¨éš¨æ©Ÿçš„å½©ç¥¨ä¸Šå¯¦ç¾äº†90%çš„ä¸­çç‡</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cf633068.html alt="Java å¤šæ…‹çš„å¯¦ç¾æ©Ÿåˆ¶ï¼Œçœ‹äº†éƒ½èªªå¥½" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9d3b0e55813d46b4982ae7d9b81d1802 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cf633068.html title="Java å¤šæ…‹çš„å¯¦ç¾æ©Ÿåˆ¶ï¼Œçœ‹äº†éƒ½èªªå¥½">Java å¤šæ…‹çš„å¯¦ç¾æ©Ÿåˆ¶ï¼Œçœ‹äº†éƒ½èªªå¥½</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d0662f03.html alt="å»£è¥¿éµè·¯å‡ºæµ·å¤§é€šé“ å…¨é¢å¯¦ç¾é›»æ°£åŒ–é‹ç‡Ÿ" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d0662f03.html title="å»£è¥¿éµè·¯å‡ºæµ·å¤§é€šé“ å…¨é¢å¯¦ç¾é›»æ°£åŒ–é‹ç‡Ÿ">å»£è¥¿éµè·¯å‡ºæµ·å¤§é€šé“ å…¨é¢å¯¦ç¾é›»æ°£åŒ–é‹ç‡Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c78a6fe2.html alt=HashMapçš„åº•å±¤å¯¦ç¾ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/0f9ffe95e10e4ff5804a8fd9cf591cfc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c78a6fe2.html title=HashMapçš„åº•å±¤å¯¦ç¾>HashMapçš„åº•å±¤å¯¦ç¾</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a171e528.html alt=å¦‚ä½•å¿«é€Ÿå…¨é¢æŒæ¡Kafkaï¼Ÿ5000å­—åè¡€æ•´ç† class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RreaNY7GvCqWFq style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a171e528.html title=å¦‚ä½•å¿«é€Ÿå…¨é¢æŒæ¡Kafkaï¼Ÿ5000å­—åè¡€æ•´ç†>å¦‚ä½•å¿«é€Ÿå…¨é¢æŒæ¡Kafkaï¼Ÿ5000å­—åè¡€æ•´ç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7c3d9f70.html alt=æ–°ç©çš„æ··åˆææ–™æˆ–æœ‰åŠ©æ–¼å¯¦ç¾é«˜æ•ˆçš„ä¸‹ä¸€ä»£é¡¯ç¤ºå™¨ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/47050004da4f36dcec1b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7c3d9f70.html title=æ–°ç©çš„æ··åˆææ–™æˆ–æœ‰åŠ©æ–¼å¯¦ç¾é«˜æ•ˆçš„ä¸‹ä¸€ä»£é¡¯ç¤ºå™¨>æ–°ç©çš„æ··åˆææ–™æˆ–æœ‰åŠ©æ–¼å¯¦ç¾é«˜æ•ˆçš„ä¸‹ä¸€ä»£é¡¯ç¤ºå™¨</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8d93e49d.html alt=æ•™ç¨‹ï¼šæ¡ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•å¯¦ç¾ç·šæ€§è¿´æ­¸ï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1537162000876f4501fb1c4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8d93e49d.html title=æ•™ç¨‹ï¼šæ¡ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•å¯¦ç¾ç·šæ€§è¿´æ­¸ï¼>æ•™ç¨‹ï¼šæ¡ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•å¯¦ç¾ç·šæ€§è¿´æ­¸ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e8e17d90.html alt=é‡è¦çªç ´ï¼ä¸­åœ‹ç§‘å­¸å®¶å¯¦ç¾åŸºåº•ç´°èƒç™Œ4.1ç§’äººå·¥æ™ºèƒ½ç²¾æº–è­˜åˆ¥ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RtbWBYL9koJMmN style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e8e17d90.html title=é‡è¦çªç ´ï¼ä¸­åœ‹ç§‘å­¸å®¶å¯¦ç¾åŸºåº•ç´°èƒç™Œ4.1ç§’äººå·¥æ™ºèƒ½ç²¾æº–è­˜åˆ¥>é‡è¦çªç ´ï¼ä¸­åœ‹ç§‘å­¸å®¶å¯¦ç¾åŸºåº•ç´°èƒç™Œ4.1ç§’äººå·¥æ™ºèƒ½ç²¾æº–è­˜åˆ¥</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>