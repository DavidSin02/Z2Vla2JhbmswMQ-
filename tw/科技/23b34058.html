<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>為ASP.NET Core開發中間件壓縮功能提高系統性能 | 极客快訊</title><meta property="og:title" content="為ASP.NET Core開發中間件壓縮功能提高系統性能 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/0e59ba59d6244b84844608d188600738"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/23b34058.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/23b34058.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/23b34058.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/23b34058.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/23b34058.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/23b34058.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/23b34058.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/23b34058.html><meta property="article:published_time" content="2020-11-14T21:01:37+08:00"><meta property="article:modified_time" content="2020-11-14T21:01:37+08:00"><meta name=Keywords content><meta name=description content="為ASP.NET Core開發中間件壓縮功能提高系統性能"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/23b34058.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>為ASP.NET Core開發中間件壓縮功能提高系統性能</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><strong>前言</strong></p><p>壓縮可以大大的降低我們Web服務器的響應速度,壓縮從而提高我們網頁的加載速度,以及節省一定的帶寬.</p><blockquote><p><strong>何時使用相應壓縮中間件</strong></p></blockquote><p>在IIS，Apache，Nginx中使用基於服務端的響應壓縮技術。中間件的執行可能和服務端模塊不匹配。HTTP.sys 和Kestrel server目前沒有提供內置的壓縮支持。</p><h6 class=pgc-h-arrow-right>什麼時候使用Response Compression Middleware:</h6><ul><li>無法使用以下基於服務器的壓縮技術時:</li></ul><ol start=1><li>IIS 動態壓縮模塊</li><li>apache的GZIP壓縮</li><li>Nginx 壓縮</li></ol><ul><li>直接託管:</li></ul><ol start=1><li>Http.sys 服務器</li><li>Kestrel 服務器</li></ol><blockquote><p><strong>如何添加MIME</strong></p></blockquote><p>中間件為壓縮指定了一組默認的 MIME 類型:</p><ul><li>application/javascript</li><li>application/json</li><li>application/xml</li><li>text/css</li><li>text/html</li><li>text/json</li><li>text/plain</li><li>text/xml</li></ul><pre><code>        public void ConfigureServices(IServiceCollection services)        {            services.AddResponseCompression();            services.AddRazorPages();        }        public void Configure(IApplicationBuilder app, IWebHostEnvironment env)        {            if (env.IsDevelopment())            {                app.UseDeveloperExceptionPage();            }            else            {                app.UseExceptionHandler("/Error");                app.UseHsts();            }            app.UseResponseCompression();            app.UseStaticFiles();            app.UseRouting();            app.UseAuthorization();            app.UseEndpoints(endpoints =&gt;            {                endpoints.MapRazorPages();            });        }</code></pre><p>默認是採用Brotli壓縮</p><p>Brotli is a generic-purpose lossless compression algorithm that compresses data using a combination of a modern variant of the LZ77 algorithm, Huffman coding and 2nd order context modeling, with a compression ratio comparable to the best currently available general-purpose compression methods. It is similar in speed with deflate but offers more dense compression.</p><p>Brotli 是基於LZ77算法的一個現代變體、霍夫曼編碼和二階上下文建模。Google軟件工程師在2015年9月發佈了包含通用無損數據壓縮的Brotli增強版本，特別側重於HTTP壓縮。其中的編碼器被部分改寫以提高壓縮比，編碼器和解碼器都提高了速度，流式API已被改進，增加更多壓縮質量級別。</p><p>與常見的通用壓縮算法不同，Brotli使用一個預定義的120千字節字典。該字典包含超過13000個常用單詞、短語和其他子字符串，這些來自一個文本和HTML文檔的大型語料庫。預定義的算法可以提升較小文件的壓縮密度。</p><p><strong>摘自：https://segmentfault.com/a/1190000009383543</strong></p><ul><li>MimeTypes:設定要進行壓縮的MimeTypes</li><li>GzipCompressionProviderOptions:設置壓縮方式(默認是CompressionLevel.Fastest快速壓縮)</li></ul><h6 class=pgc-h-arrow-right>壓縮前：</h6><div class=pgc-img><img alt="為ASP.NET Core開發中間件壓縮功能提高系統性能" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0e59ba59d6244b84844608d188600738><p class=pgc-img-caption></p></div><h6 class=pgc-h-arrow-right>壓縮後：</h6><div class=pgc-img><img alt="為ASP.NET Core開發中間件壓縮功能提高系統性能" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/0b86824dab6b4717be719c3b0b86d8e0><p class=pgc-img-caption></p></div><p>使用壓縮的好處就是節省網絡流量，壓縮資源文件。但是消耗一點CPU性能.</p><h4 class=pgc-h-arrow-right>gzip</h4><ul><li>默認情況下, Brotli 壓縮提供程序會隨Gzip 壓縮提供程序一起添加到壓縮提供程序的數組中。</li><li>他默認採用的是Brotli壓縮,如果客戶端不支持Brotli,客戶端支持Gzip,則默認為Gzip.</li></ul><pre><code>   public void ConfigureServices(IServiceCollection services)        {           services.AddResponseCompression(options=&gt; {               options.Providers.Add&lt;BrotliCompressionProvider&gt;();               options.Providers.Add&lt;GzipCompressionProvider&gt;();           });            services.AddRazorPages();        }</code></pre><div class=pgc-img><img alt="為ASP.NET Core開發中間件壓縮功能提高系統性能" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/10a8395346714b6180b1ec39b3282455><p class=pgc-img-caption></p></div><p>有些MIME類型是需要我們自己為他將其加入壓縮類型中的,我們可以從圖中看到目前有一些未被壓縮,那麼我們可以將他手動增加一下類型.</p><pre><code>    public void ConfigureServices(IServiceCollection services)        {           services.AddResponseCompression(options=&gt; {               options.Providers.Add&lt;BrotliCompressionProvider&gt;();               options.Providers.Add&lt;GzipCompressionProvider&gt;();               options.MimeTypes = ResponseCompressionDefaults.MimeTypes.Concat(                new[] { "image/x-icon" });           });            services.AddRazorPages();        }</code></pre><blockquote><p><strong>如何配置壓縮級別</strong></p></blockquote><p><strong>壓縮級別描述</strong>CompressionLevel.Fastest壓縮應該儘快完成, 即使生成的輸出未以最佳方式壓縮。CompressionLevel.NoCompression不應執行壓縮。CompressionLevel.Optimal即使壓縮需要更長的時間, 也應以最佳方式壓縮響應。</p><pre><code>public void ConfigureServices(IServiceCollection services){        services.AddResponseCompression();                    services.Configure&lt;GzipCompressionProviderOptions&gt;(options =&gt;                 {                        options.Level = CompressionLevel.Fastest;                            });                            })}</code></pre><blockquote><p><strong>安全協議壓縮</strong></p></blockquote><p>可以使用EnableForHttps選項控制安全連接上的壓縮響應，該選項默認情況下處於禁用狀態。對動態生成的頁面使用壓縮可能會導致安全問題，例如CRIME和BREACH攻擊。</p><ul><li>EnableForHttps:是否對HTTPS封包進行壓縮(默認是false)</li></ul><pre><code>        public void ConfigureServices(IServiceCollection services)        {           services.AddResponseCompression(options=&gt; {               options.Providers.Add&lt;BrotliCompressionProvider&gt;();               options.Providers.Add&lt;GzipCompressionProvider&gt;();               options.EnableForHttps = true;               options.MimeTypes = ResponseCompressionDefaults.MimeTypes.Concat(                new[] { "image/x-icon" });           });            services.AddRazorPages();        }</code></pre><p><br></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>ASP</a></li><li><a>NET</a></li><li><a>Core</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/bf86ceae.html alt="如何在ASP.NET Core中實現面向切面編程(AOP)" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/287c0bf906ec4fd88f87bd726019bf06 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bf86ceae.html title="如何在ASP.NET Core中實現面向切面編程(AOP)">如何在ASP.NET Core中實現面向切面編程(AOP)</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2c1045a1.html alt="ASP.NET Core中我們可以使用非常簡單的方式，來使用響應壓縮" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/7b9fcf79-6ed6-4933-8e57-61f4fa936d65 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2c1045a1.html title="ASP.NET Core中我們可以使用非常簡單的方式，來使用響應壓縮">ASP.NET Core中我們可以使用非常簡單的方式，來使用響應壓縮</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2eafc565.html alt="ASP.NET Core如何使用壓縮中間件提高Web應用程序性能" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2f7e2ee9a1f141b48f2b020e9b49f33a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2eafc565.html title="ASP.NET Core如何使用壓縮中間件提高Web應用程序性能">ASP.NET Core如何使用壓縮中間件提高Web應用程序性能</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/04c5f14.html alt="ASP.NET MVC知識盤點：視圖" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0ec8b2b454a04366857c2881b3625e4e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/04c5f14.html title="ASP.NET MVC知識盤點：視圖">ASP.NET MVC知識盤點：視圖</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fae72201.html alt=".Net Core 3.0 IdentityServer4 快速入門" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f15647f0f33b4702bceef5e2365bb375 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fae72201.html title=".Net Core 3.0 IdentityServer4 快速入門">.Net Core 3.0 IdentityServer4 快速入門</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4baa49fe.html alt="Rasa 入門教程 Core 系列（五）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/4a7ff1c942e5461c96528277a1df87d8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4baa49fe.html title="Rasa 入門教程 Core 系列（五）">Rasa 入門教程 Core 系列（五）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f486ab3.html alt="Aspose.Words for .NET使用教程：在Word文檔中使用圖表軸" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/59eb118c690e42838c37ab5babd9c2e4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f486ab3.html title="Aspose.Words for .NET使用教程：在Word文檔中使用圖表軸">Aspose.Words for .NET使用教程：在Word文檔中使用圖表軸</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1c24159.html alt="NET core webApi 使用JWT驗證簽名" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/618ba7dd0033415c9d7bda3cf8a0c789 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1c24159.html title="NET core webApi 使用JWT驗證簽名">NET core webApi 使用JWT驗證簽名</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a500cdb.html alt=超酷炫.NET數據可視化組件LightningChart-專業圖形視圖應用集錦 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/47320001fe7d32c8932b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a500cdb.html title=超酷炫.NET數據可視化組件LightningChart-專業圖形視圖應用集錦>超酷炫.NET數據可視化組件LightningChart-專業圖形視圖應用集錦</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/386528a.html alt="Windows Core OS 最新消息：移植 Win 10 操作中心" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/13870807645047099012dc90388a9b5b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/386528a.html title="Windows Core OS 最新消息：移植 Win 10 操作中心">Windows Core OS 最新消息：移植 Win 10 操作中心</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5ad84a1.html alt="Windows Core OS再遭曝光：可輕鬆移植到Xbox" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/Rp7wxoc3BTb50D style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5ad84a1.html title="Windows Core OS再遭曝光：可輕鬆移植到Xbox">Windows Core OS再遭曝光：可輕鬆移植到Xbox</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>