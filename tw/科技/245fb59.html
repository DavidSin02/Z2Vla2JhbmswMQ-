<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>èŠèŠMQèˆ‡å¦‚ä½•åŸºæ–¼Spring Boot RocketMQæ­å»ºä¸€å€‹æ¶ˆæ¯ä¸­å¿ƒ | æå®¢å¿«è¨Š</title><meta property="og:title" content="èŠèŠMQèˆ‡å¦‚ä½•åŸºæ–¼Spring Boot RocketMQæ­å»ºä¸€å€‹æ¶ˆæ¯ä¸­å¿ƒ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/9050c2396d10468ba999f16bd70ce041"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/245fb59.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/245fb59.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/245fb59.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/245fb59.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/245fb59.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/245fb59.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/245fb59.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/245fb59.html><meta property="article:published_time" content="2020-10-29T21:04:30+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:30+08:00"><meta name=Keywords content><meta name=description content="èŠèŠMQèˆ‡å¦‚ä½•åŸºæ–¼Spring Boot RocketMQæ­å»ºä¸€å€‹æ¶ˆæ¯ä¸­å¿ƒ"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/245fb59.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>èŠèŠMQèˆ‡å¦‚ä½•åŸºæ–¼Spring Boot RocketMQæ­å»ºä¸€å€‹æ¶ˆæ¯ä¸­å¿ƒ</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>å‰è¨€</h1><p>åœ¨å¼•å…¥ä¸€é …æŠ€è¡“ä¹‹å‰ï¼Œé¦–å…ˆå¿…é ˆæ¸…æ¥šçš„æ˜¯è©²æŠ€è¡“å¯ä»¥ç‚ºé …ç›®è§£æ±ºä»€éº¼å•é¡Œã€‚å€‹äººåœ¨ç­è§£æ¶ˆæ¯éšŠåˆ—(Message Queue)ä¹‹å‰ï¼Œä»¥ç‚ºæ¶ˆæ¯éšŠåˆ—ä¸»æ˜¯ç”¨æ–¼ç™¼é€çŸ­ä¿¡ã€éƒµä»¶ç­‰æ¶ˆæ¯ç™¼é€(ç•°æ­¥è§£è€¦)ï¼Œä½†æ·±å…¥ç†è§£æ‰ç™¼ç¾è‡ªå·±çš„ç†è§£éŒ¯äº†ï¼ŒMQçš„ä½œç”¨ä¸æ­¢é«”ç¾åœ¨ä¸€äº›ç”¨æˆ¶æ¥æ”¶åˆ°çš„å…·é«”æ¶ˆæ¯è£¡ï¼Œé‚„å¯ç”¨æ–¼å…¶å®ƒæ‡‰ç”¨çš„æ•¸æ“šç™¼é€ã€é€šç”¨çš„æ¥­å‹™è™•ç†ç­‰ã€‚æ¶ˆæ¯éšŠåˆ—å¾å­—é¢ä¸Šæ„æ€è§£è®€å°±æ˜¯å°‡æ¶ˆæ¯å­˜æ”¾åˆ°éšŠåˆ—è£¡ï¼Œæ ¹æ“šéšŠåˆ—FIFO(å…ˆå…¥å…ˆå‡º)çš„ç‰¹æ€§é€²è¡Œæ¶ˆæ¯æ¶ˆè²»ã€‚åœ¨å¯¦éš›é–‹ç™¼ä¸­ï¼Œæ˜¯ä¸€ç¨®è·¨é€²ç¨‹çš„é€šä¿¡æ©Ÿåˆ¶ï¼Œç”¨æ–¼æ‡‰ç”¨é–“çš„æ¶ˆæ¯å‚³éã€‚</p><hr><h1 class=pgc-h-arrow-right>åœ¨å¼•å…¥MQä¹‹å‰ï¼Œéœ€è¦äº†è§£çš„å„ªç¼ºé»èˆ‡æ‡‰ç”¨å ´æ™¯</h1><p>MQçš„ä¸»è¦å„ªé»ç‚º<strong>è§£è€¦</strong>ã€<strong>ç•°æ­¥</strong>ã€<strong>å‰Šå³°</strong>ï¼Œä»¥ä¸‹èˆ‰ä¸€å€‹ç°¡å–®çš„å ´æ™¯ä¾†åæ‡‰é€™å¹¾å€‹ç‰¹æ€§ã€‚</p><div class=pgc-img><img alt="èŠèŠMQèˆ‡å¦‚ä½•åŸºæ–¼Spring Boot RocketMQæ­å»ºä¸€å€‹æ¶ˆæ¯ä¸­å¿ƒ" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9050c2396d10468ba999f16bd70ce041><p class=pgc-img-caption></p></div><p>åœ¨å¾®æœå‹™é …ç›®ä¸­ï¼Œä¸€èˆ¬æœƒæ ¹æ“šæ ¸å¿ƒæ¥­å‹™é€²è¡Œç³»çµ±çš„å‚ç›´æ‹†åˆ†å†é€²è¡Œå–®ç¨éƒ¨ç½²ã€‚åœ¨ä¸Šåœ–ä¸­ï¼Œå„ç³»çµ±åœ¨ä¸‹å–®æ¥­å‹™è£¡ä¸»è¦è² è²¬çš„å…§å®¹å¦‚ä¸‹ï¼š</p><ul><li>è¨‚å–®ç³»çµ±ï¼šå‰µå»ºè¨‚å–®ï¼Œå°‡ä¸‹å–®æ¶ˆæ¯(å¦‚è¨‚å–®idã€ç”¨æˆ¶æ•¸æ“š)ç™¼é€åˆ°MQ</li><li>MQï¼šé™åˆ¶æ¯ç§’çš„è¨‚å–®è«‹æ±‚è™•ç†æ•¸(å¦‚æ¯ç§’æ¥æ”¶2000å€‹è«‹æ±‚ä½†æ•¸æ“šåº«åªèƒ½è™•ç†1000å€‹å‰‡åªè™•ç†1000å€‹ï¼Œè™•ç†ä¸éä¾†çš„å…ˆåœ¨æ¶ˆæ¯éšŠåˆ—è£¡å †ç©)</li><li>ç‰©æµç³»çµ±ï¼šå‰µå»ºè¨‚å–®ç‰©æµä¿¡æ¯</li><li>ç©åˆ†ç³»çµ±ï¼šç”¨æˆ¶è³¼ç‰©ç©åˆ†ä¿¡æ¯æ›´æ–°</li></ul><p>æƒ³è±¡ä¸‹ä»¥ä¸Šå ´æ™¯æ²’æœ‰MQçš„çš„å­˜åœ¨æ™‚å‰µå»ºè¨‚å–®æµç¨‹ä¸­å­˜åœ¨çš„å•é¡Œï¼š</p><ul><li>è¨‚å–®ç³»çµ±å‰µå»ºå®Œè¨‚å–®ä¿¡æ¯å¾Œè¦å»èª¿ç”¨ç‰©æµç³»çµ±ã€ç©åˆ†ç³»çµ±ä¸Šçš„æ¥­å‹™æ¥å£ï¼Œç³»çµ±åš´é‡çš„<strong>è€¦åˆ</strong>åœ¨ä¸€èµ·(è§£è€¦)</li><li>è¨‚å–®ç³»çµ±è‹¥éé€šéç·šç¨‹å»èª¿ç”¨å…¶å®ƒç³»çµ±çš„æ¥å£ï¼Œé‚„éœ€åŒæ­¥ç­‰å¾…è¿”å›æµªè²»ä¸å°‘æ™‚é–“(ç•°æ­¥ï¼Œé¿å…å‰µå»ºç·šç¨‹èª¿ç”¨çš„éº»ç…©)</li><li>ç”¨æˆ¶é«˜å³°æœŸè«‹æ±‚éå¤šæ•¸æ“šåº«è™•ç†ä¸éä¾†é€²è€Œå°è‡´æ‡‰ç”¨å´©æ½°(å‰Šå³°)</li></ul><p>ä»»ä½•äº‹ç‰©éƒ½æœ‰å…©é¢æ€§ï¼Œé›–ç„¶MQå¯ä»¥çµ¦ç³»çµ±è§£æ±ºä¸å°‘å•é¡Œï¼Œä½†ä¹Ÿæœƒå¼•å…¥ä¸€äº›å•é¡Œï¼Œå¦‚ï¼š</p><ul><li>ç³»çµ±è¤‡é›œåº¦æé«˜ï¼Œéœ€è¦è€ƒæ…®æ¶ˆæ¯é‡è¤‡æ¶ˆè²»ã€æ¶ˆæ¯ä¸Ÿå¤±ç­‰å•é¡Œ</li><li>æ•¸æ“šä¸€è‡´æ€§å•é¡Œï¼Œå¦‚ä¸Šä¾‹ä¸­çš„ç‰©æµæˆ–åº«å­˜ç³»çµ±å¯«åº«å‡ºç¾ç•°å¸¸å¦‚ä½•å›æ»¾è£œå„Ÿ</li></ul><p>ç­è§£äº†MQçš„ä¸€äº›ç‰¹æ€§å¾Œï¼Œå†è¨è«–ä¸‹å¹¾å€‹é©åˆä½¿ç”¨MQçš„å ´æ™¯ï¼š</p><ul><li>ä¸Šæ¸¸ç³»çµ±ä¸é—œå¿ƒä¸‹æ¸¸çš„åŸ·è¡Œçµæœ(å¦‚ç”¨æˆ¶è¨»å†ŠæˆåŠŸå¾Œç”¨æˆ¶ç³»çµ±é€šéMQå‘ç”¨æˆ¶ç™¼é€éƒµä»¶ï¼Œä½†ç™¼é€æˆä¸æˆåŠŸç”¨æˆ¶ç³»çµ±æ ¹æœ¬ä¸åœ¨æ„)</li><li>ä¾è³´æ–¼æ•¸æ“šçš„å®šæ™‚ä»»å‹™(å¦‚ä¸‹å–®å¾Œ24å°æ™‚å…§ä¸æ”¯ä»˜å‰‡å–æ¶ˆè¨‚å–®ï¼Œç”³è«‹é€€æ¬¾72å°æ™‚å…§å•†å®¶ä¸è™•ç†å‰‡è‡ªå‹•é€€æ¬¾)</li></ul><hr><h1 class=pgc-h-arrow-right>å¼•å…¥MQå¾Œçš„ä¸€äº›å•é¡Œè§£æ±ºæ€è·¯</h1><li><strong>æ¶ˆæ¯é‡è¤‡æ¶ˆè²»(ä¿è­‰æ¶ˆæ¯çš„å†ªç­‰æ€§)</strong></li><p class=pgc-end-literature>å†ªç­‰æ€§ï¼šå°æ–¼åŒä¸€æ“ä½œçš„è«‹æ±‚ç„¡è«–è«‹æ±‚å¤šå°‘æ¬¡çµæœéƒ½æ˜¯ä¸€è‡´çš„ï¼Œåœ¨MQä¸­çš„å…·é«”é«”ç¾ç‚ºåŒä¸€æ¢æ¶ˆæ¯ç„¡è«–ç™¼é€éƒ½å°‘æ¬¡éƒ½åªæœƒè¢«æ¶ˆè²»ä¸€æ¬¡ã€‚</p><p>ç”±æ–¼ç¶²çµ¡æŠ–å‹•(å»¶é²)çš„åŸå› æ¶ˆæ¯é‡è¤‡ç™¼é€çš„å•é¡Œæ˜¯ä¸å¯é¿å…çš„ï¼Œå¦‚æœåœ¨æ¶ˆè²»ç«¯æ¶ˆè²»æ™‚æ²’æœ‰åšå¥½æ¶ˆæ¯çš„å†ªç­‰æ€§ä¿è­‰å°±æœ‰å¯èƒ½å‡ºç¾é‡è¤‡æ¶ˆè²»ï¼Œå°è‡´åŒä¸€æ¢æ¶ˆæ¯è¢«å¤šæ¬¡æ¶ˆè²»ã€å¯«åº«å¤šæ¬¡çš„æƒ…æ³ã€‚æ¯”è¼ƒå¸¸è¦‹çš„åšæ³•æ˜¯ç‚ºæ¶ˆæ¯æ·»åŠ ä¸€å€‹å”¯ä¸€æ¨™è­˜(ID)ï¼Œåœ¨æ¶ˆè²»æ™‚æ ¹æ“šIDæŸ¥è©¢æ•¸æ“šåº«æ˜¯å¦å­˜åœ¨è©²æ¶ˆæ¯è¨˜éŒ„ï¼Œå¦‚æœä¸å­˜åœ¨å†æ’å…¥æ¶ˆæ¯ï¼Œå­˜åœ¨å‰‡ä¸é€²è¡Œæ’å…¥æ¶ˆè²»ã€‚<br>ç•¶ç”Ÿæˆèˆ‡æ¶ˆè²»æ™‚é–“é–“éš”ä¸é•·æ™‚ï¼Œå¯ä½¿ç”¨Redisæé«˜æ¶ˆæ¯å†ªç­‰æ€§çš„æ•ˆç‡ï¼Œå¦‚ï¼š</p><p>1. æ¶ˆè²»è€…æ¶ˆè²»å‰æ ¹æ“šIDå»æŸ¥è©¢redisæ˜¯å¦å­˜åœ¨è©²æ¶ˆæ¯</p><p>2. ä¸å­˜åœ¨è©²æ¶ˆæ¯å‰‡æ¶ˆè²»ä¸¦å¯«å…¥redisï¼Œå­˜åœ¨è©²æ¶ˆæ¯å‰‡ä¸æ¶ˆè²»è¿”å›</p><p><br></p><p>é—œæ–¼æ¶ˆæ¯IDï¼š</p><p>1. RocketMQçš„æ¯æ¢æ¶ˆæ¯éƒ½æœƒé…æœ‰å…¨å±€å”¯ä¸€çš„ID</p><p>2. å¦‚æœæ¶ˆæ¯ä¸­é–“ä»¶ä¸æœƒç”ŸæˆIDï¼Œå¯è€ƒæ…®ä¸€äº›IDæœå‹™(å¦‚é›ªèŠ±ç®—æ³•)ç”Ÿæˆå…¨å±€å”¯ä¸€ID</p><p>3. å»ºè­°IDä¸èˆ‡å¯¦éš›æ¥­å‹™é—œè¯</p><p>å¦‚ç›®å‰å€‹äººå·¥ä½œä¸­è² è²¬çš„æ¶ˆæ¯ä¸­å¿ƒæ‡‰ç”¨æ˜¯åŸºæ–¼MongoDB+RocketMQçš„æŠ€è¡“æ¶æ§‹ï¼ŒMongoDBè² è²¬å­˜å„²å„å€‹æ‡‰ç”¨ç™¼é€éä¾†çš„æ¶ˆæ¯(ä¸»è¦ç‚ºSmsã€Emailç­‰)ï¼Œæ¯æ¬¡æ¶ˆè²»å‰é€šéRocketMQçš„Message IDæŸ¥è©¢Mongoä¿è­‰æ¶ˆæ¯å†ªç­‰æ€§é¿å…é‡è¤‡æ¶ˆè²»ï¼Œæ¶ˆè²»æˆåŠŸå¾Œæ›´æ–°DBä¸­çš„æ¶ˆæ¯ç‹€æ…‹ã€‚</p><li><strong>æ¶ˆæ¯ä¸Ÿå¤±(æ¶ˆæ¯çš„å¯é æ€§)</strong></li><p>MQå„çµ„ä»¶çš„æ¶ˆæ¯ä¸Ÿå¤±å«ç¾©éƒ½æœ‰æ‰€ä¸åŒï¼Œå°è‡´èˆ‡è§£æ±ºæ–¹æ¡ˆä¹Ÿä¸ä¸€å®šç›¸åŒï¼Œä»¥kafkaã€rocketçš„æ¶ˆæ¯å‚³éæ¨¡å‹(Producer->Broker->Consumer)ç‚ºä¾‹ï¼š</p><ul><li>Producerï¼šæ¶ˆæ¯æœªæŒä¹…åŒ–åˆ°Brokerä¸­ï¼Œæˆ–æ¶ˆè²»è€…æœªèƒ½æˆåŠŸæ¶ˆè²»åˆ°æ¶ˆæ¯ã€‚Kafkaå¯é€šéæ›´æ”¹acké…ç½®è§£æ±ºï¼ŒrocketMQä¸­æœƒè¿”å›æ¶ˆæ¯ç™¼é€ç‹€æ…‹ç¢¼ã€‚</li><li>Brokerï¼šæ¶ˆæ¯æˆåŠŸå‚³åˆ°åˆ°æˆ‘é€™è£¡äº†ï¼Œå¯æˆ‘å› ç‚ºæŸäº›åŸå› (ä¸åŒçš„MQå¯èƒ½å› æ©Ÿåˆ¶å•é¡Œæœ‰ä¸åŒåŸå› )å¼„ä¸Ÿäº†ï¼Œå¦‚æœæ˜¯ç¡¬ä»¶åŸå› (å¦‚å®•æ©Ÿã€ç£ç›¤æå£)å»ºè­°ä½ copy(é›†ç¾¤éƒ¨ç½²)å¹¾å€‹æˆ‘</li><li>Consumerï¼šæˆ‘æ‹¿åˆ°äº†æ¶ˆæ¯ï¼Œä½†æ¶ˆè²»å¤±æ•—äº†æˆ–ä¸­é€”æ›æ‰äº†æ²’å‘Šè¨´Brokerã€‚å¯é€šéå„MQä¸­é–“ä»¶çš„ACKæ©Ÿåˆ¶è§£æ±ºã€‚</li></ul><hr><h1 class=pgc-h-arrow-right>åŸºæ–¼RocketMQçš„ç°¡å–®ä¾‹å­æŠ€è¡“æ¡†æ¶èˆ‡æ¥­å‹™æ¨¡å‹</h1><p>ä»¥ä¸‹ä¾¿ä»¥ä¸€å€‹åŸºæ–¼MongoDB+RocketMQ+Eureka+Spring Cloud Configçš„æŠ€è¡“æ¡†æ¶ä¸¦çµåˆä½¿ç”¨MQä¸­çš„å•é¡Œæ­å»ºä¸€å€‹ç°¡å–®çš„æ¶ˆæ¯ä¸­å¿ƒé …ç›®æ¡ˆä¾‹ï¼Œå…¶ä¸­å„çµ„ä»¶åœ¨é …ç›®ä¸­çš„ä¸»è¦ä½œç”¨å¦‚ä¸‹ï¼š</p><ul><li>Spring Cloud Configï¼šæ¶ˆæ¯é…ç½®(å¦‚topicã€ConsumerGroupã€ProducerGroup)ä¸­å¿ƒã€‚</li><li>Eurekaï¼šæ‡‰ç”¨æœå‹™è¨»å†Šä¸­å¿ƒï¼Œè² è²¬é …ç›®ä¸­å„æœå‹™çš„ç™¼ç¾èˆ‡æä¾›èª¿ç”¨ã€‚</li><li>MongoDBï¼šç”±æ–¼æ¶ˆæ¯çš„äº‹å‹™é—œä¿‚ä¸å¼·ä¸”Mongodbæ ¼å¼æ–‡æª”è‡ªç”±(jsonå­˜å„²ï¼Œéš¨æ„å¢åˆªå­—æ®µ)ï¼Œæ‰€ä»¥ä½¿ç”¨Mongodbå­˜å„²å„å€‹æ‡‰ç”¨ç™¼é€éä¾†çš„æ¶ˆæ¯(ä¸»è¦ç‚ºSmsã€Emailç­‰)ï¼Œæ¯æ¬¡æ¶ˆè²»å‰é€šéRocketMQçš„Message IDæŸ¥è©¢Mongoä¿è­‰æ¶ˆæ¯å†ªç­‰æ€§é¿å…é‡è¤‡æ¶ˆè²»ï¼Œæ¶ˆè²»æˆåŠŸå¾Œä¿å­˜æ¶ˆæ¯ã€‚</li><li>RocketMQï¼šæ¶ˆæ¯æ¥æ”¶ã€å­˜å„²ã€ç™¼é€ã€‚</li></ul><p>ä¸‹åœ–ç‚ºè©²é …ç›®çš„æ‡‰ç”¨é—œä¿‚æ¨¡å‹ï¼š</p><div class=pgc-img><img alt="èŠèŠMQèˆ‡å¦‚ä½•åŸºæ–¼Spring Boot RocketMQæ­å»ºä¸€å€‹æ¶ˆæ¯ä¸­å¿ƒ" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/da8b16e55da34842bf773abf65bddafd><p class=pgc-img-caption></p></div><p>æ¶ˆæ¯ä¸­å¿ƒæ‡‰ç”¨ï¼šçµ±ä¸€é€šç”¨æ¶ˆæ¯çš„æ¥­å‹™è™•ç†æ‡‰ç”¨ï¼Œå¦‚çŸ­ä¿¡ç™¼é€ã€éƒµä»¶ç™¼é€ã€å“¡å·¥æœå‹™è™Ÿæ¨é€ç­‰æ¶ˆæ¯çš„è™•ç†å•å·æ‡‰ç”¨ï¼šè² è²¬å“¡å·¥èª¿æŸ¥å•å·çš„åˆ†ç™¼ï¼Œåœ¨è©²ä¾‹å­ä¸­åªæ˜¯ä¸€å€‹ç°¡å–®çš„æ¶ˆæ¯ç™¼é€æ¸¬è©¦æ‡‰ç”¨commonï¼šå­˜æ”¾å„æ‡‰ç”¨é€šç”¨é¡ï¼Œå¦‚çŸ­ä¿¡æ¶ˆæ¯é¡(SmsMessage)ã€æ¶ˆæ¯å¸¸é‡é¡config-server-propertiesï¼šé…ç½®ä¸­å¿ƒçš„é…ç½®å­˜æ”¾ç›®éŒ„ç”±æ–¼è©²é …ç›®ä¸»è¦ç”¨æ–¼æ¼”ç¤ºä¸€äº›MQçš„åŠŸèƒ½èˆ‡ä½¿ç”¨ä¸­çš„å•é¡Œè§£æ±ºæ–¹å¼ï¼Œæ‰€ä»¥ç·¨ç¢¼éƒ¨åˆ†æ¯”è¼ƒç°¡å–®ã€‚</p><h1 class=pgc-h-arrow-right>æ‡‰ç”¨ç·¨ç¢¼</h1><p><strong class=highlight-text>é€šç”¨æ¨¡å¡Šç·¨ç¢¼(common)</strong></p><p>ä¸»è¦å­˜æ”¾å„æ‡‰ç”¨é€šç”¨é¡(å¦‚å¯¦é«”ã€å¸¸é‡ã€é…ç½®ã€åŠŸèƒ½ç­‰)ã€‚</p><p><strong>MessageConstantï¼šç¶­è­·æ¶ˆæ¯å¸¸é‡ã€‚</strong></p><pre><code>public interface MessageConstant {    interface System {        String QUESTION = "QUESTION";    }    interface Topic {        String SMS_TOPIC = "rocketmq.topic.sms";        String SMS_TOPIC_TEMPLATE = "${rocketmq.topic.sms}";        String MAIL_TOPIC = "rocketmq.topic.mail";        String MAIL_TOPIC_TEMPLATE = "${rocketmq.topic.mail}";    }    interface Producer {        String SMS_GROUP_TEMPLATE = "${rocketmq.producer.group.sms}";        String MAIL_GROUP_TEMPLATE = "${rocketmq.producer.group.mail}";    }    interface Consumer {        String SMS_GROUP_TEMPLATE = "${rocketmq.consumer.group.sms}";        String MAIL_GROUP_TEMPLATE = "${rocketmq.consumer.group.mail}";    }}</code></pre><p><strong>BaseMessageï¼šåŸºç¤æ¶ˆæ¯é¡ï¼Œæ‰€ç”¨çš„é€šç”¨æ¶ˆæ¯éƒ½éœ€ç¹¼æ‰¿æ­¤é¡æ–¹ä¾¿çµ±ä¸€ä¿¡æ¯çš„ç®¡ç†</strong></p><pre><code>@Data@Accessors(chain = true)public abstract class BaseMessage implements Serializable {    /**     * æ¶ˆæ¯æºç³»çµ±:{@link io.wilson.common.message.constant.MessageConstant.System}     */    private String system;}</code></pre><p><strong>SmsMessageï¼šé€šç”¨çŸ­ä¿¡æ¶ˆæ¯é¡ï¼ŒçŸ­ä¿¡å…§å®¹æ•¸æ“šè¼‰é«”</strong></p><pre><code>@EqualsAndHashCode(callSuper = true)@Data@Accessors(chain = true)@ToString(callSuper = true)public class SmsMessage extends BaseMessage {    /**     * çŸ­ä¿¡å‰µå»ºç”¨æˆ¶     */    private String createUserId;    /**     * æ¥æ”¶çŸ­ä¿¡ç”¨æˆ¶     */    private String toUserId;    /**     * æ‰‹æ©Ÿè™Ÿç¢¼     */    private String mobile;    /**     * çŸ­ä¿¡å…§å®¹     */    private String content;}</code></pre><p><strong class=highlight-text>æ¶ˆæ¯ä¸­å¿ƒæ‡‰ç”¨(message-center)</strong></p><p>æ¶ˆæ¯ä¸­å¿ƒåœ¨é€²è¡Œç·¨ç¢¼ä¹‹å‰ï¼Œéœ€ç¢ºèªæ¶ˆæ¯ä¸­å¿ƒè©²å¦‚ä½•é€²è¡Œæ¶ˆæ¯çš„è™•ç†ã€‚è©²é …ç›®æ‰€è™•çš„æ¥­å‹™ç’°å¢ƒæ˜¯å„æ‡‰ç”¨å¯èƒ½éƒ½éœ€è¦ç™¼é€ä¸€äº›çŸ­ä¿¡æ¶ˆæ¯ã€éƒµä»¶ã€æœå‹™è™Ÿæ¶ˆæ¯ç­‰ï¼Œç›¸åŒæ¶ˆæ¯çš„æ¥­å‹™è™•ç†æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥æ¶ˆæ¯ä¸­å¿ƒå°æ¶ˆæ¯æ¥æ”¶æ¶ˆè²»çš„ä¸»è¦æµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>ä¿è­‰æ¶ˆæ¯å†ªç­‰æ€§(æŸ¥è©¢æ•¸æ“šåº«ä½¿ç”¨å·²æœ‰æ¶ˆæ¯è¨˜éŒ„é¿å…é‡è¤‡æ¶ˆè²»)</li><li>æ¶ˆæ¯æ¥­å‹™è™•ç†</li><li>æ¶ˆæ¯æ—¥èªŒå…¥åº«</li></ul><p>åœ¨è©²é …ç›®ä¸­ï¼Œä¸åŒçš„æ¶ˆæ¯é¡å‹å­˜å„²åœ¨ä¸åŒçš„Mongodb collection(åŒMysql tableæ¦‚å¿µ)ï¼Œä½†å…±ç”¨ä¸€å€‹æ¶ˆæ¯æ—¥èªŒé¡MessageLogï¼š</p><pre><code>@Data@Accessors(chain = true)public class MessageLog implements Serializable {    private String msgId;    /**     * ç™¼é€æ–¹ç³»çµ±åç¨± {@link io.wilson.common.message.constant.MessageConstant}     */    private String system;    /**     * æ¶ˆæ¯å°è±¡jsonå­—ç¬¦ä¸²     */    private String msgContent;    /**     * æ¥­å‹™åŸ·è¡Œçµæœ     */    private Boolean success;    private LocalDateTime createTime;    private LocalDateTime updateTime;    /**     * åˆå§‹åŒ–æ¶ˆæ¯è¨˜éŒ„     *     * @param message       æ¶ˆæ¯     * @return     */    public static &lt;T extends BaseMessage&gt; MessageLog convertFromMessage(T message) {        LocalDateTime now = LocalDateTime.now();        return new MessageLog()                .setSystem(message.getSystem())                .setSuccess(false)                .setCreateTime(now)                .setUpdateTime(now);    }}</code></pre><p>åœ¨è©²æ¶ˆè²»æµç¨‹è¨­è¨ˆèˆ‡é–‹ç™¼ç·¨ç¢¼éç¨‹ä¸­å€‹äººè€ƒæ…®çš„æ ¸å¿ƒé»å¦‚ä¸‹ï¼š</p><ol start=1><li>å¦‚æœä½¿ç”¨æ™®é€šæ¶ˆæ¯é¡(å¦‚SmsMessage)ä½œç‚ºdbå­˜å„²çš„æ˜ å°„å°è±¡ï¼Œæœƒå°è‡´æ¶ˆæ¯é¡æ‘»é›œä¸å¿…è¦çš„å±¬æ€§(å¦‚createTimeã€updateTimeã€success)ï¼Œä¸”ä½œç‚ºä¸€å€‹é€šç”¨çš„æ¶ˆæ¯æ•¸æ“šè¼‰é«”ï¼Œæ™®é€šæ¶ˆæ¯é¡æ›´é©æ–¼ä½œç‚ºä¸€å€‹VOè€ŒéDOä½¿ç”¨ï¼Œæ‰€ä»¥æ¶ˆæ¯çš„è™•ç†çµæœã€æ¶ˆæ¯çš„å‰µå»ºæ›´æ–°æ™‚é–“é€™äº›ä½œç‚ºåŸæ¶ˆæ¯ä¸Šçš„é™„åŠ å…§å®¹ï¼Œæ›´é©åˆæ”¾åˆ°å…¶å®ƒæ•¸æ“šåº«æ˜ å°„å°è±¡ä¸­ç¶­è­·ï¼Œæ‰€ä»¥å®šç¾©äº†MessageLogä½œç‚ºæ¶ˆæ¯è¨˜éŒ„çš„å¯¦é«”é¡</li><li>æ—¢ç„¶æ˜¯ä½œç‚ºå„æ‡‰ç”¨éƒ½å¯ä½¿ç”¨çš„é€šç”¨æ¶ˆæ¯æ‰€ä»¥è‚¯å®šéƒ½æœƒæœ‰ä¸€å®šæ•¸æ“šé‡ï¼Œé›–ç„¶æ˜ å°„å¯¦é«”éƒ½ä¸€æ¨£ï¼Œä½†å­˜æ”¾åˆ°ä¸åŒçš„collectionå¯ä»¥æé«˜æ“ä½œçš„ä¾¿æ·æ€§å’Œç²å¾—æ›´å¥½çš„æ€§èƒ½ï¼Œç³»çµ±ç·¨ç¢¼å¯ä»¥æ›´å¥½åœ°æ ¹æ“šç³»çµ±é€²è¡Œæ¶ˆæ¯ç¯©é¸</li><li>åœ¨æ¶ˆæ¯æ¶ˆè²»æµç¨‹ä¸­ï¼Œä¿è­‰æ¶ˆæ¯å†ªç­‰æ€§å’Œæ¶ˆæ¯æ—¥èªŒå…¥åº«é€™å…©æ­¥åªæœ‰æ•¸æ“šåº«åæ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥å¯å®šç¾©ä¸€å€‹çˆ¶Listeneré€²è¡Œæ¶ˆæ¯ç›£è½æ¶ˆè²»çš„æ–¹æ³•æŠ½è±¡ï¼Œä¸åŒæ¶ˆæ¯çš„æ¥­å‹™è™•ç†äº¤çµ¦ä¸åŒçš„æ¶ˆæ¯Serviceï¼ŒåŒä¸€é¡æ¶ˆæ¯çš„æ¶ˆè²»å¯èƒ½æœƒå†ç´°åˆ†èª¿ç”¨ä¸åŒçš„æ¶ˆæ¯æ¥­å‹™æ–¹æ³•æ¶ˆè²»(å¦‚ç™¼é€å–®æ¢çŸ­ä¿¡ã€æ‰¹é‡ç™¼é€çŸ­ä¿¡)ï¼Œæ‰€ä»¥å¯ä»¥å°å„serviceæŠ½è±¡å‡ºä¸€å€‹consume()æ–¹æ³•æ ¹æ“šåƒæ•¸èª¿ç”¨å…·é«”çš„serviceæ¥­å‹™æ–¹æ³•é€²è¡Œæ¶ˆæ¯æ¶ˆè²»</li></ol><p>ç‚ºäº†æ›´å¥½åœ°å±•ç¤ºæ¶ˆæ¯ä¸­å¿ƒé¡ä¹‹é–“çš„é—œä¿‚ï¼Œæç¹ªä»¥ä¸‹é¡åœ–ï¼š</p><div class=pgc-img><img alt="èŠèŠMQèˆ‡å¦‚ä½•åŸºæ–¼Spring Boot RocketMQæ­å»ºä¸€å€‹æ¶ˆæ¯ä¸­å¿ƒ" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2dc778fc70144f458e6ce83310468166><p class=pgc-img-caption></p></div><p>ç•¶ä¸€æ¢çŸ­ä¿¡æ¶ˆæ¯ç™¼é€åˆ°æ¶ˆæ¯ä¸­å¿ƒæ™‚ï¼Œå…¶æ¶ˆè²»æµç¨‹å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt="èŠèŠMQèˆ‡å¦‚ä½•åŸºæ–¼Spring Boot RocketMQæ­å»ºä¸€å€‹æ¶ˆæ¯ä¸­å¿ƒ" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d27f5e23855b4241a65f06448b3ca188><p class=pgc-img-caption></p></div><ul><li><strong>æ¶ˆæ¯æ¥­å‹™è™•ç†ç·¨ç¢¼</strong></li></ul><p><strong>BaseMessageServiceï¼šæ¶ˆæ¯æ¥­å‹™æ¶ˆè²»æŠ½è±¡æ¥å£ï¼ŒæŠ½è±¡æ¯å€‹æ¶ˆè²»è€…(Listener)èª¿ç”¨çš„æ¥­å‹™æ¶ˆè²»æ–¹æ³•</strong></p><pre><code>public interface BaseMessageService&lt;T extends BaseMessage&gt; {    /**     * æ¶ˆè²»æ¶ˆæ¯     *     * @param message         æ¶ˆæ¯     * @param consumeFunction æ¶ˆè²»æ–¹æ³•     */    default boolean consume(T message, Function&lt;T, Boolean&gt; consumeFunction) {        return consumeFunction.apply(message);    }}</code></pre><p><strong>BaseMessageServiceï¼šçŸ­ä¿¡æ¶ˆæ¯æ¥­å‹™æŠ½è±¡æ¥å£</strong></p><pre><code>@Servicepublic interface SmsMessageService extends BaseMessageService&lt;SmsMessage&gt; {    /**     * ç™¼é€å–®æ¢çŸ­ä¿¡æ¶ˆæ¯     *     * @param smsMessage     * @return æ¥­å‹™è™•ç†çµæœ     */    boolean sendSingle(SmsMessage smsMessage);}</code></pre><p><strong>SmsMessageServiceImplï¼šçŸ­ä¿¡æ¶ˆæ¯æ¥­å‹™å¯¦ç¾é¡</strong></p><pre><code>@Service@Slf4jpublic class SmsMessageServiceImpl implements SmsMessageService {    @Override    public boolean sendSingle(SmsMessage smsMessage) {        // çŸ­ä¿¡æ¥­å‹™æ“ä½œçµæœ        boolean isSuccess = true;        /*         * çŸ­ä¿¡æ¥­å‹™æ“ä½œä¸¦æŠŠæ“ä½œçµæœè¨­åˆ°isSuccessä¸­         */        if (Objects.equals(smsMessage.getToUserId(), "Wilson")) {            isSuccess = false;            log.info("çŸ­ä¿¡ç™¼é€å¤±æ•—,æ¶ˆæ¯å…§å®¹:{}", smsMessage);        }        return isSuccess;    }}</code></pre><ul><li><strong>æ¶ˆæ¯æ¥­å‹™è™•ç†ç·¨ç¢¼</strong></li></ul><p><strong>MessageLogConstantï¼šç¶­è­·MessageLogçš„ç›¸é—œå¸¸é‡(å¦‚ä¸åŒæ¶ˆæ¯çš„collectionå)</strong></p><pre><code>public interface MessageLogConstant {    /**     * å„æ¶ˆæ¯æ—¥èªŒMongoé›†åˆå     */    interface CollectionName {        String SMS = "sms_message_log";        String MAIL = "mail_message_log";    }}</code></pre><p><strong>AbstractMQStoreListenerï¼šä¿è­‰æ¶ˆæ¯å†ªç­‰æ€§ã€æ¶ˆæ¯æ—¥èªŒå…¥åº«æ“ä½œçš„æŠ½è±¡Listeneré¡æ–¹æ³•ä¸­</strong></p><pre><code></code></pre><p><strong>SmsMessageListener:çŸ­ä¿¡æ¶ˆæ¯ç›£è½å™¨(æ¶ˆè²»è€…)ï¼Œå¦‚åœ¨æ¶ˆè²»éç¨‹ä¸­æ‹‹å‡ºç•°å¸¸ï¼ŒRocketMQæœƒä»¥ä¸€å®šçš„æ™‚é–“é–“éš”é€²è¡Œé‡æ–°æŠ•éæ¶ˆè²»</strong></p><pre><code>@Slf4j@Service@ConditionalOnProperty(MessageConstant.Topic.SMS_TOPIC)@RocketMQMessageListener(topic = MessageConstant.Topic.SMS_TOPIC_TEMPLATE, consumerGroup = MessageConstant.Consumer.SMS_GROUP_TEMPLATE)public class SmsMessageListener extends AbstractMQStoreListener implements RocketMQListener&lt;MessageExt&gt; {    @Resource    private SmsMessageService smsMessageService;    private static final String EXCEPTION_FORMAT = "çŸ­ä¿¡æ¶ˆæ¯æ¶ˆè²»å¤±æ•—ï¼Œæ¶ˆæ¯å…§å®¹ï¼š%s";    @Override    public void onMessage(MessageExt message) {        String msgId = message.getMsgId();        if (isConsumed(msgId)) {            return;        }        SmsMessage smsMessage = JSONObject.parseObject(message.getBody(), SmsMessage.class);        log.info("æ¥æ”¶åˆ°çŸ­ä¿¡æ¶ˆæ¯{}ï¼š{}", msgId, smsMessage);        /*if (Objects.equals(smsMessage.getToUserId(), "2020")) {            log.error("æ¶ˆæ¯{}æ¶ˆè²»å¤±æ•—", message.getMsgId());            // æ‹‹å‡ºç•°å¸¸è®“RocketMQé‡æ–°æŠ•éæ¶ˆæ¯é‡æ–°æ¶ˆè²»            throw new MQConsumeException(String.format(EXCEPTION_FORMAT, smsMessage));        }*/        boolean isSuccess = smsMessageService.consume(smsMessage, smsMessageService::sendSingle);        if (!isSuccess) {            log.info("çŸ­ä¿¡æ¶ˆæ¯æ¥­å‹™æ“ä½œå¤±æ•—,æ¶ˆæ¯id: {}", msgId);        }        // ä¿å­˜æ¶ˆæ¯æ¶ˆè²»è¨˜éŒ„        store(isSuccess, msgId, smsMessage);    }    @Override    protected String collection() {        return MessageLogConstant.CollectionName.SMS;    }}</code></pre><p><strong>MessageCenterApplication:ä¸»ç¨‹åº</strong></p><pre><code>@SpringBootApplication@EnableDiscoveryClientpublic class MessageCenterApplication {    public static void main(String[] args) {        SpringApplication.run(MessageCenterApplication.class, args);    }}</code></pre><p><strong>Spring Cloudé…ç½®æ–‡ä»¶bootstrap.yml</strong></p><pre><code>eureka:  client:    service-url:      defaultZone: http://localhost:8000/eurekaspring:  cloud:    config:      discovery:        enabled: true        service-id: config-center      #     è³‡æºæ–‡ä»¶å      profile: dev      name: rocketmq</code></pre><p><strong>SmsSendTestï¼šå–®å…ƒæ¸¬è©¦é¡</strong></p><pre><code></code></pre><ul><li><strong>é…ç½®ä¸­å¿ƒ(config-server)</strong></li></ul><p>ä¸»ç¨‹åºConfigServerApplication</p><pre><code>@SpringBootApplication@EnableDiscoveryClient@EnableConfigServerpublic class ConfigServerApplication {   public static void main(String[] args) {      SpringApplication.run(ConfigServerApplication.class, args);   }}</code></pre><p>Spring Cloudé…ç½®æ–‡ä»¶bootstrap.yml:</p><pre><code>spring:  cloud:    config:      server:        git:          uri: https://gitee.com/Wilson-He/rocketmq-message-center-demo.git          username: Wilson-He          force-pull: true          password:          # é…ç½®æ–‡ä»¶åœ¨uriä¸‹çš„ç›®éŒ„          search-paths: /config-server-propertieseureka:  client:    service-url:      defaultZone: http://localhost:8000/eureka</code></pre><p>é…ç½®æ–‡ä»¶configs-server-properties/rocketmq-dev.properties:</p><pre><code>rocketmq.name-server=127.0.0.1:9876rocketmq.topic.sms=sms-topicrocketmq.producer.group.sms=sms-grouprocketmq.consumer.group.sms=sms-grouprocketmq.topic.mail=mail-topicrocketmq.producer.group.mail=mail-grouprocketmq.consumer.group.mail=mail-group</code></pre><h1 class=pgc-h-arrow-right>é‹è¡Œæµç¨‹</h1><ol start=1><li>é‹è¡ŒRocketMQ name-serverèˆ‡broker,å¦‚mqnamesrv -n 127.0.0.1:9876,mqbroker -n 127.0.0.1:9876</li><li>é‹è¡Œeurekaæ‡‰ç”¨</li><li>é‹è¡Œé…ç½®ä¸­å¿ƒconfig-server</li><li>é‹è¡Œæ¶ˆæ¯ä¸­å¿ƒmessage-center</li><li>é‹è¡Œmessage-centerå–®å…ƒæ¸¬è©¦é¡(SmsSendTest)æˆ–é‹è¡Œquestion-appè¨ªå•localhost:8080/question/toUser?userId=xxxé€²è¡Œæ¶ˆè²»æ¸¬è©¦ï¼Œæ¶ˆæ¯ä¸­å¿ƒæ§åˆ¶æª¯æ‰“å°å‡ºæ—¥èªŒä¿¡æ¯èˆ‡Mongo sms_message_logæˆåŠŸæ–°å¢äº†æ•¸æ“šå³é …ç›®æ­å»ºå®Œæˆ</li></ol><div class=pgc-img><img alt="èŠèŠMQèˆ‡å¦‚ä½•åŸºæ–¼Spring Boot RocketMQæ­å»ºä¸€å€‹æ¶ˆæ¯ä¸­å¿ƒ" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/38b7fd8074e54102ac5ce22ef4ca4097><p class=pgc-img-caption></p></div><div class=pgc-img><img alt="èŠèŠMQèˆ‡å¦‚ä½•åŸºæ–¼Spring Boot RocketMQæ­å»ºä¸€å€‹æ¶ˆæ¯ä¸­å¿ƒ" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/147ea557bbc840b780259c110753ac5c><p class=pgc-img-caption></p></div><p><strong>(å¾…)æ“´å±•é»ï¼š</strong></p><ol start=1><li>RocketMQçš„ç™¼é€è€…æ‡‰ç”¨å¯åœ¨é…ç½®æ–‡ä»¶ä¸­è¨­ç½®rocketmq.producer.retry-times-when-send-failed/retry-times-when-send-async-failedå±¬æ€§é…ç½®rocketmqåŒæ­¥/ç•°æ­¥ç™¼é€æ¶ˆæ¯å¤±æ•—å¾Œçš„é‡è©¦æ¬¡æ•¸ï¼Œä¸è¨­ç½®å‰‡é»˜èªéƒ½ç‚º2</li><li>ç•¶æ¥­å‹™åŸ·è¡Œæ“ä½œçµæœå¤±æ•—æ™‚ä»ç„¶å…¥åº«çš„åŸå› æ˜¯æœ‰æ™‚æ¥­å‹™åŸ·è¡Œéç¨‹ä¸­å¯èƒ½æœƒåŒ…å«èª¿ç”¨ç¬¬ä¸‰æ–¹çš„æ“ä½œï¼Œç•¶ç¬¬ä¸‰æ–¹å ±éŒ¯æ™‚æœƒå°è‡´æ¥­å‹™æ“ä½œçµæœå¤±æ•—ï¼Œè€Œç¬¬ä¸‰æ–¹çš„æ“ä½œæ˜¯ä¸å¯æ§çš„ï¼Œæ‰€ä»¥å…ˆæŠŠå ±éŒ¯çµæœä¿å­˜ä¾¿æ–¼è¿½æº¯ï¼Œä¸”æœ‰æ¥­å‹™éœ€è¦æ™‚ä¹Ÿå¯é€šéå®šæ™‚ä»»å‹™æŸ¥åº«é‡æ–°åŸ·è¡Œæ¥­å‹™</li><li>è©²ä¾‹å­ä¸­åªç”¨äº†ä¸€å€‹æ¶ˆæ¯é…ç½®æ–‡ä»¶ï¼Œå¯¦éš›é–‹ç™¼ä¸­æ¶ˆæ¯é…ç½®éœ€æ ¹æ“šé …ç›®æ‰€éœ€é…ç½®åˆ°å°æ‡‰çš„é …ç›®é…ç½®æ–‡ä»¶ï¼Œå¦‚question-appçš„æ¶ˆæ¯é…ç½®(å¦‚topcã€producerGroup)æ‡‰åœ¨å…¶é …ç›®ä¸­çš„é…ç½®æ–‡ä»¶(å¦‚application.ymlã€apolloçš„namespace)ä¸­é…ç½®</li><li>è©²é …ç›®ä¸­çš„NameServerã€Brokerä¸¦æ²’æœ‰é›†ç¾¤éƒ¨ç½²ï¼ŒBrokeré›†ç¾¤éƒ¨ç½²å¾Œé…ç½®åŒæ­¥é›™å¯«é¿å…ä¸»æ©Ÿå¯«å…¥å¾Œå°šæœªåŒæ­¥åˆ°å¾æ©Ÿå°±å®•æ©Ÿå°è‡´æ¶ˆæ¯ä¸Ÿå¤±çš„æƒ…æ³(æœ‰æ„å‘çš„è‡ªè¡Œç™¾åº¦ï¼šRocketMQ åŒæ­¥é›™å¯«)</li></ol><h1 class=pgc-h-arrow-right>æœ«</h1><p>è©²æ–‡ç« é€šéä¸€å€‹ç°¡å–®çš„é …ç›®ä¾‹å­æ¼”ç¤ºäº†ä½¿ç”¨Spring Boot RocketMQè™•ç†MQå¸¸è¦‹å•é¡Œçš„ä¸€äº›æ–¹å¼ï¼š</p><ul><li>æ¶ˆæ¯é‡è¤‡æ¶ˆè²»å•é¡Œå¯é€šéæ•¸æ“šåº«å­˜å„²ä¾†ä¿è­‰å†ªç­‰æ€§</li><li>è‹¥æ¶ˆæ¯æ¶ˆè²»æ¥­å‹™æ“ä½œå¤±æ•—æ™‚å¯é€šéListeneræ‹‹å‡ºç•°å¸¸è®“RocketMQé‡æ–°æŠ•éæ¶ˆæ¯é€²è¡Œæ¶ˆè²»</li></ul><p>è©²é …ç›®ä¾‹å­å¯é€šéå€‹äººgithub/gitee(github|gitee.com/wilson-he/rocketmq-message-center-demo)æŸ¥çœ‹</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>MQ</a></li><li><a>Spring</a></li><li><a>Boot</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/000afa08.html alt="Spring Boot 2.xåŸºç¤æ•™ç¨‹ï¼šSwaggeræ¥å£åˆ†é¡èˆ‡å„å…ƒç´ æ’åºå•é¡Œè©³è§£" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/daa2cfd29ec34306a4be6f3f257b824b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/000afa08.html title="Spring Boot 2.xåŸºç¤æ•™ç¨‹ï¼šSwaggeræ¥å£åˆ†é¡èˆ‡å„å…ƒç´ æ’åºå•é¡Œè©³è§£">Spring Boot 2.xåŸºç¤æ•™ç¨‹ï¼šSwaggeræ¥å£åˆ†é¡èˆ‡å„å…ƒç´ æ’åºå•é¡Œè©³è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e61e6b6d.html alt="Spring Boot çµ±ä¸€ç•°å¸¸é€™æ¨£è™•ç†å’Œå‰–æï¼Œå®‰å¦ï¼Ÿ" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/95dd8dbd-33ff-4c32-a4b5-fd78e6126995 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e61e6b6d.html title="Spring Boot çµ±ä¸€ç•°å¸¸é€™æ¨£è™•ç†å’Œå‰–æï¼Œå®‰å¦ï¼Ÿ">Spring Boot çµ±ä¸€ç•°å¸¸é€™æ¨£è™•ç†å’Œå‰–æï¼Œå®‰å¦ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/52b013de.html alt="Spring Bootä¸­æ–‡åƒè€ƒæŒ‡å—ï¼ˆ2.1.6ï¼‰90ã€ç†±äº¤æ›" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/52221486045249f1a4a361d34e84016e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/52b013de.html title="Spring Bootä¸­æ–‡åƒè€ƒæŒ‡å—ï¼ˆ2.1.6ï¼‰90ã€ç†±äº¤æ›">Spring Bootä¸­æ–‡åƒè€ƒæŒ‡å—ï¼ˆ2.1.6ï¼‰90ã€ç†±äº¤æ›</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fe46907e.html alt="Spring Bootå¯¦ç¾xmlæ•¸æ“šæ ¼å¼å‚³è¼¸" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/0d7162206c2444189f24fc0f5fcd469e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fe46907e.html title="Spring Bootå¯¦ç¾xmlæ•¸æ“šæ ¼å¼å‚³è¼¸">Spring Bootå¯¦ç¾xmlæ•¸æ“šæ ¼å¼å‚³è¼¸</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4b61684e.html alt="ã€ŒSpring Bootå°ˆé¡Œã€CORSè·¨åŸŸ" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/49f28dea215a4273af5112e80bd79c03 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4b61684e.html title="ã€ŒSpring Bootå°ˆé¡Œã€CORSè·¨åŸŸ">ã€ŒSpring Bootå°ˆé¡Œã€CORSè·¨åŸŸ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d4207bf0.html alt="åŸºæ–¼Spring Bootæ­å»ºæ‡‰ç”¨é–‹ç™¼æ¡†æ¶â€”â€”åŸºç¤æ¶æ§‹" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/afeba6d083bb4e78ada213e1b6cd513c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d4207bf0.html title="åŸºæ–¼Spring Bootæ­å»ºæ‡‰ç”¨é–‹ç™¼æ¡†æ¶â€”â€”åŸºç¤æ¶æ§‹">åŸºæ–¼Spring Bootæ­å»ºæ‡‰ç”¨é–‹ç™¼æ¡†æ¶â€”â€”åŸºç¤æ¶æ§‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d4bf763b.html alt="åŸºç¤ç¯‡ï¼šSpring Bootå…¥é–€é«”é©—ï¼ˆåœ–æ–‡æ•™ç¨‹ï¼‰" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RwsEOXvIHX7bQq style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d4bf763b.html title="åŸºç¤ç¯‡ï¼šSpring Bootå…¥é–€é«”é©—ï¼ˆåœ–æ–‡æ•™ç¨‹ï¼‰">åŸºç¤ç¯‡ï¼šSpring Bootå…¥é–€é«”é©—ï¼ˆåœ–æ–‡æ•™ç¨‹ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4ad16f9.html alt="Spring Boot å…¥é–€ç³»åˆ—ï¼ˆäºŒåäº”ï¼‰è®€å–é…ç½®æ–‡ä»¶çš„ä¸‰ç¨®æ–¹å¼" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4ad16f9.html title="Spring Boot å…¥é–€ç³»åˆ—ï¼ˆäºŒåäº”ï¼‰è®€å–é…ç½®æ–‡ä»¶çš„ä¸‰ç¨®æ–¹å¼">Spring Boot å…¥é–€ç³»åˆ—ï¼ˆäºŒåäº”ï¼‰è®€å–é…ç½®æ–‡ä»¶çš„ä¸‰ç¨®æ–¹å¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3312eb6.html alt="Spring Boot åœ¨å•Ÿå‹•æ™‚é€²è¡Œé…ç½®æ–‡ä»¶åŠ è§£å¯†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/677858a9ea4e455e840b8fb8dc7656b9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3312eb6.html title="Spring Boot åœ¨å•Ÿå‹•æ™‚é€²è¡Œé…ç½®æ–‡ä»¶åŠ è§£å¯†">Spring Boot åœ¨å•Ÿå‹•æ™‚é€²è¡Œé…ç½®æ–‡ä»¶åŠ è§£å¯†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/07c6935.html alt="Spring Booté…ç½®æ–‡ä»¶ymlæ ¼å¼è©³è§£" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/c60ba743367141da8cddac4cb8bd7412 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/07c6935.html title="Spring Booté…ç½®æ–‡ä»¶ymlæ ¼å¼è©³è§£">Spring Booté…ç½®æ–‡ä»¶ymlæ ¼å¼è©³è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3ff10d3.html alt="Spring Boot ç•°æ­¥è«‹æ±‚å’Œç•°æ­¥èª¿ç”¨ï¼Œä¸€æ–‡æå®š" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3c824262b5b0401cbf72463bf246c13b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3ff10d3.html title="Spring Boot ç•°æ­¥è«‹æ±‚å’Œç•°æ­¥èª¿ç”¨ï¼Œä¸€æ–‡æå®š">Spring Boot ç•°æ­¥è«‹æ±‚å’Œç•°æ­¥èª¿ç”¨ï¼Œä¸€æ–‡æå®š</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b748ad6.html alt="ä½¿ç”¨Spring Bootçš„äº‹ä»¶å’Œäº‹å‹™ï¼Œå®¹æ˜“è¢«å¿½è¦–çš„é»ï¼Œä½ æœ‰è¸©éå—ï¼Ÿ" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ae11deaa7ce44232a1fa67b224125bb2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b748ad6.html title="ä½¿ç”¨Spring Bootçš„äº‹ä»¶å’Œäº‹å‹™ï¼Œå®¹æ˜“è¢«å¿½è¦–çš„é»ï¼Œä½ æœ‰è¸©éå—ï¼Ÿ">ä½¿ç”¨Spring Bootçš„äº‹ä»¶å’Œäº‹å‹™ï¼Œå®¹æ˜“è¢«å¿½è¦–çš„é»ï¼Œä½ æœ‰è¸©éå—ï¼Ÿ</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/cd142eb.html alt="Spring Bootå…¥é–€ç³»åˆ—ï¼ˆåä¸‰ï¼‰å¦‚ä½•å¯¦ç¾äº‹å‹™ï¼Œæ¥µç°¡ç‰ˆï¼" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p3.pstatp.com/large/pgc-image/15d70cf19e1c4967afc5d49a10def1ce style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/cd142eb.html title="Spring Bootå…¥é–€ç³»åˆ—ï¼ˆåä¸‰ï¼‰å¦‚ä½•å¯¦ç¾äº‹å‹™ï¼Œæ¥µç°¡ç‰ˆï¼">Spring Bootå…¥é–€ç³»åˆ—ï¼ˆåä¸‰ï¼‰å¦‚ä½•å¯¦ç¾äº‹å‹™ï¼Œæ¥µç°¡ç‰ˆï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6cfd4e0e.html alt="Spring æ ¸å¿ƒçŸ¥è­˜è¬›è§£ï¼Œå¤ªç°¡å–®å•¦" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6cfd4e0e.html title="Spring æ ¸å¿ƒçŸ¥è­˜è¬›è§£ï¼Œå¤ªç°¡å–®å•¦">Spring æ ¸å¿ƒçŸ¥è­˜è¬›è§£ï¼Œå¤ªç°¡å–®å•¦</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/090306a0.html alt="[Spring] æ·±å…¥ç­è§£äº‹å‹™åŸç†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/a8c6dbd7c51741f5a76262e8e2c7a670 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/090306a0.html title="[Spring] æ·±å…¥ç­è§£äº‹å‹™åŸç†">[Spring] æ·±å…¥ç­è§£äº‹å‹™åŸç†</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>