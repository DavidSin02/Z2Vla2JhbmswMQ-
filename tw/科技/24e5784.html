<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>每日算法LeetCode629：K個逆序對數組（難度係數3/5） | 极客快訊</title><meta property="og:title" content="每日算法LeetCode629：K個逆序對數組（難度係數3/5） - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/fb47c286e5244183b4c67e109b306c0a"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/24e5784.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/24e5784.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/24e5784.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/24e5784.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/24e5784.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/24e5784.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/24e5784.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/24e5784.html><meta property="article:published_time" content="2020-10-29T20:52:58+08:00"><meta property="article:modified_time" content="2020-10-29T20:52:58+08:00"><meta name=Keywords content><meta name=description content="每日算法LeetCode629：K個逆序對數組（難度係數3/5）"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/24e5784.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>每日算法LeetCode629：K個逆序對數組（難度係數3/5）</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><pre>導讀：算法哥今天繼續開啟leetcode hard模式，今天給大家準備了一道有趣的數學題，希望今天的分享會讓大家對動態規劃耳目一新。</pre><hr><h1>題目描述：</h1><p>給出兩個整數 n 和 k，找出所有包含從 1 到 n 的數字的排列，且恰好擁有 k 個逆序對的不同的數組的個數。</p><p>逆序對的定義如下：對於數組的第i個和第 j個元素，如果滿i &lt; j且 a[i] > a[j]，則其為一個逆序對；否則不是。</p><p>由於答案可能很大，只需要返回 答案 mod 10^9 + 7 的值。</p><p><strong>示例 1:</strong></p><pre>輸入: n = 3, k = 0輸出: 1解釋: 只有數組 [1,2,3] 包含了從1到3的整數並且正好擁有 0 個逆序對。</pre><p><strong>示例 2:</strong></p><pre>輸入: n = 3, k = 1輸出: 2解釋: 數組 [1,3,2] 和 [2,1,3] 都有 1 個逆序對。</pre><p><strong>說明:</strong></p><ol><li>n 的範圍是 [1, 1000] 並且 k 的範圍是 [0, 1000]。</li></ol><hr><h1>題目分析：</h1><p>咋一看，這題目不是個排列組合的數學題嗎？沒錯，還真是！可是今天算法哥要分享一個利用動態規劃的思想來解決這道題目的方法。啥？這也能動態規劃！！！</p><hr><p>要動態規劃，就必須設計好狀態轉移的方程式，首先我們<strong>定義一個二維數組f[i][j]表示用[1,2,3...i]這i個整數排列後有j個逆序對的數量。</strong>為啥要這麼定義呢？繼續往下看！</p><hr><p>定義好f[i][j]的狀態後，我們就得思考怎麼進行狀態轉移，<strong>假設你現在知道f[i - 1][j]了，也就是說你知道了用[1,2,3...i-1]前i - 1個數排列後有j個逆序對的數量是f[i-1][j]，此時，把整數i，直接放到前面用i-1個數排列後有j個逆序對的數組末尾，此時是不是還是j個逆序對，因為i是最大的，它放在最後，不會產生新的逆序對！這是不是就得到了用[1,2,3...i]前i個整數排列產生j個逆序對的一種方式？</strong>舉個例子！</p><hr><p>f[3][1]=2，因為用[1,2,3]組成1個逆序對的排列有兩種，[1,3,2]，[2,1,3]，現在我們在這兩個排列的末尾都補上4，變成[1,3,2,4]，[2,1,3,4]，此時每個排列的逆序對還是1，因為添加的4是最大的，不會產生新的逆序對，此時是不是推導出了f[4][1]裡的一種情形？那f[4][1]還有其他情形嗎？肯定有，比如4不在排列的末尾！</p><div class=pgc-img><img alt=每日算法LeetCode629：K個逆序對數組（難度係數3/5） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fb47c286e5244183b4c67e109b306c0a><p class=pgc-img-caption>f[3][1]推導f[4][1]</p></div><hr><p>f[3][0]=1，因為用[1,2,3]組成0個逆序對的排列只有一種，[1,2,3]，現在要推導出f[4][1]，怎麼推導？直接把4放到2和3的中間，變成[1,2,4,3]是不是就推導出了f[4][1]的又一種情形？</p><div class=pgc-img><img alt=每日算法LeetCode629：K個逆序對數組（難度係數3/5） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/71ad79b888a04003b2197f34cf16b7b0><p class=pgc-img-caption>f[3][0]推導f[4][1]</p></div><hr><p>那還有其他情形嗎？沒有了！聰明的讀者發現規律了嗎？</p><pre>f[4][1] = f[3][1] + f[3][0]同理，我們有：f[4][4] = f[3][4] + f[3][3] + f[3][2] + f[3][1] 為什麼這裡不加f[3][0] ?因為f[3][0]對應排列[1,2,3]此時把4插入到頭部變成[4,1,2,3]逆序對也只有3個，不滿足4個的要求！</pre><p>我們再抽象一點：</p><pre>f[i][j] = f[i-1][j] + f[i-1][j-1] + f[i-1][j-2]+......+f[i-1][0]，(i-1 &gt;= j)</pre><hr><pre>f[i][j] = f[i-1][j] + f[i-1][j-1] + f[i-1][j-2]+......+f[i-1][j-(i - 1)]，(i - 1 &lt; j)</pre><p>兩個推導式合併</p><pre>f[i][j] = f[i-1][j] + f[i-1][j-1] + f[i-1][j-2]+......+f[i-1][max(0, j-(i - 1))]</pre><hr><p>到這裡就結束了嗎？如果忽略時間複雜度，確實可以結束了，因為f[i][j]可以轉化成規模更小的f[i - 1][j],f[i - 1][j -1]...來推導，這正好是動態規劃的思路，但是這麼做的複雜度是O(n*k^2)的，怎麼推導的請讀者自己思考。下面將給出算法哥優化好的一個解法！</p><p>前面的推導式，我們把j用j+1替代！</p><pre>f[i][j+1] = f[i-1][j+1] + f[i-1][j] + f[i-1][j-1]+......+f[i-1][max(0, j+1-(i - 1))]</pre><hr><p>我們用後一個推導式減去前一個推導式得到：</p><pre>f[i][j+1] = f[i-1][j+1] + f[i][j] - (i - 1&lt;= j ? 1:0) * f[i-1][max(0, j + 1-(i - 1))]</pre><hr><p>把j + 1，用j替換得到：</p><pre>f[i][j] = f[i-1][j] + f[i][j-1] - (i &lt;= j ? 1:0) * f[i-1][max(0, j - i)] </pre><hr><p>到這裡，最關鍵的狀態轉移方程終於出來了！</p><p>直接上源碼：</p><div class=pgc-img><img alt=每日算法LeetCode629：K個逆序對數組（難度係數3/5） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4653451cd1f44425a89fcfc0205503cf><p class=pgc-img-caption>O(nk)</p></div><hr><h1>複雜度分析：</h1><p>f[i][j]裡，i&lt;=1000, j&lt;=1000，結合代碼看兩層循環嵌套，所以複雜度是O(nk)的！輕鬆擊敗leetcode上98%的提交！</p><hr><h1>題目總結：</h1><p>這個題目有幾個難點：</p><ol><li>用前i - 1個數的逆序對去推導前i個數的逆序對，發現這個規律是解決問題的關鍵；</li><li>發現規律後，將推導式做出進一步推導，得到一個簡化的狀態轉移方程；</li><li>聰明的讀者肯定發現算法哥的代碼裡數組只開了2維，因為每次推導的過程中只有當前這一個維度的數組，和前一個維度的數組在使用，所以可以用<strong>滾動數組</strong>的技巧來優化空間原先需要n維的數組變成來2維，這麼做既減少空間，時間上也會有提升（因為數組小了，cpu cache命中率提高了）！</li></ol><p>堅持到這裡，相信你肯定收穫滿滿的，那就趕緊關注，轉發，點贊吧！讓算法哥有激情繼續分享下去！</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>LeetCode629</a></li><li><a>逆序</a></li><li><a>數組</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/1b1296a.html alt=算法系列之-數組中的逆序對 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/774d959ee85a4570af716135a84fb472 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1b1296a.html title=算法系列之-數組中的逆序對>算法系列之-數組中的逆序對</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0b1d824.html alt=？？？數組中的逆序對（歸併排序思想） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/682efe151ca8402b9f8ee2ac0c95286f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0b1d824.html title=？？？數組中的逆序對（歸併排序思想）>？？？數組中的逆序對（歸併排序思想）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b5bd339f.html alt=數組基礎知識：100萬成員的數組取第一和最後一個有性能差距嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/dfc9869dbc274741b7ff68e0877cb33a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b5bd339f.html title=數組基礎知識：100萬成員的數組取第一和最後一個有性能差距嗎？>數組基礎知識：100萬成員的數組取第一和最後一個有性能差距嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b70a874f.html alt=C語言學習|指針和數組之間的關係 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/b4a86e58580942dfaf343a6b9b31f5cf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b70a874f.html title=C語言學習|指針和數組之間的關係>C語言學習|指針和數組之間的關係</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7f25f9e9.html alt=指針數組和數組指針 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3ffcb33cd0214a1aac0da75a0b9feee1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7f25f9e9.html title=指針數組和數組指針>指針數組和數組指針</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/500b25d2.html alt="第四章: 數組" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/c82f2b85-5aa7-44d0-85c2-a69f88ee668e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/500b25d2.html title="第四章: 數組">第四章: 數組</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/70e5706e.html alt=人工智能基礎向量、矩陣和數組 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/70e5706e.html title=人工智能基礎向量、矩陣和數組>人工智能基礎向量、矩陣和數組</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5daf79b.html alt="JavaScript 中搜索數組元素的四種方法" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/78046c20-d1aa-4ef5-b321-37209b8b9e5d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5daf79b.html title="JavaScript 中搜索數組元素的四種方法">JavaScript 中搜索數組元素的四種方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f6701da.html alt=Java判斷元素是否在數組中的方法彙總，常用操作，建議收藏 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1528345105695912143d6ab style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f6701da.html title=Java判斷元素是否在數組中的方法彙總，常用操作，建議收藏>Java判斷元素是否在數組中的方法彙總，常用操作，建議收藏</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2bc0552.html alt=在Java中如何高效判斷數組中是否包含某個元素 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/8d3d28f57280495380c13ef8419c11ab style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2bc0552.html title=在Java中如何高效判斷數組中是否包含某個元素>在Java中如何高效判斷數組中是否包含某個元素</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/85bbd88.html alt=在JSON中使用數組，讓您的JSON無限擴展 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/cc13f08b-b57e-483f-adb8-8d2ba9a32f45 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/85bbd88.html title=在JSON中使用數組，讓您的JSON無限擴展>在JSON中使用數組，讓您的JSON無限擴展</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/03886d2.html alt=面試題-數組、鏈表實現棧 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f8949fd55a4149feb3b5ab31b631c77f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/03886d2.html title=面試題-數組、鏈表實現棧>面試題-數組、鏈表實現棧</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c15e1ed.html alt=挑戰！一個數組和一個數值，在數組中找出兩個數的和等於這個數值 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/d7fd845319fd4fb4aee87f513f85d9d9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c15e1ed.html title=挑戰！一個數組和一個數值，在數組中找出兩個數的和等於這個數值>挑戰！一個數組和一個數值，在數組中找出兩個數的和等於這個數值</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f699966.html alt="Excel 數組公式頂級絕密 Excel Array formula top secret" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3d9cce8af9084c1c9cc9cac20895df17 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f699966.html title="Excel 數組公式頂級絕密 Excel Array formula top secret">Excel 數組公式頂級絕密 Excel Array formula top secret</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/60159ad.html alt=c++數組指針、二維動態數組及二維指針、動態指針數組及函數參數 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/60159ad.html title=c++數組指針、二維動態數組及二維指針、動態指針數組及函數參數>c++數組指針、二維動態數組及二維指針、動態指針數組及函數參數</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>