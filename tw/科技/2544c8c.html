<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>詳解PG三大配置文件-postgresql.conf,pg_hba.conf,pg_ident.conf | 极客快訊</title><meta property="og:title" content="詳解PG三大配置文件-postgresql.conf,pg_hba.conf,pg_ident.conf - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/59a9cd8cdac34a30a6fde42ac24222d0"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2544c8c.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2544c8c.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/2544c8c.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2544c8c.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2544c8c.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/2544c8c.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/2544c8c.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2544c8c.html><meta property="article:published_time" content="2020-10-29T20:59:53+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:53+08:00"><meta name=Keywords content><meta name=description content="詳解PG三大配置文件-postgresql.conf,pg_hba.conf,pg_ident.conf"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/2544c8c.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>詳解PG三大配置文件-postgresql.conf,pg_hba.conf,pg_ident.conf</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1><strong>概述</strong></h1><p>今天主要介紹PG的三大配置文件，下面一起來看看吧！</p><hr><h1><strong>一、pg_settings</strong></h1><blockquote><p>The view pg_settings provides access to run-time parameters of the server. It is essentially an alternative interface to the SHOW and SET commands. It also provides access to some facts about each parameter that are not directly available from SHOW, such as minimum and maximum values.</p></blockquote><div class=pgc-img><img alt=詳解PG三大配置文件-postgresql.conf,pg_hba.conf,pg_ident.conf onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/59a9cd8cdac34a30a6fde42ac24222d0><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=詳解PG三大配置文件-postgresql.conf,pg_hba.conf,pg_ident.conf onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/443734cec65d4872852c1fe5c29926fc><p class=pgc-img-caption></p></div><p>PostgreSQL的配置文件主要有如下3個(postgresql.conf,pg_hba.conf,pg_ident.conf)</p><pre> select name, setting,source from pg_settings where category='File Locations' ;</pre><div class=pgc-img><img alt=詳解PG三大配置文件-postgresql.conf,pg_hba.conf,pg_ident.conf onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0c1e6806c743494cb81c802167587087><p class=pgc-img-caption></p></div><hr><h1><strong>二、postgresql.conf（數據庫相關配置）</strong></h1><p><strong><br></strong>該文件包含一些通用設置，比如內存分配，新建database的默認存儲位置，PostgreSQL服務器的IP地址，日誌的位置以及許多其他設置。</p><pre> select name, context, unit, setting, boot_val, reset_val from pg_settings where name in ('listen_address','max_connetctons','shared_buffers','effective_cache_size','work_mem','maintenance_work_mem') order by context, name;​</pre><div class=pgc-img><img alt=詳解PG三大配置文件-postgresql.conf,pg_hba.conf,pg_ident.conf onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b9cba8ce0472478e8c62f850e2e50c07><p class=pgc-img-caption></p></div><p>說明：context 設置為postmaster，更改此形參後需要重啟PostgreSQL服務才能生效；設置為user，那麼只需要執行一次重新加載即可全局生效。重啟數據庫服務會終止活動連接，但重新加載不會。</p><p>unit 字段表示這些設置的單位;<br>setting是指當前設置；</p><p>boot_val是指默認設置；</p><p>reset_val是指重新啟動服務器或重新加載設置之後的新設置;<br>在postgresql.conf中修改了設置後，一定記得查看一下setting和reset_val並確保二者是一致，否則說明設置並未生效，需要重新啟動服務器或者重新加載設置</p><hr><h1><strong>三、pg_hba.conf（客戶端認證配置文件）</strong></h1><p>pg_hba.conf為PostgreSQL的訪問策略配置文件，默認位於/var/lib/pgsql/10/data/目錄（PostgreSQL10）。</p><p>該配置文件有5個參數，分別為：TYPE（主機類型）、DATABASE（數據庫名）、USER（用戶名）、ADDRESS（IP地址和掩碼）、METHOD（加密方法）</p><p><strong>1、TYPE，有4個值</strong></p><pre>local：使用Unix-domainsockethost：使用TCP/IP連接，可以是SSL的，也可以不是hostssl：必須是SSL的hostnossl：必須是非SSL的</pre><div class=pgc-img><img alt=詳解PG三大配置文件-postgresql.conf,pg_hba.conf,pg_ident.conf onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ef4ef44e4c5448818e19a7ded99bde82><p class=pgc-img-caption></p></div><p><strong>2、DATABASE：</strong></p><p>數據庫名，可以是"all", "sameuser", "samerole", "replication"。all表示所有，但不包括replication。多個數據庫用“,”隔開。</p><div class=pgc-img><img alt=詳解PG三大配置文件-postgresql.conf,pg_hba.conf,pg_ident.conf onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1aef388e67274aa39e085486833afc41><p class=pgc-img-caption></p></div><p><strong>3、USER：</strong></p><p>用戶名，可以為"all"，表示所有，也可以具體指定一個用戶。多個用戶用“,”隔開。和DATABASE一樣，也可以將配置放到文件中，文件名加上前綴@</p><div class=pgc-img><img alt=詳解PG三大配置文件-postgresql.conf,pg_hba.conf,pg_ident.conf onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/140af137eaf749a7bfb0bed4c6e59480><p class=pgc-img-caption></p></div><p><strong>4、ADDRESS：</strong></p><p>可以是為一個主機名，或者由IP地址和CIDR掩碼組成。掩碼可以為0-32（IPv4）或者0-128（IPv6）間的一個整數，32表示子網掩碼為255.255.255.255，24表示子網掩碼為255.255.255.0。主機名以“.”開頭。samehost可以匹配所有主機、samenet可以匹配同一個掩碼內的所有主機。</p><p>例：192.168.10.122/32表示單一主機，192.168.10.0/24表示192.168.0.1~192.168.0.255網段內所有主機，0.0.0.0/0表示所有主機。</p><div class=pgc-img><img alt=詳解PG三大配置文件-postgresql.conf,pg_hba.conf,pg_ident.conf onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2ad34296a754439ca47e5c6b43978261><p class=pgc-img-caption></p></div><p>5、METHOD：</p><p>密碼加密策略，password表示以明文方式發送密碼，md5和scram-sha-256會以對應的方式加密再發送密碼。</p><div class=pgc-img><img alt=詳解PG三大配置文件-postgresql.conf,pg_hba.conf,pg_ident.conf onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/71e79e0afe894dbcbbd92a79bbe6fa98><p class=pgc-img-caption></p></div><hr><h1><strong>四、pg_ident.conf（用戶映射文件）</strong></h1><p>前面pg_hba.conf講到ident認證方式，需要建立映射用戶或具備同名用戶。</p><p>同名用戶好辦，各新建一個同名的操作系統用戶和數據庫用戶，兩個用戶密碼不必相同，但名字必須相同。用該用戶登錄到操作系統或su到該用戶後，即可$ psql dbname。</p><p>如果不想新建同名用戶，也可以配置pg_ident.conf文件。pg_ident.conf用來配置哪些操作系統用戶可以映射為數據庫用戶。</p><p>pg_ident.conf的格式如下：</p><pre># MAPNAME SYSTEM-USERNAME PG-USERNAMEusermap username dbuser</pre><p>usermap為映射名，要在pg_hba.conf中用到，多個映射可以共用同一個映射名，username為操作系統用戶名，dbuser為映射到的數據庫用戶。<br>比如，服務器上有名為user1的操作系統用戶，同時數據庫上也有同名的數據庫用戶，user1登錄操作系統後可以直接輸入psql，以user1數據庫用戶身份登錄數據庫且不需密碼。<br>很多初學者都會遇到psql -U username登錄數據庫卻出現“username ident 認證失敗”的錯誤，明明數據庫用戶已經createuser。<br>原因就在於此，使用了ident認證方式，卻沒有同名的操作系統用戶或沒有相應的映射用戶。<br>解決方案：</p><pre>1)、在pg_ident.conf中添加映射用戶；</pre><pre>2)、改變認證方式。</pre><p>CentOS7安裝了PostgreSQL10和pgadmin4後,pgadmin4始終登陸數據庫提示用戶認證失敗,<br>就是因為Linux下PostgreSQL默認的local認證方式是ident,而pg_ident.conf用戶映射文件裡並沒有任何映射用戶,所以可以修改認證方式為md5,即可使用密碼成功登陸了.</p><hr><p>覺得有用的朋友多幫忙轉發哦！後面會分享更多devops和DBA方面的內容，感興趣的朋友可以關注下~</p><div class=pgc-img><img alt=詳解PG三大配置文件-postgresql.conf,pg_hba.conf,pg_ident.conf onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/48d332a03a0d4647bb171eadd37a5848><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>conf</a></li><li><a>pg</a></li><li><a>配置文件</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/6d3adf54.html alt=Win10系統如何刪除用戶配置文件？這個方法麻煩收好 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/5d9b3c531d8e4d64ac1f5582c2a6867e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6d3adf54.html title=Win10系統如何刪除用戶配置文件？這個方法麻煩收好>Win10系統如何刪除用戶配置文件？這個方法麻煩收好</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b54ce2e1.html alt="Windows 10 KB4549951補丁讓用戶配置文件缺失故障再次發生" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/Ry0yIZwBOBWLcl style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b54ce2e1.html title="Windows 10 KB4549951補丁讓用戶配置文件缺失故障再次發生">Windows 10 KB4549951補丁讓用戶配置文件缺失故障再次發生</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e5f86559.html alt="外媒發現Windows 10用戶配置文件丟失問題仍舊存在" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RxyuIVJ8HFwmLA style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e5f86559.html title="外媒發現Windows 10用戶配置文件丟失問題仍舊存在">外媒發現Windows 10用戶配置文件丟失問題仍舊存在</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/2b589c02.html alt=Bash技巧：介紹一個可以增刪改查鍵值對格式配置文件的Shell腳本 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/f522c649-8101-4a62-bfaf-f037729d4234 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/2b589c02.html title=Bash技巧：介紹一個可以增刪改查鍵值對格式配置文件的Shell腳本>Bash技巧：介紹一個可以增刪改查鍵值對格式配置文件的Shell腳本</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a790603.html alt="16-第二節 nginx配置文件簡述" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d238c5f67e394a75b6a5a2057fe77f8c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a790603.html title="16-第二節 nginx配置文件簡述">16-第二節 nginx配置文件簡述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c778570.html alt=Elasticsearch集群配置文件elasticsearch.yml詳解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5389bebf2485498da2d2695eb8d1cc15 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c778570.html title=Elasticsearch集群配置文件elasticsearch.yml詳解>Elasticsearch集群配置文件elasticsearch.yml詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e93c690.html alt="Golang入門系列(九) 幾種常用配置文件的使用（json，yaml，ini）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e93c690.html title="Golang入門系列(九) 幾種常用配置文件的使用（json，yaml，ini）">Golang入門系列(九) 幾種常用配置文件的使用（json，yaml，ini）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b1c0e33.html alt=Go之配置文件 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9a41b2ed6b414871b9f42059c8e3f4ec style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b1c0e33.html title=Go之配置文件>Go之配置文件</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/88838ef.html alt="Go語言 - 配置文件操作" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/570b4ebe5dd74145a991aeaabbd63232 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/88838ef.html title="Go語言 - 配置文件操作">Go語言 - 配置文件操作</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2b1e06c.html alt=Java怎麼從這四個位置讀取配置文件：文件系統-classpath-jar-URL class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2b1e06c.html title=Java怎麼從這四個位置讀取配置文件：文件系統-classpath-jar-URL>Java怎麼從這四個位置讀取配置文件：文件系統-classpath-jar-URL</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3373f6a.html alt="Kubernetes 對象入門-Deployment配置文件詳解" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/340aa6535c924784b28635c13d28ac7a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3373f6a.html title="Kubernetes 對象入門-Deployment配置文件詳解">Kubernetes 對象入門-Deployment配置文件詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b92d7a5.html alt=Linux入門-用戶配置文件 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/ca118568-0614-46ec-a131-e90077694023 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b92d7a5.html title=Linux入門-用戶配置文件>Linux入門-用戶配置文件</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3b4c1e7.html alt=MyBatis全局配置文件 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/2101b5aa85494f17ac1229e54e9f6fc8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3b4c1e7.html title=MyBatis全局配置文件>MyBatis全局配置文件</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4e23d94.html alt=Nginx簡介及配置文件詳解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/153570866559467f5003722 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4e23d94.html title=Nginx簡介及配置文件詳解>Nginx簡介及配置文件詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/800e33b.html alt=Pro/E配置文件技巧及說明、常規配置 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b3c401f98b48484b9355b1dee2248cd9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/800e33b.html title=Pro/E配置文件技巧及說明、常規配置>Pro/E配置文件技巧及說明、常規配置</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>