<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>9000字，通俗易懂的講解下Java註解 | 极客快訊</title><meta property="og:title" content="9000字，通俗易懂的講解下Java註解 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/392702e759b44da9994c126e8747d23c"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/26711ae.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/26711ae.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/26711ae.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/26711ae.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/26711ae.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/26711ae.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/26711ae.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/26711ae.html><meta property="article:published_time" content="2020-10-29T20:52:06+08:00"><meta property="article:modified_time" content="2020-10-29T20:52:06+08:00"><meta name=Keywords content><meta name=description content="9000字，通俗易懂的講解下Java註解"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/26711ae.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>9000字，通俗易懂的講解下Java註解</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>對於Java註解，我諮詢過一些身邊的人，很多人表示：</p><blockquote><p>知道怎麼用，不熟悉</p></blockquote><p style=text-align:start>不知道你是不是這樣？在我沒有系統性的學習一邊註解的時候，我也是如此，在我花時間學習過註解之後，我覺得，對於註解，最重要的在於理解，很多人也看過不少關於註解的文章，可是過不了多久就會忘記，關於遺忘，這不是個問題，只能說是正常現象。</p><p style=text-align:start>但是對於一個知識點，你理解的越透徹也就越不容易忘記，所以今天我準備通俗易懂的和大家聊聊Java註解，爭取讓大家有自己的理解，儘量記住這個重要的知識點！</p><h1 class=pgc-h-arrow-right>什麼是註解？</h1><p style=text-align:start>我們學習註解的第一步，首先就是先從最基本的開始，看看註解到底是什麼？</p><blockquote><p>註解和反射是Java中非常讓人容易忽略的東西，但卻很重要，在主流的Spring中更是充滿了註解，註解和註釋很像，兩者其實本質就差不多，註釋是給我們程序員看的，而註解呢其實就是給程序看的(關於反射，下一篇咱就開講)</p></blockquote><p style=text-align:start>上面所說希望你著重注意以下兩點：</p><p style=text-align:start>1、註解和註釋很像2、註釋是給我們程序員看的，而註解呢其實就是給程序看的</p><p style=text-align:start>我們初步理解註解就從上面兩點開始，我們先看註釋，比如這樣：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/392702e759b44da9994c126e8747d23c><p class=pgc-img-caption></p></div><p style=text-align:start>這就是一個註釋，那麼註釋有什麼用呢？簡單來說就是對相關的類或者方法加以說明，比如這裡的Test類，上面的註釋大致告訴我們這類是誰編寫的，做什麼的以及何時編寫的這些信息，當然，信息其實還可以有更多。</p><p style=text-align:start>所以，你要明白，註釋是幹嘛的，是給我們這些程序員看的，看到註釋我們就明白了，哦，這個類原來是這樣的……</p><p style=text-align:start>註釋是給程序員看的，那麼註解呢？相差一個字，註解是給程序看的，先記住即可。</p><h1 class=pgc-h-arrow-right>進一步理解註解</h1><p style=text-align:start>上面我們說了，註解和註釋是很像的，註釋是給我們人看的，註解就是給程序看的，前面的好理解，這個註解是給程序看的，你或許還有一點懵，我進一步解釋下。</p><p style=text-align:start>首先，直觀感覺下什麼是註解，比如我們在代碼中寫的這個：</p><pre><code>/** * @Description 用戶類 * @Author ithuangqing * @Date 2020-07-31 15:33 **/@Repositorypublic class UserBean {    private String name;    private int age;}12345678910</code></pre><p style=text-align:start>這裡的@Repository就是一個註解，看這段代碼，上面還有註釋，我們看到註釋，發現都看得明白，但是看到@Repository之後，就不那麼明白，這是啥，有啥用？</p><p style=text-align:start>於是我們查，大概知道，哦，這是個註解，有了這個註解，UserBean就會被裝載進Spring容器中，我們可以知道這些信息，但是，它實際上做了哪些事情，是如何起作用，也就是如何把UserBean交給Spring去處理的，這個內部實現，我們不清楚。</p><p style=text-align:start>但是，我們雖然不清楚，有個東西它清楚，什麼呢？就是一個特定的程序，也就是說，有一個專門的程序，當它看到這個UserBean上面有一個@Repository之後，這個程序就知道了，原來要把這個UserBean裝載進Spring容器中，於是這個程序員就開始執行一系列的操作區把這個UserBean裝載進Spring容器中。</p><p style=text-align:start>所以，你到此應該明白：</p><blockquote><p>註釋是給人看到的，註解是給程序看的。</p></blockquote><p style=text-align:start>我們再進一步總結下什麼是註解：</p><blockquote><p>在程序中，可以把註解看成一種特殊的標記，一般是用來標記類，方法或者接口等，這些標記有一些特點，比如可以在編譯的時候，（javac命令把java源文件編譯成字節碼文件class），類加載和運行的時候（使用java命令執行字節碼文件的時候，類的生命週期開始，從加載到卸載）被讀取到（一般是有專門的程序去讀區這些註解，利用反射技術去解析註解，然後根據得到的信息做相應的處理）</p></blockquote><p style=text-align:start>是的，關於註解，你要知道這麼一個知識點了：</p><blockquote><p>對於註解，是有專門的程序去讀取它，解析它，然後根據得到的消息去執行相應的操作。</p></blockquote><p style=text-align:start>關於這個程序，要看具體的場景，也就是說這個程序是不同的，那麼關於這個程序怎麼知道讀到哪個註解該幹嘛，這個還是依靠註解本身的定義，比如@Repository註解被定義成是把被註解的裝載進Spring容器中，那麼特有的程序獲取到這個註解就知道該幹什麼事了。</p><p style=text-align:start>到此，你應該知道什麼是註解了，當然，是概念上的一些東西，另外，對註解是怎麼起作用的，你也應該有點內味了……</p><h1 class=pgc-h-arrow-right>註解的簡單分類</h1><p style=text-align:start>這個知識點很是輕鬆愉快，不需要你失去多少腦細胞。</p><p style=text-align:start>註解是有分類的，一般有三種類型的註解：</p><ol start=1><li>自定義註解（實際很少）</li><li>JDK內置註解（@Override檢驗方法重寫）</li><li>框架中的註解</li></ol><p style=text-align:start>不知道這個能不能理解，就是說，對於註解而言，是有幾種不同分類的，首先，我們可以自己寫一個注解出來（下面會講），另外對於JDK本身而言有自己的的註解，我們看個代碼，你就知道了：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/db49dacfe4f2496db497b27accd15b91><p class=pgc-img-caption></p></div><p style=text-align:start>比如這個，是重寫toString方法，上面就有個JDK的內置註解@Override，這個註解就起到一個檢驗的作用，因為它是Object的方法，你現在要重寫它，那麼名字啊，參數啊要和之前的一樣，不一樣，就給你報錯，不信你試試：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5d7031ee586e49539f27d776c6bcd762><p class=pgc-img-caption></p></div><p style=text-align:start>這個是關於JDK的內置註解，那麼最後一個關於框架的註解，我想你只要學過Spring都知道，比如@Controller，熟悉吧，這就是框架中的註解。</p><h1 class=pgc-h-arrow-right>註解的本質</h1><p style=text-align:start>經過上面的講解，我們應該大致瞭解了什麼是註解，以及註解的一些分類，現在，我們對於概念上的註解算是清楚了，但是這個註解本質是個什麼呢？</p><p style=text-align:start>告訴你吧，註解的本質是個接口，為啥，先來看下，如何定義一個註解（下面會詳細講解）</p><pre><code>public @interface Main {}12</code></pre><p style=text-align:start>就這些，就定義了一個註解，不知道你發現了沒，這個和接口很像啊，有啥區別，就是多了一個@，不然就是接口啊，接下來我們使用XJad把這個註解反編譯一下看看：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/038f7780f2fe4fb9a1d24e8cee355dac><p class=pgc-img-caption></p></div><p style=text-align:start>看到沒，這裡的Main直接就是interface定義，然後還繼承了Annotation，這個足以說明，註解其實就是接口啊。</p><p style=text-align:start>這個暫且聊到這，記住即可！</p><h1 class=pgc-h-arrow-right>如何定義註解</h1><p style=text-align:start>接下來我們就來聊聊如何去自定義一個註解，我們在上面說過，註解的本質其實就是接口，上面也簡單演示了一個註解的定義，如下：</p><pre><code>public @interface Main {}12</code></pre><p style=text-align:start>想一下，我們平常怎麼定義一個接口，是不是使用關鍵字interface，那麼類呢？是不是使用class關鍵字，也就是說啊，定義這些一般都是需要一個關鍵字來加以聲明的，顯而易見，定義註解的關鍵字就是@interface，它和接口的定義就是多了一個@，但是註解的定義卻不僅僅是如此！</p><h1 class=pgc-h-arrow-right>元註解</h1><p style=text-align:start>這裡要引入一個元註解的概念，我們先來想一下，註解我們上面說了，一般可以用來標記類，接口或者方法等，那麼這裡就有一個問題了，比如我定義了這麼一個Main註解：</p><pre><code>public @interface Main {}12</code></pre><p style=text-align:start>那麼，我這個註解是不是可以用在類上，也可以用在接口或者方法上？一般類呀，接口啊，方法啊等等它們還是有點差別的，所以對於這些最好有區分，也就是說，有些註解只能標記類，有些註解只能標記方法等，這樣一來就需要對註解的作用域去進行限制。</p><p style=text-align:start>那麼這個該怎麼搞，答案就是元註解，那什麼是元註解呢？</p><blockquote><p>元註解就是標記註解的註解</p></blockquote><p style=text-align:start>啥意思，來看下，比如我們定義的這個Main註解，我們規定它只能用來標記方法，那麼可以這樣做：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c239ae25caec4be6b7201b10dad0f25f><p class=pgc-img-caption></p></div><p style=text-align:start>我們在上面加了一個註解@Target，後面還有參數（下面會講），這個參數ElementType.METHOD就代表我們這個註解是用於註解方法的，來，試一下：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ea5f8df3f7f24171a6e86a616b5f7daf><p class=pgc-img-caption></p></div><p style=text-align:start>你看，可以用在我們的main方法上，那麼是不是不能用於類呢？我們試下：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/286b1dbb0e494b4685978a70b8fc3eeb><p class=pgc-img-caption></p></div><p style=text-align:start>報錯了，看來是不行，所以這個@Target就是一個元註解，可以用來註解註解，也就是標記註解的註解。</p><p style=text-align:start>關於元註解，一般有以下主要的幾個：</p><ol start=1><li>@Documented 用於製作文檔</li><li>@Target 指定註解的使用位置，不指定的話任何位置都可以使用</li><li>@Retention（註解的保留策略）</li></ol><p style=text-align:start>這裡單獨提一下最後一個也就是聲明註解的保留策略@Retention，這個是什麼意思呢？</p><p style=text-align:start>這個保留策略啊，簡單來講就是說你這個註解可以在哪個時間段起作用，這個就得說說我們的代碼從寫出來，然後編譯到執行的主要三個階段了，畫個圖就是這樣的：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/cf38522154c946baa3fbef199e0e139a><p class=pgc-img-caption></p></div><p style=text-align:start>這個我已經畫的很清楚了吧，一般來說，我們的註解都是要保留到運行期間的，所以一般就是這樣：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/32ed74d345664ce593ed8292c33990ba><p class=pgc-img-caption></p></div><p style=text-align:start>當然，具體情況具體對待。</p><p style=text-align:start>到這裡你可能發現，這個註解裡面可以有參數？當然是可以的，我這裡簡單演示下，下面講到註解的語法的時候你就知道了：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0a2c2e194b1349379fb29069c169beb7><p class=pgc-img-caption></p></div><p style=text-align:start>然後再看下使用：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b6e092e1e99b4cd9bd79511a0139cc9f><p class=pgc-img-caption></p></div><p style=text-align:start>其實還是蠻簡單的！</p><h1 class=pgc-h-arrow-right>註解的基本使用語法</h1><p style=text-align:start>接下來我們就來看看註解的語法吧，就是註解具體是如何使用的。</p><p style=text-align:start>對於註解，我們知道了如何去定義它，比如簡單定義一個註解：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/56df664525de4aaaaf7e56b3add91d48><p class=pgc-img-caption></p></div><p style=text-align:start>這很簡單，我們繼續去看，對於註解還可以定義屬性：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/fc5dfae305b3423696bb02a162d2000e><p class=pgc-img-caption></p></div><p style=text-align:start>雖然這個屬性看起來很像方法，但是人家就是屬性，註解還是比較特殊的，那麼現在我們來使用下這個註解：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a77fe0f3af074afe80dbb4bbbebba6d4><p class=pgc-img-caption></p></div><p style=text-align:start>這個時候它會報錯，告訴我們需要一個value值，其實也好理解，你的註解定義中定義的有一個value屬性，那麼你在使用的時候就需要把這個屬性值給用上，那你說我可不可以不用，可以的，那定義註解屬性的時候就需要給屬性添加默認值，就是這樣：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ed2767d40cf94d9d8f8e8ef7e9ddc55c><p class=pgc-img-caption></p></div><p style=text-align:start>可以設置成一個空字符串也可以設置成具體的值。除此之外我們還可以設置多個屬性值，像這樣：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c3a032639a3b42f4a6f3dc2bdfc3a09a><p class=pgc-img-caption></p></div><p style=text-align:start>這裡就有知識點了，如果你在使用的時候只是給一個屬性值賦值，那麼在使用的時候可以這樣：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/a59b484e38da4c398f500f28f38db0f3><p class=pgc-img-caption></p></div><p style=text-align:start>那有人可能疑問，我這個hello對應的是value還是name啊，默認對應的都是value，所以這個要牢記。</p><p style=text-align:start>但是給多個屬性值賦值的時候就必須指明具體的屬性名稱了，就是這樣：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ff0a1b66af984627824a6ee93516996b><p class=pgc-img-caption></p></div><blockquote><p>PS：通過上面的介紹我們會發現註解一個比較奇怪的地方，就是對於註解而言，我們可以定義屬性，但是註解的屬性長得真的像方法，但是在註解裡面，它就是屬性，就可以直接賦值，這裡需要注意下！</p></blockquote><h1 class=pgc-h-arrow-right>屬性的類型</h1><p style=text-align:start>上面簡單介紹了註解的屬性，那麼這些屬性都是可以取哪些類型值呢？大致有如下這麼多：</p><ol start=1><li>基本數據類型</li><li>String</li><li>枚舉</li><li>Class</li><li>註解類型</li><li>數組（以上類型的一維數組）</li></ol><p style=text-align:start>關於數組的看個例子，比如這樣：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4cbc736ca01f411ba7659e9f86f31d23><p class=pgc-img-caption></p></div><p style=text-align:start>使用的時候也是同樣的道理：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/824400d081754a29ac27a2a901febd3e><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>如何真正的理解註解</h1><p style=text-align:start>我們平常對於註解之所以忽視的原因在於，很多地方只需要我們去使用，比如這樣：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4dccae24f2c340939cf00c420e513e2c><p class=pgc-img-caption></p></div><p style=text-align:start>至於註解是怎麼定義的以及註解是怎麼起作用的都不太瞭解，好像需要我們自定義註解的也都很少，所以不去系統化的學習註解的話，會忽略掉註解的很多東西，只會使用，也就是@XXX</p><p style=text-align:start>那麼，從今天開始，我希望你能夠記住，對於註解而言，它一定有如下三個流程：</p><ol start=1><li>定義註解</li><li>使用註解</li><li>讀取並執行相應流程</li></ol><p style=text-align:start>下面我們就以@Repository這個註解來看看這三個流程，首先是定義註解，這個我們可以在IDEA中按住Ctrl點進去@Repository來看，是這樣的：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/663f6e5793cf4ca69e3bb1cd9edb658c><p class=pgc-img-caption></p></div><p>](http://www.ithuangqing.vip/wp-content/uploads/2020/07/wp_editor_md_4185e9864c1c7fc41fb1173d6526a9df.jpg)</p><p style=text-align:start>這個就是@Repository註解的定義，接著我們看看@Repository的使用：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/160d79743b5843a7bf76c920f3c06d18><p class=pgc-img-caption></p></div><p style=text-align:start>然後就是對註解的讀取了，怎麼讀取呢？很多人對這塊是比較模糊的，這也是對註解理解最大的障礙所在。</p><p style=text-align:start>我們一般就是使用註解，對於註解的定義和讀取這塊一般都是框架什麼的給我們搞定了，我們不看源碼一般不知道是怎麼回事的，也就不清楚註解到底是怎麼運行起來的，簡單的理解就是註解需要靠反射去讀取，然後做相應的處理。</p><p style=text-align:start>但是我想你一定和我一樣好奇，為啥加了個@Repository註解之後，這個UserBean就被裝載進Sring容器中生成了一個bean呢？</p><p style=text-align:start>還記得我在最開始就一直在說的嗎？註解是需要有專門的程序取讀取的，然後根絕讀取到的註解獲取的信息去執行相應的操作。</p><p style=text-align:start>所以這裡，在Spring源碼中，一定有某個或者某些程序在做這個事情。</p><h1 class=pgc-h-arrow-right>註解的讀取（註解如何起作用）</h1><p style=text-align:start>上面說了註解的定義何使用，在這裡單獨把註解的讀取拿出來說下，因為這點事理解註解的重點，很多人覺得對註解不理解的一個原因就在於不清楚加了個註解之後到底幹了啥？</p><p style=text-align:start>也就是註解到底是如何起作用的？搞明白這個，將對你理解註解有極大的幫助。</p><h1 class=pgc-h-arrow-right>註解主要被反射讀取</h1><p style=text-align:start>對於註解的讀取，一般就是通過反射技術來實現，這裡就有知識點了，對於反射而言，它只能讀取內存中的字節碼信息，然後還記得之前我們說的註解的作用域@Target嗎？</p><p style=text-align:start>它裡面有幾個主要的作用域，也就是這張圖片，再來回顧下：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b653d2cc4c1e433481f42dbc0f6f86b8><p class=pgc-img-caption></p></div><p style=text-align:start>對於RetentionPolicy.CLASS而言，這個就是指的字節碼這一階段，這個時候這個字節碼文件是由Java源文件通過javac編譯生成，這個時候class字節碼文件其實還是在磁盤內，並沒有進入內存中。</p><p style=text-align:start>而反射只能取讀取內存中的字節碼信息，所以註解的保留策略也就是這個@Target只能是RUNTIME，也即運行的時候仍然可以讀取。</p><h1 class=pgc-h-arrow-right>我的理解（精華）</h1><p style=text-align:start>很多人對註解不理解，或者覺得很模糊的一個原因就是你讓我定義一個註解，我也能按照基本的註解語法去定義一個註解，你說怎麼使用註解我也知道在類，方法等上面使用 @+註解名稱的方式，但是也就到此為主了，更進一步的理解就有點模糊了，比如：</p><ol start=1><li>為什麼要這樣用？</li><li>原理是什麼，怎麼起作用的？</li></ol><p style=text-align:start>你想啊，我們就這樣在類或者方法上面寫了這麼一個@+註解名稱就行了？後續是怎麼起作用的呢？這裡你得首先清楚，註解有三大步驟：</p><ol start=1><li>定義註解</li><li>使用註解</li><li>讀取註解（這塊是大部分人缺少的，也是大部分人對註解不理解的關鍵所在）</li></ol><p style=text-align:start>再理解下什麼是註解，與註釋一字之差，肯定有相似之處，兩者都是提供額外信息的，好比備註，註釋是給我們程序員看到，看到註釋我們知道某個類是幹啥的，有啥用，看到方法的註釋，我們知道這個方法有什麼作用需要什麼參數以及參數的含義等等，那麼註解嘞，註解其實是給程序看到，當程序讀到註解，會從註解這裡得到一些信息，知道該如何處理被該註解標記的類或方法等。</p><p style=text-align:start>好好理解上面的，我們下面再以Spring的一個例子來加以說明。</p><p style=text-align:start>對於Spring簡單的大家都知道IOC吧，直白點就是不用你new對象，需要什麼直接從Spring容器中獲取，那麼首先就需要把我們的bean註冊到Spring容器中吧，這個一般有xml配置方式和註解方式，當然我們這裡要說的是註解方式，也就是使用@+註解名稱的形式，舉個簡單的例子，如下：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a204373e0c3b4d2493ddb29447bb4f92><p class=pgc-img-caption></p></div><p style=text-align:start>這個註解熟悉吧，它就是可以把我們的Person類註冊到Spring容器中去，當然，這裡就是在對這個註解的使用，我們點進去看看這個註解是怎麼定義的：</p><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c4bb4e19918341ca929bd1c8c781f64f><p class=pgc-img-caption></p></div><p style=text-align:start>這個定義我們應該已經熟悉了，對於@Component也是一個註解，它其實是最基礎的把類註冊到Spring容器中的註解，後來的像我們現在說的@Repositoy以及@Service和@Controller這些都是在@Component的基礎上發而來。</p><p style=text-align:start>這裡就需要注意了，其實這幾個註解不管是哪個，都要清楚明白的一點就是，要它們啥用，之所以需要這些註解，就是希望在哪個類上使用這些註解，就自動把這個類註冊到Spring容器中，這個要比我們寫xml配置簡單的多，我們就在一個類上寫個@Repositoy，它就被註冊到Spring容器中了？</p><p style=text-align:start>是不是很神奇，然後看下註解的定義，也很簡單，沒啥東西啊，怎麼就自動註冊到Spring容器中了呢？</p><p style=text-align:start>還記得之前說的註解三大步驟嘛？首先你需要定義一個註解，然後就是使用註解，那麼註解是怎麼起作用的就需要有程序去讀註解，這個註解就好比一個標誌，一個標籤一樣，比如這裡的@Repositoy，當一個類被這個註解標誌，那麼當特有的程序去讀到這個註解的時候，這個程序就知道，哦，原來是要把這類註冊到Spring容器中啊，那麼程序怎麼知道要把這個類註冊到Spring容器中呢？這就是 @Repositoy 告訴它的。另外我們知道註解一般可以設置一個value屬性值，可以通過反射技術拿到之類的，那麼在具體的將這個類註冊到Spring容器的過程中可能就會用到這個value屬性值，比如設置成bean的名字。</p><p style=text-align:start>我們一般使用了註解，在Spring配置文件中就需要配置註解的包掃描：</p><pre><code>&lt;context:component-scan base-package="com.ithuangqing.*"/&gt;1</code></pre><p style=text-align:start>這個其實就是在掃描，看看哪個類上使用到了@Repositoy這些註解，掃描到的就需要特殊處理將其註冊到Spring容器。想一下，這裡Spring其實就會對這個標籤進行解析，核心代碼：</p><pre><code>registerBeanDefinitionParser("component-scan", new ComponentScanBeanDefinitionParser());1</code></pre><p style=text-align:start>然後具體的處理流程就是在ComponentScanBeanDefinitionParser處理，代碼如下：</p><pre><code>@Override	public BeanDefinition parse(Element element, ParserContext parserContext) {		String basePackage = element.getAttribute(BASE_PACKAGE_ATTRIBUTE);		basePackage = parserContext.getReaderContext().getEnvironment().resolvePlaceholders(basePackage);		String[] basePackages = StringUtils.tokenizeToStringArray(basePackage,				ConfigurableApplicationContext.CONFIG_LOCATION_DELIMITERS);		// Actually scan for bean definitions and register them.		ClassPathBeanDefinitionScanner scanner = configureScanner(parserContext, element);    //得到掃描器		Set&lt;BeanDefinitionHolder&gt; beanDefinitions = scanner.doScan(basePackages);             //掃描文件，並轉化為spring bean，並註冊		registerComponents(parserContext.getReaderContext(), beanDefinitions, element);       //註冊其他相關組件		return null;	}1234567891011121314</code></pre><p style=text-align:start>上述代碼的主要作用就是掃描base-package 下的文件，然後把它轉換為Spring中的bean結構，接著將其註冊到容器中……</p><p style=text-align:start>怎麼樣，是不是越來越看不懂代碼？很正常，這裡只需要大家記住，註解是會被特有的程序去讀取，然後去做相關的處理的，而這個處理邏輯，一般就比較複雜了，尤其框架中。</p><h1 class=pgc-h-arrow-right>獲取註解的屬性</h1><p style=text-align:start>上面講解的關於註解是如何起作用的是很重要的，一定要理解，下面我們聊聊註解使用的最後一步：特有的程序去讀取註解。</p><p style=text-align:start>註解使用最終是需要依靠程序去讀取註解，得到註解的一些信息，然後才判斷接下來應該去做什麼事情，那麼接下來我們就要知道註解的屬性值該如何獲取。</p><p style=text-align:start>其實註解的屬性，用到的技術就是反射，反射是一個很重要的知識點，以後會單獨寫文通俗易懂的去聊一聊的。</p><p style=text-align:start>接下來我們來看如何使用反射來獲取註解的屬性。，主要就是一下三個基本的方法：</p><pre><code>/**是否存在對應 Annotation 對象*/public boolean isAnnotationPresent(Class&lt;? extends Annotation&gt; annotationClass) {    return GenericDeclaration.super.isAnnotationPresent(annotationClass);}/**獲取 Annotation 對象*/public &lt;A extends Annotation&gt; A getAnnotation(Class&lt;A&gt; annotationClass) {    return (A) annotationData().annotations.get(annotationClass);}/**獲取所有 Annotation 對象數組*/   public Annotation[] getAnnotations() {    return AnnotationParser.toArray(annotationData().annotations);}1234567891011121314151617</code></pre><p style=text-align:start>然後接下來看一段簡單的代碼：演示利用註解獲取註解屬性</p><pre><code>public class Test {    public static void main(String[] args) throws Exception {        Class&lt;Test&gt; testClass = Test.class;        Method toGetString = testClass.getMethod("toGetString");        //獲取註解對象        Main main = toGetString.getAnnotation(Main.class);        System.out.println(main.value());    }    @Main("這是自定義註解的value值")    public static String toGetString() {        return "";    }}123456789101112131415</code></pre><p style=text-align:start>其實很簡單，記住以上三個獲取註解的方法，關於反射我們後面會詳細聊聊。</p><p style=text-align:start>到現在基本知道了註解需要先定義出來，然後使用，那麼怎麼起作用，大概就是需要一個程序去專門利用反射技術去讀取註解，得到註解裡面的信息然後做相應的事情。</p><h1 class=pgc-h-arrow-right>總結</h1><p style=text-align:start>到這裡，關於註解的講解其實就差不多了，也許你看了也就忘了，也許你根本就沒有看完，但是我希望記住一下內容：</p><ol start=1><li>定義註解</li><li>使用註解</li><li>讀取註解</li></ol><div class=pgc-img><img alt=9000字，通俗易懂的講解下Java註解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/063bdf869aa44936a5e72836a522cd46><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>9000</a></li><li><a>講解</a></li><li><a>Java</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/4672a0fb.html alt=牛人講解Java可重入鎖原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1535262549376823724db60 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4672a0fb.html title=牛人講解Java可重入鎖原理>牛人講解Java可重入鎖原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d8234770.html alt=關於齒輪常識由淺及深講解透徹，推薦收藏！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/4e18dad6a34c44ed850916d34339092b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d8234770.html title=關於齒輪常識由淺及深講解透徹，推薦收藏！>關於齒輪常識由淺及深講解透徹，推薦收藏！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/189fa616.html alt=驅動橋設計講解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/eb89bb6bddcb4755b82277febac75960 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/189fa616.html title=驅動橋設計講解>驅動橋設計講解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6cfd4e0e.html alt="Spring 核心知識講解，太簡單啦" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6cfd4e0e.html title="Spring 核心知識講解，太簡單啦">Spring 核心知識講解，太簡單啦</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/48ba24d7.html alt=深入淺出：Java事務原理和應用兼JDBC事務詳解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/3c5e0002a8059c1311aa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/48ba24d7.html title=深入淺出：Java事務原理和應用兼JDBC事務詳解>深入淺出：Java事務原理和應用兼JDBC事務詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b8bda645.html alt=「Java」隨機數詳解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b471807e699b44c2b1dedc580ea3f3af style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b8bda645.html title=「Java」隨機數詳解>「Java」隨機數詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/816b04b7.html alt=從JVM層面帶你分析Java的Object類源碼第一部分 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/816b04b7.html title=從JVM層面帶你分析Java的Object類源碼第一部分>從JVM層面帶你分析Java的Object類源碼第一部分</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cf633068.html alt="Java 多態的實現機制，看了都說好" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9d3b0e55813d46b4982ae7d9b81d1802 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cf633068.html title="Java 多態的實現機制，看了都說好">Java 多態的實現機制，看了都說好</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/12498348.html alt="Java 編譯時多態和運行時多態" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1531535784468c357213ffe style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/12498348.html title="Java 編譯時多態和運行時多態">Java 編譯時多態和運行時多態</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d60e504d.html alt=Java基礎之多態，動態綁定多態的代碼案例，簡單卻很重要 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ab338c7287fe4649a96227987579c844 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d60e504d.html title=Java基礎之多態，動態綁定多態的代碼案例，簡單卻很重要>Java基礎之多態，動態綁定多態的代碼案例，簡單卻很重要</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bb876e43.html alt=Java特性之一：多態詳解，學java不求人 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/39a700034bab2e1401a3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bb876e43.html title=Java特性之一：多態詳解，學java不求人>Java特性之一：多態詳解，學java不求人</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/234d55fa.html alt=Java開發課程（十）——面向對象5、多態 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/df3621e51e4242fd90731dd013472f12 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/234d55fa.html title=Java開發課程（十）——面向對象5、多態>Java開發課程（十）——面向對象5、多態</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/96d2083b.html alt=「Java三分鐘」Java三大特性——多態理解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/6a9b8965-0a4c-4cb4-9389-6cbbda0e9d93 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/96d2083b.html title=「Java三分鐘」Java三大特性——多態理解>「Java三分鐘」Java三大特性——多態理解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2aa5a357.html alt=大白話講解php多態應用實例 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2aa5a357.html title=大白話講解php多態應用實例>大白話講解php多態應用實例</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b96b5bf9.html alt=如何正確認識Java多態 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d2896b2f39694d39957b901a62cfe7fb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b96b5bf9.html title=如何正確認識Java多態>如何正確認識Java多態</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>