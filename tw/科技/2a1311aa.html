<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>使用可視化設計窗體的GUI程序 | 极客快訊</title><meta property="og:title" content="使用可視化設計窗體的GUI程序 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/823893e71d9f419b921a04b64cfd991c"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2a1311aa.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2a1311aa.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/2a1311aa.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2a1311aa.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2a1311aa.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/2a1311aa.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/2a1311aa.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2a1311aa.html><meta property="article:published_time" content="2020-10-29T21:10:24+08:00"><meta property="article:modified_time" content="2020-10-29T21:10:24+08:00"><meta name=Keywords content><meta name=description content="使用可視化設計窗體的GUI程序"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/2a1311aa.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>使用可視化設計窗體的GUI程序</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>示例Demo2_1用PyQt5的一些類創建了一個簡單的GUI應用程序，窗體及窗體上的標籤對象的創建和屬性設置都完全由代碼完成。顯然這種純代碼方式構造UI的方式是比較麻煩的，特別是在窗體上組件比較多、層次比較複雜的時候，純代碼方式構造界面的工作量和難度可想而知。</p><p>Qt提供了可視化界面設計工具Qt Designer，以及Qt Creator中內置的UI Designer。可視化地設計UI窗體可以大大提高GUI應用程序開發的工作效率。</p><p>本節通過示例Demo2_2演示如何用UI Designer可視化設計UI窗體，然後轉換為Python程序，再構建為Python的GUI程序。主要工作步驟如下。</p><p>（1）在UI Designer中可視化設計窗體。</p><p>（2）用工具軟件pyuic5將窗體文件（.ui文件）轉換為Python程序文件。</p><p>（3）使用轉換後的窗體的Python類構建GUI應用程序。</p><h1><strong>2.2.1 用UI Designer可視化設計窗體</strong></h1><p>在Qt Creator中點擊菜單項“File”→“New File or Project…”，在出現的對話框裡選擇“Qt”分組裡的“Qt Designer Form”（如圖2-2所示），這將創建一個單純的窗體文件（.ui文件）。</p><p>在圖2-2的對話框中點擊“Choose…”按鈕後，出現如圖2-3所示的窗體模板選擇界面。窗體模板主要有以下3種。</p><ul><li>Dialog模板，基於QDialog類的窗體，具有一般對話框的特性，如可以模態顯示、具有返回值等。</li><li>Main Window模板，基於QMainWindow類的窗體，具有主窗口的特性，窗口上有主菜單欄、工具欄、狀態欄等。</li><li>Widget模板，基於QWidget類的窗體。QWidget類是所有界面組件的基類，如QLabel、QPushButton等界面組件都是從QWidget類繼承而來的。QWidget類也是QDialog和QMainWindow的父類，基於QWidget類創建的窗體可以作為獨立的窗口運行，也可以嵌入到其他界面組件內顯示。</li></ul><div class=pgc-img><img alt=使用可視化設計窗體的GUI程序 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/823893e71d9f419b921a04b64cfd991c><p class=pgc-img-caption></p></div><p>圖2-2 新建窗體對話框</p><div class=pgc-img><img alt=使用可視化設計窗體的GUI程序 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2a910a1e4af34d5abb58c12cf7384ab1><p class=pgc-img-caption></p></div><p>圖2-3 選擇Widget模板</p><p>在圖2-3的界面上選擇Widget模板。點擊“Next”按鈕後，在出現的對話框裡設置文件名為FormHello.ui，文件保存到Demo2_2的目錄下，再根據嚮導提示完成創建即可。創建了窗體後就可以在Qt Creator內置的UI Designer裡可視化設計窗體，圖2-4是在窗體上放置了標籤和按鈕，並設置好各種屬性後的界面。</p><p>圖2-4的UI Designer窗口有以下一些功能區域。</p><ul><li>組件面板。窗口左側是界面設計組件面板，分為多個組，如Layouts、Buttons、Display Widgets等，界面設計的常用組件都可以在組件面板裡找到。</li><li>中間區域是待設計的窗體。如果要將某個組件放置到窗體上，從組件面板上拖動一個組件放到窗體上即可。例如，放一個Label組件和一個PushButton組件到窗體上。</li><li>Action編輯器（Action Editor）和Signals Slots編輯器（Signals Slots Editor），位於待設計窗體下方。Action編輯器用於設計Action，Signals Slots編輯器用於可視化地進行信號與槽的關聯，後面會介紹其具體使用。</li><li>對象瀏覽器（Object Inspector）。窗口右上方是對象瀏覽器，用樹狀視圖顯示窗體上各組件之間的佈局和包含關係，視圖有兩列，顯示每個組件的對象名稱（objectName）和類名稱。</li><li>屬性編輯器（Property Editor）。窗口右下方是屬性編輯器，顯示某個選中的組件或窗體的各種屬性及其值，可以在屬性編輯器裡修改這些屬性的值。</li></ul><p>主窗口上方有窗體設計模式和佈局管理工具欄，最左側還有一個工具欄，這些功能在後面詳細介紹Qt Creator的使用時再具體介紹。</p><div class=pgc-img><img alt=使用可視化設計窗體的GUI程序 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/0d3d279d665c47b2807187ea0e391089><p class=pgc-img-caption></p></div><p>圖2-4 在Qt Creator裡可視化設計窗體</p><p>在設計窗體上用鼠標點選一個組件，在屬性編輯器裡會顯示其各種屬性，並且可以修改其屬性。例如，圖2-5是選中窗體上放置的標籤組件後屬性編輯器的內容。</p><div class=pgc-img><img alt=使用可視化設計窗體的GUI程序 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4ccfa9519aff41afb57e52a457d143d2><p class=pgc-img-caption></p></div><p>圖2-5 界面組件的屬性編輯器</p><p>圖2-5展示的屬性編輯器的最上方顯示的文字“LabHello: QLabel”表示這個組件是一個QLabel類的組件，objectName是LabHello。屬性編輯器的內容分為兩列，其中Property列是屬性的名稱，Value列是屬性的值。屬性又分為多個組，實際上表示了類的繼承關係，例如在圖2-5中，可以看出QLabel的繼承關係是QObject→QWidget→QFrame→QLabel。</p><p>objectName是組件的對象名稱，界面上的每個組件都需要一個唯一的對象名稱，以便被引用。界面上的組件的命名應該遵循一定的法則，具體使用什麼樣的命名法則根據個人習慣而定，主要目的是便於區分和記憶，也要便於與普通變量相區分。</p><p>設置組件屬性的值只需在屬性編輯器裡進行修改即可，例如設置LabHello的text屬性為“Hello, by UI Designer”，只需如圖2-5所示那樣修改text屬性的值即可。</p><p>表2-1是所設計的窗體，以及窗體上的標籤和按鈕的主要屬性的設置。</p><p>表2-1 窗體以及各組件的主要屬性設置</p><p><strong>objectName類名稱屬性設置備註</strong>FormHelloQWidgetwindowTitle=”Demo2_2”設置窗體的標題欄顯示文字btnCloseQPushButtonText=”關閉”設置按鈕的顯示文字LabHelloQLabelText=”Hello, by UI Designer” Font.PointSize=12 Font.bold=True設置標籤顯示文字和字體</p><p>窗體設計完成後，將這個窗體保存為文件FormHello.ui。</p><blockquote><p><em>提示：一般情況下，保存的.ui文件名與窗體的objectName名稱一致，這樣通過文件名就可以直接知道窗體的名稱。</em></p></blockquote><p>窗體文件FormHello.ui實際上是一個XML文件，它記錄了窗體上各組件的屬性以及位置分佈。FormHello.ui的XML文件內容不必去深入研究，它是由UI Designer根據可視化設計的窗體自動生成的。使用IDLE的文件編輯器就可以打開FormHello.ui文件，下面是FormHello.ui文件的內容。</p><pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;ui version="4.0"&gt; &lt;class&gt;FormHello&lt;/class&gt; &lt;widget class="QWidget" name="FormHello"&gt; &lt;property name="geometry"&gt; &lt;rect&gt; &lt;x&gt;0&lt;/x&gt; &lt;y&gt;0&lt;/y&gt; &lt;width&gt;283&lt;/width&gt; &lt;height&gt;156&lt;/height&gt; &lt;/rect&gt; &lt;/property&gt; &lt;property name="windowTitle"&gt; &lt;string&gt;Demo2_2&lt;/string&gt; &lt;/property&gt; &lt;widget class="QLabel" name="LabHello"&gt; &lt;property name="geometry"&gt; &lt;rect&gt; &lt;x&gt;50&lt;/x&gt; &lt;y&gt;40&lt;/y&gt; &lt;width&gt;189&lt;/width&gt; &lt;height&gt;16&lt;/height&gt; &lt;/rect&gt; &lt;/property&gt; &lt;property name="font"&gt; &lt;font&gt; &lt;pointsize&gt;12&lt;/pointsize&gt; &lt;weight&gt;75&lt;/weight&gt; &lt;bold&gt;true&lt;/bold&gt; &lt;/font&gt; &lt;/property&gt; &lt;property name="text"&gt; &lt;string&gt;Hello, by UI Designer&lt;/string&gt; &lt;/property&gt; &lt;/widget&gt; &lt;widget class="QPushButton" name="btnClose"&gt; &lt;property name="geometry"&gt; &lt;rect&gt; &lt;x&gt;100&lt;/x&gt; &lt;y&gt;90&lt;/y&gt; &lt;width&gt;75&lt;/width&gt; &lt;height&gt;23&lt;/height&gt; &lt;/rect&gt; &lt;/property&gt; &lt;property name="text"&gt; &lt;string&gt;關閉&lt;/string&gt; &lt;/property&gt; &lt;/widget&gt; &lt;/widget&gt; &lt;resources/&gt; &lt;connections/&gt;&lt;/ui&gt;</pre><h1><strong>2.2.2 將ui文件編譯為py文件</strong></h1><p>使用UI Designer設計好窗體並保存為文件FormHello.ui後，要在Python裡使用這個窗體，需要使用PyQt5的工具軟件pyuic5.exe將這個ui文件編譯轉換為對應的Python語言程序文件。</p><p>pyuic5.exe程序位於Python安裝目錄的Scripts子目錄下，如“D:\Python37\Scripts”，這個路徑在安裝Python時被自動添加到了系統的PATH環境變量裡，所以可以直接執行pyuic5命令。</p><p>在Windows的cmd窗口裡用cd指令切換到文件FormHello.ui所在的目錄，然後用pyuic5指令編譯轉換為Python文件。例如，假設文件FormHello.ui保存在目錄“G:\PyQt5Book\Demo\chap02\demo2_2”下，依次執行下面的指令：</p><pre>cd G:\PyQt5Book\Demo\chap02\demo2_2pyuic5 –o ui_FormHello.py FormHello.ui</pre><p>其中，pyuic5的作用是將文件FormHello.ui編譯後輸出為文件ui<em>FormHello.py。編譯輸出的文件名可以任意指定，在原來的文件名前面加“ui</em>”是個人命名習慣，表明ui_FormHello.py 文件是從FormHello.ui文件轉換來的。</p><p>為了避免重複地在cmd窗口裡輸入上述指令，可以創建一個文件uic.bat保存到項目Demo2_2的目錄下。bat文件是Windows的批處理文件，uic.bat文件的內容只有一條語句，如下：</p><pre>pyuic5 -o ui_FormHello.py FormHello.ui</pre><p>在Windows資源管理器裡雙擊uic.bat文件就會執行該文件裡的語句，也就是將文件FormHello.ui編譯為ui_FormHello.py。</p><p>編譯後在FormHello.ui文件所在的同目錄下生成了一個文件ui_FormHello.py，用IDLE的文件編輯器打開這個文件，其內容如下：</p><pre># -*- coding: utf-8 -*-# Form implementation generated from reading ui file 'FormHello.ui'## Created by: PyQt5 UI code generator 5.12## WARNING! All changes made in this file will be lost!from PyQt5 import QtCore, QtGui, QtWidgetsclass Ui_FormHello(object): def setupUi(self, FormHello): FormHello.setObjectName("FormHello") FormHello.resize(283, 156) self.LabHello = QtWidgets.QLabel(FormHello) self.LabHello.setGeometry(QtCore.QRect(50, 40, 189, 16)) font = QtGui.QFont() font.setPointSize(12) font.setBold(True) font.setWeight(75) self.LabHello.setFont(font) self.LabHello.setObjectName("LabHello") self.btnClose = QtWidgets.QPushButton(FormHello) self.btnClose.setGeometry(QtCore.QRect(100, 90, 75, 23)) self.btnClose.setObjectName("btnClose") self.retranslateUi(FormHello) QtCore.QMetaObject.connectSlotsByName(FormHello) def retranslateUi(self, FormHello): _translate = QtCore.QCoreApplication.translate FormHello.setWindowTitle(_translate("FormHello", "Demo2_2")) self.LabHello.setText(_translate("FormHello",  "Hello, by UI Designer")) self.btnClose.setText(_translate("FormHello", "關閉"))</pre><p>分析這個文件的代碼，可以發現這個文件實際上定義了一個類Ui_FormHello，仔細分析一下這段代碼，可以發現其原理和功能。</p><p>（1）Ui_FormHello類的父類是object，而不是QWidget。</p><p>（2）Ui_FormHello類定義了一個函數setupUi()，其接口定義為：</p><pre>def setupUi(self, FormHello)</pre><p>其傳入的參數有兩個，其中self是函數自己，Python中的self類似於C++語言中的this；FormHello是一個傳入的參數，而不是在Ui_FormHello類裡定義的一個變量。</p><p>setupUi()函數的前兩行語句是：</p><pre>FormHello.setObjectName("FormHello")FormHello.resize(283, 156)</pre><p>所以，FormHello是窗體，是一個QWidget對象，其名稱就是在UI Designer裡設計的窗體的objectName。但是這個FormHello不是在類Ui_FormHello裡創建的，而是作為一個參數傳入的。</p><p>（3）創建了一個QLabel類型的對象LabHello，創建的語句是：</p><pre>self.LabHello = QtWidgets.QLabel(FormHello)</pre><p>LabHello定義為Ui_FormHello類的一個公共屬性（類似於C++的公共變量），它的父容器是FormHello，所以LabHello在窗體FormHello上顯示。後面的語句又設置了LabHello的顯示位置、大小，以及字體屬性。</p><blockquote><p><em>提示：在Python語言中，類的接口包括屬性（attribute）和方法（method），屬性又分為類屬性和類的實例屬性。Python的類屬性類似於C++中類的靜態變量，類的實例屬性類似於C++中類的成員變量。Qt C++中的屬性是指用Q_PROPERTY宏定義了讀寫函數的類的接口元素，類似於Python中用@property修飾符定義了讀寫函數的實例屬性。 不管是否為屬性定義了讀寫函數，Python類中的實例屬性都可以當作一個變量來訪問。在本書中，為了與定義了讀寫函數的屬性區分開來，也為了明確概念，將自定義類中的實例數據型屬性（也就是類似於C++類中的成員變量）有時也稱為變量，特別是一些簡單類型的數據屬性。</em></p></blockquote><p>（4）創建了一個QPushButton類型的對象btnClose，創建的語句是</p><pre>self.btnClose = QtWidgets.QPushButton(FormHello)</pre><p>btnClose也是Ui_FormHello類的一個公共屬性，它的父容器是FormHello，所以在窗體上顯示。</p><p>（5）setupUi()函數的倒數第二行調用了Ui_FormHello類裡定義的另外一個函數retranslateUi()，這個函數設置了窗體的標題、標籤LabHello的文字、按鈕btnClose的標題。實際上，retranslateUi()函數集中設置了窗體上所有的字符串，利於實現軟件的多語言界面。</p><p>（6）setupUi()函數的最後一行語句用於窗體上各組件的信號與槽函數的自動連接，在後面介紹信號與槽時再詳細解釋其功能。</p><p>所以，經過pyuic5編譯後，FormHello.ui文件轉換為一個對應的Python的類定義文件ui_FormHello.py，類的名稱是Ui_FormHello。有如下的特點和功能。</p><p>（1）Ui<em>FormHello.py文件裡的類名稱Ui_FormHello與FormHello.ui文件裡窗體的objectName有關，是在窗體的objectName名稱前面加“Ui</em>”自動生成的。</p><p>（2）Ui_FormHello類的函數setupUi()用於窗體的初始化，它創建了窗體上的所有組件並設置其屬性。</p><p>（3）Ui_FormHello類並不創建窗體FormHello，窗體FormHello是由外部傳入的，作為所有界面組件的父容器。</p><blockquote><p><em>注意：ui_FormHello.py文件只是定義了一個類Ui_FormHello，這個文件並不能直接運行，而是需要在其他地方編程使用這個文件裡定義的類Ui_FormHello。</em></p></blockquote><h1><strong>2.2.3 使用Ui_FormHello類的GUI程序框架</strong></h1><p>將窗體UI文件FormHello.ui編譯轉換為Python的類定義文件ui_FormHello.py後，就可以使用其中的類Ui_FormHello創建GUI應用程序。編寫一個程序文件appMain1.py，它演示了使用Ui_FormHello類創建GUI應用程序的基本框架，其代碼如下：</p><pre>## appMain1.py## 使用ui_FormHello.py文件中的類Ui_FormHello創建appimport sysfrom PyQt5 import QtWidgetsimport ui_FormHelloapp = QtWidgets.QApplication(sys.argv) baseWidget=QtWidgets.QWidget() #創建窗體的基類QWidget的實例ui =ui_FormHello.Ui_FormHello()ui.setupUi(baseWidget) #以baseWidget作為傳遞參數，創建完整窗體baseWidget.show()##ui.LabHello.setText("Hello,被程序修改") #可以修改窗體上標籤的文字sys.exit(app.exec_())</pre><p>分析上面的代碼，可以瞭解GUI程序創建和運行的過程。</p><p>（1）首先用QApplication類創建了應用程序實例app。</p><p>（2）創建了一個QWidget類的對象baseWidget，它是基本的QWidget窗體，沒有做任何設置。</p><p>（3）使用ui_FormHello模塊中的類Ui_FormHello創建了一個對象ui。</p><p>（4）調用了Ui_FormHello類的setupUi()函數，並且將baseWidget作為參數傳入：</p><pre>ui.setupUi(baseWidget)</pre><p>根據前面的分析，Ui_FormHello類的setupUi()函數只創建窗體上的其他組件，而作為容器的窗體是靠外部傳入的，這裡的baseWidget就是作為一個基本的QWidget窗體傳入的。執行這條語句後，就在窗體baseWidget上創建了標籤和按鈕。</p><p>（5）顯示窗體，使用的語句是：</p><pre>baseWidget.show()</pre><p>注意，這裡不能使用ui.show()，因為ui是Ui_FormHello類的對象，而Ui_FormHello的父類是object，根本就不是Qt的窗體界面類。</p><p>程序運行後的結果窗口如圖2-6所示，這就是在UI Designer裡設計的窗體。這個程序只是簡單地實現了窗體的顯示，“關閉”按鈕並不能關閉窗口，在後面介紹信號與槽時再實現其功能。</p><p>那麼現在有個問題，窗體上的標籤、按鈕對象如何訪問呢？例如，若需要修改標籤的顯示文字，該如何修改呢？</p><p>分析一下程序，窗體上的標籤對象LabHello是在Ui_FormHello類裡定義的公共屬性，所以在程序裡可以通過ui對象訪問LabHello。</p><p>對appMain1.py文件稍作修改，在baseWidget.show()語句後加入一條語句，如下（省略了前後的語句）：</p><pre>baseWidget.show()ui.LabHello.setText("Hello,被程序修改")</pre><p>再運行appMain1.py，結果窗口如圖2-7所示，說明上面修改標籤文字的語句是有效的。在上面的修改標籤文字的語句中，不能將ui替換為baseWidget，即下面的語句是錯誤的：</p><pre>baseWidget.LabHello.setText("Hello,被程序修改") #錯誤的</pre><p>這是因為baseWidget是QWidget類型的對象，它只是LabHello的父容器，並沒有定義公共屬性LabHello，所以運行時會出錯。而ui是Ui_FormHello類的實例對象，窗體上的所有界面組件都是ui的實例屬性。因此，訪問窗體上的界面組件只能通過ui對象。</p><div class=pgc-img><img alt=使用可視化設計窗體的GUI程序 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/7d39db4992da4dbbb366b6103a09463a><p class=pgc-img-caption></p></div><p>圖2-6 appMain1.py運行結果窗口</p><div class=pgc-img><img alt=使用可視化設計窗體的GUI程序 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/706f1918ea8f4eaa85a4a7f6e808f559><p class=pgc-img-caption></p></div><p>圖2-7 程序中訪問窗體的標籤對象，修改了其顯示文字</p><h1><strong>2.2.4 界面與邏輯分離的GUI程序框架</strong></h1><p>分析前面的程序appMain1.py，雖然它實現了對Ui_FormHello類的使用，生成了GUI程序，但是它是存在一些缺陷的，原因在於appMain1.py完全是一個過程化的程序。它創建了Ui_FormHello類的對象ui，通過這個對象可以訪問界面上的所有組件，所以，ui可以用於界面交互，獲取界面輸入，將結果輸出到界面上。程序創建的baseWidget是QWidget類的對象，它不包含任何處理邏輯，而僅僅是為了調用ui.setupUi()函數時作為一個傳入的參數。一般的程序是從界面上讀取輸入數據，經過業務處理後再將結果輸出到界面上，那麼這些業務處理的代碼放在哪裡呢？</p><p>appMain1.py的應用程序框架只適合測試單個窗體的UI設計效果，也就是僅能顯示窗體。若要基於UI窗體設計更多的業務邏輯，由於appMain1.py是一個過程化的程序，難以實現業務邏輯功能的有效封裝。</p><p>界面與業務邏輯分離的設計方法不是唯一的，這裡介紹兩種方法，一種是多繼承方法，另一種是單繼承方法。</p><p><strong>1．多繼承方法</strong></p><p>Python的面向對象編程支持使用多繼承，編寫一個程序appMain2.py，代碼如下：</p><pre>## appMain2.py 多繼承方法import sysfrom PyQt5.QtWidgets import QWidget, QApplicationfrom ui_FormHello import Ui_FormHelloclass QmyWidget(QWidget,Ui_FormHello):  def __init__(self, parent=None): super().__init__(parent) #調用父類構造函數，創建QWidget窗體 self.Lab="多重繼承的QmyWidget" #新定義的一個變量 self.setupUi(self) #self是QWidget窗體，可作為參數傳給setupUi() self.LabHello.setText(self.Lab) if __name__ == "__main__":  app = QApplication(sys.argv) #創建app myWidget=QmyWidget() myWidget.show() myWidget.btnClose.setText("不關閉了") sys.exit(app.exec_())</pre><p>這個程序的運行結果如圖2-8所示。分析這段代碼，可以發現它的實現原理。</p><p>（1）採用多繼承的方式定義了一個類QmyWidget，稱這個類為窗體的業務邏輯類，它的父類是QWidget和Ui_FormHello。</p><p>（2）在這個類的構造函數中，首先用函數super()獲取父類，並執行父類的構造函數，代碼是：</p><pre>super().__init__(parent)</pre><p>在多繼承時，使用super()得到的是第一個基類，在這裡就是QWidget。所以，執行這條語句後，self就是一個QWidget對象。</p><p>（3）調用setupUi()函數創建UI窗體，即</p><pre>self.setupUi(self)</pre><p>因為QmyWidget的基類包括Ui_FormHello類，所以可以調用Ui_FormHello類的setupUi()函數。同時，經過前面調用父類的構造函數，self是一個QWidget對象，可以作為參數傳遞給setupUi()函數，正好作為各組件的窗體容器。</p><p>通過這樣的多繼承，Ui_FormHello類中定義的窗體上的所有界面組件對象就變成了新定義的類QmyWidget的公共屬性，可以直接訪問這些界面組件。例如，在QmyWidget類的構造函數裡通過下面的語句設置了界面上的標籤的顯示文字：</p><pre>self.Lab="多重繼承的QmyWidget" #新定義的一個屬性self.LabHello.setText(self.Lab)</pre><p>在應用程序創建QmyWidget類的實例對象myWidget後，通過下面的語句設置了界面上按鈕的顯示文字：</p><pre>myWidget.btnClose.setText("不關閉了")</pre><p>這種多繼承方式有其優點，也有其缺點，表現為以下兩方面。</p><p>（1）界面上的組件都成為窗體業務邏輯類QmyWidget的公共屬性，外界可以直接訪問。優點是訪問方便，缺點是過於開放，不符合面向對象嚴格封裝的設計思想。</p><p>（2）界面上的組件與QmyWidget類裡新定義的屬性混合在一起了，不便於區分。例如，在構造函數中有這樣一條語句：</p><pre>self.LabHello.setText(self.Lab)</pre><p>其中，self.LabHello是窗體上的標籤對象，而self.Lab是QmyWidget類裡新定義的一個屬性。如果沒有明確的加以區分的命名規則，當窗體上的界面組件較多，且窗體業務邏輯類裡定義的屬性也很多時，就難以區分哪個屬性是界面上的組件，哪個屬性是在業務邏輯類裡新定義的，這樣是不利於界面與業務邏輯分離的。</p><p><strong>2．單繼承與界面獨立封裝方法</strong></p><p>針對多繼承存在的一些問題，改用單繼承的方法，編寫另一個程序appMain.py，其代碼如下：</p><pre>## appMain.py 單繼承方法，能更好地進行界面與邏輯的分離import sysfrom PyQt5.QtWidgets import QWidget, QApplicationfrom ui_FormHello import Ui_FormHelloclass QmyWidget(QWidget):  def __init__(self, parent=None): super().__init__(parent) #調用父類構造函數，創建QWidget窗體 self.__ui=Ui_FormHello() #創建UI對象 self.__ui.setupUi(self) #構造UI self.Lab="單繼承的QmyWidget" self.__ui.LabHello.setText(self.Lab) def setBtnText(self, aText): self.__ui.btnClose.setText(aText)if __name__ == "__main__": app = QApplication(sys.argv) #創建app，用QApplication類 myWidget=QmyWidget() myWidget.show() myWidget.setBtnText("間接設置") sys.exit(app.exec_())</pre><p>這個程序的運行結果如圖2-9所示。分析這段代碼，可以看到以下幾點。</p><p>（1）新定義的窗體業務邏輯類QmyWidget只有一個基類QWidget。</p><p>（2）在QmyWidget的構造函數中，首先調用父類（也就是QWidget）的構造函數，這樣self就是一個QWidget對象。</p><p>（3）顯式地創建了一個Ui_FormHello類的私有屬性self.__ui，即</p><pre>self.__ui=Ui_FormHello() #創建UI對象</pre><p>私有屬性self.<strong>ui包含了可視化設計的UI窗體上的所有組件，所以，只有通過self.</strong>ui才可以訪問窗體上的組件，包括調用其創建界面組件的setupUi()函數。</p><blockquote><p><em>提示：Python語言的類定義通過命名規則來限定元素對外的可見性，屬性或方法名稱前有兩個下劃線表示是私有的，一個下劃線表示模塊內可見，沒有下劃線的就是公共的。</em></p></blockquote><p>（4）由於self.<strong>ui是QmyWidget類的私有屬性，因此在應用程序中創建的QmyWidget對象myWidget不能直接訪問myWidget.</strong>ui，也就無法直接訪問窗體上的界面組件。</p><p>為了訪問窗體上的組件，可以在QmyWidget類裡定義接口函數，例如函數setBtnText()用於設置窗體上按鈕的文字。在應用程序裡創建QmyWidget對象的實例myWidget，通過調用setBtnText()函數間接修改界面上按鈕的文字，即</p><pre>myWidget.setBtnText("間接設置")</pre><p>仔細觀察和分析這種單繼承的方式，發現它有如下特點。</p><p>（1）可視化設計的窗體對象被定義為QmyWidget類的一個私有屬性self.__ui，在QmyWidget類的內部對窗體上的組件的訪問都通過這個屬性實現，而外部無法直接訪問窗體上的對象，這更符合面向對象封裝隔離的設計思想。</p><p>（2）窗體上的組件不會與QmyWidget裡定義的屬性混淆。例如，下面的語句：</p><pre>self.__ui.LabHello.setText(self.Lab)</pre><p>self.<strong>ui.LabHello表示窗體上的標籤對象LabHello，它是self.</strong>ui的一個屬性；self.Lab是QmyWidget類裡定義的一個屬性。這樣，窗體上的對象和QmyWidget類裡新定義的屬性不會混淆，有利於界面與業務邏輯的分離。</p><p>（3）當然，也可以定義界面對象為公共屬性，即創建界面對象時用下面的語句：</p><pre>self.ui=Ui_FormHello()</pre><p>這裡的ui就是個公共屬性，在類的外部也可以通過屬性ui直接訪問界面上的組件。為了簡化程序，在本書後面的示例程序中，都定義界面對象為公共屬性self.ui。</p><p>對比多繼承方法和單繼承方法，可以發現單繼承方法更有利於界面與業務邏輯分離。實際上，在Qt C++應用程序中默認就是採用的單繼承方法，對Qt C++應用程序比較清楚的讀者就很容易理解其工作原理了。</p><p>本書使用這種單繼承和界面獨立封裝的方式，在後面的示例程序中都採用這種單繼承的應用程序框架。</p><p>在這個示例中，窗口上雖然放置了一個按鈕並顯示“關閉”，但是運行時點擊這個按鈕並不能關閉窗口，這是因為我們還沒有編寫任何代碼。這個示例只是為了演示如何在UI Designer裡可視化設計UI窗體，再編譯轉換為對應的Python類，然後使用PyQt5裡相關的類創建GUI應用程序的過程，以及GUI程序的框架和工作原理，下一節再重點介紹如何編寫代碼實現窗體的功能。</p><p>本文截選自《Python Qt GUI與數據可視化編程》</p><p><strong>Python Qt GUI與數據可視化編程</strong></p><div class=pgc-img><img alt=使用可視化設計窗體的GUI程序 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/41d0db6e237e4a8c89aa4f936cd81525><p class=pgc-img-caption></p></div><p>本書介紹在Python中使用PyQt5和其他模塊進行GUI和數據可視化編程的方法。第一部分介紹PyQt5設計GUI程序的基本框架，包括GUI應用程序的基本結構、窗體UI可視化設計與窗體業務邏輯的設計、信號與槽的特點和使用等。第二部分介紹GUI程序設計中一些主要功能模塊的使用，包括基本界面組件、事件處理、數據庫、繪圖、多媒體等。第三部分先介紹使用PyQtChart和PyQtDataVisualization進行二維和三維數據可視化設計的方法，再介紹將Matplotlib嵌入PyQt5 GUI應用程序窗口界面中進行數據可視化的編程方法。通過研讀本書，讀者可以掌握使用PyQt5、PyQtChart、Matplotlib等模塊進行GUI應用程序和數據可視化設計的方法。</p><p>本書適合具有Python編程基礎，並想通過Python設計GUI應用程序或在GUI應用程序中實現數據可視化的讀者閱讀和參考。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>可視化</a></li><li><a>設計</a></li><li><a>窗體</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/e1ea89d.html alt=數據可視化設計過程：面向初學者的循序漸進指南 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/S675yEr91tYEF1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e1ea89d.html title=數據可視化設計過程：面向初學者的循序漸進指南>數據可視化設計過程：面向初學者的循序漸進指南</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9bd6b239.html alt=鋼構人福利——鋼結構設計經典問題解讀 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a72bd60ea48d471b8ce03ebf0ce15869 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9bd6b239.html title=鋼構人福利——鋼結構設計經典問題解讀>鋼構人福利——鋼結構設計經典問題解讀</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6bbe6ec4.html alt=鋼管混凝土結構設計原理及在強震區橋樑結構研究成果達國際領先 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/153569494612546362474a9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6bbe6ec4.html title=鋼管混凝土結構設計原理及在強震區橋樑結構研究成果達國際領先>鋼管混凝土結構設計原理及在強震區橋樑結構研究成果達國際領先</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6d006e47.html alt=鋼結構設計基礎知識問答 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/63b48928-d7cd-4346-b80f-4f77015517c1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6d006e47.html title=鋼結構設計基礎知識問答>鋼結構設計基礎知識問答</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0dc64d99.html alt=38個鋼結構設計問題，都很常見 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/f1181ce8-cf01-4194-b9c2-362f43894ddb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0dc64d99.html title=38個鋼結構設計問題，都很常見>38個鋼結構設計問題，都很常見</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b6fd930e.html alt=步步解析橋樑設計計算，不可錯過的一篇乾貨 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d88dd927b4f2474fbe4ea261c2397ba8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b6fd930e.html title=步步解析橋樑設計計算，不可錯過的一篇乾貨>步步解析橋樑設計計算，不可錯過的一篇乾貨</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/97b90000.html alt=結構設計、校對、審核三字經，速速收藏 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/97b90000.html title=結構設計、校對、審核三字經，速速收藏>結構設計、校對、審核三字經，速速收藏</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fd0540fa.html alt=解析橋樑設計計算 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/fa4d0bcf2a204a2fac9b37978b1b0713 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fd0540fa.html title=解析橋樑設計計算>解析橋樑設計計算</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/83530974.html alt=解析橋樑設計計算，不可錯過的一篇乾貨 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/af9ca7f120da4e23b0ca589375e05dd2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/83530974.html title=解析橋樑設計計算，不可錯過的一篇乾貨>解析橋樑設計計算，不可錯過的一篇乾貨</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e8b9b44c.html alt=設計師解析橋樑設計計算，錯過了就沒有機會 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e01645937bda4ae7a7f148666ff89117 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e8b9b44c.html title=設計師解析橋樑設計計算，錯過了就沒有機會>設計師解析橋樑設計計算，錯過了就沒有機會</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/15d8539d.html alt=經典設計延續至今的烏尼莫克403萬能卡車 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/132ba54553374c7eb2c0a9c155bba041 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/15d8539d.html title=經典設計延續至今的烏尼莫克403萬能卡車>經典設計延續至今的烏尼莫克403萬能卡車</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/69536588.html alt=線纜設計初級課程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1532759411210988051a0cb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/69536588.html title=線纜設計初級課程>線纜設計初級課程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/219919c3.html alt=梯度效果的創意Logo設計案例分享（1） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/15226471428904df67cc724 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/219919c3.html title=梯度效果的創意Logo設計案例分享（1）>梯度效果的創意Logo設計案例分享（1）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/29b61120.html alt=梯度效果的創意Logo設計案例分享（2） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1522647184765cbbd0b4dcd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/29b61120.html title=梯度效果的創意Logo設計案例分享（2）>梯度效果的創意Logo設計案例分享（2）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7b6871ad.html alt=過度設計還是人性化設計，羅技雙模式滾輪拆解，你們怎麼看？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/51d58f282cad467fb9a443fd319a42f2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7b6871ad.html title=過度設計還是人性化設計，羅技雙模式滾輪拆解，你們怎麼看？>過度設計還是人性化設計，羅技雙模式滾輪拆解，你們怎麼看？</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>