<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>我是如何閱讀JDK源碼的？ | 极客快訊</title><meta property="og:title" content="我是如何閱讀JDK源碼的？ - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/25b18fb619994fcbaa58c5e28b7a4e51"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2bf9a44d.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2bf9a44d.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/2bf9a44d.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2bf9a44d.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2bf9a44d.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/2bf9a44d.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/2bf9a44d.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2bf9a44d.html><meta property="article:published_time" content="2020-11-14T21:05:53+08:00"><meta property="article:modified_time" content="2020-11-14T21:05:53+08:00"><meta name=Keywords content><meta name=description content="我是如何閱讀JDK源碼的？"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/2bf9a44d.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>我是如何閱讀JDK源碼的？</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">1. 前言</span></span></strong></h1><p>之前斷斷續續讀過一部分 JDK 常用類的源碼，這裡想把過程中的一些心得和方法記錄下來，如果能幫到需要的小夥伴就再好不過了！</p><p>本文主要分享一下我的閱讀工具和閱讀順序。</p><blockquote><p><span style="background-color:#fff9f9;--tt-darkmode-bgcolor: #151515">PS: 由於當前主流使用的 JDK 版本仍是 1.8，因此源碼閱讀主要是 1.8 版本，有些地方可以參考 1.7（面試可能問到）。</span></p></blockquote><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">2. 工具</span></span></strong></h1><p>工欲善其事，必先利其器。</p><p>需要的工具不多，IDE + Google 翻譯足夠了。</p><p>使用 IDE 的主要目的是可以寫一些測試代碼以便跟蹤調試。這個還是很有必要的，跟進代碼的執行流程更容易理解它的實現原理。</p><p>直接在 IDE 打開源碼文件，源碼中的註釋通常很詳細，遇到不懂的地方 Google 翻譯一下。也可以加上官方文檔，其實源碼裡面註釋跟文檔是一樣的，有些地方可能更詳細，只不過官方文檔排版更漂亮一些。</p><blockquote><p><span style="background-color:#fff9f9;--tt-darkmode-bgcolor: #151515">JDK 1.8 官方文檔鏈接：https://docs.oracle.com/javase/8/docs/api/</span></p></blockquote><p>當然，閱讀的先後順序也很重要，下面介紹下我的閱讀順序。</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">3. 閱讀順序</span></span></strong></h1><h1 class=pgc-h-arrow-right><strong>3.1 整體順序</strong></h1><p>JDK 中的代碼非常多，不可能、也沒必要全部讀完，因此要有的放矢。從整體上來講，順序大概是：</p><ol start=1><li>集合框架類</li><ol start=1><li>主要包括 Collection、Map、Queue 等組成的一系列常用類和接口，包括 ArrayList、LinkedList、HashMap 等。</li><li>這部分內容日常開發使用較多，而且面試高頻出現，因此可以先從這裡入手。</li></ol><li>併發包</li><ol start=1><li>即 java.util.concurrent (J.U.C) 包下的常用類，包括 ReentrantLock、ThreadPoolExecutor、AQS 等。</li><li>該部分提供了併發編程的常用工具類，也是面試高頻。</li></ol><li>其他常用類</li><ol start=1><li>例如 ThreadLocal、String、StringBuilder、StringBuffer 等。</li></ol></ol><p>整體概覽如下：</p><div class=pgc-img><img alt=我是如何閱讀JDK源碼的？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/25b18fb619994fcbaa58c5e28b7a4e51><p class=pgc-img-caption></p></div><p>具體到某一個類，如何去閱讀它的源碼實現呢？下面繼續介紹。</p><h1 class=pgc-h-arrow-right><strong>3.2 具體順序</strong></h1><h1 class=pgc-h-arrow-right><strong>3.2.1 類和接口</strong></h1><p>如何閱讀一個類的源碼呢？主要步驟大概是：</p><ol start=1><li>先讀接口代碼。包括接口說明文檔、各個方法的定義和說明文檔。</li><li>再去讀實現類的主要方法實現，通常有以下兩條主線入口：</li><ol start=1><li>構造方法</li><li>常用方法</li></ol></ol><p>在 Java 中，接口通常意味著是一種“標準”、或者“協議”。一個接口可以有多個實現類，它們都會按照接口的這種標準來實現接口的各個方法。因此，理解了一個方法的定義，再去看它的實現會更容易理解。</p><p>下面以常用的 ArrayList 為例，分析如何去閱讀它的源碼。</p><h1 class=pgc-h-arrow-right><strong>3.2.2 ArrayList 源碼分析</strong></h1><p>首先看下 ArrayList 的繼承結構：</p><div class=pgc-img><img alt=我是如何閱讀JDK源碼的？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4686af67c30a4ad89861fba2c24454c6><p class=pgc-img-caption></p></div><p>可以看到它實現了很多接口，其中三個接口 Cloneable、RandomAccess、Serializable 都是空的，可以暫時忽略。主要去看 Iterable、Collection 以及 List 接口的方法定義。</p><p>Iterable 接口：</p><div class=pgc-img><img alt=我是如何閱讀JDK源碼的？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a63938b08d1e415484802b7bec148ffc><p class=pgc-img-caption></p></div><p>Collection 接口：</p><div class=pgc-img><img alt=我是如何閱讀JDK源碼的？ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/e476e880522947b8a1d55257c9b736e8><p class=pgc-img-caption></p></div><p>List 接口：</p><div class=pgc-img><img alt=我是如何閱讀JDK源碼的？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/509f6a37ca994e7881d7a256906f2140><p class=pgc-img-caption></p></div><p>看起來方法挺多，其實不少都是我們平時會用到的，大部分理解起來並不困難，而且方法也都有註釋。這部分難度不大。</p><p>接下來根據前面提到的兩條主線入口，分析 ArrayList 的源碼如何閱讀。</p><ul><li>構造器</li></ul><p>分析一個類的源碼時，構造器通常是一個好的切入點。比如 ArrayList 的三個構造器如下：</p><pre><code>public ArrayList() {    this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;}public ArrayList(int initialCapacity) {    if (initialCapacity &gt; 0) {        this.elementData = new Object[initialCapacity];    } else if (initialCapacity == 0) {        this.elementData = EMPTY_ELEMENTDATA;    } else {        throw new IllegalArgumentException("Illegal Capacity: "+                                           initialCapacity);    }}public ArrayList(Collection&lt;? extends E&gt; c) {    elementData = c.toArray();    if ((size = elementData.length) != 0) {        // c.toArray might (incorrectly) not return Object[] (see 6260652)        if (elementData.getClass() != Object[].class)            elementData = Arrays.copyOf(elementData, size, Object[].class);    } else {        // replace with empty array.        this.elementData = EMPTY_ELEMENTDATA;    }}</code></pre><p>構造器中有不少成員變量，比如 elementData、EMPTY_ELEMENTDATA、DEFAULTCAPACITY_EMPTY_ELEMENTDATA 等，繼續跟進這幾個變量：</p><pre><code>private static final Object[] EMPTY_ELEMENTDATA = {};private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};transient Object[] elementData; // non-private to simplify nested class access</code></pre><p>由此可以得知，當我們寫了 <span style="color:#ef7060;--tt-darkmode-color: #EF7060">new ArrayList()</span> 時，它的內部到底做了些什麼。</p><ul><li>常用方法</li></ul><p>除了構造器，常用方法也是一個主要的入口，比如 add、remove 等。</p><p>add 方法實現：</p><pre><code>public boolean add(E e) {    ensureCapacityInternal(size + 1);  // Increments modCount!!    elementData[size++] = e;    return true;}private void ensureCapacityInternal(int minCapacity) {    ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));}</code></pre><p>可以一行行跟進代碼，查看 add 方法內部到底做了什麼。</p><p>其他方法的套路也是如此，不再一一說明。</p><p>按照這樣一條條主線走下來，就可以對 ArrayList 的實現原理有個整體的認知了。整體部分搞清楚之後，接下來還可以去讀一些不太常用的方法，包括剩餘的所有部分。</p><blockquote><p><span style="background-color:#fff9f9;--tt-darkmode-bgcolor: #151515">PS: 這裡只是以常用的 ArrayList 為例，其他包下的類的閱讀步驟也大同小異。</span></p></blockquote><h1 class=pgc-h-arrow-right><strong>3.3 做筆記</strong></h1><p>此外，做筆記也很重要。</p><p>可以用思維導圖梳理整體脈絡，用筆記工具記錄一個類的核心部分實現原理。</p><p>當然，如果自己整理和寫出來筆記更好，許多時候總覺得自己知道了，但是別人一問就懵了，可能還是沒理解到位吧。</p><p>有句話說得好：”教是最好的學“。當你能把某個知識點通俗易懂的講給一個外行人，才是真的懂了。</p><h1 class=pgc-h-arrow-right><strong>3.4 注意點</strong></h1><p>剛開始讀時，可能會遇到某些地方難以理解，可以嘗試寫測試代碼斷點跟蹤調試，或者參考別人的博客。</p><p>如果遇到某個點實在難以理解，也可以先跳過，過段時間再重新思考也許就豁然開朗了。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>閱讀</a></li><li><a>JDK</a></li><li><a>源碼</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/64f29aef.html alt=CPython源碼閱讀-基類與元類型-變長與定長對象 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a766bd27fb8c42f09fce11b7a8480fec style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/64f29aef.html title=CPython源碼閱讀-基類與元類型-變長與定長對象>CPython源碼閱讀-基類與元類型-變長與定長對象</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3c09a7c2.html alt=網站源碼，服務器，域名三者是什麼關係？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/S1xQDgS3bmZd8q style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3c09a7c2.html title=網站源碼，服務器，域名三者是什麼關係？>網站源碼，服務器，域名三者是什麼關係？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3a5fae7e.html alt=HashMap源碼分析 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/4852d5083ec340be9f50ded10636e4b0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3a5fae7e.html title=HashMap源碼分析>HashMap源碼分析</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e2d1f541.html alt=閱讀·學習時能讓自己強制做輸出的高效道具—KWL表 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8563f06738304651b6f37dca65555c3d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e2d1f541.html title=閱讀·學習時能讓自己強制做輸出的高效道具—KWL表>閱讀·學習時能讓自己強制做輸出的高效道具—KWL表</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e590a5d4.html alt="thinkphp6學習教程與源碼 tp6開源CMS系統源碼研究" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5ab1d67934084ab6bd585f4c84094c76 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e590a5d4.html title="thinkphp6學習教程與源碼 tp6開源CMS系統源碼研究">thinkphp6學習教程與源碼 tp6開源CMS系統源碼研究</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dbf8b0cf.html alt=Tomcat源碼分析之整體架構 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1531465870453535efa0b79 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dbf8b0cf.html title=Tomcat源碼分析之整體架構>Tomcat源碼分析之整體架構</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/07f82832.html alt="SynchronousQueue 同步隊列入門使用&源碼詳解" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/f76c27ed738844d099b011022d2e054f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/07f82832.html title="SynchronousQueue 同步隊列入門使用&源碼詳解">SynchronousQueue 同步隊列入門使用&源碼詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/59958e85.html alt=深入分析java集合框架Collection（源碼分析） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/43efff37d8ff43bc8553cc71e3b99b17 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/59958e85.html title=深入分析java集合框架Collection（源碼分析）>深入分析java集合框架Collection（源碼分析）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e275511c.html alt=源碼分析：Java集合類的AbstractCollection源碼解析 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a3aefa7e5d8c491cb86dc9c9e4390671 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e275511c.html title=源碼分析：Java集合類的AbstractCollection源碼解析>源碼分析：Java集合類的AbstractCollection源碼解析</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fdc48726.html alt=後端好書閱讀與推薦（續五） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/37425581639e49c7a4ebd28fc6c90a1f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fdc48726.html title=後端好書閱讀與推薦（續五）>後端好書閱讀與推薦（續五）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/706d8944.html alt=如何開始寫小說？制定閱讀策略，學會閱讀小說就開始 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/ee9b5e30-764c-4f7c-926c-2e376397a2a8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/706d8944.html title=如何開始寫小說？制定閱讀策略，學會閱讀小說就開始>如何開始寫小說？制定閱讀策略，學會閱讀小說就開始</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b2d54e2e.html alt=如何生成乾淨可閱讀的彙編代碼 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/fd7693c64d03414abeadb351f067183e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b2d54e2e.html title=如何生成乾淨可閱讀的彙編代碼>如何生成乾淨可閱讀的彙編代碼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4d741bce.html alt=有一說一！SpringAOP+源碼解析，切就完事了 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/965c060c22b942c1a3a9f143215f114c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4d741bce.html title=有一說一！SpringAOP+源碼解析，切就完事了>有一說一！SpringAOP+源碼解析，切就完事了</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8ea98537.html alt=源碼：太陽能路燈如何接線 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/c5ed2247de6949d89b9052d3fddd4921 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8ea98537.html title=源碼：太陽能路燈如何接線>源碼：太陽能路燈如何接線</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/436e2022.html alt=「源碼」用ModelSim做FPGA的時序仿真，看這一篇就夠了 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/769d1d2c04b9410aa18cd0add525013f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/436e2022.html title=「源碼」用ModelSim做FPGA的時序仿真，看這一篇就夠了>「源碼」用ModelSim做FPGA的時序仿真，看這一篇就夠了</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>