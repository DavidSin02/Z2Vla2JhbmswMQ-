<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>歸併算法經典應用——求解逆序數 | 极客快訊</title><meta property="og:title" content="歸併算法經典應用——求解逆序數 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/e16e9ab3eb274b49995e2e44af5019ee"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2cdf859.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2cdf859.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/2cdf859.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2cdf859.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2cdf859.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/2cdf859.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/2cdf859.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/2cdf859.html><meta property="article:published_time" content="2020-10-29T20:52:58+08:00"><meta property="article:modified_time" content="2020-10-29T20:52:58+08:00"><meta name=Keywords content><meta name=description content="歸併算法經典應用——求解逆序數"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/2cdf859.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>歸併算法經典應用——求解逆序數</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>原創不易，求個關注</p><p><br></p><p>在之前介紹線性代數行列式計算公式的時候，我們曾經介紹過逆序數：我們在列舉出行列式的每一項之後，<strong>需要通過逆序數來確定這一項符號的正負性</strong>。如果有忘記的同學可以回到之前的文章當中複習一下：</p><p><br></p><p><a class=pgc-link data-content=mp href="https://www.toutiao.com/i6773880253216457219/?group_id=6773880253216457219" target=_blank>線性代數精華1——從行列式開始</a></p><p><br></p><p>如果忘記呢，問題也不大，這個概念比較簡單，我想大家很快就能都搞清楚。</p><p><br></p><p>今天的這一篇文章，我想和大家聊聊逆序數的算法，也是一道<strong>非常經典</strong>的算法題，經常在各大公司的面試題當中出現。</p><p><br></p><p>我們先來回顧一下逆序數的定義，所謂逆序數指的是數組當中究竟<strong>存在多少組數對</strong>，使得排在前面的數大於排在後面的數。我們舉個例子，假設當下有一個數組是: [1, 3, 2]。</p><p><br></p><p>對於數對(3, 2)來說，由於3排在2前面，並且3 > 2，那麼就說明(3, 2)是一對逆序數對。整個數組當中所有逆序數對的個數就是逆序數。</p><p><br></p><p>我們從逆序數的定義當中不難發現，逆序數其實是用來<strong>衡量一個數組有序程度</strong>的一個指標。逆序數越大，說明這個數組遞增性越差。如果逆序數為0，說明這個序列是嚴格遞增的。如果一個長度為n的數組的逆序數是C_n2，那麼說明這個數組是嚴格遞減的，此時逆序數最大。</p><p><br></p><p>那麼，我們怎麼快速地求解逆序數呢？</p><p><br></p><h2 class=pgc-h-arrow-right>暴力解法</h2><p><br></p><p>顯然，這個問題可以暴力求解，我們只需要遍歷所有的數對，然後判斷是否構成逆序即可，最後累加一下所有逆序數對的個數就是最終的答案。</p><p><br></p><p>這個代碼非常簡單，只需要幾行：</p><p><br></p><div class=pgc-img><img alt=歸併算法經典應用——求解逆序數 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e16e9ab3eb274b49995e2e44af5019ee><p class=pgc-img-caption></p></div><p><br></p><p>這樣當然是可以的，但是我們也很容易發現，這樣做的時間複雜度是 O(n^2) ，這在很多時候是我們不能接受的。即使是運行速度非常快的C++，在單核CPU上一秒鐘的時間，也就能跑最多n=1000這個規模。再大需要消耗的時間就會陡然增加，而在實際應用當中，一個長度超過1000的數組簡直是家常便飯。顯然，我們需要優化這個算法，不能簡單地暴力求解。</p><p><br></p><h2 class=pgc-h-arrow-right>分治</h2><p><br></p><p>我們可以嘗試使用分治算法來解決這個問題。</p><p><br></p><p>對於一個數組arr來說，我們試著將它拆分成兩半，比如當下arr是[32, 36, 3, 9, 29, 16, 35, 73, 34, 82]。我們拆分成兩半之後分別是[32, 36, 3, 9, 29]和[16, 35, 73, 34, 82]。我們令左邊半邊的子數組是A，右邊半邊的子數組是B。顯然A和B都是原問題的子問題，我們可以假設通過遞歸可以求解出A和B子問題的結果。</p><p><br></p><p>那麼問題來了，我們怎麼通過A、B子問題的結果來構建arr的結果呢？也就是說，我們怎麼通過子問題分治來獲取原問題的答案呢？</p><p><br></p><p>在回答之前，我們先來分析一下當前的情況。當我們將arr數組拆分成了AB兩個部分之後，整個arr的逆序數就變成了三個部分。分別是A數組內部的逆序數、B數組內部的逆序數，以及AB兩個數組之間的逆序數，也就是一個元素在A中，一個元素在B中的逆序數對。</p><p><br></p><p>我們再來分析一下，會發現A數組中的元素交換位置，只會影響A數組之間的逆序數，並不會影響B以及AB之間構成的逆序數。因為A中的元素即使交換位置，也在B數組所有元素之前。</p><p><br></p><p>我們舉個例子：</p><p><br></p><p>假設arr=[3, 5, 1, 4]，那麼A=[3, 5], B=[1, 4]。</p><p><br></p><p>對於arr而言，它的逆序數是3分別是(3， 1)， （5， 1）和（5， 4）。對於A而言，它的逆序數是0，B的逆序數也是0。我們試著交換一下B當中的位置，交換之後的B=（4， 1），此時arr=[3, 5, 4, 1]。那麼B的逆序數變成1，A的逆序數依然還是0。而整體arr的逆序數變成了4，分別是：（3， 1），（5， 1），（5， 4）和（4，1），很明顯整體的逆序數新增的就是B交換元素帶來的。</p><p><br></p><p>通過觀察，我們也能發現，對於A中的3和5而言，B中的1和4的順序並不影響它們構成逆序數的數量。</p><p><br></p><p>想明白了這一層，剩下的就簡單了。既然A和B當中的元素無論怎麼交換順序也不會影響對方的結果，那麼我們就可以放心地使用分治算法來解決了。我們先假設，我們可以通過遞歸獲取A和B各自的逆序數。那麼剩下的問題就是將AB歸併之後的逆序數對，也就是找出所有<strong>A和B各佔一個元素</strong>的逆序數對的情況了。</p><p><br></p><p>我們先對A和B中的元素進行排序，我們之前已經驗證過了，我們調整A或者B當中的元素順序，並不會改變橫跨AB逆序數的數量，而我們通過遞歸已經求到了A和B中各自逆序數對的數量，所以我們存下來之後，就可以對A和B中的元素進行排序了。A和B中元素有序了之後，我們可以用插入排序的方法，將A中的元素依次插入B當中。</p><p><br></p><div class=pgc-img><img alt=歸併算法經典應用——求解逆序數 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/81db6861d20f4727b0fe95ab05ecc82b><p class=pgc-img-caption></p></div><p><br></p><p>從上圖我們可以看出來，假設我們把 A[i] 這個元素插入B數組當中j的位置。<strong>由於之前 A[i] 排在B這j個元素之前，所以構成了j個逆序數對</strong>。我們對於所有A中的元素 A[i] 求出它在B數組所有插入的位置j，然後對j求和即可。</p><p><br></p><p>比較容易想到，由於B元素有序，我們可以通過二分的方法來查找A當中元素的位置。但其實還有更好的辦法，我們一個步驟就可以完成AB的排序以及插入，就是將AB兩個有序的數組進行歸併。在歸併的過程當中，我們<strong>既可以知道插入的B數組中的位置，又可以完成數組的排序</strong>，也就順帶解決了數組排序的問題。所以整個步驟其實就是歸併排序的延伸，雖然整個代碼和歸併排序差別非常小，但是，這個過程當中的推導和思考非常重要。</p><p><br></p><p>如果你能理解上面這些推導過程，我相信代碼對你來說並不困難。如果你還沒能完全理解，也沒有關係，藉著代碼，我相信你會理解得更輕鬆。話不多說了，讓我們來看代碼吧：</p><p><br></p><div class=pgc-img><img alt=歸併算法經典應用——求解逆序數 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/21c4dc0acb8a4b2095d3e82a0f2cecb9><p class=pgc-img-caption></p></div><p><br></p><p>從代碼層面來看，上面這段代碼<strong>實現了排序的同時也算出了逆序數</strong>。所以這就是為什麼很多人會將兩者相提並論的原因，也是我個人非常喜歡這個問題的原因。看起來完全不相關的兩個問題，竟然能用幾乎同一套代碼來解決，不得不感嘆算法的神奇。也正是因此，我們這些算法的研究和學習者，才能獲取到源源不斷的樂趣。</p><p><br></p><p>今天的文章就到這裡，如果覺得有所收穫，請<strong>順手點個關注</strong>吧，你們的支持是我最大的動力。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>經典</a></li><li><a>應用</a></li><li><a>逆序</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/893b317.html alt=經典應用案例實訓，從零開始學會PLC程序結構與程序設計！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/10428cae4c0a477c8184230adc48789e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/893b317.html title=經典應用案例實訓，從零開始學會PLC程序結構與程序設計！>經典應用案例實訓，從零開始學會PLC程序結構與程序設計！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dd62c2d.html alt=奧數經典逆序推理題，鍛鍊孩子的逆向思維 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/15381138124797bf37eba7f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dd62c2d.html title=奧數經典逆序推理題，鍛鍊孩子的逆向思維>奧數經典逆序推理題，鍛鍊孩子的逆向思維</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bcc4c942.html alt=「鋼構知識」經典鋼結構設計問答 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bcc4c942.html title=「鋼構知識」經典鋼結構設計問答>「鋼構知識」經典鋼結構設計問答</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7f6e1fd9.html alt=「鋼構知識」經典鋼結構設計問答彙總 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/76195b1e9d934c2e952b060dad0951e6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7f6e1fd9.html title=「鋼構知識」經典鋼結構設計問答彙總>「鋼構知識」經典鋼結構設計問答彙總</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5e4be374.html alt=鈦及鈦合金鑄件的應用領域​ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/Rca7hqUCttQBq0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5e4be374.html title=鈦及鈦合金鑄件的應用領域​>鈦及鈦合金鑄件的應用領域​</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/15d8539d.html alt=經典設計延續至今的烏尼莫克403萬能卡車 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/132ba54553374c7eb2c0a9c155bba041 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/15d8539d.html title=經典設計延續至今的烏尼莫克403萬能卡車>經典設計延續至今的烏尼莫克403萬能卡車</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/958c038a.html alt=鑄造鋁合金應用現狀及未來前景分析 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8dcaa42ff9a64e2cad814e4e025fc52c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/958c038a.html title=鑄造鋁合金應用現狀及未來前景分析>鑄造鋁合金應用現狀及未來前景分析</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0249bca7.html alt=民間經典名言「上」：仰不愧天，俯不愧地，那不愧心 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/4000b541-b105-4302-8cc9-546a79e90ece style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0249bca7.html title=民間經典名言「上」：仰不愧天，俯不愧地，那不愧心>民間經典名言「上」：仰不愧天，俯不愧地，那不愧心</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/16133b9e.html alt=深度語義模型以及在淘寶搜索中的應用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/48529b82dc7c4f048fc3e45d586717e6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/16133b9e.html title=深度語義模型以及在淘寶搜索中的應用>深度語義模型以及在淘寶搜索中的應用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/657370c9.html alt=從起源講到應用，幾乎所有齒輪知識都在這裡了 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/6a14e31844e14b5aace5360ee6f8601a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/657370c9.html title=從起源講到應用，幾乎所有齒輪知識都在這裡了>從起源講到應用，幾乎所有齒輪知識都在這裡了</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fc32dcc9.html alt=牛常用飼料添加劑的種類與應用！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/57c1b1c2-20c8-4927-8161-242643381796 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fc32dcc9.html title=牛常用飼料添加劑的種類與應用！>牛常用飼料添加劑的種類與應用！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7fa2c409.html alt=精密三角高程在長距離一等跨河水準測量中的應用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/514529e0543f408583046cefc73fac13 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7fa2c409.html title=精密三角高程在長距離一等跨河水準測量中的應用>精密三角高程在長距離一等跨河水準測量中的應用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c96865e4.html alt=C語言經典100例004-統計各個年齡階段的人數 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/98c4bb54-8d7e-4234-bf07-0d8190ba1a0c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c96865e4.html title=C語言經典100例004-統計各個年齡階段的人數>C語言經典100例004-統計各個年齡階段的人數</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a90a489a.html alt=JAVA中多態的概念和應用，通過案例分析成員變量、方法的訪問特點 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/15310942260931dda577a75 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a90a489a.html title=JAVA中多態的概念和應用，通過案例分析成員變量、方法的訪問特點>JAVA中多態的概念和應用，通過案例分析成員變量、方法的訪問特點</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7f03f742.html alt=正切和差角變形式應用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/e1f38ef5d20445488e9e180576f12a61 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7f03f742.html title=正切和差角變形式應用>正切和差角變形式應用</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>