<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>快速鏈接你的數據 玩轉數據分析 | 极客快訊</title><meta property="og:title" content="快速鏈接你的數據 玩轉數據分析 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/5ef0f0614c3a49708226c190bad0333c"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/30db43b.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/30db43b.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/30db43b.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/30db43b.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/30db43b.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/30db43b.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/30db43b.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/30db43b.html><meta property="article:published_time" content="2020-10-29T20:59:02+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:02+08:00"><meta name=Keywords content><meta name=description content="快速鏈接你的數據 玩轉數據分析"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/30db43b.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>快速鏈接你的數據 玩轉數據分析</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1>第二章 鏈接你的數據</h1><p style=text-align:justify>無論是個人還是企業，需要分析的數據正在變得越來越多，數據的來源也變得越來越多樣，這些待分析的數據往往分散在多個數據庫、文本文件、電子表格，外部數據源中。DataFocus為用戶提供了整合各種數據源的“數據管理”功能模塊，用戶可以通過它連接各種各樣主流的數據庫，也可以上傳或者同步本地excel文件。DataFocus標準版以上產品的數據管理模塊包含了大數據倉庫和內存計算引擎。用戶接入的數據都將以列式存儲的格式保存在數倉中，這保證了分析計算的高效性。</p><p style=text-align:justify><strong>2.1鏈接你的數據</strong></p><p style=text-align:justify><strong>2.1.1 連接本地文件</strong></p><p style=text-align:justify>打開DataFocus系統，點擊左側數據管理，然後點擊右側操作按鈕，點擊導入數據。可導入本地CSV、TXT、XLS、XLSX以及JSON等本地數據文件。選中後點擊上傳，並確認行列屬性是否正確。若行列屬性不正確（如數值保留了字符串格式未轉化為數值格式），則無法進行可視化分析。適用於一些本地已有文件（如一些店鋪數據或是自錄數據表）的分析，或是一些未購買數據庫的企業。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5ef0f0614c3a49708226c190bad0333c></p><p style=text-align:justify>圖2-1 本地數據導入界面</p><p style=text-align:justify>導入本地數據，大小限制為50MB。本地Excel文件經常存在數據不規範的問題，DataFocus的數據導入模塊提供了簡單的數據清理功能，具體操作為在導入數據時點擊高級按鈕，會展開一系列選項，用戶可以設置跳過行、讀取行數、跳過註釋行、拆分列等操作，進行簡單的數據清理。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d22878cbb4434c329e1872a266617e57></p><p style=text-align:justify>圖2-2 本地數據導入高級配置</p><p style=text-align:justify><strong>2.1.2 批量導入Excel數據</strong></p><p style=text-align:justify>對於大量的，經常更新的本地數據源，DataFocus還提供了excel文件批量同步工具。比如有些小企業或工廠經常採用excel進行數據管理，他們將數據存放在某些固定的文件夾中，並定時更新。這種場景，就可以通過設定excel批量同步工具定時將excel數據追加上傳到DataFocus的數據倉庫中進行分析。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/e9b9fecb58654b5198bddce2b651481a></p><p style=text-align:justify>圖2-3批量導入Excel工具的下載</p><p style=text-align:justify>DataFocus Sync tool提供了豐富的數據同步追加功能，以及數據清洗和預處功能，足以允許部分習慣於使用excel進行數據管理的企業平滑的將其數據遷移到DataFocus中來。使用前需要用戶在服務參數配置中填入對應的服務器地址和對應的Key。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/d511f2b5ef85464f93a66c81dcc690d8></p><p style=text-align:justify>圖2- 4 DataFocus Synctool配置界面</p><p style=text-align:justify>服務參數SecretID和SecretKey通過DataFocus系統的用戶頁面點擊用戶標識，生成對應的Key。用戶完成配置連接成功後，同步工具將自動掃描所選文件夾，整理和彙總對應的數據表，如果服務器搭建在雲端，應採用https加密連接方式進行。同步工具還提供了數據清理功能，用戶可以自主配置規則對數據表進行過濾和篩選，這對不規範的excel表非常有用，還可以設定定時導入功能以便用戶定時同步追加數據到DataFocus的服務端。DataFocuaMini及以上版本均支持同步工具的導入。</p><p style=text-align:justify></p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9ff28ebd764d483d819ee4ddefe2a8ee></p><p style=text-align:justify>圖2-5 生成同步工具的key</p><p style=text-align:justify><strong>2.1.3 連接數據庫</strong></p><p style=text-align:justify>點擊左側數據管理模塊，點擊上方數據源按鈕，點擊右側新建數據源，可點擊直連數據和導入數據。需要注意的是，導入數據為數據導入到DataFocus自帶大數據倉庫，直連數據為直接抽取服務器數據進行分析。若是操作大量分析，建議使用導入數據，DataFocus數據倉庫性能可保障分析順暢，否則直連數據分析則依靠對方設備的性能。數據導入後，可點擊上方“開始”則可進行導入，列表可查看導入狀態。</p><p style=text-align:justify>導入數據支持定時更新，更新頻率一般為每天、每週、每月。直連數據可支持實時更新，數據庫中數據有變化，DataFocus中直連的這些表，以及依賴這些表製作的報表等也都能實時更新。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8830e6469df54d269a34486e3529920e></p><p style=text-align:justify>圖2-6 鏈接數據庫</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6a66430658764a8eab9df6c1318da6fc></p><p style=text-align:justify>圖2-7 數據庫鏈接方式</p><p style=text-align:justify></p><p style=text-align:justify><strong>2.1.4 直連數據和導入數據</strong></p><p style=text-align:justify>使用DataFocus進行數據分析需要與數據庫交互，但這與你使用ERP、CRM系統與數據庫交互的形式是完全不一樣的。前者屬於聯機分析處理OLAP（On-Line Analytical Processing）業務，一般需要進行比較複雜的數據庫計算，分析數據量大、維度多；而後者則屬於聯機事務處理OLTP（on-line transaction processing）範疇，主要是基本的、日常的事務處理，例如銷售流水記錄、銀行交易記錄，這類分析要求實時性高，往往只需要簡單的讀寫或者查詢數據庫即可。這是兩種典型的數據庫應用場景。DataFocus連接數據庫時，同時提供了直連數據庫功能和導入數據功能。這兩種不同的功能分別對應著不同的應用場景。</p><p style=text-align:justify><strong>直連數據庫的優點。</strong>有少數場景也需要實時查詢相應的數據，比如用於彙報或展示的數據可視化大屏、用於生產線的數據看板，均需要顯示實時的產量、交易數等。DataFocus提供了直連用戶數據庫的功能，用戶的搜索分析指令將被轉交給用戶業務系統的數據庫進行計算，因此一般此類通過直連數據庫的數據分析複雜性較低，否則會對用戶業務系統數據庫造成壓力。</p><p style=text-align:justify>一般情況下，如果業務系統數據庫穩定性要求極高，或者數據庫壓力過大，不推薦使用數據庫直連方式，這會對用戶的業務造成不可預知的影響。</p><p style=text-align:justify><strong>數據導入的靈活性。</strong>將用戶數據中的數據定時導入到DataFocus的大數據倉庫中，經過模型構建再進行分析，適用於分析、探索大數據（比如上億行數據），或者維度繁多的數據， DataFocus會將這些數據壓縮成列式存儲格式，並調用內存計算引擎進行高速分析，可以獲得極佳的探索分析體驗。</p><p style=text-align:justify>用戶將數據庫中的數據導入DataFocus數據倉庫中進行分析，可以減輕業務系統數據庫的分析壓力，因為數據分析有時候需要對數年的數據，或者多張關聯的數據表進行篩選、聚合、計算，其計算強度往往比業務系統中的業務流程所觸發的數據庫計算強度要高得多，把這些工作放到DataFocus的計算引擎中去執行，高效且可靠，不會對業務系統造成額外的壓力。及時偶爾出錯也不會干擾業務系統的正常運行。</p><p style=text-align:justify>通常，有經驗的用戶會設定DataFocus的定時導入功能從數據庫中抽取數據，根據業務系統數據庫能夠承受的壓力以及決策的時效性需求，制定合理的更新頻率。第一次導入數據時可以全量導入，之後就可以定時增量更新。有時候，如果業務系統的安全性要求較高，可以設置DataFocus從備庫中導入數據。</p><p style=text-align:justify><strong>2.2數據表關聯配置</strong></p><p style=text-align:justify><strong>2.2.1 數據表的關聯關係</strong></p><p style=text-align:justify>進行數據庫記錄時，為了提高效率，需要將數據按業務情況存放到多個數據表中，這些數據表之間彼此通過外鍵關聯的方式鏈接起來，方便進行跨表查詢和分析。DataFocus中支持的典型的數據庫表關聯關係一般有左連接（left join）、右連接（right join）和內鏈接（inner join）三種常用鏈接方式。</p><p style=text-align:justify></p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/710473843c904a45a9260f60557bd1d3><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/790e8a13decd4d2eabfef258d28ae576></p><p style=text-align:justify></p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/57ce42910ba34664abc294114ed76a9d></p><p style=text-align:justify>左關聯（left join） 右關聯（right join）</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8fffca62d440445d8e7f46aaadd42cb5></p><p style=text-align:justify>內關聯（inner join） 全關聯（笛卡爾積）</p><p style=text-align:justify>圖2-8 數據庫關聯方式</p><p style=text-align:justify>從上圖很容易看出，左連接（left join）返回包括左表中的所有記錄和右表中相關聯字段的記錄；右連接（right join）返回包括右表中的所有記錄和左表中關聯字段相等的記錄；內鏈接（inner join）則只返回兩個表中關聯字段相等的行。舉例來說，假設A表記錄了地區及編號，B表記錄了姓名及編號：</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f57e7476b00f40b384afa8900ff7daa8></p><p style=text-align:justify>表2-1 數據關聯表</p><p style=text-align:justify>四種關聯結果分別如下，可以看出第四種關聯結果產生了大量的冗餘信息，稱之為笛卡兒積，這有時候會造成無意義的數據膨脹，創建關聯關係時應該儘量避免。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/de14da6a570d4a84ada3d3b6c7584af7></p><p style=text-align:justify>表2-2 四種數據關聯結果</p><p style=text-align:justify><strong>2.2.2 配置多表關聯</strong></p><p style=text-align:justify>在進行數據分析的時候，經常會出現需要多張表格聯立使用的情況，因此就需要在系統中添加表與表之間的關聯關係。</p><p style=text-align:justify>在數據管理頁面，點擊一張表格，在彈出的表格信息中選擇“關聯關係”，如圖2-4-1所示。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a10e624a30ee4b4ebcbd408bea17602a></p><p style=text-align:justify>圖 2-9 添加關聯關係</p><p style=text-align:justify>點擊“添加關聯”，在彈出的具體的操作界面，如圖2-4-2所示，填寫關聯名、維度表、連接類型、連接篩選（選填）、源列、目標列的內容。</p><p style=text-align:justify>維度表就是指要與該表建立關聯關係的數據表，點擊維度表的輸入框會出現系統裡現有的前7張表格，可以直接選擇或者輸入表名選擇自己想要關聯的表；連接類型分為三種：內連接、左連接及右連接；源列和目標列就是關聯兩張表格的數據列。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5f5b7fe4d682404cadd9c4290057a8b1></p><p style=text-align:justify>圖 2-10 填寫關聯信息</p><p style=text-align:justify>點擊“添加關聯”，就會在“關聯關係”的頁面出現兩張表格的表名以及箭頭符號，代表了關聯關係的方向和關聯的表格信息，如圖2-4-3所示。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/fb4843b55ee34862919e706bd46883bf></p><p style=text-align:justify>圖 2-11 關聯條件</p><p style=text-align:justify>關聯好的兩張表格也會在數據管理頁面通過兩個紅色小箭頭標註，如圖2-4-4所示。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/845b3777a1004980945e4295c108a3bc></p><p style=text-align:justify>圖 2-12 關聯展示</p><p style=text-align:justify><strong>2.2.3 配置條件關聯</strong></p><p style=text-align:justify>為了更靈活的分析，有時候關聯關係的配置需要設定條件，DataFocus中可以通過設定鏈接篩選條件實現按條件的數據關聯，這在數據量非常大的情況下進行特定的分析非常有益，可以有效的降低數據量，提升分析效率。比如，如果待關聯的兩張表，通過時間列關聯，但是用戶只想分析某個特定時間段的數據，就可以設定時間在某個範圍的關聯條件。</p><p style=text-align:justify></p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/103cc2837ef34cc68ae51f53e584cdd7></p><p style=text-align:justify>圖2-13 條件關聯配置</p><p style=text-align:justify><strong>2.2.4扇形陷阱和斷層陷阱</strong></p><p style=text-align:justify>根據上面的章節介紹，我們知道兩個表要建立連接一定要存在主外鍵關係， 例如上節所述的表A和表B就是通過編號這個外鍵建立關聯關係的。但有些時候，一些關係型數據庫設計不規範，兩個表需要關聯，但是沒有直接主外鍵，藉助第三個表進行關聯，按照其設置好關聯關係後，構建模型容易造成扇形陷阱（<strong>Fan Traps）</strong>。</p><p style=text-align:justify>扇形陷阱通常是產生於一些事實表（Fact Table）擁有多個一對多的關聯，好像扇子散開一樣，而關聯在一起的實體間的關聯性讓人產生混淆。比如：Instructors、Students、Courses這三個實體，其中一個Instructor可以有多個Student，一個Student有多個Course，一個Instructor也可以有多個Course，這時如果把關聯設計為下圖的形式：</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3a665054839a489fb03a3d6cdc989f12></p><p style=text-align:justify>圖2-14 造成扇形陷阱的事實表關聯設計</p><p style=text-align:justify>這樣就出現了扇形陷阱：其中student與course的關係非常混亂了，成了多對多。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0ccbc2a061b24abc93ae1b7c6ba8cd99></p><p style=text-align:justify>圖2-15 導致扇形陷阱的關聯關係</p><p style=text-align:justify><strong>斷層陷阱（Chasm Traps）</strong>，還有一種情況是事實表之間該存在的關係卻沒有體現出來，兩個事實表並沒有辦法找到一條路徑來連接。比如：Students、Textbooks、Courses三個實體，其中一個Student可以有多個Textbook，一個Student也可以有多個Course，如果把關聯設計為下圖的形式：</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/329105dcdf1d48328998228318eb5f8b></p><p style=text-align:justify>圖2-16 造成斷層陷阱的事實表關聯設計</p><p style=text-align:justify></p><p style=text-align:justify>這就產生了斷層陷阱：由於Student可以沒有Textbook，Textbook就不知道是屬於哪個Course的了。</p><p style=text-align:justify></p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/61562ab40b5d40f5aa3ac214b9237c3b></p><p style=text-align:justify>圖2-17 導致斷層陷阱的關聯關係</p><p style=text-align:justify><strong>2.2.5 數據表關聯約束</strong></p><p style=text-align:justify>各種數據設計缺陷，如上節所述的扇形陷阱（Fan Traps）和斷層陷阱（Chasm Traps）最為常見，此外還有一些如閉環陷阱之類的問題，都會導致數據庫表關聯後SQL語句無法執行的問題。為了保障DataFocus能夠正常運行，用戶必須儘量避免以上問題的發生，在配置關聯關係時，DataFocus系統對部分以上問題進行了預處理，這些處理是不徹底的（也無法做到完美），其目的是最大限度的適應用戶的數據庫現狀，即便如此，用戶依然應該儘量優化數據庫設計，規避此類缺陷發生。</p><p style=text-align:justify><strong>關聯環路</strong>：用戶在配置數據表關聯關係的時候應避免配置成關聯環路（如圖2-19所示），A->B->C->A關聯環路會導致事實表和緯度表關聯關係混亂，DataFocus系統無法根據這樣的關聯關係構造出能夠執行的SQL語句，所以DataFocus系統不支持配置關聯環路。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/cfcdd11ce1654c06aa8d4274138d3f60></p><p style=text-align:justify>圖2-18 關聯環路</p><p style=text-align:justify></p><p style=text-align:justify><strong>關聯節點閉合</strong>：用戶在配置數據表關聯關係的時候有可能把某一個維度表配置成閉合節點（如圖2-20所示）A->C而且A->B->C則維度表C為一個閉合節點，正常來說有閉合節點的情況下構建關聯查詢SQL會造成C表重複關聯的錯誤，DataFocus對此種狀況做了一定的適配。把這種關聯關係拆分成了A->C1和A->B-C2（如圖2-21所示）其中C1和C2就是C表的但是使用的不同的別名，這樣可以把構建出來可以執行的關聯SQL。但是如果閉合節點C以下又有很多維度表關聯的話會導致構造關聯SQL的時候別名過多，所以暫時不支持閉合節點C以下關聯其他維度表。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/60db861d4bf64299adb6660fadd4e800></p><p style=text-align:justify>圖2-19 關聯節點閉合</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/64c9a0eec5ea4d898b38f36c6ec464c5></p><p style=text-align:justify>圖2-20 關聯節點閉合適配</p><p style=text-align:justify></p><p style=text-align:justify></p><p style=text-align:justify><strong>扇形陷阱/斷層陷阱</strong>：用戶在配置關聯關係的時候應儘量避免配置成扇形陷阱和斷層陷阱，如果用戶配置關聯關係造成了扇形陷阱，DataFocus為了防止扇形陷阱導致的數據極度膨脹會做一定的檢測，如果檢測到用戶可能配置造成了扇形陷阱，會對關聯關係做一定的適配處理。如圖2-21 A->B和A->C表如果存在扇形陷阱，則B和C的關係將會變的混亂，不適合在一起查詢，當出現這種情況，DataFocus中會做一定適配只能讓A表和B表同時查詢，A表和C表同時查詢，B表和C表不能同時查詢。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0dd69d5505b44e1f9dd579bb735534d1></p><p style=text-align:justify>圖2-21 扇形陷阱適配</p><p style=text-align:justify></p><p style=text-align:justify><strong>2.3 數據庫模型</strong></p><p style=text-align:justify><strong>2.3.1數據類型介紹</strong></p><p style=text-align:justify>存儲在關係數據庫（RMDBS）中的一般以結構化數據居多，這部分數據也最容易拿來進行分析和可視化。結構化數據一般都是以二維表的形式存儲，如下表所示。在DataFocus中，我們將“姓名”、“性別”、“年齡”稱作列名，對應列名下的值，如“張三”“17”等，稱之為列中值，列名是進行搜索分析的重要元素，列中值則經常用來進行過濾和篩選。</p><p style=text-align:justify></p><p style=text-align:justify><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5808094a19d74e93b8a292ce48bda8ba></p><p style=text-align:justify>表2-3 二位數據表</p><p style=text-align:justify>列名大致分為屬性列（attribute）和數值列（measure），其中屬性列一般分為字符串（string）、日期（timestamp）、地理位置（Geomap）幾大類，數值列則一般為int、double。</p><p style=text-align:justify></p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/92d20577fcde4f649ed8d170f7f434af></p><p style=text-align:justify>圖2-22 屬性列和數值列</p><p style=text-align:justify></p><p style=text-align:justify>數據導入DataFocus系統中時，如果是從數據庫中導入數據，系統會自動繼承數據表的各項屬性，一般不需要用戶干預，如果是從本地導入excel數據，系統會判斷和識別數據類型，但地理位置類型數據，需要用戶選擇設定對應的省、市、區，聚合方式選擇成none。如果是經緯度數據，則需要配置成LATITUE或者LONGITUDE。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a090adc0c889404b9dc4f9eb938da0e6></p><p style=text-align:justify>圖2-23 地理位置類數據</p><p style=text-align:justify>不同的列屬性對應著不同的數據庫聚合操作。屬性列默認在數據分析時不會自動聚合，如有需要則可以進行計數（統計數量）或去重計數；數值列則可以進行求最大值、最小值、平均值、求和、標準差、方差、計數等各種操作，數據分析時會默認進行聚合分析，一般不選擇的情況下，會默認進行求和操作，如果不希望分析時自動聚合數據，則可以選擇none，DataFocus系統默認不進行任何聚合操作。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/74edb72207a441cf9b7f26d793a045c8></p><p style=text-align:justify>圖2-24 屬性列的聚合操作</p><p style=text-align:justify>列的不同屬性，在DataFocus中加載數據後，會以不同的圖標顯示出來，也意味著不同的關鍵詞操作，比如，對於字符串類型的屬性列，就可以用“姓名開頭是張的”進行查詢，數值列則可以進行排序和聚合，比如“成本的平均值排名前三的工序”。而特殊類型如日期列則可以直接提問“每月銷售額”，地理位置圖則直接以地圖形式呈現可視化結果。</p><p style=text-align:justify></p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/14456be0aa064f5284c558bd93563b9c></p><p style=text-align:justify>圖2-25 數據類型的標識</p><p style=text-align:justify><strong>2.3.2星形模型和雪花模型</strong></p><p style=text-align:justify>企業的數據庫一般由多個維度表（Dimision table）和事實表（Fact table）組成，這些數據表之間的關聯方式多種多樣。在多維分析的商業智能解決方案中經常會用到星型數據模型（Star Schema）和雪花模型（Snowflake Schema），DataFocus同時支持這兩種數據模型，鑑於著兩種數據模型在不同市場場景下各有優劣，建議用戶在設計數據邏輯模型時，應該認真考慮使用何種模型。</p><p style=text-align:justify><strong>星型數據模型</strong>，當所有維度表都直接連接到“ 事實表”上時，整個表結構就像星星一樣，故將該模型稱為星型模型。星型模型是一種非正規化的結構，多維數據集的每一個維度都直接與事實表相連接，不存在漸變維度，所以數據有一定的冗餘，如在地域維度表中，存在國家 A 省 B 的城市 C 以及國家 A 省 B 的城市 D 兩條記錄，那麼國家 A 和省 B 的信息分別存儲了兩次，即存在冗餘。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b20bf19b04824b0ab431438cdcfe8650></p><p style=text-align:justify>圖2-26 星型數據模型</p><p style=text-align:justify><strong>雪花模型，</strong>當有一個或多個維度表沒有直接連接到事實表上，而是通過其他維表連接到事實表上時，其圖解就像多個雪花連接在一起，故稱雪花模型。雪花模型是對星型模型的擴展。它對星型模型的維度表進一步層次化，原有的各維度表可能被擴展為小的事實表，形成一些局部的 " 層次 " 區域，這些被分解的表都連接到主維度表而不是事實表。如圖 2，將地域維表又分解為國家，省份，城市等維表。它的優點是 : 通過最大限度地減少數據存儲量以及聯合較小的維表來改善查詢性能。雪花型結構去除了數據冗餘。</p><p style=text-align:justify></p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/cb6cf21570a5454fa670ba763bfcf475></p><p style=text-align:justify></p><p style=text-align:justify>圖2-27 雪花型數據模型</p><p style=text-align:justify>星型模型因為數據的冗餘所以很多統計查詢不需要做外部的連接，因此一般情況下效率比雪花型模型要高。星型結構不用考慮很多正規化的因素，設計與實現都比較簡單。雪花型模型由於去除了冗餘，有些統計就需要通過表的聯接才能產生，所以效率不一定有星型模型高。正規化也是一種比較複雜的過程，相應的數據庫結構設計、數據的 ETL、以及後期的維護都要複雜一些。因此在冗餘可以接受的前提下，實際運用中星型模型使用更多，也更有效率。</p><p style=text-align:justify>總體來講，雪花模型使得進行復雜維度分析更加容易，比如“針對特定的廣告主，有哪些客戶或者公司是在線的?”星形模型做簡單的指標分析更適合，比如“銷售員張三的銷售額?”</p><p style=text-align:justify><strong>2.3.3數據模型構建</strong></p><p style=text-align:justify>將數據導入DataFocus中以後，必須先按照設計的數據模型進行表間關聯配置。在DataFocusMini以及DataFocus Public版本中，由於沒有大數據倉庫，不需要進行模型就見就可以立即進行分析。但是這種方式不能處理數據量巨大的情況；DataFocusStandard及以上版本則提供了模型構建功能，如下圖所示，點擊進行模型構建，100%完成後即可進行大數據分析了，後續數據庫增量更新，不需要重新構建模型，但如果更改了數據模型，比如改變某些表之間的關聯關係，則必須重新構建模型才能進行聯表分析。</p><p style=text-align:justify></p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/41657632b2084d70b121187e6546d187></p><p style=text-align:justify>圖2-28 構建數據模型</p><p style=text-align:justify>當模型構建的狀態變成SUCCESS，進度為100%時，代表模型構建成功，如圖2-4-6所示。</p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7c68e84366a94513a64ea24a7c880a08></p><p style=text-align:justify>圖 2-29 模型構建成功</p><p style=text-align:justify>關聯好的多張表格可以在搜索頁面進行多表聯立搜索，如圖2-4-7所示。</p><p style=text-align:justify>用戶在創建表關聯關係的時候，表關聯不能出現迴路和閉環。</p><p style=text-align:justify>圖 2-30 關聯搜索</p><p style=text-align:justify></p><p style=text-align:justify></p><p class=pgc-img><img alt="快速鏈接你的數據 玩轉數據分析" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/04d3d2734217449b80bc9afff97a45fc></p><p style=text-align:justify><br></p></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>數據</a></li><li><a>鏈接</a></li><li><a>玩轉</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/3f88d03.html alt=軟妹子帶你玩轉Python數據可視化，座標軸位置自定義 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/320d0002dddbdff5c4c8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3f88d03.html title=軟妹子帶你玩轉Python數據可視化，座標軸位置自定義>軟妹子帶你玩轉Python數據可視化，座標軸位置自定義</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b41ad4d.html alt=軟妹子帶你玩轉Python數據可視化，座標軸刻度比例尺自定義 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/321200016c64dce4d9ca style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b41ad4d.html title=軟妹子帶你玩轉Python數據可視化，座標軸刻度比例尺自定義>軟妹子帶你玩轉Python數據可視化，座標軸刻度比例尺自定義</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a411ca8.html alt=軟妹子帶你玩轉Python數據可視化，座標軸方向及範圍設置 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/37c40003c719bfd4bde1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a411ca8.html title=軟妹子帶你玩轉Python數據可視化，座標軸方向及範圍設置>軟妹子帶你玩轉Python數據可視化，座標軸方向及範圍設置</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2d12804e.html alt=[玩轉MySQL之九]MySQL實現ACID之原子性 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/bdb044d821f74107a3fd9119fc34c642 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2d12804e.html title=[玩轉MySQL之九]MySQL實現ACID之原子性>[玩轉MySQL之九]MySQL實現ACID之原子性</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/862c99dd.html alt=數據告訴你，為什麼要在上升趨勢買入和下降趨勢賣出 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3e507bb24abc482fb28df1121a7ee097 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/862c99dd.html title=數據告訴你，為什麼要在上升趨勢買入和下降趨勢賣出>數據告訴你，為什麼要在上升趨勢買入和下降趨勢賣出</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1f742b21.html alt="數據科學家常犯的 10 個編程錯誤" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1f742b21.html title="數據科學家常犯的 10 個編程錯誤">數據科學家常犯的 10 個編程錯誤</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d5773fc2.html alt=數據科學家常遇到的10個錯誤 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/59f660bac8b541888e71459b604ba733 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d5773fc2.html title=數據科學家常遇到的10個錯誤>數據科學家常遇到的10個錯誤</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5ff7d77e.html alt=WORD表格的數據老闆讓增加合計，同事用計算器計算，我3秒鐘搞定 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f120ed2c1ed549e39bfa60bb3a86d591 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5ff7d77e.html title=WORD表格的數據老闆讓增加合計，同事用計算器計算，我3秒鐘搞定>WORD表格的數據老闆讓增加合計，同事用計算器計算，我3秒鐘搞定</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cea55527.html alt="多列數據合併一列，還在用數據透視就out了，用=號只要三步完成" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/7aa6ee1b961f467e8090ed56f45c110f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cea55527.html title="多列數據合併一列，還在用數據透視就out了，用=號只要三步完成">多列數據合併一列，還在用數據透視就out了，用=號只要三步完成</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/37396ded.html alt=數據結構系列：哈希表？這涉及的是“加密/區塊鏈”等技術的核心 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3609570de59a49a9be5667dd9a637f65 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/37396ded.html title=數據結構系列：哈希表？這涉及的是“加密/區塊鏈”等技術的核心>數據結構系列：哈希表？這涉及的是“加密/區塊鏈”等技術的核心</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0e2547f1.html alt=「數據結構」Hash表 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/617a6d43032e4efbac6b996c9bb5ab11 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0e2547f1.html title=「數據結構」Hash表>「數據結構」Hash表</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b37254e1.html alt=備戰秋招——算法與數據結構（5） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ab6859411bd8435bb2616d6fef468556 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b37254e1.html title=備戰秋招——算法與數據結構（5）>備戰秋招——算法與數據結構（5）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f605b4b8.html alt=懂了數據結構框架思維，一切算法不過是紙老虎 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ad2c8a60d9634e0aa36b5d8a664de355 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f605b4b8.html title=懂了數據結構框架思維，一切算法不過是紙老虎>懂了數據結構框架思維，一切算法不過是紙老虎</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e03941dc.html alt=數據結構一(哈希表)想進大廠的必備知識點 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/86ad7a2f62cc48f98bbe53b42ca4bf9a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e03941dc.html title=數據結構一(哈希表)想進大廠的必備知識點>數據結構一(哈希表)想進大廠的必備知識點</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/385a3c55.html alt="數據結構中的 Hash 表" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/0e43812c-6f05-4cf6-af7e-18011d0a316a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/385a3c55.html title="數據結構中的 Hash 表">數據結構中的 Hash 表</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>