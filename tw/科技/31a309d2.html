<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>ä¼æ¥­APIæ¥å£è¨­è¨ˆ(tokenã€timestampã€sign)ä¹‹å…·é«”å¯¦ç¾ | æå®¢å¿«è¨Š</title><meta property="og:title" content="ä¼æ¥­APIæ¥å£è¨­è¨ˆ(tokenã€timestampã€sign)ä¹‹å…·é«”å¯¦ç¾ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/030192793c5048239b469f5e5db8b18d"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/31a309d2.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/31a309d2.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/31a309d2.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/31a309d2.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/31a309d2.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/31a309d2.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/31a309d2.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/31a309d2.html><meta property="article:published_time" content="2020-11-14T21:00:28+08:00"><meta property="article:modified_time" content="2020-11-14T21:00:28+08:00"><meta name=Keywords content><meta name=description content="ä¼æ¥­APIæ¥å£è¨­è¨ˆ(tokenã€timestampã€sign)ä¹‹å…·é«”å¯¦ç¾"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/31a309d2.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>ä¼æ¥­APIæ¥å£è¨­è¨ˆ(tokenã€timestampã€sign)ä¹‹å…·é«”å¯¦ç¾</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right><strong>æœ¬è™Ÿä¸»è¦ç”¨æ–¼åˆ†äº«ä¼æ¥­ä¸­å¸¸ç”¨çš„æŠ€è¡“ï¼Œæ›´åŠ å´é‡æ–¼å¯¦ç”¨ï¼Œæ­¡è¿é—œæ³¨ã€æ”¶è—ï¼Œä¾¿æ–¼ç€è¦½å…¶å®ƒæ›´å¤šå¯¦ç”¨çš„æ­·å²æ–‡ç« ã€‚</strong></h1><div class=pgc-img><img alt=ä¼æ¥­APIæ¥å£è¨­è¨ˆ(tokenã€timestampã€sign)ä¹‹å…·é«”å¯¦ç¾ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/030192793c5048239b469f5e5db8b18d><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><strong>ä¸€ï¼štoken ç°¡ä»‹</strong></h1><p>Tokenï¼šè¨ªå•ä»¤ç‰Œaccess token, ç”¨æ–¼æ¥å£ä¸­, ç”¨æ–¼æ¨™è­˜æ¥å£èª¿ç”¨è€…çš„èº«ä»½ã€æ†‘è­‰ï¼Œæ¸›å°‘ç”¨æˆ¶åå’Œå¯†ç¢¼çš„å‚³è¼¸æ¬¡æ•¸ã€‚ä¸€èˆ¬æƒ…æ³ä¸‹å®¢æˆ¶ç«¯(æ¥å£èª¿ç”¨æ–¹)éœ€è¦å…ˆå‘æœå‹™å™¨ç«¯ç”³è«‹ä¸€å€‹æ¥å£èª¿ç”¨çš„è³¬è™Ÿï¼Œæœå‹™å™¨æœƒçµ¦å‡ºä¸€å€‹appIdå’Œä¸€å€‹key, keyç”¨æ–¼åƒæ•¸ç°½åä½¿ç”¨ï¼Œæ³¨æ„keyä¿å­˜åˆ°å®¢æˆ¶ç«¯ï¼Œéœ€è¦åšä¸€äº›å®‰å…¨è™•ç†ï¼Œé˜²æ­¢æ´©éœ²ã€‚</p><p>Tokençš„å€¼ä¸€èˆ¬æ˜¯UUIDï¼Œæœå‹™ç«¯ç”ŸæˆTokenå¾Œéœ€è¦å°‡tokenåšç‚ºkeyï¼Œå°‡ä¸€äº›å’Œtokené—œè¯çš„ä¿¡æ¯ä½œç‚ºvalueä¿å­˜åˆ°ç·©å­˜æœå‹™å™¨ä¸­(redis)ï¼Œç•¶ä¸€å€‹è«‹æ±‚éä¾†å¾Œï¼Œæœå‹™å™¨å°±å»ç·©å­˜æœå‹™å™¨ä¸­æŸ¥è©¢é€™å€‹Tokenæ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨å‰‡èª¿ç”¨æ¥å£ï¼Œä¸å­˜åœ¨è¿”å›æ¥å£éŒ¯èª¤ï¼Œä¸€èˆ¬é€šéæ””æˆªå™¨æˆ–è€…éæ¿¾å™¨ä¾†å¯¦ç¾ï¼ŒTokenåˆ†ç‚ºå…©ç¨®ï¼š</p><p>API Token(æ¥å£ä»¤ç‰Œ): ç”¨æ–¼è¨ªå•ä¸éœ€è¦ç”¨æˆ¶ç™»éŒ„çš„æ¥å£ï¼Œå¦‚ç™»éŒ„ã€è¨»å†Šã€ä¸€äº›åŸºæœ¬æ•¸æ“šçš„ç²å–ç­‰ã€‚ ç²å–æ¥å£ä»¤ç‰Œéœ€è¦æ‹¿appIdã€timestampå’Œsignä¾†æ›ï¼Œsign=åŠ å¯†(timestamp+key)</p><p>USER Token(ç”¨æˆ¶ä»¤ç‰Œ): ç”¨æ–¼è¨ªå•éœ€è¦ç”¨æˆ¶ç™»éŒ„ä¹‹å¾Œçš„æ¥å£ï¼Œå¦‚ï¼šç²å–æˆ‘çš„åŸºæœ¬ä¿¡æ¯ã€ä¿å­˜ã€ä¿®æ”¹ã€åˆªé™¤ç­‰æ“ä½œã€‚ç²å–ç”¨æˆ¶ä»¤ç‰Œéœ€è¦æ‹¿ç”¨æˆ¶åå’Œå¯†ç¢¼ä¾†æ›</p><p>é—œæ–¼Tokençš„æ™‚æ•ˆæ€§ï¼štokenå¯ä»¥æ˜¯ä¸€æ¬¡æ€§çš„ã€ä¹Ÿå¯ä»¥åœ¨ä¸€æ®µæ™‚é–“ç¯„åœå…§æ˜¯æœ‰æ•ˆçš„ï¼Œå…·é«”ä½¿ç”¨å“ªç¨®çœ‹æ¥­å‹™éœ€è¦ã€‚</p><p>ä¸€èˆ¬æƒ…æ³ä¸‹æ¥å£æœ€å¥½ä½¿ç”¨httpså”è­°ï¼Œå¦‚æœä½¿ç”¨httpå”è­°ï¼ŒTokenæ©Ÿåˆ¶åªæ˜¯ä¸€ç¨®æ¸›å°‘è¢«é»‘çš„å¯èƒ½æ€§ï¼Œå…¶å¯¦åªèƒ½é˜²å›å­ä¸èƒ½é˜²å°äººã€‚</p><p>ä¸€èˆ¬tokenã€timestampå’Œsign ä¸‰å€‹åƒæ•¸æœƒåœ¨æ¥å£ä¸­æœƒåŒæ™‚ä½œç‚ºåƒæ•¸å‚³éï¼Œæ¯å€‹åƒæ•¸éƒ½æœ‰å„è‡ªçš„ç”¨é€”ã€‚</p><h1 class=pgc-h-arrow-right><strong>äºŒï¼štimestamp ç°¡ä»‹</strong></h1><p>timestamp: æ™‚é–“æˆ³ï¼Œæ˜¯å®¢æˆ¶ç«¯èª¿ç”¨æ¥å£æ™‚å°æ‡‰çš„ç•¶å‰æ™‚é–“æˆ³ï¼Œæ™‚é–“æˆ³ç”¨æ–¼é˜²æ­¢DoSæ”»æ“Šã€‚ç•¶é»‘å®¢åŠ«æŒäº†è«‹æ±‚çš„urlå»DoSæ”»æ“Šï¼Œæ¯æ¬¡èª¿ç”¨æ¥å£æ™‚æ¥å£éƒ½æœƒåˆ¤æ–·æœå‹™å™¨ç•¶å‰ç³»çµ±æ™‚é–“å’Œæ¥å£ä¸­å‚³çš„çš„timestampçš„å·®å€¼ï¼Œå¦‚æœé€™å€‹å·®å€¼è¶…éæŸå€‹è¨­ç½®çš„æ™‚é–“(å‡å¦‚5åˆ†é˜)ï¼Œé‚£éº¼é€™å€‹è«‹æ±‚å°‡è¢«æ””æˆªæ‰ï¼Œå¦‚æœåœ¨è¨­ç½®çš„è¶…æ™‚æ™‚é–“ç¯„åœå…§ï¼Œæ˜¯ä¸èƒ½é˜»æ­¢DoSæ”»æ“Šçš„ã€‚ timestampæ©Ÿåˆ¶åªèƒ½æ¸›è¼•DoSæ”»æ“Šçš„æ™‚é–“ï¼Œç¸®çŸ­æ”»æ“Šæ™‚é–“ã€‚å¦‚æœé»‘å®¢ä¿®æ”¹äº†æ™‚é–“æˆ³çš„å€¼å¯é€šésignç°½åæ©Ÿåˆ¶ä¾†è™•ç†ã€‚</p><p>DoS</p><p>DoSæ˜¯Denial of Serviceçš„ç°¡ç¨±ï¼Œå³æ‹’çµ•æœå‹™ï¼Œé€ æˆDoSçš„æ”»æ“Šè¡Œç‚ºè¢«ç¨±ç‚ºDoSæ”»æ“Šï¼Œå…¶ç›®çš„æ˜¯ä½¿è¨ˆç®—æ©Ÿæˆ–ç¶²çµ¡ç„¡æ³•æä¾›æ­£å¸¸çš„æœå‹™ã€‚æœ€å¸¸è¦‹çš„DoSæ”»æ“Šæœ‰è¨ˆç®—æ©Ÿç¶²çµ¡å¸¶å¯¬æ”»æ“Šå’Œé€£é€šæ€§æ”»æ“Šã€‚</p><p>DoSæ”»æ“Šæ˜¯æŒ‡æ•…æ„çš„æ”»æ“Šç¶²çµ¡å”è­°å¯¦ç¾çš„ç¼ºé™·æˆ–ç›´æ¥é€šéé‡è »æ‰‹æ®µæ®˜å¿åœ°è€—ç›¡è¢«æ”»æ“Šå°è±¡çš„è³‡æºï¼Œç›®çš„æ˜¯è®“ç›®æ¨™è¨ˆç®—æ©Ÿæˆ–ç¶²çµ¡ç„¡æ³•æä¾›æ­£å¸¸çš„æœå‹™æˆ–è³‡æºè¨ªå•ï¼Œä½¿ç›®æ¨™ç³»çµ±æœå‹™ç³»çµ±åœæ­¢éŸ¿æ‡‰ç”šè‡³å´©æ½°ï¼Œè€Œåœ¨æ­¤æ”»æ“Šä¸­ä¸¦ä¸åŒ…æ‹¬ä¾µå…¥ç›®æ¨™æœå‹™å™¨æˆ–ç›®æ¨™ç¶²çµ¡è¨­å‚™ã€‚é€™äº›æœå‹™è³‡æºåŒ…æ‹¬ç¶²çµ¡å¸¶å¯¬ï¼Œæ–‡ä»¶ç³»çµ±ç©ºé–“å®¹é‡ï¼Œé–‹æ”¾çš„é€²ç¨‹æˆ–è€…å…è¨±çš„é€£æ¥ã€‚é€™ç¨®æ”»æ“Šæœƒå°è‡´è³‡æºçš„åŒ±ä¹ï¼Œç„¡è«–è¨ˆç®—æ©Ÿçš„è™•ç†é€Ÿåº¦å¤šå¿«ã€å…§å­˜å®¹é‡å¤šå¤§ã€ç¶²çµ¡å¸¶å¯¬çš„é€Ÿåº¦å¤šå¿«éƒ½ç„¡æ³•é¿å…é€™ç¨®æ”»æ“Šå¸¶ä¾†çš„å¾Œæœã€‚</p><p>Pingflood: è©²æ”»æ“Šåœ¨çŸ­æ™‚é–“å…§å‘ç›®çš„ä¸»æ©Ÿç™¼é€å¤§é‡pingåŒ…ï¼Œé€ æˆç¶²çµ¡å µå¡æˆ–ä¸»æ©Ÿè³‡æºè€—ç›¡ã€‚</p><p>Synflood: è©²æ”»æ“Šä»¥å¤šå€‹éš¨æ©Ÿçš„æºä¸»æ©Ÿåœ°å€å‘ç›®çš„ä¸»æ©Ÿç™¼é€SYNåŒ…ï¼Œè€Œåœ¨æ”¶åˆ°ç›®çš„ä¸»æ©Ÿçš„SYN ACKå¾Œä¸¦ä¸è¿´æ‡‰ï¼Œé€™æ¨£ï¼Œç›®çš„ä¸»æ©Ÿå°±ç‚ºé€™äº›æºä¸»æ©Ÿå»ºç«‹äº†å¤§é‡çš„é€£æ¥éšŠåˆ—ï¼Œè€Œä¸”ç”±æ–¼æ²’æœ‰æ”¶åˆ°ACKä¸€ç›´ç¶­è­·è‘—é€™</p><p>äº›éšŠåˆ—ï¼Œé€ æˆäº†è³‡æºçš„å¤§é‡æ¶ˆè€—è€Œä¸èƒ½å‘æ­£å¸¸è«‹æ±‚æä¾›æœå‹™ã€‚</p><p>Smurfï¼šè©²æ”»æ“Šå‘ä¸€å€‹å­ç¶²çš„å»£æ’­åœ°å€ç™¼ä¸€å€‹å¸¶æœ‰ç‰¹å®šè«‹æ±‚ï¼ˆå¦‚ICMPè¿´æ‡‰è«‹æ±‚ï¼‰çš„åŒ…ï¼Œä¸¦ä¸”å°‡æºåœ°å€å½è£æˆæƒ³è¦æ”»æ“Šçš„ä¸»æ©Ÿåœ°å€ã€‚å­ç¶²ä¸Šæ‰€æœ‰ä¸»æ©Ÿéƒ½å›æ‡‰å»£æ’­åŒ…è«‹æ±‚è€Œå‘è¢«æ”»æ“Šä¸»æ©Ÿç™¼åŒ…ï¼Œä½¿è©²ä¸»æ©Ÿå—åˆ°æ”»æ“Šã€‚</p><p>Land-basedï¼šæ”»æ“Šè€…å°‡ä¸€å€‹åŒ…çš„æºåœ°å€å’Œç›®çš„åœ°å€éƒ½è¨­ç½®ç‚ºç›®æ¨™ä¸»æ©Ÿçš„åœ°å€ï¼Œç„¶å¾Œå°‡è©²åŒ…é€šéIPæ¬ºé¨™çš„æ–¹å¼ç™¼é€çµ¦è¢«æ”»æ“Šä¸»æ©Ÿï¼Œé€™ç¨®åŒ…å¯ä»¥é€ æˆè¢«æ”»æ“Šä¸»æ©Ÿå› è©¦åœ–èˆ‡è‡ªå·±å»ºç«‹é€£æ¥è€Œé™·å…¥æ­»å¾ªç’°ï¼Œå¾è€Œå¾ˆå¤§ç¨‹åº¦åœ°é™ä½äº†ç³»çµ±æ€§èƒ½ã€‚</p><p>Ping of Deathï¼šæ ¹æ“šTCP/IPçš„è¦ç¯„ï¼Œä¸€å€‹åŒ…çš„é•·åº¦æœ€å¤§ç‚º65536å­—ç¯€ã€‚å„˜ç®¡ä¸€å€‹åŒ…çš„é•·åº¦ä¸èƒ½è¶…é65536å­—ç¯€ï¼Œä½†æ˜¯ä¸€å€‹åŒ…åˆ†æˆçš„å¤šå€‹ç‰‡æ®µçš„ç–ŠåŠ å»èƒ½åšåˆ°ã€‚ç•¶ä¸€å€‹ä¸»æ©Ÿæ”¶åˆ°äº†é•·åº¦å¤§æ–¼65536å­—ç¯€çš„åŒ…æ™‚ï¼Œå°±æ˜¯å—åˆ°äº†Ping of Deathæ”»æ“Šï¼Œè©²æ”»æ“Šæœƒé€ æˆä¸»æ©Ÿçš„å®•æ©Ÿã€‚</p><p>Teardropï¼šIPæ•¸æ“šåŒ…åœ¨ç¶²çµ¡å‚³éæ™‚ï¼Œæ•¸æ“šåŒ…å¯ä»¥åˆ†æˆæ›´å°çš„ç‰‡æ®µã€‚æ”»æ“Šè€…å¯ä»¥é€šéç™¼é€å…©æ®µï¼ˆæˆ–è€…æ›´å¤šï¼‰æ•¸æ“šåŒ…ä¾†å¯¦ç¾TearDropæ”»æ“Šã€‚ç¬¬ä¸€å€‹åŒ…çš„åç§»é‡ç‚º0ï¼Œé•·åº¦ç‚ºNï¼Œç¬¬äºŒå€‹åŒ…çš„åç§»é‡å°æ–¼Nã€‚ç‚ºäº†åˆä½µé€™äº›æ•¸æ“šæ®µï¼ŒTCP/IPå †æ£§æœƒåˆ†é…è¶…ä¹å°‹å¸¸çš„å·¨å¤§è³‡æºï¼Œå¾è€Œé€ æˆç³»çµ±è³‡æºçš„ç¼ºä¹ç”šè‡³æ©Ÿå™¨çš„é‡æ–°å•Ÿå‹•ã€‚</p><p>PingSweepï¼šä½¿ç”¨ICMP Echoè¼ªè©¢å¤šå€‹ä¸»æ©Ÿã€‚</p><h1 class=pgc-h-arrow-right><strong>ä¸‰ï¼šsign ç°¡ä»‹</strong></h1><p>nonceï¼šéš¨æ©Ÿå€¼ï¼Œæ˜¯å®¢æˆ¶ç«¯éš¨æ©Ÿç”Ÿæˆçš„å€¼ï¼Œä½œç‚ºåƒæ•¸å‚³ééä¾†ï¼Œéš¨æ©Ÿå€¼çš„ç›®çš„æ˜¯å¢åŠ signç°½åçš„å¤šè®Šæ€§ã€‚éš¨æ©Ÿå€¼ä¸€èˆ¬æ˜¯æ•¸å­—å’Œå­—æ¯çš„çµ„åˆï¼Œ6ä½é•·åº¦ï¼Œéš¨æ©Ÿå€¼çš„çµ„æˆå’Œé•·åº¦æ²’æœ‰å›ºå®šè¦å‰‡ã€‚</p><p>sign: ä¸€èˆ¬ç”¨æ–¼åƒæ•¸ç°½åï¼Œé˜²æ­¢åƒæ•¸è¢«éæ³•ç¯¡æ”¹ï¼Œæœ€å¸¸è¦‹çš„æ˜¯ä¿®æ”¹é‡‘é¡ç­‰é‡è¦æ•æ„Ÿåƒæ•¸ï¼Œ signçš„å€¼ä¸€èˆ¬æ˜¯å°‡æ‰€æœ‰éç©ºåƒæ•¸æŒ‰ç…§å‡çºŒæ’åºç„¶å¾Œ+token+key+timestamp+nonce(éš¨æ©Ÿæ•¸)æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œç„¶å¾Œä½¿ç”¨æŸç¨®åŠ å¯†ç®—æ³•é€²è¡ŒåŠ å¯†ï¼Œä½œç‚ºæ¥å£ä¸­çš„ä¸€å€‹åƒæ•¸signä¾†å‚³éï¼Œä¹Ÿå¯ä»¥å°‡signæ”¾åˆ°è«‹æ±‚é ­ä¸­ã€‚æ¥å£åœ¨ç¶²çµ¡å‚³è¼¸éç¨‹ä¸­å¦‚æœè¢«é»‘å®¢æŒ¾æŒï¼Œä¸¦ä¿®æ”¹å…¶ä¸­çš„åƒæ•¸å€¼ï¼Œç„¶å¾Œå†ç¹¼çºŒèª¿ç”¨æ¥å£ï¼Œé›–ç„¶åƒæ•¸çš„å€¼è¢«ä¿®æ”¹äº†ï¼Œä½†æ˜¯å› ç‚ºé»‘å®¢ä¸çŸ¥é“signæ˜¯å¦‚ä½•è¨ˆç®—å‡ºä¾†çš„ï¼Œä¸çŸ¥é“signéƒ½æœ‰å“ªäº›å€¼æ§‹æˆï¼Œä¸çŸ¥é“ä»¥æ€æ¨£çš„é †åºæ‹¼æ¥åœ¨ä¸€èµ·çš„ï¼Œæœ€é‡è¦çš„æ˜¯ä¸çŸ¥é“ç°½åå­—ç¬¦ä¸²ä¸­çš„keyæ˜¯ä»€éº¼ï¼Œæ‰€ä»¥é»‘å®¢å¯ä»¥ç¯¡æ”¹åƒæ•¸çš„å€¼ï¼Œä½†æ²’æ³•ä¿®æ”¹signçš„å€¼ï¼Œç•¶æœå‹™å™¨èª¿ç”¨æ¥å£å‰æœƒæŒ‰ç…§signçš„è¦å‰‡é‡æ–°è¨ˆç®—å‡ºsignçš„å€¼ç„¶å¾Œå’Œæ¥å£å‚³éçš„signåƒæ•¸çš„å€¼åšæ¯”è¼ƒï¼Œå¦‚æœç›¸ç­‰è¡¨ç¤ºåƒæ•¸å€¼æ²’æœ‰è¢«ç¯¡æ”¹ï¼Œå¦‚æœä¸ç­‰ï¼Œè¡¨ç¤ºåƒæ•¸è¢«éæ³•ç¯¡æ”¹äº†ï¼Œå°±ä¸åŸ·è¡Œæ¥å£äº†ã€‚</p><h1 class=pgc-h-arrow-right><strong>å››ï¼šé˜²æ­¢é‡è¤‡æäº¤</strong></h1><p>å°æ–¼ä¸€äº›é‡è¦çš„æ“ä½œéœ€è¦é˜²æ­¢å®¢æˆ¶ç«¯é‡è¤‡æäº¤çš„(å¦‚éå†ªç­‰æ€§é‡è¦æ“ä½œ)ï¼Œå…·é«”è¾¦æ³•æ˜¯ç•¶è«‹æ±‚ç¬¬ä¸€æ¬¡æäº¤æ™‚å°‡signä½œç‚ºkeyä¿å­˜åˆ°redisï¼Œä¸¦è¨­ç½®è¶…æ™‚æ™‚é–“ï¼Œè¶…æ™‚æ™‚é–“å’ŒTimestampä¸­è¨­ç½®çš„å·®å€¼ç›¸åŒã€‚ç•¶åŒä¸€å€‹è«‹æ±‚ç¬¬äºŒæ¬¡è¨ªå•æ™‚æœƒå…ˆæª¢æ¸¬redisæ˜¯å¦å­˜åœ¨è©²signï¼Œå¦‚æœå­˜åœ¨å‰‡è­‰æ˜é‡è¤‡æäº¤äº†ï¼Œæ¥å£å°±ä¸å†ç¹¼çºŒèª¿ç”¨äº†ã€‚å¦‚æœsignåœ¨ç·©å­˜æœå‹™å™¨ä¸­å› éæœŸæ™‚é–“åˆ°äº†ï¼Œè€Œè¢«åˆªé™¤äº†ï¼Œæ­¤æ™‚ç•¶é€™å€‹urlå†æ¬¡è«‹æ±‚æœå‹™å™¨æ™‚ï¼Œå› tokençš„éæœŸæ™‚é–“å’Œsignçš„éæœŸæ™‚é–“ä¸€ç›´ï¼ŒsignéæœŸä¹Ÿæ„å‘³è‘—tokenéæœŸï¼Œé‚£æ¨£åŒæ¨£çš„urlå†è¨ªå•æœå‹™å™¨æœƒå› tokenéŒ¯èª¤æœƒè¢«æ””æˆªæ‰ï¼Œé€™å°±æ˜¯ç‚ºä»€éº¼signå’Œtokençš„éæœŸæ™‚é–“è¦ä¿æŒä¸€è‡´çš„åŸå› ã€‚æ‹’çµ•é‡è¤‡èª¿ç”¨æ©Ÿåˆ¶ç¢ºä¿URLè¢«åˆ¥äººæˆªç²äº†ä¹Ÿç„¡æ³•ä½¿ç”¨ï¼ˆå¦‚æŠ“å–æ•¸æ“šï¼‰ã€‚</p><p>å°æ–¼å“ªäº›æ¥å£éœ€è¦é˜²æ­¢é‡è¤‡æäº¤å¯ä»¥è‡ªå®šç¾©å€‹è¨»è§£ä¾†æ¨™è¨˜ã€‚</p><p>æ³¨æ„ï¼š</p><p>æ‰€æœ‰çš„å®‰å…¨æªæ–½éƒ½ç”¨ä¸Šçš„è©±æœ‰æ™‚å€™é›£å…å¤ªéè¤‡é›œï¼Œåœ¨å¯¦éš›é …ç›®ä¸­éœ€è¦æ ¹æ“šè‡ªèº«æƒ…æ³ä½œå‡ºè£å‰ªï¼Œæ¯”å¦‚å¯ä»¥åªä½¿ç”¨ç°½åæ©Ÿåˆ¶å°±å¯ä»¥ä¿è­‰ä¿¡æ¯ä¸æœƒè¢«ç¯¡æ”¹ï¼Œæˆ–è€…å®šå‘æä¾›æœå‹™çš„æ™‚å€™åªç”¨Tokenæ©Ÿåˆ¶å°±å¯ä»¥äº†ã€‚å¦‚ä½•è£å‰ªï¼Œå…¨çœ‹é …ç›®å¯¦éš›æƒ…æ³å’Œå°æ¥å£å®‰å…¨æ€§çš„è¦æ±‚ã€‚</p><h1 class=pgc-h-arrow-right><strong>äº”ï¼šä½¿ç”¨æµç¨‹</strong></h1><p>æ¥å£èª¿ç”¨æ–¹(å®¢æˆ¶ç«¯)å‘æ¥å£æä¾›æ–¹(æœå‹™å™¨)ç”³è«‹æ¥å£èª¿ç”¨è³¬è™Ÿï¼Œç”³è«‹æˆåŠŸå¾Œï¼Œæ¥å£æä¾›æ–¹æœƒçµ¦æ¥å£èª¿ç”¨æ–¹ä¸€å€‹appIdå’Œä¸€å€‹keyåƒæ•¸</p><p>å®¢æˆ¶ç«¯æ”œå¸¶åƒæ•¸appIdã€timestampã€signå»èª¿ç”¨æœå‹™å™¨ç«¯çš„API tokenï¼Œå…¶ä¸­sign=åŠ å¯†(appId + timestamp + key)</p><p>å®¢æˆ¶ç«¯æ‹¿è‘—api_token å»è¨ªå•ä¸éœ€è¦ç™»éŒ„å°±èƒ½è¨ªå•çš„æ¥å£</p><p>ç•¶è¨ªå•ç”¨æˆ¶éœ€è¦ç™»éŒ„çš„æ¥å£æ™‚ï¼Œå®¢æˆ¶ç«¯è·³è½‰åˆ°ç™»éŒ„é é¢ï¼Œé€šéç”¨æˆ¶åå’Œå¯†ç¢¼èª¿ç”¨ç™»éŒ„æ¥å£ï¼Œç™»éŒ„æ¥å£æœƒè¿”å›ä¸€å€‹user_token, å®¢æˆ¶ç«¯æ‹¿è‘—user_token å»è¨ªå•éœ€è¦ç™»éŒ„æ‰èƒ½è¨ªå•çš„æ¥å£</p><p>signçš„ä½œç”¨æ˜¯é˜²æ­¢åƒæ•¸è¢«ç¯¡æ”¹ï¼Œå®¢æˆ¶ç«¯èª¿ç”¨æœå‹™ç«¯æ™‚éœ€è¦å‚³ésignåƒæ•¸ï¼Œæœå‹™å™¨éŸ¿æ‡‰å®¢æˆ¶ç«¯æ™‚ä¹Ÿå¯ä»¥è¿”å›ä¸€å€‹signç”¨æ–¼å®¢æˆ¶åº¦æ ¡é©—è¿”å›çš„å€¼æ˜¯å¦è¢«éæ³•ç¯¡æ”¹äº†ã€‚å®¢æˆ¶ç«¯å‚³çš„signå’Œæœå‹™å™¨ç«¯éŸ¿æ‡‰çš„signç®—æ³•å¯èƒ½æœƒä¸åŒã€‚</p><p>å…­ï¼šç¤ºä¾‹ä»£ç¢¼</p><p>1. dependency</p><pre><code>&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;redis.clients&lt;/groupId&gt; &lt;artifactId&gt;jedis&lt;/artifactId&gt; &lt;version&gt;2.9.0&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;</code></pre><p>2. RedisConfiguration</p><pre><code>@Configurationpublic class RedisConfiguration { @Bean public JedisConnectionFactory jedisConnectionFactory(){ return new JedisConnectionFactory(); } /** * æ”¯æŒå­˜å„²å°è±¡ * @return */ @Bean public RedisTemplate&lt;String, String&gt; redisTemplate(){ RedisTemplate&lt;String, String&gt; redisTemplate = new StringRedisTemplate(); redisTemplate.setConnectionFactory(jedisConnectionFactory()); Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class); ObjectMapper objectMapper = new ObjectMapper(); objectMapper.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY); objectMapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL); jackson2JsonRedisSerializer.setObjectMapper(objectMapper); redisTemplate.setValueSerializer(jackson2JsonRedisSerializer); redisTemplate.afterPropertiesSet(); return redisTemplate; }}</code></pre><p>3. TokenController</p><pre><code>@Slf4j@RestController@RequestMapping("/api/token")public class TokenController { @Autowired private RedisTemplate redisTemplate; /** * API Token * * @param sign * @return */ @PostMapping("/api_token") public ApiResponse&lt;AccessToken&gt; apiToken(String appId, @RequestHeader("timestamp") String timestamp, @RequestHeader("sign") String sign) { Assert.isTrue(!StringUtils.isEmpty(appId) &amp;&amp; !StringUtils.isEmpty(timestamp) &amp;&amp; !StringUtils.isEmpty(sign), "åƒæ•¸éŒ¯èª¤"); long reqeustInterval = System.currentTimeMillis() - Long.valueOf(timestamp); Assert.isTrue(reqeustInterval &lt; 5 * 60 * 1000, "è«‹æ±‚éæœŸï¼Œè«‹é‡æ–°è«‹æ±‚"); // 1. æ ¹æ“šappIdæŸ¥è©¢æ•¸æ“šåº«ç²å–appSecret AppInfo appInfo = new AppInfo("1", "12345678954556"); // 2. æ ¡é©—ç°½å String signString = timestamp + appId + appInfo.getKey(); String signature = MD5Util.encode(signString); log.info(signature); Assert.isTrue(signature.equals(sign), "ç°½åéŒ¯èª¤"); // 3. å¦‚æœæ­£ç¢ºç”Ÿæˆä¸€å€‹tokenä¿å­˜åˆ°redisä¸­ï¼Œå¦‚æœéŒ¯èª¤è¿”å›éŒ¯èª¤ä¿¡æ¯ AccessToken accessToken = this.saveToken(0, appInfo, null); return ApiResponse.success(accessToken); } @NotRepeatSubmit(5000) @PostMapping("user_token") public ApiResponse&lt;UserInfo&gt; userToken(String username, String password) { // æ ¹æ“šç”¨æˆ¶åæŸ¥è©¢å¯†ç¢¼, ä¸¦æ¯”è¼ƒå¯†ç¢¼(å¯†ç¢¼å¯ä»¥RSAåŠ å¯†ä¸€ä¸‹) UserInfo userInfo = new UserInfo(username, "81255cb0dca1a5f304328a70ac85dcbd", "111111"); String pwd = password + userInfo.getSalt(); String passwordMD5 = MD5Util.encode(pwd); Assert.isTrue(passwordMD5.equals(userInfo.getPassword()), "å¯†ç¢¼éŒ¯èª¤"); // 2. ä¿å­˜Token AppInfo appInfo = new AppInfo("1", "12345678954556"); AccessToken accessToken = this.saveToken(1, appInfo, userInfo); userInfo.setAccessToken(accessToken); return ApiResponse.success(userInfo); } private AccessToken saveToken(int tokenType, AppInfo appInfo, UserInfo userInfo) { String token = UUID.randomUUID().toString(); // tokenæœ‰æ•ˆæœŸç‚º2å°æ™‚ Calendar calendar = Calendar.getInstance(); calendar.setTime(new Date()); calendar.add(Calendar.SECOND, 7200); Date expireTime = calendar.getTime(); // 4. ä¿å­˜token ValueOperations&lt;String, TokenInfo&gt; operations = redisTemplate.opsForValue(); TokenInfo tokenInfo = new TokenInfo(); tokenInfo.setTokenType(tokenType); tokenInfo.setAppInfo(appInfo); if (tokenType == 1) { tokenInfo.setUserInfo(userInfo); } operations.set(token, tokenInfo, 7200, TimeUnit.SECONDS); AccessToken accessToken = new AccessToken(token, expireTime); return accessToken; } public static void main(String[] args) { long timestamp = System.currentTimeMillis(); System.out.println(timestamp); String signString = timestamp + "1" + "12345678954556"; String sign = MD5Util.encode(signString); System.out.println(sign); System.out.println("-------------------"); signString = "password=123456&amp;username=1&amp;12345678954556" + "ff03e64b-427b-45a7-b78b-47d9e8597d3b1529815393153sdfsdfsfs" + timestamp + "A1scr6"; sign = MD5Util.encode(signString); System.out.println(sign); }}</code></pre><p>4. WebMvcConfiguration</p><pre><code>@Configurationpublic class WebMvcConfiguration extends WebMvcConfigurationSupport { private static final String[] excludePathPatterns = {"/api/token/api_token"}; @Autowired private TokenInterceptor tokenInterceptor; @Override public void addInterceptors(InterceptorRegistry registry) { super.addInterceptors(registry); registry.addInterceptor(tokenInterceptor) .addPathPatterns("/api/**") .excludePathPatterns(excludePathPatterns); }}</code></pre><p>5. TokenInterceptor</p><pre><code>@Componentpublic class TokenInterceptor extends HandlerInterceptorAdapter { @Autowired private RedisTemplate redisTemplate; /** * * @param request * @param response * @param handler è¨ªå•çš„ç›®æ¨™æ–¹æ³• * @return * @throws Exception */ @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { String token = request.getHeader("token"); String timestamp = request.getHeader("timestamp"); // éš¨æ©Ÿå­—ç¬¦ä¸² String nonce = request.getHeader("nonce"); String sign = request.getHeader("sign"); Assert.isTrue(!StringUtils.isEmpty(token) &amp;&amp; !StringUtils.isEmpty(timestamp) &amp;&amp; !StringUtils.isEmpty(sign), "åƒæ•¸éŒ¯èª¤"); // ç²å–è¶…æ™‚æ™‚é–“ NotRepeatSubmit notRepeatSubmit = ApiUtil.getNotRepeatSubmit(handler); long expireTime = notRepeatSubmit == null ? 5 * 60 * 1000 : notRepeatSubmit.value(); // 2. è«‹æ±‚æ™‚é–“é–“éš” long reqeustInterval = System.currentTimeMillis() - Long.valueOf(timestamp); Assert.isTrue(reqeustInterval &lt; expireTime, "è«‹æ±‚è¶…æ™‚ï¼Œè«‹é‡æ–°è«‹æ±‚"); // 3. æ ¡é©—Tokenæ˜¯å¦å­˜åœ¨ ValueOperations&lt;String, TokenInfo&gt; tokenRedis = redisTemplate.opsForValue(); TokenInfo tokenInfo = tokenRedis.get(token); Assert.notNull(tokenInfo, "tokenéŒ¯èª¤"); // 4. æ ¡é©—ç°½å(å°‡æ‰€æœ‰çš„åƒæ•¸åŠ é€²ä¾†ï¼Œé˜²æ­¢åˆ¥äººç¯¡æ”¹åƒæ•¸) æ‰€æœ‰åƒæ•¸çœ‹åƒæ•¸åå‡çºŒæ’åºæ‹¼æ¥æˆurl // è«‹æ±‚åƒæ•¸ + token + timestamp + nonce String signString = ApiUtil.concatSignString(request) + tokenInfo.getAppInfo().getKey() + token + timestamp + nonce; String signature = MD5Util.encode(signString); boolean flag = signature.equals(sign); Assert.isTrue(flag, "ç°½åéŒ¯èª¤"); // 5. æ‹’çµ•é‡è¤‡èª¿ç”¨(ç¬¬ä¸€æ¬¡è¨ªå•æ™‚å­˜å„²ï¼ŒéæœŸæ™‚é–“å’Œè«‹æ±‚è¶…æ™‚æ™‚é–“ä¿æŒä¸€è‡´), åªæœ‰æ¨™è¨»ä¸å…è¨±é‡è¤‡æäº¤è¨»è§£çš„æ‰æœƒæ ¡é©— if (notRepeatSubmit != null) { ValueOperations&lt;String, Integer&gt; signRedis = redisTemplate.opsForValue(); boolean exists = redisTemplate.hasKey(sign); Assert.isTrue(!exists, "è«‹å‹¿é‡è¤‡æäº¤"); signRedis.set(sign, 0, expireTime, TimeUnit.MILLISECONDS); } return super.preHandle(request, response, handler); }}</code></pre><p>6. MD5Util</p><pre><code>public class MD5Util { private static final String hexDigits[] = { "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f" }; private static String byteArrayToHexString(byte b[]) { StringBuffer resultSb = new StringBuffer(); for (int i = 0; i &lt; b.length; i++) resultSb.append(byteToHexString(b[i])); return resultSb.toString(); } private static String byteToHexString(byte b) { int n = b; if (n &lt; 0) n += 256; int d1 = n / 16; int d2 = n % 16; return hexDigits[d1] + hexDigits[d2]; } public static String encode(String origin) { return encode(origin, "UTF-8"); } public static String encode(String origin, String charsetname) { String resultString = null; try { resultString = new String(origin); MessageDigest md = MessageDigest.getInstance("MD5"); if (charsetname == null || "".equals(charsetname)) resultString = byteArrayToHexString(md.digest(resultString .getBytes())); else resultString = byteArrayToHexString(md.digest(resultString .getBytes(charsetname))); } catch (Exception exception) { } return resultString; }}</code></pre><p>7. @NotRepeatSubmit</p><pre><code>/** * ç¦æ­¢é‡è¤‡æäº¤ */@Target(ElementType.METHOD)@Retention(RetentionPolicy.RUNTIME)public @interface NotRepeatSubmit { /** éæœŸæ™‚é–“ï¼Œå–®ä½æ¯«ç§’ **/ long value() default 5000;}</code></pre><p>8. AccessToken</p><pre><code>@Data@AllArgsConstructorpublic class AccessToken { /** token */ private String token; /** å¤±æ•ˆæ™‚é–“ */ private Date expireTime;}</code></pre><p>9. AppInfo</p><pre><code>@Data@NoArgsConstructor@AllArgsConstructorpublic class AppInfo { /** App id */ private String appId; /** API ç¥•é‘° */ private String key;}</code></pre><p>10. TokenInfo</p><pre><code>@Datapublic class TokenInfo { /** tokené¡å‹: api:0 ã€user:1 */ private Integer tokenType; /** App ä¿¡æ¯ */ private AppInfo appInfo; /** ç”¨æˆ¶å…¶ä»–æ•¸æ“š */ private UserInfo userInfo;}</code></pre><p>11. UserInfo</p><pre><code>@Datapublic class UserInfo { /** ç”¨æˆ¶å */ private String username; /** æ‰‹æ©Ÿè™Ÿ */ private String mobile; /** éƒµç®± */ private String email; /** å¯†ç¢¼ */ private String password; /** é¹½ */ private String salt; private AccessToken accessToken; public UserInfo(String username, String password, String salt) { this.username = username; this.password = password; this.salt = salt; }}</code></pre><p>12. ApiCodeEnum</p><pre><code>/** * éŒ¯èª¤ç¢¼codeå¯ä»¥ä½¿ç”¨ç´”æ•¸å­—,ä½¿ç”¨ä¸åŒå€é–“æ¨™è­˜ä¸€é¡éŒ¯èª¤ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç´”å­—ç¬¦ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å‰ç¶´+ç·¨è™Ÿ * * éŒ¯èª¤ç¢¼ï¼šERR + ç·¨è™Ÿ * * å¯ä»¥ä½¿ç”¨æ—¥èªŒç´šåˆ¥çš„å‰ç¶´ä½œç‚ºéŒ¯èª¤é¡å‹å€åˆ† Info(I) Error(E) Warning(W) * * æˆ–è€…ä»¥æ¥­å‹™æ¨¡å¡Š + éŒ¯èª¤è™Ÿ * * TODO éŒ¯èª¤ç¢¼è¨­è¨ˆ * * Alipay ç”¨äº†å…©å€‹codeï¼Œå…©å€‹msg(https://docs.open.alipay.com/api_1/alipay.trade.pay) * * @author Mengday Zhang * @version 1.0 * @since 2018/6/22 */public enum ApiCodeEnum { SUCCESS("10000", "success"), UNKNOW_ERROR("ERR0001","æœªçŸ¥éŒ¯èª¤"), PARAMETER_ERROR("ERR0002","åƒæ•¸éŒ¯èª¤"), TOKEN_EXPIRE("ERR0003","èªè­‰éæœŸ"), REQUEST_TIMEOUT("ERR0004","è«‹æ±‚è¶…æ™‚"), SIGN_ERROR("ERR0005","ç°½åéŒ¯èª¤"), REPEAT_SUBMIT("ERR0006","è«‹ä¸è¦é »ç¹æ“ä½œ"), ; /** ä»£ç¢¼ */ private String code; /** çµæœ */ private String msg; ApiCodeEnum(String code, String msg) { this.code = code; this.msg = msg; } public String getCode() { return code; } public String getMsg() { return msg; }}</code></pre><p>13. ApiResult</p><pre><code>@Data@NoArgsConstructor@AllArgsConstructorpublic class ApiResult { /** ä»£ç¢¼ */ private String code; /** çµæœ */ private String msg;}</code></pre><p>14. ApiUtil</p><pre><code>public class ApiUtil { /** * æŒ‰åƒæ•¸åå‡çºŒæ‹¼æ¥åƒæ•¸ * @param request * @return */ public static String concatSignString(HttpServletRequest request) { Map&lt;String, String&gt; paramterMap = new HashMap&lt;&gt;(); request.getParameterMap().forEach((key, value) -&gt; paramterMap.put(key, value[0])); // æŒ‰ç…§keyå‡çºŒæ’åºï¼Œç„¶å¾Œæ‹¼æ¥åƒæ•¸ Set&lt;String&gt; keySet = paramterMap.keySet(); String[] keyArray = keySet.toArray(new String[keySet.size()]); Arrays.sort(keyArray); StringBuilder sb = new StringBuilder(); for (String k : keyArray) { // æˆ–ç•¥æ‰çš„å­—æ®µ if (k.equals("sign")) { continue; } if (paramterMap.get(k).trim().length() &gt; 0) { // åƒæ•¸å€¼ç‚ºç©ºï¼Œå‰‡ä¸åƒèˆ‡ç°½å sb.append(k).append("=").append(paramterMap.get(k).trim()).append("&amp;"); } } return sb.toString(); } public static String concatSignString(Map&lt;String, String&gt; map) { Map&lt;String, String&gt; paramterMap = new HashMap&lt;&gt;(); map.forEach((key, value) -&gt; paramterMap.put(key, value)); // æŒ‰ç…§keyå‡çºŒæ’åºï¼Œç„¶å¾Œæ‹¼æ¥åƒæ•¸ Set&lt;String&gt; keySet = paramterMap.keySet(); String[] keyArray = keySet.toArray(new String[keySet.size()]); Arrays.sort(keyArray); StringBuilder sb = new StringBuilder(); for (String k : keyArray) { if (paramterMap.get(k).trim().length() &gt; 0) { // åƒæ•¸å€¼ç‚ºç©ºï¼Œå‰‡ä¸åƒèˆ‡ç°½å sb.append(k).append("=").append(paramterMap.get(k).trim()).append("&amp;"); } } return sb.toString(); } /** * ç²å–æ–¹æ³•ä¸Šçš„@NotRepeatSubmitè¨»è§£ * @param handler * @return */ public static NotRepeatSubmit getNotRepeatSubmit(Object handler) { if (handler instanceof HandlerMethod) { HandlerMethod handlerMethod = (HandlerMethod) handler; Method method = handlerMethod.getMethod(); NotRepeatSubmit annotation = method.getAnnotation(NotRepeatSubmit.class); return annotation; } return null; }}</code></pre><p>15. ApiResponse</p><pre><code>@Data@Slf4jpublic class ApiResponse&lt;T&gt; { /** çµæœ */ private ApiResult result; /** æ•¸æ“š */ private T data; /** ç°½å */ private String sign; public static &lt;T&gt; ApiResponse success(T data) { return response(ApiCodeEnum.SUCCESS.getCode(), ApiCodeEnum.SUCCESS.getMsg(), data); } public static ApiResponse error(String code, String msg) { return response(code, msg, null); } public static &lt;T&gt; ApiResponse response(String code, String msg, T data) { ApiResult result = new ApiResult(code, msg); ApiResponse response = new ApiResponse(); response.setResult(result); response.setData(data); String sign = signData(data); response.setSign(sign); return response; } private static &lt;T&gt; String signData(T data) { // TODO æŸ¥è©¢key String key = "12345678954556"; Map&lt;String, String&gt; responseMap = null; try { responseMap = getFields(data); } catch (IllegalAccessException e) { return null; } String urlComponent = ApiUtil.concatSignString(responseMap); String signature = urlComponent + "key=" + key; String sign = MD5Util.encode(signature); return sign; } /** * @param data åå°„çš„å°è±¡,ç²å–å°è±¡çš„å­—æ®µåå’Œå€¼ * @throws IllegalArgumentException * @throws IllegalAccessException */ public static Map&lt;String, String&gt; getFields(Object data) throws IllegalAccessException, IllegalArgumentException { if (data == null) return null; Map&lt;String, String&gt; map = new HashMap&lt;&gt;(); Field[] fields = data.getClass().getDeclaredFields(); for (int i = 0; i &lt; fields.length; i++) { Field field = fields[i]; field.setAccessible(true); String name = field.getName(); Object value = field.get(data); if (field.get(data) != null) { map.put(name, value.toString()); } } return map; }}</code></pre></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>ä¼æ¥­</a></li><li><a>API</a></li><li><a>è¨­è¨ˆ</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/005cb496.html alt=å·¥ç¨‹å‹˜å¯Ÿè¨­è¨ˆä¼æ¥­ä¸‰ç¶­è¨­è¨ˆåŠå¤§æ•¸æ“šä¿¡æ¯æŠ€è¡“æ‡‰ç”¨ç ”è¨æœƒåœ¨æ»¬å¬é–‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b17b03f7f4fe4edb89078798227816c8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/005cb496.html title=å·¥ç¨‹å‹˜å¯Ÿè¨­è¨ˆä¼æ¥­ä¸‰ç¶­è¨­è¨ˆåŠå¤§æ•¸æ“šä¿¡æ¯æŠ€è¡“æ‡‰ç”¨ç ”è¨æœƒåœ¨æ»¬å¬é–‹>å·¥ç¨‹å‹˜å¯Ÿè¨­è¨ˆä¼æ¥­ä¸‰ç¶­è¨­è¨ˆåŠå¤§æ•¸æ“šä¿¡æ¯æŠ€è¡“æ‡‰ç”¨ç ”è¨æœƒåœ¨æ»¬å¬é–‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dcea13c.html alt=ä½ åœ¨é–‹ç™¼APIæ™‚æ˜¯å¦‚ä½•è¨­è¨ˆç°½åé©—è­‰çš„ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dcea13c.html title=ä½ åœ¨é–‹ç™¼APIæ™‚æ˜¯å¦‚ä½•è¨­è¨ˆç°½åé©—è­‰çš„ï¼Ÿ>ä½ åœ¨é–‹ç™¼APIæ™‚æ˜¯å¦‚ä½•è¨­è¨ˆç°½åé©—è­‰çš„ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/292d3a6.html alt=è¨­è¨ˆå³æºé€šï¼šä¼æ¥­æå‡è¨­è¨ˆåŠ›çš„10å€‹æ–¹æ³• class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/331469c2d197409392b12e27ca42d0a7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/292d3a6.html title=è¨­è¨ˆå³æºé€šï¼šä¼æ¥­æå‡è¨­è¨ˆåŠ›çš„10å€‹æ–¹æ³•>è¨­è¨ˆå³æºé€šï¼šä¼æ¥­æå‡è¨­è¨ˆåŠ›çš„10å€‹æ–¹æ³•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9bd6b239.html alt=é‹¼æ§‹äººç¦åˆ©â€”â€”é‹¼çµæ§‹è¨­è¨ˆç¶“å…¸å•é¡Œè§£è®€ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a72bd60ea48d471b8ce03ebf0ce15869 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9bd6b239.html title=é‹¼æ§‹äººç¦åˆ©â€”â€”é‹¼çµæ§‹è¨­è¨ˆç¶“å…¸å•é¡Œè§£è®€>é‹¼æ§‹äººç¦åˆ©â€”â€”é‹¼çµæ§‹è¨­è¨ˆç¶“å…¸å•é¡Œè§£è®€</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6bbe6ec4.html alt=é‹¼ç®¡æ··å‡åœŸçµæ§‹è¨­è¨ˆåŸç†åŠåœ¨å¼·éœ‡å€æ©‹æ¨‘çµæ§‹ç ”ç©¶æˆæœé”åœ‹éš›é ˜å…ˆ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/153569494612546362474a9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6bbe6ec4.html title=é‹¼ç®¡æ··å‡åœŸçµæ§‹è¨­è¨ˆåŸç†åŠåœ¨å¼·éœ‡å€æ©‹æ¨‘çµæ§‹ç ”ç©¶æˆæœé”åœ‹éš›é ˜å…ˆ>é‹¼ç®¡æ··å‡åœŸçµæ§‹è¨­è¨ˆåŸç†åŠåœ¨å¼·éœ‡å€æ©‹æ¨‘çµæ§‹ç ”ç©¶æˆæœé”åœ‹éš›é ˜å…ˆ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6d006e47.html alt=é‹¼çµæ§‹è¨­è¨ˆåŸºç¤çŸ¥è­˜å•ç­” class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/63b48928-d7cd-4346-b80f-4f77015517c1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6d006e47.html title=é‹¼çµæ§‹è¨­è¨ˆåŸºç¤çŸ¥è­˜å•ç­”>é‹¼çµæ§‹è¨­è¨ˆåŸºç¤çŸ¥è­˜å•ç­”</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0dc64d99.html alt=38å€‹é‹¼çµæ§‹è¨­è¨ˆå•é¡Œï¼Œéƒ½å¾ˆå¸¸è¦‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/f1181ce8-cf01-4194-b9c2-362f43894ddb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0dc64d99.html title=38å€‹é‹¼çµæ§‹è¨­è¨ˆå•é¡Œï¼Œéƒ½å¾ˆå¸¸è¦‹>38å€‹é‹¼çµæ§‹è¨­è¨ˆå•é¡Œï¼Œéƒ½å¾ˆå¸¸è¦‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b6fd930e.html alt=æ­¥æ­¥è§£ææ©‹æ¨‘è¨­è¨ˆè¨ˆç®—ï¼Œä¸å¯éŒ¯éçš„ä¸€ç¯‡ä¹¾è²¨ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d88dd927b4f2474fbe4ea261c2397ba8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b6fd930e.html title=æ­¥æ­¥è§£ææ©‹æ¨‘è¨­è¨ˆè¨ˆç®—ï¼Œä¸å¯éŒ¯éçš„ä¸€ç¯‡ä¹¾è²¨>æ­¥æ­¥è§£ææ©‹æ¨‘è¨­è¨ˆè¨ˆç®—ï¼Œä¸å¯éŒ¯éçš„ä¸€ç¯‡ä¹¾è²¨</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/97b90000.html alt=çµæ§‹è¨­è¨ˆã€æ ¡å°ã€å¯©æ ¸ä¸‰å­—ç¶“ï¼Œé€Ÿé€Ÿæ”¶è— class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/97b90000.html title=çµæ§‹è¨­è¨ˆã€æ ¡å°ã€å¯©æ ¸ä¸‰å­—ç¶“ï¼Œé€Ÿé€Ÿæ”¶è—>çµæ§‹è¨­è¨ˆã€æ ¡å°ã€å¯©æ ¸ä¸‰å­—ç¶“ï¼Œé€Ÿé€Ÿæ”¶è—</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fd0540fa.html alt=è§£ææ©‹æ¨‘è¨­è¨ˆè¨ˆç®— class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/fa4d0bcf2a204a2fac9b37978b1b0713 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fd0540fa.html title=è§£ææ©‹æ¨‘è¨­è¨ˆè¨ˆç®—>è§£ææ©‹æ¨‘è¨­è¨ˆè¨ˆç®—</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/83530974.html alt=è§£ææ©‹æ¨‘è¨­è¨ˆè¨ˆç®—ï¼Œä¸å¯éŒ¯éçš„ä¸€ç¯‡ä¹¾è²¨ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/af9ca7f120da4e23b0ca589375e05dd2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/83530974.html title=è§£ææ©‹æ¨‘è¨­è¨ˆè¨ˆç®—ï¼Œä¸å¯éŒ¯éçš„ä¸€ç¯‡ä¹¾è²¨>è§£ææ©‹æ¨‘è¨­è¨ˆè¨ˆç®—ï¼Œä¸å¯éŒ¯éçš„ä¸€ç¯‡ä¹¾è²¨</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e8b9b44c.html alt=è¨­è¨ˆå¸«è§£ææ©‹æ¨‘è¨­è¨ˆè¨ˆç®—ï¼ŒéŒ¯éäº†å°±æ²’æœ‰æ©Ÿæœƒ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e01645937bda4ae7a7f148666ff89117 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e8b9b44c.html title=è¨­è¨ˆå¸«è§£ææ©‹æ¨‘è¨­è¨ˆè¨ˆç®—ï¼ŒéŒ¯éäº†å°±æ²’æœ‰æ©Ÿæœƒ>è¨­è¨ˆå¸«è§£ææ©‹æ¨‘è¨­è¨ˆè¨ˆç®—ï¼ŒéŒ¯éäº†å°±æ²’æœ‰æ©Ÿæœƒ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/15d8539d.html alt=ç¶“å…¸è¨­è¨ˆå»¶çºŒè‡³ä»Šçš„çƒå°¼è«å…‹403è¬èƒ½å¡è»Š class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/132ba54553374c7eb2c0a9c155bba041 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/15d8539d.html title=ç¶“å…¸è¨­è¨ˆå»¶çºŒè‡³ä»Šçš„çƒå°¼è«å…‹403è¬èƒ½å¡è»Š>ç¶“å…¸è¨­è¨ˆå»¶çºŒè‡³ä»Šçš„çƒå°¼è«å…‹403è¬èƒ½å¡è»Š</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/69536588.html alt=ç·šçºœè¨­è¨ˆåˆç´šèª²ç¨‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1532759411210988051a0cb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/69536588.html title=ç·šçºœè¨­è¨ˆåˆç´šèª²ç¨‹>ç·šçºœè¨­è¨ˆåˆç´šèª²ç¨‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/928013b9.html alt=ä¼æ¥­ç¶²ç«™å»ºè¨­é¸æ“‡æ­£ç¢ºçš„æœå‹™å™¨ï¼Œè®“ä½ çœéŒ¢ï¼Œç¶²ç«™é‹è¡Œè‰¯å¥½ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/f7824718-e78c-40c3-93f8-ba9b88203ea8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/928013b9.html title=ä¼æ¥­ç¶²ç«™å»ºè¨­é¸æ“‡æ­£ç¢ºçš„æœå‹™å™¨ï¼Œè®“ä½ çœéŒ¢ï¼Œç¶²ç«™é‹è¡Œè‰¯å¥½>ä¼æ¥­ç¶²ç«™å»ºè¨­é¸æ“‡æ­£ç¢ºçš„æœå‹™å™¨ï¼Œè®“ä½ çœéŒ¢ï¼Œç¶²ç«™é‹è¡Œè‰¯å¥½</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>