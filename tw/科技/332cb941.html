<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>數據庫SQL最常用語句 | 极客快訊</title><meta property="og:title" content="數據庫SQL最常用語句 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/332cb941.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/332cb941.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/332cb941.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/332cb941.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/332cb941.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/332cb941.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/332cb941.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/332cb941.html><meta property="article:published_time" content="2020-11-14T21:04:12+08:00"><meta property="article:modified_time" content="2020-11-14T21:04:12+08:00"><meta name=Keywords content><meta name=description content="數據庫SQL最常用語句"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/332cb941.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>數據庫SQL最常用語句</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>數據庫最常用語句</h1><p></p><p>　1、複製表(只複製結構,源表名：a 新表名：b)</p><p>　　法一：select * into b from a where 1&lt;>1</p><p>　　法二：select top 0 * into b from a</p><p>　　2、拷貝表(拷貝數據,源表名：a 目標表名：b)</p><p>insert into b(a, b, c) select d,e,f from b;</p><p>　　3、跨數據庫之間表的拷貝(具體數據使用絕對路徑)</p><p>insert into b(a, b, c) select d,e,f from b in ‘具體數據庫’ where 條件</p><p>　　例子：..from b in '"&Server.MapPath(&#34;.")&&#34;\data.mdb" &&#34;' where..</p><p>　　4、子查詢(表名1：a 表名2：b)</p><p>select a,b,c from a where a IN (select d from b ) 或者: select a,b,c from a where a IN (1,2,3)</p><p>　　5、顯示文章、提交人和最後回覆時間</p><p>select a.title,a.username,b.adddate from table a,(select max(adddate) adddate from table where table.title=a.title) b</p><p>6、外連接查詢(表名1：a 表名2：b)</p><p>select a.a, a.b, a.c, b.c, b.d, b.f from a LEFT OUT JOIN b ON a.a = b.c</p><p>　　7、在線視圖查詢(表名1：a )</p><p>select * from (SELECT a,b,c FROM a) T where t.a > 1;</p><p>　　8、between的用法,between限制查詢數據範圍時包括了邊界值,not between不包括</p><p>select * from table1 where time between time1 and time2</p><p>select a,b,c, from table1 where a not between 數值1 and 數值2</p><p>　　9、in 的使用方法</p><p>select * from table1 where a [not] in (‘值1’,’值2’,’值4’,’值6’)</p><p>　　10、兩張關聯表，刪除主表中已經在副表中沒有的信息</p><p>delete from table1 where not exists ( select * from table2 where table1.field1=table2.field1 )</p><p>　　11、四表聯查問題：</p><p>select * from a left inner join b on a.a=b.b right inner join c on a.a=c.c inner join d on a.a=d.d where .....</p><p>　　12、日程安排提前五分鐘提醒</p><p>SQL: select * from 日程安排 where datediff('minute',f開始時間,getdate())>5</p><p>　　13、一條sql 語句搞定數據庫分頁</p><p>select top 10 b.* from (select top 20 主鍵字段,排序字段 from 表名 order by 排序字段 desc) a,表名 b where b.主鍵字段 = a.主鍵字段 order by a.排序字段</p><p>　　14、前10條記錄</p><p>select top 10 * form table1 where 範圍</p><p>　　15、選擇在每一組b值相同的數據中對應的a最大的記錄的所有信息(類似這樣的用法可以用於論壇每月排行榜,每月熱銷產品分析,按科目成績排名,等等.)</p><p>select a,b,c from tablename ta where a=(select max(a) from tablename tb where tb.b=ta.b)</p><p>　　16、包括所有在 TableA 中但不在 TableB和TableC 中的行並消除所有重複行而派生出一個結果表</p><p>(select a from tableA ) except (select a from tableB) except (select a from tableC)</p><p>　　17、隨機取出10條數據</p><p>select top 10 * from tablename order by newid()</p><p>　　18、隨機選擇記錄</p><p>select newid()</p><p>　　19、刪除重複記錄</p><p>Delete from tablename where id not in (select max(id) from tablename group by col1,col2,...)</p><p>　　20、列出數據庫裡所有的表名</p><p>select name from sysobjects where type='U'</p><p>21、列出表裡的所有的</p><p>select name from syscolumns where id=object_id('TableName')</p><p>+(1)數據記錄篩選：<br>sql="select*from數據表where字段名=字段值orderby字段名[desc]"<br>sql="select*from數據表where字段名like'%字段值%'orderby字段名[desc]"<br>sql="select top10* from數據表where字段名order by字段名[desc]"<br>sql="select*from數據表where字段名in('值1','值2','值3')"<br>sql="select*from數據表where字段名between值1and值2"<br>(2)更新數據記錄：<br>sql="update數據表set字段名=字段值where條件表達式"<br>sql="update數據表set字段1=值1,字段2=值2……字段n=值n<br>where條件表達式"<br>(3)刪除數據記錄：<br>sql="delete from數據表where條件表達式"<br>sql="delete from數據表"(將數據表所有記錄刪除)<br>(4)添加數據記錄：<br>sql="insert into數據表(字段1,字段2,字段3…) values(值1,值2,值3…)"<br>sql="insert into目標數據表<br>Select * from源數據表"(把源數據表的記錄添加到目標數據表)<br>(5)數據記錄統計函數：<br>AVG(字段名)得出一個表格欄平均值<br>COUNT(*|字段名)對數據行數的統計或對某一欄有值的數據行數統計<br>MAX(字段名)取得一個表格欄最大的值<br>MIN(字段名)取得一個表格欄最小的值<br>SUM(字段名)把數據欄的值相加<br>引用以上函數的方法：<br>sql="select sum(字段名) as別名from數據表 where條件表達式"<br>setrs=conn.excute(sql)<br>用rs("別名")獲取統的計值，其它函數運用同上。<br>(5)數據表的建立和刪除：<br>CREATE TABLE數據表名稱(字段1類型1(長度),字段2類型2(長度)……)<br>例：CREATE TABLE tab01 (name varchar (50), datetime defaultnow ())<br>DROPTABLE數據表名稱(永久性刪除一個數據表)<br>4.記錄集對象的方法：<br>rs.move next將記錄指針從當前的位置向下移一行<br>rs.move previous將記錄指針從當前的位置向上移一行<br>rs.move first將記錄指針移到數據表第一行<br>rs.move last將記錄指針移到數據表最後一行<br>rs.absoluteposition=N將記錄指針移到數據表第N行<br>rs.absolutepage=N將記錄指針移到第N頁的第一行<br>rs.pagesize=N設置每頁為N條記錄<br>rs.pagecount根據pagesize的設置返回總頁數<br>rs.recordcount返回記錄總數<br>rs.bof返回記錄指針是否超出數據表首端，true表示是，false為否<br>rs.eof返回記錄指針是否超出數據表末端，true表示是，false為否<br>rs.delete刪除當前記錄，但記錄指針不會向下移動<br>rs.add new添加記錄到數據表末端<br>rs.update更新數據表記錄</p><p>SQL語句的添加、刪除、修改雖然有如下很多種方法，但在使用過程中還是不夠用，不知是否有高手把更多靈活的使用方法貢獻出來？</p><p>添加、刪除、修改使用db.Execute(Sql)命令執行操作<br>╔----------------╗<br>☆ 數據記錄篩選 ☆<br>╚----------------╝<br>注意：單雙引號的用法可能有誤(沒有測試)</p><p>Sql = "Select Distinct 字段名 From 數據表"<br>Distinct函數，查詢數據庫存表內不重複的記錄</p><p>Sql = "Select Count(*) From 數據表 where 字段名1>#18:0:0# and 字段名1&lt; #19:00# "<br>count函數,查詢數庫表內有多少條記錄，“字段名1”是指同一字段<br>例：<br>set rs=conn.execute("select count(id) as idnum from news")<br>response.write rs("idnum")</p><p>sql="select * from 數據表 where 字段名 between 值1 and 值2"<br>Sql="select * from 數據表 where 字段名 between #2003-8-10# and #2003-8-12#"<br>在日期類數值為2003-8-10 19:55:08 的字段裡查找2003-8-10至2003-8-12的所有記錄，而不管是幾點幾分。</p><p>select * from tb_name where datetime between #2003-8-10# and #2003-8-12#<br>字段裡面的數據格式為：2003-8-10 19:55:08，通過sql查出2003-8-10至2003-8-12的所有紀錄，而不管是幾點幾分。</p><p>Sql="select * from 數據表 where 字段名=字段值 order by 字段名 [desc]"</p><p>Sql="select * from 數據表 where 字段名 like '%字段值%' order by 字段名 [desc]"<br>模糊查詢</p><p>Sql="select top 10 * from 數據表 where 字段名 order by 字段名 [desc]"<br>查找數據庫中前10記錄</p><p>Sql="select top n * form 數據表 order by newid()"<br>隨機取出數據庫中的若干條記錄的方法<br>top n，n就是要取出的記錄數</p><p>Sql="select * from 數據表 where 字段名 in ('值1','值2','值3')"</p><p><br>☆ 添加數據記錄 ☆<br>sql="insert into 數據表 (字段1,字段2,字段3 …) valuess (值1,值2,值3 …)"</p><p>sql="insert into 數據表 valuess (值1,值2,值3 …)"<br>不指定具體字段名錶示將按照數據表中字段的順序，依次添加</p><p>sql="insert into 目標數據表 select * from 源數據表"<br>把源數據表的記錄添加到目標數據表</p><p><br>☆ 更新數據記錄 ☆<br>Sql="update 數據表 set 字段名=字段值 where 條件表達式"</p><p>Sql="update 數據表 set 字段1=值1,字段2=值2 …… 字段n=值n where 條件表達式"</p><p>Sql="update 數據表 set 字段1=值1,字段2=值2 …… 字段n=值n "<br>沒有條件則更新整個數據表中的指定字段值</p><p><br>☆ 刪除數據記錄 ☆<br>Sql="delete from 數據表 where 條件表達式"</p><p>Sql="delete from 數據表"<br>沒有條件將刪除數據表中所有記錄)</p><p>引用以上函數的方法：<br>sql="select sum(字段名) as 別名 from 數據表 where 條件表達式"<br>set rs=conn.excute(sql)<br>用 rs("別名") 獲取統的計值，其它函數運用同上。</p><p>☆ 數據表的建立和刪除 ☆<br>CREATE TABLE 數據表名稱(字段1 類型1(長度),字段2 類型2(長度) …… )<br>例：CREATE TABLE tab01(name varchar(50),datetime default now())<br>DROP TABLE 數據表名稱 (永久性刪除一個數據表)</p><p><br>☆ 記錄集對象的方法 ☆<br>rs.movenext 將記錄指針從當前的位置向下移一行<br>rs.moveprevious 將記錄指針從當前的位置向上移一行<br>rs.movefirst 將記錄指針移到數據表第一行<br>rs.movelast 將記錄指針移到數據表最後一行<br>rs.absoluteposition=N 將記錄指針移到數據表第N行<br>rs.absolutepage=N 將記錄指針移到第N頁的第一行<br>rs.pagesize=N 設置每頁為N條記錄<br>rs.pagecount 根據 pagesize 的設置返回總頁數<br>rs.recordcount 返回記錄總數<br>rs.bof 返回記錄指針是否超出數據表首端，true表示是，false為否<br>rs.eof 返回記錄指針是否超出數據表末端，true表示是，false為否<br>rs.delete 刪除當前記錄，但記錄指針不會向下移動<br>rs.addnew 添加記錄到數據表末端<br>rs.update 更新數據表記錄</p><p><br></p><p>注：本文如有文字侵權，請聯繫作者刪除。謝謝！</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>數據庫</a></li><li><a>SQL</a></li><li><a>語句</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/8ca809f3.html alt="SQL SERVER數據庫中用select語句複製表結構創建新表" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8ca809f3.html title="SQL SERVER數據庫中用select語句複製表結構創建新表">SQL SERVER數據庫中用select語句複製表結構創建新表</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/12fe4764.html alt="SQL 中的if判斷語句、while循環語句、和運算符" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/04199ae85d034aba8f5792b86591bb77 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/12fe4764.html title="SQL 中的if判斷語句、while循環語句、和運算符">SQL 中的if判斷語句、while循環語句、和運算符</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3defe9c5.html alt=公司有一臺很重要SQL數據庫，如何實現數據庫實時同步？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/cb0f81e61fd042fc92f5a371b68f12e3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3defe9c5.html title=公司有一臺很重要SQL數據庫，如何實現數據庫實時同步？>公司有一臺很重要SQL數據庫，如何實現數據庫實時同步？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/faccb127.html alt=SQL數據庫：ArangoDB入門指南 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/437e00033acd1d4113a4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/faccb127.html title=SQL數據庫：ArangoDB入門指南>SQL數據庫：ArangoDB入門指南</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/368ba25.html alt=SQL數據庫附加與還原的區別 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1524838831132d87e4b7c22 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/368ba25.html title=SQL數據庫附加與還原的區別>SQL數據庫附加與還原的區別</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b8364f1.html alt="Access SQL語句創建表對應的數據類型名稱" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/304092b2f0324d6f83e871a1cfdb4f91 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b8364f1.html title="Access SQL語句創建表對應的數據類型名稱">Access SQL語句創建表對應的數據類型名稱</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dda9117.html alt=SQL注入——數據庫增刪改查語句 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/c00955f4071b4896be3193f1fc058007 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dda9117.html title=SQL注入——數據庫增刪改查語句>SQL注入——數據庫增刪改查語句</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3269d080.html alt=MySQL數據庫的事務管理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/152203544367254a708f807 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3269d080.html title=MySQL數據庫的事務管理>MySQL數據庫的事務管理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/125dee29.html alt="SQL Server中的事務與鎖" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1533794121802a9afbb22f9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/125dee29.html title="SQL Server中的事務與鎖">SQL Server中的事務與鎖</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e9d6f488.html alt="SQL Server中的事務（附有實例）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/21e047bd6e3c41fba0beac7ef3f1ce4e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e9d6f488.html title="SQL Server中的事務（附有實例）">SQL Server中的事務（附有實例）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bb071e7e.html alt="SQL 事務機制-transaction" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3231427d97bf4a04b148360fea032241 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bb071e7e.html title="SQL 事務機制-transaction">SQL 事務機制-transaction</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c6e14bc6.html alt=SQL基礎知識——事務 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/773e21df09dc4e3e8403a0a62994039d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c6e14bc6.html title=SQL基礎知識——事務>SQL基礎知識——事務</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dc1a27dd.html alt="詳解Oracle 數據庫啟動過程" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1538236609349861be8e044 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dc1a27dd.html title="詳解Oracle 數據庫啟動過程">詳解Oracle 數據庫啟動過程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ad3f3a1e.html alt="數據庫技術：MySQL 基礎和 SQL 入門，單表、約束和事務" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/107897c16ae7461caa62dd375b631afe style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ad3f3a1e.html title="數據庫技術：MySQL 基礎和 SQL 入門，單表、約束和事務">數據庫技術：MySQL 基礎和 SQL 入門，單表、約束和事務</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8ff1c7a8.html alt=解讀數據庫：深入分析MySQL中事務以及MVCC的實現原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/8f370516-d41a-4803-84ba-2c01e4637c8b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8ff1c7a8.html title=解讀數據庫：深入分析MySQL中事務以及MVCC的實現原理>解讀數據庫：深入分析MySQL中事務以及MVCC的實現原理</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>