<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>C語言指針終極指南！（附詳盡圖示和代碼） | 极客快訊</title><meta property="og:title" content="C語言指針終極指南！（附詳盡圖示和代碼） - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/4e7017cb21b9471891cf2f2febf5befe"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/342d7dd9.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/342d7dd9.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/342d7dd9.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/342d7dd9.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/342d7dd9.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/342d7dd9.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/342d7dd9.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/342d7dd9.html><meta property="article:published_time" content="2020-11-14T21:00:48+08:00"><meta property="article:modified_time" content="2020-11-14T21:00:48+08:00"><meta name=Keywords content><meta name=description content="C語言指針終極指南！（附詳盡圖示和代碼）"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/342d7dd9.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>C語言指針終極指南！（附詳盡圖示和代碼）</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>1為什麼使用指針</p><p>假如我們定義了 char a=’A’ ，當需要使用 ‘A’ 時，除了直接調用變量 a ，還可以定義 char *p=&a ，調用 a 的地址，即指向 a 的指針 p ，變量 a（ char 類型）只佔了一個字節,指針本身的大小由可尋址的字長來決定，指針 p 佔用 4 個字節。</p><p>但如果要引用的是佔用內存空間比較大東西，用指針也還是 4 個字節即可。</p><ul><li>使用指針型變量在很多時候佔用更小的內存空間。</li></ul><p>變量為了表示數據，指針可以更好的傳遞數據，舉個例子：</p><p>第一節課是 1 班語文， 2 班數學，第二節課顛倒過來， 1 班要上數學， 2 班要上語文，那麼第一節課下課後需要怎樣作調整呢？方案一：課間 1 班學生全都去 2 班， 2 班學生全都來 1 班，當然，走的時候要攜帶上書本、筆紙、零食……場面一片狼藉；方案二：兩位老師課間互換教室。</p><p>顯然，方案二更好一些，方案二類似使用指針傳遞地址，方案一將內存中的內容重新“複製”了一份，效率比較低。</p><ul><li>在數據傳遞時，如果數據塊較大，可以使用指針傳遞地址而不是實際數據，即提高傳輸速度，又節省大量內存。</li></ul><p>一個數據緩衝區 char buf[100] ，如果其中 buf[0,1] 為命令號, buf[2,3] 為數據類型, buf[4~7] 為該類型的數值，類型為 int ，使用如下語句進行賦值：</p><pre><code>*(short*)&amp;buf[0]=DataId;*(short*)&amp;buf[2]=DataType;*(int*)&amp;buf[4]=DataValue;</code></pre><ul><li>數據轉換，利用指針的靈活的類型轉換，可以用來做數據類型轉換，比較常用於通訊緩衝區的填充。</li><li>指針的機制比較簡單，其功能可以被集中重新實現成更抽象化的引用數據形式</li><li>函數指針，形如: #define PMYFUN (void*)(int,int) ，可以用在大量分支處理的實例當中，如某通訊根據不同的命令號執行不同類型的命令，則可以建立一個函數指針數組，進行散轉。</li><li>在數據結構中，鏈表、樹、圖等大量的應用都離不開指針。</li></ul><h2 class=pgc-h-arrow-right>2 指針是什麼？</h2><p>操作系統將硬件和軟件結合起來，給程序員提供的一種對內存使用的抽象，這種抽象機制使得程序使用的是虛擬存儲器,而不是直接操作和使用真實存在的物理存儲器。所有的虛擬地址形成的集合就是虛擬地址空間。</p><p>內存是一個很大的線性的字節數組，每個字節固定由 8 個二進制位組成，每個字節都有唯一的編號，如下圖，這是一個 4G 的內存，他一共有 4x1024x1024x1024 = 4294967296 個字節，那麼它的地址範圍就是 0 ~ 4294967296 ，十六進制表示就是 0x00000000～0xffffffff ，當程序使用的數據載入內存時，都有自己唯一的一個編號，這個編號就是這個數據的地址。指針就是這樣形成的。</p><div class=pgc-img><img alt=C語言指針終極指南！（附詳盡圖示和代碼） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4e7017cb21b9471891cf2f2febf5befe><p class=pgc-img-caption></p></div><p>1</p><pre><code>#include &lt;stdio.h&gt;int main(void){    char ch = 'a';    int  num = 97;    printf("ch 的地址:%p\n",&amp;ch);       //ch 的地址:00BEFDF7    printf("num的地址:%p\n",&amp;num);      //num的地址:00BEFDF8    return 0;}</code></pre><div class=pgc-img><img alt=C語言指針終極指南！（附詳盡圖示和代碼） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7fd427d1df114365bb9e040702354c52><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=C語言指針終極指南！（附詳盡圖示和代碼） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2c8a7ed24e8149029fa7ce76b080e947><p class=pgc-img-caption></p></div><p>指針不僅可以表示變量的地址，還可以存儲各種類型數據的地址，指針變量是用來保存這些地址的變量，與數組類似，依據地址存放的數據類型，指針也分為 int 指針類型， double 指針類型， char 指針類型等等。</p><p>綜上，<strong>指針的實質就是數據在內存中的地址，而指針變量是用來保存這些地址的變量</strong>。</p><h2 class=pgc-h-arrow-right>指針變量 和 指向關係</h2><p>用來保存 指針 的變量，就是指針變量。如果指針變量p保存了變量 num的地址，則就說：p指向了變量num，也可以說p指向了num所在的內存塊，指針變量pp指向了p所在的內存塊，以下面為例：</p><pre><code>#include &lt;stdio.h&gt;int main(void){  int num = 97;  char ch = 'a';  int *p = &amp; num;  int **pp = &amp;p  char *p1 = &amp; ch;  printf("num 的地址:%p\n",&amp;num);     printf("指針p的值:%p\n",p);     printf("指針p的地址:%p\n",&amp;p);    printf("指針pp的值:%p\n",pp);   printf("ch 的地址:%p\n",&amp;ch);    return 0;}</code></pre><div class=pgc-img><img alt=C語言指針終極指南！（附詳盡圖示和代碼） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5b8673b6b16b49308fe658d86a405546><p class=pgc-img-caption></p></div><p>運行結果</p><ul><li>int型的num值為97佔4個字節，內存地址為: 0113F924， char 型的 ch('a')值為97佔1個字節，內存地址為: 0113F91B。</li></ul><div class=pgc-img><img alt=C語言指針終極指南！（附詳盡圖示和代碼） onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/d9862e5b5ae44e719a1cd0c5abc412ef><p class=pgc-img-caption></p></div><p>int型佔4個字節</p><div class=pgc-img><img alt=C語言指針終極指南！（附詳盡圖示和代碼） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/cd0bdcd5189849d3b02d05e1c628f094><p class=pgc-img-caption></p></div><p>char型佔1個字節</p><ul><li>num的地址為： 0113F924， num的值為 97 ，指針 p 指向 num 的內存塊，指針 p 地址為： 0113F90C， p的內存保存的值就是 num的地址 0113F924。</li></ul><div class=pgc-img><img alt=C語言指針終極指南！（附詳盡圖示和代碼） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2d206eff17204877aafc7ad367a5c826><p class=pgc-img-caption></p></div><p>0x0113F90C存儲的內容為地址0113F924</p><ul><li>指針變量 pp 指向 指針 p，指針 pp 內存值為 指針 p 的地址： 0113F90C，形成了只想指針的指針。</li></ul><div class=pgc-img><img alt=C語言指針終極指南！（附詳盡圖示和代碼） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0fad3ae29e7c4c6e9efccbb8159db4ab><p class=pgc-img-caption></p></div><p>指針pp為指向指針p的指針</p><h3 class=pgc-h-arrow-right>定義指針變量</h3><p>C語言中，定義變量時，在變量名 前 寫一個 * 星號，這個變量就變成了對應變量類型的指針變量。必要時要加( ) 來避免優先級的問題。</p><p>引申：C語言中，定義變量時，在定義的最前面寫上typedef ，那麼這個變量名就成了一種類型，即這個類型的同義詞。</p><pre><code>int a ; //int類型變量 aint *a ; //int* 變量aint arr[3]; //arr是包含3個int元素的數組int (* arr )[3]; //arr是一個指向包含3個int元素的數組的指針變量int* p_int; //指向int類型變量的指針 double* p_double; //指向idouble類型變量的指針 struct Student *p_struct; //結構體類型的指針int(*p_func)(int,int); //指向返回類型為int，有2個int形參的函數的指針 int(*p_arr)[3]; //指向含有3個int元素的數組的指針 int** p_pointer; //指向 一個整形變量指針的指針</code></pre><h3 class=pgc-h-arrow-right>取地址</h3><p>既然有了指針變量，那就得讓他保存其它變量的地址，使用& 運算符取得一個變量的地址。</p><pre><code>int add(int a , int b){    return a + b;}int main(void){    int num = 97;    float score = 10.00F;    int arr[3] = {1,2,3};    int* p_num = #    float* p_score = &amp;score    int (*p_arr)[3] = &amp;arr               int (*fp_add)(int ,int )  = add;  //p_add是指向函數add的函數指針    return 0;}</code></pre><p><strong>特殊的情況，他們並不一定需要使用&取地址</strong>：</p><ul><li>數組名的值就是這個數組的第一個元素的地址。</li><li>函數名的值就是這個函數的地址。</li><li>字符串字面值常量作為右值時，就是這個字符串對應的字符數組的名稱,也就是這個字符串在內存中的地址。</li></ul><pre><code>int add(int a , int b){    return a + b;}int main(void){    int arr[3] = {1,2,3};    int* p_first = arr;    int (*fp_add)(int ,int )  =  add;    const char* msg = "Hello world";    return 0;}</code></pre><h3 class=pgc-h-arrow-right>解地址</h3><p>對一個指針解地址，就可以取到這個內存數據，解地址 的寫法，就是在指針的前面加一個 * 號。</p><p>解指針的實質是：從指針指向的內存塊中取出這個內存數據。</p><pre><code>int main(void){    int age = 19;    int*p_age = &amp;age    *p_age  = 20;  //通過指針修改指向的內存數據    printf("age = %d",*p_age);   //通過指針讀取指向的內存數據    printf("age = %d",age);    return 0;}</code></pre><h3 class=pgc-h-arrow-right>空指針</h3><p>空指針在概念上不同於未初始化的指針。空指針可以確保不指向任何對象或函數；而未初始化的指針則可能指向任何地方。空指針不是野指針。</p><p>在C語言中，我們讓指針變量賦值為NULL表示一個空指針，而C語言中，NULL實質是 ((void*)0) ， 在C++中，NULL實質是0。</p><pre><code>#ifdef __cplusplus     #define NULL    0#else         #define NULL    ((void *)0)#endif</code></pre><h3 class=pgc-h-arrow-right>void*類型指針</h3><p>void是一種特殊的指針類型，可以用來存放任意對象的地址。一個void指針存放著一個地址，這一點和其他指針類似。不同的是，我們對它到底儲存的是什麼對象的地址並不瞭解。</p><pre><code>double a=2.3;int b=5;void *p=&amp;acout&lt;&lt;p&lt;&lt;endl;   //輸出了a的地址p=&amp;bcout&lt;&lt;p&lt;&lt;endl;   //輸出了b的地址//cout&lt;&lt;*p&lt;&lt;endl;這一行不可以執行，void*指針只可以儲存變量地址，不可以直接操作它指向的對象</code></pre><p>由於void是空類型，只保存了指針的值，而丟失了類型信息，我們不知道他指向的數據是什麼類型的，只指定這個數據在內存中的起始地址，如果想要完整的提取指向的數據，程序員就必須對這個指針做出正確的類型轉換，然後再解指針。</p><h2 class=pgc-h-arrow-right>數組和指針</h2><ul><li>同類型指針變量可以相互賦值，數組不行，只能一個一個元素的賦值或拷貝</li><li>數組在內存中是連續存放的，開闢一塊連續的內存空間。數組是根據數組的下進行訪問的。指針很靈活，它可以指向任意類型的數據。指針的類型說明了它所指向地址空間的內存。</li><li>數組所佔存儲空間的內存： sizeof（數組名） 數組的大小： sizeof（數組名）/sizeof（數據類型），在32位平臺下，無論指針的類型是什麼， sizeof（指針名）都是 4 ，在 64 位平臺下，無論指針的類型是什麼， sizeof（指針名）都是 8 。</li><li>數組名作為右值的時候，就是第一個元素的地址</li></ul><pre><code>int main(void){    int arr[5] = {1,2,3,4,5};    int *p_first = arr;    printf("%d",*p_first);  //1    return 0;}</code></pre><ul><li>指向數組元素的指針 支持 遞增 遞減 運算。 p= p+1意思是，讓 p指向原來指向的內存塊的下一個相鄰的相同類型的內存塊。在數組中相鄰內存就是相鄰下標元素。</li></ul><h2 class=pgc-h-arrow-right>函數與指針</h2><h3 class=pgc-h-arrow-right>函數的參數和指針</h3><p>C語言中，實參傳遞給形參，是按值傳遞的，也就是說，函數中的形參是實參的拷貝份，形參和實參只是在值上面一樣，而不是同一個內存數據對象。這就意味著：這種數據傳遞是單向的，即從調用者傳遞給被調函數，而被調函數無法修改傳遞的參數達到回傳的效果。</p><pre><code>void change(int a){    a++;      //在函數中改變的只是這個函數的局部變量a，而隨著函數執行結束，a被銷燬。age還是原來的age，紋絲不動。}int main(void){    int age = 60;    change(age);    printf("age = %d",age);   // age = 60    return 0;}</code></pre><p>有時候我們可以使用函數的返回值來回傳數據，在簡單的情況下是可以的，但是如果返回值有其它用途（例如返回函數的執行狀態量），或者要回傳的數據不止一個，返回值就解決不了了。</p><p>傳遞變量的指針可以輕鬆解決上述問題。</p><pre><code>void change(int* pa){    (*pa)++;   //因為傳遞的是age的地址，因此pa指向內存數據age。當在函數中對指針pa解地址時，               //會直接去內存中找到age這個數據，然後把它增1。}int main(void){    int age = 160;    change(&amp;age);    printf("age = %d",age);   // age = 61    return 0;}</code></pre><p>比如指針的一個常見的使用例子：</p><pre><code>#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;void swap(int *,int *);int main(){    int a=5,b=10;    printf("a=%d,b=%d\n",a,b);    swap(&amp;a,&amp;b);    printf("a=%d,b=%d\n",a,b);    return 0;}void swap(int *pa,int *pb){    int t=*pa;*pa=*pb;*pb=t;}</code></pre><p>在以上的例子中，swap函數的兩個形參pa和pb可以接收兩個整型變量的地址，並通過間接訪問的方式修改了它指向變量的值。在main函數中調用swap時，提供的實參分別為&a,&b，這樣就實現了pa=&a,pb=&b的賦值過程，這樣在swap函數中就通過*pa修改了 a 的值，通過*pb修改了 b 的值。因此，如果需要在被調函數中修改主調函數中變量的值，就需要經過以下幾個步驟：</p><ul><li>定義函數的形參必須為指針類型，以接收主調函數中傳來的變量的地址；</li><li>調用函數時實參為變量的地址；</li><li>在被調函數中使用*間接訪問形參指向的內存空間，實現修改主調函數中變量值的功能。</li></ul><p>指針作為函數的形參的另一個典型應用是當函數有多個返回值的情形。比如，需要在一個函數中統計一個數組的最大值、最小值和平均值。當然你可以編寫三個函數分別完成統計三個值的功能。但比較囉嗦，如：</p><pre><code>int GetMax(int a[],int n){    int max=a[0],i;    for(i=1;i&lt;n;i++)    {        if(max&lt;a[i]) max=a[i];    }    return max;}int GetMin(int a[],int n){    int min=a[0],i;    for(i=1;i&lt;n;i++)    {        if(min&gt;a[i]) min=a[i];    }    return min;}double GetAvg(int a[],int n){    double avg=0;    int i;    for(i=0;i&lt;n;i++)    {        avg+=a[i];    }    return avg/n;}</code></pre><p>其實我們完全可以在一個函數中完成這個功能，由於函數只能有一個返回值，可以返回平均值，最大值和最小值可以通過指針類型的形參來進行實現：</p><pre><code>double Stat(int a[],int n,int *pmax,int *pmin){    double avg=a[0];    int i;    *pmax=*pmin=a[0];    for(i=1;i&lt;n;i++)    {        avg+=a[i];        if(*pmax&lt;a[i]) *pmax=a[i];        if(*pmin&gt;a[i]) *pmin=a[i];    }    return avg/n;}</code></pre><h3 class=pgc-h-arrow-right>函數的指針</h3><p>一個函數總是佔用一段連續的內存區域，函數名在表達式中有時也會被轉換為該函數所在內存區域的首地址。我們可以把函數的這個首地址賦予一個指針變量，使指針變量指向函數所在的內存區域，然後通過指針變量就可以找到並調用該函數。這種指針就是函數指針。</p><p>函數指針的定義形式為：</p><p>returnType (*pointerName)(param list);</p><p>returnType 為函數返回值類型，pointerNmae 為指針名稱，param list 為函數參數列表。參數列表中可以同時給出參數的類型和名稱，也可以只給出參數的類型，省略參數的名稱，這一點和函數原型非常類似。</p><p>用指針來實現對函數的調用：</p><pre><code>#include &lt;stdio.h&gt;//返回兩個數中較大的一個int max(int a, int b){    return a&gt;b ? a : b;}int main(){    int x, y, maxval;    //定義函數指針    int (*pmax)(int, int) = max;  //也可以寫作int (*pmax)(int a, int b)    printf("Input two numbers:");    scanf("%d %d", &amp;x, &amp;y);    maxval = (*pmax)(x, y);    printf("Max value: %d\n", maxval);    return 0;}</code></pre><h2 class=pgc-h-arrow-right>結構體和指針</h2><p>結構體指針有特殊的語法： -> 符號</p><p>如果p是一個結構體指針，則可以使用 p ->【成員】 的方法訪問結構體的成員</p><pre><code>typedef struct{    char name[31];    int age;    float score;}Student;int main(void){    Student stu = {"Bob" , 19, 98.0};    Student*ps = &amp;stu    ps-&gt;age = 20;    ps-&gt;score = 99.0;    printf("name:%s age:%d",ps-&gt;name,ps-&gt;age);    return 0;}</code></pre><h2 class=pgc-h-arrow-right>const 和 指針</h2><ul><li>指向常量的指針，值不能改變，指向可改變</li><li>常指針值能改變，指向不可改變</li><li>指向常量的常指針，都不能改變</li></ul><pre><code>#include &lt;stdio.h&gt; int main(){  // 1 可改變指針  const int a = 10;  int *p = &amp;a  *p = 1000;  printf("*p = %d\n", *p);   // 2 可改變指針  const b = 10;  int *pb = &amp;b  pb = p;  printf("*pb = %d\n", *pb);   // 3  const c = 10;  int * const pc = &amp;c  *pc = 1000;  //pc = pb;不能改變   //4  const d = 10;  const * int const pd = &amp;d  //*pd = 1000; 不能改變    printf("\n");  return 0;}</code></pre><h2 class=pgc-h-arrow-right>深拷貝和淺拷貝</h2><p>如果2個程序單元（例如2個函數）是通過拷貝 他們所共享的數據的 指針來工作的，這就是淺拷貝，因為真正要訪問的數據並沒有被拷貝。如果被訪問的數據被拷貝了，在每個單元中都有自己的一份，對目標數據的操作相互 不受影響，則叫做深拷貝。</p><pre><code>#include &lt;iostream&gt;using namespace std;class CopyDemo{public:  CopyDemo(int pa,char *cstr)  //構造函數，兩個參數  {     this-&gt;a = pa;     this-&gt;str = new char[1024]; //指針數組，動態的用new在堆上分配存儲空間     strcpy(this-&gt;str,cstr);    //拷貝過來  }//沒寫，C++會自動幫忙寫一個複製構造函數，淺拷貝只複製指針,如下注釋部分  //CopyDemo(CopyDemo&amp; obj)    //{  //   this-&gt;a = obj.a;  //  this-&gt;str = obj.str; //這裡是淺複製會出問題，要深複製  //}  CopyDemo(CopyDemo&amp; obj)  //一般數據成員有指針要自己寫複製構造函數，如下  {     this-&gt;a = obj.a;    // this-&gt;str = obj.str; //這裡是淺複製會出問題，要深複製     this-&gt;str = new char[1024];//應該這樣寫     if(str != 0)        strcpy(this-&gt;str,obj.str); //如果成功，把內容複製過來  }  ~CopyDemo()  //析構函數  {     delete str;  }public:     int a;  //定義一個整型的數據成員     char *str; //字符串指針};int main(){  CopyDemo A(100,"hello!!!");  CopyDemo B = A;  //複製構造函數，把A的10和hello!!!複製給B  cout &lt;&lt;"A:"&lt;&lt; A.a &lt;&lt; "," &lt;&lt;A.str &lt;&lt; endl;  //輸出A:100，hello!!!  cout &lt;&lt;"B:"&lt;&lt; B.a &lt;&lt; "," &lt;&lt;B.str &lt;&lt; endl;  //輸出B:100，hello!!!  //修改後,發現A,B都被改變，原因就是淺複製，A,B指針指向同一地方，修改後都改變  B.a = 80;  B.str[0] = 'k';  cout &lt;&lt;"A:"&lt;&lt; A.a &lt;&lt; "," &lt;&lt;A.str &lt;&lt; endl;  //輸出A:100，kello!!!  cout &lt;&lt;"B:"&lt;&lt; B.a &lt;&lt; "," &lt;&lt;B.str &lt;&lt; endl;  //輸出B:80，kello!!!  return 0;}</code></pre><p>根據上面實例可以看到，淺複製僅複製對象本身（其中包括是指針的成員），這樣不同被複制對象的成員中的對應非空指針會指向同一對象，被成員指針引用的對象成為共享的，無法直接通過指針成員安全地刪除（因為若直接刪除，另外對象中的指針就會無效，形成所謂的野指針，而訪問無效指針是危險的；</p><p>除非這些指針有引用計數或者其它手段確保被指對象的所有權）；而深複製在淺複製的基礎上，連同指針指向的對象也一起復制，代價比較高，但是相對容易管理。</p><p><br></p><p>更多幹貨內容只需要你關注電子芯吧客微信公眾號</p><p class=pgc-end-literature>本文轉載自公眾號“C語言與CPP編程” ，作者自成一派123</p><p><br></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>語言</a></li><li><a>指針</a></li><li><a>終極</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/178bc13f.html alt=C語言指針難嗎？紙老虎而已，純乾貨講解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/71b50f2a7c1141a2ac44a24efb4a84ff style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/178bc13f.html title=C語言指針難嗎？紙老虎而已，純乾貨講解>C語言指針難嗎？紙老虎而已，純乾貨講解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a0bb3a1a.html alt=C語言指針運算不理解？深入淺出通俗易懂，一題吃透指針與數組 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f86ddd3196544739bc425c80fd9c9c5e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a0bb3a1a.html title=C語言指針運算不理解？深入淺出通俗易懂，一題吃透指針與數組>C語言指針運算不理解？深入淺出通俗易懂，一題吃透指針與數組</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/34838dce.html alt=C精品編程之——指針，C語言的精髓，每個編程初學者的噩夢 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a0b5a50b90804963b14ab394517ae294 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/34838dce.html title=C精品編程之——指針，C語言的精髓，每個編程初學者的噩夢>C精品編程之——指針，C語言的精髓，每個編程初學者的噩夢</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4c6a3555.html alt=C語言指針怎麼理解？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2245f99437eb40f38a501559e7695694 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4c6a3555.html title=C語言指針怎麼理解？>C語言指針怎麼理解？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/42ec5444.html alt=C語言的精華指針，沒學指針就是沒學C語言！零基礎瞭解C語言指針 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3751eb5d53b64a3085de1113ad56d98a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/42ec5444.html title=C語言的精華指針，沒學指針就是沒學C語言！零基礎瞭解C語言指針>C語言的精華指針，沒學指針就是沒學C語言！零基礎瞭解C語言指針</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/00508d48.html alt=c語言指針有哪些？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1530609445503dc7f276929 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/00508d48.html title=c語言指針有哪些？>c語言指針有哪些？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9c706fd4.html alt=初識C語言指針 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/202ea458-f961-4d7f-8442-64dc6ce814c8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9c706fd4.html title=初識C語言指針>初識C語言指針</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9dc72d59.html alt=指針-C語言的靈魂(五)-指針與數組的微妙關係 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/152125795472869eabef91e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9dc72d59.html title=指針-C語言的靈魂(五)-指針與數組的微妙關係>指針-C語言的靈魂(五)-指針與數組的微妙關係</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1cbb5c65.html alt=指針-C語言的靈魂(四)-指針運算 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1521079213682d1229d1654 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1cbb5c65.html title=指針-C語言的靈魂(四)-指針運算>指針-C語言的靈魂(四)-指針運算</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4ea6119e.html alt=深入理解C語言的指針 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4e2601d6d7b04dc2b8107b4555ef6910 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4ea6119e.html title=深入理解C語言的指針>深入理解C語言的指針</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/49b31745.html alt=讓你從根本上理解C語言指針，真正明白C語言指針 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a8e086b8d7104de098e65d9bd42a348d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/49b31745.html title=讓你從根本上理解C語言指針，真正明白C語言指針>讓你從根本上理解C語言指針，真正明白C語言指針</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/299cf68e.html alt="C語言指針詳解（經典 非常詳細 通俗易懂）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/945d85d21fcf45cba3e994a7220e2112 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/299cf68e.html title="C語言指針詳解（經典 非常詳細 通俗易懂）">C語言指針詳解（經典 非常詳細 通俗易懂）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d7e80fb.html alt=C語言每日一練4——利用指針進行數交換 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d7e80fb.html title=C語言每日一練4——利用指針進行數交換>C語言每日一練4——利用指針進行數交換</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/65d2605f.html alt=什麼是梯度：用形象的語言解讀梯度的本質原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/557c7b377c5449bb885df35b2d354e03 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/65d2605f.html title=什麼是梯度：用形象的語言解讀梯度的本質原理>什麼是梯度：用形象的語言解讀梯度的本質原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4b2ac18d.html alt=我國首部較少民族語言工具書《鄂倫春語常用語發音詞典》出版發行 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/S5YRqTH6awaqmG style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4b2ac18d.html title=我國首部較少民族語言工具書《鄂倫春語常用語發音詞典》出版發行>我國首部較少民族語言工具書《鄂倫春語常用語發音詞典》出版發行</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>