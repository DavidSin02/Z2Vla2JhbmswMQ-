<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>é¢è©¦å®˜ï¼šå•ä½ ä¸€å€‹ï¼ŒSpringäº‹å‹™æ˜¯å¦‚ä½•å‚³æ’­çš„ï¼Ÿ | æå®¢å¿«è¨Š</title><meta property="og:title" content="é¢è©¦å®˜ï¼šå•ä½ ä¸€å€‹ï¼ŒSpringäº‹å‹™æ˜¯å¦‚ä½•å‚³æ’­çš„ï¼Ÿ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/6513100097ce4d27b1df49cd347e4d88"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/358ab5f.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/358ab5f.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/358ab5f.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/358ab5f.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/358ab5f.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/358ab5f.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/358ab5f.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/358ab5f.html><meta property="article:published_time" content="2020-10-29T20:50:41+08:00"><meta property="article:modified_time" content="2020-10-29T20:50:41+08:00"><meta name=Keywords content><meta name=description content="é¢è©¦å®˜ï¼šå•ä½ ä¸€å€‹ï¼ŒSpringäº‹å‹™æ˜¯å¦‚ä½•å‚³æ’­çš„ï¼Ÿ"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/358ab5f.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>é¢è©¦å®˜ï¼šå•ä½ ä¸€å€‹ï¼ŒSpringäº‹å‹™æ˜¯å¦‚ä½•å‚³æ’­çš„ï¼Ÿ</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>æ¨è–¦å­¸ç¿’</h1><ul><li><a class=pgc-link data-content=mp data-source=innerLink href="https://www.toutiao.com/i6844768153789006339/?group_id=6844768153789006339" rel="noopener noreferrer" target=_blank>è‚äº†åå¤©åŠæœˆï¼Œç»ä¸Šç´”æ‰‹ç¹ªâ€œSpring/Cloud/Boot/MVCâ€å…¨å®¶æ¡¶è…¦åœ–</a></li><li><a class=pgc-link data-content=mp data-source=innerLink href="https://www.toutiao.com/i6876044225012892163/?group_id=6876044225012892163" rel="noopener noreferrer" target=_blank>ç˜‹ç‹‚è†œæ‹œï¼é˜¿é‡Œå‡ºå“Spring Securityç‹è€…æ™‰ç´šæ–‡æª”</a></li><li><a class=pgc-link data-content=mp data-source=innerLink href="https://www.toutiao.com/i6865671837171319299/?group_id=6865671837171319299" rel="noopener noreferrer" target=_blank>çœŸé¦™è­¦å‘Šï¼Alibabaçè—ç‰ˆmybatisæ‰‹å¯«æ–‡æª”ï¼Œåˆ·èµ·ä¾†</a></li></ul><div class=pgc-img><img alt=é¢è©¦å®˜ï¼šå•ä½ ä¸€å€‹ï¼ŒSpringäº‹å‹™æ˜¯å¦‚ä½•å‚³æ’­çš„ï¼Ÿ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6513100097ce4d27b1df49cd347e4d88><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">å‰è¨€</span></h1><p style=text-align:start>Springäº‹å‹™æ˜¯å¦‚ä½•å‚³æ’­çš„ï¼Ÿ</p><p style=text-align:start>å…¶å¯¦<span style="color:#4d4d4d;--tt-darkmode-color: #999999">ä¹‹å‰æœ‰åˆ†æäº‹å‹™è¨»è§£çš„è§£æéç¨‹ï¼Œæœ¬è³ªä¸Šæ˜¯å°‡äº‹å‹™å°è£ç‚ºåˆ‡é¢åŠ å…¥åˆ°AOPçš„åŸ·è¡Œéˆä¸­ï¼Œå› æ­¤æœƒèª¿ç”¨åˆ°MethodInceptorçš„å¯¦ç¾é¡çš„invokeæ–¹æ³•ï¼Œè€Œäº‹å‹™åˆ‡é¢çš„Interceptorå°±æ˜¯</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">TransactionInterceptor</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼Œæ‰€ä»¥æœ¬ç¯‡ç›´æ¥å¾è©²é¡é–‹å§‹ã€‚</span></p><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">äº‹å‹™</span><span style="color:#4f4f4f;--tt-darkmode-color: #979797">åˆ‡é¢çš„èª¿ç”¨éç¨‹</span></h1><pre><code>	public Object invoke(MethodInvocation invocation) throws Throwable {		// Work out the target class: may be {@code null}.		// The TransactionAttributeSource should be passed the target class		// as well as the method, which may be from an interface.		Class&lt;?&gt; targetClass = (invocation.getThis() != null ? AopUtils.getTargetClass(invocation.getThis()) : null);		// Adapt to TransactionAspectSupport's invokeWithinTransaction...		return invokeWithinTransaction(invocation.getMethod(), targetClass, invocation::proceed);	}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é€™å€‹æ–¹æ³•æœ¬èº«æ²’åšä»€éº¼äº‹ï¼Œä¸»è¦æ˜¯èª¿ç”¨äº†çˆ¶é¡çš„</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">invokeWithinTransaction</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•ï¼Œæ³¨æ„æœ€å¾Œä¸€å€‹åƒæ•¸ï¼Œå‚³å…¥çš„æ˜¯ä¸€å€‹lambdaè¡¨é”å¼ï¼Œè€Œé€™å€‹è¡¨é”å¼ä¸­çš„èª¿ç”¨çš„æ–¹æ³•æ‡‰è©²ä¸é™Œç”Ÿï¼Œåœ¨åˆ†æAOPèª¿ç”¨éˆæ™‚ï¼Œå°±æ˜¯é€šéé€™å€‹æ–¹æ³•</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å‚³éåˆ°ä¸‹ä¸€å€‹åˆ‡é¢</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æˆ–æ˜¯</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">èª¿ç”¨è¢«ä»£ç†å¯¦ä¾‹çš„æ–¹æ³•</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼Œå¿˜è¨˜äº†çš„å¯ä»¥å›å»çœ‹çœ‹ã€‚</span></p><pre><code>	protected Object invokeWithinTransaction(Method method, @Nullable Class&lt;?&gt; targetClass,			final InvocationCallback invocation) throws Throwable {		// If the transaction attribute is null, the method is non-transactional.		//ç²å–äº‹å‹™å±¬æ€§é¡ AnnotationTransactionAttributeSource		TransactionAttributeSource tas = getTransactionAttributeSource();		//ç²å–æ–¹æ³•ä¸Šé¢æœ‰@Transactionalè¨»è§£çš„å±¬æ€§		final TransactionAttribute txAttr = (tas != null ? tas.getTransactionAttribute(method, targetClass) : null);		//ç²å–äº‹å‹™ç®¡ç†å™¨		final PlatformTransactionManager tm = determineTransactionManager(txAttr);		final String joinpointIdentification = methodIdentification(method, targetClass, txAttr);		if (txAttr == null || !(tm instanceof CallbackPreferringPlatformTransactionManager)) {			TransactionInfo txInfo = createTransactionIfNecessary(tm, txAttr, joinpointIdentification);			Object retVal = null;			try {				// èª¿ç”¨proceedæ–¹æ³•				retVal = invocation.proceedWithInvocation();			}			catch (Throwable ex) {				// target invocation exception				//äº‹å‹™å›æ»¾				completeTransactionAfterThrowing(txInfo, ex);				throw ex;			}			finally {				cleanupTransactionInfo(txInfo);			}			//äº‹å‹™æäº¤			commitTransactionAfterReturning(txInfo);			return retVal;		}			// çœç•¥äº†else	}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é€™å€‹æ–¹æ³•é‚è¼¯å¾ˆæ¸…æ™°ï¼Œä¸€ç›®ç­ç„¶ï¼Œifè£¡é¢å°±æ˜¯å°è²æ˜å¼äº‹å‹™çš„è™•ç†ï¼Œå…ˆèª¿ç”¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">createTransactionIfNecessary</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•é–‹å•Ÿäº‹å‹™ï¼Œç„¶å¾Œé€šé</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">invocation.proceedWithInvocation</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">èª¿ç”¨ä¸‹ä¸€å€‹åˆ‡é¢ï¼Œå¦‚æœæ²’æœ‰å…¶å®ƒåˆ‡é¢äº†ï¼Œå°±æ˜¯èª¿ç”¨è¢«ä»£ç†é¡çš„æ–¹æ³•ï¼Œå‡ºç¾ç•°å¸¸å°±å›æ»¾ï¼Œå¦å‰‡æäº¤äº‹å‹™ï¼Œé€™å°±æ˜¯Springäº‹å‹™åˆ‡é¢çš„åŸ·è¡Œéç¨‹ã€‚ä½†æ˜¯ï¼Œæˆ‘å€‘ä¸»è¦è¦ææ‡‚çš„å°±æ˜¯åœ¨é€™äº›æ–¹æ³•ä¸­æ˜¯å¦‚ä½•ç®¡ç†äº‹å‹™ä»¥åŠäº‹å‹™åœ¨å¤šå€‹æ–¹æ³•ä¹‹é–“æ˜¯å¦‚ä½•å‚³æ’­çš„ã€‚</span></p><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">äº‹å‹™çš„å‚³æ’­æ€§æ¦‚å¿µ</span></h1><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å‚³æ’­æ€§æ˜¯Springè‡ªå·±æå‡ºä¾†çš„ï¼Œæ•¸æ“šåº«æ˜¯æ²’æœ‰çš„ï¼Œå› ç‚ºæ¶‰åŠåˆ°æ–¹æ³•é–“çš„èª¿ç”¨ï¼Œé‚£éº¼å¿…ç„¶å°±éœ€è¦è€ƒæ…®äº‹å‹™åœ¨é€™äº›æ–¹æ³•ä¹‹é–“å¦‚ä½•æµè½‰ï¼Œæ‰€ä»¥Springæä¾›äº†7å€‹å‚³æ’­å±¬æ€§ä¾›é¸æ“‡ï¼Œå¯ä»¥å°‡å…¶çœ‹æˆå…©å¤§é¡ï¼Œå³æ˜¯å¦æ”¯æŒç•¶å‰äº‹å‹™ï¼š</span></p><ol start=1><li>æ”¯æŒç•¶å‰äº‹å‹™ï¼ˆåœ¨åŒä¸€å€‹äº‹å‹™ä¸­ï¼‰ï¼š</li></ol><blockquote><p><span style="background-color:#eef0f4;--tt-darkmode-bgcolor: #BDBEC1">PROPAGATION_REQUIREDï¼šæ”¯æŒç•¶å‰äº‹å‹™ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±æ–°å»ºä¸€å€‹äº‹å‹™ã€‚PROPAGATION_MANDATORYï¼šæ”¯æŒç•¶å‰äº‹å‹™ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±æ‹‹å‡ºç•°å¸¸ã€‚PROPAGATION_SUPPORTSï¼šæ”¯æŒç•¶å‰äº‹å‹™ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¸ä½¿ç”¨äº‹å‹™ã€‚</span></p></blockquote><ol start=2><li>ä¸æ”¯æŒç•¶å‰äº‹å‹™ï¼ˆä¸åœ¨åŒä¸€å€‹äº‹å‹™ä¸­ï¼‰ï¼š</li></ol><blockquote><p><span style="background-color:#eef0f4;--tt-darkmode-bgcolor: #BDBEC1">PROPAGATION_NEVERï¼šä»¥éäº‹å‹™çš„æ–¹å¼é‹è¡Œï¼Œå¦‚æœæœ‰äº‹å‹™ï¼Œå‰‡æ‹‹å‡ºç•°å¸¸ã€‚PROPAGATION_NOT_SUPPORTEDï¼šä»¥éäº‹å‹™çš„æ–¹å¼é‹è¡Œï¼Œå¦‚æœæœ‰äº‹å‹™ï¼Œå‰‡æ›èµ·ç•¶å‰äº‹å‹™ã€‚PROPAGATION_REQUIRES_NEWï¼šæ–°å»ºäº‹å‹™ï¼Œå¦‚æœæœ‰äº‹å‹™ï¼Œæ›èµ·ç•¶å‰äº‹å‹™ï¼ˆå…©å€‹äº‹å‹™ç›¸äº’ç¨ç«‹ï¼Œçˆ¶äº‹å‹™å›æ»¾ä¸å½±éŸ¿å­äº‹å‹™ï¼‰ã€‚PROPAGATION_NESTEDï¼šå¦‚æœç•¶å‰äº‹å‹™å­˜åœ¨ï¼Œå‰‡åµŒå¥—äº‹å‹™åŸ·è¡Œï¼ˆæŒ‡å¿…é ˆä¾å­˜çˆ¶äº‹å‹™ï¼Œå­äº‹å‹™ä¸èƒ½å–®ç¨æäº¤ä¸”çˆ¶äº‹å‹™å›æ»¾å‰‡å­äº‹å‹™ä¹Ÿå¿…é ˆå›æ»¾ï¼Œè€Œå­äº‹å‹™è‹¥å›æ»¾ï¼Œçˆ¶äº‹å‹™å¯ä»¥å›æ»¾ä¹Ÿå¯ä»¥æ•ç²ç•°å¸¸ï¼‰ã€‚å¦‚æœç•¶å‰æ²’æœ‰äº‹å‹™ï¼Œå‰‡é€²è¡Œèˆ‡PROPAGATION_REQUIREDé¡ä¼¼çš„æ“ä½œã€‚</span></p></blockquote><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åˆ¥çœ‹å±¬æ€§é€™éº¼å¤šï¼Œå¯¦éš›ä¸Šæˆ‘å€‘ä¸»è¦ç”¨çš„æ˜¯</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">PROPAGATION_REQUIRED</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é»˜èªå±¬æ€§ï¼Œä¸€äº›ç‰¹æ®Šæ¥­å‹™ä¸‹å¯èƒ½æœƒç”¨åˆ°</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">PROPAGATION_REQUIRES_NEW</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ä»¥åŠ</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">PROPAGATION_NESTED</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ã€‚ä¸‹é¢æˆ‘æœƒå‡è¨­ä¸€å€‹å ´æ™¯ï¼Œä¸¦ä¸»è¦åˆ†æé€™ä¸‰å€‹å±¬æ€§ã€‚</span></p><pre><code>public class A {		@Autowired	private B b;	@Transactional	public void addA() {		b.addB();	}}public class B {	@Transactional	public void addB() {		// doSomething...	}}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ä¸Šé¢æˆ‘å‰µå»ºäº†Aã€Bå…©å€‹é¡ï¼Œæ¯å€‹é¡ä¸­æœ‰ä¸€å€‹äº‹å‹™æ–¹æ³•ï¼Œä½¿ç”¨äº†è²æ˜å¼äº‹å‹™ä¸¦æ¡ç”¨çš„é»˜èªå‚³æ’­å±¬æ€§ï¼Œåœ¨Aä¸­èª¿ç”¨äº†Bçš„æ–¹æ³•ã€‚<br>ç•¶è«‹æ±‚ä¾†äº†èª¿ç”¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">addA</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ™‚ï¼Œé¦–å…ˆèª¿ç”¨çš„æ˜¯ä»£ç†å°è±¡çš„æ–¹æ³•ï¼Œå› æ­¤æœƒé€²å…¥</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">createTransactionIfNecessary</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•é–‹å•Ÿäº‹å‹™ï¼š</span></p><pre><code>	protected TransactionInfo createTransactionIfNecessary(@Nullable PlatformTransactionManager tm,			@Nullable TransactionAttribute txAttr, final String joinpointIdentification) {		// If no name specified, apply method identification as transaction name.		if (txAttr != null &amp;&amp; txAttr.getName() == null) {			txAttr = new DelegatingTransactionAttribute(txAttr) {				@Override				public String getName() {					return joinpointIdentification;				}			};		}		TransactionStatus status = null;		if (txAttr != null) {			if (tm != null) {				//é–‹å•Ÿäº‹å‹™ï¼Œé€™è£¡é‡é»çœ‹				status = tm.getTransaction(txAttr);			}			else {			}		}		//å‰µå»ºäº‹å‹™ä¿¡æ¯å°è±¡ï¼Œè¨˜éŒ„æ–°è€äº‹å‹™ä¿¡æ¯å°è±¡		return prepareTransactionInfo(tm, txAttr, joinpointIdentification, status);	}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å¯¦éš›ä¸Šé–‹å•Ÿäº‹å‹™æ˜¯é€šé</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">AbstractPlatformTransactionManager</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åšçš„ï¼Œè€Œé€™å€‹é¡æ˜¯ä¸€å€‹æŠ½è±¡é¡ï¼Œå…·é«”å¯¦ä¾‹åŒ–çš„å°è±¡å°±æ˜¯æˆ‘å€‘åœ¨é …ç›®è£¡å¸¸é…ç½®çš„</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">DataSourceTransactionManager</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å°è±¡ã€‚</span></p><pre><code>	public final TransactionStatus getTransaction(@Nullable TransactionDefinition definition) throws TransactionException {		//é€™è£¡é‡é»çœ‹ï¼Œ.DataSourceTransactionObjectæ‹¿åˆ°å°è±¡		Object transaction = doGetTransaction();		// Cache debug flag to avoid repeated checks.		boolean debugEnabled = logger.isDebugEnabled();		if (definition == null) {			// Use defaults if no transaction definition given.			definition = new DefaultTransactionDefinition();		}		//ç¬¬ä¸€æ¬¡é€²ä¾†connectionHolderç‚ºç©ºçš„ï¼Œæ‰€ä»¥ä¸å­˜åœ¨äº‹å‹™		if (isExistingTransaction(transaction)) {			// Existing transaction found -&gt; check propagation behavior to find out how to behave.			return handleExistingTransaction(definition, transaction, debugEnabled);		}		// Check definition settings for new transaction.		if (definition.getTimeout() &lt; TransactionDefinition.TIMEOUT_DEFAULT) {			throw new InvalidTimeoutException("Invalid transaction timeout", definition.getTimeout());		}		// No existing transaction found -&gt; check propagation behavior to find out how to proceed.		if (definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_MANDATORY) {			throw new IllegalTransactionStateException(					"No existing transaction found for transaction marked with propagation 'mandatory'");		}		//ç¬¬ä¸€æ¬¡é€²ä¾†å¤§éƒ¨åˆ†æœƒèµ°é€™è£¡		else if (definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_REQUIRED ||				definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_REQUIRES_NEW ||				definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_NESTED) {			//å…ˆæ›èµ·			SuspendedResourcesHolder suspendedResources = suspend(null);				if (debugEnabled) {					logger.debug("Creating new transaction with name [" + definition.getName() + "]: " + definition);				}				try {					boolean newSynchronization = (getTransactionSynchronization() != SYNCHRONIZATION_NEVER);					//å‰µå»ºäº‹å‹™ç‹€æ…‹å°è±¡ï¼Œå…¶å¯¦å°±æ˜¯å°è£äº†äº‹å‹™å°è±¡çš„ä¸€äº›ä¿¡æ¯ï¼Œè¨˜éŒ„äº‹å‹™ç‹€æ…‹çš„					DefaultTransactionStatus status = newTransactionStatus(							definition, transaction, true, newSynchronization, debugEnabled, suspendedResources);					//é–‹å•Ÿäº‹å‹™,é‡é»çœ‹çœ‹ DataSourceTransactionObject					doBegin(transaction, definition);					//é–‹å•Ÿäº‹å‹™å¾Œï¼Œæ”¹è®Šäº‹å‹™ç‹€æ…‹					prepareSynchronization(status, definition);					return status;			}			catch (RuntimeException | Error ex) {				resume(null, suspendedResources);				throw ex;			}		}		else {			boolean newSynchronization = (getTransactionSynchronization() == SYNCHRONIZATION_ALWAYS);			return prepareTransactionStatus(definition, null, true, newSynchronization, debugEnabled, null);		}	}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é€™å€‹æ–¹æ³•æµç¨‹æ¯”è¼ƒé•·ï¼Œä¸€æ­¥æ­¥ä¾†çœ‹ï¼Œå…ˆèª¿ç”¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">doGetTransaction</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•ç²å–ä¸€å€‹</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">DataSourceTransactionObject</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å°è±¡ï¼Œé€™å€‹é¡æ˜¯</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">JdbcTransactionObjectSupport</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">çš„å­é¡ï¼Œåœ¨çˆ¶é¡ä¸­æŒæœ‰äº†ä¸€å€‹</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ConnectionHolder</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å°è±¡ï¼Œè¦‹åçŸ¥æ„ï¼Œé€™å€‹å°è±¡ä¿å­˜äº†ç•¶å‰çš„é€£æ¥ã€‚</span></p><pre><code>	protected Object doGetTransaction() {		//ç®¡ç†connectionå°è±¡ï¼Œå‰µå»ºå›æ»¾é»ï¼ŒæŒ‰ç…§å›æ»¾é»å›æ»¾ï¼Œé‡‹æ”¾å›æ»¾é»		DataSourceTransactionObject txObject = new DataSourceTransactionObject();		//DataSourceTransactionManageré»˜èªæ˜¯å…è¨±åµŒå¥—äº‹å‹™çš„		txObject.setSavepointAllowed(isNestedTransactionAllowed());		//obtainDataSource() ç²å–æ•¸æ“šæºå°è±¡ï¼Œå…¶å¯¦å°±æ˜¯æ•¸æ“šåº«é€£æ¥å¡Šå°è±¡		ConnectionHolder conHolder =				(ConnectionHolder) TransactionSynchronizationManager.getResource(obtainDataSource());		txObject.setConnectionHolder(conHolder, false);		return txObject;	}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è¿½æº¯</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">getResource</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•å¯ä»¥çœ‹åˆ°</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ConnectionHolder æ˜¯å¾ThreadLocal</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è£¡ç²å–çš„ï¼Œä¹Ÿå°±æ˜¯</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç•¶å‰ç·šç¨‹</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼Œkeyæ˜¯</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">DataSource</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å°è±¡ï¼›ä½†æ˜¯ä»”ç´°æ€è€ƒä¸‹æˆ‘å€‘æ˜¯ç¬¬ä¸€æ¬¡é€²ä¾†ï¼Œæ‰€ä»¥é€™è£¡è‚¯å®šç²å–ä¸åˆ°çš„ï¼Œåä¹‹ï¼Œè¦å¾é€™è£¡ç²å–åˆ°å€¼ï¼Œé‚£å¿…ç„¶æ˜¯åŒä¸€å€‹ç·šç¨‹ç¬¬äºŒæ¬¡åŠä»¥å¾Œé€²å…¥åˆ°é€™è£¡ï¼Œä¹Ÿå°±æ˜¯åœ¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">addA</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">èª¿ç”¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">addB</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ™‚ï¼Œå¦å¤–éœ€è¦æ³¨æ„é€™è£¡ä¿å­˜</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ConnectionHolder</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åˆ°</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">DataSourceTransactionObject</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å°è±¡æ™‚æ˜¯å°‡</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">newConnectionHolder</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å±¬æ€§è¨­ç½®ç‚º</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">false</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">äº†çš„ã€‚<br>ç¹¼çºŒå¾€å¾Œï¼Œå‰µå»ºå®Œ</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">transaction</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å°è±¡å¾Œï¼Œæœƒèª¿ç”¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">isExistingTransaction</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åˆ¤æ–·æ˜¯å¦å·²ç¶“å­˜åœ¨ä¸€å€‹äº‹å‹™ï¼Œå¦‚æœå­˜åœ¨å°±æœƒèª¿ç”¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">handleExistingTransaction</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•ï¼Œé€™å€‹æ–¹æ³•å°±æ˜¯è™•ç†äº‹å‹™å‚³æ’­çš„æ ¸å¿ƒæ–¹æ³•ï¼Œå› ç‚ºæˆ‘å€‘æ˜¯ç¬¬ä¸€æ¬¡é€²ä¾†ï¼Œè‚¯å®šä¸å­˜åœ¨äº‹å‹™ï¼Œæ‰€ä»¥å…ˆè·³éã€‚<br>å†å¾€å¾Œï¼Œå¯ä»¥çœ‹åˆ°å°±æ˜¯è™•ç†ä¸åŒçš„å‚³æ’­å±¬æ€§ï¼Œä¸»è¦çœ‹åˆ°ä¸‹é¢é€™å€‹éƒ¨åˆ†ï¼š</span></p><pre><code>		else if (definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_REQUIRED ||				definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_REQUIRES_NEW ||				definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_NESTED) {			//å…ˆæ›èµ·			SuspendedResourcesHolder suspendedResources = suspend(null);				if (debugEnabled) {					logger.debug("Creating new transaction with name [" + definition.getName() + "]: " + definition);				}				try {					boolean newSynchronization = (getTransactionSynchronization() != SYNCHRONIZATION_NEVER);					//å‰µå»ºäº‹å‹™ç‹€æ…‹å°è±¡ï¼Œå…¶å¯¦å°±æ˜¯å°è£äº†äº‹å‹™å°è±¡çš„ä¸€äº›ä¿¡æ¯ï¼Œè¨˜éŒ„äº‹å‹™ç‹€æ…‹çš„					DefaultTransactionStatus status = newTransactionStatus(							definition, transaction, true, newSynchronization, debugEnabled, suspendedResources);					//é–‹å•Ÿäº‹å‹™,é‡é»çœ‹çœ‹ DataSourceTransactionObject					doBegin(transaction, definition);					//é–‹å•Ÿäº‹å‹™å¾Œï¼Œæ”¹è®Šäº‹å‹™ç‹€æ…‹					prepareSynchronization(status, definition);					return status;			}			catch (RuntimeException | Error ex) {				resume(null, suspendedResources);				throw ex;			}		}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç¬¬ä¸€æ¬¡é€²ä¾†æ™‚ï¼Œ</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">PROPAGATION_REQUIRED</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ã€</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">PROPAGATION_REQUIRES_NEW</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å’Œ</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">PROPAGATION_NESTED</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">éƒ½æœƒé€²å…¥åˆ°é€™è£¡ï¼Œé¦–å…ˆæœƒèª¿ç”¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">suspend</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ›èµ·ç•¶å‰å­˜åœ¨çš„äº‹å‹™ï¼Œåœ¨é€™è£¡æ²’å•¥ä½œç”¨ã€‚æ¥ä¸‹ä¾†é€šé</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">newTransactionStatus</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å‰µå»ºäº†</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">DefaultTransactionStatus</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å°è±¡ï¼Œé€™å€‹å°è±¡ä¸»è¦å°±æ˜¯å­˜å„²ç•¶å‰äº‹å‹™çš„ä¸€äº›ç‹€æ…‹ä¿¡æ¯ï¼Œéœ€è¦ç‰¹åˆ¥æ³¨æ„</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">newTransaction</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å±¬æ€§è¨­ç½®ç‚ºäº†</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">true</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼Œè¡¨ç¤ºæ˜¯ä¸€å€‹æ–°äº‹å‹™ã€‚ç‹€æ…‹å°è±¡å‰µå»ºå¥½ä¹‹å¾Œå°±æ˜¯é€šé</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">doBegin</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é–‹å•Ÿäº‹å‹™ï¼Œé€™æ˜¯ä¸€å€‹</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ¨¡æ¿æ–¹æ³•</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼š</span></p><pre><code>	protected void doBegin(Object transaction, TransactionDefinition definition) {		DataSourceTransactionObject txObject = (DataSourceTransactionObject) transaction;		Connection con = null;		try {			//å¦‚æœæ²’æœ‰æ•¸æ“šåº«é€£æ¥			if (!txObject.hasConnectionHolder() ||					txObject.getConnectionHolder().isSynchronizedWithTransaction()) {				//å¾é€£æ¥æ± è£¡é¢ç²å–é€£æ¥				Connection newCon = obtainDataSource().getConnection();				if (logger.isDebugEnabled()) {					logger.debug("Acquired Connection [" + newCon + "] for JDBC transaction");				}				//æŠŠé€£æ¥åŒ…è£æˆConnectionHolderï¼Œç„¶å¾Œè¨­ç½®åˆ°äº‹å‹™å°è±¡ä¸­				txObject.setConnectionHolder(new ConnectionHolder(newCon), true);			}			txObject.getConnectionHolder().setSynchronizedWithTransaction(true);			con = txObject.getConnectionHolder().getConnection();			//å¾æ•¸æ“šåº«é€£æ¥ä¸­ç²å–éš”é›¢ç´šåˆ¥			Integer previousIsolationLevel = DataSourceUtils.prepareConnectionForTransaction(con, definition);			txObject.setPreviousIsolationLevel(previousIsolationLevel);			// Switch to manual commit if necessary. This is very expensive in some JDBC drivers,			// so we don't want to do it unnecessarily (for example if we've explicitly			// configured the connection pool to set it already).			if (con.getAutoCommit()) {				txObject.setMustRestoreAutoCommit(true);				if (logger.isDebugEnabled()) {					logger.debug("Switching JDBC Connection [" + con + "] to manual commit");				}				//é—œé–‰é€£æ¥çš„è‡ªå‹•æäº¤ï¼Œå…¶å¯¦é€™æ­¥å°±æ˜¯é–‹å•Ÿäº†äº‹å‹™				con.setAutoCommit(false);			}			//è¨­ç½®åªè®€äº‹å‹™ å¾é€™ä¸€é»è¨­ç½®çš„æ™‚é–“é»é–‹å§‹ï¼ˆæ™‚é–“é»aï¼‰åˆ°é€™å€‹äº‹å‹™çµæŸçš„éç¨‹ä¸­ï¼Œå…¶ä»–äº‹å‹™æ‰€æäº¤çš„æ•¸æ“šï¼Œè©²äº‹å‹™å°‡çœ‹ä¸è¦‹ï¼			//è¨­ç½®åªè®€äº‹å‹™å°±æ˜¯å‘Šè¨´æ•¸æ“šåº«ï¼Œæˆ‘é€™å€‹äº‹å‹™å…§æ²’æœ‰æ–°å¢ï¼Œä¿®æ”¹ï¼Œåˆªé™¤æ“ä½œåªæœ‰æŸ¥è©¢æ“ä½œï¼Œä¸éœ€è¦æ•¸æ“šåº«é–ç­‰æ“ä½œï¼Œæ¸›å°‘æ•¸æ“šåº«å£“åŠ›			prepareTransactionalConnection(con, definition);			//è‡ªå‹•æäº¤é—œé–‰äº†ï¼Œå°±èªªæ˜å·²ç¶“é–‹å•Ÿäº‹å‹™äº†ï¼Œäº‹å‹™æ˜¯æ´»å‹•çš„			txObject.getConnectionHolder().setTransactionActive(true);			int timeout = determineTimeout(definition);			if (timeout != TransactionDefinition.TIMEOUT_DEFAULT) {				txObject.getConnectionHolder().setTimeoutInSeconds(timeout);			}			// Bind the connection holder to the thread.			if (txObject.isNewConnectionHolder()) {				//å¦‚æœæ˜¯æ–°å‰µå»ºçš„äº‹å‹™ï¼Œå‰‡å»ºç«‹ç•¶å‰ç·šç¨‹å’Œæ•¸æ“šåº«é€£æ¥çš„é—œä¿‚				TransactionSynchronizationManager.bindResource(obtainDataSource(), txObject.getConnectionHolder());			}		}		catch (Throwable ex) {			if (txObject.isNewConnectionHolder()) {				DataSourceUtils.releaseConnection(con, obtainDataSource());				txObject.setConnectionHolder(null, false);			}			throw new CannotCreateTransactionException("Could not open JDBC Connection for transaction", ex);		}	}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é€™å€‹æ–¹æ³•è£¡é¢ä¸»è¦åšäº†å…­ä»¶äº‹ï¼š</span></p><ul><li>é¦–å…ˆå¾é€£æ¥æ± ç²å–é€£æ¥ä¸¦ä¿å­˜åˆ°<strong>DataSourceTransactionObject</strong>å°è±¡ä¸­ã€‚</li><li>é—œé–‰æ•¸æ“šåº«çš„<strong>è‡ªå‹•æäº¤</strong>ï¼Œä¹Ÿå°±æ˜¯é–‹å•Ÿäº‹å‹™ã€‚</li><li>ç²å–æ•¸æ“šåº«çš„éš”é›¢ç´šåˆ¥ã€‚</li><li>æ ¹æ“šå±¬æ€§è¨­ç½®è©²äº‹å‹™æ˜¯å¦ç‚º<strong>åªè®€äº‹å‹™</strong>ã€‚</li><li>å°‡è©²äº‹å‹™æ¨™è­˜ç‚º<strong>æ´»å‹•äº‹å‹™</strong>ï¼ˆtransactionActive=trueï¼‰ã€‚</li><li>å°‡<strong>ConnectionHolder</strong>å°è±¡èˆ‡ç•¶å‰ç·šç¨‹ç¶å®šã€‚</li></ul><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å®Œæˆä¹‹å¾Œé€šé</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">prepareSynchronization</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å°‡äº‹å‹™çš„</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å±¬æ€§</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å’Œ</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç‹€æ…‹</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è¨­ç½®åˆ°</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">TransactionSynchronizationManager</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å°è±¡ä¸­é€²è¡Œç®¡ç†ã€‚æœ€å¾Œè¿”å›åˆ°</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">createTransactionIfNecessary</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•ä¸­å‰µå»º</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">TransactionInfo</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å°è±¡èˆ‡ç•¶å‰ç·šç¨‹ç¶å®šä¸¦è¿”å›ã€‚<br>é€šéä»¥ä¸Šçš„æ­¥é©Ÿå°±é–‹å•Ÿäº†äº‹å‹™ï¼Œæ¥ä¸‹ä¾†å°±æ˜¯é€šé</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">proceedWithInvocation</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">èª¿ç”¨å…¶å®ƒåˆ‡é¢ï¼Œé€™è£¡æˆ‘å€‘å…ˆå‡è¨­æ²’æœ‰å…¶å®ƒåˆ‡é¢äº†ï¼Œé‚£éº¼å°±æ˜¯ç›´æ¥èª¿ç”¨åˆ°Aé¡çš„</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">addA</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•ï¼Œåœ¨é€™å€‹æ–¹æ³•ä¸­åˆèª¿ç”¨äº†Bé¡çš„</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">addB</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•ï¼Œé‚£éº¼è‚¯å®šä¹Ÿæ˜¯èª¿ç”¨åˆ°ä»£ç†é¡çš„æ–¹æ³•ï¼Œå› æ­¤åˆæœƒé€²å…¥åˆ°</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">createTransactionIfNecessary</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•ä¸­ã€‚ä½†é€™æ¬¡é€²ä¾†é€šé</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">isExistingTransaction</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åˆ¤æ–·æ˜¯å­˜åœ¨äº‹å‹™çš„ï¼Œå› æ­¤æœƒé€²å…¥åˆ°</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">handleExistingTransaction</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•ï¼š</span></p><pre><code>	private TransactionStatus handleExistingTransaction(			TransactionDefinition definition, Object transaction, boolean debugEnabled)			throws TransactionException {		//ä¸å…è¨±æœ‰äº‹å‹™ï¼Œç›´æ¥ç•°å¸¸		if (definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_NEVER) {			throw new IllegalTransactionStateException(					"Existing transaction found for transaction marked with propagation 'never'");		}		//ä»¥éäº‹å‹™æ–¹å¼åŸ·è¡Œæ“ä½œï¼Œå¦‚æœç•¶å‰å­˜åœ¨äº‹å‹™ï¼Œå°±æŠŠç•¶å‰äº‹å‹™æ›èµ·		if (definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_NOT_SUPPORTED) {			if (debugEnabled) {				logger.debug("Suspending current transaction");			}			//æ›èµ·ç•¶å‰äº‹å‹™			Object suspendedResources = suspend(transaction);			boolean newSynchronization = (getTransactionSynchronization() == SYNCHRONIZATION_ALWAYS);			//ä¿®æ”¹äº‹å‹™ç‹€æ…‹ä¿¡æ¯ï¼ŒæŠŠäº‹å‹™çš„ä¸€äº›ä¿¡æ¯å­˜å„²åˆ°ç•¶å‰ç·šç¨‹ä¸­ï¼ŒThreadLocalä¸­			return prepareTransactionStatus(					definition, null, false, newSynchronization, debugEnabled, suspendedResources);		}		if (definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_REQUIRES_NEW) {			if (debugEnabled) {				logger.debug("Suspending current transaction, creating new transaction with name [" +						definition.getName() + "]");			}			//æ›èµ·			SuspendedResourcesHolder suspendedResources = suspend(transaction);			try {				boolean newSynchronization = (getTransactionSynchronization() != SYNCHRONIZATION_NEVER);				DefaultTransactionStatus status = newTransactionStatus(						definition, transaction, true, newSynchronization, debugEnabled, suspendedResources);				doBegin(transaction, definition);				prepareSynchronization(status, definition);				return status;			}			catch (RuntimeException | Error beginEx) {				resumeAfterBeginException(transaction, suspendedResources, beginEx);				throw beginEx;			}		}		if (definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_NESTED) {			if (!isNestedTransactionAllowed()) {				throw new NestedTransactionNotSupportedException(						"Transaction manager does not allow nested transactions by default - " +						"specify 'nestedTransactionAllowed' property with value 'true'");			}			if (debugEnabled) {				logger.debug("Creating nested transaction with name [" + definition.getName() + "]");			}			//é»˜èªæ˜¯å¯ä»¥åµŒå¥—äº‹å‹™çš„			if (useSavepointForNestedTransaction()) {				// Create savepoint within existing Spring-managed transaction,				// through the SavepointManager API implemented by TransactionStatus.				// Usually uses JDBC 3.0 savepoints. Never activates Spring synchronization.				DefaultTransactionStatus status =						prepareTransactionStatus(definition, transaction, false, false, debugEnabled, null);				//å‰µå»ºå›æ»¾é»				status.createAndHoldSavepoint();				return status;			}			else {				// Nested transaction through nested begin and commit/rollback calls.				// Usually only for JTA: Spring synchronization might get activated here				// in case of a pre-existing JTA transaction.				boolean newSynchronization = (getTransactionSynchronization() != SYNCHRONIZATION_NEVER);				DefaultTransactionStatus status = newTransactionStatus(						definition, transaction, true, newSynchronization, debugEnabled, null);				doBegin(transaction, definition);				prepareSynchronization(status, definition);				return status;			}		}			// çœç•¥				boolean newSynchronization = (getTransactionSynchronization() != SYNCHRONIZATION_NEVER);		return prepareTransactionStatus(definition, transaction, false, newSynchronization, debugEnabled, null);	}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é€™è£¡é¢ä¹Ÿæ˜¯å°æ¯å€‹å‚³æ’­å±¬æ€§çš„åˆ¤æ–·ï¼Œå…ˆçœ‹</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">PROPAGATION_REQUIRES_NEW</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">çš„è™•ç†ï¼Œå› ç‚ºè©²å±¬æ€§è¦æ±‚æ¯æ¬¡èª¿ç”¨éƒ½é–‹å•Ÿä¸€å€‹æ–°çš„äº‹å‹™ï¼Œæ‰€ä»¥é¦–å…ˆæœƒå°‡ç•¶å‰äº‹å‹™æ›èµ·ï¼Œæ€éº¼æ›èµ·å‘¢ï¼Ÿ</span></p><pre><code>	protected final SuspendedResourcesHolder suspend(@Nullable Object transaction) throws TransactionException {		if (TransactionSynchronizationManager.isSynchronizationActive()) {			List&lt;TransactionSynchronization&gt; suspendedSynchronizations = doSuspendSynchronization();			try {				Object suspendedResources = null;				//ç¬¬ä¸€æ¬¡é€²ä¾†ï¼Œè‚¯å®šç‚ºnullçš„				if (transaction != null) {					//å§connectionHolderè¨­ç½®ç‚ºç©º					suspendedResources = doSuspend(transaction);				}				//åšæ•¸æ“šé‚„åŸæ“ä½œ				String name = TransactionSynchronizationManager.getCurrentTransactionName();				TransactionSynchronizationManager.setCurrentTransactionName(null);				boolean readOnly = TransactionSynchronizationManager.isCurrentTransactionReadOnly();				TransactionSynchronizationManager.setCurrentTransactionReadOnly(false);				Integer isolationLevel = TransactionSynchronizationManager.getCurrentTransactionIsolationLevel();				TransactionSynchronizationManager.setCurrentTransactionIsolationLevel(null);				boolean wasActive = TransactionSynchronizationManager.isActualTransactionActive();				TransactionSynchronizationManager.setActualTransactionActive(false);				return new SuspendedResourcesHolder(						suspendedResources, suspendedSynchronizations, name, readOnly, isolationLevel, wasActive);			}			catch (RuntimeException | Error ex) {				// doSuspend failed - original transaction is still active...				doResumeSynchronization(suspendedSynchronizations);				throw ex;			}		}		else if (transaction != null) {			// Transaction active but no synchronization active.			Object suspendedResources = doSuspend(transaction);			return new SuspendedResourcesHolder(suspendedResources);		}		else {			// Neither transaction nor synchronization active.			return null;		}	}	protected Object doSuspend(Object transaction) {		DataSourceTransactionObject txObject = (DataSourceTransactionObject) transaction;		txObject.setConnectionHolder(null);		//è§£é™¤ç¶å®šé—œä¿‚ï¼Œ		return TransactionSynchronizationManager.unbindResource(obtainDataSource());	}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é€™è£¡æ˜é¡¯æ˜¯é€²å…¥ç¬¬ä¸€å€‹ifä¸¦ä¸”æœƒèª¿ç”¨åˆ°</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">doSuspend</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•ï¼Œæ•´é«”ä¾†èªªæ›èµ·äº‹å‹™å¾ˆç°¡å–®ï¼šé¦–å…ˆå°‡</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">DataSourceTransactionObject</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">çš„</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ConnectionHolder</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è¨­ç½®ç‚ºç©ºä¸¦è§£é™¤èˆ‡ç•¶å‰ç·šç¨‹çš„ç¶å®šï¼Œä¹‹å¾Œå°‡è§£é™¤ç¶å®šçš„</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ConnectionHolder</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å’Œ</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å…¶å®ƒå±¬æ€§</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼ˆäº‹å‹™åç¨±ã€éš”é›¢ç´šåˆ¥ã€åªè®€å±¬æ€§ï¼‰é€šé€šå°è£åˆ°</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">SuspendedResourcesHolder</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å°è±¡ï¼Œä¸¦å°‡ç•¶å‰äº‹å‹™çš„</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ´»å‹•ç‹€æ…‹</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è¨­ç½®ç‚ºfalseã€‚æ›èµ·äº‹å‹™ä¹‹å¾Œåˆé€šé</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">newTransactionStatus</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å‰µå»ºäº†ä¸€å€‹æ–°çš„äº‹å‹™ç‹€æ…‹ä¸¦èª¿ç”¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">doBegin</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é–‹å•Ÿäº‹å‹™ï¼Œé€™è£¡ä¸å†é‡è¤‡åˆ†æã€‚<br>æ¥è‘—ä¾†çœ‹</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">PROPAGATION_NESTED</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼š</span></p><pre><code>		if (definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_NESTED) {			if (!isNestedTransactionAllowed()) {				throw new NestedTransactionNotSupportedException(						"Transaction manager does not allow nested transactions by default - " +						"specify 'nestedTransactionAllowed' property with value 'true'");			}			if (debugEnabled) {				logger.debug("Creating nested transaction with name [" + definition.getName() + "]");			}			//é»˜èªæ˜¯å¯ä»¥åµŒå¥—äº‹å‹™çš„			if (useSavepointForNestedTransaction()) {				// Create savepoint within existing Spring-managed transaction,				// through the SavepointManager API implemented by TransactionStatus.				// Usually uses JDBC 3.0 savepoints. Never activates Spring synchronization.				DefaultTransactionStatus status =						prepareTransactionStatus(definition, transaction, false, false, debugEnabled, null);				//å‰µå»ºå›æ»¾é»				status.createAndHoldSavepoint();				return status;			}			else {				// Nested transaction through nested begin and commit/rollback calls.				// Usually only for JTA: Spring synchronization might get activated here				// in case of a pre-existing JTA transaction.				boolean newSynchronization = (getTransactionSynchronization() != SYNCHRONIZATION_NEVER);				DefaultTransactionStatus status = newTransactionStatus(						definition, transaction, true, newSynchronization, debugEnabled, null);				doBegin(transaction, definition);				prepareSynchronization(status, definition);				return status;			}		}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é€™è£¡é¢å¯ä»¥çœ‹åˆ°å¦‚æœå…è¨±</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åµŒå¥—äº‹å‹™</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼Œå°±æœƒå‰µå»ºä¸€å€‹</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">DefaultTransactionStatus</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å°è±¡ï¼ˆæ³¨æ„</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">newTransaction</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ˜¯falseï¼Œè¡¨æ˜ä¸æ˜¯ä¸€å€‹æ–°äº‹å‹™ï¼‰å’Œ</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å›æ»¾é»</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼›å¦‚æœä¸å…è¨±</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åµŒå¥—</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼Œå°±æœƒå‰µå»º</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–°äº‹å‹™</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ä¸¦é–‹å•Ÿã€‚<br>ç•¶ä¸Šé¢çš„åˆ¤æ–·éƒ½ä¸æ»¿è¶³æ™‚ï¼Œä¹Ÿå°±æ˜¯å‚³æ’­å±¬æ€§ç‚ºé»˜èª</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">PROPAGATION_REQUIRED</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ™‚ï¼Œå‰‡åªæ˜¯å‰µå»ºäº†ä¸€å€‹</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">newTransaction</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç‚ºfalseçš„</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">DefaultTransactionStatus</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è¿”å›ã€‚<br>å®Œæˆä¹‹å¾Œåˆæ˜¯èª¿ç”¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">proceedWithInvocation</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼Œé‚£éº¼å°±æ˜¯åŸ·è¡ŒBé¡çš„</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">addB</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•ï¼Œå‡å¦‚æ²’æœ‰ç™¼ç”Ÿç•°å¸¸ï¼Œé‚£éº¼å°±æœƒå›åˆ°åˆ‡é¢èª¿ç”¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">commitTransactionAfterReturning</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æäº¤</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">addB</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">çš„äº‹å‹™ï¼š</span></p><pre><code>	protected void commitTransactionAfterReturning(@Nullable TransactionInfo txInfo) {		if (txInfo != null &amp;&amp; txInfo.getTransactionStatus() != null) {			txInfo.getTransactionManager().commit(txInfo.getTransactionStatus());		}	}	public final void commit(TransactionStatus status) throws TransactionException {		processCommit(defStatus);	}	private void processCommit(DefaultTransactionStatus status) throws TransactionException {		try {			boolean beforeCompletionInvoked = false;			try {				boolean unexpectedRollback = false;				prepareForCommit(status);				triggerBeforeCommit(status);				triggerBeforeCompletion(status);				beforeCompletionInvoked = true;				if (status.hasSavepoint()) {					if (status.isDebug()) {						logger.debug("Releasing transaction savepoint");					}					// å¦‚æœæ˜¯nestedï¼Œæ²’æœ‰æäº¤ï¼Œåªæ˜¯å°‡savepointæ¸…é™¤æ‰äº†					unexpectedRollback = status.isGlobalRollbackOnly();					status.releaseHeldSavepoint();				}				//å¦‚æœéƒ½æ˜¯PROPAGATION_REQUIREDï¼Œæœ€å¤–å±¤çš„æ‰æœƒèµ°é€²ä¾†çµ±ä¸€æäº¤ï¼Œå¦‚æœæ˜¯PROPAGATION_REQUIRES_NEWï¼Œæ¯ä¸€å€‹äº‹å‹™éƒ½æœƒé€²ä¾†				else if (status.isNewTransaction()) {					if (status.isDebug()) {						logger.debug("Initiating transaction commit");					}					unexpectedRollback = status.isGlobalRollbackOnly();					doCommit(status);				}				else if (isFailEarlyOnGlobalRollbackOnly()) {					unexpectedRollback = status.isGlobalRollbackOnly();				}			}		}		finally {			cleanupAfterCompletion(status);		}	}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ä¸»è¦é‚è¼¯åœ¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">processCommit</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•ä¸­ã€‚å¦‚æœå­˜åœ¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å›æ»¾é»</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼Œå¯ä»¥çœ‹åˆ°ä¸¦</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ²’æœ‰æäº¤äº‹å‹™</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼Œåªæ˜¯å°‡</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç•¶å‰äº‹å‹™çš„å›æ»¾é»</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ¸…é™¤äº†ï¼›è€Œå¦‚æœæ˜¯</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–°äº‹å‹™</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼Œå°±æœƒèª¿ç”¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">doCommit</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æäº¤äº‹å‹™ï¼Œä¹Ÿå°±æ˜¯éš»æœ‰</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">PROPAGATION_REQUIRED</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å±¬æ€§ä¸‹çš„</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æœ€å¤–å±¤äº‹å‹™</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å’Œ</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">PROPAGATION_REQUIRES_NEW</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å±¬æ€§ä¸‹çš„äº‹å‹™èƒ½æäº¤ã€‚äº‹å‹™æäº¤å®Œæˆå¾Œæœƒèª¿ç”¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">cleanupAfterCompletion</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ¸…é™¤ç•¶å‰äº‹å‹™çš„ç‹€æ…‹ï¼Œå¦‚æœæœ‰æ›èµ·çš„äº‹å‹™é‚„æœƒé€šé</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">resume</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ¢å¾©æ›èµ·çš„äº‹å‹™ï¼ˆå°‡è§£ç¶çš„é€£æ¥å’Œç•¶å‰ç·šç¨‹ç¶å®šä»¥åŠå°‡ä¹‹å‰ä¿å­˜çš„äº‹å‹™ç‹€æ…‹é‡æ–°è¨­ç½®å›å»ï¼‰ã€‚ç•¶å‰äº‹å‹™æ­£å¸¸æäº¤å¾Œï¼Œé‚£éº¼å°±æœƒè¼ªåˆ°</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">addA</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•æäº¤ï¼Œè™•ç†é‚è¼¯åŒä¸Šï¼Œä¸å†è´…è¿°ã€‚<br>å¦‚æœèª¿ç”¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">addB</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç™¼ç”Ÿç•°å¸¸ï¼Œå°±æœƒé€šé</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">completeTransactionAfterThrowing</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é€²è¡Œå›æ»¾ï¼š</span></p><pre><code>	protected void completeTransactionAfterThrowing(@Nullable TransactionInfo txInfo, Throwable ex) {		if (txInfo != null &amp;&amp; txInfo.getTransactionStatus() != null) {			if (logger.isTraceEnabled()) {				logger.trace("Completing transaction for [" + txInfo.getJoinpointIdentification() +						"] after exception: " + ex);			}			if (txInfo.transactionAttribute != null &amp;&amp; txInfo.transactionAttribute.rollbackOn(ex)) {				try {					txInfo.getTransactionManager().rollback(txInfo.getTransactionStatus());				}			}		}	}	public final void rollback(TransactionStatus status) throws TransactionException {		DefaultTransactionStatus defStatus = (DefaultTransactionStatus) status;		processRollback(defStatus, false);	}	private void processRollback(DefaultTransactionStatus status, boolean unexpected) {		try {			boolean unexpectedRollback = unexpected;			try {				triggerBeforeCompletion(status);				//æŒ‰ç…§åµŒå¥—äº‹å‹™æŒ‰ç…§å›æ»¾é»å›æ»¾				if (status.hasSavepoint()) {					if (status.isDebug()) {						logger.debug("Rolling back transaction to savepoint");					}					status.rollbackToHeldSavepoint();				}				//éƒ½ç‚ºPROPAGATION_REQUIREDæœ€å¤–å±¤äº‹å‹™çµ±ä¸€å›æ»¾				else if (status.isNewTransaction()) {					if (status.isDebug()) {						logger.debug("Initiating transaction rollback");					}					doRollback(status);				}				else {					// Participating in larger transaction					if (status.hasTransaction()) {						if (status.isLocalRollbackOnly() || isGlobalRollbackOnParticipationFailure()) {							if (status.isDebug()) {								logger.debug("Participating transaction failed - marking existing transaction as rollback-only");							}							doSetRollbackOnly(status);						}						else {							if (status.isDebug()) {								logger.debug("Participating transaction failed - letting transaction originator decide on rollback");							}						}					}					else {						logger.debug("Should roll back transaction but cannot - no transaction available");					}					// Unexpected rollback only matters here if we're asked to fail early					if (!isFailEarlyOnGlobalRollbackOnly()) {						unexpectedRollback = false;					}				}			}			catch (RuntimeException | Error ex) {				triggerAfterCompletion(status, TransactionSynchronization.STATUS_UNKNOWN);				throw ex;			}			triggerAfterCompletion(status, TransactionSynchronization.STATUS_ROLLED_BACK);			// Raise UnexpectedRollbackException if we had a global rollback-only marker			if (unexpectedRollback) {				throw new UnexpectedRollbackException(						"Transaction rolled back because it has been marked as rollback-only");			}		}		finally {			cleanupAfterCompletion(status);		}	}</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æµç¨‹å’Œæäº¤æ˜¯ä¸€æ¨£çš„ï¼Œå…ˆæ˜¯åˆ¤æ–·æœ‰æ²’æœ‰å›æ»¾é»ï¼Œå¦‚æœæœ‰å°±å›åˆ°åˆ°å›æ»¾é»ä¸¦æ¸…é™¤è©²å›æ»¾é»ï¼›å¦‚æœæ²’æœ‰å‰‡åˆ¤æ–·æ˜¯ä¸æ˜¯æ–°äº‹å‹™ï¼ˆ</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">PROPAGATION_REQUIRED</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å±¬æ€§ä¸‹çš„</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æœ€å¤–å±¤äº‹å‹™</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å’Œ</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">PROPAGATION_REQUIRES_NEW</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å±¬æ€§ä¸‹çš„äº‹å‹™ï¼‰ï¼Œæ»¿è¶³å‰‡ç›´æ¥å›æ»¾ç•¶å‰äº‹å‹™ã€‚å›æ»¾å®Œæˆå¾ŒåŒæ¨£éœ€è¦æ¸…é™¤æ‰ç•¶å‰çš„äº‹å‹™ç‹€æ…‹ä¸¦æ¢å¾©æ›èµ·çš„é€£æ¥ã€‚å¦å¤–éœ€è¦ç‰¹åˆ¥æ³¨æ„çš„æ˜¯åœ¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">catch</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è£¡é¢èª¿ç”¨å®Œå›æ»¾é‚è¼¯å¾Œï¼Œé‚„é€šé</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">throw</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ‹‹å‡ºäº†ç•°å¸¸ï¼Œé€™æ„å‘³è‘—ä»€éº¼ï¼Ÿæ„å‘³è‘—å³ä½¿æ˜¯åµŒå¥—äº‹å‹™ï¼Œå…§å±¤äº‹å‹™çš„å›æ»¾ä¹Ÿæœƒå°è‡´å¤–å±¤äº‹å‹™çš„å›æ»¾ï¼Œä¹Ÿå°±æ˜¯</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">addA</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">çš„äº‹å‹™ä¹Ÿæœƒè·Ÿè‘—å›æ»¾ã€‚<br>è‡³æ­¤ï¼Œäº‹å‹™çš„å‚³æ’­åŸç†åˆ†æå®Œç•¢ï¼Œæ·±å…¥çœ‹æ¯å€‹æ–¹æ³•çš„å¯¦ç¾æ˜¯å¾ˆè¤‡é›œçš„ï¼Œä½†å¦‚æœåƒ…åƒ…æ˜¯åˆ†æå„å€‹å‚³æ’­å±¬æ€§å°äº‹å‹™çš„å½±éŸ¿ï¼Œå‰‡æœ‰ä¸€å€‹ç°¡å–®çš„æ–¹æ³•ã€‚æˆ‘å€‘å¯ä»¥å°‡å…§å±¤äº‹å‹™åˆ‡é¢</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç­‰æ•ˆæ›¿æ›</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ‰</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">invocation.proceedWithInvocation</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æ–¹æ³•ï¼Œæ¯”å¦‚ä¸Šé¢å…©å€‹é¡çš„èª¿ç”¨å¯ä»¥çœ‹ä½œæ˜¯ä¸‹é¢é€™æ¨£ï¼š</span></p><pre><code>// addAçš„äº‹å‹™TransactionInfo txInfo = createTransactionIfNecessary(tm, txAttr, joinpointIdentification);Object retVal = null;try {	// addBçš„äº‹å‹™	TransactionInfo txInfo = createTransactionIfNecessary(tm, txAttr, joinpointIdentification);	Object retVal = null;	try {		retVal = invocation.proceedWithInvocation();	}	catch (Throwable ex) {		// target invocation exception		//äº‹å‹™å›æ»¾		completeTransactionAfterThrowing(txInfo, ex);		throw ex;	}	finally {		cleanupTransactionInfo(txInfo);	}	//äº‹å‹™æäº¤	commitTransactionAfterReturning(txInfo);}catch (Throwable ex) {	//äº‹å‹™å›æ»¾	completeTransactionAfterThrowing(txInfo, ex);	throw ex;}//äº‹å‹™æäº¤commitTransactionAfterReturning(txInfo);</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é€™æ¨£çœ‹æ˜¯ä¸æ˜¯å¾ˆå®¹æ˜“å°±èƒ½åˆ†æå‡ºäº‹å‹™ä¹‹é–“çš„å½±éŸ¿ä»¥åŠæ˜¯æäº¤é‚„æ˜¯å›æ»¾äº†ï¼Ÿä¸‹é¢ä¾†çœ‹å¹¾å€‹å¯¦ä¾‹åˆ†æã€‚</span></p><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">å¯¦ä¾‹åˆ†æ</span></h1><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æˆ‘å†æ·»åŠ ä¸€å€‹Cé¡ï¼Œå’Œ</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">addC</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">çš„æ–¹æ³•ï¼Œç„¶å¾Œåœ¨</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">addA</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è£¡é¢èª¿ç”¨é€™å€‹æ–¹æ³•ã€‚</span></p><pre><code>TransactionInfo txInfo = createTransactionIfNecessary(tm, txAttr, joinpointIdentification);Object retVal = null;try {	// addBçš„äº‹å‹™	TransactionInfo txInfo = createTransactionIfNecessary(tm, txAttr, joinpointIdentification);	Object retVal = null;	try {		b.addB();	}	catch (Throwable ex) {		// target invocation exception		//äº‹å‹™å›æ»¾		completeTransactionAfterThrowing(txInfo, ex);		throw ex;	}	//äº‹å‹™æäº¤	commitTransactionAfterReturning(txInfo);	// addCçš„äº‹å‹™	TransactionInfo txInfo = createTransactionIfNecessary(tm, txAttr, joinpointIdentification);	Object retVal = null;	try {		c.addC();	}	catch (Throwable ex) {		// target invocation exception		//äº‹å‹™å›æ»¾		completeTransactionAfterThrowing(txInfo, ex);		throw ex;	}	//äº‹å‹™æäº¤	commitTransactionAfterReturning(txInfo);}catch (Throwable ex) {	//äº‹å‹™å›æ»¾	completeTransactionAfterThrowing(txInfo, ex);	throw ex;}//äº‹å‹™æäº¤commitTransactionAfterReturning(txInfo);</code></pre><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç­‰æ•ˆæ›¿æ›å¾Œå°±æ˜¯ä¸Šé¢é€™å€‹ä»£ç¢¼ï¼Œæˆ‘å€‘åˆ†åˆ¥ä¾†åˆ†æã€‚</span></p><ul><li>éƒ½æ˜¯<strong>PROPAGATION_REQUIRED</strong>å±¬æ€§ï¼šé€šéä¸Šé¢çš„åˆ†æï¼Œæˆ‘å€‘çŸ¥é“ä¸‰å€‹æ–¹æ³•éƒ½æ˜¯åŒä¸€å€‹é€£æ¥å’Œäº‹å‹™ï¼Œé‚£éº¼ä»»ä½•ä¸€å€‹å‡ºç¾ç•°å¸¸å‰‡éƒ½æœƒå›æ»¾ã€‚</li><li><strong>addB</strong>ç‚º<strong>PROPAGATION_REQUIRES_NEW</strong>ï¼šå¦‚æœBä¸­æ‹‹å‡ºç•°å¸¸ï¼Œé‚£éº¼Bä¸­è‚¯å®šæœƒå›æ»¾ï¼Œæ¥è‘—ç•°å¸¸å‘ä¸Šæ‹‹ï¼Œå°è‡´Aäº‹å‹™æ•´é«”å›æ»¾ï¼›å¦‚æœCä¸­æ‹‹å‡ºç•°å¸¸ï¼Œä¸é›£çœ‹å‡ºCå’ŒAéƒ½æœƒå›æ»¾ï¼Œä½†Bå·²ç¶“æäº¤äº†ï¼Œå› æ­¤ä¸æœƒå—å½±éŸ¿ã€‚</li><li><strong>addC</strong>ç‚º<strong>PROPAGATION_NESTED</strong>ï¼Œ<strong>addB</strong>ç‚º<strong>PROPAGATION_REQUIRES_NEW</strong>ï¼šå¦‚æœBä¸­æ‹‹å‡ºç•°å¸¸ï¼Œé‚£éº¼Bå›æ»¾ä¸¦æ‹‹å‡ºç•°å¸¸ï¼ŒAä¹Ÿå›æ»¾ï¼ŒCä¸æœƒåŸ·è¡Œï¼›å¦‚æœCä¸­æ‹‹å‡ºç•°å¸¸ï¼Œå…ˆæ˜¯å›æ»¾åˆ°<strong>å›æ»¾é»</strong>ä¸¦æ‹‹å‡ºç•°å¸¸ï¼Œæ‰€ä»¥Aä¹Ÿå›æ»¾ï¼Œä½†Bæ­¤æ™‚å·²ç¶“æäº¤ï¼Œä¸å—å½±éŸ¿ã€‚</li><li>éƒ½æ˜¯<strong>PROPAGATION_NESTED</strong>ï¼šé›–ç„¶å‰µå»ºäº†å›æ»¾é»ï¼Œä½†æ˜¯ä»ç„¶æ˜¯åŒä¸€å€‹é€£æ¥ï¼Œä»»ä½•ä¸€å€‹ç™¼ç”Ÿç•°å¸¸éƒ½æœƒå›æ»¾ï¼Œå¦‚æœä¸æƒ³å½±éŸ¿å½¼æ­¤ï¼Œå¯ä»¥try-catchç”Ÿåå­äº‹å‹™çš„ç•°å¸¸å¯¦ç¾ã€‚</li></ul><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">é‚„æœ‰å…¶å®ƒå¾ˆå¤šæƒ…æ³ï¼Œé€™è£¡å°±ä¸ä¸€ä¸€åˆ—èˆ‰äº†ï¼Œåªè¦ä½¿ç”¨ä¸Šé¢çš„åˆ†ææ–¹æ³•éƒ½èƒ½å¤ å¾ˆè¼•é¬†çš„åˆ†æå‡ºä¾†ã€‚</span></p><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">ç¸½çµ</span></h1><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">æœ¬ç¯‡è©³ç´°åˆ†æäº†äº‹å‹™çš„å‚³æ’­åŸç†ï¼Œå¦å¤–é‚„æœ‰</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">éš”é›¢ç´šåˆ¥</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ï¼Œé€™åœ¨Springä¸­æ²’æœ‰é«”ç¾ï¼Œéœ€è¦æˆ‘å€‘è‡ªå·±çµåˆæ•¸æ“šåº«çš„çŸ¥è­˜é€²è¡Œåˆ†æè¨­ç½®ã€‚æœ€å¾Œæˆ‘å€‘é‚„éœ€è¦è€ƒæ…®</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">è²æ˜å¼äº‹å‹™</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å’Œ</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ç·¨ç¨‹å¼äº‹å‹™</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">çš„å„ªç¼ºé»ï¼Œè²æ˜å¼äº‹å‹™é›–ç„¶ç°¡å–®ï¼Œä½†ä¸é©åˆç”¨åœ¨é•·äº‹å‹™ä¸­ï¼Œæœƒä½”ç”¨å¤§é‡é€£æ¥è³‡æºï¼Œé€™æ™‚å°±éœ€è¦è€ƒæ…®åˆ©ç”¨ç·¨ç¨‹å¼äº‹å‹™çš„éˆæ´»æ€§äº†ã€‚ç¸½è€Œè¨€ä¹‹ï¼Œäº‹å‹™çš„ä½¿ç”¨ä¸¦ä¸æ˜¯ä¸€å¾‹é»˜èªå°±å¥½ï¼Œæ¥å£çš„</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ä¸€è‡´æ€§</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">å’Œ</span><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ååé‡</span></strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">èˆ‡äº‹å‹™æœ‰è‘—ç›´æ¥é—œä¿‚ï¼Œåš´é‡æƒ…æ³ä¸‹å¯èƒ½æœƒå°è‡´ç³»çµ±å´©æ½°ã€‚</span></p><blockquote><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">ä½œè€…ï¼š</span>å¤œå‹¿èª</p><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">åŸæ–‡éˆæ¥ï¼š</span>https://blog.csdn.net/l6108003/article/details/106696735</p></blockquote></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>é¢è©¦</a></li><li><a>å•ä½ </a></li><li><a>ä¸€å€‹</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/49fd79dd.html alt=é¢è©¦å®˜å•ï¼šä¸€å€‹Javaå­—ç¬¦ä¸²ä¸­åˆ°åº•èƒ½æœ‰å¤šå°‘å€‹å­—ç¬¦ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/219afb44975f48c09f4d1cf56b9eed17 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/49fd79dd.html title=é¢è©¦å®˜å•ï¼šä¸€å€‹Javaå­—ç¬¦ä¸²ä¸­åˆ°åº•èƒ½æœ‰å¤šå°‘å€‹å­—ç¬¦ï¼Ÿ>é¢è©¦å®˜å•ï¼šä¸€å€‹Javaå­—ç¬¦ä¸²ä¸­åˆ°åº•èƒ½æœ‰å¤šå°‘å€‹å­—ç¬¦ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dabba596.html alt=ä¸€å€‹HashMapèƒ½è·Ÿé¢è©¦å®˜æ‰¯ä¸ŠåŠå€‹å°æ™‚ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3c09bf1ad1b54adaab3db4be30c10c8b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dabba596.html title=ä¸€å€‹HashMapèƒ½è·Ÿé¢è©¦å®˜æ‰¯ä¸ŠåŠå€‹å°æ™‚>ä¸€å€‹HashMapèƒ½è·Ÿé¢è©¦å®˜æ‰¯ä¸ŠåŠå€‹å°æ™‚</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ac25d2d0.html alt=30åˆ†é˜æ•™ä½ æ­å»ºä¸€å€‹ç¶²ç«™ï¼ˆä¸€ï¼‰ï¼šè³¼è²·å’Œé…ç½®æœå‹™å™¨ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/5f26f1582a564e93bde33a7dd9448c3b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ac25d2d0.html title=30åˆ†é˜æ•™ä½ æ­å»ºä¸€å€‹ç¶²ç«™ï¼ˆä¸€ï¼‰ï¼šè³¼è²·å’Œé…ç½®æœå‹™å™¨>30åˆ†é˜æ•™ä½ æ­å»ºä¸€å€‹ç¶²ç«™ï¼ˆä¸€ï¼‰ï¼šè³¼è²·å’Œé…ç½®æœå‹™å™¨</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d8be5e94.html alt=ä¸æœƒè²·æœå‹™å™¨ï¼Ÿä¸€å€‹è¾¦æ³•è®“ä½ è¼•é¬†æ­ç¶²ç«™ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/84d9c54578de46058796824f1bcb6a9b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d8be5e94.html title=ä¸æœƒè²·æœå‹™å™¨ï¼Ÿä¸€å€‹è¾¦æ³•è®“ä½ è¼•é¬†æ­ç¶²ç«™>ä¸æœƒè²·æœå‹™å™¨ï¼Ÿä¸€å€‹è¾¦æ³•è®“ä½ è¼•é¬†æ­ç¶²ç«™</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c811c5f7.html alt=ä½¿ç”¨æœå‹™å™¨æ­å»ºä¸€å€‹ç¶²ç«™ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/63a6cc0eb4d146e0890515500c0040ca style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c811c5f7.html title=ä½¿ç”¨æœå‹™å™¨æ­å»ºä¸€å€‹ç¶²ç«™>ä½¿ç”¨æœå‹™å™¨æ­å»ºä¸€å€‹ç¶²ç«™</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4b69aa7f.html alt=åšä¸€å€‹å°å‹ç¶²ç«™ï¼Œæœå‹™å™¨éœ€è¦ä»€éº¼é…ç½®çš„å‘¢ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4b69aa7f.html title=åšä¸€å€‹å°å‹ç¶²ç«™ï¼Œæœå‹™å™¨éœ€è¦ä»€éº¼é…ç½®çš„å‘¢ï¼Ÿ>åšä¸€å€‹å°å‹ç¶²ç«™ï¼Œæœå‹™å™¨éœ€è¦ä»€éº¼é…ç½®çš„å‘¢ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/eee4b8ad.html alt=æ­å»ºä¸€å€‹ç¶²ç«™ï¼Œç§Ÿæœå‹™å™¨å¤§æ¦‚å¤šå°‘éŒ¢ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/eee4b8ad.html title=æ­å»ºä¸€å€‹ç¶²ç«™ï¼Œç§Ÿæœå‹™å™¨å¤§æ¦‚å¤šå°‘éŒ¢ï¼Ÿ>æ­å»ºä¸€å€‹ç¶²ç«™ï¼Œç§Ÿæœå‹™å™¨å¤§æ¦‚å¤šå°‘éŒ¢ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/62d46b38.html alt=ç´ æç¥•ç±ï½œä¸€å€‹è€³æœµï¼9å¤§çŸ¥è­˜é»ï¼Œ360åº¦å…¨æ–¹ä½æ·±åº¦å‰–æè¬›è§£ç¤ºç¯„ï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/5e7b0005767168b2b87d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/62d46b38.html title=ç´ æç¥•ç±ï½œä¸€å€‹è€³æœµï¼9å¤§çŸ¥è­˜é»ï¼Œ360åº¦å…¨æ–¹ä½æ·±åº¦å‰–æè¬›è§£ç¤ºç¯„ï¼>ç´ æç¥•ç±ï½œä¸€å€‹è€³æœµï¼9å¤§çŸ¥è­˜é»ï¼Œ360åº¦å…¨æ–¹ä½æ·±åº¦å‰–æè¬›è§£ç¤ºç¯„ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/647df9c2.html alt=ä¸€å€‹ç”·äººæ¯å¤©24å°æ™‚è·Ÿå¦»å­åœ¨ä¸€èµ·ï¼Œä¹…è€Œä¹…ä¹‹æœƒæ€æ¨£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8359cc22f03e478a8cdb889dcfea3f99 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/647df9c2.html title=ä¸€å€‹ç”·äººæ¯å¤©24å°æ™‚è·Ÿå¦»å­åœ¨ä¸€èµ·ï¼Œä¹…è€Œä¹…ä¹‹æœƒæ€æ¨£>ä¸€å€‹ç”·äººæ¯å¤©24å°æ™‚è·Ÿå¦»å­åœ¨ä¸€èµ·ï¼Œä¹…è€Œä¹…ä¹‹æœƒæ€æ¨£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5a86d7d9.html alt=æ¯å¤©ä¸€å€‹å¥½ç¿’æ…£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RKdGgquJFM6gnc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5a86d7d9.html title=æ¯å¤©ä¸€å€‹å¥½ç¿’æ…£>æ¯å¤©ä¸€å€‹å¥½ç¿’æ…£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/756b16fb.html alt=å¥¶ç²‰å¯„å‡ºä¸€å€‹æœˆï¼Œå®¶äººé²é²æ”¶ä¸åˆ°ï¼Œç‰©æµä¿¡æ¯ä¹ŸæŸ¥è©¢ä¸åˆ°ï¼Œäº‹ç™¼é˜œé™½æŸéŸ»é”å¿«éç¶²é» class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/3fd8ec4e-64c1-446a-adfa-38088fb06c01 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/756b16fb.html title=å¥¶ç²‰å¯„å‡ºä¸€å€‹æœˆï¼Œå®¶äººé²é²æ”¶ä¸åˆ°ï¼Œç‰©æµä¿¡æ¯ä¹ŸæŸ¥è©¢ä¸åˆ°ï¼Œäº‹ç™¼é˜œé™½æŸéŸ»é”å¿«éç¶²é»>å¥¶ç²‰å¯„å‡ºä¸€å€‹æœˆï¼Œå®¶äººé²é²æ”¶ä¸åˆ°ï¼Œç‰©æµä¿¡æ¯ä¹ŸæŸ¥è©¢ä¸åˆ°ï¼Œäº‹ç™¼é˜œé™½æŸéŸ»é”å¿«éç¶²é»</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b29ee719.html alt=åˆä¸€å€‹èµ°ä¸Šä¸æ­¸è·¯çš„æ¬ç£šäºº class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/bf471da0a06441f88bce49b959234257 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b29ee719.html title=åˆä¸€å€‹èµ°ä¸Šä¸æ­¸è·¯çš„æ¬ç£šäºº>åˆä¸€å€‹èµ°ä¸Šä¸æ­¸è·¯çš„æ¬ç£šäºº</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3d6d5661.html alt=å¤šæ”¶è—ä¸€å€‹ï¼Œå°±å°‘æ±‚ä¸€æ¬¡äººâ€”å“ªäº›æ—¥å¸¸å¿…å‚™ç¥ç´šç¶²ç«™ï¼ŒçœŸæ­£å€¼å¾—æ”¶è— class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/833949926ebf49b89c5fb4075a9cffdd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3d6d5661.html title=å¤šæ”¶è—ä¸€å€‹ï¼Œå°±å°‘æ±‚ä¸€æ¬¡äººâ€”å“ªäº›æ—¥å¸¸å¿…å‚™ç¥ç´šç¶²ç«™ï¼ŒçœŸæ­£å€¼å¾—æ”¶è—>å¤šæ”¶è—ä¸€å€‹ï¼Œå°±å°‘æ±‚ä¸€æ¬¡äººâ€”å“ªäº›æ—¥å¸¸å¿…å‚™ç¥ç´šç¶²ç«™ï¼ŒçœŸæ­£å€¼å¾—æ”¶è—</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/917424fc.html alt=ä¸€å€‹ä¸‰å¹´ç´šå°å­©æŒæ¡è…¦ç‹é€Ÿè¨˜æ³•ä¹‹æ•¸å­—ç·¨ç¢¼å¾Œå€’èƒŒå¦‚æµåœ“å‘¨ç‡1è¬ä½ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/5b430002414bdad7cc1f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/917424fc.html title=ä¸€å€‹ä¸‰å¹´ç´šå°å­©æŒæ¡è…¦ç‹é€Ÿè¨˜æ³•ä¹‹æ•¸å­—ç·¨ç¢¼å¾Œå€’èƒŒå¦‚æµåœ“å‘¨ç‡1è¬ä½>ä¸€å€‹ä¸‰å¹´ç´šå°å­©æŒæ¡è…¦ç‹é€Ÿè¨˜æ³•ä¹‹æ•¸å­—ç·¨ç¢¼å¾Œå€’èƒŒå¦‚æµåœ“å‘¨ç‡1è¬ä½</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/25157041.html alt=è–èƒ¡å®‰ï¼ˆæ³¢å¤šé»å„ï¼‰ï¼šä¸€å€‹å¾ˆä¸ç¾åœ‹çš„ç¾åœ‹åŸå¸‚ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d049f3231cda4890ae11c23b2c8f8f70 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/25157041.html title=è–èƒ¡å®‰ï¼ˆæ³¢å¤šé»å„ï¼‰ï¼šä¸€å€‹å¾ˆä¸ç¾åœ‹çš„ç¾åœ‹åŸå¸‚>è–èƒ¡å®‰ï¼ˆæ³¢å¤šé»å„ï¼‰ï¼šä¸€å€‹å¾ˆä¸ç¾åœ‹çš„ç¾åœ‹åŸå¸‚</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>