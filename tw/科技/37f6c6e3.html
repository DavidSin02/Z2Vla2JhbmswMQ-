<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>ä½¿ç”¨ Refit æ¡†æ¶è¨ªå• REST æ¥å£ | æå®¢å¿«è¨Š</title><meta property="og:title" content="ä½¿ç”¨ Refit æ¡†æ¶è¨ªå• REST æ¥å£ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/5ec2341f607b4b9e86391a5b41edd175"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/37f6c6e3.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/37f6c6e3.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/37f6c6e3.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/37f6c6e3.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/37f6c6e3.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/37f6c6e3.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/37f6c6e3.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/37f6c6e3.html><meta property="article:published_time" content="2020-11-14T21:00:28+08:00"><meta property="article:modified_time" content="2020-11-14T21:00:28+08:00"><meta name=Keywords content><meta name=description content="ä½¿ç”¨ Refit æ¡†æ¶è¨ªå• REST æ¥å£"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/37f6c6e3.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>ä½¿ç”¨ Refit æ¡†æ¶è¨ªå• REST æ¥å£</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p>è½‰è¼‰è‡ªã€é›¶åº¦ç·¨ç¨‹ã€‘ï¼ŒåŸæ–‡åœ°å€ï¼šhttps://www.xcode.me/post/5918</p><p><br></p><div class=pgc-img><img alt="ä½¿ç”¨ Refit æ¡†æ¶è¨ªå• REST æ¥å£" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5ec2341f607b4b9e86391a5b41edd175><p class=pgc-img-caption></p></div><p><br></p><p>Refit æ˜¯ä¸€å€‹é¡å‹å®‰å…¨çš„ REST é–‹æºåº«ï¼Œæ˜¯ä¸€å¥—åŸºæ–¼ RESTful æ¶æ§‹çš„ .NET å®¢æˆ¶ç«¯å¯¦ç¾ï¼Œå…§éƒ¨ä½¿ç”¨ HttpClient é¡å°è£ï¼Œå¯é€šé Refit æ›´åŠ ç°¡å–®å®‰å…¨åœ°è¨ªå• Web API æ¥å£ï¼Œè¦ä½¿ç”¨ Refit æ¡†æ¶ï¼Œåªéœ€è¦åœ¨é …ç›®ä¸­é€šé NuGet åŒ…å®‰è£å™¨å®‰è£å³å¯ã€‚</p><pre><code>Install-Package refit</code></pre><p>ä½¿ç”¨æ–¹æ³•å¾ˆç°¡å–®ï¼š</p><pre><code>public interface IGitHubApi{	[Get("/users/{userid}")]	Task&lt;User&gt; GetUser(string userid);}</code></pre><p>ä»¥ä¸Šæ–¹æ³•å®šç¾©ä¸€å€‹ REST API æ¥å£ï¼Œè©²æ¥å£å®šç¾©äº† GetUser å‡½æ•¸ï¼Œè©²å‡½æ•¸é€šé HTTP GET è«‹æ±‚å»è¨ªå•æœå‹™å™¨çš„ /users/{userid} è·¯å¾‘ä¸¦æŠŠè¿”å›çš„çµæœå°è£ç‚º User å°è±¡è¿”å›ï¼Œå…¶ä¸­ URL è·¯å¾‘ä¸­ {userid} çš„å€¼ç‚º GetUser å‡½æ•¸çš„ userid åƒæ•¸å–å€¼ï¼Œç„¶å¾Œï¼Œé€šé RestService é¡ç”Ÿæˆ IGitHubApi çš„ä»£ç†å¯¦ç¾ï¼Œé€šéä»£ç†ç›´æ¥èª¿ç”¨ Web API æ¥å£ã€‚</p><pre><code>var gitHubApi = RestService.For&lt;IGitHubApi&gt;("https://api.xcode.me");var octocat = await gitHubApi.GetUser("xcode");</code></pre><h2 class=pgc-h-arrow-right>API Attributesç‰¹æ€§</h2><p>é€šé Attribute ç‰¹æ€§æ¨™è¨˜ï¼ŒæŒ‡å®šè«‹æ±‚æ–¹æ³•å’Œç›¸å° URL åœ°å€ï¼Œå…§ç½®æ”¯æŒ Getã€Postã€Putã€Delete å’Œ Head æ–¹æ³•ã€‚</p><pre><code>[Get("/users/list")]</code></pre><p>ä¹Ÿå¯ä»¥åœ¨ URL ä¸­æŒ‡å®šæŸ¥è©¢åƒæ•¸ï¼š</p><pre><code>[Get("/users/list?sort=desc")]</code></pre><p>æ–¹æ³•ä¸­çš„ URL åœ°å€å¯ä»¥ä½¿ç”¨ä½”ä½ç¬¦ï¼Œä½”ä½ç¬¦æ˜¯ç”± {} åŒ…åœçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœå‡½æ•¸åƒæ•¸èˆ‡ URL è·¯å¾‘ä¸­çš„ä½”ä½ç¬¦åç¨±ä¸åŒï¼Œå¯ä½¿ç”¨ AliasAs æŒ‡å®šåˆ¥åã€‚</p><pre><code>[Get("/group/{id}/users")]Task&lt;List&lt;User&gt;&gt; GroupList([AliasAs("id")] int groupId)</code></pre><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåƒæ•¸åç¨±å’Œ URL åƒæ•¸ä½”ä½ç¬¦ä¸å€åˆ†å¤§å°å¯«ï¼Œå¦‚æœä¸€å€‹å‡½æ•¸åƒæ•¸æœªè¢« URL ä½”ä½ç¬¦æ‰€ä½¿ç”¨ï¼Œé‚£éº¼å®ƒå°‡è‡ªå‹•è¢«ç•¶ä½œ QueryString æŸ¥è©¢å­—ç¬¦ä¸²ä¾†ä½¿ç”¨ã€‚</p><pre><code>[Get("/group/{id}/users")]Task&lt;List&lt;User&gt;&gt; GroupList([AliasAs("id")] int groupId, [AliasAs("sort")] string sortOrder);</code></pre><p>ç•¶æˆ‘å€‘èª¿ç”¨ GroupList æ–¹æ³•æ™‚ï¼Œç›¸ç•¶æ–¼è«‹æ±‚ "/group/4/users?sort=desc"é€™å€‹åœ°å€ï¼Œå…¶ä¸­ sort åƒæ•¸è¢«ç•¶ä½œ GET åƒæ•¸è‡ªå‹•ä½¿ç”¨ã€‚</p><h2 class=pgc-h-arrow-right>Dynamic Querystring Parameters</h2><p>å‡½æ•¸åƒæ•¸å¯å‚³éå°è±¡ï¼Œå°è±¡çš„å­—æ®µå±¬æ€§å°‡è¢«è‡ªå‹•è¿½åŠ åˆ° Querystring æŸ¥è©¢å­—ç¬¦ä¸²ã€‚</p><pre><code>public class MyQueryParams{	[AliasAs("order")]	public string SortOrder { get; set; }		public int Limit { get; set; }}[Get("/group/{id}/users")]Task&lt;List&lt;User&gt;&gt; GroupList([AliasAs("id")] int groupId, MyQueryParams param);[Get("/group/{id}/users")]Task&lt;List&lt;User&gt;&gt; GroupListWithAttribute([AliasAs("id")] int groupId, [Query(".","search")] MyQueryParams param);param.SortOrder = "desc";param.Limit = 10;GroupList(4, param)&gt;&gt;&gt; "/group/4/users?order=desc&amp;Limit=10"GroupListWithAttribute(4, param)&gt;&gt;&gt; "/group/4/users?search.order=desc&amp;search.Limit=10"</code></pre><h2 class=pgc-h-arrow-right>Collections as Querystring parameters</h2><p>é™¤äº†æ”¯æŒå°è±¡åƒæ•¸å¤–ï¼Œé‚„æ˜¯æ”¯æŒé›†åˆåƒæ•¸ï¼Œä¸‹é¢æ˜¯ä½¿ç”¨ç¤ºä¾‹ï¼š</p><pre><code>[Get("/users/list")]Task Search([Query(CollectionFormat.Multi)]int[] ages);Search(new [] {10, 20, 30})&gt;&gt;&gt; "/users/list?ages=10&amp;ages=20&amp;ages=30"[Get("/users/list")]Task Search([Query(CollectionFormat.Csv)]int[] ages);Search(new [] {10, 20, 30})&gt;&gt;&gt; "/users/list?ages=10%2C20%2C30"</code></pre><h2 class=pgc-h-arrow-right>Bodyå…§å®¹</h2><p>é€šéä½¿ç”¨ BodyAttribute ç‰¹æ€§ï¼Œå°‡å‡½æ•¸åƒæ•¸è¿½åŠ åˆ° HTTP è«‹æ±‚çš„ Body éƒ¨åˆ†ã€‚</p><pre><code>[Post("/users/new")]Task CreateUser([Body] User user);</code></pre><p>æ ¹æ“šåƒæ•¸çš„é¡å‹ï¼Œæä¾› Body æ•¸æ“šæœ‰å››ç¨®å¯èƒ½ï¼šå¦‚æœé¡å‹ç‚º Stream æµé¡å‹ï¼Œå‰‡å…§å®¹å°‡é€šé StreamContent æµå¼å‚³è¼¸ã€‚å¦‚æœé¡å‹æ˜¯ String å­—ç¬¦ä¸²é¡å‹ï¼Œå‰‡è©²å­—ç¬¦ä¸²å°‡ç›´æ¥ç”¨ä½œå…§å®¹ã€‚å¦‚æœåƒæ•¸å…·æœ‰ [Body(BodySerializationMethod.UrlEncoded)] å±¬æ€§ï¼Œå…§å®¹å°‡è¢« URL ç·¨ç¢¼å¾Œä½¿ç”¨ã€‚å°æ–¼ä»¥ä¸Šé™¤å¤–çš„å…¶å®ƒé¡å‹ï¼Œå°è±¡å°‡è¢«åºåˆ—åŒ–ç‚º JSON å‚³è¼¸ã€‚</p><h2 class=pgc-h-arrow-right>JSONå…§å®¹</h2><p>åŸºæ–¼ JSON çš„è«‹æ±‚å’ŒéŸ¿æ‡‰ï¼Œå…§éƒ¨ä½¿ç”¨ JSON.NET æ¡†æ¶é€²è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œé»˜èªæƒ…æ³ä¸‹ï¼ŒRefit æ¡†æ¶å°‡ä½¿ç”¨ JsonConvert.DefaultSettings ä¾†é…ç½®åºåˆ—åŒ–å™¨çš„è¡Œç‚ºï¼š</p><pre><code>JsonConvert.DefaultSettings =    () =&gt; new JsonSerializerSettings() {        ContractResolver = new CamelCasePropertyNamesContractResolver(),        Converters = {new StringEnumConverter()}    };// Serialized as: {"day":"Saturday"}await PostSomeStuff(new { Day = DayOfWeek.Saturday });</code></pre><p>å› ç‚ºéœæ…‹å±¬æ€§ DefaultSettings æ˜¯å…¨å±€è¨­ç½®ï¼Œå®ƒæœƒå½±éŸ¿æ•´å€‹æ‡‰ç”¨ç¨‹åºï¼Œæœ‰äº›æ™‚å€™ï¼Œæˆ‘å€‘å¸Œæœ›å°æŸäº› API è«‹æ±‚ä½¿ç”¨ç‰¹å®šåºåˆ—åŒ–è¨­ç½®ï¼Œå¯ä»¥ä½¿ç”¨ RefitSettings ä¾†æŒ‡å®šã€‚</p><pre><code>var gitHubApi = RestService.For&lt;IGitHubApi&gt;("https://api.xcode.me",    new RefitSettings {        JsonSerializerSettings = new JsonSerializerSettings {            ContractResolver = new SnakeCasePropertyNamesContractResolver()        }    });var otherApi = RestService.For&lt;IOtherApi&gt;("https://api.xcode.me",    new RefitSettings {        JsonSerializerSettings = new JsonSerializerSettings {            ContractResolver = new CamelCasePropertyNamesContractResolver()        }    });</code></pre><p>å°è±¡å±¬æ€§çš„åºåˆ—åŒ–è¡Œç‚ºå¯ä»¥é€šé JSON.NET æ¡†æ¶æœ¬èº«çš„ JsonPropertyAttribute ç‰¹æ€§å®šè£½ï¼š</p><pre><code>public class Foo {    // Works like [AliasAs("b")] would in form posts (see below)    [JsonProperty(PropertyName="b")]    public string Bar { get; set; }}</code></pre><h2 class=pgc-h-arrow-right>Form posts</h2><p>å°æ–¼æ¡ç”¨è¡¨å–®æäº¤æ•¸æ“šï¼ˆapplication/x-www-form-urlencodedï¼‰çš„ API æ¥å£ï¼Œä½¿ç”¨ BodySerializationMethod.UrlEncoded åˆå§‹åŒ– BodyAttribute ç‰¹æ€§ï¼Œåƒæ•¸å¯ä»¥æ˜¯ä¸€å€‹ IDictionary å­—å…¸ã€‚</p><pre><code>public interface IMeasurementProtocolApi{    [Post("/collect")]    Task Collect([Body(BodySerializationMethod.UrlEncoded)] Dictionary&lt;string, object&gt; data);}var data = new Dictionary&lt;string, object&gt; {    {"v", 1},    {"tid", "UA-1234-5"},    {"cid", new Guid("d1e9ea6b-2e8b-4699-93e0-0bcbd26c206c")},    {"t", "event"},};// Serialized as: v=1&amp;tid=UA-1234-5&amp;cid=d1e9ea6b-2e8b-4699-93e0-0bcbd26c206c&amp;t=eventawait api.Collect(data);</code></pre><p>é€šéè¡¨å–®æäº¤å‚³éæ•¸æ“šï¼Œä¹Ÿå¯ä»¥æ˜¯ä»»ä½•å°è±¡ï¼Œå°è±¡çš„æ‰€æœ‰å…¬é–‹å±¬æ€§å’Œå­—æ®µå°‡è¢«åºåˆ—åŒ–ï¼Œå¯ä½¿ç”¨ AliasAs æŒ‡å®šåˆ¥åï¼š</p><pre><code>public interface IMeasurementProtocolApi{    [Post("/collect")]    Task Collect([Body(BodySerializationMethod.UrlEncoded)] Measurement measurement);}public class Measurement{    // Properties can be read-only and [AliasAs] isn't required    public int v { get { return 1; } }     [AliasAs("tid")]    public string WebPropertyId { get; set; }    [AliasAs("cid")]    public Guid ClientId { get; set; }    [AliasAs("t")]    public string Type { get; set; }    public object IgnoreMe { private get; set; }}var measurement = new Measurement {    WebPropertyId = "UA-1234-5",    ClientId = new Guid("d1e9ea6b-2e8b-4699-93e0-0bcbd26c206c"),    Type = "event" };// Serialized as: v=1&amp;tid=UA-1234-5&amp;cid=d1e9ea6b-2e8b-4699-93e0-0bcbd26c206c&amp;t=eventawait api.Collect(measurement);</code></pre><h2 class=pgc-h-arrow-right>è¨­ç½®éœæ…‹è«‹æ±‚é ­</h2><p>æ‚¨å¯ä»¥ä½¿ç”¨ HeadersAttribute ç‰¹æ€§è¨­ç½®ä¸€å€‹æˆ–å¤šå€‹ HTTP éœæ…‹è«‹æ±‚æ¨™é ­ï¼š</p><pre><code>[Headers("User-Agent: Awesome Octocat App")][Get("/users/{user}")]Task&lt;User&gt; GetUser(string user);</code></pre><p>ä¹Ÿå¯ä»¥é€šéå°‡ HeadersAttribute ç‰¹æ€§æ‡‰ç”¨æ–¼æ¥å£ï¼Œé€™å°‡å½±éŸ¿è©²æ¥å£ä¸­çš„æ‰€æœ‰è«‹æ±‚æ–¹æ³•ï¼š</p><pre><code>[Headers("User-Agent: Awesome Octocat App")]public interface IGitHubApi{    [Get("/users/{user}")]    Task&lt;User&gt; GetUser(string user);        [Post("/users/new")]    Task CreateUser([Body] User user);}</code></pre><h2 class=pgc-h-arrow-right>è¨­ç½®å‹•æ…‹è«‹æ±‚é ­</h2><p>å¦‚æœè«‹æ±‚é ­éœ€è¦åœ¨é‹è¡Œæ™‚è¨­ç½®ï¼Œå‰‡å¯ä»¥é€šéå°‡ HeaderAttribute ç‰¹æ€§æ‡‰ç”¨åˆ°å‡½æ•¸åƒæ•¸ï¼Œå¾è€Œç‚ºè«‹æ±‚é ­æ·»åŠ å‹•æ…‹å€¼ã€‚</p><pre><code>[Get("/users/{user}")]Task&lt;User&gt; GetUser(string user, [Header("Authorization")] string authorization);// Will add the header "Authorization: token OAUTH-TOKEN" to the requestvar user = await GetUser("octocat", "token OAUTH-TOKEN");</code></pre><h2 class=pgc-h-arrow-right>æˆæ¬Š(å‹•æ…‹è«‹æ±‚é ­)</h2><p>æ¨™é ­æœ€å¸¸è¦‹çš„ç”¨é€”æ˜¯æˆæ¬Šï¼Œä»Šå¤©ï¼Œå¤§å¤šæ•¸ API éƒ½ä½¿ç”¨ oAuth å”è­°é€šéè¨ªå•ä»¤ç‰Œæˆæ¬Šï¼Œç”³è«‹è¨ªå•ä»¤ç‰Œï¼Œå³å¯è¨ªå• API æ¥å£ï¼Œè¨ªå•ä»¤ç‰Œåˆ°æœŸå¾Œéœ€è¦åˆ·æ–°ä»¤ç‰Œï¼Œå–å¾—æ›´é•·å£½å‘½çš„ä»¤ç‰Œï¼Œå°è£é€™äº›ä»¤ç‰Œçš„æ“ä½œï¼Œå¯é€šéè‡ªå®šç¾© HttpClientHandler ä¾†å¯¦ç¾ï¼š</p><pre><code>class AuthenticatedHttpClientHandler : HttpClientHandler{    private readonly Func&lt;Task&lt;string&gt;&gt; getToken;    public AuthenticatedHttpClientHandler(Func&lt;Task&lt;string&gt;&gt; getToken)    {        if (getToken == null) throw new ArgumentNullException(nameof(getToken));        this.getToken = getToken;    }    protected override async Task&lt;HttpResponseMessage&gt; SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)    {        // See if the request has an authorize header        var auth = request.Headers.Authorization;        if (auth != null)        {            var token = await getToken().ConfigureAwait(false);            request.Headers.Authorization = new AuthenticationHeaderValue(auth.Scheme, token);        }        return await base.SendAsync(request, cancellationToken).ConfigureAwait(false);    }}</code></pre><p>é›–ç„¶ HttpClient åŒ…å«å¹¾ä¹ç›¸åŒçš„æ–¹æ³•ç°½å, ä½†ä½¿ç”¨æ–¹å¼ä¸åŒï¼ŒHttpClient.SendAsync æ²’æœ‰è¢«æ”¹è£ï¼Œå¿…é ˆæ”¹ç‚ºä¿®æ”¹ HttpClientHandlerï¼Œåƒé€™æ¨£ä½¿ç”¨ï¼š</p><pre><code>class LoginViewModel{    AuthenticationContext context = new AuthenticationContext(...);        private async Task&lt;string&gt; GetToken()    {        // The AcquireTokenAsync call will prompt with a UI if necessary        // Or otherwise silently use a refresh token to return        // a valid access token	        var token = await context.AcquireTokenAsync("http://my.service.uri/app", "clientId", new Uri("callback://complete"));                return token;    }    public async void LoginAndCallApi()    {        var api = RestService.For&lt;IMyRestService&gt;(new HttpClient(new AuthenticatedHttpClientHandler(GetToken)) { BaseAddress = new Uri("https://the.end.point/") });        var location = await api.GetLocationOfRebelBase();    }}interface IMyRestService{    [Get("/getPublicInfo")]    Task&lt;Foobar&gt; SomePublicMethod();    [Get("/secretStuff")]    [Headers("Authorization: Bearer")]    Task&lt;Location&gt; GetLocationOfRebelBase();}</code></pre><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç•¶éœ€è¦èª¿ç”¨å…·æœ‰èº«ä»½é©—è­‰çš„æ¥å£æ™‚ï¼ŒAuthenticatedHttpClientHandler å°‡å˜—è©¦ç²å–ä¸€å€‹æ–°çš„è¨ªå•ä»¤ç‰Œã€‚ç”±æ‡‰ç”¨ç¨‹åºæä¾›ä¸€å€‹ï¼Œæª¢æŸ¥ç¾æœ‰è¨ªå•ä»¤ç‰Œçš„åˆ°æœŸæ™‚é–“ï¼Œä¸¦åœ¨éœ€è¦æ™‚ç²å–æ–°çš„è¨ªå•ä»¤ç‰Œã€‚</p><h2 class=pgc-h-arrow-right>â€é‡æ–°å®šç¾©æ¨™é ­â€</h2><p>ç•¶å®šç¾© HTTP æ¨™é ­æ™‚ï¼Œå°æ–¼å¤šæ¬¡è¨­ç½®åŒåçš„æ¨™é ­ï¼Œé€™äº›é‡åçš„æ¨™é ­ä¸æœƒç›¸äº’è¦†è“‹ï¼Œéƒ½å°‡è¢«æ·»åŠ åˆ°è«‹æ±‚é ­ä¸­ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ¨™é ­è¨­ç½®çš„å„ªå…ˆç´šä¸åŒæ™‚ï¼Œé‡æ–°å®šç¾©æ¨™é ­å°‡è¢«æ›¿æ›ï¼Œå®ƒå€‘çš„å„ªå…ˆç´šæ˜¯ï¼š</p><p>1ã€æ¥å£ä¸Šçš„ Headers ç‰¹æ€§ï¼ˆæœ€ä½å„ªå…ˆç´šï¼‰ï¼Œ2ã€æ–¹æ³•ä¸Šçš„ Headers ç‰¹æ€§ï¼Œ3ã€æ–¹æ³•åƒæ•¸ä¸Šçš„ Header ç‰¹æ€§ï¼ˆæœ€é«˜å„ªå…ˆç´šï¼‰</p><pre><code>[Headers("X-Emoji: :rocket:")]public interface IGitHubApi{    [Get("/users/list")]    Task&lt;List&gt; GetUsers();        [Get("/users/{user}")]    [Headers("X-Emoji: :smile_cat:")]    Task&lt;User&gt; GetUser(string user);        [Post("/users/new")]    [Headers("X-Emoji: :metal:")]    Task CreateUser([Body] User user, [Header("X-Emoji")] string emoji);}// X-Emoji: :rocket:var users = await GetUsers();// X-Emoji: :smile_cat:var user = await GetUser("octocat");// X-Emoji: :trollface:await CreateUser(user, ":trollface:");</code></pre><h2 class=pgc-h-arrow-right>åˆªé™¤æ¨™é ­</h2><p>ç•¶ä½¿ç”¨ HeadersAttribute ä¸æä¾›å€¼æˆ–è€…æä¾›çš„å€¼ç‚º null æ™‚ï¼Œ è«‹æ±‚è¡¨é ­å°‡è¢«è‡ªå‹•ç§»é™¤ã€‚</p><pre><code>[Headers("X-Emoji: :rocket:")]public interface IGitHubApi{    [Get("/users/list")]    [Headers("X-Emoji")] // Remove the X-Emoji header    Task&lt;List&gt; GetUsers();        [Get("/users/{user}")]    [Headers("X-Emoji:")] // Redefine the X-Emoji header as empty    Task&lt;User&gt; GetUser(string user);        [Post("/users/new")]    Task CreateUser([Body] User user, [Header("X-Emoji")] string emoji);}// No X-Emoji headervar users = await GetUsers();// X-Emoji:var user = await GetUser("octocat");// No X-Emoji headerawait CreateUser(user, null);// X-Emoji:await CreateUser(user, "");</code></pre><h2 class=pgc-h-arrow-right>Multipart uploads</h2><p>Refit æ¡†æ¶ä¹Ÿæ”¯æŒå­—ç¯€æµå’Œæ–‡ä»¶æµçš„ä¸Šå‚³ï¼š</p><pre><code>public interface ISomeApi{    [Multipart]    [Post("/users/{id}/photo")]    Task UploadPhoto(int id, [AliasAs("myPhoto")] StreamPart stream);		someApiInstance.UploadPhoto(id, new StreamPart(myPhotoStream, "photo.jpg", "image/jpeg"));}</code></pre><h2 class=pgc-h-arrow-right>éŸ¿æ‡‰è™•ç†</h2><p>ç‚ºäº†æé«˜æ€§èƒ½ Refit åªæ”¯æŒæ–¹æ³•è¿”å› Task å’Œ IObservable é¡å‹ï¼Œå¦‚éœ€åŒæ­¥è«‹æ±‚ï¼Œå¯ä½¿ç”¨ async å’Œ await ç•°æ­¥æŠ€è¡“ã€‚</p><pre><code>[Post("/users/new")]Task CreateUser([Body] User user);// This will throw if the network call failsawait CreateUser(someUser);</code></pre><p>å¦‚æœé¡å‹åƒæ•¸ç‚º HttpResponseMessage æˆ– string é¡å‹ï¼Œå¯ä»¥é€šéé‡è¼‰å‡½æ•¸ä¾†åˆ†åˆ¥è¿”å›ã€‚</p><pre><code>// Returns the content as a string (i.e. the JSON data)[Get("/users/{user}")]Task&lt;string&gt; GetUser(string user);// Returns the raw response, as an IObservable that can be used with the// Reactive Extensions[Get("/users/{user}")]IObservable&lt;HttpResponseMessage&gt; GetUser(string user);</code></pre><h2 class=pgc-h-arrow-right>ä½¿ç”¨é€šç”¨æ¥å£</h2><p>æœ‰çš„ Web API æ“æœ‰ä¸€æ•´å¥—åŸºæ–¼ CRUD æ“ä½œçš„ REST æœå‹™ï¼ŒRefit å…è¨±æ‚¨ä½¿ç”¨é€šç”¨æ³›å‹å®šç¾©æ¥å£ï¼š</p><pre><code>public interface IReallyExcitingCrudApi&lt;T, in TKey&gt; where T : class{    [Post("")]    Task&lt;T&gt; Create([Body] T payload);    [Get("")]    Task&lt;List&lt;T&gt;&gt; ReadAll();    [Get("/{key}")]    Task&lt;T&gt; ReadOne(TKey key);    [Put("/{key}")]    Task Update(TKey key, [Body]T payload);    [Delete("/{key}")]    Task Delete(TKey key);}</code></pre><p>å¯ä»¥é€™æ¨£ä¾†èª¿ç”¨ä»¥ä¸Šæ¥å£å°è£ï¼š</p><pre><code>// The "/users" part here is kind of important if you want it to work for more// than one type (unless you have a different domain for each type)var api = RestService.For&lt;IReallyExcitingCrudApi&lt;User, string&gt;&gt;("http://api.xcode.me/users");</code></pre><h2 class=pgc-h-arrow-right>Using HttpClientFactory</h2><p>åœ¨ ASP.Net Core 2.1 ä¸­ï¼Œå¯é€šé Refix æ¡†æ¶æä¾›çš„æ“´å±•æ–¹æ³•æ³¨å…¥é¡å‹å®¢æˆ¶ç«¯ï¼š</p><pre><code>public void ConfigureServices(IServiceCollection services){    services.AddHttpClient("hello", c =&gt;    {        c.BaseAddress = new Uri("http://api.xcode.me");    })    .AddTypedClient(c =&gt; Refit.RestService.For&lt;IHelloClient&gt;(c));    services.AddMvc();}</code></pre><p>é™¤æ­¤ä¹‹å¤–ï¼Œé‚„æ”¯æŒé€šé HttpClientFactory å‰µå»ºè«‹æ±‚ä»£ç†ï¼ŒRefit ç‚ºæ­¤æä¾›æ“´å±•ï¼Œç”¨æ­¤æ“´å±•å‰éœ€è¦é€šé NuGet å¼•ç”¨ä»¥ä¸‹åŒ…ï¼Œ</p><pre><code>Install-Package Refit.HttpClientFactory</code></pre><p>å¼•ç”¨ç¨‹åºåŒ…å¾Œï¼Œå¯ä»¥é€™æ¨£ä¾†é…ç½®ï¼š</p><pre><code>services.AddRefitClient&lt;IWebApi&gt;()        .ConfigureHttpClient(c =&gt; c.BaseAddress = new Uri("https://api.xcode.me"));        // Add additional IHttpClientBuilder chained methods as required here:        // .AddHttpMessageHandler&lt;MyHandler&gt;()        // .SetHandlerLifetime(TimeSpan.FromMinutes(2));</code></pre><p>ä¹Ÿå¯ä»¥é€šé RefitSettings è¨­ç½®è¡Œç‚º:</p><pre><code>var settings = new RefitSettings();// Configure refit settings hereservices.AddRefitClient&lt;IWebApi&gt;(settings)        .ConfigureHttpClient(c =&gt; c.BaseAddress = new Uri("https://api.xcode.me"));        // Add additional IHttpClientBuilder chained methods as required here:        // .AddHttpMessageHandler&lt;MyHandler&gt;()        // .SetHandlerLifetime(TimeSpan.FromMinutes(2));</code></pre><p>ç„¶å¾Œ, æ‚¨å¯ä»¥ä½¿ç”¨æ§‹é€ å‡½æ•¸å°‡è«‹æ±‚æ¥å£æ³¨å…¥åˆ°æ§åˆ¶å™¨ä¹‹ä¸­ï¼š</p><pre><code>public class HomeController : Controller{    public HomeController(IWebApi webApi)    {        _webApi = webApi;    }    private readonly IWebApi _webApi;    public async Task&lt;IActionResult&gt; Index(CancellationToken cancellationToken)    {        var thing = await _webApi.GetSomethingWeNeed(cancellationToken);        return View(thing);    }}</code></pre></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Refit</a></li><li><a>è¨ªå•</a></li><li><a>REST</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/e46b4ccb.html alt=Npmç¨‹åºæ¼æ´æ›å…‰ï¼Œå…è¨±é»‘å®¢è¨ªå•ç”¨æˆ¶æ–‡ä»¶ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/07a4bc313620451d9ca8d505a893206f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e46b4ccb.html title=Npmç¨‹åºæ¼æ´æ›å…‰ï¼Œå…è¨±é»‘å®¢è¨ªå•ç”¨æˆ¶æ–‡ä»¶>Npmç¨‹åºæ¼æ´æ›å…‰ï¼Œå…è¨±é»‘å®¢è¨ªå•ç”¨æˆ¶æ–‡ä»¶</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/76de484d.html alt=è¨ªå•ç¾åœ‹èˆªç©ºææ–™å’Œé›ä»¶ç”Ÿç”¢å…¬å¸è¨˜å¯¦åŠé»æ»´æ„Ÿæƒ³ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ff4f21acbc444e9bbbaf237b2c7dab89 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/76de484d.html title=è¨ªå•ç¾åœ‹èˆªç©ºææ–™å’Œé›ä»¶ç”Ÿç”¢å…¬å¸è¨˜å¯¦åŠé»æ»´æ„Ÿæƒ³>è¨ªå•ç¾åœ‹èˆªç©ºææ–™å’Œé›ä»¶ç”Ÿç”¢å…¬å¸è¨˜å¯¦åŠé»æ»´æ„Ÿæƒ³</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d323acd6.html alt="ä¸€æ–‡æå®š REST Assured å¯¦è¸(äºŒ)ï¼šæ–·è¨€å¯¦ç¾" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2d017d59689b467b93d6e1a4bcb3a13c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d323acd6.html title="ä¸€æ–‡æå®š REST Assured å¯¦è¸(äºŒ)ï¼šæ–·è¨€å¯¦ç¾">ä¸€æ–‡æå®š REST Assured å¯¦è¸(äºŒ)ï¼šæ–·è¨€å¯¦ç¾</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b48185e0.html alt="ç„¡æœå‹™å™¨èª¿ç ”ï¼Œéƒ¨ç½²REST APIæ˜¯æœ€æ™®éç”¨ä¾‹" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/115fbc9ff5144e1b8fd44ef400d45a66 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b48185e0.html title="ç„¡æœå‹™å™¨èª¿ç ”ï¼Œéƒ¨ç½²REST APIæ˜¯æœ€æ™®éç”¨ä¾‹">ç„¡æœå‹™å™¨èª¿ç ”ï¼Œéƒ¨ç½²REST APIæ˜¯æœ€æ™®éç”¨ä¾‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/17be6b38.html alt="REST APIä¸€äº›å¿…å‚™çš„å®‰å…¨åŸºç¤--ç­è§£ä¸€ä¸‹" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9d96827535e743af9bf55e5af185e5b7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/17be6b38.html title="REST APIä¸€äº›å¿…å‚™çš„å®‰å…¨åŸºç¤--ç­è§£ä¸€ä¸‹">REST APIä¸€äº›å¿…å‚™çš„å®‰å…¨åŸºç¤--ç­è§£ä¸€ä¸‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ff8b72da.html alt=å¾Kuberneteså®‰å…¨è¨ªå•AWSæœå‹™ï¼Œå¤šé›²å ´æ™¯ä¸‹å¦‚ä½•ç®¡ç†é›²æ†‘æ“š class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/7527c8c63e214dfdbc6f2a8ef58f54c8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ff8b72da.html title=å¾Kuberneteså®‰å…¨è¨ªå•AWSæœå‹™ï¼Œå¤šé›²å ´æ™¯ä¸‹å¦‚ä½•ç®¡ç†é›²æ†‘æ“š>å¾Kuberneteså®‰å…¨è¨ªå•AWSæœå‹™ï¼Œå¤šé›²å ´æ™¯ä¸‹å¦‚ä½•ç®¡ç†é›²æ†‘æ“š</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c54baff1.html alt=Windowsè¨ªå•ä»¤ç‰Œç«Šå–æ”»é˜²æŠ€è¡“ç ”ç©¶ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/21e6fbbee849410aaee7391add369084 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c54baff1.html title=Windowsè¨ªå•ä»¤ç‰Œç«Šå–æ”»é˜²æŠ€è¡“ç ”ç©¶>Windowsè¨ªå•ä»¤ç‰Œç«Šå–æ”»é˜²æŠ€è¡“ç ”ç©¶</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/989ea117.html alt=ç®¡ç†APIè¨ªå•ä»¤ç‰Œçš„å®‰å…¨æœ€ä½³å¯¦è¸ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/288f721723b1489c81d62de6aa6cfd33 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/989ea117.html title=ç®¡ç†APIè¨ªå•ä»¤ç‰Œçš„å®‰å…¨æœ€ä½³å¯¦è¸>ç®¡ç†APIè¨ªå•ä»¤ç‰Œçš„å®‰å…¨æœ€ä½³å¯¦è¸</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2b3d1e19.html alt=é—œæ–¼JDBCè¨ªå•æ•¸æ“šåº«ï¼Œå­¸JAVAçš„éƒ½ä¾†çœ‹çœ‹å§ï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/436e0002836d89f78c59 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2b3d1e19.html title=é—œæ–¼JDBCè¨ªå•æ•¸æ“šåº«ï¼Œå­¸JAVAçš„éƒ½ä¾†çœ‹çœ‹å§ï¼>é—œæ–¼JDBCè¨ªå•æ•¸æ“šåº«ï¼Œå­¸JAVAçš„éƒ½ä¾†çœ‹çœ‹å§ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f75421fa.html alt="è¨ªå• 2020å»£å·æ±½è»Šç”¨å“å±•è¦½æœƒ å±•æœƒæ–°è" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a1b77359c18244fba14c2b30b7272b29 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f75421fa.html title="è¨ªå• 2020å»£å·æ±½è»Šç”¨å“å±•è¦½æœƒ å±•æœƒæ–°è">è¨ªå• 2020å»£å·æ±½è»Šç”¨å“å±•è¦½æœƒ å±•æœƒæ–°è</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/c8bf78de.html alt="åœ‹æ˜¯è¨ªå• | ä¸­åœ‹å¹³å®‰ç¸½ç¶“ç†è¬æ°¸æ—ï¼šåœ¨é€™å€‹ç‰¹æ®Šä¹‹åœ°ï¼Œæˆ‘å€‘æ²’ç†ç”±åœæ­¥" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b6cec7f9a1784a25bcd56c21958478a4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/c8bf78de.html title="åœ‹æ˜¯è¨ªå• | ä¸­åœ‹å¹³å®‰ç¸½ç¶“ç†è¬æ°¸æ—ï¼šåœ¨é€™å€‹ç‰¹æ®Šä¹‹åœ°ï¼Œæˆ‘å€‘æ²’ç†ç”±åœæ­¥">åœ‹æ˜¯è¨ªå• | ä¸­åœ‹å¹³å®‰ç¸½ç¶“ç†è¬æ°¸æ—ï¼šåœ¨é€™å€‹ç‰¹æ®Šä¹‹åœ°ï¼Œæˆ‘å€‘æ²’ç†ç”±åœæ­¥</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/808d08df.html alt=jqueryè¨ªå•jsonæ–‡ä»¶ä¸­çš„æ•¸æ“š class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1537273569736739b54a17f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/808d08df.html title=jqueryè¨ªå•jsonæ–‡ä»¶ä¸­çš„æ•¸æ“š>jqueryè¨ªå•jsonæ–‡ä»¶ä¸­çš„æ•¸æ“š</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c4007f5c.html alt=åŸºæ–¼èŠ¯ç‰‡ä»¿çœŸå™¨çš„ç¨‹åºè¨ªå•æ¬Šé™é…ç½®æ–¹æ¡ˆ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RfcQ7YoHQMBFqo style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c4007f5c.html title=åŸºæ–¼èŠ¯ç‰‡ä»¿çœŸå™¨çš„ç¨‹åºè¨ªå•æ¬Šé™é…ç½®æ–¹æ¡ˆ>åŸºæ–¼èŠ¯ç‰‡ä»¿çœŸå™¨çš„ç¨‹åºè¨ªå•æ¬Šé™é…ç½®æ–¹æ¡ˆ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/61029fb0.html alt=è¨ˆç®—æ©Ÿæ˜¯å¦‚ä½•è¨ªå•ä¸€å€‹ç¶²é çš„ï¼Ÿvlané–“å¦‚ä½•å¯¦ç¾é€šä¿¡ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a71aca8f6f2a4c6280b82d47a2a48532 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/61029fb0.html title=è¨ˆç®—æ©Ÿæ˜¯å¦‚ä½•è¨ªå•ä¸€å€‹ç¶²é çš„ï¼Ÿvlané–“å¦‚ä½•å¯¦ç¾é€šä¿¡ï¼Ÿ>è¨ˆç®—æ©Ÿæ˜¯å¦‚ä½•è¨ªå•ä¸€å€‹ç¶²é çš„ï¼Ÿvlané–“å¦‚ä½•å¯¦ç¾é€šä¿¡ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a4a7638.html alt=springbootè¨ªå•åœ–ç‰‡æœ¬åœ°è·¯å¾‘ä¸¦æ˜ å°„æˆurl class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8114173a6b58429f889c3f2681140789 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a4a7638.html title=springbootè¨ªå•åœ–ç‰‡æœ¬åœ°è·¯å¾‘ä¸¦æ˜ å°„æˆurl>springbootè¨ªå•åœ–ç‰‡æœ¬åœ°è·¯å¾‘ä¸¦æ˜ å°„æˆurl</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>