<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>ç•°æ­¥ç·¨ç¨‹å¯¦ä¾‹ï¼šJava8 APIçš„ç†è§£å’ŒCompletableFutureé¡çš„å¯¦ç¾ | æå®¢å¿«è¨Š</title><meta property="og:title" content="ç•°æ­¥ç·¨ç¨‹å¯¦ä¾‹ï¼šJava8 APIçš„ç†è§£å’ŒCompletableFutureé¡çš„å¯¦ç¾ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/1522150125651deaa9d51b2"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3a0dfd7.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3a0dfd7.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3a0dfd7.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3a0dfd7.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3a0dfd7.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3a0dfd7.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3a0dfd7.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3a0dfd7.html><meta property="article:published_time" content="2020-10-29T20:50:33+08:00"><meta property="article:modified_time" content="2020-10-29T20:50:33+08:00"><meta name=Keywords content><meta name=description content="ç•°æ­¥ç·¨ç¨‹å¯¦ä¾‹ï¼šJava8 APIçš„ç†è§£å’ŒCompletableFutureé¡çš„å¯¦ç¾"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/3a0dfd7.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>ç•°æ­¥ç·¨ç¨‹å¯¦ä¾‹ï¼šJava8 APIçš„ç†è§£å’ŒCompletableFutureé¡çš„å¯¦ç¾</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><p>ç•°æ­¥ç·¨ç¨‹æœ€å¤§çš„ç‰¹é»è«éæ–¼å®ƒèƒ½æé«˜ç³»çµ±çš„ååç‡ï¼Œå¾è€Œæé«˜å·¥ä½œæ•ˆç‡ã€‚ä¸‹é¢æ˜¯é—œæ–¼Java APIå’ŒCompletableFutureé¡çš„é™³è¿°å’Œå¯¦ä¾‹ï¼Œå¹«ä½ æ›´å¥½çš„ç†è§£Javaç•°æ­¥ç·¨ç¨‹ã€‚</p><p>Javaç•°æ­¥ç·¨ç¨‹ä¸­ï¼ŒFutureå¯ä»¥ç”¨ä¾†é€²è¡Œç•°æ­¥è¨ˆç®—ï¼Œå®ƒä½æ–¼java.util.concurrentåŒ…ä¸­ã€‚å®ƒçš„å¯¦ç¾å¯ä»¥ç†è§£æˆï¼šæˆ‘æœ‰ä¸€å€‹ä»»å‹™ï¼Œç´„å®šç”±Futureä¾†å®Œæˆé€™å€‹ä»»å‹™ã€‚æœŸé–“æˆ‘å¯ä»¥å»åšå…¶ä»–æƒ³åšçš„äº‹æƒ…ã€‚ä¸€æ®µæ™‚é–“ä¹‹å¾Œï¼Œæˆ‘å¯ä»¥ç›´æ¥å¾Futureé‚£å…’å–å‡ºçµæœã€‚å°æ–¼Javaç•°æ­¥ç·¨ç¨‹ï¼Œä¸ä¸€å®šéè¦ä½¿ç”¨rxJava, Javaæœ¬èº«çš„åº«ä¸­çš„CompletableFutureå¯ä»¥å¾ˆå¥½çš„æ‡‰å°å¤§å¤šæ•¸å ´åˆã€‚</p><p><img alt="ç•°æ­¥ç·¨ç¨‹å¯¦ä¾‹ï¼šJava8 APIçš„ç†è§£å’ŒCompletableFutureé¡çš„å¯¦ç¾" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1522150125651deaa9d51b2></p><p>é€™è£¡æ˜¯ä»‹ç´¹ Java 8 çš„ CompletionStage APIå’Œå®ƒçš„æ¨™æº–åº«çš„å¯¦ç¾ CompletableFutureçš„ä¸€ç¯‡æ–‡ç« ã€‚APIé€šéä¾‹å­çš„æ–¹å¼æ¼”ç¤ºäº†å®ƒçš„è¡Œç‚ºï¼Œæ¯å€‹ä¾‹å­æ¼”ç¤ºä¸€åˆ°å…©å€‹è¡Œç‚ºã€‚</p><p>æ—¢ç„¶CompletableFutureé¡å¯¦ç¾äº†CompletionStageæ¥å£ï¼Œé¦–å…ˆæˆ‘å€‘éœ€è¦ç†è§£é€™å€‹æ¥å£çš„å¥‘ç´„ã€‚å®ƒä»£è¡¨äº†ä¸€å€‹ç‰¹å®šçš„è¨ˆç®—çš„éšæ®µï¼Œå¯ä»¥åŒæ­¥æˆ–è€…ç•°æ­¥çš„è¢«å®Œæˆã€‚ä½ å¯ä»¥æŠŠå®ƒçœ‹æˆä¸€å€‹è¨ˆç®—æµæ°´ç·šä¸Šçš„ä¸€å€‹å–®å…ƒï¼Œæœ€çµ‚æœƒç”¢ç”Ÿä¸€å€‹æœ€çµ‚çµæœï¼Œé€™æ„å‘³è‘—å¹¾å€‹CompletionStageå¯ä»¥ä¸²è¯èµ·ä¾†ï¼Œä¸€å€‹å®Œæˆçš„éšæ®µå¯ä»¥è§¸ç™¼ä¸‹ä¸€éšæ®µçš„åŸ·è¡Œï¼Œæ¥è‘—è§¸ç™¼ä¸‹ä¸€æ¬¡ï¼Œæ¥è‘—â€¦â€¦</p><p>é™¤äº†å¯¦ç¾CompletionStageæ¥å£ï¼ŒCompletableFutureä¹Ÿå¯¦ç¾äº†futureæ¥å£, ä»£è¡¨ä¸€å€‹æœªå®Œæˆçš„ç•°æ­¥äº‹ä»¶ã€‚</p><p>CompletableFutureæä¾›äº†æ–¹æ³•ï¼Œèƒ½å¤ é¡¯å¼åœ°å®Œæˆé€™å€‹future,æ‰€ä»¥å®ƒå«CompletableFutureã€‚</p><p>1ã€ å‰µå»ºä¸€å€‹å®Œæˆçš„CompletableFuture</p><p>æœ€ç°¡å–®çš„ä¾‹å­å°±æ˜¯ä½¿ç”¨ä¸€å€‹é å®šç¾©çš„çµæœå‰µå»ºä¸€å€‹å®Œæˆçš„CompletableFuture,é€šå¸¸æˆ‘å€‘æœƒåœ¨è¨ˆç®—çš„é–‹å§‹éšæ®µä½¿ç”¨å®ƒã€‚</p><p><code>static</code><code>void</code><code>completedFutureExample() {</code></p><p><code>CompletableFuture cf = CompletableFuture.completedFuture(</code><code>"message"</code><code>);</code></p><p><code>assertTrue(cf.isDone());</code></p><p><code>assertEquals(</code><code>"message"</code><code>, cf.getNow(</code><code>null</code><code>));</code></p><p><code>}</code></p><p>getNow(null)</p><p>æ–¹æ³•åœ¨futureå®Œæˆçš„æƒ…æ³ä¸‹æœƒè¿”å›çµæœï¼Œå°±æ¯”å¦‚ä¸Šé¢é€™å€‹ä¾‹å­ï¼Œå¦å‰‡è¿”å›null (å‚³å…¥çš„åƒæ•¸)ã€‚</p><p>2ã€é‹è¡Œä¸€å€‹ç°¡å–®çš„ç•°æ­¥éšæ®µ</p><p>é€™å€‹ä¾‹å­å‰µå»ºä¸€å€‹ä¸€å€‹ç•°æ­¥åŸ·è¡Œçš„éšæ®µï¼š</p><p><code>static</code><code>void</code><code>runAsyncExample() {</code></p><p><code>CompletableFuture cf = CompletableFuture.runAsync(() -> {</code></p><p><code>assertTrue(Thread.currentThread().isDaemon());</code></p><p><code>randomSleep();</code></p><p><code>});</code></p><p><code>assertFalse(cf.isDone());</code></p><p><code>sleepEnough();</code></p><p><code>assertTrue(cf.isDone());</code></p><p><code>}</code></p><p>é€šéé€™å€‹ä¾‹å­å¯ä»¥å­¸åˆ°å…©ä»¶äº‹æƒ…ï¼š</p><p>CompletableFutureçš„æ–¹æ³•å¦‚æœä»¥</p><p>Async</p><p>çµå°¾ï¼Œå®ƒæœƒç•°æ­¥çš„åŸ·è¡Œ(æ²’æœ‰æŒ‡å®šexecutorçš„æƒ…æ³ä¸‹)ï¼Œ ç•°æ­¥åŸ·è¡Œé€šéForkJoinPoolå¯¦ç¾ï¼Œ å®ƒä½¿ç”¨å®ˆè­·ç·šç¨‹å»åŸ·è¡Œä»»å‹™ã€‚æ³¨æ„é€™æ˜¯CompletableFutureçš„ç‰¹æ€§ï¼Œ å…¶å®ƒCompletionStageå¯ä»¥overrideé€™å€‹é»˜èªçš„è¡Œç‚ºã€‚</p><p>3ã€åœ¨å‰ä¸€å€‹éšæ®µä¸Šæ‡‰ç”¨å‡½æ•¸</p><p>ä¸‹é¢é€™å€‹ä¾‹å­ä½¿ç”¨å‰é¢ #1 çš„å®Œæˆçš„CompletableFutureï¼Œ #1è¿”å›çµæœç‚ºå­—ç¬¦ä¸²</p><p>message</p><p>,ç„¶å¾Œæ‡‰ç”¨ä¸€å€‹å‡½æ•¸æŠŠå®ƒè®Šæˆå¤§å¯«å­—æ¯ã€‚</p><p><code>static</code><code>void</code><code>thenApplyExample() {</code></p><p><code>CompletableFuture cf = CompletableFuture.completedFuture(</code><code>"message"</code><code>).thenApply(s -> {</code></p><p><code>assertFalse(Thread.currentThread().isDaemon());</code></p><p><code>return</code><code>s.toUpperCase();</code></p><p><code>});</code></p><p><code>assertEquals(</code><code>"MESSAGE"</code><code>, cf.getNow(</code><code>null</code><code>));</code></p><p><code>}</code></p><p>æ³¨æ„</p><p>thenApply</p><p>æ–¹æ³•åç¨±ä»£è¡¨çš„è¡Œç‚ºã€‚</p><p>then</p><p>æ„å‘³è‘—é€™å€‹éšæ®µçš„å‹•ä½œç™¼ç”Ÿç•¶å‰çš„éšæ®µæ­£å¸¸å®Œæˆä¹‹å¾Œã€‚æœ¬ä¾‹ä¸­ï¼Œç•¶å‰ç¯€é»å®Œæˆï¼Œè¿”å›å­—ç¬¦ä¸²</p><p>message</p><p>ã€‚</p><p>Apply</p><p>æ„å‘³è‘—è¿”å›çš„éšæ®µå°‡æœƒå°çµæœå‰ä¸€éšæ®µçš„çµæœæ‡‰ç”¨ä¸€å€‹å‡½æ•¸ã€‚</p><p>å‡½æ•¸çš„åŸ·è¡Œæœƒè¢«é˜»å¡ï¼Œé€™æ„å‘³è‘—</p><p>getNow()</p><p>åªæœ‰æ‰“æ–œæ“ä½œè¢«å®Œæˆå¾Œæ‰è¿”å›ã€‚</p><p>4ã€åœ¨å‰ä¸€å€‹éšæ®µä¸Šç•°æ­¥æ‡‰ç”¨å‡½æ•¸</p><p>é€šéèª¿ç”¨ç•°æ­¥æ–¹æ³•(æ–¹æ³•å¾Œé‚ŠåŠ Asyncå¾Œç¶´)ï¼Œä¸²è¯èµ·ä¾†çš„CompletableFutureå¯ä»¥ç•°æ­¥åœ°åŸ·è¡Œï¼ˆä½¿ç”¨ForkJoinPool.commonPool()ï¼‰ã€‚</p><p><code>static</code> <code>void</code> <code>thenApplyAsyncExample() {</code></p><p><code>CompletableFuture cf = CompletableFuture.completedFuture(</code><code>"message"</code><code>).thenApplyAsync(s -> {</code></p><p><code>assertTrue(Thread.currentThread().isDaemon());</code></p><p><code>randomSleep();</code></p><p><code>return</code> <code>s.toUpperCase();</code></p><p><code>});</code></p><p><code>assertNull(cf.getNow(</code><code>null</code><code>));</code></p><p><code>assertEquals(</code><code>"MESSAGE"</code><code>, cf.join());</code></p><p><code>}</code></p><p>5ã€ä½¿ç”¨å®šè£½çš„Executoråœ¨å‰ä¸€å€‹éšæ®µä¸Šç•°æ­¥æ‡‰ç”¨å‡½æ•¸</p><p>ç•°æ­¥æ–¹æ³•ä¸€å€‹éå¸¸æœ‰ç”¨çš„ç‰¹æ€§å°±æ˜¯èƒ½å¤ æä¾›ä¸€å€‹Executorä¾†ç•°æ­¥åœ°åŸ·è¡ŒCompletableFutureã€‚é€™å€‹ä¾‹å­æ¼”ç¤ºç­å¦‚ä½•ä½¿ç”¨ä¸€å€‹å›ºå®šå¤§å°çš„ç·šç¨‹æ± ä¾†æ‡‰ç”¨å¤§å¯«å‡½æ•¸ã€‚<span>static</span></p><p><code>ExecutorService executor = Executors.newFixedThreadPool(</code><code>3</code><code>, </code><code>new</code><code>ThreadFactory() {</code></p><p><code>int</code> <code>count = </code><code>1</code><code>;</code></p><p><code>@Override</code></p><p><code>public</code> <code>Thread newThread(Runnable runnable) {</code></p><p><code>return</code> <code>new</code> <code>Thread(runnable, </code><code>"custom-executor-"</code> <code>+ count++);</code></p><p><code>}</code></p><p><code>});</code></p><p><code>static</code> <code>void</code> <code>thenApplyAsyncWithExecutorExample() {</code></p><p><code>CompletableFuture cf = CompletableFuture.completedFuture(</code><code>"message"</code><code>).thenApplyAsync(s -> {</code></p><p><code>assertTrue(Thread.currentThread().getName().startsWith(</code><code>"custom-executor-"</code><code>));</code></p><p><code>assertFalse(Thread.currentThread().isDaemon());</code></p><p><code>randomSleep();</code></p><p><code>return</code> <code>s.toUpperCase();</code></p><p><code>}, executor);</code></p><p><code>assertNull(cf.getNow(</code><code>null</code><code>));</code></p><p><code>assertEquals(</code><code>"MESSAGE"</code><code>, cf.join());</code></p><p><code>}</code></p><p>6ã€æ¶ˆè²»å‰ä¸€éšæ®µçš„çµæœ</p><p>å¦‚æœä¸‹ä¸€éšæ®µæ¥æ”¶äº†ç•¶å‰éšæ®µçš„çµæœï¼Œä½†æ˜¯åœ¨è¨ˆç®—çš„æ™‚å€™ä¸éœ€è¦è¿”å›å€¼(å®ƒçš„è¿”å›é¡å‹æ˜¯void)ï¼Œ é‚£éº¼å®ƒå¯ä»¥ä¸æ‡‰ç”¨ä¸€å€‹å‡½æ•¸ï¼Œè€Œæ˜¯ä¸€å€‹æ¶ˆè²»è€…ï¼Œ èª¿ç”¨æ–¹æ³•ä¹Ÿè®Šæˆäº†</p><p>thenAcceptï¼š</p><p><code>static</code> <code>void</code> <code>thenAcceptExample() {</code></p><p><code>StringBuilder result = </code><code>new</code> <code>StringBuilder();</code></p><p><code>CompletableFuture.completedFuture(</code><code>"thenAccept message"</code><code>)</code></p><p><code>.thenAccept(s -> result.append(s));</code></p><p><code>assertTrue(</code><code>"Result was empty"</code><code>, result.length() > </code><code>0</code><code>);</code></p><p><code>}</code></p><p>æœ¬ä¾‹ä¸­æ¶ˆè²»è€…åŒæ­¥åœ°åŸ·è¡Œï¼Œæ‰€ä»¥æˆ‘å€‘ä¸éœ€è¦åœ¨CompletableFutureèª¿ç”¨</p><p>join</p><p>æ–¹æ³•ã€‚</p><p>7ã€ç•°æ­¥åœ°æ¶ˆè²»é·ç§»éšæ®µçš„çµæœ</p><p>åŒæ¨£ï¼Œå¯ä»¥ä½¿ç”¨</p><p>thenAcceptAsync</p><p>æ–¹æ³•ï¼Œ ä¸²è¯çš„CompletableFutureå¯ä»¥ç•°æ­¥åœ°åŸ·è¡Œã€‚</p><p><code>static</code> <code>void</code> <code>thenAcceptAsyncExample() {</code></p><p><code>StringBuilder result = </code><code>new</code> <code>StringBuilder();</code></p><p><code>CompletableFuture cf = CompletableFuture.completedFuture(</code><code>"thenAcceptAsync message"</code><code>)</code></p><p><code>.thenAcceptAsync(s -> result.append(s));</code></p><p><code>cf.join();</code></p><p><code>assertTrue(</code><code>"Result was empty"</code><code>, result.length() > </code><code>0</code><code>);</code></p><p><code>}</code></p><p>8ã€å®Œæˆè¨ˆç®—ç•°å¸¸</p><p>ç¾åœ¨æˆ‘å€‘ä¾†çœ‹ä¸€ä¸‹ç•°æ­¥æ“ä½œå¦‚ä½•é¡¯å¼åœ°è¿”å›ç•°å¸¸ï¼Œç”¨ä¾†æŒ‡ç¤ºè¨ˆç®—å¤±æ•—ã€‚æˆ‘å€‘ç°¡åŒ–é€™å€‹ä¾‹å­ï¼Œæ“ä½œè™•ç†ä¸€å€‹å­—ç¬¦ä¸²ï¼ŒæŠŠå®ƒè½‰æ›æˆç­”è¬ï¼Œæˆ‘å€‘æ¨¡æ“¬å»¶é²ä¸€ç§’ã€‚</p><p>æˆ‘å€‘ä½¿ç”¨</p><p>thenApplyAsync(Function, Executor)</p><p>æ–¹æ³•ï¼Œç¬¬ä¸€å€‹åƒæ•¸å‚³å…¥å¤§å¯«å‡½æ•¸ï¼Œ executoræ˜¯ä¸€å€‹delayed executor,åœ¨åŸ·è¡Œå‰æœƒå»¶é²ä¸€ç§’ã€‚</p><p><code>static</code> <code>void</code> <code>completeExceptionallyExample() {</code></p><p><code>CompletableFuture cf = CompletableFuture.completedFuture(</code><code>"message"</code><code>).thenApplyAsync(String::toUpperCase,</code></p><p><code>CompletableFuture.delayedExecutor(</code><code>1</code><code>, TimeUnit.SECONDS));</code></p><p><code>CompletableFuture exceptionHandler = cf.handle((s, th) -> { </code><code>return</code> <code>(th != </code><code>null</code><code>) ? </code><code>"message upon cancel"</code> <code>: </code><code>""</code><code>; });</code></p><p><code>cf.completeExceptionally(</code><code>new</code> <code>RuntimeException(</code><code>"completed exceptionally"</code><code>));</code></p><p><code>assertTrue(</code><code>"Was not completed exceptionally"</code><code>, cf.isCompletedExceptionally());</code></p><p><code>try</code> <code>{</code></p><p><code>cf.join();</code></p><p><code>fail(</code><code>"Should have thrown an exception"</code><code>);</code></p><p><code>} </code><code>catch</code><code>(CompletionException ex) { </code><code>// just for testing</code></p><p><code>assertEquals(</code><code>"completed exceptionally"</code><code>, ex.getCause().getMessage());</code></p><p><code>}</code></p><p><code>assertEquals(</code><code>"message upon cancel"</code><code>, exceptionHandler.join());</code></p><p><code>}</code></p><p>è®“æˆ‘å€‘çœ‹ä¸€ä¸‹ç´°ç¯€ã€‚</p><p>é¦–å…ˆæˆ‘å€‘å‰µå»ºäº†ä¸€å€‹CompletableFuture, å®Œæˆå¾Œè¿”å›ä¸€å€‹å­—ç¬¦ä¸²</p><p>message</p><p>,æ¥è‘—æˆ‘å€‘èª¿ç”¨</p><p>thenApplyAsync</p><p>æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€å€‹CompletableFutureã€‚é€™å€‹æ–¹æ³•åœ¨ç¬¬ä¸€å€‹å‡½æ•¸å®Œæˆå¾Œï¼Œç•°æ­¥åœ°æ‡‰ç”¨è½‰å¤§å¯«å­—æ¯å‡½æ•¸ã€‚</p><p>é€™å€‹ä¾‹å­é‚„æ¼”ç¤ºç­å¦‚ä½•é€šé</p><p>delayedExecutor(timeout, timeUnit)</p><p>å»¶é²åŸ·è¡Œä¸€å€‹ç•°æ­¥ä»»å‹™ã€‚</p><p>æˆ‘å€‘å‰µå»ºäº†ä¸€å€‹åˆ†é›¢çš„</p><p>handler</p><p>éšæ®µï¼š exceptionHandlerï¼Œ å®ƒè™•ç†ç•°å¸¸ç•°å¸¸ï¼Œåœ¨ç•°å¸¸æƒ…æ³ä¸‹è¿”å›</p><p>message upon cancel</p><p>ã€‚</p><p>ä¸‹ä¸€æ­¥æˆ‘å€‘é¡¯å¼åœ°ç”¨ç•°å¸¸å®Œæˆç¬¬äºŒå€‹éšæ®µã€‚ åœ¨éšæ®µä¸Šèª¿ç”¨</p><p>join</p><p>æ–¹æ³•ï¼Œå®ƒæœƒåŸ·è¡Œå¤§å¯«è½‰æ›ï¼Œç„¶å¾Œæ‹‹å‡ºCompletionExceptionï¼ˆæ­£å¸¸çš„joinæœƒç­‰å¾…1ç§’ï¼Œç„¶å¾Œå¾—åˆ°å¤§å¯«çš„å­—ç¬¦ä¸²ã€‚ä¸éæˆ‘å€‘çš„ä¾‹å­é‚„æ²’ç­‰å®ƒåŸ·è¡Œå°±å®Œæˆäº†ç•°å¸¸ï¼‰ï¼Œ ç„¶å¾Œå®ƒè§¸ç™¼äº†handleréšæ®µã€‚</p><p>9ã€å–æ¶ˆè¨ˆç®—</p><p>å’Œå®Œæˆç•°å¸¸é¡ä¼¼ï¼Œæˆ‘å€‘å¯ä»¥èª¿ç”¨</p><p>cancel(boolean mayInterruptIfRunning)</p><p>å–æ¶ˆè¨ˆç®—ã€‚å°æ–¼CompletableFutureé¡ï¼Œå¸ƒçˆ¾åƒæ•¸ä¸¦æ²’æœ‰è¢«ä½¿ç”¨ï¼Œé€™æ˜¯å› ç‚ºå®ƒä¸¦æ²’æœ‰ä½¿ç”¨ä¸­æ–·å»å–æ¶ˆæ“ä½œï¼Œç›¸åï¼Œ</p><p>cancel</p><p>ç­‰åƒ¹æ–¼</p><p>completeExceptionally(new CancellationException())</p><p>ã€‚</p><p><code>static</code> <code>void</code> <code>cancelExample() {</code></p><p><code>CompletableFuture cf = CompletableFuture.completedFuture(</code><code>"message"</code><code>).thenApplyAsync(String::toUpperCase,</code></p><p><code>CompletableFuture.delayedExecutor(</code><code>1</code><code>, TimeUnit.SECONDS));</code></p><p><code>CompletableFuture cf2 = cf.exceptionally(throwable -> </code><code>"canceled message"</code><code>);</code></p><p><code>assertTrue(</code><code>"Was not canceled"</code><code>, cf.cancel(</code><code>true</code><code>));</code></p><p><code>assertTrue(</code><code>"Was not completed exceptionally"</code><code>, cf.isCompletedExceptionally());</code></p><p><code>assertEquals(</code><code>"canceled message"</code><code>, cf2.join());</code></p><p><code>}</code></p><p>10ã€åœ¨å…©å€‹å®Œæˆçš„éšæ®µå…¶ä¸­ä¹‹ä¸€ä¸Šæ‡‰ç”¨å‡½æ•¸</p><p>ä¸‹é¢çš„ä¾‹å­å‰µå»ºäº†</p><p>CompletableFuture</p><p>,</p><p>applyToEither</p><p>è™•ç†å…©å€‹éšæ®µï¼Œ åœ¨å…¶ä¸­ä¹‹ä¸€ä¸Šæ‡‰ç”¨å‡½æ•¸(åŒ…ä¿è­‰å“ªä¸€å€‹è¢«åŸ·è¡Œ)ã€‚ æœ¬ä¾‹ä¸­çš„å…©å€‹éšæ®µä¸€å€‹æ˜¯æ‡‰ç”¨å¤§å¯«è½‰æ›åœ¨åŸå§‹çš„å­—ç¬¦ä¸²ä¸Šï¼Œ å¦ä¸€å€‹éšæ®µæ˜¯æ‡‰ç”¨å°äº›è½‰æ›ã€‚</p><p><code>static</code> <code>void</code> <code>applyToEitherExample() {</code></p><p><code>String original = </code><code>"Message"</code><code>;</code></p><p><code>CompletableFuture cf1 = CompletableFuture.completedFuture(original)</code></p><p><code>.thenApplyAsync(s -> delayedUpperCase(s));</code></p><p><code>CompletableFuture cf2 = cf1.applyToEither(</code></p><p><code>CompletableFuture.completedFuture(original).thenApplyAsync(s -> delayedLowerCase(s)),</code></p><p><code>s -> s + </code><code>" from applyToEither"</code><code>);</code></p><p><code>assertTrue(cf2.join().endsWith(</code><code>" from applyToEither"</code><code>));</code></p><p><code>}</code></p><p>11ã€åœ¨å…©å€‹å®Œæˆçš„éšæ®µå…¶ä¸­ä¹‹ä¸€ä¸Šèª¿ç”¨æ¶ˆè²»å‡½æ•¸</p><p>å’Œå‰ä¸€å€‹ä¾‹å­å¾ˆé¡ä¼¼äº†ï¼Œåªä¸éæˆ‘å€‘èª¿ç”¨çš„æ˜¯æ¶ˆè²»è€…å‡½æ•¸ (Functionè®ŠæˆConsumer):</p><p><code>static</code> <code>void</code> <code>acceptEitherExample() {</code></p><p><code>String original = </code><code>"Message"</code><code>;</code></p><p><code>StringBuilder result = </code><code>new</code> <code>StringBuilder();</code></p><p><code>CompletableFuture cf = CompletableFuture.completedFuture(original)</code></p><p><code>.thenApplyAsync(s -> delayedUpperCase(s))</code></p><p><code>.acceptEither(CompletableFuture.completedFuture(original).thenApplyAsync(s -> delayedLowerCase(s)),</code></p><p><code>s -> result.append(s).append(</code><code>"acceptEither"</code><code>));</code></p><p><code>cf.join();</code></p><p><code>assertTrue(</code><code>"Result was empty"</code><code>, result.toString().endsWith(</code><code>"acceptEither"</code><code>));</code></p><p><code>}</code></p><p>12ã€åœ¨å…©å€‹éšæ®µéƒ½åŸ·è¡Œå®Œå¾Œé‹è¡Œä¸€å€‹</p><p>Runnable</p><p>é€™å€‹ä¾‹å­æ¼”ç¤ºäº†ä¾è³´çš„CompletableFutureå¦‚æœç­‰å¾…å…©å€‹éšæ®µå®Œæˆå¾ŒåŸ·è¡Œäº†ä¸€å€‹Runnableã€‚ æ³¨æ„ä¸‹é¢æ‰€æœ‰çš„éšæ®µéƒ½æ˜¯åŒæ­¥åŸ·è¡Œçš„ï¼Œç¬¬ä¸€å€‹éšæ®µåŸ·è¡Œå¤§å¯«è½‰æ›ï¼Œç¬¬äºŒå€‹éšæ®µåŸ·è¡Œå°å¯«è½‰æ›ã€‚</p><p><code>static</code> <code>void</code> <code>runAfterBothExample() {</code></p><p><code>String original = </code><code>"Message"</code><code>;</code></p><p><code>StringBuilder result = </code><code>new</code> <code>StringBuilder();</code></p><p><code>CompletableFuture.completedFuture(original).thenApply(String::toUpperCase).runAfterBoth(</code></p><p><code>CompletableFuture.completedFuture(original).thenApply(String::toLowerCase),</code></p><p><code>() -> result.append(</code><code>"done"</code><code>));</code></p><p><code>assertTrue(</code><code>"Result was empty"</code><code>, result.length() > </code><code>0</code><code>);</code></p><p><code>}</code></p><p>13ã€ ä½¿ç”¨BiConsumerè™•ç†å…©å€‹éšæ®µçš„çµæœ</p><p>ä¸Šé¢çš„ä¾‹å­é‚„å¯ä»¥é€šéBiConsumerä¾†å¯¦ç¾:</p><p><code>static</code> <code>void</code> <code>thenAcceptBothExample() {</code></p><p><code>String original = </code><code>"Message"</code><code>;</code></p><p><code>StringBuilder result = </code><code>new</code> <code>StringBuilder();</code></p><p><code>CompletableFuture.completedFuture(original).thenApply(String::toUpperCase).thenAcceptBoth(</code></p><p><code>CompletableFuture.completedFuture(original).thenApply(String::toLowerCase),</code></p><p><code>(s1, s2) -> result.append(s1 + s2));</code></p><p><code>assertEquals(</code><code>"MESSAGEmessage"</code><code>, result.toString());</code></p><p><code>}</code></p><p>14ã€ä½¿ç”¨BiFunctionè™•ç†å…©å€‹éšæ®µçš„çµæœ</p><p>å¦‚æœCompletableFutureä¾è³´å…©å€‹å‰é¢éšæ®µçš„çµæœï¼Œ å®ƒè¤‡åˆå…©å€‹éšæ®µçš„çµæœå†è¿”å›ä¸€å€‹çµæœï¼Œæˆ‘å€‘å°±å¯ä»¥ä½¿ç”¨</p><p>thenCombine()</p><p>å‡½æ•¸ã€‚æ•´å€‹æµæ°´ç·šæ˜¯åŒæ­¥çš„ï¼Œæ‰€ä»¥</p><p>getNow()</p><p>æœƒå¾—åˆ°æœ€çµ‚çš„çµæœï¼Œå®ƒæŠŠå¤§å¯«å’Œå°å¯«å­—ç¬¦ä¸²é€£æ¥èµ·ä¾†ã€‚</p><p><code>static</code> <code>void</code> <code>thenCombineExample() {</code></p><p><code>String original = </code><code>"Message"</code><code>;</code></p><p><code>CompletableFuture cf = CompletableFuture.completedFuture(original).thenApply(s -> delayedUpperCase(s))</code></p><p><code>.thenCombine(CompletableFuture.completedFuture(original).thenApply(s -> delayedLowerCase(s)),</code></p><p><code>(s1, s2) -> s1 + s2);</code></p><p><code>assertEquals(</code><code>"MESSAGEmessage"</code><code>, cf.getNow(</code><code>null</code><code>));</code></p><p><code>}</code></p><p>15ã€ç•°æ­¥ä½¿ç”¨BiFunctionè™•ç†å…©å€‹éšæ®µçš„çµæœ</p><p>é¡ä¼¼ä¸Šé¢çš„ä¾‹å­ï¼Œä½†æ˜¯æœ‰ä¸€é»ä¸åŒï¼š ä¾è³´çš„å‰å…©å€‹éšæ®µç•°æ­¥åœ°åŸ·è¡Œï¼Œæ‰€ä»¥</p><p>thenCombine()</p><p>ä¹Ÿç•°æ­¥åœ°åŸ·è¡Œï¼Œå³æ™‚å®ƒæ²’æœ‰</p><p>Async</p><p>å¾Œç¶´ã€‚</p><p>Javadocä¸­æœ‰è¨»é‡‹ï¼š</p><blockquote><p>Actions supplied for dependent completions of non-async methods may be performed by the thread that completes the current CompletableFuture, or by any other caller of a completion method</p></blockquote><p>æ‰€ä»¥æˆ‘å€‘éœ€è¦</p><p>join</p><p>æ–¹æ³•ç­‰å¾…çµæœçš„å®Œæˆã€‚</p><p><code>static</code> <code>void</code> <code>thenCombineAsyncExample() {</code></p><p><code>String original = </code><code>"Message"</code><code>;</code></p><p><code>CompletableFuture cf = CompletableFuture.completedFuture(original)</code></p><p><code>.thenApplyAsync(s -> delayedUpperCase(s))</code></p><p><code>.thenCombine(CompletableFuture.completedFuture(original).thenApplyAsync(s -> delayedLowerCase(s)),</code></p><p><code>(s1, s2) -> s1 + s2);</code></p><p><code>assertEquals(</code><code>"MESSAGEmessage"</code><code>, cf.join());</code></p><p><code>}</code></p><p>16ã€çµ„åˆ CompletableFuture</p><p>æˆ‘å€‘å¯ä»¥ä½¿ç”¨</p><p>thenCompose()</p><p>å®Œæˆä¸Šé¢å…©å€‹ä¾‹å­ã€‚é€™å€‹æ–¹æ³•ç­‰å¾…ç¬¬ä¸€å€‹éšæ®µçš„å®Œæˆ(å¤§å¯«è½‰æ›)ï¼Œ å®ƒçš„çµæœå‚³çµ¦ä¸€å€‹æŒ‡å®šçš„è¿”å›CompletableFutureå‡½æ•¸ï¼Œå®ƒçš„çµæœå°±æ˜¯è¿”å›çš„CompletableFutureçš„çµæœã€‚</p><p>æœ‰é»æ‹—å£ï¼Œä½†æ˜¯æˆ‘å€‘çœ‹ä¾‹å­ä¾†ç†è§£ã€‚å‡½æ•¸éœ€è¦ä¸€å€‹å¤§å¯«å­—ç¬¦ä¸²åšåƒæ•¸ï¼Œç„¶å¾Œè¿”å›ä¸€å€‹CompletableFuture, é€™å€‹CompletableFutureæœƒè½‰æ›å­—ç¬¦ä¸²è®Šæˆå°å¯«ç„¶å¾Œé€£æ¥åœ¨å¤§å¯«å­—ç¬¦ä¸²çš„å¾Œé¢ã€‚</p><p><code>static</code> <code>void</code> <code>thenComposeExample() {</code></p><p><code>String original = </code><code>"Message"</code><code>;</code></p><p><code>CompletableFuture cf = CompletableFuture.completedFuture(original).thenApply(s -> delayedUpperCase(s))</code></p><p><code>.thenCompose(upper -> CompletableFuture.completedFuture(original).thenApply(s -> delayedLowerCase(s))</code></p><p><code>.thenApply(s -> upper + s));</code></p><p><code>assertEquals(</code><code>"MESSAGEmessage"</code><code>, cf.join());</code></p><p><code>}</code></p><p>17ã€ç•¶å¹¾å€‹éšæ®µä¸­çš„ä¸€å€‹å®Œæˆï¼Œå‰µå»ºä¸€å€‹å®Œæˆçš„éšæ®µ</p><p>ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†ç•¶ä»»æ„ä¸€å€‹CompletableFutureå®Œæˆå¾Œï¼Œ å‰µå»ºä¸€å€‹å®Œæˆçš„CompletableFuture.</p><p>å¾…è™•ç†çš„éšæ®µé¦–å…ˆå‰µå»ºï¼Œ æ¯å€‹éšæ®µéƒ½æ˜¯è½‰æ›ä¸€å€‹å­—ç¬¦ä¸²ç‚ºå¤§å¯«ã€‚å› ç‚ºæœ¬ä¾‹ä¸­é€™äº›éšæ®µéƒ½æ˜¯åŒæ­¥åœ°åŸ·è¡Œ(thenApply), å¾</p><p>anyOf</p><p>ä¸­å‰µå»ºçš„CompletableFutureæœƒç«‹å³å®Œæˆï¼Œé€™æ¨£æ‰€æœ‰çš„éšæ®µéƒ½å·²å®Œæˆï¼Œæˆ‘å€‘ä½¿ç”¨</p><p>whenComplete(BiConsumer&lt;? super Object, ? super Throwable> action)</p><p>è™•ç†å®Œæˆçš„çµæœã€‚</p><p><span>static</span></p><p><code>void</code> <code>anyOfExample() {</code></p><p><code>StringBuilder result = </code><code>new</code> <code>StringBuilder();</code></p><p><code>List messages = Arrays.asList(</code><code>"a"</code><code>, </code><code>"b"</code><code>, </code><code>"c"</code><code>);</code></p><p><code>List&lt;CompletableFuture> futures = messages.stream()</code></p><p><code>.map(msg -> CompletableFuture.completedFuture(msg).thenApply(s -> delayedUpperCase(s)))</code></p><p><code>.collect(Collectors.toList());</code></p><p><code>CompletableFuture.anyOf(futures.toArray(</code><code>new</code><code>CompletableFuture[futures.size()])).whenComplete((res, th) -> {</code></p><p><code>if</code><code>(th == </code><code>null</code><code>) {</code></p><p><code>assertTrue(isUpperCase((String) res));</code></p><p><code>result.append(res);</code></p><p><code>}</code></p><p><code>});</code></p><p><code>assertTrue(</code><code>"Result was empty"</code><code>, result.length() > </code><code>0</code><code>);</code></p><p><code>}</code></p><p>18ã€ç•¶æ‰€æœ‰çš„éšæ®µéƒ½å®Œæˆå¾Œå‰µå»ºä¸€å€‹éšæ®µ</p><p>ä¸Šä¸€å€‹ä¾‹å­æ˜¯ç•¶ä»»æ„ä¸€å€‹éšæ®µå®Œæˆå¾Œæ¥è‘—è™•ç†ï¼Œæ¥ä¸‹ä¾†çš„å…©å€‹ä¾‹å­æ¼”ç¤ºç•¶æ‰€æœ‰çš„éšæ®µå®Œæˆå¾Œæ‰ç¹¼çºŒè™•ç†, åŒæ­¥åœ°æ–¹å¼å’Œç•°æ­¥åœ°æ–¹å¼å…©ç¨®ã€‚</p><p><code>static</code> <code>void</code> <code>allOfExample() {</code></p><p><code>StringBuilder result = </code><code>new</code> <code>StringBuilder();</code></p><p><code>List messages = Arrays.asList(</code><code>"a"</code><code>, </code><code>"b"</code><code>, </code><code>"c"</code><code>);</code></p><p><code>List&lt;CompletableFuture> futures = messages.stream()</code></p><p><code>.map(msg -> CompletableFuture.completedFuture(msg).thenApply(s -> delayedUpperCase(s)))</code></p><p><code>.collect(Collectors.toList());</code></p><p><code>CompletableFuture.allOf(futures.toArray(</code><code>new</code><code>CompletableFuture[futures.size()])).whenComplete((v, th) -> {</code></p><p><code>futures.forEach(cf -> assertTrue(isUpperCase(cf.getNow(</code><code>null</code><code>))));</code></p><p><code>result.append(</code><code>"done"</code><code>);</code></p><p><code>});</code></p><p><code>ass</code></p><p>19ã€ç•¶æ‰€æœ‰çš„éšæ®µéƒ½å®Œæˆå¾Œç•°æ­¥åœ°å‰µå»ºä¸€å€‹éšæ®µ</p><p>ä½¿ç”¨</p><p>thenApplyAsync()</p><p>æ›¿æ›é‚£äº›å–®å€‹çš„CompletableFuturesçš„æ–¹æ³•ï¼Œ</p><p>allOf()</p><p>æœƒåœ¨é€šç”¨æ± ä¸­çš„ç·šç¨‹ä¸­ç•°æ­¥åœ°åŸ·è¡Œã€‚æ‰€ä»¥æˆ‘å€‘éœ€è¦èª¿ç”¨</p><p>join</p><p>æ–¹æ³•ç­‰å¾…å®ƒå®Œæˆã€‚</p><p><code>static</code> <code>void</code> <code>allOfAsyncExample() {</code></p><p><code>StringBuilder result = </code><code>new</code> <code>StringBuilder();</code></p><p><code>List messages = Arrays.asList(</code><code>"a"</code><code>, </code><code>"b"</code><code>, </code><code>"c"</code><code>);</code></p><p><code>List&lt;CompletableFuture> futures = messages.stream()</code></p><p><code>.map(msg -> CompletableFuture.completedFuture(msg).thenApplyAsync(s -> delayedUpperCase(s)))</code></p><p><code>.collect(Collectors.toList());</code></p><p><code>CompletableFuture allOf = CompletableFuture.allOf(futures.toArray(</code><code>new</code><code>CompletableFuture[futures.size()]))</code></p><p><code>.whenComplete((v, th) -> {</code></p><p><code>futures.forEach(cf -> assertTrue(isUpperCase(cf.getNow(</code><code>null</code><code>))));</code></p><p><code>result.append(</code><code>"done"</code><code>);</code></p><p><code>});</code></p><p><code>allOf.join();</code></p><p><code>assertTrue(</code><code>"Result was empty"</code><code>, result.length() > </code><code>0</code><code>);</code></p><p><code>}</code></p><p>20ã€çœŸå¯¦çš„ä¾‹å­</p><p>Now that the functionality of CompletionStage and specifically CompletableFuture is explored, the below example applies them in a practical scenario:</p><p>ç¾åœ¨ä½ å·²ç¶“ç­è§£äº†CompletionStage å’Œ CompletableFuture çš„ä¸€äº›å‡½æ•¸çš„åŠŸèƒ½ï¼Œä¸‹é¢çš„ä¾‹å­æ˜¯ä¸€å€‹å¯¦è¸å ´æ™¯ï¼š</p><ul class=list-paddingleft-2><li><p>é¦–å…ˆç•°æ­¥èª¿ç”¨</p><p>cars</p><p>æ–¹æ³•ç²å¾—Carçš„åˆ—è¡¨ï¼Œå®ƒè¿”å›CompletionStageå ´æ™¯ã€‚</p><p>cars</p><p>æ¶ˆè²»ä¸€å€‹é ç¨‹çš„REST APIã€‚</p></li><li><p>ç„¶å¾Œæˆ‘å€‘è¤‡åˆä¸€å€‹CompletionStageå¡«å¯«æ¯å€‹æ±½è»Šçš„è©•åˆ†ï¼Œé€šé</p><p>rating(manufacturerId)</p><p>è¿”å›ä¸€å€‹CompletionStage, å®ƒæœƒç•°æ­¥åœ°ç²å–æ±½è»Šçš„è©•åˆ†(å¯èƒ½åˆæ˜¯ä¸€å€‹REST APIèª¿ç”¨)</p></li><li><p>ç•¶æ‰€æœ‰çš„æ±½è»Šå¡«å¥½è©•åˆ†å¾Œï¼Œæˆ‘å€‘çµæŸé€™å€‹åˆ—è¡¨ï¼Œæ‰€ä»¥æˆ‘å€‘èª¿ç”¨</p><p>allOf</p><p>å¾—åˆ°æœ€çµ‚çš„éšæ®µï¼Œ å®ƒåœ¨å‰é¢éšæ®µæ‰€æœ‰éšæ®µå®Œæˆå¾Œæ‰å®Œæˆã€‚</p></li><li><p>åœ¨æœ€çµ‚çš„éšæ®µèª¿ç”¨</p><p>whenComplete()</p><p>,æˆ‘å€‘æ‰“å°å‡ºæ¯å€‹æ±½è»Šå’Œå®ƒçš„è©•åˆ†ã€‚</p></li></ul><p><code>cars().thenCompose(cars -> {</code></p><p><code>List&lt;CompletionStage> updatedCars = cars.stream()</code></p><p><code>.map(car -> rating(car.manufacturerId).thenApply(r -> {</code></p><p><code>car.setRating(r);</code></p><p><code>return</code> <code>car;</code></p><p><code>})).collect(Collectors.toList());</code></p><p><code>CompletableFuture done = CompletableFuture</code></p><p><code>.allOf(updatedCars.toArray(</code><code>new</code> <code>CompletableFuture[updatedCars.size()]));</code></p><p><code>return</code> <code>done.thenApply(v -> updatedCars.stream().map(CompletionStage::toCompletableFuture)</code></p><p><code>.map(CompletableFuture::join).collect(Collectors.toList()));</code></p><p><code>}).whenComplete((cars, th) -> {</code></p><p><code>if</code> <code>(th == </code><code>null</code><code>) {</code></p><p><code>cars.forEach(System.out::println);</code></p><p><code>} </code><code>else</code> <code>{</code></p><p><code>throw</code> <code>new</code> <code>RuntimeException(th);</code></p><p><code>}</code></p><p><code>}).toCompletableFuture().join();</code></p><p>å› ç‚ºæ¯å€‹æ±½è»Šçš„å¯¦ä¾‹éƒ½æ˜¯ç¨ç«‹çš„ï¼Œå¾—åˆ°æ¯å€‹æ±½è»Šçš„è©•åˆ†éƒ½å¯ä»¥ç•°æ­¥åœ°åŸ·è¡Œï¼Œé€™æœƒæé«˜ç³»çµ±çš„æ€§èƒ½(å»¶é²)ï¼Œè€Œä¸”ï¼Œç­‰å¾…æ‰€æœ‰çš„æ±½è»Šè©•åˆ†è¢«è™•ç†ä½¿ç”¨çš„æ˜¯</p><p>allOf</p><p>æ–¹æ³•ï¼Œè€Œä¸æ˜¯æ‰‹å·¥çš„ç·šç¨‹ç­‰å¾…(Thread#join() æˆ– a CountDownLatch)ã€‚</p><p>é€™äº›ä¾‹å­å¯ä»¥å¹«åŠ©ä½ æ›´å¥½çš„ç†è§£ç›¸é—œçš„API,ä½ å¯ä»¥åœ¨githubä¸Šå¾—åˆ°æ‰€æœ‰çš„ä¾‹å­çš„ä»£ç¢¼ã€‚</p><p><strong>#JAVAä»£ç¢¼æŸ¥éŒ¯#</strong></p><p>æ­¤è™•ï¼ŒSomethingé¡çš„æ–‡ä»¶åå«OtherThing.java</p><p>class Something {</p><p>private static void main(String[] something_to_do) {</p><p>System.out.println("Do something ...");</p><p>}é€™å€‹å¥½åƒå¾ˆæ˜é¡¯ã€‚</p><p>ç­”æ¡ˆ: æ­£ç¢ºã€‚å¾ä¾†æ²’æœ‰äººèªªéJavaçš„Classåå­—å¿…é ˆå’Œå…¶æ–‡ä»¶åç›¸åŒã€‚ä½†public classçš„åå­—å¿…é ˆå’Œæ–‡ä»¶åç›¸åŒã€‚</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>ç•°æ­¥</a></li><li><a>ç·¨ç¨‹</a></li><li><a>å¯¦ä¾‹</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/de0da135.html alt=Cèªè¨€ç·¨ç¨‹å¯¦ä¾‹3 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/870917da8c744479b2ec65ee0173974e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/de0da135.html title=Cèªè¨€ç·¨ç¨‹å¯¦ä¾‹3>Cèªè¨€ç·¨ç¨‹å¯¦ä¾‹3</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9e4e4f6f.html alt=Cèªè¨€ç·¨ç¨‹å¯¦ä¾‹4 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/870917da8c744479b2ec65ee0173974e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9e4e4f6f.html title=Cèªè¨€ç·¨ç¨‹å¯¦ä¾‹4>Cèªè¨€ç·¨ç¨‹å¯¦ä¾‹4</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a79c9f54.html alt=PLCç·¨ç¨‹å¯¦ä¾‹ï¼šè¼ªèƒç”Ÿç”¢ç·šè† æ–™å®šé•·è£æ–·ç³»çµ± class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1540519111520026554cfba style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a79c9f54.html title=PLCç·¨ç¨‹å¯¦ä¾‹ï¼šè¼ªèƒç”Ÿç”¢ç·šè† æ–™å®šé•·è£æ–·ç³»çµ±>PLCç·¨ç¨‹å¯¦ä¾‹ï¼šè¼ªèƒç”Ÿç”¢ç·šè† æ–™å®šé•·è£æ–·ç³»çµ±</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fd08b19.html alt=ç•°æ­¥ç·¨ç¨‹ï¼šå”ä½œæ€§å¤šä»»å‹™è™•ç† class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/dbd0ddd7-eda4-430a-8176-da9804319771 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fd08b19.html title=ç•°æ­¥ç·¨ç¨‹ï¼šå”ä½œæ€§å¤šä»»å‹™è™•ç†>ç•°æ­¥ç·¨ç¨‹ï¼šå”ä½œæ€§å¤šä»»å‹™è™•ç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f74b39f.html alt="Java ç•°æ­¥ç·¨ç¨‹å°è«–" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3c356b1aa9b4416ca7b35a07f3033e13 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f74b39f.html title="Java ç•°æ­¥ç·¨ç¨‹å°è«–">Java ç•°æ­¥ç·¨ç¨‹å°è«–</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4cb74cd.html alt="Springç•°æ­¥ç·¨ç¨‹ | ä½ çš„@Asyncå°±çœŸçš„ç•°æ­¥å—ï¼Ÿç•°æ­¥æ­·éšªå¥‡é‡è¨˜" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b9d102263d0f46a0b5b203d7b6cd4a2e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4cb74cd.html title="Springç•°æ­¥ç·¨ç¨‹ | ä½ çš„@Asyncå°±çœŸçš„ç•°æ­¥å—ï¼Ÿç•°æ­¥æ­·éšªå¥‡é‡è¨˜">Springç•°æ­¥ç·¨ç¨‹ | ä½ çš„@Asyncå°±çœŸçš„ç•°æ­¥å—ï¼Ÿç•°æ­¥æ­·éšªå¥‡é‡è¨˜</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/852c87e.html alt="æœ‰äº† CompletableFutureï¼Œä½¿å¾—ç•°æ­¥ç·¨ç¨‹æ²’æœ‰é‚£éº¼é›£äº†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/e66a7bcfded64b34b43ebc1565b3e557 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/852c87e.html title="æœ‰äº† CompletableFutureï¼Œä½¿å¾—ç•°æ­¥ç·¨ç¨‹æ²’æœ‰é‚£éº¼é›£äº†">æœ‰äº† CompletableFutureï¼Œä½¿å¾—ç•°æ­¥ç·¨ç¨‹æ²’æœ‰é‚£éº¼é›£äº†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/30f9fa0.html alt=PLCç·¨ç¨‹å¯¦ä¾‹åˆ†äº«ï¼Œå¤šåœ–è©³è§£äº”å±¤æ¨“é›»æ¢¯æ§åˆ¶ç³»çµ± class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/2c064b69bd3d423b91745e8515206015 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/30f9fa0.html title=PLCç·¨ç¨‹å¯¦ä¾‹åˆ†äº«ï¼Œå¤šåœ–è©³è§£äº”å±¤æ¨“é›»æ¢¯æ§åˆ¶ç³»çµ±>PLCç·¨ç¨‹å¯¦ä¾‹åˆ†äº«ï¼Œå¤šåœ–è©³è§£äº”å±¤æ¨“é›»æ¢¯æ§åˆ¶ç³»çµ±</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3e8c3b8.html alt=è©³è§£ç·¨ç¨‹ä¸­çš„åŒæ­¥å’Œç•°æ­¥ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b292fb03b256422bb94215ce3ec3bbaf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3e8c3b8.html title=è©³è§£ç·¨ç¨‹ä¸­çš„åŒæ­¥å’Œç•°æ­¥>è©³è§£ç·¨ç¨‹ä¸­çš„åŒæ­¥å’Œç•°æ­¥</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/73e9cdf.html alt="æ‡¶è±¬ç·¨ç¨‹å¯¦ä¾‹å…­ï¼šVisual C# å¯¦ç¾å¤–éƒ¨æ–‡ä»¶çš„è®€å–å’Œå¯«å…¥" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d5f53cdfe53844a8bb683368239078a2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/73e9cdf.html title="æ‡¶è±¬ç·¨ç¨‹å¯¦ä¾‹å…­ï¼šVisual C# å¯¦ç¾å¤–éƒ¨æ–‡ä»¶çš„è®€å–å’Œå¯«å…¥">æ‡¶è±¬ç·¨ç¨‹å¯¦ä¾‹å…­ï¼šVisual C# å¯¦ç¾å¤–éƒ¨æ–‡ä»¶çš„è®€å–å’Œå¯«å…¥</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6196842.html alt=ç·¨ç¨‹ï½œå¯¦ä¾‹ï¼ˆåˆ†æ›¸å•é¡Œï¼‰ç­è§£æ•¸æ“šçµæ§‹ã€ç®—æ³•ï¼ˆçª®èˆ‰ã€éæ­¸ã€å›æº¯ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/22cf0000774f33967078 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6196842.html title=ç·¨ç¨‹ï½œå¯¦ä¾‹ï¼ˆåˆ†æ›¸å•é¡Œï¼‰ç­è§£æ•¸æ“šçµæ§‹ã€ç®—æ³•ï¼ˆçª®èˆ‰ã€éæ­¸ã€å›æº¯ï¼‰>ç·¨ç¨‹ï½œå¯¦ä¾‹ï¼ˆåˆ†æ›¸å•é¡Œï¼‰ç­è§£æ•¸æ“šçµæ§‹ã€ç®—æ³•ï¼ˆçª®èˆ‰ã€éæ­¸ã€å›æº¯ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c81ec36.html alt=ç•°æ­¥ç·¨ç¨‹æå‡æœå‹™æ€§èƒ½ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/15260210063976700d35c2d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c81ec36.html title=ç•°æ­¥ç·¨ç¨‹æå‡æœå‹™æ€§èƒ½>ç•°æ­¥ç·¨ç¨‹æå‡æœå‹™æ€§èƒ½</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/996f20ec.html alt=å°ç·šå¹³å·®å¯¦ä¾‹ï¼ˆäºŒï¼‰ï¼šåš´å¯†å¹³å·® class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/15386218640160e23eb81d8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/996f20ec.html title=å°ç·šå¹³å·®å¯¦ä¾‹ï¼ˆäºŒï¼‰ï¼šåš´å¯†å¹³å·®>å°ç·šå¹³å·®å¯¦ä¾‹ï¼ˆäºŒï¼‰ï¼šåš´å¯†å¹³å·®</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9cfcdd6f.html alt=ã€ŠJAVAç·¨ç¨‹æ€æƒ³ã€‹5åˆ†é˜é€Ÿæˆï¼šç¬¬8ç« ï¼ˆå¤šæ…‹ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/399a29d93fde48fca4bae44dffbced07 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9cfcdd6f.html title=ã€ŠJAVAç·¨ç¨‹æ€æƒ³ã€‹5åˆ†é˜é€Ÿæˆï¼šç¬¬8ç« ï¼ˆå¤šæ…‹ï¼‰>ã€ŠJAVAç·¨ç¨‹æ€æƒ³ã€‹5åˆ†é˜é€Ÿæˆï¼šç¬¬8ç« ï¼ˆå¤šæ…‹ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/638efe2f.html alt=å¯¦ä¾‹åˆ†æï¼šäº”å€‹å®¶åº­çš„é¤Šè€é‡‘å·®è·ï¼å¼•äººæ·±æ€ï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3a3959acde314dd0a2a932cdd7e4a618 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/638efe2f.html title=å¯¦ä¾‹åˆ†æï¼šäº”å€‹å®¶åº­çš„é¤Šè€é‡‘å·®è·ï¼å¼•äººæ·±æ€ï¼>å¯¦ä¾‹åˆ†æï¼šäº”å€‹å®¶åº­çš„é¤Šè€é‡‘å·®è·ï¼å¼•äººæ·±æ€ï¼</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>