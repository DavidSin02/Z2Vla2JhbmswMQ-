<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ | æå®¢å¿«è¨Š</title><meta property="og:title" content="èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/b4554f16bed74f61ad7cc35a9bd92154"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ab05587.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ab05587.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3ab05587.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ab05587.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ab05587.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3ab05587.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3ab05587.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ab05587.html><meta property="article:published_time" content="2020-11-14T21:01:36+08:00"><meta property="article:modified_time" content="2020-11-14T21:01:36+08:00"><meta name=Keywords content><meta name=description content="èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/3ab05587.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b4554f16bed74f61ad7cc35a9bd92154><p class=pgc-img-caption></p></div><p class=ql-align-justify>ä½œè€…ï¼šVictor Zhou</p><p class=ql-align-justify>ç¿»è­¯ï¼šç‹é›¨æ¡</p><p class=ql-align-justify>æ ¡å°ï¼šå³é‡‘è¿ª</p><p class=ql-align-justify>æœ¬æ–‡ç´„<strong>3800å­—</strong>ï¼Œå»ºè­°é–±è®€15åˆ†é˜ã€‚</p><p class=ql-align-justify>æœ¬æ–‡å°‡ä»‹ç´¹æœ€åŸºç¤çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡ï¼ˆVanilla RNNsï¼‰çš„æ¦‚æ³ï¼Œå·¥ä½œåŸç†ï¼Œä»¥åŠå¦‚ä½•åœ¨Pythonä¸­å¯¦ç¾ã€‚</p><p class=ql-align-justify>å¾ªç’°ç¥ç¶“ç¶²çµ¡ï¼ˆRNNï¼‰æ˜¯ä¸€ç¨®å°ˆé–€è™•ç†åºåˆ—çš„ç¥ç¶“ç¶²çµ¡ã€‚ç”±æ–¼åœ¨è™•ç†æ–‡æœ¬æ™‚ååˆ†é«˜æ•ˆï¼Œå®ƒç¶“å¸¸ç”¨æ–¼è‡ªç„¶èªè¨€è™•ç†(NLP)ã€‚åœ¨æ¥ä¸‹ä¾†çš„æ–‡ç« ä¸­ï¼Œæˆ‘å€‘å°‡æ¢è¨RNNæ˜¯ä»€éº¼ï¼Œç­è§£å®ƒçš„å·¥ä½œåŸç†ï¼Œä¸¦ä½¿ç”¨Pythonå¾é›¶é–‹å§‹æ§‹å»ºä¸€å€‹çœŸæ­£çš„RNNï¼ˆåƒ…ä½¿ç”¨numpyï¼‰ã€‚</p><p class=ql-align-justify>åœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»‹ç´¹äº†ä¸€äº›ç¥ç¶“ç¶²çµ¡çš„åŸºæœ¬çŸ¥è­˜ã€‚æœ¬æ–‡å°åŸºç¤éƒ¨åˆ†ä¸åšéå¤šä»‹ç´¹ï¼Œå¦‚æœ‰éœ€è¦ï¼Œå»ºè­°å…ˆé–±è®€åŸºç¤æ–‡ç« ã€‚</p><p class=ql-align-justify>é™„éˆæ¥ï¼š</p><p class=ql-align-justify>https://victorzhou.com/blog/intro-to-neural-networks/</p><p class=ql-align-justify>è®“æˆ‘å€‘é–‹å§‹å§ï¼</p><p class=ql-align-justify><strong>1. ç‚ºä»€éº¼è¦ç”¨RNNs?</strong></p><p class=ql-align-justify>é—œæ–¼åŸå§‹çš„ç¥ç¶“ç¶²çµ¡ï¼ˆåŒæ¨£å°æ–¼CNNsï¼‰çš„ä¸€å€‹å•é¡Œæ˜¯å®ƒå€‘åªèƒ½ä½¿ç”¨é å®šå¤§å°çš„è¼¸å…¥å’Œè¼¸å‡ºï¼šå®ƒå€‘æ¡ç”¨å›ºå®šå¤§å°çš„è¼¸å…¥ä¸¦ç”Ÿæˆå›ºå®šå¤§å°çš„è¼¸å‡ºã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒRNNså¯ä»¥å°‡å¯è®Šé•·åº¦åºåˆ—ä½œç‚ºè¼¸å…¥å’Œè¼¸å‡ºã€‚ä»¥ä¸‹æ˜¯RNNçš„ç¤ºä¾‹ï¼š</p><p class=ql-align-justify></p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/39008dd8c44a4284bf0ee932ae7630c1><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-center>ç´…è‰²ç‚ºè¼¸å…¥ï¼Œç¶ è‰²ç‚ºRNNæœ¬èº«ï¼Œè—è‰²ç‚ºè¼¸å‡ºã€‚ä¾†æºï¼šAndrej Karpathy</p><p class=ql-align-justify>é€™ç¨®è™•ç†åºåˆ—çš„èƒ½åŠ›ä½¿RNNè¡¨ç¾å„ªç•°ã€‚ä¾‹å¦‚ï¼š</p><ul><li class=ql-align-justify>æ©Ÿå™¨ç¿»è­¯ï¼ˆä¾‹å¦‚Googleç¿»è­¯ï¼‰ä½¿ç”¨â€œå¤šå°å¤šâ€RNNã€‚åŸå§‹æ–‡æœ¬åºåˆ—è¢«é€å…¥RNNï¼Œéš¨å¾ŒRNNå°‡ç¿»è­¯çš„æ–‡æœ¬ä½œç‚ºè¼¸å‡ºã€‚</li><li class=ql-align-justify>æƒ…æ„Ÿåˆ†æï¼ˆä¾‹å¦‚ï¼Œé€™æ˜¯ä¸€å€‹ç©æ¥µçš„é‚„æ˜¯è² é¢çš„è©•è«–ï¼Ÿï¼‰é€šå¸¸æ˜¯ä½¿ç”¨â€œå¤šå°ä¸€â€RNNã€‚å°‡è¦åˆ†æçš„æ–‡æœ¬é€å…¥RNNï¼Œç„¶å¾ŒRNNç”¢ç”Ÿå–®å€‹è¼¸å‡ºåˆ†é¡ï¼ˆä¾‹å¦‚ï¼Œé€™æ˜¯ä¸€å€‹ç©æ¥µçš„è©•è«–ï¼‰ã€‚</li></ul><p class=ql-align-justify>åœ¨æœ¬æ–‡å¾Œé¢ï¼Œæˆ‘å€‘å°‡å¾é›¶é–‹å§‹æ§‹å»ºâ€œå¤šå°ä¸€â€RNNï¼Œä¸¦å®ŒæˆåŸºæœ¬çš„æƒ…æ„Ÿåˆ†æã€‚</p><p class=ql-align-justify><strong>2. å¦‚ä½•ä½¿ç”¨RNNs</strong></p><p class=ql-align-justify>è®“æˆ‘å€‘ä¾†çœ‹çœ‹â€œå¤šå°å¤šâ€RNNå§ï¼</p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5d012a4a16164ce49e1e3f73fc91f195><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5a95e60f52204c29bd048e09bd58e23a><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><ol><li class=ql-align-justify>åŸºæ–¼ä¹‹å‰çš„éš±è—ç‹€æ…‹å’Œä¸‹ä¸€å€‹è¼¸å…¥ï¼Œæˆ‘å€‘å¯ä»¥å¾—åˆ°ä¸‹ä¸€å€‹éš±è—ç‹€æ…‹ã€‚</li><li class=ql-align-justify>é€šéè¨ˆç®—, æˆ‘å€‘å¯ä»¥å¾—åˆ°ä¸‹ä¸€å€‹è¼¸å‡º ã€‚</li></ol><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/726a90ff59bd4714810755a61d671341><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-center>å¤šå°å¤š RNN</p><p class=ql-align-justify>é€™å°±æ˜¯ä½¿RNNå¾ªç’°çš„éç¨‹ï¼šæ¯ä¸€æ­¥éƒ½æœƒä½¿ç”¨ç›¸åŒçš„æ¬Šé‡ã€‚ æ›´å…·é«”åœ°èªªï¼Œå…¸å‹çš„åŸå§‹RNNåƒ…ä½¿ç”¨3çµ„æ¬Šé‡å°±èƒ½å®Œæˆè¨ˆç®—ï¼š</p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c0c735105cf84822a817035c0bff279e><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify>æ­¤å¤–ï¼Œ æˆ‘å€‘é‚„è¦åœ¨RNNä¸­å¼•å…¥å…©å€‹åç§»é‡ï¼š</p><p class=ql-align-justify>æˆ‘å€‘ç”¨çŸ©é™£è¡¨ç¤ºæ¬Šé‡ï¼Œç”¨å‘é‡è¡¨ç¤ºåå·®ã€‚é€™3å€‹æ¬Šé‡å’Œ2å€‹åå·®å°±æ§‹æˆäº†æ•´å€‹RNNï¼</p><p class=ql-align-justify>ä»¥ä¸‹æ˜¯å°‡æ‰€æœ‰å…§å®¹çµ„åˆåœ¨ä¸€èµ·çš„å…¬å¼ï¼š</p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2ff73edfcaca4a359c0267ca8231ffab><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>ä¸è¦ç•¥éé€™äº›æ–¹ç¨‹å¼ã€‚ åœä¸‹ä¾†ä¸€åˆ†é˜çœ‹çœ‹å®ƒã€‚ å¦å¤–ï¼Œè¦æ™‚åˆ»ç‰¢è¨˜æ¬Šé‡æ˜¯çŸ©é™£ï¼Œå…¶ä»–è®Šé‡æ˜¯å‘é‡ã€‚</p><p class=ql-align-justify>æˆ‘å€‘åœ¨çŸ©é™£ä¹˜æ³•ä¸­æ‡‰ç”¨æ‰€æœ‰çš„æ¬Šé‡ï¼Œä¸¦å°‡åå·®æ·»åŠ åˆ°æ‰€å¾—çµæœä¸­ã€‚ç„¶å¾Œæˆ‘å€‘å°‡tanhä½œç‚ºç¬¬ä¸€å€‹ç­‰å¼çš„æ¿€æ´»å‡½æ•¸ï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ¿€æ´»ï¼Œå¦‚sigmoidï¼‰ã€‚</p><p class=ql-align-justify><strong>3. å•é¡Œ</strong></p><p class=ql-align-justify>æ¥ä¸‹ä¾†æˆ‘å€‘å°‡å¾é›¶é–‹å§‹æ‡‰ç”¨RNNä¾†åŸ·è¡Œç°¡å–®çš„æƒ…æ„Ÿåˆ†æä»»å‹™ï¼šç¢ºå®šçµ¦å®šçš„æ–‡æœ¬çš„æƒ…æ„Ÿæ˜¯æ­£å‘çš„é‚„æ˜¯è² å‘çš„ã€‚</p><p class=ql-align-justify>ä»¥ä¸‹æ˜¯æˆ‘ç‚ºæœ¬æ–‡æ•´ç†çš„æ•¸æ“šé›†ä¸­çš„ä¸€äº›ç¤ºä¾‹ï¼š</p><p class=ql-align-justify>é™„æ•¸æ“šé›†éˆæ¥ï¼š</p><p class=ql-align-justify>https://github.com/vzhou842/rnn-from-scratch/blob/master/data.py</p><p class=ql-align-justify></p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/598b612ed3fb434eaf198dd9e7c1d94b><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify><strong>4. è¨ˆåŠƒ</strong></p><p class=ql-align-justify>ç”±æ–¼é€™æ˜¯ä¸€å€‹åˆ†é¡å•é¡Œï¼Œæˆ‘å€‘å°‡ä½¿ç”¨â€œå¤šå°ä¸€â€RNNã€‚é€™å’Œæˆ‘å€‘ä¹‹å‰è¨è«–éçš„â€œå¤šå°å¤šâ€RNNé¡ä¼¼ï¼Œä½†ä¸åŒçš„æ˜¯å®ƒåªä½¿ç”¨æœ€çµ‚éš±è—ç‹€æ…‹è¼¸å‡ºä¸€å€‹yï¼š</p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d4b8424e273348c88360d90142a476d6><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-center>å¤šå°ä¸€ RNN</p><p class=ql-align-justify>æ¯å€‹éƒ½æ˜¯ä¸€å€‹è¡¨ç¤ºæ–‡æœ¬ä¸­å–®è©çš„å‘é‡ã€‚è¼¸å‡ºçš„yå‘é‡å°‡åŒ…å«å…©å€‹æ•¸å­—ï¼Œä¸€å€‹è¡¨ç¤ºç©æ¥µæ…‹åº¦ï¼Œå¦ä¸€å€‹è¡¨ç¤ºæ¶ˆæ¥µæ…‹åº¦ã€‚æˆ‘å€‘å°‡æ‡‰ç”¨Softmaxå°‡é€™äº›å€¼è½‰æ›ç‚ºæ¦‚ç‡ï¼Œä¸¦æœ€çµ‚åœ¨ç©æ¥µ/æ¶ˆæ¥µä¹‹é–“åšå‡ºæ±ºå®šã€‚</p><p class=ql-align-justify>è®“æˆ‘å€‘é–‹å§‹å¯¦ç¾RNNå§ï¼</p><p class=ql-align-justify><strong>5. é è™•ç†</strong></p><p class=ql-align-justify>å‰æ–‡æåˆ°çš„æ•¸æ“šé›†ç”±å…©éƒ¨åˆ†çµ„æˆã€‚</p><pre class=ql-align-justify>data.pytrain_data = { 'good': True, 'bad': False, # ... more data} test_data = { 'this is happy': True, 'i am good': True, # ... more data}True=ç©æ¥µï¼ŒFalse=æ¶ˆæ¥µ</pre><p class=ql-align-justify>æˆ‘å€‘å¿…é ˆé€²è¡Œä¸€äº›é è™•ç†æ‰èƒ½å°‡æ•¸æ“šè½‰æ›ç‚ºå¯ç”¨çš„æ ¼å¼ã€‚é¦–å…ˆï¼Œæˆ‘å€‘æ§‹å»ºè©å½™è¡¨ï¼Œç”¨ä¾†å­˜æ”¾æ•¸æ“šä¸­å‡ºç¾çš„è©å½™ï¼š</p><pre class=ql-align-justify>main.pyfrom data import train_data, test_data # Create the vocabulary.vocab = list(set([w for text in train_data.keys() for w in text.split(' ')]))vocab_size = len(vocab)print('%d unique words found' % vocab_size) # 18 unique words found</pre><p class=ql-align-justify>ç¾åœ¨ï¼Œvocabé€™å€‹åˆ—è¡¨ä¸­åŒ…å«äº†æ‰€æœ‰çš„å–®è©ï¼Œé€™è£¡æ˜¯æŒ‡è‡³å°‘åœ¨ä¸€å€‹è¨“ç·´æ¨£æœ¬ä¸­å‡ºç¾çš„å–®è©ã€‚æ¥ä¸‹ä¾†ï¼Œç‚ºäº†è¡¨ç¤ºè©å½™è¡¨ä¸­çš„æ¯å€‹å–®è©ï¼Œæˆ‘å€‘å°‡è¨­å®šä¸€å€‹æ•´æ•¸ç´¢å¼•ã€‚</p><pre class=ql-align-justify>main.py# Assign indices to each word.word_to_idx = { w: i for i, w in enumerate(vocab) }idx_to_word = { i: w for i, w in enumerate(vocab) }print(word_to_idx['good']) # 16 (this may change)print(idx_to_word[0]) # sad (this may change)</pre><p class=ql-align-justify>æˆ‘å€‘ç¾åœ¨å¯ä»¥ç”¨ç›¸æ‡‰çš„æ•´æ•¸ç´¢å¼•è¡¨ç¤ºä»»ä½•çµ¦å®šçš„å–®è©ï¼é€™æ˜¯å¿…è¦çš„æ­¥é©Ÿï¼Œå› ç‚ºRNNç„¡æ³•ç†è§£å–®è©ï¼Œæ‰€ä»¥æˆ‘å€‘å¿…é ˆçµ¦å®ƒè¼¸å…¥æ•¸å­—ã€‚</p><p class=ql-align-justify>æœ€å¾Œï¼Œå›æƒ³ä¸€ä¸‹RNNçš„æ¯å€‹è¼¸å…¥æ˜¯ä¸€å€‹å‘é‡ã€‚æˆ‘å€‘å°‡ä½¿ç”¨ç¨ç†±ç·¨ç¢¼ï¼Œå…¶ä¸­åŒ…å«é™¤äº†å–®å€‹ä¸€ä¹‹å¤–çš„æ‰€æœ‰é›¶ã€‚æ¯å€‹ç¨ç†±å‘é‡ä¸­çš„â€œ1â€å°‡ä½æ–¼å–®è©çš„ç›¸æ‡‰æ•´æ•¸ç´¢å¼•è™•ã€‚</p><p class=ql-align-justify>ç”±æ–¼æˆ‘å€‘çš„è©å½™è¡¨ä¸­æœ‰18å€‹å”¯ä¸€çš„å–®è©ï¼Œæ¯å€‹å°‡æ˜¯ä¸€å€‹18ç¶­çš„å–®ç†±çŸ¢é‡ã€‚</p><pre class=ql-align-justify>main.pyimport numpy as np def createInputs(text): ''' Returns an array of one-hot vectors representing the words in the input text string. - text is a string - Each one-hot vector has shape (vocab_size, 1) ''' inputs = [] for w in text.split(' '): v = np.zeros((vocab_size, 1)) v[word_to_idx[w]] = 1 inputs.append(v) return inputs</pre><p class=ql-align-justify>éš¨å¾Œï¼Œæˆ‘å€‘å°‡ç”¨createInputsï¼ˆï¼‰ä¾†ç”Ÿæˆè¼¸å…¥å‘é‡ï¼Œä¸¦å‚³å…¥åˆ°RNNä¸­ã€‚</p><p class=ql-align-justify><strong>6. å‘å‰å‚³æ’­éšæ®µ</strong></p><p class=ql-align-justify>æ˜¯æ™‚å€™é–‹å§‹å¯¦ç¾æˆ‘å€‘çš„RNNäº†ï¼æˆ‘å€‘é¦–å…ˆå°‡åˆå§‹åŒ–RNNéœ€è¦çš„3å€‹æ¬Šé‡å’Œ2å€‹åç§»é‡ï¼š</p><pre class=ql-align-justify>rnn.pyimport numpy as npfrom numpy.random import randn class RNN: # A Vanilla Recurrent Neural Network.  def __init__(self, input_size, output_size, hidden_size=64): # Weights self.Whh = randn(hidden_size, hidden_size) / 1000 self.Wxh = randn(hidden_size, input_size) / 1000 self.Why = randn(output_size, hidden_size) / 1000  # Biases self.bh = np.zeros((hidden_size, 1)) self.by = np.zeros((output_size, 1))</pre><p class=ql-align-justify>æ³¨æ„ï¼šæˆ‘å€‘é™¤ä»¥1000ä»¥æ¸›å°‘æ¬Šé‡çš„åˆå§‹æ–¹å·®ã€‚å„˜ç®¡é€™ä¸æ˜¯åˆå§‹åŒ–æ¬Šé‡çš„æœ€ä½³æ–¹æ³•ï¼Œä½†å®ƒå¾ˆç›´è§€ï¼Œé©ç”¨æ–¼é€™ç¯‡æ–‡ç« ã€‚</p><p class=ql-align-justify>æˆ‘å€‘ä½¿ç”¨np.random.randnï¼ˆï¼‰ï¼ŒåŸºæ–¼æ¨™æº–æ­£æ…‹åˆ†ä½ˆåˆå§‹åŒ–æ¬Šé‡ã€‚</p><p class=ql-align-justify>æ¥ä¸‹ä¾†ï¼Œè®“æˆ‘å€‘å¯¦ç¾RNNå‰å‘å‚³æ’­ã€‚ é‚„è¨˜å¾—æˆ‘å€‘ä¹‹å‰çœ‹åˆ°çš„é€™å…©å€‹æ–¹ç¨‹å—?</p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9673d7c35e234318ad42304ae8c9683e><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>ä»¥ä¸‹æ˜¯åœ¨ä»£ç¢¼ä¸­çš„å¯¦ç¾ï¼š</p><pre class=ql-align-justify>rnn.pyclass RNN: # ...  def forward(self, inputs): ''' Perform a forward pass of the RNN using the given inputs. Returns the final output and hidden state. - inputs is an array of one hot vectors with shape (input_size, 1). ''' h = np.zeros((self.Whh.shape[0], 1))  # Perform each step of the RNN for i, x in enumerate(inputs): h = np.tanh(self.Wxh @ x + self.Whh @ h + self.bh)  # Compute the output y = self.Why @ h + self.by  return y, h</pre><p class=ql-align-justify></p><p class=ql-align-justify>é€™å¾ˆç°¡å–®å§ï¼Ÿ è«‹æ³¨æ„ï¼Œå› ç‚ºæ²’æœ‰ä¹‹å‰çš„hå¯ä»¥ä½¿ç”¨ï¼Œæˆ‘å€‘åœ¨ç¬¬ä¸€æ­¥ä¸­å°‡håˆå§‹åŒ–ç‚ºé›¶å‘é‡ã€‚</p><p class=ql-align-justify>è®“æˆ‘å€‘ä¾†è©¦è©¦å§ï¼š</p><pre class=ql-align-justify>main.py# ... def softmax(xs): # Applies the Softmax Function to the input array. return np.exp(xs) / sum(np.exp(xs)) # Initialize our RNN!rnn = RNN(vocab_size, 2) inputs = createInputs('i am very good')out, h = rnn.forward(inputs)probs = softmax(out)print(probs) # [[0.50000095], [0.49999905]]</pre><p class=ql-align-justify>å¦‚æœéœ€è¦è¤‡ç¿’Softmaxç›¸é—œçŸ¥è­˜ï¼Œå¯ä»¥é€šééˆæ¥é–±è®€ç›¸é—œçš„å¿«é€Ÿè§£é‡‹ã€‚</p><p class=ql-align-justify>é™„éˆæ¥ï¼š</p><p class=ql-align-justify>https://victorzhou.com/blog/softmax/</p><p class=ql-align-justify>æˆ‘å€‘çš„RNNå¯ä»¥æˆåŠŸé‹è¡Œï¼Œä½†å®ƒçœ‹èµ·ä¾†ä¸æ˜¯å¾ˆæœ‰ç”¨ã€‚ çœ‹ä¾†æˆ‘å€‘å¾—ä½œå‡ºä¸€äº›æ”¹è®Š......</p><p class=ql-align-justify><strong>7. åé¥‹éšæ®µ</strong></p><p class=ql-align-justify>ç‚ºäº†è¨“ç·´RNNï¼Œé¦–å…ˆæˆ‘å€‘éœ€è¦ä¸€å€‹æå¤±å‡½æ•¸ã€‚æˆ‘å€‘å°‡ä½¿ç”¨äº¤å‰ç†µæå¤±å‡½æ•¸ï¼Œå®ƒé€šå¸¸èˆ‡Softmaxçµåˆã€‚ è¨ˆç®—å…¬å¼å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c23f0bbb55a7402fa9b59e2b56c1d419><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a142d7dfe7eb4e77a350206c92e8b0a4><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/85903da4a2994065a288efda25173e86><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>ç¾åœ¨æˆ‘å€‘æœ‰äº†æå¤±å‡½æ•¸ï¼Œæˆ‘å€‘å°‡ä½¿ç”¨æ¢¯åº¦ä¸‹é™ä¾†è¨“ç·´RNNæ¨¡å‹ï¼Œä»¥å„˜é‡æ¸›å°‘æå¤±ã€‚ é€™æ„å‘³è‘—æˆ‘å€‘ç¾åœ¨è¦åšä¸€äº›æ¢¯åº¦ç›¸é—œçš„è¨ˆç®—ï¼</p><p class=ql-align-justify>ä»¥ä¸‹éƒ¨åˆ†éœ€è¦ä¸€äº›å¤šè®Šé‡å¾®ç©åˆ†çš„åŸºæœ¬çŸ¥è­˜ï¼Œä½ å¯ä»¥é¸æ“‡è·³éé€™éƒ¨åˆ†ã€‚å³ä½¿ä½ ä¸å¤ªç­è§£ï¼Œæˆ‘ä¹Ÿå»ºè­°ä½ å¤§æ¦‚ç€è¦½ä¸€ä¸‹ã€‚æ¨å°å‡ºçµæœå¾Œï¼Œæˆ‘å€‘å°‡é€æ­¥å®Œæˆä»£ç¢¼ï¼Œæ·ºå±¤æ¬¡çš„ç†è§£ä¹Ÿæœƒæœ‰æ‰€å¹«åŠ©ã€‚</p><p class=ql-align-justify>å¦‚æœæƒ³è¦æ·±å…¥ç­è§£æœ¬ç¯€ï¼Œå¯ä»¥é–±è®€æˆ‘åœ¨â€œç¥ç¶“ç¶²çµ¡ä»‹ç´¹â€ä¸€æ–‡ä¸­çš„â€œè¨“ç·´ç¥ç¶“ç¶²çµ¡â€éƒ¨åˆ†ã€‚ æ­¤å¤–ï¼Œæœ¬æ–‡çš„æ‰€æœ‰ä»£ç¢¼éƒ½åœ¨Githubä¸Šï¼Œä½ ä¹Ÿå¯ä»¥åœ¨Githubä¸Šé—œæ³¨æˆ‘ã€‚</p><p class=ql-align-justify>é™„Githubéˆæ¥ï¼š</p><p class=ql-align-justify>https://github.com/vzhou842/rnn-from-scratch</p><p class=ql-align-justify><strong>7.1å®šç¾©</strong></p><p class=ql-align-justify>é¦–å…ˆï¼Œæˆ‘å€‘è¦æ˜ç¢ºä¸€äº›å®šç¾©ï¼š</p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4dcf72c26932453fa4d8f8176a0bb807><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><strong>7.2 æº–å‚™</strong></p><p class=ql-align-justify>æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘éœ€è¦ç·¨è¼¯å‘å‰å‚³æ’­éšæ®µä¸¦ç·©å­˜ä¸€äº›æ•¸æ“šï¼Œä»¥ä¾¿åœ¨åé¥‹éšæ®µä½¿ç”¨ã€‚åœ¨æˆ‘å€‘è™•ç†å®ƒçš„åŒæ™‚ï¼Œæˆ‘å€‘é‚„å°‡ç‚ºæˆ‘å€‘çš„åé¥‹éšæ®µè¨­ç½®æ¡†æ¶ã€‚å¤§è‡´å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class=ql-align-justify>rnn.pyclass RNN: # ...  def forward(self, inputs): ''' Perform a forward pass of the RNN using the given inputs. Returns the final output and hidden state. - inputs is an array of one hot vectors with shape (input_size, 1). ''' h = np.zeros((self.Whh.shape[0], 1))  self.last_inputs = inputs self.last_hs = { 0: h } # Perform each step of the RNN for i, x in enumerate(inputs): h = np.tanh(self.Wxh @ x + self.Whh @ h + self.bh) self.last_hs[i + 1] = h # Compute the output y = self.Why @ h + self.by  return y, h  def backprop(self, d_y, learn_rate=2e-2):''' Perform a backward pass of the RNN. - d_y (dL/dy) has shape (output_size, 1). - learn_rate is a float. ''' pass</pre><p class=ql-align-justify><strong>7.3 æ¢¯åº¦</strong></p><p class=ql-align-justify>ç¾åœ¨é–‹å§‹æ˜¯æ•¸å­¸ç™»å ´çš„æ™‚å€™å•¦ï¼æˆ‘å€‘è¦é–‹å§‹è¨ˆç®—</p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e8656aa08fcf4ed3a785df089ce8d15f><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>é€šééˆå¼æ³•å‰‡è¨ˆç®—çš„éç¨‹å°±ä½œç‚ºç·´ç¿’å§ï¼Œçµæœå¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6610a11d321e46aea59280da55d1b866><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/64e6c5394ee1459c807d7327b40260f6><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><pre class=ql-align-justify>main.py# Loop over each training examplefor x, y in train_data.items(): inputs = createInputs(x) target = int(y)  # Forward out, _ = rnn.forward(inputs) probs = softmax(out)  # Build dL/dy d_L_d_y = probs d_L_d_y[target] -= 1 # Backward rnn.backprop(d_L_d_y)</pre><p class=ql-align-justify>æ¥ä¸‹ä¾†ï¼Œè®“æˆ‘å€‘å®Œæˆå’Œçš„æ¢¯åº¦è¨ˆç®—ï¼Œé€™åƒ…ç”¨æ–¼å°‡æœ€çµ‚éš±è—ç‹€æ…‹è½‰æ›ç‚ºRNNçš„è¼¸å‡ºã€‚ æˆ‘å€‘æœ‰ï¼š</p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c4630bfcedea4ea5b98ed3a0adcd367e><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>æ˜¯æœ€çµ‚çš„éš±è—ç‹€æ…‹ã€‚å› æ­¤ï¼Œ</p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/258eb18514514300b33fb40039dedda3><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify>åŒæ¨£çš„ï¼Œ</p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/158b93f866f743dfab89d5c77d33f5e6><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>æˆ‘å€‘ç¾åœ¨å¯ä»¥é–‹å§‹æ‡‰ç”¨backpropï¼ˆï¼‰ï¼</p><pre class=ql-align-justify>rnn.pyclass RNN: # ...  def backprop(self, d_y, learn_rate=2e-2): ''' Perform a backward pass of the RNN. - d_y (dL/dy) has shape (output_size, 1). - learn_rate is a float. ''' n = len(self.last_inputs)  # Calculate dL/dWhy and dL/dby.d_Why = d_y @ self.last_hs[n].T d_by = d_y</pre><p class=ql-align-justify>æç¤ºï¼šæˆ‘å€‘ä¹‹å‰åœ¨forwardï¼ˆï¼‰ä¸­å‰µå»ºäº†self.last_hsã€‚</p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c81850133da148aaab981c92a9f03c31><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/afb8337efc014c368d19ab6ee83e72bd><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>å› ç‚ºæ”¹è®Šå°‡å½±éŸ¿æ¯ä¸€å€‹ï¼Œé€™ä¸€åˆ‡éƒ½æœƒå½±éŸ¿yå’Œæœ€çµ‚Lã€‚ç‚ºäº†è¨ˆç®—çš„æ¢¯åº¦, æˆ‘å€‘éœ€è¦æ‰€æœ‰æ™‚é–“æ­¥é•·çš„åå‘å‚³æ’­ï¼Œé€™ç¨±ç‚ºåå‘å‚³æ’­æ™‚é–“ï¼ˆBPTTï¼‰ï¼š</p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a113ecd4ea9e42e5913993d09a41539e><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/aa759978510e4839ab7f608178c12669><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><pre class=ql-align-justify>rnn.pyclass RNN: # â€¦  def backprop(self, d_y, learn_rate=2e-2):â€˜â€™â€™Perform a backward pass of the RNN.- d_y (dL/dy) has shape (output_size, 1).- learn_rate is a float.â€˜â€™â€™n = len(self.last_inputs) # Calculate dL/dWhy and dL/dby.D_Why = d_y @ self.last_hs[n].Td_by = d_y # Initialize dL/dWhh, dL/dWxh, and dL/dbh to zero.D_Whh = np.zeros(self.Whh.shape)d_Wxh = np.zeros(self.Wxh.shape)d_bh = np.zeros(self.bh.shape) # Calculate dL/dh for the last h.d_h = self.Why.T @ d_y # Backpropagate through time.For t in reversed(range(n)): # An intermediate value: dL/dh * (1 â€“ h^2) temp = ((1 â€“ self.last_hs[t + 1] ** 2) * d_h)  # dL/db = dL/dh * (1 â€“ h^2) d_bh += temp # dL/dWhh = dL/dh * (1 â€“ h^2) * h_{t-1} d_Whh += temp @ self.last_hs[t].T # dL/dWxh = dL/dh * (1 â€“ h^2) * x d_Wxh += temp @ self.last_inputs[t].T # Next dL/dh = dL/dh * (1 â€“ h^2) * Whh d_h = self.Whh @ temp # Clip to prevent exploding gradients.For d in [d_Wxh, d_Whh, d_Why, d_bh, d_by]: np.clip(d, -1, 1, out=d) # Update weights and biases using gradient descent.Self.Whh -= learn_rate * d_Whhself.Wxh -= learn_rate * d_Wxhself.Why -= learn_rate * d_Whyself.bh -= learn_rate * d_bhself.by -= learn_rate * d_by</pre><p class=ql-align-justify>è£œå……ä¸€äº›æ³¨æ„äº‹é …ï¼š</p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4919e750049140fd83b3b807bcbbe5ab><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>å¥½å•¦ï¼æˆ‘å€‘çš„RNNå·²ç¶“å®Œæˆå•¦ã€‚</p><p class=ql-align-justify><strong>8. é«˜æ½®</strong></p><p class=ql-align-justify>çµ‚æ–¼ç­‰åˆ°äº†é€™ä¸€åˆ» - è®“æˆ‘å€‘æ¸¬è©¦RNNå§ï¼</p><p class=ql-align-justify>é¦–å…ˆï¼Œæˆ‘å€‘å°‡ç·¨å¯«ä¸€å€‹å¹«åŠ©å‡½æ•¸ä¾†è™•ç†RNNçš„æ•¸æ“šï¼š</p><pre class=ql-align-justify>main.pyimport random def processData(data, backprop=True): ''' Returns the RNN's loss and accuracy for the given data. - data is a dictionary mapping text to True or False. - backprop determines if the backward phase should be run. ''' items = list(data.items()) random.shuffle(items)  loss = 0 num_correct = 0  for x, y in items: inputs = createInputs(x) target = int(y)  # Forward out, _ = rnn.forward(inputs) probs = softmax(out)  # Calculate loss / accuracy loss -= np.log(probs[target]) num_correct += int(np.argmax(probs) == target)  if backprop: # Build dL/dy d_L_d_y = probs d_L_d_y[target] -= 1  # Backward rnn.backprop(d_L_d_y)  return loss / len(data), num_correct / len(data)ç¾åœ¨ï¼Œæˆ‘å€‘å¯ä»¥å®Œæˆä¸€å€‹è¨“ç·´çš„å¾ªç’°ï¼šmain.py# Training loopfor epoch in range(1000): train_loss, train_acc = processData(train_data)  if epoch % 100 == 99: print('--- Epoch %d' % (epoch + 1)) print('Train:\tLoss %.3f | Accuracy: %.3f' % (train_loss, train_acc))  test_loss, test_acc = processData(test_data, backprop=False) print('Test:\tLoss %.3f | Accuracy: %.3f' % (test_loss, test_acc))</pre><p class=ql-align-justify>é‹è¡Œ main.pyæ‡‰è©²æœƒå¾—åˆ°å¦‚ä¸‹è¼¸å‡ºï¼š</p><pre class=ql-align-justify>--- Epoch 100Train: Loss 0.688 | Accuracy: 0.517Test: Loss 0.700 | Accuracy: 0.500--- Epoch 200Train: Loss 0.680 | Accuracy: 0.552Test: Loss 0.717 | Accuracy: 0.450--- Epoch 300Train: Loss 0.593 | Accuracy: 0.655Test: Loss 0.657 | Accuracy: 0.650--- Epoch 400Train: Loss 0.401 | Accuracy: 0.810Test: Loss 0.689 | Accuracy: 0.650--- Epoch 500Train: Loss 0.312 | Accuracy: 0.862Test: Loss 0.693 | Accuracy: 0.550--- Epoch 600Train: Loss 0.148 | Accuracy: 0.914Test: Loss 0.404 | Accuracy: 0.800--- Epoch 700Train: Loss 0.008 | Accuracy: 1.000Test: Loss 0.016 | Accuracy: 1.000--- Epoch 800Train: Loss 0.004 | Accuracy: 1.000Test: Loss 0.007 | Accuracy: 1.000--- Epoch 900Train: Loss 0.002 | Accuracy: 1.000Test: Loss 0.004 | Accuracy: 1.000--- Epoch 1000Train: Loss 0.002 | Accuracy: 1.000Test: Loss 0.003 | Accuracy: 1.000</pre><p class=ql-align-justify>æˆ‘å€‘è‡ªå·±è£½é€ çš„RNNä¹Ÿä¸éŒ¯ã€‚</p><p class=ql-align-justify>æƒ³è¦ªè‡ªå˜—è©¦æˆ–ä¿®è£œé€™äº›ä»£ç¢¼ï¼Ÿä½ ä¹Ÿå¯ä»¥åœ¨Githubä¸Šæ‰¾åˆ°ã€‚</p><p class=ql-align-justify>é™„éˆæ¥ï¼š</p><p class=ql-align-justify>https://github.com/vzhou842/rnn-from-scratch</p><p class=ql-align-justify><strong>9. ç¸½çµ</strong></p><p class=ql-align-justify>æœ¬æ–‡ä¸­ï¼Œæˆ‘å€‘å®Œæˆäº†è¿´æ­¸ç¥ç¶“ç¶²çµ¡çš„æ¼”ç·´ï¼ŒåŒ…æ‹¬å®ƒå€‘æ˜¯ä»€éº¼ï¼Œå®ƒå€‘å¦‚ä½•å·¥ä½œï¼Œç‚ºä»€éº¼å®ƒå€‘æœ‰ç”¨ï¼Œå¦‚ä½•è¨“ç·´å®ƒå€‘ä»¥åŠå¦‚ä½•å¯¦ç¾å®ƒå€‘ã€‚ä¸éï¼Œä½ é‚„å¯ä»¥åšæ›´å¤šçš„äº‹æƒ…ï¼š</p><ul><li class=ql-align-justify>ç­è§£é•·çŸ­æœŸè¨˜æ†¶ç¶²çµ¡ï¼ˆLSTMï¼‰ï¼Œé€™æ˜¯ä¸€å€‹æ›´å¼·å¤§å’Œæ›´å—æ­¡è¿çš„RNNæ¶æ§‹ï¼Œæˆ–é—œæ–¼LSTMçš„è‘—åçš„è®Šé«”--é–€æ§å¾ªç’°å–®å…ƒï¼ˆGRUï¼‰ã€‚</li><li class=ql-align-justify>é€šéæ°ç•¶çš„MLåº«ï¼ˆå¦‚Tensorflowï¼ŒKerasæˆ–PyTorchï¼‰ï¼Œä½ å¯ä»¥å˜—è©¦æ›´å¤§/æ›´å¥½çš„RNNã€‚</li><li class=ql-align-justify>ç­è§£é›™å‘RNNï¼Œå®ƒå¯ä»¥è™•ç†å‰å‘å’Œå¾Œå‘åºåˆ—ï¼Œå› æ­¤è¼¸å‡ºå±¤å¯ä»¥ç²å¾—æ›´å¤šä¿¡æ¯ã€‚</li><li class=ql-align-justify>å˜—è©¦åƒGloVeæˆ–Word2Vecé€™æ¨£çš„WordåµŒå…¥ï¼Œå¯ç”¨æ–¼å°‡å–®è©è½‰æ›ç‚ºæ›´æœ‰ç”¨çš„çŸ¢é‡è¡¨ç¤ºã€‚</li><li class=ql-align-justify>æŸ¥çœ‹è‡ªç„¶èªè¨€å·¥å…·åŒ…ï¼ˆNLTKï¼‰ï¼Œé€™æ˜¯ä¸€å€‹ç”¨æ–¼è™•ç†äººé¡èªè¨€æ•¸æ“šçš„Pythonåº«</li></ul><p class=ql-align-justify><br></p><p class=ql-align-justify>åŸæ–‡æ¨™é¡Œï¼š</p><p class=ql-align-justify>An Introduction to Recurrent Neural Networks for Beginners</p><p class=ql-align-justify>åŸæ–‡éˆæ¥ï¼š</p><p class=ql-align-justify>https://victorzhou.com/blog/intro-to-rnns/</p><p class=ql-align-right>ç·¨è¼¯ï¼šæ–¼é¨°å‡±</p><p class=ql-align-right>æ ¡å°ï¼šæ¥Šå­¸ä¿Š</p><p class=ql-align-justify><strong>è­¯è€…ç°¡ä»‹</strong></p><div class=pgc-img><img alt=èœé³¥å¿…å‚™çš„å¾ªç’°ç¥ç¶“ç¶²çµ¡æŒ‡å—ï¼ˆé™„éˆæ¥ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/73b93b6bac1f4de6babdd47b1b33bf2f><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><p class=ql-align-justify><strong>ç‹é›¨æ¡</strong>ï¼ŒUIUCçµ±è¨ˆå­¸åœ¨è®€ç¢©å£«ï¼Œæœ¬ç§‘çµ±è¨ˆå°ˆæ¥­ï¼Œç›®å‰å°ˆæ³¨æ–¼CodingæŠ€èƒ½çš„æå‡ã€‚ç†è«–åˆ°æ‡‰ç”¨çš„è½‰æ›ä¸­ï¼Œæ•¬ç•æ•¸æ“šï¼ŒæŒçºŒé€²åŒ–ã€‚</p><p class=ql-align-center><strong>â€” å®Œ â€”</strong></p><p class=ql-align-justify>é—œæ³¨æ¸…è¯-é’å³¶æ•¸æ“šç§‘å­¸ç ”ç©¶é™¢å®˜æ–¹å¾®ä¿¡å…¬çœ¾å¹³è‡ºâ€œ<strong>THUæ•¸æ“šæ´¾</strong>â€åŠå§Šå¦¹è™Ÿâ€œ<strong>æ•¸æ“šæ´¾THU</strong>â€ç²å–æ›´å¤šè¬›åº§ç¦åˆ©åŠå„ªè³ªå…§å®¹ã€‚</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>èœé³¥</a></li><li><a>å¿…å‚™</a></li><li><a>å¾ªç’°</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/f0ff6432.html alt=é‹¼çµæ§‹å¿…å‚™çŸ¥è­˜38å• class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f0ff6432.html title=é‹¼çµæ§‹å¿…å‚™çŸ¥è­˜38å•>é‹¼çµæ§‹å¿…å‚™çŸ¥è­˜38å•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bb258a5a.html alt=é‹¼çµæ§‹å¿…å‚™çŸ¥è­˜38å•ï¼Œä½ çš„æ™‰ç´šä¹‹è·¯ï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1535975955779bcac330762 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bb258a5a.html title=é‹¼çµæ§‹å¿…å‚™çŸ¥è­˜38å•ï¼Œä½ çš„æ™‰ç´šä¹‹è·¯ï¼>é‹¼çµæ§‹å¿…å‚™çŸ¥è­˜38å•ï¼Œä½ çš„æ™‰ç´šä¹‹è·¯ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/32c82df2.html alt=ç†±æ°´é‹çˆæˆ¿å¾ªç’°æ°´æ³µé¸å‹å»ºè­° class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/32c82df2.html title=ç†±æ°´é‹çˆæˆ¿å¾ªç’°æ°´æ³µé¸å‹å»ºè­°>ç†±æ°´é‹çˆæˆ¿å¾ªç’°æ°´æ³µé¸å‹å»ºè­°</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b4e33540.html alt="æ”¶è— | é€™äº›èˆªæ¸¬å¿…å‚™çš„çŸ¥è­˜é»ä½ ç­è§£å—ï¼Ÿ" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b4e33540.html title="æ”¶è— | é€™äº›èˆªæ¸¬å¿…å‚™çš„çŸ¥è­˜é»ä½ ç­è§£å—ï¼Ÿ">æ”¶è— | é€™äº›èˆªæ¸¬å¿…å‚™çš„çŸ¥è­˜é»ä½ ç­è§£å—ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/02e1ffd2.html alt=è‡¨åºŠå¿…å‚™çš„çŸ³è†å›ºå®šæŠ€è¡“ï¼Œä½ getäº†å—ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/260a4e82375e46b29f0d7e4ebc7c2a01 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/02e1ffd2.html title=è‡¨åºŠå¿…å‚™çš„çŸ³è†å›ºå®šæŠ€è¡“ï¼Œä½ getäº†å—ï¼Ÿ>è‡¨åºŠå¿…å‚™çš„çŸ³è†å›ºå®šæŠ€è¡“ï¼Œä½ getäº†å—ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/55165a07.html alt=è€é›»å·¥å¿…å‚™çš„å…­å€‹åŸºç¤é›»è·¯åœ– class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/23e99e5693c54df2955e819bb96bc0f5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/55165a07.html title=è€é›»å·¥å¿…å‚™çš„å…­å€‹åŸºç¤é›»è·¯åœ–>è€é›»å·¥å¿…å‚™çš„å…­å€‹åŸºç¤é›»è·¯åœ–</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/640ad953.html alt=é›»å·¥å¿…å‚™ï¼š22å€‹ç¶“å…¸é›»è·¯åœ–ï¼Œè€é›»å·¥ï¼šéƒ½çœ‹æ‡‚å°±å¯ä»¥å»è€ƒé«˜ç´šé›»å·¥äº† class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1537327298284fedcbce28b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/640ad953.html title=é›»å·¥å¿…å‚™ï¼š22å€‹ç¶“å…¸é›»è·¯åœ–ï¼Œè€é›»å·¥ï¼šéƒ½çœ‹æ‡‚å°±å¯ä»¥å»è€ƒé«˜ç´šé›»å·¥äº†>é›»å·¥å¿…å‚™ï¼š22å€‹ç¶“å…¸é›»è·¯åœ–ï¼Œè€é›»å·¥ï¼šéƒ½çœ‹æ‡‚å°±å¯ä»¥å»è€ƒé«˜ç´šé›»å·¥äº†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dc667d44.html alt=ä¸å¯ä¸çŸ¥ï¼æ¯å€‹æ©ŸåºŠè¡Œå®¶å¿…å‚™çš„è»¸æ‰¿é¸å‹è³‡æ–™ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/887afde1-3463-49ab-958a-3d03ef126152 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dc667d44.html title=ä¸å¯ä¸çŸ¥ï¼æ¯å€‹æ©ŸåºŠè¡Œå®¶å¿…å‚™çš„è»¸æ‰¿é¸å‹è³‡æ–™>ä¸å¯ä¸çŸ¥ï¼æ¯å€‹æ©ŸåºŠè¡Œå®¶å¿…å‚™çš„è»¸æ‰¿é¸å‹è³‡æ–™</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2c2d0ac7.html alt=å·¥ç¨‹é€ åƒ¹å¿…å‚™ï¼š16å¥—é€ åƒ¹åŸºç¤è¬›ç¾©+è¨ˆé‡è¨ˆåƒ¹+è­˜åœ–ï¼Œè¼•é¬†å­¸é€ åƒ¹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/eb9fa13af6284a158f15a13aec98fef2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2c2d0ac7.html title=å·¥ç¨‹é€ åƒ¹å¿…å‚™ï¼š16å¥—é€ åƒ¹åŸºç¤è¬›ç¾©+è¨ˆé‡è¨ˆåƒ¹+è­˜åœ–ï¼Œè¼•é¬†å­¸é€ åƒ¹>å·¥ç¨‹é€ åƒ¹å¿…å‚™ï¼š16å¥—é€ åƒ¹åŸºç¤è¬›ç¾©+è¨ˆé‡è¨ˆåƒ¹+è­˜åœ–ï¼Œè¼•é¬†å­¸é€ åƒ¹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/66d69fa2.html alt=æ‡¶äººå¿…å‚™ï¼å°ç±³æœ‰å“ä¸Šæ¶å’Œéºµæ©Ÿï¼šæ™ºèƒ½é†’é¢ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RU85Fe4Gpp7qW8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/66d69fa2.html title=æ‡¶äººå¿…å‚™ï¼å°ç±³æœ‰å“ä¸Šæ¶å’Œéºµæ©Ÿï¼šæ™ºèƒ½é†’é¢>æ‡¶äººå¿…å‚™ï¼å°ç±³æœ‰å“ä¸Šæ¶å’Œéºµæ©Ÿï¼šæ™ºèƒ½é†’é¢</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b85ef9fc.html alt=ç§‘ç ”å¿…å‚™â€œæ­¦å™¨â€ä¹‹BODåˆ†æå„€ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0574d78d5cc147668c9eefa86e773322 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b85ef9fc.html title=ç§‘ç ”å¿…å‚™â€œæ­¦å™¨â€ä¹‹BODåˆ†æå„€>ç§‘ç ”å¿…å‚™â€œæ­¦å™¨â€ä¹‹BODåˆ†æå„€</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/48532629.html alt=å¾ªç’°â½”é¤Šæ®–æŒ‡æ¨™-æº¶è§£æ°§ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/56d1472f673a48fcb736dca88bf7b39c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/48532629.html title=å¾ªç’°â½”é¤Šæ®–æŒ‡æ¨™-æº¶è§£æ°§>å¾ªç’°â½”é¤Šæ®–æŒ‡æ¨™-æº¶è§£æ°§</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1d9a5540.html alt=å¾ªç’°æµåŒ–åºŠé‹çˆè€ç£¨è€ç«ææ–™éƒ½æœ‰å“ªäº›ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/85eb71ea22e548ff81c68a4c0216f09a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1d9a5540.html title=å¾ªç’°æµåŒ–åºŠé‹çˆè€ç£¨è€ç«ææ–™éƒ½æœ‰å“ªäº›ï¼Ÿ>å¾ªç’°æµåŒ–åºŠé‹çˆè€ç£¨è€ç«ææ–™éƒ½æœ‰å“ªäº›ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f833cb1e.html alt="æŠ€è¡“ | æ·ºè«‡å¾ªç’°æµåŒ–åºŠé‹çˆå¤§ä¿®æ™‚çš„é˜²ç£¨è™•ç†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f833cb1e.html title="æŠ€è¡“ | æ·ºè«‡å¾ªç’°æµåŒ–åºŠé‹çˆå¤§ä¿®æ™‚çš„é˜²ç£¨è™•ç†">æŠ€è¡“ | æ·ºè«‡å¾ªç’°æµåŒ–åºŠé‹çˆå¤§ä¿®æ™‚çš„é˜²ç£¨è™•ç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/80eda0c9.html alt=å·¥æ¥­å¾ªç’°å†·å»æ°´è™•ç†ï¼ˆä¸‰ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a8094522823a4a4fab20b39b9c4a062c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/80eda0c9.html title=å·¥æ¥­å¾ªç’°å†·å»æ°´è™•ç†ï¼ˆä¸‰ï¼‰>å·¥æ¥­å¾ªç’°å†·å»æ°´è™•ç†ï¼ˆä¸‰ï¼‰</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>