<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 | 极客快訊</title><meta property="og:title" content="基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/15285901190965dfa7b64c2"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ae18361.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ae18361.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3ae18361.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ae18361.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ae18361.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3ae18361.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3ae18361.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ae18361.html><meta property="article:published_time" content="2020-11-14T21:04:03+08:00"><meta property="article:modified_time" content="2020-11-14T21:04:03+08:00"><meta name=Keywords content><meta name=description content="基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/3ae18361.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p><strong>一、設計的目的及意義</strong></p><p><strong>1.1、設計的現狀及背景</strong></p><p>在日常的生活和工作中, 住宅與部門的安全防範、單位的文件檔案、財務報表以及一些個人資料的保存多以加鎖的辦法來解決。若使用傳統的機械式鑰匙開鎖，人們常需攜帶多把鑰匙, 使用極不方便, 且鑰匙丟失後安全性即大打折扣。隨著科學技術的不斷髮展，人們對日常生活中的安全保險器件的要求越來越高。為滿足人們對鎖的使用要求，增加其安全性，用密碼代替鑰匙的密碼鎖應運而生。密碼鎖具有安全性高、成本低、功耗低、易操作等優點。</p><p>在安全技術防範領域，具有防盜報警功能的電子密碼鎖逐漸代替傳統的機械式密碼鎖，克服了機械式密碼鎖密碼量少、安全性能差的缺點，使密碼鎖無論在技術上還是在性能上都大大提高一步。隨著大規模集成電路技術的發展，特別是單片機的問世，出現了帶微處理器的智能密碼鎖，它除具有電子密碼鎖的功能外，還引入了智能化管理、專家分析系統等功能，從而使密碼鎖具有很高的安全性、可靠性，應用日益廣泛。</p><p>隨著人們對安全的重視和科技的發展，許多電子智能鎖（指紋識別、IC卡辨認）已在國內外相繼面世。但是這些產品的特點是針對特定的指紋和有效卡，只能適用於保密要求的箱、櫃、門等。而且指紋識識別器若在公共場所使用存在容易機械損壞，IC卡還存在容易丟失、損壞等特點。加上其成本較高，一定程度上限制了這類產品的普及和推廣。鑑於目前的技術水平與市場的接收程度，電子密碼鎖是這類電子防盜產品的主流。紅外遙控是單工的紅外通信方式，本設計的紅外遙控採用以通信方式為基礎的紅外遙控，而且本設計也使用了紅外通信技術，故著重分析紅外通信的基本原理。</p><p>紅外通信是利用紅外技術實現兩點間的近距離保密通信和信息轉發。它一般由紅外發射和接收系統兩部分組成。發射系統對一個紅外輻射源進行調製後發射紅外信號，而接收系統用光學裝置和紅外探測器進行接收，就構成紅外通信系統。但是接觸式密碼鎖系統都相應的存在著不同的缺點。例如：接觸式密碼鎖系統成本較低，體積小，卡片本身無須電源，但使用不太方便，而且有接觸磨損。相比之下，紅外遙控密碼鎖系統的成本與接觸式密碼鎖系統相當，而且可以進行近距離遙控，使用十分方便。而且它已經與 PC 機的數據庫相結合，可以組成一套酒店房間的門禁管理系統。 由於紅外遙控具有許多優點， 例如紅外線發射裝置採用紅外發光二極管遙控發射器易於小型化且價格低廉； 採用數字信號編碼和二次調製方式，不僅可以實現多路信息的控制，增加遙控功能，提高信號傳輸的抗干擾性，減少誤動作，而且功率消耗低；紅外線不會向室外洩露，不會產生信號串擾；反應速度快、傳輸效率高、工作穩定可靠等。工業設備中，在高壓、輻射、有毒氣體、粉塵等環境下，採用紅外線遙控不僅完全可靠而且能有效地隔離電氣干擾。所以紅外線遙控是目前使用最廣泛的一種通信和遙控手段。</p><p><strong>1.2、設計的目的</strong></p><p>在科技高速發展的今天，非接觸式控制越來越受大家歡迎，利用紅外遙控，方便又安全。另外，紅外線不會產生信號干擾，反應速度迅速、工作穩定度高等特點。而在工業製造中，在高壓、輻射、腐蝕等惡劣環境下，採用紅外遙控能夠很好地隔離這些干擾。在本次設計中，為了更加方便操作，除了採用矩陣鍵盤對密碼鎖進行控制外，還可以用遙控器進行控制，以達到雙控的目的。可以加深自己對所學專業的認識，關聯知識，增強自己的動手能力，積累實踐經驗，為以後的工作打好基礎。</p><p><strong>1.3、設計的意義</strong></p><p>隨著科技的發展，人們生活的節奏也越來越快，隨之人們對方便，快捷的要求也隨之不斷增高。遙控器的出現，在一定程度上滿足了人們這個要求。遙控器是由高產的發明家Robert Adler在五十年代發明的[1]。而紅外遙控是20世紀70年代才開始發展起來的一種遠程控制技術，其原理是利用紅外線來傳遞控制信號，實現對控制對象的遠距離控制，具體來講，就是有發射器發出紅外線指令信號，有接收器接收下來並對信號進行處理，最後實現對控制對象的各種功能的遠程控制。</p><p>紅外遙控具有獨立性、物理特性與可見光相似性、無穿透障礙物的能力及較強的隱蔽性等特點。隨著紅外遙控技術的開發和迅速發展，很多電器都應用了紅外遙控，在日常的生活和工作中, 住宅與部門的安全防範、單位的文件檔案、財務報表以及一些個人資料的保存多以加鎖的辦法來解決。若使用傳統的機械式鑰匙開鎖，人們常需攜帶多把鑰匙, 使用極不方便, 且鑰匙丟失後安全性即大打折扣。隨著科學技術的不斷髮展，人們對日常生活中的安全保險器件的要求越來越高。為滿足人們對鎖的使用要求，增加其安全性，用密碼代替鑰匙的密碼鎖應運而生。密碼鎖具有安全性高、成本低、功耗低、易操作等優點。 在安全技術防範領域，具有防盜報警功能的電子密碼鎖逐漸代替傳統的機械式密碼鎖，克服了機械式密碼鎖密碼量少、安全性能差的缺點，使密碼鎖無論在技術上還是在性能上都大大提高一步。隨著大規模集成電路技術的發展，特別是單片機的問世，出現了帶微處理器的智能密碼鎖，它除具有電子密碼鎖的功能外，還引入了智能化管理、專家分析系統等功能，從而使密碼鎖具有很高的安全性、可靠性，應用日益廣泛。</p><p><strong>二、主要器件介紹</strong></p><p>系統主要有STC89C52RC單片機最小系統和LCD1602液晶顯示、數據存儲芯片24C02、紅外發射接收模塊等組成。</p><p><strong>2.1、主控器件</strong></p><p>本設計是STC89C52RC單片機為控制核心，矩陣鍵盤輸入，紅外遙控輸入基於紅外通信的單片機控制技術綜合實現所有功能。系統框圖如下圖：</p><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15285901190965dfa7b64c2><p class=pgc-img-caption></p></div><p>單片機是STC公司最新推出的一種新型51內核的單片機。片內含有Flash程序存儲器、SRAM、UART、SPI、PWM等模塊。封裝圖如下圖：</p><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528590183690cd9950be22><p class=pgc-img-caption></p></div><p><strong>2.1.1、主要特性</strong></p><p>1. 增強型8051單片機，6時鐘/機器週期和12時鐘/機器週期可以任 意 選擇，指令代碼完全兼容傳統8051.</p><p>2. 工作電壓：5.5V～3.3V（5V單片機）/3.8V～2.0V（3V單片機）</p><p>3. 工作頻率範圍：0～40MHz，相當於普通8051的0～80MHz，實際工作頻 率可達48MHz</p><p>4. 用戶應用程序空間為8K字節 5. 片上集成512字節RAM</p><p>6. 通用I/O口（32個），復位後為：P1/P2/P3/P4是準雙向口/弱上拉，</p><p>P0口是漏極開路輸出，作為總線擴展用時，不用加上拉電阻，作為I/O 口 用時，需加上拉電阻。</p><p>7. ISP（在系統可編程）/IAP（在應用可編程），無需專用編程器，無需專 用仿真器，可通過串口（RxD/P3.0,TxD/P3.1）直接下載用戶程序， 數秒即 可完成一片</p><p>8. 具有EEPROM功能</p><p>9. 具有看門狗功能</p><p>10. 共3個16位定時器/計數器。即定時器T0、T1、T2</p><p>11. 外部中斷4路，下降沿中斷或低電平觸發電路，Power Down模式 可由外部中斷低電平觸發中斷方式喚醒</p><p>12. 通用異步串行口（UART），還可用定時器軟件實現多個UART</p><p>13. 工作溫度範圍：-40～+85℃（工業級）/0～75℃（商業級）</p><p><strong>2.1.2、引腳功能</strong></p><p>VCC（40引腳）：電源電壓</p><p>VSS（20引腳）：接地</p><p>P0端口（P0.0～P0.7，39～32引腳）：P0口是一個漏極開路的8位雙向I/O口。作為輸出端口，每個引腳能驅動8個TTL負載，對端口P0寫入“1”時，可以作為高阻抗輸入。在訪問外部程序和數據存儲器時，P0口也可以提供低8位地址和8位數據的複用總線。此時，P0口內部上拉電阻有效。在Flash ROM編程時，P0端口接收指令字節；而在校驗程序時，則輸出指令字節。驗證時要求外接上拉電阻。</p><p>P1端口（P1.0～P1.7，1～8引腳）：P1口是一個帶內部上拉電阻的8位雙向I/O口。P1的輸出緩衝器可驅動（吸收或者輸出電流方式）4個TTL輸入。對端口寫入1時，通過內部的上拉電阻把端口拉到高電位，這是可用作輸入口。P1口作輸入口使用時，因為有內部上拉電阻，那些被外部拉低的引腳會輸出一個電流。</p><p>P2端口（P2.0～P2.7，21～28引腳）：P2口是一個帶內部上拉電阻的8位雙向I/O端口。P2的輸出緩衝器可以驅動（吸收或輸出電流方式）4個TTL輸入。對端口寫入1時，通過內部的上拉電阻把端口拉到高電平，這時可用作輸入口。P2作為輸入口使用時，因為有內部的上拉電阻，那些被外部信號拉低的引腳會輸出一個電流</p><p>P3口引腳複用功能 引腳號 複用功能</p><p>P3.0 RXD（串行輸入口）</p><p>P3.1 TXD（串行輸出口）</p><p>P3.2 （外部中斷0）</p><p>P3.3 （外部中斷1）</p><p>P3.4 T0（定時器0的外部輸入）</p><p>P3.5 T1（定時器1的外部輸入）</p><p>P3.6 （外部數據存儲器寫選通）</p><p>P3.7 （外部數據存儲器讀選通）</p><p>RST（9引腳）：復位輸入。當輸入連續兩個機器週期以上高電平時為有效，用來完成單片機單片機的復位初始化操作。看門狗計時完成後，RST引腳輸出96個晶振週期的高電平。特殊寄存器AUXR（地址8EH）上的DISRTO位可以使此功能無效。DISRTO默認狀態下，復位高電平有效。</p><p>ALE/（30引腳）：地址鎖存控制信號（ALE）是訪問外部程序存儲器時，鎖存低8位地址的輸出脈衝。在Flash編程時，此引腳（）也用作編程輸入脈衝。 在一般情況下，ALE以晶振六分之一的固定頻率輸出脈衝，可用來作為外部定時器或時鐘使用。然而，特別強調，在每次訪問外部數據存儲器時，ALE脈衝將會跳過。如果需要，通過將地址位8EH的SFR的第0位置“1”，ALE操作將無效。這一位置“1”，ALE僅在執行MOVX或MOV指令時有效。否則，ALE將被微弱拉高。這個ALE使能標誌位（地址位8EH的SFR的第0位）的設置對微控制器處於外部執行模式下無效。</p><p>VPP（31引腳）：訪問外部程序存儲器控制信號。為使能從0000H到FFFFH的外部程序存儲器讀取指令，必須接GND。注意加密方式1時，將內部鎖定位RESET。為了執行內部程序指令，應該接VCC。在Flash編程期間，也接收12伏VPP電壓。</p><p>XTAL1（19引腳）：振盪器反相放大器和內部時鐘發生電路的輸入端。</p><p>XTAL2（18引腳）：振盪器反相放大器的輸入端。</p><p><strong>2.1.3、串口通信</strong></p><p>一條信息的各位數據被逐位順序傳送的通信方式成為串行通信。根據信息的傳送方向，串行通信可以可以進一步劃分為單工、半雙工和全雙工 3 種。信息只能單方向傳送為單工；信息能雙向傳送但不能同時雙向傳送為半雙工；信息能夠同時雙向傳送則成為全雙工。 8051 系列單片機有一個全雙工串行口， 全雙工的串行通信只需要一根輸出線和輸入線。</p><p>串行通信又有異步通信和同步通信這兩種方式。異步通信用起始位“0”表示字符的開始，然後從低位到高位逐位傳送數據，最後用停止位“1”表示字符結束。一個字符又稱作一幀信息，一幀信息包括 1 位起始位、8 位數據位、1 位停止位，若數據位增加到第 9 位， 在 8051 系列單片機中， 第九位數據可以用作奇偶校驗位， 也可以用作地址/數據幀標誌。</p><p>8051 系列單片機串行 I/O 接口的工作原理就是： 當要發送數據時， 單片機自動將 SBUF 內的 8 位並行數據轉換為一定格式的串行數據， 從 TXD 引腳按規定的波特率來輸出； 當要接收數據時， 要監視 RXD 引腳，一旦出現起始位“0” ，按規定的波特率將外圍設備送來的一定格式的串行數據轉換成 8 位並行數據，等待用戶讀取 SBUF 寄存器，若不及時讀取，SBUF 中的數據有可能被刷新。8051 系列單片機上有通用異步接收/發送器用於串行通信，發送時數據由 TXD 引腳輸出，接收時數據從 RXD 引腳輸入。有兩個緩衝器（Serial Buffer） ，一個作發送緩衝器，另外一個作為接收緩衝器。UART 是可編程的全雙工的串行口。</p><p>SBUF是可以直接尋址的專用寄存器。物理上，它對應著兩個寄存器，即一個發送寄存器一個接收寄存器，CPU寫SBUF就是修改發送寄存器；讀SBUF就是讀接收寄存器。接收器是雙緩衝的，以避免在接收下一幀數據之前，CPU未能及時的響應接收器的中斷，沒有把上一幀的數據讀走而產生兩幀數據重疊的問題。對於發送器，為了保持最大的傳輸速率，一般不需要雙緩衝，因為發送時CPU是主動的，不會產生重疊問題。</p><p>SCON是一個逐位定義的8位寄存器，用於控制串行通信的方式選擇、接收和發送，指示串口的狀態，SCON即可以字節尋址也可以位尋址，字節地址98H，地址位為98H~9FH。它的各個位定義如下：</p><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1528590308546abd0767045><p class=pgc-img-caption></p></div><p>SM2在工作方式2和3中是多機通信的使能位。在工作方式0中，SM2必須為0。在工作方式1中，若SM2=1且沒有接收到有效的停止位，則接收中斷標誌位RI不會被激活。在工作方式2和3中若SM2=1且接收到的第9位數據（RB8）為0，則接收中斷標誌RB8不會被激活，若接收到的第9位數據（RB8）為1，則RI置位。此功能可用於多處理機通信。</p><p>REN為允許串行接收位，由軟件置位或清除。置位時允許串行接收，清除時禁止串行接收。</p><p>TB8是工作方式2和3要發送的第9位數據。在許多通信協議中該位是奇偶位，可以按需要由軟件置位或清除。在多處理機通信中，該位用於表示是地址幀還是數據幀。</p><p>RB8是工作方式2和3中接收到的第9位數據（例如是奇偶位或者地址/數據標識位），在工作方式1中若SM2=0，則RB8是已接收的停止位。在工作方式0中RB8不使用。</p><p>TI 為發送中斷標誌位，由硬件置位，軟件清除。工作方式0中在發送第8位末尾由硬件置位；在其他工作方式時，在發送停止位開始時由硬件置位。TI=1時，申請中斷。CPU響應中斷後，發送下一幀數據。在任何工作方式中都必須由軟件清除TI。</p><p>RI為接收中斷標誌位，由硬件置位，軟件清除。工作方式0中在接收第8位末尾由硬件置位；在其他工作方式時，在接收停止位的中間由硬件置位。RI=1時，申請中斷，要求CPU取走數據。但在工作方式1中，SM2=1且未接收到有效的停止位時，不會對RI置位。</p><p>在任何工作方式中都必須由軟件清除RI。</p><p>系統復位時，SCON的所有位都被清除。</p><p>（1） 工作方式0</p><p>SM0=0且SM1=0時，串口選擇工作方式0，實質這是一種同步移位寄存器模式。其數據傳輸的波特率固定為Fosc/12，數據由RXD引腳輸入或輸出，同步時鐘由TXD引腳輸出。接收/發送的是8位數據，傳輸是低位在前，幀格式如下：</p><p>…….. D0 D1 D2 D3 D4 D5 D6 D7 …….</p><p>（2）工作方式1</p><p>當SM0=0且SM1=1時，串口選擇工作方式1，其數據傳輸的波特率由定時/計數器T1、T2的溢出速率決定，可通過程序設定。當T2CON寄存器中的RCLK和TCLK置位時，用T2作為發送和接收波特率發生器，而RCLK=TCLK=0時，用T1作為波特率發生器，兩者還可以交叉使用，即發送和接收採用不同的波特率。數據由TXD引腳發送，由RXD引腳接收。發送或接收一幀的數據為10位，即1位起始位（0）、8位數據位（低位在先）和1位停止位（1）。幀格式如下：</p><p>起始位0 D0 D1 D2 D3 D4 D5 D6 D7 停止位1</p><p>類似於工作方式0，當執行任一條SBUF指令時，就啟動串行數據的發送。在執行寫入SBUF的指令時，也將“1”寫入發送移位寄存器的第9位，並通知發送控制器有發送請求。實際上，發送過程始於內部的16分頻計數器下次滿度翻轉（全“1”變全“0”）後的那幾個機器週期的開始。所以，每位的發送過程與16分頻計數器同步，而不是與“寫SBUF”同步。</p><p>（3）方式 2 和方式 3</p><p>這兩種方式都是 11 位異步接收/發送方式。他們的操作過程都是完全一樣</p><p>的，所不同的是波特率而已。方式 3 波特率同方式 1（定時器 1 作為波特率時鐘發生器） 。</p><p>方式 2 和方式 3 的發送起始於任何一條 SBUF 數據裝載指令。當第 9 位數據（TB8）輸出之後，TI 將被置位（TI=1） 。</p><p>方式 2 和方式 3 的接收數據前提條件也是 REN 被編程為 1。 在第 9 位數據接收到後， 如果下列條件同時滿足，即 RI=0 且 SM2=0 或者接收到的第 9 位為 1，則將已接受的數據裝入 SBUF 緩衝器和 RB8，並將RI 置位（RI=1）否則接收數據無效。</p><p>8051 串行口的不同尋常的特徵是包括第 9 位方式。它允許把在串行口通信增加的第 9 位用於標誌特殊字節的接收。用這種方式，一個單片機可以和大量的其他單片機對話而不打擾不尋址的單片機，這種多機通信方式必須工作在嚴格的主從方式，由軟件進行分析。</p><p>2.2 、LCD1602的原理</p><p>2.2.1 LCD1602的概述</p><p>液晶顯示的原理是利用液晶的物理特性，通過電壓對其顯示區域進行控制，有電就有顯示。LCD1602是有32個5x7點陣組成的行字符型顯示屏。其操作方法如下：讀寫時序操作</p><p>讀狀態RS=L，R/W=H，E=H輸出D0—D7</p><p>寫指令RS=L，R/W=L，D0—D7指令碼，E=高脈衝</p><p>讀數據RS=H，R/W=H，E=H輸出D0—D7數據</p><p>寫數據RS=H，R/W=L，D0—D7數據，E=高脈衝</p><p><strong>2.2.2LCD1602的操作時序</strong></p><p>寫操作時序圖</p><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1528590549117f681e5d856><p class=pgc-img-caption></p></div><p><strong>2.2.3 LCD1602的基本命令</strong></p><p>1、RAM地址映射圖</p><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528590595973d036910e11><p class=pgc-img-caption></p></div><p><strong>2、指令碼</strong></p><p>1602液晶模塊內部的控制器共有11條控制指令，如表10-14所示：</p><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/152859065763283f700fe69><p class=pgc-img-caption></p></div><p>指令1：清顯示，指令碼01H,光標復位到地址00H位置。指令2：光標復位，光標返回到地址00H。</p><p>指令3：光標和顯示模式設置I/D：光標移動方向，高電平右移，低電平左移S:屏幕上所有文字是否左移或者右移。高電平表示有效，低電平則無效。</p><p>指令4：顯示開關控制。D：控制整體顯示的開與關，高電平表示開顯示，低電平表示關顯示C：控制光標的開與關，高電平表示有光標，低電平表示無光標B：控制光標是否閃爍，高電平閃爍，低電平不閃爍。</p><p>指令5：光標或顯示移位S/C：高電平時移動顯示的文字，低電平時移動光標。</p><p>指令6：功能設置命令DL：高電平時為4位總線，低電平時為8位總線N：低電平時為單行顯示，高電平時雙行顯示F:低電平時顯示5x7的點陣字符，高電平時顯示5x10的點陣字符。指令7：字符發生器RAM地址設置。</p><p>指令8：DDRAM地址設置。</p><p>指令9：讀忙信號和光標地址BF：為忙標誌位，高電平表示忙，此時模塊不能接收命令或者數據，如果為低電平表示不忙。</p><p>指令10：寫數據。</p><p>指令11：讀數據。</p><p>2.3、紅外一體化接收頭</p><p>2.3.1紅外一體化接收頭的概述</p><p>紅外遙控信號是一連串的二進制脈衝碼。為了使其在無線傳輸過程中免受其他紅外信號的干擾,通常都是先將其調製在特定的載波頻率上,然後再經紅外發射二極管發射出去,而紅外線接收裝置則要濾除其他雜波,只接收該特定頻率的信號並將其還原成二進制脈衝碼,也就是解調.</p><p>目前,對於這種進行了調製的紅外遙控信號，通常是採用一體化紅外線接收頭進行調解.一體化紅外線接收頭將低噪音放大器,限幅器,帶通濾波器,解調器,,以及整形驅動電路等集成在一起.一體化紅外線接收頭體積小,靈敏度高,外接元件少,抗干擾能力強,使用十分方便。</p><p>紅外信號收發系統的典型電路如圖1所示，紅外接收電路通常被廠家集成在一個元件中，成為一體化紅外接收頭。 內部電路包括紅外監測二極管，放大器，限幅器，帶通濾波器，積分電路，比較器等。紅外監測二極管監測到紅外信號，然後把信號送到放大器和限幅器，限幅器把脈衝幅度控制在一定的水平，而不論紅外發射器和接收器的距離遠近。交流 信號進入帶通濾波器，帶通濾波器可以通過30khz到60khz的負載波，通過解調電路和積分電路進入比較器，比較器輸出 高低電平，還原出發射端的信號波形。注意輸出的高低電平和發射端是反相的，這樣的目的是為了提高接收的靈敏度。</p><p>紅外接收頭的種類很多，引腳定義也不相同，一般都有三個引腳，包括供電腳，接地和信號輸出腳。根據發射端調製 載波的不同應選用相應解調頻率的接收頭。</p><p>紅外接收頭內部放大器的增益很大，很容易引起干擾，因此在接收頭的供電腳上須加上濾波電容，一般在22uf以上。 有的廠家建議在供電腳和電源之間接入330歐電阻，進一步降低電源干擾。</p><p>2.3.2紅外一體化接收頭的應用</p><p>紅外遙控是以調製的方式發射數據，就是把數據和一定頻率的載波進行“與”操作，這樣既可以提高發射效率又可以降低電源 功耗。</p><p>調製載波頻率一般在30khz到60khz之間，大多數使用的是38kHz，佔空比1/3的方波，如圖2所示，這是由發射端所使用的 455kHz晶振決定的。在發射端要對晶振進行整數分頻，分頻係數一般取12，所以455kHz÷12≈37.9 kHz≈38kHz。</p><p>單片機可以準備接收下面的數據。地址碼由8位二進制組成，共256種．圖中地址碼重發了一次。主要是加強發射機的可靠性．如果兩次地址碼不相同．則說明本幀數據有錯．應丟棄。不同的設備可以擁有不同的地址碼．因此。同種編碼的發射機只要設置地址碼不同，也不會相互干擾。在同一個發射機中．所有按鍵發出的地址碼都是相同的。數據碼為8位，可編碼256種狀態，代表實際所按下的鍵。數據反碼是數據碼的各位求反，通過比較數據碼與數據反碼．可判斷接收到的數據是否正確。如果數據碼與數據反碼之間的關係不滿足相反的關係．則本次遙控接收有誤．數據應丟棄。在同一個發射機上，所有按鍵的數據碼均不相同。</p><p>數據格式包括了引導碼、用戶碼、數據碼和數據碼反碼，編碼總佔32位。數據反碼是數據碼反相後的編碼，編碼時可用於對數據的糾錯。注意：第二段的用戶碼也可以在遙控應用電路中被設置成第一段用戶碼的反碼。</p><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528590702549e62d451cb5><p class=pgc-img-caption></p></div><p>用戶碼或數據碼中的每一個位可以是位‘1’，也可以是位‘0’。區分‘0’和‘1’是利用脈衝的時間間隔來區分，這種編碼方式稱為脈衝位置調製方式，英文簡寫PPM。</p><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15285907523695a17b2a4e9><p class=pgc-img-caption></p></div><p>以接收TC9012遙控器編碼為例，解碼方法如下：</p><p>設外部中斷為下降沿中斷，定時器0(或者1)為16位計時器．初始值均為0</p><p>(2)第一次進入遙控中斷後，開始計時。</p><p>(3)從第二次進入遙控中斷起，先停止計時。並將計時值保存後，再重新計時。如果計時值等於前導碼的時間，設立前導碼標誌。準備接收下面的一幀遙控數據，如果計時值不等於前導碼的時間，但前面已接收到前導碼，則判斷是遙控數據的0還是1。</p><p>(4)繼續接收下面的地址碼、數據碼、數據反碼。</p><p>(5)當接收到32位數據時，說明一幀數據接收完畢。此時可停止定時器的計時，並判斷本次接收是否有效．如果兩次地址碼相同且等於本系統的地址，數據碼與數據反碼之和等於0FFH，則接收的本幀數據碼有效。否則丟棄本次接收到的數據。</p><p>(6)接收完畢，初始化本次接收的數據，準備下一次遙控接收。</p><p><strong>三、程序設計</strong></p><p>紅外遙控鎖系統主要由單片機通過紅外通信控制,當其完成紅外信號，讀取數據，,其數據的傳輸根據協議的內容,發生錯誤時，有單片機發出警報，超出一定次數就把鍵盤鎖死報警。紅外遙控鎖系統程序需要完成以下的功能：</p><p>1、矩陣鍵盤，可以設置密碼開鎖及密碼重置；</p><p>3、遙控器輸入密碼開鎖及密碼重置；</p><p>5、密碼輸入輸入信息或密碼輸入錯誤報警及鍵盤鎖死；</p><p>6、用1602液晶顯示功能狀態。</p><p>矩陣鍵盤設置程序流程圖如下：</p><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528590846628be32c7cae7><p class=pgc-img-caption></p></div><p><strong>四、過程分享</strong></p><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528590913328337d5e9ef0><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528590914609e03486c99f><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1528590913628d500b50ec9><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/152859091370487c6a822fb><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/152859091361756e9351d87><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/152859091345945a4c727ba><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528590914199434a7926c9><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15285909144025a2bcd19d4><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1528590914548f3c97b9c34><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15285909144929d51fc2460><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528590915130bbca5e3920><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1528590916384c502e0f80c><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/152859091578251a311b35f><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528590916545fa47b6bf68><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1528590915604cd2c394447><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15285909164242003d3c5cc><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528591068251d42898405e><p class=pgc-img-caption>PCB圖</p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15285909845272d956b685a><p class=pgc-img-caption>原理圖</p></div><div class=pgc-img><img alt=基於紅外通信的單片機綜合編程控制技術實現遙控密碼鎖功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528591229939166f33875f><p class=pgc-img-caption></p></div><p><strong>程序代碼：</strong></p><p>//(智能存錢管) //晶振12Mkz</p><p>//功能：該系統具有存錢取錢功能，存錢時需要輸入密碼 密碼為000000</p><p>//密碼可修改 萬能密碼為：131420 改密碼可初始化密碼為：000000 密碼與存錢數有掉電保存功能</p><p>#include&lt;reg52.h> //頭文件</p><p>#include&lt;intrins.h></p><p>#define uchar unsigned char //宏定義</p><p>#define uint unsigned int</p><p>#define LCD1602_dat P0</p><p>uchar irbyte[4];</p><p>uchar irtime,irflag,bitnum,irdateok;</p><p>uchar irdate[33];</p><p>sbit LCD1602_rs=P1^0;</p><p>sbit LCD1602_rw=P1^1;</p><p>sbit LCD1602_e=P1^2;</p><p>sbit led=P2^0;</p><p>sbit beep=P2^7;</p><p>sbit Scl=P3^5; //24C02串行時鐘</p><p>sbit Sda=P3^4; //24C02串行數據</p><p>uchar ptem,mm[6],mm_n1[6],mm_n2[6],n,j;</p><p>uchar step,ms,time,cw;</p><p>uchar zt[2];</p><p>bit cq,beep1,beep2;</p><p>void mDelay(uint t) //延時</p><p>{</p><p>uchar i;</p><p>while(t--)</p><p>{</p><p>for(i=0;i&lt;125;i++)</p><p>{;}</p><p>}</p><p>}</p><p>void Nop(void) //空操作</p><p>{</p><p>_nop_();</p><p>_nop_();</p><p>_nop_();</p><p>_nop_();</p><p>}</p><p>/*起始條件*/</p><p>void Start(void)</p><p>{</p><p>Sda=1;</p><p>Scl=1;</p><p>Nop();</p><p>Sda=0;</p><p>Nop();</p><p>}</p><p>/*停止條件*/</p><p>void Stop(void)</p><p>{</p><p>Sda=0;</p><p>Scl=1;</p><p>Nop();</p><p>Sda=1;</p><p>Nop();</p><p>}</p><p>/*應答位*/</p><p>void Ack(void)</p><p>{</p><p>Sda=0;</p><p>Nop();</p><p>Scl=1;</p><p>Nop();</p><p>Scl=0;</p><p>}</p><p>/*反向應答位*/</p><p>void NoAck(void)</p><p>{</p><p>Sda=1;</p><p>Nop();</p><p>Scl=1;</p><p>Nop();</p><p>Scl=0;</p><p>}</p><p>/*發送數據子程序，Data為要求發送的數據*/</p><p>void Send(uchar Data)</p><p>{</p><p>uchar BitCounter=8;</p><p>uchar temp;</p><p>do</p><p>{</p><p>temp=Data;</p><p>Scl=0;</p><p>Nop();</p><p>if((temp&0x80)==0x80)</p><p>Sda=1;</p><p>else</p><p>Sda=0;</p><p>Scl=1;</p><p>temp=Data&lt;&lt;1;</p><p>Data=temp;</p><p>BitCounter--;</p><p>}</p><p>while(BitCounter);</p><p>Scl=0;</p><p>}</p><p>/*讀一字節的數據，並返回該字節值*/</p><p>uchar Read(void)</p><p>{</p><p>uchar temp=0;</p><p>uchar temp1=0;</p><p>uchar BitCounter=8;</p><p>Sda=1;</p><p>do{</p><p>Scl=0;</p><p>Nop();</p><p>Scl=1;</p><p>Nop();</p><p>if(Sda)</p><p>temp=temp|0x01;</p><p>else</p><p>temp=temp&amp;0xfe;</p><p>if(BitCounter-1)</p><p>{</p><p>temp1=temp&lt;&lt;1;</p><p>temp=temp1;</p><p>}</p><p>BitCounter--;</p><p>}</p><p>while(BitCounter);</p><p>return(temp);</p><p>}</p><p>void WrToROM(uchar Data[],uchar Address,uchar Num)</p><p>{</p><p>uchar i;</p><p>uchar *PData;</p><p>PData=Data;</p><p>for(i=0;i&lt;Num;i++)</p><p>{</p><p>Start();</p><p>Send(0xa0);</p><p>Ack();</p><p>Send(Address+i);</p><p>Ack();</p><p>Send(*(PData+i));</p><p>Ack();</p><p>Stop();</p><p>mDelay(20);</p><p>}</p><p>}</p><p>void RdFromROM(uchar Data[],uchar Address,uchar Num)</p><p>{</p><p>uchar i;</p><p>uchar *PData;</p><p>PData=Data;</p><p>for(i=0;i&lt;Num;i++)</p><p>{</p><p>Start();</p><p>Send(0xa0);</p><p>Ack();</p><p>Send(Address+i);</p><p>Ack();</p><p>Start();</p><p>Send(0xa1);</p><p>Ack();</p><p>*(PData+i)=Read();</p><p>Scl=0;</p><p>NoAck();</p><p>Stop();</p><p>}</p><p>}</p><p>void delay(uint T) //延時函數</p><p>{</p><p>while(T--);</p><p>}</p><p>void qing() // 清楚數據</p><p>{</p><p>uint i;</p><p>for(i=0;i&lt;33;i++)</p><p>{</p><p>irdate[i]=0;</p><p>}</p><p>}</p><p>void deal_with() //解碼處理部分</p><p>{</p><p>uchar i,j,k,temp;</p><p>k=1;</p><p>for(j=0;j&lt;4;j++)</p><p>{</p><p>for(i=0;i&lt;8;i++)</p><p>{</p><p>temp=temp>>1;</p><p>if(irdate[k]>7)</p><p>{</p><p>temp=temp|0x80;</p><p>}</p><p>k++;</p><p>}</p><p>irbyte[j]=temp;</p><p>}</p><p>}</p><p>void LCD1602_write(uchar order,dat) //1602 一個字節 處理</p><p>{</p><p>LCD1602_e=0;</p><p>LCD1602_rs=order;</p><p>LCD1602_dat=dat;</p><p>LCD1602_rw=0;</p><p>LCD1602_e=1;</p><p>delay(1);</p><p>LCD1602_e=0;</p><p>}</p><p>void LCD1602_writebyte(uchar *prointer) //1602 字符串 處理</p><p>{</p><p>while(*prointer!='\0')</p><p>{</p><p>LCD1602_write(1,*prointer);</p><p>prointer++;</p><p>}</p><p>}</p><p>void LCD1602_cls() //1602 初始化</p><p>{</p><p>LCD1602_write(0,0x01); //1602 清屏 指令</p><p>delay(1500);</p><p>LCD1602_write(0,0x38); // 功能設置 8位、5*7點陣</p><p>delay(1500);</p><p>LCD1602_write(0,0x0c); //設置 光標 不顯示開關、不顯示光標、字符不閃爍</p><p>LCD1602_write(0,0x06);</p><p>LCD1602_write(0,0xd0);</p><p>delay(1500);</p><p>}</p><p>uchar key_fs() //矩陣按鍵返回按碼</p><p>{</p><p>uchar fs=255;</p><p>P1=0x0f;</p><p>if(P1!=0x0f)</p><p>{</p><p>delay(800);</p><p>P1=0x0f;</p><p>if(P1!=0x0f)</p><p>{</p><p>ptem=P1;</p><p>P1=0xf0;</p><p>ptem=ptem|P1;</p><p>switch (ptem)</p><p>{</p><p>case 0xe7:</p><p>fs=1;</p><p>break;</p><p>case 0xd7:</p><p>fs=2;</p><p>break;</p><p>case 0xb7:</p><p>fs=3;</p><p>break;</p><p>case 0x77:</p><p>fs=10;</p><p>break;</p><p>case 0xeb:</p><p>fs=4;</p><p>break;</p><p>case 0xdb:</p><p>fs=5;</p><p>break;</p><p>case 0xbb:</p><p>fs=6;</p><p>break;</p><p>case 0x7b:</p><p>fs=11;</p><p>break;</p><p>case 0xed:</p><p>fs=7;</p><p>break;</p><p>case 0xdd:</p><p>fs=8;</p><p>break;</p><p>case 0xbd:</p><p>fs=9;</p><p>break;</p><p>case 0x7d:</p><p>fs=12;</p><p>break;</p><p>case 0xee:</p><p>fs=13;</p><p>break;</p><p>case 0xde:</p><p>fs=0;</p><p>break;</p><p>case 0xbe:</p><p>fs=14;</p><p>break;</p><p>case 0x7e:</p><p>fs=15;</p><p>break;</p><p>}</p><p>P1=0x0f;</p><p>while(P1!=0x0f)</p><p>{</p><p>P1=0x0f;</p><p>}</p><p>}</p><p>}</p><p>return(fs);</p><p>}</p><p>void show() //顯示程序</p><p>{</p><p>LCD1602_write(0,0x80);</p><p>LCD1602_writebyte("===Coded Lock===");</p><p>}</p><p>unsigned char coding_1(unsigned char m)</p><p>{</p><p>unsigned char k;</p><p>switch(m)</p><p>{</p><p>case (0x0c): k=1;break;</p><p>case (0x18): k=2;break;</p><p>case (0x5e): k=3;break;</p><p>case (0x08): k=4;break;</p><p>case (0x1c): k=5;break;</p><p>case (0x5a): k=6;break;</p><p>case (0x42): k=7;break;</p><p>case (0x52): k=8;break;</p><p>case (0x4a): k=9;break;</p><p>case (0x09): k=13;break;</p><p>case (0x16): k=0;break;</p><p>case (0x19): k=14;break;</p><p>case (0x0d): k=15;break;</p><p>case (0x07): k=12;break;</p><p>}</p><p>return(k);</p><p>}</p><p>void key() //按鍵鍵碼處理程序</p><p>{</p><p>uchar fz=255,i;</p><p>if(irbyte[2]!=0)</p><p>{</p><p>fz=coding_1(irbyte[2]);</p><p>do</p><p>{</p><p>qing();</p><p>deal_with();</p><p>}while(irbyte[2]!=0);</p><p>}else</p><p>{</p><p>fz=key_fs();</p><p>}</p><p>if(fz!=255)</p><p>{</p><p>beep2=1;beep=0;</p><p>delay(10000);</p><p>beep2=0;beep=1;</p><p>}</p><p>if(step==0)</p><p>{</p><p>if(fz&lt;10&&cq==0&&n&lt;6)</p><p>{</p><p>if(n==0)</p><p>{</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte("Pass:");</p><p>}</p><p>mm_n1[n]=fz;</p><p>n++;</p><p>LCD1602_write(0,0xc5);</p><p>for(i=0;i&lt;n;i++)</p><p>{</p><p>LCD1602_writebyte("*");</p><p>}</p><p>}</p><p>}else if(step==1|step==2)</p><p>{</p><p>if(fz&lt;10&&n&lt;6)</p><p>{</p><p>mm_n1[n]=fz;</p><p>n++;</p><p>LCD1602_write(0,0xc9);</p><p>for(i=0;i&lt;n;i++)</p><p>{</p><p>LCD1602_writebyte("*");</p><p>}</p><p>}</p><p>}else if(step==3)</p><p>{</p><p>if(fz&lt;10&&n&lt;6)</p><p>{</p><p>mm_n2[n]=fz;</p><p>n++;</p><p>LCD1602_write(0,0xc6);</p><p>for(i=0;i&lt;n;i++)</p><p>{</p><p>LCD1602_writebyte("*");</p><p>}</p><p>}</p><p>}</p><p>switch(fz)</p><p>{</p><p>case 11:</p><p>break;</p><p>case 12:</p><p>if(n!=0)</p><p>{</p><p>n--;</p><p>if(step==0)</p><p>{</p><p>mm_n1[n+1]=0xff;</p><p>LCD1602_write(0,0xc5);</p><p>for(i=0;i&lt;n;i++)</p><p>{</p><p>LCD1602_writebyte("*");</p><p>}</p><p>for(i=0;i&lt;6-n;i++)</p><p>{</p><p>LCD1602_writebyte(" ");</p><p>}</p><p>}else if(step==1|step==2)</p><p>{</p><p>mm_n1[n+1]=0xff;</p><p>LCD1602_write(0,0xc9);</p><p>for(i=0;i&lt;n;i++)</p><p>{</p><p>LCD1602_writebyte("*");</p><p>}</p><p>for(i=0;i&lt;6-n;i++)</p><p>{</p><p>LCD1602_writebyte(" ");</p><p>}</p><p>}else if(step==3)</p><p>{</p><p>mm_n2[n+1]=0xff;</p><p>LCD1602_write(0,0xc6);</p><p>for(i=0;i&lt;n;i++)</p><p>{</p><p>LCD1602_writebyte("*");</p><p>}</p><p>for(i=0;i&lt;6-n;i++)</p><p>{</p><p>LCD1602_writebyte(" ");</p><p>}</p><p>}</p><p>}</p><p>break;</p><p>case 13:</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte("Password");</p><p>step=0;</p><p>cq=0;</p><p>n=0;</p><p>led=0;</p><p>zt[0]='N';</p><p>zt[1]='O';</p><p>WrToROM(zt,10,2);</p><p>break;</p><p>case 14:</p><p>if(step==0)</p><p>{</p><p>if(n==6)</p><p>{</p><p>n=0;</p><p>for(i=0;i&lt;6;i++)</p><p>{</p><p>if(mm[i]!=mm_n1[i])</p><p>{</p><p>break;</p><p>}</p><p>}</p><p>if(i==6)</p><p>{</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc5);</p><p>LCD1602_writebyte("Open");</p><p>led=1;</p><p>zt[0]='O';</p><p>zt[1]='K';</p><p>WrToROM(zt,10,2);</p><p>cq=1;</p><p>cw=0;</p><p>}else if(mm_n1[0]==1&&mm_n1[1]==3&&mm_n1[2]==1&&mm_n1[3]==4&&mm_n1[4]==2&&mm_n1[5]==0)</p><p>{</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc3);</p><p>LCD1602_writebyte("Pass init");</p><p>for(j=0;j&lt;6;j++)</p><p>{</p><p>mm[j]=0;</p><p>}</p><p>cw=0;</p><p>WrToROM(mm,0,6);</p><p>}else</p><p>{</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc5);</p><p>LCD1602_writebyte("Error");</p><p>time=3;</p><p>cw++;</p><p>if(cw>2)</p><p>{</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc2);</p><p>LCD1602_writebyte("Locked state");</p><p>while(1)</p><p>{</p><p>beep1=1;</p><p>cw=3;</p><p>time=5;</p><p>}</p><p>}</p><p>}</p><p>}else</p><p>{</p><p>n=0;</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc5);</p><p>LCD1602_writebyte("Error");</p><p>time=3;</p><p>cw++;</p><p>if(cw>2)</p><p>{</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc2);</p><p>LCD1602_writebyte("Locked state");</p><p>while(1)</p><p>{</p><p>beep1=1;</p><p>cw=3;</p><p>time=5;</p><p>}</p><p>}</p><p>}</p><p>}else if(step==1)</p><p>{</p><p>if(n==6)</p><p>{</p><p>n=0;</p><p>for(i=0;i&lt;6;i++)</p><p>{</p><p>if(mm[i]!=mm_n1[i])</p><p>{</p><p>break;</p><p>}</p><p>}</p><p>if(i==6)</p><p>{</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte("New pass:");</p><p>step=2;</p><p>}else</p><p>{</p><p>step=0;</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc5);</p><p>LCD1602_writebyte("Error");</p><p>}</p><p>}else</p><p>{</p><p>step=0;</p><p>n=0;</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc5);</p><p>LCD1602_writebyte("Error");</p><p>}</p><p>}else if(step==2)</p><p>{</p><p>if(n==6)</p><p>{</p><p>n=0;</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte("Again:");</p><p>step=3;</p><p>}else</p><p>{</p><p>step=0;</p><p>n=0;</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc5);</p><p>LCD1602_writebyte("Error");</p><p>}</p><p>}else</p><p>{</p><p>step=0;</p><p>if(n==6)</p><p>{</p><p>n=0;</p><p>for(i=0;i&lt;6;i++)</p><p>{</p><p>if(mm_n1[i]!=mm_n2[i])</p><p>{</p><p>break;</p><p>}</p><p>}</p><p>if(i==6)</p><p>{</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc4);</p><p>LCD1602_writebyte("Pass OK");</p><p>for(i=0;i&lt;6;i++)</p><p>{</p><p>mm[i]=mm_n1[i];</p><p>}</p><p>WrToROM(mm,0,6);</p><p>}else</p><p>{</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc5);</p><p>LCD1602_writebyte("Error");</p><p>}</p><p>}else</p><p>{</p><p>n=0;</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc5);</p><p>LCD1602_writebyte("Error");</p><p>}</p><p>}</p><p>break;</p><p>case 15:</p><p>step=1;</p><p>n=0;</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte(" ");</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte("Old pass:");</p><p>break;</p><p>}</p><p>}</p><p>void main() //主程序</p><p>{</p><p>TMOD=0x12;</p><p>TH0=0;</p><p>TL0=0;</p><p>TH1=0x3c;</p><p>TL1=0xb0;</p><p>EA=1;</p><p>ET0=1;</p><p>ET1=1;</p><p>TR0=1;</p><p>TR1=1;</p><p>EX0=1;</p><p>IT0=1;</p><p>LCD1602_cls();</p><p>RdFromROM(zt,10,2);</p><p>if(zt[0]=='O'&&zt[1]=='K')</p><p>{</p><p>led=1;</p><p>}else</p><p>{</p><p>led=0;</p><p>}</p><p>show();</p><p>LCD1602_write(0,0xc0);</p><p>LCD1602_writebyte("Password");</p><p>RdFromROM(mm,0,6);</p><p>while(1)</p><p>{</p><p>if(irdateok==1) //解碼完成處理</p><p>{</p><p>irdateok=0;</p><p>deal_with();</p><p>}</p><p>key();</p><p>}</p><p>}</p><p>void time3_interrupt()interrupt 3</p><p>{</p><p>TH1=0x3c;</p><p>TL1=0xb0;</p><p>ms++;</p><p>if(ms%3==0)</p><p>{</p><p>if(beep2==0)</p><p>{</p><p>if(beep1==1)</p><p>{</p><p>beep=!beep;</p><p>}else</p><p>{</p><p>beep=1;</p><p>}</p><p>}</p><p>}</p><p>if(ms>19)</p><p>{</p><p>ms=0;</p><p>if(time!=0)</p><p>{</p><p>time--;</p><p>beep1=1;</p><p>}</p><p>else beep1=0;</p><p>}</p><p>}</p><p>//==================================定時器0中斷函數，用於數碼管掃描顯示====================================</p><p>void time0_interrupt()interrupt 1</p><p>{</p><p>irtime++;</p><p>}</p><p>void int0() interrupt 0 //遙控器解碼</p><p>{</p><p>if(irflag==1)</p><p>{</p><p>if(irtime>32)</p><p>{</p><p>bitnum=0;</p><p>}</p><p>irdate[bitnum]=irtime;</p><p>irtime=0;</p><p>bitnum++;</p><p>if(bitnum==33)</p><p>{</p><p>bitnum=0;</p><p>irdateok=1;</p><p>}</p><p>}</p><p>else</p><p>{</p><p>irflag=1;</p><p>irtime=0;</p><p>}</p><p>}</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>紅外</a></li><li><a>單片機</a></li><li><a>綜合</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/745227e1.html alt=綜合佈線與弱電工程：跳線、尾纖、光纖接口，一文講明白 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/70370b3c8fc348e2ab70ef1e28a16c77 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/745227e1.html title=綜合佈線與弱電工程：跳線、尾纖、光纖接口，一文講明白>綜合佈線與弱電工程：跳線、尾纖、光纖接口，一文講明白</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1d2be915.html alt=寧夏、內蒙古自治區黃河的綜合治理措施 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/217d033a478c468f928df0367a082186 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1d2be915.html title=寧夏、內蒙古自治區黃河的綜合治理措施>寧夏、內蒙古自治區黃河的綜合治理措施</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/162efaea.html alt=詳解綜合佈線中屏蔽線纜有何作用！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1535790948669d855fe1265 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/162efaea.html title=詳解綜合佈線中屏蔽線纜有何作用！>詳解綜合佈線中屏蔽線纜有何作用！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/92ac0d94.html alt=技術文章—如何快速設計紅外體溫檢測儀？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b2db4225ff734a078ff4d3862782b10f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/92ac0d94.html title=技術文章—如何快速設計紅外體溫檢測儀？>技術文章—如何快速設計紅外體溫檢測儀？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a71711d1.html alt=溫榆河綜合治理工程主體完工，新增120個垂釣點位 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7e1611ffc1a24354805bac415c11f715 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a71711d1.html title=溫榆河綜合治理工程主體完工，新增120個垂釣點位>溫榆河綜合治理工程主體完工，新增120個垂釣點位</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3a3eebcb.html alt=一文看懂綜合佈線接地與聯結技術 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/c3d6eac2b6de41e580192c4b79134c35 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3a3eebcb.html title=一文看懂綜合佈線接地與聯結技術>一文看懂綜合佈線接地與聯結技術</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c4e851be.html alt=弱電綜合佈線中，到底採用屏蔽雙絞線還是非屏蔽雙絞線 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/fe0df606f4e2459aa108632c8e84d24b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c4e851be.html title=弱電綜合佈線中，到底採用屏蔽雙絞線還是非屏蔽雙絞線>弱電綜合佈線中，到底採用屏蔽雙絞線還是非屏蔽雙絞線</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1c6d9cc9.html alt=綜合佈線系統精華知識 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/87f59c95f1c14aefa8143a8f7625984c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1c6d9cc9.html title=綜合佈線系統精華知識>綜合佈線系統精華知識</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/31d75a5b.html alt=綜合佈線系統選擇指南 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/68f0e405-6ec2-403f-8b1e-bbcb418ebe63 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/31d75a5b.html title=綜合佈線系統選擇指南>綜合佈線系統選擇指南</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f4345a9b.html alt=網絡工程｜綜合佈線整體解決方案 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f4345a9b.html title=網絡工程｜綜合佈線整體解決方案>網絡工程｜綜合佈線整體解決方案</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/aa473c75.html alt=轉彎機皮帶綜合性能測評，技術乾貨不能錯過 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/15410451431617002f26d8a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/aa473c75.html title=轉彎機皮帶綜合性能測評，技術乾貨不能錯過>轉彎機皮帶綜合性能測評，技術乾貨不能錯過</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/44fba67e.html alt=想成為技術牛人，先弄懂單片機集成電路常見的封裝類型 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RM4TLjrGaw1ro9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/44fba67e.html title=想成為技術牛人，先弄懂單片機集成電路常見的封裝類型>想成為技術牛人，先弄懂單片機集成電路常見的封裝類型</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5a66e162.html alt=小米9紅外遙控功能確認迴歸：NFC/雙頻GPS同步升級 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RIOpipuHw6Bc0h style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5a66e162.html title=小米9紅外遙控功能確認迴歸：NFC/雙頻GPS同步升級>小米9紅外遙控功能確認迴歸：NFC/雙頻GPS同步升級</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b16159f6.html alt=打造光明“文化高地”這座大型綜合文化藝術中心值得期待 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b16159f6.html title=打造光明“文化高地”這座大型綜合文化藝術中心值得期待>打造光明“文化高地”這座大型綜合文化藝術中心值得期待</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bbbb90ed.html alt=看完這篇文章你就明白了，鯰魚彩色墨水綜合指南（上篇） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/4b0300020b3381ab5a3b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bbbb90ed.html title=看完這篇文章你就明白了，鯰魚彩色墨水綜合指南（上篇）>看完這篇文章你就明白了，鯰魚彩色墨水綜合指南（上篇）</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>