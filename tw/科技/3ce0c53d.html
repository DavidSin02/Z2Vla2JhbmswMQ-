<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>TensorFlow系列專題（十二）：CNN最全原理剖析（序） | 极客快訊</title><meta property="og:title" content="TensorFlow系列專題（十二）：CNN最全原理剖析（序） - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/27859481f604430bb47e6886f1904e69"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ce0c53d.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ce0c53d.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3ce0c53d.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ce0c53d.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ce0c53d.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3ce0c53d.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3ce0c53d.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ce0c53d.html><meta property="article:published_time" content="2020-10-29T21:12:41+08:00"><meta property="article:modified_time" content="2020-10-29T21:12:41+08:00"><meta name=Keywords content><meta name=description content="TensorFlow系列專題（十二）：CNN最全原理剖析（序）"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/3ce0c53d.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>TensorFlow系列專題（十二）：CNN最全原理剖析（序）</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><h1><strong>目錄</strong></h1><ul><li><strong>前言</strong></li><li><strong>卷積層（餘下部分）</strong></li><li class=ql-indent-1><strong>卷積的基本結構</strong></li><li><strong>卷積層</strong></li><li class=ql-indent-1><strong>什麼是卷積</strong></li><li class=ql-indent-1><strong>滑動步長和零填充</strong></li><li><strong>池化層</strong></li><li><strong>卷積神經網絡的基本結構</strong></li><li><strong>總結</strong></li><li><strong>參考文獻</strong></li></ul><h1><strong>一、前言</strong></h1><p>上一篇我們一直說到了CNN [1]卷積層的特性，今天會繼續講解卷積層的基本結構</p><h1><strong>二、卷積層（餘下部分）</strong></h1><p><strong>1. 卷積的基本結構</strong></p><p>如圖1所示，假設輸入到神經網絡中的是一張大小為256 * 256的圖像，第一層隱藏層的神經元個數為241 * 241。在只考慮單通道的情況下，全連接神經網絡輸入層到第一層隱藏層的連接數為(256 * 256) * (241 * 241)，也就是說輸入層到第一層隱藏層有(256 * 256) * (241 * 241)+1個參數（1為偏置項參數個數）。而在卷積神經網絡中，假設我們使用了一個大小為16 * 16的卷積核，則輸入層到第一層隱藏層的連接數為(256 * 256) * (16 * 16)，由於我們的卷積核是共享的，因此參數個數僅為 (16 * 16) + 1個。有時候為了提取圖像中不同的特徵，我們可能會使用多個卷積核，假設這裡我們使用了100個大小為16 * 16的卷積核，則輸入層到第一層隱藏層的參數個數也僅為100 * (16 * 16) + 1，這依然遠遠少於全連接神經網絡的參數個數。</p><p>根據圖4-11所示的例子我們可以看到卷積神經網絡的兩個重要特性：</p><p><strong>局部連接</strong>：全連接神經網絡中，第層的每一個神經元和第層的每一個神經元之間都有連接。而在卷積神經網絡中，第層的每一個神經元都只和第層的部分神經元之間有連接，而這個"部分"有多大，則具體取決於卷積核的大小。</p><p><strong>權值共享</strong>：在卷積神經網絡中，同一隱藏層的每一個神經元所使用的卷積核都是相同的，卷積核對同一隱藏層的神經元來說是共享的。</p><div class=pgc-img><img alt=TensorFlow系列專題（十二）：CNN最全原理剖析（序） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/27859481f604430bb47e6886f1904e69><p class=pgc-img-caption>圖1全連接神經網絡（左）和卷積神經網絡（右）連接數示例</p></div><p>在卷積層中，特徵圖（feature map，又稱為特徵映射）是輸入層的圖像（或其它的特徵圖）經過卷積之後得到的特徵輸出。一個卷積核只負責提取某一類特定的特徵，為了充分的提取出圖像中的信息，我們通常會使用多個卷積核。卷積層的一般性結構可以表示如下：</p><p><strong>1. 輸入特徵映射組</strong>：輸入特徵映射組 X(X∈R^(M×N×D)) 是一個三維的張量（tensor），其中每個切片（slice）矩陣 X^d (X^d∈R^(M×N),1≤d≤D)是一個輸入特徵映射。每個特徵映射的大小為M×N，D是輸入特徵映射的個數。</p><p><strong>2. 輸出特徵映射組</strong>：輸出特徵映射組Y(Y∈R^(M^'×N^'×P))也是一個三維張量，其中每個切片矩陣 Y^p (Y^p∈R^(M^'×N^' ),1≤p≤P)是一個輸出特徵映射。每個特徵映射的大小為M^'×N^'，P是輸出特徵映射的個數。</p><p><strong>3. 卷積核</strong>：卷積核W(W∈R^(m×n×D×P))是一個四維張量，其中每個切片矩陣 W^(p,d) (W^(p,d)∈R^(m×n),1≤p≤P,1≤d≤D)是一個二維的卷積核。</p><p>為了更直觀的理解，我們看如圖2所示的例子。示例中的輸入特徵映射組有兩個特徵映射，每個特徵映射的大小為5*5，對應有M=5,N=5,D=2。輸出特徵映射組有三個特徵映射，每個特徵映射的大小為3*3，對應有M=3,N=3,P=3。卷積核的維度是3*3*2*3，每個二維卷積核的大小為3*3，對應有m=3,n=3,D=2,P=3。</p><div class=pgc-img><img alt=TensorFlow系列專題（十二）：CNN最全原理剖析（序） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/683f6011f5754376830e80e16228cfdb><p class=pgc-img-caption>圖2一個卷積層的結構示例</p></div><p>圖3所示是卷積層中從輸入特徵映射組到輸出特徵映射組的計算過程示例。卷積核W^(p,1),W^(p,2),⋯,W^(p,D)分別對輸入的特徵映射X^1,X^2,⋯,X^D進行卷積，然後將卷積得到的結果相加，再加上一個偏置b^p後得到卷積層的淨輸入Z^p，如式1。最後經過一個非線性激活函數後得到輸出特徵映射Y^p，如式2，其中函數f(∙)為非線性激活函數。</p><div class=pgc-img><img alt=TensorFlow系列專題（十二）：CNN最全原理剖析（序） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a3890d3045e64d64864bad2a2e6ae616><p class=pgc-img-caption></p></div><p>在圖3所示的例子中，每一個輸入特徵映射都需要個卷積核和一個偏置。假設每個二維卷積核的大小為m×n，那麼該層卷積層共需要的參數個數為：(m×n)×P×D+P。</p><div class=pgc-img><img alt=TensorFlow系列專題（十二）：CNN最全原理剖析（序） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/deb686b66b284d9a8293cbcb27f9714d><p class=pgc-img-caption>圖3卷積層中計算過程示例</p></div><h1><strong>三、池化層</strong></h1><p>池化層（pooling layer）也稱為子採樣層（subsampling layer），池化層一般都是緊跟在卷積層之後，它的作用是進行特徵選擇，減少特徵的數量，進而減少網絡中參數的數量。</p><p>對於一個特徵映射，我們可以將其劃分為多個區域（這些區域可以有重合部分），池化就是對這些劃分後的區域進行下采樣（down sampling），然後得到一個值，並將這個值作為該區域的概括。池化層的方式有多種，一般常用的有最大池化（maximum pooling）和平均池化（mean pooling）。</p><p><strong>最大池化（maximum pooling）</strong>：選取區域內的最大值的神經元作為該區域的概括。</p><p><strong>平均池化（mean pooling）</strong>：取區域內所有神經元的均值作為該區域的概括。</p><p>如圖4是一個最大池化和均值池化的示例，這裡我們將一個特徵映射劃分為了4個區域，即池化窗口的大小為2×2，步長為2。</p><div class=pgc-img><img alt=TensorFlow系列專題（十二）：CNN最全原理剖析（序） onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3b3bfcb085914980ab2e1a9ac73a5efe><p class=pgc-img-caption>圖4 最大池化和平均池化示例</p></div><p>目前大多數卷積神經網絡中，池化層僅包含下采樣操作，池化層沒有需要訓練的參數。但在一些早期的卷積網絡中，會在池化層中使用一個非線性激活函數，例如我們會面會介紹的LeNet-5。現在，池化層的作用已經越來越小，通過增加捲積的步長也可以達到池化層同樣的效果。因此在目前一些比較新的卷積神經網絡中，池化層出現的頻率已經越來越低。</p><h1><strong>四、卷積神經網絡的基本結構</strong></h1><p>一個基本的卷積神經網絡通常是由卷積層、池化層和全連接層交叉堆疊而成。如圖5所示，由連續M個卷積層和h個池化層構成一個卷積塊（M的取值一般為1~5，h的取值一般為0或1），一個卷積神經網絡中可以堆疊N個連續的卷積塊（N的取值可以很大，較深的網絡可以達到100多層）。在個連續的卷積塊之後是K個連續的全連接層（K一般取1~2）。</p><div class=pgc-img><img alt=TensorFlow系列專題（十二）：CNN最全原理剖析（序） onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/13d2aae01b3b487db6fe6f7254a44ab0><p class=pgc-img-caption>圖5基本的卷積神經網絡結構示意圖</p></div><h1><strong>五、總結</strong></h1><p>本節介紹了卷積層的結構及池化層和卷積神經網絡的特性，下一節將結合代碼介紹基於CNN的一個實際比賽的冰山雷達波圖像識別項目。</p><h1><strong>六、參考文獻</strong></h1><p>[1] Alex Krizhevsky: ImageNet Classification with Deep Convolutional Neural Networks .NIPS 2012</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>TensorFlow</a></li><li><a>專題</a></li><li><a>CNN</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/96b22e09.html alt=TensorFlow系列專題（十二）：CNN最全原理剖析 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/0d594a544ebf49b0ae6f6a7915b953af style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/96b22e09.html title=TensorFlow系列專題（十二）：CNN最全原理剖析>TensorFlow系列專題（十二）：CNN最全原理剖析</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6ff19cd8.html alt=中小學作文訓練之描寫專題（九）場面描寫 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/75eab302c96d43e8a680908253f96bcc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6ff19cd8.html title=中小學作文訓練之描寫專題（九）場面描寫>中小學作文訓練之描寫專題（九）場面描寫</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fb690fd5.html alt="【軍訓專題】七日習武煉攻防 健體修身做棟樑（二）——記高一（6）班軍事訓練" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RXI4mYh2qsSmFV style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fb690fd5.html title="【軍訓專題】七日習武煉攻防 健體修身做棟樑（二）——記高一（6）班軍事訓練">【軍訓專題】七日習武煉攻防 健體修身做棟樑（二）——記高一（6）班軍事訓練</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1678b1c4.html alt=（收藏）Spring事務專題：事務的基本概念，Mysql事務處理原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/433259b5-1936-4cee-ab74-70aef36536ee style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1678b1c4.html title=（收藏）Spring事務專題：事務的基本概念，Mysql事務處理原理>（收藏）Spring事務專題：事務的基本概念，Mysql事務處理原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/83377bc0.html alt="專題2.7 實驗：探究彈力與彈簧伸長量的關係及驗證平行四邊形定則" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/15397434180389d5f41ed0d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/83377bc0.html title="專題2.7 實驗：探究彈力與彈簧伸長量的關係及驗證平行四邊形定則">專題2.7 實驗：探究彈力與彈簧伸長量的關係及驗證平行四邊形定則</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7799eb87.html alt=中考複習專題之半角模型 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/474fb2e71c604674a24a04465c43b957 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7799eb87.html title=中考複習專題之半角模型>中考複習專題之半角模型</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5b640ca5.html alt=半導體行業專題報告：模擬芯片，長坡厚雪好賽道 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8b732a7490af41789cff4cea5098e7a3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5b640ca5.html title=半導體行業專題報告：模擬芯片，長坡厚雪好賽道>半導體行業專題報告：模擬芯片，長坡厚雪好賽道</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/50222b2e.html alt=模擬芯片行業專題報告：龍頭如何崛起？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/9c6e0676583b4376a56789609cd2ecb3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/50222b2e.html title=模擬芯片行業專題報告：龍頭如何崛起？>模擬芯片行業專題報告：龍頭如何崛起？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/99186545.html alt=密度之空心、混合物質密度計算專題 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ed051756eeef47409536574ed9283c4c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/99186545.html title=密度之空心、混合物質密度計算專題>密度之空心、混合物質密度計算專題</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6e572fcc.html alt="Win10專題 | 十分硬核的Windows 10精簡教程（用戶文件篇）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/24d10164-2cf8-4f4e-a53d-18a1e5b1f85d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6e572fcc.html title="Win10專題 | 十分硬核的Windows 10精簡教程（用戶文件篇）">Win10專題 | 十分硬核的Windows 10精簡教程（用戶文件篇）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d260a748.html alt=測試開發專題：spring-boot統一異常捕獲 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/135918e30e2f4a2ea248b539eb383688 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d260a748.html title=測試開發專題：spring-boot統一異常捕獲>測試開發專題：spring-boot統一異常捕獲</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9ff880b4.html alt=「精華」科普專題-光纖通信入門知識彙總（2020.7.12） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/7070534fcf3c4960b98838ac6929c8de style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9ff880b4.html title=「精華」科普專題-光纖通信入門知識彙總（2020.7.12）>「精華」科普專題-光纖通信入門知識彙總（2020.7.12）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8eafd6ad.html alt="缺陷庫專題（三）| 缺陷的優先級別" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0568106c7cfa4eb2a6e3e1743599b4c0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8eafd6ad.html title="缺陷庫專題（三）| 缺陷的優先級別">缺陷庫專題（三）| 缺陷的優先級別</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/aa93bfe3.html alt=服務器開發專題1-程序，進程的區別和併發概念 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1534549004517ed1429f6ce style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/aa93bfe3.html title=服務器開發專題1-程序，進程的區別和併發概念>服務器開發專題1-程序，進程的區別和併發概念</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a11fff49.html alt=南京市高淳區固城街道秀山村召開垃圾分類工作專題培訓會 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/98bae3d75b924dd3bab1b755f58635f0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a11fff49.html title=南京市高淳區固城街道秀山村召開垃圾分類工作專題培訓會>南京市高淳區固城街道秀山村召開垃圾分類工作專題培訓會</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>