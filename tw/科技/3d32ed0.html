<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>關係型數據庫原理：數據庫的控制功能 | 极客快訊</title><meta property="og:title" content="關係型數據庫原理：數據庫的控制功能 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/8b23038a9a3149febfc812e9fa84aca8"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3d32ed0.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3d32ed0.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3d32ed0.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3d32ed0.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3d32ed0.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3d32ed0.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3d32ed0.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3d32ed0.html><meta property="article:published_time" content="2020-10-29T21:08:25+08:00"><meta property="article:modified_time" content="2020-10-29T21:08:25+08:00"><meta name=Keywords content><meta name=description content="關係型數據庫原理：數據庫的控制功能"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/3d32ed0.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>關係型數據庫原理：數據庫的控制功能</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>《大數據和人工智能交流》頭條號向廣大初學者新增C 、Java 、Python 、Scala、javascript 等目前流行的計算機、大數據編程語言，希望大家以後關注本頭條號更多的內容。</p><p><br></p><p>1、事務管理</p><p>事務是一個操作序列，這些操作“要麼都做，要麼不做”，是數據庫環境中不可分割的邏輯工作單位。事務和程序是兩個不同的概念，一般一個程序可包含多個事務。在SQL語言中，事務定義的語句有以下三條：</p><p>（1）BEGIN TRANSACTION</p><p>事務開始</p><p>（2）COMMIT</p><p>事務提交。該操作表示事務成功結束，它將通知事務管理器該事務的所有更新操作現在可以被提交或永久保留</p><p>（3）ROLLBACK</p><p>事務回滾。該操作表示事務非成功的結束，它將通知事務管理器出故障了，數據庫可能處於不一致狀態，該事務的所有更新操作必須回滾或撤銷</p><p>事務具有原子性（atomicity）、一致性(consistency)、隔離性(isolation)和持久性(durability)，這4個特性也稱為事務的ACID性質</p><p>（1）原子性</p><p>事務是原子的，要麼都做，要麼都不做</p><p>（2）一致性</p><p>事務執行的結果必須保證數據庫從一個一致性狀態變到另一個一致性狀態。因此，當數據庫只包含成功事務提交的結果時，稱數據庫處於一致性狀態</p><p>（3）隔離性</p><p>事務相互隔離。當多個事務併發執行時，任一事務的更新操作直到其成功提交的整個過程，對其它事務都是不可見的</p><p>（4）持久性</p><p>一旦事務提交成功，即使數據庫崩潰，對其數據庫的更新操作也將永久有效</p><p><br></p><p>2、數據庫的備份與恢復</p><p>在數據庫的運行過程中，難免會出現計算機系統的軟、硬件故障，這些故障會影響數據庫中數據的正確性，甚至破壞數據庫，使數據庫中的全部或部分數據丟失。因此，數據庫的關鍵技術在於建立冗餘數據，即備份數據。如何在系統出現故障後能夠及時的恢復到故障前的正確狀態，就是數據庫恢復技術</p><p><br></p><p>（1）故障類型</p><p>數據庫中有事務內部故障、系統故障、介質故障及計算機病毒</p><p>【1】事務內部故障</p><p>事務內部故障有的可以通過程序本身發現。例如，銀行轉賬事務，將賬戶A的金額轉X到賬戶B，此時應該將賬戶A的餘額-X，將賬戶B的餘額+X。如果賬戶A的餘額不足，那麼兩個事務都不做，否則都做。但有些事非預期的，不能由事務程序處理，例如運算溢出、併發事務發生死鎖等</p><p>【2】系統故障</p><p>通常稱為軟故障，是指造成系統停止運行的任何事件，使得系統要重新啟動。例如CPU故障、操作系統故障和突然停電</p><p>【3】介質故障</p><p>通常稱為硬故障，如磁盤損壞、磁頭碰撞和瞬時強磁干擾、此類故障發生的機率小，但破壞性大</p><p><br></p><p>【4】計算機病毒</p><p>計算機病毒是一種人為的故障和破壞，是在計算機程序中插入的破壞，計算機功能或數據可以繁殖和傳播的一組計算機指令或程序代碼</p><p><br></p><p>（2）備份方法</p><p>恢復的基本原理是“建立數據冗餘（重複存儲）”。建立冗餘數據的方法是進行數據轉儲和登記日誌文件。數據的轉儲分為靜態轉儲和動態轉儲、海量轉儲和增量轉儲</p><p>【1】靜態轉儲和動態轉儲</p><p>靜態轉儲是指在轉儲期間不允許對數據庫進行任何存取、修改操作；動態轉儲是在轉儲期間允許對數據進行存取、修改操作。因此，轉儲和用戶事務可並行執行</p><p>【2】海量轉儲和增量轉儲</p><p>海量轉儲是指每次轉儲全部數據；增量轉儲是指每次只轉儲上次轉儲後更新過的數據</p><p>【3】日誌文件</p><p>在事務處理過程中，DBMS把事務開始、事務結束以及對數據的插入、刪除、修改的每次操作寫入日誌文件。一旦發生故障，DBMS的恢復子系統利用日誌文件撤銷事務對數據庫的改變，回退到事務的初始狀態。因此，DBMS利用日誌文件來進行事務故障恢復和系統故障恢復，並可協助後備副本進行介質故障恢復</p><p>（3）恢復</p><p>事務恢復有以下3個步驟：</p><p>【1】反向掃描文件日誌（即從最後向前掃描日誌文件），查找該事務的更新操作</p><p>【2】對事務的更新操作執行逆操作</p><p>【3】繼續反向掃描日誌文件，查找該事務的其它更新操作，並做同樣處理，直到事務的開始 標誌</p><p>（4）數據庫鏡像</p><p>為了避免介質磁盤介質出現故障影響數據庫的可用性，許多DBMS提供數據庫鏡像功能用於數據庫恢復。需要說明的是，數據庫鏡像是通過複製數據實現的，但頻繁複制數據會降低系統運行效率。因此，在實際應用中往往對關鍵的數據和日誌文件鏡像</p><p><br></p><p>3、併發控制</p><p>所謂併發，是指在多用戶共享的系統中許多用戶可能同時對同一數據進行操作。併發操作帶來的問題是數據不一致，主要有三類：丟失更新、不可重複讀和讀髒數據。其主要原因是事務的併發操作破壞了事務的隔離性。DBMS的併發控制子系統負責協調併發事務執行，保證數據庫的完整性不受破壞，避免用戶得到不正確的數據</p><p>（1）併發操作帶來的問題</p><p>併發操作帶來數據不一致有三類：丟失修改、不可重複讀和讀髒數據</p><p>【1】丟失修改</p><p>如下圖，事務T1和T2都對數據A做減1操作。事務T1在t6時刻把A修改後的值15寫入數據庫，但事務T2在時刻t7再把它對A減1後的值15寫入。兩個事務都是對A的值進行減1操作並且都執行成功，但A中的值卻只減少1。例如，火車售票系統，T1和T2各售出一張票，但數據庫裡存票卻只減了1張，造成數據的不一致。原因在於T1事務對數據庫的修改被T2事務覆蓋丟失了破壞了事務的隔離性</p><p><br></p><div class=pgc-img><img alt=關係型數據庫原理：數據庫的控制功能 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8b23038a9a3149febfc812e9fa84aca8><p class=pgc-img-caption></p></div><p>【2】不可重複讀</p><p>事務T1讀取A、B的值後進行計算，事務T2在t6時刻對B的值做了修改以後，事務T1又重新讀取A、B的值再運算，同一事務內對同一組數據的相同運算結果不同，顯然與事實不相符。同樣事務T2干擾了事務T1的獨立性</p><p><br></p><div class=pgc-img><img alt=關係型數據庫原理：數據庫的控制功能 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/95a8621a814248858b5efcabf9d7f5b5><p class=pgc-img-caption></p></div><p>【3】讀髒數據</p><p>事務T1對數據C修改之後，在t4時刻事務T2讀取修改後的C值做處理，之後T1回滾，數據C恢復了原來的值，事務T2對C所做的處理是無效的，它讀的是被丟掉的垃圾值</p><p><br></p><div class=pgc-img><img alt=關係型數據庫原理：數據庫的控制功能 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/083fd3156fe144948a110df2f15cb4c3><p class=pgc-img-caption></p></div><p>通過以上3個例子，在事務並行處理的過程中對相同數據進行訪問導致數據的不一致性，解決該問題可以從保證事務的隔離性入手</p><p>（2）併發控制技術</p><p>併發控制的主要技術是封鎖。基本封鎖的類型有排它鎖（簡稱X鎖或者寫鎖）和共享鎖（簡稱S鎖或讀鎖）</p><p>【1】封鎖</p><p>排它鎖：若事務T對數據對象A加上X鎖，則只允許T讀取和修改A，其它事務都不能對A加任何類型的鎖，直到T釋放A上的鎖</p><p>共享鎖：若事務T對數據對象A加上S鎖，則只允許T讀取A，但不能修改A，其它事務只能再對A加S鎖，直到T釋放A上的S鎖。這就保證了其它事務可以讀A，但在T釋放A上S鎖之前不能對A進行任何修改</p><p><br></p><p>【2】三級鎖協議</p><p>一級鎖協議：事務在修改數據R之前必須先對其加鎖，直到事務結束才釋放。事務結束包括正常結束（Commit）和非正常結束（rollback）。一級鎖協議可以解決丟失更新問題</p><p>二級鎖協議：在一級鎖協議的基礎上，加上事務T在讀數據R之前必須先對其加S鎖。二級鎖協議可以幫助解決讀髒數據的問題。但是，由於二級鎖協議讀完了數據後即可釋放鎖，所以不能保證可重複讀</p><p>三級鎖協議：在一級鎖協議的基礎上，加上事務T在讀數據R之前必須先對加S鎖，直到事務結束時釋放S鎖。三級鎖協議除了防止丟失修改和不讀“髒”數據外，還進一步防止了不可重複讀</p><p><br></p><p>（3）活鎖與死鎖</p><p>所謂活鎖，是指當事務T1封鎖了數據R時，事務T2請求封鎖數據R，於是T2等待，當T1釋放了R上的鎖後，系統首先批准了T3 的請求，於是T2等待，當T3釋放了R上的鎖後又批准了T4請求，以此類推，使得T2可能永遠等待現象</p><p><br></p><p>所謂死鎖，指的是兩個以上的事務分別請求鎖住對方已經封鎖的數據，導致長期等待而無法繼續運行下去的現象</p><p>（4）併發調度的可串行性</p><p>多個事務併發執行是正確的，當且僅當其結果與某一次序串行的執行它們的結果相同，稱為這種調度策略是可串行化的調度</p><p>可串行性是併發事務正確性的準則，按這個準則規定，一個給定的併發調度，當僅當它可串行化才認為是正確的調度</p><p>（5）兩段封鎖協議</p><p>所謂兩段封鎖協議，是指所有事務必須分兩個階段對數據項加鎖和解鎖。即事務分兩個階段，第一個階段是獲得鎖，事務可以獲得任何數據項上的任何類型鎖，但不能釋放；第二階段是釋放鎖，事務可以釋放任何數據項上的任何類型的鎖，但不能申請</p><p>（6）鎖的粒度</p><p>封鎖對象的大小稱為鎖的粒度。封鎖對象可以是邏輯單元（如屬性、元組、關係、索引項、整個索引甚至整個數據庫），也可以是物理單元（如數據頁或索引頁）</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>數據庫</a></li><li><a>原理</a></li><li><a>功能</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/09f918a.html alt=電容器的工作原理及功能 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/5f3a5125480d409b986f953f0da5c23d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/09f918a.html title=電容器的工作原理及功能>電容器的工作原理及功能</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4adca96d.html alt=不鏽鋼旋轉樓梯—不鏽鋼旋轉樓梯的原理和尺寸介紹 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1532917894689e20edadba9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4adca96d.html title=不鏽鋼旋轉樓梯—不鏽鋼旋轉樓梯的原理和尺寸介紹>不鏽鋼旋轉樓梯—不鏽鋼旋轉樓梯的原理和尺寸介紹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/798c35eb.html alt=鼠標滾輪工作原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a32f01002df34196a3ca95824a0705c9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/798c35eb.html title=鼠標滾輪工作原理>鼠標滾輪工作原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0fe7a863.html alt=土壤採樣器的工作原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/3591b04ce0ef4b24b7f04dcf6d4f0e5a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0fe7a863.html title=土壤採樣器的工作原理>土壤採樣器的工作原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3269d080.html alt=MySQL數據庫的事務管理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/152203544367254a708f807 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3269d080.html title=MySQL數據庫的事務管理>MySQL數據庫的事務管理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dc1a27dd.html alt="詳解Oracle 數據庫啟動過程" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1538236609349861be8e044 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dc1a27dd.html title="詳解Oracle 數據庫啟動過程">詳解Oracle 數據庫啟動過程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ad3f3a1e.html alt="數據庫技術：MySQL 基礎和 SQL 入門，單表、約束和事務" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/107897c16ae7461caa62dd375b631afe style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ad3f3a1e.html title="數據庫技術：MySQL 基礎和 SQL 入門，單表、約束和事務">數據庫技術：MySQL 基礎和 SQL 入門，單表、約束和事務</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8ff1c7a8.html alt=解讀數據庫：深入分析MySQL中事務以及MVCC的實現原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/8f370516-d41a-4803-84ba-2c01e4637c8b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8ff1c7a8.html title=解讀數據庫：深入分析MySQL中事務以及MVCC的實現原理>解讀數據庫：深入分析MySQL中事務以及MVCC的實現原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/aa0b7a4a.html alt=文件櫃一般都有哪些功能呢 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/296a7aac43dd4b5289f8ca212bb3c16c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/aa0b7a4a.html title=文件櫃一般都有哪些功能呢>文件櫃一般都有哪些功能呢</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1c9afde0.html alt="一起來談談ThreadLocal 原理吧！你需要了解！" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/499a403f2b63464db8e3e12298c1a3e5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1c9afde0.html title="一起來談談ThreadLocal 原理吧！你需要了解！">一起來談談ThreadLocal 原理吧！你需要了解！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/203dfed4.html alt=和麵機的原理及運用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1bd01e6484624601ae66ef141b0cdbd7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/203dfed4.html title=和麵機的原理及運用>和麵機的原理及運用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2537ec20.html alt=和麵機的工作原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/01f3205782f045a2a5aec20d70b9efc8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2537ec20.html title=和麵機的工作原理>和麵機的工作原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4ac331a0.html alt=功率因素表的工作原理及接線方式 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/470a0003e8a9a1d2d829 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4ac331a0.html title=功率因素表的工作原理及接線方式>功率因素表的工作原理及接線方式</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/504d903f.html alt=疊加原理及其應用（第1集） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/504d903f.html title=疊加原理及其應用（第1集）>疊加原理及其應用（第1集）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/18681b55.html alt=PHP鏈接數據庫操作教程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3b10e2d3b35043f8ae9cb1823878b66a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/18681b55.html title=PHP鏈接數據庫操作教程>PHP鏈接數據庫操作教程</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>