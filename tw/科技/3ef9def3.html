<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>構建可維護的軟件 | 极客快訊</title><meta property="og:title" content="構建可維護的軟件 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/d4ed6e5397e34028815fafc5746a6758"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ef9def3.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ef9def3.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3ef9def3.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ef9def3.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ef9def3.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3ef9def3.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/3ef9def3.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/3ef9def3.html><meta property="article:published_time" content="2020-11-14T21:01:42+08:00"><meta property="article:modified_time" content="2020-11-14T21:01:42+08:00"><meta name=Keywords content><meta name=description content="構建可維護的軟件"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/3ef9def3.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>構建可維護的軟件</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>將基礎架構與應用程序分離</h1><div class=pgc-img><img alt=構建可維護的軟件 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d4ed6e5397e34028815fafc5746a6758><p class=pgc-img-caption>> Photo by Kevin Horvat on Unsplash</p></div><p></p><p>在過去的幾年中，我遇到了一些我不想談論的代碼。 我總是想知道項目如何才能以這種狀態結束，更重要的是，如何防止自己編寫遺留代碼。</p><h1 class=pgc-h-arrow-right>開始一個新項目</h1><p>開始一個新項目總是很令人興奮。 使用許多新技術並編寫比上次更好的代碼的絕好機會。</p><p>這看起來像是微服務的完美項目！</p><p>別誤會我，我喜歡微服務，但您不應該從它開始。 除非您已經在微服務環境中工作，否則這太過分了。</p><p>相反，請確保您的代碼已準備好進行分離。 有很多方法可以做到這一點。 問題是，您需要走多遠。 它仍然只是MVP，我們希望在數週而不是數月內發佈項目。 但是，我們也不想為此做噩夢。</p><p>在我看來，有兩種選擇</p><p>· 快速而骯髒地建造東西。 當人們開始使用它時，我們會將其丟棄並正確構建。</p><p>· 分開應用程序的某些部分，以便我們在需要時可以替換它們。 節省執行時間，而不是分開。</p><h1 class=pgc-h-arrow-right>建造和更換</h1><p>這可能是一個非常好的方法，尤其是當我們快速想測試人們是否喜歡我們的產品時。</p><p>但是，當產品成功後，我們將不得不重寫所有內容，說實話。 它在生產中運行後真的要從頭開始構建嗎？ 可能不是。</p><p>當然，如果產品成功，則有一天它將被重寫。 但這可能要花費數年的時間，而且如果不幸的話，您最終可能會處理具有超過一萬行代碼的文件。</p><p>我認為我已在10782行中找到了該錯誤。</p><p>這可能有點誇張，但您明白了。</p><p>如果您的目標是測試某個想法，請絕對考慮使用此選項，只需確保對其進行重構即可。</p><h1 class=pgc-h-arrow-right>將基礎架構與應用程序分離</h1><p>這將花費更多時間，但是如果項目失敗，我們可以將一些代碼重用於另一個項目。 但是，如果執行不正確，我們可能最終仍會重構整個項目。</p><p>那麼，我們如何分隔項目以保持其可維護性呢？</p><p>讓我們從創建基礎架構和應用程序層開始。</p><div class=pgc-img><img alt=構建可維護的軟件 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/aac97c27a6fb421a9c587f2a386dadb3><p class=pgc-img-caption></p></div><p>基礎結構層將包含管理任何網絡請求的所有類。 從接收API調用到與數據存儲進行通信。 這是項目開始時最重要的部分。</p><p>假設我們為MVP選擇了一個SQLite數據庫。 只要確保實現隱藏在接口後面，我們就可以在必要時輕鬆替換數據存儲。</p><p>處理傳入請求有點不同。 但是目標是相同的。 我們可以使用命令對象將處理請求的方式與處理請求的方式分開。 讓我們看看以下示例。</p><div class=pgc-img><img alt=構建可維護的軟件 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2487de6262dd49fb8fa0a138c573d34b><p class=pgc-img-caption></p></div><p>我們有一個控制器，它接收創建新主題的請求。 控制器會將數據從HTTP請求轉換為命令對象。 該對象將包含我們要執行的突變所需的所有數據。 我們可以將此對象傳遞給位於應用程序層中的服務。 服務本身對HTTP請求一無所知。 因此，我們可以輕鬆地由消費者替換我們的控制器，甚至可以同時支持兩個控制器：</p><div class=pgc-img><img alt=構建可維護的軟件 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0b512912162444199407dc3b0e6443fc><p class=pgc-img-caption></p></div><p>然後，我們的主題服務將決定是否應創建主題。 主題獨特嗎？ 標題符合要求嗎？ 這些業務規則應放在應用程序層內。 如果所有斷言都通過，則服務將在存儲庫上執行create方法。 請務必僅通過接口引用存儲庫，這一點很重要。</p><div class=pgc-img><img alt=構建可維護的軟件 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9c7fdecca8984733b936d8a9655a3ae7><p class=pgc-img-caption></p></div><p>假設我們現在想用MySQL數據庫替換SQLite數據庫。 為此，我們只需要創建一個新的存儲庫，實現現有接口並將其注入主題服務中即可。</p><p>通過將基礎架構與業務邏輯分開，我們可以更輕鬆地替換應用程序的某些部分。 當然，僅創建兩個文件夾和一些類不足以阻止現有的舊應用程序。 我們仍然需要不時更新我們的服務。</p><h1 class=pgc-h-arrow-right>分離不同的上下文</h1><p>確保將應用程序的不同部分分成各自的上下文。 我們不希望有一個包含數百個控制器的Controller文件夾。 每個上下文都應具有自己的基礎結構和應用程序層。 某些類（例如記錄器）可以在上下文之間共享。 這些共享的類可以放在Common文件夾中。</p><p>src/ Topic/ Application/ Infrastructure/ Account/ Application/ Infrastructure/ Common/</p><p>另外，請嘗試避免直接引用其他上下文。 您可以使用事件在它們之間進行通信。 如果必須引用另一個上下文，請確保僅在基礎結構層中引用它。 當您的應用程序變得很大時，這種分離使遷移到微服務體系結構變得容易得多。</p><h1 class=pgc-h-arrow-right>最後的想法</h1><p>新項目的截止日期通常很緊。 通過將項目分為兩層，我們將能夠在確保質量和可擴展性的同時快速交付。</p><p>關於這個話題還有很多要說的。 如果您喜歡將應用程序劃分為不同的層，則可能還需要：</p><p>· 六角形建築</p><p>· 分層架構</p><p>· 域驅動設計</p><p>感謝您閱讀本文。 如果喜歡，請考慮關注我，下次再見！</p><p>(本文翻譯自Stein Janssen的文章《Building Maintainable Software》，參考：https://levelup.gitconnected.com/building-maintainable-software-50c6bd09c611)</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>構建</a></li><li><a>可維護</a></li><li><a>軟件</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/321b6cd8.html alt=如何構建更好，更快和更強大的軟件 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/78560cbadc5246239f7a304c78c6c31f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/321b6cd8.html title=如何構建更好，更快和更強大的軟件>如何構建更好，更快和更強大的軟件</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bcc3f9eb.html alt=解讀新規範——構建精細化橋樑之路 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/9317d74f6fd541a6b6e1e5269a0a549c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bcc3f9eb.html title=解讀新規範——構建精細化橋樑之路>解讀新規範——構建精細化橋樑之路</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c08f7fcf.html alt=寶信軟件：公司聚焦大數據、人工智能、虛擬製造等七大關鍵技術的研究 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c08f7fcf.html title=寶信軟件：公司聚焦大數據、人工智能、虛擬製造等七大關鍵技術的研究>寶信軟件：公司聚焦大數據、人工智能、虛擬製造等七大關鍵技術的研究</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c214d3b9.html alt=聲音錄製，用軟件算法模擬硬件也能出專業效果 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/15374046796064ae0d9cd60 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c214d3b9.html title=聲音錄製，用軟件算法模擬硬件也能出專業效果>聲音錄製，用軟件算法模擬硬件也能出專業效果</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5aff079a.html alt="ACL 2018｜中科院軟件研究所：基於端到端語義圖生成的語義解析" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1528975110519ee64a67c03 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5aff079a.html title="ACL 2018｜中科院軟件研究所：基於端到端語義圖生成的語義解析">ACL 2018｜中科院軟件研究所：基於端到端語義圖生成的語義解析</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9552c1b8.html alt="軟件開發中數據庫必備基礎01 - 圖解事務基礎" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e4e00ac778db451792b955bde23add02 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9552c1b8.html title="軟件開發中數據庫必備基礎01 - 圖解事務基礎">軟件開發中數據庫必備基礎01 - 圖解事務基礎</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/77f10720.html alt=電子設計軟件公司Altium稱電子設計的銷售繼續保持暫停狀態 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/67743491955d426094a06d714d9aefe4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/77f10720.html title=電子設計軟件公司Altium稱電子設計的銷售繼續保持暫停狀態>電子設計軟件公司Altium稱電子設計的銷售繼續保持暫停狀態</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/00241cd4.html alt="EmStat Pico：支持軟件運行的嵌入式小型電化學恆電勢器系統化" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/8354687ee778482b91fcf358548742a1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/00241cd4.html title="EmStat Pico：支持軟件運行的嵌入式小型電化學恆電勢器系統化">EmStat Pico：支持軟件運行的嵌入式小型電化學恆電勢器系統化</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8f16596d.html alt="EmStat Pico：支持軟件運行的嵌入式小型電化學恆電勢器系統化模塊" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RzUhNnv9Rg64Gv style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8f16596d.html title="EmStat Pico：支持軟件運行的嵌入式小型電化學恆電勢器系統化模塊">EmStat Pico：支持軟件運行的嵌入式小型電化學恆電勢器系統化模塊</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9c87514a.html alt=構建高速公路數字化運營管理體系！中交高速隧道水消防自動監測系統正式上線 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8f31532172f24b1483fd817526874c6c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9c87514a.html title=構建高速公路數字化運營管理體系！中交高速隧道水消防自動監測系統正式上線>構建高速公路數字化運營管理體系！中交高速隧道水消防自動監測系統正式上線</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a203c47f.html alt=納米軟件案例之射頻同軸電纜自動測試系統 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d6acc7338cf44ab4b1b1ededf42bee46 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a203c47f.html title=納米軟件案例之射頻同軸電纜自動測試系統>納米軟件案例之射頻同軸電纜自動測試系統</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4cf95694.html alt="無需軟件：在線提取 QQ 群成員方法" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/f8c3e5d8-4614-4261-99f2-52f523f48300 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4cf95694.html title="無需軟件：在線提取 QQ 群成員方法">無需軟件：在線提取 QQ 群成員方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6ac95342.html alt=18只百元股白酒佔4席，頂點軟件漲近3倍成選秀狀元 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RNrF830IcL5kjJ style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6ac95342.html title=18只百元股白酒佔4席，頂點軟件漲近3倍成選秀狀元>18只百元股白酒佔4席，頂點軟件漲近3倍成選秀狀元</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d05c2c91.html alt=注意！頂點軟件：股東金石投資減持約168萬股，減持計劃時間已過半 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/SAYG0O94vwve4T style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d05c2c91.html title=注意！頂點軟件：股東金石投資減持約168萬股，減持計劃時間已過半>注意！頂點軟件：股東金石投資減持約168萬股，減持計劃時間已過半</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0400ef60.html alt=減持！頂點軟件：監事擬減持不超過35.78萬股 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/S9muvLnBNZ6YG9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0400ef60.html title=減持！頂點軟件：監事擬減持不超過35.78萬股>減持！頂點軟件：監事擬減持不超過35.78萬股</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>