<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>網絡知識盲區：扒開TCP的外衣，圖解看清TCP-IP協議 | 极客快訊</title><meta property="og:title" content="網絡知識盲區：扒開TCP的外衣，圖解看清TCP-IP協議 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/cb64b31d13854e71b3ba2986865ba208"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/40b5174.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/40b5174.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/40b5174.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/40b5174.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/40b5174.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/40b5174.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/40b5174.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/40b5174.html><meta property="article:published_time" content="2020-10-29T20:50:28+08:00"><meta property="article:modified_time" content="2020-10-29T20:50:28+08:00"><meta name=Keywords content><meta name=description content="網絡知識盲區：扒開TCP的外衣，圖解看清TCP-IP協議"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/40b5174.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>網絡知識盲區：扒開TCP的外衣，圖解看清TCP-IP協議</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>本文通過圖來梳理TCP-IP協議相關知識。TCP通信過程包括三個步驟：建立TCP連接通道，傳輸數據，斷開TCP連接通道。如圖1所示，給出了TCP通信過程的示意圖。</p><div class=pgc-img><img alt=網絡知識盲區：扒開TCP的外衣，圖解看清TCP-IP協議 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/cb64b31d13854e71b3ba2986865ba208></div><p>圖1 TCP 三次握手四次揮手</p><p>圖1主要包括三部分：建立連接、傳輸數據、斷開連接。</p><p>1)建立TCP連接很簡單，通過三次握手便可建立連接。</p><p>2)建立好連接後，開始傳輸數據。TCP數據傳輸牽涉到的概念很多：超時重傳、快速重傳、流量控制、擁塞控制等等。</p><p>3)斷開連接的過程也很簡單，通過四次握手完成斷開連接的過程。</p><p><strong>三次握手建立連接：</strong></p><p>第一次握手：客戶端發送syn包(seq=x)到服務器，並進入SYN_SEND狀態，等待服務器確認;</p><p>第二次握手：服務器收到syn包，必須確認客戶的SYN(ack=x+1)，同時自己也發送一個SYN包(seq=y)，即SYN+ACK包，此時服務器進入SYN_RECV狀態;</p><p>第三次握手：客戶端收到服務器的SYN+ACK包，向服務器發送確認包ACK(ack=y+1)，此包發送完畢，客戶端和服務器進入ESTABLISHED狀態，完成三次握手。</p><p>握手過程中傳送的包裡不包含數據，三次握手完畢後，客戶端與服務器才正式開始傳送數據。理想狀態下，TCP連接一旦建立，在通信雙方中的任何一方主動關閉連接之前，TCP 連接都將被一直保持下去。</p><p><strong>傳輸數據過程：</strong></p><p>a.超時重傳</p><p>超時重傳機制用來保證TCP傳輸的可靠性。每次發送數據包時，發送的數據報都有seq號，接收端收到數據後，會回覆ack進行確認，表示某一seq號數據已經收到。發送方在發送了某個seq包後，等待一段時間，如果沒有收到對應的ack回覆，就會認為報文丟失，會重傳這個數據包。</p><p>b.快速重傳</p><p>接受數據一方發現有數據包丟掉了。就會發送ack報文告訴發送端重傳丟失的報文。如果發送端連續收到標號相同的ack包，則會觸發客戶端的快速重傳。比較超時重傳和快速重傳，可以發現超時重傳是發送端在傻等超時，然後觸發重傳;而快速重傳則是接收端主動告訴發送端數據沒收到，然後觸發發送端重傳。</p><p>c.流量控制</p><p>這裡主要說TCP滑動窗流量控制。TCP頭裡有一個字段叫Window，又叫Advertised-Window，這個字段是接收端告訴發送端自己還有多少緩衝區可以接收數據。於是發送端就可以根據這個接收端的處理能力來發送數據，而不會導致接收端處理不過來。 滑動窗可以是提高TCP傳輸效率的一種機制。</p><p>d.擁塞控制</p><p>滑動窗用來做流量控制。流量控制只關注發送端和接受端自身的狀況，而沒有考慮整個網絡的通信情況。擁塞控制，則是基於整個網絡來考慮的。考慮一下這樣的場景：某一時刻網絡上的延時突然增加，那麼，TCP對這個事做出的應對只有重傳數據，但是，重傳會導致網絡的負擔更重，於是會導致更大的延遲以及更多的丟包，於是，這個情況就會進入惡性循環被不斷地放大。試想一下，如果一個網絡內有成千上萬的TCP連接都這麼行事，那麼馬上就會形成“網絡風暴”，TCP這個協議就會拖垮整個網絡。為此，TCP引入了擁塞控制策略。擁塞策略算法主要包括：慢啟動，擁塞避免，擁塞發生，快速恢復。</p><p><strong>四次握手斷開連接：</strong></p><p>第一次揮手：主動關閉方發送一個FIN，用來關閉主動方到被動關閉方的數據傳送，也就是主動關閉方告訴被動關閉方：我已經不會再給你發數據了(當然，在fin包之前發送出去的數據，如果沒有收到對應的ack確認報文，主動關閉方依然會重發這些數據)，但此時主動關閉方還可以接受數據。</p><p>第二次揮手：被動關閉方收到FIN包後，發送一個ACK給對方，確認序號為收到序號+1(與SYN相同，一個FIN佔用一個序號)。</p><p>第三次揮手：被動關閉方發送一個FIN，用來關閉被動關閉方到主動關閉方的數據傳送，也就是告訴主動關閉方，我的數據也發送完了，不會再給你發數據了。</p><p>第四次揮手：主動關閉方收到FIN後，發送一個ACK給被動關閉方，確認序號為收到序號+1，至此，完成四次揮手。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>TCP</a></li><li><a>網絡</a></li><li><a>知識</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/6474ccee.html alt=點對點網絡的基本知識分享 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8678a34470a144ad88fc0487f0d8da91 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6474ccee.html title=點對點網絡的基本知識分享>點對點網絡的基本知識分享</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a660d731.html alt=網絡基本概念-TCP/IP架構及各層網絡協議 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/7f834ac140184ca6a079de4d0d3e515c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a660d731.html title=網絡基本概念-TCP/IP架構及各層網絡協議>網絡基本概念-TCP/IP架構及各層網絡協議</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/86e033bc.html alt=前端要知道的網絡知識三：認識OSI七層模型 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/222c6f2c-ae3d-41d5-9e3f-e344f24d2e6c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/86e033bc.html title=前端要知道的網絡知識三：認識OSI七層模型>前端要知道的網絡知識三：認識OSI七層模型</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d1703d4a.html alt=網絡內核之TCP是如何發送和接收消息的 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/d1b708de7db2403cbc70a570db2177f0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d1703d4a.html title=網絡內核之TCP是如何發送和接收消息的>網絡內核之TCP是如何發送和接收消息的</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9c95b6a2.html alt=電腦網絡知識：超文本傳輸協議(HTTP)的學習 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/dd62b1e29a5548f3bd7714f348272da2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9c95b6a2.html title=電腦網絡知識：超文本傳輸協議(HTTP)的學習>電腦網絡知識：超文本傳輸協議(HTTP)的學習</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b43524ea.html alt="網絡安全 | 小才子不得不知道的網絡安全知識！" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RcXFjwQ3pvBZmg style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b43524ea.html title="網絡安全 | 小才子不得不知道的網絡安全知識！">網絡安全 | 小才子不得不知道的網絡安全知識！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5fb22495.html alt=那些你可能不知道的網絡冷知識奇技淫巧 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4580a9a9cee342f6b4414d49ee87e174 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5fb22495.html title=那些你可能不知道的網絡冷知識奇技淫巧>那些你可能不知道的網絡冷知識奇技淫巧</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0ecbe660.html alt=網絡基礎知識-計算機基本組成結構及存儲器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0ecbe660.html title=網絡基礎知識-計算機基本組成結構及存儲器>網絡基礎知識-計算機基本組成結構及存儲器</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/c7528b6b.html alt=高中數學知識網絡結構圖，適合教學 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3f02d1e0b6ea446898ec82611eaf59c1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/c7528b6b.html title=高中數學知識網絡結構圖，適合教學>高中數學知識網絡結構圖，適合教學</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/6d4c7f1e.html alt=如何免費製作一份網絡安全知識競賽？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/54aa58c5-6566-4eba-82d4-bc92748029be style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/6d4c7f1e.html title=如何免費製作一份網絡安全知識競賽？>如何免費製作一份網絡安全知識競賽？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2eb6f16c.html alt="一文讀懂 TCP/IP 網絡模型" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/c7aa7812af5c4f46b1cfc94a150dc976 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2eb6f16c.html title="一文讀懂 TCP/IP 網絡模型">一文讀懂 TCP/IP 網絡模型</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/975b3725.html alt=網絡知識：OSI開放式互聯參考模型，與實現：TCP/IP class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/124074e718154ea9b6802b226f24ab89 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/975b3725.html title=網絡知識：OSI開放式互聯參考模型，與實現：TCP/IP>網絡知識：OSI開放式互聯參考模型，與實現：TCP/IP</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/459f2fb1.html alt=計算機知識之網絡通信基礎 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/4aed0001096359476368 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/459f2fb1.html title=計算機知識之網絡通信基礎>計算機知識之網絡通信基礎</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/90614ae7.html alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8d304ea806844def81454ee6df8f69d6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/90614ae7.html title=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課>電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dba885a9.html alt=計算機網絡知識看這一篇文章就夠了 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/764877f718574ec99a7c58c8ce88f446 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dba885a9.html title=計算機網絡知識看這一篇文章就夠了>計算機網絡知識看這一篇文章就夠了</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>