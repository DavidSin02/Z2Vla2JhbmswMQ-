<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>「安卓逆向」去除某銀行app簽名校驗 | 极客快訊</title><meta property="og:title" content="「安卓逆向」去除某銀行app簽名校驗 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/7018e55f6c3a4397af1e14a01e6fbb13"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/418dd7b.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/418dd7b.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/418dd7b.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/418dd7b.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/418dd7b.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/418dd7b.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/418dd7b.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/418dd7b.html><meta property="article:published_time" content="2020-10-29T21:04:28+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:28+08:00"><meta name=Keywords content><meta name=description content="「安卓逆向」去除某銀行app簽名校驗"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/418dd7b.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>「安卓逆向」去除某銀行app簽名校驗</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>首先，祝大家新年快樂！新的一年紅紅火火！</p><p>前段時間有個朋友聯繫到我 ，說有家安全公司招聘(哪家公司我就不說了) 但是面試題目第一題就難著了。這我哪兒能忍，直接幹!</p><p>拿到app的時候我心涼了一下 ，這銀行我搞個錘子，但是逆向工程師絕不認輸!</p><p>直接重新簽名安裝 ，果然不出意外崩潰。</p><p>現在勒讓我們捋捋思路，在程序一啟動就崩潰，說明校驗是存放在入口點或者入口頁面的初始化函數裡面。先掏出我們的逆向工具 jadx反編譯一波，找到AndroidManifest.xml文件裡面 我們知道入口點比入口頁面執行的時機要早 ，直接先從入口點的onCreate()函數入手。</p><div class=pgc-img><img alt=「安卓逆向」去除某銀行app簽名校驗 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7018e55f6c3a4397af1e14a01e6fbb13><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=「安卓逆向」去除某銀行app簽名校驗 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15359a922dfe46ee9339251fef713e7c><p class=pgc-img-caption></p></div><p>直接往下跟捋捋邏輯</p><p>Java層其實沒啥東西，只要你思路清晰一眼就能看出來 ，這個onCreate()函數首先調用了一些super 然後註冊了一些事件 ，下面我們看到了一句代碼：</p><div class=pgc-img><img alt=「安卓逆向」去除某銀行app簽名校驗 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/39c5906940de417387913acfb7084f0d><p class=pgc-img-caption></p></div><p>Init這又在初始化什麼??? 過去看看：</p><div class=pgc-img><img alt=「安卓逆向」去除某銀行app簽名校驗 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/3ff1a9fff6de409eb7748a3a6d23f07a><p class=pgc-img-caption></p></div><p><br></p><p>System.loadLibrary加載了這個so庫 ，上面還有個native關鍵詞修飾的getSignatures();函數。</p><p>這就有點敏感了，心裡已經10有8 9確定了簽名校驗在so層 ，然後這個init又調用了一個native_init函數 傳入了一個context ，既然如此就去so看看：</p><p><br></p><div class=pgc-img><img alt=「安卓逆向」去除某銀行app簽名校驗 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a27f3955c6dd44269d5411e0be9705b5><p class=pgc-img-caption></p></div><p>So文件還是挺多的 直接拖出來 ，放進ida反編譯一波。</p><p>找到節區分析，逆向分析思路一定得要清晰 ，先不慌搜索註冊得函數，先看一波init跟init_array ，不清楚這部操作的小貼友們不要慌 ，推薦學習一下so文件的加載流程以及ELF文件結構 (可能下篇文章會詳細講到，不過市面上也有很多百度一波就行。看不懂就留言我抽空自己寫一下以我理解的流程 ，嚼碎了給你)</p><p>言歸正轉，接著來：</p><div class=pgc-img><img alt=「安卓逆向」去除某銀行app簽名校驗 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/aa704f06b40740638754fe91a8689a60><p class=pgc-img-caption></p></div><p>沒有東西 ，可以鬆口氣了，要是再有東西就又多了幾步了。</p><p>接著找到導出函數窗口搜索一波</p><div class=pgc-img><img alt=「安卓逆向」去除某銀行app簽名校驗 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f9a564ccae1d4e9592ea8bd8a5f9f97b><p class=pgc-img-caption></p></div><p>採用了靜態註冊問題不大，來到這個函數</p><div class=pgc-img><img alt=「安卓逆向」去除某銀行app簽名校驗 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4f28685193e94279950b0aca75619990><p class=pgc-img-caption></p></div><p>沒啥操作直接調用了_Z8init_libP7_JNIEnvP8_jobject 這個函數初始化，跟進</p><div class=pgc-img><img alt=「安卓逆向」去除某銀行app簽名校驗 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/da7519fdd9604d7cb9fe53b242eb7a79><p class=pgc-img-caption></p></div><p>又調用了_Z9check_appP7_JNIEnvP8_jobject函數 ，跟進</p><p>來到這個check_app函數裡面</p><div class=pgc-img><img alt=「安卓逆向」去除某銀行app簽名校驗 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/de4a2b7fa68b4a2a8f932212e7056ec5><p class=pgc-img-caption></p></div><p>發現這裡調用了這個get_sign這個函數，我們往上看他傳入了那些參數，R0寄存器是R4傳入的env ，R1寄存器就是R5傳入的jobject，R2寄存器就是調用上面的函數的返回值。</p><p>這裡先不看，現在分析到這裡我們可以通過他的函數名稱確定在這裡get獲取這個sign簽名。</p><div class=pgc-img><img alt=「安卓逆向」去除某銀行app簽名校驗 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/710676327beb490da6509015913d7b36><p class=pgc-img-caption></p></div><p>緊接著進行md5 sha系列的簽名運算</p><div class=pgc-img><img alt=「安卓逆向」去除某銀行app簽名校驗 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b5ab4a653345419f81d1217e4536b19c><p class=pgc-img-caption></p></div><p>我們也可以看一下他的運行流程</p><p>沒有混淆就是為所欲為</p><p>找到了這個get_sign獲取當前簽名了就好辦了，直接改這個調用就行，要是要改的乾淨一點可以從下面的判斷入手，直接改nop指令你就得注意下面的寄存器相關的使用了，稍不注意就gg。</p><p>改好以後直接運行，完美!</p><p><br></p><p>好了這個就講到這裡了，聽說月薪小20k ，流下了我月薪1800的淚水！</p><p><br></p><p>總結一下:現在安卓逆向安全行業的門檻還是挺低的，你品，你細品。這個銀行如果加殼(當然了銀行基本不會加殼) 就費時間了，還有就是對so文件的保護不夠好，關鍵點很好定位，基本不用動態就能分析出來 ，混淆也沒有，不過混淆也沒啥用，對咱逆向安全工程師來說都問題不大!</p><p>本面試題案例來源與網絡，如有侵權，請聯繫刪除</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>安卓</a></li><li><a>某銀行</a></li><li><a>app</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/c6fe44c8.html alt=下載安卓桌面便籤插件怎麼在手機桌面上設置添加顯示便籤組部件 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/5e8100039a46b9346f6f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c6fe44c8.html title=下載安卓桌面便籤插件怎麼在手機桌面上設置添加顯示便籤組部件>下載安卓桌面便籤插件怎麼在手機桌面上設置添加顯示便籤組部件</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/be39d1d2.html alt=個人信息被盜用？個稅app任職受僱信息異常可申訴解決 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/be39d1d2.html title=個人信息被盜用？個稅app任職受僱信息異常可申訴解決>個人信息被盜用？個稅app任職受僱信息異常可申訴解決</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/13598df5.html alt="安卓APP開發 | 簡單學Java從編程入門開始-基本數據類型" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/8d229cd404e34fc7844f91b6a8ef2e9c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/13598df5.html title="安卓APP開發 | 簡單學Java從編程入門開始-基本數據類型">安卓APP開發 | 簡單學Java從編程入門開始-基本數據類型</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/18e17223.html alt=不給流氓app一點機會，教你徹底凍結 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/ccbcee318c2142889cf6e92220c54b08 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/18e17223.html title=不給流氓app一點機會，教你徹底凍結>不給流氓app一點機會，教你徹底凍結</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/31b3261f.html alt=安卓逆向——Smali基本語法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/f2af1f64-11b6-47ee-8c66-6c93d7154493 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/31b3261f.html title=安卓逆向——Smali基本語法>安卓逆向——Smali基本語法</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/930bc89a.html alt=網購技巧：一文了解京東app各處優惠券領券位置 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/7bb7a015eb664ce485da06db1065521a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/930bc89a.html title=網購技巧：一文了解京東app各處優惠券領券位置>網購技巧：一文了解京東app各處優惠券領券位置</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/aac7505d.html alt="涉嫌違法違規 房天下app遭下架" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/c1e46b3d-827d-497d-83f5-e1bd47913eab style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/aac7505d.html title="涉嫌違法違規 房天下app遭下架">涉嫌違法違規 房天下app遭下架</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/1b630032.html alt="伴伴app怎麼約線下的人 邀約心儀網友操作方法" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/RJd6xq1Ho02nrg style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/1b630032.html title="伴伴app怎麼約線下的人 邀約心儀網友操作方法">伴伴app怎麼約線下的人 邀約心儀網友操作方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/14d27c7b.html alt=耐克app反場 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/14d27c7b.html title=耐克app反場>耐克app反場</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/75babb1a.html alt=水如初app class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8085991c4acc48ec9d383ccbbabafcc8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/75babb1a.html title=水如初app>水如初app</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d1ef0eed.html alt=好省app是騙局？大家千萬別做了！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8b89a5b54f314da79d87731544358f7a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d1ef0eed.html title=好省app是騙局？大家千萬別做了！>好省app是騙局？大家千萬別做了！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2ca44eea.html alt=朋友圈吸睛神奇，5款製圖app分享給你 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e1ecd1fa923742378877c7b304896297 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2ca44eea.html title=朋友圈吸睛神奇，5款製圖app分享給你>朋友圈吸睛神奇，5款製圖app分享給你</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4d0bfb56.html alt="一款能在安卓上製作3D模型（雕刻）的應用丨做模型So Easy 帶測試" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1525767183756f9e0162dc4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4d0bfb56.html title="一款能在安卓上製作3D模型（雕刻）的應用丨做模型So Easy 帶測試">一款能在安卓上製作3D模型（雕刻）的應用丨做模型So Easy 帶測試</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1aa236a0.html alt=五款安卓可以用的畫畫軟件，閒來無事時輕鬆上手 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/10108da7e973407db419690b9534e74a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1aa236a0.html title=五款安卓可以用的畫畫軟件，閒來無事時輕鬆上手>五款安卓可以用的畫畫軟件，閒來無事時輕鬆上手</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d392a4df.html alt=作圖app哪個好？推薦7款手機畫畫軟件 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1538963215204332a095c76 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d392a4df.html title=作圖app哪個好？推薦7款手機畫畫軟件>作圖app哪個好？推薦7款手機畫畫軟件</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>