<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>å¾é›¶é–‹å§‹å­¸ç¿’æ¯”ç‰¹å¹£é–‹ç™¼ï¼šå‰µå»ºéŒ¢åŒ…é‡è¦æ–¹æ³•ä¹‹å‰µå»ºç§é‘°åŠå…¬é‘° | æå®¢å¿«è¨Š</title><meta property="og:title" content="å¾é›¶é–‹å§‹å­¸ç¿’æ¯”ç‰¹å¹£é–‹ç™¼ï¼šå‰µå»ºéŒ¢åŒ…é‡è¦æ–¹æ³•ä¹‹å‰µå»ºç§é‘°åŠå…¬é‘° - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/476b088.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/476b088.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/476b088.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/476b088.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/476b088.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/476b088.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/476b088.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/476b088.html><meta property="article:published_time" content="2020-10-29T20:51:34+08:00"><meta property="article:modified_time" content="2020-10-29T20:51:34+08:00"><meta name=Keywords content><meta name=description content="å¾é›¶é–‹å§‹å­¸ç¿’æ¯”ç‰¹å¹£é–‹ç™¼ï¼šå‰µå»ºéŒ¢åŒ…é‡è¦æ–¹æ³•ä¹‹å‰µå»ºç§é‘°åŠå…¬é‘°"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/476b088.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>å¾é›¶é–‹å§‹å­¸ç¿’æ¯”ç‰¹å¹£é–‹ç™¼ï¼šå‰µå»ºéŒ¢åŒ…é‡è¦æ–¹æ³•ä¹‹å‰µå»ºç§é‘°åŠå…¬é‘°</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p><h2>å¯«åœ¨å‰é¢</h2>å‰µå»ºéŒ¢åŒ…å’Œäº¤æ˜“æ˜¯æ¯”ç‰¹å¹£æœ€é‡è¦çš„å…©æ–¹é¢ï¼Œæ¶‰åŠåˆ°å¾ˆå¤šå¾ˆå¤šçš„å…§å®¹ï¼Œé éä¸€ç¯‡æ–‡ç« èƒ½æ¦‚æ‹¬çš„å®Œã€‚ä¸Šä¸€ç¯‡å¾æ•´é«”ä¸Šè¬›è§£äº†éŒ¢åŒ…çš„å‰µå»ºæµç¨‹ï¼Œé›–ç„¶å·²ç¶“å¾ˆè©³ç´°äº†ï¼Œä½†é‚„æ˜¯æ¼æ‰äº†å¹¾å€‹é‡è¦çš„æ–¹æ³•ï¼Œå¾æœ¬ç¯‡é–‹å§‹æˆ‘å€‘è¬›è§£é€™å¹¾å€‹ç‰¹åˆ¥é‡è¦çš„æ–¹æ³•ã€‚å°éŒ¢åŒ…æ„Ÿèˆˆè¶£çš„æœ‹å‹ä¸€å®šä¸è¦éŒ¯èª¤ã€‚<h2>GenerateNewSeed</h2></p><p>é€™å€‹æ–¹æ³•ä¸»è¦ç”¨ä¾†ç”Ÿæˆç§é‘°/å…¬é‘°ï¼Œåœ¨ç”Ÿæˆå…¬é‘°å¾Œï¼Œèª¿ç”¨éŒ¢åŒ…å°è±¡çš„ <code>SetHDSeed</code>æ–¹æ³•ï¼Œæ ¹æ“šå…¬é‘°ç”Ÿæˆä¸€å€‹<code>CHDChain</code>å°è±¡ï¼ŒæŠŠå…¬é‘°ç¶“é SHA256ã€RIPEMD160 å…©æ¬¡å“ˆå¸Œè¿”å›å¾Œçš„ 20å€‹å­—ç¯€ 180 ä½å­—ç¬¦ä¸²ä½œç‚ºå®ƒçš„<code>seed_id</code>å±¬æ€§ï¼Œå¾è€Œä»¥å¾Œå¯ä»¥è¡ç”Ÿæ›´çš„æ“´å±•å…¬é‘°ã€‚</p><pre><code>void CWallet::SetHDSeed(const CPubKey&amp; seed){    LOCK(cs_wallet);    CHDChain newHdChain;    newHdChain.nVersion = CanSupportFeature(FEATURE_HD_SPLIT) ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;    newHdChain.seed_id = seed.GetID;    SetHDChain(newHdChain, false);}</code></pre><p>åœ¨å‰µå»ºéŒ¢åŒ…çš„éç¨‹ä¸­ï¼Œæœ¬æ–¹æ³•åŠä¸‹é¢çš„ <code>TopUpKeyPool</code>æ–¹æ³•ï¼Œå¯èƒ½æœƒè¢«èª¿ç”¨å…©æ¬¡ï¼Œä¸€æ¬¡åœ¨ç¬¬ä¸€æ¬¡å‰µå»ºéŒ¢åŒ…æ™‚ï¼Œå¦ä¸€æ¬¡åœ¨ç”¨æˆ¶æ˜ç¢ºå‡ç´šï¼Œä¸”éŒ¢åŒ…æ”¯æŒ HDï¼Œä½† HD æ²’å•Ÿç”¨çš„æƒ…æ³ä¸‹ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘å€‘é–‹å§‹æ­£å¼è¬›è§£é€™å€‹æ–¹æ³•ã€‚</p><ol><li>é¦–å…ˆï¼Œç”Ÿæˆä¸¦èª¿ç”¨ç§é‘°çš„ <code>MakeNewKey</code>ä¾†åˆå§‹åŒ–ç§é‘°ã€‚<pre><code>CKey key; key.MakeNewKey(true); </code></pre></li><li>ç„¶å¾Œï¼Œèª¿ç”¨ <code>DeriveNewSeed</code>æ–¹æ³•ï¼Œç”Ÿæˆä¸¦è¿”å›ç§é‘°å°æ‡‰çš„å…¬é‘°ã€‚<pre><code>return DeriveNewSeed(key); </code></pre></li></ol><p>æˆ‘å€‘å…ˆä¾†çœ‹ <code>MakeNewKey</code>é€™å€‹æ–¹æ³•ã€‚é€™å€‹æ–¹æ³•æ¯”è¼ƒç°¡å–®ï¼Œä½†æ˜¯éå¸¸é‡è¦ï¼Œå› ç‚ºæ­£æ˜¯é€™å€‹æ–¹æ³•ï¼Œç”Ÿæˆäº†çœŸæ­£æ„ç¾©ä¸Šçš„ç§é‘°ã€‚</p><pre><code>void CKey::MakeNewKey(bool fCompressedIn) {    do {        GetStrongRandBytes(keydata.data, keydata.size);    } while (!Check(keydata.data));    fValid = true;    fCompressed = fCompressedIn;}</code></pre><p><code>GetStrongRandBytes</code>æ–¹æ³•ï¼Œæ­£æ˜¯ç”Ÿæˆç§é‘°çš„éç¨‹ã€‚é€™å€‹æ–¹æ³•çš„åŸ·è¡Œé‚è¼¯å¦‚ä¸‹ï¼š</p><ol><li>ç”Ÿæˆä¸€å€‹ SHA512å°è±¡å’Œä¸€å€‹ç„¡ç¬¦è™Ÿå­—ç¬¦æ•¸çµ„ã€‚<pre><code>CSHA512 hasher; unsigned char buf[64]; </code></pre></li><li>é¦–å…ˆï¼Œèª¿ç”¨ <code>RandAddSeedPerfmon</code>æ–¹æ³•ï¼Œé€šé OpenSSL's RNG ç”Ÿæˆéš¨æ©Ÿæ•¸ï¼Œä¸¦é€²è¡Œ SHA512 å“ˆå¸Œã€‚<pre><code>RandAddSeedPerfmon; GetRandBytes(buf, 32); hasher.Write(buf, 32); </code></pre></li><li>ç„¶å¾Œï¼Œèª¿ç”¨ <code>GetOSRand</code>æ–¹æ³•ï¼Œé€šé OS RNG ç”Ÿæˆéš¨æ©Ÿæ•¸ï¼Œä¸¦é€²è¡Œ SHA512 å“ˆå¸Œã€‚<pre><code>GetOSRand(buf); hasher.Write(buf, 32); </code></pre></li><li>æœ€å¾Œï¼Œå¦‚æœ HW å¯ç”¨ï¼Œé€šé HW ç”Ÿæˆéš¨æ©Ÿæ•¸ï¼Œä¸¦é€²è¡Œ SHA512 å“ˆå¸Œã€‚<pre><code>if (GetHWRand(buf)) { hasher.Write(buf, 32); } </code></pre></li><li>æ¥ä¸‹ä¾†ï¼Œåˆä½µä¸¦æ›´æ–°ç‹€æ…‹ã€‚<pre><code>{ WAIT_LOCK(cs_rng_state, lock); hasher.Write(rng_state, sizeof(rng_state)); hasher.Write((const unsigned char*)&amp;rng_counter, sizeof(rng_counter)); ++rng_counter; hasher.Finalize(buf); memcpy(rng_state, buf + 32, 32); } </code></pre></li><li>ç„¶å¾Œï¼ŒæŠŠ <code>buf</code>æ•¸çµ„ä¸­çš„å…§å®¹æ‹·è²åˆ°è¼¸å‡ºåƒæ•¸ä¸­ï¼Œä¸¦æ¸…ç©ºæ•¸çµ„ä¸­çš„å…§å®¹ã€‚<pre><code>memcpy(out, buf, num); memory_cleanse(buf, 64); </code></pre></li></ol><p><code>Check</code>æ–¹æ³•å…§éƒ¨é€šéèª¿ç”¨<code>secp256k1_ec_seckey_verify</code>æ–¹æ³•ï¼Œæª¢æŸ¥ç§é‘°çš„æ•¸æ“šæ˜¯å¦æ»¿è¶³è¦æ±‚ï¼Œå¾Œè€…æ­£æ˜¯æ©¢åœ“æ›²ç·šç®—æ³•ç›¸é—œçš„ã€‚</p><p>æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘ä¾†çœ‹ <code>DeriveNewSeed</code>æ–¹æ³•æ˜¯å¦‚ä½•ç”Ÿæˆå…¬é‘°çš„ã€‚æ–¹æ³•åŸ·è¡Œé‚è¼¯å¦‚ä¸‹ï¼š</p><ol><li>ç”Ÿæˆç•¶å‰æ™‚é–“ï¼Œä¸¦ç”¨ç•¶å‰æ™‚é–“åˆå§‹åŒ–èœœé‘°å…ƒæ•¸æ“šã€‚<pre><code>int64_t nCreationTime = GetTime; CKeyMetadata metadata(nCreationTime); </code></pre></li><li>èª¿ç”¨ç§é‘°çš„ <code>GetPubKey</code>æ–¹æ³•ï¼Œç”Ÿæˆå…¬é‘°ã€‚æ–¹æ³•å…§éƒ¨æ­£æ˜¯é€šéæ©¢åœ“æ›²ç·šç®—æ³•ä¾†ç”Ÿæˆç§é‘°å°æ‡‰çš„å…¬é‘°ã€‚ä»£ç¢¼å¦‚ä¸‹ï¼Œæœ‰èˆˆè¶£çš„è®€è€…å¯ä»¥è‡ªè¡Œç ”ç©¶ã€‚<pre><code>assert(fValid); secp256k1_pubkey pubkey; size_t clen = CPubKey::PUBLIC_KEY_SIZE; CPubKey result; int ret = secp256k1_ec_pubkey_create(secp256k1_context_sign, &amp;pubkey, begin); assert(ret); secp256k1_ec_pubkey_serialize(secp256k1_context_sign, (unsigned char*)result.begin, &amp;clen, &amp;pubkey, fCompressed ? SECP256K1_EC_COMPRESSED : SECP256K1_EC_UNCOMPRESSED); assert(result.size == clen); assert(result.IsValid); return result; </code></pre></li><li>åŸ·è¡Œ <code>assert(key.VerifyPubKey(seed));</code>æ–¹æ³•ï¼Œé©—è­‰å…¬é‘°ç¢ºå¯¦æœ‰ç§é‘°ç›¸åŒ¹é…ã€‚</li><li>è¨­ç½®èœœé‘°å…ƒæ•¸æ“šçš„å…©å€‹å±¬æ€§ã€‚<pre><code>metadata.hdKeypath = "s"; metadata.hd_seed_id = seed.GetID; </code></pre><code>GetID</code>æ–¹æ³•ï¼Œç”¨å…¬é‘°çš„æ•¸æ“šç¶“é SHA256ã€RIPEMD160 å…©æ¬¡å“ˆå¸Œå¾Œç”Ÿæˆçš„å­—ç¬¦ä¸²ä¾†ç”Ÿæˆä¸€å€‹<code>CKeyID</code>å°è±¡ã€‚</li><li>æŠŠå¯†é‘°å…ƒæ•¸æ“šä¿å­˜åœ¨ <code>mapKeyMetadata</code>é›†åˆä¸­ã€‚<pre><code>mapKeyMetadata[seed.GetID()] = metadata; </code></pre></li><li>èª¿ç”¨ <code>AddKeyPubKey</code>æ–¹æ³•ï¼ŒæŠŠç§é‘°/å…¬é‘°åŠå…ƒæ•¸æ“šä¿å­˜åˆ°æ•¸æ“šåº«ã€‚å¦‚æœå‡ºéŒ¯ï¼Œæ‹‹å‡ºä¸€å€‹ç•°å¸¸ã€‚<pre><code>if (!AddKeyPubKey(key, seed)) throw std::runtime_error(std::string(__func__) + ": AddKeyPubKey failed"); </code></pre><code>AddKeyPubKey</code>æ–¹æ³•ç”Ÿæˆä¸€å€‹è¨ªå•æ•¸æ“šåº«çš„å°è±¡ï¼Œç„¶å¾Œèª¿ç”¨éŒ¢åŒ…å°è±¡çš„<code>AddKeyPubKeyWithDB</code>æ–¹æ³•ä¾†ä¿å­˜å¯†é‘°æ•¸æ“šã€‚å¾Œè€…çš„åŸ·è¡Œæµç¨‹å¦‚ä¸‹ï¼š<ul><li>å¦‚æœè®Šé‡ <code>encrypted_batch</code>ç‚ºç©ºï¼Œé‚£éº¼è¨­ç½®è®Šé‡<code>needsDB</code>ç‚ºçœŸã€‚å¦‚æœå¾Œè€…ç‚ºçœŸï¼Œé‚£éº¼è¨­ç½®<code>encrypted_batch</code>å±¬æ€§ç‚ºåƒæ•¸æŒ‡å®šçš„å°è±¡ã€‚<pre><code>bool needsDB = !encrypted_batch; if (needsDB) { encrypted_batch = &amp;batch; } </code></pre></li><li>èª¿ç”¨ <code>CCryptoKeyStore::AddKeyPubKey</code>æ–¹æ³•ï¼Œä¿å­˜ç§é‘°å’Œå…¬é‘°ã€‚å¦‚æœä¸æˆåŠŸï¼Œé€²ä¸€æ­¥ï¼Œå¦‚æœè®Šé‡<code>needsDB</code>ç‚ºçœŸï¼Œå‰‡è¨­ç½®è®Šé‡<code>encrypted_batch</code>ç‚ºå‡ã€‚<pre><code>if (!CCryptoKeyStore::AddKeyPubKey(secret, pubkey)) { if (needsDB) encrypted_batch = nullptr; return false; } </code></pre><code>CCryptoKeyStore::AddKeyPubKey</code>æ–¹æ³•å…§éƒ¨åŸ·è¡Œé‚è¼¯å¦‚ä¸‹ï¼š<ul><li>å¦‚æœæ²’æœ‰åŠ å¯†ï¼Œé‚£éº¼èª¿ç”¨ <code>CBasicKeyStore::AddKeyPubKey</code>ä¾†ä¿å­˜ç§é‘°å’Œå…¬é‘°ï¼Œç„¶å¾Œè¿”å›ã€‚<pre><code>if (!IsCrypted) { return CBasicKeyStore::AddKeyPubKey(key, pubkey); } </code></pre><code>IsCrypted</code>æ–¹æ³•ï¼Œåˆå§‹åŒ–æ™‚æ˜¯æ²’æœ‰åŠ å¯†çš„ï¼Œåªæœ‰åœ¨åŸ·è¡ŒåŠ é–ã€è§£é–ã€æ·»åŠ åŠ å¯†å¯†é‘°çš„æƒ…æ³ä¸‹æ‰æœƒæ˜¯åŠ å¯†çš„ã€‚ç•¶å‰æƒ…æ™¯æ˜¯æ²’æœ‰åŠ å¯†çš„ï¼Œæ‰€ä»¥åŸ·è¡ŒåŸºé¡çš„æ–¹æ³•ä¾†ä¿å­˜ç§é‘°å’Œå…¬é‘°ã€‚<p><code>CBasicKeyStore::AddKeyPubKey</code>æ–¹æ³•ï¼Œé¦–å…ˆæŠŠç§é‘°ä¿å­˜åœ¨<code>mapKeys</code>é›†åˆä¸­ï¼Œç„¶å¾Œèª¿ç”¨<code>ImplicitlyLearnRelatedKeyScripts</code>æ–¹æ³•ä¾†è™•ç†è…³æœ¬ï¼Œå› ç‚ºå…¬é‘°é»˜èªæ˜¯å£“ç¸®çš„ï¼Œæ‰€ä»¥åœ¨æ–¹æ³•å…§æœƒç”Ÿæˆè…³æœ¬ï¼Œä¸¦æŠŠè…³æœ¬ä¿å­˜åœ¨<code>mapScripts</code>é›†åˆä¸­ã€‚</p><pre><code>bool CBasicKeyStore::AddKeyPubKey(const CKey&amp; key, const CPubKey &amp;pubkey) { LOCK(cs_KeyStore); mapKeys[pubkey.GetID()] = key; ImplicitlyLearnRelatedKeyScripts(pubkey); return true; } </code></pre></li><li>å¦‚æœæ˜¯é–å®šçš„ï¼Œé‚£éº¼è¿”å›å‡ã€‚<pre><code>if (IsLocked) { return false; } </code></pre><code>IsLocked</code>æ–¹æ³•ï¼Œé¦–å…ˆèª¿ç”¨<code>IsCrypted</code>æ–¹æ³•ï¼Œç¢ºå®šæ˜¯å¦æ˜¯åŠ å¯†çš„ï¼Œå¦‚æœä¸æ˜¯åŠ å¯†çš„ï¼Œå‰‡ç›´æ¥è¿”å›å‡ï¼›å¦å‰‡ï¼ŒæŠŠ<code>vMasterKey</code>é›†åˆæ¸…ç©ºã€‚<pre><code>bool CCryptoKeyStore::IsLocked const { if (!IsCrypted) { return false; } LOCK(cs_KeyStore); return vMasterKey.empty; } </code></pre></li><li>æ¥ä¸‹ä¾†ï¼Œç”ŸæˆåŠ å¯†ç§é‘°ã€‚<pre><code>std::vector&lt;unsigned char&gt; vchCryptedSecret; CKeyingMaterial vchSecret(key.begin, key.end); if (!EncryptSecret(vMasterKey, vchSecret, pubkey.GetHash, vchCryptedSecret)) { return false; } </code></pre></li><li>æœ€å¾Œï¼Œèª¿ç”¨ <code>AddCryptedKey</code>æ–¹æ³•ï¼Œä¿å­˜åŠ å¯†ç§é‘°ï¼Œä¸¦è¿”å›<pre><code>if (!AddCryptedKey(pubkey, vchCryptedSecret)) { return false; } return true; </code></pre><code>AddCryptedKey</code>æ–¹æ³•ï¼Œé¦–å…ˆç¢ºå®šæ˜¯å¦æ˜¯åŠ å¯†çš„ï¼Œå¦‚æœæ²’æœ‰åŠ å¯†å‰‡è¿”å›å‡ã€‚æ¥ä¸‹ä¾†ï¼ŒæŠŠç§é‘°ä¿å­˜åœ¨<code>mapCryptedKeys</code>é›†åˆä¸­ï¼Œç„¶å¾Œèª¿ç”¨<code>ImplicitlyLearnRelatedKeyScripts</code>æ–¹æ³•ä¾†è™•ç†è…³æœ¬ï¼Œå› ç‚ºå…¬é‘°é»˜èªæ˜¯å£“ç¸®çš„ï¼Œæ‰€ä»¥åœ¨æ–¹æ³•å…§æœƒç”Ÿæˆè…³æœ¬ï¼Œä¸¦æŠŠè…³æœ¬ä¿å­˜åœ¨<code>mapScripts</code>é›†åˆä¸­ã€‚<pre><code>bool CCryptoKeyStore::AddCryptedKey(const CPubKey &amp;vchPubKey, const std::vector&lt;unsigned char&gt; &amp;vchCryptedSecret) { LOCK(cs_KeyStore); if (!SetCrypted) { return false; } mapCryptedKeys[vchPubKey.GetID()] = make_pair(vchPubKey, vchCryptedSecret); ImplicitlyLearnRelatedKeyScripts(vchPubKey); return true; } </code></pre></li></ul></li><li>å¦‚æœè®Šé‡ <code>needsDB</code>ç‚ºçœŸï¼Œå‰‡è¨­ç½®è®Šé‡<code>encrypted_batch</code>ç‚ºç©ºæŒ‡é‡ã€‚</li><li>èª¿ç”¨ <code>GetScriptForDestination</code>æ–¹æ³•ï¼Œç²å¾—å…¬é‘°å°æ‡‰çš„è…³æœ¬ã€‚<pre><code>CScript script; script = GetScriptForDestination(pubkey.GetID); </code></pre></li><li>èª¿ç”¨ <code>HaveWatchOnly</code>æ–¹æ³•ï¼Œæª¢æŸ¥<code>setWatchOnly</code>é›†åˆä¸­æ˜¯å¦æœ‰é€™å€‹è…³æœ¬ã€‚å¦‚æœæœ‰ï¼Œå‰‡èª¿ç”¨<code>RemoveWatchOnly</code>æ–¹æ³•ï¼Œæ¸…é™¤å…¬é‘°å°æ‡‰çš„è…³æœ¬ã€‚<pre><code>if (HaveWatchOnly(script)) { RemoveWatchOnly(script); } </code></pre><code>RemoveWatchOnly</code>æ–¹æ³•åŸ·è¡Œé‚è¼¯å¦‚ä¸‹ï¼š<ul><li>èª¿ç”¨ <code>CCryptoKeyStore::RemoveWatchOnly</code>æ–¹æ³•ä¾†ç§»é™¤è…³æœ¬ã€‚æ–¹æ³•å…§éƒ¨åŸ·è¡Œé‚è¼¯å¦‚ä¸‹ï¼šå¾<code>setWatchOnly</code>é›†åˆä¸­ç§»é™¤å°æ‡‰çš„è…³æœ¬ï¼›ç„¶å¾Œï¼Œèª¿ç”¨<code>ExtractPubKey</code>æ–¹æ³•ï¼Œé€šéè…³æœ¬ä¾†è§£æå‡ºå…¬é‘°ï¼Œå¦‚æœå¯ä»¥å¾—åˆ°å…¬é‘°ï¼Œå‰‡å¾<code>mapWatchKeys</code>é›†åˆä¸­ç§»é™¤å°æ‡‰çš„å…¬é‘°ï¼›æœ€å¾Œï¼Œè¿”å›çœŸã€‚</li><li>èª¿ç”¨æ•¸æ“šåº«è¨ªå•å°è±¡çš„ <code>EraseWatchOnly</code>æ–¹æ³•ï¼Œå¾æ•¸æ“šåº«ä¸­ç§»é™¤<code>watchmeta</code>å’Œ<code>watchs</code>å°æ‡‰çš„æ•¸æ“šã€‚</li><li>è¿”å›çœŸã€‚</li></ul></li><li>èª¿ç”¨ <code>GetScriptForRawPubKey</code>æ–¹æ³•ï¼Œå¾åŸå§‹å…¬é‘°ç²å¾—è…³æœ¬ã€‚<pre><code>script = GetScriptForRawPubKey(pubkey); </code></pre></li><li>èª¿ç”¨ <code>HaveWatchOnly</code>æ–¹æ³•ï¼Œæª¢æŸ¥<code>setWatchOnly</code>é›†åˆä¸­æ˜¯å¦æœ‰é€™å€‹è…³æœ¬ã€‚å¦‚æœæœ‰ï¼Œå‰‡èª¿ç”¨<code>RemoveWatchOnly</code>æ–¹æ³•ï¼Œæ¸…é™¤å…¬é‘°å°æ‡‰çš„è…³æœ¬ã€‚æ–¹æ³•åŸ·è¡Œé‚è¼¯å¦‚ä¸Šæ‰€è¿°ï¼Œé€™è£¡ä¸è¬›ã€‚</li><li>å¦‚æœä¸æ˜¯åŠ å¯†çš„ï¼Œå‰‡èª¿ç”¨æ•¸æ“šåº«çš„è¨ªå•å°è±¡çš„ <code>WriteKey</code>æ–¹æ³•ï¼ŒæŠŠç§é‘°å’Œå…¬é‘°åŠå¯†é‘°å…ƒæ•¸æ“šå¯«å…¥æ•¸æ“šåº«ã€‚åœ¨é€™å€‹æ–¹æ³•ä¸­ï¼Œé¦–å…ˆï¼Œä»¥<code>keymeta</code>ç‚ºéµï¼Œä¿å­˜å°æ‡‰çš„å…ƒæ•¸æ“šï¼›ç„¶å¾Œï¼ŒæŠŠå…¬é‘°/ç§é‘°ä¿å­˜åˆ°å‘é‡ä¸­ï¼Œä»¥<code>key</code>ç‚ºéµï¼Œä¿å­˜å°æ‡‰çš„å…¬é‘°/ç§é‘°ã€‚</li><li>æœ€å¾Œï¼Œè¿”å›çœŸã€‚</li></ul></li></ol></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>é›¶é–‹å§‹</a></li><li><a>å­¸ç¿’</a></li><li><a>å¹£é–‹ç™¼</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/97886d06.html alt="webå‰ç«¯ï¼ˆå¾é›¶é–‹å§‹ï¼‰ï¼Œæ¯å¤©æ›´æ–°å­¸ç¿’ç­†è¨˜ HTML5å…ƒç´ åˆ†é¡" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/46d70004fcd55e1ddad3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/97886d06.html title="webå‰ç«¯ï¼ˆå¾é›¶é–‹å§‹ï¼‰ï¼Œæ¯å¤©æ›´æ–°å­¸ç¿’ç­†è¨˜ HTML5å…ƒç´ åˆ†é¡">webå‰ç«¯ï¼ˆå¾é›¶é–‹å§‹ï¼‰ï¼Œæ¯å¤©æ›´æ–°å­¸ç¿’ç­†è¨˜ HTML5å…ƒç´ åˆ†é¡</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/84915242.html alt=ä¸€èµ·å¾é›¶é–‹å§‹å­¸ç¿’ç¶²çµ¡æ¶æ§‹è¨­è¨ˆ-å‡ºå£å€è¨­è¨ˆ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/9c9125f248b744768c280209b4917f01 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/84915242.html title=ä¸€èµ·å¾é›¶é–‹å§‹å­¸ç¿’ç¶²çµ¡æ¶æ§‹è¨­è¨ˆ-å‡ºå£å€è¨­è¨ˆ>ä¸€èµ·å¾é›¶é–‹å§‹å­¸ç¿’ç¶²çµ¡æ¶æ§‹è¨­è¨ˆ-å‡ºå£å€è¨­è¨ˆ</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/a837c314.html alt=å¾é›¶é–‹å§‹å­¸ç¿’pythonï¼ˆ6ï¼‰â€”â€”åˆ—è¡¨ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8c3b0d5080d3437eaea96e165d52f314 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/a837c314.html title=å¾é›¶é–‹å§‹å­¸ç¿’pythonï¼ˆ6ï¼‰â€”â€”åˆ—è¡¨>å¾é›¶é–‹å§‹å­¸ç¿’pythonï¼ˆ6ï¼‰â€”â€”åˆ—è¡¨</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f093fad.html alt=å¾é›¶é–‹å§‹å­¸ç¿’ä¸‰æ¥µç®¡ï¼Œè¬›å¾—å¾ˆè©³ç´°ï¼Œé€šä¿—æ˜“æ‡‚ï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/de3617d3884241f3ac33c0d6f0279d62 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f093fad.html title=å¾é›¶é–‹å§‹å­¸ç¿’ä¸‰æ¥µç®¡ï¼Œè¬›å¾—å¾ˆè©³ç´°ï¼Œé€šä¿—æ˜“æ‡‚ï¼>å¾é›¶é–‹å§‹å­¸ç¿’ä¸‰æ¥µç®¡ï¼Œè¬›å¾—å¾ˆè©³ç´°ï¼Œé€šä¿—æ˜“æ‡‚ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/329f8e4.html alt=è·Ÿè‘—ç¾å¥³è€å¸«å¾é›¶é–‹å§‹å­¸ç¿’Excel4-è¨­ç½®å–®å…ƒæ ¼é‚Šæ¡†ç·šå’Œå°é½Šæ–¹å¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5c2313dab7314bd5bba48a7e54f50574 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/329f8e4.html title=è·Ÿè‘—ç¾å¥³è€å¸«å¾é›¶é–‹å§‹å­¸ç¿’Excel4-è¨­ç½®å–®å…ƒæ ¼é‚Šæ¡†ç·šå’Œå°é½Šæ–¹å¼>è·Ÿè‘—ç¾å¥³è€å¸«å¾é›¶é–‹å§‹å­¸ç¿’Excel4-è¨­ç½®å–®å…ƒæ ¼é‚Šæ¡†ç·šå’Œå°é½Šæ–¹å¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f74c4fe8.html alt=å¾é›¶é–‹å§‹æœå‹™å™¨æ­å»ºwordpressç¶²ç«™è©³ç´°å»ºç«™æ•™ç¨‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/991db5d6ab1c4209bc6bb9fb185a69b3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f74c4fe8.html title=å¾é›¶é–‹å§‹æœå‹™å™¨æ­å»ºwordpressç¶²ç«™è©³ç´°å»ºç«™æ•™ç¨‹>å¾é›¶é–‹å§‹æœå‹™å™¨æ­å»ºwordpressç¶²ç«™è©³ç´°å»ºç«™æ•™ç¨‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dc2af9c9.html alt=æ©Ÿå™¨å­¸ç¿’ç­†è¨˜(ä¸ƒ)â€”â€”åˆè­˜é‚è¼¯è¿´æ­¸ã€ä¸åŒæ–¹æ³•æ¨å°æ¢¯åº¦å…¬å¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/13adbab9c7f94c7fa81d49a98861b051 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dc2af9c9.html title=æ©Ÿå™¨å­¸ç¿’ç­†è¨˜(ä¸ƒ)â€”â€”åˆè­˜é‚è¼¯è¿´æ­¸ã€ä¸åŒæ–¹æ³•æ¨å°æ¢¯åº¦å…¬å¼>æ©Ÿå™¨å­¸ç¿’ç­†è¨˜(ä¸ƒ)â€”â€”åˆè­˜é‚è¼¯è¿´æ­¸ã€ä¸åŒæ–¹æ³•æ¨å°æ¢¯åº¦å…¬å¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e214e6d7.html alt=æ·±åº¦å­¸ç¿’/æ©Ÿå™¨å­¸ç¿’å…¥é–€æ•¸å­¸çŸ¥è­˜æ•´ç†ï¼ˆäºŒï¼‰æ¢¯åº¦èˆ‡å°æ•¸ï¼Œæ³°å‹’å±•é–‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1540372101455de0fb74774 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e214e6d7.html title=æ·±åº¦å­¸ç¿’/æ©Ÿå™¨å­¸ç¿’å…¥é–€æ•¸å­¸çŸ¥è­˜æ•´ç†ï¼ˆäºŒï¼‰æ¢¯åº¦èˆ‡å°æ•¸ï¼Œæ³°å‹’å±•é–‹>æ·±åº¦å­¸ç¿’/æ©Ÿå™¨å­¸ç¿’å…¥é–€æ•¸å­¸çŸ¥è­˜æ•´ç†ï¼ˆäºŒï¼‰æ¢¯åº¦èˆ‡å°æ•¸ï¼Œæ³°å‹’å±•é–‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f3767255.html alt=è¬›é€æ©Ÿå™¨å­¸ç¿’ä¸­çš„æ¢¯åº¦ä¸‹é™ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5c80301e53424671bc22755be2e4ee33 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f3767255.html title=è¬›é€æ©Ÿå™¨å­¸ç¿’ä¸­çš„æ¢¯åº¦ä¸‹é™>è¬›é€æ©Ÿå™¨å­¸ç¿’ä¸­çš„æ¢¯åº¦ä¸‹é™</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ac12f3a1.html alt=ç›´æµé‹çˆçµ¦æ°´æ§åˆ¶å­¸ç¿’ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/eba10edcc8d14d9f8cde6fd5b212d90e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ac12f3a1.html title=ç›´æµé‹çˆçµ¦æ°´æ§åˆ¶å­¸ç¿’>ç›´æµé‹çˆçµ¦æ°´æ§åˆ¶å­¸ç¿’</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a1bc38f3.html alt=HTMLCSSå­¸ç¿’ç­†è¨˜ï¼ˆå…­ï¼‰â€”â€”å…ƒç´ é¡å‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/bdb5988349894ce9bf568c6418f85b7d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a1bc38f3.html title=HTMLCSSå­¸ç¿’ç­†è¨˜ï¼ˆå…­ï¼‰â€”â€”å…ƒç´ é¡å‹>HTMLCSSå­¸ç¿’ç­†è¨˜ï¼ˆå…­ï¼‰â€”â€”å…ƒç´ é¡å‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c9091681.html alt="MySQL å­¸ç¿’ç­†è¨˜" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c9091681.html title="MySQL å­¸ç¿’ç­†è¨˜">MySQL å­¸ç¿’ç­†è¨˜</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/175f9730.html alt=æ·±å…¥å­¸ç¿’MySQLäº‹å‹™ï¼šACIDç‰¹æ€§çš„å¯¦ç¾åŸç†ã€Œè½‰ã€ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/cdc702d66d6943499997d11e931425eb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/175f9730.html title=æ·±å…¥å­¸ç¿’MySQLäº‹å‹™ï¼šACIDç‰¹æ€§çš„å¯¦ç¾åŸç†ã€Œè½‰ã€>æ·±å…¥å­¸ç¿’MySQLäº‹å‹™ï¼šACIDç‰¹æ€§çš„å¯¦ç¾åŸç†ã€Œè½‰ã€</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f6b2ef73.html alt=å¦‚ä½•å­¸ç¿’æ¨¡æ“¬ICè¨­è¨ˆï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f6b2ef73.html title=å¦‚ä½•å­¸ç¿’æ¨¡æ“¬ICè¨­è¨ˆï¼Ÿ>å¦‚ä½•å­¸ç¿’æ¨¡æ“¬ICè¨­è¨ˆï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c56ee116.html alt=å°çŒ¿åœˆpythonå­¸ç¿’-ä¸‰å¤§ç‰¹æ€§ä¹‹å¤šæ…‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ad0e8e3777854337abeb7c779ad79a04 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c56ee116.html title=å°çŒ¿åœˆpythonå­¸ç¿’-ä¸‰å¤§ç‰¹æ€§ä¹‹å¤šæ…‹>å°çŒ¿åœˆpythonå­¸ç¿’-ä¸‰å¤§ç‰¹æ€§ä¹‹å¤šæ…‹</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>