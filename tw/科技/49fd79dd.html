<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>面試官問：一個Java字符串中到底能有多少個字符？ | 极客快訊</title><meta property="og:title" content="面試官問：一個Java字符串中到底能有多少個字符？ - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/219afb44975f48c09f4d1cf56b9eed17"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/49fd79dd.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/49fd79dd.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/49fd79dd.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/49fd79dd.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/49fd79dd.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/49fd79dd.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/49fd79dd.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/49fd79dd.html><meta property="article:published_time" content="2020-11-14T21:01:00+08:00"><meta property="article:modified_time" content="2020-11-14T21:01:00+08:00"><meta name=Keywords content><meta name=description content="面試官問：一個Java字符串中到底能有多少個字符？"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/49fd79dd.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>面試官問：一個Java字符串中到底能有多少個字符？</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><blockquote><p>作者：鳥窩</p><p>來源：https://urlify.cn/qYNR3q</p></blockquote><p>依照Java的文檔， Java中的字符內部是以UTF-16編碼方式表示的，最小值是 \u0000 (0),最大值是\uffff(65535)， 也就是一個字符以2個字節來表示，難道Java最多隻能表示 65535個字符？</p><blockquote><p>char: The char data type is a single 16-bit Unicode character. It has a minimum value of '\u0000' (or 0) and a maximum value of '\uffff' (or 65,535 inclusive). from The Java™ Tutorials</p></blockquote><p>首先，讓我們先看個例子：</p><div class=pgc-img><img alt=面試官問：一個Java字符串中到底能有多少個字符？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/219afb44975f48c09f4d1cf56b9eed17><p class=pgc-img-caption></p></div><p>運行這個程序，你覺得輸出結果是什麼？</p><p>輸出結果:</p><div class=pgc-img><img alt=面試官問：一個Java字符串中到底能有多少個字符？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/160242dce14240c8a9d6468555e5953b><p class=pgc-img-caption></p></div><p>我們知道， String.getBytes()如果不指定編碼格式，Java會使用操作系統的編碼格式得到字節數組，在我的MacOS中，默認使用UTF-8作為字符編碼(locale命令可以查看操作系統的編碼)，所以在我的機器運行，String.getBytes()會返回UTF-8編碼的字節數組。</p><p>String.length返回Unicode code units的長度。</p><p>String.toCharArray返回字符數組。</p><p>我們設置的字符串都是兩個unicode字符，輸出結果：</p><ul class=list-paddingleft-2><li><strong>普通的中文字</strong>：字符串的長度是2，每個中文字按UTF-8編碼是三個字節，字符數組的長度看起來也沒問題</li><li><strong>emojis字符</strong>：我們設置了兩個emojis字符，男女頭像。結果字符串的長度是4, UTF-8編碼8個字節，字符數組的長度是4</li><li><strong>生僻的中文字</strong>：我們設置了兩個中文字，其中一個是生僻的中文字。結果字符串的長度是3， UTF-8編碼7個字節，字符數組的長度是3</li></ul><p>看起來字符串的字符數和我們預期的有點不一樣，我們的字符串只有兩個unicode字符, 可是輸出結果有時候是2，有時候是3， 有時候是4，為什麼呢？</p><p>這還得從Java的歷史說起。</p><p>Java最初設計的Charactor用兩個字節來表示unicode字符，這沒有問題， 因為最初unicode中的字符還比較少， Java 1.1之前採用Unicode version 1.1.5, JDK 1.1中支持Unicode 2.0, JDK 1.1.7支持Unicode 2.1, Java SE 1.4 支持 Unicode 3.0, Java SE 5.0開始支持Unicode 4.0。</p><p>直到Unicode 3.0, Java用兩個字節來表示unicode字符還沒有問題，因為Unicode 3.0最多49,259個字符， 兩個字節可以表示65,535個字符，還足夠容的下所有的uicode3.0字符。</p><p>但是Unicode 4.0(事實上自Unicode 3.1), 字符集進行很大的擴充，已經達到了96,447個字符，Unicode 11.0已經包含137,374個字符。</p><p>在Unicode中，為每一個字符對應一個編碼點(一個整數)，用 U+緊跟著十六進制數表示。所有字符按照使用上的頻繁度劃分為 17 個平面（編號為 0-16），即基本的多語言平面和增補平面。基本的多語言平面（英文為 Basic Multilingual Plane，簡稱 BMP）又稱平面 0，收集了使用最廣泛的字符。</p><p>這樣一來，Java的Charactor的兩個字節的設計，已經不足以容納所有的Unicode 4的字符， 所以可能需要4個字節才能表示擴展字符，所以現在的Charactor代表的已經不再是一個字符 (代碼點 code point), 而是一個代碼單元(code unit)。</p><ul class=list-paddingleft-2><li><strong>Code Point</strong>：代碼點，一個字符的數字表示。一個字符集一般可以用一張或多張由多個行和多個列所構成的二維表來表示。二維表中行與列交叉的點稱之為代碼點，每個碼點分配一個唯一的編號數字，稱之為碼點值或碼點編號，除開某些特殊區域(比如代理區、專用區)的非字符代碼點和保留代碼點，每個代碼點唯一對應於一個字符。從U+0000 到 U+10FFFF。</li><li><strong>Code Unit</strong>：代碼單元，是指一個已編碼的文本中具有最短的比特組合的單元。對於 UTF-8 來說，代碼單元是 8 比特長；對於 UTF-16 來說，代碼單元是 16 比特長。換一種說法就是 UTF-8 的是以一個字節為最小單位的，UTF-16 是以兩個字節為最小單位的。</li></ul><p>Java的字符在內部以UTF-16編碼方式來表示，String.length返回的是Code Unit的長度，而不再是Unicode中字符的長度。對於傳統的BMP平面的代碼點，String.length和我們傳統理解的字符的數量是一致的，對於擴展的字符，String.length可能是我們理解的字符長度的兩倍。</p><p>有可能你會問， 對於一個UTF-16編碼的擴展字符，它以4個字節來表示，那麼前兩個字節會不會和BMP平面衝突，導致程序不知道它是擴展字符還是BMP平面的字符？<br></p><p>其實是不會的， 幸運的是， 在BMP平面中， U+D800到U+DFFF之間的碼位是永久保留不映射到Unicode字符，UTF-16就利用保留下來的0xD800-0xDFFF區塊的碼位來對輔助平面的字符的碼位進行編碼。</p><p>UTF-16編碼中，輔助平面中的碼位從U+10000到U+10FFFF，共計FFFFF個,需要20位來表示。第一個整數（兩個字節，稱為前導代理）要容納上述20位的前10位，第二個整數（稱為後尾代理）容納上述20位的後10位。前導代理的值的範圍是0xD800到0xDBFF,後尾代理的0xDC00~0xDFFF。</p><p>可以看到前導代理和後尾代理的範圍都落在了BMP平面中不用來映射的碼位，所以不會產生衝突，而且前導代理和後尾代理也沒有重合。這樣我們得到兩個字節的，就可以直接判斷它是否是BMP平面的字符，還是擴展字符中的前導代理還是後尾代碼。</p><p>國外的有些用戶用emojis字符做自己的暱稱，導致有些系統不能正確的顯示出來，這是因為這些系統粗暴的使用Charactor來表示，在顯示的時候截斷的時候有時候可能不是在正確的代碼點上進行截斷。</p><p>我們在進行字符串截取的時候,比如String.substring有可能會踩到一些坑，尤其經常使用的emojis字符。</p><p>自 Java 1.5 java.lang.String就提供了Code Point方法， 用來獲取完整的Unicode字符和Unicode字符數量:</p><div class=pgc-img><img alt=面試官問：一個Java字符串中到底能有多少個字符？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/98fbc015fe774487838c54cad8c11ee5><p class=pgc-img-caption></p></div><p>注意這些方法中的index使用的是code unit值。<br></p><p><strong>我目前是在職Java開發，如果你現在正在瞭解Java技術，想要學好Java，渴望成為一名Java開發工程師，在入門學習Java的過程當中缺乏基礎的入門視頻教程，你可以關注並私信我：01。我這裡有一套最新的Java基礎JavaSE的精講視頻教程，這套視頻教程是我在年初的時候，根據市場技術棧需求錄製的，非常的系統完整。</strong></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>面試</a></li><li><a>官問</a></li><li><a>一個</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/a5729241.html alt="面試官問：瀏覽器輸入 URL 回車之後發生了什麼？" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/bb73188609ae4838af5ddfaf87140f91 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a5729241.html title="面試官問：瀏覽器輸入 URL 回車之後發生了什麼？">面試官問：瀏覽器輸入 URL 回車之後發生了什麼？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/60d9c491.html alt=面試官問：什麼是協議？你會嗎 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8f33f88f61cb40d0bfec0a8818d08eb8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/60d9c491.html title=面試官問：什麼是協議？你會嗎>面試官問：什麼是協議？你會嗎</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dabba596.html alt=一個HashMap能跟面試官扯上半個小時 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3c09bf1ad1b54adaab3db4be30c10c8b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dabba596.html title=一個HashMap能跟面試官扯上半個小時>一個HashMap能跟面試官扯上半個小時</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e803c28.html alt=面試官問我什麼是「棧」，我隨手畫了10張圖來解釋 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/0277ae9951df4d8483fc21ce4d8d17fe style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e803c28.html title=面試官問我什麼是「棧」，我隨手畫了10張圖來解釋>面試官問我什麼是「棧」，我隨手畫了10張圖來解釋</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ca9385f.html alt=美女面試官問我Python如何優雅的創建臨時文件，我的回答.... class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/17fc10f6f4374b4382e19b7d112f8cb7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ca9385f.html title=美女面試官問我Python如何優雅的創建臨時文件，我的回答....>美女面試官問我Python如何優雅的創建臨時文件，我的回答....</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3bc8bd1.html alt=Java面試官問：“面向對象7大設計原則”——教你如何完美解答 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/01fe429309444a6885c5b2e92feac9db style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3bc8bd1.html title=Java面試官問：“面向對象7大設計原則”——教你如何完美解答>Java面試官問：“面向對象7大設計原則”——教你如何完美解答</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/358ab5f.html alt=面試官：問你一個，Spring事務是如何傳播的？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6513100097ce4d27b1df49cd347e4d88 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/358ab5f.html title=面試官：問你一個，Spring事務是如何傳播的？>面試官：問你一個，Spring事務是如何傳播的？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7fcd360.html alt="面試官問你 TCP/IP 協議了嗎？" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8e984b9638d04249b032458327e74cf8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7fcd360.html title="面試官問你 TCP/IP 協議了嗎？">面試官問你 TCP/IP 協議了嗎？</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/5271d1e.html alt=面試官問：你講講分佈式事務問題的幾種方案？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p1.pstatp.com/large/pgc-image/64101dc3b81743718f0c86bc6e9f8c70 style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/5271d1e.html title=面試官問：你講講分佈式事務問題的幾種方案？>面試官問：你講講分佈式事務問題的幾種方案？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ac25d2d0.html alt=30分鐘教你搭建一個網站（一）：購買和配置服務器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/5f26f1582a564e93bde33a7dd9448c3b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ac25d2d0.html title=30分鐘教你搭建一個網站（一）：購買和配置服務器>30分鐘教你搭建一個網站（一）：購買和配置服務器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d8be5e94.html alt=不會買服務器？一個辦法讓你輕鬆搭網站 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/84d9c54578de46058796824f1bcb6a9b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d8be5e94.html title=不會買服務器？一個辦法讓你輕鬆搭網站>不會買服務器？一個辦法讓你輕鬆搭網站</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c811c5f7.html alt=使用服務器搭建一個網站 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/63a6cc0eb4d146e0890515500c0040ca style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c811c5f7.html title=使用服務器搭建一個網站>使用服務器搭建一個網站</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4b69aa7f.html alt=做一個小型網站，服務器需要什麼配置的呢？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4b69aa7f.html title=做一個小型網站，服務器需要什麼配置的呢？>做一個小型網站，服務器需要什麼配置的呢？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/eee4b8ad.html alt=搭建一個網站，租服務器大概多少錢？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/eee4b8ad.html title=搭建一個網站，租服務器大概多少錢？>搭建一個網站，租服務器大概多少錢？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/62d46b38.html alt=素描祕籍｜一個耳朵！9大知識點，360度全方位深度剖析講解示範！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/5e7b0005767168b2b87d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/62d46b38.html title=素描祕籍｜一個耳朵！9大知識點，360度全方位深度剖析講解示範！>素描祕籍｜一個耳朵！9大知識點，360度全方位深度剖析講解示範！</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>