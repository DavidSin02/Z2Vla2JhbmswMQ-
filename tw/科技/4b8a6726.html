<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>PLC程序設計｜簡化程序元素的最佳方式——面向對象編程 | 极客快訊</title><meta property="og:title" content="PLC程序設計｜簡化程序元素的最佳方式——面向對象編程 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/40110002be00daf02cb9"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4b8a6726.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4b8a6726.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4b8a6726.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4b8a6726.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4b8a6726.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4b8a6726.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4b8a6726.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4b8a6726.html><meta property="article:published_time" content="2020-10-29T21:10:38+08:00"><meta property="article:modified_time" content="2020-10-29T21:10:38+08:00"><meta name=Keywords content><meta name=description content="PLC程序設計｜簡化程序元素的最佳方式——面向對象編程"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/4b8a6726.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>PLC程序設計｜簡化程序元素的最佳方式——面向對象編程</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>摘要</p><p><strong>面向對象編程,是一種利用對象、方法和屬性，來組織和簡化程序元素的最佳方式。</strong></p><p>最新發布的IEC-61131-3標準更新包括面向對象編程（OOP）語言。雖然面向對象編程是高大上的術語，但它其實是關於組織和簡化的。組織是指程序元素進行分組以及分組所採用的機制。組織良好的程序更直觀和更易於使用。面向對象的特徵旨在改善和促進健全的組織項目。簡化是指向外部世界提供簡化的接口。封裝之下，對象內部的複雜細節則保留在程序中。</p><h1><strong>何為對象？</strong></h1><p><strong>編程中的“對象”，就是將功能和數據整合在一起，用其來實現對實際設備、過程和其它結構的狀態和行為的建模。</strong>在IEC 61131-3標準中，對象是帶額外特性的功能塊。功能塊可以定義方法和屬性，從而可以進一步劃分代碼和擴展接口。方法和屬性可以使用任何IEC-61131-3語言來實現。語言的選擇在每個方法或屬性的基礎上確定，這使其很容易根據環境來使用最適合的語言。</p><p>示例項目包含一個功能塊，該功能塊實現一個簡單的加/減計數器（如圖1所示）。在其它面向對象編程（OOP）語言中使用的“類”，是“函數功能塊”的同義詞。兩者的定義都必須在使用前進行實例化。類的實例或功能塊被稱為“對象”。</p><p><img alt=PLC程序設計｜簡化程序元素的最佳方式——面向對象編程 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/40110002be00daf02cb9></p><p class=pgc-img-caption><strong>圖1：該示例工程包含了一個簡單的增/減計數器的功能塊。圖片來源： Mitek 自動化</strong></p><h1><strong>定義方法</strong></h1><p><strong>“方法”，是能夠訪問所定義的函數塊內部數據和參數的函數。</strong>它們也可以有輸入、輸出參數和返回值，這和普通函數一樣。</p><p><strong>方法，可以用梯形圖來定義。</strong>當輸入參數為“真”時，計數器遞增，最後達到一個最大值。在功能塊的主體中，定義PMaxCount和Count參數。由於方法可以訪問功能塊的數據和參數，方法內部就可以使用PMaxCount和Count參數。返回值被寫入到CountUp，它是方法本身的名字。</p><p><strong>在方法中定義NotMax變量，並將其分配給方法的調用堆棧。</strong>這意味著，前一個運行週期的變量值不會保持。在功能塊主體中定義的變量被分配到內存中，並在不同的運行週期中保持一致。</p><p><strong>另一種方法是定義遞減計數器，比如使用結構化文本語言來實現。</strong>當輸入參數為“真”時，計數器遞減，直到減為零為止。Count 是功能塊的輸出參數，並將返回值寫入變量CountDn，這也是方法的名稱。此方法提供了一種簡單方便的方法，將整個程序分解成更小、更易於管理的程序塊。這種設計，更易於匹配不同的語言。</p><p><strong>從函數塊本體調用這些方法，是很簡單的事情（如圖2所示）。</strong>由於這些方法是使用關鍵字“私有”定義的，所以只能在函數中調用它們。使用關鍵字“公共”定義的方法，也可以在外部調用。</p><p><img alt=PLC程序設計｜簡化程序元素的最佳方式——面向對象編程 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/40130002ba37bc8c8ec3></p><p class=pgc-img-caption><strong>圖2：用戶可以從功能塊本體來調用這些方法，並使用關鍵詞作為方法的防護。</strong></p><h1><strong>定義屬性</strong></h1><p><strong>“屬性”是類似於變量的函數，可以在表達式中使用，與使用變量的方法相同。</strong>不同於綁定到某個存儲位置，屬性與get()和set()功能綁定。當需要從屬性中讀取數據時，就需要執行get()功能。當需要向屬性寫入數據時，就需要執行set()功能。</p><p><strong>“公有”與“私有”關鍵詞，也可以用來控制屬性的訪問權限。</strong>“私有”意味著屬性只能在定義的功能塊內部使用。“公有”，則意味著該屬性可用在外部調用。然而，“公有”與“私有”關鍵詞也可以用於get()和set()函數的定義。這就使得該屬性，外部可讀，內部可寫。</p><p><strong>在最基本的形式中，屬性從內部變量讀取、或寫入數據。</strong>它們的附加功能可用於驗證數據值或執行其它操作。例如，可在程序中添加MaxCount屬性。這允許將最大計數設置為指定的值，且其當前值可讀。數據通過MaxCount屬性傳遞給set()和get()函數，就像變量一樣。get()函數返回功能塊變量PMaxCount的值。set()函數驗證輸入值，以便在將結果寫入PMaxCount之前確保它是一個正數。</p><p><img alt=PLC程序設計｜簡化程序元素的最佳方式——面向對象編程 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/40130002ba366dc3dcd1></p><p class=pgc-img-caption><strong>圖3：重置屬性沒有潛在讀寫操作對象。</strong></p><p>在圖3所示的例子中，在項目中增加了使用梯形圖語言實現的復位功能。重置屬性沒有潛在的讀寫操作對象變量。當寫入“真”時，執行復位操作。當讀取屬性時，計算表達式的值，並返回結果。</p><p><strong>值得一提的是，項目結構和組織如何反映到項目樹中。</strong>在項目中，每個程序、函數塊、方法和屬性都用一個節點表示。雙擊節點，就會在主窗口的文檔頁打開一個選項卡。標籤可以被移除並以單獨的窗口顯示。get()和set()功能都可以單獨顯示，因此可以用於屬性定義的顯示。</p><p><img alt=PLC程序設計｜簡化程序元素的最佳方式——面向對象編程 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/40150000b4c216d846ed></p><p class=pgc-img-caption><strong>圖4：程序可以像功能塊一樣定義內部數據、參數、方法和屬性。</strong></p><h1><strong>面向對象程序元素的優化</strong></h1><p><strong>面向對象包括很多，但它最根本的目的就是以一種最優的方式組織程序元素。</strong>對象、方法和屬性，是實現這一目標的主要手段，對於理解和掌握這些概念，是最基本的。</p><p>項目初期，可採用較小的程序步驟來組織常規程序；基於對象的設計可以稍後進行。熟悉使用這些技術以後，會讓你更容易考慮所有其它的可能性。沒有理由不做嘗試。</p><p>本文來自於《控制工程中文版》（CONTROL ENGINEERING China ）2017年9月刊《技術進展》欄目，原標題為：PLC程序設計：面向對象編程</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>程序</a></li><li><a>PLC</a></li><li><a>設計</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/35600614.html alt=如何將三菱PLC程序轉換成歐姆龍PLC程序？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f762ca5e70d34ee799291349e49f4802 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/35600614.html title=如何將三菱PLC程序轉換成歐姆龍PLC程序？>如何將三菱PLC程序轉換成歐姆龍PLC程序？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7ec7c325.html alt=PLC控制系統設計的基本內容和一般步驟 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/33e70b70238e44ddb21c2c26958a71a1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7ec7c325.html title=PLC控制系統設計的基本內容和一般步驟>PLC控制系統設計的基本內容和一般步驟</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/42e331ee.html alt=設計PLC系統最怕干擾，干擾源在哪裡，如何避免呢？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d146904b123f4e47875389cc7bec1fec style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/42e331ee.html title=設計PLC系統最怕干擾，干擾源在哪裡，如何避免呢？>設計PLC系統最怕干擾，干擾源在哪裡，如何避免呢？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/84db749c.html alt=JavaScript高級程序設計第六章面向對象程序設計 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/59480000e93734c23fe8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/84db749c.html title=JavaScript高級程序設計第六章面向對象程序設計>JavaScript高級程序設計第六章面向對象程序設計</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1ae07d2.html alt=PLC控制的基本電路設計方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/RtTQn5N92QxnYW style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1ae07d2.html title=PLC控制的基本電路設計方法>PLC控制的基本電路設計方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fc3343c.html alt="PHP 程序設計" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/e559a280e51a493dbea2fb5b97525d6a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fc3343c.html title="PHP 程序設計">PHP 程序設計</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3336871.html alt=PLC梯形圖程序設計基礎及經驗設計 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/48d399dfc8554b4b812d6441d3023592 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3336871.html title=PLC梯形圖程序設計基礎及經驗設計>PLC梯形圖程序設計基礎及經驗設計</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ebf521e.html alt=PLC程序設計：面向對象編程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7cb697d8c7ee44988cbc70bb495b1a2d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ebf521e.html title=PLC程序設計：面向對象編程>PLC程序設計：面向對象編程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/70b1ad8.html alt=一文看懂PLC程序設計五大要點 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/90476a7b-33ab-4c64-889f-c01795b5cf60 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/70b1ad8.html title=一文看懂PLC程序設計五大要點>一文看懂PLC程序設計五大要點</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/adbdf92.html alt=大家一起來學習程序設計 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1535694483100fc3dac429b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/adbdf92.html title=大家一起來學習程序設計>大家一起來學習程序設計</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e251962.html alt=數控加工程序設計，你會嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e64aa19d0d1d49979d4ceec478e72ee1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e251962.html title=數控加工程序設計，你會嗎？>數控加工程序設計，你會嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a0dccd8.html alt=最新計算機畢業設計，分享20套程序設計（程序+論文+PPt） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/049b749e-368d-4cb6-8e0e-b155d59e77e9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a0dccd8.html title=最新計算機畢業設計，分享20套程序設計（程序+論文+PPt）>最新計算機畢業設計，分享20套程序設計（程序+論文+PPt）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5b49743.html alt=程序設計基本方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/f1e60f1c36a544ad9c57e9e9c9166785 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5b49743.html title=程序設計基本方法>程序設計基本方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5b064a0.html alt=程序設計方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5b064a0.html title=程序設計方法>程序設計方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1204d30.html alt=程序設計的任務 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/870917da8c744479b2ec65ee0173974e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1204d30.html title=程序設計的任務>程序設計的任務</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>