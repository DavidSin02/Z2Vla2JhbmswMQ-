<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Python數據清洗(一)：類型轉換和冗餘數據刪除 | 极客快訊</title><meta property="og:title" content="Python數據清洗(一)：類型轉換和冗餘數據刪除 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/936eb6071cd947a4b3fedc4277d90815"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4ee568a.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4ee568a.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4ee568a.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4ee568a.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4ee568a.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4ee568a.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/4ee568a.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/4ee568a.html><meta property="article:published_time" content="2020-10-29T20:59:01+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:01+08:00"><meta name=Keywords content><meta name=description content="Python數據清洗(一)：類型轉換和冗餘數據刪除"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/4ee568a.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Python數據清洗(一)：類型轉換和冗餘數據刪除</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div class=pgc-img><img alt=Python數據清洗(一)：類型轉換和冗餘數據刪除 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/936eb6071cd947a4b3fedc4277d90815><p class=pgc-img-caption></p></div><blockquote><p>作者 | 劉順祥</p></blockquote><blockquote><p>來源 | 數據分析1480</p></blockquote><p>數據分析過程中最頭疼也是工作量最大的部分算是探索和清洗了——探索的目的是瞭解數據，瞭解數據背後隱藏的規律；洗的目的則是為了讓乾淨的數據進入分析或建模的下一個環節。小編將通過三篇文章，詳細講解工作中常規的數據清洗方法，<strong>包括數據類型的轉換，重複數據的處理，缺失值的處理以及異常數據的識別和處理</strong>。這是Python數據清洗系列的第一篇文章，主要分享的內容包括——<strong>數據類型的轉換and冗餘數據的識別和處理</strong></p><h1><strong>數據類型的判斷和轉換</strong></h1><p>如下表所示，為某公司用戶的個人信息和交易數據，涉及的字段為用戶id、性別、年齡、受教育水平、交易金額和交易日期。從表面上看，似乎沒有看出數據背後可能存在的問題，那接下來就將其讀入到Python中，並通過探索的方式發現數據中的問題。</p><div class=pgc-img><img alt=Python數據清洗(一)：類型轉換和冗餘數據刪除 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/41a4aa5583de432caed58fd0577f7c7d><p class=pgc-img-caption></p></div><p>讀取數據，以及查看數據規模、查看數據中各變量的數據類型的代碼如下：</p><pre># 導入第三方包import pandas as pd# 讀入外部數據data3 = pd.read_excel(io=r'C:\Users\Administrator\Desktop\datas\data3.xlsx')# 查看數據的規模data3.shapeout:(3000, 6)# 查看錶中各變量的數據類型# data3.dtypesout:</pre><p>表中各變量的數據類型如表下表所示：</p><div class=pgc-img><img alt=Python數據清洗(一)：類型轉換和冗餘數據刪除 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fd01a2adb5de48ada07cfea29ac3d26a><p class=pgc-img-caption></p></div><p>上述代碼利用<strong>shape“方法”</strong>返回了數據集的規模，即該數據包含3000行6列；通過<strong>dtypes“方法”</strong>則返回了數據集中各變量的數據類型——除id變量和age變量為數值型，其餘變量均為字符型。直觀上能夠感受到一點問題，即數據類型不對，例如用戶id應該為字符型，消費金額custom_amt為數值型，訂單日期為日期型。如果發現數據類型不對，如何藉助於Python工具實現數據類型的轉換呢？可參照如下代碼的實現。</p><pre># 數值型轉字符型data3['id'] = data3['id'].astype(str)# 字符型轉數值型data3['custom_amt'] = data3['custom_amt'].str[1:].astype(float)# 字符型轉日期型data3['order_date'] = pd.to_datetime(data3['order_date'], format = '%Y年%m月%d日')# 重新查看數據集的各變量類型data3.dtypesout:</pre><p>這些數據經過處理後，各個字段的數據類型如下表所示：</p><div class=pgc-img><img alt=Python數據清洗(一)：類型轉換和冗餘數據刪除 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7d505e92c58147de9041b34cdb0f6e57><p class=pgc-img-caption></p></div><p>如上結果所示，三個變量全都轉換成了各自所期望的數據類型。<strong>astype“方法”</strong>用於數據類型的強制轉換，可選擇的常用轉換類型包括str（表示字符型）、float（表示浮點型）和int（表示整型）。由於消費金額custom_amt變量中的值<strong>包含人民幣符號“￥”</strong>，所以在數據類型轉換之前必須將其刪除（通過字符串的切片方法刪除，<strong>[1:]表示從字符串的第二個元素開始截斷</strong>）。對於字符轉日期問題，推薦使用更加靈活的to_datetime函數，因為它在format參數的調節下，可以識別任意格式的字符型日期值。</p><p>需要注意的是，Python中的函數有兩種表現形式，一種是常規理解下的<strong>函數</strong>（語法為func(parameters)，如to_datetime函數），另一種則是<strong>“方法”</strong>（語法為obj.func(parameters)，如dtypes和astype“方法”）。兩者的區別在於 “方法”是針對特定對象的函數（即該“方法”只能用在某個固定類型的對象上），而函數並沒有這方面的限制。</p><p>基於如上類型的轉換結果，最後瀏覽一下數據的展現形式：</p><pre># 預覽數據的前5行data3.head()</pre><div class=pgc-img><img alt=Python數據清洗(一)：類型轉換和冗餘數據刪除 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8eb8c5d369ac45f9b5e39884c4d38ebe><p class=pgc-img-caption></p></div><h1><strong>冗餘數據的判斷和處理</strong></h1><p>如上過程是對數據中各變量類型的判斷和轉換，除此還需要監控表中是否存在“髒”數據，如冗餘的重複觀測和缺失值等。可以通過<strong>duplicated“方法”</strong>進行 “髒”數據的識別和處理。仍然對上邊的data3數據為例進行操作，具體代碼如下所示。</p><pre># 判斷數據中是否存在重複觀測data3.duplicated().any()out:False</pre><p>如上結果返回的是False，說明該數據集中並不存在重複觀測。假如讀者利用如上的代碼在數據集中發現了重複觀測，可以使用drop_duplicates“方法”將冗餘信息刪除。</p><p><strong>需要說明的是</strong>，在使用duplicated“方法”對數據行作重複性判斷時，會返回一個與原數據行數相同的序列（如果數據行沒有重複，則對應False，否則對應True），為了得到最終的判斷結果，需要<strong>再使用any“方法”</strong>（即序列中只要存在一個True，則返回True）。</p><p>duplicated“方法”和drop_duplicates“方法”都有一個非常重要的參數，<strong>就是subset</strong>。默認情況下不設置該參數時，表示對數據的所有列進行重複性判斷；如果需要按指定的變量做數據的重複性判斷時，就可以使用該參數指定具體的變量列表。舉例如下：</p><pre># 構造數據df = pd.DataFrame(dict(name = ['張三','李四','王二','張三','趙五','丁一','王二'], gender = ['男','男','女','男','女','女','男'], age = [29,25,27,29,21,22,27], income = [15600,14000,18500,15600,10500,18000,13000], edu = ['本科','本科','碩士','本科','大專','本科','碩士']))# 查看數據df</pre><div class=pgc-img><img alt=Python數據清洗(一)：類型轉換和冗餘數據刪除 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2a67676fe4084ee68e3aea4c5dfdc219><p class=pgc-img-caption></p></div><p>目測有兩條數據完全一樣，就是用戶張三，如果直接使用drop_duplicates“方法”，而不做任何參數的修改時，將會刪除第二次出現的用戶張三。代碼如下：</p><pre># 默認情況下，對數據的所有變量進行判斷df.drop_duplicates()</pre><div class=pgc-img><img alt=Python數據清洗(一)：類型轉換和冗餘數據刪除 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a42003904acb406aa7c4be39fe8860ee><p class=pgc-img-caption></p></div><p>假設在數據清洗中，用戶的姓名和年齡相同就認為是重複數據，那麼該如何基於這兩個變量進行重複值的刪除呢？此時就需要使用subset參數了，代碼如下：</p><pre>df.drop_duplicates(subset=['name','age'])</pre><div class=pgc-img><img alt=Python數據清洗(一)：類型轉換和冗餘數據刪除 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/61460297f5c742cfb8e5c7686086c47e><p class=pgc-img-caption></p></div><p><strong>需要注意的是</strong>，使用drop_duplicates“方法”刪除重複數據，並不能直接影響到原始數據，即原始數據中還是存在重複觀測的。如需使drop_duplicates“方法”的刪除功能作用在原始數據中，<strong>必須將inplace參數設置為True</strong>。</p><p>本期的內容就介紹到這裡，<strong>下一篇將分享缺失值的識別和處理技術。</strong></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Python</a></li><li><a>數據</a></li><li><a>類型</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/7739dc7a.html alt=Python數據可視化Matplotlib，如何在一副圖像中顯示多組柱形圖？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/5d4a0000046e1bea8b90 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7739dc7a.html title=Python數據可視化Matplotlib，如何在一副圖像中顯示多組柱形圖？>Python數據可視化Matplotlib，如何在一副圖像中顯示多組柱形圖？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/11452718.html alt=C++基本數據類型的大小和極值範圍 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/3247bc04-7125-4cb0-89a2-5bcef14bb5b1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/11452718.html title=C++基本數據類型的大小和極值範圍>C++基本數據類型的大小和極值範圍</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6ed397a4.html alt=C語言入門教程（二）數據類型及標準函數 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/244f95dddbbb47a29b312d3800957ea7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6ed397a4.html title=C語言入門教程（二）數據類型及標準函數>C語言入門教程（二）數據類型及標準函數</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8895f05b.html alt=Python數據可視化Matplotlib，如何改變柱狀圖中柱體寬度及顏色？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/5e86000416e5b4683dfb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8895f05b.html title=Python數據可視化Matplotlib，如何改變柱狀圖中柱體寬度及顏色？>Python數據可視化Matplotlib，如何改變柱狀圖中柱體寬度及顏色？</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/497456fe.html alt=Python數據結構算法，學習人工智能必備知識點 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1536842670061d56ecf34d6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/497456fe.html title=Python數據結構算法，學習人工智能必備知識點>Python數據結構算法，學習人工智能必備知識點</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/051c1ef8.html alt=Python數據結構之隊列的實現與實例分析 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/051c1ef8.html title=Python數據結構之隊列的實現與實例分析>Python數據結構之隊列的實現與實例分析</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d0729002.html alt=一文讀懂MySQL數據類型 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3969d292a92340368ca9cc80eb1b4040 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d0729002.html title=一文讀懂MySQL數據類型>一文讀懂MySQL數據類型</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d5628f8.html alt=​如何在Python中加入多個數據幀？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ac466a2ef0dc4cdca642d9937504b4cc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d5628f8.html title=​如何在Python中加入多個數據幀？>​如何在Python中加入多個數據幀？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ad0fe12.html alt=Python數據可視化Matplotlib，如何隱藏座標軸刻度線標籤？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/66c60001502562989911 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ad0fe12.html title=Python數據可視化Matplotlib，如何隱藏座標軸刻度線標籤？>Python數據可視化Matplotlib，如何隱藏座標軸刻度線標籤？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7d448bf.html alt=Python數據可視化Matplotlib，如何隱藏座標軸刻度線？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/66c60001502562989911 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7d448bf.html title=Python數據可視化Matplotlib，如何隱藏座標軸刻度線？>Python數據可視化Matplotlib，如何隱藏座標軸刻度線？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8aa0358.html alt=Python數據可視化Matplotlib，座標軸刻度線定位——對數定位法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/15216867300432ec0694263 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8aa0358.html title=Python數據可視化Matplotlib，座標軸刻度線定位——對數定位法>Python數據可視化Matplotlib，座標軸刻度線定位——對數定位法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9d392c1.html alt=Python數據可視化利器Matplotlib，座標軸刻度線及刻度線標籤設置 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/3b1600029ce67d83c611 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9d392c1.html title=Python數據可視化利器Matplotlib，座標軸刻度線及刻度線標籤設置>Python數據可視化利器Matplotlib，座標軸刻度線及刻度線標籤設置</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3f88d03.html alt=軟妹子帶你玩轉Python數據可視化，座標軸位置自定義 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/320d0002dddbdff5c4c8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3f88d03.html title=軟妹子帶你玩轉Python數據可視化，座標軸位置自定義>軟妹子帶你玩轉Python數據可視化，座標軸位置自定義</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b41ad4d.html alt=軟妹子帶你玩轉Python數據可視化，座標軸刻度比例尺自定義 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/321200016c64dce4d9ca style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b41ad4d.html title=軟妹子帶你玩轉Python數據可視化，座標軸刻度比例尺自定義>軟妹子帶你玩轉Python數據可視化，座標軸刻度比例尺自定義</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a411ca8.html alt=軟妹子帶你玩轉Python數據可視化，座標軸方向及範圍設置 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/37c40003c719bfd4bde1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a411ca8.html title=軟妹子帶你玩轉Python數據可視化，座標軸方向及範圍設置>軟妹子帶你玩轉Python數據可視化，座標軸方向及範圍設置</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>