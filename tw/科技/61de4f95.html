<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>蒙特卡羅方法概述 | 极客快訊</title><meta property="og:title" content="蒙特卡羅方法概述 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/776e8b236f774a14841c556abaae8272"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/61de4f95.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/61de4f95.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/61de4f95.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/61de4f95.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/61de4f95.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/61de4f95.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/61de4f95.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/61de4f95.html><meta property="article:published_time" content="2020-11-14T21:08:08+08:00"><meta property="article:modified_time" content="2020-11-14T21:08:08+08:00"><meta name=Keywords content><meta name=description content="蒙特卡羅方法概述"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/61de4f95.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>蒙特卡羅方法概述</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>作為一種隨機採樣方法，馬爾科夫鏈蒙特卡羅（Markov Chain Monte Carlo，以下簡稱MCMC）在機器學習,深度學習以及自然語言處理等領域都有廣泛的應用，是很多複雜算法求解的基礎。</p><p>從名字我們可以看出，MCMC由兩個MC組成，即蒙特卡羅方法（Monte Carlo Simulation，簡稱MC）和馬爾科夫鏈（Markov Chain ，也簡稱MC）。要弄懂MCMC的原理我們首先得搞清楚蒙特卡羅方法和馬爾科夫鏈的原理。</p><h2 class=pgc-h-arrow-right>蒙特卡羅方法</h2><p>蒙特卡羅原來是一個賭場的名稱，用它作為名字大概是因為蒙特卡羅方法是一種隨機模擬的方法，這很像賭博場裡面的扔骰子的過程。原理是通過大量隨機樣本，去了解一個系統，進而得到所要計算的值。</p><p>它非常強大和靈活，又相當簡單易懂，很容易實現。對於許多問題來說，它往往是最簡單的計算方法，有時甚至是唯一可行的方法。</p><p>給定統計樣本集，如何估計產生這個樣本集的隨機變量概率密度函數,是我們比較熟悉的概率密度估計問題。</p><p>求解概率密度估計問題的常用方法是最大似然估計、最大後驗估計等。但是，我們思考概率密度估計問題的逆問題:給定一個概率分佈p(x)，如何讓計算機生成滿足這個概率分佈的樣本。</p><p>這個問題就是統計模擬中研究的重要問題–採樣(Sampling)。</p><p>如果有一個我們很難求解出f(x)f(x)的原函數的函數, 現要求其在定義域 [a, b] 上的積分, 如果這個函數是均勻分佈, 那麼我們可以採樣 [a,b] 區間的 n 個值：${x 0,x_1,…x {n-1}}$,用它們的均值來代表 [a,b] 區間上所有的 f(x) 的值。這樣我們上面的定積分的近似求解為:</p><p>如果不是均勻分佈, 並 <strong>假設我們可以得到 xx 在[a,b][a,b]的概率分佈函數p(x)p(x)</strong> ，那麼我們的定積分求和可以這樣進行：</p><p>上式最右邊的這個形式就是蒙特卡羅方法的一般形式。當然這裡是連續函數形式的蒙特卡羅方法，但是在離散時一樣成立。</p><p>可以看出，最上面我們假設x在[a,b]之間是均勻分佈的時候，p(xi)=1/(b−a)，帶入我們有概率分佈的蒙特卡羅積分的上式，可以得到：</p><p>也就是說，我們最上面的均勻分佈也可以作為一般概率分佈函數p(x)p(x)在均勻分佈時候的特例。那麼我們現在的問題轉到了如何在已知分佈求出 x 的分佈p(x)p(x)對應的若干個樣本上來。</p><h2 class=pgc-h-arrow-right>採樣方法</h2><p>主要有概率分佈採樣及接受-拒絕採樣方法.</p><h3 class=pgc-h-arrow-right>概率分佈採樣</h3><p>如果求出了xx的概率分佈，我們可以基於概率分佈去採樣基於這個概率分佈的 n 個xx的樣本集，帶入蒙特卡羅求和的式子即可求解。但是還有一個關鍵的問題需要解決，即如何基於概率分佈去採樣基於這個概率分佈的 n 個xx的樣本集。</p><p>一般而言均勻分佈 Uniform(0,1) 的樣本是相對容易生成的。 通過線性同餘發生器可以生成偽隨機數，我們用確定性算法生成[0,1]之間的偽隨機數序列後，</p><p>這些序列的各種統計指標和均勻分佈 Uniform(0,1) 的理論計算結果非常接近。這樣的偽隨機序列就有比較好的統計性質，可以被當成真實的隨機數使用。線性同餘隨機數生成器如下:</p><p>式中a，c，ma，c，m是數學推導出的合適的常數。這種算法產生的下一個隨機數完全依賴當前的隨機數，當隨機數序列足夠大的時候，隨機數會出現重複子序列的情況。</p><p>當然，也有很多更加先進的隨機數產生算法出現，比如 numpy 用的是 Mersenne Twister 等.</p><p>而其他常見的概率分佈，無論是離散的分佈還是連續的分佈，它們的樣本都可以通過 Uniform(0,1) 的樣本轉換而得, 但是如何產生滿足其他分佈下的隨機數呢？</p><p>比如二維正態分佈的樣本(Z1,Z2)(Z1,Z2)可以通過通過獨立採樣得到的 uniform(0,1) 樣本對(X1,X2)(X1,X2)通過如下的式子轉換而得：</p><p>其他一些常見的連續分佈，比如 t分佈 ， F分佈 ， Beta分佈 ， Gamma分佈 等，都可以通過類似的方式從 uniform(0,1) 得到的採樣樣本轉化得到。在python的 numpy ， scikit-learn 等類庫中，都有生成這些常用分佈樣本的函數可以使用。</p><p>不過很多時候，我們的x的概率分佈不是常見的分佈，這意味著我們沒法方便的得到這些非常見的概率分佈的樣本集。那這個問題怎麼解決呢？</p><h3 class=pgc-h-arrow-right>接受-拒絕採樣</h3><p>對於概率分佈不是常見的分佈，一個可行的辦法是採用接受-拒絕採樣來得到該分佈的樣本。既然 p(x)p(x) 太複雜在程序中沒法直接採樣，那麼我設定一個程序可採樣的分佈 q(xq(x) 比如高斯分佈，然後按照一定的方法拒絕某些樣本，以達到接近 p(x)p(x) 分佈的目的，其中q(x)q(x)叫做 proposal distribution 。</p><p>具體採用過程如下，設定一個方便採樣的常用概率分佈函數 q(x)，以及一個常量 k，使得 p(x) 總在 kq(x) 的下方。</p><div class=pgc-img><img alt=蒙特卡羅方法概述 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/776e8b236f774a14841c556abaae8272><p class=pgc-img-caption></p></div><p>首先，採樣得到 q(x) 的一個樣本$z 0$，採樣方法如上，使用 uniform(0,1) 轉換得到。然後，從均勻分佈(0,kq(z0))(0,kq(z0))中採樣得到一個值uu。如果uu落在了上圖中的灰色區域，則拒絕這次抽樣，否則接受這個樣本z0z0。重複以上過程得到 n 個接受的樣本 $z_0,z_1,…z {n−1}$,則最後的蒙特卡羅方法求解結果為：</p><p>整個過程中，我們通過一系列的接受拒絕決策來達到用q(x)模擬p(x)概率分佈的目的。</p><h2 class=pgc-h-arrow-right>小結</h2><p>使用接受-拒絕採樣，我們可以解決一些概率分佈不是常見的分佈的時候，得到其採樣集並用蒙特卡羅方法求和的目的。但是接受-拒絕採樣也只能部分滿足我們的需求，在很多時候我們還是很難得到我們的概率分佈的樣本集。比如：</p><ol start=1><li>對於一些二維分佈p(x,y)p(x,y)，有時候我們只能得到條件分佈p(x|y)p(x|y)和p(y|x)p(y|x),卻很難得到二維分佈p(x,y)p(x,y)一般形式，這時我們無法用接受-拒絕採樣得到其樣本集。</li><li>對於一些高維的複雜非常見分佈p(x1,x2,…,xn)p(x1,x2,…,xn)，我們要找到一個合適的q(x)和q(x)和k$非常困難。</li></ol><p>從上面可以看出，要想將蒙特卡羅方法作為一個通用的採樣模擬求和的方法，必須解決如何方便得到各種複雜概率分佈的對應的採樣樣本集的問題。</p><p>此時就需要使用一些更加複雜的隨機模擬的方法來生成樣本。比如馬爾科夫鏈蒙特卡羅方法，瞭解這個算法我們首先要對馬爾科夫鏈的平穩分佈的性質有基本的認識。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>卡羅</a></li><li><a>蒙特</a></li><li><a>概述</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/00145145.html alt=福建省“平潭縣”基本概述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e272987dca8b435a8dc733a7d49ef2e6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/00145145.html title=福建省“平潭縣”基本概述>福建省“平潭縣”基本概述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0f4f341e.html alt=發電廠動力部分概述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0f4f341e.html title=發電廠動力部分概述>發電廠動力部分概述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f7fcf6f5.html alt=羅斯蒙特3051系列變送器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/81dc497104784cfeaf9ca0d02f1f22cc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f7fcf6f5.html title=羅斯蒙特3051系列變送器>羅斯蒙特3051系列變送器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/26fb9d6f.html alt=鍛造篇——鍛造工藝概述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/7f5fe4d41e864ae58c2100bde0e44e5c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/26fb9d6f.html title=鍛造篇——鍛造工藝概述>鍛造篇——鍛造工藝概述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7edb5d1d.html alt=中原官話概述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ea60db8e7cf64d14990a3bec5583b024 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7edb5d1d.html title=中原官話概述>中原官話概述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dedf2651.html alt=電機繞組概述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dedf2651.html title=電機繞組概述>電機繞組概述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/843991c7.html alt=液壓控制閥概述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1521815441159b9a4824212 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/843991c7.html title=液壓控制閥概述>液壓控制閥概述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/30d461d9.html alt=換熱器原理與種類概述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a79b8508df0d4a609402ffff2c3239b7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/30d461d9.html title=換熱器原理與種類概述>換熱器原理與種類概述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c69e3d63.html alt=電氣備品備件管理方案概述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b8649ba4d3d740ee8682dd2f0a7cf6cd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c69e3d63.html title=電氣備品備件管理方案概述>電氣備品備件管理方案概述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d6745bcd.html alt=Map接口概述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/7e955e46020b4afc85b3d83a8cbd92ca style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d6745bcd.html title=Map接口概述>Map接口概述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/13c523d3.html alt=飼料用天然色素概述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/4e5a0002d5316173e498 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/13c523d3.html title=飼料用天然色素概述>飼料用天然色素概述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b4b14775.html alt=地震概述和預測 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/770e3502d81f4719ab47c0ca3d4b9501 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b4b14775.html title=地震概述和預測>地震概述和預測</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1a077261.html alt=軟土地基處理方法概述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1a077261.html title=軟土地基處理方法概述>軟土地基處理方法概述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d502b32a.html alt=電機小知識——電機概述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9fdf58d609ce4e5ea6861f7b34983504 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d502b32a.html title=電機小知識——電機概述>電機小知識——電機概述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ce6104b9.html alt=概述8個高壓清洗機操作說明 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/dbb0259c10a34463b331a6967c767c70 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ce6104b9.html title=概述8個高壓清洗機操作說明>概述8個高壓清洗機操作說明</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>