<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Fzf：Golang開發的Github高星系統模糊搜索補全工具 | 极客快訊</title><meta property="og:title" content="Fzf：Golang開發的Github高星系統模糊搜索補全工具 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/b6efd0314b444ab584fe52ec5ecf8252"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6b8c2546.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6b8c2546.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/6b8c2546.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6b8c2546.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6b8c2546.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/6b8c2546.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/6b8c2546.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6b8c2546.html><meta property="article:published_time" content="2020-10-29T21:10:13+08:00"><meta property="article:modified_time" content="2020-10-29T21:10:13+08:00"><meta name=Keywords content><meta name=description content="Fzf：Golang開發的Github高星系統模糊搜索補全工具"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/6b8c2546.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Fzf：Golang開發的Github高星系統模糊搜索補全工具</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>工欲善其事，必先利其器，常使用Linux命令終端的人都知道，bash默認情況下提供了很多便利的功能，比如TAB命令補全等，CTRL+R命令搜索等，但是這些功能往往有這樣或者那樣的問題致使不夠盡興。今天，蟲蟲給大家介紹一款強大通用系統模糊搜索補全工具Fzf，可以給這方面的功能錦上添花，趨於完美。</p><div class=pgc-img><img alt=Fzf：Golang開發的Github高星系統模糊搜索補全工具 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b6efd0314b444ab584fe52ec5ecf8252><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>概述</h1><p>Fzf是一個開源的交互式shell命令行模糊查詢工具，可以用於對文件，歷史記錄（history），進程，主機名，書籤，git commit等等列表和應用。</p><p>Fzf是用Golang語言開發的shell系統工具，源代碼託管再Github上（github.com/junegunn/fzf.git），截止目前該項目已經累積了25500多星，Fork上千。</p><p>藉助於Golang靜態編譯的特點，Fzf具有便攜式，無依賴性；高性能，速度飛快的優點，同時還具有：</p><p>最全面的功能集；</p><p>佈局靈活；</p><p>額外強大的插件支持：</p><p>比如Vim/Neovim插件，可支持鍵綁定和模糊自動補全。</p><h1 class=pgc-h-arrow-right>安裝</h1><p>Fzf支持通過Homebrew、操作系統包管理器以及源碼方式安裝。其文件項目有四部分組成，包括以下組件：</p><p>fzf可執行文件；</p><p>fzf-tmux腳本，用於在tmux窗格中啟動fzf；</p><p>Shell擴展：支持按鍵綁定（CTRL-T，CTRL-R和ALT-C），支持bash，zsh，fish。</p><p>模糊自動補全，支持bash，zsh。</p><p>Vim/Neovim插件。</p><p>其中，fzf可執行文件是必須的，其他組件依賴於它。如果不需要其他組件，可以單獨下載fzf可執行文件運行。</p><h1 class=pgc-h-arrow-right>發行版包管理器安裝</h1><p>Fzf最簡單的安裝方法就是通過OS發行版本的包管理器一鍵安裝。Fzf支持了最廣泛的發行版本安裝：</p><p><strong>Arch Linux：</strong></p><p>sudo pacman -S fzf</p><p><strong>Debian系：</strong></p><p>fzf支持Debian Buster及更新的版本，可以使用apt-get包管理器安裝。sudo apt-get install fzf</p><p><strong>Fedora：</strong></p><p>fzf支持Fedora 26及更新的版本，可以使用dnf安裝：</p><p>sudo dnf install fzf</p><p>默認情況下，啟用vim或neovim的Shell補全和插件。Shell鍵綁定已安裝，但默認情況下未啟用。有關更多信息，請參見Fedora的軟件包文檔（/usr/share/doc/fzf/README.Fedora）。</p><p><strong>FreeBSD：</strong></p><p>pkg install fzf</p><p><strong>NixOS：</strong></p><p>以使用Nix軟件包管理器來安裝fzf。</p><p>nix-env -iA nixpkgs.fzf</p><p><strong>openSUSE：</strong></p><p>對於openSUSE 支持Tumbleweed版本，可通過zypper安裝：</p><p>sudo zypper install fzf</p><p><strong>Windows：</strong></p><p>Windows的預編譯二進制文件可以項目發佈頁下載。fzf也支持以Chocolatey或Scoop軟件包管理器安裝：</p><p>choco install fzf</p><p>scoop install fzf</p><p>但是，該項目的其他組件可能無法在Windows上運行。已知問題和限制可以在Wiki頁面上找到。可能要考慮在Windows子系統（適用於Linux）上安裝fzf，以確保一切運行正常。</p><p><strong>Homebrew安裝</strong></p><p>對於Mac系統可以Homebrew fzf。</p><p>brew install fzf</p><p>如果要安裝用鍵綁定和模糊補全腳本使用：</p><p>(brew --prefix)/opt/fzf/install</p><p>也可以通過MacPorts：</p><p>sudo port install fzf</p><h1 class=pgc-h-arrow-right>Git安裝</h1><p>如果你的用的發行版恰好不支持，或者你需要自定義源碼安裝最新版本，可以通過git clone 克隆項目，然後執行安裝程序即可。</p><p>git clone --depth 1 github.com/junegunn/fzf.git ~/.fzf</p><p>~/.fzf/install</p><div class=pgc-img><img alt=Fzf：Golang開發的Github高星系統模糊搜索補全工具 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/20c5ded4ae824cde9d53a7e82f4ca149><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>Vim插件</h1><p>安裝好Fzf後，在Vim配置文件中將目錄添加到&runtimepath，就可以在Vim啟它，如下所示：</p><p>對Homebrew安裝的</p><p>set rtp+=/usr/local/opt/fzf</p><p>對通過git安裝的</p><p>set rtp+=~/.fzf</p><p>如果使用要vim-plug，則配置如下：</p><p>對Homebrew安裝的</p><p>Plug '/usr/local/opt/fzf'</p><p>對通過git安裝的</p><p>Plug '~/.fzf'</p><p>也可以使用vim-plug來完成安裝工作，而不是在系統上單獨安裝fzf（使用Homebrew或git clone），然後通過配置在Vim中啟用（添加到&runtimepath ）。</p><p>Plug 'junegunn/fzf', { 'dir': '~/.fzf', 'do': './install --all' }</p><h1 class=pgc-h-arrow-right>升級fzf</h1><p>Fzf在持續迭代開發，為了獲取最新功能，則需要時時升級版本。Fzf的升級方法如下：</p><p>git安裝：</p><p>cd ~/.fzf && git pull && ./install</p><p>brew：</p><p>brew update; brew reinstall fzf</p><p>chocolatey: choco upgrade fzf</p><p>vim-plug: :PlugUpdate fzf</p><h1 class=pgc-h-arrow-right>Fzf源碼編譯</h1><p>Fzf編譯需要golang 1.11版本以上，還依賴下面的第三方庫：</p><p>使用的第三方庫</p><p>mattn/go-runewidth</p><p>mattn/ o-shellwords</p><p>mattn/go-isatty</p><p>tcell</p><p>構建fzf二進制文件並將其複製到bin目錄，</p><p>make && make install</p><p>在目標中構建32位和64位可執行文件和tarball</p><p>make release</p><p>為目標中所有受支持的平臺製作發佈檔案</p><p>make release-all</p><p><strong>使用go get構建</strong></p><p>Fzf也支持，直接通過go get命令，而無需手動克隆存儲庫。具體命令如下：</p><p>go get -u github.com/junegunn/fzf</p><h1 class=pgc-h-arrow-right>Fzf用法大全</h1><p>Fzf安裝後，將啟動交互式查找程序，從STDIN中讀取列表，然後將所選項目寫入STDOUT。</p><p>find * -type f | fzf > selected</p><div class=pgc-img><img alt=Fzf：Golang開發的Github高星系統模糊搜索補全工具 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/26b6fe74a6e74e658a847e06e8f59e19><p class=pgc-img-caption></p></div><p>如果沒有STDIN管道，則fzf將使用find命令來獲取文件列表（不包括隱藏文件）。（可以使用FZF_DEFAULT_COMMAND覆蓋默認命令）</p><p>vim $(fzf）</p><h1 class=pgc-h-arrow-right>使用finder</h1><p>CTRL-J/CTRL-K（或CTRL-N/CTRL-P）可上下移動光標</p><p>輸入鍵選擇項目，按CTRL-C/ TRL-G/ESC退出</p><p>在多選模式（-m）中，使用TAB和Shift-TAB標記多個項目</p><p>Emacs樣式鍵綁定</p><p>鼠標：滾動，單擊，雙擊；在多選模式下按住Shift點擊並Shift滾動。</p><h1 class=pgc-h-arrow-right>佈局</h1><p>默認情況下，Fzf開題全屏模式，我們可以使用--height選項使其在光標下方開始。</p><p>vim $(fzf --height 40%)</p><div class=pgc-img><img alt=Fzf：Golang開發的Github高星系統模糊搜索補全工具 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e4c4559e03f34266844efb522cf8e2f6><p class=pgc-img-caption></p></div><p>如果喜歡"自上而下"的佈局而不是默認的"自下而上"的佈局，請使用--reverse和--layout選項。</p><p>vim $(fzf --height 40%)</p><div class=pgc-img><img alt=Fzf：Golang開發的Github高星系統模糊搜索補全工具 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6218feb51fcd4bb3b39101492de700da><p class=pgc-img-caption></p></div><p>可以將這些選項添加到$ FZF_DEFAULT_OPTS，以便默認情況下應用它們。例如，</p><pre>export FZF_DEFAULT_OPTS ='--height 40% --layout = reverse --border'</pre><h1 class=pgc-h-arrow-right>搜索語法</h1><p>除非有特殊說明，Fzf都會以擴展搜索模式啟動，可以在其中鍵入多個以空格分隔的搜索詞。比如：^music .mp3$ chongchong !fire</p><p>相關解釋如下：</p><p>chongchong模糊匹配，匹配chognchong字條；</p><p>^music前綴精準匹配，匹配以music開頭的字條；</p><p>.mp3$ 後綴精準匹配，匹配以.mp3結尾的字條；</p><p>'whild 精準匹配，匹配包含wild的字條；</p><p>!fire 反向精準匹配，匹配其中不包含fire的字條；！也支持對前後綴匹配的反向匹配。</p><p>上例子表示查找以music開頭，以.mp3結尾，不包括fire，含有chongchong的字條。</p><p>如果不喜歡模糊匹配並且不想"引用"每個單詞，可以用-e或--exact選項啟動fzf。注意：設置為--exact時，"-prefix"選項會實效。</p><p>單個豎線字符可以充當OR運算符。比如，下面的查詢匹配以core開頭，以go，rb或py結尾的條目。</p><p>^core go$ | rb$ | py$</p><h1 class=pgc-h-arrow-right>環境變量</h1><p><strong>FZF_DEFAULT_COMMAND</strong></p><p>輸入為tty時使用的默認命令</p><p>例如導出FZF_DEFAULT_COMMAND ='fd --type f'</p><p><strong>FZF_DEFAULT_OPTS</strong></p><p>默認選項</p><p>例如export FZF_DEFAULT_OPTS ="-layout = reverse --inline-info"</p><h1 class=pgc-h-arrow-right>fzf-tmux腳本</h1><p>fzf-tmux是一個bash腳本，用來在tmux窗格中打開fzf。</p><div class=pgc-img><img alt=Fzf：Golang開發的Github高星系統模糊搜索補全工具 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/54317faf494f47a2a625886ca4eb3ef3><p class=pgc-img-caption></p></div><p><br></p><p>在水平分割中窗體中（15行））顯示git分支</p><p>git branch | fzf-tmux -d 15</p><p>在左側垂直分割的窗體中（屏幕寬度的20%）顯示字典的內容：</p><p>cat /usr/share/dict/words | fzf-tmux -l 20% --multi --reverse</p><p>如果不是tmux模式，該插件也可以正常工作，只是-[udlr]選項會實效。通常模式下需要使用--height HEIGHT[%]選項，啟動非全屏模式的fzf。</p><p>fzf --height 40%</p><h1 class=pgc-h-arrow-right>命令行的鍵綁定</h1><p>安裝腳本將會在bash，zsh和fish添加以下按鍵綁定。</p><p><strong>CTRL-T: </strong>將選定的文件或者目錄粘貼到命令行上</p><div class=pgc-img><img alt=Fzf：Golang開發的Github高星系統模糊搜索補全工具 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c60db9c50ae4425dbbdfbd3e39c59a82><p class=pgc-img-caption></p></div><p>可通過設置FZF_CTRL_T_COMMAND覆蓋默認命令；</p><p>可通過設置FZF_CTRL_T_OPTS設置其他選項；</p><p><strong>CTRL-R : </strong>從歷史記錄中將所選命令粘貼到命令行上</p><div class=pgc-img><img alt=Fzf：Golang開發的Github高星系統模糊搜索補全工具 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/d141722d1c9a4fb08f3d08c85e3d48c1><p class=pgc-img-caption></p></div><p>如果想按時間順序查看命令，請再次按CTRL-R，按相關性切換排序</p><p>可通過設置FZF_CTRL_R_OPTS設置其他選項；</p><p><strong>ALT-C </strong>cd進入所選目錄</p><p>可通過設置FZF_ALT_C_COMMAND以覆蓋默認命令；</p><p>可通過設置FZF_ALT_C_OPTS設置其他選項；</p><p>在tmux會話下，可以通過將FZF_TMUX設置為1來在拆分窗格中啟動fzf，然後使用FZF_TMUX_HEIGHT更改窗格的高度（例如20%，50%等）。</p><p>如果在bash上使用vi模式，則需要在.bashrc中的source ~/.fzf.bash之前添加set -o vi，以使其正確設置vi模式的鍵綁定。</p><p>可以在Wiki頁面上找到更多提示。</p><h1 class=pgc-h-arrow-right>bash和zsh的模糊補全</h1><h1 class=pgc-h-arrow-right>文件和目錄</h1><p>如果光標前的單詞以觸發序列（默認為<strong>**</strong>）結尾，則可以觸發文件和目錄的模糊補全。</p><p>COMMAND [DIRECTORY/] [FUZZY_PATTERN] ** &lt;TAB></p><p>當前目錄下的文件,可以使用TAB鍵選擇多個項目</p><p>cat ** &lt;TAB></p><div class=pgc-img><img alt=Fzf：Golang開發的Github高星系統模糊搜索補全工具 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3c450773afab4739865383b8acd6fb62><p class=pgc-img-caption></p></div><p>對父目錄下的文件名補全</p><p>vim ../** &lt;TAB></p><div class=pgc-img><img alt=Fzf：Golang開發的Github高星系統模糊搜索補全工具 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c723d72062aa4e4492547e7c3d4af107><p class=pgc-img-caption></p></div><p>父目錄下匹配`fzf`的文件</p><p>vim ../fzf** &lt;TAB></p><div class=pgc-img><img alt=Fzf：Golang開發的Github高星系統模糊搜索補全工具 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a8bab949ea7f4a1cafd39db9a2d2e798><p class=pgc-img-caption></p></div><p>用戶主目錄下的文件</p><p>cat ~/** &lt;TAB></p><p>當前目錄下的目錄（單選）</p><p>cd ** &lt;TAB></p><p>~/github下與`fzf`匹配的目錄</p><p>cd ~/github/fzf** &lt;TAB></p><h1 class=pgc-h-arrow-right>進程ID</h1><p>PID的模糊補全提供給kill命令。在這種情況下，沒有觸發序列，只需在kill命令後按tab鍵即可。</p><p>可以使用&lt;TAB>或&lt;Shift-TAB>鍵選擇多個進程</p><p>kill -9 &lt;TAB></p><div class=pgc-img><img alt=Fzf：Golang開發的Github高星系統模糊搜索補全工具 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ea0fc118f28c4e5c9d7220e8e67dbc02><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>主機名</h1><p>對ssh和telnet命令，支持主機名的模糊補全。補全名稱是從/etc/hosts和~/.ssh/config中獲取的。</p><p>ssh ** &lt;TAB></p><p>telnet ** &lt;TAB></p><h1 class=pgc-h-arrow-right>環境變量/別名</h1><p>unset **&lt;TAB></p><p>export **&lt;TAB></p><p>unalias **&lt;TAB></p><h1 class=pgc-h-arrow-right>默認配置項</h1><h1 class=pgc-h-arrow-right>觸發關鍵字</h1><p>比如使用~~作為觸發關鍵字，不用默認的**，可通過設置：</p><p>export FZF_COMPLETION_TRIGGER='~~'</p><h1 class=pgc-h-arrow-right>fzf命令的選項</h1><p>export FZF_COMPLETION_OPTS='+c -x'</p><h1 class=pgc-h-arrow-right>默認搜索工具</h1><p>使用fd（github.com/sharkdp/fd）代替默認find命令列出路徑</p><p>_fzf_compgen_path() {</p><p>fd --hidden --follow --exclude ".git" . "$1"</p><p>}</p><p>其中函數（$1）的第一個參數開始便利的基礎目錄。</p><p>使用fd生成目錄補全的列表：</p><p>_fzf_compgen_dir() {</p><p>fd --type d --hidden --follow --exclude ".git" . "$1"</p><p>}</p><h1 class=pgc-h-arrow-right>增加命令支持</h1><p>在bash上，僅對預定義的命令集啟用了模糊補全，其詳細裡列表通過"complete | grep _fzf"查看。Fzf也支持對其進行擴展，方法是：</p><p>_fzf_setup_completion path|dir COMMANDS...</p><p>比如：</p><p>_fzf_setup_completion path ag git kubectl</p><p>_fzf_setup_completion dir tree</p><h1 class=pgc-h-arrow-right>Vim插件</h1><p>Fzf的Vim插件提供了兩個核心功能fzf#run和fzf#wrap，其中:fzf命令基本文件選擇器命令。</p><p><strong>fzf#run（[spec dict]）</strong>：使用給定的規範在Vim中啟動fzf，比如：</p><p>:call fzf#run({'source': 'ls'})</p><p><strong>fzf#wrap([spec dict]) -> (dict) </strong>：採用fzf#run的規範，並返回其擴展版本以及用於處理全局首選項的其他選項（g：fzf_xxx）。</p><p>:echo fzf#wrap({'source': 'ls'})</p><p>通常在將規範傳遞給fzf#run之前將其包裝在fzf#wrap</p><p>:call fzf#run(fzf#wrap({'source': 'ls'}))</p><p><strong>:FZF [fzf_options string] [path string]：</strong>基本的模糊文件選擇器，對那些不想編寫VimScript來實現自定義命令的人的參考實現</p><h1 class=pgc-h-arrow-right>用法</h1><p><strong>:FZF[!]</strong></p><p>"在當前目錄下查找文件</p><p>:FZF</p><p>在主目錄下查找文件</p><p>：FZF ~</p><p>使用fzf命令行選項</p><p>:FZF --reverse --info=inline /tmp</p><p>與ctrlp.vim相似，使用Enter鍵，CTRL-T，CTRL-X或CTRL-V在當前窗口，新選項卡，水平分割或垂直分割中分別打開選定的文件。</p><p>注意，環境變量FZF_DEFAULT_COMMAND和FZF_DEFAULT_OPTS也起作用。</p><h1 class=pgc-h-arrow-right>配置項</h1><p>g:fzf_action：自定義的額外按鍵綁定，用於以不同方式打開所選文件</p><p>g:fzf_layout: 確定fzf窗口的大小和位置</p><p>g:fzf_colors: 自定義fzf顏色以匹配當前的配色方案</p><p>g:fzf_history_dir: 啟用歷史記錄功能</p><h1 class=pgc-h-arrow-right>fzf#run</h1><p>fzf#run()函數是Vim集成的核心。它需要一個字典參數，一個規範，並相應地啟動fzf進程。至少要指定接收器選項，以告訴它應該對所選條目執行的操作。</p><p>call fzf#run({'sink': 'e'})</p><p>上面沒有指定源，所以這等效於在沒有標準輸入管道的情況下在命令行上啟動fzf。fzf將使用find命令（或$ FZF_DEFAULT_COMMAND（如果已定義））列出當前目錄下的文件。選擇一個文件時候，它將使用接收器:e命令將其打開。如果要在新選項卡中打開它，則可以傳遞:tabedit命令作為接收器。</p><p>call fzf#run({'sink': 'tabedit'})</p><p>可以使用任何shell命令作為源，而不是使用默認的find命令。比如下面示例將列出git管理的文件。相當於shell命令行下運行git ls-files | fzf。</p><p>call fzf#run({'source': 'git ls-files', 'sink': 'e'})</p><p>可以將fzf選項指定為spec詞典中的選項條目。</p><p>call fzf#run({'sink': 'tabedit', 'options': '--multi --reverse'})</p><p>不希望fzf窗口占據整個屏幕，還可以傳遞佈局選項。</p><p>call fzf#run({'source': 'git ls-files', 'sink': 'e', 'left': '40%'})</p><p>call fzf#run({'source': 'git ls-files', 'sink': 'e', 'window': '30vnew'})</p><p>源不一定是外部shell命令，可以傳遞Vim​​數組作為源。下面的示例中，傳遞了顏色名稱實現顏色方案選擇器的源。</p><p>call fzf#run({'source': map(split(globpath(&rtp, 'colors/*.vim')),</p><p>\ 'fnamemodify(v:val, ":t:r")'),</p><p>\ 'sink': 'colo', 'left': '25%'})</p><h1 class=pgc-h-arrow-right>fzf#wrap</h1><p>前面說過:FZF命令的幾個方面可以使用一組全局選項變量進行配置。使用不同的方式打開文件（g:fzf_action），窗口位置和大小（g:fzf_layout），調色板（g:fzf_colors）等不同的方式。那麼，如何使我們的自定義fzf#run調用也能起作用呢？只需將其傳遞給fzf#run，然後用fzf#wrap修飾spec詞典:</p><p>fzf#wrap([name string], [spec dict], [fullscreen bool]) -> (dict)</p><p>所有參數都是可選的。通常只需要傳遞一個規範字典。</p><p>name用於管理歷史記錄文件。如果未定義g:fzf_history_dir，則會被忽略。</p><p>fullscreeen 可設置為0或1（默認值:0）。</p><p>fzf#wrap接受一個規範，並返回它的擴展版本（也是字典），並帶有用於解決全局首選項的其他選項。可以像這樣檢查它的返回值：</p><p>echo fzf#wrap({'source': 'ls'})</p><p>打包規範之後，就可將其傳遞給fzf#run。</p><p>call fzf#run(fzf#wrap({'source': 'ls'}))</p><p>現在，它支持CTRL-T，CTRL-V和CTRL-X鍵綁定，並根據g:fzf_layout設置打開fzf窗口。</p><p>為了使其易於使用，讓我們定義LS命令使用。</p><p><br></p><p>command! LS call fzf#run(fzf#wrap({'source': 'ls'}))</p><p>然後就可以通:LS調用。</p><h1 class=pgc-h-arrow-right>其他功能</h1><h1 class=pgc-h-arrow-right>性能問題</h1><p>Fzf很快，而且會變得越來越快。在大多數情況下，性能都不是問題。但是有幾個性能選項需要了解。</p><p><strong>--ansi</strong>：告訴Fzf提取並解析輸入中的ANSI顏色代碼，這會使初始掃描變慢。因此，不建議將其添加到$FZF_DEFAULT_OPTS中。</p><p><strong>--nth</strong>：該選項也會使fzf變慢，指定該選項後fzf必須對每行做標記。</p><p><strong>--with-nth</strong>：該選項也會使fzf變慢，指定該選項後fzf必須每行標記並重新轉載。</p><p>如果對想能有嚴苛要求，可以考慮使用--algo = v1（默認值為v2）使fzf使用更快的貪婪算法。但是，不能保證該算法找到最佳順序的匹配，因此一般不建議使用。</p><h1 class=pgc-h-arrow-right>執行外部程序</h1><p>可以通過設置鍵綁定來啟動外部進程，而無需離開fzf（execute，execute-silent）。</p><p>通過按F1鍵以較少的文件打開文件而不離開fzf，通過按CTRL-Y將行復制到剪貼板並中止fzf（需要pbcopy支持）</p><p>fzf --bind 'f1:execute(less -f {}),ctrl-y:execute-silent(echo {} | pbcopy)+abort'</p><h1 class=pgc-h-arrow-right>預覽窗口</h1><p>設置--preview選項時，fzf會自動以當前行作為參數啟動外部進程，並在拆分窗口中顯示結果。</p><p>使用{}替換為焦點行的單引號字符串</p><p>fzf --preview 'cat {}'</p><p>由於預覽窗口僅在該過程完成後才更新，因此該命令快速完成很重要。</p><p>使用head而不是cat，以便命令不會花費太長時間來完成</p><p>fzf --preview 'head -100 {}'</p><p>預覽窗口支持ANSI顏色，因此可以使用語法突出顯示文件內容的程序，比如和</p><p>bat、Highlight、CodeRay、Rouge等配合使用，比如下面的命令依次使用bat, highlight, coderay, rougify，然後回退到cat：</p><p>fzf --preview '[[ $(file --mime {}) =~ binary ]] &&</p><p>echo {} is a binary file ||</p><p>(bat --style=numbers --color=always {} ||</p><p>highlight -O ansi -l {} ||</p><p>coderay {} ||</p><p>rougify {} ||</p><p>cat {}) 2> /dev/null | head -500'</p><p>也可以使用--preview-window選項自定義預覽窗口的大小和位置。例如，</p><p>fzf --height 40% --reverse --preview 'file {}' --preview-window down:1</p><p>fzf --height 40％--reverse --preview'file {}'--preview-window down：1</p><h1 class=pgc-h-arrow-right>.gitignore</h1><p>可以使用fd，ripgrep或silver搜索程序代替默認的find命令來遍歷文件系統，搜索時候支持利用git忽略定義.gitignore文件排除文件和目錄。</p><p>將fd的輸出輸入fzf</p><p>fd --type f | fzf</p><p>將fd設置為fzf的默認源</p><p>export FZF_DEFAULT_COMMAND='fd --type f'</p><p>設置後， fzf（不帶管道）將使用fd代替find</p><p>也支持對CTRL-T命令使用：</p><p>export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"</p><p>如果要使該命令遵循符號鏈接，並且不希望其排除隱藏文件，可使用以下命令：</p><p>export FZF_DEFAULT_COMMAND='fd --type f --hidden --follow --exclude .git'</p><h1 class=pgc-h-arrow-right>git ls-tree快速遍歷</h1><p>如果在大型git存儲庫中運行fzf，則使用git ls-tree可以提高遍歷的速度。</p><p>export FZF_DEFAULT_COMMAND='</p><p>(git ls-tree -r --name-only HEAD ||</p><p>find . -path "*/\.*" -prune -o -type f -print -o -type l -print |</p><p>sed s/^..//) 2> /dev/null'</p><h1 class=pgc-h-arrow-right>Fish Shell</h1><p>Fish Shell 2.6.0之前的版本不允許在命令替換中從STDIN讀取，所以簡單的vim（fzf）將無法正常工作。 fish 2.5.0和更早版本需要使用使用read fish命令：</p><p>fzf | read -l result; and vim $result</p><p>對於多個結果：</p><p>fzf -m | while read -l r; set result $result $r; end; and vim $result</p><p>fish shell的glob系統系統和shell不同，所以**的補全功能將不起作用。但是，CTRL-T命令將使用命令行最後一個標記作為遞歸搜索的根文件夾。例如，在以下命令行的末尾按下CTRL-T</p><p>ls /var/</p><p>將列出/var/下的所有文件和文件夾。</p><p>使用自定義FZF_CTRL_T_COMMAND時，請使用未擴展的$dir變量來使用此功能。當最後不是有效目錄時，$dir默認為.。 例：</p><p>set -g FZF_CTRL_T_COMMAND "command find -L \$dir -type f 2> /dev/null | sed '1d; s#^\./##'"</p><h1 class=pgc-h-arrow-right>總結</h1><p>Fzf是一款非常優秀、老少皆宜的開源系統工具，可以用來取代shell默認的搜索和補全行為。由於使用golang開發安裝部署非常方便，性能也非常高。適合於開發者，運維和其他Linux用戶,Github 2萬多星就足以說明其多受歡迎了,非常值得大家使用。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Fzf</a></li><li><a>Golang</a></li><li><a>開發</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/a980c6f3.html alt=教你從頭學前端開發——第一個網頁（一） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1c44113d83f24f5db93c8353aff0c670 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a980c6f3.html title=教你從頭學前端開發——第一個網頁（一）>教你從頭學前端開發——第一個網頁（一）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e1f5a66a.html alt=網頁開發網頁的相關概念你知道嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8ca7902bdcb14bc5a25a88be4953edd6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e1f5a66a.html title=網頁開發網頁的相關概念你知道嗎？>網頁開發網頁的相關概念你知道嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9552c1b8.html alt="軟件開發中數據庫必備基礎01 - 圖解事務基礎" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e4e00ac778db451792b955bde23add02 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9552c1b8.html title="軟件開發中數據庫必備基礎01 - 圖解事務基礎">軟件開發中數據庫必備基礎01 - 圖解事務基礎</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f8c3b92d.html alt=python安全開發軍規之四：使用安全的隨機數生成器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/bbda123b84db44148aca9d3e26ddf119 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f8c3b92d.html title=python安全開發軍規之四：使用安全的隨機數生成器>python安全開發軍規之四：使用安全的隨機數生成器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/234d55fa.html alt=Java開發課程（十）——面向對象5、多態 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/df3621e51e4242fd90731dd013472f12 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/234d55fa.html title=Java開發課程（十）——面向對象5、多態>Java開發課程（十）——面向對象5、多態</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8dd83b90.html alt=常用最全正則表達式整理(開發必備) class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/5127ac984657471b853b307afe52b2fe style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8dd83b90.html title=常用最全正則表達式整理(開發必備)>常用最全正則表達式整理(開發必備)</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e2ad303f.html alt=給JAVA開發人員的正則表達式入門課 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/5d620d422d0a4855924c5bcbf8ba483a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e2ad303f.html title=給JAVA開發人員的正則表達式入門課>給JAVA開發人員的正則表達式入門課</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a278a157.html alt=中國尚未被開發的海島，遊客甚少景色美爆，距江浙滬超近 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6150f65415b047acad00ca52441a93ec style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a278a157.html title=中國尚未被開發的海島，遊客甚少景色美爆，距江浙滬超近>中國尚未被開發的海島，遊客甚少景色美爆，距江浙滬超近</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d260a748.html alt=測試開發專題：spring-boot統一異常捕獲 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/135918e30e2f4a2ea248b539eb383688 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d260a748.html title=測試開發專題：spring-boot統一異常捕獲>測試開發專題：spring-boot統一異常捕獲</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d7062663.html alt="道韻筋骨開發 解讀普及體系中大家所熟悉的“開胯”（撥胯）練法" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f09cbcf088974d11b128e0446ea00ccb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d7062663.html title="道韻筋骨開發 解讀普及體系中大家所熟悉的“開胯”（撥胯）練法">道韻筋骨開發 解讀普及體系中大家所熟悉的“開胯”（撥胯）練法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5a9b1eec.html alt="Golang 入門 : 理解併發與並行" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/cf0d86c0222b4f50ad5ba925231b361e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5a9b1eec.html title="Golang 入門 : 理解併發與並行">Golang 入門 : 理解併發與並行</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/aa93bfe3.html alt=服務器開發專題1-程序，進程的區別和併發概念 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1534549004517ed1429f6ce style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/aa93bfe3.html title=服務器開發專題1-程序，進程的區別和併發概念>服務器開發專題1-程序，進程的區別和併發概念</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/63619dc0.html alt=匯川六宗肥地上架，開發商們都不淡定了 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/5fb5a9d4ae93444e8660c99914c3e7ad style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/63619dc0.html title=匯川六宗肥地上架，開發商們都不淡定了>匯川六宗肥地上架，開發商們都不淡定了</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d068068a.html alt=柬埔寨知名開發公司指定雷邦仕為防水材料合作品牌 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/3331dc1b6b1d4754acf196f00164ed8c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d068068a.html title=柬埔寨知名開發公司指定雷邦仕為防水材料合作品牌>柬埔寨知名開發公司指定雷邦仕為防水材料合作品牌</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/826d97dc.html alt=石油開發與開採基礎知識 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/826d97dc.html title=石油開發與開採基礎知識>石油開發與開採基礎知識</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>