<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>百度語義解析 ( Text-to-SQL ) 技術研究及應用 | 极客快訊</title><meta property="og:title" content="百度語義解析 ( Text-to-SQL ) 技術研究及應用 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/780ac2852a114bb8a09aeffaf6b1f45e"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6b91c075.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6b91c075.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/6b91c075.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6b91c075.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6b91c075.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/6b91c075.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/6b91c075.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/6b91c075.html><meta property="article:published_time" content="2020-11-14T21:01:59+08:00"><meta property="article:modified_time" content="2020-11-14T21:01:59+08:00"><meta name=Keywords content><meta name=description content="百度語義解析 ( Text-to-SQL ) 技術研究及應用"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/6b91c075.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>百度語義解析 ( Text-to-SQL ) 技術研究及應用</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/780ac2852a114bb8a09aeffaf6b1f45e><p class=pgc-img-caption></p></div><p>來源：DataFunTalk</p><p>本文長度為<strong>6500字</strong>，建議閱讀<strong>10+分鐘</strong></p><p>本文介紹自然語言問題轉成數據庫可操作的SQL查詢語句的應用。</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/42c89835624a44dca9dd574a4739bc33><p class=pgc-img-caption></p></div><p><strong>[ 導讀 ]</strong>語義解析 ( Semantic Parsing ) 是自然語言處理技術的核心任務之一，涉及語言學、計算語言學、機器學習以及認知語言等多個學科，在近幾年中獲得了廣泛關注，語義解析任務有助於促進機器語言理解的快速發展。</p><p>本文重點介紹語義解析技術中的Text-to-SQL任務，讓機器自動將用戶輸入的自然語言問題轉成數據庫可操作的SQL查詢語句，實現基於數據庫的自動問答能力。</p><h1 class=pgc-h-arrow-right>任務介紹及研究動機</h1><p>當前，大量信息存儲在結構化和半結構化知識庫中，如數據庫。對於這類數據的分析和獲取需要通過SQL等編程語言與數據庫進行交互操作，SQL的使用難度限制了非技術用戶，給數據分析和使用帶來了較高的門檻。人們迫切需要技術或工具完成自然語言與數據庫的交互，因此誕生了Text-to-SQL任務。</p><p>我們通過圖1中的實例來介紹一下Text-to-SQL任務。該任務包含兩部分：<strong>Text-to-SQL解析器</strong>和<strong>SQL執行器。</strong></p><p>解析器的輸入是給定的數據庫和針對該數據庫的問題，輸出是問題對應的SQL查詢語句，如圖中紅色箭頭標示。SQL執行器在數據庫上完成該查詢語句的執行，及給出問題的最終答案，如圖中綠色箭頭標示。</p><p>SQL執行器有很多成熟的系統，如MySQL，SQLite等，該部分不是本文重點。本文主要介紹解析器，學術界中Text-to-SQL任務默認為Text-to-SQL解析模型。</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/3a9e4a9a33114aae93dbf87ea5b4e544><p class=pgc-img-caption></p></div><p>圖1</p><p>首先，我們介紹一下術語<strong>“數據庫”</strong>和<strong>“SQL查詢語句”</strong>：</p><p><strong>1. 數據庫由一張或多張表格構成，表格之間的關係通過外鍵給出。</strong>在該實例中，數據庫由表 “中國城市”和“2018年宜居城市” 構成，兩張表通過外鍵：“中國城市”的“名稱”列和“2018年宜居城市”的“名稱”列關聯；</p><p><strong>2. SQL是數據庫查詢語言，其構成來自3部分：</strong>數據庫（如實例SQL查詢語句中藍色標註的成分）、問題（如實例SQL查詢語句紅色標註的成分）、SQL關鍵詞（如實例SQL查詢語句中的Select、From、Where等）。</p><p>其次，我們介紹一下Text-to-SQL解析模型。根據SQL的構成，解析器需要完成兩個任務，即<strong>“問題與數據庫的映射”</strong>和<strong>“SQL生成”</strong>。</p><p>在問題與數據庫的映射中，需要找出問題依賴的表格以及具體的列，如圖1實例中，問題“綠化率前5的城市有哪些，分別隸屬於哪些省？”依賴的數據庫內容包括：表格“中國城市”，具體的列“名稱”、“所屬省”、“綠化率”（SQL查詢語句藍色標註成分）。</p><p>在SQL生成中，結合第一步識別結果以及問題包含信息，生成滿足語法的SQL查詢語句，如實例中的“Select 名稱，所屬省 From 中國城市 Where 綠化率 > 30%”。</p><h1 class=pgc-h-arrow-right>Text-to-SQL研究進展</h1><p>Text-to-SQL技術能夠有效地輔助人們對海量的數據庫進行查詢，因其有實用的應用場景，引起了學術界和工業界的廣泛關注。我們接下來將從<strong>相關數據集</strong>和<strong>模型</strong>兩方面介紹該技術的研究進展。</p><p><strong>1. 數據集介紹</strong></p><p>圖2給出了Text-to-SQL數據集發展趨勢，代表數據集參見表1。</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/24ecc33a7dd0447c8e5b1321709e5909><p class=pgc-img-caption></p></div><p>圖2</p><p><strong>其中術語介紹：</strong></p><ul><li>根據包含領域數量，數據集分為單領域和多領域。</li><li>根據每個數據庫包含表的數量，數據集分為單表和多表模式。在多表模式中，SQL生成涉及到表格的選擇。</li><li>根據問題複雜度，數據集分為簡單問題和複雜問題模式，其中問題複雜度由SQL查詢語句涉及到的關鍵詞數量、嵌套層次、子句數量等確定。</li><li>根據完整SQL生成所需輪數，數據集分為單輪和多輪。</li><li>若SQL生成融進漸進式對話，則數據集增加“結合對話”標記。當前只有CoSQL數據集是融進對話的數據集。</li></ul><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/66de185c07484b51906d15cc33f54914><p class=pgc-img-caption></p></div><p>表1</p><p>由圖2和表1可知，當前主流數據集都是多領域的，這就要求Text-to-SQL解析模型除了滿足問題無關外，還要滿足領域無關。</p><p><strong>2. 模型介紹</strong></p><p>SQL查詢語句是一個符合語法、有邏輯結構的序列，其構成來自三部分：<strong>數據庫、問題、SQL關鍵詞。</strong></p><p>在當前深度學習研究背景下，Text-to-SQL任務可被看作是一個類似於神經機器翻譯的序列到序列的生成任務，主要採用Seq2Seq模型框架。基線Seq2Seq模型加入注意力、拷貝等機制後，在單領域數據集上可以達到80%以上的準確率，但在多領域數據集上效果很差，準確率均低於25%。</p><p>從<strong>編碼</strong>和<strong>解碼</strong>兩個方面進行原因分析。</p><p>在編碼階段，問題與數據庫之間需要形成很好的對齊或映射關係，即問題中涉及了哪些表格中的哪些元素（包含列名和表格元素值）；同時，問題與SQL語法也需要進行映射，即問題中詞語觸發了哪些關鍵詞操作（如Group、Order、Select、Where等）、聚合操作（如Min、Max、Count等）等；最後，問題表達的邏輯結構需要表示並反饋到生成的SQL查詢語句上，邏輯結構包括嵌套、多子句等。</p><p>在解碼階段，SQL語言是一種有邏輯結構的語言，需要保證其語法合理性和可執行性。普通的Seq2Seq框架並不具備建模這些信息的能力。</p><p>當前基於Seq2Seq框架，主要有以下幾種改進。</p><p><strong>1）基於Pointer Network的改進</strong></p><p>首先，SQL組成來自三部分：<strong>數據庫中元素</strong>（如表名、列名、表格元素值）、<strong>問題中詞彙</strong>、 <strong>SQL關鍵字</strong>。其次，當前公開的多領域數據集為了驗證模型數據庫無關，在劃分訓練集和測試集時要求數據庫無交叉，這種劃分方式導致測試集數據庫中很大比例的元素屬於未登錄詞。傳統的Seq2Seq模型是解決不好這類問題的。</p><p>Pointer Network很好地解決了這一問題，其輸出所用到的詞表是隨輸入而變化的。具體做法是利用注意力機制，直接從輸入序列中選取單詞作為輸出。在Text-to-SQL任務中，將問題中詞彙、SQL關鍵詞、對應數據庫的所有元素作為輸入序列，利用Pointer Network從輸入序列中拷貝單詞作為最終生成SQL的組成元素。</p><p>由於Pointer Network可以較好的滿足具體數據庫無關這一要求，在多領域數據集上的模型大多使用該網絡，如Seq2SQL[1]、STAMP[8]、Coarse2Fine[9] 、IRNet[16]等模型。</p><p><strong>2）基於Sequence-to-set的改進</strong></p><p>在簡單問題對應的數據集合上，其SQL查詢語句形式簡單（僅包含Select和Where關鍵詞），為了解決Seq2Seq模型中順序錯誤帶來的影響（如“條件1 And 條件2”，預測為“條件2 And 條件1”，屬於順序錯誤，但對應的SQL是正確的），SQLNet[10]提出了Sequence-to-set模型，基於所有的列預測其屬於哪個關鍵詞（即屬於Select還是Where，在SQLNet模型中僅預測是否屬於Where），針對SQL 中每一個關鍵詞選擇概率最高的前K個列。</p><p>該模式適用於SQL形式簡單的數據集，在WikiSQL和NL2SQL這兩個數據集合上使用較多，且衍生出很多相關模型，如TypeSQL[11]、SQLova[12]、X-SQL[13]等。</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/151e9dbbc35b46efa6036521c0f17a92><p class=pgc-img-caption></p></div><p>圖3 Sequence-to-Set</p><p><strong>3）基於TRANX（自頂向下文法生成）的改進</strong></p><p>複雜問題對應的SQL查詢語句形式也複雜，涉及到多關鍵詞組合、嵌套、多子句等。並且，測試集合中的某些SQL查詢語句形式在訓練集合中沒有見過，這就要求模型不僅對新數據庫具有泛化能力，對新SQL查詢語句形式也要有泛化能力。</p><p>針對這種情況，需要更多關注生成SQL的邏輯結構。為了保證SQL生成過程中語法合理，一些模型開始探索及使用語法樹生成的方法。</p><p>TRANX[14]框架借鑑了AST[15]論文思想，根據目標語言的語法構建規約文法，基於該文法可以將生成目標表示為語法樹（需要保證生成目標與語法樹表示一一對應），然後實現了自頂向下的語法樹生成系統，圖4給出了該系統流程。</p><p>我們簡單介紹一下基於該系統實現Text-to-SQL任務。</p><p>首先，根據SQL語法制定規約文（對應圖4中的ASDL Grammar），需要保證每一條SQL查詢語句均可由該文法產出。</p><p>其次，設計動作集合用於轉移系統（圖4中的Transition System），基於該轉移系統選擇合理的規約文法生成語法樹，該轉移系統將語法樹的生成轉成動作序列的生成，即轉成一系列文法的選擇序列，文法在選擇過程中保證了合理性（即孩子節點文法均在父節點允許的文法範圍內）；該動作序列的生成可基於Seq2Seq等框架進行。</p><p>該框架在代碼生成、SQL生成等任務上都已驗證過，在Text-to-SQL任務上的模型包括IRNet[16]、Global GNN[17]、RATSQL[18]等。</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ff73bde7e824456884bda5e494654548><p class=pgc-img-caption></p></div><p>圖4：基於TRANX的code生成</p><p><strong>4）其他改進</strong></p><p>在多表數據集合上，一些模型加入圖網絡來增強數據庫的表示，如Global GNN[17]、RATSQL[18]等。在WikiSQL數據集合上，由於該數據集給出了SQL執行系統，部分模型通過加入執行指導[19]來提升SQL的可執行性和準確率。</p><p><strong>3. 評價方法</strong></p><p>Text-to-SQL任務的評價方法主要包含兩種：<strong>精確匹配率</strong>（Exact Match, Accqm）、<strong>執行正確率</strong>（Execution Accuracy, Accex）。</p><p>精確匹配率指,預測得到的SQL語句與標準SQL語句精確匹配成功的問題佔比。為了處理由成分順序帶來的匹配錯誤，當前精確匹配評估將預測的SQL語句和標準SQL語句按著SQL關鍵詞分成多個子句，每個子句中的成分表示為集合，當兩個子句對應的集合相同則兩個子句相同，當兩個SQL所有子句相同則兩個SQL精確匹配成功；</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5628c57a598b45bd8e6861ab62030970><p class=pgc-img-caption></p></div><p>執行正確指，執行預測的SQL語句，數據庫返回正確答案的問題佔比。</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b0a53af4d1814c769f3d61a8991eeb9f><p class=pgc-img-caption></p></div><p>目前僅WikiSQL數據集支持Accex，其他數據集僅支持Accqm。大部分數據集發佈了對應的評估腳本，方便大家在同一個評估標準下進行算法研究。</p><p>接下來，我們就<strong>數據集DuSQL的建設</strong>和<strong>模型DuParser的構建</strong>，向大家介紹百度在Text-to-SQL技術方面的研究，並展示百度在<strong>ToB客服業務</strong>和<strong>搜索業務</strong>中對該技術的應用，同時也對該技術面臨的挑戰和未來發展進行了一些思考。</p><h1 class=pgc-h-arrow-right>百度對Text-to-SQL技術的研究</h1><p>百度在一些實際業務中需要用到Text-to-SQL技術，比如基於表格的問答、ToB的客服業務等，所以結合實際應用，在數據集建設及模型構建方面做了一些工作，有一定的技術積累。</p><p><strong>1. 數據集DuSQL</strong></p><p>由表1可見，當前Text-to-SQL數據集大部分是英文數據集，中文數據集只有<strong>NL2SQL數據集</strong>和<strong>CSpider數據集。</strong></p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0fb857623b3c44c6ac1ab2387381f7de><p class=pgc-img-caption></p></div><p>表1</p><p>其中CSpider數據集是英文數據集Spider的翻譯版本，中英文化差異導致問題用語和知識上存在差異，比如行政區劃相關的數據在Spider數據集上表示為“州、縣、市”等，在CSpider數據集上則表示為“省、市、縣”等，這種差異性降低了該數據集在實際應用中的價值。</p><p>NL2SQL數據集中的問題相對簡單，問題類型為基於單/多條件查詢匹配的答案檢索，能夠解決如“3000元以下的手機有哪些”等簡單問題，但無法解決“便宜的手機有哪些”、“蘋果8手機256G比128G貴多少”這樣較難的問題。在實際應用中，後種難度較高的問題佔比很高，尤其是在商業智能（BI）和購物相關諮詢的業務中。</p><p>我們從實際應用中隨機抽取用戶問題，就問題解決所需要的操作對問題類型進行了人工分析，結果如表2所示，可以看出涉及到計算、排序、比較等操作的問題有一定的佔比。</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c24772738f0049a4a76282234f545ebb><p class=pgc-img-caption></p></div><p>表2</p><p>為了更好地理解這些問題類型，我們列舉了一些問題類型及對應的問題實例（數據庫見上篇圖1），見表3：</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/188bdb5569b64bad9ec4545da87254fe><p class=pgc-img-caption></p></div><p>表3: 問題類型及實例</p><p>為了更好地覆蓋實際應用中常見的問題類型，使構建的數據集在實際應用中發揮更大的價值，我們基於實際應用分析構建了多領域、多表、包含複雜問題的數據集DuSQL。</p><p>數據集構建主要分為兩大步驟：<strong>數據庫構建和&lt;問題，SQL查詢語句></strong>構建。在數據庫構建中，要保證數據庫覆蓋的領域足夠廣泛，在&lt;問題, SQL查詢語句>構建中，要保證覆蓋實際應用中常見的問題類型。</p><p>數據庫主要來自百科（包括三元組數據和百科頁面中的表格）、權威網站（如國家統計局、天眼查、中國產業信息網、中關村在線等）、各行業年度報告以及論壇（如貼吧）等。</p><p>從這些網站挖掘到表格後，我們按表格的表頭對同類表格進行了聚類，並根據表格中的實體鏈接等信息構建表格之間的關聯，最終保留了813張表格，分為200個數據庫。由於很多表格的內容較敏感，我們僅使用了表格的表頭，對錶格內容進行了隨機填充，無法保證事實性。</p><p>基於一個半自動方案構建&lt;問題, SQL查詢語句>，首先需要基於SQL文法自動生成SQL查詢語句和對應的偽語言問題描述，然後通過眾包方式將偽語言問題描述改寫為自然語言問題。在自動生成SQL查詢語句時，我們設計了覆蓋所有常見問題類型的SQL規約文法，最終構建了近2.4萬的數據。</p><p>表4展示了DuSQL數據集與其他多領域數據集的對比情況。其中，時間計算屬於常數計算，引入常量TIME_NOW（表示當前時間），比如數據庫Schema為“{公司名稱, 成立年份, 員工數, …}”，問題為“XX公司成立多少年了”， SQL查詢語句為“Select TIME_NOW – 成立年份 Where 公司名稱=XX”。在實際應用中，常數計算中的時間計算需求較大，因此我們構建了相關數據。</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7ef8491e5f454691838fb729c8af91e9><p class=pgc-img-caption></p></div><p>表4：CSpider來自Spider訓練集和開發集的翻譯，其統計使用Spider的統計</p><p><strong>2. 模型DuParser</strong></p><p>基於實際應用，百度研發了一種基於表格元素識別和文法組合的解析算法DuParser，要求其在實際應用中能夠基於用戶提供的數據或反饋達到快速迭代、效果可解釋、可控的要求，解析算法框架見圖5（對應的實例見圖6，不同顏色的箭頭表示了流程中各模塊對應輸入輸出）。</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/42851de37945405ebe49478320aac69f><p class=pgc-img-caption></p></div><p>圖5</p><p>首先，“成分映射”模塊完成問題中表格相關成分識別（圖6黑色箭頭表示的流程），用戶提供的數據包括同義詞、應用常見問題形式等，該部分可充分利用用戶提供的數據進行效果優化。然後對識別的成分進行SQL關鍵詞識別（圖6紫色箭頭表示的流程），該部分算法基於Sequence-to-set模型改進。</p><p>前兩個過程將問題中被映射成功的詞彙替換成相應的符號，輸入到基於文法組合的解析算法中，該部分的替換使後面模塊與具體數據庫無關，這提升了模型對新數據庫的泛化能力。</p><p>最後，在基於文法組合的語義解析階段，通過改造CYK算法，DuParser構建了一個自下向上的解析框架（圖6藍色箭頭表示的流程），並且，在文法組合過程中通過引入SQL片段與對應問題片段相似度匹配來選擇最優文法。</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b91ccb73ca74485f904f4575cb921658><p class=pgc-img-caption></p></div><p>圖6：黑色箭頭表示成分映射，紫色表示標籤識別，藍色表示文法組合</p><p><strong>該框架有以下幾個優點：</strong></p><ul><li>首先，與端到端的神經網絡模型相比，它具有良好的可解釋性和效果可控性，容易進行系統調試和針對性效果優化；</li><li>其次，它可以充分利用用戶提供的數據及反饋，在用戶任務上快速啟動且加快迭代優化速度；</li><li>最後，該框架可以做到語言無關、領域無關，有很好的擴展能力。</li></ul><p>該模型在單表數據集合上進行了效果驗證，結果見表5（使用的預訓練模型與對應的SOTA一致）。</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/720ef173febb446f821d7f45d8a40f62><p class=pgc-img-caption></p></div><p>表5</p><p>注:</p><p>1）NL2SQL數據集的SOTA是開源最好模型[20]在開發集上的結果;</p><p>2）WikiSQL數據集的SOTA模型是不加執行指導的X-SQL[13]模型；</p><p>3）Spider單表來自Spider數據集中的單表部分數據，SOTA模型是IRNet[16]，評估了其中單表上的準確率（非bert版本）；</p><p>4）百度應用數據會針對數據集做優化，重點是“同義詞”部分。</p><h1 class=pgc-h-arrow-right>百度對Text-to-SQL技術的應用</h1><p>Text-to-SQL技術主要的應用場景是基於數據庫的問答。在實際的應用中，百度將該技術應用於<strong>ToB客服業務</strong>和<strong>搜索業務</strong>中。</p><p>對於ToB業務，以UNIT平臺為輸出接口，支持結構化問答業務（參見下方鏈接）。支持的業務應用於車載對話系統、企業智能報表生成系統、電話客服系統等，圖7給出落地於車載對話系統中的案例。</p><p><strong>鏈接：</strong></p><p>https://ai.baidu.com/forum/topic/show/957042</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/d0af862b449f425d986f4074b045e8a2><p class=pgc-img-caption></p></div><p>圖7</p><p>對於搜索業務，我們探索了搜索中的計算類問答（圖8）和企業表格問答（圖9）。</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/51cc92d36cc24f708e576932346a5770><p class=pgc-img-caption></p></div><p>圖8</p><div class=pgc-img><img alt="百度語義解析 ( Text-to-SQL ) 技術研究及應用" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0291cebce379469db5de4c1b56bd2326><p class=pgc-img-caption></p></div><p>圖9</p><h1 class=pgc-h-arrow-right>目前挑戰及未來思考</h1><p>Text-to-SQL技術在實際應用中可直接使用，但由於實際應用領域覆蓋廣泛，模型需要滿足領域無關、語言無關、問題無關。</p><p>當前模型在中間表示、樹形解碼、圖網絡建模數據庫等方向均有探索，並取得了一定的成效，但對一些複雜操作的解決效果還不夠好，可參見Spider數據集標註為“難”和“極難”的數據效果。同時，在實際應用中，還需要考慮以下問題：</p><ul><li><strong>表格的識別及規範化表示：</strong>表格默認以第一行為表頭，但在實際挖掘表格中，有三種情況：以第一行為表頭，以第一列為表頭，或者第一行和第一列共同表示表格；挖掘的表格存在信息缺失問題，如表名缺失、表格值不全等；同時，面對多個表格時缺失表間鏈接關係。</li><li><strong>外界知識的利用：</strong>有一些常識信息不包含在表格中，如排序操作的方向判斷（列為“出生日期”，問題為“年齡最大的員工”）、表格值進制轉換（列為“人口(億)”，問題為“人口超5千萬的城市”）等，這些信息需要引入外界知識來協助SQL生成。</li><li><strong>融進漸進式對話：</strong>對於用戶的歧義表達和模糊表達，需要有“提問-反饋-再提問”的過程，這類問題往往需要通過多輪對話解決，而用戶的問題通常是上下文相關的，因此需要模型具備基於上下文的理解和分析能力。</li></ul><p>今天的分享就到這裡，謝謝大家。</p><p class=pgc-end-literature>參考文獻</p><p class=pgc-end-literature>[1] Seq2sql: Generating structured queries from natural language using reinforcement learning (Victor Zhong, Caiming Xiong, Richard Socher. CoRR2017)</p><p class=pgc-end-literature>[2] Spider: A Large-Scale Human-Labeled Dataset for Complex and Cross-Domain Semantic Parsing and Text-to-SQL Task (Tao Yu, Rui Zhang, Kai Yang, Michihiro Yasunaga, etc. EMNLP2018)</p><p class=pgc-end-literature>[3] A Pilot Study for Chinese SQL Semantic Parsing (Qingkai Min, Yuefeng Shi, Yue Zhang. EMNLP2019)</p><p class=pgc-end-literature>[4] SParC: Cross-Domain Semantic Parsing in Context (Tao Yu, Rui Zhang, Michihiro Yasunaga, Yi Chern Tan, etc. ACL2019)</p><p class=pgc-end-literature>[5] CoSQL: A Conversational Text-to-SQL Challenge Towards Cross-Domain Natural Language Interfaces to Databases (Tao Yu, Rui Zhang, He Yang Er, Suyi Li, Eric Xue, etc. EMNLP2019)</p><p class=pgc-end-literature>[6] https://tianchi.aliyun.com/markets/tianchi/zhuiyi_cn</p><p class=pgc-end-literature>[7] Pointer Networks （OriolVinyals, Meire Fortunato, Navdeep Jaitly. NIPS2015）</p><p class=pgc-end-literature>[8] Semantic Parsing with Syntax- and Table-Aware SQL Generation (Yibo Sun, Duyu Tang, Nan Duan, etc. ACL2018)</p><p class=pgc-end-literature>[9] Coarse-to-Fine Decoding for Neural Semantic Parsing (Li Dong, Mirella Lapata. ACL2018)</p><p class=pgc-end-literature>[10] SQLNet: Generating Structured Queries From Natural Language Without Reinforcement Learning (Xiaojun Xu, Chang Liu, DawnSong. CoRR 2018)</p><p class=pgc-end-literature>[11] TypeSQL: Knowledge-based Type-Aware Neural Text-to-SQL Generation (Tao Yu, Zifan Li, Zilin Zhang, Rui Zhang, Dragomir Radev. NAACL2018)</p><p class=pgc-end-literature>[12] Achieving 90% accuracy in WikiSQL (Wonseok Hwang, Jinyeong Yim, SeungHyun Park, Mnjoon Seo. CoRR2019)</p><p class=pgc-end-literature>[13] X-SQL: Reinforce Context Into Schema Representation (Pengcheng He, Yi Mao, Kaushik Chakrabarti, Weizhu Chen. CoRR2019)</p><p class=pgc-end-literature>[14] TRANX: A Transition-based Neural Abstract Syntax Parser for Semantic Parsing and Code Generation (Pengcheng Yin, Graham Neubig, EMNLP 2018 )</p><p class=pgc-end-literature>[15] Abstract syntax networks for code generation and semantic parsing (Maxim Rabinovich, Mitchell Stern, Dan Klein. ACL2017)</p><p class=pgc-end-literature>[16] Towards Complex Text-to-SQL in Cross-Domain Database with Intermediate Representation (Jiaqi Guo, Zecheng Zhan, Yan Gao, Yan Xiao, Jian-Guang Lou, Ting Liu, Dongmei Zhang. ACL2019)</p><p class=pgc-end-literature>[17] Representing Schema Structure with Graph Neural Networks for Text-to-SQL Parsing (Ben Bogin, Matt Gardner, Jonathan Berant. ACL2019)</p><p class=pgc-end-literature>[18] RAT-SQL: Relation-Aware Schema Encoding and Linking for Text-to-SQL Parsers (Bailin Wang, Richard Shin, Xiaodong Liu, Oleksandr Polozov, Matthew Richardson. Submitted to ACL2020)</p><p class=pgc-end-literature>[19] Robust Text-to-SQL Generation with Execution-Guided Decoding (Chenglong Wang, Kedar Tatwawadi, Marc Brockschmidt, Po-Sen Huang, Yi Mao, Oleksandr Polozov, Rishabh Singh. CoRR2018)</p><p class=pgc-end-literature>[20] https://github.com/beader/tianchi_nl2sql</p><p>編輯：黃繼彥</p><p>校對：林亦霖</p><p><strong>—完—</strong></p><p>想要獲得更多數據科學領域相關動態，誠邀關注清華-青島數據科學研究院官方微信公眾平臺“ <strong>數據派THU</strong> ”。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>語義</a></li><li><a>Text</a></li><li><a>SQL</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/8fcabd80.html alt=亞馬遜的Alexa的語義分析性能得到大幅度提高 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RPsVq1PFCI1UDR style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8fcabd80.html title=亞馬遜的Alexa的語義分析性能得到大幅度提高>亞馬遜的Alexa的語義分析性能得到大幅度提高</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/16133b9e.html alt=深度語義模型以及在淘寶搜索中的應用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/48529b82dc7c4f048fc3e45d586717e6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/16133b9e.html title=深度語義模型以及在淘寶搜索中的應用>深度語義模型以及在淘寶搜索中的應用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f4c5c93c.html alt=谷歌推出自然語言框架語義解析器SLING，但沒說有沒有用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/46ea0001172cab9535dc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f4c5c93c.html title=谷歌推出自然語言框架語義解析器SLING，但沒說有沒有用>谷歌推出自然語言框架語義解析器SLING，但沒說有沒有用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/125dee29.html alt="SQL Server中的事務與鎖" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1533794121802a9afbb22f9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/125dee29.html title="SQL Server中的事務與鎖">SQL Server中的事務與鎖</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e9d6f488.html alt="SQL Server中的事務（附有實例）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/21e047bd6e3c41fba0beac7ef3f1ce4e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e9d6f488.html title="SQL Server中的事務（附有實例）">SQL Server中的事務（附有實例）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bb071e7e.html alt="SQL 事務機制-transaction" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3231427d97bf4a04b148360fea032241 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bb071e7e.html title="SQL 事務機制-transaction">SQL 事務機制-transaction</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c6e14bc6.html alt=SQL基礎知識——事務 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/773e21df09dc4e3e8403a0a62994039d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c6e14bc6.html title=SQL基礎知識——事務>SQL基礎知識——事務</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4ddebd12.html alt="SQL 難點解決：記錄的引用" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/3a1b904121564aa389aba6a046772870 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4ddebd12.html title="SQL 難點解決：記錄的引用">SQL 難點解決：記錄的引用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e5773a66.html alt=（二)SQL數據模式、表、索引的建立與刪除 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0f1d1d3b1dac408190a1191154fe642d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e5773a66.html title=（二)SQL數據模式、表、索引的建立與刪除>（二)SQL數據模式、表、索引的建立與刪除</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a0630d89.html alt=SQL分類之DQL：查詢表中的記錄 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a0630d89.html title=SQL分類之DQL：查詢表中的記錄>SQL分類之DQL：查詢表中的記錄</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/332cb941.html alt=數據庫SQL最常用語句 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/332cb941.html title=數據庫SQL最常用語句>數據庫SQL最常用語句</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8ca809f3.html alt="SQL SERVER數據庫中用select語句複製表結構創建新表" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8ca809f3.html title="SQL SERVER數據庫中用select語句複製表結構創建新表">SQL SERVER數據庫中用select語句複製表結構創建新表</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/44c388b7.html alt=數據分析師要掌握SQL到什麼程度？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9632c1ad23d948788a9c4d84a167aafc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/44c388b7.html title=數據分析師要掌握SQL到什麼程度？>數據分析師要掌握SQL到什麼程度？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7f357ca6.html alt="SQL 2大觸發器類型及應用實例" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a4853ad0f7f84c14a09f3af661787334 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7f357ca6.html title="SQL 2大觸發器類型及應用實例">SQL 2大觸發器類型及應用實例</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/12fe4764.html alt="SQL 中的if判斷語句、while循環語句、和運算符" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/04199ae85d034aba8f5792b86591bb77 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/12fe4764.html title="SQL 中的if判斷語句、while循環語句、和運算符">SQL 中的if判斷語句、while循環語句、和運算符</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>