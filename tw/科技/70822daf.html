<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>TensorFlowå¯¦æˆ°ï¼šChapter-7ä¸‹ï¼ˆTFTSåº«èˆ‡æ™‚é–“åºåˆ—é æ¸¬ï¼‰ | æå®¢å¿«è¨Š</title><meta property="og:title" content="TensorFlowå¯¦æˆ°ï¼šChapter-7ä¸‹ï¼ˆTFTSåº«èˆ‡æ™‚é–“åºåˆ—é æ¸¬ï¼‰ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/153490532779764442c6667"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/70822daf.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/70822daf.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/70822daf.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/70822daf.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/70822daf.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/70822daf.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/70822daf.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/70822daf.html><meta property="article:published_time" content="2020-11-14T21:03:08+08:00"><meta property="article:modified_time" content="2020-11-14T21:03:08+08:00"><meta name=Keywords content><meta name=description content="TensorFlowå¯¦æˆ°ï¼šChapter-7ä¸‹ï¼ˆTFTSåº«èˆ‡æ™‚é–“åºåˆ—é æ¸¬ï¼‰"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/70822daf.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>TensorFlowå¯¦æˆ°ï¼šChapter-7ä¸‹ï¼ˆTFTSåº«èˆ‡æ™‚é–“åºåˆ—é æ¸¬ï¼‰</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><ul><li>æœ¬ç¯€ç°¡ä»‹</li><li>TensorFlowæ›´æ–°</li><li>æ³¨æ„</li><li>ä¸‹è¼‰æœ€æ–°æºç¢¼ç·¨è­¯æºç¢¼æ›´æ–°</li><li>é¦–å…ˆå¸è¼‰ç•¶å‰çš„tensorflow</li><li>åƒè€ƒå®˜æ–¹çš„å¾æºç¢¼å®‰è£tensorflow</li><li>ç›´æ¥ä½¿ç”¨pipå·¥å…·æ›´æ–°</li><li>æ›´æ–°å¾Œå¯èƒ½æœƒé‡åˆ°çš„ç•°å¸¸</li><li>è‡ªå®šç¾©LSTMå¾ªç’°ç¥ç¶“ç¶²çµ¡é€²è¡Œæ™‚é–“åºåˆ—é æ¸¬</li><li>å·¥ç¨‹å¯¦ç¾</li><li>éœ€è¦ç”¨åˆ°çš„æ¨¡å¡Š</li><li>ç”Ÿæˆè¨“ç·´æ•¸æ“šèˆ‡æ¸¬è©¦æ•¸æ“š</li><li>è¨»è§£</li><li>å®šç¾©ç¶²çµ¡æ¨¡å‹</li><li>å‰µå»ºæ¨¡å‹ä¸¦è¨“ç·´</li><li>Estimatorå·¥å…·</li><li>ç¹ªåœ–</li><li>åˆ©ç”¨TFTSé€²è¡Œæ™‚é–“åºåˆ—é æ¸¬</li><li>è¼‰å…¥æ•¸æ“šéƒ¨åˆ†</li><li>å¾CSVæ–‡ä»¶ä¸­è®€å…¥æ™‚é–“åºåˆ—æ•¸æ“š</li><li>ä½¿ç”¨ARæ¨¡å‹é æ¸¬æ™‚é–“åºåˆ—</li><li>ä»£ç¢¼å¯¦ç¾</li><li>ç”¢ç”Ÿæ•¸æ“š</li><li>å‰µå»ºaræ¨¡å‹</li><li>è¨“ç·´è©•ä¼°æ¨¡å‹ä¸¦é æ¸¬</li><li>ä½¿ç”¨LSTMé æ¸¬å–®è®Šé‡æ™‚é–“åºåˆ—</li><li>ç”¢ç”Ÿè¨“ç·´æ•¸æ“š</li><li>å®šç¾©è¨“ç·´æ¨¡å‹ä¸¦é æ¸¬</li><li>ç¹ªè£½é æ¸¬æ•¸æ“šåœ–</li><li>ä½¿ç”¨LSTMé æ¸¬å¤šè®Šé‡æ™‚é–“åºåˆ—</li><li>ç²å–è¨“ç·´æ•¸æ“š</li><li>å®šç¾©è¨“ç·´æ¨¡å‹ä¸¦é æ¸¬</li><li>ç¹ªè£½é æ¸¬åœ–</li><li>ç¸½çµ</li></ul><h1><strong>æœ¬ç¯€ç°¡ä»‹</strong></h1><p>æœ¬ç¯€é—œæ–¼TFTSæ¨¡å¡Šçš„ä½¿ç”¨åƒè€ƒçŸ¥ä¹-ä½•ä¹‹æº-å¦‚ä½•å„ªé›…åœ°ç”¨TensorFlowé æ¸¬æ™‚é–“åºåˆ—ï¼šTFTSåº«è©³ç´°æ•™ç¨‹ã€‚</p><p>å¦‚ä½•åœ¨TensorFlowä¸Šä½¿ç”¨LSTMä¾†åšæ™‚é–“åºåˆ—é æ¸¬æ˜¯ä¸€å€‹å¾ˆè€çš„è©±é¡Œï¼Œç„¶è€Œä¸€ç›´æ²’æœ‰æ¯”è¼ƒå¥½çš„è§£æ±ºæ–¹æ¡ˆã€‚åœ¨å‰›å‰›ç™¼ä½ˆçš„TensorFlow1.3ç‰ˆæœ¬ä¸­ï¼Œåœ¨tf.contribåŒ…ä¸‹å¼•å…¥äº†ä¸€å€‹Time Seriesæ¨¡å¡Š(TensorFlow Time Series,TFTS)ã€‚å…¶æºç¢¼åœ°å€åœ¨github timeseriesã€‚TFTSæä¾›äº†ä¸€å¥—åŸºç¤çš„æ™‚é–“åºåˆ—æ¨¡å‹APIã€‚<strong>ç›®å‰æä¾›ARã€Anomaly Mixture ARã€LSTMä¸‰ç¨®é æ¸¬æ¨¡å‹ã€‚</strong></p><p>é€™è£¡å› ç‚ºæ˜¯å‰›å‰›ç™¼ä½ˆçš„åº«ï¼Œæ–‡æª”åŒ±ä¹ï¼Œæˆ‘å€‘è‘—é‡æ–¼ä»‹ç´¹TFTSçš„ä»¥ä¸‹å¹¾å€‹åŠŸèƒ½:</p><ul><li>è®€å…¥æ™‚é–“åºåˆ—æ•¸æ“šï¼ˆåˆ†ç‚ºå¾numpyæ•¸çµ„å’Œcsvæ–‡ä»¶å…©ç¨®æ–¹å¼ï¼‰</li><li>ç”¨ARæ¨¡å‹å°æ™‚é–“åºåˆ—é€²è¡Œé æ¸¬</li><li>ç”¨LSTMæ¨¡å‹å°æ™‚é–“åºåˆ—é€²è¡Œé æ¸¬ï¼ˆåŒ…å«å–®è®Šé‡å’Œå¤šè®Šé‡ï¼‰</li></ul><p>å…ˆçœ‹æ•ˆæœåœ–ï¼Œ</p><ol><li>ä½¿ç”¨è‡ªå®šç¾©LSTMå¾ªç’°ç¶²çµ¡å°å–®è®Šé‡é€²è¡Œæ™‚é–“åºåˆ—é æ¸¬(æ²’ä½¿ç”¨TFTSï¼Œä»£ç¢¼æ¯”è¼ƒç¹ç‘£):</li></ol><div class=pgc-img><img alt=TensorFlowå¯¦æˆ°ï¼šChapter-7ä¸‹ï¼ˆTFTSåº«èˆ‡æ™‚é–“åºåˆ—é æ¸¬ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153490532779764442c6667><p class=pgc-img-caption></p></div><ol><li><br></li><li>ä½¿ç”¨TFTSä¸‹çš„ARæ¨¡å‹é æ¸¬æ•ˆæœå¦‚ä¸‹ï¼Œè—è‰²ç‚ºè¨“ç·´æ•¸æ“šï¼Œç¶ è‰²ç‚ºæ¨¡å‹æ“¬åˆæ•¸æ“šï¼Œç´…è‰²ç‚ºé æ¸¬æ•¸æ“š:</li></ol><div class=pgc-img><img alt=TensorFlowå¯¦æˆ°ï¼šChapter-7ä¸‹ï¼ˆTFTSåº«èˆ‡æ™‚é–“åºåˆ—é æ¸¬ï¼‰ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1534905340254238b94744c><p class=pgc-img-caption></p></div><ol><li><br></li><li>ä½¿ç”¨TFTSä¸‹çš„LSTMå°å–®è®Šé‡é€²è¡Œæ™‚é–“åºåˆ—é æ¸¬:</li></ol><div class=pgc-img><img alt=TensorFlowå¯¦æˆ°ï¼šChapter-7ä¸‹ï¼ˆTFTSåº«èˆ‡æ™‚é–“åºåˆ—é æ¸¬ï¼‰ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/15349053676857b8384ce87><p class=pgc-img-caption></p></div><ol><li><br></li><li>ä½¿ç”¨TFTSä¸‹çš„LSTMå°å¤šè®Šé‡é€²è¡Œæ™‚é–“åºåˆ—é æ¸¬:</li></ol><div class=pgc-img><img alt=TensorFlowå¯¦æˆ°ï¼šChapter-7ä¸‹ï¼ˆTFTSåº«èˆ‡æ™‚é–“åºåˆ—é æ¸¬ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15349053822246c145a2838><p class=pgc-img-caption></p></div><ol><li><br></li></ol><p>é€™è£¡æ¶‰åŠåˆ°çš„ä»£ç¢¼ä¿å­˜åœ¨github-hzy46.ç¶²é€Ÿä¸å¥½çš„åŒå­¸å¯ä»¥åˆ°æˆ–è€…åœ¨CSDNä¸Šä¸‹è¼‰ã€‚</p><hr><hr><h1><strong>TensorFlowæ›´æ–°</strong></h1><p><strong>æ³¨æ„</strong></p><p>å¾Œé¢ä½¿ç”¨çš„LSTMæ¨¡å‹çš„ä¾‹å­é ˆä½¿ç”¨TensorFlowæœ€æ–°çš„é–‹ç™¼ç‰ˆçš„æºç¢¼ã€‚å…·é«”ä¾†èªªï¼Œè¦ä¿è­‰ä¸‹é¢é€™å¥è©±å¯ä»¥æˆåŠŸåŸ·è¡Œã€‚</p><p>from tensorflow.contrib.timeseries.python.timeseries.estimators import TimeSeriesRegressor</p><ul><li>1</li><li>2</li></ul><p>å¦‚æœåŸ·è¡Œä¸æˆåŠŸï¼Œå‰‡éœ€è¦ä¸‹é¢çš„æ›´æ–°æ“ä½œã€‚</p><p><strong>ä¸‹è¼‰æœ€æ–°æºç¢¼(ç·¨è­¯æºç¢¼æ›´æ–°)</strong></p><p><strong>1. é¦–å…ˆå¸è¼‰ç•¶å‰çš„tensorflow</strong></p><p>pip uninstall tensorflow #gpuç‰ˆ å°±æ˜¯tensorflow-gpu</p><ul><li>1</li><li>2</li></ul><p><strong>2. åƒè€ƒå®˜æ–¹çš„å¾æºç¢¼å®‰è£tensorflow</strong></p><p>åƒè€ƒTensorFlowå®˜æ–¹å®‰è£æ•™ç¨‹ã€‚æˆ‘çš„é–‹ç™¼ç’°å¢ƒæ˜¯Ubuntu16.04+1080é¡¯å¡ï¼Œéœ€è¦å®‰è£gpuç‰ˆæœ¬ã€‚</p><ul><li>ä¿è­‰é¡¯å¡é©…å‹•ï¼ŒCUDA8.0,cudnn6.0å®‰è£æˆåŠŸ</li><li>å®‰è£bazel bazelå®‰è£æ•™ç¨‹</li><li>å®‰è£Pythonä¾è³´åŒ…</li><li>sudo apt-get install python-numpy python-dev python-pip python-wheel # å°py2</li><li>sudo apt-get install python3-numpy python3-dev python3-pip python3-wheel #å°py3</li><li>1</li><li>2</li><li>å¾githubä¸Šä¸‹è¼‰æœ€æ–°çš„æºç¢¼</li><li>git clone https://github.com/tensorflow/tensorflow</li><li>1</li><li>é…ç½®tensorflowå®‰è£</li><li>cd tensorflow # cd to the top-level directory created</li><li>$ ./configure</li><li>'''</li><li>é™¤äº†CUDAé …é¸æ“‡yï¼Œå…¶ä»–éƒ½æ˜¯næˆ–è€…é»˜èªé ….</li><li>Configuration finished</li><li>'''</li><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>ç·¨è­¯æˆpipåŒ…</li></ul><p>'''</p><p>ç·¨è­¯</p><p>'''</p><p>bazel build --config=opt --config=cuda //tensorflow/tools/pip_package:build_pip_package</p><p>'''</p><p>æŒºé•·çš„ä¸€æ®µç·¨è­¯æ™‚é–“</p><p>ç”Ÿç”¢pipåŒ…</p><p>'''</p><p>bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg</p><p>'''</p><p>å®‰è£</p><p>'''</p><p>sudo pip install /tmp/tensorflow_pkg/tensorflow-1.3.0-py2-none-any.whl</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li></ul><p>å¦‚æœå‡ºå•¥å•é¡Œï¼Œå»ºè­°ç›´æ¥çœ‹å®˜æ–¹æ•™ç¨‹ä¾†æ•´ï¼Œæœ‰å•¥å°å•é¡Œï¼Œä¸Šstackoverflowä¸Šæ‰¾æ‰¾åŸå› ã€‚(å¾æºç¢¼ç·¨è­¯tensorflowå‰å‰å¾Œå¾ŒèŠ±è²»äº†æˆ‘2å¤©çš„æ™‚é–“ï¼Œç¾åœ¨æ•´å‡ºä¾†äº†ï¼Œè¸©äº†ä¸å°‘çš„å‘ï¼Œæ„Ÿè¦ºä¸‹æ¬¡æœƒå¿«å¾ˆå¤šäº†ï½)</p><p>ç¾åœ¨9æœˆåˆtensorflowçš„pipå®‰è£ç‰ˆæœ¬é‚„ä¸æ”¯æŒé€™å€‹TimeSeriesRegressoré¡ï¼Œç­‰åˆ°å¾Œé¢ç‰ˆæœ¬ç©©å®šæ›´æ–°äº†ï¼Œæ‡‰è©²å¯ä»¥ç”¨ä¸‹é¢pipå·¥å…·æ›´æ–°ã€‚</p><p><strong>ç›´æ¥ä½¿ç”¨pipå·¥å…·æ›´æ–°</strong></p><p>å› ç‚ºæœ¬æ¬¡ç”¨åˆ°çš„åº«éœ€è¦é‹è¡Œåœ¨TensorFlow1.3ç‰ˆæœ¬ï¼Œè€Œæˆ‘çš„ç’°å¢ƒæ˜¯Ubuntuä¸‹çš„1.0.1ç‰ˆæœ¬çš„TensorFlowã€‚å¦‚æœä½ ä¸çŸ¥é“è‡ªå·±çš„TensorFlowæ˜¯å•¥ç‰ˆæœ¬ï¼Œæœ‰ä¸€å€‹ç°¡å–®çš„æ–¹æ³•:</p><p>æ¿€æ´»pythonç·¨ç¨‹ç’°å¢ƒï¼Œéµå…¥ä»¥ä¸‹ä»£ç¢¼é‹è¡Œå³å¯ã€‚</p><p>import tensorflow as tf</p><p>print(tf.__version__) # æŸ¥çœ‹tensorflowç‰ˆæœ¬</p><p>print(tf.__path__) # æŸ¥çœ‹tensorflowå®‰è£ä½ç½®</p><p>'''</p><p>è¼¸å‡ºï¼š</p><p>1.0.1</p><p>['/root/anaconda2/lib/python2.7/site-packages/tensorflow']</p><p>'''</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li></ul><p>æ›´æ–°æ–¹æ³•ä¹Ÿå¾ˆç°¡å–®ï¼Œå¦‚æœä½ çš„TensorFlowæ˜¯æ™®é€šçš„å®‰è£ï¼Œç›´æ¥åœ¨å‘½ä»¤è¡Œéµå…¥ä»¥ä¸‹å‘½ä»¤:</p><p>$: sudo pip install --upgrade tensorflow-gpu # æˆ‘å®‰è£çš„æ˜¯gpuç‰ˆ</p><ul><li>1</li></ul><p>ç­‰å¾…æ›´æ–°å®Œæˆå³å¯ã€‚</p><p>import tensorflow as tf</p><p>print(tf.__version__) # æŸ¥çœ‹tensorflowç‰ˆæœ¬</p><p>print(tf.__path__) # æŸ¥çœ‹tensorflowå®‰è£ä½ç½®</p><p>'''</p><p>è¼¸å‡ºï¼š</p><p>1.3.0</p><p>['/root/anaconda2/lib/python2.7/site-packages/tensorflow']</p><p>'''</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li></ul><p><strong>æ›´æ–°å¾Œå¯èƒ½æœƒé‡åˆ°çš„ç•°å¸¸</strong></p><ul><li>å•é¡Œæè¿°:</li><li>libcudnn.so.6:cannot open sharedobject file: No such file or directory</li><li>1</li><li>å•é¡Œåˆ†æ:</li><li>æˆ‘åœ¨é–‹å§‹å®‰è£1.0.1ç‰ˆæœ¬çš„tensorflowæ™‚ï¼Œé…ç½®çš„æ˜¯CUDA8.0+cudnn-v5.1ã€‚é€™è£¡æˆ‘æŠŠtensorflowå‡ç´šåˆ°1.3ç‰ˆæœ¬ï¼Œæ–°çš„Tensorflowé©é…çš„æ˜¯cudnn-v6.0ã€‚æ•…éœ€è¦å‡ç´šcudnnã€‚</li><li>è§£æ±ºè¾¦æ³•:</li><li>å‡ç´šcudnnçš„æ–¹æ³•åƒè€ƒå®‰è£CUDNNã€‚</li></ul><ol><li>ä¸‹è¼‰é©é…CUDAç‰ˆæœ¬å’Œç³»çµ±ç‰ˆæœ¬çš„cudnn-v6.0</li></ol><ul><li><br></li></ul><ol><li>è§£å£“ä¸‹è¼‰å¥½çš„cudnn</li><li>$ : sudo tar -zxvf cudnn-8.0-linux-x64-v6.0.tgz</li><li>â€¦</li><li>å°‡è§£å£“æ–‡ä»¶æ‹·è²ä¸¦ä¿®æ”¹æ¬Šé™</li><li>$ :sudo cp cuda/include/cudnn.h /usr/local/cuda/include/ # copy file</li><li>$ :sudo cp cuda/lib64/libcudnn* /usr/local/cuda/lin64/</li><li>$ :sudo chmod a+r /usr/local/cuda/include/cudnn.h # ä¿®æ”¹æ¬Šé™</li><li>$ :sudo chmod a+r /usr/local/cuda/libcudnn*</li></ol><ul><li>1</li><li>2</li><li>3</li><li>4</li></ul><p>åˆ°é€™è£¡ï¼Œç®—æ˜¯å¤§åŠŸå‘Šæˆäº†ï½</p><hr><hr><h1><strong>è‡ªå®šç¾©LSTMå¾ªç’°ç¥ç¶“ç¶²çµ¡é€²è¡Œæ™‚é–“åºåˆ—é æ¸¬</strong></h1><p>åœ¨ä½¿ç”¨TFTSåº«å‰ï¼Œæˆ‘å€‘å…ˆåˆ©ç”¨è‡ªå®šç¾©å¾ªç’°ç¥ç¶“ç¶²çµ¡é æ¸¬æ­£å¼¦å‡½æ•¸ã€‚åˆæ­¥å­¸ç¿’ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨LSTMå¾ªç’°ç¥ç¶“ç¶²çµ¡é€²è¡Œæ™‚é–“åºåˆ—é æ¸¬ï¼Œé€™è£¡æˆ‘å€‘æœƒä½¿ç”¨TensorFlowçš„ä¸€å€‹é«˜ç´šå°è£å·¥å…·-TFLearn(é›†æˆåœ¨tf.contrib.learn).</p><p><strong>å·¥ç¨‹å¯¦ç¾</strong></p><p><strong>1. éœ€è¦ç”¨åˆ°çš„æ¨¡å¡Š</strong></p><p># coding:utf8</p><p>import numpy as np</p><p>import tensorflow as tf</p><p>from tensorflow.contrib.learn.python.learn.estimators.estimator import SKCompat</p><p>import matplotlib.pyplot as plt</p><p>learn = tf.contrib.learn</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li></ul><p><strong>2. ç”Ÿæˆè¨“ç·´æ•¸æ“šèˆ‡æ¸¬è©¦æ•¸æ“š</strong></p><p>å› ç‚ºæ˜¯è¦é æ¸¬æ­£å¼¦å‡½æ•¸ï¼Œé€™è£¡æˆ‘å€‘ä½¿ç”¨npæ¨¡å¡Šä¸‹çš„np.sinå‡½æ•¸ç”Ÿæˆè¨“ç·´æ•¸æ“šå’Œæ¸¬è©¦æ•¸æ“šã€‚</p><p>TRAINING_EXAMPLES = 10000 # è¨“ç·´æ•¸æ“šå¤§å°</p><p>TESTING_EXAMPLES = 1000 # æ¸¬è©¦æ•¸æ“šå¤§å°</p><p>SAMPLE_GAP = 0.01 #æ¡æ¨£é–“éš”</p><p>TIMESTEPS = 10 # å¾ªç’°ç¥ç¶“ç¶²çµ¡æˆªæ–·é•·åº¦</p><p>def generate_data(seq):</p><p>'''</p><p>å®šç¾©ç”Ÿæˆæ­£å¼¦å‡½æ•¸æ•¸æ“šå‡½æ•¸</p><p>:param seq:</p><p>:return: Xç‚ºè¨“ç·´æ•¸æ“šåºåˆ—,yç‚ºé æ¸¬æ•¸æ“š</p><p>'''</p><p>X = []</p><p>y = []</p><p>for i in range(len(seq) - TIMESTEPS - 1):</p><p>X.append([seq[i: i + TIMESTEPS]]) # æˆªå–ä»¥iä¸‹æ¨™é–‹å§‹çš„ä»¥TIMESTEPSç‚ºbatchçš„æ•¸æ“š</p><p>y.append([seq[i + TIMESTEPS]]) # é æ¸¬i+TIMESTEPSçš„æ•¸æ“š</p><p>return np.array(X, dtype=np.float32), np.array(y, dtype=np.float32)</p><p># ç”Ÿæˆæ•¸æ“š</p><p># TRAINING_EXAMPLESè¨“ç·´æ•¸æ“šå€‹æ•¸ SAMPLE_GAPæ¡æ¨£é–“éš”</p><p>test_start = TRAINING_EXAMPLES * SAMPLE_GAP</p><p># è¨“ç·´æ•¸æ“šå’Œæ¸¬è©¦æ•¸æ“šå€‹æ•¸</p><p>test_end = (TRAINING_EXAMPLES + TESTING_EXAMPLES) * SAMPLE_GAP</p><p># np.linspaceç”Ÿæˆç­‰å·®æ•¸åˆ— å³æ¡æ¨£æ©«è»¸æ•¸æ“š</p><p># å¾0åˆ°test_start,ç”ŸæˆTRAINING_EXAMPLESå€‹æ•¸æ“š(å³æ¡æ¨£é–“éš”ç‚ºSAMPLE_GAP)</p><p>train_X, train_y = generate_data(np.sin(np.linspace(</p><p>0, test_start, TRAINING_EXAMPLES, dtype=np.float32)))</p><p># np.linspaceç”Ÿæˆç­‰å·®æ•¸åˆ—</p><p>#</p><p>test_X, test_y = generate_data(np.sin(np.linspace(</p><p>test_start, test_end, TESTING_EXAMPLES, dtype=np.float32)))</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li><li>31</li><li>32</li><li>33</li><li>34</li><li>35</li><li>36</li><li>37</li></ul><hr><p><strong>è¨»è§£ï¼š</strong></p><p>è¨“ç·´æ•¸æ“šTRAINING_EXAMPLESåŠ ä¸Šæ¸¬è©¦æ•¸æ“šTESTING_EXAMPLESä¸€å…±éœ€è¦11000çµ„ã€‚</p><p>é€™è£¡æˆ‘å€‘è¨­ç½®æ˜¯æ¡æ¨£é–“éš”SAMPLE_GAPæ˜¯0.01ã€‚æ•…æˆ‘å€‘æ•´å€‹æ¡æ¨£è·é›¢æ˜¯11000*0.01=110.ä¹Ÿå°±æ˜¯åœ¨sinå‡½æ•¸ä¸Šï¼Œxè»¸ç‚º[0,110]é€™æ®µè·é›¢ä¸Šå‡åˆ†ç‚º11000ä»½ã€‚</p><p>è¨“ç·´æ•¸æ“šæ˜¯ä»¥ç¶²çµ¡çš„æˆªæ–·é•·åº¦ç‚ºåˆ†å‰²é–“è·ã€‚é€™è£¡å¾ªç’°ç¥ç¶“ç¶²çµ¡çš„æˆªæ–·é•·åº¦TIMESTEPSç‚º10ã€‚æ•…æˆ‘å€‘çš„æ•¸æ“šä¹Ÿæ˜¯10å€‹æ¡æ¨£é»å’Œå°æ‡‰çš„sinå€¼ç‚ºä¸€çµ„ï¼Œé æ¸¬ç¬¬11å€‹é»ã€‚(è¨“ç·´æ™‚å€™å°±æ˜¯è¿´æ­¸ç¬¬11å€‹é»çš„å€¼).</p><ul><li>å…ˆä½¿ç”¨np.linspaceå‡½æ•¸å–å‡ºç­‰å·®é–“éš”çš„æ¡æ¨£é»</li><li>å†ä½¿ç”¨np.sinå‡½æ•¸ç²å¾—å°æ‡‰çš„sinå€¼ã€‚</li><li>åœ¨ç”Ÿæˆæ•¸æ“šgenerate_dataæ™‚ï¼Œä»¥TIMESTEPSæˆªæ–·æ•¸æ“šåˆ°Xå…§ï¼Œå°‡TIMESTEPS+1å€‹æ•¸æ“šæ”¾åˆ°å°æ‡‰çš„æ¨™ç±¤yå…§ã€‚</li></ul><p>ä¸‹é¢æ˜¯np.linspaceå’Œnp.sinçš„ç”¨æ³•ç¤ºä¾‹ï¼š</p><div class=pgc-img><img alt=TensorFlowå¯¦æˆ°ï¼šChapter-7ä¸‹ï¼ˆTFTSåº«èˆ‡æ™‚é–“åºåˆ—é æ¸¬ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1534905400997ddbd9982c2><p class=pgc-img-caption></p></div><hr><p><strong>3. å®šç¾©ç¶²çµ¡æ¨¡å‹</strong></p><p>æˆ‘å€‘ä½¿ç”¨BasicLSTMCellå’ŒMultiRNNCellæ§‹æˆä¸€å€‹hidden_sizeç‚º30çš„2å±¤çš„LSTMå¾ªç’°ç¥ç¶“ç¶²çµ¡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯<strong>ä¸åŒç‰ˆæœ¬ä¸‹åœ¨å‰µå»ºLSTMCellsçš„æ–¹æ³•æ˜¯ä¸ä¸€æ¨£çš„ã€‚</strong></p><p>HIDDEN_SIZE = 30 # éš±è—å–®å…ƒå€‹æ•¸</p><p>NUM_LAYERS = 2 #LSTMå±¤æ•¸</p><p>TRAINING_STEPS = 3000 # è¨“ç·´æ•¸æ“šè¼ªæ•¸</p><p>BATCH_SIZE = 32 # batchå¤§å°</p><p>def lstm_model(X, y):</p><p>'''</p><p>å®šç¾©LSTMæ¨¡å‹</p><p>:param X: è¨“ç·´æ•¸æ“š</p><p>:param y: é æ¸¬æ¨™ç±¤</p><p>:return:</p><p>'''</p><p># 1.2ç‰ˆæœ¬å¾Œ,tensorflowå°ä½¿ç”¨BasicLSTMCellç­‰ RNNCellsç”Ÿæˆcellsæœ‰ä¸åŒçš„è™•ç†æ–¹æ³•ï¼Œé€™è£¡å¤šå±¤çš„RNNå»ºè­°æ¡ç”¨é€™ç¨®å‰µå»ºcellæ–¹æ³•</p><p>stacked_rnn = []</p><p>for iiLyr in range(NUM_LAYERS):</p><p>stacked_rnn.append(tf.nn.rnn_cell.BasicLSTMCell(HIDDEN_SIZE, state_is_tuple=True))</p><p>cell = tf.nn.rnn_cell.MultiRNNCell(cells=stacked_rnn, state_is_tuple=True)</p><p>#lstm_cell = tf.contrib.rnn.BasicLSTMCell(HIDDEN_SIZE, state_is_tuple=True) #1.2ç‰ˆæœ¬å‰</p><p>#cell = tf.contrib.rnn.MultiRNNCell([lstm_cell] * NUM_LAYERS)</p><p># å°‡å¤šå±¤LSTMçµæ§‹é€£æ¥æˆRNNç¶²çµ¡ä¸¦è¨ˆç®—å…¶å‰å‘å‚³æ’­çµæœ</p><p>output, _ = tf.nn.dynamic_rnn(cell, X, dtype=tf.float32)</p><p># åªé—œæ³¨ç¶²çµ¡çš„æœ€å¾Œä¸€å€‹è¼¸å‡ºçµæœ,å³ç‚ºä¸‹ä¸€æ™‚åˆ»çš„é æ¸¬è¼¸å‡º</p><p>output = tf.reshape(output, [-1, HIDDEN_SIZE])</p><p># é€šéç„¡æ¿€æ´»å‡½æ•¸çš„å…¨è¯æ¥å±¤è¨ˆç®—ç·šæ€§è¿´æ­¸ï¼Œä¸¦å°‡æ•¸æ“šå£“ç¸®æˆä¸€ç¶­æ•¸çµ„çš„çµæ§‹ã€‚</p><p>predictions = tf.contrib.layers.fully_connected(output, 1, None)</p><p>labels = tf.reshape(y, [-1])</p><p>predictions = tf.reshape(predictions, [-1])</p><p># å®šç¾©å¹³æ–¹å·®æå¤±</p><p>loss = tf.losses.mean_squared_error(predictions, labels)</p><p># å‰µå»ºæ¨¡å‹å„ªåŒ–å™¨ä¸¦å¾—åˆ°å„ªåŒ–æ­¥é©Ÿ</p><p>train_op = tf.contrib.layers.optimize_loss(</p><p>loss, tf.contrib.framework.get_global_step(),</p><p>optimizer="Adagrad", learning_rate=0.1)</p><p>return predictions, loss, train_op</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li><li>31</li><li>32</li><li>33</li><li>34</li><li>35</li><li>36</li><li>37</li><li>38</li><li>39</li><li>40</li></ul><p><strong>4. å‰µå»ºæ¨¡å‹ä¸¦è¨“ç·´</strong></p><p>é€™è£¡æˆ‘å€‘ä½¿ç”¨äº†tf.contrib.learnä¸‹çš„ä¸€å€‹<strong>å°è£æ¨¡å‹å·¥å…·Estimator</strong>ã€‚ä½¿ç”¨Estimatorå°è£å¥½ä¸€å€‹é æ¸¬æ¨¡å‹å¾Œ((å·²è¨“ç·´)ï¼Œæˆ‘å€‘å°æ¸¬è©¦æ•¸æ“šé€²è¡Œäº†é æ¸¬ï¼Œå†è¨ˆç®—äº†ä¸‹å‡æ–¹èª¤å·®ï¼Œå¤§é«”ä¸Šçš„è©•ä¼°äº†ä¸€ä¸‹æ¨¡å‹çš„é æ¸¬æ€§èƒ½ã€‚</p><p># å°è£ä¹‹å‰å®šç¾©çš„lstm</p><p># å¦‚æœä½ çš„tensorflow1.2ç‰ˆæœ¬å‰å·²ç¶“è¨“ç·´å¥½äº†é€™æ¨£çš„çš„ä¸€å€‹æ¨¡å‹ï¼Œåœ¨tensorflowæ›´æ–°å¾Œï¼Œé‡æ–°ç”Ÿæˆæ¨¡å‹ã€‚</p><p># å› ç‚ºåœ¨æ–°ç‰ˆæœ¬çš„Tensorflowè£¡ï¼ŒLSTMå–®å…ƒçš„æ–‡ä»¶æ”¹è®Šäº†ï¼Œé€™è£¡æˆ‘å€‘ç°¡å–®çš„æŠŠä»¥å‰çš„model_dirä¿®æ”¹äº†ï¼Œä¿è­‰å‰µå»ºäº†æ–°çš„æ¨¡å‹</p><p>regressor = SKCompat(learn.Estimator(model_fn=lstm_model, model_dir="Models/model_3"))</p><p># æ“¬åˆæ•¸æ“š</p><p>regressor.fit(train_X, train_y, batch_size=BATCH_SIZE, steps=TRAINING_STEPS)</p><p># è¨ˆç®—é æ¸¬å€¼</p><p>predicted = [[pred] for pred in regressor.predict(test_X)]</p><p># è¨ˆç®—MSE</p><p>rmse = np.sqrt(((predicted - test_y) ** 2).mean(axis=0))</p><p>print ("Mean Square Error is: %f" % rmse[0])</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li></ul><hr><p><strong>Estimatorå·¥å…·</strong></p><p>é€™è£¡æˆ‘å€‘ç°¡å–®çš„ä»‹ç´¹ä»¥ä¸‹Estimatorå·¥å…·ã€‚</p><p>åƒè€ƒTensorFlow 0.12 Estimators Models Layerså­¸ç¿’ç­†è¨˜ã€‚Estimatorsçš„ä½œç”¨æ˜¯:</p><ul><li>tf.estimator frameworkç”¨æ–¼å¿«é€Ÿæ§‹å»ºå’Œè¨“ç·´æ©Ÿå™¨å­¸ç¿’æ¨¡å‹ï¼ŒåŒæ™‚Estimatoræä¾›äº†ä¸€äº›å¸¸è¦‹çš„æ¨¡å‹(å¸¸è¦‹çš„è¿´æ­¸å’Œåˆ†é¡æ¨¡å‹ï¼Œä¾‹å¦‚:ç·šæ€§åˆ†é¡ï¼Œç·šæ€§è¿´æ­¸ç­‰)</li><li>tf.estimatorç‚ºmonitors,checkpointingæä¾›äº†åˆå§‹åŒ–é…ç½®ï¼ŒåŒæ™‚æä¾›äº†æ§‹å»ºå’Œè©•ä¼°è‡ªå®šç¾©æ¨¡å‹çš„å¤§éƒ¨åˆ†é‚è¼¯ã€‚ä¾ç…§è‘—tutorialå¯ä»¥å¾ˆæ–¹ä¾¿çš„å‰µå»ºä¸€å€‹estimator.TensorFlowé—œæ–¼Estimatorä»‹ç´¹</li></ul><p>ç¸½çš„ä¾†èªªï¼Œæˆ‘å€‘å¯ä»¥èªç‚ºtf.estimatorå·¥å…·æ˜¯ç”¨ä¾†æä¾›ä¸€å€‹è‡ªå®šç¾©æ¨¡å‹çš„æ¡†æ¶ï¼Œæˆ‘å€‘ç…§è‘—å®šç¾©å¥½çš„æ ¼å¼é…ç½®å¥½è¼¸å…¥å³å¯ã€‚</p><ol><li><strong>å‰µå»ºä¸€å€‹Estimator</strong></li></ol><ul><li>å…ˆçœ‹æ§‹é€ å™¨å®šç¾©:</li><li>init(model_fn=None, model_dir=None, config=None, params=None, feature_engineering_fn=None)</li><li>'''</li><li>Args:</li><li>model_fn: æ¨¡å‹å®šç¾©ï¼Œå®šç¾©äº†train, eval, predictçš„å¯¦ç¾</li><li>model_dir: logæ–‡ä»¶å’Œè¨“ç·´åƒæ•¸çš„ä¿å­˜ç›®éŒ„</li><li>config: Configuration object</li><li>params: dict of hyper parameters that will be passed into model_fn. Keys are names of parameters, values are basic python types.</li><li>feature_engineering_fn: Feature engineering function. Takes features and labels which are the output of input_fn and returns features and labels which will be fed into model_fn. Please check model_fn for a definition of features and labels.</li><li>'''</li><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li><strong>tf.estimatorå¸¸æ¥æ”¶2å€‹åƒæ•¸:model_fnå’Œmodel_dir.æ³¨æ„åˆ°æˆ‘å€‘ä½¿ç”¨çš„.</strong></li><li>learn.Estimator(model_fn=lstm_model, model_dir="Models/model_3") # model_fnå’Œmodel_diråƒæ•¸</li><li>1</li><li><strong>é€™è£¡éœ€è¦æ³¨æ„model_fn:</strong></li></ul><ol><li>model_fn(features, labels, mode, params)</li><li>'''</li><li>features: Tensor or dict of Tensor's. å³æ¨£æœ¬æ•¸æ“šx.</li><li>labels: Tensor or dict of Tensor's. æ¨£æœ¬æ•¸æ“šy.(æ”¯æŒç„¡æ¨™ç±¤è¨“ç·´ï¼Œèª¿æ•´å°æ‡‰çš„modeå³å¯)</li><li>mode: æŒ‡å®šmodel_fnåŠŸèƒ½.</li><li>params: params is a dict of hyperparameters</li><li>'''</li></ol><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li></ul><ol><li><strong>è¨“ç·´æ¨¡å‹</strong></li><li>å°‡æˆ‘å€‘çš„è¨“ç·´æ•¸æ“šå¡çµ¦fitï¼Œè¨“ç·´å®Œæˆå¾Œï¼Œå°±æœƒæŒ‰ç…§å‰é¢æŒ‡å®šçš„model_dirå­˜æ”¾è¨“ç·´å¥½çš„æ¨¡å‹.</li><li>fit(x=None, y=None, input_fn=None, steps=None, batch_size=None, monitors=None, max_steps=None)</li><li>'''</li><li>x: è¨“ç·´æ•¸æ“šx. æ ¼å¼ç‚º[n_samples,n_features...],å¦‚æœè¨­ç½®æ­¤åƒæ•¸ï¼Œinput_fnéœ€ç‚ºNone.</li><li>y: è¨“ç·´æ•¸æ“šyã€‚xå°æ‡‰çš„æ¨™ç±¤ã€‚</li><li>steps: æ¯æ¬¡è¨“ç·´ops.</li><li>batch_size: minibatch size.</li><li>moitors: Used for callbacks inside the training loop.</li><li>max_steps: Number of total steps for which to train model.</li><li>input_fn: èªªç™½äº†å°±æ˜¯æŠŠxï¼Œyï¼Œbatch_sizeåŒ…è£ä¸€ä¸‹ã€‚ ç”¨é€™å€‹å°±ä¸ç”¨è¨­ç½®x,y,batch_sizeäº†.</li><li>'''</li></ol><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li></ul><ol><li><strong>é æ¸¬</strong></li><li>å°‡éœ€è¦é æ¸¬çš„æ•¸æ“šå¡çµ¦predictï¼Œè¿”å›çš„å°±æ˜¯é æ¸¬å€¼.</li><li>predict(x=None, input_fn=None, batch_size=None, outputs=None, as_iterable=True)</li><li>'''</li><li>x : ç‚ºéœ€è¦é æ¸¬çš„æ•¸æ“šã€‚</li><li>batch_size: minibatch size.</li><li>input_fn: å°xå’Œbatch_sizeçš„åŒ…è£</li><li>outputs: list of str, name of the output to predict. If None, returns all</li><li>as_iterable: If True, return an iterable which keeps yielding predictions for each example until inputs are exhausted. Note: The inputs must terminate if you want the iterable to terminate (e.g. be sure to pass num_epochs=1 if you are using something like read_batch_features).</li><li>'''</li></ol><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li></ul><ol><li><strong>æ³¨æ„</strong></li><li><strong>å‰é¢æˆ‘èªªäº†å¦‚æœåœ¨è¼¸å…¥çš„æ™‚å€™è¨­ç½®x,y,batch_sizeå°±ä¸è¦è¨­ç½®input_fnï¼Œéœ€è¦æ³¨æ„çš„æ˜¯:ï¼Œå¦‚æœä½¿ç”¨x,yè€Œä¸æ˜¯input_fnä¾†å‚³åƒæ•¸çš„å½¢å¼ï¼Œéœ€è¦ç”¨Estimatorè£¡ä¸€å€‹å«SKCompatçš„é¡åŒ…è£ä¸€ä¸‹</strong>.</li><li>estimator_instance = SKCompat(Estimator(model_fn=..., model_dir=...))</li></ol><ul><li>1</li><li>2</li></ul><ol><li>åˆ°é€™è£¡ï¼Œæˆ‘å€‘å°TensorFlowå…§çš„Estimatorå·¥å…·ä»‹ç´¹å°±ç®—çµæŸäº†ï½</li></ol><hr><p><strong>5. ç¹ªåœ–</strong></p><p>ä½¿ç”¨pltå°‡é æ¸¬æ•¸æ“šå’Œæ¸¬è©¦æ•¸æ“šç¹ªè£½å‡ºä¾†ï¼Œæœ‰ä¸€å€‹ç›´è§€ä¸Šçš„èªè­˜ã€‚</p><p>fig = plt.figure()</p><p>plot_predicted, = plt.plot(predicted, label='predicted')</p><p>plot_test, = plt.plot(test_y[0:399], label='real_sin')</p><p>plt.legend([plot_predicted, plot_test],['predicted', 'real_sin'])</p><p>plt.show()</p><p>fig.savefig('pre_sin.png')</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li></ul><div class=pgc-img><img alt=TensorFlowå¯¦æˆ°ï¼šChapter-7ä¸‹ï¼ˆTFTSåº«èˆ‡æ™‚é–“åºåˆ—é æ¸¬ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1534905420970d8901ff26f><p class=pgc-img-caption></p></div><hr><hr><h1><strong>åˆ©ç”¨TFTSé€²è¡Œæ™‚é–“åºåˆ—é æ¸¬</strong></h1><p>åˆ°é€™è£¡ç®—æ˜¯åˆ‡å…¥ä¸»é¡Œäº†ï¼Œä¸‹é¢ä»‹ç´¹å¦‚ä½•ä½¿ç”¨TFTSæ¨¡å¡Šé€²è¡Œæ™‚é–“åºåˆ—é æ¸¬ã€‚</p><p><strong>è¼‰å…¥æ•¸æ“šéƒ¨åˆ†</strong></p><p>å°æ–¼æ™‚é–“åºåˆ—é æ¸¬å•é¡Œï¼Œæˆ‘å€‘å¯ä»¥æŠŠ<strong>æ•¸æ“šæŠ½è±¡æˆ:{è§€å¯Ÿé»:è§€å¯Ÿå€¼}</strong>ã€‚ä¾‹å¦‚æŸå¹´ä¸€æœˆçš„åƒ¹æ ¼ç‚º120å…ƒï¼ŒäºŒæœˆçš„åƒ¹æ ¼ç‚º130å…ƒï¼Œä¸‰æœˆçš„åƒ¹æ ¼ç‚º135å…ƒï¼Œå››æœˆçš„åƒ¹æ ¼ç‚º132å…ƒã€‚é‚£éº¼è§€å¯Ÿçš„æ™‚é–“é»å¯ä»¥çœ‹åšæ˜¯1,2,3,4ï¼Œè€Œåœ¨å„æ™‚é–“é»ä¸Šè§€å¯Ÿåˆ°çš„æ•¸æ“šçš„å€¼ç‚º120,130,135,132ã€‚</p><p>TFTSåº«æä¾›äº†å…©å€‹æ•¸æ“šè®€å–å™¨NumpyReaderå’ŒCSVReader.</p><p>NumpyReaderç”¨æ–¼å¾Numpyæ•¸çµ„ä¸­è®€å…¥æ•¸æ“šï¼Œä¸‹é¢èˆ‰ä¸€å€‹demo:</p><p>import numpy as np</p><p>import matplotlib.pyplot as plt</p><p>x = np.array(range(1000))</p><p>noise = np.random.uniform(-0.2, 0.2, 1000) # éš¨æ©Ÿç”Ÿæˆ-0.2~0.2ä¹‹é–“çš„æ•¸æ“š</p><p>y = np.sin(np.pi * x * 0.01) + x * 0.005 + noise # y=sin(0.01*pi*x) + 0.005*x + noise</p><p>p = plt.plot(x, y)</p><p>plt.show()</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li></ul><div class=pgc-img><img alt=TensorFlowå¯¦æˆ°ï¼šChapter-7ä¸‹ï¼ˆTFTSåº«èˆ‡æ™‚é–“åºåˆ—é æ¸¬ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15349054358039a9e76c444><p class=pgc-img-caption></p></div><p>æ©«è»¸å³â€™æ¡æ¨£é»xâ€™,ç¸±è»¸ç‚ºâ€™æ¡æ¨£å€¼yâ€™.</p><p>TFTSæä¾›çš„è®€å…¥xå’Œyçš„æ¥å£éå¸¸ç°¡å–®ï¼Œä½¿ç”¨demoå¦‚ä¸‹:</p><p>data = {</p><p>tf.contrib.timeseries.TrainEvalFeatures.TIMES: x,</p><p>tf.contrib.timeseries.TrainEvalFeatures.VALUES: y,</p><p>}</p><p>reader = NumpyReader(data)</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li></ul><p>æˆ‘å€‘é¦–å…ˆæŠŠxå’Œyè½‰ç‚ºPythonä¸­çš„dict.æˆ‘å€‘ä¾†åˆ†æä»¥ä¸‹ä¸Šé¢dataçš„å¯«æ³•ã€‚tf.contrib.timeseries.TrainEvalFeatures.TIMESå°±æ˜¯ä¸€å€‹å­—ç¬¦ä¸²â€™timesâ€™ï¼Œè€Œå°æ‡‰tf.contrib.timeseries.TrainEvalFeatures.VALUESä¹Ÿæ˜¯ä¸€å€‹å­—ç¬¦ä¸²â€™valuesâ€™.ä¸Šé¢çš„dataå®šç¾©ä¹Ÿå¯ä»¥å¯«æˆ:</p><p>data = {</p><p>'times' : x,</p><p>'values': y,</p><p>}</p><ul><li>1</li><li>2</li><li>3</li><li>4</li></ul><p>è‡³æ–¼ç‚ºä»€éº¼å¯«æˆä¸Šé¢çš„é‚£å€‹å½¢å¼ï¼Œä¹Ÿæ˜¯ç‚ºäº†é…åˆè¦ç¯„åŒ–ã€‚</p><p>NumpyReaderè¿”å›çš„å°è±¡æœ‰ä¸€å€‹<strong>read_full()æ–¹æ³•ï¼Œè©²æ–¹æ³•ç”¨æ–¼å¾Readerä¸­è®€å–æ‰€æœ‰çš„æ•¸æ“š</strong>ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯:<strong>read_full()æœƒç”¢ç”Ÿè®€å–éšŠåˆ—</strong>(é€™æ¨£çš„è™•ç†è¨“ç·´æ•¸æ“šçš„æ–¹æ³•å’ŒTensorFlowé–‹æºçš„AlexNetç¶²çµ¡ä¸Šå°è¼¸å…¥æ•¸æ“šåšå¢å¼·æ“ä½œä½¿ç”¨çš„æ–¹æ³•é¡ä¼¼)ï¼Œé€™è¦æ±‚æˆ‘å€‘åœ¨ä½¿ç”¨è©²æ–¹æ³•å‰ï¼Œéœ€è¦<strong>å…ˆèª¿ç”¨tf.train.start_queue_runnerså•Ÿå‹•éšŠåˆ—</strong>ï¼Œç„¶å¾Œæ‰èƒ½è®€å–æ•¸æ“šã€‚ä½¿ç”¨çš„demoå¦‚ä¸‹:</p><p>with tf.Session() as sess:</p><p>full_data = reader.read_full()</p><p>coord = tf.train.Coordinator() # å‰µå»ºä¸€å€‹ç·šç¨‹å”èª¿å™¨</p><p>threads = tf.train.start_queue_runners(sess=sess, coord=coord) # å•Ÿå‹•ç·šç¨‹éšŠåˆ—</p><p>print('times shape:', full_data['times'])</p><p>print('values shape:', full_data['values'])</p><p>print(sess.run(full_data)['times'][0:10])</p><p>print(sess.run(full_data)['values'][0:10])</p><p>coord.request_stop()</p><p>'''</p><p>è¼¸å‡º:</p><p>times shape: Tensor("Squeeze_1:0", shape=(1000,), dtype=int64)</p><p>values shape: Tensor("Squeeze:0", shape=(1000, 1), dtype=float64)</p><p>[0 1 2 3 4 5 6 7 8 9]</p><p>[[-0.09581681]</p><p>[ 0.01284531]</p><p>[ 0.1107236 ]</p><p>[ 0.08856841]</p><p>[ 0.19104294]</p><p>[ 0.32795446]</p><p>[ 0.17780316]</p><p>[ 0.35017529]</p><p>[ 0.10477021]</p><p>[ 0.16101822]]</p><p>'''</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li><li>28</li><li>29</li></ul><p>é€šå¸¸åœ¨è¨“ç·´æ¨¡å‹æ™‚ï¼Œæˆ‘å€‘æ¡éœ€è¦çš„æ˜¯<strong>minibatchå½¢å¼çš„è¨“ç·´æ•¸æ“š</strong>ï¼ŒTFTSåº«æä¾›äº†<strong>tf.contrib.timeseries.RandomWindowInputFn</strong>æ–¹æ³•ç”¨æ–¼åœ¨readerä¸­éš¨æ©Ÿé¸å–window_sizeå¤§å°çš„æ•¸æ“šçµ„æˆä¸€çµ„åºåˆ—æ•¸æ“šã€‚demoå¦‚ä¸‹:</p><p>train_input_fn = tf.contrib.timeseries.RandomWindowInputFn(</p><p>reader, batch_size=2, window_size=10)</p><p>with tf.Session() as sess:</p><p>batch_data = train_input_fn.create_batch()</p><p>coord = tf.train.Coordinator()</p><p>threads = tf.train.start_queue_runners(sess=sess, coord=coord)</p><p>one_batch = sess.run(batch_data[0])</p><p>coord.request_stop()</p><p>print('one_batch_data:', one_batch)</p><p>'''</p><p>å³ä¸€å€‹batchç‚º2çµ„åºåˆ—æ•¸æ“šï¼Œæ¯çµ„åºåˆ—æ•¸æ“šæœ‰10æ¢æ•¸æ“šã€‚</p><p>è¼¸å‡º:</p><p>one_batch_data: {</p><p>'values': array([[[ 1.21827106],</p><p>[ 1.37975747],</p><p>[ 1.15419451],</p><p>[ 1.07579377],</p><p>[ 1.19008057],</p><p>[ 1.32173953],</p><p>[ 1.2152622 ],</p><p>[ 1.31092923],</p><p>[ 1.26184174],</p><p>[ 1.25915473]],</p><p>[[ 0.08465949],</p><p>[-0.0859257 ],</p><p>[-0.02987006],</p><p>[ 0.17472125],</p><p>[ 0.23542243],</p><p>[ 0.2032668 ],</p><p>[ 0.07650485],</p><p>[ 0.20822309],</p><p>[ 0.30753332],</p><p>[ 0.16054565]]]),</p><p>'times': array([[61, 62, 63, 64, 65, 66, 67, 68, 69, 70],</p><p>[ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]])}</p><p>'''</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li><li>31</li><li>32</li><li>33</li><li>34</li><li>35</li><li>36</li><li>37</li><li>38</li><li>39</li><li>40</li><li>41</li></ul><p>TFTSå¾Numpyä¸­è®€å–æ•¸æ“šçš„æµç¨‹å¤§æ¦‚æ“ä½œå°±æ˜¯é€™æ¨£äº†ï½</p><hr><p><strong>å¾CSVæ–‡ä»¶ä¸­è®€å…¥æ™‚é–“åºåˆ—æ•¸æ“š</strong></p><p>TFTSé‚„æä¾›äº†CSVReaderç”¨æ–¼è®€å–CSVæ–‡ä»¶ã€‚</p><p>é …ç›®ä¸­æä¾›äº†ä¸€å€‹input_input_csv.pyæ–‡ä»¶ç”¨æ–¼è™•ç†csvæ–‡ä»¶ï¼Œé€™è£¡è™•ç†çš„æ–‡ä»¶æ˜¯â€™./data/period_trend.csvâ€™.</p><p>é€™è£¡CSVçš„æ–‡ä»¶å½¢å¼å¦‚ä¸‹(æˆªå–):</p><p>1,-0.6656603714</p><p>2,-0.1164380359</p><p>3,0.7398626488</p><p>4,0.7368633029</p><p>5,0.2289480898</p><p>6,2.257073255</p><p>7,3.023457405</p><p>8,2.481161007</p><p>9,3.773638612</p><p>10,5.059257738</p><p>11,3.553186083</p><p>12,4.554486452</p><p>13,3.655475698</p><p>14,3.419647598</p><p>15,4.303376245</p><p>16,4.830153934</p><p>17,7.253057441</p><p>18,5.064802335</p><p>19,5.448082106</p><p>20,6.251301517</p><p>...</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li></ul><p>CSVçš„ç¬¬ä¸€åˆ—æ•¸æ“šç‚ºæ™‚é–“é»ï¼Œç¬¬äºŒåˆ—æ•¸æ“šç‚ºå°æ‡‰çš„è§€å¯Ÿå€¼ã€‚</p><p>CSVReaderçš„æ“ä½œæ­¥é©Ÿé™¤äº†è®€å–æ–‡ä»¶çš„éƒ¨åˆ†ä¸åŒï¼Œå¾Œé¢çš„æ“ä½œå’Œå‰é¢çš„NumpyReaderæ˜¯ä¸€æ¨£çš„ã€‚æ“ä½œçš„demoå¦‚ä¸‹:</p><p>from __future__ import print_function</p><p>import tensorflow as tf</p><p>csv_file_name = './data/period_trend.csv'</p><p>reader = tf.contrib.timeseries.CSVReader(csv_file_name)</p><p>with tf.Session() as sess:</p><p>data = reader.read_full()</p><p>coord = tf.train.Coordinator()</p><p>threads = tf.train.start_queue_runners(sess=sess, coord=coord)</p><p>print(sess.run(data))</p><p>coord.request_stop()</p><p>train_input_fn = tf.contrib.timeseries.RandomWindowInputFn(reader, batch_size=4, window_size=16)</p><p>with tf.Session() as sess:</p><p>data = train_input_fn.create_batch()</p><p>coord = tf.train.Coordinator()</p><p>threads = tf.train.start_queue_runners(sess=sess, coord=coord)</p><p>batch1 = sess.run(data[0])</p><p>batch2 = sess.run(data[0])</p><p>coord.request_stop()</p><p>print('batch1:', batch1)</p><p>print('batch2:', batch2)</p><p>'''</p><p>è¼¸å‡º:</p><p>{'values': array([[ -0.66566038],</p><p>[ -0.11643804],</p><p>[ 0.73986262],</p><p>[ 0.73686332],</p><p>[ 0.22894809],</p><p>[ 2.25707316],</p><p>[ 3.02345729],</p><p>...</p><p>dtype=float32), 'times': array([ 1, 2, 3, 4, 5, 6, ...ï¼Œ500])}</p><p>batch1: {'values': array([[[ 9.75562382],</p><p>[ 9.1494894 ],</p><p>[ 8.94796562],</p><p>[ 9.1767683 ],dtype=float32), 'times': array([[ 98, 99ï¼Œ...,129]])}</p><p>batch2: {'values': array([[[ 4.97288084],</p><p>[ 5.21278238],...ï¼Œdtype=float32), 'times': array([[ 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94,</p><p>95, 96, 97],...ï¼Œ226]])}</p><p>'''</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li><li>31</li><li>32</li><li>33</li><li>34</li><li>35</li><li>36</li><li>37</li><li>38</li><li>39</li><li>40</li><li>41</li><li>42</li><li>43</li><li>44</li><li>45</li><li>46</li><li>47</li></ul><p>åˆ°é€™è£¡ç‚ºæ­¢ï¼Œè¼‰å…¥æ•¸æ“šéƒ¨åˆ†åˆ°é€™è£¡å°±ç®—çµæŸäº†ã€‚</p><hr><p><strong>ä½¿ç”¨ARæ¨¡å‹é æ¸¬æ™‚é–“åºåˆ—</strong></p><p>ARæ¨¡å‹æ˜¯ä¸€ç¨®ç·šæ€§é æ¸¬ï¼Œå³å·²çŸ¥Nå€‹æ•¸æ“šï¼Œå¯ç”±æ¨¡å‹æ¨å‡ºç¬¬Né»å‰é¢æˆ–å¾Œé¢çš„æ•¸æ“šï¼ˆè¨­æ¨å‡ºPé»ï¼‰ï¼Œæ‰€ä»¥å…¶æœ¬è³ªé¡ä¼¼æ–¼æ’å€¼ï¼Œå…¶ç›®çš„éƒ½æ˜¯ç‚ºäº†å¢åŠ æœ‰æ•ˆæ•¸æ“šï¼Œåªæ˜¯ARæ¨¡å‹æ˜¯ç”±Né»éæ¨ï¼Œè€Œæ’å€¼æ˜¯ç”±å…©é»ï¼ˆæˆ–å°‘æ•¸å¹¾é»ï¼‰å»æ¨å°å¤šé»ï¼Œæ‰€ä»¥ARæ¨¡å‹è¦æ¯”æ’å€¼æ–¹æ³•æ•ˆæœæ›´å¥½ã€‚</p><p><strong>ä»£ç¢¼å¯¦ç¾</strong></p><p><strong>ç”¢ç”Ÿæ•¸æ“š</strong></p><p>ç”¢ç”Ÿæ•¸æ“šçš„æ–¹æ³•å°±æ˜¯ä¸Šé¢ä»‹ç´¹çš„æ–¹æ³•ã€‚</p><p>x = np.array(range(1000))</p><p>noise = np.random.uniform(-0.2, 0.2, 1000)</p><p>y = np.sin(np.pi * x / 100) + x / 200. + noise</p><p>plt.plot(x, y)</p><p>plt.savefig('timeseries_y.jpg')</p><p>data = {</p><p>tf.contrib.timeseries.TrainEvalFeatures.TIMES: x,</p><p>tf.contrib.timeseries.TrainEvalFeatures.VALUES: y,</p><p>}</p><p>reader = NumpyReader(data)</p><p>train_input_fn = tf.contrib.timeseries.RandomWindowInputFn(</p><p>reader, batch_size=16, window_size=40)</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li></ul><p><strong>å‰µå»ºaræ¨¡å‹</strong></p><p>å‰µå»ºaræ¨¡å‹ï¼Œæˆ‘å€‘éœ€è¦ä½¿ç”¨tf.contrib.timeseries.ARRegressoré¡</p><hr><p>å…ˆçœ‹ä¸‹ARRegressoré¡</p><p>class ARRegressor(_TimeSeriesRegressor):</p><p>"""</p><p>ARRegressoræ˜¯åŸºæ–¼æ»‘çª—æ¨¡å‹çš„ã€‚é€™è¦æ±‚è¼¸å…¥çª—å£å¤§å°è¦å›ºå®šç‚º'input_window_size'ï¼Œè¼¸å‡ºçª—å£å¤§å°å›ºå®šç‚º'output_window_size'. åŒæ™‚é€™å…©å€‹åƒæ•¸çš„å’Œå¿…é ˆç­‰æ–¼window_size(æ»¿è¶³è¨“ç·´æˆ–è©•ä¼°æ™‚ä½¿ç”¨çš„input_fn)ã€‚å»ºè­°ä½¿ç”¨'RandomWindowInputFn'(å°±æ˜¯ä¸Šé¢è¬›çš„éš¨æ©Ÿç”¢ç”Ÿbatchæ•¸æ“šçš„å‡½æ•¸)ç”¢ç”Ÿè¨“ç·´æˆ–è€…è©•ä¼°ã€‚</p><p>"""</p><p>def __init__(self,</p><p>periodicities, input_window_size,</p><p>output_window_size, num_features, num_time_buckets=10,</p><p>loss=ar_model.ARModel.NORMAL_LIKELIHOOD_LOSS,</p><p>hidden_layer_sizes=None, anomaly_prior_probability=None,</p><p>anomaly_distribution=None, optimizer=None,</p><p>model_dir=None, config=None):</p><p>"""</p><p>åƒæ•¸:</p><p>periodicities: value or a list of values. è¼¸å…¥ä¿¡è™Ÿçš„é€±æœŸã€‚</p><p>input_window_size: è¿´æ­¸æ™‚çµ¦å®šçš„è¼¸å…¥æ•¸æ“šæ™‚é–“æ­¥æ•¸.</p><p>output_window_size: é æ¸¬æ™‚é–“æ­¥æ•¸ï¼Œå»ºè­°è¨­ç½®>1.</p><p>num_features: æ™‚é–“åºåˆ—çš„ç¶­åº¦.(æ•¸æ“šçš„è§€å¯Ÿå€¼)</p><p>loss: SQUARED_LOSS æˆ–è€… NORMAL_LIKELIHOOD_LOSS.</p><p>hidden_layer_sizes: é»˜èªå³å¯.</p><p>anomaly_distributionï¼›anomaly_distribution: é»˜èªå³å¯ï¼ŒæŒ‡å®šå³æ§‹æˆæ··åˆæ¨¡å‹</p><p>optimizer: defaults to Adagrad with step size 0.1.</p><p>model_dir:æ¨¡å‹å­˜å„²åœ°å€.(ä¸Šé¢Estimatoræœ‰è¬›)</p><p>config: See `Estimator`.</p><p>"""</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li></ul><p>ç¸½çš„ä¾†èªªï¼Œéœ€è¦å¡«çš„åƒæ•¸æœ‰periodicities,input_window_size,output_window_size,num_features,lossã€‚å…¶å®ƒçš„åƒæ•¸é»˜èªå³å¯ã€‚</p><hr><p>é€™è£¡éœ€è¦æ³¨æ„çš„æœ‰<strong>input_window_size + output_window_size = window_size</strong>.(RandomWindowInputFnç”Ÿæˆæ•¸æ“šè£¡é¢çš„window_size).æˆ‘å€‘åœ¨ä¸Šé¢çš„ç”Ÿæˆæ•¸æ“šä½¿ç”¨çš„window_size=40.ä¸‹é¢ä½¿ç”¨çš„æ˜¯input_window_size=30, output_window_size=10.å°±æ˜¯è¼¸å…¥åºåˆ—30å€‹ï¼Œé æ¸¬10å€‹ã€‚</p><p><strong>num_features</strong>å³æ™‚é–“åºåˆ—çš„ç¶­åº¦ã€‚å°±æ˜¯åœ¨ä¸€å€‹æ™‚é–“é»ä¸Šè§€å¯Ÿåˆ°çš„æ•¸æ“šç¶­åº¦ã€‚æˆ‘å€‘é€™è£¡æ¯ä¸€æ­¥éƒ½æ˜¯ä¸€å€‹å–®ç¨çš„å€¼ï¼Œæ‰€ä»¥num_features=1ã€‚</p><p><strong>periodicities</strong>æ˜¯ä¿¡è™Ÿçš„é€±æœŸåˆ†é‡çš„é€±æœŸï¼Œæˆ‘å€‘ä¿¡è™Ÿçš„è¡¨é”å¼ç‚º:</p><p>y=sin(0.01âˆ—Ï€âˆ—x)+0.005âˆ—x+noise</p><p>y=sin(0.01âˆ—Ï€âˆ—x)+0.005âˆ—x+noise</p><p>yçš„é€±æœŸåˆ†é‡çš„frequencyç‚º2âˆ—Ï€âˆ—(1/f)</p><p>2âˆ—Ï€âˆ—(1/f),æ•…f=200,æ‰€ä»¥periodicities=200</p><p>f=200,æ‰€ä»¥periodicities=200ã€‚</p><p><strong>loss</strong>çš„å–å€¼ç¾åœ¨æ”¯æŒNORMAL_LIKELIHOOD_LOSSå’ŒSQUARED_LOSSã€‚ ar = tf.contrib.timeseries.ARRegressor(</p><p>periodicities=200, input_window_size=30, output_window_size=10,</p><p>num_features=1,</p><p>loss=tf.contrib.timeseries.ARModel.NORMAL_LIKELIHOOD_LOSS)</p><p>'''</p><p>(input_window_size=30) + (output_window_size=10) = (window_size=40)</p><p>'''</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li></ul><p><strong>è¨“ç·´è©•ä¼°æ¨¡å‹ä¸¦é æ¸¬</strong></p><p>ä½¿ç”¨trainå‡½æ•¸å‚³å…¥å‰µå»ºå¥½çš„æ•¸æ“štrain_input_fnè¨“ç·´æ¨¡å‹å³å¯.</p><p>ar.train(input_fn=train_input_fn, steps=6000)</p><ul><li>1</li></ul><p>æ¥ä¸‹ä¾†å°±æ˜¯å°æ¨¡å‹é€²è¡Œè©•ä¼°ï¼Œé¦–å…ˆæˆ‘å€‘ä½¿ç”¨ARæ¨¡å‹æä¾›çš„evaluateå‡½æ•¸ï¼Œé€™è£¡evaluationçš„è™•ç†æ˜¯ä½¿ç”¨è¨“ç·´å¥½çš„æ¨¡å‹åœ¨åŸå…ˆçš„è¨“ç·´é›†ä¸Šé€²è¡Œè¨ˆç®—ï¼Œç”±æ­¤æˆ‘å€‘å¯ä»¥è§€å¯Ÿåˆ°æ¨¡å‹çš„æ“¬åˆæ•ˆæœ.</p><p>evaluation_input_fn = tf.contrib.timeseries.WholeDatasetInputFn(reader)</p><p>evaluation = ar.evaluate(input_fn=evaluation_input_fn, steps=1)</p><p># keys of evaluation: ['covariance', 'loss', 'mean', 'observed', 'start_tuple', 'times', 'global_step']</p><p># evaluation['covariance']ä»£è¡¨å”æ–¹å·® evaluation['loss']ä»£è¡¨æå¤± etc..</p><ul><li>1</li><li>2</li><li>3</li><li>4</li></ul><p>å¦‚æœè¦ç†è§£é€™è£¡evaluateå‡½æ•¸çš„é‚è¼¯ï¼Œé€™è£¡ARæ¨¡å‹ï¼šæ¯æ¬¡éƒ½æ¥æ”¶é•·åº¦ç‚º30çš„è¼¸å…¥è§€æ¸¬åºåˆ—ï¼Œä¸¦è¼¸å‡ºé•·åº¦ç‚º10çš„é æ¸¬åºåˆ—ã€‚ä»¥æ­¤ç‚ºè¦å‰‡ï¼Œæ¯æ¬¡ç§»å‹•æ­¥é•·ç‚º1ï¼Œä»¥æ­¤é¡æ¨ï¼Œæ•´å€‹è¨“ç·´é›†é•·åº¦ç‚º1000çš„åºåˆ—ï¼Œæœ€çµ‚æˆ‘å€‘å¾—åˆ°970å€‹é æ¸¬å€¼ã€‚</p><p>é€™970å€‹é æ¸¬å€¼è¨˜éŒ„åœ¨evaluation[â€˜meanâ€™]ä¸­;evaluationé‚„æœ‰å…¶ä»–å¹¾å€‹éµå€¼:evaluation[â€˜lossâ€™]è¡¨ç¤ºç¸½çš„æå¤±ï¼Œevaluation[â€˜timesâ€™]è¡¨ç¤ºevaluation[â€˜meanâ€™]å°æ‡‰çš„æ™‚é–“é»ç­‰ç­‰.</p><p>è©•ä¼°å®Œæ¨¡å‹å¾Œï¼Œä¸‹é¢è©²æ˜¯ä½¿ç”¨æ¨¡å‹äº†ï¼Œé€™è£¡æˆ‘å€‘æœƒç”¨åˆ°predictå‡½æ•¸ä¾†é æ¸¬ï¼Œå‚³å…¥åƒæ•¸ç‚ºevaluation[â€˜start_tupleâ€™]æœƒè¢«ç”¨æ–¼ä¹‹å¾Œçš„é æ¸¬ä¸­ï¼Œå®ƒç›¸ç•¶æ–¼æœ€å¾Œ30æ­¥çš„è¼¸å‡ºå€¼å’Œå°æ‡‰çš„æ™‚é–“é»ã€‚ä»¥æ­¤ç‚ºèµ·é»(ä¹Ÿå°±æ˜¯çµ¦å®šè§€å¯Ÿæ•¸æ“š)ï¼Œæˆ‘å€‘å¯ä»¥å°1000æ­¥ä»¥å¾Œçš„å€¼é€²è¡Œé æ¸¬ï¼Œå°æ‡‰çš„ä»£ç¢¼ç‚ºï¼š</p><p>(predictions,) = tuple(ar.predict(</p><p>input_fn=tf.contrib.timeseries.predict_continuation_input_fn(</p><p>evaluation, steps=250)))</p><ul><li>1</li><li>2</li><li>3</li></ul><p>é€™è£¡çš„ä»£ç¢¼åœ¨1000æ­¥ä¹‹å¾Œåˆåƒå¾Œé æ¸¬äº†250å€‹æ™‚é–“é»ã€‚å°æ‡‰çš„å€¼å°±ä¿å­˜åœ¨predictions[â€˜meanâ€™]ä¸­ã€‚æˆ‘å€‘å¯ä»¥æŠŠè§€æ¸¬åˆ°çš„å€¼ã€æ¨¡å‹æ“¬åˆçš„å€¼ã€é æ¸¬å€¼ç”¨ä¸‹é¢çš„ä»£ç¢¼ç•«å‡ºä¾†ï¼š</p><p>plt.figure(figsize=(15, 5))</p><p>plt.plot(data['times'].reshape(-1), data['values'].reshape(-1), label='origin')</p><p>plt.plot(evaluation['times'].reshape(-1), evaluation['mean'].reshape(-1), label='evaluation')</p><p>plt.plot(predictions['times'].reshape(-1), predictions['mean'].reshape(-1), label='prediction')</p><p>plt.xlabel('time_step')</p><p>plt.ylabel('values')</p><p>plt.legend(loc=4)</p><p>plt.savefig('predict_result.jpg')</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li></ul><div class=pgc-img><img alt=TensorFlowå¯¦æˆ°ï¼šChapter-7ä¸‹ï¼ˆTFTSåº«èˆ‡æ™‚é–“åºåˆ—é æ¸¬ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1534905582992424220237f><p class=pgc-img-caption></p></div><hr><p><strong>ä½¿ç”¨LSTMé æ¸¬å–®è®Šé‡æ™‚é–“åºåˆ—</strong></p><p>æ³¨æ„ï¼šä»¥ä¸‹LSTMæ¨¡å‹çš„ä¾‹å­å¿…é ˆä½¿ç”¨TensorFlowæœ€æ–°çš„é–‹ç™¼ç‰ˆçš„æºç¢¼ã€‚å…·é«”ä¾†èªªï¼Œè¦ä¿è­‰</p><p>from tensorflow.contrib.timeseries.python.timeseries.estimators import TimeSeriesRegressor</p><ul><li>1</li></ul><p>å¯ä»¥æˆåŠŸåŸ·è¡Œã€‚(å°±æ˜¯å‰é¢èªªçš„éœ€è¦å®‰è£æœ€æ–°ç‰ˆçš„tensorflow)</p><p>çµ¦å‡ºå…©å€‹ç”¨LSTMé æ¸¬æ™‚é–“åºåˆ—æ¨¡å‹çš„ä¾‹å­ï¼Œåˆ†åˆ¥æ˜¯train_lstm.pyå’Œtrain_lstm_multivariate.pyã€‚å‰è€…æ˜¯åœ¨LSTMä¸­é€²è¡Œå–®è®Šé‡çš„æ™‚é–“åºåˆ—é æ¸¬ï¼Œå¾Œè€…æ˜¯ä½¿ç”¨LSTMé€²è¡Œå¤šè®Šé‡æ™‚é–“åºåˆ—é æ¸¬ã€‚ç‚ºäº†ä½¿ç”¨LSTMæ¨¡å‹ï¼Œæˆ‘å€‘éœ€è¦å…ˆä½¿ç”¨TFTSåº«å°å…¶é€²è¡Œå®šç¾©ï¼Œå®šç¾©æ¨¡å‹çš„ä»£ç¢¼ä¾†æºæ–¼TFTSçš„ç¤ºä¾‹æºç¢¼ï¼Œåœ¨train_lstm.pyå’Œtrain_lstm_multivariate.pyä¸­åˆ†åˆ¥æ‹·è²äº†ä¸€ä»½ã€‚</p><p><strong>ç”¢ç”Ÿè¨“ç·´æ•¸æ“š</strong></p><p>é€™è£¡æˆ‘å€‘ç”¢ç”Ÿçš„æ•¸æ“šå…¬å¼ä¿®æ”¹ä¸€ä¸‹</p><p>y=sin(Ï€âˆ—0.02âˆ—x)+cos(Ï€âˆ—0.02âˆ—x)+sin(Ï€âˆ—0.04âˆ—x)+noise</p><p>y=sin(Ï€âˆ—0.02âˆ—x)+cos(Ï€âˆ—0.02âˆ—x)+sin(Ï€âˆ—0.04âˆ—x)+noise</p><p>åŒæ¨£ç”¨å‡½æ•¸åŠ å™ªè²çš„æ–¹æ³•ç”Ÿæˆä¸€å€‹æ¨¡æ“¬çš„æ™‚é–“åºåˆ—æ•¸æ“šï¼š</p><p>x = np.array(range(1000))</p><p>noise = np.random.uniform(-0.2, 0.2, 1000)</p><p>y = np.sin(np.pi * x / 50 ) + np.cos(np.pi * x / 50) + np.sin(np.pi * x / 25) + noise</p><p>data = {</p><p>tf.contrib.timeseries.TrainEvalFeatures.TIMES: x,</p><p>tf.contrib.timeseries.TrainEvalFeatures.VALUES: y,</p><p>}</p><p>'''</p><p>plt.plot(x, y)</p><p>plt.savefig('train_data.jpg')</p><p>'''</p><p>reader = NumpyReader(data)</p><p>train_input_fn = tf.contrib.timeseries.RandomWindowInputFn(</p><p>reader, batch_size=4, window_size=100) # batch_sizeç‚º4 åºåˆ—é•·åº¦ç‚º100</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li></ul><p>ç”¢ç”Ÿæ•¸æ“šå¦‚ä¸‹:</p><div class=pgc-img><img alt=TensorFlowå¯¦æˆ°ï¼šChapter-7ä¸‹ï¼ˆTFTSåº«èˆ‡æ™‚é–“åºåˆ—é æ¸¬ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1534905461004578947d80b><p class=pgc-img-caption></p></div><p><strong>å®šç¾©è¨“ç·´æ¨¡å‹ä¸¦é æ¸¬</strong></p><p>é€™è£¡ä½¿ç”¨TFTSåŒ…å…§æä¾›çš„TimeSeriesRegressoræ¨¡å‹ã€‚å…¶ä¸­_LSTMModelä¾†è‡ªTFTSåŒ…çš„å®˜æ–¹ä¾‹å­ã€‚</p><hr><ul><li><strong>_LSTMModelæ¥å—å…©å€‹åƒæ•¸:</strong>num_units: æ¨¡å‹ä¸­ä½¿ç”¨çš„LSTMå–®å…ƒå€‹æ•¸</li><li>num_features: æ™‚é–“åºåˆ—èƒ½è§€å¯Ÿåˆ°çš„ç¶­åº¦.(å³æ¯å€‹æ™‚é–“æ­¥èƒ½è§€å¯Ÿåˆ°çš„æ•¸æ“šç‰¹å¾µé‡)</li></ul><p>é€™è£¡æˆ‘å€‘ä½¿ç”¨çš„æ¨¡å‹åƒæ•¸ç‚ºnum_features = 1è¡¨ç¤ºå–®è®Šé‡æ™‚é–“åºåˆ—ï¼Œå³æ¯å€‹æ™‚é–“é»ä¸Šè§€å¯Ÿåˆ°çš„é‡åªæ˜¯ä¸€å€‹å–®ç¨çš„æ•¸å€¼ã€‚num_units=128è¡¨ç¤ºä½¿ç”¨éš±å±¤ç‚º128å¤§å°çš„LSTMæ¨¡å‹ã€‚å¾ŒçºŒçš„è¨“ç·´ï¼Œè©•ä¼°ï¼Œé æ¸¬å’Œå‰é¢è¬›çš„ä»£ç¢¼é¡ä¼¼ã€‚åœ¨ä»¥å¾Œçš„1000çµ„æ•¸æ“šä¸Šï¼Œæˆ‘å€‘å‘å¾Œé æ¸¬äº†200çµ„æ•¸æ“šã€‚</p><hr><p>ä»£ç¢¼å¦‚ä¸‹:</p><p>estimator = ts_estimators.TimeSeriesRegressor(</p><p>model=_LSTMModel(num_features=1, num_units=128),</p><p>optimizer=tf.train.AdamOptimizer(0.001))</p><p>estimator.train(input_fn=train_input_fn, steps=2000)</p><p>evaluation_input_fn = tf.contrib.timeseries.WholeDatasetInputFn(reader)</p><p>evaluation = estimator.evaluate(input_fn=evaluation_input_fn, steps=1)</p><p># Predict starting after the evaluation é æ¸¬å¾ŒçºŒçš„200çµ„æ•¸æ“š</p><p>(predictions,) = tuple(estimator.predict(</p><p>input_fn=tf.contrib.timeseries.predict_continuation_input_fn(</p><p>evaluation, steps=200)))</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li></ul><p><strong>ç¹ªè£½é æ¸¬æ•¸æ“šåœ–</strong></p><p>observed_times = evaluation["times"][0]</p><p>observed = evaluation["observed"][0, :, :]</p><p>evaluated_times = evaluation["times"][0]</p><p>evaluated = evaluation["mean"][0]</p><p>predicted_times = predictions['times']</p><p>predicted = predictions["mean"]</p><p>plt.figure(figsize=(15, 5))</p><p>plt.axvline(999, linestyle="dotted", linewidth=4, color='r')</p><p>observed_lines = plt.plot(observed_times, observed, label="observation", color="k")</p><p>evaluated_lines = plt.plot(evaluated_times, evaluated, label="evaluation", color="g")</p><p>predicted_lines = plt.plot(predicted_times, predicted, label="prediction", color="r")</p><p>plt.legend(handles=[observed_lines[0], evaluated_lines[0], predicted_lines[0]],</p><p>loc="upper left")</p><p>plt.savefig('predict_result.jpg')</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li></ul><div class=pgc-img><img alt=TensorFlowå¯¦æˆ°ï¼šChapter-7ä¸‹ï¼ˆTFTSåº«èˆ‡æ™‚é–“åºåˆ—é æ¸¬ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15349056032327a60fa42cb><p class=pgc-img-caption></p></div><hr><p><strong>ä½¿ç”¨LSTMé æ¸¬å¤šè®Šé‡æ™‚é–“åºåˆ—</strong></p><p>èˆ‡ä¸Šé¢çš„ä½¿ç”¨LSTMé æ¸¬å–®è®Šé‡æ™‚é–“åºåˆ—ä¸åŒçš„åœ°æ–¹åœ¨æ–¼æ•¸æ“šçš„è®€å–å’Œæ¨¡å‹çš„é æ¸¬é‡ã€‚ä½¿ç”¨åŸç†å¯¦è³ªä¸Šæ˜¯ä¸€è‡´çš„ã€‚</p><p><strong>ç²å–è¨“ç·´æ•¸æ“š</strong></p><p>æ‰€è¬‚å¤šè®Šé‡æ™‚é–“åºåˆ—ï¼Œå°±æ˜¯æŒ‡åœ¨æ¯å€‹æ™‚é–“é»ä¸Šçš„è§€æ¸¬é‡æœ‰å¤šå€‹å€¼ã€‚åœ¨data/multivariate_periods.csvæ–‡ä»¶ä¸­ï¼Œä¿å­˜äº†ä¸€å€‹å¤šè®Šé‡æ™‚é–“åºåˆ—çš„æ•¸æ“šï¼š(ä¸‹é¢æ˜¯æˆªå–)</p><p>0,0.926906299771,1.99107237682,2.56546245685,3.07914768197,4.04839057867</p><p>1,0.108010001864,1.41645361423,2.1686839775,2.94963962176,4.1263503303</p><p>2,-0.800567600028,1.0172132907,1.96434754116,2.99885333086,4.04300485864</p><p>3,0.0607042871898,0.719540073421,1.9765012584,2.89265588817,4.0951014426</p><p>4,0.933712200629,0.28052120776,1.41018552514,2.69232603996,4.06481164223</p><p>5,-0.171730652974,0.260054421028,1.48770816369,2.62199129293,4.44572807842</p><p>6,-1.00180162933,0.333045158863,1.50006392277,2.88888309683,4.24755865606</p><p>7,0.0580061875336,0.688929398826,1.56543458772,2.99840358953,4.52726873347</p><p>8,0.764139447412,1.24704875327,1.77649279698,3.13578593851,4.63238922951</p><p>9,-0.230331874785,1.47903998963,2.03547545751,3.20624030377,4.77980005228</p><p>10,-1.03846045211,2.01133000781,2.31977503972,3.67951536251,5.09716775897</p><p>11,0.188643592253,2.23285349038,2.68338482249,3.49817168611,5.24928239634</p><p>12,0.91207302309,2.24244446841,2.71362604985,3.96332587625,5.37802271594</p><p>13,-0.296588665881,2.02594634141,3.07733910479,3.99698324956,5.56365901394</p><p>14,-0.959961476551,1.45078629833,3.18996420137,4.3763059609,5.65356015609</p><p>15,0.46313530679,1.01141441548,3.4980215948,4.20224896882,5.88842247449</p><p>16,0.929354125798,0.626635305936,3.70508262244,4.51791573544,5.73945973251</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li></ul><p>å³æ¯å€‹æ™‚é–“æ­¥ä¸Šèƒ½è§€å¯Ÿåˆ°å¤šå€‹æ•¸æ“šè®Šé‡(é€™è£¡æœ‰5çµ„æ•¸æ“š)ã€‚èˆ‰å€‹ç°¡å–®çš„ä¾‹å­:å¦‚æœç¾åœ¨æˆ‘åœ¨è·‘æ­¥ï¼Œæ¯å€‹æ™‚é–“æ­¥ä¸Šï¼Œå¯ä»¥ç²å–åˆ°æˆ‘çš„å¿ƒè·³ï¼Œè¡€å£“ï¼Œé«”æº«ã€‚é€™å°±æ˜¯åœ¨æ¯å€‹æ™‚é–“æ­¥ä¸Šèƒ½è§€å¯Ÿåˆ°3å€‹æ•¸æ“šè®Šé‡ã€‚</p><p>ä¸‹é¢ä¾èˆŠæ˜¯ä½¿ç”¨CSVReaderè™•ç†æ•¸æ“šï¼Œå€åˆ¥åœ¨column_namesåƒæ•¸ï¼Œè©²åƒæ•¸å‘Šè¨´CSVReaderé‚£äº›è®Šé‡æ˜¯å°æ‡‰çš„æ™‚é–“æ­¥å’Œè®Šé‡ã€‚</p><p>csv_file_name = path.join("./data/multivariate_periods.csv")</p><p>reader = tf.contrib.timeseries.CSVReader(</p><p>csv_file_name,</p><p>column_names=((tf.contrib.timeseries.TrainEvalFeatures.TIMES,)</p><p>+ (tf.contrib.timeseries.TrainEvalFeatures.VALUES,) * 5))</p><p>train_input_fn = tf.contrib.timeseries.RandomWindowInputFn(</p><p>reader, batch_size=4, window_size=32)</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li></ul><p><strong>å®šç¾©è¨“ç·´æ¨¡å‹ä¸¦é æ¸¬</strong></p><p>é€™è£¡èˆ‡ä¸Šé¢çš„ç¨‹åºä¸åŒçš„åœ°æ–¹åœ¨æ–¼_LSTMModelä¸­åƒæ•¸num_features=5.å³èƒ½è§€å¯Ÿçš„æ•¸æ“šé‡ç¶­åº¦ç‚º5.æœ¬æ¬¡å‘å¾Œé æ¸¬çš„æ•¸æ“šç‚º100çµ„ã€‚(è¨“ç·´æ•¸æ“š100çµ„)</p><p>estimator = ts_estimators.TimeSeriesRegressor(</p><p>model=_LSTMModel(num_features=5, num_units=128),</p><p>optimizer=tf.train.AdamOptimizer(0.001))</p><p>estimator.train(input_fn=train_input_fn, steps=200)</p><p>evaluation_input_fn = tf.contrib.timeseries.WholeDatasetInputFn(reader)</p><p>evaluation = estimator.evaluate(input_fn=evaluation_input_fn, steps=1)</p><p># Predict starting after the evaluation</p><p>(predictions,) = tuple(estimator.predict(</p><p>input_fn=tf.contrib.timeseries.predict_continuation_input_fn(</p><p>evaluation, steps=100)))</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li></ul><p><strong>ç¹ªè£½é æ¸¬åœ–</strong></p><p>observed_times = evaluation["times"][0]</p><p>observed = evaluation["observed"][0, :, :]</p><p>evaluated_times = evaluation["times"][0]</p><p>evaluated = evaluation["mean"][0]</p><p>predicted_times = predictions['times']</p><p>predicted = predictions["mean"]</p><p>plt.figure(figsize=(15, 5))</p><p>plt.axvline(99, linestyle="dotted", linewidth=4, color='r')</p><p>observed_lines = plt.plot(observed_times, observed, label="observation", color="k")</p><p>evaluated_lines = plt.plot(evaluated_times, evaluated, label="evaluation", color="g")</p><p>predicted_lines = plt.plot(predicted_times, predicted, label="prediction", color="r")</p><p>plt.legend(handles=[observed_lines[0], evaluated_lines[0], predicted_lines[0]],</p><p>loc="upper left")</p><p>plt.savefig('predict_result.jpg')</p><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li></ul><div class=pgc-img><img alt=TensorFlowå¯¦æˆ°ï¼šChapter-7ä¸‹ï¼ˆTFTSåº«èˆ‡æ™‚é–“åºåˆ—é æ¸¬ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15349054915748b089e1943><p class=pgc-img-caption></p></div><hr><hr><h1><strong>ç¸½çµ</strong></h1><p>TFTSæ˜¯Tensorflowå®˜æ–¹æä¾›çš„åŸºæ–¼LSTMæ¨¡å‹çš„æ™‚åºé æ¸¬å·¥å…·ï¼Œå¯ä»¥ç”¨æ–¼å¸¸è¦‹çš„æ™‚åºæ¨¡å‹ä¸Š(æ›¿ä»£HMM)ã€‚é€™è£¡è¬›äº†å¦‚æœä½¿ç”¨TFTSæ¨¡å‹è®€å–æ•¸æ“šä½µç”¢ç”Ÿè¨“ç·´æ•¸æ“šï¼ŒåŒæ™‚è¬›äº†å¦‚æœä½¿ç”¨TFTSæ¨¡å¡Šè‡ªå¸¶çš„ARå’ŒLSTMæ¨¡å‹ã€‚</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>TensorFlow</a></li><li><a>å¯¦æˆ°</a></li><li><a>Chapter</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/cfc7290d.html alt=OpenCVé …ç›®å¯¦æˆ°---äººè‡‰æª¢æ¸¬ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f267e46946554437b5ffe48234f3b78d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cfc7290d.html title=OpenCVé …ç›®å¯¦æˆ°---äººè‡‰æª¢æ¸¬>OpenCVé …ç›®å¯¦æˆ°---äººè‡‰æª¢æ¸¬</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fcc2ad9e.html alt=éŸ³é »ç·¨ç¢¼å¯¦æˆ° class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/aacf5cab-b987-443f-815e-236f984fb2d0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fcc2ad9e.html title=éŸ³é »ç·¨ç¢¼å¯¦æˆ°>éŸ³é »ç·¨ç¢¼å¯¦æˆ°</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/02729303.html alt=javaå¯¦æˆ°é …ç›®å¸¸ç”¨é¡ï¼ŒDateã€Calendarã€BigDecimalã€Mathã€UUID class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d69c7c9d8b85444da9360e334ba6555d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/02729303.html title=javaå¯¦æˆ°é …ç›®å¸¸ç”¨é¡ï¼ŒDateã€Calendarã€BigDecimalã€Mathã€UUID>javaå¯¦æˆ°é …ç›®å¸¸ç”¨é¡ï¼ŒDateã€Calendarã€BigDecimalã€Mathã€UUID</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/73ba27bb.html alt=è€è‚¡æ°‘ç¸½çµçš„è³£å‡ºæŠ€å·§å¯¦æˆ°åœ–è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/7575000bb7b8e57fa260 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/73ba27bb.html title=è€è‚¡æ°‘ç¸½çµçš„è³£å‡ºæŠ€å·§å¯¦æˆ°åœ–è§£>è€è‚¡æ°‘ç¸½çµçš„è³£å‡ºæŠ€å·§å¯¦æˆ°åœ–è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/22408815.html alt=è‚¡ç¥¨äº¤æ˜“æŒ‡å—ï¼šå¯¦æˆ°åœ–è§£ç¶“å…¸çš„è³£å‡ºæŠ€å·§ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/15305260751844061be70e0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/22408815.html title=è‚¡ç¥¨äº¤æ˜“æŒ‡å—ï¼šå¯¦æˆ°åœ–è§£ç¶“å…¸çš„è³£å‡ºæŠ€å·§>è‚¡ç¥¨äº¤æ˜“æŒ‡å—ï¼šå¯¦æˆ°åœ–è§£ç¶“å…¸çš„è³£å‡ºæŠ€å·§</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/eaa95354.html alt=è‚¡ç¥¨è³£å‡ºå¯¦æˆ°æŠ€è¡“åœ–è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/88520001219b9b7dabd2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/eaa95354.html title=è‚¡ç¥¨è³£å‡ºå¯¦æˆ°æŠ€è¡“åœ–è§£>è‚¡ç¥¨è³£å‡ºå¯¦æˆ°æŠ€è¡“åœ–è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/feeaba4f.html alt="åœ¨ç·šå ±è¡¨è¨­è¨ˆå¯¦æˆ°ç³»åˆ— â€“ â‘¡è£½ä½œè¡¨æ ¼é¡å ±è¡¨" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/47190002d9db05c4adc2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/feeaba4f.html title="åœ¨ç·šå ±è¡¨è¨­è¨ˆå¯¦æˆ°ç³»åˆ— â€“ â‘¡è£½ä½œè¡¨æ ¼é¡å ±è¡¨">åœ¨ç·šå ±è¡¨è¨­è¨ˆå¯¦æˆ°ç³»åˆ— â€“ â‘¡è£½ä½œè¡¨æ ¼é¡å ±è¡¨</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d288ac1b.html alt=æ‰“é€šå¯¦æˆ°ä¿éšœéˆè·¯â€œæœ€å¾Œä¸€å…¬é‡Œâ€ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d288ac1b.html title=æ‰“é€šå¯¦æˆ°ä¿éšœéˆè·¯â€œæœ€å¾Œä¸€å…¬é‡Œâ€>æ‰“é€šå¯¦æˆ°ä¿éšœéˆè·¯â€œæœ€å¾Œä¸€å…¬é‡Œâ€</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/79ca353a.html alt=ã€Œæ¡ˆä¾‹å¯¦æˆ°ã€æ¡ˆä¾‹è§£æï¼ˆ24ï¼‰è‡ªå™´ç³»çµ± class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/c8b46117-9cc6-4c33-be2f-ca4e35b8431f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/79ca353a.html title=ã€Œæ¡ˆä¾‹å¯¦æˆ°ã€æ¡ˆä¾‹è§£æï¼ˆ24ï¼‰è‡ªå™´ç³»çµ±>ã€Œæ¡ˆä¾‹å¯¦æˆ°ã€æ¡ˆä¾‹è§£æï¼ˆ24ï¼‰è‡ªå™´ç³»çµ±</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/db5ee11c.html alt=ã€Œæ¡ˆä¾‹å¯¦æˆ°ã€æ¡ˆä¾‹è§£æï¼ˆ39ï¼‰è‡ªå™´ç³»çµ± class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/db5ee11c.html title=ã€Œæ¡ˆä¾‹å¯¦æˆ°ã€æ¡ˆä¾‹è§£æï¼ˆ39ï¼‰è‡ªå™´ç³»çµ±>ã€Œæ¡ˆä¾‹å¯¦æˆ°ã€æ¡ˆä¾‹è§£æï¼ˆ39ï¼‰è‡ªå™´ç³»çµ±</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c3d6e4c9.html alt=Javaé …ç›®å¯¦æˆ°ç¬¬10å¤©ï¼šåˆ†é æ¬„çš„å¯¦ç¾ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/000f44dadac946188c05567c6741ae3c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c3d6e4c9.html title=Javaé …ç›®å¯¦æˆ°ç¬¬10å¤©ï¼šåˆ†é æ¬„çš„å¯¦ç¾>Javaé …ç›®å¯¦æˆ°ç¬¬10å¤©ï¼šåˆ†é æ¬„çš„å¯¦ç¾</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/20b12ef6.html alt=Javaé …ç›®å¯¦æˆ°ç¬¬7å¤©ï¼šå°èˆªæ¬„æ¥­å‹™çš„å¯¦ç¾ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5ed388098e304e21872e291ae4eebf6f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/20b12ef6.html title=Javaé …ç›®å¯¦æˆ°ç¬¬7å¤©ï¼šå°èˆªæ¬„æ¥­å‹™çš„å¯¦ç¾>Javaé …ç›®å¯¦æˆ°ç¬¬7å¤©ï¼šå°èˆªæ¬„æ¥­å‹™çš„å¯¦ç¾</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4110ca16.html alt=è‚¡å¸‚çœŸæ­£å²å®³çš„å¯¦æˆ°æ“ç›¤æ‰‹ï¼šâ€œå°¾ç›¤30åˆ†é˜â€æ˜¯è‚¡å¸‚å…¨å¤©çš„æœ€é»ƒé‡‘æ™‚åˆ»ï¼Œè®€æ‡‚æœ¬æ–‡ç­‰æ–¼è®€æ‡‚ä¸­åœ‹è‚¡å¸‚ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RbYtVhS9wGTmMO style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4110ca16.html title=è‚¡å¸‚çœŸæ­£å²å®³çš„å¯¦æˆ°æ“ç›¤æ‰‹ï¼šâ€œå°¾ç›¤30åˆ†é˜â€æ˜¯è‚¡å¸‚å…¨å¤©çš„æœ€é»ƒé‡‘æ™‚åˆ»ï¼Œè®€æ‡‚æœ¬æ–‡ç­‰æ–¼è®€æ‡‚ä¸­åœ‹è‚¡å¸‚>è‚¡å¸‚çœŸæ­£å²å®³çš„å¯¦æˆ°æ“ç›¤æ‰‹ï¼šâ€œå°¾ç›¤30åˆ†é˜â€æ˜¯è‚¡å¸‚å…¨å¤©çš„æœ€é»ƒé‡‘æ™‚åˆ»ï¼Œè®€æ‡‚æœ¬æ–‡ç­‰æ–¼è®€æ‡‚ä¸­åœ‹è‚¡å¸‚</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/63d702d9.html alt=å¯¦æˆ°ï¼šå¿«é€Ÿè£½ä½œæ™¶æ ¼åŒ–ç•Œé¢ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/f6d9a49e175845eeb3f1cf0891713c6f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/63d702d9.html title=å¯¦æˆ°ï¼šå¿«é€Ÿè£½ä½œæ™¶æ ¼åŒ–ç•Œé¢>å¯¦æˆ°ï¼šå¿«é€Ÿè£½ä½œæ™¶æ ¼åŒ–ç•Œé¢</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c3c2cbf1.html alt=ä¸‰ã€å½™ç·¨åˆæ­¥å¯¦æˆ° class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c3c2cbf1.html title=ä¸‰ã€å½™ç·¨åˆæ­¥å¯¦æˆ°>ä¸‰ã€å½™ç·¨åˆæ­¥å¯¦æˆ°</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>