<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>javaç¨‹åºå“¡æ”¶è—ç³»åˆ—ï¼šé«˜æ€§èƒ½çš„é—œéµSpring MVCçš„ç•°æ­¥æ¨¡å¼ | æå®¢å¿«è¨Š</title><meta property="og:title" content="javaç¨‹åºå“¡æ”¶è—ç³»åˆ—ï¼šé«˜æ€§èƒ½çš„é—œéµSpring MVCçš„ç•°æ­¥æ¨¡å¼ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/bb3b82f85b21434da2285f1ac2c2c733"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7437eb3.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7437eb3.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/7437eb3.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7437eb3.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7437eb3.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/7437eb3.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/7437eb3.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7437eb3.html><meta property="article:published_time" content="2020-10-29T20:50:33+08:00"><meta property="article:modified_time" content="2020-10-29T20:50:33+08:00"><meta name=Keywords content><meta name=description content="javaç¨‹åºå“¡æ”¶è—ç³»åˆ—ï¼šé«˜æ€§èƒ½çš„é—œéµSpring MVCçš„ç•°æ­¥æ¨¡å¼"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/7437eb3.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>javaç¨‹åºå“¡æ”¶è—ç³»åˆ—ï¼šé«˜æ€§èƒ½çš„é—œéµSpring MVCçš„ç•°æ­¥æ¨¡å¼</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><p>æˆ‘æ‰¿èªæœ‰äº›æ¨™é¡Œé»¨äº†ï¼Œä¸éè©±èªªé€™æ¨£å…¶å¯¦ä¹Ÿæ²’éŒ¯ï¼Œé—œæ–¼â€œç•°æ­¥â€è™•ç†çš„æ–‡ç« å·²ç¶“ä¸å°‘ï¼Œä»£ç¢¼ä¾‹å­ä¹Ÿèƒ½æ‰¾åˆ°å¾ˆå¤šï¼Œä½†æˆ‘é‚„æ˜¯æ‰“ç®—é«®è¡¨é€™ç¯‡æˆ‘å¯«äº†å¥½é•·ä¸€æ®µæ™‚é–“ï¼Œå»ä¸€ç›´æ²’ç™¼è¡¨çš„æ–‡ç« ï¼Œä»¥ä¸€å€‹æ›´ç°¡å–®çš„è¦–è§’ï¼ŒæŠŠç•°æ­¥æ¨¡å¼è¬›æ¸…æ¥šã€‚</p><h1><strong>ä»€éº¼æ˜¯ç•°æ­¥æ¨¡å¼</strong></h1><p>è¦çŸ¥é“ä»€éº¼æ˜¯ç•°æ­¥æ¨¡å¼ï¼Œå°±å…ˆè¦çŸ¥é“ä»€éº¼æ˜¯åŒæ­¥æ¨¡å¼ï¼Œ<strong>å…ˆçœ‹æœ€å…¸å‹çš„åŒæ­¥æ¨¡å¼ï¼š</strong></p><div class=pgc-img><img alt="javaç¨‹åºå“¡æ”¶è—ç³»åˆ—ï¼šé«˜æ€§èƒ½çš„é—œéµSpring MVCçš„ç•°æ­¥æ¨¡å¼" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/bb3b82f85b21434da2285f1ac2c2c733><p class=pgc-img-caption></p></div><p>ç€è¦½å™¨ç™¼èµ·è«‹æ±‚ï¼ŒWebæœå‹™å™¨é–‹ä¸€å€‹ç·šç¨‹è™•ç†ï¼Œè™•ç†å®ŒæŠŠè™•ç†çµæœè¿”å›ç€è¦½å™¨ã€‚å¥½åƒæ²’ä»€éº¼å¥½èªªçš„äº†ï¼Œçµ•å¤§å¤šæ•¸Webæœå‹™å™¨éƒ½å¦‚æ­¤èˆ¬è™•ç†ã€‚ç¾åœ¨æƒ³æƒ³<strong>å¦‚æœè™•ç†çš„éç¨‹ä¸­éœ€è¦èª¿ç”¨å¾Œç«¯çš„ä¸€å€‹æ¥­å‹™é‚è¼¯æœå‹™å™¨ï¼Œæœƒæ˜¯æ€æ¨£å‘¢ï¼Ÿ</strong></p><div class=pgc-img><img alt="javaç¨‹åºå“¡æ”¶è—ç³»åˆ—ï¼šé«˜æ€§èƒ½çš„é—œéµSpring MVCçš„ç•°æ­¥æ¨¡å¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/44a68f97bf264aa2ba11b3af221e52cb><p class=pgc-img-caption></p></div><p>èª¿å°±èª¿å§ï¼Œä¸Šåœ–æ‰€ç¤ºï¼Œè«‹æ±‚è™•ç†ç·šç¨‹æœƒåœ¨Calläº†ä¹‹å¾Œç­‰å¾…Returnï¼Œè‡ªèº«è™•æ–¼é˜»å¡ç‹€æ…‹ã€‚é€™ä¹Ÿæ˜¯çµ•å¤§å¤šæ•¸Webæœå‹™å™¨çš„åšæ³•ï¼Œä¸€èˆ¬ä¾†èªªé€™æ¨£åšä¹Ÿå¤ äº†ï¼Œç‚ºå•¥ï¼Ÿä¸€ä¾†â€œé•·æ™‚é–“è™•ç†æœå‹™â€èª¿ç”¨é€šå¸¸ä¸å¤šï¼ŒäºŒä¾†è«‹æ±‚æ•¸å…¶å¯¦ä¹Ÿä¸å¤šã€‚è¦ä¸æ˜¯é€™æ¨£çš„è©±ï¼Œ<strong>é€™ç¨®æ¨¡å¼æœƒå‡ºç¾ä»€éº¼å•é¡Œå‘¢ï¼Ÿâ€”â€”æœƒå‡ºç¾çš„å•é¡Œå°±æ˜¯è«‹æ±‚è™•ç†ç·šç¨‹çš„çŸ­ç¼ºï¼</strong>å› ç‚ºè«‹æ±‚è™•ç†ç·šç¨‹çš„ç¸½æ•¸æ˜¯æœ‰é™çš„ï¼Œå¦‚æœé¡ä¼¼çš„è«‹æ±‚å¤šäº†ï¼Œæ‰€æœ‰çš„è™•ç†ç·šç¨‹è™•æ–¼é˜»å¡çš„ç‹€æ…‹ï¼Œé‚£æ–°çš„è«‹æ±‚ä¹Ÿå°±ç„¡æ³•è™•ç†äº†ï¼Œä¹Ÿå°±æ‰€è¬‚å½±éŸ¿äº†æœå‹™å™¨çš„ååèƒ½åŠ›ã€‚è¦æ›´åŠ å¥½åœ°ç™¼æ®æœå‹™å™¨çš„å…¨éƒ¨æ€§èƒ½ï¼Œå°±è¦ä½¿ç”¨ç•°æ­¥ï¼Œé€™ä¹Ÿæ˜¯æ¨™é¡Œä¸Šæ‰€èªªçš„â€œé«˜æ€§èƒ½çš„é—œéµâ€ã€‚<strong>æ¥ä¸‹ä¾†æˆ‘å€‘ä¾†çœ‹çœ‹ç•°æ­¥æ˜¯æ€éº¼ä¸€å›äº‹ï¼š</strong></p><div class=pgc-img><img alt="javaç¨‹åºå“¡æ”¶è—ç³»åˆ—ï¼šé«˜æ€§èƒ½çš„é—œéµSpring MVCçš„ç•°æ­¥æ¨¡å¼" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f202fbf6fd0a43cb8d76b7d03343ad4f><p class=pgc-img-caption></p></div><p>æœ€å¤§çš„ä¸åŒåœ¨æ–¼è«‹æ±‚è™•ç†ç·šç¨‹å°å¾Œè‡ºè™•ç†çš„èª¿ç”¨ä½¿ç”¨äº†â€œinvokeâ€çš„æ–¹å¼ï¼Œå°±æ˜¯èªªèª¿äº†ä¹‹å¾Œç›´æ¥è¿”å›ï¼Œè€Œä¸ç­‰å¾…ï¼Œé€™æ¨£è«‹æ±‚è™•ç†ç·šç¨‹å°±â€œè‡ªç”±â€äº†ï¼Œå®ƒå¯ä»¥æ¥è‘—å»è™•ç†åˆ¥çš„è«‹æ±‚ï¼Œç•¶å¾Œç«¯è™•ç†å®Œæˆå¾Œï¼Œæœƒé‰¤èµ·ä¸€å€‹å›èª¿è™•ç†ç·šç¨‹ä¾†è™•ç†èª¿ç”¨çš„çµæœï¼Œé€™å€‹å›èª¿è™•ç†ç·šç¨‹è·Ÿè«‹æ±‚è™•ç†ç·šç¨‹ä¹Ÿè¨±éƒ½æ˜¯ç·šç¨‹æ± ä¸­çš„æŸå€‹ç·šç¨‹ï¼Œç›¸äº’é–“å¯ä»¥å®Œå…¨æ²’æœ‰é—œä¿‚ï¼Œç”±é€™å€‹å›èª¿è™•ç†ç·šç¨‹å‘ç€è¦½å™¨è¿”å›å…§å®¹ã€‚<strong>é€™å°±æ˜¯ç•°æ­¥çš„éç¨‹ã€‚</strong></p><p>å¸¶ä¾†çš„æ”¹é€²æ˜¯é¡¯è€Œæ˜“è¦‹çš„ï¼Œè«‹æ±‚è™•ç†ç·šç¨‹ä¸éœ€è¦é˜»å¡äº†ï¼Œå®ƒçš„èƒ½åŠ›å¾—åˆ°äº†æ›´å……åˆ†çš„ä½¿ç”¨ï¼Œå¸¶ä¾†äº†æœå‹™å™¨ååèƒ½åŠ›çš„æå‡ã€‚</p><h1><strong>Spring MVCçš„ä½¿ç”¨â€”â€”DefferedResult</strong></h1><p>è¦ä½¿ç”¨Spring MVCçš„ç•°æ­¥åŠŸèƒ½ï¼Œä½ å¾—å…ˆç¢ºä¿ä½ ç”¨çš„æ˜¯Servlet 3.0æˆ–ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œ<strong>Mavenä¸­å¦‚æ­¤é…ç½®ï¼š</strong></p><pre> &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt; &lt;version&gt;3.1.0&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;4.2.3.RELEASE&lt;/version&gt; &lt;/dependency&gt;</pre><p>æˆ‘é€™è£¡ä½¿ç”¨çš„Servletç‰ˆæœ¬æ˜¯3.1.0ï¼ŒSpring MVCç‰ˆæœ¬æ˜¯4.2.3ï¼Œå»ºè­°ä½¿ç”¨æœ€æ–°çš„ç‰ˆæœ¬ã€‚</p><p>ç”±æ–¼Spring MVCçš„è‰¯å¥½å°è£ï¼Œç•°æ­¥åŠŸèƒ½ä½¿ç”¨èµ·ä¾†å‡ºå¥‡çš„ç°¡å–®ã€‚<strong>å‚³çµ±çš„åŒæ­¥æ¨¡å¼çš„Controlleræ˜¯è¿”å›ModelAndViewï¼Œè€Œç•°æ­¥æ¨¡å¼å‰‡æ˜¯è¿”å›DeferredResult&lt;ModelAndView></strong>ã€‚</p><p><strong>çœ‹é€™å€‹ä¾‹å­ï¼š</strong></p><pre>@RequestMapping(value="/asynctask", method = RequestMethod.GET)public DeferredResult&lt;ModelAndView&gt; asyncTask(){ DeferredResult&lt;ModelAndView&gt; deferredResult = new DeferredResult&lt;ModelAndView&gt;(); System.out.println("/asynctask èª¿ç”¨ï¼thread id is : " + Thread.currentThread().getId()); longTimeAsyncCallService.makeRemoteCallAndUnknownWhenFinish(new LongTermTaskCallback() { @Override public void callback(Object result) { System.out.println("ç•°æ­¥èª¿ç”¨åŸ·è¡Œå®Œæˆ, thread id is : " + Thread.currentThread().getId()); ModelAndView mav = new ModelAndView("remotecalltask"); mav.addObject("result", result); deferredResult.setResult(mav); } });}</pre><p>longTimeAsyncCallServiceæ˜¯æˆ‘å¯«çš„ä¸€å€‹æ¨¡æ“¬é•·æ™‚é–“ç•°æ­¥èª¿ç”¨çš„æœå‹™é¡ï¼Œèª¿ç”¨ä¹‹ï¼Œç«‹å³è¿”å›ï¼Œç•¶å®ƒè™•ç†å®Œæˆæ™‚å€™ï¼Œå°±é‰¤èµ·ä¸€å€‹ç·šç¨‹èª¿ç”¨æˆ‘å€‘æä¾›çš„å›èª¿å‡½æ•¸ï¼Œé€™è·Ÿâ€œåœ–3â€æè¿°çš„ä¸€æ¨£ï¼Œ<strong>å®ƒçš„ä»£ç¢¼å¦‚ä¸‹ï¼š</strong></p><pre>public interface LongTermTaskCallback { void callback(Object result);}public class LongTimeAsyncCallService { private final int CorePoolSize = 4; private final int NeedSeconds = 3; private Random random = new Random(); private ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(CorePoolSize); public void makeRemoteCallAndUnknownWhenFinish(LongTermTaskCallback callback){ System.out.println("å®Œæˆæ­¤ä»»å‹™éœ€è¦ : " + NeedSeconds + " ç§’"); scheduler.schedule(new Runnable() { @Override public void run() { callback.callback("é•·æ™‚é–“ç•°æ­¥èª¿ç”¨å®Œæˆ."); } }, "é€™æ˜¯è™•ç†çµæœ:)", TimeUnit.SECONDS); }}</pre><p><strong>è¼¸å‡ºçš„çµæœæ˜¯ï¼š</strong></p><blockquote><p>/asynctask èª¿ç”¨ï¼thread id is : 46</p><p>å®Œæˆæ­¤ä»»å‹™éœ€è¦ : 3 ç§’</p><p>ç•°æ­¥èª¿ç”¨åŸ·è¡Œå®Œæˆ, thread id is : 47</p></blockquote><p><strong>ç”±æ­¤å¯è¦‹è¿”å›çµæœçš„ç·šç¨‹å’Œè«‹æ±‚è™•ç†ç·šç¨‹ä¸æ˜¯åŒä¸€ç·šç¨‹ã€‚</strong></p><h1><strong>é‚„æœ‰å€‹å«WebAsyncTask</strong></h1><p>è¿”å›DefferedResult&lt;ModelAndView>ä¸¦éå”¯ä¸€åšæ³•ï¼Œé‚„å¯ä»¥è¿”å›WebAsyncTaskä¾†å¯¦ç¾â€œç•°æ­¥â€ï¼Œä½†ç•¥æœ‰ä¸åŒï¼Œä¸åŒä¹‹è™•åœ¨æ–¼è¿”å›WebAsyncTaskçš„è©±æ˜¯ä¸éœ€è¦æˆ‘å€‘ä¸»å‹•å»èª¿ç”¨Callbackçš„ï¼Œ<strong>çœ‹ä¾‹å­ï¼š</strong></p><pre>@RequestMapping(value="/longtimetask", method = RequestMethod.GET)public WebAsyncTask longTimeTask(){ System.out.println("/longtimetaskè¢«èª¿ç”¨ thread id is : " + Thread.currentThread().getId()); Callable&lt;ModelAndView&gt; callable = new Callable&lt;ModelAndView&gt;() { public ModelAndView call() throws Exception { Thread.sleep(3000); //å‡è¨­æ˜¯ä¸€äº›é•·æ™‚é–“ä»»å‹™ ModelAndView mav = new ModelAndView("longtimetask"); mav.addObject("result", "åŸ·è¡ŒæˆåŠŸ"); System.out.println("åŸ·è¡ŒæˆåŠŸ thread id is : " + Thread.currentThread().getId()); return mav; } }; return new WebAsyncTask(callable);}</pre><p>å…¶æ ¸å¿ƒæ˜¯ä¸€å€‹Callable&lt;ModelAndView>ï¼Œäº‹å¯¦ä¸Šï¼Œç›´æ¥è¿”å›Callable&lt;ModelAndView>éƒ½æ˜¯å¯ä»¥çš„ï¼Œä½†æˆ‘å€‘é€™è£¡åŒ…è£äº†ä¸€å±¤ï¼Œä»¥ä¾¿åšå¾Œé¢æåˆ°çš„â€œè¶…æ™‚è™•ç†â€ã€‚å’Œå‰ä¸€å€‹æ–¹æ¡ˆçš„å·®åˆ¥åœ¨æ–¼é€™å€‹Callableçš„callæ–¹æ³•ä¸¦ä¸æ˜¯æˆ‘å€‘ç›´æ¥èª¿ç”¨çš„ï¼Œè€Œæ˜¯åœ¨longTimeTaskè¿”å›å¾Œï¼Œç”±Spring MVCç”¨ä¸€å€‹å·¥ä½œç·šç¨‹ä¾†èª¿ç”¨ï¼ŒåŸ·è¡Œï¼Œ<strong>æ‰“å°å‡ºä¾†çš„çµæœï¼š</strong></p><blockquote><p>/longtimetaskè¢«èª¿ç”¨ thread id is : 56</p><p>åŸ·è¡ŒæˆåŠŸ thread id is : 57</p></blockquote><p>å¯è¦‹ç¢ºå¯¦ç”±ä¸åŒç·šç¨‹åŸ·è¡Œçš„ï¼Œä½†é€™å€‹WebAsyncTaskå¯ä¸å¤ªç¬¦åˆâ€œåœ–3â€æ‰€æè¿°çš„æŠ€è¡“è¦æ ¼ï¼Œå®ƒåƒ…åƒ…æ˜¯ç°¡å–®åœ°æŠŠè«‹æ±‚è™•ç†ç·šç¨‹çš„ä»»å‹™è½‰äº¤çµ¦å¦ä¸€å·¥ä½œç·šç¨‹è€Œå·²ã€‚</p><h1><strong>è™•ç†è¶…æ™‚</strong></h1><p>å¦‚æœâ€œé•·æ™‚é–“è™•ç†ä»»å‹™â€ä¸€ç›´æ²’è¿”å›ï¼Œé‚£æˆ‘å€‘ä¹Ÿä¸æ‡‰è©²è®“å®¢æˆ¶ç«¯ç„¡é™ç­‰ä¸‹å»å•Šï¼Œç¸½æ­¸è¦å¼„å€‹â€œè¶…æ™‚â€å‡ºä¾†ã€‚<strong>å¦‚åœ–ï¼š</strong></p><div class=pgc-img><img alt="javaç¨‹åºå“¡æ”¶è—ç³»åˆ—ï¼šé«˜æ€§èƒ½çš„é—œéµSpring MVCçš„ç•°æ­¥æ¨¡å¼" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/fa07cac856dd45969c24bf33e92212b7><p class=pgc-img-caption></p></div><p>å…¶å¯¦â€œè¶…æ™‚è™•ç†ç·šç¨‹â€å’Œâ€œå›èª¿è™•ç†ç·šç¨‹â€å¯èƒ½éƒ½æ˜¯ç·šç¨‹æ± ä¸­çš„æŸå€‹ç·šç¨‹ï¼Œæˆ‘ç‚ºäº†æ¸…æ™°é»æŠŠå®ƒå€‘åˆ†é–‹ç•«è€Œå·²ã€‚å¢åŠ é€™å€‹è¶…æ™‚è™•ç†åœ¨Spring MVCä¸­éå¸¸ç°¡å–®ï¼Œ<strong>å…ˆæ‹¿WebAsyncTaské‚£æ®µä»£ç¢¼ä¾†æ”¹ä¸€ä¸‹ï¼š</strong></p><pre>@RequestMapping(value="/longtimetask", method = RequestMethod.GET)public WebAsyncTask longTimeTask(){ System.out.println("/longtimetaskè¢«èª¿ç”¨ thread id is : " + Thread.currentThread().getId()); Callable&lt;ModelAndView&gt; callable = new Callable&lt;ModelAndView&gt;() { public ModelAndView call() throws Exception { Thread.sleep(3000); //å‡è¨­æ˜¯ä¸€äº›é•·æ™‚é–“ä»»å‹™ ModelAndView mav = new ModelAndView("longtimetask"); mav.addObject("result", "åŸ·è¡ŒæˆåŠŸ"); System.out.println("åŸ·è¡ŒæˆåŠŸ thread id is : " + Thread.currentThread().getId()); return mav; } };   WebAsyncTask asyncTask = new WebAsyncTask(2000, callable); asyncTask.onTimeout( new Callable&lt;ModelAndView&gt;() { public ModelAndView call() throws Exception { ModelAndView mav = new ModelAndView("longtimetask"); mav.addObject("result", "åŸ·è¡Œè¶…æ™‚"); System.out.println("åŸ·è¡Œè¶…æ™‚ thread id is ï¼š" + Thread.currentThread().getId()); return mav; } } ); return new WebAsyncTask(3000, callable);}</pre><p>æ³¨æ„çœ‹ç´…è‰²å­—é«”éƒ¨åˆ†ä»£ç¢¼ï¼Œé€™å°±æ˜¯å‰é¢æåˆ°çš„ç‚ºä»€éº¼Callableé‚„è¦å¤–åŒ…ä¸€å±¤çš„ç·£æ•…ï¼Œçµ¦WebAsyncTaskè¨­ç½®ä¸€å€‹è¶…æ™‚å›èª¿ï¼Œå³å¯å¯¦ç¾è¶…æ™‚è™•ç†ï¼Œåœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œæ­£å¸¸è™•ç†éœ€è¦3ç§’é˜ï¼Œè€Œè¶…æ™‚è¨­ç½®ç‚º2ç§’ï¼Œæ‰€ä»¥è‚¯å®šæœƒå‡ºç¾è¶…æ™‚ï¼Œ<strong>åŸ·è¡Œæ‰“å°logå¦‚ä¸‹ï¼š</strong></p><blockquote><p>/longtimetaskè¢«èª¿ç”¨ thread id is : 59</p><p>åŸ·è¡Œè¶…æ™‚ thread id is ï¼š61</p><p>åŸ·è¡ŒæˆåŠŸ thread id is : 80</p></blockquote><p>å—¯ï¼Ÿæ˜æ˜è¶…æ™‚äº†ï¼Œæ€éº¼é‚„æœƒâ€œåŸ·è¡ŒæˆåŠŸâ€å‘¢ï¼Ÿè¶…æ™‚æ­¸è¶…æ™‚ï¼Œè¶…æ™‚ä¸¦ä¸æœƒæ‰“æ–·æ­£å¸¸åŸ·è¡Œæµç¨‹ï¼Œä½†æ³¨æ„ï¼Œå‡ºç¾è¶…æ™‚å¾Œæˆ‘å€‘çµ¦å®¢æˆ¶ç«¯è¿”å›äº†â€œè¶…æ™‚â€çš„çµæœï¼Œé‚£æ¥ä¸‹ä¾†å³ä¾¿æ­£å¸¸è™•ç†æµç¨‹æˆåŠŸï¼Œå®¢æˆ¶ç«¯ä¹Ÿæ”¶ä¸åˆ°æ­£å¸¸è™•ç†æˆåŠŸæ‰€ç”¢ç”Ÿçš„çµæœäº†ï¼Œé€™å¸¶ä¾†çš„å•é¡Œå°±æ˜¯ï¼šå®¢æˆ¶ç«¯çœ‹åˆ°äº†â€œè¶…æ™‚â€ï¼Œå¯¦éš›ä¸Šæ“ä½œåˆ°åº•æœ‰æ²’æœ‰æˆåŠŸï¼Œå®¢æˆ¶ç«¯ä¸¦ä¸çŸ¥é“ï¼Œä½†é€šå¸¸é€™ä¹Ÿä¸æ˜¯ä»€éº¼å¤§å•é¡Œï¼Œå› ç‚ºç”¨æˆ¶åœ¨ç€è¦½å™¨ä¸Šå†åˆ·æ–°ä¸€ä¸‹å°±å¥½äº†ã€‚:D</p><p>å¥½ï¼Œ<strong>å†ä¾†çœ‹DefferedResultæ–¹å¼çš„è¶…æ™‚è™•ç†ï¼š</strong></p><pre> @RequestMapping(value = "/asynctask", method = RequestMethod.GET) public DeferredResult&lt;ModelAndView&gt; asyncTask() { DeferredResult&lt;ModelAndView&gt; deferredResult = new DeferredResult&lt;ModelAndView&gt;(2000L); System.out.println("/asynctask èª¿ç”¨ï¼thread id is : " + Thread.currentThread().getId()); longTimeAsyncCallService.makeRemoteCallAndUnknownWhenFinish(new LongTermTaskCallback() { @Override public void callback(Object result) { System.out.println("ç•°æ­¥èª¿ç”¨åŸ·è¡Œå®Œæˆ, thread id is : " + Thread.currentThread().getId()); ModelAndView mav = new ModelAndView("remotecalltask"); mav.addObject("result", result); deferredResult.setResult(mav); } }); deferredResult.onTimeout(new Runnable() { @Override public void run() { System.out.println("ç•°æ­¥èª¿ç”¨åŸ·è¡Œè¶…æ™‚ï¼thread id is : " + Thread.currentThread().getId()); ModelAndView mav = new ModelAndView("remotecalltask"); mav.addObject("result", "ç•°æ­¥èª¿ç”¨åŸ·è¡Œè¶…æ™‚"); deferredResult.setResult(mav); } }); return deferredResult; }</pre><p>éå¸¸é¡ä¼¼ï¼Œå°å§ï¼Œæˆ‘æŠŠè¶…æ™‚è¨­ç½®ç‚º2ç§’ï¼Œè€Œæ­£å¸¸è™•ç†éœ€è¦3ç§’ï¼Œä¸€å®šæœƒè¶…æ™‚ï¼Œ<strong>åŸ·è¡Œçµæœå¦‚ä¸‹ï¼š</strong></p><blockquote><p>/asynctask èª¿ç”¨ï¼thread id is : 48</p><p>å®Œæˆæ­¤ä»»å‹™éœ€è¦ : 3 ç§’</p><p>ç•°æ­¥èª¿ç”¨åŸ·è¡Œè¶…æ™‚ï¼thread id is : 51</p><p>ç•°æ­¥èª¿ç”¨åŸ·è¡Œå®Œæˆ, thread id is : 49</p></blockquote><p>å®Œå…¨åœ¨æˆ‘å€‘é æ–™ä¹‹ä¸­ã€‚</p><h1><strong>ç•°å¸¸è™•ç†</strong></h1><p>è²Œä¼¼æ²’ä»€éº¼å·®åˆ¥ï¼Œåœ¨Controllerä¸­çš„è™•ç†å’Œä¹‹å‰åŒæ­¥æ¨¡å¼çš„è™•ç†æ˜¯ä¸€æ¨£ä¸€æ¨£çš„ï¼š</p><pre> @ExceptionHandler(Exception.class) public ModelAndView handleAllException(Exception ex) { ModelAndView model = new ModelAndView("error"); model.addObject("result", ex.getMessage()); return model; }</pre><p>é‚„è¦å†å¼„å€‹å…¨å±€çš„ç•°å¸¸è™•ç†å•¥çš„ï¼Œå’Œéå»çš„åšæ³•éƒ½ä¸€æ¨£ï¼Œåœ¨æ­¤ä¸è¡¨äº†ã€‚</p><p>æˆ‘é€™è£¡æœ‰æ‰‹å¯«SpringMVCçš„æ¶æ§‹è¦–é »ï¼Œ<strong>éœ€è¦çš„è©±å¯ä»¥é€šéä»¥ä¸‹æ–¹å¼ç²å–ï¼š</strong></p><div class=pgc-img><img alt="javaç¨‹åºå“¡æ”¶è—ç³»åˆ—ï¼šé«˜æ€§èƒ½çš„é—œéµSpring MVCçš„ç•°æ­¥æ¨¡å¼" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2f0ca7b2dbb84f84ba331f59e14e52d8><p class=pgc-img-caption></p></div><blockquote><p><strong>é—œæ³¨æˆ‘ï¼Œè½‰ç™¼æ–‡ç« ï¼Œè¨˜ä½ï¼Œä¸€å®šè¦è½‰ç™¼æ–‡ç« ï¼Œç„¶å¾Œ</strong>åŠ å…¥æˆ‘çš„äº¤æµç¾¤ï¼š805685193 <strong>ç®¡ç†å“¡è™•å…è²»ç²å–</strong></p></blockquote></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>java</a></li><li><a>é—œéµ</a></li><li><a>Spring</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/000afa08.html alt="Spring Boot 2.xåŸºç¤æ•™ç¨‹ï¼šSwaggeræ¥å£åˆ†é¡èˆ‡å„å…ƒç´ æ’åºå•é¡Œè©³è§£" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/daa2cfd29ec34306a4be6f3f257b824b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/000afa08.html title="Spring Boot 2.xåŸºç¤æ•™ç¨‹ï¼šSwaggeræ¥å£åˆ†é¡èˆ‡å„å…ƒç´ æ’åºå•é¡Œè©³è§£">Spring Boot 2.xåŸºç¤æ•™ç¨‹ï¼šSwaggeræ¥å£åˆ†é¡èˆ‡å„å…ƒç´ æ’åºå•é¡Œè©³è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6cfd4e0e.html alt="Spring æ ¸å¿ƒçŸ¥è­˜è¬›è§£ï¼Œå¤ªç°¡å–®å•¦" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6cfd4e0e.html title="Spring æ ¸å¿ƒçŸ¥è­˜è¬›è§£ï¼Œå¤ªç°¡å–®å•¦">Spring æ ¸å¿ƒçŸ¥è­˜è¬›è§£ï¼Œå¤ªç°¡å–®å•¦</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/090306a0.html alt="[Spring] æ·±å…¥ç­è§£äº‹å‹™åŸç†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/a8c6dbd7c51741f5a76262e8e2c7a670 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/090306a0.html title="[Spring] æ·±å…¥ç­è§£äº‹å‹™åŸç†">[Spring] æ·±å…¥ç­è§£äº‹å‹™åŸç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/69818103.html alt=javaç›¸é—œçŸ¥è­˜(10)ç¸½çµ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/84649e6ba0f8442a8b10584403bf6635 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/69818103.html title=javaç›¸é—œçŸ¥è­˜(10)ç¸½çµ>javaç›¸é—œçŸ¥è­˜(10)ç¸½çµ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fb2bc471.html alt="ã€Œè­¯ã€ Spring çš„åˆ†ä½ˆå¼äº‹å‹™å¯¦ç¾â€”ä½¿ç”¨å’Œä¸ä½¿ç”¨ XAâ€”ç¬¬äºŒéƒ¨åˆ†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fb2bc471.html title="ã€Œè­¯ã€ Spring çš„åˆ†ä½ˆå¼äº‹å‹™å¯¦ç¾â€”ä½¿ç”¨å’Œä¸ä½¿ç”¨ XAâ€”ç¬¬äºŒéƒ¨åˆ†">ã€Œè­¯ã€ Spring çš„åˆ†ä½ˆå¼äº‹å‹™å¯¦ç¾â€”ä½¿ç”¨å’Œä¸ä½¿ç”¨ XAâ€”ç¬¬äºŒéƒ¨åˆ†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1678b1c4.html alt=ï¼ˆæ”¶è—ï¼‰Springäº‹å‹™å°ˆé¡Œï¼šäº‹å‹™çš„åŸºæœ¬æ¦‚å¿µï¼ŒMysqläº‹å‹™è™•ç†åŸç† class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/433259b5-1936-4cee-ab74-70aef36536ee style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1678b1c4.html title=ï¼ˆæ”¶è—ï¼‰Springäº‹å‹™å°ˆé¡Œï¼šäº‹å‹™çš„åŸºæœ¬æ¦‚å¿µï¼ŒMysqläº‹å‹™è™•ç†åŸç†>ï¼ˆæ”¶è—ï¼‰Springäº‹å‹™å°ˆé¡Œï¼šäº‹å‹™çš„åŸºæœ¬æ¦‚å¿µï¼ŒMysqläº‹å‹™è™•ç†åŸç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d3c48fcc.html alt=Springè²æ˜å¼äº‹å‹™è™•ç†çš„å¯¦ç¾åŸç†ï¼Œä¾†è‡ªé¢è©¦å®˜çš„çª®è¿½æ‹·å• class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d3c48fcc.html title=Springè²æ˜å¼äº‹å‹™è™•ç†çš„å¯¦ç¾åŸç†ï¼Œä¾†è‡ªé¢è©¦å®˜çš„çª®è¿½æ‹·å•>Springè²æ˜å¼äº‹å‹™è™•ç†çš„å¯¦ç¾åŸç†ï¼Œä¾†è‡ªé¢è©¦å®˜çš„çª®è¿½æ‹·å•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/02729303.html alt=javaå¯¦æˆ°é …ç›®å¸¸ç”¨é¡ï¼ŒDateã€Calendarã€BigDecimalã€Mathã€UUID class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d69c7c9d8b85444da9360e334ba6555d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/02729303.html title=javaå¯¦æˆ°é …ç›®å¸¸ç”¨é¡ï¼ŒDateã€Calendarã€BigDecimalã€Mathã€UUID>javaå¯¦æˆ°é …ç›®å¸¸ç”¨é¡ï¼ŒDateã€Calendarã€BigDecimalã€Mathã€UUID</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5f8b26e0.html alt=å¤šæ…‹çš„æœ¬è³ªï¼Œjavaå‹•æ…‹ç¶å®š class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/50ac000493fbc8532b5e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5f8b26e0.html title=å¤šæ…‹çš„æœ¬è³ªï¼Œjavaå‹•æ…‹ç¶å®š>å¤šæ…‹çš„æœ¬è³ªï¼Œjavaå‹•æ…‹ç¶å®š</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2ea7884b.html alt=javaç¨‹åºå“¡æ³¨æ„ï¼šå°‘æœ‰äººçŸ¥çš„å“ˆå¸Œè¡çªè§£æ±ºç­–ç•¥ï¼Œå­¸åˆ°å°±æ˜¯è³ºåˆ° class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/54d45b20ef6a4a3f960411db61474538 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2ea7884b.html title=javaç¨‹åºå“¡æ³¨æ„ï¼šå°‘æœ‰äººçŸ¥çš„å“ˆå¸Œè¡çªè§£æ±ºç­–ç•¥ï¼Œå­¸åˆ°å°±æ˜¯è³ºåˆ°>javaç¨‹åºå“¡æ³¨æ„ï¼šå°‘æœ‰äººçŸ¥çš„å“ˆå¸Œè¡çªè§£æ±ºç­–ç•¥ï¼Œå­¸åˆ°å°±æ˜¯è³ºåˆ°</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/56c317a5.html alt=ç§‘æ™®æ–‡ï¼šç¥ç¥•çš„æ±™æ°´è™•ç†æµç¨‹ï¼Œéƒ½æœ‰å“ªäº›é—œéµæ­¥é©Ÿå‘¢ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7113d7e544d14241957a3996c2bec8b0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/56c317a5.html title=ç§‘æ™®æ–‡ï¼šç¥ç¥•çš„æ±™æ°´è™•ç†æµç¨‹ï¼Œéƒ½æœ‰å“ªäº›é—œéµæ­¥é©Ÿå‘¢ï¼Ÿ>ç§‘æ™®æ–‡ï¼šç¥ç¥•çš„æ±™æ°´è™•ç†æµç¨‹ï¼Œéƒ½æœ‰å“ªäº›é—œéµæ­¥é©Ÿå‘¢ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d86b1a6d.html alt=æ‰‹æ©Ÿé¡¯ç¤ºå±é—œéµææ–™æˆæœ¬é™äº†ï¼Œæ±™æŸ“è¼•äº† class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1531616443789c3e2d32478 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d86b1a6d.html title=æ‰‹æ©Ÿé¡¯ç¤ºå±é—œéµææ–™æˆæœ¬é™äº†ï¼Œæ±™æŸ“è¼•äº†>æ‰‹æ©Ÿé¡¯ç¤ºå±é—œéµææ–™æˆæœ¬é™äº†ï¼Œæ±™æŸ“è¼•äº†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bf248ef5.html alt=2018å¹´æ”¶è—å’Œç”°ç‰æœ€æ–°é—œéµè©â€”â€”ç·šä¸Šäº¤æ˜“ï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/54000003fda0ced1dd2b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bf248ef5.html title=2018å¹´æ”¶è—å’Œç”°ç‰æœ€æ–°é—œéµè©â€”â€”ç·šä¸Šäº¤æ˜“ï¼>2018å¹´æ”¶è—å’Œç”°ç‰æœ€æ–°é—œéµè©â€”â€”ç·šä¸Šäº¤æ˜“ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/76b97e91.html alt=å…ˆèšäººå†è«‡äº¤æ˜“ï¼Œâ€œç¤¾å€â€æ˜¯ç››ä¸–æ”¶è—åå¹´ä¾†çš„é—œéµè© class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/6778/2898233604 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/76b97e91.html title=å…ˆèšäººå†è«‡äº¤æ˜“ï¼Œâ€œç¤¾å€â€æ˜¯ç››ä¸–æ”¶è—åå¹´ä¾†çš„é—œéµè©>å…ˆèšäººå†è«‡äº¤æ˜“ï¼Œâ€œç¤¾å€â€æ˜¯ç››ä¸–æ”¶è—åå¹´ä¾†çš„é—œéµè©</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/19cbd4c3.html alt="java å¸¸ç”¨çš„æ­£å‰‡è¡¨é”å¼" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1540129072390e6c4c05126 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/19cbd4c3.html title="java å¸¸ç”¨çš„æ­£å‰‡è¡¨é”å¼">java å¸¸ç”¨çš„æ­£å‰‡è¡¨é”å¼</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>