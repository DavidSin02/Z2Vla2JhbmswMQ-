<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>5分鐘！用Java實現目標檢測 | PyTorch | 极客快訊</title><meta property="og:title" content="5分鐘！用Java實現目標檢測 | PyTorch - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/bcf4256f45fe4ac29cbc234e7f84961c"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7771d40.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7771d40.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/7771d40.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7771d40.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7771d40.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/7771d40.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/7771d40.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7771d40.html><meta property="article:published_time" content="2020-10-29T21:04:31+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:31+08:00"><meta name=Keywords content><meta name=description content="5分鐘！用Java實現目標檢測 | PyTorch"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/7771d40.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>5分鐘！用Java實現目標檢測 | PyTorch</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><blockquote class=pgc-blockquote-abstract><p>魚羊 編輯整理<br>量子位 報道 | 公眾號 QbitAI</p></blockquote><p>編者按：作為一個Java開發者，你是否曾為在PyTorch上部署模型而苦惱？這篇來自AWS軟件工程師的投稿，結合實例，詳細介紹了DJL這個為Java開發者設計的深度學習庫：5分鐘，你就能在PyTorch上，用Java實現目標檢測。</p><h1 class=pgc-h-arrow-right><strong>5分鐘，用Java實現目標檢測</strong></h1><p>文 / 知乎用戶@Lanking</p><div class=pgc-img><img alt="5分鐘！用Java實現目標檢測 | PyTorch" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/bcf4256f45fe4ac29cbc234e7f84961c><p class=pgc-img-caption></p></div><p>PyTorch在深度學習領域中的應用日趨廣泛，得益於它獨到的設計。無論是數據的並行處理還是動態計算圖，一切都為Python做出了很多簡化。很多論文都選擇使用PyTorch去實現也證明了它在訓練方面的效率以及易用性。</p><p>在PyTorch領域，儘管部署一個模型有很多選擇，可為Java開發人員準備的選項卻屈指可數。</p><p>在過去，用戶可以用PyTorch C++ 寫JNI (Java Native Interface) 來實現這個過程。最近，PyTorch 1.4 也發佈了試驗性的Java 前端。</p><p>可是這兩種解決方案都沒有辦法能讓Java開發者很好的使用：用戶需要從易於使用和易於維護中二選一。</p><p>針對於這個問題，亞馬遜雲服務 (AWS)開源了 Deep Java Library (DJL)，一個為Java開發者設計的深度學習庫。它兼顧了易用性和可維護性，一切運行效率以及內存管理問題都得到了很好的處理。</p><p>DJL使用起來異常簡單。只需幾行代碼，用戶就可以輕鬆部署深度學習模型用作推理。那麼我們就開始上手用DJL部署一個PyTorch 模型吧。</p><h1 class=pgc-h-arrow-right><strong>前期準備</strong></h1><p>用戶可以輕鬆使用maven或者gradle等Java常用配置管理包來引用DJL。下面是一個示例：</p><pre><code>plugins {    id 'java'}repositories {                               jcenter()}dependencies {    implementation "ai.djl:api:0.4.0"    implementation "ai.djl:repository:0.4.0"    runtimeOnly "ai.djl.pytorch:pytorch-model-zoo:0.4.0"    runtimeOnly "ai.djl.pytorch:pytorch-native-auto:1.4.0"}</code></pre><p>然後只需gradle build，基本配置就大功告成了。</p><h1 class=pgc-h-arrow-right><strong>開始部署模型</strong></h1><p>我們用到的目標檢測模型來源於NVIDIA在torchhub發佈的預訓練模型。我們用下面這張圖來推理幾個可以識別的物體（狗，自行車以及皮卡）。</p><div class=pgc-img><img alt="5分鐘！用Java實現目標檢測 | PyTorch" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c19cb712daf84647a5199748aa8de011><p class=pgc-img-caption></p></div><p>可以通過下面的代碼來實現推理的過程：</p><pre><code>public static void main(String[] args) throws IOException, ModelException, TranslateException {    String url = "https://github.com/awslabs/djl/raw/master/examples/src/test/resources/dog_bike_car.jpg";    BufferedImage img = BufferedImageUtils.fromUrl(url);    Criteria&lt;BufferedImage, DetectedObjects&gt; criteria =            Criteria.builder()                    .optApplication(Application.CV.OBJECT_DETECTION)                    .setTypes(BufferedImage.class, DetectedObjects.class)                    .optFilter("backbone", "resnet50")                    .optProgress(new ProgressBar())                    .build();    try (ZooModel&lt;BufferedImage, DetectedObjects&gt; model = ModelZoo.loadModel(criteria)) {        try (Predictor&lt;BufferedImage, DetectedObjects&gt; predictor = model.newPredictor()) {            DetectedObjects detection = predictor.predict(img);            System.out.println(detection);        }    }}</code></pre><p>然後，就結束了。相比於其他解決方案動輒上百行的代碼，DJL把所有過程簡化到了不到30行完成。那麼我們看看輸出的結果:</p><pre><code>[    class: "dog", probability: 0.96709, bounds: [x=0.165, y=0.348, width=0.249, height=0.539]    class: "bicycle", probability: 0.66796, bounds: [x=0.152, y=0.244, width=0.574, height=0.562]    class: "truck", probability: 0.64912, bounds: [x=0.609, y=0.132, width=0.284, height=0.166]]</code></pre><p>你也可以用我們目標檢測圖形化API來看一下實際的檢測效果：</p><div class=pgc-img><img alt="5分鐘！用Java實現目標檢測 | PyTorch" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/a70b5cf56afa43978d5c48e768dffef5><p class=pgc-img-caption></p></div><p>你也許會說，這些代碼都包裝的過於厲害，真正的小白該如何上手呢？</p><p>讓我們仔細的看一下剛才的那段代碼：</p><pre><code> // 讀取一張圖片    String url = "https://github.com/awslabs/djl/raw/master/examples/src/test/resources/dog_bike_car.jpg";    BufferedImage img = BufferedImageUtils.fromUrl(url);    // 創建一個模型的尋找標準    Criteria&lt;BufferedImage, DetectedObjects&gt; criteria =            Criteria.builder()                    // 設置應用類型：目標檢測                    .optApplication(Application.CV.OBJECT_DETECTION)                    // 確定輸入輸出類型 （使用默認的圖片處理工具）                    .setTypes(BufferedImage.class, DetectedObjects.class)                    // 模型的過濾條件                    .optFilter("backbone", "resnet50")                    .optProgress(new ProgressBar())                    .build();    // 創建一個模型對象    try (ZooModel&lt;BufferedImage, DetectedObjects&gt; model = ModelZoo.loadModel(criteria)) {        // 創建一個推理對象        try (Predictor&lt;BufferedImage, DetectedObjects&gt; predictor = model.newPredictor()) {            // 推理            DetectedObjects detection = predictor.predict(img);            System.out.println(detection);        }    }</code></pre><p>這樣是不是清楚了很多？DJL建立了一個模型庫(ModelZoo)的概念，引入了來自於GluonCV, TorchHub, Keras 預訓練模型, huggingface自然語言處理模型等70多個模型。所有的模型都可以一鍵導入，用戶只需要使用默認或者自己寫的輸入輸出工具就可以實現輕鬆的推理。我們還在不斷的添加各種預訓練模型。</p><h1 class=pgc-h-arrow-right><strong>瞭解DJL</strong></h1><div class=pgc-img><img alt="5分鐘！用Java實現目標檢測 | PyTorch" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/dd0c4e1fb92d419ca5e3df4daa418075><p class=pgc-img-caption></p></div><p>DJL是亞馬遜雲服務在2019年re:Invent大會推出的專為Java開發者量身定製的深度學習框架，現已運行在亞馬遜數以百萬的推理任務中。</p><p>如果要總結DJL的主要特色，那麼就是如下三點：</p><ul><li>DJL不設限制於後端引擎：用戶可以輕鬆的使用 MXNet, PyTorch, TensorFlow和fastText來在Java上做模型訓練和推理。</li><li>DJL的算子設計無限趨近於numpy：它的使用體驗上和numpy基本是無縫的，切換引擎也不會造成結果改變。</li><li>DJL優秀的內存管理以及效率機制：DJL擁有自己的資源回收機制，100個小時連續推理也不會內存溢出。</li></ul><p>James Gosling (Java 創始人) 在使用後給出了讚譽:</p><div class=pgc-img><img alt="5分鐘！用Java實現目標檢測 | PyTorch" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c4163ef0a97842fb875cd85e93ac7583><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><strong>對於PyTorch的支持</strong></h1><p>DJL現已支持PyTorch 1.5。我們深度整合了PyTorch C++ API，開發了一套JNI提供Java的底層支持。DJL提供各類PyTorch原生算子算法，現在支持所有的 TorchScript模型。</p><p>現在可以在 Mac/Linux/Windows全平臺運行DJL PyTorch。DJL具有自檢測CUDA版本的功能，也會自動採用對應的CUDA版本包來運行gpu任務。</p><p>想了解更多，請參見下面幾個鏈接：https://djl.aihttps://github.com/awslabs/djl</p><p>也歡迎加入我們slack論壇：https://app.slack.com/client/TPX8YGQTW</p><p>— 完 —</p><p style=text-align:start>量子位 QbitAI · 頭條號簽約作者</p><p style=text-align:start>關注我們，第一時間獲知前沿科技動態</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>分鐘</a></li><li><a>Java</a></li><li><a>實現</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/cf633068.html alt="Java 多態的實現機制，看了都說好" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9d3b0e55813d46b4982ae7d9b81d1802 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cf633068.html title="Java 多態的實現機制，看了都說好">Java 多態的實現機制，看了都說好</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c78b6d52.html alt=8分鐘看完，徹底掌握Java正則表達式的十大問題 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/14ae145d-0620-476a-8a82-7912b192e9b5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c78b6d52.html title=8分鐘看完，徹底掌握Java正則表達式的十大問題>8分鐘看完，徹底掌握Java正則表達式的十大問題</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/44cdc077.html alt=Java如何實現自動關閉資源？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9f24b68095db4b80b744910d2b5cced6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/44cdc077.html title=Java如何實現自動關閉資源？>Java如何實現自動關閉資源？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7d792b58.html alt=Java實現遠程服務生產與消費(RPC)的4種方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/856837d3a1b446dbbeb16994e9ed19da style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7d792b58.html title=Java實現遠程服務生產與消費(RPC)的4種方法>Java實現遠程服務生產與消費(RPC)的4種方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2a836fe1.html alt=Java編程技巧：如何實現參數的輸入輸出？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b36247aabf154a46aca31b642fc3cd0c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2a836fe1.html title=Java編程技巧：如何實現參數的輸入輸出？>Java編程技巧：如何實現參數的輸入輸出？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/891a2ed3.html alt=技術點滴：實現Java父類強制轉換子類的原則 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1539014984935468692050e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/891a2ed3.html title=技術點滴：實現Java父類強制轉換子類的原則>技術點滴：實現Java父類強制轉換子類的原則</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ea69ab1.html alt=Java可重入讀寫鎖實現：ReentrantReadWriteLock class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/87955ae16a9a4013b7b4ec6a387656f5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ea69ab1.html title=Java可重入讀寫鎖實現：ReentrantReadWriteLock>Java可重入讀寫鎖實現：ReentrantReadWriteLock</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/325007f.html alt="教你如何用 Java 實現異步調用" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/325007f.html title="教你如何用 Java 實現異步調用">教你如何用 Java 實現異步調用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9e89bbd.html alt=22、Java實現多態的機制 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6b65bd7dfb1c428c87904b93b9587c07 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9e89bbd.html title=22、Java實現多態的機制>22、Java實現多態的機制</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1d5ee81.html alt=Java多態的實現機制是什麼，看完你就知道（值得收藏） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/ae124314-674a-47ca-b794-c5b32a309a66 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1d5ee81.html title=Java多態的實現機制是什麼，看完你就知道（值得收藏）>Java多態的實現機制是什麼，看完你就知道（值得收藏）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1db9a93.html alt="1分鐘實現：按某列內容分類彙總，分頁打印 Excel 表格" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/c8fd3358f14c45749064bd5b2bd17f2e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1db9a93.html title="1分鐘實現：按某列內容分類彙總，分頁打印 Excel 表格">1分鐘實現：按某列內容分類彙總，分頁打印 Excel 表格</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/93727dba.html alt="技術帖 | 3分鐘搞定各種測試分析技術" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/f055e0a4477240088de2abb7cd696cfa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/93727dba.html title="技術帖 | 3分鐘搞定各種測試分析技術">技術帖 | 3分鐘搞定各種測試分析技術</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ac25d2d0.html alt=30分鐘教你搭建一個網站（一）：購買和配置服務器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/5f26f1582a564e93bde33a7dd9448c3b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ac25d2d0.html title=30分鐘教你搭建一個網站（一）：購買和配置服務器>30分鐘教你搭建一個網站（一）：購買和配置服務器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/50218ed7.html alt=5分鐘教你搭建自己的服務器和解析域名 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/733737e9f0714b50b7164eb128f72341 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/50218ed7.html title=5分鐘教你搭建自己的服務器和解析域名>5分鐘教你搭建自己的服務器和解析域名</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/602bcbcd.html alt="每天這樣陪玩 10 分鐘，勝過上萬元早教班" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RlIqLlfA7COpuB style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/602bcbcd.html title="每天這樣陪玩 10 分鐘，勝過上萬元早教班">每天這樣陪玩 10 分鐘，勝過上萬元早教班</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>