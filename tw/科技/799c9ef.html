<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Python 七步捉蟲法 | 极客快訊</title><meta property="og:title" content="Python 七步捉蟲法 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/6873f40bbe694e17a51e13270492ad24"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/799c9ef.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/799c9ef.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/799c9ef.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/799c9ef.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/799c9ef.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/799c9ef.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/799c9ef.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/799c9ef.html><meta property="article:published_time" content="2020-10-29T21:05:31+08:00"><meta property="article:modified_time" content="2020-10-29T21:05:31+08:00"><meta name=Keywords content><meta name=description content="Python 七步捉蟲法"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/799c9ef.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Python 七步捉蟲法</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><div class=pgc-img><img alt="Python 七步捉蟲法" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6873f40bbe694e17a51e13270492ad24><p class=pgc-img-caption></p></div><p>瞭解一些技巧助你減少代碼查錯時間。</p><p>-- Maria Mckinley</p><p>在週五的下午三點鐘（為什麼是這個時間？因為事情總會在週五下午三點鐘發生），你收到一條通知，客戶發現你的軟件出現一個錯誤。在有了初步的懷疑後，你聯繫運維，查看你的軟件日誌以瞭解發生了什麼，因為你記得收到過日誌已經搬家了的通知。</p><p>結果這些日誌被轉移到了你獲取不到的地方，但它們正在導入到一個網頁應用中——所以到時候你可以用這個漂亮的應用來檢索日誌，但是，這個應用現在還沒完成。這個應用預計會在幾天內完成。我知道，你覺得這完全不切實際。然而並不是，日誌或者日誌消息似乎經常在錯誤的時間消失不見。在我們開始查錯前，一個忠告：經常檢查你的日誌以確保它們還在你認為它們應該在的地方，並記錄你認為它們應該記的東西。當你不注意的時候，這些東西往往會發生令人驚訝的變化。</p><p>好的，你找到了日誌或者嘗試了呼叫運維人員，而客戶確實發現了一個錯誤。甚至你可能認為你已經知道錯誤在哪兒。</p><p>你立即打開你認為可能有問題的文件並開始查錯。</p><h1 class=ql-align-center>1、先不要碰你的代碼</h1><p>閱讀代碼，你甚至可能會想到該閱讀哪些部分。但是在開始搞亂你的代碼前，請重現導致錯誤的調用並把它變成一個測試。這將是一個集成測試，因為你可能還有其他疑問，目前你還不能準確地知道問題在哪兒。</p><p>確保這個測試結果是失敗的。這很重要，因為有時你的測試不能重現失敗的調用，尤其是你使用了可以混淆測試的 web 或者其他框架。很多東西可能被存儲在變量中，但遺憾的是，只通過觀察測試，你在測試裡調用的東西並不總是明顯可見的。當我嘗試著重現這個失敗的調用時，我並不是說我要創建一個可以通過的測試，但是，好吧，我確實是創建了一個測試，但我不認為這特別不尋常。</p><blockquote><p>從自己的錯誤中吸取教訓。</p></blockquote><h1 class=ql-align-center>2、編寫錯誤的測試</h1><p>現在，你有了一個失敗的測試，或者可能是一個帶有錯誤的測試，那麼是時候解決問題了。但是在你開幹之前，讓我們先檢查下調用棧，因為這樣可以更輕鬆地解決問題。</p><p>調用棧包括你已經啟動但尚未完成地所有任務。因此，比如你正在烤蛋糕並準備往麵糊里加麵粉，那你的調用棧將是：</p><ul><li>做蛋糕</li><li>打麵糊</li><li>加麵粉</li></ul><p>你已經開始做蛋糕，開始打麵糊，而你現在正在加麵粉。往鍋底抹油不在這個列表中，因為你已經完成了，而做糖霜不在這個列表上因為你還沒開始做。</p><p>如果你對調用棧不清楚，我強烈建議你使用 Python Tutor ，它能幫你在執行代碼時觀察調用棧。</p><p>現在，如果你的 Python 程序出現了錯誤， Python 解釋器會幫你打印出當前調用棧。這意味著無論那一時刻程序在做什麼，很明顯錯誤發生在調用棧的底部。</p><h1 class=ql-align-center>3、始終先檢查調用棧底部</h1><p>在棧底你不僅能看到發生了哪個錯誤，而且通常可以在調用棧的最後一行發現問題。如果棧底對你沒有幫助，而你的代碼還沒有經過代碼分析，那麼使用代碼分析是非常有用的。我推薦 pylint 或者 flake8。通常情況下，它會指出我一直忽略的錯誤的地方。</p><p>如果錯誤看起來很迷惑，你下一步行動可能是用 Google 搜索它。如果你搜索的內容不包含你的代碼的相關信息，如變量名、文件等，那你將獲得更好的搜索結果。如果你使用的是 Python 3（你應該使用它），那麼搜索內容包含 Python 3 是有幫助的，否則 Python 2 的解決方案往往會佔據大多數。</p><p>很久以前，開發者需要在沒有搜索引擎的幫助下解決問題。那是一段黑暗時光。充分利用你可以使用的所有工具。</p><p>不幸的是，有時候問題發生在更早階段，但只有在調用棧底部執行的地方才顯現出來。就像當蛋糕沒有膨脹時，忘記加發酵粉的事才被發現。</p><p>那就該檢查整個調用棧。問題更可能在你的代碼而不是 Python 標準庫或者第三方包，所以先檢查調用棧內你的代碼。另外，在你的代碼中放置斷點通常會更容易檢查代碼。在調用棧的代碼中放置斷點，然後看看周圍是否如你預期。</p><p>“但是，瑪麗，”我聽到你說，“如果我有一個調用棧，那這些都是有幫助的，但我只有一個失敗的測試。我該從哪裡開始？”</p><p>pdb，一個 Python 調試器。</p><p>找到你代碼裡會被這個調用命中的地方。你應該能夠找到至少一個這樣的地方。在那裡打上一個 pdb 的斷點。</p><h1 class=ql-align-center>一句題外話</h1><p>為什麼不使用 print 語句呢？我曾經依賴於 print 語句。有時候，它們仍然很方便。但當我開始處理複雜的代碼庫，尤其是有網絡調用的代碼庫，print 語句就變得太慢了。我最終在各種地方都加上了 print 語句，但我沒法追蹤它們的位置和原因，而且變得更復雜了。但是主要使用 pdb 還有一個更重要的原因。假設你添加一條 print 語句去發現錯誤問題，而且 print 語句必須早於錯誤出現的地方。但是，看看你放 print 語句的函數，你不知道你的代碼是怎麼執行到那個位置的。查看代碼是尋找調用路徑的好方法，但看你以前寫的代碼是恐怖的。是的，我會用 grep 處理我的代碼庫以尋找調用函數的地方，但這會變得乏味，而且搜索一個通用函數時並不能縮小搜索範圍。pdb 就變得非常有用。</p><p>你遵循我的建議，打上 pdb 斷點並運行你的測試。然而測試再次失敗，但是沒有任何一個斷點被命中。留著你的斷點，並運行測試套件中一個同這個失敗的測試非常相似的測試。如果你有個不錯的測試套件，你應該能夠找到一個這樣的測試。它會命中了你認為你的失敗測試應該命中的代碼。運行這個測試，然後當它運行到你的斷點，按下 w 並檢查調用棧。如果你不知道如何查看因為其他調用而變得混亂的調用棧，那麼在調用棧的中間找到屬於你的代碼，並在堆棧中該代碼的上一行放置一個斷點。再試一次新的測試。如果仍然沒命中斷點，那麼繼續，向上追蹤調用棧並找出你的調用在哪裡脫軌了。如果你一直沒有命中斷點，最後到了追蹤的頂部，那麼恭喜你，你發現了問題：你的應用程序名稱拼寫錯了。</p><blockquote><p>沒有經驗，小白，一點都沒有經驗。</p></blockquote><h1 class=ql-align-center>4、修改代碼</h1><p>如果你仍覺得迷惑，在你稍微改變了一些的地方嘗試新的測試。你能讓新的測試跑起來麼？有什麼是不同的呢？有什麼是相同的呢？嘗試改變一下別的東西。當你有了你的測試，以及可能也還有其它的測試，那就可以開始安全地修改代碼了，確定是否可以縮小問題範圍。記得從一個新提交開始解決問題，以便於可以輕鬆地撤銷無效地更改。（這就是版本控制，如果你沒有使用過版本控制，這將會改變你的生活。好吧，可能它只是讓編碼更容易。查閱“ 版本控制可視指南 ”，以瞭解更多。）</p><h1 class=ql-align-center>5、休息一下</h1><p>儘管如此，當它不再感覺起來像一個有趣的挑戰或者遊戲而開始變得令人沮喪時，你最好的舉措是脫離這個問題。休息一下。我強烈建議你去散步並嘗試考慮別的事情。</p><h1 class=ql-align-center>6、把一切寫下來</h1><p>當你回來了，如果你沒有突然受到啟發，那就把你關於這個問題所知的每一個點信息寫下來。這應該包括：</p><ul><li>真正造成問題的調用</li><li>真正發生了什麼，包括任何錯誤信息或者相關的日誌信息</li><li>你真正期望發生什麼</li><li>到目前為止，為了找出問題，你做了什麼工作；以及解決問題中你發現的任何線索。</li></ul><p>有時這裡有很多信息，但相信我，從零碎中挖掘信息是很煩人。所以儘量簡潔，但是要完整。</p><h1 class=ql-align-center>7、尋求幫助</h1><p>我經常發現寫下所有信息能夠啟迪我想到還沒嘗試過的東西。當然，有時候我在點擊求助郵件（或表單）的提交按鈕後立刻意識到問題是是什麼。無論如何，當你在寫下所有東西仍一無所獲時，那就試試向他人發郵件求助。首先是你的同事或者其他參與你的項目的人，然後是該項目的郵件列表。不要害怕向人求助。大多數人都是友善和樂於助人的，我發現在 Python 社區裡尤其如此。</p><p>Maria McKinley 已在 PyCascades 2019 演講 代碼查錯 ，2 月 23-24，於西雅圖。</p><hr><p>via: https://opensource.com/article/19/2/steps-hunting-code-python-bugs</p><p>作者： Maria Mckinley 選題： lujun9972 譯者： LazyWolfLin 校對： wxy</p><p>本文由 LCTT 原創編譯， Linux中國 榮譽推出</p><h1 class=ql-align-center>點擊“瞭解更多”可訪問文內鏈接</h1></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>七步</a></li><li><a>Python</a></li><li><a>捉蟲法</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/91eece92.html alt="只需 45 秒，Python 給故宮畫一組手繪圖！" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/df1bd890ffee4a439e9f5142ae42c102 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/91eece92.html title="只需 45 秒，Python 給故宮畫一組手繪圖！">只需 45 秒，Python 給故宮畫一組手繪圖！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8aab963e.html alt=Python手繪圖瞭解一下！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/746c9e6e214b48b2a0215fc9e151cdc8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8aab963e.html title=Python手繪圖瞭解一下！>Python手繪圖瞭解一下！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cfd854c6.html alt=故宮下雪了！我用Python給它畫了一組手繪圖，僅用45秒（附代碼） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/774d2f0a372f48c589ec84dd3a164dd9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cfd854c6.html title=故宮下雪了！我用Python給它畫了一組手繪圖，僅用45秒（附代碼）>故宮下雪了！我用Python給它畫了一組手繪圖，僅用45秒（附代碼）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b433c17e.html alt="四十、Python模塊random: 偽隨機數據生成與隨機元素抽取" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/25f231d6-c1ce-4cf8-8988-5da509a0c26a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b433c17e.html title="四十、Python模塊random: 偽隨機數據生成與隨機元素抽取">四十、Python模塊random: 偽隨機數據生成與隨機元素抽取</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/04486eba.html alt=Python爬蟲使用selenium爬取群成員信息（全自動實現自動登陸） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/e11e69f643584941aaa2b71ee6ed3d7f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/04486eba.html title=Python爬蟲使用selenium爬取群成員信息（全自動實現自動登陸）>Python爬蟲使用selenium爬取群成員信息（全自動實現自動登陸）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/86b46e6d.html alt=Python爬蟲教程，利用Python採集QQ群成員信息 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6d6cce76ad48405c9dbb960d4617bcef style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/86b46e6d.html title=Python爬蟲教程，利用Python採集QQ群成員信息>Python爬蟲教程，利用Python採集QQ群成員信息</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7739dc7a.html alt=Python數據可視化Matplotlib，如何在一副圖像中顯示多組柱形圖？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/5d4a0000046e1bea8b90 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7739dc7a.html title=Python數據可視化Matplotlib，如何在一副圖像中顯示多組柱形圖？>Python數據可視化Matplotlib，如何在一副圖像中顯示多組柱形圖？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/05b8f164.html alt=Python中的多進程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/49dd44b999924b69bd3396709ecacaf4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/05b8f164.html title=Python中的多進程>Python中的多進程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/389d4437.html alt="Python常用算法學習(5) 樹二叉樹（原理+代碼）-最全總結" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d3d5fd4ef98c4a8e8dc9095eeef052a6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/389d4437.html title="Python常用算法學習(5) 樹二叉樹（原理+代碼）-最全總結">Python常用算法學習(5) 樹二叉樹（原理+代碼）-最全總結</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0fa274c2.html alt="七十九、Python | Leetcode 二叉樹系列（上篇）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a6c9fa6432a3419a8a60bd334f978a11 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0fa274c2.html title="七十九、Python | Leetcode 二叉樹系列（上篇）">七十九、Python | Leetcode 二叉樹系列（上篇）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f0a927d6.html alt=Python中如何定義只讀屬性？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/60dafb43-a3bb-4456-9f60-3d55ab9e1c4e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f0a927d6.html title=Python中如何定義只讀屬性？>Python中如何定義只讀屬性？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/68f62be6.html alt=Python文件讀寫方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/dca556bb2ffb4013b992ebb4b6a9a296 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/68f62be6.html title=Python文件讀寫方法>Python文件讀寫方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4d9fe5d5.html alt=Python開發常見問題彙總 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1525506011510ee699a3e91 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4d9fe5d5.html title=Python開發常見問題彙總>Python開發常見問題彙總</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7dad731d.html alt=對於新手來說，Python中有哪些難以理解的概念？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1f4ec4c3a6484cf58453023c44e01d75 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7dad731d.html title=對於新手來說，Python中有哪些難以理解的概念？>對於新手來說，Python中有哪些難以理解的概念？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ab8f2e4e.html alt=整數溢出是怎麼回事？Python和Numpy的整數為何不一樣？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d700b7792dc04a3c9b39679d104469d8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ab8f2e4e.html title=整數溢出是怎麼回事？Python和Numpy的整數為何不一樣？>整數溢出是怎麼回事？Python和Numpy的整數為何不一樣？</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>