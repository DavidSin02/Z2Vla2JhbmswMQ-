<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>公交車總遲到？你大概掉進了“等待時間悖論 | 极客快訊</title><meta property="og:title" content="公交車總遲到？你大概掉進了“等待時間悖論 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/343302fa5be649b9b52a02cadd5e8859"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7b81410.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7b81410.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/7b81410.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7b81410.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7b81410.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/7b81410.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/7b81410.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7b81410.html><meta property="article:published_time" content="2020-10-29T21:04:22+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:22+08:00"><meta name=Keywords content><meta name=description content="公交車總遲到？你大概掉進了“等待時間悖論"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/7b81410.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>公交車總遲到？你大概掉進了“等待時間悖論</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/343302fa5be649b9b52a02cadd5e8859><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><strong>大數據文摘出品</strong></p><p class=ql-align-justify><strong>編譯：李雷、小蔣、錢天培</strong></p><p class=ql-align-justify>如果你經常坐公交車，相信下面這一場景對你絕不陌生。</p><p class=ql-align-justify>你到了車站，準備搭乘聲稱每10分鐘一班的公交車。你盯著你的手錶留意著時間，結果公交車終於在11分鐘後到來。</p><p class=ql-align-justify>這時你不由得感嘆：為什麼今天運氣這麼差！</p><p class=ql-align-justify>想想也是。如果公交車每10分鐘一班，而你到達的時間是隨機的，那麼你的平均等待時間難道不是5分鐘嘛？</p><p class=ql-align-justify>但實際上，等待公交車的時間似乎永遠要比你預估的久。</p><p class=ql-align-justify>究竟是你錯了？還是公交運營系統出了問題？</p><p class=ql-align-justify>事實證明，在一些合理的假設下，你可以得出一個驚人的結論：</p><p class=ql-align-justify>在等待平均10分鐘一班的公交車時，你的平均等待時間將為10分鐘。</p><p class=ql-align-justify>這就叫等待時間悖論。</p><p><strong>等待時間悖論</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>如果公交車精確每10分鐘來一輛，那麼你的平均等待時間就是這個間隔的一半：5分鐘。</p><p class=ql-align-justify>可是，如果我們給這個10分鐘加上一點隨機成分呢？</p><p class=ql-align-justify>這時，等待時間悖論就出現了。</p><p class=ql-align-justify>等待時間悖是檢驗悖論的一種。那麼，什麼是檢驗悖論呢？</p><p class=ql-align-justify>簡言之，只要觀察量的概率與觀察量有關，就會出現檢驗悖論。比如說，我們做了一個調查大學生班級平均人數的調查。雖然學校確實保證每班平均有30名學生，但實際調查下來的平均班級規模通常會大得多。</p><p class=ql-align-justify>原因是，較大的班級中就有更多的學生，因此在計算學生的平均體驗時，你會對大班進行過度地抽樣。極端得講，如果有一個班一個學生也沒有，那你壓根不會抽樣到這個班級的學生。</p><p class=ql-align-justify>對於通常10分鐘一班的公交線路，有時兩班車的間隔會超過10分鐘，有時則短點。如果你在隨機時間到達，那你會有更多機會遇到更長的等待間隔，而不是較短的。</p><p class=ql-align-justify>因此，乘客所經歷的平均等待時間間隔將比公交車之間的平均到達時間間隔更長，因為較長的間隔是被過度採樣了的。</p><p class=ql-align-justify>但等待時間悖論提出了一個比這更震撼的主張。</p><p class=ql-align-justify>當兩班車的平均間隔是N分鐘時，搭乘者所經歷的平均等待時間也是N分鐘，而非N/2分鐘。</p><p class=ql-align-justify>這是真的嗎？</p><p><strong>模擬等待時間</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>為了證明等待時間悖論的合理性，讓我們首先模擬平均每10分鐘到達一班的公交車流。</p><p class=ql-align-justify>我們將模擬大量的公交車到達的情況：100萬輛（或大約19年中全天不間斷的10分鐘來一輛車的間隔），以保證實驗的準確性。</p><pre>import numpy as npN = 1000000 # number of busestau = 10 # average minutes between arrivalsrand = np.random.RandomState(42) # universal random seedbus_arrival_times = N * tau * np.sort(rand.rand(N))</pre><p class=ql-align-justify>為了確認我們做的是對的，讓我們檢查一下平均間隔是否接近τ= 10：</p><pre>intervals = np.diff(bus_arrival_times)intervals.mean()</pre><p class=ql-align-justify><br></p><p class=ql-align-justify>輸出：</p><pre>9.9999879601518398</pre><p class=ql-align-justify><br></p><p class=ql-align-justify>通過模擬這些公交車到達，我們現在可以模擬大量乘客在此期間到達公交車站，並計算他們每個人經歷的等待時間。讓我們將它封裝在一個函數中供以後使用：</p><pre>def simulate_wait_times(arrival_times, rseed=8675309, # Jenny's random seed n_passengers=1000000): rand = np.random.RandomState(rseed)  arrival_times = np.asarray(arrival_times) passenger_times = arrival_times.max() * rand.rand(n_passengers) # find the index of the next bus for each simulated passenger i = np.searchsorted(arrival_times, passenger_times, side='right') return arrival_times[i] - passenger_times</pre><p class=ql-align-justify>然後我們可以模擬一些等待時間並計算平均值：</p><pre>wait_times = simulate_wait_times(bus_arrival_times)wait_times.mean()</pre><p class=ql-align-justify><br></p><p class=ql-align-justify>輸出：</p><pre>10.001584206227317</pre><p class=ql-align-justify><br></p><p class=ql-align-justify>平均等待時間接近10分鐘。正如等待時間悖論預測的那樣。</p><p><strong>深入挖掘：概率和泊松過程</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>我們如何理解這一現象呢？</p><p class=ql-align-justify>從本質上說，這是檢驗悖論的一個例子，其中觀察值的概率與觀察值本身有關。 讓我們用p（T）表示公交車到達車站時間隔T的分佈。 在這種表示法中，到達時間的期望值是：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/20bd0425e5d14c6f99ac634eb64532e3><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>在上面的模擬中，我們選擇了E [T] =τ= 10分鐘。</p><p class=ql-align-justify>當乘客隨機到達公交車站時，他們所經歷的時間間隔的概率將受到p（T）的影響，但也受到T本身的影響：間隔時間越長，乘客遇到這一間隔的概率就越大。</p><p class=ql-align-justify>所以我們可以得出乘客所經歷的到達時間分佈：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/850deb7ad8474c639524eaeb51ca1fef><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>比例常數來自正態化分佈：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/37358933e50c4b78b5ec509b3e1fe565><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>與上面相比，我們可以將它簡化為</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/74d713e7076b4244bb22b50c20082ec5><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>預計等待時間E [W]將是乘客所經歷的預期間隔的一半，所以我們可以寫作</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a3017b9359274513acf6115799c28c5e><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>或者可以寫得更清楚一點：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/627e8aefe6ce4f11ac9e75951c55fc80><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>現在，讓我們為p（T）選擇一個表格並計算積分。</p><p class=ql-align-justify><strong>選擇p(T)</strong></p><p class=ql-align-justify>如果我們這種公式推導可行，那用於p（T）的合理分佈是什麼？</p><p class=ql-align-justify>我們可以通過繪製兩班車間隔的直方圖來獲得模擬到達中的p（T）分佈的圖片：</p><pre>%matplotlib inlineimport matplotlib.pyplot as pltplt.style.use('seaborn')plt.hist(intervals, bins=np.arange(80), density=True)plt.axvline(intervals.mean(), color='black', linestyle='dotted')plt.xlabel('Interval between arrivals (minutes)')plt.ylabel('Probability density');</pre><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ef945027b5714f75bf1797f089045486><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>這裡的垂直虛線表示平均的間隔大約為10分鐘。這看起來非常像指數分佈，而且並非偶然：我們將公交車的到達時間模擬為均勻隨機數，這非常接近於泊松過程，對於這樣的過程，可以證明到達之間的間隔分佈是呈指數分佈的。</p><p class=ql-align-justify>注：實際上，在區間Nτ內均勻採樣N個點，點之間的間隔T遵循β分佈：T /（Nτ）〜Bet [1，N]，當N很大的時候這個極限趨於T~Exp [1 /τ]。</p><p class=ql-align-justify>區間的指數分佈意味著到達時間遵循泊松過程。</p><p class=ql-align-justify>通過再次檢查這個推斷，我們可以確認它與泊松過程的另一個屬性的相匹配：在固定時間範圍內到達公交的數量將是泊松分佈的。讓我們將模擬到達的時間按小時分桶檢查一下：</p><pre>from scipy.stats import poisson# count the number of arrivals in 1-hour binsbinsize = 60binned_arrivals = np.bincount((bus_arrival_times // binsize).astype(int))x = np.arange(20)# plot the resultsplt.hist(binned_arrivals, bins=x - 0.5, density=True, alpha=0.5, label='simulation')plt.plot(x, poisson(binsize / tau).pmf(x), 'ok', label='Poisson prediction')plt.xlabel('Number of arrivals per hour')plt.ylabel('frequency')plt.legend();</pre><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ca00320a4ef04dc3949b995ac10e73dd><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>經驗值和理論值緊密匹配，這讓我們相信我們的解釋是正確：對於大N，柏鬆過程可以很好地描述我們模擬的公交到達時間，其到達間隔是指數分佈的。</p><p class=ql-align-justify>這意味著概率分佈如下：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a4f173ff1e7b46d786e149fe2ed60abf><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>將此概率分佈代入上面的公式，我們發現一個人的平均等待時間為</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/b15bf27c777f4238887880824c93c680><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>乘客的預期等待時間與公交到達的平均間隔相同！</p><p class=ql-align-justify>一種補充的推斷方式是：泊松過程是一個無記憶過程，這意味著事件發生的歷史情況與下一個事件的預期時間無關。所以當你到達公交站後，等到下一班公交的平均等待時間總是一樣的：在我們的案例中，它是10分鐘，這與上一班車走了多久無關！</p><p class=ql-align-justify>同樣的原理，你已經等待了多久並不重要：下一輛公交預計的到達時間總是10分鐘：對泊松過程來說，你花費在等待的時間沒用。</p><p><strong>實際的等待時間</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>如果通過泊松過程確實描述了真實世界的公交到達時間，上述分析是正確的，但事實真的如此嗎？</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fca0946fd9c84ae1ac1d1fe0f658f82d><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>為了確定等待時間悖論是否描述了現實情況，我們深入研究了一些可供下載的數據：arrival_times.csv（3MB的CSV文件）</p><p class=ql-align-justify>https://gist.githubusercontent.com/jakevdp/82409002fcc5142a2add0168c274a869/raw/1bbabf78333306dbc45b9f33662500957b2b6dc3/arrival_times.csv</p><p class=ql-align-justify>該數據集包含2016年第二季度記錄的西雅圖市中心3rd & Pike公交站的西雅圖Rapid Ride C、D、E線的預定和實際到達時間。</p><pre>import pandas as pddf = pd.read_csv('arrival_times.csv')df = df.dropna(axis=0, how='any')df.head()</pre><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/19545c9ce04a4ebfbf59614bf6869d57><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>我特意選擇Rapid Ride路線的數據是因為，在一天的大部分時間裡，公交車的間隔很規律，通常在10到15分鐘之間。</p><p class=ql-align-justify><strong>數據清洗</strong></p><p class=ql-align-justify>首先，讓我們進行一下數據清洗，將其轉換為更易於使用的表單：</p><pre># combine date and time into a single timestampdf['scheduled'] = pd.to_datetime(df['OPD_DATE'] + ' ' + df['SCH_STOP_TM'])df['actual'] = pd.to_datetime(df['OPD_DATE'] + ' ' + df['ACT_STOP_TM'])# if scheduled &amp; actual span midnight, then the actual day needs to be adjustedminute = np.timedelta64(1, 'm')hour = 60 * minutediff_hrs = (df['actual'] - df['scheduled']) / hourdf.loc[diff_hrs &gt; 20, 'actual'] -= 24 * hourdf.loc[diff_hrs &lt; -20, 'actual'] += 24 * hourdf['minutes_late'] = (df['actual'] - df['scheduled']) / minute# map internal route codes to external route lettersdf['route'] = df['RTE'].replace({673: 'C', 674: 'D', 675: 'E'}).astype('category')df['direction'] = df['DIR'].replace({'N': 'northbound', 'S': 'southbound'}).astype('category')# extract useful columnsdf = df[['route', 'direction', 'scheduled', 'actual', 'minutes_late']].copy()df.head()</pre><p class=ql-align-justify><br></p><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9e4fa8ef615a4a3f9424b3b5ebc5610a><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><strong>公交車晚了多少？</strong></p><p class=ql-align-justify>該表中主要有六個不同的數據集：C、D和E線的北行和南行。為了瞭解它們的特性，讓我們繪製這六條線路的實際與預定到達時間差的直方圖：</p><pre>import seaborn as snsg = sns.FacetGrid(df, row="direction", col="route")g.map(plt.hist, "minutes_late", bins=np.arange(-10, 20))g.set_titles('{col_name} {row_name}')g.set_axis_labels('minutes late', 'number of buses');</pre><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/418522b4983d4b948ec79e78a0a387d5><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>你可能會認為公交車每次在行程開始時與其時間表更接近，並且在快結束時有更多的差異，這在數據中得到了證實：南行（southbound）C線和北行(northbound) D線、E線都在各自路線的起點接近時間表，而其反方向在終點時更接近。</p><p class=ql-align-justify><strong>預定和觀察到的到達時間間隔</strong></p><p class=ql-align-justify>接下來讓我們來看看這六條路線觀察和預計的到達時間間隔。我們首先使用Pandas 的groupby功能分別計算這些間隔：</p><pre>def compute_headway(scheduled): minute = np.timedelta64(1, 'm') return scheduled.sort_values().diff() / minutegrouped = df.groupby(['route', 'direction'])df['actual_interval'] = grouped['actual'].transform(compute_headway)df['scheduled_interval'] = grouped['scheduled'].transform(compute_headway)g = sns.FacetGrid(df.dropna(), row="direction", col="route")g.map(plt.hist, "actual_interval", bins=np.arange(50) + 0.5)g.set_titles('{col_name} {row_name}')g.set_axis_labels('actual interval (minutes)', 'number of buses');</pre><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/41b321ec6f434f288b504b52f3778786><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>可以很清楚看出，這並不像我們模型的指數分佈形式，此外，分佈可能受到非恆定的預定到達間隔的影響。</p><p class=ql-align-justify>讓我們重複上面的圖表，查看預定到達間隔的分佈：</p><p class=ql-align-justify>這表明公交車在整個星期都有不同的到達時間間隔，所以我們無法從原始到達時間數據的分佈來評估等待時間悖論的準確性。</p><pre>g = sns.FacetGrid(df.dropna(), row="direction", col="route")g.map(plt.hist, "scheduled_interval", bins=np.arange(20) - 0.5)g.set_titles('{col_name} {row_name}')g.set_axis_labels('scheduled interval (minutes)', 'frequency');</pre><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a58d34b5921d4c87b255d0d06faddd3e><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><strong>構建均勻分佈的時間表</strong></p><p class=ql-align-justify>即使預定的到達間隔不均勻，也有一些特定的間隔有大量到達的數據：例如，有近2000個北行E線的預定間隔為10分鐘。為了探索等待時間悖論是否適用，讓我們按路線、方向和預定間隔對數據進行分組，然後將這些近似的到達時間重新堆疊在一起，就像它們按順序發生的一樣。這應該保持了原始數據所有的相關特徵，同時更容易直接與等待時間悖論的預測比較。</p><pre>def stack_sequence(data): # first, sort by scheduled time data = data.sort_values('scheduled')  # re-stack data &amp; recompute relevant quantities data['scheduled'] = data['scheduled_interval'].cumsum() data['actual'] = data['scheduled'] + data['minutes_late'] data['actual_interval'] = data['actual'].sort_values().diff() return datasubset = df[df.scheduled_interval.isin([10, 12, 15])]grouped = subset.groupby(['route', 'direction', 'scheduled_interval'])sequenced = grouped.apply(stack_sequence).reset_index(drop=True)sequenced.head()</pre><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/db0711d5b6184b09a2199c60c743cf2e><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>使用這些清理過的數據，我們可以繪製不同路線、方向和到達頻率的“實際”到達間隔的分佈：</p><pre>for route in ['C', 'D', 'E']: g = sns.FacetGrid(sequenced.query(f"route == '{route}'"), row="direction", col="scheduled_interval") g.map(plt.hist, "actual_interval", bins=np.arange(40) + 0.5) g.set_titles('{row_name} ({col_name:.0f} min)') g.set_axis_labels('actual interval (min)', 'count') g.fig.set_size_inches(8, 4) g.fig.suptitle(f'{route} line', y=1.05, fontsize=14)</pre><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2e9460ff34094498a95e3016aa148332><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/01c100bb8ad444ffa4d9087c84460ce4><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>我們看到，每條路線和時間表的觀測到達間隔的分佈接近高斯分佈，在預定的到達間隔附近達到峰值，並且在路線開始附近具有較小的標準差（C的南行(southbound)，D / E的北行(northbound)），以及在路線結束附近有更大的標準差。</p><p class=ql-align-justify>即使不經過統計測試，我們也可以清楚地看到，實際的到達時間間隔肯定不是指數分佈的，因而等待時間悖論所依賴的基本假設並不成立。</p><p class=ql-align-justify>我們可以利用上面使用的等待時間模擬功能來找到每條公交路線、方向和時間表的平均等待時間：</p><pre>grouped = sequenced.groupby(['route', 'direction', 'scheduled_interval'])sims = grouped['actual'].apply(simulate_wait_times)sims.apply(lambda times: "{0:.1f} +/- {1:.1f}".format(times.mean(), times.std()))</pre><p class=ql-align-justify><br></p><p class=ql-align-justify>輸出：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=公交車總遲到？你大概掉進了“等待時間悖論 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/977e963303d049d889e3f01830eeb50e><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>平均等待時間可能比預定時間間隔的一半長上一兩分鐘，但不等於等待時間悖論所暗示的預定時間間隔。換句話說，檢驗悖論得到了證實，但等待時間悖論似乎與現實不符。</p><p><strong>結論</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>等待時間悖論是個非常有趣的現象。它涵蓋了模擬、概率以及統計假設與現實的比較。</p><p class=ql-align-justify>雖然我們確認了，現實世界的公交線路確實遵循了一些版本的檢驗悖論，但上面的分析非常明確地顯示，等待時間悖論背後的核心假設（公交車的到達時間遵循泊松過程）並不是很有根據。</p><p class=ql-align-justify>回想起來，這也並不令人驚訝：泊松過程是一個無記憶過程，它假設到達的概率完全獨立於自上次到達的時間。實際上，一個運行良好的公交系統將有一個有意安排的時間表，用以避免這種行為：公交車不會在一天中的隨機時間開始他們的路線，而是按照選擇能夠最佳服務公眾的時間表開始他們的路線。</p><p class=ql-align-justify>這裡更大的教訓是，你應該謹慎對待任何數據分析工作的假設。泊松過程可以良好地描述到達時間的數據 – 但只是在某些特定情況下。</p><p class=ql-align-justify>僅僅因為一種類型的數據看起來像另一種類型的數據，並不能推導出對一種數據有效的假設必然對另一種有效。</p><p class=ql-align-justify>通常那些看似正確的假設可能會導致與現實不符的結論。</p><p class=ql-align-justify>最後，你可以在這裡下載本文全部代碼</p><p class=ql-align-justify>http://jakevdp.github.io/downloads/notebooks/WaitingTimeParadox.ipynb</p><p class=ql-align-justify>相關報道：</p><p class=ql-align-justify>http://jakevdp.github.io/blog/2018/09/13/waiting-time-paradox/?utm_source=mybridge&utm_medium=blog&utm_campaign=read_more</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>車總遲</a></li><li><a>時間</a></li><li><a>悖論</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/65709773.html alt=幹海帶泡軟太浪費時間了，這個小妙招處理後，三分鐘就變軟 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/66b80001068b5f6c9893 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/65709773.html title=幹海帶泡軟太浪費時間了，這個小妙招處理後，三分鐘就變軟>幹海帶泡軟太浪費時間了，這個小妙招處理後，三分鐘就變軟</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ebbbc375.html alt=時間繼電器測試儀的使用方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1205bf787f1f4de6a5f1e73e7737887b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ebbbc375.html title=時間繼電器測試儀的使用方法>時間繼電器測試儀的使用方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bee33acb.html alt=中國各大城市日照時間排名 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/153881187704099dbc15528 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bee33acb.html title=中國各大城市日照時間排名>中國各大城市日照時間排名</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/38343fa4.html alt=全國各地年日照時間地圖：為什麼四川貴州等省日照時間特別短？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b09ab5cc1ee34e48b0267fb1a573fd3e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/38343fa4.html title=全國各地年日照時間地圖：為什麼四川貴州等省日照時間特別短？>全國各地年日照時間地圖：為什麼四川貴州等省日照時間特別短？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/410f2fbf.html alt=夏至和冬至的日照時間相差多少？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3a7f980a05ac4b079a5119635df0019b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/410f2fbf.html title=夏至和冬至的日照時間相差多少？>夏至和冬至的日照時間相差多少？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/401d7e61.html alt=大家都熟知日出時間，那麼你們知道這個時間是怎麼算出來的嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e240bd51910c4924b88d747cff22c8e8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/401d7e61.html title=大家都熟知日出時間，那麼你們知道這個時間是怎麼算出來的嗎？>大家都熟知日出時間，那麼你們知道這個時間是怎麼算出來的嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/10c244b4.html alt=房子日照時間一般該是多少 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/R8ldewXa9z1FL style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/10c244b4.html title=房子日照時間一般該是多少>房子日照時間一般該是多少</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/052f74b7.html alt="如何看待美國衰落：別猜時間 要看趨勢" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1a35e01eff33445d93fb0a33681d9bcd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/052f74b7.html title="如何看待美國衰落：別猜時間 要看趨勢">如何看待美國衰落：別猜時間 要看趨勢</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/17cb0041.html alt=10分鐘的時間，學習一套企業人員數量差距分析方案 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/a2efe19b-b6ea-4af6-a8c9-b467e2fc69a1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/17cb0041.html title=10分鐘的時間，學習一套企業人員數量差距分析方案>10分鐘的時間，學習一套企業人員數量差距分析方案</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6334f375.html alt=怎麼在短時間內解決滾筒軸承位磨損問題？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d764cf47bae1433787eca00aac011446 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6334f375.html title=怎麼在短時間內解決滾筒軸承位磨損問題？>怎麼在短時間內解決滾筒軸承位磨損問題？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/95198d21.html alt=單代號網絡圖的繪製與6個時間參數的計算，一篇全掌握 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/c5297952c0e647eea3c702c4b9691098 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/95198d21.html title=單代號網絡圖的繪製與6個時間參數的計算，一篇全掌握>單代號網絡圖的繪製與6個時間參數的計算，一篇全掌握</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ce711a6b.html alt=一建市政的混凝土養護時間總結·墨師兄一個規律·讓你過目不忘 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ad9b77cce4884dd1b7e73343c2ebbb74 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ce711a6b.html title=一建市政的混凝土養護時間總結·墨師兄一個規律·讓你過目不忘>一建市政的混凝土養護時間總結·墨師兄一個規律·讓你過目不忘</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8ac280bd.html alt=50年的時間過去，我國的電子計算機發展到了什麼地步？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/460e4566-11a4-41c4-84f2-c7ac027f57ef style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8ac280bd.html title=50年的時間過去，我國的電子計算機發展到了什麼地步？>50年的時間過去，我國的電子計算機發展到了什麼地步？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/94bf3b55.html alt=時間如流水過去，只有茶濃淡依舊 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/7b1801e5-d71a-49c1-bdab-25acba111a7e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/94bf3b55.html title=時間如流水過去，只有茶濃淡依舊>時間如流水過去，只有茶濃淡依舊</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7e601275.html alt=監理工程師考試時間-考試科目 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7e601275.html title=監理工程師考試時間-考試科目>監理工程師考試時間-考試科目</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>