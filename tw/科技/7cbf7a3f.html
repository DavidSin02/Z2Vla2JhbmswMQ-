<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>感應式讀卡器，複製你的門禁卡、購物卡、飯卡，你的卡還安全麼？ | 极客快訊</title><meta property="og:title" content="感應式讀卡器，複製你的門禁卡、購物卡、飯卡，你的卡還安全麼？ - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/4d89aab359c744f6a5e42f8537ef5869"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7cbf7a3f.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7cbf7a3f.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/7cbf7a3f.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7cbf7a3f.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7cbf7a3f.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/7cbf7a3f.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/7cbf7a3f.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/7cbf7a3f.html><meta property="article:published_time" content="2020-10-29T21:11:58+08:00"><meta property="article:modified_time" content="2020-10-29T21:11:58+08:00"><meta name=Keywords content><meta name=description content="感應式讀卡器，複製你的門禁卡、購物卡、飯卡，你的卡還安全麼？"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/7cbf7a3f.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>感應式讀卡器，複製你的門禁卡、購物卡、飯卡，你的卡還安全麼？</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><strong>看了這個，你的飯卡還安全嗎？</strong></p><p>僅供測試，請勿模仿。</p><p>//NFC是什麼，肯德基嗎，，，不。。。</p><p><strong>近場通信（Near Field Communication，簡稱NFC），是一種新興的技術，使用了NFC技術的設備</strong></p><p><strong>（例如移動電話）可以在彼此靠近的情況下進行數據交換，是由非接觸式射頻識別（RFID）及</strong><strong>互連</strong><strong>互通技術整合演變而來的，通過在單一芯片上集成感應式讀卡器、感應式卡片和點對點通信的功能，利用移動終端實現移動支付、電子票務、門禁、移動身份識別、防偽等應用。由飛利浦公司和索尼公司共同開發的一種非接觸式識別和互聯技術，可以在移動設備、消費類電子產品、PC和智能控件工具間進行近距離無線通信。NFC功能提供了一種簡單、觸控式的解決方案，可以讓消費者簡單直觀地交換信息、訪問內容與服務。</strong></p><h1 class=pgc-h-arrow-right>一、核心原理</h1><p>藉助CM9 rom的nfc讀寫標籤功能，實現軟件卡模擬。（之前的版本都沒有，google官方版本沒有開放此功能，目前從android 5.0起google開放了其他nfc api以進行卡模擬操作，）。</p><h1 class=pgc-h-arrow-right>二、應用場景</h1><p>手機或手環等帶有NFC功能的設備通過模擬IC卡的操作，把像小區門禁卡、飯卡等IC卡的數據複製到手機的NFC芯片上面，以後就可以用手機的NFC功能進行刷卡。</p><h1 class=pgc-h-arrow-right>三、實現功能</h1><p>可以截獲安卓手機支持的13.56hz nfc無線通訊協議的所有標籤數據，nfc非接觸黑盒測試一直沒有太好的方案，要麼太高端（需要專業的設備），要麼不好用（proxmark3也不便宜，監聽無線的方式導致截獲數據不穩定，也沒有現成兒的解決方案，操作的便捷性和交互性也好差）nfcproxy給我們這些偶爾用一用的測試狗提供了一種低成本高效率的解決方案，支持各種nfc標籤，iso 14443標準，apdu數據也是完整穩定的，基於安卓app源碼的二次開發也非常簡單，會java的隨便改改基本都不是問題。基於這個 app可以以軟件方式衍生出多種測試方式</p><p>1、 卡和終端之間數據的嗅探</p><p>2、 交互過程中的數據修改</p><p>3、 模擬卡</p><p>最關鍵的還是簡單，買倆一百來塊錢一個的二手手機就可以了。</p><p>硬件需求：</p><p>兩個帶nfc功能的android手機（鹹魚最便宜300塊錢以內可以搞定）一個帶非接觸功能的POS或者讀卡器（有個pos最省事，我有一個支持銀聯閃付的pos）自己的銀行卡，支持非接觸支付的，有銀聯quick pass標誌的都可以</p><p>1、基於支持CM9 rom的安卓手機一個</p><p>我用的是谷歌親兒子一代 nexus s,ROM是slim 4.3 build 2-OFFICIAL-1332 一個基於cm的定製版本</p><p>android版本 4.3.1。我買得早，略貴，現在閒魚買二手的話沒有必要買這個，後面幾代也都便宜了，二兒子三兒子四兒子什麼的，都可以考慮，一加一也可以考慮，略貴。理論上支持CM9的都可以，但由於</p><p>CM官網已經黃了老版本的rom不好找，所以儘量要先找到手機對應的老版本的rom再決定買啥。 2、帶nfc功能的安卓手機一個（最好也支持cm9）</p><p>我用的是 三星 GALAXY S2的T版SGH-T989大力神，CM版本是11-20160815-NIGHTLY-hercules，</p><p>android版本4.4.4 ，cm11好像已經去掉軟件卡模擬的功能了，我也沒有去降rom版本，有一個能用行了。只要不是太奇葩的定製rom，理論上都可以。建議還是選擇支持cm的，比較保險。硬件選擇同上軟件需求：</p><p>有完整的功能實現，大家可以直接打包使用我基於自己用著方</p><p>便，整合了emv-bertlv庫，可以直接在app裡把交互數據拆包。大家可以用著試試我的github地址：</p><p>本地app包下載：</p><p>使用方法</p><p>兩個手機都安裝nfcproxy都打開NFC功能連接到同一個wifi，兩個手機之間可以相互訪問</p><p>1、 proxy端設置</p><p>在支持cm9卡模擬的手機（我得是nexus s），打開nfcproxy軟件，點設置，取消 relay mode 單選框IP 地址填另一個手機的wifi ip端口 填另一個手機的nfcproxy監聽端口，默認9999encrypt</p><p>communications 不需要選，自己玩不用加密always keep screen on 隨便debug logging 勾上，可以顯示出卡號。然後退出設置。</p><p>2、 relay端的設置</p><p>在另外一個手機（我得是t989），打開nfcproxy軟件，點設置，勾選 relay mode 單選框IP 地址 不用填</p><p>端口 填剛剛在另一個手機設置的nfcproxy監聽端口，默認9999，兩邊一樣就行encrypt</p><p>communications 不需要選，自己玩不用加密always keep screen on 隨便debug logging 勾上，可以顯示出卡號。然後退出設置。</p><p>3、 測試</p><p>1、 將用於relay端的手機，nfcproxy軟件打開貼到銀行卡上，這時status窗口應該提示</p><p>TechList:android.nfc.tech.IsoDepandroid.nfc.tech.NfcA，如果沒反應請檢查nfc是否打開，手機</p><p>NFC功能是否正常</p><p>2、 將POS機弄到選擇消費，輸入金額後，提示請刷卡的界面</p><p>3、 將用於proxy端的手機，nfcproxy軟件打開，去貼到POS機上執行非接刷卡動作。</p><p>正常情況貼上去後nfcproxy的data窗口會提示：Reader</p><p>TAG:Tech[android.nfc.tech.Iso.PcdA]Connecting to NFCRelayConnected to NFCRelayTransaction</p><p>Complete!這說明已經已經連上了貼卡那臺手機，POS機的請求已經轉發到卡上了，並且卡的應答已經轉發回來了，交易成了。這時候POS應該顯示請輸入密碼了，輸入密碼交易成功。再看replay端的 nfcproxy的data窗口，就可以看到交互的數據了在數據上長按可以選擇最右面的三個豎點，export to file將截取的數據保存到內部存儲的/NfcProxy目錄中</p><p>注1：如果帖POS的手機沒反應，需要檢查nfc功能是否正常</p><p>注2：status 提示 connection to NFCRelay failed 需要檢查兩臺手機wifi是否聯通，配置的ip和端口是否正常</p><div class=pgc-img><img alt=感應式讀卡器，複製你的門禁卡、購物卡、飯卡，你的卡還安全麼？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4d89aab359c744f6a5e42f8537ef5869><p class=pgc-img-caption></p></div><p><strong>祝好運。</strong></p><p><strong>btw：</strong>這個方案15年我就在用，只是工作測試pos需要，偶爾用到感覺很方便，最近又用了一次，下決心整理一下。之前都看大神的文章，自己也為社區貢獻一次。軟件本身還有很大潛力可以挖，比如動態修改交互數據什麼的。。。。。。<strong>你們懂的，不要亂來哦，會查水錶的。</strong>另外也發現有一些終端讀卡會採用一些奇怪的模式，導致軟件報錯，這時候只能再用proxmark3暴力監聽了，但這個mitm的方式比 proxmark方便多了，也便宜的多了哈。最後附一張ppt裡的圖，我簡單畫了一下，方便大家理解</p><div class=pgc-img><img alt=感應式讀卡器，複製你的門禁卡、購物卡、飯卡，你的卡還安全麼？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/47dfbafa7aca4bba8e11ded6c27569b1><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>四、如何複製IC卡？</h1><p>在複製IC卡這一塊，我把IC卡分為加密卡和非加密卡兩類，非加密卡請直接嘗試複製，不行的話參照加密卡的教程。</p><p>工具：</p><p>1.硬件：PN532(初學者建議購買這個，某寶賣30RMB左右，一般的半加密卡用這個就能破解了，全加密卡需要用到PM3)，USB轉ttl線，小米手環NFC版（3代4代隨意），cuid卡</p><p>2.軟件：PN532的驅動（自己問賣家要，找對應的驅動，或看看我鏈接裡的驅動適不適合）、winhex、</p><p>MifareOneTool（簡稱M1T）、NFC_READER_crack。</p><div class=pgc-img><img alt=感應式讀卡器，複製你的門禁卡、購物卡、飯卡，你的卡還安全麼？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8fa3d447313340499712f7f4b61329fc><p class=pgc-img-caption></p></div><p>首先把USB轉ttl線與PN532連接好（線序定義：黑GND, 紅VCC,白SDA,綠SCL）。然後在電腦安裝好</p><p>PN532的驅動，PN532連接到電腦，然後查看設備管理器，COM口那有設備證明已經成功安裝好驅動了。</p><div class=pgc-img><img alt=感應式讀卡器，複製你的門禁卡、購物卡、飯卡，你的卡還安全麼？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1f5dfd3ea7144d259827f80a78a19b3e><p class=pgc-img-caption></p></div><p>打開M1T軟件，點擊檢測連接然後一鍵解原卡，有密鑰的會嘗試破解，破解成功後會導出一個.dump文件，我們把它保存。</p><div class=pgc-img><img alt=感應式讀卡器，複製你的門禁卡、購物卡、飯卡，你的卡還安全麼？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/bb4ec4f4606f4960a1eb35e0f66d9a7e><p class=pgc-img-caption></p></div><p>用winhex打開該.dump文件，把AB密鑰用FF填充，填充好了之後我們另存為一份，順便把開頭的卡號記下來（8位）</p><div class=pgc-img><img alt=感應式讀卡器，複製你的門禁卡、購物卡、飯卡，你的卡還安全麼？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9057ac3296a14ce8bf40cdf7b75f2b8a><p class=pgc-img-caption></p></div><p>之後我們再次打開M1t，選擇高級操作模式，打開Hex編輯器，把剛剛找的八位卡號複製下來，再打開工具，修改UID，把剛才複製的八位卡號粘貼到裡面，點確定，然後點文件-另存為一個.mfd文件。</p><div class=pgc-img><img alt=感應式讀卡器，複製你的門禁卡、購物卡、飯卡，你的卡還安全麼？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/efe106b1e3df4fcd9ed79e2bdce9fad7><p class=pgc-img-caption></p></div><p>高級模式裡選擇cuid寫，把剛剛的.mfd文件寫入cuid卡里面，如果沒寫滿64個塊就再寫一次。</p><div class=pgc-img><img alt=感應式讀卡器，複製你的門禁卡、購物卡、飯卡，你的卡還安全麼？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/efe106b1e3df4fcd9ed79e2bdce9fad7><p class=pgc-img-caption></p></div><p>小米手環選擇門卡模擬，把剛剛寫入了.mfd文件的cuid卡模擬到小米手環上，之後打開</p><p>NFC_READER_crack這個軟件，選擇寫普通M1卡，把填充好密鑰的飯卡數據寫入手環中。如果只寫入63個塊，那也沒關係，去試試能不能用。</p><div class=pgc-img><img alt=感應式讀卡器，複製你的門禁卡、購物卡、飯卡，你的卡還安全麼？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d80c4c200fd946d893e7d67eda5e1650><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=感應式讀卡器，複製你的門禁卡、購物卡、飯卡，你的卡還安全麼？ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/2ff5d5f5106248efacfd75930b1bc446><p class=pgc-img-caption></p></div><p>然後就大功告成啦！！</p><p>本教程切勿用於非法用途，複製飯卡餘額都是一樣的，不存在修改餘額這一說。飯卡原本餘額是多少的，你用什麼來打飯餘額都是一樣。複製到手環裡只是為了方便打飯。</p><p>Q：為什麼到了最後把數據寫入手環時不用原來的M1T而是用NFC_READER_crack呢？</p><p>A：因為用M1T寫入數據到手環會出現玄♂學問題，就是寫不到63個塊，用NFC_READER_crack就沒有問題。如果是用cuid卡來複制門禁卡的話可以嘗試用M1T。</p><p>Q：那如何複製門禁卡？</p><p>A：門禁卡如果是半加密卡的話可以參照本文來複制，如果是非加密卡的話試試直接模擬可不可以，如果不行的話按照讀出數據（保存）–生成一個帶有卡號的.mfd文件–複製到cuid卡–手環模擬該cuid卡–手環寫入門禁卡數據這一步驟來複制。</p><h1 class=pgc-h-arrow-right>五、最後</h1><p>生活中不乏其他案例，黑客破解NFC公交卡，可無限次乘車，甚至可以劫持帶有NFC功能的手機，所以安全問題顯而易見，畢竟防人之心不可無。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>感應式</a></li><li><a>讀卡器</a></li><li><a>購物卡</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E5%AD%B8/5b5ef3c0.html alt=Shopify感應式、芯片式和刷卡式讀卡器使用說明 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/RcOamXfCwY2DHf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/5b5ef3c0.html title=Shopify感應式、芯片式和刷卡式讀卡器使用說明>Shopify感應式、芯片式和刷卡式讀卡器使用說明</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0bc8e815.html alt=復旦國密CPU讀卡器、遠距離國密CPU讀卡器、CPU卡髮卡機、加密器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/dfd3d7b270f4418eb71d81343c1f7d97 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0bc8e815.html title=復旦國密CPU讀卡器、遠距離國密CPU讀卡器、CPU卡髮卡機、加密器>復旦國密CPU讀卡器、遠距離國密CPU讀卡器、CPU卡髮卡機、加密器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c8ab1d2c.html alt=注意：手機就是讀卡器！手機上的這個功能很多人不知道 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/2bc42afd21404607b8a4f9c21dc58443 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c8ab1d2c.html title=注意：手機就是讀卡器！手機上的這個功能很多人不知道>注意：手機就是讀卡器！手機上的這個功能很多人不知道</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/828f16f9.html alt=LEGIC讀卡器、LEGIC門禁、LEGIC梯控、考勤 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/59660f2c94e8417688df1178f1399f3c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/828f16f9.html title=LEGIC讀卡器、LEGIC門禁、LEGIC梯控、考勤>LEGIC讀卡器、LEGIC門禁、LEGIC梯控、考勤</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b2ba5d3d.html alt=一文讀懂海康威視門禁主機與讀卡器連接方式 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a897a280ed6b451c84ec8ccbfa65fa94 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b2ba5d3d.html title=一文讀懂海康威視門禁主機與讀卡器連接方式>一文讀懂海康威視門禁主機與讀卡器連接方式</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/53caa9ae.html alt=純乾貨，教您利用PN532讀卡器在小米手環5NFC版上添加加密門禁卡 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e0b1ee16cd594ccba4ac5b346cdce131 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/53caa9ae.html title=純乾貨，教您利用PN532讀卡器在小米手環5NFC版上添加加密門禁卡>純乾貨，教您利用PN532讀卡器在小米手環5NFC版上添加加密門禁卡</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5276c17.html alt="我國首次將大推力感應式振動臺成功應用於新能源領域 破國外壟斷" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1531457245504e78b13b396 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5276c17.html title="我國首次將大推力感應式振動臺成功應用於新能源領域 破國外壟斷">我國首次將大推力感應式振動臺成功應用於新能源領域 破國外壟斷</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/039bf29.html alt=關於無線射頻讀卡器的設計和應用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1fa1d8748da2449ebcfcedbadb2ea8f2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/039bf29.html title=關於無線射頻讀卡器的設計和應用>關於無線射頻讀卡器的設計和應用</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>