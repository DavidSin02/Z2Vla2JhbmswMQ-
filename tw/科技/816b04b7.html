<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>å¾JVMå±¤é¢å¸¶ä½ åˆ†æJavaçš„Objecté¡æºç¢¼ç¬¬ä¸€éƒ¨åˆ† | æå®¢å¿«è¨Š</title><meta property="og:title" content="å¾JVMå±¤é¢å¸¶ä½ åˆ†æJavaçš„Objecté¡æºç¢¼ç¬¬ä¸€éƒ¨åˆ† - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/816b04b7.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/816b04b7.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/816b04b7.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/816b04b7.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/816b04b7.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/816b04b7.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/816b04b7.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/816b04b7.html><meta property="article:published_time" content="2020-11-14T21:08:08+08:00"><meta property="article:modified_time" content="2020-11-14T21:08:08+08:00"><meta name=Keywords content><meta name=description content="å¾JVMå±¤é¢å¸¶ä½ åˆ†æJavaçš„Objecté¡æºç¢¼ç¬¬ä¸€éƒ¨åˆ†"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/816b04b7.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>å¾JVMå±¤é¢å¸¶ä½ åˆ†æJavaçš„Objecté¡æºç¢¼ç¬¬ä¸€éƒ¨åˆ†</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p><strong>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å°åœ–éˆè¦–ç•Œï¼Œæœ€è¿‘åœ¨åˆ†æJava8æºç¢¼ï¼Œä½¿ç”¨çš„JDKæ˜¯OpenJDK8,æ‰“ç®—å°‡åˆ†ææºç¢¼çš„ç­†è¨˜éƒ½æœƒåˆ†äº«å‡ºä¾†ï¼Œåœ¨é ­æ¢ä¸Šä»£ç¢¼æ’ç‰ˆæ¯”è¼ƒé›£çœ‹ï¼Œæƒ³è¦ç­†è¨˜çš„å¯ä»¥é—œæ³¨ä¸¦ç§ä¿¡æˆ‘ã€‚</strong></p><p><a class=pgc-link data-content=mp href="https://www.toutiao.com/i6814477971127009803/?group_id=6814477971127009803" rel="noopener noreferrer" target=_blank>å¾JVMå±¤é¢å¸¶ä½ åˆ†æJavaçš„Objecté¡æºç¢¼ç¬¬äºŒéƒ¨åˆ†</a></p><h1 class=pgc-h-arrow-right>Object æºç¢¼</h1><p><strong>ä½ç½®ï¼šjava.langåŒ…</strong></p><p><strong>Objecté¡æ˜¯Javaä¸­æœ€åŸºæœ¬çš„é¡ï¼Œæ˜¯æ‰€æœ‰é¡çš„æ ¹ã€‚ä¹Ÿå°±èªªï¼Œæ‰€æœ‰çš„é¡é»˜èªéƒ½æœƒç¹¼æ‰¿å®ƒï¼ŒåŒ…æ‹¬æ•¸çµ„ç­‰ï¼Œéƒ½è¦ç¹¼æ‰¿Objectä¸­çš„æ‰€æœ‰æ–¹æ³•</strong>ã€‚Objecté¡ä¸­å¤§å¤šæ•¸éƒ½æ˜¯nativeæ–¹æ³•ï¼Œnativeå°±æ˜¯æœ¬åœ°æ–¹æ³•ï¼Œç”±é—œéµnativeå­—ä¿®é£¾ï¼Œé€™äº›æ–¹æ³•ä¸åœ¨javaèªè¨€ä¸­å¯¦ç¾ï¼Œ<strong>åº•å±¤å¯¦ç¾æ˜¯çš„c/c++ä»£ç¢¼</strong>ã€‚ä¸»è¦çš„nativeæ–¹æ³•å¦‚ä¸‹ï¼š</p><pre><code>//åŠ è¼‰æœ¬åœ°æ–¹æ³•private static native void registerNatives();//ç²å–å°è±¡çš„é¡å‹ Classpublic final native Class&lt;?&gt; getClass();//ç²å–hashç¢¼ public native int hashCode();//å°è±¡æ‹·è²protected native Object clone() throws CloneNotSupportedException;//è·Ÿç·šç¨‹æœ‰é—œçš„æ–¹æ³•//å–šé†’ç·šç¨‹public final native void notify();//å–šé†’æ‰€æœ‰çš„ç·šç¨‹public final native void notifyAll();//ç·šç¨‹ç­‰å¾…public final native void wait(long timeout) throws InterruptedException;</code></pre><h1 class=pgc-h-arrow-right>private static native void registerNatives()</h1><p>åœ¨Objecté¡ä¸­ï¼Œæœ‰staticä»£ç¢¼å¡Šï¼Œé€™å€‹éœæ…‹ä»£ç¢¼å¡Šèª¿ç”¨äº†registerNatives()æ–¹æ³•ï¼š</p><pre><code>private static native void registerNatives();static {    registerNatives();}</code></pre><p><strong>registerNativesæ–¹æ³•çš„ä½œç”¨æ˜¯åŠ è¼‰å’Œè¨»å†Šæœ¬åœ°Cã€C++èªè¨€å‡½æ•¸ï¼Œå°‡Javaçš„æœ¬åœ°æ–¹æ³•èˆ‡JVMåº•å±¤çš„Cã€C++èªè¨€å‡½æ•¸å°æ‡‰èµ·ä¾†ï¼Œæ˜¯é€£æ¥javaèªè¨€èˆ‡åº•å±¤èªè¨€çš„æ©‹æ¨‘ï¼ŒregisterNativesæ–¹æ³•åœ¨å…¶ä»–é¡ä¸­ä¹Ÿå¯èƒ½å­˜åœ¨ï¼Œå¦‚Classé¡</strong>ã€‚Javaé¡çš„æœ¬åœ°æ–¹æ³•å°æ‡‰Cã€C++å‡½æ•¸çš„è¦å‰‡æ˜¯Java_åŒ…å_æ–¹æ³•å,åŒ…åä»¥ä¸‹åŠƒç·šåˆ†éš”ï¼ŒObjecté¡çš„registerNativeså°æ‡‰è‘—Cèªè¨€å‡½æ•¸æ˜¯Java_java_lang_Object_registerNativesï¼Œjava_lang_Objectæ˜¯javaå…¨é¡åä»¥ä¸‹åŠƒç·šé€£æ¥ï¼ŒregisterNativesæ˜¯Javaä¸­çš„æ–¹æ³•ï¼Œå…¶ä¸­Java_java_lang_Object_registerNativesé€™å€‹Cèªè¨€å‡½æ•¸å¦‚ä¸‹ï¼š</p><pre><code>static JNINativeMethod methods[] = {    {&#34;hashCode&#34;,    &#34;()I&#34;,                    (void *)&JVM_IHashCode},    {&#34;wait&#34;,        &#34;(J)V&#34;,                   (void *)&JVM_MonitorWait},    {&#34;notify&#34;,      &#34;()V&#34;,                    (void *)&JVM_MonitorNotify},    {&#34;notifyAll&#34;,   &#34;()V&#34;,                    (void *)&JVM_MonitorNotifyAll},    {&#34;clone&#34;,       &#34;()Ljava/lang/Object;&#34;,   (void *)&JVM_Clone},};JNIEXPORT void JNICALLJava_java_lang_Object_registerNatives(JNIEnv *env, jclass cls){    (*env)-&gt;RegisterNatives(env, cls,                            methods, sizeof(methods)/sizeof(methods[0]));}</code></pre><p>Java_java_lang_Object_registerNativesä¸»è¦æ˜¯è¨»å†ŠObjecté¡çš„hashCodeã€waitã€notifyã€notifyAllã€cloneç­‰æ–¹æ³•ï¼Œè€ŒgetClassæ–¹æ³•å»ä¸åœ¨é€™è£¡åŠ è¼‰ã€‚åœ¨Objecté¡ä¸­ï¼Œé€™äº›æœ¬åœ°æ–¹æ³•ä¸æ˜¯åœ¨Javaå±¤é¢å¯¦ç¾çš„ï¼Œæ‰€æœ‰åœ¨èª¿ç”¨é€™äº›æ–¹æ³•çš„æ™‚å€™ï¼Œæ˜¯èª¿ç”¨äº†åº•å±¤èªè¨€çš„å…·é«”å¯¦ç¾ã€‚</p><p>åœ¨methods[]æ•¸çµ„ä¸­ï¼Œæœ‰å¤šå€‹Javaæœ¬åœ°æ–¹æ³•å°æ‡‰JVMå±¤é¢çš„å‡½æ•¸ï¼Œå¦‚Objectä¸­hashCodeæ–¹æ³•å°æ‡‰JVMä¸­çš„JVM_IHashCodeå‡½æ•¸ï¼Œè¿”å›çš„é¡å‹æ˜¯()Iï¼Œå³è¿”å›çš„æ˜¯æ•´æ•¸é¡å‹ã€‚</p><h1 class=pgc-h-arrow-right>public final native Class&lt;?> getClass()</h1><p>getClass()æ–¹æ³•çš„ä½œç”¨æ˜¯è¿”å›å°è±¡é‹è¡Œæ™‚çš„Classé¡å‹ï¼Œjavaç·¨è­¯æœƒå°‡javaé¡ç·¨è­¯æˆä»¥.classçµå°¾çš„æ–‡ä»¶ï¼Œé€™æ˜¯ç·¨è­¯ç”Ÿæˆçš„äºŒé€²åˆ¶å­—ç¯€ç¢¼æ–‡ä»¶ï¼Œç”¨æ–¼JVMåŠ è¼‰ï¼ŒJavaè·¨å¹³è‡ºæ˜¯å› ç‚ºä½¿ç”¨èˆ‡å¹³è‡ºç„¡é—œçš„classäºŒé€²åˆ¶å­—ç¯€ç¢¼æ–‡ä»¶ï¼Œå¯ä»¥é€šéJjavaä¸­çš„Classé¡ç²å–å°è±¡çš„æ§‹é€ å™¨ã€æ–¹æ³•ã€å±¬æ€§ã€è¨»è§£ç­‰ç›¸é—œä¿¡æ¯ï¼š</p><pre><code>Object object=new Object();System.out.println(object.getClass());Class&lt;?&gt; objectClass=object.getClass();//æ§‹é€ å™¨Constructor&lt;?&gt;[] constructors=objectClass.getConstructors();System.out.println(&#34;Object é¡çš„æ§‹é€ å™¨ï¼š&#34;);for (Constructor constructor:constructors){        System.out.print(constructor); }//æ–¹æ³•Method[] methods=objectClass.getMethods();System.out.println(&#34;Object é¡çš„æ–¹æ³•ï¼š&#34;);for (Method method:methods){      System.out.println(method);}//å±¬æ€§Field[] fields=objectClass.getFields();System.out.println(&#34;Object é¡çš„å±¬æ€§ï¼š&#34;);for (Field field:fields){       System.out.println(field);}</code></pre><p>getClassæ–¹æ³•å°æ‡‰çš„åº•å±¤Cèªè¨€å‡½æ•¸ç‚ºJava_java_lang_Object_getClassï¼Œå…·é«”å¯¦ç¾ç‚ºï¼š</p><pre><code>JNIEXPORT jclass JNICALLJava_java_lang_Object_getClass(JNIEnv *env, jobject this){    if (this == NULL) {        JNU_ThrowNullPointerException(env, NULL);        return 0;    } else {        return (*env)-&gt;GetObjectClass(env, this);    }}</code></pre><p>ç•¶å‚³å…¥çš„å°è±¡thisç‚ºnullï¼Œç›´æ¥æ‹‹å‡ºNullPointerExceptionç•°å¸¸ï¼Œå¦å‰‡èª¿ç”¨GetObjectClasså‡½æ•¸,GetObjectClasså‡½æ•¸å¦‚ä¸‹ï¼š</p><pre><code>JNI_ENTRY(jclass, jni_GetObjectClass(JNIEnv *env, jobject obj))  JNIWrapper(&#34;GetObjectClass&#34;);#ifndef USDT2  DTRACE_PROBE2(hotspot_jni, GetObjectClass__entry, env, obj);#else /* USDT2 */  HOTSPOT_JNI_GETOBJECTCLASS_ENTRY(env, obj);#endif /* USDT2 *///ä¸»è¦ä½œç”¨æ˜¯æ ¹æ“šjavaå°è±¡å¼•ç”¨æ‰¾åˆ°JVMä¸­å¼•ç”¨å°è±¡ï¼Œå°‡Javaå°è±¡è½‰æ›ç‚ºJVMä¸­çš„å¼•ç”¨å°è±¡ï¼Œç„¶å¾Œèª¿ç”¨klass()æ–¹æ³•æ‰¾åˆ°å…ƒæ•¸æ“š  Klass* k = JNIHandles::resolve_non_null(obj)-&gt;klass();  jclass ret =(jclass) JNIHandles::make_local(env, k-&gt;java_mirror());#ifndef USDT2  DTRACE_PROBE1(hotspot_jni, GetObjectClass__return, ret);#else /* USDT2 */  HOTSPOT_JNI_GETOBJECTCLASS_RETURN(                                    ret);#endif /* USDT2 */  return ret;JNI_END</code></pre><p>ä¸Šè¿°çš„æ ¸å¿ƒä»£ç¢¼ç‚º:</p><pre><code>Klass* k = JNIHandles::resolve_non_null(obj)-&gt;klass();</code></pre><p>resolve_non_nullæ–¹æ³•ä¸»è¦ä½œç”¨æ˜¯æ ¹æ“šjavaå°è±¡å¼•ç”¨æ‰¾åˆ°JVMä¸­å¼•ç”¨å°è±¡oopï¼Œå°‡Javaå°è±¡è½‰æ›ç‚ºJVMä¸­çš„å¼•ç”¨å°è±¡ï¼Œç„¶å¾Œèª¿ç”¨klass()æ–¹æ³•æ‰¾åˆ°å…ƒæ•¸æ“šï¼Œresolve_non_nullçš„æ–¹æ³•ç‚ºï¼š</p><pre><code>inline oop JNIHandles::resolve_non_null(jobject handle) {  assert(handle != NULL, &#34;JNI handle should not be null&#34;);  oop result = *(oop*)handle;  assert(result != NULL, &#34;Invalid value read from jni handle&#34;);  assert(result != badJNIHandle, &#34;Pointing to zapped jni handle area&#34;);  // Don&#39;t let that private _deleted_handle object escape into the wild.  assert(result != deleted_handle(), &#34;Used a deleted global handle.&#34;);  return result;};</code></pre><p>resolve_non_nullæ–¹æ³•çš„æ ¸å¿ƒä»£ç¢¼æ˜¯oop result = (oop)handle;é€™å¥ä»£ç¢¼çš„æ„æ€æ˜¯å…ˆå°‡å‚³å…¥çš„Javaå°è±¡è½‰ç‚ºoopå¯¦ä¾‹ï¼Œï¼ˆ(oop*)handleï¼‰ï¼Œç„¶å¾Œå†ç²å–oopçš„æŒ‡é‡ï¼Œé€™å€‹æŒ‡é‡å°±æ˜¯å¼•ç”¨å°è±¡å¯¦ä¾‹çš„åœ°å€ï¼ˆ*(oop*)handleï¼‰ã€‚ç„¶å¾Œèª¿ç”¨klass()ç²å–å°è±¡å¯¦ä¾‹æ‰€å±¬çš„å…ƒæ•¸æ“šKlassï¼ŒKlassæ˜¯æŒ‡å‘Classé¡å‹çš„æŒ‡é‡ã€‚</p><pre><code>inline Klass* oopDesc::klass() const {  if (UseCompressedClassPointers) {    return Klass::decode_klass_not_null(_metadata._compressed_klass);  } else {  //è¿”å›å…ƒæ•¸æ“š    return _metadata._klass;  }}</code></pre><p>jclass ret =(jclass) JNIHandles::make_local(env, k->java_mirror())åˆ†ç‚ºå…©æ­¥ï¼Œå…ˆèª¿ç”¨Klassçš„java_mirror()æ–¹æ³•ï¼Œjava_mirroræ–¹æ³•çš„ä½œç”¨æ˜¯è¿”å›Klasså…ƒæ•¸æ“šçš„é¡åƒï¼ˆoopï¼‰ï¼Œå°æ‡‰è‘—jjava/lang/Classé¡çš„å¯¦ä¾‹ï¼Œava_mirroræ–¹æ³•å¦‚ä¸‹ï¼š</p><pre><code> // java/lang/Class instance mirroring this classoop       _java_mirror;oop java_mirror() const              { return _java_mirror; }</code></pre><p>æœ€å¾Œé€šé JNIHandles::make_localè™•ç†oopï¼Œç„¶å¾Œè¿”å›è™•ç†éå¾Œçš„oop,make_localçš„ä»£ç¢¼å¦‚ä¸‹ï¼š</p><pre><code>jobject JNIHandles::make_local(oop obj) {  if (obj == NULL) {      //è¿”å›null    return NULL;                // ignore null handles  } else {     //ç²å–ç•¶å‰ç·šç¨‹    Thread* thread = Thread::current();    assert(Universe::heap()-&gt;is_in_reserved(obj), &#34;sanity check&#34;);     //åˆ©ç”¨ç•¶å‰ç·šç¨‹æ´»èºçš„handleså°oopé€²è¡Œè™•ç†ã€‚    return thread-&gt;active_handles()-&gt;allocate_handle(obj);  }}</code></pre><p>åœ¨JNIHandles::make_localå‡½æ•¸ä¸­ï¼Œç•¶å‚³å…¥çš„oopå¯¦ä¾‹objç‚ºç©ºæ™‚ï¼Œç›´æ¥è¿”å›ç©ºï¼Œå¦å‰‡å°‡è™•ç†éçš„çµæœã€‚</p><h1 class=pgc-h-arrow-right>public native int hashCode()</h1><p>hashCodeæ–¹æ³•è¿”å›å°è±¡çš„å“ˆå¸Œç¢¼ï¼Œä»¥æ•´æ•¸å½¢å¼è¿”å›ã€‚å“ˆå¸Œè¡¨åœ¨javaé›†åˆä¸­å¦‚HashMapã€HashSetä¸­è¢«å»£æ³›ä½¿ç”¨ï¼Œä¸»è¦ä½œç”¨æ˜¯ç‚ºäº†æé«˜æŸ¥è©¢æ•ˆç‡ã€‚hashCodeæ–¹æ³•ä¸€äº›è¦å®š/ç´„å®šå¦‚ä¸‹ï¼š</p><li>åœ¨ä¸ä¿®æ”¹å°è±¡çš„equals()æ–¹æ³•æ™‚ï¼ŒåŒä¸€å€‹å°è±¡ç„¡è«–ä½•æ™‚èª¿ç”¨hashCodeæ–¹æ³•ï¼Œæ¯æ¬¡èª¿ç”¨hashCodeæ–¹æ³•å¿…é ˆè¿”å›ç›¸åŒçš„æ•´æ•¸ï¼ˆå“ˆå¸Œç¢¼ï¼‰ã€‚æ­¤æ•´æ•¸ä¸éœ€è¦åœ¨æ‡‰ç”¨ç¨‹åºçš„ä¸€æ¬¡åŸ·è¡Œèˆ‡åŒä¸€æ‡‰ç”¨ç¨‹åºçš„å¦ä¸€æ¬¡åŸ·è¡Œä¹‹é–“ä¿æŒä¸€è‡´ã€‚</li><li>å¦‚æœå…©å€‹å°è±¡ç›¸ç­‰ï¼ˆä½¿ç”¨equals()æ–¹æ³•åˆ¤æ–·ï¼‰ï¼Œé‚£éº¼é€™å…©å€‹å°è±¡èª¿ç”¨hashCodeæ–¹æ³•å¿…é ˆè¿”å›ç›¸åŒçš„æ•´æ•¸çµæœï¼ˆå“ˆå¸Œç¢¼ï¼‰ã€‚</li><li>å¦‚æœå…©å€‹å°è±¡ä¸ç›¸ç­‰ï¼ˆä½¿ç”¨equals()æ–¹æ³•åˆ¤æ–·ï¼‰ï¼Œå…©å€‹å°è±¡èª¿ç”¨hashCodeæ–¹æ³•è¿”å›çš„çµæœä¸ä¸€å®šä¸åŒï¼Œä¹Ÿå°±æ˜¯ä¸åŒçš„å…©å€‹å°è±¡çš„hashCodeæ–¹æ³•è¿”å›çš„çµæœå¯ä»¥ç›¸åŒä¹Ÿå¯ä»¥ä¸ç›¸åŒã€‚ä½†æ˜¯ä¸åŒå°è±¡è¿”å›çš„å“ˆå¸Œç¢¼æœ€å¥½ä¸åŒï¼Œé€™æ¨£åœ¨å“ˆå¸Œè¡¨æŸ¥è©¢æ™‚æ•ˆç‡æœƒæ›´é«˜ã€‚</li><p>hashCodeæ–¹æ³•çš„ä½¿ç”¨ï¼š</p><pre><code>Object o1=new Object();Object o2=new Object();Object o3=o1;System.out.println(&#34;o1çš„hashçš„å“ˆå¸Œç¢¼ï¼š&#34;+ o1.hashCode());System.out.println(&#34;o2çš„hashçš„å“ˆå¸Œç¢¼ï¼š&#34;+ o2.hashCode());System.out.println(&#34;o3çš„hashçš„å“ˆå¸Œç¢¼ï¼š&#34;+ o3.hashCode());//æˆ‘æ©Ÿå™¨ä¸Šçš„çµæœï¼Œä¸åŒæ©Ÿå™¨çµæœä¸åŒo1çš„hashçš„å“ˆå¸Œç¢¼ï¼š399573350o2çš„hashçš„å“ˆå¸Œç¢¼ï¼š463345942o3çš„hashçš„å“ˆå¸Œç¢¼ï¼š399573350</code></pre><p>o1å’Œo2æ˜¯ä¸åŒçš„å°è±¡ï¼ŒhashCodeæ–¹æ³•ç”¢ç”Ÿä¸åŒçš„å“ˆå¸Œç¢¼ï¼Œ o1èˆ‡o3æ˜¯ä¸åŒçš„å°è±¡ï¼Œå®ƒå€‘çš„å“ˆå¸Œç¢¼ä¸ä¸€æ¨£ã€‚hashCodeçš„åº•å±¤C++å¯¦ç¾</p><pre><code>static inline intptr_t get_next_hash(Thread * Self, oop obj) {  intptr_t value = 0 ;  if (hashCode == 0) {      //OpenJdk 6 &7çš„é»˜èªå¯¦ç¾,æ­¤é¡æ–¹æ¡ˆè¿”å›ä¸€å€‹Park-Millerå½éš¨æ©Ÿæ•¸ç”Ÿæˆå™¨ç”Ÿæˆçš„éš¨æ©Ÿæ•¸     value = os::random() ;  } else  if (hashCode == 1) {      //æ­¤é¡æ–¹æ¡ˆå°‡å°è±¡çš„å…§å­˜åœ°å€ï¼Œåšç§»ä½é‹ç®—å¾Œèˆ‡ä¸€å€‹éš¨æ©Ÿæ•¸é€²è¡Œç•°æˆ–å¾—åˆ°çµæœ     intptr_t addrBits = cast_from_oop&lt;intptr_t&gt;(obj) &gt;&gt; 3 ;     value = addrBits ^ (addrBits &gt;&gt; 5) ^ GVars.stwRandom ;  } else  if (hashCode == 2) {      //æ­¤é¡æ–¹æ¡ˆå°‡å°è±¡çš„å…§å­˜åœ°å€ï¼Œåšç§»ä½é‹ç®—å¾Œèˆ‡ä¸€å€‹éš¨æ©Ÿæ•¸é€²è¡Œç•°æˆ–å¾—åˆ°çµæœ     value = 1 ;            // for sensitivity testing  } else  if (hashCode == 3) {      //æ­¤é¡æ–¹æ¡ˆè¿”å›ä¸€å€‹è‡ªå¢åºåˆ—çš„ç•¶å‰å€¼     value = ++GVars.hcSequence ;  } else  if (hashCode == 4) {      //æ­¤é¡æ–¹æ¡ˆè¿”å›ç•¶å‰å°è±¡çš„å…§å­˜åœ°å€     value = cast_from_oop&lt;intptr_t&gt;(obj) ;  } else {     //OpenJdk 8 é»˜èªhashCodeçš„è¨ˆç®—æ–¹æ³•     //é€šéå’Œç•¶å‰ç·šç¨‹æœ‰é—œçš„ä¸€å€‹éš¨æ©Ÿæ•¸+ä¸‰å€‹ç¢ºå®šå€¼      //é‹ç”¨Marsaglia&#39;s xorshift schemeéš¨æ©Ÿæ•¸ç®—æ³•å¾—åˆ°çš„ä¸€å€‹éš¨æ©Ÿæ•¸     unsigned t = Self-&gt;_hashStateX ;     t ^= (t &lt;&lt; 11) ;     Self-&gt;_hashStateX = Self-&gt;_hashStateY ;     Self-&gt;_hashStateY = Self-&gt;_hashStateZ ;     Self-&gt;_hashStateZ = Self-&gt;_hashStateW ;     unsigned v = Self-&gt;_hashStateW ;     v = (v ^ (v &gt;&gt; 19)) ^ (t ^ (t &gt;&gt; 8)) ;     Self-&gt;_hashStateW = v ;     value = v ;  }  value &= markOopDesc::hash_mask;  if (value == 0) value = 0xBAD ;  assert (value != markOopDesc::no_hash, &#34;invariant&#34;) ;  TEVENT (hashCode: GENERATE) ;  return value;}</code></pre><p>get_next_hashå‡½æ•¸æ ¹æ“šhashCodeçš„å€¼ï¼Œä¾†æ¡ç”¨ä¸åŒçš„hashCodeè¨ˆç®—æ–¹æ³•ï¼Œç•¶hashCode=0æ™‚ï¼Œæ˜¯OpenJDK6ã€7çš„é»˜èªå¯¦ç¾æ–¹æ³•ï¼Œæ­¤é¡æ–¹æ¡ˆè¿”å›ä¸€å€‹Park-Millerå½éš¨æ©Ÿæ•¸ç”Ÿæˆå™¨ç”Ÿæˆçš„éš¨æ©Ÿæ•¸ï¼›ç•¶hashCode=1æ™‚ï¼Œé€šéå°‡å°è±¡çš„å…§å­˜åœ°å€ï¼Œåšç§»ä½é‹ç®—å¾Œèˆ‡ä¸€å€‹éš¨æ©Ÿæ•¸é€²è¡Œç•°æˆ–å¾—åˆ°çµæœï¼›ç•¶hashCode == 3ï¼Œè¿”å›ä¸€å€‹è‡ªå¢åºåˆ—çš„ç•¶å‰å€¼ï¼›ç•¶hashCode == 4æ™‚ï¼Œè¿”å›ç•¶å‰å°è±¡çš„å…§å­˜åœ°å€ï¼›ç•¶hashCode ç‚ºå…¶ä»–å€¼æ™‚ï¼Œæ˜¯openJDK8 çš„hashCode æ–¹æ³•çš„é»˜èªå¯¦ç¾ã€‚</p><p>openJDK8 çš„é»˜èªhashCodeçš„è¨ˆç®—æ–¹æ³•æ˜¯é€šéå’Œç•¶å‰ç·šç¨‹æœ‰é—œçš„ä¸€å€‹éš¨æ©Ÿæ•¸+ä¸‰å€‹ç¢ºå®šå€¼ï¼Œé‹ç”¨Marsaglia's xorshift schemeéš¨æ©Ÿæ•¸ç®—æ³•å¾—åˆ°çš„ä¸€å€‹éš¨æ©Ÿæ•¸ã€‚xorshiftç®—æ³•æ˜¯é€šéç§»ä½å’Œèˆ‡æˆ–è¨ˆç®—ï¼Œèƒ½å¤ åœ¨è¨ˆç®—æ©Ÿä¸Šä»¥æ¥µå¿«çš„é€Ÿåº¦ç”Ÿæˆå½éš¨æ©Ÿæ•¸åºåˆ—ã€‚ç®—æ³•å¦‚ä¸‹ï¼š</p><pre><code>unsigned long xor128(){	static unsigned long x=123456789,y=362436069,z=521288629,w=88675123;	unsigned long t;	t=(xË†(x&lt;&lt;11));x=y;y=z;z=w;     return( w=(wË†(w&gt;&gt;19))Ë†(tË†(t&gt;&gt;8)) );}</code></pre><p>Self->hashStateX æ˜¯éš¨æ©Ÿæ•¸ã€Self->hashStateY ã€Self->hashStateZã€Self->hashStateW æ˜¯ä¸‰å€‹ç¢ºèªçš„æ•¸ï¼Œåˆ†åˆ¥å°æ‡‰xorshift ç®—æ³•çš„xã€yã€zã€wã€‚</p><p>åœ¨å•Ÿå‹•JVMæ™‚ï¼Œå¯ä»¥é€šéè¨­ç½®<strong>-XX:hashCode</strong>åƒæ•¸ï¼Œæ”¹è®Šé»˜èªçš„hashCodeçš„è¨ˆç®—æ–¹å¼ã€‚</p><h1 class=pgc-h-arrow-right>public boolean equals(Object obj)</h1><pre><code>public boolean equals(Object obj) {        return (this == obj);}</code></pre><p>equalsæ–¹æ³•åˆ¤æ–·å…©å€‹å°è±¡æ˜¯å¦ç›¸ç­‰ï¼Œåœ¨é€™å€‹æ–¹æ³•ä¸­ï¼Œç›´æ¥ç”¨this==objé€²è¡Œæ¯”è¼ƒï¼Œè¿”å›thiså’Œobjæ¯”è¼ƒçš„çµæœï¼Œâ€œ==â€œç¬¦è™Ÿæ˜¯æ¯”è¼ƒå…©å€‹å°è±¡æ˜¯å¦æ˜¯åŒä¸€å€‹å°è±¡ï¼Œæ¯”è¼ƒçš„æ˜¯å…©å€‹å°è±¡å…§å­˜åœ°å€æ˜¯å¦ç›¸ç­‰ã€‚å­é¡åœ¨ç¹¼æ‰¿Objecté¡çš„æ™‚å€™ï¼Œä¸€èˆ¬éœ€è¦é‡å¯«equalsæ–¹æ³•ï¼Œå¦‚æœä¸é‡å¯«ï¼Œé‚£éº¼å°±é»˜èªçˆ¶é¡Objectçš„æ–¹æ³•ï¼Œåœ¨JDKæºç¢¼ä¸­ï¼Œå¾ˆå¤šå°è±¡éƒ½é‡å¯«equalsæ–¹æ³•ï¼Œæ¯”å¦‚Stringé¡ã€‚</p><p>å°æ–¼éç©ºçš„å°è±¡å¼•ç”¨ï¼Œequalsæ–¹æ³•æœ‰å¹¾å€‹æ€§è³ªï¼š</p><li>è‡ªåæ€§ï¼šå°æ–¼ä»»ä½•éç©ºå°è±¡xå’Œyï¼Œå¦‚æœx.equals(y) çš„çµæœç‚ºtrueï¼Œé‚£éº¼y.equals(x) çš„çµæœä¹Ÿç‚ºtrueã€‚</li><li>å‚³éæ€§ï¼šå°æ–¼ä»»ä½•éç©ºå°è±¡xã€yå’Œzï¼Œå¦‚æœx.equals(y)å’Œy.equals(z)çš„çµæœéƒ½ç‚ºtrueï¼Œé‚£éº¼x.equals(z)çš„çµæœä¹Ÿç‚ºtrueã€‚</li><li>ä¸€è‡´æ€§ï¼šå°æ–¼ä»»ä½•éç©ºå°è±¡xå’Œyï¼Œå¦‚æœæœªä¿®æ”¹equalsæ–¹æ³•ï¼Œå¤šæ¬¡èª¿ç”¨equalsæ–¹æ³•çµæœå§‹çµ‚ç‚ºtrueæˆ–è€…falseï¼Œä¸èƒ½é€™æ¬¡è¿”å›trueï¼Œä¸‹æ¬¡è¿”å›falseã€‚</li><li>å°æ–¼ä»»ä½•éç©ºå°è±¡xï¼Œx.equals(null)çš„çµæœæ˜¯falseã€‚</li><p>å­é¡åœ¨ç¹¼æ‰¿Objectï¼Œé‡å¯«equalsæ–¹æ³•æ™‚ï¼Œå¿…é ˆé‡å¯«hashCodeæ–¹æ³•ï¼Œåœ¨hashCodeç´„å®šä¸­ï¼Œå¦‚æœå…©å€‹å°è±¡ç›¸ç­‰ï¼ŒhashCodeå¿…é ˆè¿”å›ç›¸åŒçš„å“ˆå¸Œç¢¼ã€‚å¾ˆå¤šæ™‚å€™ï¼Œå­é¡åœ¨é‡å¯«çˆ¶é¡Objectçš„equalsæ–¹æ³•æ™‚ï¼Œå¾€å¾€æœƒå¿˜äº†é‡å¯«hashCodeï¼Œç•¶é‡å¯«äº†equalsä½†æ²’æœ‰é‡å¯«hashCodeæ–¹æ³•æ™‚ï¼Œé‚£éº¼è©²å­é¡ç„¡æ³•çµåˆjavaé›†åˆæ­£å¸¸é‹è¡Œï¼Œå› ç‚ºjavaé›†åˆå¦‚HashMapã€HashSetç­‰éƒ½æ˜¯åŸºæ–¼å“ˆå¸Œç¢¼é€²è¡Œå­˜å„²çš„ã€‚</p><h1 class=pgc-h-arrow-right>protected native Object clone() throws CloneNotSupportedException;</h1><p>clone()æœ¬åœ°æ–¹æ³•ï¼Œå‰µå»ºä¸¦è¿”å›æ­¤å°è±¡çš„å‰¯æœ¬ï¼Œè©²æ–¹æ³•ä½¿ç”¨protected ä¿®é£¾ï¼ŒObjectä¸èƒ½ç›´æ¥èª¿ç”¨clone()æ–¹æ³•ï¼Œæœƒç·¨è­¯éŒ¯èª¤ï¼š</p><pre><code> Object o=new Object(); //ç·¨è­¯éŒ¯èª¤ Object o1=  o.clone();</code></pre><p>å¦‚æœæƒ³è¦ä½¿ç”¨clone()æ–¹æ³•ï¼Œå­é¡å¿…é ˆé‡å¯«é€™å€‹æ–¹æ³•ï¼Œä¸¦ç”¨publicä¿®é£¾ã€‚å¦‚æœå­é¡æ²’æœ‰å¯¦ç¾clone(),å­é¡é»˜èªèª¿ç”¨çˆ¶é¡çš„cloneæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p><pre><code>public class ObjectCloneTest {    public static void main(String [] args) throws CloneNotSupportedException {        ObjectCloneTest o=new ObjectCloneTest();        ObjectCloneTest cloneTest= (ObjectCloneTest) o.clone();        System.out.println(cloneTest);    }}</code></pre><p>ä½†æ˜¯é‹è¡Œæ™‚ç™¼ç”Ÿç•°å¸¸ï¼š</p><pre><code>Exception in thread &#34;main&#34; java.lang.CloneNotSupportedException: com.lingheng.java.source.ObjectCloneTest	at java.lang.Object.clone(Native Method)	at com.lingheng.java.source.ObjectCloneTest.main(ObjectCloneTest.java:12)</code></pre><p>å¦‚æœå­æ²’æœ‰å¯¦ç¾Cloneableæ¥å£ï¼Œç•¶å­é¡èª¿ç”¨clone()æ–¹æ³•æ™‚ï¼Œæœƒæ‹‹å‡ºCloneNotSupportedExceptionç•°å¸¸ã€‚ç•¶å­é¡å¯¦ç¾Cloneableæ¥å£ï¼Œç¨‹åºé‹è¡ŒæœƒæˆåŠŸï¼š</p><pre><code>//å¯¦ç¾Cloneableæ¥å£public class ObjectCloneTest implements Cloneable{    public static void main(String [] args) throws CloneNotSupportedException {        ObjectCloneTest o=new ObjectCloneTest();        ObjectCloneTest cloneTest= (ObjectCloneTest) o.clone();        System.out.println(&#34;æ‰“å°cloneTestï¼š&#34;+cloneTest);    }}//çµæœæ‰“å°cloneTestï¼šcom.lingheng.java.source.ObjectCloneTest@6d6f6e28</code></pre><p>æ‰€ä»¥ï¼Œ<strong>æƒ³è¦ä½¿ç”¨clone()æ–¹æ³•ï¼Œé™¤äº†ç¹¼æ‰¿Objectå¤–ï¼ˆé»˜èªç¹¼æ‰¿ï¼‰ï¼Œé‚„éœ€è¦å¯¦ç¾Cloneableæ¥å£ã€‚æ‰€æœ‰çš„æ•¸çµ„é»˜èªæ˜¯å¯¦ç¾äº†Cloneableæ¥å£çš„ï¼Œæ•¸çµ„çš„clone()è¿”å›æ•¸çµ„é¡å‹:</strong></p><pre><code>public void arrayClone(){    //å­—ç¬¦ä¸²æ•¸çµ„    String[] s=new String[]{&#34;hello&#34;,&#34;world&#34;};    System.out.println(s);    System.out.println(s.clone());     //æ•´æ•¸æ•¸çµ„     int[] num=new int[]{1,3};     System.out.println(num);     System.out.println(num.clone());}//çµæœ[Ljava.lang.String;@17d10166[Ljava.lang.String;@1b9e1916[I@ba8a1dc[I@4f8e5cde</code></pre><p>å°æ–¼ä»»ä½•å°è±¡xï¼Œå…·æœ‰ä»¥ä¸‹å¹¾å€‹ç´„å®šï¼š</p><ol start=1><li>x.clone() != x ç‚ºtrue</li><li>x.clone().getClass() == x.getClass() ç‚ºtrueï¼Œä½†é€™ä¸æ˜¯å¿…é ˆæ»¿è¶³çš„è¦æ±‚ï¼Œä¹Ÿå°±æ˜¯èªªå¯èƒ½æ˜¯falseã€‚æŒ‰ç…§ç´„å®šï¼Œè¿”å›çš„å°è±¡æ‡‰è©²é€šéèª¿ç”¨super.cloneä¾†ç²å¾—ã€‚å¦‚æœä¸€å€‹é¡å’Œå®ƒæ‰€æœ‰çš„è¶…é¡ï¼ˆé™¤äº†Objectï¼‰ éµå¾ªé€™å€‹ç´„å®šï¼Œé‚£å°±æœƒx.clone().getClass() == x.getClass()ã€‚</li><li>x.clone().equals(x)é€šå¸¸æƒ…æ³ä¸‹ç‚ºtrueï¼Œé€™ä¸æ˜¯å¿…é ˆæ»¿è¶³çš„è¦æ±‚ã€‚</li></ol><p>å°æ–¼ç´„å®š1ï¼Œå› ç‚ºæ‹·è²æ˜¯å‰µå»ºä¸€å€‹æ–°çš„å°è±¡ï¼Œæ‰€ä»¥æ‹·è²çš„å°è±¡å’ŒåŸå°è±¡æ˜¯ä¸ç›¸ç­‰çš„ã€‚</p><p>å°æ–¼ç´„å®š2ï¼Œé€™å€‹æ¯”è¼ƒå¥½ç†è§£ï¼Œä¸€å€‹é¡å’Œå®ƒæ‰€æœ‰çš„è¶…é¡çš„cloneæ–¹æ³•éƒ½èª¿ç”¨super.clone()ç²å–è¿”å›å°è±¡ï¼Œæ‰€ä»¥é€™å€‹é¡çš„Classå€‹åŸå°è±¡çš„Claasæ˜¯ä¸€æ¨£çš„ã€‚cloneè¿”å›çš„é¡å‹æ˜¯Objecté¡ï¼Œä¹Ÿå°±æ˜¯èªªï¼Œåœ¨cloneä¸­å¯ä»¥è¿”å›åªè¦æ˜¯Objectçš„å­é¡å°±å¯ä»¥äº†ï¼Œé€™æ¨£çš„è©±ï¼Œx.clone().getClass() == x.getClass()çš„çµæœç‚ºfalseï¼›</p><p>å°æ–¼ç´„å®š3ï¼Œé€™ä¸æ˜¯å¿…é ˆæ»¿è¶³çš„æ¢ä»¶ï¼Œç•¶åœ¨cloneä¸­æ”¹è®Šäº†å°è±¡çš„å±¬æ€§å€¼ï¼Œé‚£éº¼x.clone().equals(x)çš„çµæœå°±å¯èƒ½ä¸æ˜¯trueäº†ã€‚</p><p>åˆ†æäº†Javaå±¤é¢çš„cloneçš„ç´„å®šï¼Œæˆ‘å€‘å¾JVMå±¤é¢çœ‹çœ‹cloneåº•å±¤çš„å¯¦ç¾ï¼Œåœ¨registerNativeså‡½æ•¸ä¸­æœƒåŠ è¼‰cloneçš„JVMå¯¦ç¾JVM_Cloneï¼ŒJVM_Cloneçš„å¯¦ç¾å¦‚ä¸‹ï¼š</p><pre><code>//JVM_Clone çš„å¯¦ç¾JVM_ENTRY(jobject, JVM_Clone(JNIEnv* env, jobject handle))  JVMWrapper(&#34;JVM_Clone&#34;);  Handle obj(THREAD, JNIHandles::resolve_non_null(handle));  const KlassHandle klass (THREAD, obj-&gt;klass());  JvmtiVMObjectAllocEventCollector oam;#ifdef ASSERT  // Just checking that the cloneable flag is set correct//å¦‚æœæ˜¯å‚³å…¥çš„æ˜¯æ•¸çµ„  if (obj-&gt;is_array()) {      //æ‰€æœ‰çš„æ•¸çµ„éƒ½é»˜èªå¯¦ç¾äº†Cloneableæ¥å£    guarantee(klass-&gt;is_cloneable(), &#34;all arrays are cloneable&#34;);  } else {      //æ˜¯å¦æ˜¯å¯¦ä¾‹    guarantee(obj-&gt;is_instance(), &#34;should be instanceOop&#34;);    bool cloneable = klass-&gt;is_subtype_of(SystemDictionary::Cloneable_klass());      //åˆ¤æ–·æ˜¯å¦æ˜¯åˆæ³•çš„cloneable    guarantee(cloneable == klass-&gt;is_cloneable(), &#34;incorrect cloneable flag&#34;);  }#endif----------------------------------åˆ†å‰²ç·š1-------------------------------------------------// Check if class of obj supports the Cloneable interface. // All arrays are considered to be cloneable (See JLS 20.1.5)    //å¦‚æœæ²’æœ‰å¯¦ç¾Cloneableæ¥å£ï¼Œæ‹‹å‡ºCloneNotSupportedExceptionç•°å¸¸  if (!klass-&gt;is_cloneable()) {    ResourceMark rm(THREAD);    THROW_MSG_0(vmSymbols::java_lang_CloneNotSupportedException(), klass-&gt;external_name());  }  // Make shallow object copy 	//æ·ºæ‹·è²  const int size = obj-&gt;size();  oop new_obj = NULL;  if (obj-&gt;is_array()) {//æ•¸çµ„      //æ•¸çµ„çš„é•·åº¦    const int length = ((arrayOop)obj())-&gt;length();     //ç”³è«‹å…§å­˜ï¼Œå‰µå»ºæ–°çš„æ•¸çµ„    new_obj = CollectedHeap::array_allocate(klass, size, length, CHECK_NULL);  } else {    //ç”³è«‹å…§å­˜ï¼Œå‰µå»ºæ–°çš„å°è±¡    new_obj = CollectedHeap::obj_allocate(klass, size, CHECK_NULL);  }----------------------------------åˆ†å‰²ç·š2------------------------------------------------- // 4839641 (4840070): We must do an oop-atomic copy, because if another thread  // is modifying a reference field in the clonee, a non-oop-atomic copy might  // be suspended in the middle of copying the pointer and end up with parts  // of two different pointers in the field.  Subsequent dereferences will crash.  // 4846409: an oop-copy of objects with long or double fields or arrays of same  // won&#39;t copy the longs/doubles atomically in 32-bit vm&#39;s, so we copy jlongs instead  // of oops.  We know objects are aligned on a minimum of an jlong boundary.  // The same is true of StubRoutines::object_copy and the various oop_copy  // variants, and of the code generated by the inline_native_clone intrinsic.  assert(MinObjAlignmentInBytes &gt;= BytesPerLong, &#34;objects misaligned&#34;);  //åŸå­æ€§æ‹·è²ï¼Œå¯èƒ½å¦å¤–ä¸€å€‹ç·šç¨‹æœƒä¿®æ”¹cloneå¼•ç”¨çš„å­—æ®µ  Copy::conjoint_jlongs_atomic((jlong*)obj(), (jlong*)new_obj,                               (size_t)align_object_size(size) / HeapWordsPerLong);  // Clear the header  new_obj-&gt;init_mark();  // Store check (mark entire object and let gc sort it out)  BarrierSet* bs = Universe::heap()-&gt;barrier_set();  assert(bs-&gt;has_write_region_opt(), &#34;Barrier set does not have write_region&#34;);  bs-&gt;write_region(MemRegion((HeapWord*)new_obj, size));  // Caution: this involves a java upcall, so the clone should be  // &#34;gc-robust&#34; by this stage.  //ç•¶javaå­é¡å¯¦ç¾äº†finalizeæ–¹æ³•ï¼Œå·²ç¶“èª¿ç”¨finalizeï¼Œè¨»å†Šfinalizeræ–¹æ³•  if (klass-&gt;has_finalizer()) {    assert(obj-&gt;is_instance(), &#34;should be instanceOop&#34;);    new_obj = InstanceKlass::register_finalizer(instanceOop(new_obj), CHECK_NULL);  }	//å‰µå»ºæ‹·è²çš„å°è±¡è¿”å›  return JNIHandles::make_local(env, oop(new_obj));JVM_END</code></pre><p>JVM_Cloneçš„å¯¦ç¾éç¨‹æ¯”è¼ƒé•·ï¼Œæˆ‘å°‡åˆ†å‰²æˆä¸‰éƒ¨åˆ†ï¼Œåˆ†å‰²ç·š1ä¸Šéƒ¨åˆ†ä¸»è¦æ˜¯æª¢æŸ¥æ‹·è²çš„ä¸€äº›æ¨™èªŒæ˜¯å¦æ­£ç¢ºï¼Œåˆ¤æ–·å‚³å…¥çš„æ˜¯æ•¸çµ„é‚„æ˜¯å°è±¡ï¼Œåœ¨ä¸Šé¢æˆ‘è¬›éæ‰€æœ‰çš„æ•¸çµ„éƒ½é»˜èªå¯¦ç¾äº†Cloneableæ¥å£ï¼Œåœ¨é€™è£¡å°±å¯ä»¥è­‰æ˜äº†ã€‚ç„¶å¾Œé‚„åˆ¤æ–·äº†å‚³å…¥çš„å°è±¡æ˜¯å¦ç¹¼æ‰¿Cloneableæ¥å£ï¼Œæ²’æœ‰ç¹¼æ‰¿çš„è©±ï¼Œå°±æ˜¯éæ³•çš„ï¼Œé€™æ˜¯ç¬¬ä¸€æ®µé‚è¼¯ã€‚</p><p>åˆ†å‰²ç·šä¸­é–“éƒ¨åˆ†çš„é‚è¼¯ï¼Œä¸»è¦æ˜¯ç”³è«‹å…§å­˜ï¼Œä¾›æ‹·è²çš„æ™‚å€™ä½¿ç”¨ã€‚é¦–å…ˆå…ˆåˆ¤æ–·æ˜¯å¦å¯¦ç¾Cloneableæ¥å£ï¼Œå¦‚æœæ²’æœ‰æ‹‹å‡ºCloneNotSupportedExceptionç•°å¸¸ï¼Œç„¶å¾Œæ ¹æ“šå‚³å…¥çš„æ˜¯æ•¸çµ„é‚„æ˜¯å°è±¡ï¼Œèª¿ç”¨ä¸åŒçš„æ–¹æ³•é€²è¡Œç”³è«‹ä¸åŒå¤§å°çš„å…§å­˜ã€‚ä»£ç¢¼çš„æœ‰æ®µè¨»é‡‹æ˜¯â€Make shallow object copy â€œï¼Œå°±æ˜¯èªªé€™è£¡çš„æ‹·è²æ˜¯æ·ºæ‹·è²ã€‚</p><p>æœ€å¾Œçš„é‚è¼¯æ˜¯ï¼Œåšä¸€äº›æª¢æŸ¥ï¼Œæœ€å¾Œè¿”å›æ–°å‰µå»ºçš„æ‹·è²å°è±¡ã€‚å› ç‚ºå°è±¡çš„å±¬æ€§å¯èƒ½è¢«å¦å¤–ä¸€å€‹ç·šç¨‹æ”¹è®Šï¼Œæ‰€ä»¥é€²è¡Œçš„æ˜¯åŸå­æ€§çš„æ‹·è²ï¼Œæœ€å¾Œå‰µå»ºæ‹·è²çš„å°è±¡é€²è¡Œè¿”å›ã€‚é€™äº›æºç¢¼çš„è¨»é‡‹å¾ˆè©³ç´°ï¼Œæœ‰èˆˆè¶£çš„å¯ä»¥å…·é«”çœ‹çœ‹å…¶ä»–çš„ä¸€äº›é‚è¼¯ã€‚</p><h1 class=pgc-h-arrow-right>public String toString()</h1><p>oString()è¿”å›å°è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ï¼Œæœ€å¥½æ‰€æœ‰Objectçš„å­é¡éƒ½é‡å¯«é€™å€‹æ–¹æ³•ï¼ŒObjecté¡çš„toStringæ–¹æ³•è¿”å›çš„æ˜¯"é¡å@å“ˆå¸Œç¢¼çš„åå…­é€²åˆ¶ï¼Œä»£ç¢¼å¯¦ç¾å¦‚ä¸‹ï¼š</p><pre><code>public String toString() {        return getClass().getName() + &#34;@&#34; + Integer.toHexString(hashCode());}</code></pre><p>ç•¶æˆ‘å€‘åœ¨ä»£ç¢¼è¼¸å…¥ä½¿ç”¨System.out.printlnè¼¸å…¥å°è±¡çš„æ™‚å€™ï¼Œæœƒèª¿ç”¨é€™å€‹å°è±¡çš„toStringæ–¹æ³•ï¼Œè¿”å›çš„æ˜¯toStringçš„å­—ç¬¦ä¸²ã€‚ä¸€èˆ¬åœ¨é‡å¯«çš„toStringçš„éç¨‹ï¼Œè¿”å›çš„å­—ç¬¦ä¸²è¦æ˜“è®€çš„ã€‚</p><p>Objecté¡çš„æºç¢¼å…ˆåˆ†æåˆ°é€™è£¡ï¼Œå› ç‚ºåˆ†æçš„ç­†è¨˜æœƒæ¯”è¼ƒé•·ï¼Œæˆ‘å°‡ç”¨å…©ç¯‡æ–‡ç« ä¾†ç™¼è¡¨ã€‚<strong>æƒ³è¦ç­†è¨˜çš„å¯ä»¥é—œæ³¨ä¸¦ç§ä¿¡æˆ‘ã€‚</strong></p><p></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>JVM</a></li><li><a>å±¤é¢</a></li><li><a>Java</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/59d7c87e.html alt=JVM/ä½µç™¼/MySQL/Java/ç¶²çµ¡ç­‰ä¸€å€‹éƒ½æ²’è‚å®Œï¼Œæƒ³æ“ BATä½ èªªé›£ä¸é›£ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/80833d07a23e4e4c8677376189188e4d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/59d7c87e.html title=JVM/ä½µç™¼/MySQL/Java/ç¶²çµ¡ç­‰ä¸€å€‹éƒ½æ²’è‚å®Œï¼Œæƒ³æ“ BATä½ èªªé›£ä¸é›£ï¼Ÿ>JVM/ä½µç™¼/MySQL/Java/ç¶²çµ¡ç­‰ä¸€å€‹éƒ½æ²’è‚å®Œï¼Œæƒ³æ“ BATä½ èªªé›£ä¸é›£ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9891406.html alt=ç¨‹åºå“¡ï¼šæ·±å…¥ç†è§£JVMï¼Œå¾JVMå±¤é¢ä¾†è¬›Javaå¤šæ…‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/dde11845-76d0-4452-af65-97e0e223c1cf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9891406.html title=ç¨‹åºå“¡ï¼šæ·±å…¥ç†è§£JVMï¼Œå¾JVMå±¤é¢ä¾†è¬›Javaå¤šæ…‹>ç¨‹åºå“¡ï¼šæ·±å…¥ç†è§£JVMï¼Œå¾JVMå±¤é¢ä¾†è¬›Javaå¤šæ…‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c3cb200.html alt=ã€ŒJavaçš„JVMåˆ†æã€JDKç›£æ§å’Œæ•…éšœè™•ç†å·¥å…·ï¼Œå­¸æœƒåˆ†æç¨‹åº class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/fb7c5a5f91ff439cbd458318d4316adf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c3cb200.html title=ã€ŒJavaçš„JVMåˆ†æã€JDKç›£æ§å’Œæ•…éšœè™•ç†å·¥å…·ï¼Œå­¸æœƒåˆ†æç¨‹åº>ã€ŒJavaçš„JVMåˆ†æã€JDKç›£æ§å’Œæ•…éšœè™•ç†å·¥å…·ï¼Œå­¸æœƒåˆ†æç¨‹åº</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/48ba24d7.html alt=æ·±å…¥æ·ºå‡ºï¼šJavaäº‹å‹™åŸç†å’Œæ‡‰ç”¨å…¼JDBCäº‹å‹™è©³è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/3c5e0002a8059c1311aa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/48ba24d7.html title=æ·±å…¥æ·ºå‡ºï¼šJavaäº‹å‹™åŸç†å’Œæ‡‰ç”¨å…¼JDBCäº‹å‹™è©³è§£>æ·±å…¥æ·ºå‡ºï¼šJavaäº‹å‹™åŸç†å’Œæ‡‰ç”¨å…¼JDBCäº‹å‹™è©³è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b8bda645.html alt=ã€ŒJavaã€éš¨æ©Ÿæ•¸è©³è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b471807e699b44c2b1dedc580ea3f3af style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b8bda645.html title=ã€ŒJavaã€éš¨æ©Ÿæ•¸è©³è§£>ã€ŒJavaã€éš¨æ©Ÿæ•¸è©³è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cf633068.html alt="Java å¤šæ…‹çš„å¯¦ç¾æ©Ÿåˆ¶ï¼Œçœ‹äº†éƒ½èªªå¥½" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9d3b0e55813d46b4982ae7d9b81d1802 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cf633068.html title="Java å¤šæ…‹çš„å¯¦ç¾æ©Ÿåˆ¶ï¼Œçœ‹äº†éƒ½èªªå¥½">Java å¤šæ…‹çš„å¯¦ç¾æ©Ÿåˆ¶ï¼Œçœ‹äº†éƒ½èªªå¥½</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/12498348.html alt="Java ç·¨è­¯æ™‚å¤šæ…‹å’Œé‹è¡Œæ™‚å¤šæ…‹" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1531535784468c357213ffe style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/12498348.html title="Java ç·¨è­¯æ™‚å¤šæ…‹å’Œé‹è¡Œæ™‚å¤šæ…‹">Java ç·¨è­¯æ™‚å¤šæ…‹å’Œé‹è¡Œæ™‚å¤šæ…‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d60e504d.html alt=JavaåŸºç¤ä¹‹å¤šæ…‹ï¼Œå‹•æ…‹ç¶å®šå¤šæ…‹çš„ä»£ç¢¼æ¡ˆä¾‹ï¼Œç°¡å–®å»å¾ˆé‡è¦ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ab338c7287fe4649a96227987579c844 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d60e504d.html title=JavaåŸºç¤ä¹‹å¤šæ…‹ï¼Œå‹•æ…‹ç¶å®šå¤šæ…‹çš„ä»£ç¢¼æ¡ˆä¾‹ï¼Œç°¡å–®å»å¾ˆé‡è¦>JavaåŸºç¤ä¹‹å¤šæ…‹ï¼Œå‹•æ…‹ç¶å®šå¤šæ…‹çš„ä»£ç¢¼æ¡ˆä¾‹ï¼Œç°¡å–®å»å¾ˆé‡è¦</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bb876e43.html alt=Javaç‰¹æ€§ä¹‹ä¸€ï¼šå¤šæ…‹è©³è§£ï¼Œå­¸javaä¸æ±‚äºº class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/39a700034bab2e1401a3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bb876e43.html title=Javaç‰¹æ€§ä¹‹ä¸€ï¼šå¤šæ…‹è©³è§£ï¼Œå­¸javaä¸æ±‚äºº>Javaç‰¹æ€§ä¹‹ä¸€ï¼šå¤šæ…‹è©³è§£ï¼Œå­¸javaä¸æ±‚äºº</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/234d55fa.html alt=Javaé–‹ç™¼èª²ç¨‹ï¼ˆåï¼‰â€”â€”é¢å‘å°è±¡5ã€å¤šæ…‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/df3621e51e4242fd90731dd013472f12 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/234d55fa.html title=Javaé–‹ç™¼èª²ç¨‹ï¼ˆåï¼‰â€”â€”é¢å‘å°è±¡5ã€å¤šæ…‹>Javaé–‹ç™¼èª²ç¨‹ï¼ˆåï¼‰â€”â€”é¢å‘å°è±¡5ã€å¤šæ…‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/96d2083b.html alt=ã€ŒJavaä¸‰åˆ†é˜ã€Javaä¸‰å¤§ç‰¹æ€§â€”â€”å¤šæ…‹ç†è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/6a9b8965-0a4c-4cb4-9389-6cbbda0e9d93 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/96d2083b.html title=ã€ŒJavaä¸‰åˆ†é˜ã€Javaä¸‰å¤§ç‰¹æ€§â€”â€”å¤šæ…‹ç†è§£>ã€ŒJavaä¸‰åˆ†é˜ã€Javaä¸‰å¤§ç‰¹æ€§â€”â€”å¤šæ…‹ç†è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b96b5bf9.html alt=å¦‚ä½•æ­£ç¢ºèªè­˜Javaå¤šæ…‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d2896b2f39694d39957b901a62cfe7fb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b96b5bf9.html title=å¦‚ä½•æ­£ç¢ºèªè­˜Javaå¤šæ…‹>å¦‚ä½•æ­£ç¢ºèªè­˜Javaå¤šæ…‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8a7023ee.html alt="Java å¸¸è¦‹çš„49å€‹éŒ¯èª¤åŠé¿å…æ–¹æ³•ï¼ç¿»è­¯ä½œæ¥­ï¼šç¢¼è¾²ç¶²-å°å³°" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/3c5a0001a9e3fd1b8a13 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8a7023ee.html title="Java å¸¸è¦‹çš„49å€‹éŒ¯èª¤åŠé¿å…æ–¹æ³•ï¼ç¿»è­¯ä½œæ¥­ï¼šç¢¼è¾²ç¶²-å°å³°">Java å¸¸è¦‹çš„49å€‹éŒ¯èª¤åŠé¿å…æ–¹æ³•ï¼ç¿»è­¯ä½œæ¥­ï¼šç¢¼è¾²ç¶²-å°å³°</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/adc31f83.html alt=Javaé¢è©¦çŸ¥è­˜é»ç¸½çµâ‘¥â€”â€”ç®—æ³•èˆ‡æ•¸æ“šçµæ§‹_ä¸€é»èª²å ‚ï¼ˆå¤šå²¸å­¸é™¢ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/68ac43b98fa343f2874d08bacae73ee8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/adc31f83.html title=Javaé¢è©¦çŸ¥è­˜é»ç¸½çµâ‘¥â€”â€”ç®—æ³•èˆ‡æ•¸æ“šçµæ§‹_ä¸€é»èª²å ‚ï¼ˆå¤šå²¸å­¸é™¢ï¼‰>Javaé¢è©¦çŸ¥è­˜é»ç¸½çµâ‘¥â€”â€”ç®—æ³•èˆ‡æ•¸æ“šçµæ§‹_ä¸€é»èª²å ‚ï¼ˆå¤šå²¸å­¸é™¢ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8c21d419.html alt="æ·±å…¥ç†è§£ Java ä½µç™¼æ ¸å¿ƒæ©Ÿåˆ¶ï¼Œçœ‹å®Œå¾Œå¥½çˆ½" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/832db421a3364a20a62c93127ea6e862 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8c21d419.html title="æ·±å…¥ç†è§£ Java ä½µç™¼æ ¸å¿ƒæ©Ÿåˆ¶ï¼Œçœ‹å®Œå¾Œå¥½çˆ½">æ·±å…¥ç†è§£ Java ä½µç™¼æ ¸å¿ƒæ©Ÿåˆ¶ï¼Œçœ‹å®Œå¾Œå¥½çˆ½</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>