<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>簡析面向切面編程（AOP） 一點課堂（多岸學院） | 极客快訊</title><meta property="og:title" content="簡析面向切面編程（AOP） 一點課堂（多岸學院） - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/3325c54c3e7b41da9eb735d23570b305"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8a1e230d.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8a1e230d.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8a1e230d.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8a1e230d.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8a1e230d.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8a1e230d.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/8a1e230d.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/8a1e230d.html><meta property="article:published_time" content="2020-11-14T21:04:29+08:00"><meta property="article:modified_time" content="2020-11-14T21:04:29+08:00"><meta name=Keywords content><meta name=description content="簡析面向切面編程（AOP） 一點課堂（多岸學院）"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/8a1e230d.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>簡析面向切面編程（AOP） 一點課堂（多岸學院）</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>看到 AOP，那麼一定會聯想到 OOP，也就是面向對象編程。AOP 和 OOP 是在不同業務場景下的兩種設計思想，本文將盡量用生動有趣的語言介紹 AOP 在前端領域的應用以及 AOP 和 OOP 之間的區別。在這之前，我們先了解兩者的基本概念。</p><p>1.面向對象編程（OOP）</p><p>對於面向對象編程的嚴格概念，每個人都有自己的理解，筆者也不在此二次解讀了。但是我們可以舉一個生活中的例子來類比，為後文做鋪墊：</p><p>有這樣一個女孩，她每個月底都要充話費。每次充話費的時候，她都要打開支付寶，填寫手機號碼，再選擇充值金額，最後點擊充值按鈕完成充值。整個過程，我們可以稱之為面向過程充值。</p><p>後來，她找了男朋友，給手機充話費的重擔就落在了男朋友身上。於是女孩每次充值前，都會把充值金額發給男朋友，男朋友完成操作後告訴她充值好了。整個過程，我們可以稱之為面向對象充值。因為女孩只需要關心充值金額和充值結果即可，不用關心具體怎麼充值的。</p><p>2.面向切面編程（AOP）</p><p>面向對象編程好像已經能滿足大部分場景了，可以擴展可以複用，那面向切面編程又是為了解決什麼問題呢？基於上文的充值例子，我們拓展一下場景：</p><p>過了一段時間，女孩發現男朋友只會用支付寶充值話費，某天她想讓男友用微信充值，但是發現市面上的手機無法同時安裝微信和支付寶。女孩不得不又找了一個手機裡有微信的男朋友。可是同時交往兩個男朋友心力交瘁，女孩該怎麼辦呢？</p><p>面向切面充值提供瞭解決方案：女孩額外買了兩支手機，一支裝有微信，另一隻裝有支付寶，然後她甩掉了其中一個男朋友。這樣每次她想讓男朋友幫忙充話費的時候，就把兩支手機中的一支給男朋友，並且使用微信還是支付寶，女孩可以自己決定。</p><p>講到這裡，相信讀者腦海中對 AOP 和 OOP 的區別已經有了大致的輪廓了。AOP 的具體定義是什麼？它是一種通過預編譯或運行期動態代理實現邏輯功能統一維護的技術。OOP 是針對對象屬性和行為的封裝，而 AOP 是針對某個步驟和階段的，上面例子的"男朋友"就是對象的封裝，而"充值方式（支付寶/微信）"則是"充值"行為的邏輯片段。可以說，AOP 是對 OOP 的進一步增強。</p><p>AOP 有如下三個主要概念：</p><p>1.切面（Aspect）</p><p>這也是 AOP 首字母A的由來，切面 = 切入點 + 通知。</p><p>2.切入點（Pointcut）</p><p>切入點是指具體被增強的類或者方法。</p><p>3.通知（Advice）</p><p>在切入點執行時的增強處理，類似回調函數的作用，例如下文將要提到的 Dojo 的after等方法就是通知。</p><p>接下來我們寫一段代碼，來切實感受下以上三個抽象的概念。假設我們有一個對象，其中含有一個打印的方法：let TestObj = {log: () => {console.log('打印log');}}</p><p>我們希望程序增加一個功能，在打印之前告訴我們要打印了，在打印之後也告訴我們執行結束，但是不能去改動對象內部的代碼，那麼我們可以編寫一個新的方法：let emitter = (target) {console.log('即將開始打印');target.log();console.log('打印結束');}</p><p>emitter(TestObj);</p><p>上述代碼是實現 AOP 最簡單和典型的方式。emitter函數並沒有改變原有對象的邏輯，僅僅做了“包裝”和“增強”，那麼一般把log方法稱之為切入點，它前後執行的console.log稱之為通知，emitter稱為切片，而TestObj稱為切面。</p><p>3.前端為什麼需要AOP</p><p>AOP 在 Spring 框架中有的大量的應用，不過這並不屬於前端範疇，我們姑且不做討論。前端的 Dojo 框架可以算是早期在底層應用 AOP 思想的代表，它內部提供了 aspect 模塊。 aspect 模塊提供了三個方法：•after•before•around</p><p>從三個方法的名字中我們就能大概猜到他們的用處，以傳輸 ajax 請求為例，before用於發送請求前對參數做最後的處理，after用於處理 ajax 返回的數據，around則是在請求過程中使用。三個方法都不會改變核心代碼的邏輯，僅僅起到“包裝”的作用，和 JS 的前調函數和回調函數非常類似。來到現代前端開發，我們經常遇到和使用表單。當然，我們會把各式各樣的業務表單封裝成業務表單組件，因為這樣能夠很好地降低開發工作量。</p><p>可是有一天，產品經理要求每個業務表單組件提交時都需要埋點。於是我們決定將埋點邏輯添加到每個業務組件中，但是這些埋點邏輯是完全一樣的，免不了複製粘貼。有沒有什麼辦法複用埋點邏輯呢？依據 OOP 的思想，我們考慮將埋點邏輯抽象成一個單獨的Log 類，並在業務組件內調用。但是這樣又造成了副作用，Log 會與業務組件發生耦合，每當 Log 類發生改動時，所有的業務組件埋點行為都會發生變化，這又是令人頭疼的。所以我們需要一種新的編碼方式，可以動態地將 Log 埋點邏輯注入到指定組件內部甚至內部指定方法，解決方案與上面的示例代碼思路相同，這種編程思想就是 AOP。</p><p>4.前端領域的AOP</p><p>1.javascript</p><p>因為 AOP並不是前端源起的概念，所以在 ES6 發佈之前，只能使用原生 js 進行抽象模擬，而且一種常用的解決方法是改造Function的原型，極易出現 bug。而在 ES6 發佈之後，裝飾器（Decorator）作為正式標準引入了 Javascript。該標準是從其他面嚮對象語言中借鑑來的，對於前端開發而言，可以更加規範地通過 AOP 思想編寫代碼。與 python 類似，js 使用@關鍵字。我們來看下用法：</p><pre> @decorator class TestClass { // ... } function decotator(targetClass) { targetClass.rejectDecorator = true; } TestClass.rejectDecorator // true</pre><p>從上述代碼可以看出，裝飾器decorator修改了組件內部的變量，而裝飾器實質上就是一個函數。既然是函數，那麼必然可以通過傳入的參數來控制裝飾器的行為：</p><pre> function proDecorator(boolValue) { return function(targetClass) { target.rejectDecorator = boolValue; } } @proDecorator(true) class TestClass() {} TestClass.rejectDecorator // true @proDecorator(false) class TestClass() {} TestClass.rejectDecorator // false</pre><p>裝飾器不但可以修飾類，也可以修飾類中的方法。我們上面提到的 Log 問題，就可以通過使用裝飾器修飾內部方法來解決：</p><pre> class TestClass { @log add(a, b) { return a + b; } } function log(target, name, descriptor){ let oldValue = descriptor.value; descriptor.value = function() { console.log(`Calling ${name} with`, arguments); return oldValue.apply(this, arguments); }; return descriptor; } const Test = new TestClass(); const num = Test.add(2, 4); console.log(num); // calling add with [object Arguments] { ... } // 6</pre><p>裝飾器用法還有很多，感興趣的讀者可以自行查閱，本文不再贅述。通過上述代碼我們發現，裝飾器很好地實現了 AOP 所倡導的設計理念，同時其本身又可以參數定製化，擺脫了傳統函數式工具的限制。</p><p>2.React</p><p>對於 React 熟悉的讀者應該聽過 Mixin，它是一種組織 React 內部函數的方法。而後來 Facebook 官方逐漸棄用了這種模式，推薦開發者使用高階組件（HOC）。其實 HOC 就是一種典型的在 AOP 思想指導下的編碼方式，我們看如下代碼：</p><pre> //WrappedComponent為被處理組件 function HOC(WrappedComponent){ return class HOC extends Component { render(){ const newProps = {type:'HOC'}; return &lt;div&gt; &lt;WrappedComponent {...this.props} {...newProps}/&gt; &lt;/div&gt; } } } @HOC class OriginComponent extends Component { render(){ return &lt;div&gt;這是原始組件&lt;/div&gt; } } //const newComponent = HOC(OriginComponent)  WX20180817-115140</pre><div class=pgc-img><img alt="簡析面向切面編程（AOP） 一點課堂（多岸學院）" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3325c54c3e7b41da9eb735d23570b305><p class=pgc-img-caption></p></div><p>我們看到，在HOC函數內部聲明瞭新的newProps，在render時將其添加到原始組件的props中。本身 React 組件就是類的一種，那麼@HOC作用與裝飾器作用完全相同。在 AOP 思想指導下，我們想對原始組件進行改造，比如增加一些props，不必親自去改動內部代碼，在組件外部添加裝飾器即可。</p><p>5.總結</p><p>AOP 和 OOP 本身並不矛盾，在軟件開發中，我們可以基於 OOP 對代碼結構進行縱向劃分模塊，同時基於 AOP 橫向注入邏輯單元，從而使軟件結構更為立體。兩者相輔相成，才能提高軟件工程的健壯性。</p><div class=pgc-img><img alt="簡析面向切面編程（AOP） 一點課堂（多岸學院）" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/613fe313067d424cae0628d27db7ed28><p class=pgc-img-caption></p></div><p>想要深入學習的同學們可以加入QQ群討論哦，QQ討論群組：984370849 706564342 歡迎加入討論我們有高階完整資源筆記分享，也有我們的群體有IT各業人員，可以快速解決在這裡尋找到解決問題的辦法，沒錯，我們等著你，分享我們之間的經驗，以及我們之間共同但又不同的故事。</p><div class=pgc-img><img alt="簡析面向切面編程（AOP） 一點課堂（多岸學院）" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/59c71f25742a4b17966f9874851884ac><p class=pgc-img-caption></p></div></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>簡析</a></li><li><a>編程</a></li><li><a>AOP</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/60d27d99.html alt=Spring面向切面編程AOP的初步瞭解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6eb76749eacf41f1ac8d6bb660ae18ab style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/60d27d99.html title=Spring面向切面編程AOP的初步瞭解>Spring面向切面編程AOP的初步瞭解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a7b6ff44.html alt=談談AOP（面向切面編程） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1534580818763e7a06b5c87 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a7b6ff44.html title=談談AOP（面向切面編程）>談談AOP（面向切面編程）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/82a2f71a.html alt=面向切面編程（AOP）中的術語你能說出幾個？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/5436586b-f08f-4845-b15a-7da897dc9b16 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/82a2f71a.html title=面向切面編程（AOP）中的術語你能說出幾個？>面向切面編程（AOP）中的術語你能說出幾個？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0ef619f7.html alt=Autofac的AOP面向切面編程研究 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/15b5a9a952f84c688e4f9a33c0fe0f13 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0ef619f7.html title=Autofac的AOP面向切面編程研究>Autofac的AOP面向切面編程研究</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2798be0b.html alt="Spring AOP 面向切面編程需要知道的事" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/63832e5a-4ec8-451b-87cf-c6295ac2adf5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2798be0b.html title="Spring AOP 面向切面編程需要知道的事">Spring AOP 面向切面編程需要知道的事</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/af398a38.html alt=Spring—面向切面編程（AOP）詳解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/3ad8b3ec-d7c5-4b89-9b46-e473a4f5d570 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/af398a38.html title=Spring—面向切面編程（AOP）詳解>Spring—面向切面編程（AOP）詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/90a3b194.html alt="Spring：AOP 面向切面編程" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/2e916acf35c540c59694eae279114599 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/90a3b194.html title="Spring：AOP 面向切面編程">Spring：AOP 面向切面編程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7d826c93.html alt=spring框架之AOP面向切面編程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9b61c468edc241dda89e2ac1e5fabd74 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7d826c93.html title=spring框架之AOP面向切面編程>spring框架之AOP面向切面編程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d371c81c.html alt=一招學會面向切面編程(AOP) class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d371c81c.html title=一招學會面向切面編程(AOP)>一招學會面向切面編程(AOP)</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c98c28c3.html alt=使用註解方式配置Spring中的面向切面編程AOP class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c98c28c3.html title=使用註解方式配置Spring中的面向切面編程AOP>使用註解方式配置Spring中的面向切面編程AOP</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c1d85759.html alt=程序開發技巧：AOP面向切面編程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/a302cf66-000b-4516-8077-4243a4fc069d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c1d85759.html title=程序開發技巧：AOP面向切面編程>程序開發技巧：AOP面向切面編程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/800c0c72.html alt=輕鬆理解AOP(面向切面編程) class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e2b0a6818e8a4e67965808f3fc2ab237 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/800c0c72.html title=輕鬆理解AOP(面向切面編程)>輕鬆理解AOP(面向切面編程)</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9cfcdd6f.html alt=《JAVA編程思想》5分鐘速成：第8章（多態） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/399a29d93fde48fca4bae44dffbced07 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9cfcdd6f.html title=《JAVA編程思想》5分鐘速成：第8章（多態）>《JAVA編程思想》5分鐘速成：第8章（多態）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5776a5ae.html alt=明朝迅速走向衰落的原因簡析：經濟危機和政治缺陷難以克服 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/91e01b8cc6544b9abedefe6a66cbb95e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5776a5ae.html title=明朝迅速走向衰落的原因簡析：經濟危機和政治缺陷難以克服>明朝迅速走向衰落的原因簡析：經濟危機和政治缺陷難以克服</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ede16bf9.html alt=「編程基礎」PHP基礎教程（二） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/17685aad04c54d02928724fb99fea026 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ede16bf9.html title=「編程基礎」PHP基礎教程（二）>「編程基礎」PHP基礎教程（二）</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>