<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 | 极客快訊</title><meta property="og:title" content="電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/8d304ea806844def81454ee6df8f69d6"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/90614ae7.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/90614ae7.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/90614ae7.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/90614ae7.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/90614ae7.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/90614ae7.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/90614ae7.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/90614ae7.html><meta property="article:published_time" content="2020-10-29T21:10:19+08:00"><meta property="article:modified_time" content="2020-10-29T21:10:19+08:00"><meta name=Keywords content><meta name=description content="電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/90614ae7.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>一、計算機網絡的4大發展階段</p><p>1.面向終端的計算機網絡</p><p>以單個計算機為中心的遠程聯機系統，構成面向終端的計算機網絡。這種系統用一臺中央主機連接大量的地理上處於分散位置的終端，其中終端都不具備自主處理的能力。例如，20世紀50年代初美國的半自動地面防空SAGE系統，該系統將遠距離的雷達和其他設備的信息，通過通信線路彙集到一臺旋風計算機，第一次實現了利用計算機遠距離的集中控制和人—機對話。SAGE系統的誕生被譽為計算機通信發展史上的里程碑。從此，計算機網絡開始逐步形成和發展。</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8d304ea806844def81454ee6df8f69d6><p class=pgc-img-caption></p></div><p>2.計算機－計算機網絡</p><p>在主機－終端系統中，隨著終端設備的增加，主機負荷不斷加重，處理數據效率明顯下降，數據傳輸率較低，線路的利用率也低，因此，採用主機－終端系統的計算機網絡已不能滿足人們對日益增加的信息處理的需求，另外，由於計算機的性價比提高，在20世紀60年代末，出現了計算機與計算機互連的系統，它將多臺自主計算機通過通信線路互聯起來為用戶提供服務，它的產生標誌著計算機網絡的興起，併為Internet的形成奠定了基礎。</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4eb2e0ed966848ed9081f6bacf31f8aa><p class=pgc-img-caption></p></div><p>最早的計算機－計算機網絡是美國國防部高級研究局（Defense Advanced Research Projects Agency，DARPA）於20世紀60年代末聯合計算機公司和大學共同研製而組建的ARPA網（Advanced Research Projects Agency Network，ARPANET），ARPANET中採用的許多網絡技術，如分組交換、路由選擇等，至今仍在使用。它是Internet 的前身，標誌著計算機網絡的興起。</p><p>3.開放式標準化網絡</p><p>隨著大量廠商、公司都各自研製自己的計算機網絡系統並提供服務，雖然計算機網絡得到一定的應用，但相應的弊病也就曝露出來，他們各自研製的網絡系統沒有一個統一的標準，不能實現互連。為了解決這一問題，20世紀70年代末，國際標準化組織（International Standards Organization，ISO）成立了專門的工作組來研究計算機網絡的標準。ISO制訂了計算機網絡體系結構的標準及國際標準化協議，於1984年ISO正式頒佈了"開放系統互連參考模型（Open System Interconnection　B.sic Reference Model，OSI/RM）"，簡稱為OSI參考模型或OSI/RM。OSI參考模型將網絡劃分為七層，因此，也稱為OSI七層模型。</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2be52fb9fc584ed1aae6852c44cfb7f8><p class=pgc-img-caption></p></div><p>標準化的最大好處是開放性，雖然開放，但各廠商必須按該標準來生產計算機的相關設備。用戶在組裝一臺計算機時，不必侷限於只購買一個公司的產品，而是可以自由地選購兼容產品。這樣，標準化的制定與實施，不僅促進了企業的競爭，同時也大大加速了計算機網絡的發展，計算機網絡在各個領域的應用也越來越廣泛，併為這些領域帶來了巨大的工作效率和經濟效益。</p><p>4.網絡互連與高速網絡時代</p><p>20世紀90年代以來，隨著信息高速公路計劃的提出與實施，Internet在地域、用戶、功能和應用等方面不斷拓展，極大地促進了計算機網絡技術的迅猛發展。這個階段的計算機網絡，其主要特點是綜合化和高速化。</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e2e301503b214a4bafcf2c7b6f7c510d><p class=pgc-img-caption></p></div><p>綜合化是指採用交換的數據傳送方式將多種業務綜合到一個網絡中完成，例如，它不但可以傳輸數據，還可以傳輸圖像、聲音、影像等多媒體信息，三網（電話網、有線電視網和數據網）融合甚至多網融合已成為一個重要的發展方向。</p><p>高速化是指傳輸數據的速率得到極大提高，早期的以太網其數據速率只有10Mbps。而目前，速度達100Mbps的以太網已相當普及，速度再提高十倍、達Gbps的產品也已面世。</p><p>二、計算機網絡基礎知識</p><p>"黑客"的目的是尋找目標漏洞，然後去發起攻擊或者提出解決方案修補漏洞，而尋找漏洞的過程，你就需要掌握很多知識，例如計算機原理、計算機網絡、操作系統、計算機軟件、編程語言、數據結構、數據庫技術、前沿技術等等，在這麼多要學習的內容裡，首先需要先學習"網絡通信原理"，為什麼？因為網絡通信原理十分重要，根據他的原理可以判斷出許多貌似正確的理論其實是有很多漏洞的通信過程，而很多黑客攻擊就是利用了這些漏洞，很多網絡安全解決方案也是用來解決這些漏洞問題的。</p><p>（一）、網絡的由來？</p><p>互聯網的本質就是一系列的網絡協議。</p><p>一臺硬設有了操作系統，然後裝上軟件你就可以正常使用了，每個人都擁有一臺自己的機器，然而彼此孤立。</p><p>如何能讓大家一起玩耍，就有了初步的網絡，其實兩臺計算機之間通信與兩個人打電話之間通信的原理是一樣的，普通話屬於中國國內人與人之間通信的標準，那如果是兩個國家的人交流呢？問題是，你不可能要求一個人／計算機掌握全世界的語言／標準，於是有了世界統一的通信標準：英語</p><p>結論：英語成為世界上所有人通信的統一標準，如果把計算機看成分佈於世界各地的人，那麼連接兩臺計算機之間的internet實際上就是一系列統一的標準，這些標準稱之為互聯網協議，互聯網的本質就是一系列的協議，總稱為'互聯網協議'（Internet Protocol Suite).</p><p>互聯網協議的功能：定義計算機如何接入internet，以及接入internet的計算機通信的標準。</p><p>（二）、網絡協議介紹</p><p>為了使不同計算機廠家生產的計算機能夠相互通信，以便在更大的範圍內建立計算機網絡，國際標準化組織（ISO）在1978年提出了"開放系統互聯參考模型"，即著名的OSI/RM模型（Open System Interconnection/Reference Model）。它將計算機網絡體系結構的通信協議劃分為七層，自下而上依次為：物理層（Physics Layer）、數據鏈路層（Data Link Layer）、網絡層（Network Layer）、傳輸層（Transport Layer）、會話層（Session Layer）、表示層（Presentation Layer）、應用層（Application Layer）。其中第四層完成數據傳送服務，上面三層面向用戶。</p><p>互聯網協議按照功能不同分為osi七層或tcp/ip五層</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/357ce57eddf94bfe8649a162963b62b2><p class=pgc-img-caption></p></div><p>每層運行常見物理設備</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2dd6c17f3159495883e1c0bc064b8d41><p class=pgc-img-caption></p></div><p>五層模型講解</p><p>我們將應用層，表示層，會話層並作應用層，從tcp／ip五層協議的角度來闡述每層的由來與功能，搞清楚了每層的主要協議，就理解了整個互聯網通信的原理。</p><p>首先，用戶感知到的只是最上面一層應用層，自上而下每層都依賴於下一層，所以我們從最下一層開始切入，比較好理解每層都運行特定的協議，越往上越靠近用戶，越往下越靠近硬件</p><p>1、物理層：上面提到，孤立的計算機之間要想一起玩，就必須接入internet，言外之意就是計算機之間必須完成組網</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5fd64d1b12e34568a9bf710b051b2e1f><p class=pgc-img-caption></p></div><p>物理層功能：主要是基於電器特性發送高低電壓(電信號)，高電壓對應數字1，低電壓對應數字0</p><p>2、數據鏈路層：單純的電信號0和1沒有任何意義，必須規定電信號多少位一組，每組什麼意思</p><p>數據鏈路層的功能：定義了電信號的分組方式</p><p><strong>以太網協議：</strong></p><p>早期的時候各個公司都有自己的分組方式，後來形成了統一的標準，即以太網協議ethernet</p><p>ethernet規定</p><p>一組電信號構成一個數據包，叫做'幀'</p><p>每一數據幀分成：報頭head和數據data兩部分</p><p>head包含：(固定18個字節)</p><p>發送者／源地址，6個字節</p><p>接收者／目標地址，6個字節</p><p>數據類型，6個字節</p><p>data包含：(最短46字節，最長1500字節)</p><p>數據包的具體內容</p><p>head長度＋data長度＝最短64字節，最長1518字節，超過最大限制就分片發送</p><p><strong>mac地址：</strong></p><p>head中包含的源和目標地址由來：ethernet規定接入internet的設備都必須具備網卡，發送端和接收端的地址便是指網卡的地址，即mac地址。</p><p>mac地址：每塊網卡出廠時都被燒製上一個世界唯一的mac地址，長度為48位2進制，通常由12位16進制數表示（前六位是廠商編號，後六位是流水線號）</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/44a3c0c8e7244c0eb1d81f71c647dcd1><p class=pgc-img-caption></p></div><p>廣播：</p><p>有了mac地址，同一網絡內的兩臺主機就可以通信了（一臺主機通過arp協議獲取另外一臺主機的mac地址）ethernet採用最原始的方式，廣播的方式進行通信，即計算機通信基本靠吼</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/aef52cc03e1a418f92e63678b8df3eef><p class=pgc-img-caption></p></div><p>3、網絡層：有了ethernet、mac地址、廣播的發送方式，世界上的計算機就可以彼此通信了，問題是世界範圍的互聯網是由一個個彼此隔離的小的局域網組成的，那麼如果所有的通信都採用以太網的廣播方式，那麼一臺機器發送的包全世界都會收到，這就不僅僅是效率低的問題了，這會是一種災難</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/554ef2beb217471c9f1162f96ba5047c><p class=pgc-img-caption></p></div><p>上圖結論：必須找出一種方法來區分哪些計算機屬於同一廣播域，哪些不是，如果是就採用廣播的方式發送，如果不是，就採用路由的方式（向不同廣播域／子網分發數據包），mac地址是無法區分的，它只跟廠商有關。</p><p>網絡層功能：引入一套新的地址用來區分不同的廣播域／子網，這套地址即網絡地址</p><p><strong>IP協議：</strong></p><p>規定網絡地址的協議叫ip協議，它定義的地址稱之為ip地址，廣泛採用的v4版本即ipv4，它規定網絡地址由32位2進製表示</p><p>範圍0.0.0.0-255.255.255.255</p><p>一個ip地址通常寫成四段十進制數，例：172.16.10.1</p><p>ip地址分成兩部分</p><p>網絡部分：標識子網</p><p>主機部分：標識主機</p><p>注意：單純的ip地址段只是標識了ip地址的種類，從網絡部分或主機部分都無法辨識一個ip所處的子網</p><p>例：172.16.10.1與172.16.10.2並不能確定二者處於同一子網</p><p><strong>子網掩碼</strong></p><p>所謂"子網掩碼"，就是表示子網絡特徵的一個參數。它在形式上等同於IP地址，也是一個32位二進制數字，它的網絡部分全部為1，主機部分全部為0。比如，IP地址172.16.10.1，如果已知網絡部分是前24位，主機部分是後8位，那麼子網絡掩碼就是11111111.11111111.11111111.00000000，寫成十進制就是255.255.255.0。</p><p>知道"子網掩碼"，我們就能判斷，任意兩個IP地址是否處在同一個子網絡。方法是將兩個IP地址與子網掩碼分別進行AND運算（兩個數位都為1，運算結果為1，否則為0），然後比較結果是否相同，如果是的話，就表明它們在同一個子網絡中，否則就不是。</p><p>比如，已知IP地址172.16.10.1和172.16.10.2的子網掩碼都是255.255.255.0，請問它們是否在同一個子網絡？兩者與子網掩碼分別進行AND運算，</p><p>172.16.10.1：10101100.00010000.00001010.000000001</p><p>255255.255.255.0:11111111.11111111.11111111.00000000</p><p>AND運算得網絡地址結果：10101100.00010000.00001010.000000001->172.16.10.0</p><p>172.16.10.2：10101100.00010000.00001010.000000010</p><p>255255.255.255.0:11111111.11111111.11111111.00000000</p><p>AND運算得網絡地址結果：10101100.00010000.00001010.000000001->172.16.10.0</p><p>結果都是172.16.10.0，因此它們在同一個子網絡。</p><p>總結一下，IP協議的作用主要有兩個，一個是為每一臺計算機分配IP地址，另一個是確定哪些地址在同一個子網絡。</p><p><strong>ip數據包</strong></p><p>ip數據包也分為head和data部分，無須為ip包定義單獨的欄位，直接放入以太網包的data部分</p><p>head：長度為20到60字節</p><p>data：最長為65,515字節。</p><p>而以太網數據包的"數據"部分，最長只有1500字節。因此，如果IP數據包超過了1500字節，它就需要分割成幾個以太網數據包，分開發送了。</p><p><strong>ARP協議</strong></p><p>arp協議由來：計算機通信基本靠吼，即廣播的方式，所有上層的包到最後都要封裝上以太網頭，然後通過以太網協議發送，在談及以太網協議時候，我門瞭解到通信是基於mac的廣播方式實現，計算機在發包時，獲取自身的mac是容易的，如何獲取目標主機的mac，就需要通過arp協議</p><p>arp協議功能：廣播的方式發送數據包，獲取目標主機的mac地址</p><p>協議工作方式：每臺主機ip都是已知的</p><p>例如：主機172.16.10.10/24訪問172.16.10.11/24</p><p>3.1首先通過ip地址和子網掩碼區分出自己所處的子網</p><p>3.2分析172.16.10.10/24與172.16.10.11/24處於同一網絡(如果不是同一網絡，那麼下表中目標ip為172.16.10.1,通過arp獲取的是網關的mac)</p><p>3.3這個包會以廣播的方式在發送端所處的自網內傳輸，所有主機接收後拆開包，發現目標ip為自己的，就響應，返回自己的mac</p><p>4、傳輸層：網絡層的ip幫我們區分子網，以太網層的mac幫我們找到主機，然後大家使用的都是應用程序，你的電腦上可能同時開啟qq，暴風影音，等多個應用程序，那麼我們通過ip和mac找到了一臺特定的主機，如何標識這臺主機上的應用程序，答案就是端口，端口即應用程序與網卡關聯的編號。</p><p>傳輸層功能：建立端口到端口的通信</p><p>補充：端口範圍0-65535，0-1023為系統佔用端口</p><p>tcp協議：可靠傳輸，TCP數據包沒有長度限制，理論上可以無限長，但是為了保證網絡的效率，通常TCP數據包的長度不會超過IP數據包的長度，以確保單個TCP數據包不必再分割。</p><p>udp協議：</p><p>不可靠傳輸，"報頭"部分一共只有8個字節，總長度不超過65,535字節，正好放進一個IP數據包。</p><p>tcp報文</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/26c0b94f2b3d4072ac6b776f150fefcc><p class=pgc-img-caption></p></div><p>tcp三次握手和四次揮手</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/698d9fedf0a5449d8e30aac2ac042f15><p class=pgc-img-caption></p></div><p>5、應用層：用戶使用的都是應用程序，均工作於應用層，互聯網是開發的，大家都可以開發自己的應用程序，數據多種多樣，必須規定好數據的組織形式</p><p>應用層功能：規定應用程序的數據格式。</p><p>例：TCP協議可以為各種各樣的程序傳遞數據，比如Email、WWW、FTP等等。那麼，必須有不同協議規定電子郵件、網頁、FTP數據的格式，這些應用程序協議就構成了"應用層"。</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8ba6ee22ca064554a6e76c2ee8027846><p class=pgc-img-caption></p></div><p>6、Socket：我們知道兩個進程如果需要進行通訊最基本的一個前提能能夠唯一的標示一個進程，在本地進程通訊中我們可以使用PID來唯一標示一個進程，但PID只在本地唯一，網絡中的兩個進程PID衝突機率很大，這時候我們需要另闢它徑了，我們知道IP層的ip地址可以唯一標示主機，而TCP層協議和端口號可以唯一標示主機的一個進程，這樣我們可以利用ip地址＋協議＋端口號唯一標示網絡中的一個進程。</p><p>能夠唯一標示網絡中的進程後，它們就可以利用socket進行通信了，什麼是socket呢？我們經常把socket翻譯為套接字，socket是在應用層和傳輸層之間的一個抽象層，它把TCP/IP層複雜的操作抽象為幾個簡單的接口供應用層調用已實現進程在網絡中通信。</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/a9cb1fc9ce714b74a12f2ceab0fe98d4><p class=pgc-img-caption></p></div><p>socket起源於UNIX，在Unix一切皆文件哲學的思想下，socket是一種"打開—讀/寫—關閉"模式的實現，服務器和客戶端各自維護一個"文件"，在建立連接打開後，可以向自己文件寫入內容供對方讀取或者讀取對方內容，通訊結束時關閉文件。</p><p>（三）、網絡通信實現</p><p>每臺主機實現網絡通信的基本四要素：</p><p>本機的IP地址</p><p>子網掩碼</p><p>網關的IP地址</p><p>DNS的IP地址</p><p>獲取這四要素分兩種方式：</p><p>1.靜態獲取</p><p>即手動配置</p><p>2.動態獲取</p><p>通過dhcp獲取</p><p>（1）最前面的"以太網標頭"，設置發出方（本機）的MAC地址和接收方（DHCP服務器）的MAC地址。前者就是本機網卡的MAC地址，後者這時不知道，就填入一個廣播地址：FF-FF-FF-FF-FF-FF。</p><p>（2）後面的"IP標頭"，設置發出方的IP地址和接收方的IP地址。這時，對於這兩者，本機都不知道。於是，發出方的IP地址就設為0.0.0.0，接收方的IP地址設為255.255.255.255。</p><p>（3）最後的"UDP標頭"，設置發出方的端口和接收方的端口。這一部分是DHCP協議規定好的，發出方是68端口，接收方是67端口。</p><p>這個數據包構造完成後，就可以發出了。以太網是廣播發送，同一個子網絡的每臺計算機都收到了這個包。因為接收方的MAC地址是FF-FF-FF-FF-FF-FF，看不出是發給誰的，所以每臺收到這個包的計算機，還必須分析這個包的IP地址，才能確定是不是發給自己的。當看到發出方IP地址是0.0.0.0，接收方是255.255.255.255，於是DHCP服務器知道"這個包是發給我的"，而其他計算機就可以丟棄這個包。</p><p>接下來，DHCP服務器讀出這個包的數據內容，分配好IP地址，發送回去一個"DHCP響應"數據包。這個響應包的結構也是類似的，以太網標頭的MAC地址是雙方的網卡地址，IP標頭的IP地址是DHCP服務器的IP地址（發出方）和255.255.255.255（接收方），UDP標頭的端口是67（發出方）和68（接收方），分配給請求端的IP地址和本網絡的具體參數則包含在Data部分。</p><p>新加入的計算機收到這個響應包，於是就知道了自己的IP地址、子網掩碼、網關地址、DNS服務器等等參數。</p><p>（四）、例舉主機訪問網站的網絡通信過程</p><p>首先打開瀏覽器，在地址欄輸入URL，回車，出現網站內容。這是我們幾乎每天都在做的事，那這個過程中到底是什麼原理呢？HTTP、TCP、DNS、IP這些耳熟能詳的名詞都在什麼時候起著什麼作用呢？在這裡整體梳理一遍。</p><p>4.1整個過程基本分做下面幾個部分：</p><p>1、域名解析成IP地址；</p><p>2、與目的主機進行TCP連接（三次握手）；</p><p>3、發送與收取數據；</p><p>4、與目的主機斷開TCP連接（四次揮手）；</p><p>4.2下面分別進行詳細說明。</p><p>4.2.1域名解析成IP地址</p><p>首先說什麼是域名解析？</p><p>我們在瀏覽器地址欄中輸入的都是類似"www.baidu.com"、"www.qq.com"等等容易記憶的英文域名，但這些字母你直接交給整個網絡線路去尋找目的主機找得到嗎？找不到，因為每個主機在網絡中的位置都是以IP標識的，IP才是主機在網絡中的位置，域名只是為了方便用戶記憶而已，這就要求瀏覽器能夠識別域名並且將其轉化為對應的IP地址。</p><p>所以瀏覽器會有一個DNS緩存，其中記錄了一些域名與IP的對應關係，供瀏覽器快速查找需要的IP。但是這個DNS緩存不可能存下所有的域名-IP地址，何況IP地址有時候還會變化，因此當在DNS緩存中沒有找到的時候，就要先向DNS服務器請求域名解析，我們常聽到的DNS服務器很大的作用就是進行域名解析。</p><p>值得一提的是，DNS域名解析時用的是UDP協議。</p><p>整個域名解析的過程如下：</p><p>1、瀏覽器向本機DNS模塊發出DNS請求，DNS模塊生成相關的DNS報文；</p><p>2、DNS模塊將生成的DNS報文傳遞給傳輸層的UDP協議單元；</p><p>3、UDP協議單元將該數據封裝成UDP數據報，傳遞給網絡層的IP協議單元；</p><p>4、IP協議單元將該數據封裝成IP數據包，其目的IP地址為DNS服務器的IP地址；</p><p>5、封裝好的IP數據包將傳遞給數據鏈路層的協議單元進行發送；</p><p>6、發送時在ARP緩存中查詢相關數據，如果沒有，就發送ARP廣播（包含待查詢的IP地址，收到廣播的主機檢查自己的IP，符合條件的主機將含有自己MAC地址的ARP包發送給ARP廣播的主機）請求，等待ARP迴應；</p><p>7、得到ARP迴應後，將IP地址與路由的下一跳MAC地址對應的信息寫入ARP緩存表；</p><p>8、寫入緩存後，以路由下一跳的地址填充目的MAC地址，以數據幀形式轉發；</p><p>9、轉發可能進行多次；</p><p>10、DNS請求到達DNS服務器的數據鏈路層協議單元；</p><p>11、DNS服務器的數據鏈路層協議單元解析數據幀，將內部的IP數據包傳遞給網絡層IP協議單元；</p><p>12、DNS服務器的IP協議單元解析IP數據包，將內部的UDP數據報傳遞給傳輸層UDP協議單元；</p><p>13、DNS服務器的UDP協議單元解析收到的UDP數據報，將內部的DNS報文傳遞給DNS服務單元；</p><p>14、DNS服務單元將域名解析成對應IP地址，產生DNS迴應報文；</p><p>15、DNS迴應報文->UDP->IP->MAC->我的主機；</p><p>16、我的主機收到數據幀，將數據幀->IP->UDP->瀏覽器；</p><p>17、將域名解析結果以域名和IP地址對應的形式寫入DNS緩存表。</p><p>其中提到了一個ARP的概念，類似於DNS將域名翻譯成IP，ARP則是將IP翻譯成MAC地址，我們知道了IP後，需要通過主機的MAC地址來更具體的找到主機。同樣的也有一個ARP緩存，其中存儲了一些IP與MAC地址的對應關係，如果緩存中找不到，就會進行廣播來查找MAC地址，收到廣播的主機會檢查自己的IP是否是待查找的IP，是的話就返回自己的MAC地址。</p><p>如果做開發，往往還會接觸到端口這個概念，那端口是什麼呢？這裡是指TCP/IP協議中的端口，端口號的範圍從0到65535，比如用於瀏覽網頁服務的80端口，用於FTP服務的21端口等等，都有一些固定的端口號，被佔用後就不能被別的服務拿來傳輸數據了。</p><p>4.2.2與目的主機進行TCP連接（三次握手）</p><p>得到域名對應的IP地址後，也就表示可以將數據送達目的主機了，這時候才開始我們常說的三次握手建立連接。</p><p>HTTP的請求時使用TCP進行傳輸的，可以保證可靠傳輸，並且有序，而TCP是有連接的傳輸，也就是在傳輸數據之前，會建立我的主機與目的主機之間的連接，然後才能傳輸數據，傳輸完成後，還有斷開連接。這也就是TCP的三次握手和四次揮手，大致過程如下圖所示：</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a6cd5c06525949c68cf1591f3a2c3076><p class=pgc-img-caption></p></div><p>具體的三次握手建立連接的過程如下表述，其中數據包的傳輸過程類似上文請求DNS服務器時的過程，就簡單的表示一下：</p><p>1、向目的主機發送TCP連接請求報文；</p><p>2、該TCP報文中SYN標誌位設為1，表示連接請求；</p><p>3、該TCP報文通過IP（DNS）->MAC（ARP）->網關->目的主機；</p><p>4、目的主機收到數據幀，通過IP->TCP，TCP協議單元迴應請求應答報文；</p><p>5、該報文中SYN和ACK標誌設為1，表示連接請求應答；</p><p>6、該TCP報文通過IP（DNS）->MAC（ARP）->網關->我的主機；</p><p>7、我的主機收到數據幀，通過IP->TCP，TCP協議單元迴應請求確認報文；</p><p>8、該TCP報文通過IP（DNS）->MAC（ARP）->網關->目的主機；</p><p>9、目的主機收到數據幀，通過IP->TCP，連接建立完成。</p><p>三次握手的過程就是一去一回一去，互相確認一下，就建立連接啦。這個過程中任何一個報文出錯或者超時，都要進行重傳。</p><p>4.2.3發送與收取數據</p><p>如上所說，只有建立連接後才能開始傳輸數據，數據其實有多種傳輸方式，比如分段啊分組啊分時啊等等。而一個數據包的傳輸過程如下所示，以HTTP的GET方法請求為例：</p><p>1、瀏覽器向域名發出GET方法報文；</p><p>2、該GET方法報文通過TCP->IP（DNS）->MAC（ARP）->網關->目的主機；</p><p>3、目的主機收到數據幀，通過IP->TCP->HTTP，HTTP協議單元會迴應HTTP協議格式封裝好的HTML形式數據；</p><p>4、該HTML數據通過TCP->IP（DNS）->MAC（ARP）->網關->我的主機；</p><p>5、我的主機收到數據幀，通過IP->TCP->HTTP->瀏覽器，瀏覽器以網頁形式顯示HTML內容。</p><p>其他的HTTP方法在傳輸數據時方法都類似，只是所攜帶的內容不同。</p><p>4.2.4與目的主機斷開TCP連接（四次揮手）</p><p>數據傳輸完成後需要斷開連接，與建立時不同，斷開連接需要多一次，有四次揮手，至於為什麼，看完過程我們再講。</p><p>看圖理解過程：</p><div class=pgc-img><img alt=電腦網絡知識：三分鐘瞭解計算機網絡通信原理，成為黑客的必須課 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0e8e9e8f774a4c5c88ed33957668dda1><p class=pgc-img-caption></p></div><p>過程如下：</p><p>1、瀏覽器向目的主機發出TCP連接結束請求報文，此時進入FIN WAIT狀態；</p><p>2、該報文FIN標誌位設為1，表示結束請求；</p><p>3、TCP結束請求報文通過IP（DNS）->MAC（ARP）->網關->目的主機；</p><p>4、目的主機收到數據幀，通過IP->TCP，TCP協議單元迴應結束應答報文；</p><p>5、當前只是進行迴應，因為目的主機可能還有數據要傳，並不急著斷開連接；</p><p>6、該報文中ACK標誌位設為1，表示收到結束請求；</p><p>7、目的數據發送完所有數據後，向我的主機發出TCP連接結束請求報文；</p><p>8、該報文FIN標誌位設為1，表示結束請求；</p><p>9、TCP結束請求報文通過IP（DNS）->MAC（ARP）->網關->我的主機；</p><p>10、我的主機收到數據幀，通過IP->TCP，TCP協議單元迴應結束應答報文，此時進入TIME WAIT狀態，因為不相信網絡是可靠的，如果目的主機沒收到還可以重發；</p><p>11、該報文中的FIN標誌位均設為1，表示結束應答；</p><p>12、該TCP迴應報文通過IP（DNS）->MAC（ARP）->網關->目的主機；</p><p>13、目的主機關閉連接；</p><p>14、TIME WAIT等待結束後，沒有收到回覆，說明目的正常關閉了，我的主機也關閉連接。</p><p>這裡的過程是以我的主機主動發起結束請求開始的，實際上也可以由目的主機主動發起，那麼過程就會跟上面相反，但細節差不多。</p><p>FIN_WAIT狀態是主動發起請求時等待確認信息，而TIME_WAIT狀態是收到結束請求後發送確認信息後等待看是否需要重發。</p><p>現在來說說為什麼斷開連接時需要四次揮手呢？因為建立連接時目的主機可以直接發送SYN（同步）+ACK（應答）報文。而當斷開時，目的主機收到FIN後可能還有數據要發，並不一定直接斷開，所以先發送一次應答，告知我的主機收到了請求，等確認所有數據都發完了，再發送FIN，同時等待我的主機應答，這裡的FIN和ACK就不能一起發送，所以需要四次。</p><p>4.2.5總結一下：</p><p>以上就是主機訪問網站時的網絡通信全過程，歸納起來就是：</p><p>首先要通過域名找到IP，如果緩存裡沒有就要請求DNS服務器；得到IP後開始於目的主機進行三次握手來建立TCP連接；連接建立後進行HTTP訪問，傳輸並獲取網頁內容；傳輸完後與目的主機四次揮手來斷開TCP連接。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>網絡</a></li><li><a>電腦</a></li><li><a>知識</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/9c95b6a2.html alt=電腦網絡知識：超文本傳輸協議(HTTP)的學習 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/dd62b1e29a5548f3bd7714f348272da2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9c95b6a2.html title=電腦網絡知識：超文本傳輸協議(HTTP)的學習>電腦網絡知識：超文本傳輸協議(HTTP)的學習</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6474ccee.html alt=點對點網絡的基本知識分享 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8678a34470a144ad88fc0487f0d8da91 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6474ccee.html title=點對點網絡的基本知識分享>點對點網絡的基本知識分享</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/86e033bc.html alt=前端要知道的網絡知識三：認識OSI七層模型 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/222c6f2c-ae3d-41d5-9e3f-e344f24d2e6c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/86e033bc.html title=前端要知道的網絡知識三：認識OSI七層模型>前端要知道的網絡知識三：認識OSI七層模型</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/337f5aca.html alt=公司電腦網絡信息資源管理規定 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/337f5aca.html title=公司電腦網絡信息資源管理規定>公司電腦網絡信息資源管理規定</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a25f5aab.html alt=奇怪的接口知識增加了！電腦上的這些接口都是幹嗎的？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/c27e50f05ca641abaa44532eeb033f30 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a25f5aab.html title=奇怪的接口知識增加了！電腦上的這些接口都是幹嗎的？>奇怪的接口知識增加了！電腦上的這些接口都是幹嗎的？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7e839484.html alt=奇怪的知識增加了！電腦內存容量真的是越大越好嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/a457a965c6064a45a93d273286d37f57 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7e839484.html title=奇怪的知識增加了！電腦內存容量真的是越大越好嗎？>奇怪的知識增加了！電腦內存容量真的是越大越好嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/edb2b1fc.html alt=電腦知識：Linux系統基礎知識與命令大全，乾貨滿滿 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/edb2b1fc.html title=電腦知識：Linux系統基礎知識與命令大全，乾貨滿滿>電腦知識：Linux系統基礎知識與命令大全，乾貨滿滿</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b43524ea.html alt="網絡安全 | 小才子不得不知道的網絡安全知識！" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RcXFjwQ3pvBZmg style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b43524ea.html title="網絡安全 | 小才子不得不知道的網絡安全知識！">網絡安全 | 小才子不得不知道的網絡安全知識！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5fb22495.html alt=那些你可能不知道的網絡冷知識奇技淫巧 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4580a9a9cee342f6b4414d49ee87e174 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5fb22495.html title=那些你可能不知道的網絡冷知識奇技淫巧>那些你可能不知道的網絡冷知識奇技淫巧</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/64cf6798.html alt=如何在電腦上安裝網絡打印機？詳細教程全部教給你 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/24662168358c46dd94f37db8044a4ed0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/64cf6798.html title=如何在電腦上安裝網絡打印機？詳細教程全部教給你>如何在電腦上安裝網絡打印機？詳細教程全部教給你</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8e772aa3.html alt=電腦如何映射網絡驅動器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/a79c5b33-be8f-4ea6-826a-6369b265b85b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8e772aa3.html title=電腦如何映射網絡驅動器>電腦如何映射網絡驅動器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/65394b5f.html alt=電腦網絡診斷提示以太網適配器驅動出現問題怎麼辦 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/R6YvQw5ARZ7UKF style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/65394b5f.html title=電腦網絡診斷提示以太網適配器驅動出現問題怎麼辦>電腦網絡診斷提示以太網適配器驅動出現問題怎麼辦</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0ecbe660.html alt=網絡基礎知識-計算機基本組成結構及存儲器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0ecbe660.html title=網絡基礎知識-計算機基本組成結構及存儲器>網絡基礎知識-計算機基本組成結構及存儲器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/72454ef2.html alt=電腦知識：很多網站都支持的第三方授權登錄，究竟是怎麼一回事？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1c18e10633044b0aac2436a6d3a4f700 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/72454ef2.html title=電腦知識：很多網站都支持的第三方授權登錄，究竟是怎麼一回事？>電腦知識：很多網站都支持的第三方授權登錄，究竟是怎麼一回事？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dfb49a6f.html alt=網絡人電腦控制器，有固話和手機兩個版本 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/d4e94b71035a4a7da67da626e2f8df4d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dfb49a6f.html title=網絡人電腦控制器，有固話和手機兩個版本>網絡人電腦控制器，有固話和手機兩個版本</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>