<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>I2C接口學習筆記 | 极客快訊</title><meta property="og:title" content="I2C接口學習筆記 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/d876fbb087244b0e842451017b0f026c"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/90ba125.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/90ba125.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/90ba125.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/90ba125.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/90ba125.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/90ba125.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/90ba125.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/90ba125.html><meta property="article:published_time" content="2020-10-29T21:04:18+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:18+08:00"><meta name=Keywords content><meta name=description content="I2C接口學習筆記"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/90ba125.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>I2C接口學習筆記</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>說明：<u>本文寫於2018年1月，現第一次放到頭條上。文中大部分資料來自I2C規範，但絕對是本人編寫的，部分英文未進行翻譯，並不是不知道如何翻譯，而是時間有限，對於專業人員而言，意思不難明白，所以就不浪費時間，如果感興趣的朋友需要進一步探討，後續會陸續釋放出相關接口，如MIPI、UART、HDMI、DDR、SPI等接口的學習筆記。因本人水平有限，文中難免有錯漏之處，敬請指正和諒解！</u></p><p>接口名稱：IIC 或 I2C</p><p>英文全稱：Inter-integrated Circuit</p><p>中文：集成電路總線</p><p>標準維護和制定：NA</p><p>發明者： PHILIPS（1982年）<strong>（現為NXP Semiconductors）</strong></p><p>網址： www.nxp.com</p><p>當前規範<strong>：I2C-bus specification and user manual</strong></p><p>最新版本：V6（1992年釋放V1.0）</p><p>生效時間：2014.04.04</p><p>下一版本：NA</p><p>說明： I2C為全雙工雙向串行總線，一根是雙向的數據線SDA，另一根是時鐘線SCL。其數據傳輸速率有以下5種：</p><ol start=1><li>標準模式SM（Standard mode）:100kbps；（雙向）</li><li>快速模式FM（Fast mode）: 400Kbps；（雙向）</li><li>快速+FM+（Fast Mode Plus）:1Mbps; （雙向）</li><li>高速模式HS(High speed mode):3.4Mbps；（雙向）</li><li>超快速模式UFM（Ultra Fast-mode）：5Mbps（單向）</li></ol><p>注：行業內許多總線接口都採用IIC接口作為基礎然後進行修改和適配。如</p><p>SMBus：System Management Bus www.smbus.org</p><p>PMBus ：Power Management Bus www.pmbus.org</p><p>IPMI：Intelligent Platform Management Interface (www.intel.com/design/servers/ipmi/ipmi.htm)</p><p>DDC：Display Data Channel www.vesa.org.</p><p>ATCA：Advanced Telecom Computing Architecture</p><p>(www.picmg.org/v2internal/resourcepage2.cfm?id=2)</p><p><br></p><p><strong>普通I2C（不含UFM）總線配置示意圖</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d876fbb087244b0e842451017b0f026c><p class=pgc-img-caption></p></div><p><strong>UFM I2C總線配置示意圖</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1872bf1e68f14393b9e5a247c5b2b22a><p class=pgc-img-caption></p></div><p><strong>一、接口結構</strong></p><p>I2C總線採用二線制傳輸，一根是數據線SDA（Serial Data Line），另一根是時鐘線SCL（Serial Clock line），所有I2C器件都連接在SDA和SCL上，每一個器件具有一個唯一的地址。其架構如下圖所示。可以連接幾個器件取決於<strong>總線電容</strong>的限制。</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/75aff727bd1743be91e9e7538ffc2c81><p class=pgc-img-caption>I2C連接模型</p></div><p><strong>I2C總線中有一個發送器（Transmitter）和一個接收器（Receiver）。</strong></p><p><strong>I2C總線在邏輯分為Master和Slave兩個角色。</strong></p><p>I2C總線支持多主（multi-mastering）和主從（master-slave）兩種工作方式。<strong>主機是指啟動數據的傳送（發起始信號）、發出時鐘信號、發出終止信號的器件。通常，主機由單片機或其它微處理器擔任。</strong></p><p><strong>從機是指被主機訪問的器件，它可以是其它單片機，或者其他外圍芯片，如：A/D、D/A、LED或LCD驅動、串行存儲器芯片。</strong></p><p>多主方式下，I2C總線上可以有多個主機。I2C總線需通過硬件和軟件仲裁來確定主機對總線的控制權。</p><p>主從工作方式時，系統中只有一個主機，總線上的其它器件均為從機（具有I2C總線接口），只有主機能對從機進行讀寫訪問，因此，不存在總線的競爭等問題。在主從方式下，I2C總線的時序可以模擬 ，I2C總線的使用不受主機是否具有I2C總線接口的制。</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b21cf4a450314dbb91b1e8cc5a552a1c><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1dd4d309d7cb4e639fe57737a016a190><p class=pgc-img-caption></p></div><p><strong>二、工作原理</strong></p><p>2.1 非超高速模式I2C總線工作原理</p><p>2.1.1 數據位傳輸BIT TRANSFER</p><p>I2C總線上主機與從機之間一次傳送的數據稱為一幀。由<strong>啟動信號、若干個數據字節、應答位和停止信號</strong>組成。數據傳送的基本單元為8位數據，每個字節後面必須跟隨一個ACK位。數據傳輸是MSB（Most Significant Bit）優先。</p><p>時鐘線SCL的一個時鐘週期只能傳輸一位數據。在SCL時鐘線為高電平期間內，數據線SDA上的數據必須穩定。當SCL時鐘線變為低電平時，數據線SDA的狀態才能改變。</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ab8ff00e54994d09989f82aac06673e9><p class=pgc-img-caption></p></div><p><strong>2.1.2 啟動和停止 START & STOP conditions</strong></p><p>起始（START）狀態：I2C總線傳輸過程中，當時鍾線SCL為高電平，數據線SDA出現高電平到低電平跳變時，標誌I2C總線傳輸數據開始。</p><p>停止（STOP）狀態：I2C總線傳輸過程中，當時鍾線SCL為高電平，數據線SDA出現低電平到高電平跳變時，標誌著I2C總線傳輸數據結束。</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/84d1ecbbc7894366a01226c6dc81b458><p class=pgc-img-caption></p></div><p><strong>2.1.3 數據的傳送TRANSFERRING DATA</strong></p><p>每次傳輸的字節數不受限制。每個字節後必須跟一個應答（acknowledge）位。數據傳輸時，首先傳送最高位，如圖10.5所示，如果從機暫時不能接收下一個字節數據，如從機響應內部中斷，那麼，可以使時鐘線SCL保持為低電平，迫使主機處於等待狀態；當從機準備就緒後，再釋放時鐘線SCL，使數據傳輸繼續進行。</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3a53ddbd851943ce8cb5d7c830d38a9f><p class=pgc-img-caption></p></div><p><strong>2.1.4 應答Acknowledge</strong></p><p>I2C協議規定，在每個字節傳送完畢後，必須有一個應答位。應答位的時鐘脈衝由主機產生。在應答時鐘有效期間，發送設備把數據線SDA置為高電平；接收設備必須把數據線SDA置為低電平，並且在此期間保持低電平狀態，以便產生有效的應答信號。</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/720e0863976747ddb5d9e126b1593d5d><p class=pgc-img-caption></p></div><p><strong>2.1.5 數據傳輸格式</strong></p><p>在起始狀態S之後，先發送一個7位從機地址（或10位地址），接著第8位是數據方向位，＝0表示發送(寫)，＝1表示請求數據(讀)。</p><p>一次數據傳輸總是由主機產生停止狀態P而結束。但是，如果主機還希望在總線上傳輸數據，那麼，它可以產生另一個起始狀態和尋址另一個從機，不需要先產生一個停止狀態。在這種傳輸方式中，就可能有讀寫方式的組合。</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ca6875457af14e9bb4bdcadd3d91f0d8><p class=pgc-img-caption></p></div><p>在I2C總線啟動或應答信號後的第1~8個時鐘脈衝，對應一個字節的8位數據傳送。高電平期間，數據串行傳送；低電平期間為數據準備，允許總線上數據電平變化。一旦I2C總線啟動，傳送的字節數沒有限制，只要求每傳送一個字節後，對方迴應一個應答位。發送時，最先發送的是數據的最高位。每次傳送開始有起始信號，結束時有停止信號。傳送完一個字節，可以通過對時鐘線的控制使傳送暫停</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/674579285d264cb29fe68d2c675729c5><p class=pgc-img-caption></p></div><p><br></p><p>一個SLAVE器件有<strong>7位和10位地址（可支持1024個器件）</strong>兩種。使用10位地址格式時，第一個字節的前7位確定地址，第8位確定R（讀，高電平）還是/W（寫，低電平）。</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e500f12bfb9a4e7f9798812c54b461f9><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e5c8f31095a746ad964b7875c87a93bb><p class=pgc-img-caption></p></div><p><br></p><p><strong>2.2 超快速模式UFM I2C總線工作原理</strong></p><p>超高速I2C總線的速率可達5Mbps，由於其是單向傳輸（主至從） 其常見用於LED驅動器件，此時MCU作為發送器，LED驅動器件作為接收器。其傳輸還是基於普通I2C，傳輸包括START啟動位, slave address被動器件地址,command命令位, ninth clock第九時鐘 和 STOP位等。它的兩根線為區別普通I2C，分別被稱之為USDA和USCL。其配置可參考下圖。</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/87585a6d134e461783b1e148a4c61be6><p class=pgc-img-caption>UFM Mode I2C</p></div><p><br></p><p><strong>2.2.1 UFM模式I2C的信令和邏輯電平</strong></p><p>邏輯電平同普通I2C，依賴於VDD電壓，一般為低電平為0.3VDD，高電平為0.7VDD。</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4872c29a904545c9a796133a2168e5e2><p class=pgc-img-caption></p></div><p><br></p><p><strong>2.2.2 UFM I2C 位傳輸</strong></p><p>位傳輸示意圖見下圖所示<strong>。</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c6a64c5b888d4bfb89dd5ec385652299><p class=pgc-img-caption>Bit Transfer</p></div><p><br></p><p><strong>2.2.3 啟動和停止</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d1855428cd464d44be6c528e43e18401><p class=pgc-img-caption>Start & Stop Conditions</p></div><p><br></p><p><strong>2.2.4 字節格式</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1f155ac5b4fc40cb82e70dcdf52f4d0b><p class=pgc-img-caption></p></div><p><br></p><p><strong>2.2.5 數據傳輸</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/837386ff32f64332845fbe93e6c6352c><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/80d080d377c8427799872680ba61aecc><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0556c75c6076405f87a71fe42bbfd0a7><p class=pgc-img-caption></p></div><p><strong>2.2.6 啟動字節</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/53a61109cf0940e0a3712343eeb77b54><p class=pgc-img-caption></p></div><p><strong>2.2.7 Device ID</strong></p><p>在UFM時，不支持Device ID。</p><p><strong>2.2.8 軟件復位</strong></p><p>Following a General Call, (0000 0000), sending 0000 0110 (06h) as the second byte</p><p>causes a software reset. This feature is optional and not all devices respond to this</p><p>command. On receiving this 2-byte sequence, all devices designed to respond to the</p><p>general call address reset and take in the programmable part of their address.</p><p><strong>三、應用設計</strong></p><p>普通 SDA和SCL線接口一般設計為開集或開漏;但對於UFM模式（最高達5Mbps）的SDA和SCL則是推輓輸出（Push-Pull output）,如下圖所示，當總線處於空閒狀態時，USCL和USDA腳上部三極管導通而處於高電平。</p><p>不管是普通SDA和SCL還是USDA和USCL，其邏輯電平不依賴於信號電平的大小，而是與供電電壓成正比，即一般為輸入低電平VIL為0.3VDD，輸入高電平VIH為0.7VDD。</p><p>注意：UFM總線（單向）不能兼容普通的、前面4種模式的I2C總線（它們需要電流源或上拉電阻且為雙向）。</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e4eded8460424bf187561a632394e14c><p class=pgc-img-caption>普通I2C 內部電路</p></div><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/debf9bdc104c4c1cba7b7b5fc14bfc11><p class=pgc-img-caption>UFM I2C內部 電路</p></div><p><strong>3.1 上拉電阻的選擇</strong></p><p>一個標準模式的I2C總線，其連接結構如下圖所示。在這種連接結構中，我們來討論如何確定上拉電阻Rp和串聯電阻Rs（防止高壓脈衝衝擊）的取值範圍，進而確定一個阻值的選擇規則。</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/26ee2153a26f4637844a2a44da6778b5><p class=pgc-img-caption></p></div><p><br></p><p>根據I2C總線的原理，Rp取值的範圍取決於以下三個要素：</p><ol start=1><li>供電電壓</li><li>總線電容</li><li>總線上所連接器件的個數（輸入電流+漏電電流）</li></ol><p><strong>對於I2C輸出，因為總線要求VOLmax = 0.4 V時，標準和快速模式下其SINK灌電流最小值為3mA、快速+模式下為20mA,因此，供電電壓限制了Rp的最小值。具體關係見下圖3.1 所示。</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9feeb672a97c4520853596452e39bb61><p class=pgc-img-caption>圖3.1 Rp最小值與供電電壓VDD的關係</p></div><p><strong>例如</strong>：假設供電電壓為VDD=5V±10%,VOLmax=0.4 V @3 mA,則Rpmin =</p><p>(5.5-0.4)/0.003=1.7 KΩ</p><p>總線電容是所連接器件的引腳、線纜或線路以及連接器等共同作用的等效電容，其總的等效電容量會影響時鐘的上升時間tr,因此，電容Cb與上升時間tr成正比，即電容越大，上升時間tr越大，例如，在標準模式（即速率為100Kbps）時，總等效電容Cb不能大於400pF(快速模式時不能大於100pF,其餘值可根據速率而定)。可以說，此電容Cb值確定了Rp(上拉電阻)的最大值。計算公式見如下，具體關係見下圖3.2所示。<strong>式中，tr為上升時間，Cb為總線電容</strong></p><p><strong>圖3.2 RP最大值與總線電容的關係</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/12edc393a6e04683a7bd8f70099858c3><p class=pgc-img-caption>圖3.2 RP最大值 與總線電容的關係</p></div><p><strong>3.2 Rs電阻的選擇</strong></p><p>低電平的噪聲裕量要求為0.1VDD，因此，此電平的要求限制了Rs的最大值，同時此電阻值也會影響下降時間tf。<strong>供電VDD、Rp和Rs三者之間的關係見下圖3.3所示</strong>。</p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3f39ca24629e46aab1f01369d26b0746><p class=pgc-img-caption>圖3.3 供電VDD、Rp和Rs三者之間的關係</p></div><p><br></p><p><strong>3.3 輸入漏電流Input leakage</strong></p><p>輸入高電平最大漏電流為10uA,且高電平時的噪聲裕量為0.2VDD，這兩個要素就限制了Rp的最大值。其關係圖見下圖3.4所示。</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/b0b554f9911e457b943365824c69647e><p class=pgc-img-caption></p></div><p><br></p><p>圖3.4 輸入高電平漏電流與VDD和Rp電阻取值的關係函數</p><p><strong>3.4 標準、快速、快速+及高速模式I2C總線的特性參數</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6b77511f76114ec4a209e04c97cebf37><p class=pgc-img-caption>表3.1. SDA和SCL I/O的特性參數表</p></div><p>[1] Some legacy Standard-mode devices had fixed input levels of VIL = 1.5 V and VIH = 3.0 V. Refer to component data sheets.</p><p>[2] Maximum VIH = VDD(max) + 0.5 V or 5.5 V, whichever is lower. See component data sheets.</p><p>[3] The same resistor value to drive 3 mA at 3.0 V VDD provides the same RC time constant when using &lt;2 V VDD with a smaller current draw.</p><p>[4] In order to drive full bus load at 400 kHz, 6 mA IOL is required at 0.6 V VOL. Parts not meeting this specification can still function, but not at 400 kHz and 400 pF.</p><p>[5] The maximum tf for the SDA and SCL bus lines quoted in 表3.2(300 ns) is longer than the specified maximum tof for the output stages (250 ns). This allows series protection resistors (Rs) to be connected between the SDA/SCL pins and the SDA/SCL bus lines as shown in Figure 45 without exceeding the maximum specified tf.</p><p>[6] Necessary to be backwards compatible with Fast-mode.</p><p>[7] In Fast-mode Plus, fall time is specified the same for both output stage and bus timing. If series resistors are used, designers should allow for this when considering bus timing.</p><p>[8] Input filters on the SDA and SCL inputs suppress noise spikes of less than 50 ns.</p><p>[9] If VDD is switched off, I/O pins of Fast-mode and Fast-mode Plus devices must not obstruct the SDA and SCL lines.</p><p>[10] Special purpose devices such as multiplexers and switches may exceed this capacitance because they connect multiple paths together</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b3cce0a423da4a8aa36581b2ef7a9cdc><p class=pgc-img-caption>表3.2. 標準、快速及快速+等模式下I2C總線器件SDA和SCL的特性參數</p></div><p>[1] All values referred to VIH(min) (0.3VDD) and VIL(max) (0.7VDD) levels (see Table 9).</p><p>[2] tHD;DAT is the data hold time that is measured from the falling edge of SCL, applies to data in transmission and the acknowledge.</p><p>[3] A device must internally provide a hold time of at least 300 ns for the SDA signal (with respect to the VIH(min) of the SCL signal) to bridge the undefined region of the falling edge of SCL.</p><p>[4] The maximum tHD;DAT could be 3.45 μs and 0.9 μs for Standard-mode and Fast-mode, but must be less than the maximum of tVD;DAT or tVD;ACK by a transition time. This maximum must only be met if the device does not stretch the LOW period (tLOW) of the SCL signal. If the clock stretches the SCL, the data must be valid by the set-up time before it releases the clock.</p><p>[5] A Fast-mode I2C-bus device can be used in a Standard-mode I2C-bus system, but the requirement tSU;DAT 250 ns must then be met. This will automatically be the case if the device does not stretch the LOW period of the SCL signal. If such a device does stretch the LOW period of the SCL signal, it must output the next data bit to the SDA line tr(max) + tSU;DAT = 1000 + 250 = 1250 ns (according to the Standard-mode I2C-bus specification) before the SCL line is released. Also the acknowledge timing must meet this set-up time.</p><p>[6] If mixed with Hs-mode devices, faster fall times according to 表3.2 are allowed.</p><p>[7] The maximum tf for the SDA and SCL bus lines is specified at 300 ns. The maximum fall time for the SDA output stage tf is specified at 250 ns. This allows series protection resistors to be connected in between the SDA and the SCL pins and the SDA/SCL bus lines without exceeding the maximum specified tf.</p><p>[8] In Fast-mode Plus, fall time is specified the same for both output stage and bus timing. If series resistors are used, designers should allow for this when considering bus timing.</p><p>[9] Necessary to be backwards compatible to Fast-mode.</p><p>[10] The maximum bus capacitance allowable may vary from this value depending on the actual operating voltage and frequency of the application.具體可參考I2C總線標準文檔。</p><p>[11] tVD;DAT = time for data signal from SCL LOW to SDA output (HIGH or LOW, depending on which one is worse).</p><p>[12] tVD;ACK = time for Acknowledgement signal from SCL LOW to SDA output (HIGH or LOW, depending on which one is worse).</p><p>表3.3 高速模式I2C總線器件SDAH, SCLH, SDA和SCL I/O特性參數</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/af47a8561c9948a390bfd205960a4d2a><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/d4257a569c5e4f818ed459142c823bb7><p class=pgc-img-caption></p></div><p>[1] Devices that use non-standard supply voltages which do not conform to the intended I2C-bus system levels must relate their input levels to the VDD voltage to which the pull-up resistors Rp are connected.</p><p>[2] Devices that offer the level shift function must tolerate a maximum input voltage of 5.5 V at SDA and SCL.</p><p>[3] For capacitive bus loads between 100 pF and 400 pF, the rise and fall time values must be linearly interpolated.</p><p>[4] If their supply voltage has been switched off, SDAH and SCLH I/O stages of Hs-mode slave devices must have floating outputs. Due to the current-source output circuit, which normally has a clipping diode to VDD, this requirement is not mandatory for the SCLH or the SDAH I/O stage of Hs-mode master devices. This means that the supply voltage of Hs-mode master devices cannot be switched off without affecting the SDAH and SCLH lines.</p><p>[5] Special purpose devices such as multiplexers and switches may exceed this capacitance because they connect multiple paths together</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8617c990d707497ea57709ad38dedd35><p class=pgc-img-caption>表3.4高速模式Hs I2C-總線器件SDAH, SCLH, SDA和SCL特性參數</p></div><p>[1] All values referred to VIH(min) and VIL(max) levels (see 表3.3).</p><p>[2] For bus line loads Cb between 100 pF and 400 pF the timing parameters must be linearly interpolated.</p><p>[3] A device must internally provide a data hold time to bridge the undefined part between VIH and VIL of the falling edge of the SCLH signal. An input circuit with a threshold as low as possible for the falling edge of the SCLH signal minimizes this hold time.</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/327f38f3f07e4df29d614ad2776c21d1><p class=pgc-img-caption></p></div><p><strong>3.5 UFM模式總線特性參數</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/30be72a032ce47449d0b0f5de16b1c5e><p class=pgc-img-caption>表3.5 USDA和USCL I/O特性參數表</p></div><p>[1] Refer to component data sheets for actual switching points.</p><p>[2] Maximum VIH = VDD(max) + 0.5 V or 5.5 V, whichever is lower. See component data sheets.</p><p>[3] Special purpose devices such as multiplexers and switches may exceed this capacitance because they connect multiple paths together.</p><p>[4] Input filters on the USDA and USCL slave inputs suppress noise spikes of less than 10 ns.</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6b7331b9dfb64e5ca4743995c4a85f5a><p class=pgc-img-caption></p></div><p>[1] tVD;DAT = minimum time for USDA data out to be valid following USCL LOW.</p><p>[2] Typical rise time or fall time for UFm signals is 25 ns measured from the 30 % level to the 70 % level (rise time) or from the 70 % level to the 30 % level (fall time).</p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e3689a935ac9480ea3eb549de9b54945><p class=pgc-img-caption></p></div><p><strong>3.6 電平轉換電路的設計</strong></p><p>因為半導體技術的發展，產生了各種電壓的信令及接口，如TTL、CMOS、LVTTL、LVCMOS、ECL、PECL、LVPECL、CML、VML等，電壓有5V、3.3V、1.8V、1.5V、1.2V、0.6V等等。下面簡單介紹一下，電平轉換電路，以便I2C電路在不同的電平之間也能起工作。</p><p>下圖圖3.5中，VDD1=3.3V代表低壓端，也可以是2.5V、1.8V等其它電壓，VDD2=5V代表高壓端，也可以是其它電壓，如12V、9V等，原則上就是VDD2>=VDD1.兩個N溝通增強型MOS場效應管TR1、TR2充當SCL和SDA線電平轉換作用，MOS管G極接低壓VDD1端，MOS管S端（源極）接低壓端SDA1或SCL1，MOS管D端（漏極）接高壓端SDA2或SCL2.其工作原理解釋如下：</p><p><strong>當I2C總線空閒時，TR1/TR2 G和S電平均為3.3V，則GS低於導通電壓不能導通而MOS管截止，總線高壓端與低壓端均保持高電平而相互不受影響；</strong></p><p><strong>當低壓端總線拉低時，TR1/TR2 G端保持3.3V，S端被拉低電，所以GS高於導通電壓而MOS管DS導通，將把SDA2/SCL2的電平拉到低電平狀態；</strong></p><p><strong>當高壓端總線拉低時，TR1/TR2內置的、並聯在D、S兩極的反向二極管會導通，直到GS超過導通門限而導通，從而把SDA1/SCL1也拉到低電平。</strong></p><p><br></p><div class=pgc-img><img alt=I2C接口學習筆記 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/535704b7458948fdb6c7e87724343769><p class=pgc-img-caption>圖3.5 電平轉換電路原理圖</p></div><p><strong>四、測試驗證</strong></p><p>I2C總線設計上比較簡單，測試也比較簡單，用邏輯分析儀和數字示波器就能很好的進行分析，本節就不再介紹<strong>。</strong></p><p><br></p><p>---------------------------------------------------The END------------------------------------------------</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>I2C</a></li><li><a>學習</a></li><li><a>筆記</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/dc2af9c9.html alt=機器學習筆記(七)——初識邏輯迴歸、不同方法推導梯度公式 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/13adbab9c7f94c7fa81d49a98861b051 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dc2af9c9.html title=機器學習筆記(七)——初識邏輯迴歸、不同方法推導梯度公式>機器學習筆記(七)——初識邏輯迴歸、不同方法推導梯度公式</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a1bc38f3.html alt=HTMLCSS學習筆記（六）——元素類型 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/bdb5988349894ce9bf568c6418f85b7d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a1bc38f3.html title=HTMLCSS學習筆記（六）——元素類型>HTMLCSS學習筆記（六）——元素類型</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c9091681.html alt="MySQL 學習筆記" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c9091681.html title="MySQL 學習筆記">MySQL 學習筆記</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/112d1b5f.html alt=一造學習筆記—管理篇（2）：工程造價管理的組織和內容 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/9e65b076-038f-4720-96ff-182898f42dee style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/112d1b5f.html title=一造學習筆記—管理篇（2）：工程造價管理的組織和內容>一造學習筆記—管理篇（2）：工程造價管理的組織和內容</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0a02618e.html alt=某教程學習筆記（一）：17、php漏洞 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/6d21bdb33b0a49e8b6eaa2c2a725a1d8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0a02618e.html title=某教程學習筆記（一）：17、php漏洞>某教程學習筆記（一）：17、php漏洞</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b37aac89.html alt=【學習筆記】Android開發之kotlin語言（一） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ee3f9c8348ae4de58a5f62922d2042e1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b37aac89.html title=【學習筆記】Android開發之kotlin語言（一）>【學習筆記】Android開發之kotlin語言（一）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b33d00d0.html alt=CV學習筆記（十二）：圖像金字塔 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/74c73f94d57a4f5d8f2e5183e78c8e67 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b33d00d0.html title=CV學習筆記（十二）：圖像金字塔>CV學習筆記（十二）：圖像金字塔</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f564827a.html alt="吳恩達深度學習筆記(108)-序列模型介紹(Sequence Models)" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/dfa0587764f14afb8ccfd7a33796cd74 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f564827a.html title="吳恩達深度學習筆記(108)-序列模型介紹(Sequence Models)">吳恩達深度學習筆記(108)-序列模型介紹(Sequence Models)</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7f69ae29.html alt="Python 3 學習筆記：Excel 基礎操作（二）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a777a023a91a465fb317de8de7e4cd37 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7f69ae29.html title="Python 3 學習筆記：Excel 基礎操作（二）">Python 3 學習筆記：Excel 基礎操作（二）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b75ffe84.html alt=學習《建築材料第9節》的筆記 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b75ffe84.html title=學習《建築材料第9節》的筆記>學習《建築材料第9節》的筆記</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/269cb6ac.html alt=學霸學習筆記整理:二年級上冊語文生字組詞、語文園地、背誦內容 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/e104e9dc17d9403daf57edff22a8141d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/269cb6ac.html title=學霸學習筆記整理:二年級上冊語文生字組詞、語文園地、背誦內容>學霸學習筆記整理:二年級上冊語文生字組詞、語文園地、背誦內容</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/efabb5bb.html alt=吳恩達深度學習筆記(106)-風格遷移網絡講解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/01def15aa8654252990f709965d5b769 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/efabb5bb.html title=吳恩達深度學習筆記(106)-風格遷移網絡講解>吳恩達深度學習筆記(106)-風格遷移網絡講解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3605c009.html alt="吳恩達深度學習筆記(67)-遷移學習（Transfer learning)" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/f00ccb946c7a451aa25adba4b28799e5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3605c009.html title="吳恩達深度學習筆記(67)-遷移學習（Transfer learning)">吳恩達深度學習筆記(67)-遷移學習（Transfer learning)</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9819f021.html alt="吳恩達深度學習筆記(89)-遷移學習（Transfer Learning）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d934f6fbf66144dca95cbb6ce8223d62 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9819f021.html title="吳恩達深度學習筆記(89)-遷移學習（Transfer Learning）">吳恩達深度學習筆記(89)-遷移學習（Transfer Learning）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d0730e65.html alt=LINUX學習筆記 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/44f9bc1578c2472a9e0d5d71b924649a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d0730e65.html title=LINUX學習筆記>LINUX學習筆記</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>