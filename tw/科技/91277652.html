<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>ç¶œåˆå…¸è—ï¼šå…¨é¢å¿«é€Ÿå…¥é–€Redisæ•¸æ“šåº«(æ–‡æœ«æœ‰æ›´å¤šè³‡æ–™ï¼‰ | æå®¢å¿«è¨Š</title><meta property="og:title" content="ç¶œåˆå…¸è—ï¼šå…¨é¢å¿«é€Ÿå…¥é–€Redisæ•¸æ“šåº«(æ–‡æœ«æœ‰æ›´å¤šè³‡æ–™ï¼‰ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/94a1c0a72fcf432bb4711317aadcc8c5"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/91277652.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/91277652.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/91277652.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/91277652.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/91277652.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/91277652.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/91277652.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/91277652.html><meta property="article:published_time" content="2020-10-29T21:09:57+08:00"><meta property="article:modified_time" content="2020-10-29T21:09:57+08:00"><meta name=Keywords content><meta name=description content="ç¶œåˆå…¸è—ï¼šå…¨é¢å¿«é€Ÿå…¥é–€Redisæ•¸æ“šåº«(æ–‡æœ«æœ‰æ›´å¤šè³‡æ–™ï¼‰"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/91277652.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>ç¶œåˆå…¸è—ï¼šå…¨é¢å¿«é€Ÿå…¥é–€Redisæ•¸æ“šåº«(æ–‡æœ«æœ‰æ›´å¤šè³‡æ–™ï¼‰</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><blockquote><p>ä½œè€…ï¼šå°å¼Ÿèª¿èª¿</p><p>éˆæ¥ï¼šhttps://segmentfault.com/a/1190000010241956</p></blockquote><p><br></p><div class=pgc-img><img alt=ç¶œåˆå…¸è—ï¼šå…¨é¢å¿«é€Ÿå…¥é–€Redisæ•¸æ“šåº«(æ–‡æœ«æœ‰æ›´å¤šè³‡æ–™ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/94a1c0a72fcf432bb4711317aadcc8c5><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>Rediså®‰è£</p><p>å®˜æ–¹ç·¨è­¯å®‰è£</p><p>$ wget http://download.redis.io/releases/redis-4.0.0.tar.gz</p><p>$ tar xzvf redis-4.0.0.tar.gz -C /usr/local/</p><p>$ cd /usr/local/redis-4.0.0</p><p>$ make</p><p>$ make test</p><p>$ make install</p><p># ç¨‹åºæœƒè‡ªå‹•åŸ·è¡Œ:</p><p># mkdir -p /usr/local/bin</p><p># cp -pf redis-server /usr/local/bin</p><p># cp -pf redis-benchmark /usr/local/bin</p><p># cp -pf redis-cli /usr/local/bin</p><p># cp -pf redis-check-dump /usr/local/bin</p><p># cp -pf redis-check-aof /usr/local/bin</p><p>æ¸¬è©¦make testå ±éŒ¯</p><p>$ make test</p><p>You need tcl 8.5 or newer in order to run the Redis test</p><p>make: *** [test] Error 1</p><p>é€™å€‹æ˜¯éœ€è¦å®‰è£tcl</p><p>wget http://downloads.sourceforge.net/tcl/tcl8.6.1-src.tar.gz</p><p>sudo tar xzvf tcl8.6.1-src.tar.gz -C /usr/local/</p><p>cd /usr/local/tcl8.6.1/unix/</p><p>sudo ./configure</p><p>sudo make</p><p>sudo make install</p><p>é€šéEPELæºå®‰è£</p><p>æºå®‰è£å•é¡Œåœ¨æ–¼ä¸èƒ½å®‰è£æœ€æ–°ï¼Œæˆ–è€…æŒ‡å®šRedisç‰ˆæœ¬ã€‚</p><p>yum --enablerepo=epel -y install redis</p><p>å¦‚æœæ²’æœ‰å®‰è£æºï¼Œé€šéä¸‹é¢æ–¹å¼å®‰è£æºã€‚</p><p>cd /etc/yum.repos.d/</p><p>rpm -Uvh http://download.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</p><p>Rediså‡ç´š</p><p>é¦–å…ˆï¼Œç¢ºä¿å®‰è£äº†ä»¥ä¸‹reposï¼ŒEPELå’ŒREMIï¼š</p><p>sudo rpm -Uvh http://download.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</p><p>sudo rpm -Uvh http://rpms.remirepo.net/enterprise/remi-release-6.rpm</p><p>é€šé--enablerepo=epelåƒæ•¸æŸ¥çœ‹æŒ‡å®šæºRedisç‰ˆæœ¬ï¼Œæª¢æŸ¥REMI repoä¸­çš„Redisç‰ˆæœ¬ï¼š</p><p>yum --enablerepo=epel info redis</p><p># Loaded plugins: fastestmirror</p><p># Loading mirror speeds from cached hostfile</p><p># * base: centos.ustc.edu.cn</p><p># * epel: mirrors.tuna.tsinghua.edu.cn</p><p># * extras: centos.ustc.edu.cn</p><p># * updates: mirrors.zju.edu.cn</p><p># Available Packages</p><p># Name : redis</p><p># Arch : x86_64</p><p># Version : 2.4.10</p><p># Release : 1.el6</p><p># Size : 213 k</p><p># Repo : epel/x86_64</p><p># Summary : A persistent key-value database</p><p># URL : http://redis.io</p><p># License : BSD</p><p># Description : Redis is an advanced key-value store. It is similar to memcached but the data</p><p># : set is not volatile, and values can be strings, exactly like in memcached, but</p><p># : also lists, sets, and ordered sets. All this data types can be manipulated with</p><p># : atomic operations to push/pop elements, add/remove elements, perform server</p><p># : side union, intersection, difference between sets, and so forth. Redis supports</p><p># : different kind of sorting abilities.</p><p>ç„¶å¾Œå¾EPEL repoå®‰è£ç›¸é—œçš„ä¾è³´é—œä¿‚ï¼ˆjemallocï¼‰ï¼š</p><p>yum --enablerepo=epel install jemalloc</p><p>åœ¨å®‰è£ä¹‹å‰ï¼Œæ‚¨æ‡‰è©²åœæ­¢èˆŠçš„Rediså®ˆè­·é€²ç¨‹ï¼š</p><p>service redis stop</p><p>ç„¶å¾Œå®‰è£æ›´æ–°ç‰ˆæœ¬çš„Redisï¼š</p><p>sudo yum --enablerepo=remi install redis</p><p>æœå‹™ç®¡ç†</p><p>é‡æ–°å•Ÿå‹•Rediså®ˆè­·ç¨‹åºï¼Œä¸¦ä½¿å…¶é‡æ–°å•Ÿå‹•æ™‚è‡ªå‹•å•Ÿå‹•ï¼š</p><p>sudo service redis start</p><p>sudo chkconfig redis on</p><p>åŸºæœ¬æœå‹™æ“ä½œ</p><p>## å•Ÿå‹•ä¸¦å¾Œè‡ºé‹è¡Œ</p><p>$ redis-server & nohup</p><p>## æŸ¥æ˜¯å¦å•Ÿå‹•</p><p>$ redis-cli ping</p><p>## é—œé–‰å‘½ä»¤</p><p>$ redis-cli shutdown</p><p># å‘½ä»¤è¡Œå®¢æˆ¶ç«¯å•Ÿå‹•</p><p>$ redis-cli start</p><p># å•Ÿå‹•</p><p>$ service redis start</p><p># åœæ­¢</p><p>$ service redis stop</p><p># å‘½ä»¤è¡Œå®¢æˆ¶ç«¯å•Ÿå‹•</p><p>$ redis-cli -p 6380</p><p># æŒ‡å®šç«¯å£å¾Œè‡ºå•Ÿå‹•</p><p>$ redis-server --port 6380 &</p><p>æŸ¥çœ‹ç‰ˆæœ¬</p><p>æª¢æŸ¥ç•¶å‰å®‰è£çš„Redisç‰ˆæœ¬ï¼š</p><p># æŸ¥çœ‹ Redis ç‰ˆæœ¬</p><p>$ redis-cli info | grep redis_version</p><p># æŸ¥çœ‹ç«¯å£è™Ÿ</p><p>$ redis-cli info | grep tcp_port</p><p>é–‹æ©Ÿå•Ÿå‹•</p><p>æˆ‘å€‘å°‡åœ¨ Redis å®‰è£ç›®éŒ„æ‰¾åˆ°/usr/local/redis-4.0.0/utilsé€™å€‹ç›®éŒ„ï¼Œåœ¨é€™å€‹ç›®éŒ„ä¸­æœ‰å€‹æœ‰å€‹è…³æœ¬ redis_init_scriptï¼Œå°‡æ­¤è…³æœ¬æ‹·è²åˆ°/etc/init.dç›®éŒ„ä¸‹ï¼Œå‘½åç‚ºredis:</p><p>cp /usr/local/redis-4.0.0/utils/redis_init_script /etc/init.d/redis</p><p>æ‹·è²ä¸€ä¸‹redis.conf æ–‡ä»¶åˆ°/etc/redisç›®éŒ„ä¸‹</p><p>cp /usr/local/redis-4.0.0/redis.conf /etc/redis/6380.conf</p><p>é…ç½®æ–‡ä»¶6380.conféœ€è¦æ›´æ”¹å¹¾å€‹åœ°æ–¹</p><p># æ˜¯å¦åœ¨å¾Œè‡ºåŸ·è¡Œï¼Œyesï¼šå¾Œè‡ºé‹è¡Œï¼›noï¼šä¸æ˜¯å¾Œè‡ºé‹è¡Œï¼ˆè€ç‰ˆæœ¬é»˜èªï¼‰</p><p>daemonize yes</p><p>æ›´æ”¹æ¬Šé™ï¼Œé€šé chkconfig å‘½ä»¤æª¢æŸ¥ã€è¨­ç½®ç³»çµ±redisæœå‹™é–‹å•Ÿ</p><p>chmod +x /etc/init.d/redis</p><p>chkconfig redis on</p><p>å¿…é ˆæŠŠä¸‹é¢å…©è¡Œè¨»é‡‹æ”¾åœ¨ /etc/init.d/redis æ–‡ä»¶é ­éƒ¨ï¼Œä¸è¨­ç½®æœƒå ±ä¸æ”¯æŒçš„æç¤º service redis does not support chkconfig</p><p># chkconfig: 2345 90 10</p><p># description: redis is a persistent key-value database</p><p>ä¸Šé¢çš„è¨»é‡‹çš„æ„æ€æ˜¯ï¼Œredisæœå‹™å¿…é ˆåœ¨é‹è¡Œç´š2ï¼Œ3ï¼Œ4ï¼Œ5ä¸‹è¢«å•Ÿå‹•æˆ–é—œé–‰ï¼Œå•Ÿå‹•çš„å„ªå…ˆç´šæ˜¯90ï¼Œé—œé–‰çš„å„ªå…ˆç´šæ˜¯10ã€‚</p><p><strong>Redis å•Ÿå‹•è­¦å‘ŠéŒ¯èª¤è§£æ±º</strong></p><ol><li>WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.</li></ol><p>echo "vm.overcommit_memory=1" > /etc/sysctl.conf # æˆ– vi /etcsysctl.conf , ç„¶å¾Œrebooté‡å•Ÿæ©Ÿå™¨</p><p>echo 1 > /proc/sys/vm/overcommit_memory # ä¸éœ€è¦å•Ÿæ©Ÿå™¨å°±ç”Ÿæ•ˆ</p><ol><li>WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.</li></ol><p>echo 511 > /proc/sys/net/core/somaxconn</p><p>æ›´æ”¹é…ç½®</p><p>Redis çš„é…ç½®æ–‡ä»¶ä½æ–¼ Redis å®‰è£ç›®éŒ„ä¸‹ï¼Œæ–‡ä»¶åç‚º redis.confã€‚é»˜èª Redis é…ç½®æ–‡ä»¶åœ¨ sudo vi /etc/redis.conf é€™è£¡å¯ä»¥ç·¨è¼¯</p><p>sudo vi /etc/redis.conf</p><p>ä½ å¯ä»¥é€šé CONFIG å‘½ä»¤æŸ¥çœ‹æˆ–è¨­ç½®é…ç½®é …ã€‚é…ç½®è¨­ç½®å‘½ä»¤</p><p>## é€²å…¥redisç²å–</p><p>127.0.0.1:6379> CONFIG GET CONFIG_SETTING_NAME</p><p>## é€²å…¥redisè¨­ç½®</p><p>127.0.0.1:6379> CONFIG SET CONFIG_SETTING_NAME NEW_CONFIG_VALUE</p><p>## ç²å–æ‰€æœ‰é…ç½®</p><p>127.0.0.1:6379> CONFIG GET *</p><p>## è¨­ç½®é…ç½®é–‹å•Ÿé€šçŸ¥åŠŸèƒ½</p><p>$ redis-cli config set notify-keyspace-events KEA</p><p>åŸºæœ¬æ“ä½œ</p><p>## å‘½ä»¤è¡Œå®¢æˆ¶ç«¯å•Ÿå‹•</p><p>$ redis-cli</p><p># æ¸¬è©¦å¿ƒè·³</p><p>127.0.0.1:6379> ping</p><p>PONG</p><p># è¨­ç½® mykey éµçš„å€¼</p><p>127.0.0.1:6379> set mykey hello</p><p>OK</p><p># ç²å– mykey éµçš„å€¼</p><p>127.0.0.1:6379> get mykey</p><p>"hello"</p><p>## è¨­ç½® mykey å¤±æ•ˆäº‹ä»¶</p><p>127.0.0.1:6379> expire mykey 2</p><p># æŸ¥çœ‹ç•¶å‰redisçš„é…ç½®ä¿¡æ¯</p><p>127.0.0.1:6379> config get *</p><p># ç²å–æ‰€æœ‰çš„key</p><p>127.0.0.1:6379> keys *</p><p># åˆªé™¤redisç•¶å‰æ•¸æ“šåº«ä¸­çš„æ‰€æœ‰Key</p><p>127.0.0.1:6379> flushdb</p><p>127.0.0.1:6379> config get dir</p><p># é¥å“­ç•¶å‰åº« key çš„æ•¸é‡</p><p>127.0.0.1:6379> dbsize</p><p># åˆªé™¤æ‰€æœ‰æ•¸æ“šåº«ä¸­çš„key</p><p>127.0.0.1:6379> flushall</p><p># é€€å‡º</p><p>127.0.0.1:6379> exit</p><p># æ‰¾å‡ºæ‹–æ…¢ Redis çš„ç½ªé­ç¦é¦–</p><p># é€šéé€™å€‹å·¥å…·å¯ä»¥æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤çµ±è¨ˆçš„å¿«ç…§ï¼Œ</p><p># æ¯”å¦‚å‘½ä»¤åŸ·è¡Œäº†å¤šå°‘æ¬¡ï¼Œ</p><p># åŸ·è¡Œå‘½ä»¤æ‰€è€—è²»çš„æ¯«ç§’æ•¸(æ¯å€‹å‘½ä»¤çš„ç¸½æ™‚é–“å’Œå¹³å‡æ™‚é–“)</p><p># åªéœ€è¦ç°¡å–®åœ°åŸ·è¡Œ CONFIG RESETSTAT å‘½ä»¤å°±å¯ä»¥é‡ç½®ï¼Œé€™æ¨£ä½ å°±å¯ä»¥å¾—åˆ°ä¸€å€‹å…¨æ–°çš„çµ±è¨ˆçµæœã€‚</p><p>127.0.0.1:6379> commandstats</p><p>cmdstat_get:calls=78,usec=608,usec_per_call=7.79</p><p>cmdstat_setex:calls=5,usec=71,usec_per_call=14.20</p><p>cmdstat_keys:calls=2,usec=42,usec_per_call=21.00</p><p>cmdstat_info:calls=10,usec=1931,usec_per_call=193.10</p><p>æ”¯æŒçš„æ•¸æ“šé¡å‹</p><p>å­—ç¬¦ä¸²</p><p># å•Ÿå‹•å®¢æˆ¶ç«¯ ,å­˜å„²å­—ç¬¦ä¸²åˆ°redis.</p><p>redis> SET name forezp</p><p>OK</p><p># å–å­—ç¬¦ä¸²:</p><p>redis> get name</p><p>"forezp"</p><p>Hashes - å“ˆå¸Œå€¼</p><p>redis > HMSET king username forezp password xxdxx age 22</p><p>redis > HGETALL king</p><p>1) "username"</p><p>2) "forezp "</p><p>3) "password "</p><p>4) "xxdxx "</p><p>5) "age "</p><p>6) "22"</p><p>Lists - åˆ—è¡¨</p><p>redis> lpush pricess kenny</p><p>(integer) 1</p><p>redis 127.0.0.1:6379> lpush pricess jolin</p><p>(integer) 2</p><p>redis 127.0.0.1:6379> lpush pricess mayun</p><p>(integer) 3</p><p>redis 127.0.0.1:6379> lrange pricess 0 10</p><p>1) "kenny"</p><p>2) "jolin"</p><p>3) "mayun"</p><p>æœ‰åºé›†åˆ</p><p>redis > ZADD kindom 1 redis</p><p>(integer) 1</p><p>redis> ZADD kindom 2 mongodb</p><p>(integer) 1</p><p>redis > ZADD kindom 3 mysql</p><p>(integer) 1</p><p>redis > ZADD kindom 3 mysql</p><p>(integer) 0</p><p>redis > ZADD kindom 4 mysql</p><p>(integer) 0</p><p>redis > ZRANGE kindom 0 10 WITHSCORES</p><p>1) "redis"</p><p>2) "1"</p><p>3) "mongodb"</p><p>4) "2"</p><p>5) "mysql"</p><p>6) "4"</p><p>é–‹å•Ÿé€šçŸ¥</p><p>éµç©ºé–“äº‹ä»¶é€šçŸ¥é»˜èªè¢«ç¦ç”¨ï¼Œå› ç‚ºé€™å€‹ç‰¹æ€§æ¶ˆè€—CPUé›»é‡ä¸æ˜¯å¾ˆæ˜æ™ºã€‚ä½¿ç”¨redis.confçš„notify-keyspace-eventsï¼Œæˆ–è€…é€šéCONFIG SETä¾†é–‹å•Ÿé€šçŸ¥ã€‚</p><p>## è¨­ç½®é…ç½®é–‹å•Ÿé€šçŸ¥åŠŸèƒ½</p><p>$ redis-cli config set notify-keyspace-events KEA</p><p>## å‘½ä»¤è¡Œç›£æ§æ‰€æœ‰é€šçŸ¥</p><p>$ redis-cli --csv psubscribe '__key*__:*'</p><p>Reading messages... (press Ctrl-C to quit)</p><p>"psubscribe","__key*__:*",1</p><p>éµå€¼èªªæ˜</p><p>K Keyspace events, published with __keyspace@&lt;db>__ prefix.</p><p>E Keyevent events, published with __keyevent@&lt;db>__ prefix.</p><p>g Generic commands (non-type specific) like DEL, EXPIRE, RENAME, ...</p><p>$ String commands</p><p>l List commands</p><p>s Set commands</p><p>h Hash commands</p><p>z Sorted set commands</p><p>x Expired events (events generated every time a key expires)</p><p>e Evicted events (events generated when a key is evicted for maxmemory)</p><p>A Alias for g$lshzxe, so that the "AKE" string means all the events.</p><p>ä¸åŒå‘½ä»¤ç”¢ç”Ÿçš„äº‹ä»¶(Events generated by different commands)</p><p>æŒ‰ç…§ä¸‹é¢çš„æ¸…å–®ï¼Œä¸åŒçš„å‘½ä»¤ç”¢ç”Ÿä¸åŒé¡å‹çš„äº‹ä»¶ã€‚ Redis Keyspace Notifications</p><ul><li>DEL ç‚ºæ¯ä¸€å€‹è¢«åˆªé™¤çš„éµç”¢ç”Ÿä¸€å€‹deläº‹ä»¶ã€‚</li><li>RENAME ç”¢ç”Ÿå…©å€‹äº‹ä»¶ï¼Œç‚ºæºéµç”¢ç”Ÿä¸€å€‹rename_fromäº‹ä»¶ï¼Œç‚ºç›®æ¨™éµç”¢ç”Ÿä¸€å€‹rename_toäº‹ä»¶ã€‚</li><li>EXPIRE ç•¶ç‚ºéµè¨­ç½®éæœŸæ™‚ç”¢ç”Ÿä¸€å€‹expireäº‹ä»¶ï¼Œæˆ–è€…æ¯ç•¶è¨­ç½®äº†éæœŸçš„éµè¢«åˆªé™¤æ™‚ç”¢ç”Ÿä¸€å€‹expiredäº‹ä»¶(æŸ¥çœ‹EXPIREæ–‡æª”ç²å–æ›´å¤šä¿¡æ¯)ã€‚</li><li>SORT ç•¶STOREç”¨æ–¼è¨­ç½®ä¸€å€‹æ–°éµæ™‚ç”¢ç”Ÿä¸€å€‹sortstoreäº‹ä»¶ã€‚ç•¶çµæœåˆ—è¡¨ç‚ºç©ºï¼Œä¸¦ä¸”ä½¿ç”¨äº†STOREé¸é …ï¼Œä¸¦ä¸”å·²ç¶“æœ‰ä¸€å€‹è©²åå­—çš„éµå­˜åœ¨ï¼Œé‚£éº¼é€™å€‹ä»¶éµè¢«åˆªé™¤ï¼Œæ‰€ä»¥é€™ç¨®æ¢ä»¶ä¸‹æˆ–ç”¢ç”Ÿä¸€å€‹deläº‹ä»¶ã€‚</li><li>SETåŠå…¶æ‰€æœ‰è®Šç¨®(SETEX, SETNX,GETSET) ç”¢ç”Ÿsetäº‹ä»¶ã€‚ä½†æ˜¯SETEXé‚„æœƒç”¢ç”Ÿä¸€å€‹expireäº‹ä»¶ã€‚</li><li>MSET ç‚ºæ¯å€‹éµç”¢ç”Ÿä¸€å€‹å–®ç¨çš„setäº‹ä»¶ã€‚</li><li>SETRANGE ç”¢ç”Ÿä¸€å€‹setrangeäº‹ä»¶ã€‚</li><li>INCR, DECR, INCRBY, DECRBY éƒ½ç”¢ç”Ÿincrbyäº‹ä»¶ã€‚</li><li>INCRBYFLOAT ç”¢ç”Ÿä¸€å€‹incrbyfloatäº‹ä»¶ã€‚</li><li>APPEND ç”¢ç”Ÿä¸€å€‹appendäº‹ä»¶ã€‚</li><li>LPUSHå’ŒLPUSHX ç”¢ç”Ÿå–®å€‹lpushäº‹ä»¶ï¼Œå³ä½¿åœ¨å¯è®Šæƒ…æ³ä¸‹(even in the variadic case)ã€‚</li><li>RPUSHå’ŒRPUSHX ç”¢ç”Ÿå–®å€‹rpushäº‹ä»¶ï¼Œå³ä½¿åœ¨å¯è®Šæƒ…æ³ä¸‹(even in the variadic case)ã€‚</li><li>RPOP ç”¢ç”Ÿä¸€å€‹rpopäº‹ä»¶ã€‚å¦‚æœéµç”±æ–¼æœ€å¾Œä¸€å€‹å…ƒç´ è¢«å¾åˆ—è¡¨ä¸­å½ˆå‡ºè€Œå°è‡´åˆªé™¤ï¼Œæœƒåˆç”¢ç”Ÿä¸€å€‹deläº‹ä»¶ã€‚</li><li>LPOP ç”¢ç”Ÿä¸€å€‹lpopäº‹ä»¶ã€‚å¦‚æœéµç”±æ–¼æœ€å¾Œä¸€å€‹å…ƒç´ è¢«å¾åˆ—è¡¨ä¸­å½ˆå‡ºè€Œå°è‡´åˆªé™¤ï¼Œæœƒåˆç”¢ç”Ÿä¸€å€‹deläº‹ä»¶ã€‚</li><li>LINSERT ç”¢ç”Ÿä¸€å€‹linsertäº‹ä»¶ã€‚</li><li>LSET ç”¢ç”Ÿä¸€å€‹lsetäº‹ä»¶ã€‚</li><li>LREM ç”¢ç”Ÿä¸€å€‹lremäº‹ä»¶ã€‚å¦‚æœçµæœåˆ—è¡¨ç‚ºç©ºä¸¦ä¸”éµè¢«åˆªé™¤ï¼Œæœƒåˆç”¢ç”Ÿä¸€å€‹deläº‹ä»¶ã€‚</li><li>LTRIM ç”¢ç”Ÿä¸€å€‹ltrimäº‹ä»¶ã€‚å¦‚æœçµæœåˆ—è¡¨ç‚ºç©ºä¸¦ä¸”éµè¢«åˆªé™¤ï¼Œæœƒåˆç”¢ç”Ÿä¸€å€‹deläº‹ä»¶ã€‚</li><li>RPOPLPUSHå’ŒBRPOPLPUSH ç”¢ç”Ÿä¸€å€‹rpopäº‹ä»¶å’Œä¸€å€‹lpushäº‹ä»¶ã€‚å…©ç¨®æƒ…æ³ä¸‹é †åºéƒ½èƒ½ä¿è­‰ (lpushäº‹ä»¶ç¸½æ˜¯åœ¨rpopäº‹ä»¶ä¹‹å¾Œè¢«å‚³é) å¦‚æœçµæœåˆ—è¡¨é•·åº¦ç‚ºé›¶ä¸¦ä¸”éµè¢«åˆªé™¤ï¼Œæœƒåˆç”¢ç”Ÿä¸€å€‹deläº‹ä»¶ã€‚</li><li>HSET, HSETNXå’ŒHMSET éƒ½ç”¢ç”Ÿå–®å€‹hsetäº‹ä»¶ã€‚</li><li>HINCRBY ç”¢ç”Ÿä¸€å€‹hincrbyäº‹ä»¶ã€‚</li><li>HINCRBYFLOAT ç”¢ç”Ÿä¸€å€‹hincrbyfloatäº‹ä»¶ã€‚</li><li>HDEL ç”¢ç”Ÿå–®å€‹hdeläº‹ä»¶ã€‚å¦‚æœçµæœå“ˆå¸Œç‚ºç©ºä¸¦ä¸”éµè¢«åˆªé™¤ï¼Œæœƒåˆç”¢ç”Ÿä¸€å€‹deläº‹ä»¶ã€‚</li><li>SADD ç”¢ç”Ÿå–®å€‹saddäº‹ä»¶ï¼Œå³ä½¿åœ¨å¯è®Šæƒ…æ³ä¸‹(even in the variadic case)ã€‚</li><li>SREM ç”¢ç”Ÿå–®å€‹sremäº‹ä»¶ã€‚å¦‚æœçµæœé›†åˆç‚ºç©ºä¸¦ä¸”éµè¢«åˆªé™¤ï¼Œæœƒåˆç”¢ç”Ÿä¸€å€‹deläº‹ä»¶ã€‚</li><li>SMOVE ç‚ºæºéµç”¢ç”Ÿä¸€å€‹sremäº‹ä»¶ç‚ºç›®æ¨™éµç”¢ç”Ÿä¸€å€‹saddäº‹ä»¶ã€‚</li><li>SPOP ç”¢ç”Ÿä¸€å€‹spopäº‹ä»¶ã€‚å¦‚æœçµæœé›†åˆç‚ºç©ºä¸¦ä¸”éµè¢«åˆªé™¤ï¼Œæœƒåˆç”¢ç”Ÿä¸€å€‹deläº‹ä»¶ã€‚</li><li>SINTERSTORE, SUNIONSTORE, SDIFFSTORE åˆ†åˆ¥ç”¢ç”Ÿsinterstoreï¼Œsunionostoreï¼Œsdiffstoreäº‹ä»¶ã€‚åœ¨ç‰¹æ®Šæƒ…æ³ä¸‹ï¼Œé›†åˆç‚ºç©ºï¼Œä¸”å­˜å„²çµæœçš„éµå·²ç¶“å­˜åœ¨ï¼Œç”±æ–¼éµè¢«åˆªé™¤ï¼Œæœƒç”¢ç”Ÿä¸€å€‹deläº‹ä»¶ã€‚</li><li>ZINCR ç”¢ç”Ÿä¸€å€‹zincräº‹ä»¶ã€‚</li><li>ZADDç”¢ç”Ÿå–®å€‹zaddäº‹ä»¶ï¼Œå³ä½¿æ·»åŠ äº†å¤šå€‹å…ƒç´ ã€‚.</li><li>ZREM ç”¢ç”Ÿå–®å€‹zremäº‹ä»¶ï¼Œå³ä½¿åˆªé™¤äº†å¤šå€‹å…ƒç´ ã€‚ç•¶çµæœæœ‰åºé›†åˆç‚ºç©ºï¼Œä¸¦ä¸”éµè¢«ç”Ÿæˆæ™‚ï¼Œæœƒç”¢ç”Ÿä¸€å€‹é¡å¤–çš„deläº‹ä»¶ã€‚</li><li>ZREMBYSCORE ç”¢ç”Ÿå–®å€‹zrembyscoreäº‹ä»¶ã€‚ç•¶çµæœæœ‰åºé›†åˆç‚ºç©ºï¼Œä¸¦ä¸”éµè¢«ç”Ÿæˆæ™‚ï¼Œæœƒç”¢ç”Ÿä¸€å€‹é¡å¤–çš„deläº‹ä»¶ã€‚</li><li>ZREMBYRANK ç”¢ç”Ÿå–®å€‹zrembyrankäº‹ä»¶ã€‚ç•¶çµæœæœ‰åºé›†åˆç‚ºç©ºï¼Œä¸¦ä¸”éµè¢«ç”Ÿæˆæ™‚ï¼Œæœƒç”¢ç”Ÿä¸€å€‹é¡å¤–çš„deläº‹ä»¶ã€‚</li><li>ZINTERSTOREå’ŒZUNIONSTORE åˆ†åˆ¥ç”¢ç”Ÿzinterstoreå’Œzunionstoreäº‹ä»¶ã€‚åœ¨ç‰¹æ®Šæƒ…æ³ä¸‹ï¼Œé›†åˆç‚ºç©ºï¼Œä¸”å­˜å„²çµæœçš„éµå·²ç¶“å­˜åœ¨ï¼Œç”±æ–¼éµè¢«åˆªé™¤ï¼Œæœƒç”¢ç”Ÿä¸€å€‹deläº‹ä»¶ã€‚</li><li>æ¯ç•¶ä¸€å€‹é—œè¯æœ‰ç”Ÿå­˜äº‹ä»¶çš„éµç”±æ–¼éæœŸè€Œè¢«å¾æ•¸æ“šé›†ä¸­åˆªé™¤æ™‚æœƒç”¢ç”Ÿä¸€å€‹expiredäº‹ä»¶ã€‚</li><li>æ¯ç•¶ä¸€å€‹éµç”±æ–¼maxmemoryç­–ç•¥è€Œå¾æ•¸æ“šé›†ä¸­è¢«æ·˜æ±°ä»¥ç¯€çœå…§å­˜æ™‚æœƒç”¢ç”Ÿä¸€å€‹evictedäº‹ä»¶ã€‚</li></ul><p>é–‹å•Ÿé ç¨‹ç™»éŒ„é€£æ¥</p><p>ä½¿ç”¨ netstat ä¾†æŸ¥çœ‹ç«¯å£å ç”¨æƒ…æ³ï¼Œ6379ç‚ºé»˜èªRedisç«¯å£ã€‚</p><p>netstat -nlt|grep 6379</p><ul><li>-tï¼šæŒ‡æ˜é¡¯ç¤º TCP ç«¯å£</li><li>-uï¼šæŒ‡æ˜é¡¯ç¤º UDP ç«¯å£</li><li>-lï¼šåƒ…é¡¯ç¤ºç›£è½å¥—æ¥å­—</li><li>-pï¼šé¡¯ç¤ºé€²ç¨‹æ¨™è­˜ç¬¦å’Œç¨‹åºåç¨±ï¼Œæ¯ä¸€å€‹å¥—æ¥å­—/ç«¯å£éƒ½å±¬æ–¼ä¸€å€‹ç¨‹åºã€‚</li><li>-nï¼šä¸é€²è¡Œ DNS è¼ªè©¢ï¼Œé¡¯ç¤º IP ï¼ˆå¯ä»¥åŠ é€Ÿæ“ä½œï¼‰</li></ul><p>ä¿®æ”¹é˜²ç«ç‰†é…ç½®</p><p>ä¿®æ”¹é˜²ç«ç‰†é…ç½® sudo vi /etc/sysconfig/iptables</p><p>-A INPUT -m state --state NEW -m tcp -p tcp --dport 6379 -j ACCEPT</p><p>ä¿®æ”¹é…ç½®æ–‡ä»¶</p><p>Redis protected-mode æ˜¯3.2 ä¹‹å¾ŒåŠ å…¥çš„æ–°ç‰¹æ€§ï¼Œåœ¨Redis.confçš„è¨»é‡‹ä¸­ï¼Œæˆ‘å€‘å¯ä»¥ç­è§£åˆ°ï¼Œä»–çš„å…·é«”ä½œç”¨å’Œå•Ÿç”¨æ¢ä»¶ã€‚å¯ä»¥åœ¨ sudo vi /etc/redis.conf ä¸­ç·¨è¼¯ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚</p><p># Protected mode is a layer of security protection, in order to avoid that</p><p># Redis instances left open on the internet are accessed and exploited.</p><p>#</p><p># When protected mode is on and if:</p><p>#</p><p># 1) The server is not binding explicitly to a set of addresses using the</p><p># "bind" directive.</p><p># 2) No password is configured.</p><p>#</p><p># The server only accepts connections from clients connecting from the</p><p># IPv4 and IPv6 loopback addresses 127.0.0.1 and ::1, and from Unix domain</p><p># sockets.</p><p>#</p><p># By default protected mode is enabled. You should disable it only if</p><p># you are sure you want clients from other hosts to connect to Redis</p><p># even if no authentication is configured, nor a specific set of interfaces</p><p># are explicitly listed using the "bind" directive.</p><p>protected-mode yes</p><p>å®ƒå•Ÿç”¨çš„æ¢ä»¶ï¼Œæœ‰å…©å€‹ï¼š</p><ol><li>æ²’æœ‰bind IP</li><li>æ²’æœ‰è¨­ç½®è¨ªå•å¯†ç¢¼</li></ol><p>å¦‚æœå•Ÿç”¨äº†ï¼Œå‰‡åªèƒ½å¤ é€šélookback ipï¼ˆ127.0.0.1ï¼‰è¨ªå•Redis cacheï¼Œå¦‚æœå¾å¤–ç¶²è¨ªå•ï¼Œå‰‡æœƒè¿”å›ç›¸æ‡‰çš„éŒ¯èª¤ä¿¡æ¯ï¼š</p><p>(error) DENIED Redis is running in protected mode because protected mode is enabled, no bind address was specified, no authentication password is requested to clients. In this mode connections are only accepted from the lookback interface. If you want to connect from external computers to Redis you may adopt one of the following solutions: 1) Just disable protected mode sending the command 'CONFIG SET protected-mode no' from the loopback interface by connecting to Redis from the same host the server is running, however MAKE SURE Redis is not publicly accessible from internet if you do so. Use CONFIG REWRITE to make this change permanent. 2) Alternatively you can just disable the protected mode by editing the Redis configuration file, and setting the protected mode option to 'no', and then restarting the server. 3) If you started the server manually just for testing, restart it with the --portected-mode no option. 4) Setup a bind address or an authentication password. NOTE: You only need to do one of the above things in order for the server to start accepting connections from the outside.</p><p>æä¾›çš„åŸç”Ÿç›£æ§</p><p>ç•¶å‰éˆæ¥çš„å®¢æˆ¶ç«¯æ•¸å’Œé€£æ¥æ•¸</p><p>redis-cli --statæŸ¥çœ‹ç•¶å‰é€£æ¥çš„å®¢æˆ¶ç«¯æ•¸ï¼Œé€£æ¥æ•¸ç­‰</p><p>------- data ------ --------------------- load -------------------- - child -</p><p>keys mem clients blocked requests connections</p><p>4 1.27M 6 0 17340 (+0) 111</p><p>4 1.27M 6 0 17341 (+1) 111</p><p>4 1.27M 6 0 17342 (+1) 111</p><p>4 1.27M 6 0 17343 (+1) 111</p><p>å…§å­˜æœ€å¤§çš„éµå€¼å’Œå¹³å‡çš„éµå€¼æ•¸æ“š</p><p>redis-cli --bigkeys å°ç•¶å‰ä½”ç”¨å…§å­˜æœ€å¤§çš„éµå€¼å’Œå¹³å‡çš„éµå€¼æ•¸æ“šï¼Œä¹Ÿå¯ä»¥é€šéæŒ‡å®š-iåƒæ•¸å®šæ™‚æŸ¥çœ‹ç•¶å‰çš„è¦–åœ–æƒ…æ³ã€‚</p><p># Scanning the entire keyspace to find biggest keys as well as</p><p># average sizes per key type. You can use -i 0.1 to sleep 0.1 sec</p><p># per 100 SCAN commands (not usually needed).</p><p>[00.00%] Biggest string found so far 'asdf.js' with 3 bytes</p><p>[00.00%] Biggest string found so far 'wabg-tokeneyJhbGciOiJIUzI1NiJ9.NA.UGGRiB2I42rP-33cIMrcoPub7AzHgDlqHacAKFw1pfE' with 328 bytes</p><p>[00.00%] Biggest string found so far 'wabg-token-province' with 231042 bytes</p><p>-------- summary -------</p><p>Sampled 4 keys in the keyspace!</p><p>Total key length in bytes is 180 (avg len 45.00)</p><p>Biggest string found 'wabg-token-province' has 231042 bytes</p><p>4 strings with 231819 bytes (100.00% of keys, avg size 57954.75)</p><p>0 lists with 0 items (00.00% of keys, avg size 0.00)</p><p>0 sets with 0 members (00.00% of keys, avg size 0.00)</p><p>0 hashs with 0 fields (00.00% of keys, avg size 0.00)</p><p>0 zsets with 0 members (00.00% of keys, avg size 0.00)</p><p>æŸ¥çœ‹ç•¶å‰çš„éµå€¼æƒ…æ³</p><p>redis-cli --scanæä¾›å’Œkeys *ç›¸ä¼¼çš„åŠŸèƒ½ï¼ŒæŸ¥çœ‹ç•¶å‰çš„éµå€¼æƒ…æ³ï¼Œå¯ä»¥é€šéæ­£å‰‡è¡¨é”</p><p>$ redis-cli --scan</p><p>sess:K4xh-bxOBrcXpy9kEW87oiy-u7I2sAA5</p><p>asdf.js</p><p>sess:1tGNZSXW8GyoEQsbtpqkA5tMmSFp_ZIn</p><p>wabg-tokeneyJhbGciOiJIUzI1NiJ9.NA.UGGRiB2I42rP-33cIMrcoPub7AzHgDlqHacAKFw1pfE</p><p>sess:3e4NGIJd0wf1-RONeTt-FsXQj4EaVNjk</p><p>wabg-token-province</p><p>sess:UuCLAX2sWZ50fiIO1qvDgulf0XIZRd98</p><p>wabg-tokeneyJhbGciOiJIUzI1NiJ9.MQ.6z44GClzAsUED1M_UyxqdREdDKcYFnL9tSqd5ZhLhsY</p><p>sess:2HEchaRLYUoaa44IF1bB6mpik7lZjBb4</p><p>åŸç”Ÿçš„Monitorç›£æ§</p><p>redis-cli monitoræ‰“å°å‡ºæ‰€æœ‰severæ¥æ”¶åˆ°çš„å‘½ä»¤ä»¥åŠå…¶å°æ‡‰çš„å®¢æˆ¶ç«¯åœ°å€</p><p>$ redis-cli monitor</p><p>OK</p><p>1472626566.218175 [0 127.0.0.1:62862] "info"</p><p>1472626571.220948 [0 127.0.0.1:62862] "exists" "aaa"</p><p>1472626571.223174 [0 127.0.0.1:62862] "set" "aaa" ""</p><p>1472626571.232126 [0 127.0.0.1:62862] "type" "aaa"</p><p>1472626571.243697 [0 127.0.0.1:62862] "pttl" "aaa"</p><p>1472626571.243717 [0 127.0.0.1:62862] "object" "ENCODING" "aaa"</p><p>1472626571.243726 [0 127.0.0.1:62862] "strlen" "aaa"</p><p>é…ç½®èªªæ˜</p><p>#redis.conf</p><p># Redis configuration file example.</p><p># ./redis-server /path/to/redis.conf</p><p>################################## INCLUDES ###################################</p><p>#é€™åœ¨ä½ æœ‰æ¨™æº–é…ç½®æ¨¡æ¿ä½†æ˜¯æ¯å€‹redisæœå‹™å™¨åˆéœ€è¦å€‹æ€§è¨­ç½®çš„æ™‚å€™å¾ˆæœ‰ç”¨ã€‚</p><p># include /path/to/local.conf</p><p># include /path/to/other.conf</p><p>################################ GENERAL #####################################</p><p># æ˜¯å¦åœ¨å¾Œè‡ºåŸ·è¡Œï¼Œyesï¼šå¾Œè‡ºé‹è¡Œï¼›noï¼šä¸æ˜¯å¾Œè‡ºé‹è¡Œï¼ˆè€ç‰ˆæœ¬é»˜èªï¼‰</p><p>daemonize yes</p><p># 3.2è£¡çš„åƒæ•¸ï¼Œæ˜¯å¦é–‹å•Ÿä¿è­·æ¨¡å¼ï¼Œé»˜èªé–‹å•Ÿã€‚è¦æ˜¯é…ç½®è£¡æ²’æœ‰æŒ‡å®šbindå’Œå¯†ç¢¼ã€‚</p><p># é–‹å•Ÿè©²åƒæ•¸å¾Œï¼Œredisåªæœƒæœ¬åœ°é€²è¡Œè¨ªå•ï¼Œæ‹’çµ•å¤–éƒ¨è¨ªå•ã€‚</p><p># è¦æ˜¯é–‹å•Ÿäº†å¯†ç¢¼ å’Œbindï¼Œå¯ä»¥é–‹å•Ÿã€‚å¦ å‰‡æœ€å¥½é—œé–‰ï¼Œè¨­ç½®ç‚ºnoã€‚</p><p>protected-mode yes</p><p># redisçš„é€²ç¨‹æ–‡ä»¶</p><p>pidfile /var/run/redis/redis-server.pid</p><p># redisç›£è½çš„ç«¯å£è™Ÿã€‚</p><p>port 6379</p><p># æ­¤åƒæ•¸ç¢ºå®šäº†TCPé€£æ¥ä¸­å·²å®ŒæˆéšŠåˆ—(å®Œæˆä¸‰æ¬¡æ¡æ‰‹ä¹‹å¾Œ)çš„é•·åº¦ï¼Œ</p><p># ç•¶ç„¶æ­¤å€¼å¿…é ˆä¸å¤§æ–¼Linuxç³»çµ±å®šç¾©çš„/proc/sys/net/core/somaxconnå€¼ï¼Œé»˜èªæ˜¯511ï¼Œ</p><p># è€ŒLinuxçš„é»˜èªåƒæ•¸å€¼æ˜¯128ã€‚ç•¶ç³»çµ±ä½µç™¼é‡å¤§ä¸¦ä¸”å®¢æˆ¶ç«¯é€Ÿåº¦ç·©æ…¢çš„æ™‚å€™ï¼Œ</p><p># å¯ä»¥å°‡é€™äºŒå€‹åƒæ•¸ä¸€èµ·åƒè€ƒè¨­å®šã€‚è©²å…§æ ¸åƒæ•¸é»˜èªå€¼ä¸€èˆ¬æ˜¯128ï¼Œå°æ–¼è² è¼‰å¾ˆå¤§çš„æœå‹™ç¨‹åºä¾†èªªå¤§å¤§çš„ä¸å¤ ã€‚</p><p># ä¸€èˆ¬æœƒå°‡å®ƒä¿®æ”¹ç‚º2048æˆ–è€…æ›´å¤§ã€‚åœ¨/etc/sysctl.confä¸­æ·»åŠ :net.core.somaxconn = 2048ï¼Œç„¶å¾Œåœ¨çµ‚ç«¯ä¸­åŸ·è¡Œsysctl -pã€‚</p><p>tcp-backlog 511</p><p>#æŒ‡å®š redis åªæ¥æ”¶ä¾†è‡ªæ–¼è©² IP åœ°å€çš„è«‹æ±‚ï¼Œå¦‚æœä¸é€²è¡Œè¨­ç½®ï¼Œé‚£éº¼å°‡è™•ç†æ‰€æœ‰è«‹æ±‚</p><p>bind 127.0.0.1</p><p># é…ç½®unix socketä¾†è®“redisæ”¯æŒç›£è½æœ¬åœ°é€£æ¥ã€‚</p><p># unixsocket /var/run/redis/redis.sock</p><p># é…ç½®unix socketä½¿ç”¨æ–‡ä»¶çš„æ¬Šé™</p><p># unixsocketperm 700</p><p># æ­¤åƒæ•¸ç‚ºè¨­ç½®å®¢æˆ¶ç«¯ç©ºé–’è¶…étimeoutï¼Œæœå‹™ç«¯æœƒæ–·é–‹é€£æ¥ï¼Œç‚º0å‰‡æœå‹™ç«¯ä¸æœƒä¸»å‹•æ–·é–‹é€£æ¥ï¼Œä¸èƒ½å°æ–¼0ã€‚</p><p>timeout 0</p><p># tcp keepaliveåƒæ•¸ã€‚å¦‚æœè¨­ç½®ä¸ç‚º0ï¼Œå°±ä½¿ç”¨é…ç½®tcpçš„SO_KEEPALIVEå€¼ï¼Œ</p><p># ä½¿ç”¨keepaliveæœ‰å…©å€‹å¥½è™•:æª¢æ¸¬æ›æ‰çš„å°ç«¯ã€‚é™ä½ä¸­é–“è¨­å‚™å‡ºå•é¡Œè€Œå°è‡´ç¶²çµ¡çœ‹ä¼¼é€£æ¥å»å·²ç¶“èˆ‡å°ç«¯ç«¯å£çš„å•é¡Œã€‚</p><p># åœ¨Linuxå…§æ ¸ä¸­ï¼Œè¨­ç½®äº†keepaliveï¼Œredisæœƒå®šæ™‚çµ¦å°ç«¯ç™¼é€ackã€‚æª¢æ¸¬åˆ°å°ç«¯é—œé–‰éœ€è¦å…©å€çš„è¨­ç½®å€¼ã€‚</p><p>tcp-keepalive 0</p><p># æŒ‡å®šäº†æœå‹™ç«¯æ—¥èªŒçš„ç´šåˆ¥ã€‚ç´šåˆ¥åŒ…æ‹¬ï¼šdebugï¼ˆå¾ˆå¤šä¿¡æ¯ï¼Œæ–¹ä¾¿é–‹ç™¼ã€æ¸¬è©¦ï¼‰ï¼Œ</p><p># verboseï¼ˆè¨±å¤šæœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯æ²’æœ‰debugç´šåˆ¥ä¿¡æ¯å¤šï¼‰ï¼Œnoticeï¼ˆé©ç•¶çš„æ—¥èªŒç´šåˆ¥ï¼Œé©åˆç”Ÿç”¢ç’°å¢ƒï¼‰ï¼Œwarnï¼ˆåªæœ‰éå¸¸é‡è¦çš„ä¿¡æ¯ï¼‰</p><p>loglevel notice</p><p>#æŒ‡å®šäº†è¨˜éŒ„æ—¥èªŒçš„æ–‡ä»¶ã€‚ç©ºå­—ç¬¦ä¸²çš„è©±ï¼Œæ—¥èªŒæœƒæ‰“å°åˆ°æ¨™æº–è¼¸å‡ºè¨­å‚™ã€‚å¾Œè‡ºé‹è¡Œçš„redisæ¨™æº–è¼¸å‡ºæ˜¯/dev/nullã€‚</p><p>logfile /var/log/redis/redis-server.log</p><p># æ˜¯å¦æ‰“é–‹è¨˜éŒ„syslogåŠŸèƒ½</p><p># syslog-enabled no</p><p># syslogçš„æ¨™è­˜ç¬¦ã€‚</p><p># syslog-ident redis</p><p># æ—¥èªŒçš„ä¾†æºã€è¨­å‚™</p><p># syslog-facility local0</p><p># æ•¸æ“šåº«çš„æ•¸é‡ï¼Œé»˜èªä½¿ç”¨çš„æ•¸æ“šåº«æ˜¯DB 0ã€‚å¯ä»¥é€šéâ€SELECT â€œå‘½ä»¤é¸æ“‡ä¸€å€‹db</p><p>databases 16</p><p>################################ SNAPSHOTTING ################################</p><p># å¿«ç…§é…ç½®</p><p># è¨»é‡‹æ‰â€œsaveâ€é€™ä¸€è¡Œé…ç½®é …å°±å¯ä»¥è®“ä¿å­˜æ•¸æ“šåº«åŠŸèƒ½å¤±æ•ˆ</p><p># è¨­ç½®sedisé€²è¡Œæ•¸æ“šåº«é¡åƒçš„é »ç‡ã€‚</p><p># 900ç§’ï¼ˆ15åˆ†é˜ï¼‰å…§è‡³å°‘1å€‹keyå€¼æ”¹è®Šï¼ˆå‰‡é€²è¡Œæ•¸æ“šåº«ä¿å­˜--æŒä¹…åŒ–ï¼‰</p><p># 300ç§’ï¼ˆ5åˆ†é˜ï¼‰å…§è‡³å°‘10å€‹keyå€¼æ”¹è®Šï¼ˆå‰‡é€²è¡Œæ•¸æ“šåº«ä¿å­˜--æŒä¹…åŒ–ï¼‰</p><p># 60ç§’ï¼ˆ1åˆ†é˜ï¼‰å…§è‡³å°‘10000å€‹keyå€¼æ”¹è®Šï¼ˆå‰‡é€²è¡Œæ•¸æ“šåº«ä¿å­˜--æŒä¹…åŒ–ï¼‰</p><p>save 900 1</p><p>save 300 10</p><p>save 60 10000</p><p># ç•¶RDBæŒä¹…åŒ–å‡ºç¾éŒ¯èª¤å¾Œï¼Œæ˜¯å¦ä¾ç„¶é€²è¡Œç¹¼çºŒé€²è¡Œå·¥ä½œï¼Œyesï¼šä¸èƒ½é€²è¡Œå·¥ä½œï¼Œnoï¼šå¯ä»¥ç¹¼çºŒé€²è¡Œå·¥ä½œï¼Œ</p><p># å¯ä»¥é€šéinfoä¸­çš„rdb_last_bgsave_statusç­è§£RDBæŒä¹…åŒ–æ˜¯å¦æœ‰éŒ¯èª¤</p><p>stop-writes-on-bgsave-error yes</p><p># ä½¿ç”¨å£“ç¸®rdbæ–‡ä»¶ï¼Œrdbæ–‡ä»¶å£“ç¸®ä½¿ç”¨LZFå£“ç¸®ç®—æ³•ï¼Œyesï¼šå£“ç¸®ï¼Œä½†æ˜¯éœ€è¦ä¸€äº›cpuçš„æ¶ˆè€—ã€‚noï¼šä¸å£“ç¸®ï¼Œéœ€è¦æ›´å¤šçš„ç£ç›¤ç©ºé–“</p><p>rdbcompression yes</p><p># æ˜¯å¦æ ¡é©—rdbæ–‡ä»¶ã€‚å¾rdbæ ¼å¼çš„ç¬¬äº”å€‹ç‰ˆæœ¬é–‹å§‹ï¼Œåœ¨rdbæ–‡ä»¶çš„æœ«å°¾æœƒå¸¶ä¸ŠCRC64çš„æ ¡é©—å’Œã€‚</p><p># é€™è·Ÿæœ‰åˆ©æ–¼æ–‡ä»¶çš„å®¹éŒ¯æ€§ï¼Œä½†æ˜¯åœ¨ä¿å­˜rdbæ–‡ä»¶çš„æ™‚å€™ï¼Œæœƒæœ‰å¤§æ¦‚10%çš„æ€§èƒ½æè€—ï¼Œæ‰€ä»¥å¦‚æœä½ è¿½æ±‚é«˜æ€§èƒ½ï¼Œå¯ä»¥é—œé–‰è©²é…ç½®ã€‚</p><p>rdbchecksum yes</p><p># rdbæ–‡ä»¶çš„åç¨±</p><p>dbfilename dump.rdb</p><p># æ•¸æ“šç›®éŒ„ï¼Œæ•¸æ“šåº«çš„å¯«å…¥æœƒåœ¨é€™å€‹ç›®éŒ„ã€‚rdbã€aofæ–‡ä»¶ä¹Ÿæœƒå¯«åœ¨é€™å€‹ç›®éŒ„</p><p>dir /var/lib/redis</p><p>################################# REPLICATION #################################</p><p># è¤‡è£½é¸é …ï¼Œslaveè¤‡è£½å°æ‡‰çš„masterã€‚</p><p># slaveof &lt;masterip> &lt;masterport></p><p>#å¦‚æœmasterè¨­ç½®äº†requirepassï¼Œé‚£éº¼slaveè¦é€£ä¸Šmasterï¼Œéœ€è¦æœ‰masterçš„å¯†ç¢¼æ‰è¡Œã€‚masterauthå°±æ˜¯ç”¨ä¾†é…ç½®masterçš„å¯†ç¢¼ï¼Œé€™æ¨£å¯ä»¥åœ¨é€£ä¸Šmasterå¾Œé€²è¡Œèªè­‰ã€‚</p><p># masterauth &lt;master-password></p><p>#ç•¶å¾åº«åŒä¸»æ©Ÿå¤±å»é€£æ¥æˆ–è€…è¤‡è£½æ­£åœ¨é€²è¡Œï¼Œå¾æ©Ÿåº«æœ‰å…©ç¨®é‹è¡Œæ–¹å¼ï¼š1) å¦‚æœslave-serve-stale-dataè¨­ç½®ç‚ºyes(é»˜èªè¨­ç½®)ï¼Œå¾åº«æœƒç¹¼çºŒéŸ¿æ‡‰å®¢æˆ¶ç«¯çš„è«‹æ±‚ã€‚2) å¦‚æœslave-serve-stale-dataè¨­ç½®ç‚ºnoï¼Œé™¤å»INFOå’ŒSLAVOFå‘½ä»¤ä¹‹å¤–çš„ä»»ä½•è«‹æ±‚éƒ½æœƒè¿”å›ä¸€å€‹éŒ¯èª¤â€SYNC with master in progressâ€ã€‚</p><p>slave-serve-stale-data yes</p><p>#ä½œç‚ºå¾æœå‹™å™¨ï¼Œé»˜èªæƒ…æ³ä¸‹æ˜¯éš»è®€çš„ï¼ˆyesï¼‰ï¼Œå¯ä»¥ä¿®æ”¹æˆNOï¼Œç”¨æ–¼å¯«ï¼ˆä¸å»ºè­°ï¼‰ã€‚</p><p>slave-read-only yes</p><p>#æ˜¯å¦ä½¿ç”¨socketæ–¹å¼è¤‡è£½æ•¸æ“šã€‚ç›®å‰redisè¤‡è£½æä¾›å…©ç¨®æ–¹å¼ï¼Œdiskå’Œsocketã€‚å¦‚æœæ–°çš„slaveé€£ä¸Šä¾†æˆ–è€…é‡é€£çš„slaveç„¡æ³•éƒ¨åˆ†åŒæ­¥ï¼Œå°±æœƒåŸ·è¡Œå…¨é‡åŒæ­¥ï¼Œmasteræœƒç”Ÿæˆrdbæ–‡ä»¶ã€‚æœ‰2ç¨®æ–¹å¼ï¼šdiskæ–¹å¼æ˜¯masterå‰µå»ºä¸€å€‹æ–°çš„é€²ç¨‹æŠŠrdbæ–‡ä»¶ä¿å­˜åˆ°ç£ç›¤ï¼Œå†æŠŠç£ç›¤ä¸Šçš„rdbæ–‡ä»¶å‚³éçµ¦slaveã€‚socketæ˜¯masterå‰µå»ºä¸€å€‹æ–°çš„é€²ç¨‹ï¼Œç›´æ¥æŠŠrdbæ–‡ä»¶ä»¥socketçš„æ–¹å¼ç™¼çµ¦slaveã€‚diskæ–¹å¼çš„æ™‚å€™ï¼Œç•¶ä¸€å€‹rdbä¿å­˜çš„éç¨‹ä¸­ï¼Œå¤šå€‹slaveéƒ½èƒ½å…±äº«é€™å€‹rdbæ–‡ä»¶ã€‚socketçš„æ–¹å¼å°±çš„ä¸€å€‹å€‹slaveé †åºè¤‡è£½ã€‚åœ¨ç£ç›¤é€Ÿåº¦ç·©æ…¢ï¼Œç¶²é€Ÿå¿«çš„æƒ…æ³ä¸‹æ¨è–¦ç”¨socketæ–¹å¼ã€‚</p><p>repl-diskless-sync no</p><p>#disklessè¤‡è£½çš„å»¶é²æ™‚é–“ï¼Œé˜²æ­¢è¨­ç½®ç‚º0ã€‚ä¸€æ—¦è¤‡è£½é–‹å§‹ï¼Œç¯€é»ä¸æœƒå†æ¥æ”¶æ–°slaveçš„è¤‡è£½è«‹æ±‚ç›´åˆ°ä¸‹ä¸€å€‹rdbå‚³è¼¸ã€‚æ‰€ä»¥æœ€å¥½ç­‰å¾…ä¸€æ®µæ™‚é–“ï¼Œç­‰æ›´å¤šçš„slaveé€£ä¸Šä¾†ã€‚</p><p>repl-diskless-sync-delay 5</p><p>#slaveæ ¹æ“šæŒ‡å®šçš„æ™‚é–“é–“éš”å‘æœå‹™å™¨ç™¼é€pingè«‹æ±‚ã€‚æ™‚é–“é–“éš”å¯ä»¥é€šé repl_ping_slave_period ä¾†è¨­ç½®ï¼Œé»˜èª10ç§’ã€‚</p><p># repl-ping-slave-period 10</p><p>#è¤‡è£½é€£æ¥è¶…æ™‚æ™‚é–“ã€‚masterå’Œslaveéƒ½æœ‰è¶…æ™‚æ™‚é–“çš„è¨­ç½®ã€‚masteræª¢æ¸¬åˆ°slaveä¸Šæ¬¡ç™¼é€çš„æ™‚é–“è¶…érepl-timeoutï¼Œå³èªç‚ºslaveé›¢ç·šï¼Œæ¸…é™¤è©²slaveä¿¡æ¯ã€‚slaveæª¢æ¸¬åˆ°ä¸Šæ¬¡å’Œmasteräº¤äº’çš„æ™‚é–“è¶…érepl-timeoutï¼Œå‰‡èªç‚ºmasteré›¢ç·šã€‚éœ€è¦æ³¨æ„çš„æ˜¯repl-timeoutéœ€è¦è¨­ç½®ä¸€å€‹æ¯”repl-ping-slave-periodæ›´å¤§çš„å€¼ï¼Œä¸ç„¶æœƒç¶“å¸¸æª¢æ¸¬åˆ°è¶…æ™‚ã€‚</p><p># repl-timeout 60</p><p>#æ˜¯å¦ç¦æ­¢è¤‡è£½tcpéˆæ¥çš„tcp nodelayåƒæ•¸ï¼Œå¯å‚³éyesæˆ–è€…noã€‚é»˜èªæ˜¯noï¼Œå³ä½¿ç”¨tcp nodelayã€‚å¦‚æœmasterè¨­ç½®äº†yesä¾†ç¦æ­¢tcp nodelayè¨­ç½®ï¼Œåœ¨æŠŠæ•¸æ“šè¤‡è£½çµ¦slaveçš„æ™‚å€™ï¼Œæœƒæ¸›å°‘åŒ…çš„æ•¸é‡å’Œæ›´å°çš„ç¶²çµ¡å¸¶å¯¬ã€‚ä½†æ˜¯é€™ä¹Ÿå¯èƒ½å¸¶ä¾†æ•¸æ“šçš„å»¶é²ã€‚é»˜èªæˆ‘å€‘æ¨è–¦æ›´å°çš„å»¶é²ï¼Œä½†æ˜¯åœ¨æ•¸æ“šé‡å‚³è¼¸å¾ˆå¤§çš„å ´æ™¯ä¸‹ï¼Œå»ºè­°é¸æ“‡yesã€‚</p><p>repl-disable-tcp-nodelay no</p><p>#è¤‡è£½ç·©è¡å€å¤§å°ï¼Œé€™æ˜¯ä¸€å€‹ç’°å½¢è¤‡è£½ç·©è¡å€ï¼Œç”¨ä¾†ä¿å­˜æœ€æ–°è¤‡è£½çš„å‘½ä»¤ã€‚é€™æ¨£åœ¨slaveé›¢ç·šçš„æ™‚å€™ï¼Œä¸éœ€è¦å®Œå…¨è¤‡è£½masterçš„æ•¸æ“šï¼Œå¦‚æœå¯ä»¥åŸ·è¡Œéƒ¨åˆ†åŒæ­¥ï¼Œåªéœ€è¦æŠŠç·©è¡å€çš„éƒ¨åˆ†æ•¸æ“šè¤‡è£½çµ¦slaveï¼Œå°±èƒ½æ¢å¾©æ­£å¸¸è¤‡è£½ç‹€æ…‹ã€‚ç·©è¡å€çš„å¤§å°è¶Šå¤§ï¼Œslaveé›¢ç·šçš„æ™‚é–“å¯ä»¥æ›´é•·ï¼Œè¤‡è£½ç·©è¡å€åªæœ‰åœ¨æœ‰slaveé€£æ¥çš„æ™‚å€™æ‰åˆ†é…å…§å­˜ã€‚æ²’æœ‰slaveçš„ä¸€æ®µæ™‚é–“ï¼Œå…§å­˜æœƒè¢«é‡‹æ”¾å‡ºä¾†ï¼Œé»˜èª1mã€‚</p><p># repl-backlog-size 5mb</p><p>#masteræ²’æœ‰slaveä¸€æ®µæ™‚é–“æœƒé‡‹æ”¾è¤‡è£½ç·©è¡å€çš„å…§å­˜ï¼Œrepl-backlog-ttlç”¨ä¾†è¨­ç½®è©²æ™‚é–“é•·åº¦ã€‚å–®ä½ç‚ºç§’ã€‚</p><p># repl-backlog-ttl 3600</p><p>#ç•¶masterä¸å¯ç”¨ï¼ŒSentinelæœƒæ ¹æ“šslaveçš„å„ªå…ˆç´šé¸èˆ‰ä¸€å€‹masterã€‚æœ€ä½çš„å„ªå…ˆç´šçš„slaveï¼Œç•¶é¸masterã€‚è€Œé…ç½®æˆ0ï¼Œæ°¸é ä¸æœƒè¢«é¸èˆ‰ã€‚</p><p>slave-priority 100</p><p>#redisæä¾›äº†å¯ä»¥è®“masteråœæ­¢å¯«å…¥çš„æ–¹å¼ï¼Œå¦‚æœé…ç½®äº†min-slaves-to-writeï¼Œå¥åº·çš„slaveçš„å€‹æ•¸å°æ–¼Nï¼Œmaterå°±ç¦æ­¢å¯«å…¥ã€‚masteræœ€å°‘å¾—æœ‰å¤šå°‘å€‹å¥åº·çš„slaveå­˜æ´»æ‰èƒ½åŸ·è¡Œå¯«å‘½ä»¤ã€‚é€™å€‹é…ç½®é›–ç„¶ä¸èƒ½ä¿è­‰Nå€‹slaveéƒ½ä¸€å®šèƒ½æ¥æ”¶åˆ°masterçš„å¯«æ“ä½œï¼Œä½†æ˜¯èƒ½é¿å…æ²’æœ‰è¶³å¤ å¥åº·çš„slaveçš„æ™‚å€™ï¼Œmasterä¸èƒ½å¯«å…¥ä¾†é¿å…æ•¸æ“šä¸Ÿå¤±ã€‚è¨­ç½®ç‚º0æ˜¯é—œé–‰è©²åŠŸèƒ½ã€‚</p><p># min-slaves-to-write 3</p><p>#å»¶é²å°æ–¼min-slaves-max-lagç§’çš„slaveæ‰èªç‚ºæ˜¯å¥åº·çš„slaveã€‚</p><p># min-slaves-max-lag 10</p><p># è¨­ç½®1æˆ–å¦ä¸€å€‹è¨­ç½®ç‚º0ç¦ç”¨é€™å€‹ç‰¹æ€§ã€‚</p><p># Setting one or the other to 0 disables the feature.</p><p># By default min-slaves-to-write is set to 0 (feature disabled) and</p><p># min-slaves-max-lag is set to 10.</p><p>################################## SECURITY ###################################</p><p>#requirepassé…ç½®å¯ä»¥è®“ç”¨æˆ¶ä½¿ç”¨AUTHå‘½ä»¤ä¾†èªè­‰å¯†ç¢¼ï¼Œæ‰èƒ½ä½¿ç”¨å…¶ä»–å‘½ä»¤ã€‚é€™è®“rediså¯ä»¥ä½¿ç”¨åœ¨ä¸å—ä¿¡ä»»çš„ç¶²çµ¡ä¸­ã€‚ç‚ºäº†ä¿æŒå‘å¾Œçš„å…¼å®¹æ€§ï¼Œå¯ä»¥è¨»é‡‹è©²å‘½ä»¤ï¼Œå› ç‚ºå¤§éƒ¨åˆ†ç”¨æˆ¶ä¹Ÿä¸éœ€è¦èªè­‰ã€‚ä½¿ç”¨requirepassçš„æ™‚å€™éœ€è¦æ³¨æ„ï¼Œå› ç‚ºrediså¤ªå¿«äº†ï¼Œæ¯ç§’å¯ä»¥èªè­‰15wæ¬¡å¯†ç¢¼ï¼Œç°¡å–®çš„å¯†ç¢¼å¾ˆå®¹æ˜“è¢«æ”»ç ´ï¼Œæ‰€ä»¥æœ€å¥½ä½¿ç”¨ä¸€å€‹æ›´å¾©é›œçš„å¯†ç¢¼ã€‚</p><p># requirepass foobared</p><p>#æŠŠå±éšªçš„å‘½ä»¤çµ¦ä¿®æ”¹æˆå…¶ä»–åç¨±ã€‚æ¯”å¦‚CONFIGå‘½ä»¤å¯ä»¥é‡å‘½åç‚ºä¸€å€‹å¾ˆé›£è¢«çŒœåˆ°çš„å‘½ä»¤ï¼Œé€™æ¨£ç”¨æˆ¶ä¸èƒ½ä½¿ç”¨ï¼Œè€Œå…§éƒ¨å·¥å…·é‚„èƒ½æ¥è‘—ä½¿ç”¨ã€‚</p><p># rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52</p><p>#è¨­ç½®æˆä¸€å€‹ç©ºçš„å€¼ï¼Œå¯ä»¥ç¦æ­¢ä¸€å€‹å‘½ä»¤</p><p># rename-command CONFIG ""</p><p>################################### LIMITS ####################################</p><p># è¨­ç½®èƒ½é€£ä¸Šredisçš„æœ€å¤§å®¢æˆ¶ç«¯é€£æ¥æ•¸é‡ã€‚é»˜èªæ˜¯10000å€‹å®¢æˆ¶ç«¯é€£æ¥ã€‚</p><p># ç”±æ–¼redisä¸å€åˆ†é€£æ¥æ˜¯å®¢æˆ¶ç«¯é€£æ¥é‚„æ˜¯å…§éƒ¨æ‰“é–‹æ–‡ä»¶æˆ–è€…å’Œslaveé€£æ¥ç­‰ï¼Œæ‰€ä»¥maxclientsæœ€å°å»ºè­°è¨­ç½®åˆ°32ã€‚</p><p># å¦‚æœè¶…éäº†maxclientsï¼Œredisæœƒçµ¦æ–°çš„é€£æ¥ç™¼é€â€™max number of clients reachedâ€™ï¼Œä¸¦é—œé–‰é€£æ¥ã€‚</p><p># maxclients 10000</p><p># redisé…ç½®çš„æœ€å¤§å…§å­˜å®¹é‡ã€‚ç•¶å…§å­˜æ»¿äº†ï¼Œéœ€è¦é…åˆmaxmemory-policyç­–ç•¥é€²è¡Œè™•ç†ã€‚</p><p># æ³¨æ„slaveçš„è¼¸å‡ºç·©è¡å€æ˜¯ä¸è¨ˆç®—åœ¨maxmemoryå…§çš„ã€‚æ‰€ä»¥ç‚ºäº†é˜²æ­¢ä¸»æ©Ÿå…§å­˜ä½¿ç”¨å®Œï¼Œå»ºè­°è¨­ç½®çš„maxmemoryéœ€è¦æ›´å°ä¸€äº›ã€‚</p><p># maxmemory &lt;bytes></p><p># å…§å­˜å®¹é‡è¶…émaxmemoryå¾Œçš„è™•ç†ç­–ç•¥ã€‚</p><p># volatile-lruï¼šåˆ©ç”¨LRUç®—æ³•ç§»é™¤è¨­ç½®ééæœŸæ™‚é–“çš„keyã€‚</p><p># volatile-randomï¼šéš¨æ©Ÿç§»é™¤è¨­ç½®ééæœŸæ™‚é–“çš„keyã€‚</p><p># volatile-ttlï¼šç§»é™¤å³å°‡éæœŸçš„keyï¼Œæ ¹æ“šæœ€è¿‘éæœŸæ™‚é–“ä¾†åˆªé™¤ï¼ˆè¼”ä»¥TTLï¼‰</p><p># allkeys-lruï¼šåˆ©ç”¨LRUç®—æ³•ç§»é™¤ä»»ä½•keyã€‚</p><p># allkeys-randomï¼šéš¨æ©Ÿç§»é™¤ä»»ä½•keyã€‚</p><p># noevictionï¼šä¸ç§»é™¤ä»»ä½•keyï¼Œåªæ˜¯è¿”å›ä¸€å€‹å¯«éŒ¯èª¤ã€‚</p><p># ä¸Šé¢çš„é€™äº›é©…é€ç­–ç•¥ï¼Œå¦‚æœredisæ²’æœ‰åˆé©çš„keyé©…é€ï¼Œå°æ–¼å¯«å‘½ä»¤ï¼Œé‚„æ˜¯æœƒè¿”å›éŒ¯èª¤ã€‚</p><p># rediså°‡ä¸å†æ¥æ”¶å¯«è«‹æ±‚ï¼Œåªæ¥æ”¶getè«‹æ±‚ã€‚</p><p># å¯«å‘½ä»¤åŒ…æ‹¬ï¼šset setnx setex append incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby getset mset msetnx exec sortã€‚</p><p># maxmemory-policy noeviction</p><p>#lruæª¢æ¸¬çš„æ¨£æœ¬æ•¸ã€‚ä½¿ç”¨lruæˆ–è€…ttlæ·˜æ±°ç®—æ³•ï¼Œå¾éœ€è¦æ·˜æ±°çš„åˆ—è¡¨ä¸­éš¨æ©Ÿé¸æ“‡sampleå€‹keyï¼Œé¸å‡ºé–’ç½®æ™‚é–“æœ€é•·çš„keyç§»é™¤ã€‚</p><p># maxmemory-samples 5</p><p>############################## APPEND ONLY MODE ###############################</p><p>#é»˜èªredisä½¿ç”¨çš„æ˜¯rdbæ–¹å¼æŒä¹…åŒ–ï¼Œé€™ç¨®æ–¹å¼åœ¨è¨±å¤šæ‡‰ç”¨ä¸­å·²ç¶“è¶³å¤ ç”¨äº†ã€‚ä½†æ˜¯rediså¦‚æœä¸­é€”å®•æ©Ÿï¼Œæœƒå°è‡´å¯èƒ½æœ‰å¹¾åˆ†é˜çš„æ•¸æ“šä¸Ÿå¤±ï¼Œæ ¹æ“šsaveä¾†ç­–ç•¥é€²è¡ŒæŒä¹…åŒ–ï¼ŒAppend Only Fileæ˜¯å¦ä¸€ç¨®æŒä¹…åŒ–æ–¹å¼ï¼Œå¯ä»¥æä¾›æ›´å¥½çš„æŒä¹…åŒ–ç‰¹æ€§ã€‚RedisæœƒæŠŠæ¯æ¬¡å¯«å…¥çš„æ•¸æ“šåœ¨æ¥æ”¶å¾Œéƒ½å¯«å…¥ appendonly.aof æ–‡ä»¶ï¼Œæ¯æ¬¡å•Ÿå‹•æ™‚Rediséƒ½æœƒå…ˆæŠŠé€™å€‹æ–‡ä»¶çš„æ•¸æ“šè®€å…¥å…§å­˜è£¡ï¼Œå…ˆå¿½ç•¥RDBæ–‡ä»¶ã€‚</p><p>appendonly no</p><p>#aofæ–‡ä»¶å</p><p>appendfilename "appendonly.aof"</p><p># aofæŒä¹…åŒ–ç­–ç•¥çš„é…ç½®</p><p># noè¡¨ç¤ºä¸åŸ·è¡Œfsyncï¼Œç”±æ“ä½œç³»çµ±ä¿è­‰æ•¸æ“šåŒæ­¥åˆ°ç£ç›¤ï¼Œé€Ÿåº¦æœ€å¿«ã€‚</p><p># alwaysè¡¨ç¤ºæ¯æ¬¡å¯«å…¥éƒ½åŸ·è¡Œfsyncï¼Œä»¥ä¿è­‰æ•¸æ“šåŒæ­¥åˆ°ç£ç›¤ã€‚</p><p># everysecè¡¨ç¤ºæ¯ç§’åŸ·è¡Œä¸€æ¬¡fsyncï¼Œå¯èƒ½æœƒå°è‡´ä¸Ÿå¤±é€™1sæ•¸æ“šã€‚</p><p>appendfsync everysec</p><p># åœ¨aofé‡å¯«æˆ–è€…å¯«å…¥rdbæ–‡ä»¶çš„æ™‚å€™ï¼ŒæœƒåŸ·è¡Œå¤§é‡IOï¼Œ</p><p># æ­¤æ™‚å°æ–¼everysecå’Œalwaysçš„aofæ¨¡å¼ä¾†èªªï¼ŒåŸ·è¡Œfsyncæœƒé€ æˆé˜»å¡éé•·æ™‚é–“ï¼Œ</p><p># no-appendfsync-on-rewriteå­—æ®µè¨­ç½®ç‚ºé»˜èªè¨­ç½®ç‚ºnoã€‚</p><p># å¦‚æœå°å»¶é²è¦æ±‚å¾ˆé«˜çš„æ‡‰ç”¨ï¼Œé€™å€‹å­—æ®µå¯ä»¥è¨­ç½®ç‚ºyesï¼Œå¦å‰‡é‚„æ˜¯è¨­ç½®ç‚ºnoï¼Œ</p><p># é€™æ¨£å°æŒä¹…åŒ–ç‰¹æ€§ä¾†èªªé€™æ˜¯æ›´å®‰å…¨çš„é¸æ“‡ã€‚è¨­ç½®ç‚ºyesè¡¨ç¤ºrewriteæœŸé–“å°æ–°å¯«æ“ä½œä¸fsync,</p><p># æš«æ™‚å­˜åœ¨å…§å­˜ä¸­,ç­‰rewriteå®Œæˆå¾Œå†å¯«å…¥ï¼Œé»˜èªç‚ºnoï¼Œå»ºè­°yesã€‚Linuxçš„é»˜èªfsyncç­–ç•¥æ˜¯30ç§’ã€‚å¯èƒ½ä¸Ÿå¤±30ç§’æ•¸æ“šã€‚</p><p>no-appendfsync-on-rewrite no</p><p># aofè‡ªå‹•é‡å¯«é…ç½®ã€‚ç•¶ç›®å‰aofæ–‡ä»¶å¤§å°è¶…éä¸Šä¸€æ¬¡é‡å¯«çš„aofæ–‡ä»¶å¤§å°çš„ç™¾åˆ†ä¹‹å¤šå°‘é€²è¡Œé‡å¯«ï¼Œ</p><p># å³ç•¶aofæ–‡ä»¶å¢é•·åˆ°ä¸€å®šå¤§å°çš„æ™‚å€™Redisèƒ½å¤ èª¿ç”¨bgrewriteaofå°æ—¥èªŒæ–‡ä»¶é€²è¡Œé‡å¯«ã€‚</p><p># ç•¶å‰AOFæ–‡ä»¶å¤§å°æ˜¯ä¸Šæ¬¡æ—¥èªŒé‡å¯«å¾—åˆ°AOFæ–‡ä»¶å¤§å°çš„äºŒå€ï¼ˆè¨­ç½®ç‚º100ï¼‰æ™‚ï¼Œè‡ªå‹•å•Ÿå‹•æ–°çš„æ—¥èªŒé‡å¯«éç¨‹ã€‚</p><p>auto-aof-rewrite-percentage 100</p><p>#è¨­ç½®å…è¨±é‡å¯«çš„æœ€å°aofæ–‡ä»¶å¤§å°ï¼Œé¿å…äº†é”åˆ°ç´„å®šç™¾åˆ†æ¯”ä½†å°ºå¯¸ä»ç„¶å¾ˆå°çš„æƒ…æ³é‚„è¦é‡å¯«</p><p>auto-aof-rewrite-min-size 64mb</p><p># aofæ–‡ä»¶å¯èƒ½åœ¨å°¾éƒ¨æ˜¯ä¸å®Œæ•´çš„ï¼Œç•¶rediså•Ÿå‹•çš„æ™‚å€™ï¼Œaofæ–‡ä»¶çš„æ•¸æ“šè¢«è¼‰å…¥å…§å­˜ã€‚</p><p># é‡å•Ÿå¯èƒ½ç™¼ç”Ÿåœ¨redisæ‰€åœ¨çš„ä¸»æ©Ÿæ“ä½œç³»çµ±å®•æ©Ÿå¾Œï¼Œ</p><p># å°¤å…¶åœ¨ext4æ–‡ä»¶ç³»çµ±æ²’æœ‰åŠ ä¸Šdata=orderedé¸é …ï¼ˆrediså®•æ©Ÿæˆ–è€…ç•°å¸¸çµ‚æ­¢ä¸æœƒé€ æˆå°¾éƒ¨ä¸å®Œæ•´ç¾è±¡ã€‚ï¼‰</p><p># å‡ºç¾é€™ç¨®ç¾è±¡ï¼Œå¯ä»¥é¸æ“‡è®“redisé€€å‡ºï¼Œæˆ–è€…å°å…¥å„˜å¯èƒ½å¤šçš„æ•¸æ“šã€‚å¦‚æœé¸æ“‡çš„æ˜¯yesï¼Œ</p><p># ç•¶æˆªæ–·çš„aofæ–‡ä»¶è¢«å°å…¥çš„æ™‚å€™ï¼Œæœƒè‡ªå‹•ç™¼ä½ˆä¸€å€‹logçµ¦å®¢æˆ¶ç«¯ç„¶å¾Œloadã€‚å¦‚æœæ˜¯noï¼Œç”¨æˆ¶å¿…é ˆæ‰‹å‹•redis-check-aofä¿®å¾©AOFæ–‡ä»¶æ‰å¯ä»¥ã€‚</p><p>aof-load-truncated yes</p><p>################################ LUA SCRIPTING ###############################</p><p># å¦‚æœé”åˆ°æœ€å¤§æ™‚é–“é™åˆ¶ï¼ˆæ¯«ç§’ï¼‰ï¼Œredisæœƒè¨˜å€‹logï¼Œç„¶å¾Œè¿”å›errorã€‚</p><p># ç•¶ä¸€å€‹è…³æœ¬è¶…éäº†æœ€å¤§æ™‚é™ã€‚</p><p># åªæœ‰SCRIPT KILLå’ŒSHUTDOWN NOSAVEå¯ä»¥ç”¨ã€‚</p><p># ç¬¬ä¸€å€‹å¯ä»¥æ®ºæ²’æœ‰èª¿writeå‘½ä»¤çš„æ±è¥¿ã€‚è¦æ˜¯å·²ç¶“èª¿ç”¨äº†writeï¼Œåªèƒ½ç”¨ç¬¬äºŒå€‹å‘½ä»¤æ®ºã€‚</p><p>lua-time-limit 5000</p><p>################################ REDIS CLUSTER ###############################</p><p># é›†ç¾¤é–‹é—œï¼Œé»˜èªæ˜¯ä¸é–‹å•Ÿé›†ç¾¤æ¨¡å¼ã€‚</p><p># cluster-enabled yes</p><p># é›†ç¾¤é…ç½®æ–‡ä»¶çš„åç¨±ï¼Œæ¯å€‹ç¯€é»éƒ½æœ‰ä¸€å€‹é›†ç¾¤ç›¸é—œçš„é…ç½®æ–‡ä»¶ï¼ŒæŒä¹…åŒ–ä¿å­˜é›†ç¾¤çš„ä¿¡æ¯ã€‚</p><p># é€™å€‹æ–‡ä»¶ä¸¦ä¸éœ€è¦æ‰‹å‹•é…ç½®ï¼Œé€™å€‹é…ç½®æ–‡ä»¶æœ‰Redisç”Ÿæˆä¸¦æ›´æ–°ï¼Œæ¯å€‹Redisé›†ç¾¤ç¯€é»éœ€è¦ä¸€å€‹å–®ç¨çš„é…ç½®æ–‡ä»¶ï¼Œ</p><p># è«‹ç¢ºä¿èˆ‡å¯¦ä¾‹é‹è¡Œçš„ç³»çµ±ä¸­é…ç½®æ–‡ä»¶åç¨±ä¸è¡çª</p><p># cluster-config-file nodes-6379.conf</p><p># ç¯€é»äº’é€£è¶…æ™‚çš„é–¥å€¼ã€‚é›†ç¾¤ç¯€é»è¶…æ™‚æ¯«ç§’æ•¸</p><p># cluster-node-timeout 15000</p><p># åœ¨é€²è¡Œæ•…éšœè½‰ç§»çš„æ™‚å€™ï¼Œå…¨éƒ¨slaveéƒ½æœƒè«‹æ±‚ç”³è«‹ç‚ºmasterï¼Œä½†æ˜¯æœ‰äº›slaveå¯èƒ½èˆ‡masteræ–·é–‹é€£æ¥ä¸€æ®µæ™‚é–“äº†ï¼Œ</p><p># å°è‡´æ•¸æ“šéæ–¼é™³èˆŠï¼Œé€™æ¨£çš„slaveä¸æ‡‰è©²è¢«æå‡ç‚ºmasterã€‚è©²åƒæ•¸å°±æ˜¯ç”¨ä¾†åˆ¤æ–·slaveç¯€é»èˆ‡masteræ–·ç·šçš„æ™‚é–“æ˜¯å¦éé•·ã€‚åˆ¤æ–·æ–¹æ³•æ˜¯ï¼š</p><p># æ¯”è¼ƒslaveæ–·é–‹é€£æ¥çš„æ™‚é–“å’Œ(node-timeout * slave-validity-factor) + repl-ping-slave-period</p><p># å¦‚æœç¯€é»è¶…æ™‚æ™‚é–“ç‚ºä¸‰åç§’, ä¸¦ä¸”slave-validity-factorç‚º10,å‡è¨­é»˜èªçš„repl-ping-slave-periodæ˜¯10ç§’ï¼Œ</p><p># å³å¦‚æœè¶…é310ç§’slaveå°‡ä¸æœƒå˜—è©¦é€²è¡Œæ•…éšœè½‰ç§»</p><p># cluster-slave-validity-factor 10</p><p># masterçš„slaveæ•¸é‡å¤§æ–¼è©²å€¼ï¼Œslaveæ‰èƒ½é·ç§»åˆ°å…¶ä»–å­¤ç«‹masterä¸Šï¼Œ</p><p># å¦‚é€™å€‹åƒæ•¸è‹¥è¢«è¨­ç‚º2ï¼Œé‚£éº¼åªæœ‰ç•¶ä¸€å€‹ä¸»ç¯€é»æ“æœ‰2 å€‹å¯å·¥ä½œçš„å¾ç¯€é»æ™‚ï¼Œå®ƒçš„ä¸€å€‹å¾ç¯€é»æœƒå˜—è©¦é·ç§»ã€‚</p><p># cluster-migration-barrier 1</p><p># é»˜èªæƒ…æ³ä¸‹ï¼Œé›†ç¾¤å…¨éƒ¨çš„slotæœ‰ç¯€é»è² è²¬ï¼Œé›†ç¾¤ç‹€æ…‹æ‰ç‚ºokï¼Œæ‰èƒ½æä¾›æœå‹™ã€‚</p><p># è¨­ç½®ç‚ºnoï¼Œå¯ä»¥åœ¨slotæ²’æœ‰å…¨éƒ¨åˆ†é…çš„æ™‚å€™æä¾›æœå‹™ã€‚</p><p># ä¸å»ºè­°æ‰“é–‹è©²é…ç½®ï¼Œé€™æ¨£æœƒé€ æˆåˆ†å€çš„æ™‚å€™ï¼Œå°åˆ†å€çš„masterä¸€ç›´åœ¨æ¥å—å¯«è«‹æ±‚ï¼Œè€Œé€ æˆå¾ˆé•·æ™‚é–“æ•¸æ“šä¸ä¸€è‡´ã€‚</p><p># cluster-require-full-coverage yes</p><p>################################## SLOW LOG ###################################</p><p>###slog logæ˜¯ç”¨ä¾†è¨˜éŒ„redisé‹è¡Œä¸­åŸ·è¡Œæ¯”è¼ƒæ…¢çš„å‘½ä»¤è€—æ™‚ã€‚ç•¶å‘½ä»¤çš„åŸ·è¡Œè¶…éäº†æŒ‡å®šæ™‚é–“ï¼Œå°±è¨˜éŒ„åœ¨slow logä¸­ï¼Œslog logä¿å­˜åœ¨å…§å­˜ä¸­ï¼Œæ‰€ä»¥æ²’æœ‰IOæ“ä½œã€‚</p><p>#åŸ·è¡Œæ™‚é–“æ¯”slowlog-log-slower-thanå¤§çš„è«‹æ±‚è¨˜éŒ„åˆ°slowlogè£¡é¢ï¼Œå–®ä½æ˜¯å¾®ç§’ï¼Œæ‰€ä»¥1000000å°±æ˜¯1ç§’ã€‚æ³¨æ„ï¼Œè² æ•¸æ™‚é–“æœƒç¦ç”¨æ…¢æŸ¥è©¢æ—¥èªŒï¼Œè€Œ0å‰‡æœƒå¼·åˆ¶è¨˜éŒ„æ‰€æœ‰å‘½ä»¤ã€‚</p><p>slowlog-log-slower-than 10000</p><p>#æ…¢æŸ¥è©¢æ—¥èªŒé•·åº¦ã€‚ç•¶ä¸€å€‹æ–°çš„å‘½ä»¤è¢«å¯«é€²æ—¥èªŒçš„æ™‚å€™ï¼Œæœ€è€çš„é‚£å€‹è¨˜éŒ„æœƒè¢«åˆªæ‰ã€‚é€™å€‹é•·åº¦æ²’æœ‰é™åˆ¶ã€‚åªè¦æœ‰è¶³å¤ çš„å…§å­˜å°±è¡Œã€‚ä½ å¯ä»¥é€šé SLOWLOG RESET ä¾†é‡‹æ”¾å…§å­˜ã€‚</p><p>slowlog-max-len 128</p><p>################################ LATENCY MONITOR ##############################</p><p>#å»¶é²ç›£æ§åŠŸèƒ½æ˜¯ç”¨ä¾†ç›£æ§redisä¸­åŸ·è¡Œæ¯”è¼ƒç·©æ…¢çš„ä¸€äº›æ“ä½œï¼Œç”¨LATENCYæ‰“å°rediså¯¦ä¾‹åœ¨è·‘å‘½ä»¤æ™‚çš„è€—æ™‚åœ–è¡¨ã€‚åªè¨˜éŒ„å¤§æ–¼ç­‰æ–¼ä¸‹é‚Šè¨­ç½®çš„å€¼çš„æ“ä½œã€‚0çš„è©±ï¼Œå°±æ˜¯é—œé–‰ç›£è¦–ã€‚é»˜èªå»¶é²ç›£æ§åŠŸèƒ½æ˜¯é—œé–‰çš„ï¼Œå¦‚æœä½ éœ€è¦æ‰“é–‹ï¼Œä¹Ÿå¯ä»¥é€šéCONFIG SETå‘½ä»¤å‹•æ…‹è¨­ç½®ã€‚</p><p>latency-monitor-threshold 0</p><p>############################# EVENT NOTIFICATION ##############################</p><p>#éµç©ºé–“é€šçŸ¥ä½¿å¾—å®¢æˆ¶ç«¯å¯ä»¥é€šéè¨‚é–±é »é“æˆ–æ¨¡å¼ï¼Œä¾†æ¥æ”¶é‚£äº›ä»¥æŸç¨®æ–¹å¼æ”¹å‹•äº† Redis æ•¸æ“šé›†çš„äº‹ä»¶ã€‚å› ç‚ºé–‹å•Ÿéµç©ºé–“é€šçŸ¥åŠŸèƒ½éœ€è¦æ¶ˆè€—ä¸€äº› CPU ï¼Œæ‰€ä»¥åœ¨é»˜èªé…ç½®ä¸‹ï¼Œè©²åŠŸèƒ½è™•æ–¼é—œé–‰ç‹€æ…‹ã€‚</p><p>#notify-keyspace-events çš„åƒæ•¸å¯ä»¥æ˜¯ä»¥ä¸‹å­—ç¬¦çš„ä»»æ„çµ„åˆï¼Œå®ƒæŒ‡å®šäº†æœå‹™å™¨è©²ç™¼é€å“ªäº›é¡å‹çš„é€šçŸ¥ï¼š</p><p>##K éµç©ºé–“é€šçŸ¥ï¼Œæ‰€æœ‰é€šçŸ¥ä»¥ __keyspace@__ ç‚ºå‰ç¶´</p><p>##E éµäº‹ä»¶é€šçŸ¥ï¼Œæ‰€æœ‰é€šçŸ¥ä»¥ __keyevent@__ ç‚ºå‰ç¶´</p><p>##g DEL ã€ EXPIRE ã€ RENAME ç­‰é¡å‹ç„¡é—œçš„é€šç”¨å‘½ä»¤çš„é€šçŸ¥</p><p>##$ å­—ç¬¦ä¸²å‘½ä»¤çš„é€šçŸ¥</p><p>##l åˆ—è¡¨å‘½ä»¤çš„é€šçŸ¥</p><p>##s é›†åˆå‘½ä»¤çš„é€šçŸ¥</p><p>##h å“ˆå¸Œå‘½ä»¤çš„é€šçŸ¥</p><p>##z æœ‰åºé›†åˆå‘½ä»¤çš„é€šçŸ¥</p><p>##x éæœŸäº‹ä»¶ï¼šæ¯ç•¶æœ‰éæœŸéµè¢«åˆªé™¤æ™‚ç™¼é€</p><p>##e é©…é€(evict)äº‹ä»¶ï¼šæ¯ç•¶æœ‰éµå› ç‚º maxmemory æ”¿ç­–è€Œè¢«åˆªé™¤æ™‚ç™¼é€</p><p>##A åƒæ•¸ g$lshzxe çš„åˆ¥å</p><p>#è¼¸å…¥çš„åƒæ•¸ä¸­è‡³å°‘è¦æœ‰ä¸€å€‹ K æˆ–è€… Eï¼Œå¦å‰‡çš„è©±ï¼Œä¸ç®¡å…¶é¤˜çš„åƒæ•¸æ˜¯ä»€éº¼ï¼Œéƒ½ä¸æœƒæœ‰ä»»ä½• é€šçŸ¥è¢«åˆ†ç™¼ã€‚è©³ç´°ä½¿ç”¨å¯ä»¥åƒè€ƒhttp://redis.io/topics/notifications</p><p>notify-keyspace-events "KEA"</p><p>############################### ADVANCED CONFIG ###############################</p><p># æ•¸æ“šé‡å°æ–¼ç­‰æ–¼hash-max-ziplist-entriesçš„ç”¨ziplistï¼Œå¤§æ–¼hash-max-ziplist-entriesç”¨hash</p><p>hash-max-ziplist-entries 512</p><p># valueå¤§å°å°æ–¼ç­‰æ–¼hash-max-ziplist-valueçš„ç”¨ziplistï¼Œå¤§æ–¼hash-max-ziplist-valueç”¨hashã€‚</p><p>hash-max-ziplist-value 64</p><p># æ•¸æ“šé‡å°æ–¼ç­‰æ–¼list-max-ziplist-entriesç”¨ziplistï¼Œå¤§æ–¼list-max-ziplist-entriesç”¨listã€‚</p><p>list-max-ziplist-entries 512</p><p># valueå¤§å°å°æ–¼ç­‰æ–¼list-max-ziplist-valueçš„ç”¨ziplistï¼Œå¤§æ–¼list-max-ziplist-valueç”¨listã€‚</p><p>list-max-ziplist-value 64</p><p># æ•¸æ“šé‡å°æ–¼ç­‰æ–¼set-max-intset-entriesç”¨inisetï¼Œå¤§æ–¼set-max-intset-entriesç”¨setã€‚</p><p>set-max-intset-entries 512</p><p># æ•¸æ“šé‡å°æ–¼ç­‰æ–¼zset-max-ziplist-entriesç”¨ziplistï¼Œå¤§æ–¼zset-max-ziplist-entriesç”¨zsetã€‚</p><p>zset-max-ziplist-entries 128</p><p># valueå¤§å°å°æ–¼ç­‰æ–¼zset-max-ziplist-valueç”¨ziplistï¼Œå¤§æ–¼zset-max-ziplist-valueç”¨zsetã€‚</p><p>zset-max-ziplist-value 64</p><p># valueå¤§å°å°æ–¼ç­‰æ–¼hll-sparse-max-bytesä½¿ç”¨ç¨€ç–æ•¸æ“šçµæ§‹ï¼ˆsparseï¼‰ï¼Œ</p><p># å¤§æ–¼hll-sparse-max-bytesä½¿ç”¨ç¨ å¯†çš„æ•¸æ“šçµæ§‹ï¼ˆdenseï¼‰ã€‚</p><p># ä¸€å€‹æ¯”16000å¤§çš„valueæ˜¯å¹¾ä¹æ²’ç”¨çš„ï¼Œå»ºè­°çš„valueå¤§æ¦‚ç‚º3000ã€‚</p><p># å¦‚æœå°CPUè¦æ±‚ä¸é«˜ï¼Œå°ç©ºé–“è¦æ±‚è¼ƒé«˜çš„ï¼Œå»ºè­°è¨­ç½®åˆ°10000å·¦å³ã€‚</p><p>hll-sparse-max-bytes 3000</p><p># Rediså°‡åœ¨æ¯100æ¯«ç§’æ™‚ä½¿ç”¨1æ¯«ç§’çš„CPUæ™‚é–“ä¾†å°redisçš„hashè¡¨é€²è¡Œé‡æ–°hashï¼Œå¯ä»¥é™ä½å…§å­˜çš„ä½¿ç”¨ã€‚</p><p># ç•¶ä½ çš„ä½¿ç”¨å ´æ™¯ä¸­ï¼Œæœ‰éå¸¸åš´æ ¼çš„å¯¦æ™‚æ€§éœ€è¦ï¼Œä¸èƒ½å¤ æ¥å—Redisæ™‚ä¸æ™‚çš„å°è«‹æ±‚æœ‰2æ¯«ç§’çš„å»¶é²çš„è©±ï¼ŒæŠŠé€™é …é…ç½®ç‚ºnoã€‚</p><p># å¦‚æœæ²’æœ‰é€™éº¼åš´æ ¼çš„å¯¦æ™‚æ€§è¦æ±‚ï¼Œå¯ä»¥è¨­ç½®ç‚ºyesï¼Œä»¥ä¾¿èƒ½å¤ å„˜å¯èƒ½å¿«çš„é‡‹æ”¾å…§å­˜ã€‚</p><p>activerehashing yes</p><p># å°å®¢æˆ¶ç«¯è¼¸å‡ºç·©è¡é€²è¡Œé™åˆ¶å¯ä»¥å¼·è¿«é‚£äº›ä¸å¾æœå‹™å™¨è®€å–æ•¸æ“šçš„å®¢æˆ¶ç«¯æ–·é–‹é€£æ¥ï¼Œç”¨ä¾†å¼·åˆ¶é—œé–‰å‚³è¼¸ç·©æ…¢çš„å®¢æˆ¶ç«¯ã€‚</p><p># å°æ–¼normal clientï¼Œç¬¬ä¸€å€‹0è¡¨ç¤ºå–æ¶ˆhard limitï¼Œç¬¬äºŒå€‹0å’Œç¬¬ä¸‰å€‹0è¡¨ç¤ºå–æ¶ˆsoft limitï¼Œnormal clienté»˜èªå–æ¶ˆé™åˆ¶ï¼Œå› ç‚ºå¦‚æœæ²’æœ‰å°‹å•ï¼Œä»–å€‘æ˜¯ä¸æœƒæ¥æ”¶æ•¸æ“šçš„ã€‚</p><p>client-output-buffer-limit normal 0 0 0</p><p># å°æ–¼slave clientå’ŒMONITER clientï¼Œå¦‚æœclient-output-bufferä¸€æ—¦è¶…é256mbï¼Œåˆæˆ–è€…è¶…é64mbæŒçºŒ60ç§’ï¼Œé‚£éº¼æœå‹™å™¨å°±æœƒç«‹å³æ–·é–‹å®¢æˆ¶ç«¯é€£æ¥ã€‚</p><p>client-output-buffer-limit slave 256mb 64mb 60</p><p># å°æ–¼pubsub clientï¼Œå¦‚æœclient-output-bufferä¸€æ—¦è¶…é32mbï¼Œåˆæˆ–è€…è¶…é8mbæŒçºŒ60ç§’ï¼Œé‚£éº¼æœå‹™å™¨å°±æœƒç«‹å³æ–·é–‹å®¢æˆ¶ç«¯é€£æ¥ã€‚</p><p>client-output-buffer-limit pubsub 32mb 8mb 60</p><p># redisåŸ·è¡Œä»»å‹™çš„é »ç‡ç‚º1sé™¤ä»¥hzã€‚</p><p>hz 10</p><p># åœ¨aofé‡å¯«çš„æ™‚å€™ï¼Œå¦‚æœæ‰“é–‹äº†aof-rewrite-incremental-fsyncé–‹é—œï¼Œç³»çµ±æœƒæ¯32MBåŸ·è¡Œä¸€æ¬¡fsyncã€‚é€™å°æ–¼æŠŠæ–‡ä»¶å¯«å…¥ç£ç›¤æ˜¯æœ‰å¹«åŠ©çš„ï¼Œå¯ä»¥é¿å…éå¤§çš„å»¶é²å³°å€¼ã€‚</p><p>aof-rewrite-incremental-fsync yes</p><p>10åˆ†é˜å¾Œé€²éšåƒè€ƒï¼š</p><p><a class=pgc-link href="https://www.toutiao.com/i6607303031492968973/?group_id=6607303031492968973" target=_blank>RedisåŸºç¤é–‹ç™¼ç’°å¢ƒæ­å»º</a>ï¼›</p><p><a class=pgc-link href="https://www.toutiao.com/i6675301040037822983/?group_id=6675301040037822983" target=_blank>å¿«é€Ÿèªè­˜Redisæ•¸æ“šåº«</a>ï¼›</p><p><a class=pgc-link href="https://www.toutiao.com/i6673093598772199948/?group_id=6673093598772199948" target=_blank>åŸºæœ¬æå®šRedisæ•¸æ“šåº«</a>ï¼›</p><p><a class=pgc-link href="https://www.toutiao.com/i6691590455001350664/?group_id=6691590455001350664" target=_blank>Redisé«˜å¯ç”¨åŸç†åœ–è§£</a>ï¼›</p><p><a class=pgc-link href="https://www.toutiao.com/i6653672634510737934/?group_id=6653672634510737934" target=_blank>ç†è§£Redisä¸»å¾åŒæ­¥</a>ï¼›</p><p><a class=pgc-link href="https://www.toutiao.com/i6606571678430396936/?group_id=6606571678430396936" target=_blank>é«˜å¯ç”¨Redisè§£æ±ºæ–¹æ¡ˆ</a>ï¼›</p><p><a class=pgc-link href="https://www.toutiao.com/i6769566504800223748/?group_id=6769566504800223748" target=_blank>Rediså¾å…¥é–€åˆ°ç²¾é€š</a>ï¼›</p><p><a class=pgc-link href="https://www.toutiao.com/i6771709610605675012/?group_id=6771709610605675012" target=_blank>Redis å¸¸è¦‹è©¦é¡Œ</a>ï¼›ä»¥åŠ <a class=pgc-link href="https://www.toutiao.com/i6609636411266040324/?group_id=6609636411266040324" target=_blank>50é“åŠ©å­¸é¡Œ </a>ï¼›</p><p><a class=pgc-link href="https://www.toutiao.com/i6701593489529897480/?group_id=6701593489529897480" target=_blank>Memcacheèˆ‡RedisåŸç†å°æ¯”</a>ã€‚</p><p><a class=pgc-link href="https://www.toutiao.com/i6607997901614350851/?group_id=6607997901614350851" target=_blank>Redisèˆ‡Javaæ•´åˆæ¡ˆä¾‹å¯¦æˆ°</a>ã€‚</p><p>åŸºæœ¬ä¸Šä½ éœ€è¦çš„NoSQLæ•¸æ“šåº«Redisé€™è£¡åŸºæœ¬éƒ½æœ‰äº†ï¼ŒèŠ±é»æ™‚é–“æŒæ¡ä¸€ä¸‹å§ã€‚</p><p>æœ€å¾Œï¼Œä½ <strong>å°±æ”¶å€‹è—ã€é»é»è´Šã€è½‰ç™¼åˆ†äº«</strong>é †æ‰‹æå®šå§ ^_^</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>æ–‡æœ«</a></li><li><a>ç¶œåˆ</a></li><li><a>å…¥é–€</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/745227e1.html alt=ç¶œåˆä½ˆç·šèˆ‡å¼±é›»å·¥ç¨‹ï¼šè·³ç·šã€å°¾çº–ã€å…‰çº–æ¥å£ï¼Œä¸€æ–‡è¬›æ˜ç™½ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/70370b3c8fc348e2ab70ef1e28a16c77 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/745227e1.html title=ç¶œåˆä½ˆç·šèˆ‡å¼±é›»å·¥ç¨‹ï¼šè·³ç·šã€å°¾çº–ã€å…‰çº–æ¥å£ï¼Œä¸€æ–‡è¬›æ˜ç™½>ç¶œåˆä½ˆç·šèˆ‡å¼±é›»å·¥ç¨‹ï¼šè·³ç·šã€å°¾çº–ã€å…‰çº–æ¥å£ï¼Œä¸€æ–‡è¬›æ˜ç™½</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6fe27eab.html alt="å‰ç«¯ | HTMLå…¥é–€åŸºç¤çŸ¥è­˜-ç¶²é " class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/e7a0b61194f445b8b9e5ae330961d2ea style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6fe27eab.html title="å‰ç«¯ | HTMLå…¥é–€åŸºç¤çŸ¥è­˜-ç¶²é ">å‰ç«¯ | HTMLå…¥é–€åŸºç¤çŸ¥è­˜-ç¶²é </a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1d2be915.html alt=å¯§å¤ã€å…§è’™å¤è‡ªæ²»å€é»ƒæ²³çš„ç¶œåˆæ²»ç†æªæ–½ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/217d033a478c468f928df0367a082186 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1d2be915.html title=å¯§å¤ã€å…§è’™å¤è‡ªæ²»å€é»ƒæ²³çš„ç¶œåˆæ²»ç†æªæ–½>å¯§å¤ã€å…§è’™å¤è‡ªæ²»å€é»ƒæ²³çš„ç¶œåˆæ²»ç†æªæ–½</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/19664ba8.html alt=EXCELå…¥é–€åŸºç¤ï¼šå°è¡Œå’Œåˆ—é¸å®šæ•¸æ“šæ±‚å’Œ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1f03f82096d240dd92410709f3e19eb9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/19664ba8.html title=EXCELå…¥é–€åŸºç¤ï¼šå°è¡Œå’Œåˆ—é¸å®šæ•¸æ“šæ±‚å’Œ>EXCELå…¥é–€åŸºç¤ï¼šå°è¡Œå’Œåˆ—é¸å®šæ•¸æ“šæ±‚å’Œ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5abb53a8.html alt=å·¥ç¨‹é€ åƒ¹å¾å…¥é–€åˆ°ç²¾é€šï¼šé€ åƒ¹å“¡å…¨èƒ½åœ–è§£+å·¥ç¨‹ç®—é‡è¡¨ï¼Œé™æ™‚åˆ†äº«ï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/49834ccb43ed42cb9a54c9827c3ab134 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5abb53a8.html title=å·¥ç¨‹é€ åƒ¹å¾å…¥é–€åˆ°ç²¾é€šï¼šé€ åƒ¹å“¡å…¨èƒ½åœ–è§£+å·¥ç¨‹ç®—é‡è¡¨ï¼Œé™æ™‚åˆ†äº«ï¼>å·¥ç¨‹é€ åƒ¹å¾å…¥é–€åˆ°ç²¾é€šï¼šé€ åƒ¹å“¡å…¨èƒ½åœ–è§£+å·¥ç¨‹ç®—é‡è¡¨ï¼Œé™æ™‚åˆ†äº«ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1a5f8d5f.html alt=å·¥ç¨‹é€ åƒ¹ï¼šå…¥é–€çŸ¥è­˜å…¨å¥—è¬›ç¾©ï¼Œ30ç« 600é ï¼Œç²¾é€šé€ åƒ¹é¦–é¸ä¹‹ä½œ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9e1b335c343a455f8777dd3144fc1c35 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1a5f8d5f.html title=å·¥ç¨‹é€ åƒ¹ï¼šå…¥é–€çŸ¥è­˜å…¨å¥—è¬›ç¾©ï¼Œ30ç« 600é ï¼Œç²¾é€šé€ åƒ¹é¦–é¸ä¹‹ä½œ>å·¥ç¨‹é€ åƒ¹ï¼šå…¥é–€çŸ¥è­˜å…¨å¥—è¬›ç¾©ï¼Œ30ç« 600é ï¼Œç²¾é€šé€ åƒ¹é¦–é¸ä¹‹ä½œ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2d4007c7.html alt=â€œé»‘å®¢â€å…¥é–€å­¸ç¿’ä¹‹â€œWindowsçµ„ç­–ç•¥â€ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ea21244d5f5c420ebef29650f3fafd1c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2d4007c7.html title=â€œé»‘å®¢â€å…¥é–€å­¸ç¿’ä¹‹â€œWindowsçµ„ç­–ç•¥â€>â€œé»‘å®¢â€å…¥é–€å­¸ç¿’ä¹‹â€œWindowsçµ„ç­–ç•¥â€</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/162efaea.html alt=è©³è§£ç¶œåˆä½ˆç·šä¸­å±è”½ç·šçºœæœ‰ä½•ä½œç”¨ï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1535790948669d855fe1265 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/162efaea.html title=è©³è§£ç¶œåˆä½ˆç·šä¸­å±è”½ç·šçºœæœ‰ä½•ä½œç”¨ï¼>è©³è§£ç¶œåˆä½ˆç·šä¸­å±è”½ç·šçºœæœ‰ä½•ä½œç”¨ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9d08c7e6.html alt=PHPå…¥é–€æ•™ç¨‹ï¼Œ5å¤©86ç¯€èª²åŠ©åŠ›å°ç™½è®Šå¤§ç¥ï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/4366000004d4c98fd587 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9d08c7e6.html title=PHPå…¥é–€æ•™ç¨‹ï¼Œ5å¤©86ç¯€èª²åŠ©åŠ›å°ç™½è®Šå¤§ç¥ï¼>PHPå…¥é–€æ•™ç¨‹ï¼Œ5å¤©86ç¯€èª²åŠ©åŠ›å°ç™½è®Šå¤§ç¥ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/923fd40e.html alt=Thinkphp6å¿«é€Ÿå…¥é–€ä¸€ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/c4331ddc0ffb4c94a4aa80be95178354 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/923fd40e.html title=Thinkphp6å¿«é€Ÿå…¥é–€ä¸€>Thinkphp6å¿«é€Ÿå…¥é–€ä¸€</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3d2ce3d6.html alt="phpæ–°æ‰‹å…¥é–€æ•™ç¨‹ï¼Œ æœ€å…¨æœ€å®Œæ•´çš„æ•™å­¸è¦–é »èª²ç¨‹" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/666a38216ab04790a716bb1451c7fe44 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3d2ce3d6.html title="phpæ–°æ‰‹å…¥é–€æ•™ç¨‹ï¼Œ æœ€å…¨æœ€å®Œæ•´çš„æ•™å­¸è¦–é »èª²ç¨‹">phpæ–°æ‰‹å…¥é–€æ•™ç¨‹ï¼Œ æœ€å…¨æœ€å®Œæ•´çš„æ•™å­¸è¦–é »èª²ç¨‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/07454552.html alt=ã€Œç´ æå…¥é–€ã€åŸºç¤ä¸ç´®å¯¦ï¼Œå¾æ’ç·šç·´èµ· class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/15252166717297d7af296ee style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/07454552.html title=ã€Œç´ æå…¥é–€ã€åŸºç¤ä¸ç´®å¯¦ï¼Œå¾æ’ç·šç·´èµ·>ã€Œç´ æå…¥é–€ã€åŸºç¤ä¸ç´®å¯¦ï¼Œå¾æ’ç·šç·´èµ·</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/07c706e2.html alt=ã€Œç´ æå…¥é–€ã€ç´ ææ’ç·šçš„ç¹ªç•«æŠ€æ³• class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1530098801296ab58189790 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/07c706e2.html title=ã€Œç´ æå…¥é–€ã€ç´ ææ’ç·šçš„ç¹ªç•«æŠ€æ³•>ã€Œç´ æå…¥é–€ã€ç´ ææ’ç·šçš„ç¹ªç•«æŠ€æ³•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a993b442.html alt=ç´ æå…¥é–€ä¸¨ä½ èªªç·šæ¢æˆ–è€…æ’ç·šï¼Œå®¹æ˜“å—ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1536648317995f32cedaa40 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a993b442.html title=ç´ æå…¥é–€ä¸¨ä½ èªªç·šæ¢æˆ–è€…æ’ç·šï¼Œå®¹æ˜“å—ï¼Ÿ>ç´ æå…¥é–€ä¸¨ä½ èªªç·šæ¢æˆ–è€…æ’ç·šï¼Œå®¹æ˜“å—ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d0e2c5d2.html alt=é›¶åŸºç¤å…¥é–€è¦çŸ¥é“çš„ç´ æçŸ¥è­˜ç¸½çµ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/c2c16563-8821-4294-a8c6-9d76e62a2440 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d0e2c5d2.html title=é›¶åŸºç¤å…¥é–€è¦çŸ¥é“çš„ç´ æçŸ¥è­˜ç¸½çµ>é›¶åŸºç¤å…¥é–€è¦çŸ¥é“çš„ç´ æçŸ¥è­˜ç¸½çµ</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>