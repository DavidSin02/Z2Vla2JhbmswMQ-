<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線 | 极客快訊</title><meta property="og:title" content="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/30802044436747b99233181a03ed93c8"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/915196f6.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/915196f6.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/915196f6.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/915196f6.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/915196f6.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/915196f6.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/915196f6.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/915196f6.html><meta property="article:published_time" content="2020-10-29T21:11:50+08:00"><meta property="article:modified_time" content="2020-10-29T21:11:50+08:00"><meta name=Keywords content><meta name=description content="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/915196f6.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p class=ql-align-center><br></p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/30802044436747b99233181a03ed93c8><p class=pgc-img-caption></p></div><blockquote><p>天線一直是業餘無線電活動中最熱門的話題，也是無線電愛好者最常自制的器材之一。天線的好壞直接影響無線電通訊系統的收發效果和通訊距離。業餘無線電臺具有發射功率小、收發共用同一天線和天線架設條件簡陋等特點，更加要求合理地選用適當的天線以達到更好的通訊效果。</p><p>天線總輸入功率的比值，稱該天線的最大增益係數。它是比天線方向性係數更全面的反映天線對總的射頻功率的有效利用程度。並用分貝數表示。可以用數學推證，天線最大增益係數等於天線方向性係數和天線效率的乘積。</p><p>對於任何一類天線，下一步是決定極化方向。通常是水平極化和垂直極化的某一種。水平極化意味著天線輻射單元平行於地面被安裝，而垂直極化的天線振子垂直於地面。</p><p><strong>構建磁環天線:</strong>天線具有多種形狀和尺寸，具有多種特性，這樣可以與各種應用場合相匹配。火腿們可能熟悉跟蹤天線，八木和偶極子，但是有更多的負載。 本文作者Eric正在走一條適合自己的路，他打造的這款自調諧磁環天線值得一看。</p></blockquote><h1 class=ql-align-justify><strong>Eric打造的一款業餘無線電環形天線</strong></h1><p class=ql-align-justify>我一直在試驗我家周圍用於業餘無線電臺的各種天線裝置。由於我們處於太陽黑子傳播週期的底部，因此現在傳播極差，因此如果您想要聽到對方的通聯，擁有一款有效且高效的天線是很重要的。</p><p class=ql-align-justify>我遇到的一種天線似乎既有趣又獨特，這就是磁環天線。這類天線的構造通常是由導電材料環構成，環的兩端封閉。在兩端之間的空間中，放置調諧可變電容器以在特定頻率下諧振。</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1b5ec3c2e7c6484b85b2408fbf1811ec><p class=pgc-img-caption></p></div><p class=ql-align-justify>磁環通常是極高Q設備，可在非常窄的範圍內進行調諧。這種狹窄的工作範圍意味著天線自然會提供一定程度的選擇性，但它需要經常重新調諧。將頻率改變甚至2-3kHz可以使您脫離天線的工作頻段。</p><p class=ql-align-justify>我希望環形天線在20米處工作良好，而且為了方便，我想用銅管（0.75“外徑，10英尺長）組裝它。我還希望能夠工作到100W。</p><h1 class=ql-align-justify><strong>把這些參數進入計算器，得到以下結果：</strong></h1><blockquote><p>天線效率：60％（低於100％時為-2.2 dB）天線帶寬：18.9 kHz調諧電容：62 pF電容器電壓：3,687伏特RMS諧振循環電流：20.1A抗輻射：0.074歐姆耐損耗：0.050歐姆電感：2.08 微亨感應電抗：183歐姆品質因數（Q）：742分佈式容量：8 pF</p></blockquote><p class=ql-align-justify>看電容電壓接近4kV？使用<span>空芯</span>電容器時，高電壓可能會引起電容器鰭片的電弧放電。有一些方法可以避免這種情況（增加間距，浸入油中），但常見的方法是使用真空可變電容器。</p><p class=ql-align-justify><strong>我從ebay得到了以下型號：Comet CVBA-500BC：</strong></p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/846a88cee0004d0d9fe42127c70663b3><p class=pgc-img-caption></p></div><p class=ql-align-justify>該電容的調諧範圍為5-500pf，最大電壓為5kV，峰值工作電流為57A。</p><p class=ql-align-justify>我設計並3D打印了一個用於可變電容器的塑料支架。我還打印了一個齒輪式步進電機，銅管的安裝點和塑料件，將環安裝到木銷上。</p><p class=ql-align-justify><strong>3D打印件看起來像這樣：</strong></p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f9d53016cf574f97b4c0428894c1e7a3><p class=pgc-img-caption></p></div><p class=ql-align-justify>組裝好的天線看起來應該是Fusion360的渲染：</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b351d498bdc14c66bd0a51f7a9c9aef6><p class=pgc-img-caption></p></div><p class=ql-align-justify>如果您想對設計進行任何更改或自行打印，我將在此處分享Fusion 360項目：https://a360.co/2TtVUop。</p><p class=ql-align-justify>許多人使用銅管和45度角連接器組裝環形天線以形成八角形。這足夠接近一個圓圈，但會給環路帶來一些電阻。我想將一塊銅彎成一個連續的環，以減少環路的電阻。</p><p class=ql-align-justify>我從Home Depot購買10英尺長的銅管並試圖讓當地一家消聲器商店看看是否能把它彎曲成一個環，但談過的兩家商店都表示他們不能或不願意彎曲銅環。</p><p class=ql-align-justify>迫不得已，我買了一個像這樣的導管彎管機（電臺小叔表示：土豪啊，一言不合就買設備啊！）。通過沿著環的長度標記相等的空間並且一次彎曲一點，我能夠將銅彎曲成環。不幸的是，當我彎曲時，銅變得非常脆並且傾向於彎曲。 （它看起來更像是一個20邊的多邊形而不是一個圓形）。</p><p class=ql-align-justify>眾所周知，銅會變硬。這意味著當銅彎曲並形成不同的形狀時，銅變得更脆並且更不具有延展性。退火是將銅加熱到內部應力消除並且銅準備好再次形成的過程。退火銅很簡單，我買了一個噴燈，加熱了整個銅的長度，直到它發出紅光。對於10英尺長的管道，我能夠在幾分鐘內加熱整個管道長度。</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/04923c88fac4437eac6778bc74af1049><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5188427167ec46fdbe816abe296151df><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/95bcb66505674ebb9fd64103849822e9><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8c979797a1204d15bed33cb3f30c4c64><p class=pgc-img-caption></p></div><p class=ql-align-justify>在退火過程之後，銅會改變顏色並變得更容易彎曲。</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6c4ba06747fe4274aaddba048be9776a><p class=pgc-img-caption></p></div><p class=ql-align-justify>頂部圖像退火，底部圖像直接來自Home Depot。</p><p class=ql-align-justify>退火後，我可以輕鬆地用手將銅摺疊成一個環。令人矚目的是它與眾不同之處。</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0ae022f3d2e24b729c28ceff6b09d60f><p class=pgc-img-caption></p></div><p class=ql-align-justify>稍微小心一點，我想我可以得到一個近乎完美的天線圈。</p><p class=ql-align-justify>如果您正在製作自己的環形天線，我建議在彎曲之前使用噴燈來加熱銅管。在彎曲過程中，銅將更容易彎曲並且彎曲度更小。</p><p class=ql-align-justify>下一步，我想製作（可能是3D打印）一系列三個滾輪，這將讓我將銅管彎曲到特定的半徑。</p><p class=ql-align-justify>我完成了環形天線的組裝並首次對它進行了一些測試。到目前為止，結果看起來很棒。</p><p class=ql-align-justify>接下來繼續組裝，首先，我將塑料夾塊擰到銅環的兩端：</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8bd1274ee865441484b6b9995fd906a3><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f2c6f9e18a654d25827ec1970951e972><p class=pgc-img-caption></p></div><p class=ql-align-justify>我在汽車商店買了6個awg銅卷。我將約10個awg線的末端折成兩半，然後將夾子敲到線上以形成牢固的連接。在銅管上鑽一個足以容納M5螺釘的孔，夾子牢固地連接在一起。</p><p class=ql-align-justify>10awg銅線夾在電容器的金屬板和塑料蓋件之間。三個m3x12螺釘用於牢固地夾緊電線並保持牢固的連接。</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c97adc9bddc44d5fa55a3cad300c6f88><p class=pgc-img-caption></p></div><p class=ql-align-justify>天線設計安裝在一個1.25英寸的木釘上。我從港口貨運中購買了兩個48英寸的木釘，用3D打印塑料對接接頭來連接兩者。當天線在外面時，我仍然需要決定用作基座的東西。</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2dced5e00b9c40e0970a291be7be8942><p class=pgc-img-caption></p></div><p class=ql-align-justify>驅動環由大約2英尺的10awg電線組成，絕緣完好無損。</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/df88c148e13f4b5abb290aaddc163cbe><p class=pgc-img-caption></p></div><p class=ql-align-justify>在沒有調整電容的情況下（它介於調諧範圍的兩個極端之間），我連接了FA-VA5天線分析儀進行了一些SWR掃描測量。第一次掃描看起來很令人鼓舞，在SWR降至1.5以下的特定頻率下，顯然存在強烈的窄諧振。</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0754d4f031fc4a05aa684603006ca384><p class=pgc-img-caption></p></div><p class=ql-align-justify>在對電容器進行了一些調整之後，我能夠將天線“調諧”到14MHz。調整非常敏感！電容器的四分之一圈可對調諧頻率產生顯著的影響。我認為步進電機的齒輪減速可能最終會有所幫助。我真的很高興看到SWR下降到1.0 ，希望這意味著我會從天線上獲得一些好的結果。</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d6f09568c42549b090430a748198c75e><p class=pgc-img-caption></p></div><p class=ql-align-justify><br></p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ec4ff8e67d734516855e0be7f91aef95><p class=pgc-img-caption></p></div><p class=ql-align-justify><strong>接下來的步驟是嘗試測試天線，然後開始使用自動調諧器電路。</strong></p><p class=ql-align-justify>我開始研究磁環天線的自動調諧器。我將按以下順序實現各種功能塊：</p><blockquote><p>1.電機控制和歸位2. SWR測量3.尋求存儲歷史和快速調整的算法</p></blockquote><h1 class=ql-align-justify><strong>組件選擇：</strong></h1><p class=ql-align-justify>我計劃在這個項目中使用STM32F401 mcu。我之所以選擇這個，是因為我知道它具有足夠的處理能力，我已經有一些NUCLEO評估板，我熟悉工具鏈。</p><p class=ql-align-justify>我正在為該項目使用“SilentStepStick”步進電機驅動器。這與基於Allegro A4XXX芯片的Pololu步進驅動器類似（並且可以引腳分隔）。</p><p class=ql-align-justify>SilentStepStick基於TMC2130芯片，並且通過串行接口暴露了一些額外的功能，我認為這些功能非常有用。</p><p class=ql-align-justify>特別是，存在稱為“失速檢測”的特徵，其檢測電動機上的負載何時突然改變。這可用於在不使用機械限位器的情況下“回家”系統（這是在Prusa i3 MK3打印機上完成的）。我打算在啟動時使用失速檢測“歸位”可變電容。可變電容器是一個多圈電容器，在旋轉的一端有一個硬停止。沒有Stepstick就很難回家，因為很難確定多圈調整的哪一圈是最後一圈。通過失速檢測功能，我可以向一個方向轉動電機，直到調節螺絲達到最低點並檢測失速發生的點。這一點將成為允許在動力循環之間比較位置數據的原始位置。我需要對此進行描述才能看出它是多麼可重複，但根據我對Prusa i3打印機的經驗，我認為它將足夠一致。</p><p class=ql-align-justify>SilentStepSticks可在Digikey定期購買和庫存。順便提一下，它們為您的3D打印機做了很好的升級，正如其名稱所暗示的那樣，它們使步進電機更加安靜。</p><h1 class=ql-align-justify><strong>初始電機驅動器原型：</strong></h1><p class=ql-align-justify>作為第一步，我想將步進驅動器連接到NUCLEO-F401RE評估板並獲得一些基本的電機操作。我正在使用STM32CubeMx為項目創建初始配置。該軟件為各種NUCLEO板提供了一些預先配置的選項，因此可以非常快速地啟動項目。</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8006a186e65e4c748093f887e5bbc8ba><p class=pgc-img-caption></p></div><p class=ql-align-justify><strong>我在STM32CubeMX中使用以下配置選項：</strong></p><p class=ql-align-justify>SPI1配置為全雙工主機，時鐘極性高。使用引腳PA5（SCK），PA6（MISO），PA7（MOSI）我必須移除PA5的GPIO輸出功能，因為它似乎連接到電路板上的綠色LED。</p><p class=ql-align-justify>PB9設置為GPIO開漏輸出，啟用上拉。我正在命名這個“MOTOR_CS”。我將它用作軟件控制的CS引腳。</p><p class=ql-align-justify>啟用FreeRTOS</p><p class=ql-align-justify>將PA4設置為GPIO輸出並將其命名為“MOTOR_EN”</p><p class=ql-align-justify>將PA8,9設置為GPIO輸出，並分別將它們命名為“MOTOR_STEP”和“MOTOR_DIR”。</p><p class=ql-align-justify>將PA0和PA1設置為模擬輸入（其中一個或兩個將用於測量前往天線的前向和反射功率）。</p><p class=ql-align-justify><strong>這就是CubeMx中GPIO分配的樣子：</strong></p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c6383dfb8b0445a8a2bd439a9d58611a><p class=pgc-img-caption></p></div><p class=ql-align-justify>我選擇Acronis TrueStudio作為目標，並使用STM32CubeMX生成源代碼。像往常一樣，我必須從Truestudio IDE中刪除“Drivers”和“Middlewares”文件夾，讓它們自動重新填充（在此之前我會收到一堆帶來各種庫的錯誤）。之後，項目構建並且STLink調試器開箱即用。</p><p class=ql-align-justify>我需要能夠一次延遲處理器幾uS來控制步進電機的定時脈衝。我正在使用本文中的一些代碼來執行此操作：https：//www.carminenoviello.com/2015/09/04/precisely-measure-microseconds-stm32/</p><p class=ql-align-justify>在構建之後，我設置了motor_dir和motor_step引腳，以便在循環中來回驅動電機1000步。我在麵包板上連接了SilentStepStick並連接了步進電機。我正在使用我的工作臺13.8v電源供電。 SilentStepStick上有一個焊接跳線，當連接時，它會禁用SPI接口並允許SPI引腳用作配置引腳。我現在正在使用它，以便在不編寫SPI代碼的情況下測試電機接線和功能。引腳可以檢測三種狀態：開路，GND和VIO：</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/0beb7a56ca0f4ef3824bb4c589ef6ead><p class=pgc-img-caption></p></div><p class=ql-align-justify>我將CFG1設置為GND，將CFG2設置為Open。這應該提供16 uSteps插值和“spreadCycle”。</p><p class=ql-align-justify>我打開電源並啟動程序。起初，電機開始按預期來回移動。但是，我很快就遇到了熱問題。電動機每隔一秒左右停止一次。 50％的工作週期。我嘗試使用電位器調節驅動電流，並將VREF電平從1.1V降低到500mV（驅動電流為0.71 * VREF），但問題仍然存在。在此之後不久，我幾乎失去了SilentStepStick的所有功能。我能看到的唯一一項活動是在安裝或拆下“En”銷後進行一些短暫的動作，然後是一些不穩定，然後沒有移動。看起來驅動器暫時運行然後遇到某種故障狀態並禁用輸出。</p><p class=ql-align-justify>在查看數據表後，我發現了這個問題。當SPI模式禁用時，步進驅動器上的“CS”引腳變為“CFG3”引腳。以下是CFG3的選項：</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/8ac53bad584f4f91876a249ff3d38579><p class=pgc-img-caption></p></div><p class=ql-align-justify>我將CFG3連接到地，忽略電位計並根據內部參考設置電流。拆下CS引腳上的導線後，步進驅動器使用與電位器電壓成比例的電流，電機運行平穩連續。</p><p class=ql-align-justify>最後，通過將SPI焊接跳線連接到地，然後使用下面的接線連接，我能夠毫無問題地使用SilentStepStick。大多數引腳可以保持打開狀態。這將配置步進驅動器以進行16uStep操作（內插最多256個），啟用“spreadCycle”操作，並通過電位計進行電流調整。如果你想在麵包板上使用一個愚蠢的，安靜的步進驅動器，這將很有效：</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/7c191180a2504ab8a4a1c9beeebecb96><p class=pgc-img-caption></p></div><p class=ql-align-justify>現在我已經確認硬件已正確連接且電機平穩旋轉，下一步將啟用SPI進行配置和失速檢測。</p><p class=ql-align-justify>現在我已經確認步進驅動器工作正常，我想建立SPI通信以進行配置和狀態回讀。 這對於啟用我用於歸位的失速檢測功能尤為重要。</p><p class=ql-align-justify>首先，我編寫了一個函數，使用SPI在TMC2130上讀寫寄存器。 這是一個讀/寫功能 - 唯一的區別是在'寫'操作中，寄存器的地址與0x80進行“或”運算。</p><p class=ql-align-justify>tmc_readwrite_register（）：</p><p class=ql-align-justify>讀命令連續發送兩次。 這是因為TMC2130通過一次SPI事務延遲響應。 數據表的這一部分解釋了它：</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fe07dd0b915740b7924c6cf6c8d4e102><p class=pgc-img-caption></p></div><p class=ql-align-justify>可以通過創建連接來連接一行中的多個命令來優化一些讀取操作。 它也可以利用來自同一寄存器的多個後續讀取。 我不認為其中任何一個都是必要的，現在我接受我偶爾發送冗餘命令。</p><p class=ql-align-justify>在主循環中，在初始化SPI和GPIO塊之後，我將以下代碼放入重複循環中：</p><p class=ql-align-justify>data = tmc_readwrite_register（TMC_REG_IOIN，0,0）;</p><p class=ql-align-justify>TMC_REG_IOIN定義為IOIN寄存器的8位地址。 該寄存器包含TMC2130上所有IO引腳的邏輯電平。 它還有一些總是讀回'1'的位，這對測試SPI接口很有用。</p><p class=ql-align-justify>我附上了我的Saleae邏輯分析儀，看起來通信工作正常。</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/cde716a00bc04c08bb17846fb2f01288><p class=pgc-img-caption></p></div><p class=ql-align-justify>這是兩筆交易中的第二筆。</p><p class=ql-align-justify>如果我將命令更改為：</p><p class=ql-align-justify>data = tmc_readwrite_register（TMC_REG_IOIN，0xAAAAAAAA，1）;</p><p class=ql-align-justify>MOSI信號相應變化：</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8458b78bbc2d4e38a577f9a145c07e7a><p class=pgc-img-caption></p></div><p class=ql-align-justify>雖然MOSI看起來不錯，但MISO線看起來不正確。我讀到的值與IOIN寄存器的數據表描述不一致。 將TMC2130數據表中的時序圖與邏輯分析儀波形進行比較，可以看出使用了錯誤的時鐘邊沿。 我更改了更改spi.c中的行以選擇第二個時鐘邊緣：</p><p class=ql-align-justify>hspi1.Init.CLKPhase = SPI_PHASE_2EDGE;</p><p class=ql-align-justify>在此之後，SPI接口在兩個方向上都運行良好。</p><p class=ql-align-justify>以下是將“DIR”引腳設置為3v3讀取IOIN寄存器的示例：</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4337993521ac4fa3af720f72f869ec08><p class=pgc-img-caption></p></div><p class=ql-align-justify>以下是“DIR”引腳連接到GND的相同走線：</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/4a22b92ff01542619dc69f3e8b7823c4><p class=pgc-img-caption></p></div><p class=ql-align-justify>正如預期的那樣，位1從1切換到零，其餘輸入數據保持不變：</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a57c34c1ad3b408ea89b4fc1a7eca191><p class=pgc-img-caption></p></div><p class=ql-align-justify>另請注意，位24-31為0x11，如數據表中所示。</p><p class=ql-align-justify>我在檢查調試器中的值時也看到了正確的數據返回：</p><div class=pgc-img><img alt="有趣、獨特 | 打造一款業餘無線電愛好者專屬的自調諧磁環天線" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/24a23ca390c946d998f71a16f00c3227><p class=pgc-img-caption></p></div><p class=ql-align-justify>現在我需要為TMC2130步進器找到正確的初始化值並編寫初始化函數。</p><p class=ql-align-justify>更多內容請訪問http://www.esorensen.com</p><h1 class=ql-align-justify><strong>天線作品點評：</strong></h1><p class=ql-align-justify>Eric的構建設計在20米波段上以100W工作，這會影響天線的規格。在磁環設計中特別關鍵的是調諧電容器兩端的電壓；在這個設計中，它出現在大約4千伏。這需要仔細選擇能夠處理這些電壓的部件。在這種情況下，使用真空可變電容器，額定峰值電流為57安培，峰值電壓為5千伏。</p><p class=ql-align-justify>磁環設計導致天線調諧到非常窄的頻率範圍，提供良好的選擇性。但是，為了保持帶寬，它還需要經常重新調整。 Eric正在實施一個自整定系統來解決這個問題，控制器使用電機驅動調諧電容器，以將天線保持在適當的工作點。</p><p class=ql-align-justify>如果您不熟悉磁環構建，Eric的項目可以很好地介紹這種設計中固有的電氣和機械因素。我們已經看到了更加模糊的設計，就像這些天線應用了先進的噴塗技術一樣。</p><p>source：</p><p>http://www.esorensen.com</p><p>https://hackaday.com</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>獨特</a></li><li><a>業餘無線</a></li><li><a>電愛好者</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/f4c40cdd.html alt=疫情下的業餘無線電愛好者社交：你和我只隔一個144MHz波長的距離 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/4f0027cff6164c189fb8cf7289b27aa8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f4c40cdd.html title=疫情下的業餘無線電愛好者社交：你和我只隔一個144MHz波長的距離>疫情下的業餘無線電愛好者社交：你和我只隔一個144MHz波長的距離</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b7ef563.html alt=全球業餘無線電愛好者戶外通聯天線集錦 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/7470273db262440a969c13e324342f38 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b7ef563.html title=全球業餘無線電愛好者戶外通聯天線集錦>全球業餘無線電愛好者戶外通聯天線集錦</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9976c577.html alt=深海採礦可能導致獨特的生態系統將“永遠消失” class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/cdc214c96cf845f7be1311779b404252 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9976c577.html title=深海採礦可能導致獨特的生態系統將“永遠消失”>深海採礦可能導致獨特的生態系統將“永遠消失”</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/66dc83ed.html alt="新 SSTV 業餘無線電設備已運抵國際空間站" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/fce6efb3ec4e4d29a9a041e1da9bea15 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/66dc83ed.html title="新 SSTV 業餘無線電設備已運抵國際空間站">新 SSTV 業餘無線電設備已運抵國際空間站</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d8c7d0c9.html alt=德國業餘無線電愛好者因在羅德島持有無線電設備而以間諜罪被捕 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a254c7617b1049b0bdb2de1028e49947 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d8c7d0c9.html title=德國業餘無線電愛好者因在羅德島持有無線電設備而以間諜罪被捕>德國業餘無線電愛好者因在羅德島持有無線電設備而以間諜罪被捕</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/512b8fdc.html alt=日本各大知名電臺製造企業已有6個型號的業餘無線電設備“停產” class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/4bcd93af2bce4560a6cae828ad1e740f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/512b8fdc.html title=日本各大知名電臺製造企業已有6個型號的業餘無線電設備“停產”>日本各大知名電臺製造企業已有6個型號的業餘無線電設備“停產”</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8328a587.html alt=業餘無線電入門如何選購設備，你需要多大的功率 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a6de464db02d492ab7b3263dcf047d0b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8328a587.html title=業餘無線電入門如何選購設備，你需要多大的功率>業餘無線電入門如何選購設備，你需要多大的功率</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a9e325e6.html alt=簡單低成本的FT8業餘無線電收發器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/82856473def34fc8adb3ff6a6a9f6039 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a9e325e6.html title=簡單低成本的FT8業餘無線電收發器>簡單低成本的FT8業餘無線電收發器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3786d7dd.html alt=帶鏡面的廚房島臺，獨特的風格豐富小廚房的視覺空間 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4ad18a8ce68246e4be787352cbdade1a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3786d7dd.html title=帶鏡面的廚房島臺，獨特的風格豐富小廚房的視覺空間>帶鏡面的廚房島臺，獨特的風格豐富小廚房的視覺空間</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/ea9f759b.html alt=公認4種貴州的獨特美食，涼拌生血上榜，圖4連兩廣人都不敢吃 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/27bbddc9fb2b444d9f438ea9bf3a356c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/ea9f759b.html title=公認4種貴州的獨特美食，涼拌生血上榜，圖4連兩廣人都不敢吃>公認4種貴州的獨特美食，涼拌生血上榜，圖4連兩廣人都不敢吃</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/09543b5a.html alt=業餘無線電入門-9（業餘電臺玩什麼？） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8d224ac0bcb941ddaedefce5191f688c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/09543b5a.html title=業餘無線電入門-9（業餘電臺玩什麼？）>業餘無線電入門-9（業餘電臺玩什麼？）</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/8705f8d0.html alt=獨特的代謝生態位使菌株能夠植入腸道菌群 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RkW91tVAqsetWk style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/8705f8d0.html title=獨特的代謝生態位使菌株能夠植入腸道菌群>獨特的代謝生態位使菌株能夠植入腸道菌群</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/c082d29f.html alt=盤點獨特的東南亞式庭院植物的配置 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f01e304b2cf347cc9a436c5fa5e576a4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/c082d29f.html title=盤點獨特的東南亞式庭院植物的配置>盤點獨特的東南亞式庭院植物的配置</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/b646feef.html alt=重溫《鋼琴家》：獨特敘事結構下的人物形象 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/fcbc76d7-08f6-4cae-8c7d-26fcd8c87bc4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/b646feef.html title=重溫《鋼琴家》：獨特敘事結構下的人物形象>重溫《鋼琴家》：獨特敘事結構下的人物形象</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/3b156968.html alt=獨特的苗族民間療法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/39f60001bac5d65c3b23 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/3b156968.html title=獨特的苗族民間療法>獨特的苗族民間療法</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>