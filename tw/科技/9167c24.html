<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Visual Studio代碼度量值查看方法以及特性詳解 | 极客快訊</title><meta property="og:title" content="Visual Studio代碼度量值查看方法以及特性詳解 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/98c4dad9fbf84df4873771289e856163"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9167c24.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9167c24.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9167c24.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9167c24.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9167c24.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9167c24.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9167c24.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9167c24.html><meta property="article:published_time" content="2020-10-29T21:01:10+08:00"><meta property="article:modified_time" content="2020-10-29T21:01:10+08:00"><meta name=Keywords content><meta name=description content="Visual Studio代碼度量值查看方法以及特性詳解"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/9167c24.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Visual Studio代碼度量值查看方法以及特性詳解</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><h1><strong>查看方式</strong></h1><p><strong>Visual Studio -> Analyze -> Calculate code metrics feature</strong></p><p>代碼度量(Code Metrics)是用來測量專業標準的軟件特性。在某些方面，它提供了量化的有用反饋給開發者。</p><p>查看代碼度量值很簡單：在項目或解決方案上按右鍵，選擇"Calculate Code Metrics"。 以下是一些類似的結果:</p><div class=pgc-img><img alt="Visual Studio代碼度量值查看方法以及特性詳解" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/98c4dad9fbf84df4873771289e856163><p class=pgc-img-caption></p></div><p>結果窗口中有五個不同的度量特性：圈複雜度(Cyclomatic Complexity)， 繼承深度(Depth of Inheritance)， 類耦合度(Class Coupling)， 代碼行數(Lines of Code)， 和一個總的可維護指數(Maintainability Index)。 通過展開左邊的樹結點，你可以從整個項目深入觀察類裡面的方法。</p><p>但是特徵中的<span>那些數字</span>是什麼意思呢?</p><h1><strong>圈複雜度(Cyclomatic Complexity)</strong></h1><p>圈複雜度是調用方法時取得的線性獨立路徑的總數，基於if，switch，while和類似的分支語句的數量。 如果一個方法沒有這樣的語句存在，就表示方法中只有一條可行路線，這樣的情況下圈複雜度的值為1。</p><pre>public int DoSomething(int x){if (x == 1){// code that is executed when x is 1}if (x == 2){// code that is executed when x is 2}// code that is executed even if x is neither 1 or 2return x;}</pre><p>在這個例子中，有三條可行的路線存在，走哪條路線取決於x的值:</p><p>1、當x是12、當x是23、當x不是1也不是2</p><p>圈複雜度告訴你兩件重要事：</p><p>首先，它指出一個方法的綜合複雜度。值越低越好，如果數值較高，就說明方法可能覆蓋了過多不同情況的處理(例如，嘗試做太多容錯處理)，說明方法需要分解成更簡單的只滿足一種情況的單一職責方法(這樣會更容易維護)。</p><p>其次，為了確保每種情況都被完全地測試，你必須為每條路線創建唯一的測試用例。 圈複雜度告訴你需要寫多少個測試用例來確保所有可能的情況都已經被覆蓋。</p><p>如果一個代碼段的圈複雜度值多於測試用例的數量，你就會發現有些情況沒有被處理，而且可能藏匿著bug。</p><p><strong>繼承深度(Depth of Inheritance)</strong></p><p>繼承深度是表示一個類的繼承的級數，起始值為1(所有類都是繼承自Object)。 這個例子有3級繼承:</p><div class=pgc-img><img alt="Visual Studio代碼度量值查看方法以及特性詳解" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8d2d2acdbefc48a39c4df553ae4f135b><p class=pgc-img-caption></p></div><p>該值是越低越好; 如果繼承深度在3或4以上，你的代碼可能超出設計標準(over-engineered)，說明代碼是難以維護的。</p><p>數值越高，就越多子類需要修改 -- 消耗時間和金錢，也潛在地引入bug -- 如果你對基類做出重大變更的話。</p><p>只要你考慮下每個變更對於子類會引入一些潛在的bug，這些bug會影響到他們引用的所有對象。。。 你就懂我意思了。</p><h1><strong>類耦合度(Class Coupling)</strong></h1><p>類耦合度是計算一個類中引用到的對象類型數，不包括原始的和內置的類型，像int和string。 該值是越低越好; 值越高，就代表類綁定了越多類，也意味著存在越多依賴關係在它的中間環境中。</p><p>隨著類的耦合度的增加，它就會變得難以分離出來用在另一個項目中。 簡單來講，類的耦合度越高，它的重用性就越低。</p><p>我們都看過很多理論案例說類要儘量可重用，但實際編程，大部分類都是高度針對特定項目而編寫的，或多或少需要完全重寫才能"重用"在另一個項目中。</p><p>如果類在它最初被創建的時候設計得更完善，我們就可以在之後省掉很多時間。</p><h1><strong>代碼行數(Lines of Code)</strong></h1><p>代碼行數是通過計算執行的代碼行數來量度軟件塊的大小。 雖然和上面的特徵一樣，這個值也是越低越好(原因很簡單，你以更少的代碼完成功能就能減少你思考的負擔)，但在用這個特徵前有幾條告誡你需要知道:</p><p>1、不是每行代碼都相等。 有些行是非常簡單，有些卻非常複雜，會花費數小時來計算。2、它不計算已刪除或已覆蓋的代碼3、有時將一行復雜的代碼分割成幾行會令它更容易理解; 在這樣的情況下，增加了代碼行但更容易維護。4、除非設計完善並徹底測試過，而且已成型的所有代碼是出自你本人，否則代碼行數不會精確反映投入軟件中的努力的量。要聰明地使用這個度量值。 在以前，代碼行數出名地被濫用於測量每日的編程生產力，帶來了災難性的結果。 請記住，比起寫代碼，軟件開發有更多重要的東西。</p><h1><strong>可維護指數(Maintainability Index)</strong></h1><p>最後是可維護指數，範圍是0到100，用來指示所有類，成員，命名空間或項目的可維護性。 事實上，它是一個之前所有度量值的合計值，但它也同時包含一些額外的度量值，像霍爾斯特德量(Halstead Volume)，該值用來量度程序的總長度和詞彙數。 與之前的度量值不同，這個值是越高越好。</p><p>可維護指數還提供了一個紅/黃/綠的交通燈圖標，讓你一眼看見問題的區域。 交通燈會轉黃當數值低於20，當數值低於10時會轉紅，這時你需要重新檢查你的代碼以躲避危險。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Visual</a></li><li><a>Studio</a></li><li><a>代碼</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E5%AD%B8/80ce7a9.html alt="12個Visual Studio調試效率技巧" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3f071deda1ba4990be44a5288def5a58 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/80ce7a9.html title="12個Visual Studio調試效率技巧">12個Visual Studio調試效率技巧</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c9ad6a3e.html alt=（1-2我們的第一段PHP代碼）php基礎php學習基礎實例代碼操作教程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b707f4e4acce41bda439262a966603f8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c9ad6a3e.html title=（1-2我們的第一段PHP代碼）php基礎php學習基礎實例代碼操作教程>（1-2我們的第一段PHP代碼）php基礎php學習基礎實例代碼操作教程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/389d4437.html alt="Python常用算法學習(5) 樹二叉樹（原理+代碼）-最全總結" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d3d5fd4ef98c4a8e8dc9095eeef052a6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/389d4437.html title="Python常用算法學習(5) 樹二叉樹（原理+代碼）-最全總結">Python常用算法學習(5) 樹二叉樹（原理+代碼）-最全總結</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f4e78a26.html alt=二叉樹的算法代碼，一篇文章全搞定！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f4e78a26.html title=二叉樹的算法代碼，一篇文章全搞定！>二叉樹的算法代碼，一篇文章全搞定！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/873415c9.html alt=錯誤代碼大全2，時刻掌握計算機的故障原因！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/152937668211718b8850640 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/873415c9.html title=錯誤代碼大全2，時刻掌握計算機的故障原因！>錯誤代碼大全2，時刻掌握計算機的故障原因！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/45c8b4b0.html alt=關於“神祕代碼”的含義 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/c040bb33daee4d30bc48cb70d5bf8ee1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/45c8b4b0.html title=關於“神祕代碼”的含義>關於“神祕代碼”的含義</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8d4cfc67.html alt=VBA代碼自動讓一個空閒工作薄關閉 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/49f19f02a01b4aa28fab830611f1ae2d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8d4cfc67.html title=VBA代碼自動讓一個空閒工作薄關閉>VBA代碼自動讓一個空閒工作薄關閉</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/55fe58a0.html alt=對不起，我的VBA代碼將暫停運行，並於10秒後自動關閉主程序 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/84e4fd546fe349bebfed630910a1b643 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/55fe58a0.html title=對不起，我的VBA代碼將暫停運行，並於10秒後自動關閉主程序>對不起，我的VBA代碼將暫停運行，並於10秒後自動關閉主程序</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c733e892.html alt=「軟件工程」代碼質量綜合指南：最佳實踐和工具 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/236ba3959c874246b78fcd77527eeceb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c733e892.html title=「軟件工程」代碼質量綜合指南：最佳實踐和工具>「軟件工程」代碼質量綜合指南：最佳實踐和工具</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0a63befb.html alt=志高空調故障代碼—室內機與主機通訊故障 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2458a1e3f357436b89196b74341218e1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0a63befb.html title=志高空調故障代碼—室內機與主機通訊故障>志高空調故障代碼—室內機與主機通訊故障</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/83b0c7a4.html alt=VBA代碼利用Listview控件來顯示你的工作表任務 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7127f7ca7e064dd8b8a4283b5246d4d9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/83b0c7a4.html title=VBA代碼利用Listview控件來顯示你的工作表任務>VBA代碼利用Listview控件來顯示你的工作表任務</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1085ff4a.html alt=利用VBA代碼自定義設置我的菜單 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/04d2083257c844a8a10542a635548b26 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1085ff4a.html title=利用VBA代碼自定義設置我的菜單>利用VBA代碼自定義設置我的菜單</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b95dde80.html alt=Linux技巧：在代碼中設置終端字符顯示顏色和移動光標位置 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/9bde2c83315847498e4b848f524e429c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b95dde80.html title=Linux技巧：在代碼中設置終端字符顯示顏色和移動光標位置>Linux技巧：在代碼中設置終端字符顯示顏色和移動光標位置</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ce238bab.html alt=代碼：C語言中的移位 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/37ce0000d799b4e516fa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ce238bab.html title=代碼：C語言中的移位>代碼：C語言中的移位</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7b70c367.html alt="代碼規範—使用 TypeScript 裝飾器" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/4b5097e2-c4fd-4d37-9c54-707760739775 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7b70c367.html title="代碼規範—使用 TypeScript 裝飾器">代碼規範—使用 TypeScript 裝飾器</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>