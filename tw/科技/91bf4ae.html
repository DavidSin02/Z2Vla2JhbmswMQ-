<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>報表工具對比選型系列用例——多源分片報表 | 极客快訊</title><meta property="og:title" content="報表工具對比選型系列用例——多源分片報表 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/95fb949a3a52446d9469fefa4df369df"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/91bf4ae.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/91bf4ae.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/91bf4ae.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/91bf4ae.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/91bf4ae.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/91bf4ae.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/91bf4ae.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/91bf4ae.html><meta property="article:published_time" content="2020-10-29T21:07:00+08:00"><meta property="article:modified_time" content="2020-10-29T21:07:00+08:00"><meta name=Keywords content><meta name=description content="報表工具對比選型系列用例——多源分片報表"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/91bf4ae.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>報表工具對比選型系列用例——多源分片報表</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>潤乾報表、帆軟報表、Smartbi、永洪 BI、億信 BI 這幾款國內產品都把中國複雜報表作為宣傳點。我們以常見的多源分片為報表為用例，來對比評測這些產品的處理能力（由於時間和知識限制，個別很偏的功能點可能會有遺漏）。</p><p>內容比較長，如果不想看細節，可以直接跳到最後看結論。</p><h1 class=pgc-h-arrow-right>用例說明</h1><p><strong>報表式樣</strong></p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/95fb949a3a52446d9469fefa4df369df><p class=pgc-img-caption></p></div><p><strong>數據結構</strong></p><p>[訂單表]</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/91ca2fead7954a56afe7d0ca462e5680><p class=pgc-img-caption></p></div><p>主數據存儲在訂單表中，該表通過僱員 ID 和銷售員表關聯，通過產品 ID 和產品表關聯。</p><p>[銷售員表]</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8236408da7b44f139db06c1c0aa029f4><p class=pgc-img-caption></p></div><p>銷售員表中存儲職務、姓名，報表左下角統計數據時按照職務和姓名統計，該表通過僱員 ID 和訂單表關聯。</p><p>[產品表]</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/71aeba2e70724ca1850db37a42a13bf6><p class=pgc-img-caption></p></div><p>產品表中包含類別 ID 和產品 ID，並且是一對多關係，報表中需要按照類別分組，也就是要按該類別下多個產品的信息彙總。通過產品 ID 和訂單表關聯</p><p>[類別表]</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/9a408284613e480ca3b342be22811a6a><p class=pgc-img-caption></p></div><p>這是一箇中文字典表，通過它將類別 ID 映射成中文名稱。</p><p>假定數據都來自數據庫，可用 SQL 語句取出。</p><p><strong>報表特點分析</strong></p><p>1、 這是一個典型的多源分片報表，報表可以分成左上、右上、左下、右下四片區域，每片數據來自不同數據表（甚至可能不同數據庫），需要實現多個數據集之間的關聯。</p><p>2、 對字段數據的處理，數據庫中存儲的是訂購日期，報表中需要按照年、月分組統計，需要根據日期解析出年、月，彙總區域是金額，數據庫中存儲的是單價、數量，需要對字段進行相乘操作。</p><p>3、 上表頭中的產品類別需要按確定的次序排列，也就是維表 ID 的次序。</p><p>4、 左表頭的層次不一樣，上半兩層，下半三層。</p><p>下面看下幾款工具製作這個報表的過程和工作量。</p><p>關於工作量的評估，我們假定使用者均熟悉 SQL 語句且瞭解相應的報表工具，並只記錄實際的製作和正常調試的時間，不包括查閱產品函數資料的時間，也就是一個熟手的完成時間。</p><h1 class=pgc-h-arrow-right>潤乾報表</h1><p><strong>製作過程</strong></p><p>1、 配置並連接數據源，這個各個工具操作基本都類似，按照嚮導方式配置就行。</p><p>2、 設置數據集</p><p>潤乾報表支持多數據集，本例的數據存儲在四個表內，所以在報表中增加四個數據集，只要分別取四個表的數據（select * from …），可以通過嚮導操作。</p><p>3、 設計報表模板</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/604132d5a1924bcdb07e0bed78cac3c9><p class=pgc-img-caption></p></div><p>多源分片報表是一個比較基礎的中國式報表，國內報表工具基本都支持，這裡看下幾個關鍵單元格的設置：</p><p>3.1、 A3 單元格表達式：=ds1.group(year( 訂購日期);year(訂購日期):1)+“年”，需求中要求按照年月分組，而數據庫中存儲的是訂購日期，所以此處先通過 year 函數取訂購日期中的年份。</p><p>3.2、 D3 單元格：=ds1.sum( 數量<em>單價 )，報表統計項中的金額是通過單價</em>數量這兩個字段生成。</p><p>3.3、 E2 單元格按照類別 ID 分組統計，但是要求這個單元格顯示中文，單元格有個顯示值表達式屬性：</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d8cf705ea5aa45feac71eb8a8f955637><p class=pgc-img-caption></p></div><p>中文可以來自單獨的一個數據集，這樣通過內置的函數就可以將 id 映射成中文。</p><p>3.4、 E3 單元格：=ds1.sum(數量 * 單價, 產品 ID in ds4.select( 產品 ID))，多源分片最主要的要將多個數據源數據關聯在一起，函數裡邊寫入過濾條件就行，銷售額在 ds1 數據集中，E2 單元格的類別來自 ds4 數據集，ds1 和 ds4 通過產品 ID 關聯，ds4 中類別 ID 和產品 ID 是一對多的關係，所以此處關聯用 in，這樣報表右上方就能取出對應類別下的數據彙總。</p><p>3.5、 報表第四行表達式類似，主要是 ds1 和 ds3 數據集之間的關聯，這裡就不細說了。</p><p>3.6、 單元格邊框、合併單元格，這些操作和 excel 中基本一致，按照需求設置就行。</p><p><strong>運行結果</strong></p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/05fb3a52d06140a690ce5ee246bc88da><p class=pgc-img-caption></p></div><p><strong>完成後點評</strong></p><p>1、 用時 0.5 小時。</p><p>2、 常規設置和操作 excel 類似，再加上報表內的函數，製作起來很快。</p><p>3、 函數豐富，比如 =ds1.group(year( 訂購日期);year(訂購日期):1)+“年” ，對訂購日期的年份進行分組，直接用 year 函數取年就行，不必對源數據集進行單獨設置；類似地，=ds1.sum( 數量 * 單價) 數據由其他字段組合生成時，直接使用函數，不需要單獨寫 sql 語句等，這樣只關心報表中幾個函數的使用就行。</p><p>4、 多源關聯方便，比如：=ds1.sum(數量 * 單價, 產品 ID in ds4.select( 產品 ID))，還是通過函數內置的一些功能實現，不用在數據集中處理，絕大多數操作都是在單元格函數中控制。</p><p>5、 產品類別用維表擴展（E2 格中用 ds2.group 根據類別 ID 分組），很容易保證次序，再設置顯示值就能顯示相應的中文名稱。</p><p>6、 採用類 Excel 操作，佈局、樣式設置按照以前的思維處理就行，包括一些數據彙總等等。</p><p>7、 表達式基本上都是手填，雖然有表達式編輯界面，但還不如手填來得方便。</p><h1 class=pgc-h-arrow-right>帆軟報表</h1><p><strong>製作過程</strong></p><p>1、 配置並連接數據源</p><p>2、 設置數據集</p><p>帆軟報表支持單元格中的多數據集關聯，在報表中新增四個數據集，分別對應 4 個數據表。但訂單表的 SQL 特殊一點，先要用 單價 * 數量 as 銷售金額，報表中要對銷售金額彙總，金額來自單價和數量兩個字段的乘積。因為在報表中沒找到字段相乘彙總的辦法，所以在取數時新增一個列。</p><p>3、 設計報表模板</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/215ef783e8e54da3b02f572b66ae8318><p class=pgc-img-caption></p></div><p>3.1 分別根據訂購日期的年份、月份分組，將 ds1 中的訂購日期拖拽到單元格 A3 中，在自定義分組對話框中設置自定義公式:year($$$)+”年”， 將 ds1 中的訂購日期字段拖拽到 C3 中，同樣增加自定義公式分組，分組表達式為 month($$$)+”月”</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0feef33ff3dd47b8957a7aeb203eabb1><p class=pgc-img-caption></p></div><p>3.2 D2 單元格按照城市排序，程序裡默認按照中文的 ASCII 碼排序，如果想按照拼音排序則需要在單元格屬性的擴展排序中設置公式，如：</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/16ecea2c7b204c76a669eb9e54ea9322><p class=pgc-img-caption></p></div><p>使用該函數需要下載函數插件。類別字段是按 ID 排序，則不需要專門處理。</p><p>3.3 交叉點中的銷售金額統計，在數據集中先做了處理生成了銷售金額字段，此處直接進行求和操作。</p><p>3.4 多數據集單元格關聯。帆軟在做多源關聯的時候，通過下拉選擇數據列，操作符和比較的對象，通過點擊增加按鈕，自動生成關聯的條件表達式。</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/7edd3abf9c0249198d4eabb268fdf4b0><p class=pgc-img-caption></p></div><p>3.5 顯示值設置</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/19f15b0a60a540ae92486a5292db1dae><p class=pgc-img-caption></p></div><p>對 C5 中僱員 ID 需要最終顯示出僱員的姓名，在形態中要選擇數據查詢，設置對應的顯示值字段。</p><p><strong>報表結果</strong></p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2c09e33570634a038cfdac2b7ae8eedb><p class=pgc-img-caption></p></div><p><strong>完成後點評</strong></p><p>1、 用時，0.5 小時。</p><p>2、 數據集設置裡直接用嚮導取數，沒有特殊的寫法，製作這樣的報表對寫 SQL 能力要求不高。</p><p>3、 到處都有可視化界面，操作體驗對初學者非常良好。比如報表中多源關聯時，通過下拉選擇數據列、操作符和比較的對象，就能自動生成關聯的條件表達式，不需要對源數據進行關聯處理。</p><p>4、 工具採用類 Excel 操作，佈局、樣式設置按照以前的思維處理就行，包括一些數據彙總等等。</p><p>5、 運算模型把字段和表達式分別處理的，需要增加自定義表達式才能拖拽填入，對熟手略顯囉嗦。</p><p>6、 中文排序默認是按照 ASCII 排序，並不是按照常規的首字母方式，要按首字母排序要用 StringPinyin() 函數轉換下，需要單獨下載插件，這裡有點不方便。</p><p>7、 銷售金額來源於單價 * 數量，帆軟單元格里不能直接先對字段相乘然後再求和，本例中是通過 SQL 語句新增字段，文本數據源或者 nosql 數據庫無法執行 SQL 時，只能在報表中增加隱藏行，會比較麻煩。</p><h1 class=pgc-h-arrow-right>Smartbi</h1><p><strong>製作過程</strong></p><p>1、 配置並連接數據源。</p><p>2、 準備數據集</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7c73d7bd6d6749d4b898fbb59e8621cd><p class=pgc-img-caption></p></div><p>報表支持多數據集，這裡按照需要準備四個，每個數據集分別取自描述中數據結構的四個物理表。</p><p>其中訂單數據集：“select <em>, 數量</em>單價金額,year(訂購日期) 年,month(訂購日期) 月 from 訂單” ，因為報表內要根據訂購日期按 年和月分組，但 smartbi 沒有對應的單元格函數支持，所以需要在數據準備階段把需要分組的字段獨立成一個字段。彙總金額也是同樣的，在數據集已有字段先算出“金額”。其餘數據集取出相應數據就行。</p><p>3、 設計報表模板</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a0b292c9a8fd404aac0353d99a5a09ae><p class=pgc-img-caption></p></div><p>3.1 訂單數據集中已經處理了年、月、金額等，所以報表中直接使用處理後的字段，用鼠標將相應的字段拖拽到對應單元格就行，和其他類 Excel 開發工具類似，此處就不做過細說明了。</p><p>3.2 多數據集間關聯是通過“過濾”功能，普通條件類型選擇數據列，下面的過濾條件就可以直接可以和其他數據集的字段關聯了，如下</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/86d57eb5c90a4a2c9440477cacd9da53><p class=pgc-img-caption></p></div><p>設計界面</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d7bafaf6d3cc46f79dfdd8e665397935><p class=pgc-img-caption></p></div><p><strong>運行結果</strong></p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/2d4437fd982542f6aaabafcd810a85b9><p class=pgc-img-caption></p></div><p><strong>完成後點評</strong></p><p>1、 用時：1 小時左右。</p><p>2、 Smartbi 在 excel 中進行報表開發，比較符合常規使用習慣，主要查看下具體函數使用以及關聯操作就行。</p><p>3、 關聯直接在報表單元格中通過嚮導方式設置，簡單的關聯不需要手寫代碼。</p><p>4、 儘管是點選方式設置過濾表達式，不過有些可複用的表達式沒法複製粘貼，都必須重複點選一次。</p><p>5、 對於年、月分組的處理，沒有可用的單元格函數，需要在數據準備階段，基於“訂購日期”字段把年、月單獨處理成獨立字段。訂單金額同樣，需要在數據集中設置。如果數據來源是文本文件或者是 NOSQL 數據庫，無法寫 SQL 語句處理這些字段，這類需求就很難實現了，只能更改數據結構或者報表中增加輔助行列（本例是彙總表，需要增加大量隱藏行列），可行性不大，所以在實際應用中還是有一定限制的。</p><p>6、 在設計過程中發現，當有增刪行時，其他格子設置的主格不自動變化，這個有點費勁了，一旦有這種情況，都得檢查改一遍。</p><p>7、 沒有真實值和顯示值的分類，導致存放在不同庫的碼錶無法把名稱給顯示出來。 如果必須弄，需要藉助“轉換規則”，先建轉換規則，然後給業務數據集的字段選擇規則，然後單元格屬性勾選“使用顯示值”這個東西是系統配置，也就是需要系統功能配合才能做到 ID 反顯名稱。</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8e80f8ff8cf148fb94d7743d0b73730a><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1186eef98fdf499cbf42ac8c5bf7c6ef><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>永洪 BI</h1><p><strong>製作過程</strong></p><p>1、 配置並連接數據源</p><p>2、 設置數據集</p><p>永洪中自由格式報表支持多數據源，按照嚮導方式新增四個數據集，每個數據集對應數據庫中的一張表，形成銷售員、訂單、產品、類別名稱四個數據集。永洪報表單元格內支持多數劇集關聯的，但使用起來有問題，比如類別表和訂單表關聯是通過產品 ID，類別和產品 ID 是個一對多的關係，永洪單元格內關聯不支持這種 in 的形式，所以沒辦法用它的多數據集模型來實現這張報表。只能換個思路，在數據集階段將多個數據集合成一個數據集。本例中實質上是一個事實表和三個維表的關聯，還可以改用組合數據集，通過嚮導將多個數據集結果關聯形成一個單數據集：</p><p>2.1、 新建組合數據集，將已經創建好的四個數據集通過關聯字段關聯起來，通過嚮導方式設置就行。</p><p>2.2、 訂購日期年、月的處理，在數據集設置中，可以在訂購日期上新增加統計字段，用內置函數生成新的字段年和月</p><p>2.3、 金額的話同樣，可以新增字段，裡邊寫入 單價 * 數量，生成新的計算列</p><p>3、 設計報表模板</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e06d2f9e740c44a3a0a034e85be1e46a><p class=pgc-img-caption></p></div><p>在數據集設置中，用“組合數據集”將多個數據集關聯成了一個數據集，並且對年、月、金額等數據做了處理，所以報表中設計器來就比較方便了，直接用鼠標將字段拖拽到對應的位置，設置擴展方向、合併格等就可以了。</p><p><strong>運行結果</strong></p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b0e6f21d3cbc4f958e29e41a74d10756><p class=pgc-img-caption></p></div><p><strong>完成後點評</strong></p><p>1、 報表製作用時，1 小時多。數據集多數據源關聯需要較長時間。</p><p>2、 數據處理能力較強，提供“組合數據集”將已有的數據集（可跨庫）關聯成一個新的數據集。能夠在數據集基礎上新增統計列。</p><p>3、 多源關聯支持有一定侷限性，最好的關聯方式應該是報表內單元格間多數據集的關聯，這樣就不用考慮具體數據集的來源，永洪本身是支持單元格內做格間過濾的，但是關聯只能用“=”，而像本例中的類別和產品一對多的關聯要用 in 形式，它就不支持了，所以必須要轉成單數據集。本例是一個事實表和三個維表的關聯，還能轉換成單數據集對付，實際應用中數據集個數可能會更多，關聯會更復雜、甚至會出現多對多的關聯，就做不成單數據集了。而且即使是維表和事實表的簡單關聯，還需要考慮 left join 等關聯方式，設置工作量大增。本例製作時維表中有冗餘數據，導致數據不準確，花了較長時間才發現問題，嚴格上來說並不是一個好方案。總體來看，永洪的多源關聯能力還不夠完善。</p><p>4、 上表頭的類別排序實現困難，永洪中單元格不支持顯示值屬性的設置，要想顯示中文單元格內只能從數據集中取中文字段，這樣就會按照中文字段排序了，無法達到按照 ID 排序需求，倒是可以加個隱藏行，裡邊按照 ID 分組排序，然後下邊增加一行顯示中文，需要增加輔助行，有點費事了。</p><p>5、 報表中設置了表頭斜線，結果中能顯示，但是在設計模板中看不到效果，容易造成混淆。包括單元格多選，不能像 excel 那樣鼠標選中一片，要按 ctrl 鍵，不太方便。</p><h1 class=pgc-h-arrow-right>億信</h1><p><strong>製作過程</strong></p><p>1、 配置並連接數據源。</p><p>2、 設置數據集</p><p>億信支持多個數據來源，在數據集中增加多個數據集，數據集類型分為主題表和維表，主題表是報表中用到的主數據來源，也就是事實表，比如本例的訂單信息，維表用於中文顯示值映射，也就是碼錶。按照嚮導設置，內容就是普通的 sql 語句，比如（select * from ……）。</p><p>億信報表也支持數據來自多個數據集，但是如果兩個數據集要關聯取數的話報表單元格內是無法做到的，要提前在數據集設置頁面設置表間關係。比如本例中訂單表和銷售員表是通過僱員 ID 關聯，那麼要設置一下兩個數據集間的表關聯關係：</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/c20aeba539524d329d0ae37c5c950b17><p class=pgc-img-caption></p></div><p>3、報表設計頁面</p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/838ca8fd630e42c3a08416251cf149e6><p class=pgc-img-caption></p></div><p>億信報表的計算和其他報表工具不同，其他報表是先執行數據集取數，然後報表內根據表達式從數據集結果中取數運算，而億信是分析單元格、解析單元格表達式、查找表間關係、拼 sql 取數返回到單元格，比如產品類別那列，第二行是 CHANPIN 數據集，第三行是 DINGDAN 數據集，</p><p>如果數據集創建階段沒有設置表間關係，那麼會解析成兩個 SQL 去數據庫取數，由於報表單元格內無法設置關聯，這兩段數據是沒有任何關聯的，本例要求取對應類別下的數據，所以在數據集處創建了 CHANPIN 和 DINGDAN 的關聯，這樣這塊就會解析成類似：select price*num from DINGDAN,CHANPIN where DINGDAN. 產品 ID=CHANPIN. 產品 ID，將這個 SQL 發送到數據庫端然後取結果返回，這樣就能關聯展示，這裡可以看到，因為要解析成一個 SQL，所以要求兩個數據集來源必須是同一個庫。從這個意義講，億信並不能算嚴格支持多源關聯報表，關鍵運算是轉換成 SQL 丟給數據庫去做的。</p><p>億信的難點在於前期的數據整合、設置表間關聯，報表設計的具體操作和其他工具就都比較類似了，比如類別那可以取類別 ID 並按照 ID 排序，在設置顯示值，具體這裡就不一一說明了。</p><p><strong>運行結果</strong></p><div class=pgc-img><img alt=報表工具對比選型系列用例——多源分片報表 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b9e5b3718ca742fe82af7b03cded1d7f><p class=pgc-img-caption></p></div><p><strong>完成後點評</strong></p><p>1、 製作用時 1 小時。</p><p>2、 多源關聯時的處理，要對源數據進行數據的關聯處理，數據集多時，找表間關聯關係還要驗證關聯後的數據準確性，耗時較長。</p><p>3、 可以通過函數對數據集字段操作，比如年、月維度的控制，銷售金額來源於 danjia*shuliang，不需要在數據集中控制。</p><p>4、 難點在數據關聯處理，數據處理完成後，這個報表格式比較簡單，實際報表製作主要通過鼠標拖拽還是比較方便，當然這個好像多個報表工具操作都差不多。</p><p>5、 多源關聯支持是有問題的，億信的機制是報表計算時解析單元格內的表達式然後尋找表間關係再拼成 SQL 方式去數據庫取數（其實本質還是數據庫內的關聯），那麼就要求多個數據集來自同一個庫，這樣無法處理異庫數據集間的關聯，更無法支持非數據庫來源的數據。即使是同一數據庫，在設置表關聯時為保證維數據的不丟失，還要考慮 left join 等情況，實際操作起來還是有些難度的，還要避免出現多對多的情況，否則無法保證數據的正確性，當前機制下處理多源關聯類報表難度大。</p><h1 class=pgc-h-arrow-right>總結</h1><p>多源分片報表是非常典型的複雜報表，僅僅從這一個簡單例子，也能看出各家產品的風格，而且，這些風格並不只侷限於這一個報表，可以說是這些產品的基本特徵。</p><ol start=1><li>如果不糾結細節的話，各家產品都能完成這個報表，從功能上講算是都能過關的。</li><li>從報表開始起家的潤乾和帆軟明顯要更強，製作過程流暢性要比永洪和億信這兩家以 BI 起家的產品好很多。後兩者並不以複雜報表作為主要賣點，但受市場壓力，也要提供這種能力，基本上就是做到“可以用”的水平，但遠遠談不上好用。Smartbi 介於這兩類中間，它以 BI 起家，但年代要久遠，受到複雜報表的需求壓力也較多，能力比永洪億信要好很多，但和潤乾帆軟相比仍有一定的差距。</li><li>報表模型上，潤乾和帆軟基本一樣，Smartbi 也類似；永洪和億信則相差較大。這種單元格擴展來解決分片報表的機制先由潤乾發明，帆軟之後跟隨，擴展模型層面基本上全抄，只是改了術語名稱（主格改叫父格），因此是一樣的，能力也基本相當。Smartbi 之後再抄過來（延用了帆軟的術語，這裡面還有故事就不說了），結果形成了相似的模型。而永洪和億信的 BI 基因較強，對複雜報表的邏輯理解還不夠深刻，模型就差了很多，能力當然也會差很多，這兩家產品的複雜報表只能算是入門階段，和其它三家相比不在一個檔次。</li><li>潤乾和帆軟的使用都較為流暢，但風格也仍有不同。潤乾製作過程中提倡手寫表達式，而帆軟則更多用可視化界面。看起來後者會對使用者更友好，這也是業界常常說用潤乾難帆軟易的現象。但對於熟手來講，手寫表達式的效率更高，而且可以隨意靈活組合；使用界面編輯對生手門檻低，熟手卻會嫌煩，還犧牲靈活性。比如此例中帆軟需要先定製數據集把表達式邏輯化成字段才行，而潤乾對於表達式和字段是同一套規則，無需專門處理。</li><li>從這個意義上，潤乾和帆軟的擴展模型雖然都一樣，但底層運算模型還是有差異。潤乾的抽象程度更深，數據計算能力也就更強，初期掌握難度略大，但一旦掌握就會發現能夠橫掃一切；而帆軟考慮的情況要簡單，在簡單情況下更順手，但碰到特殊情況時還要再用特殊手段，反而進一步提高學習成本。結果的表現是：初次使用且沒碰到複雜情況時帆軟的效率更高（選型考察產品時常常是這樣的），長期反覆使用時（總會碰到複雜情況了）潤乾的效率就會明顯佔優。</li></ol></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>報表</a></li><li><a>選型</a></li><li><a>用例</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/421bbc6a.html alt=報表工具對比選型系列用例——過程計算 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/194902429a4c43218283ae04603edd77 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/421bbc6a.html title=報表工具對比選型系列用例——過程計算>報表工具對比選型系列用例——過程計算</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1b4746cd.html alt=不愧是財務總監，做的財務分析報表這麼高大上，數據直觀，厲害 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/f7896873614243fa9ecddcedab65d874 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1b4746cd.html title=不愧是財務總監，做的財務分析報表這麼高大上，數據直觀，厲害>不愧是財務總監，做的財務分析報表這麼高大上，數據直觀，厲害</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d1aec48f.html alt="蘭州市公安局大幅清理規範基層派出所報表臺賬 迴歸主業 讓民警輕裝上陣" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/Ri8EAuuh4unwk style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d1aec48f.html title="蘭州市公安局大幅清理規範基層派出所報表臺賬 迴歸主業 讓民警輕裝上陣">蘭州市公安局大幅清理規範基層派出所報表臺賬 迴歸主業 讓民警輕裝上陣</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cb03cd29.html alt=氧氣傳感器的選型目錄 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2186a708231b414483e05aa2ee2c80fc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cb03cd29.html title=氧氣傳感器的選型目錄>氧氣傳感器的選型目錄</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6a8fcb28.html alt=溶氧儀的分類及選型指南 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a1ca64e1e97b4f159a9813463fc769d0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6a8fcb28.html title=溶氧儀的分類及選型指南>溶氧儀的分類及選型指南</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/be38071c.html alt=溫度傳感器選型技巧：如何選擇熱電阻和熱電偶傳感器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8530c0cd8cac44fca052d478338aa348 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/be38071c.html title=溫度傳感器選型技巧：如何選擇熱電阻和熱電偶傳感器>溫度傳感器選型技巧：如何選擇熱電阻和熱電偶傳感器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/feeaba4f.html alt="在線報表設計實戰系列 – ②製作表格類報表" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/47190002d9db05c4adc2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/feeaba4f.html title="在線報表設計實戰系列 – ②製作表格類報表">在線報表設計實戰系列 – ②製作表格類報表</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/64601dfa.html alt=自控工程設計：膜片壓力錶與隔膜壓力錶的原理和選型 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5eba28ddcb3e400c9f981750bfda67b6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/64601dfa.html title=自控工程設計：膜片壓力錶與隔膜壓力錶的原理和選型>自控工程設計：膜片壓力錶與隔膜壓力錶的原理和選型</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dfd4fa38.html alt=熱交換器選型與設計手冊 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/15215366460230c2c213a84 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dfd4fa38.html title=熱交換器選型與設計手冊>熱交換器選型與設計手冊</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d62e2158.html alt=傳感器的選型和使用方法，你瞭解多少呢？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/487987f0cd674356ac6f56aa1ffb0191 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d62e2158.html title=傳感器的選型和使用方法，你瞭解多少呢？>傳感器的選型和使用方法，你瞭解多少呢？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9974e585.html alt=機械密封選型與常用型號比較 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1529887218967413e2fe8ce style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9974e585.html title=機械密封選型與常用型號比較>機械密封選型與常用型號比較</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cf6c340e.html alt=六方面闡述PLC選型指導 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ffdf850a41c543c49e7276166771cb10 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cf6c340e.html title=六方面闡述PLC選型指導>六方面闡述PLC選型指導</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/358af82c.html alt=漏電斷路器的選型，零序電流保護，參數功能，一看就懂 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0220779fb56a4ee988d6100622d10765 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/358af82c.html title=漏電斷路器的選型，零序電流保護，參數功能，一看就懂>漏電斷路器的選型，零序電流保護，參數功能，一看就懂</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e75b469f.html alt=這個報表工具絕了！能做GIS數據地圖，還能集成R語言！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a0eddf7ddce349acb3397c0d299c3e78 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e75b469f.html title=這個報表工具絕了！能做GIS數據地圖，還能集成R語言！>這個報表工具絕了！能做GIS數據地圖，還能集成R語言！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9b8bf240.html alt=正交法——測試用例設計方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/78c1ce95b7c344d0bf5c3d8c5d7463ab style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9b8bf240.html title=正交法——測試用例設計方法>正交法——測試用例設計方法</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>