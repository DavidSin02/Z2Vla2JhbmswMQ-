<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Springå­¸ç¿’ï¼ˆ4ï¼‰ï¼šSpring AOP | æå®¢å¿«è¨Š</title><meta property="og:title" content="Springå­¸ç¿’ï¼ˆ4ï¼‰ï¼šSpring AOP - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/be8a179a4a8040648c1fb5a0532cc84b"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/92488c35.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/92488c35.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/92488c35.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/92488c35.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/92488c35.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/92488c35.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/92488c35.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/92488c35.html><meta property="article:published_time" content="2020-11-14T21:04:29+08:00"><meta property="article:modified_time" content="2020-11-14T21:04:29+08:00"><meta name=Keywords content><meta name=description content="Springå­¸ç¿’ï¼ˆ4ï¼‰ï¼šSpring AOP"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/92488c35.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Springå­¸ç¿’ï¼ˆ4ï¼‰ï¼šSpring AOP</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><h3 class=line>Spring AOPèªªæ˜</h3><p>AOPï¼ˆAspect Oriented Pragramingï¼‰é¢å‘åˆ‡é¢ç·¨ç¨‹ï¼ŒAOPæ¡ç”¨æ©«å‘æŠ½å–æ©Ÿåˆ¶ï¼Œå–ä»£äº†å‚³çµ±ç¸±å‘ç¹¼æ‰¿é«”ç³»çš„é‡è¤‡æ€§ä»£ç¢¼ï¼ˆæ€§èƒ½ç›£è¦–ã€äº‹å‹™ç®¡ç†ã€å®‰å…¨æª¢æŸ¥ã€ç·©å­˜ï¼‰ã€‚</p><p>æ‰€è¬‚çš„å‚³çµ±ç¸±å‘ç¹¼æ‰¿é«”ç³»æ˜¯æŒ‡ç•¶ä½ éœ€è¦å¯¦ç¾æŸå€‹åŠŸèƒ½çš„æ™‚å€™éœ€è¦å»ç¹¼æ‰¿æŸå€‹é¡ï¼Œè€Œæ©«å‘æŠ½å–æ©Ÿåˆ¶å‰‡æ˜¯é€šéä½¿ç”¨å‹•æ…‹ä»£ç†æ©Ÿåˆ¶ç”¢ç”Ÿä¸€å€‹èˆ‡ä¹‹åŒç´šçš„å°è±¡ï¼Œç„¶å¾Œåœ¨ä»£ç†å°è±¡ä¸­é€²è¡ŒåŠŸèƒ½å¢å¼·ã€‚</p><p>Spring AOPä½¿ç”¨ç´”Javaå¯¦ç¾ï¼Œä¸éœ€è¦å°ˆé–€çš„ç·¨è­¯éç¨‹å’Œé¡åŠ è¼‰å™¨ï¼Œåœ¨é‹è¡ŒæœŸé€šéä»£ç†æ–¹å¼å‘ç›®æ¨™é¡ç¹”å…¥å¢å¼·ä»£ç¢¼ã€‚</p><h3 class=line>Springçš„AOPä»£ç†</h3><p>JDKå‹•æ…‹ä»£ç†:å°å¯¦ç¾äº†æ¥å£çš„é¡ç”Ÿæˆä»£ç†CGLibä»£ç†æ©Ÿåˆ¶:å°é¡ç”Ÿæˆä»£ç†</p><h3 class=line>AOPç›¸é—œè¡“èª</h3><p><strong>Joinpoint(é€£æ¥é»):</strong>æ‰€è¬‚é€£æ¥é»æ˜¯æŒ‡é‚£äº›è¢«æ””æˆªåˆ°çš„é»ã€‚åœ¨springä¸­,é€™äº›é»æŒ‡çš„æ˜¯æ–¹æ³•,å› ç‚ºspringåªæ”¯æŒæ–¹æ³•é¡å‹çš„é€£æ¥é»ï¼›<strong>Pointcut(åˆ‡å…¥é»):</strong>æ‰€è¬‚åˆ‡å…¥é»æ˜¯æŒ‡æˆ‘å€‘è¦å°å“ªäº›Joinpointé€²è¡Œæ””æˆªçš„å®šç¾©ï¼›<strong>Advice(é€šçŸ¥/å¢å¼·):</strong>æ‰€è¬‚é€šçŸ¥æ˜¯æŒ‡æ””æˆªåˆ°Joinpointä¹‹å¾Œæ‰€è¦åšçš„äº‹æƒ…å°±æ˜¯é€šçŸ¥ã€‚é€šçŸ¥åˆ†ç‚ºå‰ç½®é€šçŸ¥ï¼Œå¾Œç½®é€šçŸ¥ï¼Œç•°å¸¸é€šçŸ¥ï¼Œæœ€çµ‚é€šçŸ¥ï¼Œç’°ç¹é€šçŸ¥(åˆ‡é¢è¦å®Œæˆçš„åŠŸèƒ½)ï¼›<strong>Introduction(å¼•ä»‹):</strong>å¼•ä»‹æ˜¯ä¸€ç¨®ç‰¹æ®Šçš„é€šçŸ¥åœ¨ä¸ä¿®æ”¹é¡ä»£ç¢¼çš„å‰æä¸‹, Introductionå¯ä»¥åœ¨é‹è¡ŒæœŸç‚ºé¡å‹•æ…‹åœ°æ·»åŠ ä¸€äº›æ–¹æ³•æˆ–Fieldï¼›<strong>Target(ç›®æ¨™å°è±¡):</strong>ä»£ç†çš„ç›®æ¨™å°è±¡ï¼›<strong>Weaving(ç¹”å…¥):</strong>æ˜¯æŒ‡æŠŠå¢å¼·æ‡‰ç”¨åˆ°ç›®æ¨™å°è±¡ä¾†å‰µå»ºæ–°çš„ä»£ç†å°è±¡çš„éç¨‹ã€‚springæ¡ç”¨å‹•æ…‹ä»£ç†ç¹”å…¥ï¼Œè€ŒAspectJæ¡ç”¨ç·¨è­¯æœŸç¹”å…¥å’Œé¡è£è¼‰æœŸç¹”å…¥ï¼›<strong>Proxyï¼ˆä»£ç†ï¼‰:</strong>ä¸€å€‹é¡è¢«AOPç¹”å…¥å¢å¼·å¾Œï¼Œå°±ç”¢ç”Ÿä¸€å€‹çµæœä»£ç†é¡ï¼›<strong>Aspect(åˆ‡é¢) :</strong>æ˜¯åˆ‡å…¥é»å’Œé€šçŸ¥ï¼ˆå¼•ä»‹ï¼‰çš„çµåˆã€‚</p><div class=pgc-img><img alt="Springå­¸ç¿’ï¼ˆ4ï¼‰ï¼šSpring AOP" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/be8a179a4a8040648c1fb5a0532cc84b><p class=pgc-img-caption></p></div><div class=pgc-img><img alt="Springå­¸ç¿’ï¼ˆ4ï¼‰ï¼šSpring AOP" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/229735938bf44e95a4216e2374199024><p class=pgc-img-caption></p></div><h1 class=line>AOPçš„åº•å±¤å¯¦ç¾</h1><p>å‰é¢èªªéAOPä»£ç†æœ‰å…©ç¨®ï¼Œä¸€ç¨®æ˜¯JDKå‹•æ…‹ä»£ç†ï¼Œç”¨æ–¼å°å¯¦ç¾äº†æ¥å£çš„é¡ç”Ÿæˆä»£ç†ï¼›å¦ä¸€ç¨®æ˜¯CGLibä»£ç†æ©Ÿåˆ¶ï¼Œç”¨æ–¼å°é¡ç”Ÿæˆä»£ç†ã€‚</p><h3 class=line>JDKå‹•æ…‹ä»£ç†</h3><p>æ–°å»ºä¸€å€‹Mavené …ç›®ï¼Œåç¨±ç‚ºSpringAOPï¼Œå°å…¥Junitä¾è³´ã€‚æ–°å»ºcom/envy/aop/demoæ–‡ä»¶å¤¾ï¼Œæ–°å»ºæ¥å£æ–‡ä»¶UserDao.javaï¼Œè£¡é¢çš„ä»£ç¢¼ç‚ºï¼š</p><pre><code>public interface UserDao {    public void add();    public void update();}</code></pre><p>ä»¥åŠå¯¦ç¾é¡UserDaoImpl.javaæ–‡ä»¶ï¼š</p><pre><code>public class UserDaoImpl implements UserDao {    public void add() {        System.out.println("this is add method");    }    public void update() {        System.out.println("this is update method");    }}</code></pre><p>æ¥è‘—æ–°å»ºcom/envy/aop/testæ–‡ä»¶å¤¾ï¼Œæ–°å»ºæ¸¬è©¦æ–‡ä»¶AopTest.javaï¼Œè£¡é¢çš„ä»£ç¢¼ç‚ºï¼š</p><pre><code>public class AopTest {    @Test    public void testOne(){        UserDao userDao = new UserDaoImpl();        userDao.add();        userDao.update();    }}</code></pre><p>é‹è¡Œçµæœï¼š</p><pre><code>this is add methodthis is update method</code></pre><p>ä¸Šè¿°æ˜¯å‚³çµ±çš„ç·¨ç¨‹æ–¹å¼ï¼Œæ¥ä¸‹ä¾†æ˜¯ä½¿ç”¨JDKå‹•æ…‹ä»£ç†æ¨¡å¼çš„ç›¸é—œæ­¥é©Ÿï¼ŒJDKå‹•æ…‹ä»£ç†æ¨¡å¼ç”¨æ–¼å°å¯¦ç¾äº†æ¥å£çš„é¡ç”Ÿæˆä»£ç†ï¼Œè€Œæ­¤è™•çš„UserDaoæœ¬èº«å°±æ˜¯ä¸€å€‹æ¥å£ã€‚</p><p>æ–°å»ºMyJDKProxy.javaæ–‡ä»¶ï¼Œè£¡é¢ä»£ç¢¼ç‚ºï¼š</p><pre><code>public class MyJDKProxy implements InvocationHandler {    private UserDao userDao;    public MyJDKProxy(UserDao userDao){        this.userDao=userDao;    }    public Object createProxy(){        Object proxy= Proxy.newProxyInstance(userDao.getClass().getClassLoader(),userDao.getClass().getInterfaces(),this);        return proxy;    }    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {        if("add".equals(method.getName())){            //ä¸€äº›å¢å¼·åŠŸèƒ½ï¼Œå¦‚æ¬Šé™æ ¡é©—            System.out.println("é–‹å§‹æ¬Šé™æ ¡é©—æ“ä½œ");            return method.invoke(proxy,args);        }        return method.invoke(userDao,args);    }}</code></pre><p>æ¥è‘—æ–°å»ºtestTwoæ–¹æ³•ï¼Œè£¡é¢ä»£ç¢¼ç‚ºï¼š</p><pre><code>    @Test    public void testTwo(){        UserDao userDao = new UserDaoImpl();        UserDao proxy = (UserDao) new MyJDKProxy(userDao).createProxy();        proxy.add();        proxy.update();    }</code></pre><p>é‹è¡Œçµæœï¼š</p><pre><code>Start permission verificationthis is add methodthis is update method</code></pre><h3 class=line>CGLIBå‹•æ…‹ä»£ç†</h3><p>CGLIB(Code Generation Library)æ˜¯ä¸€å€‹é–‹æºé …ç›®ï¼æ˜¯ä¸€å€‹å¼·å¤§çš„ï¼Œé«˜æ€§èƒ½ï¼Œé«˜è³ªé‡çš„Codeç”Ÿæˆé¡åº«ï¼Œå®ƒå¯ä»¥åœ¨é‹è¡ŒæœŸæ“´å±•Javaé¡èˆ‡å¯¦ç¾Javaæ¥å£ã€‚ Hibernateæ”¯æŒå®ƒä¾†å¯¦ç¾PO(Persistent Object æŒä¹…åŒ–å°è±¡)å­—ç¯€ç¢¼çš„å‹•æ…‹ç”Ÿæˆ(Hibernateå¯¦éš›ä½¿ç”¨Javassistç”Ÿæˆä»£ç†ï¼Œè©²ä»£ç†å°è±¡å°±æ˜¯æŒä¹…åŒ–é¡çš„å­é¡çš„å¯¦ä¾‹)ï¼Œç¾åœ¨åšcglibçš„é–‹ç™¼ï¼Œå¯ä»¥ä¸ç”¨ç›´æ¥å¼•å…¥cglibçš„åŒ…ï¼Œå› ç‚ºspringæ ¸å¿ƒä¸­å·²ç¶“é›†æˆäº†cglibã€‚</p><p>CGLIBç”Ÿæˆä»£ç†æ©Ÿåˆ¶ï¼šå…¶å¯¦ç”Ÿæˆäº†ä¸€å€‹çœŸå¯¦å°è±¡çš„å­é¡ã€‚</p><p>æ–°å»ºProductDao.javaæ–‡ä»¶ï¼Œè£¡é¢çš„ä»£ç¢¼ç‚ºï¼š</p><pre><code>public class ProductDao {    public void add(){        System.out.println("add product");    }    public void update(){        System.out.println("update product");    }}</code></pre><p>æ¥è‘—æ–°å»ºæ¸¬è©¦æ–¹æ³•testThreeï¼Œè£¡é¢çš„ä»£ç¢¼ç‚ºï¼š</p><pre><code>    @Test    public void testThree(){        ProductDao productDao = new ProductDao();        productDao.add();        productDao.update();    }</code></pre><p>é‹è¡Œçµæœï¼š</p><pre><code>add productupdate product</code></pre><p>ä¸Šè¿°æ˜¯å‚³çµ±çš„ç·¨ç¨‹æ–¹å¼ï¼Œæ¥ä¸‹ä¾†æ˜¯ä½¿ç”¨CGLIBå‹•æ…‹ä»£ç†æ¨¡å¼çš„ç›¸é—œæ­¥é©Ÿï¼ŒCGLIBå‹•æ…‹ä»£ç†æ¨¡å¼ç”¨æ–¼å°é¡ç”Ÿæˆä»£ç†ï¼Œè€Œæ­¤è™•çš„ProductDaoæœ¬èº«å°±æ˜¯ä¸€å€‹é¡ã€‚</p><p>æ–°å»ºMyCGLibProxy.javaæ–‡ä»¶ï¼Œè£¡é¢ä»£ç¢¼ç‚ºï¼š</p><pre><code>public class MyCGLibProxy implements MethodInterceptor {    private ProductDao productDao;    public MyCGLibProxy(ProductDao productDao){        this.productDao=productDao;    }    public Object createProxy(){        //1ã€è¨­ç½®æ ¸å¿ƒé¡        Enhancer enhancer = new Enhancer();        //2ã€è¨­ç½®çˆ¶é¡        enhancer.setSuperclass(productDao.getClass());        //3ã€è¨­ç½®å›èª¿        enhancer.setCallback(this);        //4ã€ç”Ÿæˆä»£ç†        Object proxy = enhancer.create();        return proxy;    }    public Object intercept(Object proxy, Method method, Object[] args, MethodProxy methodProxy) throws Throwable {        if("add".equals(method.getName())){            //ä¸€äº›å¢å¼·åŠŸèƒ½ï¼Œå¦‚æ¬Šé™æ ¡é©—            System.out.println("Start permission verification");            return methodProxy.invokeSuper(proxy,args);        }        return methodProxy.invokeSuper(proxy,args);    }}</code></pre><p>æ¥è‘—æ–°å»ºtestFouræ–¹æ³•ï¼Œè£¡é¢ä»£ç¢¼ç‚ºï¼š</p><pre><code>    @Test    public void testFour(){        ProductDao productDao = new ProductDao();        ProductDao proxy = (ProductDao) new MyCGLibProxy(productDao).createProxy();        proxy.add();        proxy.update();    }</code></pre><p>é‹è¡Œçµæœï¼š</p><pre><code>Start permission verificationadd productupdate product</code></pre><p>ä»£ç†çŸ¥è­˜ç¸½çµï¼š1ã€Springåœ¨é‹è¡ŒæœŸç”Ÿæˆå‹•æ…‹ä»£ç†å°è±¡ï¼Œä¸éœ€è¦ä½¿ç”¨ç‰¹æ®Šçš„ç·¨è­¯å™¨ï¼›2ã€SpringAOPçš„åº•å±¤å°±æ˜¯é€šéJDKå‹•æ…‹ä»£ç†æˆ–CGLibå‹•æ…‹ä»£ç†æŠ€è¡“ç‚ºç›®æ¨™BeanåŸ·è¡Œæ©«å‘ç¹”å…¥ã€‚</p><p>è‹¥ç›®æ¨™å°è±¡å¯¦ç¾äº†è‹¥å¹²æ¥å£ï¼ŒSpringä½¿ç”¨JDKçš„java.lang.reflect.Proxyé¡ä»£ç†ï¼›è‹¥ç›®æ¨™å°è±¡æ²’æœ‰å¯¦ç¾ä»»ä½•æ¥å£ï¼ŒSpringä½¿ç”¨CGLIBåº«ç”Ÿæˆç›®æ¨™å°è±¡çš„å­é¡ã€‚åœ¨ç¨‹åºä¸­æ‡‰å„ªå…ˆå°æ¥å£å‰µå»ºä»£ç†ï¼Œä¾¿æ–¼ç¨‹åºè§£è€¦ç¶­è­·ã€‚æ¨™è¨˜ç‚ºfinalçš„æ–¹æ³•ä¸èƒ½è¢«ä»£ç†ï¼Œå› ç‚ºè©²æ–¹æ³•ä¸èƒ½è¢«é‡å¯«ã€‚å› æ­¤JDKå‹•æ…‹ä»£ç†æ˜¯é‡å°æ¥å£ç”Ÿæˆå­é¡ï¼Œæ¥å£ä¸­çš„æ–¹æ³•ä¸èƒ½ä½¿ç”¨finalä¾†ä¿®é£¾ï¼›CGLIbæ˜¯é‡å°ç›®æ¨™é¡ç”Ÿæˆå­é¡ï¼Œé¡æˆ–è€…æ–¹æ³•ä¸èƒ½ä½¿ç”¨finalä¾†ä¿®é£¾ã€‚</p><p><strong>Springåªæ”¯æŒæ–¹æ³•é€£æ¥é»ï¼Œä¸æ”¯æŒå±¬æ€§é€£æ¥é»ã€‚</strong></p><h1 class=line>Springä¸­çš„AOP</h1><h3 class=line>SpringAOPå¢å¼·é¡å‹</h3><p>AOPä¸æ˜¯ç”±Springå®šç¾©ï¼Œè€Œæ˜¯AOPè¯ç›Ÿçµ„ç¹”ä¾†å®šç¾©çš„ã€‚SpringæŒ‰ç…§é€šçŸ¥Adviceåœ¨ç›®æ¨™é¡æ–¹æ³•çš„é€£æ¥é»ä½ç½®ï¼Œå¯ä»¥åˆ†ç‚º5å€‹ä½ç½®ï¼šå‰ç½®é€šçŸ¥ï¼šorg.springframework.aop.MethodBeforeAdvice:åœ¨ç›®æ¨™æ–¹æ³•åŸ·è¡Œå‰å¯¦æ–½å¢å¼·ï¼›å¾Œç½®é€šçŸ¥ï¼šorg.springframework.aop.AfterReturningAdvice:åœ¨ç›®æ¨™æ–¹æ³•åŸ·è¡Œå¾Œå¯¦æ–½å¢å¼·ï¼›ç’°ç¹é€šçŸ¥ï¼šorg.aopalliance.intercept.MethodInterceptor:åœ¨ç›®æ¨™æ–¹æ³•åŸ·è¡Œå‰å¾Œå¯¦æ–½å¢å¼·ï¼›ç•°å¸¸æ‹‹å‡ºé€šçŸ¥ï¼šorg.springframework.aop.ThrowsAdvice:åœ¨æ–¹æ³•æ‹‹å‡ºç•°å¸¸å¾Œå¯¦æ–½å¢å¼·ï¼›å¼•ä»‹é€šçŸ¥ï¼šorg.springframework.aop.IntroductionInterceptor(ä¸ç ”ç©¶):åœ¨ç›®æ¨™é¡ä¸­æ·»åŠ ä¸€äº›æ–°çš„æ–¹æ³•å’Œå±¬æ€§ã€‚</p><h3 class=line>SpringAOPåˆ‡é¢é¡å‹</h3><p>Advisorï¼ˆSpringä¸­å‚³çµ±åˆ‡é¢ï¼‰å°±æ˜¯å°PointCutæ‡‰ç”¨Adviceã€‚ï¼ˆé€šå¸¸æ‰€èªªçš„Advisoræ˜¯æŒ‡åªæœ‰ä¸€å€‹Pointå’Œä¸€å€‹Adviceï¼Œè€ŒAspectæ˜¯å…·æœ‰å¤šå€‹åˆ‡é»å’Œå¤šå€‹é€šçŸ¥çš„çµ„åˆï¼‰ï¼›Advisor :ä»£è¡¨ä¸€èˆ¬åˆ‡é¢ï¼ŒAdviceæœ¬èº«å°±æ˜¯ä¸€å€‹åˆ‡é¢ï¼Œå°ç›®æ¨™é¡æ‰€æœ‰æ–¹æ³•é€²è¡Œæ””æˆª ï¼ˆæ²’æœ‰åˆ‡é»ï¼‰ï¼›PointcutAdvisor :ä»£è¡¨å…·æœ‰åˆ‡é»çš„åˆ‡é¢ï¼Œå¯ä»¥æŒ‡å®šæ””æˆªç›®æ¨™é¡å“ªäº›æ–¹æ³•ï¼›IntroductionAdvisor : ä»£è¡¨å¼•ä»‹åˆ‡é¢ï¼Œé‡å°å¼•ä»‹é€šçŸ¥è€Œä½¿ç”¨åˆ‡é¢ï¼ˆä¸è¦æ±‚æŒæ¡ï¼‰ã€‚</p><h1 class=line>SpringAOPçš„é–‹ç™¼</h1><h3 class=line>é‡å°æ‰€æœ‰æ–¹æ³•çš„å¢å¼·(ä¸å¸¶åˆ‡é»çš„åˆ‡é¢)</h3><p>æ­¤è™•æ¼”ç¤ºé‡å°æ‰€æœ‰æ–¹æ³•çš„å¢å¼·ä¹Ÿå°±æ˜¯ä¸å¸¶åˆ‡é»çš„åˆ‡é¢ï¼Œç›¸æ‡‰çš„æ“ä½œæ­¥é©Ÿå¦‚ä¸‹ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼šå°å…¥ç›¸æ‡‰çš„åŒ…ã€‚é¦–å…ˆåœ¨pom.xmlæ–‡ä»¶ä¸­å¼•å…¥spring-aopï¼Œspring-testå’Œcom.springsource.org.aopallianceï¼š</p><pre><code>&lt;dependency&gt;            &lt;groupId&gt;org.springframework&lt;/groupId&gt;            &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;            &lt;version&gt;4.2.4.RELEASE&lt;/version&gt;        &lt;/dependency&gt;        &lt;dependency&gt;            &lt;groupId&gt;aopalliance&lt;/groupId&gt;            &lt;artifactId&gt;aopalliance&lt;/artifactId&gt;            &lt;version&gt;1.0&lt;/version&gt;        &lt;/dependency&gt;        &lt;dependency&gt;            &lt;groupId&gt;org.springframework&lt;/groupId&gt;            &lt;artifactId&gt;spring-test&lt;/artifactId&gt;            &lt;version&gt;4.2.4.RELEASE&lt;/version&gt;&lt;/dependency&gt;</code></pre><p>ç¬¬äºŒæ­¥ï¼šç·¨å¯«è¢«ä»£ç†å°è±¡ã€‚æ–°å»ºcom.envy.aop.studentåŒ…ï¼Œæ¥è‘—åœ¨è£¡é¢æ–°å»ºæ¥å£StudentDao.javaæ–‡ä»¶ï¼Œè£¡é¢ä»£ç¢¼ç‚ºï¼š</p><pre><code>public interface StudentDao {    public void add();    public void update();}</code></pre><p>ä»¥åŠå®ƒçš„å¯¦ç¾é¡StudentDaoImpl.javaï¼š</p><pre><code>public class StudentDaoImpl implements StudentDao {    public void add() {        System.out.println("this is add method");    }    public void update() {        System.out.println("this is update method");    }}</code></pre><p>ç¬¬ä¸‰æ­¥ï¼Œç·¨å¯«å¢å¼·çš„ä»£ç¢¼ã€‚æ­¤è™•åƒ…åƒ…ä»¥å‰ç½®é€šçŸ¥ç‚ºä¾‹æ¼”ç¤ºå¦‚ä½•ç·¨å¯«å¢å¼·ä»£ç¢¼ï¼ˆå‰ç½®é€šçŸ¥ï¼šorg.springframework.aop.MethodBeforeAdvice:åœ¨ç›®æ¨™æ–¹æ³•åŸ·è¡Œå‰å¯¦æ–½å¢å¼·ï¼‰ã€‚æ–°å»ºMyBeforeAdvice.javaæ–‡ä»¶ï¼š</p><pre><code>public class MyBeforeAdvice implements MethodBeforeAdvice {    public void before(Method method, Object[] objects, Object o) throws Throwable {        System.out.println("å‰ç½®å¢å¼·çš„æ–¹æ³•");    }}</code></pre><p>ç¬¬å››æ­¥ï¼Œç”Ÿæˆä»£ç†(é…ç½®ç”Ÿæˆä»£ç†)ã€‚æ–°å»ºapplicationContext.xmlæ–‡ä»¶ï¼Œè£¡é¢çš„ä»£ç¢¼å¦‚ä¸‹ï¼š</p><pre><code>  &lt;!-- ä¸å¸¶æœ‰åˆ‡é»çš„åˆ‡é¢ --&gt;    &lt;!--  é…ç½®ç›®æ¨™é¡(ç›®æ¨™å°è±¡ï¼Œå³éœ€è¦çµ¦å“ªå€‹é¡é€²è¡Œå¢å¼·) --&gt;    &lt;bean id="studentDao" class="com.envy.aop.student.StudentDaoImpl"/&gt;    &lt;!-- å‰ç½®é€šçŸ¥é¡å‹ --&gt;    &lt;bean id="myBeforeAdvice" class="com.envy.aop.student.MyBeforeAdvice"/&gt;    &lt;!-- SpringAOPç”¢ç”Ÿä»£ç†å°è±¡ --&gt;    &lt;bean id="studentDaoProxy" class="org.springframework.aop.framework.ProxyFactoryBean"&gt;        &lt;!-- é…ç½®ç›®æ¨™é¡(ç›®æ¨™å°è±¡ï¼Œå³éœ€è¦çµ¦å“ªå€‹é¡é€²è¡Œå¢å¼·) --&gt;        &lt;property name="target" ref="studentDao"/&gt;        &lt;!-- å¯¦ç¾çš„æ¥å£ --&gt;        &lt;property name="proxyInterfaces" value="com.envy.aop.student.StudentDao"/&gt;        &lt;!-- æ¡ç”¨æ””æˆªçš„åç¨± --&gt;        &lt;property name="interceptorNames" value="myBeforeAdvice"/&gt;        &lt;!-- æ˜¯å¦å¼·åˆ¶ä½¿ç”¨CGLibï¼Œtrueæ˜¯ï¼Œfalseå‰‡æ˜¯JDK --&gt;        &lt;property name="optimize" value="true"/&gt;    &lt;/bean&gt;</code></pre><p>ç¬¬äº”æ­¥ï¼Œæ³¨å…¥æ¸¬è©¦ã€‚æ–°å»ºSpringAOPAdvisor.javaæ¸¬è©¦æ–‡ä»¶ï¼Œè£¡é¢çš„ä»£ç¢¼ç‚ºï¼š</p><pre><code>@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration("classpath:applicationContext.xml")public class SpringAOPAdvisor {//    @Resource(name="studentDao")  //é€™æ˜¯ä¸ä½¿ç”¨AOPä»£ç†å°è±¡    @Resource(name="studentDaoProxy")    private StudentDao studentDao;    @Test    public void testOne(){        studentDao.add();        studentDao.update();    }}</code></pre><p>é‹è¡Œçµæœï¼š</p><pre><code>å‰ç½®å¢å¼·çš„æ–¹æ³•this is add methodå‰ç½®å¢å¼·çš„æ–¹æ³•this is update method</code></pre><p>åœ¨ç¬¬å››æ­¥ï¼Œç”Ÿæˆä»£ç†å°è±¡æ™‚æˆ‘å€‘åœ¨applicationContext.xmlæ–‡ä»¶ä¸­é…ç½®äº†ä¸€äº›å±¬æ€§ã€‚å…¶å¯¦å°±æ˜¯ç”Ÿæˆä»£ç†SpringåŸºæ–¼ProxyFactoryBeané¡ï¼Œåº•å±¤è‡ªå‹•é¸æ“‡ä½¿ç”¨JDKçš„å‹•æ…‹ä»£ç†é‚„æ˜¯CGLIBçš„ä»£ç†ã€‚ä¸‹é¢æ˜¯å…¶ä¸­çš„å¹¾å€‹å±¬æ€§ä»‹ç´¹:target :ä»£ç†çš„ç›®æ¨™å°è±¡ï¼›proxyInterfaces :ä»£ç†è¦å¯¦ç¾çš„æ¥å£ï¼Œå¦‚æœå¤šå€‹æ¥å£å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ ¼å¼è³¦å€¼:</p><pre><code>&lt;list&gt;ã€€ã€€&lt;value&gt;&lt;/value&gt;ã€€ã€€ã€€ã€€....&lt;/list&gt;</code></pre><p>proxyTargetClass :æ˜¯å¦å°é¡ä»£ç†è€Œä¸æ˜¯æ¥å£ï¼Œè¨­ç½®ç‚ºtrueæ™‚ï¼Œä½¿ç”¨CGLibä»£ç†ï¼›interceptorNames :éœ€è¦ç¹”å…¥ç›®æ¨™çš„Adviceï¼›singleton :è¿”å›ä»£ç†æ˜¯å¦ç‚ºå–®å¯¦ä¾‹ï¼Œé»˜èªç‚ºå–®ä¾‹ã€‚optimize :ç•¶è¨­ç½®ç‚ºtrueæ™‚ï¼Œå¼·åˆ¶ä½¿ç”¨CGLibã€‚</p><p><br></p><div class=pgc-img><img alt="Springå­¸ç¿’ï¼ˆ4ï¼‰ï¼šSpring AOP" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4d11fe2dabf84b89a74231a746dfe34d><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Spring</a></li><li><a>å­¸ç¿’</a></li><li><a>AOP</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/b91a8349.html alt="Spring AOPç°¡ä»‹èˆ‡åº•å±¤å¯¦ç¾æ©Ÿåˆ¶â€”â€”å‹•æ…‹ä»£ç†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/413780d1-cf47-4038-9471-b686d97aa99b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b91a8349.html title="Spring AOPç°¡ä»‹èˆ‡åº•å±¤å¯¦ç¾æ©Ÿåˆ¶â€”â€”å‹•æ…‹ä»£ç†">Spring AOPç°¡ä»‹èˆ‡åº•å±¤å¯¦ç¾æ©Ÿåˆ¶â€”â€”å‹•æ…‹ä»£ç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7b564e1e.html alt="Spring bootå­¸ç¿’ï¼ˆå…­ï¼‰Spring bootå¯¦ç¾AOPè¨˜éŒ„æ“ä½œæ—¥èªŒ" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/6824f504d2264a748492cd7ceb6732ba style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7b564e1e.html title="Spring bootå­¸ç¿’ï¼ˆå…­ï¼‰Spring bootå¯¦ç¾AOPè¨˜éŒ„æ“ä½œæ—¥èªŒ">Spring bootå­¸ç¿’ï¼ˆå…­ï¼‰Spring bootå¯¦ç¾AOPè¨˜éŒ„æ“ä½œæ—¥èªŒ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b5dd97d4.html alt=Springæ¡†æ¶AOPæŠ€è¡“ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/760bf32faca443cb8e28ed0b9bc20205 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b5dd97d4.html title=Springæ¡†æ¶AOPæŠ€è¡“>Springæ¡†æ¶AOPæŠ€è¡“</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/60d27d99.html alt=Springé¢å‘åˆ‡é¢ç·¨ç¨‹AOPçš„åˆæ­¥ç­è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6eb76749eacf41f1ac8d6bb660ae18ab style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/60d27d99.html title=Springé¢å‘åˆ‡é¢ç·¨ç¨‹AOPçš„åˆæ­¥ç­è§£>Springé¢å‘åˆ‡é¢ç·¨ç¨‹AOPçš„åˆæ­¥ç­è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b949fbad.html alt=å°å¯¦ä¾‹ç†è§£Springä¸­çš„AOP----é¢å‘åˆ‡é¢ç·¨ç¨‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/35942664cec244f88d6a0f7b1e7067cc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b949fbad.html title=å°å¯¦ä¾‹ç†è§£Springä¸­çš„AOP----é¢å‘åˆ‡é¢ç·¨ç¨‹>å°å¯¦ä¾‹ç†è§£Springä¸­çš„AOP----é¢å‘åˆ‡é¢ç·¨ç¨‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2798be0b.html alt="Spring AOP é¢å‘åˆ‡é¢ç·¨ç¨‹éœ€è¦çŸ¥é“çš„äº‹" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/63832e5a-4ec8-451b-87cf-c6295ac2adf5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2798be0b.html title="Spring AOP é¢å‘åˆ‡é¢ç·¨ç¨‹éœ€è¦çŸ¥é“çš„äº‹">Spring AOP é¢å‘åˆ‡é¢ç·¨ç¨‹éœ€è¦çŸ¥é“çš„äº‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fcef4925.html alt="Spring AOPï¼šSpringçš„é¢å‘åˆ‡é¢ï¼Œæä¾›AOPï¼ˆé¢å‘åˆ‡é¢ç·¨ç¨‹ï¼‰çš„å¯¦ç¾" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fcef4925.html title="Spring AOPï¼šSpringçš„é¢å‘åˆ‡é¢ï¼Œæä¾›AOPï¼ˆé¢å‘åˆ‡é¢ç·¨ç¨‹ï¼‰çš„å¯¦ç¾">Spring AOPï¼šSpringçš„é¢å‘åˆ‡é¢ï¼Œæä¾›AOPï¼ˆé¢å‘åˆ‡é¢ç·¨ç¨‹ï¼‰çš„å¯¦ç¾</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/af398a38.html alt=Springâ€”é¢å‘åˆ‡é¢ç·¨ç¨‹ï¼ˆAOPï¼‰è©³è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/3ad8b3ec-d7c5-4b89-9b46-e473a4f5d570 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/af398a38.html title=Springâ€”é¢å‘åˆ‡é¢ç·¨ç¨‹ï¼ˆAOPï¼‰è©³è§£>Springâ€”é¢å‘åˆ‡é¢ç·¨ç¨‹ï¼ˆAOPï¼‰è©³è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/90a3b194.html alt="Springï¼šAOP é¢å‘åˆ‡é¢ç·¨ç¨‹" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/2e916acf35c540c59694eae279114599 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/90a3b194.html title="Springï¼šAOP é¢å‘åˆ‡é¢ç·¨ç¨‹">Springï¼šAOP é¢å‘åˆ‡é¢ç·¨ç¨‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c98c28c3.html alt=ä½¿ç”¨è¨»è§£æ–¹å¼é…ç½®Springä¸­çš„é¢å‘åˆ‡é¢ç·¨ç¨‹AOP class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c98c28c3.html title=ä½¿ç”¨è¨»è§£æ–¹å¼é…ç½®Springä¸­çš„é¢å‘åˆ‡é¢ç·¨ç¨‹AOP>ä½¿ç”¨è¨»è§£æ–¹å¼é…ç½®Springä¸­çš„é¢å‘åˆ‡é¢ç·¨ç¨‹AOP</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0ef7083e.html alt="æº«æ•…çŸ¥æ–°â€”â€”Spring AOPï¼ˆä¸€ï¼‰" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0ef7083e.html title="æº«æ•…çŸ¥æ–°â€”â€”Spring AOPï¼ˆä¸€ï¼‰">æº«æ•…çŸ¥æ–°â€”â€”Spring AOPï¼ˆä¸€ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/430ad617.html alt=ç†è§£Springï¼šAOPçš„åŸç†åŠæ‰‹å‹•å¯¦ç¾ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8435d8c955b34ce68d6e3765409ff14f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/430ad617.html title=ç†è§£Springï¼šAOPçš„åŸç†åŠæ‰‹å‹•å¯¦ç¾>ç†è§£Springï¼šAOPçš„åŸç†åŠæ‰‹å‹•å¯¦ç¾</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e0013439.html alt="é—œæ–¼Spring AOPçš„éˆé­‚åå•" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f76928765e9444fd8b608eab1ae51b90 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e0013439.html title="é—œæ–¼Spring AOPçš„éˆé­‚åå•">é—œæ–¼Spring AOPçš„éˆé­‚åå•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/55b5b18.html alt=Springå­¸ç¿’ç¸½çµï¼ˆ3ï¼‰â€”â€”Springé…ç½®æ–‡ä»¶è©³è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/43600001bb8d069efbc5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/55b5b18.html title=Springå­¸ç¿’ç¸½çµï¼ˆ3ï¼‰â€”â€”Springé…ç½®æ–‡ä»¶è©³è§£>Springå­¸ç¿’ç¸½çµï¼ˆ3ï¼‰â€”â€”Springé…ç½®æ–‡ä»¶è©³è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dc2af9c9.html alt=æ©Ÿå™¨å­¸ç¿’ç­†è¨˜(ä¸ƒ)â€”â€”åˆè­˜é‚è¼¯è¿´æ­¸ã€ä¸åŒæ–¹æ³•æ¨å°æ¢¯åº¦å…¬å¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/13adbab9c7f94c7fa81d49a98861b051 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dc2af9c9.html title=æ©Ÿå™¨å­¸ç¿’ç­†è¨˜(ä¸ƒ)â€”â€”åˆè­˜é‚è¼¯è¿´æ­¸ã€ä¸åŒæ–¹æ³•æ¨å°æ¢¯åº¦å…¬å¼>æ©Ÿå™¨å­¸ç¿’ç­†è¨˜(ä¸ƒ)â€”â€”åˆè­˜é‚è¼¯è¿´æ­¸ã€ä¸åŒæ–¹æ³•æ¨å°æ¢¯åº¦å…¬å¼</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>