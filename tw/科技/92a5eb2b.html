<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼ | æå®¢å¿«è¨Š</title><meta property="og:title" content="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/02d9481e13424aa88f6ca7b8b06bc29a"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/92a5eb2b.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/92a5eb2b.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/92a5eb2b.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/92a5eb2b.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/92a5eb2b.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/92a5eb2b.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/92a5eb2b.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/92a5eb2b.html><meta property="article:published_time" content="2020-11-14T20:59:18+08:00"><meta property="article:modified_time" content="2020-11-14T20:59:18+08:00"><meta name=Keywords content><meta name=description content="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/92a5eb2b.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>1ï¼Œæ¦‚è¿°</h1><p>è¦æƒ³ç†è§£springçš„äº‹ä»¶æ©Ÿåˆ¶ï¼Œæˆ‘è¦ºå¾—é¦–å…ˆè‡ªå·±å‹•æ‰‹å»æ“¼ä¸€å¥—ç°¡å–®çš„è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹demoé‚„æ˜¯éå¸¸æœ‰å¿…è¦æ»´ï¼Œå› ç‚ºé€™æ¨£æœ‰åŠ©æ–¼ç†è§£springäº‹ä»¶æ©Ÿåˆ¶ã€‚ç•¶ç„¶ï¼Œé€™è£¡ä¹Ÿæ˜¯æ¨¡ä»¿springçš„äº‹ä»¶æ©Ÿåˆ¶çš„ä»£ç¢¼ï¼Œä¸éä¸‹é¢çœ‹ä»£ç¢¼å¯¦ç¾æ™‚å¯ä»¥å…ˆæ‹‹é–‹springçš„äº‹ä»¶æ©Ÿåˆ¶ç›¸é—œä»£ç¢¼ï¼Œå°‡æ³¨æ„åŠ›é›†ä¸­åˆ°é€™å€‹ç°¡å–®demoä¸Šå³å¯ã€‚</p><p>åœ¨çœ‹é€™å€‹è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹æ™‚ï¼Œé¦–å…ˆè¦ç†Ÿæ‚‰è§€å¯Ÿè€…è¨­è¨ˆæ¨¡å¼ï¼Œå› ç‚ºäº‹ä»¶é©…å‹•ç·¨ç¨‹å¯ä»¥èªªæ˜¯è§€å¯Ÿè€…ï¼ˆç™¼ä½ˆè¨‚é–±ï¼‰æ¨¡å¼çš„å…·é«”å¯¦ç¾ã€‚</p><h1 class=pgc-h-arrow-right>2ï¼Œè‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹</h1><p>å› ç‚ºé€™ç¯‡æ–‡ç« æ˜¯springäº‹ä»¶æ©Ÿåˆ¶çš„å‰ç½®æ–‡ç« ï¼Œå› æ­¤é€™è£¡è‡ªå®šç¾©å¯¦ç¾ä¸€å€‹æ¨¡æ“¬å®¹å™¨ï¼ˆå¯ä»¥ç†è§£ç‚ºspringå®¹å™¨ï¼Œservltetå®¹å™¨ç­‰ï¼‰çš„ç”Ÿå‘½é€±æœŸäº‹ä»¶çš„ç°¡å–®demoã€‚</p><h2 class=pgc-h-arrow-right>2.1 äº‹ä»¶</h2><p>å…ˆä¾†çœ‹ä¸€ä¸‹äº‹ä»¶çš„æ•´é«”æ¶æ§‹åœ–ï¼Œè®“å¤§å®¶å…ˆæœ‰å°äº‹ä»¶æœ‰ä¸€å€‹æ•´é«”çš„èªè­˜ï¼Œå¦‚ä¸‹åœ–ï¼š</p><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/02d9481e13424aa88f6ca7b8b06bc29a><p class=pgc-img-caption></p></div><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/008d494effab450898b3befbbb0968ae><p class=pgc-img-caption></p></div><p><strong>1ï¼ŒEventæ¥å£</strong></p><p>é¢å‘æ¥å£ç·¨ç¨‹ï¼Œé¦–å…ˆå…ˆå®šç¾©ä¸€å€‹Eventæ¥å£ï¼Œè©²æ¥å£æ²’æœ‰ä»»ä½•æ–¹æ³•ï¼Œå¯ä»¥èªªæ˜¯äº‹ä»¶çš„æ¨™èªŒæ¥å£ã€‚</p><pre><code>public interface Event extends Serializable {}è¤‡è£½ä»£ç¢¼</code></pre><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/008d494effab450898b3befbbb0968ae><p class=pgc-img-caption></p></div><p><strong>2ï¼ŒAbstractContextEvent</strong></p><p>AbstractContextEventæ˜¯å®¹å™¨äº‹ä»¶çš„åŸºæœ¬æŠ½è±¡é¡ï¼Œå› ç‚ºäº‹ä»¶ä¹Ÿå¯ä»¥æ”œå¸¶æ•¸æ“šï¼Œå› æ­¤é€™è£¡å®šç¾©äº†ä¸€å€‹timestampå±¬æ€§ï¼Œç”¨ä¾†è¨˜éŒ„äº‹ä»¶çš„ç™¼ç”Ÿæ™‚é–“ã€‚</p><pre><code>public class AbstractContextEvent implements Event {    private static final long serialVersionUID = -6159391039546783871L;    private final long timestamp = System.currentTimeMillis();    public final long getTimestamp() {        return this.timestamp;    }}è¤‡è£½ä»£ç¢¼</code></pre><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/008d494effab450898b3befbbb0968ae><p class=pgc-img-caption></p></div><p><strong>3ï¼ŒContextStartEvent</strong></p><p>ContextStartEventäº‹ä»¶æ˜¯AbstractContextEventå…·é«”å¯¦ç¾é¡ï¼Œå®¹å™¨é–‹å§‹å•Ÿå‹•æ™‚è§¸ç™¼ï¼Œé€™è£¡ç‚ºäº†demoç°¡å–®ï¼Œé€™è£¡ä¸å†å®šç¾©ä»»ä½•äº‹ä»¶é‚è¼¯ï¼Œåªæ˜¯ä»£è¡¨å®¹å™¨å•Ÿå‹•æ™‚çš„ä¸€å€‹æ¨™èªŒäº‹ä»¶é¡ã€‚</p><pre><code>public class ContextStartEvent extends AbstractContextEvent {}è¤‡è£½ä»£ç¢¼</code></pre><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/008d494effab450898b3befbbb0968ae><p class=pgc-img-caption></p></div><p><strong>4ï¼ŒContextRunningEvent</strong></p><p>ContextRunningEventäº‹ä»¶æ˜¯AbstractContextEventå…·é«”å¯¦ç¾é¡ï¼Œå®¹å™¨å•Ÿå‹•å¾Œæ™‚è§¸ç™¼ï¼Œé€™è£¡ç‚ºäº†demoç°¡å–®ï¼Œé€™è£¡ä¸å†å®šç¾©ä»»ä½•äº‹ä»¶é‚è¼¯ï¼Œåªæ˜¯ä»£è¡¨å®¹å™¨å•Ÿå‹•é‹è¡Œæ™‚æ™‚çš„ä¸€å€‹æ¨™èªŒäº‹ä»¶é¡ã€‚</p><pre><code>public class ContextRunningEvent extends AbstractContextEvent {}è¤‡è£½ä»£ç¢¼</code></pre><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/008d494effab450898b3befbbb0968ae><p class=pgc-img-caption></p></div><p><strong>5ï¼ŒContextDestroyEvent</strong></p><p>ContextDestroyEventäº‹ä»¶æ˜¯AbstractContextEventå…·é«”å¯¦ç¾é¡ï¼Œå®¹å™¨éŠ·ç‡¬æ™‚è§¸ç™¼ï¼Œé€™è£¡ç‚ºäº†demoç°¡å–®ï¼Œé€™è£¡ä¸å†å®šç¾©ä»»ä½•äº‹ä»¶é‚è¼¯ï¼Œåªæ˜¯ä»£è¡¨å®¹å™¨éŠ·ç‡¬æ™‚çš„ä¸€å€‹æ¨™èªŒäº‹ä»¶é¡ã€‚</p><pre><code>public class ContextDestroyEvent extends AbstractContextEvent {}è¤‡è£½ä»£ç¢¼</code></pre><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/008d494effab450898b3befbbb0968ae><p class=pgc-img-caption></p></div><h2 class=pgc-h-arrow-right>2.2 äº‹ä»¶ç›£è½å™¨</h2><p>å…ˆä¾†çœ‹ä¸€ä¸‹äº‹ä»¶ç›£è½å™¨çš„æ•´é«”æ¶æ§‹åœ–ï¼Œè®“å¤§å®¶å…ˆæœ‰å°äº‹ä»¶ç›£è½å™¨æœ‰ä¸€å€‹æ•´é«”çš„èªè­˜ï¼Œå¦‚ä¸‹åœ–ï¼š</p><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ed47b080cfb64f6cb38e001571597f85><p class=pgc-img-caption></p></div><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/008d494effab450898b3befbbb0968ae><p class=pgc-img-caption></p></div><p>â€‹</p><p>å…¶ä¸­EventListeneræ˜¯æ‰€æœ‰äº‹ä»¶ç›£è½å™¨çš„åŸºé¡æ¥å£ï¼Œï¼Œæ˜¯äº‹ä»¶ç›£è½å™¨çš„æ¨™èªŒé¡æ¥å£ï¼Œè¢«æ‰€æœ‰å…·é«”çš„äº‹ä»¶ç›£è½å™¨å¯¦ç¾ã€‚ç„¶å¾ŒContextListeneræ¥å£æ˜¯å®¹å™¨äº‹ä»¶ç›£è½å™¨æ¥å£ï¼Œç¹¼æ‰¿äº†EventListenerï¼Œä¸»è¦å®šç¾©ç­å¦‚ä¸‹äº‹ä»¶ç›£è½æ–¹æ³•ï¼š</p><pre><code> void onApplicationEvent(T event);è¤‡è£½ä»£ç¢¼</code></pre><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/008d494effab450898b3befbbb0968ae><p class=pgc-img-caption></p></div><p>ç„¶å¾ŒContextListeneræ¥å£è¢«ä¸‰å€‹å…·é«”çš„å®¹å™¨ç”Ÿå‘½é€±æœŸäº‹ä»¶ç›£è½å™¨å¯¦ç¾ï¼Œåˆ†åˆ¥æ˜¯ContextStartEventListenerï¼ˆç›£è½å®¹å™¨å•Ÿå‹•æ™‚çš„ContextStartEventï¼‰ï¼ŒContextRunningEventListenerï¼ˆç›£è½å®¹å™¨å•Ÿå‹•å¾Œé‹è¡Œæ™‚çš„ContextRunningEventï¼‰å’ŒContextDestroyEventListenerï¼ˆç›£è½å®¹å™¨éŠ·ç‡¬æ™‚çš„ContextDestroyEventï¼‰ã€‚</p><p>ä¸‹é¢çœ‹å…·é«”çš„ä»£ç¢¼å¯¦ç¾ï¼š</p><pre><code>public interface EventListener {}public interface ContextListener&lt;T extends AbstractContextEvent&gt; extends EventListener {    /**     * Handle an application event.     * @param event the event to respond to     */    void onApplicationEvent(T event);}public class ContextStartEventListener implements ContextListener&lt;AbstractContextEvent&gt; {    /**     * Handle an application event.     *     * @param event the event to respond to     */    public void onApplicationEvent(AbstractContextEvent event) {        if (event instanceof ContextStartEvent) {            System.out.println("å®¹å™¨å•Ÿå‹•ã€‚ã€‚ã€‚ï¼Œå•Ÿå‹•æ™‚é–“ç‚ºï¼š" + event.getTimestamp());        }    }}public class ContextRunningEventListener implements ContextListener&lt;AbstractContextEvent&gt; {    /**     * Handle an application event.     *     * @param event the event to respond to     */    public void onApplicationEvent(AbstractContextEvent event) {        if (event instanceof ContextRunningEvent) {            System.out.println("å®¹å™¨é–‹å§‹é‹è¡Œã€‚ã€‚ã€‚");            try {                Thread.sleep(3000);                System.out.println("å®¹å™¨é‹è¡ŒçµæŸã€‚ã€‚ã€‚");            } catch (InterruptedException e) {                e.printStackTrace();            }        }    }}public class ContextDestroyEventListener implements ContextListener&lt;AbstractContextEvent&gt; {    /**     * Handle an application event.     *     * @param event the event to respond to     */    public void onApplicationEvent(AbstractContextEvent event) {        if (event instanceof ContextDestroyEvent) {            System.out.println("å®¹å™¨éŠ·ç‡¬ã€‚ã€‚ã€‚ï¼ŒéŠ·ç‡¬æ™‚é–“ç‚ºï¼š" + event.getTimestamp());        }    }}è¤‡è£½ä»£ç¢¼</code></pre><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/008d494effab450898b3befbbb0968ae><p class=pgc-img-caption></p></div><h2 class=pgc-h-arrow-right>2.3 äº‹ä»¶ç™¼ä½ˆå™¨</h2><p>å…ˆçœ‹ä¸‹é¡åœ–ï¼š</p><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/88bf4e5830ff419bbdf2a92566abdbef><p class=pgc-img-caption></p></div><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/008d494effab450898b3befbbb0968ae><p class=pgc-img-caption></p></div><p>â€‹</p><p>ApplicationEventMulticasteræ˜¯ç™¼ä½ˆäº‹ä»¶çš„çˆ¶é¡æ¥å£ï¼Œä¸»è¦å®šç¾©äº†å¢åŠ ï¼Œåˆªé™¤ï¼Œç²å–ç­‰æ“ä½œäº‹ä»¶ç›£è½å™¨çš„çš„æ–¹æ³•æ¥å£ï¼Œæ­¤å¤–ï¼Œé‚„å®šç¾©äº†ä¸€å€‹ç™¼ä½ˆäº‹ä»¶çš„æ–¹æ³•ã€‚</p><p>SimpleApplicationEventMulticasteræ˜¯ApplicationEventMulticasteräº‹ä»¶ç™¼ä½ˆå™¨æ¥å£çš„é»˜èªå¯¦ç¾é¡ï¼Œä¸»è¦æ‰¿æ“”ç™¼ä½ˆäº‹ä»¶çš„åŠŸèƒ½ã€‚å…¶å…§éƒ¨ç¶­è­·äº†ä¸€å€‹äº‹ä»¶ç›£è½å™¨åˆ—è¡¨contextListenersï¼Œç•¶ç™¼ä½ˆäº‹ä»¶æ™‚æœƒéæ­·é€™äº›åˆ—è¡¨ï¼Œç„¶å¾Œå†å‘æ¯å€‹ç›£è½å™¨ç™¼ä½ˆäº‹ä»¶ï¼Œé€šéè¨­ç½®asyncå±¬æ€§ä¾†æ±ºå®šåŒæ­¥å»£æ’­äº‹ä»¶é‚„æ˜¯ç•°æ­¥å»£æ’­äº‹ä»¶ã€‚</p><p>ä¸‹é¢çœ‹çœ‹å¯¦ç¾ä»£ç¢¼ï¼š</p><pre><code>public interface ApplicationEventMulticaster {    void addContextListener(ContextListener&lt;?&gt; listener);    void removeContextListener(ContextListener&lt;?&gt; listener);    void removeAllListeners();    void multicastEvent(AbstractContextEvent event);}public class SimpleApplicationEventMulticaster implements ApplicationEventMulticaster {    // æ˜¯å¦ç•°æ­¥ç™¼ä½ˆäº‹ä»¶    private boolean async = false;    // ç·šç¨‹æ±     private Executor taskExecutor = new ThreadPoolExecutor(5, 5, 0, TimeUnit.SECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());    // äº‹ä»¶ç›£è½å™¨åˆ—è¡¨    private List&lt;ContextListener&lt;?&gt;&gt; contextListeners = new ArrayList&lt;ContextListener&lt;?&gt;&gt;();        public void addContextListener(ContextListener&lt;?&gt; listener) {        contextListeners.add(listener);    }    public void removeContextListener(ContextListener&lt;?&gt; listener) {        contextListeners.remove(listener);    }    public void removeAllListeners() {        contextListeners.clear();    }    public void multicastEvent(AbstractContextEvent event) {        doMulticastEvent(contextListeners, event);    }    private void doMulticastEvent(List&lt;ContextListener&lt;?&gt;&gt; contextListeners, AbstractContextEvent event) {        for (ContextListener contextListener : contextListeners) {            // ç•°æ­¥å»£æ’­äº‹ä»¶            if (async) {                taskExecutor.execute(() -&gt; invokeListener(contextListener, event));                // new Thread(() -&gt; invokeListener(contextListener, event)).start();            // åŒæ­¥ç™¼ä½ˆäº‹ä»¶ï¼Œé˜»å¡çš„æ–¹å¼            } else {                invokeListener(contextListener, event);            }        }    }    private void invokeListener(ContextListener contextListener, AbstractContextEvent event) {        contextListener.onApplicationEvent(event);    }    public void setAsync(boolean async) {        this.async = async;    }}è¤‡è£½ä»£ç¢¼</code></pre><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/008d494effab450898b3befbbb0968ae><p class=pgc-img-caption></p></div><h2 class=pgc-h-arrow-right>2.4 æ¸¬è©¦è‡ªå®šç¾©çš„å®¹å™¨ç”Ÿå‘½é€±æœŸäº‹ä»¶</h2><p>é‚£éº¼ç›´æ¥ä¸Šæ¸¬è©¦ä»£ç¢¼ï¼Œä¸‹é¢åªæ¼”ç¤ºåŒæ­¥ç™¼ä½ˆäº‹ä»¶çš„åŠŸèƒ½ï¼š</p><pre><code>public class MockSpringEventTest {    @Test    public void testContextLifecycleEventInSync() {        // æ–°å»ºSimpleApplicationEventMulticasterå°è±¡ï¼Œä¸¦æ·»åŠ å®¹å™¨ç”Ÿå‘½é€±æœŸç›£è½å™¨        ApplicationEventMulticaster eventMulticaster = new SimpleApplicationEventMulticaster();        eventMulticaster.addContextListener(new ContextStartEventListener());        eventMulticaster.addContextListener(new ContextRunningEventListener());        eventMulticaster.addContextListener(new ContextDestroyEventListener());        // ç™¼å°„å®¹å™¨å•Ÿå‹•äº‹ä»¶ContextStartEvent        eventMulticaster.multicastEvent(new ContextStartEvent());        // ç™¼å°„å®¹å™¨æ­£åœ¨é‹è¡Œäº‹ä»¶ContextRunningEvent        eventMulticaster.multicastEvent(new ContextRunningEvent());        // ç™¼å°„å®¹å™¨æ­£åœ¨é‹è¡Œäº‹ä»¶ContextDestroyEvent        eventMulticaster.multicastEvent(new ContextDestroyEvent());    }    @Test    public void testContextLifecycleEventInAsync() throws InterruptedException {        // æ–°å»ºSimpleApplicationEventMulticasterå°è±¡ï¼Œä¸¦æ·»åŠ å®¹å™¨ç”Ÿå‘½é€±æœŸç›£è½å™¨        ApplicationEventMulticaster eventMulticaster = new SimpleApplicationEventMulticaster();        eventMulticaster.addContextListener(new ContextStartEventListener());        eventMulticaster.addContextListener(new ContextRunningEventListener());        eventMulticaster.addContextListener(new ContextDestroyEventListener());        ((SimpleApplicationEventMulticaster) eventMulticaster).setAsync(true);        // ç™¼å°„å®¹å™¨å•Ÿå‹•äº‹ä»¶ContextStartEvent        eventMulticaster.multicastEvent(new ContextStartEvent());        // ç™¼å°„å®¹å™¨æ­£åœ¨é‹è¡Œäº‹ä»¶ContextRunningEvent        eventMulticaster.multicastEvent(new ContextRunningEvent());        // ç™¼å°„å®¹å™¨æ­£åœ¨é‹è¡Œäº‹ä»¶ContextDestroyEvent        eventMulticaster.multicastEvent(new ContextDestroyEvent());        // é€™è£¡æ²’æ˜ç™½åœ¨æ²’æœ‰ç”¨CountDownLatchçš„æƒ…æ³ä¸‹ç‚ºä½•ä¸»ç·šç¨‹é€€å‡ºï¼Œéå¾Œè‡ºç·šç¨‹çš„å­ç·šç¨‹ä¹Ÿæœƒé€€å‡ºï¼Ÿï¼Ÿï¼Ÿç‚ºäº†æ¸¬è©¦ï¼Œæ‰€æœ‰å…ˆç”¨CountDownLatché–ä½mainç·šç¨‹å…ˆ        // ç¶“éæ¸¬è©¦ï¼ŒåŸä¾†æ˜¯å› ç‚ºç”¨äº†junitçš„æ–¹æ³•ï¼Œtestæ–¹æ³•ç·šç¨‹é€€å‡ºå¾Œï¼Œtestæ–¹æ³•ç·šç¨‹ç”¢ç”Ÿçš„éå¾Œè‡ºç·šç¨‹ä¹Ÿéš¨ä¹‹é€€å‡ºï¼Œè€Œä¸‹é¢çš„mainæ–¹æ³•å•Ÿå‹•çš„éå¾Œè‡ºç·šç¨‹å‰‡ä¸æœƒ        // TODO é€™æ˜¯ç‚ºä»€éº¼å‘¢ï¼Ÿï¼Ÿï¼Ÿé›£é“æ˜¯Aå­ç·šç¨‹ï¼ˆémainç·šç¨‹ï¼‰å•Ÿå‹•çš„Bå­ç·šç¨‹æœƒéš¨è‘—Aå­ç·šç¨‹é€€å‡ºè€Œé€€å‡ºï¼Ÿé‚„æ²’é©—è­‰        CountDownLatch countDownLatch = new CountDownLatch(1);        countDownLatch.await();    }    public static void main(String[] args) throws InterruptedException {        // æ–°å»ºSimpleApplicationEventMulticasterå°è±¡ï¼Œä¸¦æ·»åŠ å®¹å™¨ç”Ÿå‘½é€±æœŸç›£è½å™¨        ApplicationEventMulticaster eventMulticaster = new SimpleApplicationEventMulticaster();        eventMulticaster.addContextListener(new ContextStartEventListener());        eventMulticaster.addContextListener(new ContextRunningEventListener());        eventMulticaster.addContextListener(new ContextDestroyEventListener());        ((SimpleApplicationEventMulticaster) eventMulticaster).setAsync(true);        // ç™¼å°„å®¹å™¨å•Ÿå‹•äº‹ä»¶ContextStartEvent        eventMulticaster.multicastEvent(new ContextStartEvent());        // ç™¼å°„å®¹å™¨æ­£åœ¨é‹è¡Œäº‹ä»¶ContextRunningEvent        eventMulticaster.multicastEvent(new ContextRunningEvent());        // ç™¼å°„å®¹å™¨æ­£åœ¨é‹è¡Œäº‹ä»¶ContextDestroyEvent        eventMulticaster.multicastEvent(new ContextDestroyEvent());    }}è¤‡è£½ä»£ç¢¼</code></pre><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/008d494effab450898b3befbbb0968ae><p class=pgc-img-caption></p></div><p>é€šéé‹è¡Œæ¸¬è©¦æ–¹æ³•testContextLifecycleEventInSync()ï¼Œé‹è¡Œçµæœå¦‚ä¸‹æˆªåœ–ï¼š</p><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e0534434b2284016b2e9aecce621c524><p class=pgc-img-caption></p></div><div class=pgc-img><img alt="æ¨¡ä»¿Springäº‹ä»¶æ©Ÿåˆ¶å¯¦ç¾è‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹ Springæºç¢¼" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/008d494effab450898b3befbbb0968ae><p class=pgc-img-caption></p></div><p>â€‹</p><h1 class=pgc-h-arrow-right>3ï¼Œçµèª</h1><p>å¥½äº†ï¼Œè‡ªå®šç¾©äº‹ä»¶é©…å‹•ç·¨ç¨‹çš„ç°¡å–®demoå°±å·²ç¶“å¯¦ç¾äº†ã€‚</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Spring</a></li><li><a>æ©Ÿåˆ¶</a></li><li><a>å¯¦ç¾</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/fb2bc471.html alt="ã€Œè­¯ã€ Spring çš„åˆ†ä½ˆå¼äº‹å‹™å¯¦ç¾â€”ä½¿ç”¨å’Œä¸ä½¿ç”¨ XAâ€”ç¬¬äºŒéƒ¨åˆ†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fb2bc471.html title="ã€Œè­¯ã€ Spring çš„åˆ†ä½ˆå¼äº‹å‹™å¯¦ç¾â€”ä½¿ç”¨å’Œä¸ä½¿ç”¨ XAâ€”ç¬¬äºŒéƒ¨åˆ†">ã€Œè­¯ã€ Spring çš„åˆ†ä½ˆå¼äº‹å‹™å¯¦ç¾â€”ä½¿ç”¨å’Œä¸ä½¿ç”¨ XAâ€”ç¬¬äºŒéƒ¨åˆ†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fe46907e.html alt="Spring Bootå¯¦ç¾xmlæ•¸æ“šæ ¼å¼å‚³è¼¸" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/0d7162206c2444189f24fc0f5fcd469e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fe46907e.html title="Spring Bootå¯¦ç¾xmlæ•¸æ“šæ ¼å¼å‚³è¼¸">Spring Bootå¯¦ç¾xmlæ•¸æ“šæ ¼å¼å‚³è¼¸</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/aee2cfd1.html alt=Springäº‹ä»¶ç›£è½æ©Ÿåˆ¶åŸç† class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/217264042932461b810f06a25805a819 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/aee2cfd1.html title=Springäº‹ä»¶ç›£è½æ©Ÿåˆ¶åŸç†>Springäº‹ä»¶ç›£è½æ©Ÿåˆ¶åŸç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d17e55d6.html alt=ä¹¾è²¨ï½œSpringæ ¸å¿ƒæ©Ÿåˆ¶ä¹‹ä¾è³´æ³¨å…¥ï¼ˆå»ºè­°æ”¶è—ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/51887a9e50dc4be4af17b22398f6a901 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d17e55d6.html title=ä¹¾è²¨ï½œSpringæ ¸å¿ƒæ©Ÿåˆ¶ä¹‹ä¾è³´æ³¨å…¥ï¼ˆå»ºè­°æ”¶è—ï¼‰>ä¹¾è²¨ï½œSpringæ ¸å¿ƒæ©Ÿåˆ¶ä¹‹ä¾è³´æ³¨å…¥ï¼ˆå»ºè­°æ”¶è—ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ced3f3d.html alt=Springçš„å­æ¡†æ¶Â SpringMVCï¼Œå¦‚ä½•å¯¦ç¾æ‰‹å‹•æ§åˆ¶äº‹å‹™æäº¤ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b61e2ad631e44fa28a481ade5746a032 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ced3f3d.html title=Springçš„å­æ¡†æ¶Â SpringMVCï¼Œå¦‚ä½•å¯¦ç¾æ‰‹å‹•æ§åˆ¶äº‹å‹™æäº¤ï¼Ÿ>Springçš„å­æ¡†æ¶Â SpringMVCï¼Œå¦‚ä½•å¯¦ç¾æ‰‹å‹•æ§åˆ¶äº‹å‹™æäº¤ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f09ac34c.html alt=å½©è‰²é›»å­æ›¸åœ¨å»£å·ç‡å…ˆå¯¦ç¾é‡ç”¢ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RkPMb9G6tipobr style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f09ac34c.html title=å½©è‰²é›»å­æ›¸åœ¨å»£å·ç‡å…ˆå¯¦ç¾é‡ç”¢>å½©è‰²é›»å­æ›¸åœ¨å»£å·ç‡å…ˆå¯¦ç¾é‡ç”¢</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/000afa08.html alt="Spring Boot 2.xåŸºç¤æ•™ç¨‹ï¼šSwaggeræ¥å£åˆ†é¡èˆ‡å„å…ƒç´ æ’åºå•é¡Œè©³è§£" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/daa2cfd29ec34306a4be6f3f257b824b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/000afa08.html title="Spring Boot 2.xåŸºç¤æ•™ç¨‹ï¼šSwaggeræ¥å£åˆ†é¡èˆ‡å„å…ƒç´ æ’åºå•é¡Œè©³è§£">Spring Boot 2.xåŸºç¤æ•™ç¨‹ï¼šSwaggeræ¥å£åˆ†é¡èˆ‡å„å…ƒç´ æ’åºå•é¡Œè©³è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bb071e7e.html alt="SQL äº‹å‹™æ©Ÿåˆ¶-transaction" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3231427d97bf4a04b148360fea032241 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bb071e7e.html title="SQL äº‹å‹™æ©Ÿåˆ¶-transaction">SQL äº‹å‹™æ©Ÿåˆ¶-transaction</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6cfd4e0e.html alt="Spring æ ¸å¿ƒçŸ¥è­˜è¬›è§£ï¼Œå¤ªç°¡å–®å•¦" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6cfd4e0e.html title="Spring æ ¸å¿ƒçŸ¥è­˜è¬›è§£ï¼Œå¤ªç°¡å–®å•¦">Spring æ ¸å¿ƒçŸ¥è­˜è¬›è§£ï¼Œå¤ªç°¡å–®å•¦</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/090306a0.html alt="[Spring] æ·±å…¥ç­è§£äº‹å‹™åŸç†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/a8c6dbd7c51741f5a76262e8e2c7a670 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/090306a0.html title="[Spring] æ·±å…¥ç­è§£äº‹å‹™åŸç†">[Spring] æ·±å…¥ç­è§£äº‹å‹™åŸç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2d12804e.html alt=[ç©è½‰MySQLä¹‹ä¹]MySQLå¯¦ç¾ACIDä¹‹åŸå­æ€§ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/bdb044d821f74107a3fd9119fc34c642 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2d12804e.html title=[ç©è½‰MySQLä¹‹ä¹]MySQLå¯¦ç¾ACIDä¹‹åŸå­æ€§>[ç©è½‰MySQLä¹‹ä¹]MySQLå¯¦ç¾ACIDä¹‹åŸå­æ€§</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5f4c6dc1.html alt=äº‹å‹™æ©Ÿåˆ¶å’Œé–æ©Ÿåˆ¶ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5a547c8c402142cca7ed81d05fe0e3e3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5f4c6dc1.html title=äº‹å‹™æ©Ÿåˆ¶å’Œé–æ©Ÿåˆ¶>äº‹å‹™æ©Ÿåˆ¶å’Œé–æ©Ÿåˆ¶</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e41fd8de.html alt="æ’«é †å„é …é˜²æ±›å·¥ä½œå¯¦ç¾â€œå…­åˆ°ä½â€ ç¢ºä¿å…¨å¸‚å®‰å…¨åº¦æ±›" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e41fd8de.html title="æ’«é †å„é …é˜²æ±›å·¥ä½œå¯¦ç¾â€œå…­åˆ°ä½â€ ç¢ºä¿å…¨å¸‚å®‰å…¨åº¦æ±›">æ’«é †å„é …é˜²æ±›å·¥ä½œå¯¦ç¾â€œå…­åˆ°ä½â€ ç¢ºä¿å…¨å¸‚å®‰å…¨åº¦æ±›</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6e8f3f2e.html alt=é€£mysqlé–çš„æ©Ÿåˆ¶éƒ½ä¸ç­è§£ï¼Œæ€éº¼åšæ¶æ§‹å¸« class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1533476323070887266574f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6e8f3f2e.html title=é€£mysqlé–çš„æ©Ÿåˆ¶éƒ½ä¸ç­è§£ï¼Œæ€éº¼åšæ¶æ§‹å¸«>é€£mysqlé–çš„æ©Ÿåˆ¶éƒ½ä¸ç­è§£ï¼Œæ€éº¼åšæ¶æ§‹å¸«</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1678b1c4.html alt=ï¼ˆæ”¶è—ï¼‰Springäº‹å‹™å°ˆé¡Œï¼šäº‹å‹™çš„åŸºæœ¬æ¦‚å¿µï¼ŒMysqläº‹å‹™è™•ç†åŸç† class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/433259b5-1936-4cee-ab74-70aef36536ee style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1678b1c4.html title=ï¼ˆæ”¶è—ï¼‰Springäº‹å‹™å°ˆé¡Œï¼šäº‹å‹™çš„åŸºæœ¬æ¦‚å¿µï¼ŒMysqläº‹å‹™è™•ç†åŸç†>ï¼ˆæ”¶è—ï¼‰Springäº‹å‹™å°ˆé¡Œï¼šäº‹å‹™çš„åŸºæœ¬æ¦‚å¿µï¼ŒMysqläº‹å‹™è™•ç†åŸç†</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>