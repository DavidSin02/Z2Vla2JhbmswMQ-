<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>å¤§æ•¸æ“šå°ˆå®¶ï¼Œå°Flinkæ‰¹è™•ç†ç”ŸæˆJobGraphæµç¨‹æ·±å…¥åˆ†æï¼Œå€¼å¾—æ”¶è— | æå®¢å¿«è¨Š</title><meta property="og:title" content="å¤§æ•¸æ“šå°ˆå®¶ï¼Œå°Flinkæ‰¹è™•ç†ç”ŸæˆJobGraphæµç¨‹æ·±å…¥åˆ†æï¼Œå€¼å¾—æ”¶è— - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/9c9227424d8f4b52958e32ec1ffdb116"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/92b7ebb2.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/92b7ebb2.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/92b7ebb2.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/92b7ebb2.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/92b7ebb2.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/92b7ebb2.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/92b7ebb2.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/92b7ebb2.html><meta property="article:published_time" content="2020-11-14T21:02:46+08:00"><meta property="article:modified_time" content="2020-11-14T21:02:46+08:00"><meta name=Keywords content><meta name=description content="å¤§æ•¸æ“šå°ˆå®¶ï¼Œå°Flinkæ‰¹è™•ç†ç”ŸæˆJobGraphæµç¨‹æ·±å…¥åˆ†æï¼Œå€¼å¾—æ”¶è—"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/92b7ebb2.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>å¤§æ•¸æ“šå°ˆå®¶ï¼Œå°Flinkæ‰¹è™•ç†ç”ŸæˆJobGraphæµç¨‹æ·±å…¥åˆ†æï¼Œå€¼å¾—æ”¶è—</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p>æˆ‘å€‘å…ˆé€šéä¸€å€‹ç°¡å–®çš„æ‰¹é‡è™•ç†WordCountçš„ç¨‹åºï¼Œä¾†äº†è§£ä¸€ä¸‹ï¼Œåœ¨ç·¨ç¨‹APIå±¤é¢çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼Œä»¥åŠFlinkæ˜¯å¦‚ä½•åŸºæ–¼Pipelineé¢¨æ ¼çš„APIå¯¦ç¾ä¸€å€‹å®Œæ•´çš„æ‡‰ç”¨ç¨‹åºçš„ï¼Œé‚„æœ‰å°±æ˜¯æ¯ä¸€æ­¥æ“ä½œçš„åº•å±¤ï¼Œéƒ½æ˜¯å¦‚ä½•é€²è¡Œè½‰æ›çš„ã€‚WordCountç¨‹åºä»£ç¢¼ï¼Œç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>final MultipleParameterTool params = MultipleParameterTool.fromArgs(args);final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();env.getConfig().setGlobalJobParameters(params);Â // get input dataDataSet&lt;String&gt; text = env.readTextFile(input);DataSet&lt;Tuple2&lt;String, Integer&gt;&gt; counts =Â Â Â Â Â Â Â Â // split up the lines in pairs (2-tuples) containing: (word,1)Â Â Â Â Â Â Â Â text.flatMap(new Tokenizer())Â Â Â Â Â Â Â Â // group by the tuple field "0" and sum up tuple field "1"Â Â Â Â Â Â Â Â .groupBy(0)Â Â Â Â Â Â Â Â .sum(1);counts.writeAsCsv(params.get("output"), "\n", " ");// execute programenv.execute("WordCount Example");</code></pre><p>ä¸Šè¿°WordCountç¤ºä¾‹ç¨‹åºï¼Œå®ƒåœ¨ç”¨æˆ¶ç·¨ç¨‹APIä½¿ç”¨çš„å±¤é¢ä¾†çœ‹æ˜¯å‘ˆç·šæ€§çš„ï¼Œå°æ‡‰ä¸€å€‹è¨ˆç®—DAGï¼Œæˆ‘å€‘ä»¥å®ƒç‚ºä¾‹å› ç‚ºç·šæ€§æ¯”è¼ƒç°¡å–®ï¼Œæ›´å®¹æ˜“ç†è§£å’Œèªªæ˜ã€‚é€šéæŸ¥çœ‹Flinkæºç¢¼å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢ç¨‹åºé€šéèª¿ç”¨ExecutionEnvironmentçš„readTextFile()ã€flatMap()ã€groupBy()ã€sum()ã€writeAsCsv()æ–¹æ³•ï¼Œç”Ÿæˆäº†ä¸€å€‹è¨ˆç®—Job DAGã€‚é€™å€‹Jobå¯ä»¥é€šéä¸‹åœ–ä¾†å±•ç¤ºFlinkåœ¨High-Level APIå±¤é¢æ˜¯å¦‚ä½•æ˜ å°„åˆ°æˆ‘å€‘æ‰€èªªçš„Operatorçµ„ä»¶çš„ï¼Œå¦‚åœ–æ‰€ç¤ºï¼š</p><div class=pgc-img><img alt=å¤§æ•¸æ“šå°ˆå®¶ï¼Œå°Flinkæ‰¹è™•ç†ç”ŸæˆJobGraphæµç¨‹æ·±å…¥åˆ†æï¼Œå€¼å¾—æ”¶è— onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9c9227424d8f4b52958e32ec1ffdb116><p class=pgc-img-caption></p></div><p>ä¸Šåœ–ä¸­ï¼Œç¬¬ä¸€å±¤è—è‰²æ–¹æ¡†è¡¨ç¤ºé€šéç”¨æˆ¶ç·¨ç¨‹APIèª¿ç”¨æ–¹æ³•å¾Œï¼Œè½‰æ›æˆçš„å„å€‹DataSetå°è±¡ï¼Œå®ƒå€‘è¡¨ç¤ºæ¯ç¶“éä¸€å€‹è½‰æ›æ“ä½œï¼Œéƒ½ç”±ä¸€å€‹DataSetç”Ÿæˆå¦ä¸€å€‹DataSetã€‚é™¤äº†DataSinkå’ŒUnsortedGroupingä»¥å¤–ï¼Œé€™äº›DataSetéƒ½æ˜¯ä½æ–¼org.apache.flink.api.java.operatorsåŒ…ä¸‹é¢çš„å¯¦ç¾é¡ã€‚ç¬¬äºŒå±¤çš„é»‘è‰²æ–¹æ¡†è¡¨ç¤ºï¼Œç‚ºäº†èƒ½å¤ é€²ä¸€æ­¥æ ¡é©—ç”¨æˆ¶ç·¨å¯«çš„Batch Jobç¨‹åºçš„è¦ç¯„æ€§ï¼Œä»¥åŠç²å–æ›´å¤šæœ‰é—œDataflowçš„ä¿¡æ¯ï¼ŒåˆæŠ½è±¡å‡ºäº†ä¸€å±¤Operatorè¨­è¨ˆï¼Œé€™ä¸€å±¤Operatorä½æ–¼org.apache.flink.api.common.operatorsåŒ…ä¸‹é¢ã€‚å¾å·¦å³å‘å³ç®­é ­è¡¨ç¤ºï¼Œç”¨æˆ¶ç¨‹åºå°è¼¸å…¥æ•¸æ“šé›†é€²è¡Œè½‰æ›æ“ä½œçš„é †åºï¼›å¾å³å‘å·¦ç®­é ­è¡¨ç¤ºï¼Œæ¯ç¶“éä¸€æ¬¡è½‰æ›æ“ä½œç”Ÿæˆä¸€å€‹æ–°çš„DataSetï¼Œå®ƒå…§éƒ¨éƒ½æœƒç¶­è­·ä¸€å€‹æŒ‡é‡ç”¨ä¾†æŒ‡å‘ä¸Šä¸€å€‹DataSetï¼Œé€™æ–¹ä¾¿äº†å°å„å€‹è½‰æ›æ“ä½œæ–°ç”Ÿæˆç”ŸæˆDataSetçš„é †åºé€²è¡Œè·Ÿè¹¤ã€‚å…¶å¯¦ï¼ŒFlinkåœ¨æ§‹å»ºJobGraphçš„éç¨‹ä¸­ï¼Œå°±æ˜¯å¾å¾Œå‘å‰é€²è¡Œéæ­·ï¼Œä¸æ–·å°Jobçš„DAGåœ–ä¸­å„å€‹Operatoré€²è¡Œå¢å¼·å’Œå„ªåŒ–ã€‚ä¸‹é¢æˆ‘å€‘æœƒå°é€™å…©å±¤é€²è¡Œè©³ç´°è§£é‡‹èªªæ˜ã€‚æœ‰é—œDataSeté¡çš„è¨­è¨ˆï¼Œå¦‚ä¸‹åœ–æ‰€ç¤ºï¼š</p><div class=pgc-img><img alt=å¤§æ•¸æ“šå°ˆå®¶ï¼Œå°Flinkæ‰¹è™•ç†ç”ŸæˆJobGraphæµç¨‹æ·±å…¥åˆ†æï¼Œå€¼å¾—æ”¶è— onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1346c393ae964d29bcd6088043e89750><p class=pgc-img-caption></p></div><p>åœ–ä¸­å„å€‹Operatorçš„å…·é«”å¯¦ç¾é¡ï¼Œæ˜¯æ§‹å»ºDAGåœ–æœ€åŸå§‹çš„è¡¨ç¤ºå½¢å¼ï¼Œä»–å€‘å…§éƒ¨ç›´æ¥å°è£äº†é€šéç·¨ç¨‹APIå‚³å…¥çš„å‡½æ•¸ï¼Œæˆ–è€…Flinkå…§éƒ¨ç‚ºå®ŒæˆDAGè€Œå¯¦ç¾çš„å…§ç½®å‡½æ•¸ã€‚æˆ‘å€‘ä»¥flatMapç‚ºä¾‹ï¼Œèª¿ç”¨flatMap()æœƒå‰µå»ºåç‚ºFlatMapOperatorçš„DataSetï¼Œå…·é«”å¯¦ç¾ä»£ç¢¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>public &lt;R&gt; FlatMapOperator&lt;T, R&gt; flatMap(FlatMapFunction&lt;T, R&gt; flatMapper) {Â Â Â Â if (flatMapper == null) {Â Â Â Â Â Â Â Â throw new NullPointerException("FlatMap function must not be null.");Â Â Â Â }Â Â Â Â Â String callLocation = Utils.getCallLocationName();Â Â Â Â TypeInformation&lt;R&gt; resultType = TypeExtractor.getFlatMapReturnTypes(flatMapper, getType(), callLocation, true);Â Â Â Â return new FlatMapOperator&lt;&gt;(this, resultType, clean(flatMapper), callLocation);}</code></pre><p>ä»£ç¢¼ä¸­çš„FlatMapFunctionå°±æ˜¯ç”¨æˆ¶ç·¨å¯«Flinkç¨‹åºæ™‚ï¼Œå‚³å…¥çµ¦flatMap()æ–¹æ³•çš„å‡½æ•¸å¯¦ç¾ï¼Œé€™å€‹å‡½æ•¸æœƒè¢«è¨­ç½®ç‚ºFlatMapOperatorå°è±¡çš„ä¸€å€‹functionå±¬æ€§çš„å€¼ã€‚ç•¶æˆ‘å€‘ç·¨å¯«çš„Flinkæ‰¹é‡è™•ç†ç¨‹åºä¸­ï¼Œæœ€å¾Œæœƒèª¿ç”¨ExecutionEnvironment.execute()ï¼Œåœ¨è©²æ–¹æ³•ä¸­æœƒå°æœ€åŸå§‹çš„ç”±Operatoræ§‹å»ºå¥½çš„DAGåœ–é€²è¡Œè™•ç†ï¼Œè™•ç†çš„åŸºæœ¬æµç¨‹ç°¡è¦æè¿°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ol start=1><li>å‰µå»ºä¸€å€‹Planï¼Œå®ƒæ˜¯Pipelineæ¥å£çš„å…·é«”å¯¦ç¾é¡ï¼Œè¡¨ç¤ºäº†å¾DataSinkåˆ°DataSourceå¯¦ç¾é€£é€šçš„æ•¸æ“šæµDAGåœ–ã€‚</li><li>æ ¹æ“šè¼¸å…¥é…ç½®ï¼Œç²å–åˆ°å°æ‡‰çš„PipelineExecutorï¼Œç”¨ä¾†å°‡å¯¦ç¾çš„Jobæäº¤åˆ°åŸ·è¡Œå¼•æ“é€²è¡Œè¨ˆç®—è™•ç†ã€‚</li><li>å°‡Plané€²ä¸€æ­¥é€²è¡Œå„ªåŒ–ï¼Œç·¨è­¯ç”ŸæˆOptimizedPlanï¼Œå®ƒè¡¨ç¤ºäº†å°æ‡‰çš„åŸ·è¡Œè¨ˆåŠƒï¼Œé€šéæŠ½è±¡çš„æ•¸æ“šçµæ§‹PlanNodeå’ŒChannelä¾†æ›´åŠ ç²¾ç¢ºæè¿°ç¨‹åºå¦‚ä½•è¢«åŸ·è¡Œã€‚</li><li>æœ€å¾Œï¼Œæ ¹æ“šOptimizedPlanç”Ÿæˆæœ€çµ‚çš„JobGraphï¼Œå¾è€Œæäº¤åˆ°é›†ç¾¤JobManageré€²è¡ŒçœŸæ­£åŸ·è¡Œã€‚</li></ol><p>é€™è£¡ï¼Œæˆ‘å€‘ä¸æœƒéå¸¸æ·±å…¥åœ°èªªæ˜å„å€‹æ­¥é©Ÿæ¶‰åŠåˆ°çš„ç´°ç¯€ï¼Œä½†æ˜¯æœƒå¾æ›´é«˜Levelä¾†ç†è§£ç”ŸæˆJobGraphçš„éç¨‹ä¸­ï¼Œéƒ½åšäº†å“ªäº›è™•ç†ã€‚</p><p><strong>ç”ŸæˆPlan</strong></p><p>åœ¨ç”ŸæˆPlançš„éç¨‹ä¸­ï¼Œå°±æ¶‰åŠåˆ°ä¸Šé¢WordCountæ•¸æ“šæµDAGåœ–ä¸­å±•ç¤ºçš„ç¬¬äºŒå±¤æ§‹æˆDAGçš„åŸºæœ¬å…ƒç´ Operatorï¼Œå®ƒå€‘æ˜¯ä½æ–¼org.apache.flink.api.common.operatorsåŒ…ä¸‹é¢å¯¦ç¾é¡ï¼Œæˆ‘å€‘å…ˆçœ‹çœ‹é€™å€‹Operatoré¡é«”ç³»çš„ç¹¼æ‰¿é—œä¿‚ï¼Œå¦‚ä¸‹åœ–æ‰€ç¤ºï¼š</p><div class=pgc-img><img alt=å¤§æ•¸æ“šå°ˆå®¶ï¼Œå°Flinkæ‰¹è™•ç†ç”ŸæˆJobGraphæµç¨‹æ·±å…¥åˆ†æï¼Œå€¼å¾—æ”¶è— onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c0c61514b7d3450583c14f232fc92541><p class=pgc-img-caption></p></div><p>ä¸Šé¢é¡åœ–ä¸­ï¼Œå¤§å¤šæ•¸Operatorå¯¦ç¾é¡åç¨±éƒ½å¸¶æœ‰ä¸€å€‹Baseçš„å¾Œç¶´ï¼Œå¤§éƒ¨åˆ†éƒ½èˆ‡org.apache.flink.api.javaåŒ…ä¸‹é¢çš„Operatorå¯¦ç¾é¡æœ‰ä¸€å€‹å°æ‡‰é—œä¿‚ï¼Œæ¯”å¦‚ï¼ŒFlatMapOperatorå°æ‡‰FlatMapOperatorBaseï¼ŒDataSourceå°æ‡‰DataSourceBaseã€AggregateOperatorå°æ‡‰GroupReduceOperatorBaseç­‰ç­‰ï¼Œä¸å†ä¸€ä¸€åˆ—èˆ‰ã€‚åœ¨DataSetçš„å…·é«”å¯¦ç¾é¡ä¸­ï¼Œæ¯å€‹é¡éƒ½æœ‰ä¸€å€‹translateToDataFlow()æ–¹æ³•ï¼Œèƒ½å¤ å°‡è©²Operatorçš„è¼¸å…¥DataSetè½‰æ›æˆä¸€å€‹org.apache.flink.api.common.operators.Operatorï¼Œæ‰€ä»¥åœ¨å¾DataSinkåˆ°DataSourceéæ­¸éæ­·éç¨‹ä¸­ï¼Œéƒ½æœƒé€²è¡Œè©²è½‰æ›æ“ä½œã€‚å¦å¤–ï¼Œé‚„æœƒæ ¹æ“šç”¨æˆ¶ç·¨å¯«ç¨‹åºä¸­è¨­ç½®çš„å„ç¨®åƒæ•¸ï¼ŒåŒ…æ‹¬Flinké»˜èªçš„ä¸€äº›åƒæ•¸å€¼ç­‰ç­‰ï¼Œéƒ½é…ç½®åˆ°åŸºæ–¼org.apache.flink.api.common.operators.Operatorçš„å…·é«”å°è±¡ä¸Šã€‚ä¸‹é¢æ˜¯æ ¸å¿ƒçš„è™•ç†ä»£ç¢¼ï¼š</p><pre><code>public Plan translateToPlan(List&lt;DataSink&lt;?&gt;&gt; sinks, String jobName) {Â Â Â Â List&lt;GenericDataSinkBase&lt;?&gt;&gt; planSinks = new ArrayList&lt;&gt;();Â Â Â Â Â for (DataSink&lt;?&gt; sink : sinks) {Â Â Â Â Â Â Â Â planSinks.add(translate(sink));Â Â Â Â }Â Â Â Â Â Plan p = new Plan(planSinks);Â Â Â Â p.setJobName(jobName);Â Â Â Â return p;}</code></pre><p>å…¶ä¸­ï¼Œåƒæ•¸sinksæ˜¯åœ¨ExecutionEnvironmentä¸­ç®¡ç†çš„æœ€åŸå§‹Flinkç¨‹åºDAGï¼Œå°æ–¼ä¸Šé¢çš„WordCountä¾‹å­ï¼Œå¯¦éš›åªæœ‰ä¸€å€‹DataSinkã€‚ä¸Šé¢çš„translate(sink)æ–¹æ³•èª¿ç”¨ï¼Œå°æœ€åˆæ§‹å»ºå¥½çš„æ•´å€‹DAGé€²è¡Œç¿»è­¯è™•ç†ï¼Œå®ƒæ˜¯ä¸€å€‹éæ­¸è™•ç†éç¨‹ï¼Œä»£ç¢¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>private &lt;T&gt; GenericDataSinkBase&lt;T&gt; translate(DataSink&lt;T&gt; sink) {Â Â Â Â // translate the input recursivelyÂ Â Â Â Operator&lt;T&gt; input = translate(sink.getDataSet());Â Â Â Â // translate the sink itself and connect it to the inputÂ Â Â Â GenericDataSinkBase&lt;T&gt; translatedSink = sink.translateToDataFlow(input);Â Â Â Â translatedSink.setResources(sink.getMinResources(), sink.getPreferredResources());Â Â Â Â return translatedSink;}</code></pre><p>ä¸Šé¢translate(sink.getDataSet())æ–¹æ³•èª¿ç”¨ä¸­ï¼Œå°å„ç¨®ä¸åŒé¡å‹çš„Operatoré€²è¡Œç¿»è­¯è™•ç†ï¼Œå› ç‚ºæ¯å€‹Operatorçš„ç‰¹é»ä»¥åŠè¡Œç‚ºæœ¬èº«å°±ä¸åŒï¼Œæ‰€ä»¥translate()æ–¹æ³•ä¸­åˆ†åˆ¥é€²è¡Œäº†ä¸åŒçš„è™•ç†ï¼Œå¯¦ç¾å¦‚ä¸‹ä»£ç¢¼æ‰€ç¤ºï¼š</p><pre><code>private &lt;T&gt; Operator&lt;T&gt; translate(DataSet&lt;T&gt; dataSet) {Â Â Â Â while (dataSet instanceof NoOpOperator) {Â Â Â Â Â Â Â Â dataSet = ((NoOpOperator&lt;T&gt;) dataSet).getInput();Â Â Â Â }Â Â Â Â Â // check if we have already translated that data set (operation or source)Â Â Â Â Operator&lt;?&gt; previous = this.translated.get(dataSet);Â Â Â Â if (previous != null) {Â Â Â Â Â Â Â Â // Union operators may only have a single output.Â Â Â Â Â Â Â Â // We ensure this by not reusing previously created union operators.Â Â Â Â Â Â Â Â // The optimizer will merge subsequent binary unions into one n-ary union.Â Â Â Â Â Â Â Â if (!(dataSet instanceof UnionOperator)) {Â Â Â Â Â Â Â Â Â Â Â Â // all other operators are reused.Â Â Â Â Â Â Â Â Â Â Â Â @SuppressWarnings("unchecked")Â Â Â Â Â Â Â Â Â Â Â Â Operator&lt;T&gt; typedPrevious = (Operator&lt;T&gt;) previous;Â Â Â Â Â Â Â Â Â Â Â Â return typedPrevious;Â Â Â Â Â Â Â Â }Â Â Â Â }Â Â Â Â Â Operator&lt;T&gt; dataFlowOp;Â Â Â Â if (dataSet instanceof DataSource) {Â Â Â Â Â Â Â Â DataSource&lt;T&gt; dataSource = (DataSource&lt;T&gt;) dataSet;Â Â Â Â Â Â Â Â dataFlowOp = dataSource.translateToDataFlow();Â Â Â Â Â Â Â Â dataFlowOp.setResources(dataSource.getMinResources(), dataSource.getPreferredResources());Â Â Â Â }Â Â Â Â else if (dataSet instanceof SingleInputOperator) {Â Â Â Â Â Â Â Â SingleInputOperator&lt;?, ?, ?&gt; singleInputOperator = (SingleInputOperator&lt;?, ?, ?&gt;) dataSet;Â Â Â Â Â Â Â Â dataFlowOp = translateSingleInputOperator(singleInputOperator);Â Â Â Â Â Â Â Â dataFlowOp.setResources(singleInputOperator.getMinResources(), singleInputOperator.getPreferredResources());Â Â Â Â }Â Â Â Â else if (dataSet instanceof TwoInputOperator) {Â Â Â Â Â Â Â Â TwoInputOperator&lt;?, ?, ?, ?&gt; twoInputOperator = (TwoInputOperator&lt;?, ?, ?, ?&gt;) dataSet;Â Â Â Â Â Â Â Â dataFlowOp = translateTwoInputOperator(twoInputOperator);Â Â Â Â Â Â Â Â dataFlowOp.setResources(twoInputOperator.getMinResources(), twoInputOperator.getPreferredResources());Â Â Â Â }Â Â Â Â else if (dataSet instanceof BulkIterationResultSet) {Â Â Â Â Â Â Â Â BulkIterationResultSet&lt;?&gt; bulkIterationResultSet = (BulkIterationResultSet&lt;?&gt;) dataSet;Â Â Â Â Â Â Â Â dataFlowOp = translateBulkIteration(bulkIterationResultSet);Â Â Â Â Â Â Â Â dataFlowOp.setResources(bulkIterationResultSet.getIterationHead().getMinResources(),Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â bulkIterationResultSet.getIterationHead().getPreferredResources());Â Â Â Â }Â Â Â Â else if (dataSet instanceof DeltaIterationResultSet) {Â Â Â Â Â Â Â Â DeltaIterationResultSet&lt;?, ?&gt; deltaIterationResultSet = (DeltaIterationResultSet&lt;?, ?&gt;) dataSet;Â Â Â Â Â Â Â Â dataFlowOp = translateDeltaIteration(deltaIterationResultSet);Â Â Â Â Â Â Â Â dataFlowOp.setResources(deltaIterationResultSet.getIterationHead().getMinResources(),Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â deltaIterationResultSet.getIterationHead().getPreferredResources());Â Â Â Â }Â Â Â Â else if (dataSet instanceof DeltaIteration.SolutionSetPlaceHolder || dataSet instanceof DeltaIteration.WorksetPlaceHolder) {Â Â Â Â Â Â Â Â throw new InvalidProgramException("A data set that is part of a delta iteration was used as a sink or action."Â Â Â Â Â Â Â Â Â Â Â Â + " Did you forget to close the iteration?");Â Â Â Â }Â Â Â Â else {Â Â Â Â Â Â Â Â throw new RuntimeException("Error while creating the data flow plan for the program: Unknown operator or data set type: " + dataSet);Â Â Â Â }Â Â Â Â Â this.translated.put(dataSet, dataFlowOp);Â Â Â Â // take care of broadcast variablesÂ Â Â Â translateBcVariables(dataSet, dataFlowOp);Â Â Â Â return dataFlowOp;}</code></pre><p>ä¸Šé¢translateSingleInputOperator()ã€translateTwoInputOperator()ç­‰æ–¹æ³•ä¸­ï¼Œæœƒéæ­¸èª¿ç”¨è©²translate()æ–¹æ³•ä¾†å°æŸå€‹Operatoré€²è¡Œç¿»è­¯è™•ç†ã€‚æˆ‘å€‘ä»¥å‰é¢çµ¦å‡ºçš„WordCountç¨‹åºç‚ºä¾‹ï¼Œå°±æœƒå°DataSourceâ†’FlatMapOperatorâ†’UnsortedGroupingâ†’AggregateOperatorâ†’DataSinké€²è¡Œå¾å¾Œè‡³å‰çš„éæ­·ï¼Œæœ€çµ‚ç¿»è­¯æˆGenericDataSourceBaseâ†’FlatMapOperatorBaseâ†’GroupReduceOperatorBaseâ†’GenericDataSinkBaseã€‚é€™æ¨£ï¼Œæˆ‘å€‘ä¾¿å¾—åˆ°äº†æœ€åŸºæœ¬çš„Planã€‚</p><p><strong>ç”ŸæˆOptimizedPlan</strong></p><p>é€šéä¸Šä¸€æ­¥ç”Ÿæˆçš„Planï¼Œæˆ‘å€‘é‚„ç„¡æ³•ç²¾ç¢ºåœ°çŸ¥é“å¦‚ä½•çœŸæ­£é‹è¡ŒæŸå€‹Operatorã€‚æ‰€ä»¥æ¥ä¸‹ä¾†ï¼Œç”Ÿæˆçš„OptimizedPlanèƒ½å¤ åšåˆ°å¦‚ä¸‹äº‹æƒ…ï¼š</p><ul><li>åŸºæ–¼ç”¨æˆ¶çš„ç¨‹åºç”ŸæˆPlanï¼Œæ›´é€²ä¸€æ­¥ç”Ÿæˆæ›´ç²¾ç¢ºæè¿°ç”¨æˆ¶ç¨‹åºåŸ·è¡Œçš„OptimizedPlanã€‚</li><li>OptimizedPlanèƒ½å¤ ç²¾ç¢ºåœ°æè¿°ç¨‹åºå¦‚ä½•ç‰©ç†åœ°åŸ·è¡Œã€‚</li><li>Operatorä½¿ç”¨ä½•ç¨®ç­–ç•¥åŸ·è¡Œï¼Œæ¯”å¦‚ï¼Œæ˜¯Hash Joiné‚„æ˜¯Sort Merge Joinã€‚</li><li>Operatorä¹‹é–“é€²è¡Œæ•¸æ“šäº¤æ›çš„ç­–ç•¥ï¼Œæ˜¯Local Pipe Forwardã€Shuffleï¼Œé‚„æ˜¯Broadcastã€‚</li><li>Operatorä¹‹é–“ä½¿ç”¨çš„æ•¸æ“šäº¤æ›æ¨¡å¼ï¼Œæ˜¯Pipelinedé‚„æ˜¯Batchã€‚</li><li>åœ¨ä»€éº¼åœ°æ–¹ç·©å­˜ä¸­é–“çµæœã€‚</li></ul><p>é€™è£¡ï¼Œæˆ‘å€‘ä¸å†æ›´è©³ç´°åœ°å»åˆ†æï¼Œå¾Œé¢æœƒå°å–®ç¨å¯«æ–‡ç« é€²è¡Œæ·±å…¥åˆ†æã€‚ç¾åœ¨å¯ä»¥æŸ¥çœ‹å°æ‡‰ä»£ç¢¼ä¾†äº†è§£ï¼Œæ ¸å¿ƒä»£ç¢¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>GraphCreatingVisitor graphCreator = new GraphCreatingVisitor(defaultParallelism, defaultDataExchangeMode);program.accept(graphCreator);Â // if we have a plan with multiple data sinks, add logical optimizer nodes that have two data-sinks as children// each until we have only a single root node. This allows to transparently deal with the nodes with// multiple outputsOptimizerNode rootNode;if (graphCreator.getSinks().size() == 1) {Â Â Â Â rootNode = graphCreator.getSinks().get(0);}else if (graphCreator.getSinks().size() &gt; 1) {Â Â Â Â Iterator&lt;DataSinkNode&gt; iter = graphCreator.getSinks().iterator();Â Â Â Â rootNode = iter.next();Â Â Â Â while (iter.hasNext()) {Â Â Â Â Â Â Â Â rootNode = new SinkJoiner(rootNode, iter.next());Â Â Â Â }}else {Â Â Â Â throw new CompilerException("Bug: The optimizer plan representation has no sinks.");}Â // now that we have all nodes created and recorded which ones consume memory, tell the nodes their minimal// guaranteed memory, for further cost estimations. We assume an equal distribution of memory among consumer tasksrootNode.accept(new IdAndEstimatesVisitor(this.statistics));Â // We need to enforce that union nodes always forward their output to their successor.// Any partitioning must be either pushed before or done after the union, but not on the union's output.UnionParallelismAndForwardEnforcer unionEnforcer = new UnionParallelismAndForwardEnforcer();rootNode.accept(unionEnforcer);Â // We are dealing with operator DAGs, rather than operator trees.// That requires us to deviate at some points from the classical DB optimizer algorithms.// This step builds auxiliary structures to help track branches and joins in the DAGBranchesVisitor branchingVisitor = new BranchesVisitor();rootNode.accept(branchingVisitor);Â // Propagate the interesting properties top-down through the graphInterestingPropertyVisitor propsVisitor = new InterestingPropertyVisitor(this.costEstimator);rootNode.accept(propsVisitor);Â // perform a sanity check: the root may not have any unclosed branchesif (rootNode.getOpenBranches() != null &amp;&amp; rootNode.getOpenBranches().size() &gt; 0) {Â Â Â Â throw new CompilerException("Bug: Logic for branching plans (non-tree plans) has an error, and does not " +Â Â Â Â Â Â Â Â Â Â Â Â "track the re-joining of branches correctly.");}Â // the final step is now to generate the actual plan alternativesList&lt;PlanNode&gt; bestPlan = rootNode.getAlternativePlans(this.costEstimator);if (bestPlan.size() != 1) {Â Â Â Â throw new CompilerException("Error in compiler: more than one best plan was created!");}Â // check if the best plan's root is a data sink (single sink plan)// if so, directly take it. if it is a sink joiner node, get its contained sinksPlanNode bestPlanRoot = bestPlan.get(0);List&lt;SinkPlanNode&gt; bestPlanSinks = new ArrayList&lt;SinkPlanNode&gt;(4);Â if (bestPlanRoot instanceof SinkPlanNode) {Â Â Â Â bestPlanSinks.add((SinkPlanNode) bestPlanRoot);} else if (bestPlanRoot instanceof SinkJoinerPlanNode) {Â Â Â Â ((SinkJoinerPlanNode) bestPlanRoot).getDataSinks(bestPlanSinks);}Â // finalize the planOptimizedPlan plan = new PlanFinalizer().createFinalPlan(bestPlanSinks, program.getJobName(), program);plan.accept(new BinaryUnionReplacer());plan.accept(new RangePartitionRewriter(plan));Â // post pass the plan. this is the phase where the serialization and comparator code is setpostPasser.postPass(plan);</code></pre><p>é€™è£¡éœ€è¦èªªçš„æ˜¯ï¼Œç¶“éä¸Šé¢ä»£ç¢¼çš„è™•ç†ï¼Œé¦–å…ˆæœƒå°‡Planç”Ÿæˆä¸€ç®‡ä¸­é–“çµæ§‹çš„Planï¼Œä¸»è¦æ˜¯é€šéGraphCreatingVisitorä¾†é€²è¡Œè™•ç†çš„ï¼ŒDAGåœ–ä»¥OptimizerNodeç‚ºåŸºæœ¬ç¯€é»é€²è¡ŒæŠ½è±¡æ§‹å»ºï¼Œå°æ‡‰çš„é¡åŠå…¶ç¹¼æ‰¿é—œä¿‚å¦‚ä¸‹åœ–æ‰€ç¤ºï¼š</p><div class=pgc-img><img alt=å¤§æ•¸æ“šå°ˆå®¶ï¼Œå°Flinkæ‰¹è™•ç†ç”ŸæˆJobGraphæµç¨‹æ·±å…¥åˆ†æï¼Œå€¼å¾—æ”¶è— onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c701d403f5af48f5bb38533054b76334><p class=pgc-img-caption></p></div><p>å„ªåŒ–å™¨ï¼ˆOptimizerï¼‰æœƒä½¿ç”¨æ¯å€‹OptimizerNodeæä¾›çš„ä¿¡æ¯ä¾†æ§‹å»ºDAGï¼Œç¨±ç‚ºOptimizer DAGï¼Œå¾è€Œå®Œæˆå¦‚ä¸‹è™•ç†å·¥ä½œï¼š</p><ul><li>è©•ä¼°æ¯å€‹Operatorè™•ç†çš„æ•¸æ“šé‡çš„å¤§å°ï¼Œä»¥åŠKey/Valueæ•¸æ“šçš„æ•¸é‡ã€‚</li><li>ç¢ºå®šåœ¨DAGçš„ä»€éº¼ä½ç½®é€²è¡ŒSplitï¼ˆåˆ†æ”¯ï¼‰æˆ–è€…Joinï¼ˆåˆä½µï¼‰è™•ç†æ“ä½œã€‚</li><li>ä½¿ç”¨DagConnectionæ•¸æ“šæ¥å£ä¾†æè¿°Operatorä¹‹é–“å¦‚ä½•é€²è¡Œé€£æ¥ï¼ŒåŒ…æ‹¬Broadcasté€£æ¥ã€Incomingé€£æ¥å’ŒOutgoingé€£æ¥ã€‚</li><li>é¸æ“‡åˆé©çš„å±¬æ€§ï¼Œå¾è€Œä¸æ–·è¿­ä»£å„ªåŒ–å€™é¸è¨ˆåŠƒï¼ˆCandidate Planï¼‰ã€‚</li></ul><p>ç„¶å¾Œï¼Œæ ¹æ“šä¸Šé¢åŸºæ–¼OptimizerNodeçš„DAGï¼Œåˆé€²è¡Œå„ªåŒ–è™•ç†ï¼Œæœ€çµ‚å¾—åˆ°äº†ä»¥PlanNodeç‚ºåŸºæœ¬ç¯€é»æŠ½è±¡çš„DAGåœ–ï¼ŒPlanNodeé¡åŠå…¶ç¹¼æ‰¿é—œä¿‚å¦‚ä¸‹åœ–æ‰€ç¤ºï¼š</p><div class=pgc-img><img alt=å¤§æ•¸æ“šå°ˆå®¶ï¼Œå°Flinkæ‰¹è™•ç†ç”ŸæˆJobGraphæµç¨‹æ·±å…¥åˆ†æï¼Œå€¼å¾—æ”¶è— onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4dd907b1283c449f952d73fe4b822d28><p class=pgc-img-caption></p></div><p>æ¯å€‹PlanNodeä¸¦ä¸æ˜¯å’Œä¹‹å‰ç¿»è­¯éç¨‹ä¸­ç”Ÿæˆçš„ä¸€äº›æ•¸æ“šçµæ§‹æ²’é—œä¿‚ï¼Œå®ƒå€‘å…§éƒ¨éƒ½æœ‰ä¸€å€‹OptimizerNodeçš„å¼•ç”¨ï¼Œå¾è€Œèƒ½è¨ªå•åˆ°OptimizerNodeå…§éƒ¨çš„ä¿¡æ¯ã€‚PlanNodeä¸»è¦æŠ½è±¡äº†DAGåœ–ä¸­å„å€‹Operatorä¹‹é–“å¦‚ä½•é€²è¡Œæ•¸æ“šäº¤æ›ï¼Œä»¥åŠæ•¸æ“šäº¤æ›ç­–ç•¥ï¼Œæœ€çµ‚å¾—åˆ°ä¸€å€‹å”¯ä¸€çš„æœ€ä½³Planï¼Œå°æ‡‰ä»£ç¢¼ç‰‡æ®µå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>List&lt;PlanNode&gt; bestPlan = rootNode.getAlternativePlans(this.costEstimator);if (bestPlan.size() != 1) {Â Â Â Â throw new CompilerException("Error in compiler: more than one best plan was created!");}Â // check if the best plan's root is a data sink (single sink plan)// if so, directly take it. if it is a sink joiner node, get its contained sinksPlanNode bestPlanRoot = bestPlan.get(0);List&lt;SinkPlanNode&gt; bestPlanSinks = new ArrayList&lt;SinkPlanNode&gt;(4);if (bestPlanRoot instanceof SinkPlanNode) {Â Â Â Â bestPlanSinks.add((SinkPlanNode) bestPlanRoot);} else if (bestPlanRoot instanceof SinkJoinerPlanNode) {Â Â Â Â ((SinkJoinerPlanNode) bestPlanRoot).getDataSinks(bestPlanSinks);}Â // finalize the planOptimizedPlan plan = new PlanFinalizer().createFinalPlan(bestPlanSinks, program.getJobName(), program);plan.accept(new BinaryUnionReplacer());Â plan.accept(new RangePartitionRewriter(plan));Â // post pass the plan. this is the phase where the serialization and comparator code is setpostPasser.postPass(plan);</code></pre><p>åˆ°æ­¤ç‚ºæ­¢ï¼Œå·²ç¶“ç”Ÿæˆäº†ä¸€å€‹OptimizedPlanï¼Œé€šéOptimizedPlanå°±å¯ä»¥ç”Ÿæˆæˆ‘å€‘éœ€è¦çš„JobGraphäº†ã€‚</p><p><strong>ç”ŸæˆJobGraph</strong></p><p>JobGraphæ˜¯JobManagerèƒ½å¤ æ¥æ”¶çš„Jobçš„æ•¸æ“šçµæ§‹ï¼Œæ˜¯ä¸€ç¨®Low-Levelçš„æ•¸æ“šæµDAGè¡¨ç¾å½¢å¼ï¼Œå®ƒå®šç¾©äº†Jobç¯„åœå…§ï¼ˆJob-wideï¼‰çš„ä¸€äº›è¨­ç½®ã€‚ç”ŸæˆJobGraphçš„ä¸»æµç¨‹ï¼Œä»£ç¢¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>private JobGraph compilePlan(Plan plan, Configuration optimizerConfiguration) {Â Â Â Â Optimizer optimizer = new Optimizer(new DataStatistics(), optimizerConfiguration);Â Â Â Â OptimizedPlan optimizedPlan = optimizer.compile(plan);Â Â Â Â JobGraphGenerator jobGraphGenerator = new JobGraphGenerator(optimizerConfiguration);Â Â Â Â return jobGraphGenerator.compileJobGraph(optimizedPlan, plan.getJobId());}</code></pre><p>çµ„æˆJobGraphè¨ˆç®—åœ–æ‹“æ’²ä¸­ï¼Œæœ€æ ¸å¿ƒçš„å…©å€‹æ•¸æ“šçµæ§‹ç‚ºJobVertexå’ŒIntermediateDataSetã€‚å…¶ä¸­ï¼ŒJobVertexæ˜¯å°è¨ˆç®—é‚è¼¯å–®å…ƒçš„æŠ½è±¡ï¼Œå®ƒé€šéè¨­ç½®invokableClassNameå±¬æ€§ä¾†è¡¨ç¤ºï¼Œå®ƒå¿…é ˆæ˜¯AbstractInvokableé¡çš„å…·é«”å¯¦ç¾é¡ï¼Œèƒ½å¤ ç›´æ¥åœ¨TaskManagerä¸Šé€šéåå°„ç”ŸæˆAbstractInvokableå°è±¡ï¼Œç„¶å¾Œèª¿ç”¨å…¶invoke()æ–¹æ³•åŸ·è¡Œè©²Taskå°æ‡‰çš„è™•ç†é‚è¼¯ï¼Œæ¯”å¦‚ï¼Œæ‰¹è™•ç†Jobä½¿ç”¨çš„æ˜¯å…·é«”å¯¦ç¾BatchTaskã€‚IntermediateDataSetæ˜¯ä¸€å€‹OperatoråŸ·è¡Œå¾Œç”¢ç”Ÿçš„ä¸­é–“çµæœé›†çš„æŠ½è±¡ï¼Œä¹ŸåŒ…æ‹¬ä¸€å€‹DataSourceå°æ‡‰çš„æ•¸æ“šé›†ï¼Œå®ƒèƒ½å¤ è¢«å…¶ä»–Operatorè®€å–ã€ç‰©åŒ–ï¼ˆMaterializedï¼‰ï¼Œç”šè‡³ä¸Ÿæ£„ã€‚</p><p>æœ¬æ–‡ä½œè€…ä¾†è‡ªæ™‚å»¶è»ï¼ŒåŸæ–‡é»æ“Šç­è§£æ›´å¤šâ†“â†“â†“</p><p><strong>æ„Ÿè¬å¤§å®¶æ”¯æŒï¼Œå¤šå¤šè½‰ç™¼é—œæ³¨ä¸è¿·è·¯~~~~~</strong></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>å¤§æ•¸æ“š</a></li><li><a>å°ˆå®¶</a></li><li><a>Flink</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/c08f7fcf.html alt=å¯¶ä¿¡è»Ÿä»¶ï¼šå…¬å¸èšç„¦å¤§æ•¸æ“šã€äººå·¥æ™ºèƒ½ã€è™›æ“¬è£½é€ ç­‰ä¸ƒå¤§é—œéµæŠ€è¡“çš„ç ”ç©¶ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c08f7fcf.html title=å¯¶ä¿¡è»Ÿä»¶ï¼šå…¬å¸èšç„¦å¤§æ•¸æ“šã€äººå·¥æ™ºèƒ½ã€è™›æ“¬è£½é€ ç­‰ä¸ƒå¤§é—œéµæŠ€è¡“çš„ç ”ç©¶>å¯¶ä¿¡è»Ÿä»¶ï¼šå…¬å¸èšç„¦å¤§æ•¸æ“šã€äººå·¥æ™ºèƒ½ã€è™›æ“¬è£½é€ ç­‰ä¸ƒå¤§é—œéµæŠ€è¡“çš„ç ”ç©¶</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/848a087b.html alt="ã€Œç™¾ä½å°ˆå®¶è«‡ä¸­åœ‹è£½åº¦ã€åœ‹å®¶ç›£å¯Ÿé«”åˆ¶æ”¹é©ï¼šä»¥æ³•å¾‹ç‚ºç¡¬æ§“æ§“ æ‰ç‰¢åˆ¶åº¦çš„ç± å­" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/848a087b.html title="ã€Œç™¾ä½å°ˆå®¶è«‡ä¸­åœ‹è£½åº¦ã€åœ‹å®¶ç›£å¯Ÿé«”åˆ¶æ”¹é©ï¼šä»¥æ³•å¾‹ç‚ºç¡¬æ§“æ§“ æ‰ç‰¢åˆ¶åº¦çš„ç± å­">ã€Œç™¾ä½å°ˆå®¶è«‡ä¸­åœ‹è£½åº¦ã€åœ‹å®¶ç›£å¯Ÿé«”åˆ¶æ”¹é©ï¼šä»¥æ³•å¾‹ç‚ºç¡¬æ§“æ§“ æ‰ç‰¢åˆ¶åº¦çš„ç± å­</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/385506dd.html alt=å°ˆå®¶ï¼šè²·æˆ¿æ™‚ä¸€å®šè¦åˆ†æ¸…å±¤é«˜å’Œæ·¨é«˜ï¼Œæœ€ä½³å±¤é«˜ï¼Ÿè³¼æˆ¿è€…å…¥ä½ä¸å¾Œæ‚” class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/b7b94ebb-4938-423d-8106-e3b030bcd12e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/385506dd.html title=å°ˆå®¶ï¼šè²·æˆ¿æ™‚ä¸€å®šè¦åˆ†æ¸…å±¤é«˜å’Œæ·¨é«˜ï¼Œæœ€ä½³å±¤é«˜ï¼Ÿè³¼æˆ¿è€…å…¥ä½ä¸å¾Œæ‚”>å°ˆå®¶ï¼šè²·æˆ¿æ™‚ä¸€å®šè¦åˆ†æ¸…å±¤é«˜å’Œæ·¨é«˜ï¼Œæœ€ä½³å±¤é«˜ï¼Ÿè³¼æˆ¿è€…å…¥ä½ä¸å¾Œæ‚”</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6209a18d.html alt=æ—¥æœ¬è‡ªç„¶é¤Šç”Ÿå°ˆå®¶æ¨è–¦ï¼šèº«é«”æŸ”è»Ÿå£½å‘½é•·ï¼èº«é«”è®Šè»Ÿçš„å››å€‹ç¥•è¨£ï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/18aa0007361f7b6ea86d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6209a18d.html title=æ—¥æœ¬è‡ªç„¶é¤Šç”Ÿå°ˆå®¶æ¨è–¦ï¼šèº«é«”æŸ”è»Ÿå£½å‘½é•·ï¼èº«é«”è®Šè»Ÿçš„å››å€‹ç¥•è¨£ï¼>æ—¥æœ¬è‡ªç„¶é¤Šç”Ÿå°ˆå®¶æ¨è–¦ï¼šèº«é«”æŸ”è»Ÿå£½å‘½é•·ï¼èº«é«”è®Šè»Ÿçš„å››å€‹ç¥•è¨£ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/413f46d7.html alt=é€™é¡æˆ¿å­å€¼å¾—è­¦æƒ•ï¼Ÿå°ˆå®¶ï¼šè¬¹æ…è³¼è²· class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/91932a47-8406-4bcf-a396-832cae0f8574 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/413f46d7.html title=é€™é¡æˆ¿å­å€¼å¾—è­¦æƒ•ï¼Ÿå°ˆå®¶ï¼šè¬¹æ…è³¼è²·>é€™é¡æˆ¿å­å€¼å¾—è­¦æƒ•ï¼Ÿå°ˆå®¶ï¼šè¬¹æ…è³¼è²·</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ed99f279.html alt=ç¾è»èˆªæ¯å®Œæˆ159å¤©éƒ¨ç½²ï¼Œè¿”å›æ—¥æœ¬æ©«é ˆè³€ï¼Œå°ˆå®¶ï¼šå¨è„…ä¸æœƒæ¶ˆåœ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1f3b65702078424186c654edf8612984 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ed99f279.html title=ç¾è»èˆªæ¯å®Œæˆ159å¤©éƒ¨ç½²ï¼Œè¿”å›æ—¥æœ¬æ©«é ˆè³€ï¼Œå°ˆå®¶ï¼šå¨è„…ä¸æœƒæ¶ˆåœ>ç¾è»èˆªæ¯å®Œæˆ159å¤©éƒ¨ç½²ï¼Œè¿”å›æ—¥æœ¬æ©«é ˆè³€ï¼Œå°ˆå®¶ï¼šå¨è„…ä¸æœƒæ¶ˆåœ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4740e709.html alt=ç¾è»èˆªæ¯è¿”å›æ—¥æœ¬ï¼Œé‡å‹ç„¡äººæ©Ÿæˆ°é¬¥é€¼è¿‘ï¼Œå°ˆå®¶ï¼šä¸Ÿæ‰å¹»æƒ³æº–å‚™æ‰“ä»— class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/fde62c4d13084f6a93cd6928c979e424 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4740e709.html title=ç¾è»èˆªæ¯è¿”å›æ—¥æœ¬ï¼Œé‡å‹ç„¡äººæ©Ÿæˆ°é¬¥é€¼è¿‘ï¼Œå°ˆå®¶ï¼šä¸Ÿæ‰å¹»æƒ³æº–å‚™æ‰“ä»—>ç¾è»èˆªæ¯è¿”å›æ—¥æœ¬ï¼Œé‡å‹ç„¡äººæ©Ÿæˆ°é¬¥é€¼è¿‘ï¼Œå°ˆå®¶ï¼šä¸Ÿæ‰å¹»æƒ³æº–å‚™æ‰“ä»—</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/91d64d87.html alt=å°ˆå®¶é»è©•Natureä¸¨ä½ çš„æƒ…ç·’ä¿¡è™Ÿæˆ–å¯å°è¨˜åˆ°çµ„è›‹ç™½ä¸Šâ€”â€”é¦–æ¬¡å ±é“çµ„è›‹ç™½äº”ç¾¥è‰²èƒºåŒ–ä¿®é£¾åŠå…¶ç”Ÿç‰©å­¸åŠŸèƒ½ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RLEDa3yDZw3fDG style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/91d64d87.html title=å°ˆå®¶é»è©•Natureä¸¨ä½ çš„æƒ…ç·’ä¿¡è™Ÿæˆ–å¯å°è¨˜åˆ°çµ„è›‹ç™½ä¸Šâ€”â€”é¦–æ¬¡å ±é“çµ„è›‹ç™½äº”ç¾¥è‰²èƒºåŒ–ä¿®é£¾åŠå…¶ç”Ÿç‰©å­¸åŠŸèƒ½>å°ˆå®¶é»è©•Natureä¸¨ä½ çš„æƒ…ç·’ä¿¡è™Ÿæˆ–å¯å°è¨˜åˆ°çµ„è›‹ç™½ä¸Šâ€”â€”é¦–æ¬¡å ±é“çµ„è›‹ç™½äº”ç¾¥è‰²èƒºåŒ–ä¿®é£¾åŠå…¶ç”Ÿç‰©å­¸åŠŸèƒ½</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/40f2728c.html alt="é’å³¶è¯ä»ç«‹äº¤æ©‹è®Šå½¢äº†ï¼Ÿå°ˆå®¶è¿´æ‡‰ï¼šæ©‹æ¨‘æ­£å¸¸ åƒ…ç‚ºè¦–è¦ºèª¤å·®" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/S5bxGnIByoLBnf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/40f2728c.html title="é’å³¶è¯ä»ç«‹äº¤æ©‹è®Šå½¢äº†ï¼Ÿå°ˆå®¶è¿´æ‡‰ï¼šæ©‹æ¨‘æ­£å¸¸ åƒ…ç‚ºè¦–è¦ºèª¤å·®">é’å³¶è¯ä»ç«‹äº¤æ©‹è®Šå½¢äº†ï¼Ÿå°ˆå®¶è¿´æ‡‰ï¼šæ©‹æ¨‘æ­£å¸¸ åƒ…ç‚ºè¦–è¦ºèª¤å·®</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a7ad4761.html alt=å¤§æ•¸æ“šçµ±è¨ˆï¼š80%ç™Œç—‡è¡“å¾Œ3å¹´å¾©ç™¼è½‰ç§»ï¼Œç™‚æ³•æ›¿ç™Œæ‚£æ“‹éâ€œç”Ÿæ­»åŠ«â€ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/401e795037ab41d5a2481e58bccf0d23 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a7ad4761.html title=å¤§æ•¸æ“šçµ±è¨ˆï¼š80%ç™Œç—‡è¡“å¾Œ3å¹´å¾©ç™¼è½‰ç§»ï¼Œç™‚æ³•æ›¿ç™Œæ‚£æ“‹éâ€œç”Ÿæ­»åŠ«â€>å¤§æ•¸æ“šçµ±è¨ˆï¼š80%ç™Œç—‡è¡“å¾Œ3å¹´å¾©ç™¼è½‰ç§»ï¼Œç™‚æ³•æ›¿ç™Œæ‚£æ“‹éâ€œç”Ÿæ­»åŠ«â€</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/85f1b34e.html alt=ã€å°ˆå®¶å»ºè¨€ã€‘é—œæ–¼å°ç•¶å‰å±æ©Ÿçš„ç ”åˆ¤åŠå°ç­–å»ºè­° class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/fc020dcaf8a444cc9a1285abae2f57b9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/85f1b34e.html title=ã€å°ˆå®¶å»ºè¨€ã€‘é—œæ–¼å°ç•¶å‰å±æ©Ÿçš„ç ”åˆ¤åŠå°ç­–å»ºè­°>ã€å°ˆå®¶å»ºè¨€ã€‘é—œæ–¼å°ç•¶å‰å±æ©Ÿçš„ç ”åˆ¤åŠå°ç­–å»ºè­°</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/70f3ad5e.html alt=éª¨ç§‘å°ˆå®¶è©³è§£ï¼šåŠ›å­¸åˆºæ¿€èˆ‡åŠæœˆæ¿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/9e4f8f70a5ee4c75b501abe66ff2f3b4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/70f3ad5e.html title=éª¨ç§‘å°ˆå®¶è©³è§£ï¼šåŠ›å­¸åˆºæ¿€èˆ‡åŠæœˆæ¿>éª¨ç§‘å°ˆå®¶è©³è§£ï¼šåŠ›å­¸åˆºæ¿€èˆ‡åŠæœˆæ¿</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/35db2356.html alt="å¤§æ•¸æ“šæ·±åº¦å­¸ç¿’çš„æ–°åˆ©å™¨: å¿«é€Ÿç¥ç¶“ç¶²çµ¡è¨“ç·´:P-network" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d172925963f2465aa131058c05cd72f9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/35db2356.html title="å¤§æ•¸æ“šæ·±åº¦å­¸ç¿’çš„æ–°åˆ©å™¨: å¿«é€Ÿç¥ç¶“ç¶²çµ¡è¨“ç·´:P-network">å¤§æ•¸æ“šæ·±åº¦å­¸ç¿’çš„æ–°åˆ©å™¨: å¿«é€Ÿç¥ç¶“ç¶²çµ¡è¨“ç·´:P-network</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/04338c15.html alt="å¹³è‡ºèˆ‡å•†å®¶é€£éº¥æ¼”æˆ²è³£æ¬¡å“ å°ˆå®¶å»ºè­°é©æ™‚ä¿®æ”¹å»£å‘Šæ³•" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/04338c15.html title="å¹³è‡ºèˆ‡å•†å®¶é€£éº¥æ¼”æˆ²è³£æ¬¡å“ å°ˆå®¶å»ºè­°é©æ™‚ä¿®æ”¹å»£å‘Šæ³•">å¹³è‡ºèˆ‡å•†å®¶é€£éº¥æ¼”æˆ²è³£æ¬¡å“ å°ˆå®¶å»ºè­°é©æ™‚ä¿®æ”¹å»£å‘Šæ³•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2509e623.html alt=ä»€éº¼æ˜¯å¤§æ•¸æ“šçŸ¥è­˜å·¥ç¨‹ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/85164f0582334f6abca0e4421db5dbd1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2509e623.html title=ä»€éº¼æ˜¯å¤§æ•¸æ“šçŸ¥è­˜å·¥ç¨‹ï¼Ÿ>ä»€éº¼æ˜¯å¤§æ•¸æ“šçŸ¥è­˜å·¥ç¨‹ï¼Ÿ</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>