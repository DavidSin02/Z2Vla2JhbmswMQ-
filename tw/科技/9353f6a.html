<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>企業級服務網格架構之路解讀——Service Mesh在會話層解耦 | 极客快訊</title><meta property="og:title" content="企業級服務網格架構之路解讀——Service Mesh在會話層解耦 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/0a7e35c88f9e49e38339505c9e535538"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9353f6a.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9353f6a.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9353f6a.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9353f6a.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9353f6a.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9353f6a.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9353f6a.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9353f6a.html><meta property="article:published_time" content="2020-10-29T20:52:48+08:00"><meta property="article:modified_time" content="2020-10-29T20:52:48+08:00"><meta name=Keywords content><meta name=description content="企業級服務網格架構之路解讀——Service Mesh在會話層解耦"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/9353f6a.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>企業級服務網格架構之路解讀——Service Mesh在會話層解耦</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><blockquote><p>追本溯源，Service Mesh實際上是一種SDN，等同於OSI模型中的會話層。 每一次技術變革，必然要導致生產力和生產關係的變革，我們看到這種趨勢正在加速。本書中給出了企業上Service Mesh的路徑，可供廣大技術和管理人員參考。</p></blockquote><p>這是一本由Nginx贊助，O’Reilly出版社出品的關於服務網格的書籍，本書標題是</p><p>The Enterprise Path to Service Mesh，還有個副標題Decoupling at Layer 5，第一版發行於2018年8月8日。這本書一共61頁，本文是我對該書的一些解讀，讀者可以在Nginx的網站上免費下載閱讀完整內容。</p><p>本文篇幅內容會有點詳細，所以先給大家來點小福利鼓勵大家看完文章</p><p><strong>免費分享架構知識文檔和架構視頻資料，希望能幫助到您提高自己的技術升職加薪</strong></p><p><strong>也節省大家在網上搜索資料的時間來學習</strong></p><p><strong>轉發+關注私信回覆【架構資料】領取技術資料【面試資料】</strong></p><p><br></p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0a7e35c88f9e49e38339505c9e535538><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3b8e00ce1ff44ee5bc8d213a089bbae6><p class=pgc-img-caption></p></div><p><br></p><h2 class=pgc-h-arrow-right>關於作者</h2><p>本書作者是Lee Calcote，先後在Cisco、Seagate、Solarwind任職負責技術戰略決策，參與DMTF（Distributed Management Task Foundation）、CIS（Center for Internet Security），還是CNCF Ambassador、Docker Captain。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f7dba0e1bc6249249eaec23dbbf15812><p class=pgc-img-caption></p></div><p><br></p><p>圖書封面</p><p><br></p><p>下面看下本書目錄，大體瞭解下本書講了哪些內容。</p><h2 class=pgc-h-arrow-right>目錄</h2><p><strong>第1章 Service Mesh基礎</strong></p><ul><li>管控多個服務</li><li>什麼是Service Mesh</li><li>為什麼需要Service Mesh</li><li>結論</li></ul><p><strong>第2章 技術對比</strong></p><ul><li>不同的服務網格（還有Gateway）</li><li>容器編排</li><li>API Gateway</li><li>客戶端庫</li><li>總結</li></ul><p><strong>第3章 採納和演進</strong></p><ul><li>漸漸式採納</li><li>採納步驟</li><li>改造部署</li><li>架構演進</li><li>總結</li></ul><p><strong>第4章 定製和集成</strong></p><ul><li>可定製Sidecar</li><li>可擴展適配器</li><li>總結</li></ul><p><strong>第5章 總結</strong></p><ul><li>用還是不用？</li></ul><p>下面將對每章解讀。</p><h2 class=pgc-h-arrow-right>第1章 Service Mesh基礎</h2><p>微服務將原先的單體架構中的應用內通信，轉變為基於RPC的遠程通信，雖然這樣提高了研發效率，提高了開發語言選擇的多樣性，但是隨著單體應用的解體，原先的巨石散落為石塊變得四處都是，如何管理這些微服務就成了難題。當微服務的個數少的時候還可以通過人工配置的方式去管理，但隨著業務規模的增大，微服務的數量也可能呈指數級增長，如何協調管理成百上千的服務，這就需要有一套設計良好的框架。</p><p>一直以來都存在一個謬誤，那就是在分佈式系統中網絡是可靠的。實際上網絡是不可靠的，而且也是不安全的，如何保證應用調用和事務的安全性與可靠性，保護微服務的一個專門的基礎設施層Service Mesh就應運而生。</p><p>Service Mesh是建立在物理或者虛擬網絡層之上的，基於策略的微服務的流量控制，與一般的網絡協議不同的是它有以下幾個特點：</p><ul><li>開發者驅動</li><li>可配置策略</li><li>服務優先的網絡配置而不是協議</li></ul><p>本章主要介紹Service Mesh的定義和組成，為什麼要使用Service Mesh，它可以帶來哪些好處。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d3ce8c82f0974a49933fb25d6144af52><p class=pgc-img-caption></p></div><p><br>Service Mesh與傳統網絡的區別就是<strong>硬件或者虛擬網絡</strong>與<strong>軟件定義網絡（SDN）</strong>的區別，我們從上圖中可以看到物理和虛擬網絡中比起SDN還多了<strong>管理平面</strong>。</p><p>硬件網絡中控制平面與數據平面緊耦合，也就是說是與供應商綁定的，管理平面是獨立出來的。而SDN卻給了我們很多自由度，可以通過軟件的形式自定義網絡，例如Kubernetes中的CNI。</p><p>物理網絡有很多種拓撲類型，如星形拓撲、總線拓撲、環形拓撲、樹型拓撲、網狀拓撲等，大家可以去搜索拓撲網絡。不論是那種拓撲結構，總有一條路徑可以從一個節點路由到另一個節點，只是不同的拓撲類型效率不同，管理的複雜度不一樣罷了。</p><p>下圖是網狀拓撲，所謂網狀拓撲就是每個節點都可以跟所有其他節點直接互聯，這樣而這也是鏈接數最多一種拓撲，如果有n個節點的話，鏈接數就是n(n-1)。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a29b5def5b674dc6a66b51199ac5a159><p class=pgc-img-caption></p></div><h3 class=pgc-h-arrow-right>Service Mesh架構</h3><p>下圖是Conduit Service Mesh（現在已合併到Linkerd2中了）的架構圖，這是Service Mesh的一種典型的架構。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/821f69e79cd840f1ab9ca0504634bf35><p class=pgc-img-caption></p></div><p>Service Mesh中分為<strong>控制平面</strong>和<strong>數據平面</strong>，當前流行的兩款開源的Service Mesh Istio和Linkerd實際上都是這種構造，只不過Istio的劃分更清晰，而且部署更零散，很多組件都被拆分，控制平面中包括Mixer、Pilot、Citadel，數據平面默認是用Envoy；而Linkerd中只分為linkerd做數據平面，namerd作為控制平面。</p><p><br><strong>控制平面</strong></p><p>控制平面的特點：</p><ul><li>不直接解析數據包</li><li>與控制平面中的代理通信，下發策略和配置</li><li>負責網絡行為的可視化</li><li>通常提供API或者命令行工具可用於配置版本化管理，便於持續集成和部署</li></ul><p><strong>數據平面</strong></p><p>數據平面的特點：</p><ul><li>通常是按照無狀態目標設計的，但實際上為了提高流量轉發性能，需要緩存一些數據，因此無狀態也是有爭議的</li><li>直接處理入站和出站數據包，轉發、路由、健康檢查、負載均衡、認證、鑑權、產生監控數據等</li><li>對應用來說透明，即可以做到無感知部署</li></ul><h3 class=pgc-h-arrow-right>Service Mesh的價值所在</h3><p>Service Mesh中服務是一等公民，它提供L5的網絡流量管理，並提供以下功能：</p><p><strong>可觀察性</strong></p><p>還是拿Istio做例子，Mixer通過適配器將應用的遙測數據發送給後端監控、日誌、認證和份額管理系統。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/26634fe37af84dc684c26876e123a118><p class=pgc-img-caption></p></div><p>從上圖可以看到Mixer適配器可以對接多種監控和日誌後端。</p><p><strong>流量控制</strong></p><p>文中給出的例子是超時、重試、截止時間和速率限制。</p><p><strong>安全性</strong></p><p>下圖是Istio中安全通信路徑的示意圖。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8d235525f749490b9e3e9b0711002968><p class=pgc-img-caption></p></div><p>一般的安全性都是通過證書的方式實現的。Sidecar代理負責證書生命週期的管理，包括證書的生成、分發、刷新和註銷。從圖中還可以看到，在Pod內部sidecar會與應用容器之間建立本地TCP連接，其中使用mTLS（雙向傳輸層加密）。這一點是非常重要的，因為一個節點上甚至一個Pod內都不一定運行一個容器，容器可能會被暴露到外部訪問，保證傳輸層的雙向加密，可以保證流量傳輸的安全。</p><p><strong>延遲和故障注入</strong></p><p>這個功能對於榮宰容災和故障演練特別有用。通過人為的向系統中注入故障，如HTTP 500錯誤，通過分析分佈式應用的行為，檢驗系統的健壯性。</p><p><br>在L5解耦</p><p>這是本書最有重要的一個觀點，重要到要放到副標題，熟悉OSI模型的人都知道L5是什麼。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d3c8400d6cee4b1ba8737e153c69a10f><p class=pgc-img-caption></p></div><p><br></p><p>OSI模型（圖片來自CSDN）</p><p><br></p><p>Service Mesh是在開發和運維之間植入的一個基礎設施層。它將服務通信的關注點分離出來，在TCP/IP層之上抽象出一層通用功能。Service Mesh的引入直接導致生產關係的改變進而提高生產效率。具體表現在：</p><ul><li><strong>運維人員</strong>在修改服務重試超時時間之前無需再知會<strong>開發人員</strong>。</li><li><strong>客戶成功</strong>部門在撤銷客戶的訪問權限前無需再知會<strong>運維</strong>。</li><li><strong>產品Owner</strong>可以針對特定服務，根據用戶選擇的套餐執行配額管理。</li><li><strong>開發人員</strong>可隨時將新版本功能重定向到beta版本，不需要<strong>運維人員</strong>干涉。</li></ul><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/cd330b50ea324d96a74c3e11521b46af><p class=pgc-img-caption></p></div><p>這種職責的解耦大大加速了軟件的迭代速度，總之你可以把Service Mesh作為OSI模型中的會話層。</p><p><br>第2章 技術對比</p><p>這一章主要講解Service Mesh技術之間的區別，Service Mesh與其他相關技術之間的區別，讀者可以直接瀏覽該網站來查看對比：layer5.io/service-mes…</p><p>為什麼有了如Kubernetes這樣的容器編排我們還需要Service Mesh呢，下表是對容器編排調度器的核心功能和缺少的服務級別能力對比。</p><p>核心能力缺少的服務級別能力集群管理熔斷調度L7細粒度的流量控制編排器和主機維護混沌測試服務發現金絲雀部署網絡和負載均衡超時、重試、 budget和deadline有狀態服務按請求路由多租戶、多region策略簡單的應用監控檢查和性能監控傳輸層安全（加密）應用部署身份和訪問控制配置和祕鑰管理配額管理/協議轉換（REST、gRPC）</p><p>以上是容器編排中缺少的服務級別的能力，當讓類似Kubernetes這樣的容器編排系統中也有服務管理的能力，如Ingress Controller，但是它僅僅負責集群內的服務對外暴露的反向代理，每個Ingress Controller的能力受限於Kubernetes的編程模型。對服務進行管理還可以通過例如Kong、基於雲的負載均衡器、API Gateway和API管理來實現，在沒有Service Mesh的時候還需要如Finagle、Hystrix、Ribbon客戶端庫的加持。</p><p>下圖是一個使用<strong>客戶端庫</strong>將應用與服務治理緊耦合的示意圖。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/9841003809d1495f8fbcd0801297eab9><p class=pgc-img-caption></p></div><p>從圖中我們可以看到，應用程序代碼與客戶端度庫緊耦合在一起，不同的服務團隊需要一起協調超時和重試機制等。容器編排更適用於分佈式應用，API Gateway通常只需要部署在系統邊緣即可，不需要在每個應用中都部署，而Service Mesh卻需要在每個服務或者說節點中部署。</p><h2 class=pgc-h-arrow-right>第3章 採納和演進</h2><p>沒有人會一下子採納Service Mesh架構的所有組件，或者一次性將所有的應用都改造成Service Mesh的，都是漸漸式採納，從非核心繫統開始改造。採納Service Mesh就兩種路徑：</p><ul><li>全盤採納：通常對於新應用來說才會這樣做，也叫做Greenfiled項目</li><li>漸進式採納：舊系統改造，也叫做Brownfiled項目</li></ul><p>通過價值驅動、開發人員的接受程度、自底向上的選擇你最急切需要的功能，可能是可觀察性或RPC的負載均衡等等，先採納部分功能，然後通過漸漸式的方式來演進。</p><p><strong>架構演進</strong></p><p>我們在前面看到了通過<strong>客戶端庫</strong>來治理服務的架構圖，那是我們在改造成Service Mesh架構前使用微服務架構通常的形式，下圖是使用Service Mesh架構的最終形式。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d4a1ab01016b4632b768f3a790b7e257><p class=pgc-img-caption></p></div><p><br>當然在達到這一最終形態之前我們需要將架構一步步演進，下面給出的是參考的演進路線。</p><h3 class=pgc-h-arrow-right>Ingress或邊緣代理</h3><p>如果你使用的是Kubernetes做容器編排調度，那麼在進化到Service Mesh架構之前，通常會使用Ingress Controller，做集群內外流量的反向代理，如使用Traefik或Nginx Ingress Controller。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a86c18d610b0476dba37440ce63fe531><p class=pgc-img-caption></p></div><p>這樣只要利用Kubernetes的原有能力，當你的應用微服務化並容器化需要開放外部訪問且只需要L7代理的話這種改造十分簡單，但問題是無法管理服務間流量。</p><h3 class=pgc-h-arrow-right>路由器網格</h3><p>Ingress或者邊緣代理可以處理進出集群的流量，為了應對集群內的服務間流量管理，我們可以在集群內加一個Router層，即路由器層，讓集群內所有服務間的流量都通過該路由器。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/6d8cae4bfc11497cb5fcce8330c6f95f><p class=pgc-img-caption></p></div><p>這個架構無需對原有的單體應用和新的微服務應用做什麼改造，可以很輕易的遷移進來，但是當服務多了管理起來就很麻煩。</p><h3 class=pgc-h-arrow-right>Proxy per Node</h3><p>這種架構是在每個節點上都部署一個代理，如果使用Kubernetes來部署的話就是使用DaemonSet對象，Linkerd第一代就是使用這種方式部署的，一代的Linkerd使用Scala開發，基於JVM比較消耗資源，二代的Linkerd使用Go開發。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8a5a9d5fa3014ebbacc33a8f8b4f0493><p class=pgc-img-caption></p></div><p>這種架構有個好處是每個節點只需要部署一個代理即可，比起在每個應用中都注入一個sidecar的方式更節省資源，而且更適合基於物理機/虛擬機的大型單體應用，但是也有一些副作用，比如粒度還是不夠細，如果一個節點出問題，該節點上的所有服務就都會無法訪問，對於服務來說不是完全透明的。</p><h3 class=pgc-h-arrow-right>Sidecar代理/Fabric模型</h3><p>這個一般不會成為典型部署類型，當企業的服務網格架構演進到這一步時通常只會持續很短時間，然後就會增加控制平面。跟前幾個階段最大的不同就是，應用程序和代理被放在了同一個部署單元裡，可以對應用程序的流量做更細粒度的控制。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4ecf5af64b89428f883a0121582d224a><p class=pgc-img-caption></p></div><p>這已經是最接近Service Mesh架構的一種形態了，唯一缺的就是控制平面了。所有的sidecar都支持熱加載，配置的變更可以很容易的在流量控制中反應出來，但是如何操作這麼多sidecar就需要一個統一的控制平面了。</p><h3 class=pgc-h-arrow-right>Sidecar代理/控制平面</h3><p>下面的示意圖是目前大多數Service Mesh的架構圖，也可以說是整個Service Mesh架構演進的最終形態。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fb78ebb0ecc64ef095eb81133266ff7b><p class=pgc-img-caption></p></div><p>這種架構將代理作為整個服務網格中的一部分，使用Kubernetes部署的話，可以通過以sidecar的形式注入，減輕了部署的負擔，可以對每個服務的做細粒度權限與流量控制。但有一點不好就是為每個服務都注入一個代理會佔用很多資源，因此要想方設法降低每個代理的資源消耗。</p><h3 class=pgc-h-arrow-right>多集群部署和擴展</h3><p>以上都是單個服務網格集群的架構，所有的服務都位於同一個集群中，服務網格管理進出集群和集群內部的流量，當我們需要管理多個集群或者是引入外部的服務時就需要網格擴展和多集群配置。</p><p><br>第4章 定製和集成</p><p>例如Istio這樣的Service Mesh中有很多地方可以給大家定製，例如作為數據平面的sidecar，雖然默認使用的是Envoy，但是你可以開發自己的sidecar代理；還有Mixer中的各種adpater，你也可以開發自己的adapter來擴展遙測和鑑權功能，Consul Connect就是個例子。</p><p>當前可選擇的開源的代理可以在landscape裡找到，例如使用nginMesh替代Envoy作為數據平面。下圖是使用nginMesh作為sidecar的架構圖。</p><p><strong>nginMesh</strong></p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c49cfb8beba848eab045a47f4f7de5a0><p class=pgc-img-caption></p></div><p>通過擴展Istio Mixer adapter來對接不同的監控後端。</p><p><br></p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fd754593fdb84ba7be4a8ad085d8ae57><p class=pgc-img-caption></p></div><p><strong>SOFAMosn</strong></p><p>還有螞蟻金服開源的Go語言版的數據平面SOFAMosn，這是也兼容Istio的SOFAMesh的一部分，也可以單獨作為代理使用，詳見：SOFAMesh & SOFA MOSN—基於Istio構建的用於應對大規模流量的Service Mesh解決方案。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2fbaabf9d32a4d42856ce49a3fee5094><p class=pgc-img-caption></p></div><p>SOFAMosn的模塊架構圖。</p><div class=pgc-img><img alt="企業級服務網格架構之路解讀——Service Mesh在會話層解耦" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ede0e733fb804d99b05d6bbca31ad82e><p class=pgc-img-caption></p></div><p>在未來我們會看到更多定製的數據平面和Mixer適配器出現。</p><h2 class=pgc-h-arrow-right>總結</h2><p><br></p><h3 class=pgc-h-arrow-right>用還是不用</h3><p>既然Service Mesh這麼好，那到底用還是不用，如果用的話應該什麼時候用，應該怎麼用？這取決於您的公司的雲原生技術的成熟度曲線的位置，服務的規模，業務核心和底層基礎設施管理是否適應等。</p><p>技術總是在不斷向前發展，容器出現後，解決的軟件環境和分發的問題；但是如何管理分佈式的應用呢，又出現了容器編排軟件；容器編排軟件解決的微服務的部署問題，但是對於微服務的治理的功能太弱，這才出現了Service Mesh，當然Service Mesh也不是萬能的，下一步會走向何方呢？會是Serverless嗎？我們拭目以待。</p><p>Service Mesh還有一些遺留的問題沒有解決或者說比較薄弱的功能：</p><ul><li>分佈式應用的調試，可以參考squash</li><li>服務拓撲和狀態圖，可以參考kiali和vistio</li><li>多租戶和多集群的支持</li><li>白盒監控、支持APM</li><li>加強負載測試工具slow_cooker、fortio、lago等</li><li>更高級的fallback路徑支持</li><li>可拔插的證書授權組建，支持外部的CA</li></ul><p>下面是採納Service Mesh之前需要考慮的因素。</p><p>因素可以考慮使用Service Mesh強烈建議使用Service Mesh服務通信基本無需跨服務間的通訊十分要求服務間通訊可觀察性只關注邊緣的指標即可內部服務和邊緣指標都要考慮以更好的瞭解服務的行為客戶關注主要關注外部API的體驗</p><p>內外用戶是隔離的內部外部用戶沒有區別體驗一致API的界限API主要是作為客戶端為客戶提供，內部的API與外部是分離的API即產品，API就是你的產品能力安全模型通過邊緣、防火牆可信內部網絡的方式控制安全所有的服務都需要認證和鑑權、服務間要加密、zero-trust安全觀念</p><p>在考慮完上述因素後，儘量選擇開源的平臺和解決方案，還要想好開源軟件的邊界在哪裡，哪些能力將是企業版才會提供的。</p><p><br>最後小編祝大家都能工作順利</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>企業級</a></li><li><a>服務</a></li><li><a>網格架構</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/720d6d3b.html alt=北海人民不能錯過的掌上生活服務辦理平臺 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ad2c0c816b5a4c94982e13f61805144f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/720d6d3b.html title=北海人民不能錯過的掌上生活服務辦理平臺>北海人民不能錯過的掌上生活服務辦理平臺</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/03d16469.html alt=阿里雲彈性伸縮服務簡介，彈性伸縮服務入門掃盲 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1538214769522e3e469ade5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/03d16469.html title=阿里雲彈性伸縮服務簡介，彈性伸縮服務入門掃盲>阿里雲彈性伸縮服務簡介，彈性伸縮服務入門掃盲</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3998ae89.html alt=服務治理最佳實踐：如何依據參數值進行服務路由、鑑權、限流？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/3f6fb254f0cc4ba390695e1d561d4a5c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3998ae89.html title=服務治理最佳實踐：如何依據參數值進行服務路由、鑑權、限流？>服務治理最佳實踐：如何依據參數值進行服務路由、鑑權、限流？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/47c5c6aa.html alt=白水公安交警文明交通勸導志願服務活動常態化 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/48d1b1a47c7d494f8c8d2d104ec56544 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/47c5c6aa.html title=白水公安交警文明交通勸導志願服務活動常態化>白水公安交警文明交通勸導志願服務活動常態化</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ba2ab10c.html alt=垃圾分類人人做！“站桶”服務我先行 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/SFGevXxI3MRNxJ style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ba2ab10c.html title=垃圾分類人人做！“站桶”服務我先行>垃圾分類人人做！“站桶”服務我先行</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4679df39.html alt=管委會副主任於梅檢查指導政務服務中心工作 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/RG4b9NkIdNjk7v style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4679df39.html title=管委會副主任於梅檢查指導政務服務中心工作>管委會副主任於梅檢查指導政務服務中心工作</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/da2278e2.html alt="單縣：搶抓水利建設 服務農業生產" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/da2278e2.html title="單縣：搶抓水利建設 服務農業生產">單縣：搶抓水利建設 服務農業生產</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/576365de.html alt="文昌服務窗口節後亮出好狀態 收心聚力忙服務" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/576365de.html title="文昌服務窗口節後亮出好狀態 收心聚力忙服務">文昌服務窗口節後亮出好狀態 收心聚力忙服務</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/374b019f.html alt=海西：行政服務窗口收心歸位狀態佳 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/SCyWPnD81ibeFW style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/374b019f.html title=海西：行政服務窗口收心歸位狀態佳>海西：行政服務窗口收心歸位狀態佳</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/af218e13.html alt=節後第一個工作日，政務服務中心各窗口迅速進入工作狀態 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/SCybbHR1vt3UiX style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/af218e13.html title=節後第一個工作日，政務服務中心各窗口迅速進入工作狀態>節後第一個工作日，政務服務中心各窗口迅速進入工作狀態</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/180166ae.html alt="Microsoft 365服務出現全球大規模宕機 Teams等服務均無法使用" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/SBwbaFWH7J1n4s style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/180166ae.html title="Microsoft 365服務出現全球大規模宕機 Teams等服務均無法使用">Microsoft 365服務出現全球大規模宕機 Teams等服務均無法使用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b0f0ddcc.html alt=微軟多個在線服務中斷，全美911系統同時宕機 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b0f0ddcc.html title=微軟多個在線服務中斷，全美911系統同時宕機>微軟多個在線服務中斷，全美911系統同時宕機</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6f554a6a.html alt="蘋果多項服務遭遇宕機 涉及App Store iCloud" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/SC26Qv9DN1HG5r style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6f554a6a.html title="蘋果多項服務遭遇宕機 涉及App Store iCloud">蘋果多項服務遭遇宕機 涉及App Store iCloud</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/40898e8a.html alt=員工服務中心提升工作效能實現業務量穩步增長 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/40898e8a.html title=員工服務中心提升工作效能實現業務量穩步增長>員工服務中心提升工作效能實現業務量穩步增長</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5fe89566.html alt="企業級 GIT（分佈式版本控制系統）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/153553805994080f727247a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5fe89566.html title="企業級 GIT（分佈式版本控制系統）">企業級 GIT（分佈式版本控制系統）</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>