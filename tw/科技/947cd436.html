<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Spring Security OAuth2 å…¥é–€ | æå®¢å¿«è¨Š</title><meta property="og:title" content="Spring Security OAuth2 å…¥é–€ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/30b7584056744a0eb2d53d1f039f7bb7"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/947cd436.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/947cd436.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/947cd436.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/947cd436.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/947cd436.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/947cd436.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/947cd436.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/947cd436.html><meta property="article:published_time" content="2020-11-14T21:00:29+08:00"><meta property="article:modified_time" content="2020-11-14T21:00:29+08:00"><meta name=Keywords content><meta name=description content="Spring Security OAuth2 å…¥é–€"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/947cd436.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Spring Security OAuth2 å…¥é–€</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><ul><li>1. æ¦‚è¿°</li><li>2. å¼•å…¥ Spring Security OAuth2 ä¾è³´</li><li>3. é…ç½®è³‡æºæœå‹™å™¨</li><li>4. é…ç½®æˆæ¬Šæœå‹™å™¨</li><li class=ql-indent-1>4.1 æˆæ¬Šç¢¼æ¨¡å¼</li><li>Spring Security Setting</li><li class=ql-indent-1>4.2 å¯†ç¢¼æ¨¡å¼</li><li class=ql-indent-1>4.3 ç°¡åŒ–æ¨¡å¼</li><li class=ql-indent-1>4.4 å®¢æˆ¶ç«¯æ¨¡å¼</li><li class=ql-indent-1>4.5 å¦‚ä½•é¸æ“‡ï¼Ÿ</li><li class=ql-indent-1>4.6 ç‚ºä»€éº¼æœ‰ Client ç·¨è™Ÿå’Œå¯†ç¢¼</li><li>5. åˆ·æ–°ä»¤ç‰Œ</li><li class=ql-indent-1>5.1 ç²å–åˆ·æ–°ä»¤ç‰Œ</li><li class=ql-indent-1>5.2 â€œåˆ·æ–°â€è¨ªå•ä»¤ç‰Œ</li><li class=ql-indent-1>5.3 ç‚ºä»€éº¼éœ€è¦æœ‰åˆ·æ–°ä»¤ç‰Œ</li><li>6. åˆªé™¤ä»¤ç‰Œ</li><li class=ql-indent-1>6.1 åˆªé™¤è¨ªå•ä»¤ç‰Œ</li><li class=ql-indent-1>6.2 åˆªé™¤åˆ·æ–°ä»¤ç‰Œ</li><li class=ql-indent-1>6.3 RFC7009 - OAuth2 Token Revocation</li><li>7. ä»¤ç‰Œå…ƒæ•¸æ“š</li><li>666. å½©è›‹</li></ul><hr><h1><strong>1. æ¦‚è¿°</strong></h1><p>æœ¬æ–‡ï¼Œæˆ‘å€‘ä¾†å…¥é–€ Spring Security OAuth2.0 çš„ä½¿ç”¨ã€‚é€šéæœ¬æ–‡ï¼Œå¸Œæœ›ä½ å° OAuth2.0 æœ‰ä¸€æ¬¡èº«è‡¨å…¶å¢ƒçš„æ„Ÿå—ã€‚</p><p>å¦å¤–ï¼Œé€™æ˜¯ä¸€ç¯‡å…¥é–€çš„æ–‡ç« ï¼Œæ‰€ä»¥å¯¦éš›å ´æ™¯ä¸‹ï¼Œéœ€è¦åšä¸€äº›å¾®èª¿ã€‚ç•¶ç„¶ï¼Œéœ€è¦å¾®èª¿çš„åœ°æ–¹ï¼Œç­†è€…æœƒåœ¨ç¤ºä¾‹ä¸­èªªæ˜ï¼Œä»¥å…èª¤å°ã€‚</p><p>å¦‚æœä½ æ˜¯ OAuth2.0 çš„èŒæ–°ï¼Œå»ºè­°å…ˆé€šè®€é˜®ä¸€å³°å¤§ç¥çš„ ã€Šç†è§£OAuth 2.0ã€‹ã€‚å› ç‚ºï¼Œæœ¬æ–‡ä¸æœƒå»é—¡è¿° OAuth2.0 æ¦‚å¿µéƒ¨åˆ†çš„å…§å®¹ã€‚æˆ–è€…ï¼Œä¹Ÿå¯ä»¥çœ‹çœ‹ ã€ŠOAuth 2.0æœ€ç°¡åš®å°ã€‹ ï¼Œæ¯”è¼ƒç”Ÿå‹•å½¢è±¡ã€‚</p><p>é–±è®€å®Œæœ¬æ–‡å¾Œï¼Œä½ æƒ³è¦æ›´åŠ æ·±å…¥çš„ç†è§£ OAuth2.0 ï¼Œå¯ä»¥é–±è®€å¦‚ä¸‹å…©æœ¬æ›¸ç±ï¼š</p><ul><li>ã€ŠOAuth2 in Actionã€‹ é‡åŸç†</li><li>ã€ŠOAuth2 2.0 Cookbookã€‹ é‡å¯¦è¸ï¼ŒåŸºæ–¼ Spring Security OAuth2 ã€‚</li></ul><p>é–±è®€å®Œæœ¬æ–‡å¾Œï¼Œä½ æƒ³è¦äº†è§£æºç¢¼ï¼Œå¯ä»¥é–±è®€è€å¾çš„å…©ç¯‡æ–‡ç« ï¼š</p><ul><li>ã€ŠReï¼šå¾é›¶é–‹å§‹çš„Spring Security OAuth2ï¼ˆäºŒï¼‰ã€‹</li><li>ã€ŠReï¼šå¾é›¶é–‹å§‹çš„Spring Security OAuth2ï¼ˆä¸‰ï¼‰ã€‹</li></ul><hr><p>OKï¼Œä¸€æ³¢å®‰åˆ©ä¹‹å¾Œï¼Œæˆ‘å€‘ä¾†ä¸€èµ·é€²å…¥æ­£æ–‡ã€‚å°æ–¼ Spring Security OAuth2 çš„é…ç½®ï¼Œå¤§é«”ä¾†èªªï¼Œå°±æ˜¯<strong>å…©æ­¥</strong>ï¼š</p><ol><li>é…ç½®æˆæ¬Šæœå‹™å™¨( AuthorizationServer )</li><li>é…ç½®è³‡æºæœå‹™å™¨( ResourceServer )</li></ol><h1><strong>2. å¼•å…¥ Spring Security OAuth2 ä¾è³´</strong></h1><p>åœ¨ pom.xml æ–‡ä»¶ä¸­ï¼Œå¼•å…¥å¦‚ä¸‹:</p><pre>&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;1.5.16.RELEASE&lt;/version&gt; &lt;relativePath /&gt; &lt;!-- lookup parent from repository --&gt;&lt;/parent&gt;&lt;dependencies&gt; &lt;!-- for Spring MVC --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- for Spring Security --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- for OAuth 2.0 --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.security.oauth&lt;/groupId&gt; &lt;artifactId&gt;spring-security-oauth2&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;</pre><p>å› ç‚ºï¼Œæˆ‘å€‘ä½¿ç”¨çš„æ˜¯ SpringBoot çš„ç‰ˆæœ¬ç‚º 1.5.16.RELEASE ï¼Œæ‰€ä»¥ä½¿ç”¨çš„ Spring Security çš„ç‰ˆæœ¬ç‚º 4.2.8.RELEASE ï¼ŒSpring Security OAuth2 çš„ç‰ˆæœ¬ç‚º 2.2.0.15.RELEASE ã€‚</p><h1><strong>3. é…ç½®è³‡æºæœå‹™å™¨</strong></h1><p>ä¸€èˆ¬æƒ…æ³ä¸‹ï¼Œè³‡æºæœå‹™å™¨æŒ‡çš„æ˜¯ï¼Œæˆ‘å€‘æä¾› API çš„æ‡‰ç”¨æˆ–æœå‹™ã€‚ä¾‹å¦‚ï¼Œè¨‚å–®æœå‹™ã€å•†å“æœå‹™ã€‚<strong>è€ƒæ…®åˆ°è®“æ•´å€‹ç¤ºä¾‹æ›´åŠ ç°¡å–®ï¼Œæœ¬æ–‡å…ˆå°‡å®ƒå’Œæˆæ¬Šæœå‹™å™¨æ”¾åœ¨ä¸€å€‹ Maven é …ç›®ä¸­</strong>ã€‚</p><p>â‘  å‰µå»ºä¸€å€‹ Controller é¡</p><pre>/** * ç¤ºä¾‹æ¨¡å¡Š Controller */@RestController@RequestMapping("/api/example")public class ExampleController { @RequestMapping("/hello") public String hello() { return "world"; }}</pre><ul><li>éå¸¸ç°¡å–®ï¼Œé€™æ˜¯ä¸€å€‹ç¤ºä¾‹æ¨¡å¡Šçš„ Controller ï¼Œæä¾› /api/example/hello æ¥å£ã€‚</li></ul><p>â‘¡ é…ç½®è³‡æºæœå‹™å™¨</p><pre>// è³‡æºæœå‹™é…ç½®@Configuration@EnableResourceServerpublic class OAuth2ResourceServer extends ResourceServerConfigurerAdapter { @Override public void configure(HttpSecurity http) throws Exception { http.authorizeRequests() // å° "/api/**" é–‹å•Ÿèªè­‰ .anyRequest() .authenticated() .and() .requestMatchers() .antMatchers("/api/**"); }}</pre><ul><li>@Configuration è¨»è§£ï¼Œä¿è­‰ OAuth2ResourceServer èƒ½å¤ è¢« SpringBoot æƒæåˆ°é…ç½®ã€‚</li><li>@EnableResourceServer è¨»è§£ï¼Œé–‹å•Ÿè³‡æºæœå‹™å™¨ã€‚</li><li>ç¹¼æ‰¿( extends ) ResourceServerConfigurerAdapter é¡ï¼Œä¸¦è¦†å¯« #configure(HttpSecurity http) æ–¹æ³•ï¼Œé…ç½®å° HTTP è«‹æ±‚ä¸­ï¼ŒåŒ¹é… /api/**" è·¯å¾‘ï¼Œé–‹å•Ÿèªè­‰çš„é©—è­‰ã€‚</li></ul><h1><strong>4. é…ç½®æˆæ¬Šæœå‹™å™¨</strong></h1><p>åœ¨ OAuth2.0 ä¸­ï¼Œå®šç¾©äº†<strong>å››ç¨®</strong>æˆæ¬Šæ¨¡å¼ï¼š</p><ul><li>æˆæ¬Šç¢¼æ¨¡å¼( authorization code )</li><li>å¯†ç¢¼æ¨¡å¼( resource owner password credentials )</li><li>ç°¡åŒ–æ¨¡å¼( implicit )</li><li>å®¢æˆ¶ç«¯æ¨¡å¼( client credentials )</li></ul><p>æ‰€ä»¥ï¼Œç­†è€…åœ¨ SpringBoot-Labs/lab-02 ç›®éŒ„ä¸‹ï¼Œæ¯ä¸€ç¨®æ–¹å¼ï¼Œéƒ½æä¾›äº†ä¸€å€‹ Maven é …ç›®ç¤ºä¾‹ã€‚</p><p><strong>4.1 æˆæ¬Šç¢¼æ¨¡å¼</strong></p><p>Maven é …ç›®çµæ§‹å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt="Spring Security OAuth2 å…¥é–€" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/30b7584056744a0eb2d53d1f039f7bb7><p class=pgc-img-caption></p></div><p>Maven é …ç›®çµæ§‹</p><p>å°æ‡‰ GitHub åœ°å€ï¼šhttps://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-02/authorization-code-server</p><p>â‘  é…ç½®æˆæ¬Šæœå‹™å™¨</p><pre>// æˆæ¬Šæœå‹™å™¨é…ç½®@Configuration@EnableAuthorizationServerpublic class OAuth2AuthorizationServer extends AuthorizationServerConfigurerAdapter { @Override public void configure(ClientDetailsServiceConfigurer clients) throws Exception { clients.inMemory() // &lt;1&gt; // &lt;2&gt; begin ... .withClient("clientapp").secret("112233") // Client è³¬è™Ÿã€å¯†ç¢¼ã€‚ .redirectUris("http://localhost:9001/callback") // é…ç½®å›èª¿åœ°å€ï¼Œé¸å¡«ã€‚ .authorizedGrantTypes("authorization_code") // æˆæ¬Šç¢¼æ¨¡å¼ .scopes("read_userinfo", "read_contacts") // å¯æˆæ¬Šçš„ Scope // &lt;2&gt; end ...// .and().withClient() // å¯ä»¥ç¹¼çºŒé…ç½®æ–°çš„ Client // &lt;3&gt; ; }}</pre><ul><li>@Configuration è¨»è§£ï¼Œä¿è­‰ OAuth2AuthorizationServer èƒ½å¤ è¢« SpringBoot æƒæåˆ°é…ç½®ã€‚</li><li>@EnableAuthorizationServer è¨»è§£ï¼Œé–‹å•Ÿæˆæ¬Šæœå‹™å™¨ã€‚</li><li>&lt;1> è™•ï¼ŒåŸºæ–¼å…§å­˜ï¼Œç‚ºäº†æ–¹ä¾¿æ¸¬è©¦ã€‚å¯¦éš›æƒ…æ³ä¸‹ï¼Œæœ€å¥½æ”¾å…¥<strong>æ•¸æ“šåº«</strong>ä¸­ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚</li><li>&lt;2> è™•ï¼Œå‰µå»ºä¸€å€‹ Client é…ç½®ã€‚</li><li>&lt;3> è™•ï¼Œå¯ä»¥ä½¿ç”¨ #and() æ–¹æ³•ï¼Œç¹¼çºŒæ·»åŠ å¦å¤–çš„ Client é…ç½®ã€‚</li></ul><p>â‘¡ é…ç½®ç™»é™¸è³¬è™Ÿ</p><p>å‰µå»º application.properties æ–‡ä»¶ï¼Œä¸¦é…ç½®å¦‚ä¸‹ï¼š</p><pre># Spring Security Settingsecurity.user.name=yunaisecurity.user.password=1024</pre><ul><li>é€™è£¡é…ç½®äº†ä¸€å€‹è³¬è™Ÿç‚º "yunai" ï¼Œå¯†ç¢¼ç‚º "1024" çš„ç™»é™¸è³¬æˆ¶ã€‚</li><li>å¯¦éš›ç”Ÿç”¢ç’°å¢ƒä¸‹ï¼Œç™»é™¸è³¬è™Ÿçš„æ•¸æ“šï¼Œè‚¯å®šæ˜¯æ”¾åœ¨<strong>æ•¸æ“šåº«</strong>ä¸­ã€‚</li></ul><p>â‘¢ å•Ÿå‹•é …ç›®</p><pre>@SpringBootApplicationpublic class Application { public static void main(String[] args) { SpringApplication.run(Application.class, args); }}</pre><p>å•Ÿå‹•é …ç›®</p><p>â‘£ ç²å–æˆæ¬Šç¢¼</p><p>4.1 ç€è¦½å™¨æ‰“é–‹ http://localhost:8080/oauth/authorize?client_id=clientapp&redirect_uri=http://localhost:9001/callback&response_type=code&scope=read_userinfo</p><ul><li>client_id åƒæ•¸ï¼Œ<strong>å¿…å‚³</strong>ï¼Œç‚ºæˆ‘å€‘åœ¨ OAuth2AuthorizationServer ä¸­é…ç½®çš„ Client çš„ç·¨è™Ÿã€‚</li><li>redirect_url åƒæ•¸ï¼Œ<strong>å¯é¸</strong>ï¼Œå›èª¿åœ°å€ã€‚ç•¶ç„¶ï¼Œå¦‚æœ client_id å°æ‡‰çš„ Client æœªé…ç½® redirectUris å±¬æ€§ï¼Œæœƒå ±éŒ¯ã€‚</li><li>response_type åƒæ•¸ï¼Œ<strong>å¿…å‚³</strong>ï¼Œè¿”å›çµæœç‚º<strong>æˆæ¬Šç¢¼</strong>ã€‚</li><li>scope åƒæ•¸ï¼Œ<strong>å¯é¸</strong>ï¼Œç”³è«‹æˆæ¬Šçš„ Scope ã€‚å¦‚æœå¤šå€‹ï¼Œä½¿ç”¨é€—è™Ÿåˆ†éš”ã€‚</li><li>state åƒæ•¸ï¼Œ<strong>å¯é¸</strong>ï¼Œè¡¨ç¤ºå®¢æˆ¶ç«¯çš„ç•¶å‰ç‹€æ…‹ï¼Œå¯ä»¥æŒ‡å®šä»»æ„å€¼ï¼Œèªè­‰æœå‹™å™¨æœƒåŸå°ä¸å‹•åœ°è¿”å›é€™å€‹å€¼ã€‚</li><li class=ql-indent-1><em>æœªåœ¨ä¸Šè¿° URL ä¸­é«”ç¾å‡ºä¾†</em>ã€‚</li></ul><p>4.2 ç€è¦½å™¨æ‰“é–‹å¾Œï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt="Spring Security OAuth2 å…¥é–€" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/2c0398b6bfa446ad8f35c8a8cff08e0c><p class=pgc-img-caption></p></div><p>ç€è¦½å™¨</p><ul><li>è¼¸å…¥åœ¨ ã€Œâ‘¡ é…ç½®ç™»é™¸è³¬è™Ÿã€ ä¸­é…ç½®çš„ç™»é™¸è³¬è™Ÿ "yunai" / "1024" ã€‚</li><li>å¯¦éš›ç”Ÿç”¢æƒ…æ³ä¸‹ï¼Œæˆ‘å€‘ä»¥ QQ ä¸‰æ–¹ç™»é™¸ä½œç‚ºä¾‹å­ï¼Œå¦‚ä¸‹åœ–ï¼š</li></ul><div class=pgc-img><img alt="Spring Security OAuth2 å…¥é–€" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0e54b12c8993489e9b338e0ec9cdbfbb><p class=pgc-img-caption></p></div><ul><li>QQ ç¤ºä¾‹</li></ul><p>4.3 ç™»é™¸æˆåŠŸï¼Œé¸æ“‡å…è¨±æ‰€æœ‰ç”³è«‹çš„ Scope ï¼Œé»æ“Šã€Authorizeã€‘æŒ‰éˆ•ï¼Œç¢ºèªæˆæ¬Šã€‚å¦‚ä¸‹åœ–ï¼š</p><div class=pgc-img><img alt="Spring Security OAuth2 å…¥é–€" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5d74dc322da1462fa716502d32d37942><p class=pgc-img-caption></p></div><p>Authorize</p><p>4.4 æˆæ¬Šå®Œæˆï¼Œå›èª¿ redirect_uri åœ°å€ã€‚å¦‚ä¸‹åœ–æ‰€ç¤ºï¼š</p><div class=pgc-img><img alt="Spring Security OAuth2 å…¥é–€" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/583e98bb10534b13b4b33a404d7d6a91><p class=pgc-img-caption></p></div><p>å›èª¿åœ°å€</p><ul><li>code åƒæ•¸ï¼Œå°±æ˜¯è¿”å›çš„æˆæ¬Šç¢¼ã€‚</li></ul><p>â‘¤ ç²å–è¨ªå•ä»¤ç‰Œ</p><pre>curl -X POST --user clientapp:112233 http://localhost:8080/oauth/token -H "content-type: application/x-www-form-urlencoded" -d "code=UydkmV&amp;grant_type=authorization_code&amp;redirect_uri=http%3A%2F%2Flocalhost%3A9001%2Fcallback&amp;scope=read_userinfo"</pre><ul><li>--user clientapp:112233 è™•ï¼Œå¡«å¯«æˆ‘å€‘åœ¨ OAuth2AuthorizationServer ä¸­é…ç½®çš„ Client çš„ç·¨è™Ÿå’Œå¯†ç¢¼ã€‚</li><li>code=UydkmV è™•ï¼Œå¡«å¯«åœ¨ ã€Œâ‘£ ç²å–æˆæ¬Šç¢¼ã€ ä¸­ç²å–çš„æˆæ¬Šç¢¼( code ) ã€‚</li></ul><p>è¿”å›çµæœç¤ºä¾‹å¦‚ä¸‹ï¼š</p><pre>{ "access_token": "e60e41f2-2ad0-4c79-97d5-49af38e5c2e8",  "token_type": "bearer",  "expires_in": 43199,  "scope": "read_userinfo"}</pre><ul><li>access_token å±¬æ€§ï¼Œè¨ªå•ä»¤ç‰Œã€‚<strong>éç©º</strong>ã€‚</li><li>token_type å±¬æ€§ï¼Œä»¤ç‰Œé¡å‹ï¼Œå¯ä»¥æ˜¯ "bearer" æˆ– "mac" é¡å‹ã€‚<strong>éç©º</strong>ã€‚</li><li>expires_in å±¬æ€§ï¼ŒéæœŸæ™‚é–“ï¼Œå–®ä½ç‚ºç§’ã€‚ä¸€èˆ¬æƒ…æ³ä¸‹ï¼Œéç©ºã€‚</li><li>scope å±¬æ€§ï¼Œæ¬Šé™ç¯„åœã€‚å¦‚æœèˆ‡ Client ç”³è«‹çš„ç¯„åœä¸€è‡´ï¼Œæ­¤é …å¯çœç•¥ã€‚</li><li>refresh_token å±¬æ€§ï¼Œåˆ·æ–°ä»¤ç‰Œï¼Œç”¨ä¾†ç²å–ä¸‹ä¸€æ¬¡çš„è¨ªå•ä»¤ç‰Œã€‚</li><li class=ql-indent-1>åœ¨æˆæ¬Šç¢¼æ¨¡å¼ä¸‹ï¼Œ<strong>å…è¨±ç‚ºç©º</strong>ã€‚</li></ul><p>å¯èƒ½æœ‰éƒ¨åˆ†èƒ–å‹æ˜¯ Windows é›»è…¦ï¼Œå¯ä»¥åƒè€ƒ ã€Šwindowsï¼ˆ64ä½ï¼‰ä¸‹ä½¿ç”¨ curl å‘½ä»¤ã€‹ ä¾†å®‰è£ä¸€å€‹ curl å‘½ä»¤ã€‚</p><p>ç•¶ç„¶ï¼Œå¦‚æœèƒ–å‹ä½¿ç”¨ Postman ï¼Œå¯ä»¥åƒçœ‹å¦‚ä¸‹å…©åœ–ï¼š</p><ul><li><br></li></ul><div class=pgc-img><img alt="Spring Security OAuth2 å…¥é–€" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ac0e54ab22eb41ddae5c3dc910be6adb><p class=pgc-img-caption></p></div><ul><li>åœ– 1</li></ul><div class=pgc-img><img alt="Spring Security OAuth2 å…¥é–€" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/db6f5dd8b9654d82978837aa59292829><p class=pgc-img-caption></p></div><ul><li>åœ– 2</li></ul><p>â‘¥ èª¿ç”¨è³‡æºæœå‹™å™¨çš„ API</p><pre>curl -X GET http://localhost:8080/api/example/hello -H "authorization: Bearer e60e41f2-2ad0-4c79-97d5-49af38e5c2e8"</pre><ul><li>authorization: Bearer e60e41f2-2ad0-4c79-97d5-49af38e5c2e8 è™•ï¼Œå¡«å¯«æŒ‡å®šçš„è¨ªå•ä»¤ç‰Œé¡å‹å’Œè¨ªå•ä»¤ç‰Œã€‚ä¾‹å¦‚æ­¤è™•åˆ†åˆ¥ç‚ºï¼Œ"Bearer"ã€"e60e41f2-2ad0-4c79-97d5-49af38e5c2e8" ã€‚</li></ul><p>å¦‚æœèƒ–å‹ä½¿ç”¨ Postman ï¼Œå¯ä»¥åƒçœ‹å¦‚ä¸‹åœ–ï¼š</p><ul><li><br></li></ul><div class=pgc-img><img alt="Spring Security OAuth2 å…¥é–€" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1cf8acd198fa4fa0a6879e1f7fe0a231><p class=pgc-img-caption></p></div><ul><li>åœ–</li></ul><p><strong>4.2 å¯†ç¢¼æ¨¡å¼</strong></p><p>Maven é …ç›®çµæ§‹å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt="Spring Security OAuth2 å…¥é–€" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/805fda53fe80438d9185ed53ec3f9ee1><p class=pgc-img-caption></p></div><p>Maven é …ç›®çµæ§‹</p><p>å°æ‡‰ GitHub åœ°å€ï¼šhttps://github.com/YunaiV/SpringBoot-Labs/tree/f8d701cbd9b2a4f2cee3a7f2186148bcdf859895/lab-02/resource-owner-password-credentials-server</p><p>â‘  é…ç½®æˆæ¬Šæœå‹™å™¨</p><pre>// æˆæ¬Šæœå‹™å™¨é…ç½®@Configuration@EnableAuthorizationServerpublic class OAuth2AuthorizationServer extends AuthorizationServerConfigurerAdapter { // ç”¨æˆ¶èªè­‰ @Autowired private AuthenticationManager authenticationManager; @Override public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception { endpoints.authenticationManager(authenticationManager); } @Override public void configure(ClientDetailsServiceConfigurer clients) throws Exception { clients.inMemory() .withClient("clientapp").secret("112233") // Client è³¬è™Ÿã€å¯†ç¢¼ã€‚ .authorizedGrantTypes("password") // å¯†ç¢¼æ¨¡å¼ .scopes("read_userinfo", "read_contacts") // å¯æˆæ¬Šçš„ Scope// .and().withClient() // å¯ä»¥ç¹¼çºŒé…ç½®æ–°çš„ Client ; }}</pre><ul><li>é…ç½® Client çš„æ–¹å¼ï¼Œå’Œã€æˆæ¬Šç¢¼æ¨¡å¼ã€‘åŸºæœ¬ä¸€è‡´ã€‚å·®åˆ¥åœ¨æ–¼ï¼š</li><li class=ql-indent-1>ç„¡éœ€é…ç½® `redirectUris` å±¬æ€§ï¼Œå› ç‚ºä¸éœ€è¦å›èª¿åœ°å€ã€‚</li><li class=ql-indent-1>é…ç½®æˆæ¬Šæ¨¡å¼ç‚ºã€<strong>å¯†ç¢¼æ¨¡å¼</strong>ã€‘ã€‚</li><li>å¦å¤–ï¼Œéœ€è¦å¼•å…¥ <strong>AuthenticationManager</strong> ä¾†æ”¯æŒã€å¯†ç¢¼æ¨¡å¼ã€‘ï¼Œå¦å‰‡æœƒå ± "Resolved [error="unsupported_grant_type", error_description="Unsupported grant type: password"]" ç•°å¸¸ã€‚</li></ul><p>â‘¡ é…ç½®ç™»é™¸è³¬è™Ÿ</p><p>å’Œã€æˆæ¬Šç¢¼æ¨¡å¼ã€‘<strong>ä¸€è‡´</strong>ã€‚</p><p>â‘¢ å•Ÿå‹•é …ç›®</p><p>å’Œã€æˆæ¬Šç¢¼æ¨¡å¼ã€‘<strong>ä¸€è‡´</strong>ã€‚</p><p>â‘£ ç²å–è¨ªå•ä»¤ç‰Œ</p><pre>curl -X POST --user clientapp:112233 http://localhost:8080/oauth/token -H "accept: application/json" -H "content-type: application/x-www-form-urlencoded" -d "grant_type=password&amp;username=yunai&amp;password=1024&amp;scope=read_userinfo"</pre><ul><li>å’Œã€æˆæ¬Šç¢¼æ¨¡å¼ã€‘å·®ç•°æ¯”è¼ƒå¤§ã€‚</li><li>ç›´æ¥è«‹æ±‚ oauth/token æ¥å£ï¼Œç²å¾—è¨ªå•ä»¤ç‰Œã€‚</li><li>è«‹æ±‚åƒæ•¸å¸¶ä¸Šäº† username å’Œ password ï¼Œå°±ç”¨æˆ¶çš„ç™»é™¸è³¬è™Ÿå’Œå¯†ç¢¼ã€‚</li><li>è«‹æ±‚åƒæ•¸ grant_type ç‚º password ï¼Œè¡¨ç¤ºã€å¯†ç¢¼æ¨¡å¼ã€‘ã€‚</li></ul><p>è¿”å›çµæœç¤ºä¾‹å¦‚ä¸‹ï¼š</p><pre>{ "access_token": "68de6eb9-5672-4e47-a3e6-110404285ba9", "token_type": "bearer", "expires_in": 43199, "scope": "read_userinfo"}</pre><ul><li>å’Œã€æˆæ¬Šç¢¼æ¨¡å¼ã€‘ä¸€è‡´ã€‚</li></ul><p>â‘¤ èª¿ç”¨è³‡æºæœå‹™å™¨çš„ API</p><p>å’Œã€æˆæ¬Šç¢¼æ¨¡å¼ã€‘<strong>ä¸€è‡´</strong>ã€‚</p><p><strong>4.3 ç°¡åŒ–æ¨¡å¼</strong></p><p>Maven é …ç›®çµæ§‹å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt="Spring Security OAuth2 å…¥é–€" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/07b3cdb156354222bf76ff9c252080e4><p class=pgc-img-caption></p></div><p>Maven é …ç›®çµæ§‹</p><p>å°æ‡‰ GitHub åœ°å€ï¼šhttps://github.com/YunaiV/SpringBoot-Labs/tree/f8d701cbd9b2a4f2cee3a7f2186148bcdf859895/lab-02/implicit-server</p><p>â‘  é…ç½®æˆæ¬Šæœå‹™å™¨</p><pre>// æˆæ¬Šæœå‹™å™¨é…ç½®@Configuration@EnableAuthorizationServerpublic class OAuth2AuthorizationServer extends AuthorizationServerConfigurerAdapter { @Override public void configure(ClientDetailsServiceConfigurer clients) throws Exception { clients.inMemory() .withClient("clientapp").secret("112233") // Client è³¬è™Ÿã€å¯†ç¢¼ã€‚ .redirectUris("http://localhost:9001/callback") // é…ç½®å›èª¿åœ°å€ï¼Œé¸å¡«ã€‚ .authorizedGrantTypes("implicit") // æˆæ¬Šç¢¼æ¨¡å¼ .scopes("read_userinfo", "read_contacts") // å¯æˆæ¬Šçš„ Scope// .and().withClient() // å¯ä»¥ç¹¼çºŒé…ç½®æ–°çš„ Client ; }}</pre><ul><li>å’Œã€æˆæ¬Šç¢¼æ¨¡å¼ã€‘åŸºæœ¬ä¸€è‡´ã€‚å·®åˆ¥<strong>åƒ…åƒ…</strong>åœ¨æ–¼ï¼šé…ç½®æˆæ¬Šæ¨¡å¼ç‚ºã€ç°¡åŒ–æ¨¡å¼ã€‘ã€‚</li></ul><blockquote><p>FROM ã€Šç†è§£ OAuth 2.0ã€‹</p><p>ç°¡åŒ–æ¨¡å¼ï¼ˆimplicit grant typeï¼‰ä¸é€šéç¬¬ä¸‰æ–¹æ‡‰ç”¨ç¨‹åºçš„æœå‹™å™¨ï¼Œç›´æ¥åœ¨ç€è¦½å™¨ä¸­å‘èªè­‰æœå‹™å™¨ç”³è«‹ä»¤ç‰Œï¼Œè·³éäº†"æˆæ¬Šç¢¼"é€™å€‹æ­¥é©Ÿï¼Œå› æ­¤å¾—åã€‚æ‰€æœ‰æ­¥é©Ÿåœ¨ç€è¦½å™¨ä¸­å®Œæˆï¼Œä»¤ç‰Œå°è¨ªå•è€…æ˜¯å¯è¦‹çš„ï¼Œä¸”å®¢æˆ¶ç«¯ä¸éœ€è¦èªè­‰ã€‚</p></blockquote><p>â‘¡ é…ç½®ç™»é™¸è³¬è™Ÿ</p><p>å’Œã€æˆæ¬Šç¢¼æ¨¡å¼ã€‘ä¸€è‡´ã€‚</p><p>â‘¢ å•Ÿå‹•é …ç›®</p><p>å’Œã€æˆæ¬Šç¢¼æ¨¡å¼ã€‘ä¸€è‡´ã€‚</p><p>â‘£ ç²å–æˆæ¬Šç¢¼</p><p>4.1 ç€è¦½å™¨æ‰“é–‹ http://localhost:8080/oauth/authorize?client_id=clientapp&redirect_uri=http://localhost:9001/callback&response_type=implicit&scope=read_userinfo</p><ul><li>å’Œã€æˆæ¬Šç¢¼æ¨¡å¼ã€‘åŸºæœ¬ä¸€è‡´ã€‚å·®åˆ¥<strong>åƒ…åƒ…</strong>åœ¨æ–¼ï¼šè«‹æ±‚åƒæ•¸ response_type ç‚º "implicit" ç°¡åŒ–æ¨¡å¼ã€‚</li></ul><p>4.2 ç€è¦½å™¨æ‰“é–‹å¾Œï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt="Spring Security OAuth2 å…¥é–€" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e12f36b8e90249cfb2ae9ea547800601><p class=pgc-img-caption></p></div><p>ç€è¦½å™¨</p><ul><li>å’Œã€æˆæ¬Šç¢¼æ¨¡å¼ã€‘åŸºæœ¬ä¸€è‡´ï¼Œè¼¸å…¥åœ¨ ã€Œâ‘¡ é…ç½®ç™»é™¸è³¬è™Ÿã€ ä¸­é…ç½®çš„ç™»é™¸è³¬è™Ÿ "yunai" / "1024" ã€‚</li></ul><p>4.3 ç™»é™¸æˆåŠŸï¼Œç›´æ¥æˆæ¬Šå®Œæˆï¼Œå›èª¿ redirect_uri åœ°å€ã€‚å¦‚ä¸‹åœ–æ‰€ç¤ºï¼š</p><div class=pgc-img><img alt="Spring Security OAuth2 å…¥é–€" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0fd5174469084e718cfe845c9131b93e><p class=pgc-img-caption></p></div><p>ç€è¦½å™¨</p><ul><li>å’Œã€æˆæ¬Šç¢¼æ¨¡å¼ã€‘åŸºæœ¬ä¸ä¸€è‡´çš„æœ‰<strong>å…©é»</strong>ï¼š</li><li class=ql-indent-1>ç™»é™¸æˆåŠŸå¾Œï¼Œ<strong>ç„¡éœ€</strong>é¸æ“‡å…è¨±æ‰€æœ‰ç”³è«‹çš„ Scope ï¼Œç›´æ¥æˆæ¬Šå®Œæˆã€‚</li><li class=ql-indent-1>è¿”å›çš„ä¸æ˜¯æˆæ¬Šç¢¼ï¼Œè€Œæ˜¯<strong>è¨ªå•ä»¤ç‰Œ</strong>ã€‚</li></ul><blockquote><p>ç¸½çš„ä¾†èªªï¼Œã€ç°¡åŒ–æ¨¡å¼ã€‘æ˜¯ã€æˆæ¬Šç¢¼æ¨¡å¼ã€‘çš„ç°¡åŒ–æ¨¡å¼ã€‚</p></blockquote><p>â‘¤ èª¿ç”¨è³‡æºæœå‹™å™¨çš„ API</p><p>å’Œã€æˆæ¬Šç¢¼æ¨¡å¼ã€‘ä¸€è‡´ã€‚</p><p><strong>4.4 å®¢æˆ¶ç«¯æ¨¡å¼</strong></p><p>Maven é …ç›®çµæ§‹å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt="Spring Security OAuth2 å…¥é–€" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/642724b17b7f416daebf5f9273ad8640><p class=pgc-img-caption></p></div><p>Maven é …ç›®çµæ§‹</p><p>å°æ‡‰ GitHub åœ°å€ï¼šhttps://github.com/YunaiV/SpringBoot-Labs/tree/f8d701cbd9b2a4f2cee3a7f2186148bcdf859895/lab-02/client-credentials-server</p><p>â‘  é…ç½®æˆæ¬Šæœå‹™å™¨</p><p>å’Œã€å¯†ç¢¼æ¨¡å¼ã€‘ä¸€è‡´ã€‚</p><p>â‘¡ é…ç½®ç™»é™¸è³¬è™Ÿ</p><p>å®ƒ<strong>ç„¡éœ€</strong>é…ç½®ç™»é™¸è³¬è™Ÿã€‚å› ç‚ºå®ƒæ²’æœ‰ç”¨æˆ¶çš„æ¦‚å¿µï¼Œç›´æ¥èˆ‡æˆæ¬Šæœå‹™å™¨äº¤äº’ï¼Œé€šé Client çš„ç·¨è™Ÿ( client_id )å’Œå¯†ç¢¼( client_secret )ä¾†ä¿è­‰å®‰å…¨æ€§ã€‚</p><p>â‘¢ å•Ÿå‹•é …ç›®</p><p>å’Œã€å¯†ç¢¼æ¨¡å¼ã€‘ä¸€è‡´ã€‚</p><p>â‘£ ç²å–è¨ªå•ä»¤ç‰Œ</p><pre>curl -X POST "http://localhost:8080/oauth/token" --user clientapp:112233 -d "grant_type=client_credentials&amp;scope=read_contacts"</pre><ul><li>å’Œã€å¯†ç¢¼æ¨¡å¼ã€‘åŸºæœ¬ä¸€è‡´ï¼Œå·®åˆ¥å¦‚ä¸‹ï¼š</li><li class=ql-indent-1>è«‹æ±‚åƒæ•¸<strong>ç„¡éœ€</strong>å¸¶ä¸Šäº† `username` å’Œ `password` ã€‚</li><li class=ql-indent-1>è«‹æ±‚åƒæ•¸ `grant_type` ç‚º `client_credentials` ï¼Œè¡¨ç¤ºã€å¯†ç¢¼æ¨¡å¼ã€‘ã€‚</li></ul><p>è¿”å›çµæœç¤ºä¾‹å¦‚ä¸‹ï¼š</p><pre>{ "access_token":"cb2bdfd8-18fa-4b8f-b525-10587bd672e8", "token_type":"bearer", "expires_in":43199, "scope":"read_contacts"}</pre><ul><li>å’Œã€å¯†ç¢¼æ¨¡å¼ã€‘ä¸€è‡´ã€‚</li></ul><p>â‘¤ èª¿ç”¨è³‡æºæœå‹™å™¨çš„ API</p><p>å’Œã€å¯†ç¢¼æ¨¡å¼ã€‘<strong>ä¸€è‡´</strong>ã€‚</p><blockquote><p>ç¸½çš„ä¾†èªªï¼Œã€å®¢æˆ¶ç«¯æ¨¡å¼ã€‘æ˜¯ã€å¯†ç¢¼æ¨¡å¼ã€‘çš„ç°¡åŒ–æ¨¡å¼ã€‚</p></blockquote><p><strong>4.5 å¦‚ä½•é¸æ“‡ï¼Ÿ</strong></p><p>å¯èƒ½å¾ˆå¤šèƒ–å‹ï¼Œæœ‰è·Ÿç­†è€…ä¸€æ¨£çš„å›°æƒ‘ã€‚ä¸‹é¢ç­†è€…å¼•ç”¨æ¥Šæ³¢è€å¸«çš„ä¸€å¼µåœ–ï¼Œç›¸ä¿¡èƒ½è§£æ±ºæˆ‘å€‘çš„å›°æ“¾ã€‚å¦‚ä¸‹åœ–æ‰€ç¤ºï¼š</p><blockquote><p>FROM ã€Šæ·±åº¦å‰–æ OAuth2 å’Œå¾®æœå‹™å®‰å…¨æ¶æ§‹ã€‹</p></blockquote><div class=pgc-img><img alt="Spring Security OAuth2 å…¥é–€" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/7509a1cd750a40319046830196d1ef53><p class=pgc-img-caption></p></div><blockquote><p>æˆæ¬Šé¡å‹é¸æ“‡</p></blockquote><p>ç•¶ç„¶ï¼Œå°æ–¼<strong>é»ƒæ¡†</strong>éƒ¨åˆ†ï¼Œå°æ–¼ç­†è€…é‚„æ˜¯æ¯”è¼ƒå›°æƒ‘çš„ã€‚ç­†è€…èªç‚ºï¼Œç¬¬ä¸‰æ–¹çš„å–®é æ‡‰ç”¨ SPA ï¼Œä¹Ÿæ˜¯é©åˆæ¡ç”¨ Authorization Code Grant æˆæ¬Šæ¨¡å¼çš„ã€‚ä¾‹å¦‚ï¼Œã€Šå¾®ä¿¡ç¶²é æˆæ¬Šã€‹ ï¼š</p><blockquote><p>å…·é«”è€Œè¨€ï¼Œç¶²é æˆæ¬Šæµç¨‹åˆ†ç‚ºå››æ­¥ï¼š</p><p>1ã€å¼•å°ç”¨æˆ¶é€²å…¥æˆæ¬Šé é¢åŒæ„æˆæ¬Šï¼Œç²å–code</p><p>2ã€é€šécodeæ›å–ç¶²é æˆæ¬Šaccess_tokenï¼ˆèˆ‡åŸºç¤æ”¯æŒä¸­çš„access_tokenä¸åŒï¼‰</p><p>3ã€å¦‚æœéœ€è¦ï¼Œé–‹ç™¼è€…å¯ä»¥åˆ·æ–°ç¶²é æˆæ¬Šaccess_tokenï¼Œé¿å…éæœŸ</p><p>4ã€é€šéç¶²é æˆæ¬Šaccess_tokenå’Œopenidç²å–ç”¨æˆ¶åŸºæœ¬ä¿¡æ¯ï¼ˆæ”¯æŒUnionIDæ©Ÿåˆ¶ï¼‰</p></blockquote><p>æ‰€ä»¥ï¼Œç­†è€…çŒœæ¸¬ï¼Œä¹‹æ‰€ä»¥åœ–ä¸­ç•«çš„æ˜¯ Implicit Grant çš„åŸå› æ˜¯ï¼Œå— Google çš„ ã€ŠOAuth 2.0 for Client-side Web Applicationsã€‹ ä¸€æ–‡ä¸­ï¼Œæ¨è–¦ä½¿ç”¨äº† Implicit Grant ã€‚</p><p>ç•¶ç„¶ï¼Œå…·é«”ä½¿ç”¨ Implicit Grant é‚„æ˜¯ Authorization Code Grant æˆæ¬Šæ¨¡å¼ï¼Œæ²’æœ‰å®šè«–ã€‚ç­†è€…ï¼Œåå‘æ–¼ä½¿ç”¨ <strong>Authorization Code Grant</strong>ï¼Œå°æ–¼ç¬¬ä¸‰æ–¹å®¢æˆ¶ç«¯çš„å ´æ™¯ã€‚</p><p><strong>4.6 ç‚ºä»€éº¼æœ‰ Client ç·¨è™Ÿå’Œå¯†ç¢¼</strong></p><p>æˆ‘å€‘çœ‹åˆ°ä¸Šè¿°å››ç¨®æˆæ¬Šæ¨¡å¼ï¼Œç„¡è«–æ˜¯å“ªä¸€ç¨®ï¼Œæœ€çµ‚èª¿ç”¨æˆæ¬Šæœå‹™å™¨æ™‚ï¼Œéƒ½æœƒå‚³é Client ç·¨è™Ÿå’Œå¯†ç¢¼ï¼Œé€™æ˜¯ç‚ºä»€éº¼å‘¢ï¼Ÿé€šé Client ç·¨è™Ÿå’Œå¯†ç¢¼ï¼Œæˆæ¬Šæœå‹™å™¨å¯ä»¥çŸ¥é“èª¿ç”¨çš„ä¾†æºä»¥åŠæ­£ç¢ºæ€§ã€‚é€™æ¨£ï¼Œå³ä½¿â€œå£äººâ€æ‹¿åˆ° Access Token ï¼Œä½†æ˜¯æ²’æœ‰ Client ç·¨è™Ÿå’Œå¯†ç¢¼ï¼Œä¹Ÿä¸èƒ½å’Œæˆæ¬Šæœå‹™å™¨ç™¼ç”Ÿ<strong>æœ‰æ•ˆ</strong>çš„äº¤äº’ã€‚</p><h1><strong>5. åˆ·æ–°ä»¤ç‰Œ</strong></h1><p>åœ¨ ã€Œ4. é…ç½®æˆæ¬Šæœå‹™å™¨ã€ ä¸­ï¼Œæˆ‘å€‘ä¸€ç›´æ²’æœ‰çœ‹åˆ°æˆ‘å€‘æœŸç›¼çš„åˆ·æ–°ä»¤ç‰Œ( refresh token )çš„èº«å½±ã€‚é€™æ˜¯ç‚ºä»€éº¼å‘¢ï¼Ÿå› ç‚ºæˆ‘å€‘åœ¨é…ç½® Spring Security OAuth2 ä¸¦æœªé…ç½®ï¼Œç²å–è¨ªå•ä»¤ç‰Œçš„åŒæ™‚ï¼Œç²å–åˆ·æ–°ä»¤ç‰Œã€‚</p><p>é‚£éº¼ï¼Œæ€éº¼é…ç½®é–‹å•Ÿç²å–åˆ·æ–°ä»¤ç‰Œçš„åŠŸèƒ½å‘¢ï¼Ÿæˆ‘å€‘ä¾†çœ‹çœ‹ ã€Œ5.1 ç²å–åˆ·æ–°ä»¤ç‰Œã€ ã€‚</p><p><strong>5.1 ç²å–åˆ·æ–°ä»¤ç‰Œ</strong></p><p>å› ç‚ºã€å¯†ç¢¼æ¨¡å¼ã€‘ç›¸å°ç°¡å–®ï¼Œæˆ‘å€‘ç›´æ¥åœ¨åŸæœ‰ç¨‹åºä¸Šåšæ”¹é€ ã€‚å°æ‡‰ GitHub åœ°å€ï¼šhttps://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-02/authorization-code-server-with-refresh-token ã€‚</p><blockquote><p>åœ¨æ­¥é©Ÿä¸Šï¼Œå¦‚æœå’ŒåŸæœ‰ã€å¯†ç¢¼æ¨¡å¼ã€‘ä¿æŒä¸€è‡´çš„åœ°æ–¹ï¼Œä¸‹æ–‡æœƒé€²è¡Œçœç•¥ï¼Œä¸¦æ¨™è¨»â€œå’ŒåŸæœ‰<strong>ä¸€è‡´</strong>â€ã€‚</p></blockquote><p>â‘  é…ç½®æˆæ¬Šæœå‹™å™¨</p><pre>// æˆæ¬Šæœå‹™å™¨é…ç½®@Configuration@EnableAuthorizationServerpublic class OAuth2AuthorizationServer extends AuthorizationServerConfigurerAdapter { // ç”¨æˆ¶èªè­‰ @Autowired private AuthenticationManager authenticationManager; @Override public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception { endpoints.authenticationManager(authenticationManager); } @Override public void configure(ClientDetailsServiceConfigurer clients) throws Exception { clients.inMemory() .withClient("clientapp").secret("112233") // Client è³¬è™Ÿã€å¯†ç¢¼ã€‚ .authorizedGrantTypes("password", "refresh_token") // å¯†ç¢¼æ¨¡å¼ // &lt;1&gt; .scopes("read_userinfo", "read_contacts") // å¯æˆæ¬Šçš„ Scope// .and().withClient() // å¯ä»¥ç¹¼çºŒé…ç½®æ–°çš„ Client ; }}</pre><ul><li>åœ¨ &lt;1> è™•ï¼Œæˆ‘å€‘å¾ˆç¥å¥‡çš„å¤šé…ç½®äº†ä¸€å€‹ "refresh_token" ï¼Œç”¨æ–¼é–‹å•Ÿç²å–åˆ·æ–°ä»¤ç‰Œçš„åŠŸèƒ½ã€‚ä½†æ˜¯ä½†æ˜¯ä½†æ˜¯ï¼ŒOAuth2 çš„æˆæ¬Šæ¨¡å¼èªªå¥½çš„æ˜¯å››ç¨®çš„éº¼ï¼Œæ€éº¼åˆå‡ºç¾äº† "refresh_token" é€™ç¨®æˆæ¬Šæ¨¡å¼ï¼Ÿæ·¡å®šï¼Œåœ¨ Spring Security OAtuh2 ä¸­ï¼Œ"refresh_token" ä½œç‚ºä¸€ç¨®ç‰¹æ®Šçš„æˆæ¬Šæ¨¡å¼<strong>é…ç½®</strong>ï¼Œç”¨æ–¼é–‹å•Ÿç²å–åˆ·æ–°ä»¤ç‰Œçš„åŠŸèƒ½ã€‚æ‰€ä»¥ï¼Œå…¶å®ƒæˆæ¬Šæ¨¡å¼å¦‚æœé–‹å•Ÿç²å–åˆ·æ–°ä»¤ç‰Œçš„åŠŸèƒ½ï¼Œéœ€è¦åœ¨ #authorizedGrantTypes(â€¦) è¨­ç½®æ™‚ï¼Œå¤šå‚³å…¥ "refresh_token" æ–¹æ³•åƒæ•¸ã€‚</li></ul><p>â‘¡ é…ç½®ç™»é™¸è³¬è™Ÿ</p><p>å’ŒåŸæœ‰<strong>ä¸€è‡´</strong>ã€‚</p><p>â‘¢ å•Ÿå‹•é …ç›®</p><p>å’ŒåŸæœ‰<strong>ä¸€è‡´</strong>ã€‚</p><p>â‘£ ç²å–è¨ªå•ä»¤ç‰Œ</p><pre>curl -X POST --user clientapp:112233 http://localhost:8080/oauth/token -H "accept: application/json" -H "content-type: application/x-www-form-urlencoded" -d "grant_type=password&amp;username=yunai&amp;password=1024&amp;scope=read_userinfo"</pre><ul><li>å’ŒåŸæœ‰<strong>ä¸€è‡´</strong>ã€‚</li></ul><p>è¿”å›çµæœç¤ºä¾‹å¦‚ä¸‹ï¼š</p><pre>{ "access_token":"092a2286-04e7-4e7d-8c20-19fbe25865ff", "token_type":"bearer", "refresh_token":"afeeb083-997f-4ea8-9334-aab6c1696cca", "expires_in":43199, "scope":"read_userinfo"}</pre><ul><li>åœ¨åŸæœ‰çš„åŸºç¤ä¸Šï¼Œ<strong>å¤š</strong>è¿”å›äº† "refresh_token" åˆ·æ–°ä»¤ç‰Œã€‚ç¾æ»‹æ»‹ã€‚</li></ul><p>â‘¤ èª¿ç”¨è³‡æºæœå‹™å™¨çš„ API</p><p>å’ŒåŸæœ‰<strong>ä¸€è‡´</strong>ã€‚</p><p><strong>5.2 â€œåˆ·æ–°â€è¨ªå•ä»¤ç‰Œ</strong></p><p>å› ç‚ºè¨ªå•è¨ªå•ä»¤ç‰Œæœƒè‡ªå‹•éæœŸï¼Œé€šéä½¿ç”¨åˆ·æ–°ä»¤ç‰Œï¼Œå¯ä»¥ç²å¾—<strong>æ–°çš„</strong>è¨ªå•ä»¤ç‰Œã€‚æ³¨æ„ï¼Œè¨ªå•ä»¤ç‰Œç²å–åˆ°çš„æ˜¯<strong>æ–°çš„</strong>ï¼Œä¸æ˜¯è€çš„å“ˆã€‚é€™ä¹Ÿæ˜¯ç‚ºä»€éº¼ï¼Œåœ¨æ¨™é¡Œä¸Šï¼Œç­†è€…å°<strong>åˆ·æ–°</strong>åŠ äº†é›™å¼•è™Ÿã€‚</p><pre>curl -i -X POST -u 'clientapp:112233' http://localhost:8080/oauth/token -H "accept: application/json" -d 'grant_type=refresh_token&amp;refresh_token=afeeb083-997f-4ea8-9334-aab6c1696cca'</pre><ul><li>èª¿ç”¨æ¥å£é‚„æ˜¯ "oauth/token" ï¼Œå·®åˆ¥åœ¨æ–¼å‚³å…¥çš„è«‹æ±‚åƒæ•¸ grant_type ç‚º "refresh_token"ï¼Œä½¿ç”¨åˆ·æ–°ä»¤ç‰Œã€‚</li><li>è«‹æ±‚åƒæ•¸ refresh_token ç‚ºä¸Šé¢ç²å–åˆ°çš„åˆ·æ–°ä»¤ç‰Œ "afeeb083-997f-4ea8-9334-aab6c1696cca" ã€‚</li></ul><p>è¿”å›çµæœç¤ºä¾‹å¦‚ä¸‹ï¼š</p><pre>{ "access_token":"507eb761-4b25-4159-b927-ef3eff5e7eff", "token_type":"bearer", "refresh_token":"afeeb083-997f-4ea8-9334-aab6c1696cca", "expires_in":43199, "scope":"read_userinfo"}</pre><ul><li>ç²å¾—çš„è¨ªå•ä»¤ç‰Œç‚º "507eb761-4b25-4159-b927-ef3eff5e7eff" ï¼Œæ˜¯<strong>æ–°çš„</strong>ã€‚ä¸¦ä¸”ï¼ŒéæœŸæ™‚é–“ä¹Ÿè®Šæˆ<strong>æ–°çš„</strong>ã€‚</li></ul><hr><p>ç­†è€…åœ¨çœ‹ OAuth2.0 çš„åˆ·æ–°ä»¤ç‰Œæ™‚ï¼Œä¸€ç›´æœ‰å€‹ç–‘æƒ‘ï¼šåˆ·æ–°ä»¤ç‰Œæ˜¯å¦æœ‰éæœŸæ™‚é–“ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œ<strong>æœ‰</strong>ã€‚ä½†æ˜¯ï¼Œç­†è€…ä¸å¤ªç¢ºå®šï¼Œåœ¨ Spring Security OAuth2 ä¸­ï¼Œå¦‚æœä¸è¨­ç½®åˆ·æ–°ä»¤ç‰Œçš„éæœŸæ™‚é–“ï¼Œåˆ·æ–°æ™‚é–“æ˜¯å¦<strong>ç„¡é™é•·</strong>ï¼Ÿç•¶ç„¶ï¼Œé€™å€‹è²Œä¼¼ä¹Ÿä¸¦ä¸é‡è¦ã€‚å› ç‚ºï¼Œåœ¨å¯¦éš›ä½¿ç”¨ä¸­ï¼Œæˆ‘å€‘è‚¯å®šæ˜¯éœ€è¦é¡¯ç¤º( ä¸»å‹• )è¨­ç½®åˆ·æ–°ä»¤ç‰Œçš„éæœŸæ™‚é–“ï¼Œä½¿ç”¨ ClientBuilder#refreshTokenValiditySeconds(int refreshTokenValiditySeconds) æ–¹æ³•ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><pre>@Overridepublic void configure(ClientDetailsServiceConfigurer clients) throws Exception { clients.inMemory() .withClient("clientapp").secret("112233") // Client è³¬è™Ÿã€å¯†ç¢¼ã€‚ .authorizedGrantTypes("password", "refresh_token") // å¯†ç¢¼æ¨¡å¼ .scopes("read_userinfo", "read_contacts") // å¯æˆæ¬Šçš„ Scope .refreshTokenValiditySeconds(1200) // 1200 ç§’éæœŸ// .and().withClient() // å¯ä»¥ç¹¼çºŒé…ç½®æ–°çš„ Client ;}</pre><p>åˆ·æ–°ä»¤ç‰ŒéæœŸæ™‚ï¼Œè¿”å›çµæœç¤ºä¾‹å¦‚ä¸‹ï¼š</p><pre>{ "error":"invalid_token", "error_description":"Invalid refresh token (expired): 7139d075-c4ea-48f0-9dbb-6f65fa6dbeb0"}</pre><ul><li>å¦‚æœèƒ–å‹è¦æ¸¬è©¦é€™å€‹æ•ˆæœï¼Œå¯ä»¥æŠŠåˆ·æ–°ä»¤ç‰ŒéæœŸæ™‚é–“è¨­ç½®ç‚º 1 ç§’ã€‚</li></ul><p><strong>5.3 ç‚ºä»€éº¼éœ€è¦æœ‰åˆ·æ–°ä»¤ç‰Œ</strong></p><p>å‡ºæ–¼<strong>å®‰å…¨æ€§</strong>çš„è€ƒæ…®ï¼Œè¨ªå•ä»¤ç‰Œçš„éæœŸæ™‚é–“æ¯”è¼ƒçŸ­ï¼Œåˆ·æ–°ä»¤ç‰Œçš„éæœŸæ™‚é–“æ¯”è¼ƒé•·ã€‚é€™æ¨£ï¼Œå¦‚æœè¨ªå•ä»¤ç‰Œå³ä½¿è¢«ç›œç”¨èµ°ï¼Œé‚£éº¼åœ¨ä¸€å®šçš„æ™‚é–“å¾Œï¼Œè¨ªå•ä»¤ç‰Œä¹Ÿèƒ½åœ¨è¼ƒçŸ­çš„æ™‚é–“å¼éæœŸã€‚ç•¶ç„¶ï¼Œå®‰å…¨ä¹Ÿæ˜¯ç›¸å°çš„ï¼Œå¦‚æœä½¿ç”¨åˆ·æ–°ä»¤ç‰Œå¾Œï¼Œç²å–åˆ°æ–°çš„è¨ªå•ä»¤ç‰Œï¼Œè¨ªå•ä»¤ç‰Œ<strong>å¾ŒçºŒ</strong>åˆ<strong>å¯èƒ½</strong>è¢«ç›œç”¨ã€‚</p><p>å¦å¤–ï¼Œåˆ·æ–°ä»¤ç‰Œæ˜¯å¯é¸é …ï¼Œä¸ä¸€å®šæœƒè¿”å›ã€‚</p><p>ç­†è€…æ•´ç†äº†ä¸‹ï¼Œå¤§å®¶å¸¸ç”¨é–‹æ”¾å¹³è‡ºçš„ä»¤ç‰ŒéæœŸæ™‚é–“ï¼Œè®“å¤§å®¶æ›´å¥½çš„ç†è§£ï¼š</p><ul><li>å°ç±³é–‹æ”¾å¹³è‡º</li><li class=ql-indent-1>ã€ŠAccess Token ç”Ÿå‘½é€±æœŸã€‹</li><li class=ql-indent-1>Access Token ï¼š90 å¤©æœ‰æ•ˆæœŸ</li><li class=ql-indent-1>Refresh Token ï¼š10 å¹´æœ‰æ•ˆæœŸ</li><li>å¾®ä¿¡é–‹æ”¾å¹³è‡º</li><li class=ql-indent-1>ã€Šç¶²ç«™æ‡‰ç”¨å¾®ä¿¡ç™»éŒ„é–‹ç™¼æŒ‡å—ã€‹</li><li class=ql-indent-1>Access Token ï¼š2 å°æ™‚æœ‰æ•ˆæœŸ</li><li class=ql-indent-1>Refresh Token ï¼šæœªçŸ¥æœ‰æ•ˆæœŸ</li><li>é¨°è¨Šé–‹æ”¾å¹³è‡º</li><li class=ql-indent-1>ã€Šç²å– Access_Tokenã€‹</li><li class=ql-indent-1>Access Token ï¼š90 å¤©æœ‰æ•ˆæœŸ</li><li class=ql-indent-1>Refresh Token ï¼šæœªçŸ¥æœ‰æ•ˆæœŸ</li></ul><h1><strong>6. åˆªé™¤ä»¤ç‰Œ</strong></h1><p>å¯¦éš›åœ¨ OAuth2 æ™‚ï¼Œæœ‰åˆªé™¤è¨ªå•ä»¤ç‰Œå’Œåˆ·æ–°ä»¤ç‰Œçš„éœ€æ±‚ã€‚ä¾‹å¦‚ï¼šç”¨æˆ¶ç™»å‡ºç³»çµ±ã€‚é›–ç„¶èªªï¼Œå¯ä»¥é€šéå®¢æˆ¶ç«¯<strong>æœ¬åœ°</strong>åˆªé™¤ä»¤ç‰Œçš„æ–¹å¼å¯¦ç¾ã€‚ä½†æ˜¯ï¼Œè€ƒæ…®åˆ°çœŸæ­£çš„å¾¹åº•çš„å¯¦ç¾åˆªé™¤ä»¤ç‰Œï¼Œå¿…ç„¶æœå‹™ç«¯<strong>è‡ªèº«</strong>éœ€è¦åˆªé™¤ä»¤ç‰Œã€‚</p><p>åœ¨ Spring Security OAuth2 ä¸­ï¼Œä¸¦æ²’æœ‰æä¾›å…§ç½®çš„æ¥å£ï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±å»å¯¦ç¾ã€‚ç­†è€…åƒçœ‹ ã€ŠSpring Security OAuth2 â€“ Simple Token Revocationã€‹ æ–‡æª”ï¼Œå¯¦ç¾åˆªé™¤ä»¤ç‰Œçš„ API æ¥å£ã€‚</p><p>å› ç‚ºã€å¯†ç¢¼æ¨¡å¼ã€‘ç›¸å°ç°¡å–®ï¼Œæˆ‘å€‘ç›´æ¥åœ¨åŸæœ‰ç¨‹åºä¸Šåšæ”¹é€ ã€‚å°æ‡‰ GitHub åœ°å€ï¼š ã€‚æ³¨æ„ï¼Œå¦‚ä¸‹åƒ…åƒ…æ˜¯ Demo ï¼Œå¯¦éš›ç”Ÿç”¢ç’°å¢ƒä¸‹éœ€è¦åšæ”¹é€ ã€‚</p><p><strong>6.1 åˆªé™¤è¨ªå•ä»¤ç‰Œ</strong></p><p>â‘  æ–°å¢åˆªé™¤è¨ªå•ä»¤ç‰Œçš„ API æ¥å£</p><pre>@Autowiredprivate ConsumerTokenServices tokenServices;@RequestMapping(method = RequestMethod.POST, value = "api/access_token/revoke")public String revokeToken(@RequestParam("token") String token) { tokenServices.revokeToken(token); return token;}</pre><ul><li>ä½¿ç”¨ ConsumerTokenServices#revokeToken(String tokenValue) æ–¹æ³•ï¼Œåˆªé™¤è¨ªå•ä»¤ç‰Œã€‚</li></ul><p><strong>æ³¨æ„</strong>ï¼Œå¯¦éš›ç”Ÿç”¢ç’°å¢ƒä¸‹ï¼Œæˆæ¬Šæœå‹™å™¨å’Œè³‡æºæœå‹™å™¨æ˜¯ä¸åœ¨ä¸€èµ·çš„ï¼Œæ‰€ä»¥æ­¤è™•åƒ…åƒ…æ˜¯ç¤ºä¾‹ã€‚ä¸»è¦æ˜¯ç‚ºäº†ä»‹ç´¹ ConsumerTokenServices#revokeToken(String tokenValue) æ–¹æ³•çš„ä½¿ç”¨ã€‚</p><p>â‘¡ è¨ªå•åˆªé™¤è¨ªå•ä»¤ç‰Œçš„ API æ¥å£ã€‚</p><pre>curl -X POST http://localhost:8080/api/access_token/revoke -H "authorization: Bearer 23874e0b-a1d8-4337-9551-7b9be1ebaebe" -d "token=23874e0b-a1d8-4337-9551-7b9be1ebaebe"</pre><p>ç§»é™¤æˆåŠŸå¾Œï¼Œåœ¨ä½¿ç”¨ç•¶å‰è¨ªå•ä»¤ç‰Œï¼Œå°±æœƒå ±å¦‚ä¸‹éŒ¯èª¤ï¼š</p><pre>{ "error":"invalid_token", "error_description":"Invalid access token: 23874e0b-a1d8-4337-9551-7b9be1ebaebe"}</pre><hr><p>å¦å¤–ï¼Œä¹Ÿå¯ä»¥åƒè€ƒ https://github.com/geektime-geekbang/oauth2lab/blob/master/lab05/oauth-server/src/main/java/io/spring2go/config/RevokeTokenEndpoint.java çš„å¯¦ç¾ã€‚</p><p><strong>6.2 åˆªé™¤åˆ·æ–°ä»¤ç‰Œ</strong></p><p>â‘  æ–°å¢åˆªé™¤è¨ªå•ä»¤ç‰Œçš„ API æ¥å£</p><pre>@Autowired(required = false) // &lt;1&gt;private TokenStore tokenStore;@RequestMapping(method = RequestMethod.POST, value = "api/refresh_token/revoke")public String revokeRefreshToken(@RequestParam("token") String token) { tokenStore.removeRefreshToken(new DefaultOAuth2RefreshToken(token)); return token;}</pre><ul><li>&lt;1> è™•ï¼Œä½¿ç”¨äº† required = false çš„åŸå› æ˜¯ï¼Œæœ¬ç¤ºä¾‹ä¸¦æœªé¡¯ç¤ºè²æ˜ TokenStore Bean å°è±¡äº¤çµ¦ Spring ç®¡ç†ï¼Œæ‰€ä»¥ç„¡æ³•æ³¨å…¥ã€‚ æ‰€ä»¥ ã€Œ6.2 åˆªé™¤åˆ·æ–°ä»¤ç‰Œã€ æ˜¯ä¸€å€‹ç„¡æ³•<strong>è·‘é€š</strong>çš„ç¤ºä¾‹ã€‚</li><li>é‡é»åœ¨æ–¼ï¼Œèª¿ç”¨ TokenStore#removeRefreshToken(OAuth2RefreshToken token) æ–¹æ³•ï¼Œåˆªé™¤åˆ·æ–°ä»¤ç‰Œã€‚</li></ul><p>â‘¡ è¨ªå•åˆªé™¤åˆ·æ–°ä»¤ç‰Œçš„ API æ¥å£ã€‚</p><pre>curl -X POST http://localhost:8080/api/refresh_token/revoke -H "authorization: Bearer 52e85411-ac1d-4844-bf03-cf5633e4eecd" -d "token=ead4734a-ca5c-45bf-ac25-9a92291a9fe1"</pre><p>ç§»é™¤æˆåŠŸå¾Œï¼Œåœ¨ä½¿ç”¨ç•¶å‰åˆ·æ–°ä»¤ç‰Œï¼Œå°±æœƒå ±å¦‚ä¸‹éŒ¯èª¤ï¼š</p><pre>{ "error":"invalid_token", "error_description":"Invalid refresh token: ead4734a-ca5c-45bf-ac25-9a92291a9fe1"}</pre><hr><p>å¦å¤–ï¼Œä¹Ÿå¯ä»¥åƒè€ƒ https://github.com/geektime-geekbang/oauth2lab/blob/master/lab05/oauth-server/src/main/java/io/spring2go/config/TokenController.java çš„å¯¦ç¾ã€‚</p><p><strong>6.3 RFC7009 - OAuth2 Token Revocation</strong></p><p>åœ¨ OAuth2 ä¸­ï¼Œåˆªé™¤ä»¤ç‰Œï¼Œæ¨™æº–çš„èªªæ³•ç‚º OAuth2 Token æ’¤éŠ·ï¼Œå°æ‡‰ RFC7009 ã€‚æ„Ÿèˆˆè¶£çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹ã€‚</p><blockquote><p>FROM ã€ŠOAuth2 Token æ’¤éŠ·ï¼ˆRFC7009 - OAuth2 Token Revocationï¼‰ã€‹</p></blockquote><p>ç°¡å–®ä¾†èªªï¼Œé€™å€‹å”è­°è¦å®šäº†ä¸€å€‹Authorization serveræä¾›ä¸€å€‹æ€æ¨£çš„APIä¾†ä¾›Clientæ’¤éŠ·access_tokenæˆ–è€…refresh_tokenã€‚</p><p>æ¯”å¦‚Clientç™¼èµ·ä¸€å€‹å¦‚ä¸‹çš„è«‹æ±‚ï¼š</p><blockquote><p><em>POST /revoke HTTP/1.1</em></p><p><em>Host: server.example.com</em></p><p><em>Content-Type: application/x-www-form-urlencoded</em></p><p><em>Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW</em></p><p><em>token=45ghiukldjahdnhzdauz&token_type_hint=refresh_token</em></p></blockquote><p>å…¶ä¸­å„é …å«ç¾©å¦‚ä¸‹ï¼š</p><ol><li>/revokeï¼šæ˜¯Authorization Serveréœ€è¦æä¾›çš„APIåœ°å€ï¼ŒClientä½¿ç”¨Postæ–¹å¼è«‹æ±‚é€™å€‹åœ°å€ã€‚</li><li>Content-Type: application/x-www-form-urlencodedï¼šå›ºå®šæ­¤æ ¼å¼ã€‚</li><li>Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JWï¼šè¨ªå•å—ä¿è­·è³‡æºçš„æˆæ¬Šæ†‘è­‰ã€‚</li><li>tokenï¼šå¿…é¸ï¼Œå¯ä»¥æ˜¯access_tokenæˆ–è€…refresh_tokençš„å…§å®¹ã€‚</li><li>token_type_hintï¼šå¯é¸ï¼Œè¡¨ç¤ºtokençš„é¡å‹ï¼Œå€¼ç‚ºâ€access_tokenâ€œæˆ–è€…"refresh_token"ã€‚</li></ol><p>å¦‚æœæ’¤éŠ·æˆåŠŸï¼Œå‰‡è¿”å›ä¸€å€‹HTTP status codeç‚º200çš„éŸ¿æ‡‰å°±å¯ä»¥äº†ã€‚</p><h1><strong>7. ä»¤ç‰Œå…ƒæ•¸æ“š</strong></h1><blockquote><p>FROM ã€ŠOAuth2 Token å…ƒæ•¸æ“šï¼ˆRFC7662 - OAuth2 Token Introspectionï¼‰ã€‹</p></blockquote><p>ç°¡å–®çš„ç¸½çµä¾†èªªï¼Œé€™å€‹è¦ç¯„æ˜¯ç‚ºOAuth2æ“´å±•äº†ä¸€å€‹APIæ¥å£ï¼ˆIntrospection Endpointï¼‰ï¼Œè®“ç¬¬ä¸‰æ–¹Clientå¯ä»¥æŸ¥è©¢ä¸Šé¢æåˆ°çš„é‚£äº›ä¿¡æ¯ï¼ˆæ¯”å¦‚ï¼Œaccess_tokenæ˜¯å¦é‚„æœ‰æ•ˆï¼Œèª°é ’ç™¼çš„ï¼Œé ’ç™¼çµ¦èª°çš„ï¼Œscopeåˆå“ªäº›ç­‰ç­‰çš„å…ƒæ•¸æ“šä¿¡æ¯ï¼‰ã€‚</p><p>æ¯”å¦‚Clientç™¼èµ·ä¸€å€‹å¦‚ä¸‹çš„è«‹æ±‚ï¼š</p><blockquote><p><em>POST /introspect HTTP/1.1</em></p><p><em>Host: server.example.com</em></p><p><em>Accept: application/json</em></p><p><em>Content-Type: application/x-www-form-urlencoded</em></p><p><em>Authorization: Bearer 23410913-abewfq.123483</em></p><p><em>token=2YotnFZFEjr1zCsicMWpAA&token_type_hint=access_token</em></p></blockquote><p>çœ‹èµ·ä¾†å’Œä¸Šé¢çš„æ’¤éŠ·Tokençš„è«‹æ±‚å·®ä¸å¤šï¼Œå…¶ä¸­å„é …å«ç¾©å¦‚ä¸‹ï¼š</p><ol><li>/introspectï¼šæ˜¯Authorization Serveréœ€è¦æä¾›çš„APIåœ°å€ï¼ŒClientä½¿ç”¨Postæ–¹å¼è«‹æ±‚é€™å€‹åœ°å€ã€‚</li><li>Accept:application/jsonï¼šè¡¨ç¤ºAuthorization Serveréœ€è¦è¿”å›ä¸€å€‹JSONæ ¼å¼çš„æ•¸æ“šã€‚</li><li>Content-Type: application/x-www-form-urlencodedï¼šå›ºå®šæ­¤æ ¼å¼ã€‚</li><li>Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JWï¼šè¨ªå•å—ä¿è­·è³‡æºçš„æˆæ¬Šæ†‘è­‰ã€‚</li><li>tokenï¼šå¿…é¸ï¼Œå¯ä»¥æ˜¯access_tokenæˆ–è€…refresh_tokençš„å…§å®¹ã€‚</li><li>token_type_hintï¼šå¯é¸ï¼Œè¡¨ç¤ºtokençš„é¡å‹ï¼Œå€¼ç‚ºâ€access_tokenâ€œæˆ–è€…"refresh_token"ã€‚</li></ol><p>å¦‚æœè«‹æ±‚æˆåŠŸï¼Œå‰‡æœƒè¿”å›å¦‚ä¸‹çš„ä¿¡æ¯ï¼š</p><pre> 1 { 2 "active": true, 3 "client_id": "l238j323ds-23ij4", 4 "token_type":"access_token", 5 "username": "jdoe", 6 "scope": "read write dolphin", 7 "sub": "Z5O3upPC88QrAjx00dis", 8 "aud": "https://protected.example.net/resource", 9 "iss": "https://server.example.com/",10 "exp": 1419356238,11 "iat": 1419350238,12 "nbf": 1419350238,13 "jti": "abcdefg"14 "extension_field": "twenty-seven"15 }</pre><p>JSONå„é …å±¬æ€§å«ç¾©å¦‚ä¸‹ï¼ˆå…¶ä¸­æœ‰äº›ä¿¡æ¯æ˜¯åœ¨JSON Web Tokenä¸­å®šç¾©çš„ï¼Œåƒè€ƒéˆæ¥æœ‰è©³ç´°çš„ä»‹ç´¹ï¼‰:</p><ol><li>activeï¼šå¿…é ˆçš„ã€‚è¡¨ç¤ºtokenæ˜¯å¦é‚„æ˜¯æœ‰æ•ˆçš„ã€‚</li><li>client_idï¼šå¯é¸çš„ã€‚è¡¨ç¤ºtokenæ‰€å±¬çš„Clientã€‚æ¯”å¦‚ä¸Šé¢çš„<strong>åœ¨ç·šæ‰“å°ä¸¦ä¸”åŒ…éƒµçš„ç¶²ç«™</strong>ã€‚</li><li>token_typeï¼šå¯é¸çš„ã€‚è¡¨ç¤ºtokençš„é¡å‹ã€‚å°æ‡‰å‚³éçš„token_type_hintã€‚</li><li>user_nameï¼šå¯é¸çš„ã€‚è¡¨ç¤ºtokençš„æˆæ¬Šè€…çš„åå­—ã€‚æ¯”å¦‚ä¸Šé¢çš„<strong>å°æ˜</strong>ã€‚</li><li>scopeï¼šå¯é¸çš„ã€‚å’Œä¸Šç¯‡5.1.1 Authorization Requestä¸­çš„å¯é¸åƒæ•¸scopeå°æ‡‰ï¼Œè¡¨ç¤ºæˆæ¬Šçµ¦Clientè¨ªå•çš„ç¯„åœï¼Œæ¯”å¦‚æ˜¯ç›¸å†Šï¼Œè€Œä¸æ˜¯å°æ˜çš„æ—¥èªŒä»¥åŠå…¶ä»–å—ä¿è­·è³‡æºã€‚</li><li>subï¼šå¯é¸çš„ã€‚tokenæ‰€å±¬çš„è³‡æºæ“æœ‰è€…çš„å”¯ä¸€æ¨™è­˜ï¼ŒJWTå®šç¾©çš„ã€‚ä¹Ÿå°±æ˜¯å°æ˜çš„å”¯ä¸€æ¨™è­˜ç¬¦ã€‚</li><li>audï¼šå¯é¸çš„ã€‚tokené ’ç™¼çµ¦èª°çš„ï¼ŒJWTå®šç¾©çš„ã€‚</li><li>issï¼šå¯é¸çš„ã€‚tokençš„é ’ç™¼è€…ï¼ŒJWTå®šç¾©çš„ã€‚</li><li>expï¼šå¯é¸çš„ã€‚tokençš„éæœŸæ™‚é–“ï¼ŒJWTå®šç¾©çš„ã€‚</li><li>iatï¼šå¯é¸çš„ã€‚issé ’ç™¼tokençš„æ™‚é–“ï¼ŒJWTå®šç¾©çš„ã€‚</li><li>nbfï¼šå¯é¸çš„ã€‚tokenä¸æœƒåœ¨é€™å€‹æ™‚é–“ä¹‹å‰è¢«ä½¿ç”¨ï¼ŒJWTå®šç¾©çš„ã€‚</li><li>jtiï¼šå¯é¸çš„ã€‚tokençš„å”¯ä¸€æ¨™è­˜ï¼ŒJWTå®šç¾©çš„ã€‚</li><li>extension_fieldï¼šå¯ä»¥è‡ªå·±æ“´å±•ç›¸é—œå…¶ä»–å±¬æ€§ã€‚</li></ol><p>å…¶ä¸­å¤§é‡çš„ä¿¡æ¯éƒ½æ˜¯å¯é¸çš„ä¿¡æ¯ï¼Œè€Œä¸”å¯ä»¥è‡ªå·±æ“´å±•éœ€è¦çš„å±¬æ€§ä¿¡æ¯ï¼Œå¾é€™äº›å±¬æ€§ä¸­å°±å¯ä»¥è§£æ±ºæˆ‘å€‘ä¸Šé¢æåˆ°çš„access_tokenå°æ–¼Clientä¸é€æ˜çš„å•é¡Œã€‚</p><p>æˆ‘å€‘æ³¨æ„åˆ°å…¶ä¸­æœ‰å¾ˆå¤šå±¬æ–¼JWTå®šç¾©çš„å±¬æ€§ï¼Œé‚£éº¼é€™å€‹JWTæ˜¯ä»€éº¼æ±è¥¿ï¼Ÿå®ƒè§£æ±ºäº†ä»€éº¼å•é¡Œï¼Ÿæ„Ÿèˆˆè¶£çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹ ã€ŠJSON Web Token (JWT)ã€‹ ã€‚</p><hr><p>å°æ–¼ä»¤ç‰Œå…ƒæ•¸æ“š API æ¥å£çš„å¯¦ç¾ï¼Œç­†è€…é€™è£¡å°±æš«æ™‚ä¸æä¾›ã€‚å¦‚æœæœ‰éœ€è¦çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹ TokenStore çš„å…©å€‹ API ï¼š</p><ul><li>#readAccessToken(String tokenValue) æ–¹æ³•ï¼Œè®€å–æŒ‡å®šçš„è¨ªå•ä»¤ç‰Œçš„ä¿¡æ¯ã€‚</li><li>#readRefreshToken(String tokenValue) æ–¹æ³•ï¼Œè®€å–æŒ‡å®šçš„åˆ·æ–°ä»¤ç‰Œçš„ä¿¡æ¯ã€‚</li></ul><h1><strong>666. å½©è›‹</strong></h1><p>ä¸€è¬å€‹æ³¨æ„ï¼Œæœ¬æ–‡åƒ…åƒ…æ˜¯ Spring Security OAuth2 çš„å…¥é–€æ–‡ç« ã€‚å¯¦éš›ç”Ÿç”¢ä½¿ç”¨æ™‚ï¼Œé‚„éœ€è¦åšå¾ˆå¤šäº‹æƒ…ã€‚ä¾‹å¦‚ï¼š</p><ul><li>ä½¿ç”¨é—œä¿‚æ•¸æ“šåº«ï¼Œ<strong>æŒä¹…åŒ–</strong>å­˜å„² Client å’Œä»¤ç‰Œä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ JdbcTokenStore ã€‚</li><li>æˆæ¬Šæœå‹™å™¨å’Œè³‡æºæœå‹™å™¨åˆ†é›¢ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ RemoteTokenServices ã€‚</li><li>ä½¿ç”¨ç·©å­˜æœå‹™å™¨ï¼Œæå‡ Client å’Œä»¤ç‰Œä¿¡æ¯çš„<strong>è¨ªå•</strong>é€Ÿåº¦ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ RedisTokenStore ã€‚</li></ul><p>æ¨è–¦é–±è®€æ–‡ç« ï¼š</p><ul><li>CatalpaFlat ã€ŠSpring Security OAuth2 æ·±å…¥è§£æã€‹</li><li>å°æ±å­ ã€ŠSpring Security OAuth2 é–‹ç™¼æŒ‡å—ã€‹</li><li>èŠèŠæ¶æ§‹ ã€Šè¼•é¬†ç±Œ 1.6 å„„è¨»å†Šç”¨æˆ¶çš„ Passport è³¬æˆ¶é«”ç³»æ¶æ§‹è¨­è¨ˆã€‹</li></ul></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Spring</a></li><li><a>Security</a></li><li><a>OAuth2</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/426ce0a.html alt="ä½¿ç”¨ Spring Security ä¿è­· Web æ‡‰ç”¨çš„å®‰å…¨" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/2ec6e597-bd62-4262-b0d9-f76be38ca833 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/426ce0a.html title="ä½¿ç”¨ Spring Security ä¿è­· Web æ‡‰ç”¨çš„å®‰å…¨">ä½¿ç”¨ Spring Security ä¿è­· Web æ‡‰ç”¨çš„å®‰å…¨</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/000afa08.html alt="Spring Boot 2.xåŸºç¤æ•™ç¨‹ï¼šSwaggeræ¥å£åˆ†é¡èˆ‡å„å…ƒç´ æ’åºå•é¡Œè©³è§£" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/daa2cfd29ec34306a4be6f3f257b824b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/000afa08.html title="Spring Boot 2.xåŸºç¤æ•™ç¨‹ï¼šSwaggeræ¥å£åˆ†é¡èˆ‡å„å…ƒç´ æ’åºå•é¡Œè©³è§£">Spring Boot 2.xåŸºç¤æ•™ç¨‹ï¼šSwaggeræ¥å£åˆ†é¡èˆ‡å„å…ƒç´ æ’åºå•é¡Œè©³è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6cfd4e0e.html alt="Spring æ ¸å¿ƒçŸ¥è­˜è¬›è§£ï¼Œå¤ªç°¡å–®å•¦" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6cfd4e0e.html title="Spring æ ¸å¿ƒçŸ¥è­˜è¬›è§£ï¼Œå¤ªç°¡å–®å•¦">Spring æ ¸å¿ƒçŸ¥è­˜è¬›è§£ï¼Œå¤ªç°¡å–®å•¦</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/090306a0.html alt="[Spring] æ·±å…¥ç­è§£äº‹å‹™åŸç†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/a8c6dbd7c51741f5a76262e8e2c7a670 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/090306a0.html title="[Spring] æ·±å…¥ç­è§£äº‹å‹™åŸç†">[Spring] æ·±å…¥ç­è§£äº‹å‹™åŸç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fb2bc471.html alt="ã€Œè­¯ã€ Spring çš„åˆ†ä½ˆå¼äº‹å‹™å¯¦ç¾â€”ä½¿ç”¨å’Œä¸ä½¿ç”¨ XAâ€”ç¬¬äºŒéƒ¨åˆ†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fb2bc471.html title="ã€Œè­¯ã€ Spring çš„åˆ†ä½ˆå¼äº‹å‹™å¯¦ç¾â€”ä½¿ç”¨å’Œä¸ä½¿ç”¨ XAâ€”ç¬¬äºŒéƒ¨åˆ†">ã€Œè­¯ã€ Spring çš„åˆ†ä½ˆå¼äº‹å‹™å¯¦ç¾â€”ä½¿ç”¨å’Œä¸ä½¿ç”¨ XAâ€”ç¬¬äºŒéƒ¨åˆ†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1678b1c4.html alt=ï¼ˆæ”¶è—ï¼‰Springäº‹å‹™å°ˆé¡Œï¼šäº‹å‹™çš„åŸºæœ¬æ¦‚å¿µï¼ŒMysqläº‹å‹™è™•ç†åŸç† class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/433259b5-1936-4cee-ab74-70aef36536ee style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1678b1c4.html title=ï¼ˆæ”¶è—ï¼‰Springäº‹å‹™å°ˆé¡Œï¼šäº‹å‹™çš„åŸºæœ¬æ¦‚å¿µï¼ŒMysqläº‹å‹™è™•ç†åŸç†>ï¼ˆæ”¶è—ï¼‰Springäº‹å‹™å°ˆé¡Œï¼šäº‹å‹™çš„åŸºæœ¬æ¦‚å¿µï¼ŒMysqläº‹å‹™è™•ç†åŸç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d3c48fcc.html alt=Springè²æ˜å¼äº‹å‹™è™•ç†çš„å¯¦ç¾åŸç†ï¼Œä¾†è‡ªé¢è©¦å®˜çš„çª®è¿½æ‹·å• class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d3c48fcc.html title=Springè²æ˜å¼äº‹å‹™è™•ç†çš„å¯¦ç¾åŸç†ï¼Œä¾†è‡ªé¢è©¦å®˜çš„çª®è¿½æ‹·å•>Springè²æ˜å¼äº‹å‹™è™•ç†çš„å¯¦ç¾åŸç†ï¼Œä¾†è‡ªé¢è©¦å®˜çš„çª®è¿½æ‹·å•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e61e6b6d.html alt="Spring Boot çµ±ä¸€ç•°å¸¸é€™æ¨£è™•ç†å’Œå‰–æï¼Œå®‰å¦ï¼Ÿ" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/95dd8dbd-33ff-4c32-a4b5-fd78e6126995 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e61e6b6d.html title="Spring Boot çµ±ä¸€ç•°å¸¸é€™æ¨£è™•ç†å’Œå‰–æï¼Œå®‰å¦ï¼Ÿ">Spring Boot çµ±ä¸€ç•°å¸¸é€™æ¨£è™•ç†å’Œå‰–æï¼Œå®‰å¦ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dcf7d4b4.html alt="Springäº‹å‹™å¤±æ•ˆçš„ 8 å¤§åŸå› ï¼Œé€™æ¬¡å¯ä»¥åŠæ‰“é¢è©¦å®˜äº†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dcf7d4b4.html title="Springäº‹å‹™å¤±æ•ˆçš„ 8 å¤§åŸå› ï¼Œé€™æ¬¡å¯ä»¥åŠæ‰“é¢è©¦å®˜äº†">Springäº‹å‹™å¤±æ•ˆçš„ 8 å¤§åŸå› ï¼Œé€™æ¬¡å¯ä»¥åŠæ‰“é¢è©¦å®˜äº†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e83df1dd.html alt=Springåˆ‡é¢ç²å–ä¸åˆ°requestçš„åƒæ•¸å€¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0b6e5064b47940df843a25466066845d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e83df1dd.html title=Springåˆ‡é¢ç²å–ä¸åˆ°requestçš„åƒæ•¸å€¼>Springåˆ‡é¢ç²å–ä¸åˆ°requestçš„åƒæ•¸å€¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/52b013de.html alt="Spring Bootä¸­æ–‡åƒè€ƒæŒ‡å—ï¼ˆ2.1.6ï¼‰90ã€ç†±äº¤æ›" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/52221486045249f1a4a361d34e84016e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/52b013de.html title="Spring Bootä¸­æ–‡åƒè€ƒæŒ‡å—ï¼ˆ2.1.6ï¼‰90ã€ç†±äº¤æ›">Spring Bootä¸­æ–‡åƒè€ƒæŒ‡å—ï¼ˆ2.1.6ï¼‰90ã€ç†±äº¤æ›</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b91a8349.html alt="Spring AOPç°¡ä»‹èˆ‡åº•å±¤å¯¦ç¾æ©Ÿåˆ¶â€”â€”å‹•æ…‹ä»£ç†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/413780d1-cf47-4038-9471-b686d97aa99b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b91a8349.html title="Spring AOPç°¡ä»‹èˆ‡åº•å±¤å¯¦ç¾æ©Ÿåˆ¶â€”â€”å‹•æ…‹ä»£ç†">Spring AOPç°¡ä»‹èˆ‡åº•å±¤å¯¦ç¾æ©Ÿåˆ¶â€”â€”å‹•æ…‹ä»£ç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7b564e1e.html alt="Spring bootå­¸ç¿’ï¼ˆå…­ï¼‰Spring bootå¯¦ç¾AOPè¨˜éŒ„æ“ä½œæ—¥èªŒ" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/6824f504d2264a748492cd7ceb6732ba style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7b564e1e.html title="Spring bootå­¸ç¿’ï¼ˆå…­ï¼‰Spring bootå¯¦ç¾AOPè¨˜éŒ„æ“ä½œæ—¥èªŒ">Spring bootå­¸ç¿’ï¼ˆå…­ï¼‰Spring bootå¯¦ç¾AOPè¨˜éŒ„æ“ä½œæ—¥èªŒ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/341006dc.html alt="SpringBootç³»åˆ—ï¼ˆ14ï¼‰ï¼šSpring AOPè£é€¼æŒ‡å—ä¹‹å¯¦ç¾æ“ä½œæ—¥èªŒè¨˜éŒ„" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/7bc702acb84d4284b4df028da09900db style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/341006dc.html title="SpringBootç³»åˆ—ï¼ˆ14ï¼‰ï¼šSpring AOPè£é€¼æŒ‡å—ä¹‹å¯¦ç¾æ“ä½œæ—¥èªŒè¨˜éŒ„">SpringBootç³»åˆ—ï¼ˆ14ï¼‰ï¼šSpring AOPè£é€¼æŒ‡å—ä¹‹å¯¦ç¾æ“ä½œæ—¥èªŒè¨˜éŒ„</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b5dd97d4.html alt=Springæ¡†æ¶AOPæŠ€è¡“ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/760bf32faca443cb8e28ed0b9bc20205 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b5dd97d4.html title=Springæ¡†æ¶AOPæŠ€è¡“>Springæ¡†æ¶AOPæŠ€è¡“</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>