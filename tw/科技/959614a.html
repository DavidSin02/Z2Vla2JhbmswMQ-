<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Andorid-APP 安全（四）之流量分析與內外存儲 | 极客快訊</title><meta property="og:title" content="Andorid-APP 安全（四）之流量分析與內外存儲 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/dab8cd614ee54fdfab796f94ec547412"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/959614a.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/959614a.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/959614a.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/959614a.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/959614a.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/959614a.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/959614a.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/959614a.html><meta property="article:published_time" content="2020-10-29T20:53:03+08:00"><meta property="article:modified_time" content="2020-10-29T20:53:03+08:00"><meta name=Keywords content><meta name=description content="Andorid-APP 安全（四）之流量分析與內外存儲"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/959614a.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Andorid-APP 安全（四）之流量分析與內外存儲</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dab8cd614ee54fdfab796f94ec547412><p class=pgc-img-caption></p></div><p>繼上一篇Andorid-APP 安全測試（三）的內容</p><p>安全測試（四）主要針對三個方面來寫：Andorid逆向與審計的補充、對 Android 設備進行流量分析、Android內外存儲基礎知識、Android 取證。因Android 取證涉及內容有點多，大部分內容會在安全測試（五）中寫到。</p><p>Andorid逆向與審計的補充</p><p>Android 逆向與審計中對於源碼混淆的審計我在第一篇APP文章中有寫到，https://www.secpulse.com/archives/74861.html。前不久在一論壇看到一個大佬在2012的一篇文章，對於判斷APK文件是否混淆 思路簡單新穎（2012年的時候就有大佬提出了，然而我卻在2019年才偶遇這篇文章~我和大佬的距離差了七年。）在這裡分享給小夥伴，參考鏈接：https://bbs.pediy.com/thread-159959.htm。</p><p>一個簡單的方法判斷APK文件是否混淆。</p><p>目前越來越多的惡意apk文件為了對抗殺毒軟件以及分析人員的分析，由於商業軟件自身的保密需要，很大程度上都會進行一定的混淆，更有甚者採用全反射調用的來掩藏自己的真實意圖。雖然一定程度上經過混淆的文件的其文件大小都會變小。以著名的proguard為例，經過處理的apk文件大小往往不到其未經過處理的apk文件的1/3。</p><p>由於apk文件的混淆往往是伴隨著文件的壓縮和代碼的優化問題，混淆的apk文件解壓轉換為jar文件，使用ju-gui打開以後有一個不太引人注意的細節問題---其中找不到資源文件類。</p><p>利用這一特性，我們可以直接利用apktool解壓apk文件，對其smali文件的文件名進行分析，如果存在一個或以上的資源的smali文件，就可以證明該apk文件沒有混淆，反之，則說明已經是混淆過了的文件。如下圖所示</p><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2d5b84d05fdc4a3c89ef12faeed26d54><p class=pgc-img-caption></p></div><p>而全反射調用的判斷就比較簡單了，直接判斷是否存在forname函數。</p><p>對於全反射調用請自行百度瞭解下吧~。</p><p>** 調用系統隱藏的API: 使用Class.forName("全類名")調用</p><p>哪些情況會使用反射</p><p>1. 指定類名/全類名字符串</p><p>2. 使用反射相關API : Class Method Field</p><p>對 Android 設備進行流量分析</p><p>網絡流量是指，能夠連接網絡的設備在網絡上所產生的數據流量。</p><p>性能數據給出的網絡流量性能數據可以區分接收流量和發送流量：</p><p>接收流量：應用運行期間，網卡的下行流量，單位是字節</p><p>發送流量：應用運行期間，網卡的上行流量，單位是字節</p><p>通常應用程序會在網絡數據中洩漏敏感信息。此外，你經常會遇到通過不安全的網絡協議執行身份驗證和會話管理的應用程序。網絡流量分析我們主要分兩種：被動分析和主動分析。</p><p>被動分析：</p><p>應用程序發送的網絡數據不會被攔截。相反，我們將嘗試捕獲所有網絡數據包，然後在網絡分析器（如Wireshark）中打開它，然後嘗試找出應用程序中的漏洞或安全問題。</p><p>被動分析：可以使用 tcpdump 來將所有的信息保存到設備中一個位置。此後，我們將該文件拉取到我們的系統，然後使用 Wireshark或其他包分析器查看它。</p><p>下面是我對被動分析做的詳細實驗步驟，僅供參考~</p><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/093117704c8e4542b638128b5563f327><p class=pgc-img-caption></p></div><p>準備工具：wireshark，netcat，tcpdump</p><p>tcpdump鏈接：http://www.strazzere.com/android/tcpdump</p><p>tcpdump(需Root用戶運行)攔截和顯示發送或收到過網絡連接到該機器的TCP/IP和其他數據包。簡單說就監控手機進出網絡數據。</p><p>Tcpdump抓取手機數據包特點：</p><p>1).基本只能針對Android手機</p><p>2).不能實時抓包</p><p>3).電腦需要安裝Android SDK</p><p>4).電腦需要安裝Wireshark</p><p>5).測試手機需要獲取root權限</p><p>6).測試手機需要安裝tcpdump軟件</p><p>假如你的Android設備已經root了，你可以用如下方式創建一個目錄，存放TCPdump的二進制可執行文件。</p><p>通過ADB命令，在Android設備上依次執行下面的命令。</p><pre>adb shell sumkdir /data/tcpdump/chmod 777 /data/tcpdump/</pre><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/994bdfef8a624f9d9dad698e5f36c01e><p class=pgc-img-caption></p></div><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2a54ea09b452483eb416ec685df69ee1><p class=pgc-img-caption></p></div><p>然後跳轉到你本地tcpdump 的保存目錄下，把下載後的tcpdump 上傳到你的Android的tcpdump 的目錄下。</p><p>執行下面命令：</p><pre>adb push tcpdump /data/tcpdump /adb shellsuchmod 777 /data/tcpdump /tcpdump</pre><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/cf780b1ebc02418095121411fe6404f2><p class=pgc-img-caption></p></div><p>當你把for android 版的tcpdump上傳到設備上後，並把他的權限設為可執行之後，你應該執行下面這條命令，確認Android設備上的NETCAT是可用的。</p><p>如圖：</p><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/905c2775a68640609be21cf54419563e><p class=pgc-img-caption></p></div><p>上面運行nc不過是個確認檢查而已，在大多數版本的Android系統上默認都自帶了NETCAT 。如果沒有，可以去下載一個。</p><p>確認了tcpdump和NETCAT都已經安裝到你的Android設備上後，你可以執行下面命令，抓取網絡流量，如果一切正常，你應該在屏幕上看見輸出下面的這些信息。</p><p>./data/tcpdump/tcpdump -w - | nc -l -p 31337</p><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/57550cc0c92140528badf9428e2b9c0a><p class=pgc-img-caption></p></div><p>你應該把tcpdump的輸出傳給裝在你本地計算機的Wireshark上，要完成這個任務，首先要執行下面命令，通過ADB設置一下端口轉發</p><pre>adb forward tcp:12345 tcp:31337</pre><p>在端口轉發之後，運行你本地計算機的NETCAT</p><p>ne .exe 127.0.0.1 12345</p><p>這樣做了之後，所有的流量都會被正確的轉發，你可以通過管道把輸出轉接到Wireshark。</p><pre>adb forward tcp:12345 tcp:31337 &amp;&amp; nc.exe 127.0.0.1 12345 | Wireshark -k -S -i -</pre><p>運行此命令前我將netcat還有wireshark放在了同一目錄下，之後就可以看到wireshark運轉起來。</p><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e362bd132fa74f618bf6a8f65dca9f32><p class=pgc-img-caption></p></div><p>還可以將數據包導出到電腦，用wireshark打開</p><p>如下命令：</p><pre>/tcpdump -p -vv -s 0 -w /sdcard/11.pcap #執行抓包命令，結果保存到SD卡22.pcap文件中adb pull /sdcard/22.pcap E:/ #前為手機中文件及存放路徑，後為電腦E盤根目錄</pre><p>使用Wireshark等工具分析抓包文件22.pcap</p><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c067768d7530453c84a2fab636322564><p class=pgc-img-caption></p></div><p>主動分析：</p><p>在主動分析中，滲透測試者將主動攔截所有正在進行的網絡通信，並可以即時分析，評估和修改數據。這裡需要設置代理，並且由應用/設備生成和接收的所有網絡流量會通過該代理。</p><p>這裡我們最常用的抓包工具就是burpsuite。利用burpsuite攔截數據包流量只需要在設置代理。</p><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6b91698910ad4b46a89aec5acce8ce6e><p class=pgc-img-caption></p></div><p>為了檢查代理是否工作，打開任意APP。 然後我們能夠看到它是否在代理中被攔截。</p><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f7b979160c8d4a82bccf67028c359d2b><p class=pgc-img-caption></p></div><p>就先不說講述的專業不專業，說我這個碼是不是打的很專業~</p><p>正如我們在上面的屏幕截圖中看到的，我們成功地攔截了來自設備和應用程序的所有基於 HTTP 的請求。</p><p>當通過 HTTP 協議進行通信時，上述方法可以正常用於應用和流量器的流量攔截。 在</p><p>HTTPS 中，由於證書不匹配，因此我們無法攔截流量。我們只需要將burpsuite中證書導出，安裝到手機證書中即可。網上關於“Burpsuite抓取手機app的數據包-證書的導入”這類文章很多，百度到的一個僅供參考：https://blog.csdn.net/u011975363/article/details/83654074</p><p>之後就能看到抓包工具中抓取到了Https流量</p><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/16c2989c2c4c480eae6673c5e8930e3d><p class=pgc-img-caption></p></div><p>以上是對Android被動分析、主動分析工具使用的詳細介紹，歡迎小夥伴評論分享新思路哦~</p><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/806d29f93f534f5fa6e15fc52bc90d98><p class=pgc-img-caption></p></div><p>Android內外存儲基礎知識</p><p>在這裡提到Android內外存儲的基礎知識，也是為了後面在Android取證部分中會涉及到數據的存儲位置。</p><p>Android手機上的存儲空間可做如下劃分：</p><p>內存：RAM</p><p>內部存儲：內部ROM</p><p>外部存儲：外部ROM和SDCard</p><p>手機上的存儲在概念上分成了”內部internal“和”外部external“兩部分，但其實都在手機內部。因此無論Android手機是否有可移動的sdcard，它都有外部存儲和內部存儲，且通過相同的Api方法來訪問可移動的sdcard或者手機自帶的存儲。</p><p>以下是一部手機的存儲展示圖，用SDK中DDMS自帶的Device File Explore打開後展現的文件目錄。</p><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2532e368e4e7465b9bd9ee6c1aa8f23d><p class=pgc-img-caption></p></div><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/305e8dbe420048889cd7afd4c3bb7bd3><p class=pgc-img-caption></p></div><p>（1）內部存儲：</p><p>Android可以說是一個Linux操作系統，它的內部存儲空間對於應用程序和用戶來講就是“/data/data“目錄。內部存儲與外部存儲相比有著比較穩定，存儲方便，操作簡單，更加安全（可以控制訪問權限）等優點，而它唯一的缺點就是空間有限。</p><p>內部存儲空間的有限意味著應物盡其用，用來保存比較重要的數據，例如用戶信息資料，口令祕碼等不需要與其他應用程序共享的數據。注意應用程序被卸載時，應用程序在內部存儲空間的文件數據將全部被刪除，避免佔用寶貴的空間。</p><p>內部存儲即data文件夾，其中裡面有兩個文件夾值得關注：</p><p>·app文件夾（未root無法打開）：存放著所有app的apk文件夾，當開發者調試某個app時，AS控制檯輸出的內容中有一項是uploading…，代表正在上傳apk到這個文件夾。</p><p>·data文件夾：內部都是app的包名，存儲著應用程序相關的數據，例如 data/data/包名/(shared_prefs、database、files、cache)</p><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/5e599efe957d4bc6a7259ea867f96078><p class=pgc-img-caption></p></div><p>（2）外部存儲：</p><p>外部存儲是指用戶在使用時自行在手機上添加的外部存儲介質，例如TS卡，SD卡等閃存儲介質。其顯著的優點就是存儲空間大，無需擔心數據清除問題，與內部存儲不同的是當應用程序卸載時，它在外部存儲所創建的文件數據不會被清除，因此清理外部存儲空間的責任丟給了用戶自己。缺點則是不太穩定，閃存介質對於Android手機而言會出現SD卡不能正常使用的情況。</p><p>外部存儲即storage文件夾或mnt文件夾。需要注意的是storage中有一個sdcard0文件夾，其中又分為公有目錄和私有目錄：</p><ul><li>公有目錄：有9大類，比如DCIM、Download等系統為用戶創建的文件夾；私有目錄： 即Android文件夾/storage/sdcard/Android/，其中的data文件夾包含了許多包名組成的文件夾。</li></ul><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dc1e888acc28484b86b3fc16e499ffb1><p class=pgc-img-caption></p></div><p>若應用程序在運行過程中需要向手機上保存數據，通常是保存在sdcard中/storage/sdcard，即應用直接在sdcard的根目錄創建一個文件夾用於數據保存，不過當該app被卸載後，數據還保留在sdcard中，意味著留下了垃圾數據。</p><p>在開發中，Google官方建議App數據存儲在外部存儲的私有目錄中對應App的包名下storage/sdcard/Android/data/包名/，這樣當用戶卸載掉App之後，相關的數據會一併刪除！</p><p>（3）內外部存儲常用目錄操作</p><ul><li>context.getFilesDir() 內部存儲data/data/包名/files目錄context.getCacheDir() 內部存儲data/data/包名/cache目錄Environment.getExternalStorageDirectory() 外部存儲根目錄Environment.getExternalStoragePublicDirectory (Environment.DIRECTORY_DCIM) 外部存儲公有目錄context.getExternalFilesDir() 外部存儲私有目錄storage/sdcard/Android/data/包名/files。一般存儲長時間保存的數據。context.getExternalCacheDir() 外部存儲私有目錄storage/sdcard/Android/data/包名/cache。一般存儲臨時緩存數據。</li></ul><p>注意上述最後兩個API：當app被卸載後，sdCard/Android/data/PackageName/下的所有文件都會被刪除，不會留下垃圾信息。兩個API對應的目錄分別對應著 設置->應用->應用詳情裡面的“清除數據”與“清除緩存”選項。</p><p>（4）sd卡路徑隨著Android版本變化</p><ul><li>android 4.0</li></ul><p>Galaxy Nexus(GN)手機上的userData分區很大，被掛在/data 目錄下。用戶的數據通常是存儲在SD卡上，可是GN無SD卡，即只有intenal內部存儲。</p><p>Google直接在userData分區下虛擬了一個media目錄，它是內置sd卡的數據存儲位置，具體使用了fuse技術將/data/media虛擬成為一個叫做/dev/fuse的設備，為了讓程序能認出來，被同時掛載在 /mnt/sdcard 目錄，又為了兼容以前的程序，做了一個快捷方式（linux系統裡叫軟連接），因此 /sdcard 指向的就是 /mnt/sdcard。</p><ul><li>android 4.1</li></ul><p>在4.1中同樣使用fuse技術，/dev/fuse 會被同時掛載到/storage/sdcard0 目錄。“sdcard0”表示第一個sd卡（若有外置sd卡，那會多一個 /storage/sdcard1） /sdcard 軟連接會指向 /storage/sdcard0 ，此時/mnt/sdcard 也是個軟連接，會指向/storage/sdcard0。</p><p>/storage/sdcard0才是最終源頭，/sdcard、/mnt/sdcard是指向它的一個軟連接而已。</p><ul><li>android 4.2及之後</li></ul><p>在4.2之後，Android出現了一個“多用戶”的功能特徵，意味著一臺設備可能被多個人同時應用，因此需要將每個人的數據、應用、個性配置分開。</p><p>4.2版本中同樣使用fuse技術，而/dev/fuse 會被掛載到/storage/emulated/0 目錄。（若有多個用戶，0文件夾名稱依次增加，例如/storage/emulated/1）</p><p>不僅如此，為了兼容Android版本升級，還同時掛載到/storage/emulated/legacy，建立了三個軟連接指向自己：</p><ul><li>·/storage/sdcard0·/sdcard·/mnt/sdcard</li></ul><p>也許在手機設備開發中似乎沒太注意到“多用戶”新特性的作用，無需太過在意，它主要在平板上使用，手機端是禁用的，但底層實現原理相同。</p><p>/mnt/shell/emulated 目錄和 /storage/emulated 下的文件夾是一樣的。</p><p>/sdcard/：只是一個符號鏈接，鏈接到/storage/sdcard0/</p><p>/mnt/sdcard：Android4.0版本之前的顯示</p><p>/storage/sdcard0 ：Android4.0版本之後的顯示</p><p>/storage/emulated/0/：這是參照“emulated MMC”，通常指其內部，“0”代表第一個用戶，即設備擁有者。 如果您創建其他用戶，則此數字將為每個用戶增加。</p><p>/storage/emulated/legacy/：與上同理，但指向當前工作用戶的部分。（對於“0”用戶而言，這是/storage/emulated/0/的符號鏈接）</p><p>/storage/sdcard0/：注意這裡的“0”並非是一個單獨文件夾名，而是作為後綴一樣，意味著“0”並不代表用戶，而是設備（卡）本身，因此它不需要legacy鏈接。人們可以通過OTG將讀卡器與另一個SD卡連接起來，然後路徑將成為/storage/sdcard1/。</p><p>為了兼容Android版本升級，還同時掛載到/storage/emulated/legacy，建立了三個軟連接指向自己：/storage/sdcard0 、/sdcard、/mnt/sdcard。</p><p>Android 取證</p><p>Android 取證這部分內容會涉及比較多，大部分內容我會寫在安全測試（五）中。本章安全測試（四）只做一個簡單介紹，以下對Android 取證技術的講解，思路取材大多來源於網絡以及《Android 取證實戰》一書。</p><p>之後所寫的關於Android取證的大概思路，都在如下我清晰的草稿紙上。</p><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/7d7445f50d23460ba48a6c078b56d605><p class=pgc-img-caption></p></div><p>取證類型：</p><p>邏輯採集：取證員與設備交互並從文件系統提取數據。該數據可以是任何內容，諸如應用特定數據，聯繫人，通話記錄，消息，web 瀏覽器歷史，社交網絡用戶信息和財務信息。邏輯採集的優點是，在大多數情況下比物理採集更容易獲取邏輯信息。然而，在一些情況下，該方法的一個限制是，在這種情況下的證據（智能手機及其數據）具有被篡改的高風險。</p><p>物理採集：這意味著對整個物理存儲介質進行逐位拷貝。我們還可以在執行物理採集時定位不同的單個分區。與邏輯採集相比，這種方法慢得多，但更可靠和可信賴。此外，為了在智能手機上執行物理採集，檢查者需要熟悉不同類型的文件系統，例如 Yet Another Flash File System 2（YAFFS2），ext3，ext4，rfs 等。</p><p>文件系統：</p><p>在 Android 中進行物理採集有點棘手，一個主要原因是文件系統不同。</p><p>Android 文件系統的主分區通常被分區為 YAFFS2。在 Android 中使用 YAFFS2 的原因是，它為設備提供了優勢，這包括更高的效率和性能，以及更低的佔用空間。幾年前，當 Android 剛剛推出時，取證是平臺上的一個大問題，因為幾乎沒有支持 YAFFS2 文件系統格式的取證工具。</p><p>SD 卡是 FAT32 類型，是正常系統用戶中的共享格式。因此，為了獲取SD卡的映像，可以使用任何常規的數據採集取證工具。</p><p>大多說用戶使用的U盤格式都是FAT32格式，因為它的兼容性相對好一些，幾乎可以完美應對所有操作系統，並且快速的進行讀寫工作。但是它的缺點是是不能設置權限，安全等級較低。並且最關鍵的一點就是它最高只能支持4G以下的單個文件傳輸。隨著文件越來越大，一個高清的電影就已經達到了好幾個G的大小，相比之下FAT32已經屬於落後“產品”。</p><p>製作副本或創建現有數據系統映像的最有名的工具之一是 dd，它從原始來源到系統進行逐塊複製。然而，由於該工具的一些缺點，例如缺少內存塊以及跳過壞塊，會導致數據損壞，因此不推薦在取證調查期間使用。</p><p>如何查看Android 文件系統分區：</p><p>Android 基於 Linux 內核，並從 Linux 本身派生其大部分功能和屬性。 在 Android 中，文件系統被劃分為不同的分區，每個分區都具有重要意義。在 Android 設備上查看分區，我們可以使用 adb shell 然後查看 proc下的 mtd文件，如下面的命令所示。</p><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d5eff665c5bb4de1968488e20d0b18ab><p class=pgc-img-caption></p></div><p>在大多數 Android設備上，我們通常會看到一些數據分區，如system，userdata ， cache ，recovery ，boot ，pds ，kpanic 和misc ，它們安裝在dev 列指定的不同位置。為了看到不同的分區和類型，我們可以在 adb shell中鍵入mount。</p><p>通過執行 mount 命令列表，所有不同的分區及其位置將被掛載：</p><div class=pgc-img><img alt="Andorid-APP 安全（四）之流量分析與內外存儲" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0aaa75154f254be3a4dac4f7ad16d942><p class=pgc-img-caption></p></div><p>Android USB大容量存儲終端設備映像</p><p>目前所有的Android終端設備都配備有外接的安全數字（SDK）卡，或者是內置的多媒體卡（eMMC），給用戶提供所需要的大容量存儲空間。需要這些存儲終端設備的理由是基於安全和隱私保護的需要，通常存儲在/data/data中的用戶應用數據都是被隔離開的。然而，用戶希望在Android終端設備和個人電腦之間來回拷貝音樂、圖像、視頻或者其他各類文件，這些大容量的FAT文件系統分區可以解決這些問題。用戶的敏感數據依然能夠得到保護，同時，用戶又能夠訪問大尺寸、便攜式的文件。</p><p>如何獲得SD卡或eMMC的取證映像</p><p>在不需要從終端設備中取出任何卡的前提下，目前從SD卡或eMMC中獲取取證映像的方式主要有兩種。第一種方法將UMS終端設備接口暴露給取證工作站，然後使用任何可選擇的取證工具獲取映像。第二種方法，不將USB暴露給取證工作站，而是在終端設備上使用dd命令。</p><p>關於android取證詳細的工具介紹以及使用方式將在下一篇寫到，歡迎小夥伴一起探討android安全相關問題，一起學習一起成長~</p><p>最後：祝大家新年快樂哦~</p><p>本文參考鏈接：</p><p>https://www.jianshu.com/p/23abbd62781e</p><p>https://bbs.pediy.com/thread-159959.htm。</p><p>https://www.jianshu.com/p/70db63beafff</p><p>https://blog.csdn.net/itermeng/article/details/79423035</p><p>參考資料：</p><p>《Android 滲透測試學習手冊》</p><p>《Android取證實戰：調查、分析與移動安全》</p><p>作者：Lemon</p><p>歡迎來安全脈搏查看更多的乾貨文章和我們一起交流互動哦！</p><p>脈搏地址：安全脈搏 | 分享技術，悅享品質</p><p>微博地址:Sina Visitor System</p><p>【注：安全脈搏所有文章未經許可，謝絕轉載】</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>外存</a></li><li><a>Andorid</a></li><li><a>APP</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/397120ff.html alt="“開放雨花”APP 正式上線，一鍵樂享雨花“掌上生活”" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RZlr9KB3QUXPmk style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/397120ff.html title="“開放雨花”APP 正式上線，一鍵樂享雨花“掌上生活”">“開放雨花”APP 正式上線，一鍵樂享雨花“掌上生活”</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9feb8b0e.html alt="中國銀聯助力招行掌上生活APP公繳場景建設 服務更廣大持卡人" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9feb8b0e.html title="中國銀聯助力招行掌上生活APP公繳場景建設 服務更廣大持卡人">中國銀聯助力招行掌上生活APP公繳場景建設 服務更廣大持卡人</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/da255287.html alt=使用招行掌上生活APP管理名下所有信用卡還款 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/528ea75d73cc4ef38ba1d522b1cf5154 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/da255287.html title=使用招行掌上生活APP管理名下所有信用卡還款>使用招行掌上生活APP管理名下所有信用卡還款</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1707f15d.html alt=招商銀行掌上生活APP可直接註冊綁定雲閃付APP，還送超值開卡禮！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/5b480001a2dfc14e3af7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1707f15d.html title=招商銀行掌上生活APP可直接註冊綁定雲閃付APP，還送超值開卡禮！>招商銀行掌上生活APP可直接註冊綁定雲閃付APP，還送超值開卡禮！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/75f7a232.html alt=招商銀行汪建中：掌上生活APP現在累計用戶達7千萬 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/75f7a232.html title=招商銀行汪建中：掌上生活APP現在累計用戶達7千萬>招商銀行汪建中：掌上生活APP現在累計用戶達7千萬</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5c546e61.html alt=招行銀行掌上生活APP領66積分 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/R9LsgJU8gpQzpg style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5c546e61.html title=招行銀行掌上生活APP領66積分>招行銀行掌上生活APP領66積分</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/df20af6e.html alt=掌上生活APP新版本發佈 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/15354421682856b040a7d53 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/df20af6e.html title=掌上生活APP新版本發佈>掌上生活APP新版本發佈</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d5ed9b10.html alt=掌上生活APP：積分模塊設計分析 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/Rj5TAZoAjFz5G2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d5ed9b10.html title=掌上生活APP：積分模塊設計分析>掌上生活APP：積分模塊設計分析</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dc65dad3.html alt=收藏夾必收APP使用教程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/15319959779178836430bd3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dc65dad3.html title=收藏夾必收APP使用教程>收藏夾必收APP使用教程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3c15c017.html alt=分享一款國產APP股票圖形引擎 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/4eb5ae1dcf834fae9f8fd15d33b9ba6e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3c15c017.html title=分享一款國產APP股票圖形引擎>分享一款國產APP股票圖形引擎</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0ac13623.html alt="Android 11加入新功能：長期不用的APP自動關閉敏感權限" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/Rx4J9h84rlZBze style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0ac13623.html title="Android 11加入新功能：長期不用的APP自動關閉敏感權限">Android 11加入新功能：長期不用的APP自動關閉敏感權限</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bad37f62.html alt=旅行路上必備的十大戶外APP，如果沒有趕快下載吧 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/aaf21b830ddc4bcc9a1ac8b6f41f4d70 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bad37f62.html title=旅行路上必備的十大戶外APP，如果沒有趕快下載吧>旅行路上必備的十大戶外APP，如果沒有趕快下載吧</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4f0154d3.html alt=券商APP宕機背後：券商經理“很忙”一直在接電話 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RxQgaPMHX8M0Su style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4f0154d3.html title=券商APP宕機背後：券商經理“很忙”一直在接電話>券商APP宕機背後：券商經理“很忙”一直在接電話</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c1ec0b2c.html alt=招商證券APP出現“宕機”？客服迴應：可嘗試重新登陸 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c1ec0b2c.html title=招商證券APP出現“宕機”？客服迴應：可嘗試重新登陸>招商證券APP出現“宕機”？客服迴應：可嘗試重新登陸</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/24ae8718.html alt="牛市突如其來 多家券商APP不堪重壓現“久違”宕機" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/24ae8718.html title="牛市突如其來 多家券商APP不堪重壓現“久違”宕機">牛市突如其來 多家券商APP不堪重壓現“久違”宕機</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>