<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>管理API訪問令牌的安全最佳實踐 | 极客快訊</title><meta property="og:title" content="管理API訪問令牌的安全最佳實踐 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/288f721723b1489c81d62de6aa6cfd33"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/989ea117.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/989ea117.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/989ea117.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/989ea117.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/989ea117.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/989ea117.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/989ea117.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/989ea117.html><meta property="article:published_time" content="2020-11-14T21:00:28+08:00"><meta property="article:modified_time" content="2020-11-14T21:00:28+08:00"><meta name=Keywords content><meta name=description content="管理API訪問令牌的安全最佳實踐"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/989ea117.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>管理API訪問令牌的安全最佳實踐</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>API包含在所有內容中，因此管理其安全性至關重要。請繼續閱讀，向集成和應用程序開發專家學習。</p><p>現代應用程序（基於Web和本機）依賴後端的API來訪問受保護的資源。要授權訪問這些API，請求必須包含某種訪問令牌或密鑰。本文重點介紹訪問令牌管理的安全最佳實踐 - 適用於API提供商和應用程序開發人員。</p><p><strong>讓我們談談信任第一！</strong></p><p>在處理安全性時，優先考慮一條規則：不要信任任何人。如果您是API提供商，則您不能相信調用API的應用程序是您期望的那個，您收到的令牌沒有被盜，或者客戶端和服務器之間的通信沒有被截獲。在客戶端，您不能相信應用程序不會被反編譯（暴露嵌入的祕密），應用程序存儲不會通過XSS攻擊受到損害，或者您的用戶不會被欺騙提交偽造的請求。</p><p>這意味著您必須採取適當的措施來安全地獲取，存儲和管理調用後端API所需的安全令牌。</p><p>此外，如果您從未公開宣傳過API，您可能認為您的API是安全的。對您而言，他們感到私密，因為它們僅供您的企業應用程序使用。但是，如果它們可以在移動應用程序中使用，則它們在公共互聯網上，因此是公開的。在企業網絡外部暴露的任何API都必須被視為公開的。</p><p><strong>獲取令牌的API密鑰</strong></p><p>在使用API時，通常會提供兩種選擇：將一段靜態信息與API調用一起傳遞，或者在調用API之前動態獲取該信息。這條信息通常是訪問令牌或API密鑰。出於傳統原因，BasicAuth仍用於某些API，但作為主流解決方案被棄用。</p><p>在設計API的安全性方面時，您必須明智地選擇API使用者如何訪問它。按照通常的安全措施，誘發風險是考慮的關鍵因素。保護僅允許諮詢天氣數據的API與保護銀行支付API非常不同。</p><p>雖然開發人員使用API密鑰更容易，但它不能提供與使用雙因素用戶身份驗證和客戶端應用程序的正確標識獲得的訪問令牌相同的安全級別。此外，API密鑰不攜帶有關用戶的任何信息，也不能在後端級別用於決定允許API使用者調用哪些操作。最後，除非API提供商撤銷，否則API密鑰永不過期。</p><p>創建OAuth是為了解決這些缺點：</p><ul><li>訪問資源的應用程序是已知的（使用客戶端應用程序憑據）。</li><li>API提供程序可以定義範圍以限制對某些操作的訪問（您可以獲取目錄條目，但是即使使用有效的標記，也不能輸入新的目錄條目）。</li><li>令牌的生命週期有限。</li></ul><p><strong>讓我們從一些術語開始</strong></p><p>OAuth術語有時會令人困惑。在下表中，我們提供了從實用的，以開發為重點的術語到OAuth術語的映射。</p><div class=pgc-img><img alt=管理API訪問令牌的安全最佳實踐 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/288f721723b1489c81d62de6aa6cfd33><p class=pgc-img-caption></p></div><p><strong>不透明與JWT</strong></p><p>OAuth不強制使用訪問令牌格式，因此，根據OAuth服務器實現，訪問令牌可能是不透明的（通常是不帶信息的長字符串）或JSON Web令牌（JWT）。</p><p>JWT的關鍵優勢是能夠包含聲明或有關用戶的信息，後端服務可以使用這些聲明來制定業務邏輯決策。</p><p><strong>學習OAuth舞蹈</strong></p><p>OAuth授權類型定義客戶端如何獲取令牌。我們的團隊通常將此稱為“OAuth舞蹈”。在OAuth世界中有很多種方式可以跳舞，但只有一種方法你必須學習：授權代碼。在某些情況下，其他授權類型可能很有用，但授權代碼授予類型是獲取所有類型應用程序的訪問令牌的推薦方法：Web應用程序，本機應用程序和移動應用程序。</p><p>特別是對於公共客戶端和移動應用程序，建議採取額外的安全措施來防止授權代碼被盜。該安全層在Proof Key for Code Exchange標準（PKCE，發音為“pixy”）中描述。您可以在此處瞭解有關PKCE以及如何使用它的更多信息。如果您是API提供商，請確保您的OAuth服務器支持此選項。</p><p>您應該特別注意資源所有者密碼授權：最簡單的實現，它非常有吸引力。但是，由於其核心要求是客戶端 - 服務器信任，因此您可能永遠不應該使用它。</p><p><strong>令牌管理建議</strong></p><p><strong>注意OAuth應用程序憑據洩漏</strong></p><p>在GitHub中存儲您的應用程序代碼？您的OAuth應用憑據是否也存儲在那裡，特別是客戶端密鑰？這是今天憑證洩密的<strong>頭號來源</strong>。如果這些憑據被盜，任何人都可以偽裝成你。如果您認為憑據可能已被洩露，請立即重新生成憑據。</p><p>此外，永遠不要將您的客戶端祕密放在分佈式代碼中，例如通過應用商店或客戶端JavaScript下載的應用。</p><p><strong>不要在應用程序中硬編碼令牌</strong></p><p>簡化代碼以獲取令牌很長一段時間並將其存儲在應用程序中可能很誘人。別。做。那。</p><p><strong>像對待密碼一樣對待代幣</strong></p><p>代幣是門鑰匙！令牌和API密鑰允許任何擁有它們的人訪問資源。因此，它們與密碼一樣重要。以同樣的方式對待他們！</p><p><strong>OAuth不是身份驗證協議</strong></p><p>OAuth是關於委派對資源的訪問權限。它不是身份驗證協議（儘管名稱）。將代幣視為酒店卡。您需要對自己進行身份驗證以獲取酒店鑰匙，但是一旦您擁有它，它絕不會證明您是誰。API提供商不得依賴令牌佔有作為身份證明，正如最近的用戶信息洩露所證明的那樣。</p><p>你真的應該看看OpenID Connect（OIDC），一個補充規範，而不是試圖在OAuth之上實現身份驗證。OIDC允許用戶與應用程序共享其配置文件的某些方面，而無需共享其憑據。</p><p><strong>謹防你在JWT中存儲什麼以及誰有權訪問它們</strong></p><p>JWT可以以聲明的形式存儲大量信息，並且如果被捕獲則可以輕鬆解析（除非它們被加密）。如果您使用JWT來傳輸僅對後端服務有用的信息，您可以採用不同的方法：JWT可以以聲明的形式存儲大量信息，並且如果被捕獲則可以輕鬆解析（除非它們被加密）。如果您使用JWT來傳輸僅對後端服務有用的信息，您可以採用不同的方法：</p><ul><li>在客戶端和後端之間使用不透明字符串或基本JWT。</li><li>在後端，驗證請求並注入一個新的JWT，其中包含一個包含下游消耗的聲明的有效負載。許多API安全網關都提供此功能。</li></ul><p>如果要在整個流中使用相同的令牌，並且它可能攜帶敏感信息，請加密令牌有效負載。這就是說，永遠不要使用JWT來攜帶用戶的憑據，比如密碼！</p><p><strong>徹底驗證JWT</strong></p><p>當您在服務器端收到JWT時，必須徹底驗證其內容。特別是，您應該拒絕任何不符合您預期的簽名算法或使用弱算法或弱非對稱/對稱密鑰進行簽名的JWT。此外，您必須驗證所有聲明，到期日期，發佈者和受眾。</p><p>某些庫和工具為您執行此操作; 其他人需要先正確配置; 有些人只做部分檢查。根據您使用的庫採取適當的措施。</p><p><strong>不要將令牌存儲在本地存儲中; 使用安全Cookie</strong></p><p>瀏覽器本地存儲和會話存儲可以從JavaScript讀取，因此對於存儲諸如令牌之類的敏感信息是不安全的。相反，使用安全cookie， httpOnly 標誌和CSRF措施來防止令牌被盜。</p><p><strong>始終通過HTTPS和請求正文傳輸令牌</strong></p><p>這樣做可以限制令牌在飛行中被捕獲或寫入代理日誌或服務器日誌的風險。您還應該確保只使用TLS 1.2 / 1.3以及涉及頒發和驗證令牌的所有參與者的最安全的密碼套件。</p><p><strong>使用專用瀏覽器視圖來請求同意信息</strong></p><p>許多應用程序使用嵌入式用戶代理，但應避免這種情況，因為它不允許用戶正確驗證他們正在與哪個站點進行通信。此外，該應用程序將完全可見用戶輸入的憑據。正如OAuth本機應用最佳做法標準所鼓勵的那樣，一些API提供商會採取強有力的措施來應對這種做法。</p><p><strong>結論</strong></p><p>訪問令牌是實現現代應用程序的基礎 - 但必須小心處理。作為後端開發人員，您必須確保提供適當的授權類型以獲取訪問令牌，支持移動應用程序的PKCE以及徹底驗證JWT。作為前端開發人員，您必須控制JWT的存儲並保護應用程序憑據。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>API</a></li><li><a>訪問</a></li><li><a>實踐</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/b6acbddb.html alt=「壓鑄實踐」大截面ZA27鋅合金蝸輪的雙重擠壓鑄造應用案例 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/972374c8b24644389e188cb290249f17 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b6acbddb.html title=「壓鑄實踐」大截面ZA27鋅合金蝸輪的雙重擠壓鑄造應用案例>「壓鑄實踐」大截面ZA27鋅合金蝸輪的雙重擠壓鑄造應用案例</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b096e432.html alt=餐飲業的共益實踐案例：是什麼留住了海底撈的員工？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3253c0fd3b54497282e5ebfb67cc350c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b096e432.html title=餐飲業的共益實踐案例：是什麼留住了海底撈的員工？>餐飲業的共益實踐案例：是什麼留住了海底撈的員工？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8ece3d8b.html alt=溼法鋅冶煉氟、氯現在走向及生產實踐 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/c6ec0692-63fe-42f8-8df3-b0a6226ca1a5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8ece3d8b.html title=溼法鋅冶煉氟、氯現在走向及生產實踐>溼法鋅冶煉氟、氯現在走向及生產實踐</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e46b4ccb.html alt=Npm程序漏洞曝光，允許黑客訪問用戶文件 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/07a4bc313620451d9ca8d505a893206f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e46b4ccb.html title=Npm程序漏洞曝光，允許黑客訪問用戶文件>Npm程序漏洞曝光，允許黑客訪問用戶文件</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/130bed32.html alt=「理論實踐」地方人大常委會研究室工作的實踐與思考 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/R9AiF6fHzZIbrG style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/130bed32.html title=「理論實踐」地方人大常委會研究室工作的實踐與思考>「理論實踐」地方人大常委會研究室工作的實踐與思考</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3998ae89.html alt=服務治理最佳實踐：如何依據參數值進行服務路由、鑑權、限流？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/3f6fb254f0cc4ba390695e1d561d4a5c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3998ae89.html title=服務治理最佳實踐：如何依據參數值進行服務路由、鑑權、限流？>服務治理最佳實踐：如何依據參數值進行服務路由、鑑權、限流？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8b2f4f92.html alt="Java - 日期時間API" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8b2f4f92.html title="Java - 日期時間API">Java - 日期時間API</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8654883c.html alt=項目實踐中的一些性能優化指南 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8c9ad977831f4b6bbaaf2e1b4651b667 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8654883c.html title=項目實踐中的一些性能優化指南>項目實踐中的一些性能優化指南</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f2b89270.html alt="繼Java API之後谷歌Map API被訴侵權" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/93cccb8ab813488f9355335120e11164 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f2b89270.html title="繼Java API之後谷歌Map API被訴侵權">繼Java API之後谷歌Map API被訴侵權</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/76de484d.html alt=訪問美國航空材料和鍛件生產公司記實及點滴感想 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ff4f21acbc444e9bbbaf237b2c7dab89 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/76de484d.html title=訪問美國航空材料和鍛件生產公司記實及點滴感想>訪問美國航空材料和鍛件生產公司記實及點滴感想</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/16e9e712.html alt=高併發之API接口，分佈式，防刷限流，如何做？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/72ef0f380abf4c6693d26afc863a1782 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/16e9e712.html title=高併發之API接口，分佈式，防刷限流，如何做？>高併發之API接口，分佈式，防刷限流，如何做？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/231d1667.html alt=數據倉庫實踐之如何設計可執行表命名規範 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/43bcbccdb0084c158129e23d3bce3b31 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/231d1667.html title=數據倉庫實踐之如何設計可執行表命名規範>數據倉庫實踐之如何設計可執行表命名規範</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c6860eb9.html alt=疫情期間做好職工思想政治工作的探索與實踐 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/SAiPd9B1uasVed style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c6860eb9.html title=疫情期間做好職工思想政治工作的探索與實踐>疫情期間做好職工思想政治工作的探索與實踐</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/80ae7e84.html alt=數據治理分析項目最佳實踐 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/67ed2ac0609b4877ae82c58a9507432d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/80ae7e84.html title=數據治理分析項目最佳實踐>數據治理分析項目最佳實踐</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d323acd6.html alt="一文搞定 REST Assured 實踐(二)：斷言實現" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2d017d59689b467b93d6e1a4bcb3a13c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d323acd6.html title="一文搞定 REST Assured 實踐(二)：斷言實現">一文搞定 REST Assured 實踐(二)：斷言實現</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>