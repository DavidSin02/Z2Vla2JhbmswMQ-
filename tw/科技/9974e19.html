<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>基於流水線技術的全數字鎖相環設計 | 极客快訊</title><meta property="og:title" content="基於流水線技術的全數字鎖相環設計 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/RNfrFzg7ak4FBq"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9974e19.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9974e19.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9974e19.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9974e19.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9974e19.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9974e19.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9974e19.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9974e19.html><meta property="article:published_time" content="2020-10-29T21:04:24+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:24+08:00"><meta name=Keywords content><meta name=description content="基於流水線技術的全數字鎖相環設計"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/9974e19.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>基於流水線技術的全數字鎖相環設計</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>鎖相環是一個能對輸入信號進行自動跟蹤的負反饋控制電路。鎖相環在通信、無線電電子學、自動控制和電力系統自動化等領域得到了極為廣泛的應用，其性能的好壞將直接影響整個電子系統的工作性能<sup>[1]</sup>。隨著數字技術的不斷髮展，全數字鎖相環的應用範圍也更加廣泛<sup>[2]</sup>。全數字鎖相環具有比模擬鎖相環更多的優點，它可以解決模擬鎖相環中設計複雜性較高、可移植性較差和對噪聲十分敏感等問題<sup>[3]</sup>。對於系統芯片而言，系統運行速度和功耗是衡量其性能優劣的重要指標之一，如何提高其運行速度和降低其功耗是國內外學者關注的熱點問題<sup>[4]</sup>。全數字鎖相環作為系統芯片中常用的功能模塊，這些問題也是我們在設計鎖相環時迫切需要解決的問題。另一方面，提高鎖相環的鎖相速度與增強鎖相環的穩定性是相互矛盾的。在鎖相環設計時，若數字濾波器的參數取較小值，可加快鎖相環的鎖相速度，縮短鎖相時間，但在系統鎖定後會出現相位抖動，影響系統的穩定性；而其參數取較大值時，雖可減小相位抖動，增強系統的穩定性，但卻又會造成鎖相速度變慢。由於傳統全數字鎖相環中數字濾波器的參數是固定不變的，不能實現參數的動態調節，因此，在鎖相環設計時只能取某一固定的折中值，這就不能從根本上解決同時提高鎖相環的動態性能與穩態性能之間所存在的矛盾，也就不能最大限度地提高鎖相系統的整體性能。</p><p>本文提出的基於技術的全數字鎖相環，一是能夠提高鎖相系統的運行速度，降低系統功耗；二是可實現數字濾波器參數的動態調節，從根本上解決提高鎖相速度與增強系統穩定性之間的矛盾。文中介紹了該鎖相環的系統結構、工作原理及主要模塊的設計方案。利用 Quartus II軟件工具對電路系統進行了仿真驗證，並根據仿真結果對電路參數的變化對鎖相系統的影響進行了分析<sup>[5]</sup>。</p><p><strong>1 流水線技術</strong></p><p><strong>1.1 流水線技術的工作原理</strong></p><p>流水線技術在速度優化中是常用的技術之一，它能顯著地提高設計電路的運行速度上限<sup>[6]</sup>。為了保障數據的快速傳輸，必須使系統運行在儘可能高的頻率上，但如果某些複雜邏輯功能的完成需要較長的延時，就會使系統很難運行在高的頻率上。在這種情況下，可使用流水線技術，即在長延時的邏輯功能塊中插入觸發器，使複雜的邏輯操作分步完成，減少每個部分的處理延時，從而使系統的運行頻率得以提高<sup>[7-8]</sup>。流水線設計的代價是增加了寄存器邏輯，即增加了芯片資源的耗用。具體工作原理如圖1所示。</p><img alt=基於流水線技術的全數字鎖相環設計 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RNfrFzg7ak4FBq><p>圖1(a)中的最高工作頻率為1/T<sub>a</sub>；在圖1(b)中，將圖1(a)中延時較大的組合邏輯電路分解為兩個延時較小的組合邏輯電路，並在該電路中插入一個寄存器，其中T<sub>a</sub>=T<sub>1</sub>+T<sub>2</sub>，T<sub>1</sub>≈T<sub>2</sub>。該電路中第一級由輸入寄存器、組合邏輯電路和插入的寄存器構成，其最高工作頻率約等於1/T<sub>1</sub>；第二級由後一個組合邏輯電路和寄存器構成，其最高工作頻率約等於1/T<sub>2</sub>。因此，該流水線電路結構的最高工作頻率約等於1/T<sub>1</sub>，與圖1(a)的電路結構相比較，其電路的整體運行速度得到顯著的提高。</p><p><strong>1.2 流水線技術的應用</strong></p><p>採用流水線技術可以優化計數器的電路，以24位計數器為例，該計數器的進位鏈很長，必然會降低工作頻率。若將其分割成3個8位的計數器，每當8位的計數器計到255後，可利用進位信號觸發下一個8位的計數器工作，這樣便可減少系統的工作延遲，從而達到提高系統信息處理速度的目的<sup>[9]</sup>。具體實現過程如圖2所示。</p><img alt=基於流水線技術的全數字鎖相環設計 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RNfrFzy6EFeBhX><p>其中圖2(a)為沒有采用流水線技術的24位的電路結構，圖2(b)為採用流水線技術設計的電路。從圖2(b)中可以看出，將24位的計數器分為三級流水線設計，每一級為一個8位計數器，其中第一級計數器的位數為0～7位，第二級計數器位數為8～15位，第三級計數器的位數為16～23位。每當低一級的8位計數器產生進位信號時，觸發高一級的8位計數器開始計數，以此類推進行累加計數。採用這種流水線計數器的電路結構，可提高計數器在進位鏈上的處理速度，進而提高整體電路的運行速度。</p><p><strong>2 鎖相環主要電路模塊的設計</strong></p><p>本文所提出的全數字鎖相環的系統框圖<sup>[10]</sup>如圖3所示，該鎖相環主要由數字鑑相器、自動變模電路、數字濾波器、加扣脈衝控制電路和N分頻器組成。其中數字鑑相器由雙D觸發器實現，其主要作用是通過比較輸入信號f<sub>in</sub>與輸出反饋信號F<sub>OUT</sub>之間的相位變化，產生相位誤差信號u<sub>e</sub>、超前信號u<sub>p</sub>和滯後信號u<sub>d</sub>。數字濾波器主要由可逆計數器構成，它可根據超前信號或滯後信號進行加計數或減計數，當計數值達到計數器的模值時，產生進位信號inc或借位信號dec，其中可逆計數器的模值km（即該濾波器的參數）由自動變模電路提供，該信號可根據誤差信號u<sub>e</sub>的大小自動產生。加扣脈衝控制電路和N分頻器構成了數字振盪器，當inc信號為高電平時，在數字序列信號IDout中插入一個脈衝；當dec信號為高電平時，在IDout中扣除一個脈衝，再經過N分頻器得到調節後的輸出信號F<sub>OUT</sub>。將該輸出信號反饋到數字鑑相器，通過鎖相系統對相位誤差的反覆調節，最終達到相位的鎖定。</p><img alt=基於流水線技術的全數字鎖相環設計 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RNfrG0AEz5Ukvz><p><strong>2.1 流水線自動變模電路設計</strong></p><p>數字濾波器的動態參數主要由自動變模電路提供，其中自動變模電路主要是由一個時間數字轉換模塊(TDC)和變模控制器構成，其主要作用是根據數字鑑相器輸出的相位誤差的大小來改變數字濾波器中可逆計數器的模值km。當相位誤差較大時，輸出較小的模值，以便加快鎖相速度；而當相位誤差較小時，輸出較大的模值，以減小環路鎖定後的相位抖動。</p><p>根據本文提出的流水線計數器的設計理念，對TDC模塊中的20位計數器採用5級流水線設計，其中第一級計數器的位數為0～3位，第二級計數器位數為4～7位，第三級計數器的位數為8～11位，第四級計數器的位數為12～15位，第五級計數器位數為16～19位。採用超高速集成電路硬件描述語言(VHDL)對流水線電路結構的TDC模塊進行設計，該模塊的RTL級電路圖如圖4所示。</p><img alt=基於流水線技術的全數字鎖相環設計 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RNfrG0X6stfokT><p>在採用VHDL完成變模控制器的設計之後，再將兩個模塊連接起來，便可得到流水線自動變模的電路如圖5所示。其輸入信號ue為相位誤差信號，輸出信號km是提供給數字濾波器中可逆計數器的可變模值。</p><img alt=基於流水線技術的全數字鎖相環設計 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RNfrG3uHzLfpGx><p><strong>2.2 流水線數字濾波器設計</strong></p><p>數字濾波器主要由8位可逆計數器構成，對該可逆計數器採用2級流水線設計，第一級計數器的位數為0～3位，第二級計數器為位數為4～7位。採用 VHDL對流水線電路結構的數字濾波器進行設計，該模塊的RTL級電路如圖6所示。其輸入信號km為計數器的模值，輸出信號dec和inc信號分別為加扣脈衝控制電路的控制信號。</p><img alt=基於流水線技術的全數字鎖相環設計 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RNfrGGYHxdb9Iw><p>數字濾波器的仿真波形如圖7所示，從圖中可以看出當km的值分別取2，4，8，32時，相應dec和inc信號出現的頻率是不同的。這說明該數字濾波器能夠根據模值km的大小，自動調節其輸出控制信號的頻率，進而可實現對鎖相環工作過程的動態調節。</p><img alt=基於流水線技術的全數字鎖相環設計 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RNfrGGoCD2hSJ8><p><strong>2.3 流水線分頻器設計</strong></p><p>該分頻器是由24位計數器構成，其分頻係數可調。對該計數器採用3級流水線設計，其中第一級計數器的位數為0～7位，第二級計數器位數為8～15位，第三級計數器的位數為16～23位。同樣，採用 VHDL對流水線電路結構的分頻器進行設計，該模塊的RTL級電路圖如圖8所示。</p><img alt=基於流水線技術的全數字鎖相環設計 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RNfrGH12eB9fKe><p><strong>3 鎖相系統的整體設計與仿真</strong></p><p>該鎖相系統的整體設計採用自頂而下的設計方法，首先，用VHDL語言對各模塊進行編程設計，在完成各模塊的設計之後，再按照系統設計方案將各模塊連接起來構成系統頂層電路，該系統電路如圖9所示。其中jianxq為數字鑑相器，zdjc為自動變模電路，bknjs8為數字濾波器，ID為加減脈衝控制電路，divN8為N分頻器。Clk為時鐘信號，fin為輸入信號，km為可逆計數器的模值。</p><img alt=基於流水線技術的全數字鎖相環設計 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RNfrGHEF8F6wK4><p>系統時鐘頻率取200 MHz，輸入頻率為50 MHz時，對頂層電路進行系統仿真，其結果如圖10所示。</p><img alt=基於流水線技術的全數字鎖相環設計 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/RNfrGHT9UvgAdf><p>取同一系統時鐘頻率，當輸入頻率由50 MHz跳變為25 MHz時，其仿真波形如圖11所示。</p><img alt=基於流水線技術的全數字鎖相環設計 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RNfrGQsGT7hdtn><p>從圖10可以看出，在相位調節區間，鎖相環中可逆計數器的模值km 隨著相位誤差的不同而變化，這樣可以加快其鎖定速度；在相位鎖定區間，則會自動選擇本系統所設置的最大模值km，故可大大減小環路輸出信號相位的抖動，提高了系統的穩定性。從圖11可以看出當輸入頻率發生跳變時，鎖相環能夠在輸入信號頻率發生跳變後的第一個週期內快速鎖定信號的頻率，並迅速對相位誤差進行調整，大約經過2.5 μs便可鎖定，且鎖定後同樣自動選擇最大的km值。由此可以看出該鎖相環能夠根據其不同的工作過程對系統參數進行動態調節，從根本上解決了提高鎖定速度與穩定性之間的矛盾，提高了鎖相系統的整體性能。</p><p>取系統時鐘頻率為200 MHz，輸入信號頻率為50 MHz時，分別對傳統鎖相環和流水線鎖相環進行了系統仿真，並對仿真結果進行時序分析和功耗分析。具體結果分析如表1所示。</p><p>從以上表格可以看出，首先，與傳統的鎖相環相比，流水線電路結構鎖相環的系統延時減少了1.278 ns。其次，時鐘頻率為200 MHz時，其系統的總功耗比傳統的鎖相環減少了630 μW。由此可見，具有流水線電路結構的全數字鎖相環可以減少系統延時，提高系統的工作速度，並可減少系統的總功耗。</p><p><strong>4 結論</strong></p><p>本文所提出的全數字鎖相環採用流水線技術優化了系統的電路結構，減少了系統延遲，提高了系統的運行速度，降低了系統的總功耗。由於數字濾波器的參數可以動態調整，故既能提高鎖相速度，又可增強系統的穩定性，從而很好地解決了兩者之間所存在的矛盾。</p><p><strong>參考文獻</strong></p><p>[1] Guo Xiaoqiang，Wu Weiyang，Chen Zhe.Multiple complex-coefficient-filter based phase-locked loop and synchronization technique for three-phase grid-interfaced converters in distributed utility networks[J].IEEE Transactions on Industrial Electronics，2011，58(4)：1194-1204.</p><p>[2] 彭詠龍，路智斌，李亞斌.基於FPGA的改進型全數字鎖相環的設計[J].電源技術，2015，39(2)：410-412.</p><p>[3] STASZEWSKI R B，MUHAMMAD K，LEIPOLD D，et al.All-digital TX frequency synthesizer and discrete time receiver for Bluetooth radio in 130-n/n CMOS[J].IEEE Journal of Solid-State Circuits，2004，39(12)：2278-2291.</p><p>[4] 單長虹，陳忠澤，單健.基於雙邊沿觸發計數器的低功耗全數字鎖相環的設計[J].電路與系統學報，2005，10(2)：142-145.</p><p>[5] 黃保瑞，楊世平.基於FPGA的全數字鎖相環設計[J].電子測試，2014(8X)：33-34.</p><p>[6] 潘鬆，黃繼業.EDA技術實用教程VHDL版(第5版)[M].北京：科技出版社，2013.</p><p>[7] 崔秀敏.基於FPGA的流水線技術設計與實現[J].Science & Technology Information，2010(7)：76-77.</p><p>[8] 何永泰，董剛，黃文卿.流水線技術在FPGA設計中的實現[J].天津工業大學學報，2006，25(4)：84-86.</p><p>[9] Xu Liangge，LINDFORS S.A high-speed variable phase accumulator for an ADPLL architecture[J].2008 IEEE International Symposium on Circuits and Systems，2008.</p><p>[10] 單長虹，鄧國揚.一種新型快速全數字鎖相環的研究[J].系統仿真學報，2003，15(4)：581-583.</p><p><strong>作者信息:</strong></p><p>田 帆，楊檬瑋，單長虹</p><p>（南華大學 電氣工程學院，湖南 衡陽421001）</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>線技術</a></li><li><a>全數</a></li><li><a>字鎖</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/4a48ddee.html alt=介紹一款基於STM32高性能全數字式正弦波逆變電源的設計方案 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/153430263281697d780903a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4a48ddee.html title=介紹一款基於STM32高性能全數字式正弦波逆變電源的設計方案>介紹一款基於STM32高性能全數字式正弦波逆變電源的設計方案</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/dd1e38fb.html alt=K線技術-重要的（T線）阻力線跟支撐線 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/fdbb0ac2d2394518ad2c55a4801e9524 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/dd1e38fb.html title=K線技術-重要的（T線）阻力線跟支撐線>K線技術-重要的（T線）阻力線跟支撐線</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e34ad2e3.html alt=一塊屏的革命：全數字化黑板的到來 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RioSaR71nhJZT4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e34ad2e3.html title=一塊屏的革命：全數字化黑板的到來>一塊屏的革命：全數字化黑板的到來</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/97ed6ab1.html alt=全數字式核反應有3個大優勢，美剛批准建設、你想象不到我國水平 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/61617da66a7241e398e455d5c85c0ca1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/97ed6ab1.html title=全數字式核反應有3個大優勢，美剛批准建設、你想象不到我國水平>全數字式核反應有3個大優勢，美剛批准建設、你想象不到我國水平</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e565984.html alt=全數字可視對講系統通用設計方案 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/34c2f6c358a34e84a73d403afb02555d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e565984.html title=全數字可視對講系統通用設計方案>全數字可視對講系統通用設計方案</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/41b24cd.html alt=數字化焊接？高精度全數字脈衝焊機！焊工的翻身之戰 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b0378b12498b44be91585d5790f48ea7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/41b24cd.html title=數字化焊接？高精度全數字脈衝焊機！焊工的翻身之戰>數字化焊接？高精度全數字脈衝焊機！焊工的翻身之戰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d2c6dba.html alt=高精度全數字脈衝焊機 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/c954e1ea181447b5bf26a5d243a77466 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d2c6dba.html title=高精度全數字脈衝焊機>高精度全數字脈衝焊機</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>