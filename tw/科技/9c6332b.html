<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>一個真實問題，搞定三個冷門pandas函數 | 极客快訊</title><meta property="og:title" content="一個真實問題，搞定三個冷門pandas函數 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/b21422d9f27e4fe3962d0ca036e65494"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9c6332b.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9c6332b.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9c6332b.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9c6332b.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9c6332b.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9c6332b.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9c6332b.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9c6332b.html><meta property="article:published_time" content="2020-10-29T20:58:30+08:00"><meta property="article:modified_time" content="2020-10-29T20:58:30+08:00"><meta name=Keywords content><meta name=description content="一個真實問題，搞定三個冷門pandas函數"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/9c6332b.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>一個真實問題，搞定三個冷門pandas函數</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div class=pgc-img><img alt=一個真實問題，搞定三個冷門pandas函數 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b21422d9f27e4fe3962d0ca036e65494><p class=pgc-img-caption></p></div><p>作者：劉早起</p><p>來源：早起Python</p><p>最近有一個粉絲問過我一個問題，覺得挺有意思，分享給大家。經過簡化後大概就是有一個長這樣的時間序列數據</p><div class=pgc-img><img alt=一個真實問題，搞定三個冷門pandas函數 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8ed218a7eb5d45a1ac84f36b065f497e><p class=pgc-img-caption></p></div><p>可以看到，一共有15行數據，其中有一些行的<span style="color:#ff6441;--tt-darkmode-color: #FF6441">value</span>是空值， 現在想在<strong>不改變原數據的情況下</strong>取出<strong>從第一個不是空值的行之後的全部數據</strong></p><div class=pgc-img><img alt=一個真實問題，搞定三個冷門pandas函數 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5e28934a5a354130bedc5cd537029a58><p class=pgc-img-caption></p></div><p>嗯，看上去不是很難，但如果添加一個額外要求:<strong>「使用純pandas函數完成」</strong> 這就涉及到了一些不常用的函數，一起來看看。</p><p>首先需要構造這樣的數據，在Python中我們可以先按照規則生成字符串，然後使用<span style="color:#ff6441;--tt-darkmode-color: #FF6441">time</span>或<span style="color:#ff6441;--tt-darkmode-color: #FF6441">datatime</span>模塊進行轉換，方法很多，但是<strong>pandas中如何直接生成呢？這就涉及到第一個函數</strong><span style="color:#ff6441;--tt-darkmode-color: #FF6441">date_range</span>。</p><p><strong><span style="color:#f96e57;--tt-darkmode-color: #F96E57">pd.date_range</span></strong></p><p>其實在pandas中生成時間序列數據比其他方法要方便很多，使用<span style="color:#ff6441;--tt-darkmode-color: #FF6441">.date_range</span><strong>一行代碼</strong>即可，該函數使用方法為</p><pre><code>pandas.date_range(start=None, end=None, periods=None, freq=None,                   tz=None, normalize=False, name=None, closed=None, **kwargs)</code></pre><p>可以通過<strong>起止日期</strong>來生成</p><div class=pgc-img><img alt=一個真實問題，搞定三個冷門pandas函數 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fa554d55eddf4ae8afa6e39502765b18><p class=pgc-img-caption></p></div><p>也可以通過<strong>開始日期與長度</strong>生成</p><div class=pgc-img><img alt=一個真實問題，搞定三個冷門pandas函數 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/bf589adbde9d4130a4c90f277eec09da><p class=pgc-img-caption></p></div><p>上面的默認間隔是1天，當然是可以自定義，比如修改為5天</p><div class=pgc-img><img alt=一個真實問題，搞定三個冷門pandas函數 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0248b9b2ada944de8f3d043fc0b1418a><p class=pgc-img-caption></p></div><p>該方法還<strong>支持生成更多的指定形式的時間序列數據</strong>，感興趣的讀者可以自行查閱官方文檔，現在我們就可以生成示例數據</p><pre><code>df = pd.DataFrame(    {   'date': [i for i in pd.date_range('20200701','20200715')],        'value': ['','','','','',1,6,1,2,'',2,1,6,0,1]}) </code></pre><div class=pgc-img><img alt=一個真實問題，搞定三個冷門pandas函數 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8ed218a7eb5d45a1ac84f36b065f497e><p class=pgc-img-caption></p></div><p>接下來我的思路是</p><ul><li>判斷value列的每個值是否為空值，返回<span style="color:#ff6441;--tt-darkmode-color: #FF6441">Ture/False</span></li><li><strong>找到第一個為False的索引</strong>，取後面全部的數據</li></ul><p>為了只用pandas實現這個思路，用到了兩個不常見的函數，讓我們慢慢說。</p><p><strong><span style="color:#f96e57;--tt-darkmode-color: #F96E57">pandas.Series.ne</span></strong></p><p>ne函數<strong>可以比較兩個Series</strong>，常用於缺失值填充，下面是一個例子</p><div class=pgc-img><img alt=一個真實問題，搞定三個冷門pandas函數 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/190ccd8b778e477eb633fbcb805d9647><p class=pgc-img-caption></p></div><p>除了可以比較兩個Series之外，對於我們的問題，它可以比較元素：<strong>返回True如果這個值不是你指定的值</strong>，聽上去很繞，我們看代碼</p><div class=pgc-img><img alt=一個真實問題，搞定三個冷門pandas函數 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/7b07d53b089e4009bac2f32ab0d73d91><p class=pgc-img-caption></p></div><p>可以看到，所有空值都被標記為False，接下來要做的就是<strong>找到第一個True元素的索引，並取出之後的全部數據。</strong></p><p><strong><span style="color:#f96e57;--tt-darkmode-color: #F96E57">pandas.DataFrame.idxmax</span></strong></p><p>如何在pandas中<strong>直接定位一組數據中最大/最小值的位置</strong>？可以使用<span style="color:#ff6441;--tt-darkmode-color: #FF6441">idxmax/idxmin</span>，這個函數不難，直接看一個簡單的例子</p><div class=pgc-img><img alt=一個真實問題，搞定三個冷門pandas函數 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/55afe2098ad142c69f8cc8258c7ac57f><p class=pgc-img-caption></p></div><p>它可以<strong>返回最大值/最小值第一次出現的位置索引</strong>！剛好可以滿足我們的要求，現在就可以將<span style="color:#ff6441;--tt-darkmode-color: #FF6441">idxmax</span>與之前的<span style="color:#ff6441;--tt-darkmode-color: #FF6441">ne</span>函數結合起來實現我們需求</p><pre><code>df['value'].ne('').idxmax()# 5</code></pre><p>返回的索引值是5，最後就可以使用<span style="color:#ff6441;--tt-darkmode-color: #FF6441">loc</span>函數<strong>一行代碼實現我們的需求</strong></p><div class=pgc-img><img alt=一個真實問題，搞定三個冷門pandas函數 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/863133247c324b919ae93936b1cae1c7><p class=pgc-img-caption></p></div><p>其實這個問題<strong>還有很多其他的辦法</strong>，比如可以先篩選出所有True的索引，然後使用<span style="color:#ff6441;--tt-darkmode-color: #FF6441">.first_valid_index()</span>找到第一個True，最後也可以不用loc直接<span style="color:#ff6441;--tt-darkmode-color: #FF6441">df[df['value'].ne('')]</span>實現。</p><p>但我還希望你能掌握上面三個函數並靈活運用，如果有更好的思路可以在評論區留言。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>一個</a></li><li><a>真實</a></li><li><a>問題</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/403126d1.html alt=告訴你一個真實的紐大 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RXc8TqD4aRr2nA style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/403126d1.html title=告訴你一個真實的紐大>告訴你一個真實的紐大</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ae248594.html alt="給你一個真實的月亮 中國探月工程數據庫公開 荒涼冷寂暗藏壯美" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3ec9fcd065584428822eb7ec537da25a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ae248594.html title="給你一個真實的月亮 中國探月工程數據庫公開 荒涼冷寂暗藏壯美">給你一個真實的月亮 中國探月工程數據庫公開 荒涼冷寂暗藏壯美</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/1c7e9ad1.html alt=告訴你一個全面而真實的加拿大，系列之八，英屬哥倫比亞省 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/aa93e67c-75d2-42aa-9b1c-11761cc713aa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/1c7e9ad1.html title=告訴你一個全面而真實的加拿大，系列之八，英屬哥倫比亞省>告訴你一個全面而真實的加拿大，系列之八，英屬哥倫比亞省</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a6f8a7d2.html alt=“一個65歲女人再婚後的真實私生活” class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/07a8a80c973e44e48e521a7eeee227bd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a6f8a7d2.html title=“一個65歲女人再婚後的真實私生活”>“一個65歲女人再婚後的真實私生活”</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8e40ddee.html alt=一個二婚女的真實私生活！（漫畫） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/3dd49a4701be48a0aef303aaf0e785d8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8e40ddee.html title=一個二婚女的真實私生活！（漫畫）>一個二婚女的真實私生活！（漫畫）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6eb8bbfb.html alt=一個問題引發的統計學派之爭 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RG2r5FA2oJUVhk style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6eb8bbfb.html title=一個問題引發的統計學派之爭>一個問題引發的統計學派之爭</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/33cf3d0.html alt=一個真實故事告訴你，將就結婚的下場，夠你噁心一輩子的了 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/abe54e15b6c24cc6800a33d0c03311cb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/33cf3d0.html title=一個真實故事告訴你，將就結婚的下場，夠你噁心一輩子的了>一個真實故事告訴你，將就結婚的下場，夠你噁心一輩子的了</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/fa53d2c.html alt=圓錐曲線中斜率之和為零問題的一個變式題 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/bf11e094f3e54d5389c6683b8edc2d0c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/fa53d2c.html title=圓錐曲線中斜率之和為零問題的一個變式題>圓錐曲線中斜率之和為零問題的一個變式題</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/f10e3aa.html alt=重返「二·二八」到「江南案」，凝視一個真實的臺灣 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1abd6d36a5c2462990d50a1d98f5c601 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/f10e3aa.html title=重返「二·二八」到「江南案」，凝視一個真實的臺灣>重返「二·二八」到「江南案」，凝視一個真實的臺灣</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8a0c240.html alt=戰“疫”，我看到一個真實的迭部 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/c0f63a5efaf544a2acf7576fbca80794 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8a0c240.html title=戰“疫”，我看到一個真實的迭部>戰“疫”，我看到一個真實的迭部</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/56e83d3.html alt=解密“平行時空”是否真實存在著另一個自己 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p3.pstatp.com/large/pgc-image/e4211f593f0147a090ba384182283607 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/56e83d3.html title=解密“平行時空”是否真實存在著另一個自己>解密“平行時空”是否真實存在著另一個自己</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/23ddeb1.html alt=一個窗口解決所有問題！這種醫保經辦模式是怎麼做到的？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p3.pstatp.com/large/pgc-image/RertsevFJsMM8W style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/23ddeb1.html title=一個窗口解決所有問題！這種醫保經辦模式是怎麼做到的？>一個窗口解決所有問題！這種醫保經辦模式是怎麼做到的？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ac25d2d0.html alt=30分鐘教你搭建一個網站（一）：購買和配置服務器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/5f26f1582a564e93bde33a7dd9448c3b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ac25d2d0.html title=30分鐘教你搭建一個網站（一）：購買和配置服務器>30分鐘教你搭建一個網站（一）：購買和配置服務器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d8be5e94.html alt=不會買服務器？一個辦法讓你輕鬆搭網站 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/84d9c54578de46058796824f1bcb6a9b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d8be5e94.html title=不會買服務器？一個辦法讓你輕鬆搭網站>不會買服務器？一個辦法讓你輕鬆搭網站</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c811c5f7.html alt=使用服務器搭建一個網站 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/63a6cc0eb4d146e0890515500c0040ca style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c811c5f7.html title=使用服務器搭建一個網站>使用服務器搭建一個網站</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>