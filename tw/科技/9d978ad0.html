<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>自動化辦公第一期-自動獲取工作表名稱 | 极客快訊</title><meta property="og:title" content="自動化辦公第一期-自動獲取工作表名稱 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/c70070d16ecc4cdc955692e61fd053ec"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9d978ad0.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9d978ad0.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9d978ad0.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9d978ad0.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9d978ad0.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9d978ad0.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9d978ad0.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9d978ad0.html><meta property="article:published_time" content="2020-11-14T21:04:12+08:00"><meta property="article:modified_time" content="2020-11-14T21:04:12+08:00"><meta name=Keywords content><meta name=description content="自動化辦公第一期-自動獲取工作表名稱"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/9d978ad0.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>自動化辦公第一期-自動獲取工作表名稱</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><br></p><p>今天我們開一個小的系列，自動化辦公，提供一下可以自動化處理的方法和技巧</p><p>第一期，我們分享<strong>自動獲取工作表名稱</strong></p><p><br></p><p>獲取表名的方式有很多，比如技巧法、函數法、宏表函數法、VBA、PQ等</p><p><br></p><p>我們本期介紹的是：<strong>宏表函數法</strong></p><p><br></p><p>需要說明的是宏表函數屬於excel4中遺留下來的方式，無法直接在工作表中使用，需要通過自定義名稱 或者在VBA中使用</p><p><br></p><p>以下是最最最詳細的製作教程及原理解析：</p><p><br></p><h1 class=pgc-h-arrow-right>1、定義名稱<br></h1><p>這裡我們通過<strong>GET.WORKBOOK(1）</strong>來獲取全部名稱，具體我們看下圖</p><p><br></p><div class=pgc-img><img alt=自動化辦公第一期-自動獲取工作表名稱 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c70070d16ecc4cdc955692e61fd053ec><p class=pgc-img-caption></p></div><p><br></p><h1 class=pgc-h-arrow-right>2、使用定義名稱<br></h1><p>定義好的名稱，我們可以直接在工作表輸入<strong>=定義的名稱</strong>使用</p><p>具體如下：</p><div class=pgc-img><img alt=自動化辦公第一期-自動獲取工作表名稱 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/014e61d88b3e48479edb41ec30b88a3a><p class=pgc-img-caption></p></div><p><br></p><h1 class=pgc-h-arrow-right>3、獲取全部工作表名稱<br></h1><p><br></p><p>上一步我們看到只有一個名稱 而且格式是[文件名]表名</p><p>但是其實裡面存放了所有的表名，只是一個單元格只呈現出一個</p><p>具體我們只要，點擊進入公司尾部，按下<strong>F9</strong>即可查看全部結果</p><p><br></p><p>我們通過動畫來給大家演示具體的過程和效果：</p><p><br></p><div class=pgc-img><img alt=自動化辦公第一期-自動獲取工作表名稱 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ffa57ece60ed4d99bdef8de4ac0e16a1><p class=pgc-img-caption></p></div><p><br></p><h1 class=pgc-h-arrow-right>4、清理提取表名<br></h1><p>第三步中我們知道，其實表名都在其中，那麼我就要想辦法提取</p><p>首先要考慮去掉文件名，保留下表名，然後再逐個提取</p><p><br></p><p>去掉文件可以使用替換函數處理-Replace</p><p>具體公式：<strong>=REPLACE(全部表名,1,FIND("]",全部表名),"")</strong></p><p><br></p><div class=pgc-img><img alt=自動化辦公第一期-自動獲取工作表名稱 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/86b5d6d2c6e84195bfb11ffe86defee1><p class=pgc-img-caption></p></div><p><br></p><p>這裡有兩個函數一個是FIND用於查詢"]"的位置，然後通過REPLACE替換</p><p><br></p><p>為了幫助大家更好的理解，我們這裡再詳細說一下涉及的函數</p><p><br></p><p><strong>FIND函數:</strong></p><p>語法：FIND(查什麼,待查的字符)</p><p>結果：如果找到返回對應的位置，否則報錯</p><p><br></p><p>案例演示：</p><div class=pgc-img><img alt=自動化辦公第一期-自動獲取工作表名稱 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0a54b462cbd746ccbb408f6ef5420d57><p class=pgc-img-caption></p></div><p><br></p><p><strong>REPLACE函數：</strong></p><p>語法：REPLACE(待處理字符串,開始位置,字符長度,替換字符）</p><p>結果：替換後的結果</p><p><br></p><p>案例：相對於去掉開始兩個字符串，替換成了空內容</p><p><br></p><div class=pgc-img><img alt=自動化辦公第一期-自動獲取工作表名稱 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/5bac36b269864a8698c98ebe4bd6e6b8><p class=pgc-img-caption></p></div><p><br></p><p>這樣我們應該就理解了上方的公式了！</p><p><br></p><h1 class=pgc-h-arrow-right>5、依次寫入工作表<br></h1><p>在上一步中，我們已經把文件名去掉，剩下的就是一組表名，通過F9，我們知道都在單元格中，但是如何提取呢？這裡我們就要請出INDEX函數</p><p><br></p><p>公式：<strong>=INDEX(REPLACE(全部表名,1,FIND("]",全部表名),""),ROW(A1))</strong></p><p><br></p><p>這裡我們只解析這裡的INDEX語法，實際用法還有很多種</p><p><br></p><p><strong>INDEX函數：</strong></p><p>語法：INDEX(數組,第幾個）</p><p>結果：按照第二參數取出</p><p><br></p><p>ROW的部分是生成對應的單元格行號，比如ROW(A2）=2</p><p>我們只需要關注行即可，列不影響</p><p><br></p><div class=pgc-img><img alt=自動化辦公第一期-自動獲取工作表名稱 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fdfe1045193840e3863a824acff1f918><p class=pgc-img-caption></p></div><p><br></p><p>我們發現，下面多處的部分就會報錯，此時，我們只要使用IFERROR函數來屏蔽錯誤即可</p><p><br></p><p><strong>IFERROR函數：</strong></p><p>語法：IFERROR(原公式,出錯後顯示的內容）</p><p>結果：容錯後的結果</p><p>這裡我們希望出錯後什麼都不顯示，此時一般我們使用一對雙引號</p><p><br></p><p>公式：<strong>=IFERROR(INDEX(REPLACE(全部表名,1,FIND("]",全部表名),""),ROW(A1)),"")</strong></p><p><br></p><p>公式效果如下：</p><div class=pgc-img><img alt=自動化辦公第一期-自動獲取工作表名稱 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2494defd5414488bab029aaa9a0113fa><p class=pgc-img-caption></p></div><p><br></p><p>通過上面5步，我們應可以獲取到全部表名，但是有一個問題，就是以上的方式是否可以實現新增的自動獲取和修改後自動更新兩點，如果不能，那麼談不上自動化。</p><p><br></p><p>如果你去試了，會發現確實不行，因為我們還有最後一步沒有完成</p><p><br></p><p>那就是第六步</p><p><br></p><h1 class=pgc-h-arrow-right>6、自動更新<br></h1><p>自動更新我們利用兩個函數來實現，第一個是<strong>NOW</strong>，第二個是<strong>T函數</strong></p><p>NOW函數：可以返回電腦上的日期時間，精確到秒，基本可以說是實時刷新更新，最核心的是他們是易失性函數，這個大家可能陌生的概念，可以簡單理解為 過一段時間或重新打開表格會自動重新計算的函數，這裡重點是過一段時間就會刷新，這完美配合了NOW的實時更新！</p><p><br></p><p><strong>T函數</strong>：你可能認為他一個字母而已，但是他確認是一個函數，他的功能就是</p><p>T(內容）-如果內容是文本就返回內容，否則<strong>返回空</strong></p><p><br></p><p>介紹完二者，那麼我們如果你用他們來實現自動更新呢？</p><p>NOW結果是時間，不是文本那麼T(NOW()) 就會範圍空，如果我們在一個公式的最後 &T(NOW())，就可以實現在不改變函數功能的情況下，實現實時更新。</p><p><br></p><p>如上分析後，我們的第一步公式更新一下如下：</p><p>公式：<strong>=GET.WORKBOOK(1)&T(NOW())</strong></p><p><br></p><div class=pgc-img><img alt=自動化辦公第一期-自動獲取工作表名稱 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e0cb59abe7d14dd8ad0eefcbc00fc444><p class=pgc-img-caption></p></div><p><br></p><p>我們採用這種方式，也是希望加深大家的印象，希望大家都能學會！</p><p><br></p><p>最後我們通過一個動畫，看看他們的效果吧！</p><p><strong>增、刪、改，都可以實時更新表名！</strong></p><p><br></p><div class=pgc-img><img alt=自動化辦公第一期-自動獲取工作表名稱 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b923b25749ee43d481ec2d604837896d><p class=pgc-img-caption></p></div><p><br></p><p>在文章的最後，我們要補充的就是保存文件的問題，很多好奇這有什麼好說的，但是大家嘗試就知道，不能保存為xlsx格式，因為他是宏表函數，我們需要保存為<strong>xls</strong>或者<strong>xlsm</strong>，含有宏的文件格式</p><p><br></p><div class=pgc-img><img alt=自動化辦公第一期-自動獲取工作表名稱 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5336a791c99a40f0948129dd971f5d90><p class=pgc-img-caption></p></div><p><br></p><p>OK，今天的超詳細的自動化教程第一期就到這裡</p><p>有好的方法或者意見歡迎留言交流，有想學習的知識點也歡迎留言，小編會</p><p>安排，安排！！</p><p class=pgc-end-literature>Excel辦公實戰，高效辦公，每天進步一點點！</p><p class=pgc-end-literature>關注小編，下次精彩不迷路！</p><p class=pgc-end-literature>喜歡小編的文章，一定要點贊，關注，轉發</p><p class=pgc-end-literature>您的鼓勵是小編最大的動力！</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>自動化</a></li><li><a>辦公</a></li><li><a>自動</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/1bd90ef4.html alt=自動化智能化，自動化生產線有哪些組成部分---徠深科技 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/9eb763e6d45644e7a528cb7fbde85e31 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1bd90ef4.html title=自動化智能化，自動化生產線有哪些組成部分---徠深科技>自動化智能化，自動化生產線有哪些組成部分---徠深科技</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/eb41e5b.html alt=python自動化辦公：玩轉word之頁眉頁腳祕笈 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/fc19d46c-ce11-44c6-bff3-ad95969a640b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/eb41e5b.html title=python自動化辦公：玩轉word之頁眉頁腳祕笈>python自動化辦公：玩轉word之頁眉頁腳祕笈</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a50263f.html alt=「由力自動化」自動焊錫機 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/bb47687030e1401f9b6d81a434540afa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a50263f.html title=「由力自動化」自動焊錫機>「由力自動化」自動焊錫機</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/200cc00.html alt=「由力自動化」自動焊錫機的優點 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1922b2dbb1e24db89edd42ccf3752a0a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/200cc00.html title=「由力自動化」自動焊錫機的優點>「由力自動化」自動焊錫機的優點</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/55a049d.html alt=WPS表格辦公—自動顯示分頁符的方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/10bd6289dec34cb8953590f5b71d8511 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/55a049d.html title=WPS表格辦公—自動顯示分頁符的方法>WPS表格辦公—自動顯示分頁符的方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/df6ab1c.html alt=瑞德鑫自動化：如何定位自動擰螺絲機的螺絲孔 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1524537907329792bc7bef1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/df6ab1c.html title=瑞德鑫自動化：如何定位自動擰螺絲機的螺絲孔>瑞德鑫自動化：如何定位自動擰螺絲機的螺絲孔</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/543d61c.html alt=Python自動化辦公——這裡有你不知道的Python批量處理小技巧 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/07750aec-3b5a-4984-8fcb-ff0c813cfb40 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/543d61c.html title=Python自動化辦公——這裡有你不知道的Python批量處理小技巧>Python自動化辦公——這裡有你不知道的Python批量處理小技巧</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/31adec60.html alt=方大九鋼檢測部推出生石灰自動取樣器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/31adec60.html title=方大九鋼檢測部推出生石灰自動取樣器>方大九鋼檢測部推出生石灰自動取樣器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/74f03106.html alt=方大九鋼：給石灰粉自動取樣器腔體洗“鹽酸浴”效果好 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/74f03106.html title=方大九鋼：給石灰粉自動取樣器腔體洗“鹽酸浴”效果好>方大九鋼：給石灰粉自動取樣器腔體洗“鹽酸浴”效果好</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a73cf80a.html alt="自動化彈性伸縮如何支持百萬級核心錯峰混部 | 架構沙龍回顧" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/61d58d713ab649708f7796af3bc5f21b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a73cf80a.html title="自動化彈性伸縮如何支持百萬級核心錯峰混部 | 架構沙龍回顧">自動化彈性伸縮如何支持百萬級核心錯峰混部 | 架構沙龍回顧</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/06708c4c.html alt=excel小技巧：自動求和，當新增數據時自動求和 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1523970520159b755ba89ba style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/06708c4c.html title=excel小技巧：自動求和，當新增數據時自動求和>excel小技巧：自動求和，當新增數據時自動求和</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/80306d69.html alt=Excel辦公技巧：製作面積圖時不同系列發生重疊或交叉怎麼辦？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8003f9a2d7d74213ae5aeb82c16c4f91 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/80306d69.html title=Excel辦公技巧：製作面積圖時不同系列發生重疊或交叉怎麼辦？>Excel辦公技巧：製作面積圖時不同系列發生重疊或交叉怎麼辦？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e6372c2e.html alt=數控機床自動化上下料機械手的好處 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e6372c2e.html title=數控機床自動化上下料機械手的好處>數控機床自動化上下料機械手的好處</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/714c8510.html alt=自動化上下料機械臂是由什麼要素組成？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/5b430001856ca1491feb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/714c8510.html title=自動化上下料機械臂是由什麼要素組成？>自動化上下料機械臂是由什麼要素組成？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f65108b5.html alt=37.3度以上自動報警！實時體溫監測，揭祕“抗疫神器”紅外熱像儀 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4e8a4e07bff64e6db5dcef502221fa45 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f65108b5.html title=37.3度以上自動報警！實時體溫監測，揭祕“抗疫神器”紅外熱像儀>37.3度以上自動報警！實時體溫監測，揭祕“抗疫神器”紅外熱像儀</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>