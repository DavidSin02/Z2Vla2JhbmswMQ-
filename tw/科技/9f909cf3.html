<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>CAN總線錯誤檢測機制 | 极客快訊</title><meta property="og:title" content="CAN總線錯誤檢測機制 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/153016949864906bebe91d2"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9f909cf3.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9f909cf3.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9f909cf3.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9f909cf3.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9f909cf3.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9f909cf3.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/9f909cf3.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/9f909cf3.html><meta property="article:published_time" content="2020-10-29T21:09:30+08:00"><meta property="article:modified_time" content="2020-10-29T21:09:30+08:00"><meta name=Keywords content><meta name=description content="CAN總線錯誤檢測機制"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/9f909cf3.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>CAN總線錯誤檢測機制</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p><strong>【</strong>電動汽車<strong>資源網EV江湖 ZLG致遠電子】</strong>CAN總線是ISO國際標準化的串行通信協議。在汽車產業中,出於對安全性、舒適性、方便性、低公害、低成本的要求,各種各樣的電子控制系統被開發了出來。由於這些系統之間通信所用的數據類型及對可靠性的要求不盡相同,由多條總線構成的情況很多,線束的數量也隨之增加。為適應“減少線束的數量”、“通過多個LAN,進行大量數據的高速通信”的需要,CAN總線應運而生,圖1為CAN總線在汽車中的應用圖。</p><div class=pgc-img><img alt=CAN總線錯誤檢測機制 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153016949864906bebe91d2><p class=pgc-img-caption></p></div><p>圖1 汽車中CAN總線的應用</p><p>CAN的高性能和可靠性已被認同,並被廣泛地應用於工業自動化、船舶、醫療設備、工業設備等方面。現場總線是當今自動化領域技術發展的熱點之一,被譽為自動化領域的計算機局域網。圖2為CAN總線網路圖,它的出現為分佈式控制系統實現各節點之間實時、可靠的數據通信提供了強而有力的技術支持。</p><div class=pgc-img><img alt=CAN總線錯誤檢測機制 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/153016949894291e3df40c9><p class=pgc-img-caption></p></div><p>圖2 CAN總線網路圖</p><p>CAN總線作為可靠性非常高的總線,出錯概率非常小,這也是它被廣泛應用的原因之一。在CAN總線的實際研發中,相較於CAN總線的正確幀,工程師更關注CAN總線的錯誤幀,下面將為大家展現CANscope波形常見的幾類錯誤,圖3為干擾導致的CAN通訊錯誤。</p><div class=pgc-img><img alt=CAN總線錯誤檢測機制 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153016949872766d7741ec6><p class=pgc-img-caption></p></div><p>圖3 錯誤波形圖</p><p>圖4為終端電阻並聯過多,差分電平幅值太小導致接收節點識別失敗的錯誤。</p><div class=pgc-img><img alt=CAN總線錯誤檢測機制 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/153016949866404dead1783><p class=pgc-img-caption></p></div><p>圖4 錯誤波形圖</p><p>圖5為總線支線過長,電平下降沿臺階過高,導致位寬度失調的錯誤。</p><div class=pgc-img><img alt=CAN總線錯誤檢測機制 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1530169498676b1c2b0c278><p class=pgc-img-caption></p></div><p>圖5 錯誤波形圖</p><p>圖6為卡車打開/關閉大燈時,耦合到CAN總線上的干擾,導致的錯誤。</p><div class=pgc-img><img alt=CAN總線錯誤檢測機制 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15301694987529a423a8ead><p class=pgc-img-caption></p></div><p>圖6 錯誤波形圖</p><p>圖7為波特率異常(位寬度從2us突然變成1.6us),導致位錯誤。</p><div class=pgc-img><img alt=CAN總線錯誤檢測機制 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/15301694994872a3df9f701><p class=pgc-img-caption></p></div><p>圖7 錯誤波形圖</p><p>CAN總線的錯誤都有哪些形式,相互之間有什麼樣的關係,以及總線的檢測與校驗的原理是什麼?</p><p>CAN總線的錯誤幀可分為位錯誤、位填充錯誤、CRC錯誤、格式錯誤、應答錯誤五大類,每類錯誤的具體解釋如圖8所示,此圖簡潔明瞭的展現了各種錯誤。</p><div class=pgc-img><img alt=CAN總線錯誤檢測機制 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1530169499396c00ffd5031><p class=pgc-img-caption></p></div><p>圖8 CAN總線錯誤類型</p><p>CAN報文傳輸過程中出現通訊錯誤,會發送錯誤幀,以上所述的錯誤幀類型中根據其錯誤標識符不同,可分為“主動錯誤”和“被動錯誤”。</p><p>主動錯誤:檢測錯誤主動報錯,發出錯誤標識符(連續6個顯性位)和錯誤界定符(連續8個隱形位);目的在於“主動”通知錯誤,即使別的節點沒有發現此錯誤;</p><p>被動錯誤:檢測錯誤,被動等待其他節點報錯後發送錯誤標識符(連續6個隱形位)和錯誤標識符(連續8個隱形位);目的在於識別錯誤,迴應主動錯誤;</p><p>總線關閉:節點不參與總線通訊;</p><p>為了避免某個設備因為自身原因(例如硬件損壞)導致無法正常收發數據而不斷地破壞數據幀,從而影響其他正常節點通訊,CAN-bus規範中規定每個CAN控制器都有一個發送錯誤計數器和一個接收錯誤計數器。根據計數值不同CAN節點會處於不同的設備狀態,狀態之間的轉換關係如圖9所示:</p><div class=pgc-img><img alt=CAN總線錯誤檢測機制 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153016949955687cd507fbe><p class=pgc-img-caption></p></div><p>圖9 錯誤轉換圖</p><p>接收、發送錯誤計數器對應的變動條件及數值變動情況:</p><p>● 接收單元檢測出錯誤時,檢測到錯誤標識符或過載標誌的“位錯誤”除外,此時REC+1、TEC不變;</p><p>● 接收單元在發送完錯誤標誌後檢測到第一位為顯性電平,此時REC+8、TEC不變;</p><p>●發送單元輸出錯誤標誌,此時REC不變、TEC+8;</p><p>●發送單元發送主動錯誤標誌或過載標誌,檢測出位錯誤,REC不變、TEC+8;</p><p>●接收單元發送主動錯誤標誌或過載標誌,檢測出位錯誤,REC+8、TEC不變;</p><p>●各單元從主動錯誤標誌、過載標誌的開始檢測出連續14個顯性位,之後每檢測出連續8個顯性位,發送時REC+8、接收時TEC+8;</p><p>●檢測出被動錯誤標誌後追加連續8個位的顯性位,發送時REC+8、接收時TEC+8;</p><p>●發送單元正常接收數據結束時(返回ACK且到幀結束位檢測到錯誤),REC不變、TEC-1;</p><p>●接收單元正常接收數據結束時(到CRC未檢測出錯誤且正常返回ACK),REC&lt;127時,REC-1,REC>127時,REC=127;TEC不變;</p><p>●處於總線關閉的單元,檢測到128次連續11個位的隱形位,錯誤計數器歸零,REC、TEC=0;</p><p>CAN總線錯誤處理功能屬於是鏈路層功能,此功能由CAN控制器決定,如圖10所示CAN控制介紹圖,其中詳細介紹與錯誤處理有關的部分:位流處理器、位邏輯控制、錯誤管理邏輯。</p><p>●位流處理器(BSP)是一個控制發送緩衝器、接收FIFO和CAN總線之間數據流的程序裝置,它還執行總線上的錯誤檢測、仲載、總線填充和錯誤處理。</p><p>●位時序邏輯(BTL)監視串行的CAN總線和位時序,它在信息開頭“弱勢支配”的總線傳輸時,同步 CAN總線位流(硬同步),接收報文時再次同步下一次傳送(軟同步)。</p><p>●錯誤管理邏輯(EML)負責限制傳輸層模塊的錯誤,它接收來自位流處理器的出錯報告,然後把有關錯誤統計告訴位流處理器和接口管理邏輯(IML)。</p><div class=pgc-img><img alt=CAN總線錯誤檢測機制 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15301694998270d26c38ffa><p class=pgc-img-caption></p></div><p>圖10 CAN控制器</p><p>CAN控制器的信號從CAN收發器的TXD發送到總線,同時被RXD收回進行檢測,以此達到實時的接收錯誤檢測、發送錯誤檢測與ID仲裁功能。CAN總線是如何保證數據傳輸可靠性的,以下介紹CAN總線獨有的檢測機制:位流檢測和CRC校驗;</p><p>位流檢測:即位檢測,如圖11所示節點在發送過程中,同時會監測自身發送的位數值,假如檢測到位與自身送出的位數值不同,則會提示位錯誤;</p><div class=pgc-img><img alt=CAN總線錯誤檢測機制 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15301694998435c4fa9b896><p class=pgc-img-caption></p></div><p>圖11 位檢測</p><p>CRC校驗:即循環冗餘校驗碼是數據通訊領域中最常用的一種差錯校驗碼,其信息字段和校驗字段的長度可任意選定;CRC校驗過程是通過循環計算冗餘校驗碼的方式實現的,CAN控制器內部CRC的實現是基於多項式發生器和一個15位寄存器;其意義在於保證傳輸數據的正確性,未經CRC校驗檢測出的錯誤低於10負九次方。</p><p>CANscope總線分析儀是一款綜合性的CAN總線開發與測試的專業工具,集海量存儲示波器、網絡分析儀、誤碼率分析儀、協議分析儀及可靠性測試工具於一身,並把各種儀器有機的整合和關聯,如圖12所示CANscope的軟件界面圖;重新定義CAN總線的開發測試方法,可對CAN網絡通訊正確性、可靠性、合理性進行多角度全方位的評估;幫助用戶快速定位故障節點,解決CAN總線應用的各種問題,是CAN總線開發測試的終極工具。</p><div class=pgc-img><img alt=CAN總線錯誤檢測機制 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15301694993697cb5e52ff9><p class=pgc-img-caption></p></div><p>圖12 CANscope軟件界面</p><p><strong>(來源:電動汽車資源網EV江湖 ZLG致遠電子)</strong></p><p>本文由電動汽車資源網【EV江湖】作者撰寫,觀點僅代表個人,不代表電動汽車資源網。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>總線</a></li><li><a>錯誤</a></li><li><a>檢測</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/e248c728.html alt=如何檢測光纖施工有沒達到標準？讀懂這篇文章足夠 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a357dbf061ff4e9ba7a19f247bd0999c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e248c728.html title=如何檢測光纖施工有沒達到標準？讀懂這篇文章足夠>如何檢測光纖施工有沒達到標準？讀懂這篇文章足夠</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/03a82c26.html alt=二手車檢測小常識之檢測部位 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/76746e71faac4f328d24e14d2f2d7404 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/03a82c26.html title=二手車檢測小常識之檢測部位>二手車檢測小常識之檢測部位</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/84e317ac.html alt=檢測虛設問題，應當採取強有力的措施加以解決 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/115bad769be144f19346317e77eed4b3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/84e317ac.html title=檢測虛設問題，應當採取強有力的措施加以解決>檢測虛設問題，應當採取強有力的措施加以解決</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2580d7b3.html alt=檢驗檢測機構程序文件、作業指導書編寫 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/3c7d5716-7d9c-472f-b84c-80158227a5fc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2580d7b3.html title=檢驗檢測機構程序文件、作業指導書編寫>檢驗檢測機構程序文件、作業指導書編寫</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ce0de46b.html alt=6個硬拉錯誤你都知道嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/509800008698e71077d2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ce0de46b.html title=6個硬拉錯誤你都知道嗎？>6個硬拉錯誤你都知道嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d07b6005.html alt=勇於承認錯誤的人，才是對自己最大的負責！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/152125346473672025c1c57 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d07b6005.html title=勇於承認錯誤的人，才是對自己最大的負責！>勇於承認錯誤的人，才是對自己最大的負責！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/01cfc446.html alt=如何不用打架就能說服別人承認錯誤？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RLQuktlFinUnGi style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/01cfc446.html title=如何不用打架就能說服別人承認錯誤？>如何不用打架就能說服別人承認錯誤？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3b27455d.html alt=對就是對，錯就是錯，勇於承認錯誤才是進步的表現 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/56790008a0f93a186f89 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3b27455d.html title=對就是對，錯就是錯，勇於承認錯誤才是進步的表現>對就是對，錯就是錯，勇於承認錯誤才是進步的表現</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e9b5e60d.html alt=承認錯誤也是一種勇敢 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1523331859560d5a2bd44e6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e9b5e60d.html title=承認錯誤也是一種勇敢>承認錯誤也是一種勇敢</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f04599c9.html alt=敢於承認自己的錯誤，才能不斷完善自我，成為更加優秀的人 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/b1a810d1-abf0-4d6b-9903-9dba365d8c2f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f04599c9.html title=敢於承認自己的錯誤，才能不斷完善自我，成為更加優秀的人>敢於承認自己的錯誤，才能不斷完善自我，成為更加優秀的人</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b667bcba.html alt="焦化問答  幹熄焦壓力檢測點常見故障有哪些？如何處理？" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/067d278f7d4949c785f5db324bb8bced style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b667bcba.html title="焦化問答  幹熄焦壓力檢測點常見故障有哪些？如何處理？">焦化問答 幹熄焦壓力檢測點常見故障有哪些？如何處理？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3de88fa3.html alt=生活中對PE管的五大錯誤認識 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/497f548c985641f7a612506bd54283bd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3de88fa3.html title=生活中對PE管的五大錯誤認識>生活中對PE管的五大錯誤認識</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1875bfc7.html alt=生活中，敢於承認自己的錯誤，是一種成熟的表現 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/614f4c5c-9032-4849-91af-41b95d34c617 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1875bfc7.html title=生活中，敢於承認自己的錯誤，是一種成熟的表現>生活中，敢於承認自己的錯誤，是一種成熟的表現</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0e00f10a.html alt=練太極拳常見的主要錯誤，你還在犯嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8b6452b8ff234b56b0b1ce0b054252af style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0e00f10a.html title=練太極拳常見的主要錯誤，你還在犯嗎？>練太極拳常見的主要錯誤，你還在犯嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2b4d5199.html alt=越按摩越僵硬，有多少人按摩頸椎是錯誤的？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d9c508a06914421ea05257e81f1d0271 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2b4d5199.html title=越按摩越僵硬，有多少人按摩頸椎是錯誤的？>越按摩越僵硬，有多少人按摩頸椎是錯誤的？</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>