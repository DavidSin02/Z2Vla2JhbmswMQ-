<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>excel提取技巧：單元格部分內容提取的三種方法 | 极客快訊</title><meta property="og:title" content="excel提取技巧：單元格部分內容提取的三種方法 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/15395830590494739893a0b"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1a2d229.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1a2d229.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a1a2d229.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1a2d229.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1a2d229.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a1a2d229.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a1a2d229.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1a2d229.html><meta property="article:published_time" content="2020-10-29T21:08:52+08:00"><meta property="article:modified_time" content="2020-10-29T21:08:52+08:00"><meta name=Keywords content><meta name=description content="excel提取技巧：單元格部分內容提取的三種方法"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/a1a2d229.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>excel提取技巧：單元格部分內容提取的三種方法</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><div class=pgc-img><img alt=excel提取技巧：單元格部分內容提取的三種方法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15395830590494739893a0b><p class=pgc-img-caption></p></div><p>問題來自於一位群友的求助，大家請看圖：</p><div class=pgc-img><img alt=excel提取技巧：單元格部分內容提取的三種方法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/153958305905416c21b550a><p class=pgc-img-caption></p></div><p>數據源在A列，包含了很多項信息，現在需要從中提取出容值、封裝和耐壓三項數據，不難發現，需要提取的數據具有一定的規律性，分別是數據源的第二、三、四個逗號之後的數據。</p><p>當我們遇到問題的時候，找到規律是解決問題的關鍵。現在規律找到了，因此解決方法也就有了。這裡有三種方法，從最簡單的快捷鍵操作到經典的吃遍天下的公式都有，以下分別進行介紹。</p><p><strong>1.快速填充法（Ctrl+ E）</strong></p><div class=pgc-img><img alt=excel提取技巧：單元格部分內容提取的三種方法 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1539583059301c61562e57c><p class=pgc-img-caption></p></div><p>評價：★★★★★</p><p>優勢：簡單、易用。</p><p>劣勢：還沒有發現。</p><p><strong>操作要點：</strong></p><p>（1）在B2單元格輸入0402時，要先輸入一個單引號，或者把單元格修改為文本格式再輸入；</p><p>（2）只輸入一個數據可能無法通過Ctrl+E得到正確結果，這時候連續輸入兩個數據就可以了。</p><p><strong>提示：</strong>組合鍵Ctrl+ E只能在Excel2013及以上的版本才能使用。</p><p>就本例而言，Ctrl+ E略微顯得有些麻煩，因此再介紹一種用分列的處理方法。</p><p><strong>2.分列法</strong></p><div class=pgc-img><img alt=excel提取技巧：單元格部分內容提取的三種方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539583059014c5bb0351e1><p class=pgc-img-caption></p></div><p>評價：★★★★☆</p><p>優勢：簡單、易用。</p><p>劣勢：數據量大了後工作量還是比較重。</p><p><strong>操作要點：</strong></p><p>（1）分列過程中使用逗號進行分隔；</p><p>（2）需要跳過不導入的列；</p><p>（3）對容值這列數據設置為文本格式；</p><p>（4）手工指定數據存放的目標區域。</p><p>相比第一個方法來說，使用分列就簡單了許多，同時通過這個例子，大家也可以對分列這個強大的功能有了深入的瞭解。</p><p>使用分列雖然比較方便，但如果經常要處理這類數據的話，操作量也是蠻大的，最後我們再來分享一個公式的做法。</p><p><strong>3. TRIM-MID-SUBSTITUTE-REPT組合公式法</strong></p><p>使用公式：=TRIM(MID(SUBSTITUTE($A2,",",REPT(" ",99)),COLUMN(B1)*99,99))</p><p>右拉下拉即可得到所需的結果。</p><div class=pgc-img><img alt=excel提取技巧：單元格部分內容提取的三種方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/153958305909551b191c589><p class=pgc-img-caption></p></div><p>評價：★★★★☆</p><p>優勢：快速，對付大量數據尤其實用，並且可以修改參數用於更復雜的字符提取。</p><p>劣勢：公式不好記。</p><p><strong>公式解析：</strong></p><p>這個公式裡用到了五個函數，其中有我們比較熟悉的MID和COLUMN，也有我們不太常用的TRIM、SUBSTITUTE和REPT函數。下面簡單來解釋一下這個公式的思路。</p><p>公式的核心部分是SUBSTITUTE($A2,",",REPT(" ",99))，這部分的作用是進行替換。</p><p>SUBSTITUTE函數格式為：</p><p>SUBSTITUTE（在哪裡替換，替換什麼，換成什麼，換第幾個）</p><p>例如：</p><p>公式=SUBSTITUTE($A2,",","-",3)的效果就是把A2單元格的第3個逗號換成-號。</p><div class=pgc-img><img alt=excel提取技巧：單元格部分內容提取的三種方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1539583059051ed102b37d2><p class=pgc-img-caption></p></div><p>當省略第四參數的時候，代表逗號全部替換，如圖：</p><div class=pgc-img><img alt=excel提取技巧：單元格部分內容提取的三種方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15395830592502a7d9498b1><p class=pgc-img-caption></p></div><p>本例中是把A2中的逗號換成了REPT(" ",99)，也就是99個空格。</p><p>REPT函數的格式為：</p><p>REPT（要重複的字符，重複次數）</p><p>例如：</p><p>REPT(“★”,5)，就是將★重複五次。</p><div class=pgc-img><img alt=excel提取技巧：單元格部分內容提取的三種方法 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153958305925728904f1ba7><p class=pgc-img-caption></p></div><p>至於公式中為什麼要用99個空格，完全是一種套路，繼續看完公式的其他部分或許就理解了。</p><p>使用SUBSTITUTE得到的數據還需要用MID函數來進行提取。MID函數大家應該比較熟悉了，基本格式為：MID（要提取的數據，從什麼位置開始取，取幾個字）。在本例中要提取的數據就是SUBSTITUTE（），而要提取的容值的位置原本是在第2個逗號之後，由於我們把逗號換成了99個空格，要提取的位置前面至少有兩組空格也就是2*99個字符；相應封裝的提取的位置是3*99，耐壓的是4*99。採用公式右拉，所以這裡用COLUMN(B1)*99作為提取位置。MID的最後一個參數是要取幾個字符，為了保險起見，統一提取99個字。</p><p>也就是說，經過MID（SUBSTITUTE（），COLUMN(B1)*99，99）這部分公式運算後，得到的結果是我們實際需要的容值數據包含在前後空格中。為了便於大家理解，臨時將空格換成-，可以直觀地看出效果：</p><div class=pgc-img><img alt=excel提取技巧：單元格部分內容提取的三種方法 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15395830593303ba8647f72><p class=pgc-img-caption></p></div><p>我們肯定不希望得到的結果中包含有大量無用的空格，因此在最外層套一個TRIM就可以去掉這些空格。TRIM函數只有一個參數，功能就是去掉字符串中多餘的空格。</p><p>本例使用的實際上也是非常經典的一個公式組合：TRIM-MID-SUBSTITUTE-REPT組合。公式理解起來需要一定的基礎，新手暫時無法理解的時候，可以先掌握公式的套路，根據自己的需要修改參數。</p><p><strong>閒言妄語：</strong></p><p>估計很多小白看不懂這個公式的套路哦~~小編心癢癢，就來現個醜，打個比方——沖水撈死魚。</p><p>一堆死魚，密密麻麻，一個靠一個。現在給你一個簍子（MID函數）要你從死魚中把其中的紅魚撈出來。要求是不要碰到其它魚。啷個辦？把魚分開（SUBSTITUTE函數替換逗號增大間距）呀！咋個分開？沖水（加空格）呀，使勁沖水（用99個空格，勁夠大了），魚分開了，然後一簍子就把紅色死魚撈起來了，雖然撈魚的時候水（空格）肯定也會帶上，但水馬上就從網孔（TRIM函數）中漏掉（被排除了）了，只剩需要的紅魚。</p><p>為啥用水（空格）而不是其他東西（譬如逗號）來增加間距呀？網孔（TRIM函數）只適合濾水（逗號就濾不走）呀。為啥要衝那麼多水（99個空格）？因為分得越開，越可以忽略其他魚的影響（字符數不等的影響），簍子（MID函數）的口徑（取字符的字符數）就可以越大（99），只需要給一個下簍子的大概位置（並非紅魚的準確位置，由COLUMN(B1)*99實現），就肯定只撈到水和紅魚。</p><p><strong>＊＊＊＊部落窩教育－excel互轉技巧＊＊＊＊</strong></p><p>原創：老菜鳥/部落窩教育（未經同意，請勿轉載）</p><p>更多教程：部落窩教育（www.itblw.com）</p><p>微信公眾號：exceljiaocheng</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>提取</a></li><li><a>excel</a></li><li><a>單元格</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/95114197.html alt=10個excel單元格的設置技巧，看完後還敢說你瞭解excel單元格嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/5c8699c28f984ee4955afb51f297d08e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/95114197.html title=10個excel單元格的設置技巧，看完後還敢說你瞭解excel單元格嗎？>10個excel單元格的設置技巧，看完後還敢說你瞭解excel單元格嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/10c7ce2d.html alt=excel中如何提取時間 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/153473005779129cc4dc901 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/10c7ce2d.html title=excel中如何提取時間>excel中如何提取時間</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/088a612b.html alt=excel中使用快捷方式鎖定單元格，凍結某些單元格、公式或單元格 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/203ee3d6bd5b4ae7b531ae4706f32fab style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/088a612b.html title=excel中使用快捷方式鎖定單元格，凍結某些單元格、公式或單元格>excel中使用快捷方式鎖定單元格，凍結某些單元格、公式或單元格</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/227666aa.html alt=excel快速移動單元格的方法？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0485f2c0e82746c997ac8be7ac96f34d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/227666aa.html title=excel快速移動單元格的方法？>excel快速移動單元格的方法？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a93838c.html alt=讓excel單元格顏色隨日期自動變化，你會嗎？用條件格式1分鐘搞定 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/1787a588-657b-4b18-b3fd-5e7d67d31f9d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a93838c.html title=讓excel單元格顏色隨日期自動變化，你會嗎？用條件格式1分鐘搞定>讓excel單元格顏色隨日期自動變化，你會嗎？用條件格式1分鐘搞定</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/accc98e1.html alt=Excel合併單元格彙總求和、計數，一個公式搞定，直接套用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/c9d2e965-4179-4b0a-aace-c6de13b42ebe style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/accc98e1.html title=Excel合併單元格彙總求和、計數，一個公式搞定，直接套用>Excel合併單元格彙總求和、計數，一個公式搞定，直接套用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2664a94c.html alt=excel中的DSUM函數——條件求和原來如此簡單 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0dc7aeaa9b61467e86dbaeae6dfeaaa4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2664a94c.html title=excel中的DSUM函數——條件求和原來如此簡單>excel中的DSUM函數——條件求和原來如此簡單</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/729c91d6.html alt=excel中運用sumproduct函數多列多條件求和 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/eca06a506fd3480f97b93edddacc65aa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/729c91d6.html title=excel中運用sumproduct函數多列多條件求和>excel中運用sumproduct函數多列多條件求和</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/06708c4c.html alt=excel小技巧：自動求和，當新增數據時自動求和 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1523970520159b755ba89ba style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/06708c4c.html title=excel小技巧：自動求和，當新增數據時自動求和>excel小技巧：自動求和，當新增數據時自動求和</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/92db9d80.html alt=excel工作表的行或列怎麼自動求和 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3cb8c0ec1c534395bc85f10ff757f503 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/92db9d80.html title=excel工作表的行或列怎麼自動求和>excel工作表的行或列怎麼自動求和</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/48f18e97.html alt=excel常用函數用法解析第四篇——COLUMN、ROW函數 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4c3daf45857e4f169def37fc08d652fd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/48f18e97.html title=excel常用函數用法解析第四篇——COLUMN、ROW函數>excel常用函數用法解析第四篇——COLUMN、ROW函數</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a2cae819.html alt=3秒鐘內搞定同單元格內多個人名，多個單元格人員計數 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/9d2e2bc6-603f-4bf3-9879-4e8060ac4cd1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a2cae819.html title=3秒鐘內搞定同單元格內多個人名，多個單元格人員計數>3秒鐘內搞定同單元格內多個人名，多個單元格人員計數</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b22dfac7.html alt=「Excel技巧」統計同一個單元格內的人員數量，一個公式就搞定 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f45549dd2cae4e14aa958ce201c1ea72 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b22dfac7.html title=「Excel技巧」統計同一個單元格內的人員數量，一個公式就搞定>「Excel技巧」統計同一個單元格內的人員數量，一個公式就搞定</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/071c15c7.html alt=快速定位合併單元格 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/435c00024948943a584d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/071c15c7.html title=快速定位合併單元格>快速定位合併單元格</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9cb8d920.html alt=3日科技熱點回顧：excel中怎麼跳至有內容的最後一個單元格？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8bc1ff70e2a74131a43c9ac9ea424bf3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9cb8d920.html title=3日科技熱點回顧：excel中怎麼跳至有內容的最後一個單元格？>3日科技熱點回顧：excel中怎麼跳至有內容的最後一個單元格？</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>