<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>萬字長文帶你瞭解變分自編碼器VAEs | 极客快訊</title><meta property="og:title" content="萬字長文帶你瞭解變分自編碼器VAEs - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/0f0d438dcd3f4085902cc8c9214d8655"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1fb61f.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1fb61f.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a1fb61f.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1fb61f.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1fb61f.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a1fb61f.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a1fb61f.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a1fb61f.html><meta property="article:published_time" content="2020-10-29T21:05:25+08:00"><meta property="article:modified_time" content="2020-10-29T21:05:25+08:00"><meta name=Keywords content><meta name=description content="萬字長文帶你瞭解變分自編碼器VAEs"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/a1fb61f.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>萬字長文帶你瞭解變分自編碼器VAEs</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>原文標題：Understanding Variational Autoencoders (VAEs)</p><p>原文鏈接：https://towardsdatascience.com/understanding-variational-autoencoders-vaes-f70510919f73</p><p>原文作者：Joseph Rocca & Baptiste Rocca</p><p><br></p><p>最近比較關注文本生成任務，除了用到傳統的seq2seq模型，還涉及到一些GAN和VAE的知識。這篇是看的資料裡介紹VAE比較好的一篇文章，就翻譯了一下，推薦給大家。</p><p><br></p><ul><li>簡介</li><ul><li>大綱</li></ul><li>降維，PCA和自編碼器</li><ul><li>什麼是降維？</li><li>主成分分析（PCA）</li><li>自編碼器</li></ul><li>變分自編碼器（VAE）</li><ul><li>自編碼器用於內容生成的侷限性</li><li>變分自編碼器的定義</li><li>關於正則化的直觀解釋</li></ul><li>VAE的數學細節</li><ul><li>概率框架和假設</li><li>變分推理公式</li><li>將神經網絡引入模型</li></ul><li>總結</li></ul><p><br></p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0f0d438dcd3f4085902cc8c9214d8655><p class=pgc-img-caption></p></div><p><br></p><h2 class=pgc-h-arrow-right>簡介</h2><p>在過去的幾年中，由於一些驚人的進步，基於深度學習的生成模型越來越受到關注。依靠大量數據，精心設計的網絡結構和訓練技術，深度生成模型已經顯示出了令人難以置信的能力，可以生成高度逼真的各種內容，例如圖像，文本和聲音。在這些深度生成模型中，有兩個類別脫穎而出，值得特別關注：生成對抗網絡（GAN）和變分自編碼器（VAE）。</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b11c1020985e48df93a030bcecea49b4><p class=pgc-img-caption></p></div><p>VAE生成的人臉圖片</p><p>在今年1月發佈的文章中，我們深入討論了生成對抗網絡（GANs），並展示了對抗訓練如何對抗兩個網絡（生成器和鑑別器），以推動這兩個網絡同時迭代。在這篇文章中，我們將介紹另一種主要的深度生成模型：變分自編碼器（VAE）。簡而言之，VAE是一種自編碼器，在訓練過程中其編碼分佈是規範化的，以確保其在隱空間具有良好的特性，從而允許我們生成一些新數據。術語“變分”源自統計中的正則化和變分推理方法。</p><p>雖然最後兩句話很好地概括了VAE的概念，但是它們也會引出很多問題。什麼是自編碼器？什麼是隱空間，為什麼要對其進行規範化？如何用VAE生成新數據？VAE與變分推理之間有什麼聯繫？為了儘可能詳細地描述VAE，我們將嘗試回答所有這些問題（以及許多其他問題！），併為讀者提供儘可能多的知識（從基本直覺到更高級的數學細節）。因此，本文的目的不僅是討論變分自編碼器所依賴的基本概念，而且還要逐步構建出導致這些概念的推理過程。</p><p>事不宜遲，讓我們一起（重新）發現VAE！</p><h3 class=pgc-h-arrow-right>大綱</h3><p>在第一部分中，我們將回顧一些有關降維和自編碼器的重要概念，這些概念將有助於理解VAE。在第二部分中，我們將說明為什麼不能使用自編碼器來生成新數據，並將介紹變分自編碼器，它們是自編碼器的規範化版本，使生成數據成為可能。在最後一節中，我們將基於變分推論對VAE進行更數學的描述。</p><blockquote><p>注意：在最後一節中，我們試圖使數學推導儘可能完整和清楚，以彌合直覺和方程之間的差距。但是，不想深入瞭解VAE的數學細節的讀者可以跳過本節，而不會影響對主要概念的理解。還要注意，在本文中，我們將大量使用以下符號：對於隨機變量，我們將用表示該隨機變量的分佈（或密度，取決於上下文）。</p></blockquote><h2 class=pgc-h-arrow-right>降維，PCA和自編碼器</h2><p>在這部分中，我們將從討論與降維有關的一些概念開始。特別地，我們將簡要回顧主成分分析（PCA）和自編碼器，以展示這兩種思想之間的相互關係。</p><h3 class=pgc-h-arrow-right>什麼是降維？</h3><p>在機器學習中，<strong>降維是減少描述某些數據的特徵數量的過程</strong>。可以通過<strong>選擇</strong>（僅保留一些現有特徵）或通過<strong>提取</strong>（基於舊特徵來生成數量更少的新特徵）來進行降維。降維在許多需要低維數據（數據可視化，數據存儲，繁重的計算...）的場景中很有用。儘管存在許多不同的降維方法，但是我們可以構建一個適用於大多數方法都的總體框架。</p><p>首先，我們稱編碼器為從“舊特徵”表示中產生“新特徵”表示（通過選擇或提取）的過程，然後將逆過程稱為解碼。降維可以理解為為數據壓縮，其中編碼器壓縮數據（從初始空間到編碼空間，也稱為隱空間），而解碼器將其解壓縮。當然，根據初始數據分佈、隱空間大小和編碼器定義，壓縮可能是有損的，這意味著一部分信息在編碼過程中丟失，並且在解碼時無法恢復。</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d0fb1a2723924daba71ae6eab89bb543><p class=pgc-img-caption></p></div><p>編碼器和解碼器</p><p>降維方法的主要目的是在給定候選中找到最佳的編碼器/解碼器對。換句話說，對於給定的一組可能的編碼器和解碼器，我們希望編碼時保持信息量最大，從而在解碼時具有儘可能小的重構誤差。如果我們分別用和表示我們正在考慮的編碼器和解碼器，則降維問題可以表示為</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/68506e5ceb8f45878bbfe53765196d31><p class=pgc-img-caption></p></div><p>其中</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5d104718072d4b1ab61ab22e810f4442><p class=pgc-img-caption></p></div><p>定義輸入數據和編碼解碼數據之間的重構誤差量度。需要注意，在下面我們將用表示數據數量，表示初始（解碼）空間的維數，表示降維後（編碼）空間的維數。</p><h3 class=pgc-h-arrow-right>主成分分析（PCA）</h3><p>談到降維時，首先想到的方法就是主成分分析（PCA）。為了展示它如何符合我們剛剛描述的框架並建立與自編碼器的聯繫，我們將對PCA的工作方式進行的概述（忽略大部分細節）。</p><p>PCA的想法是構建個新的獨立特徵，這些特徵是個舊特徵的<strong>線性組合</strong>，使得這些新特徵所定義的子空間上的數據投影儘可能接近初始數據（就歐幾里得距離而言）。換句話說，PCA尋找初始空間的最佳線性子空間（由新特徵的正交基來描述），以使通過其在該子空間上的投影近似數據的誤差儘可能小。</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1586e653399f4a528d4bbcb527e0fcec><p class=pgc-img-caption></p></div><p>PCA是在尋找最佳子空間</p><p>用我們的框架來描述，我們正在搜尋一個矩陣表示的編碼器（線性變換），該變換的各行是正交的（特徵獨立性），並且在尋找一個矩陣表示的相應解碼器。可以證明，與協方差特徵矩陣的個最大特徵值（在範數上）相對應的單位特徵向量是正交的（可以構造出正交的），並且組成了維數的最佳子空間，使得數據投影到子空間的誤差最小。因此，可以選擇這個特徵向量作為我們的新特徵，因此，降維問題可以表示為特徵值/特徵向量問題。此外，還可以推出，在這種情況下，解碼器矩陣是編碼器矩陣的轉置。</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f31a4337c70e46c8a1e0ff4e13c9510c><p class=pgc-img-caption></p></div><p>PCA與我們的總體框架是兼容的</p><h3 class=pgc-h-arrow-right>自編碼器</h3><p>現在我們討論<strong>自編碼器</strong>，以及如何使用神經網絡進行降維。自編碼器的總體思路非常簡單，主要包括用神經網絡來作為編碼器和解碼器，並使用迭代優化學習最佳的編碼-解碼方案。因此，在每次迭代中，我們向自編碼器體系結構（編碼器後跟解碼器）提供一些數據，我們將編碼解碼後的輸出與初始數據進行比較，並通過反向傳播誤差來更新網絡的權重。</p><p>因此，直觀地講，整個自編碼器體系結構（編碼器+解碼器）會構造出數據瓶頸（bottleneck），從而確保只有信息的主要結構部分可以通過瓶頸並進行重構。從我們的總體框架來看，考慮的編碼器系列由編碼器網絡體系結構定義，考慮的解碼器系列由解碼器網絡體系結構定義，而重構誤差的減小則通過對編碼器和解碼器參數進行梯度下降來進行。</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5238bbe0b694487cadbb17b721dfccfb><p class=pgc-img-caption></p></div><p>帶有損失函數的自編碼器</p><p>首先，假設我們的編碼器和解碼器體系結構都只有一層且沒有非線性（線性自編碼器）。這樣的編碼器和解碼器是簡單的線性變換，可以表示為矩陣。在這種情況下，某種意義上，我們可以看到與PCA的明顯的關聯，就像PCA一樣，我們正在尋找最佳的線性子空間來投影數據，並且使這樣做時信息損失儘可能少。用PCA獲得的編碼和解碼矩陣自然地定義了梯度下降所能滿足的一種解決方案，但是我們應該指出這不是唯一的解決方案。實際上，<strong>可以選擇幾組不同的基向量來描述相同的最佳子空間</strong>，因此，幾個編碼器/解碼器對都可以提供最小的重構誤差。此外，與PCA不同，對於線性自編碼器，我們最終獲得的新特徵不必是獨立的（神經網絡中沒有正交性約束）。</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/cff7e327454441d98a528fc028c3bb0a><p class=pgc-img-caption></p></div><p>線性自編碼器和PCA的聯繫</p><p>現在，假設編碼器和解碼器都是深度非線性網絡的。在這種情況下，網絡結構越複雜，自編碼器就可以進行更多的降維，同時保持較低的重構損失。直觀地講，如果我們的編碼器和解碼器具有足夠的自由度，則可以將任何初始維數減小為1。實際上，具有“無限大能力”的編碼器理論上可以將我們的N個初始數據編碼為1、2、3， …最多N個（或更一般地說，為實軸上的N個整數），相關的解碼器再進行逆變換，在這種過程中不會造成任何損失。</p><p>但是我們應該牢記兩點。首先，在沒有重建損失的情況下進行重要的降維通常會帶來一個代價：隱空間中缺乏可解釋和可利用的結構（缺乏規則性，lack of regularity）。其次，大多數時候，降維的最終目的不僅是減少數據的維數，而是要在減少維數的同時將數據結構信息的主要部分保留在簡化的表示中。出於這兩個原因，必須根據降維的最終目的來仔細控制和調整隱空間的大小和自編碼器的“深度”（深度定義壓縮的程度和質量）。</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/8d4c097f640248fcbfc6920f52b2e307><p class=pgc-img-caption></p></div><p>降維時希望保留主要信息</p><h2 class=pgc-h-arrow-right>變分自編碼器（VAE）</h2><p>到目前為止，我們已經討論了降維問題，並介紹了自編碼器，它們是可以通過梯度下降訓練的編碼器-解碼器結構。現在，讓我們考慮內容生成問題，看一下自編碼器對此問題的侷限性，並介紹變分自編碼器。</p><h3 class=pgc-h-arrow-right>自編碼器用於內容生成的侷限性</h3><p>此時，自然會想到一個問題：“自編碼器和內容生成之間的聯繫是什麼？”。確實，一旦對自編碼器進行了訓練，我們既有編碼器又有解碼器，但是仍然沒有真正的方式來產生任何新內容。乍一看，我們可能會認為，如果隱空間足夠規則（在訓練過程中編碼器很好地“組織”了），我們可以從該隱空間中隨機取一個點並將其解碼以獲得新的內容。然後，解碼器將或多或少地像生成對抗網絡的生成器一樣工作。</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8d26406a0a6c46e99ba4d5839c3c1b54><p class=pgc-img-caption></p></div><p>但是，正如我們在上一節中討論的那樣，自編碼器的隱空間的規則性是一個難點，它取決於初始空間中數據的分佈、隱空間的大小和編碼器的結構。因此，很難（如果不是不可能）先驗地確保編碼器將以與我們剛剛描述的生成過程兼容的方式智能地組織隱空間。</p><p>為了說明這一點，讓我們再看一遍之前給出的示例，在該示例中，我們描述了一種強大的編碼器和解碼器，可以將任何N個初始訓練數據放到實軸上（每個數據點都被編碼為實值）並可以沒有任何損失地解碼。在這種情況下，自編碼器的高自由度使得可以在沒有信息損失的情況下進行編碼和解碼（儘管隱空間的維數較低）但會導致嚴重的過度擬合，這意味著隱空間的某些點將在解碼時給出無意義的內容。儘管這種精挑細選的一維示例太過極端，但可以注意到自編碼器的隱空間規則性問題是普遍的，值得特別注意。</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f117d52f1f004ced803d3ffac0a24e8d><p class=pgc-img-caption></p></div><p>進入隱空間的編碼數據之間缺乏結構是很正常的。的確，在自編碼器的訓練任務中，沒有什麼東西保證能夠得到這種結構：無論隱空間如何組織，自編碼器都僅以儘可能少的損失為目標進行訓練。因此，如果我們對架構的定義不小心，那麼在訓練過程中，網絡很自然地會利用任何過擬合的可能性來儘可能地完成其任務……除非我們明確對其進行規範化！</p><h3 class=pgc-h-arrow-right>變分自編碼器的定義</h3><p>因此，為了能夠將我們的自編碼器的解碼器用於生成目的，我們必須確保隱空間足夠規則。獲得這種規律性的一種可能解決方案是在訓練過程中引入顯式的正規化（regularisation）。<strong>因此，正如我們在這篇文章的簡介中提到的那樣，變分自編碼器可以定義為一種自編碼器，其訓練經過正規化以避免過度擬合，並確保隱空間具有能夠進行生成過程的良好屬性。</strong></p><p>就像標準自編碼器一樣，變分自編碼器是一種由編碼器和解碼器組成的結構，經過訓練以使編碼解碼後的數據與初始數據之間的重構誤差最小。但是，為了引入隱空間的某些正則化，我們對編碼-解碼過程進行了一些修改：<strong>我們不是將輸入編碼為隱空間中的單個點，而是將其編碼為隱空間中的概率分佈</strong>。然後對模型進行如下訓練：</p><ul><li>首先，將輸入編碼為在隱空間上的分佈；</li><li>第二，從該分佈中採樣隱空間中的一個點；</li><li>第三，對採樣點進行解碼並計算出重建誤差；</li><li>最後，重建誤差通過網絡反向傳播。</li></ul><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/4d87e23328714179a9ca719239208f79><p class=pgc-img-caption></p></div><p>自編碼器（確定性）和變分自編碼器（概率性）之間的差異</p><p>實踐中，選擇正態分佈作為編碼的分佈，使得可以訓練編碼器來返回描述高斯分佈的均值和協方差矩陣。將輸入編碼為具有一定方差而不是單個點的分佈的原因是它可以非常自然地表達隱空間規則化：編碼器返回的分佈被強制接近標準正態分佈。在下一節中，我們將通過這種方式確保隱空間的局部和全局正則化（局部是由於方差控制，而全局是由於均值控制）。</p><p>因此，在訓練VAE時最小化的損失函數由一個“重構項”（在最後一層）組成，“重構項”傾向於使編碼解碼方案儘可能地具有高性能，而一個“正則化項”（在隱層）通過使編碼器返回的分佈接近標準正態分佈，來規範隱空間的組織。該正則化項為返回的分佈與標準高斯之間的<strong>Kulback-Leibler散度[1]</strong>，這將在下一節中進一步說明。我們可以注意到，兩個高斯分佈之間的Kullback-Leibler散度具有封閉形式，可以直接用兩個分佈的均值和協方差矩陣表示。</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/cd850df1343e467293065952575303b2><p class=pgc-img-caption></p></div><p>在變分自動編碼器中，損失函數由一個重構項（優化編碼-解碼）和一個正則化項（使隱空間規則化）組成。</p><h3 class=pgc-h-arrow-right>關於正則化的直觀解釋</h3><p>為了使生成過程成為可能，我們期望隱空間具有規則性，這可以通過兩個主要屬性表示：連續性（continuity，隱空間中的兩個相鄰點解碼後不應呈現兩個完全不同的內容）和完整性（completeness，針對給定的分佈，從隱空間採樣的點在解碼後應提供“有意義”的內容）。</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/59f1dde9fce048e7b816469e783ac3ef><p class=pgc-img-caption></p></div><p>不規範的隱空間vs規範的隱空間</p><p>VAE將輸入編碼為分佈而不是點不足以確保連續性和完整性。如果沒有明確定義的正則化項，則模型可以學習最小化其重構誤差，從而“忽略”要返回一個分佈並表現得幾乎像經典自編碼器一樣（導致過度擬合）。為此，編碼器可以返回具有微小方差的分佈（這往往是點分佈punctual distributions），或者返回具有巨大均值差異的分佈（在隱空間中彼此實際上相距很遠）。在這兩種情況下，返回分佈的限制都沒有取得效果，並且不滿足連續性和/或完整性。</p><p>因此，為了避免這些影響，<strong>我們必須對協方差矩陣和編碼器返回的分佈均值進行正則化</strong>。實際上，通過強制分佈接近標準正態分佈（集中和簡化）來完成此正則化。這樣，我們要求協方差矩陣接近於單位陣，防止出現單點分佈，並且均值接近於0，防止編碼分佈彼此相距太遠。</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7718165368954f0491bb9043118bef0e><p class=pgc-img-caption></p></div><p>必須對返回的VAE分佈進行正則化，以獲得具有良好屬性的隱空間。</p><p>使用此正則化項，我們可以防止模型在隱空間中的編碼相互遠離，並鼓勵儘可能多的返回分佈“重疊”，從而滿足預期的連續性和完整性條件。自然地，對於任何正則化項，這都是以訓練數據上更高的重建誤差為代價的。然而，可以調整重建誤差和KL散度之間的權重，我們將在下一節中看到如何從形式推導中自然得出平衡的表達。</p><p>總結這一小節，我們可以觀察到，通過正則化獲得的連續性和完整性往往會在隱空間中編碼的信息上產生“梯度”。例如，應將隱空間中位於來自不同訓練數據的兩個編碼分佈的均值的中間點解碼為提供第一個分佈的數據和提供第二個分佈的數據之間的某個數據，如下所示：在兩種情況下，它都可以由自編碼器採樣。</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/14df8d3d3df14c8dbd2b77dadee04b93><p class=pgc-img-caption></p></div><p>正則化傾向於在潛在空間中編碼的信息上創建一個“梯度”。</p><blockquote><p><strong>注意</strong>：順帶一提，我們提到的第二個問題（網絡使分佈彼此遠離）當規模變大時幾乎與第一個潛在問題（網絡趨向於返回單點分佈）等效：在兩種情況下，分佈方差的差別都相對小於均值之間的差別。</p></blockquote><h2 class=pgc-h-arrow-right>VAE的數學細節</h2><p>在上一節中，我們給出了以下直觀的概述：VAE是將輸入編碼為分佈而不是點的自編碼器，並且其隱空間結構通過將編碼器返回的分佈約束為接近標準高斯而得以規範化。在本節中，我們將對VAE進行更數學的介紹，從而使我們可以更嚴格地證明正則化項的合理性。為此，我們將建立一個明確的概率框架，並將使用變分推理技術。</p><h3 class=pgc-h-arrow-right>概率框架和假設</h3><p>讓我們首先定義一個概率圖形模型來描述我們的數據。我們用表示代表我們的數據變量，並假定是由未直接觀察到的潛在變量（編碼表示,the encoded representation）生成的。因此，對於每個數據點，假定以下兩個步驟生成過程：</p><ul><li>首先，從先驗分佈中採樣一個隱空間表示；</li><li>第二，按條件概率採樣數據</li></ul><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/de543f03a926476681618a4e3f1247b0><p class=pgc-img-caption></p></div><p>數據生成過程的概率圖模型。</p><p>在這種概率模型下，我們可以重新定義編碼器和解碼器的概念。實際上，與考慮使用確定的編碼器和解碼器的簡單自編碼器不同，我們現在將考慮這兩個對象的概率版本。自然地，“概率解碼器”由定義，描述給定已編碼變量的解碼變量的分佈，而“概率編碼器”由定義，描述的分佈。根據解碼後的變量給出編碼後變量的分佈。</p><p>此時，我們已經注意到，在簡單的自編碼器中所缺乏的隱空間的正則化自然出現在數據生成過程的定義中：我們假設隱空間中的編碼表示遵循先驗分佈。否則，我們還可以提一下著名的貝葉斯定理，該定理在先驗，似然性和後驗之間建立聯繫</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fc475eecc1d2499f9f454b3884f03566><p class=pgc-img-caption></p></div><p>現在讓我們假設是標準的高斯分佈，是高斯分佈，其均值由變量的確定函數定義，並且協方差矩陣的形式為正常數乘以單位矩陣的。假定函數屬於記為的函數族，對於我們暫不指定。因此，我們有</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f6a708bca21a4d99a6192d8178ee6ec9><p class=pgc-img-caption></p></div><p>現在，讓我們考慮。從理論上講，我們知道和，便可以使用貝葉斯定理來計算：這是經典的<strong>貝葉斯推理問題[2]</strong>。但是，正如我們在前一篇文章中所討論的那樣，這種計算通常是棘手的（由於分母處的積分），需要使用諸如變分推理之類的近似技術。</p><blockquote><p><strong>注意</strong>：在這裡我們可以提到和都是高斯分佈。因此，如果我們有，則意味著也應遵循高斯分佈，並且從理論上講，我們可以“僅”嘗試表示均值以及的協方差矩陣相對於和x|z)$的均值和協方差矩陣。但是，實際上不滿足此條件，因此我們需要使用近似算法（如變分推理），使該方法能夠通用，並且對模型假設的某些更改更加健壯。</p></blockquote><h3 class=pgc-h-arrow-right>變分推理公式</h3><p>在統計中，變分推論（VI）是一種近似複雜分佈的技術。這個想法是要設置一個參數化的分佈族（例如高斯族，其參數是均值和協方差），並在該族中尋找目標分佈的最佳近似。該族中最好的對象是使給定的近似誤差測量值最小化的元素（大多數情況下是近似分佈與目標分佈之間的Kullback-Leibler散度），並通過對該族的參數進行梯度下降來發現。有關更多詳細信息，請參閱有關<strong>變分推理的文章[3]</strong>及其中的參考。</p><p>在這裡，我們將通過高斯分佈來近似，其均值和協方差由參數的兩個函數和定義。這兩個函數應該分別屬於函數族和，這將在以後指定，但是應該對其進行參數化。因此我們可以寫出如下表示</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/989658a89769433c955bd7d902ff08d9><p class=pgc-img-caption></p></div><p>好了，我們已經以這種方式定義了一個變分推論的候選族，現在需要通過優化函數和（實際上是它們的參數）以最小化近似分佈和真實分佈間的Kullback-Leibler散度，從而找到該族中的最佳近似。換句話說，我們正在尋找最優的和，使得</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/38ef33cac1724f7791dfe663cc833089><p class=pgc-img-caption></p></div><p>在倒數第二個方程中，我們可以觀察到在近似後驗時存在一個權衡點——最大化“觀測”的可能性（第一項，預期對數似然概率的最大）與接近先驗分佈（第二項，和之間的KL散度最小）。這種折衷對於貝葉斯推理問題是很自然的，體現了在數據的置信度與先驗分佈置信度之間的平衡。</p><p>到目前為止，如果假設函數是已知且固定的，則我們可以使用變分推理技術來近似後驗。但是實際上，定義解碼器的函數是未知的，而且也需要求解。但我們最初的目標是找到一種性能良好的編碼/解碼方案，其隱空間又足夠規則，可以用於生成目的。如果規則性主要由在隱空間上假定的先驗分佈所決定，則整個編碼-解碼方案的性能高度取決於函數的選擇。確實，由於可以從和近似（通過變分推論），而是簡單的標準高斯模型，僅存的兩個需要我們優化的對象是參數(決定了分佈的協方差)和函數(決定了分佈的均值)。</p><p>因此，讓我們考慮一下，正如我們之前討論的那樣，對於中的任何函數（每個函數都定義一個不同的概率解碼器），我們都可以得到的最佳近似。無論他的特性如何，但我們正在尋找一種儘可能高效的編碼-解碼方案，然後，當給定從採樣的時，我們希望選擇函數使的期望對數似然概率最大化。<strong>換句話說，對於給定的輸入，當我們從分佈採樣然後從分佈採樣時，我們希望最大化的概率。因此，我們正在尋找最優</strong></p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ebd76e8633f84525a07cfeb2a0dd44cf><p class=pgc-img-caption></p></div><p>其中取決於函數，獲得方法如前所屬。將所有部分聚集在一起，我們正在尋找最優的，和，以便</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/961fc36eea8b4bdb8834fc09ddc8342d><p class=pgc-img-caption></p></div><p>我們可以在該目標函數中對應前面章節裡對VAE的直觀描述中引入的元素：和之間的重構誤差以及和（這是標準的高斯）之間由KL散度給出的正則項。我們還可以注意到常數，它決定了前兩個條件之間的平衡。越高，我們對模型中的概率解碼器假設周圍的方差就越大，我們也就越關注正則化項（如果低，則相反）。</p><h3 class=pgc-h-arrow-right>將神經網絡引入模型</h3><p>目前為止，我們已經建立了一個依賴於三個函數，和的概率模型，並使用變分推理表示要解決的優化問題，以便獲得能夠給出最優值的，和。此模型的編解碼方案。由於我們無法輕鬆地在函數的整個空間上進行優化，因此我們限制了優化域，並決定將，和表示為神經網絡。因此，，和分別對應於網絡體系結構定義的函數族，並且將對這些網絡的參數進行優化。</p><p>實際上，和不是由兩個完全獨立的網絡定義的，而是共享它們的一部分結構和權重，因此我們可以</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d12ce99240d0416d8634d13068219e52><p class=pgc-img-caption></p></div><p>因為它定義了的協方差矩陣，所以被假定為方陣。但是，為了簡化計算並減少參數的數量，我們做出了額外的假設，即的近似值是具有對角協方差矩陣的多維高斯分佈（變量獨立性假設）。在此假設下，只是協方差矩陣對角元素的向量，因此其大小與相同。但是，我們以這種方式減少了我們用於變分推斷的分佈族，因此，對的近似可能不太準確。</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f7507eb154264fb28b97d4190a040805><p class=pgc-img-caption></p></div><p>VAE的編碼器部分</p><p>編碼器對建模時將均值和協方差均視關於為(和）的高斯函數，解碼器則與之不同。我們的模型假設具有固定的高斯協方差。函數定義關於的高斯分佈均值，由神經網絡建模，可以表示如下</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d4513d5b24754fb394f952bc838f9dee><p class=pgc-img-caption></p></div><p>VAE的解碼器部分</p><p>然後，通過將編碼器和解碼器部分串聯在一起，可以獲得總體架構。但是，在訓練過程中，我們仍然需要非常小心從編碼器返回的分佈中進行採樣。採樣過程必須以允許誤差通過網絡反向傳播。儘管有隨機採樣發生在模型的中間，但有一個簡單的稱為重參數化技巧（reparametrisation trick），使梯度下降成為可能。它利用以下事實：如果是遵循均值的高斯分佈的隨機變量，則與協方差可以表示為</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/345d58395d044fcd9bb7f7a35d21f3f3><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/82a0372225cd42e8809c4fcb587f9eac><p class=pgc-img-caption></p></div><p>reparametrisation示意圖</p><p>最後，這種方式獲得的變分式自編碼器架構的目標函數由上一小節的最後一個方程式給出，其中理論期望由蒙特卡洛近似代替，該近似值在大多數情況下僅進行單次採樣。因此，考慮這種近似並表示（），我們可以獲得上一節中直觀得出的損失函數，該函數由一個重構項，一個正則項和一個常數來定義這兩個項的相對權重。</p><div class=pgc-img><img alt=萬字長文帶你瞭解變分自編碼器VAEs onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/febaee24996c4e39b0165377ad5e0479><p class=pgc-img-caption></p></div><p>變分自編碼器的表示形式</p><h2 class=pgc-h-arrow-right>總結</h2><p>本文的主要方法是：</p><ul><li>降維是減少描述某些數據的特徵量的過程（通過僅選擇初始特徵的子集或通過將它們組合成數量更少的新特徵），因此可以看作是編碼過程</li><li>自編碼器是由編碼器和解碼器組成的神經網絡體系結構，它們會創建瓶頸以處理數據，並經過訓練以在編碼-解碼過程中損失最少的信息（通過梯度下降迭代進行訓練，目的是減少重建錯誤）</li><li>由於過度擬合，自編碼器的隱空間可能極為不規則（隱空間中的臨近點可能產生截然不同的解碼數據，而且解碼後，隱空間中的某些點可能產生無意義的內容），因此，我們無法定義了一個生成過程，該過程僅包含從隱空間中採樣一個點，然後使其經過解碼器以獲取新數據</li><li>變分自編碼器（VAE）是自編碼器，它通過使編碼器返回隱空間中的分佈而不是單個點，並在損失函數中添加一個對返回的分佈的正則項來解決隱空間不規則性的問題，以確保更好地組織隱空間</li><li>假設有一個簡單的基本概率模型來描述我們的數據，則可以詳細推導由重構項和正則項組成的非常直觀的VAE損失函數，尤其是使用變分推理的統計技術（因此稱為“變分”自編碼器）</li></ul><p>總而言之，在過去的幾年中，GAN獲得的關注遠超過VAE。除其他原因外，與GAN對抗訓練的簡潔概念相比，VAE的理論基礎（概率模型和變分推論）的複雜程度較高。希望我們能像今年早些時候為GAN所做的那樣，通過本篇文章分享寶貴的直覺和強大的理論基礎，以使VAE更易於新人使用。</p><h3 class=pgc-h-arrow-right>參考資料</h3><p>[1]</p><p>KL散度: https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence</p><p>[2]</p><p>貝葉斯推理問題: https://towardsdatascience.com/bayesian-inference-problem-mcmc-and-variational-inference-25a8aa9bce29</p><p>[3]</p><p>變分推理文章: https://towardsdatascience.com/bayesian-inference-problem-mcmc-and-variational-inference-25a8aa9bce29</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>萬字長</a></li><li><a>文帶</a></li><li><a>瞭解</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/4ed442e.html alt="萬字長文帶你入門 GCN" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RqSgmP9HojtMNK style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4ed442e.html title="萬字長文帶你入門 GCN">萬字長文帶你入門 GCN</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5010a4b6.html alt=兩分鐘瞭解低損耗電纜結構 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9af84f52bbed4ee39f3825e0f43e619b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5010a4b6.html title=兩分鐘瞭解低損耗電纜結構>兩分鐘瞭解低損耗電纜結構</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cae5a51a.html alt=「施工技巧」詳細瞭解光纜、終端盒、尾纖的接法和光纖各種接口 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/decf8edb02a34404b92b86681378575f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cae5a51a.html title=「施工技巧」詳細瞭解光纜、終端盒、尾纖的接法和光纖各種接口>「施工技巧」詳細瞭解光纜、終端盒、尾纖的接法和光纖各種接口</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/47bcd6a6.html alt=詳細瞭解光纜、終端盒、尾纖的接法和光纖各種接口 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/dcdae811e636496d948cf5a745f470fc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/47bcd6a6.html title=詳細瞭解光纜、終端盒、尾纖的接法和光纖各種接口>詳細瞭解光纜、終端盒、尾纖的接法和光纖各種接口</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8aab963e.html alt=Python手繪圖瞭解一下！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/746c9e6e214b48b2a0215fc9e151cdc8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8aab963e.html title=Python手繪圖瞭解一下！>Python手繪圖瞭解一下！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c90e11f6.html alt=「瞭解」房屋的層高和淨高怎麼算？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1526054178152a496189726 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c90e11f6.html title=「瞭解」房屋的層高和淨高怎麼算？>「瞭解」房屋的層高和淨高怎麼算？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/17eee2b1.html alt="小蜜團隊萬字長文 | 講透對話管理模型最新研究進展" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/249d781057744bdcb94e007250ac41bc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/17eee2b1.html title="小蜜團隊萬字長文 | 講透對話管理模型最新研究進展">小蜜團隊萬字長文 | 講透對話管理模型最新研究進展</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2db74f7c.html alt=瞭解鍋爐循環泵與換熱站循環泵的佈置 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1533630871099dca28f1fe7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2db74f7c.html title=瞭解鍋爐循環泵與換熱站循環泵的佈置>瞭解鍋爐循環泵與換熱站循環泵的佈置</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/090306a0.html alt="[Spring] 深入瞭解事務原理" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/a8c6dbd7c51741f5a76262e8e2c7a670 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/090306a0.html title="[Spring] 深入瞭解事務原理">[Spring] 深入瞭解事務原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5b46ca88.html alt=做跨境電商站外推廣，你必須瞭解的Facebook像素 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/2df772dcb2d747f8b55ff9e4610cbcad style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5b46ca88.html title=做跨境電商站外推廣，你必須瞭解的Facebook像素>做跨境電商站外推廣，你必須瞭解的Facebook像素</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ed10eec0.html alt=瞭解了“屍填巨港之岸，血滿長城之窟”，還覺得宋代窩囊嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/79d0cee860504ee48c8e419052ceab23 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ed10eec0.html title=瞭解了“屍填巨港之岸，血滿長城之窟”，還覺得宋代窩囊嗎？>瞭解了“屍填巨港之岸，血滿長城之窟”，還覺得宋代窩囊嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1fe1c2dd.html alt=瞭解生成對抗網絡（GAN） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/634604de44ad4d17931ccc0bcf3e46ef style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1fe1c2dd.html title=瞭解生成對抗網絡（GAN）>瞭解生成對抗網絡（GAN）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c2f3b02a.html alt=牆繪知識來了，帶你一分鐘瞭解丙烯顏料 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f33c910d91a847bdb6baabc3ab01e0cd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c2f3b02a.html title=牆繪知識來了，帶你一分鐘瞭解丙烯顏料>牆繪知識來了，帶你一分鐘瞭解丙烯顏料</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6114a4bb.html alt=格鬥周：帶你瞭解各類格鬥術 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/46b75604edfa491990901ac982573db9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6114a4bb.html title=格鬥周：帶你瞭解各類格鬥術>格鬥周：帶你瞭解各類格鬥術</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/444cae24.html alt=瞭解房屋建築圈樑 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/154043230417821ced6ef46 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/444cae24.html title=瞭解房屋建築圈樑>瞭解房屋建築圈樑</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>