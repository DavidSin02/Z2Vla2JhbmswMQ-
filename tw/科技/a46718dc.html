<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>智能小車34：arduino與arm的彙編程序開發 | 极客快訊</title><meta property="og:title" content="智能小車34：arduino與arm的彙編程序開發 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/3c7c0001bd0a8ff81358"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a46718dc.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a46718dc.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a46718dc.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a46718dc.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a46718dc.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a46718dc.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a46718dc.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a46718dc.html><meta property="article:published_time" content="2020-11-14T21:04:32+08:00"><meta property="article:modified_time" content="2020-11-14T21:04:32+08:00"><meta name=Keywords content><meta name=description content="智能小車34：arduino與arm的彙編程序開發"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/a46718dc.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>智能小車34：arduino與arm的彙編程序開發</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>為了解底層技術，一直就想學習下彙編程序。但以前學習的都是理論，沒有在真實環境實踐過，時間長了就忘了。目前手頭有arduino uno板子與arm 2440板子，分別在這兩種平臺寫了段彙編程序，來理一理真實板子開發彙編程序的流程。</p><p><strong>一、Arduino彙編程序開發。</strong></p><p><strong>1.安裝和打開Atmel Studio 7.0</strong></p><p><strong>2.新建項目【File-New Project】,選擇項目類型為Assembler(彙編)</strong>,如下圖：</p><p><img alt=智能小車34：arduino與arm的彙編程序開發 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/3c7c0001bd0a8ff81358></p><p><strong>3.選擇設備類型,arduino unor3對應的mcu為ATmega328p,所以選這個類型。</strong>如下圖：</p><p><img alt=智能小車34：arduino與arm的彙編程序開發 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/3c7d0001b0a9ffecbe19></p><p><strong>4.在打開的main.asm中粘入以下彙編代碼</strong>:</p><p>start:// NOP</p><p>LDI R16, 0xff; LoaD Immediate</p><p>OUT PORTB, R16; PORTB=0xFF</p><p>LDI R17,1&lt; OUT DDRB,R17; DDRB: Data Direction Register. DDRB5=1,Configure the PORTB.5 as OUTPUT</p><p>OUTPUT: SBI PINB,5; one instrction to toggle the PORTB.5(13 on arduino)</p><p>// delay loop about 0.5s</p><p>LDI R19,0xE0</p><p>DELAY0: LDI R16, 0x00</p><p>DELAY1: LDI R18, 0x00</p><p>DELAY2: INC R18</p><p>BRNE delay2; BRanch if Not Equal</p><p>INC R16</p><p>BRNE delay1</p><p>INC R19</p><p>BRNE delay0</p><p>BREAK</p><p>RJMP output</p><p>//這裡的代碼先不去研究了，它的功能是讓13號引腳的led燈每隔0.5秒閃一下。原理大概就是寄存器操作，然後delay,循環。</p><p><strong>5.配置為Release,選擇【Build->Build Solution】編譯代碼。</strong></p><p>這時編譯後的目標文件在圖1中選擇的目錄下，文件名為AssemblerTest.hex。</p><p><strong>6.在arduino官方ide中打開日誌可以查看到它的上傳avrdude命令。</strong></p><p>我們把這個命令中的文件名替換為第5步的文件名，執行一下就可以上傳了。我的電腦代碼如下：</p><p>cd D:\Program Files (x86)\Arduino\hardware\tools\avr\bin</p><p>avrdude -CE:/workspace/arduino/avrdude.conf -v -patmega328p -carduino -PCOM3 -b115200 -D -Uflash:w:E:/workspace/arduino/AssemblerTest.hex:i</p><p>最後的效果：</p><p><img alt=智能小車34：arduino與arm的彙編程序開發 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/3c7d0001b0aa1bfac62b></p><p>因為拍照的瞬間閃的燈滅了，所以圖裡13號引腳對應的燈沒有亮。<strong>二、asm彙編程序開發</strong></p><p><strong>1.在記事本中鍵入以下代碼</strong>:</p><p>.text</p><p>.global _start</p><p>_start:</p><p>LDR R0,=0x56000050 @ R0設為GPFCON寄存器。此寄存器</p><p>@ 用於選擇端口B各引腳的功能：</p><p>@ 是輸出、是輸入、還是其他</p><p>MOV R1,#0x00000100</p><p>STR R1,[R0] @ 設置GPF4為輸出口, 位[8:7]=0b01</p><p>LDR R0,=0x56000054 @ R0設為GPBDAT寄存器。此寄存器</p><p>@ 用於讀/寫端口B各引腳的數據</p><p>MOV R1,#0x00000000 @ 此值改為0x00000010,</p><p>@ 可讓LED1熄滅</p><p>STR R1,[R0] @ GPF4輸出0，LED1點亮</p><p>MAIN_LOOP:</p><p>B MAIN_LOOP</p><p>@這個代碼的功能是點亮一個led燈，GPF4為輸出引腳</p><p>@文件名為led_on.S</p><p><strong>2.在記事本中編寫如下Makefile文件</strong></p><p>led_on.bin : led_on.S</p><p>arm-linux-gcc -g -c -o led_on.o led_on.S</p><p>arm-linux-ld -Ttext 0x0000000 -g led_on.o -o led_on_elf</p><p>arm-linux-objcopy -O binary -S led_on_elf led_on.bin</p><p>clean:</p><p>rm -f led_on.bin led_on_elf *.o</p><p>//要能執行上面的命令，先安裝下arm-linux-gcc，我安裝的軟件包是arm-linux-gcc-3.4.5-glibc-2.3.6.tar.bz2，這個解壓設置下/etc/profile,最後source一下就行</p><p><strong>3.上傳上面兩個文件到linux ，執行make命令。</strong></p><p>執行後會發現led_on.bin文件,把這個文件下載到windows,準備燒錄。</p><p><strong>4.在windows上執行oflash.exe</strong></p><p>在執行前需安裝openJtag的驅動，我用的是OpenOCD with GUI setup.exe</p><p>根據oflash的提示選擇0(openJTAG)->1(2440)->0(nand flash)->led_on.bin(文件名)->0(nand flash)->0(0地址寫入）。</p><p>燒寫完成後重啟板子就可以看到一個led燈一直常亮。</p><p>我的板子上有三個燈，可以通過查看原理圖查到燈與2440的引腳，再從2440的數據手冊(dataSheet)中找到這個引腳的地址，修改上面代碼裡的地址，就可以換燈了。</p><p>最後的效果：</p><p><img alt=智能小車34：arduino與arm的彙編程序開發 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/3c7f000178875f6105bc></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>小車</a></li><li><a>34</a></li><li><a>arduino</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/78fffbda.html alt=arduino傳感器專輯之熱敏電阻溫度傳感器模塊 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d3fa49b2e3184f6f9fdaa73dddca92be style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/78fffbda.html title=arduino傳感器專輯之熱敏電阻溫度傳感器模塊>arduino傳感器專輯之熱敏電阻溫度傳感器模塊</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2e3f219e.html alt=34張流程圖全面瞭解鋼材生產全流程！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ROAx2E98Lkh6SE style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2e3f219e.html title=34張流程圖全面瞭解鋼材生產全流程！>34張流程圖全面瞭解鋼材生產全流程！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f56c3883.html alt="為“夢想”而燃燒——第34期全國“二星夢想培訓”上海站 （二）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/e030cb654be0481593e1b10e36b72845 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f56c3883.html title="為“夢想”而燃燒——第34期全國“二星夢想培訓”上海站 （二）">為“夢想”而燃燒——第34期全國“二星夢想培訓”上海站 （二）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/34e68c10.html alt=PLC控制小車上下左右移動 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/66b00002eb470af97744 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/34e68c10.html title=PLC控制小車上下左右移動>PLC控制小車上下左右移動</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bff47e21.html alt=34人追責！漢中“7.18”架橋機事故調查報告出爐！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/36eb7523feae484699eaf0425f4ce568 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bff47e21.html title=34人追責！漢中“7.18”架橋機事故調查報告出爐！>34人追責！漢中“7.18”架橋機事故調查報告出爐！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7e143e66.html alt=超全！圖解34種採礦方法（值得收藏） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3a14555f4c9a415a8ff0e897b1aeb909 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7e143e66.html title=超全！圖解34種採礦方法（值得收藏）>超全！圖解34種採礦方法（值得收藏）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0ecb9062.html alt=液壓開卷機升降小車 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/37e100019f271175762e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0ecb9062.html title=液壓開卷機升降小車>液壓開卷機升降小車</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/566fa5a7.html alt=液壓開卷機升降小車廠家直銷 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/37d800045a810c6cfadd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/566fa5a7.html title=液壓開卷機升降小車廠家直銷>液壓開卷機升降小車廠家直銷</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6b6c783e.html alt="34年後，骨科醫生再看「 切爾諾貝利 」事件" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/c5a386ea00e042a0aaee7e519c58d6c9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6b6c783e.html title="34年後，骨科醫生再看「 切爾諾貝利 」事件">34年後，骨科醫生再看「 切爾諾貝利 」事件</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/71531a6c.html alt=小車油燈報警繼續開，熄火駕駛員隧道內揮手求油 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/71531a6c.html title=小車油燈報警繼續開，熄火駕駛員隧道內揮手求油>小車油燈報警繼續開，熄火駕駛員隧道內揮手求油</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/94e2b79b.html alt=通過8工位小車呼叫實例，教你快速掌握數據類型，你學會了麼 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7d83bc34439c4a4eb9b66f49bf3ee698 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/94e2b79b.html title=通過8工位小車呼叫實例，教你快速掌握數據類型，你學會了麼>通過8工位小車呼叫實例，教你快速掌握數據類型，你學會了麼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a869feef.html alt=裝修效果圖丨34組玄關門廳過道效果圖，各有各的風采！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/15393148023638f4d6d78ef style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a869feef.html title=裝修效果圖丨34組玄關門廳過道效果圖，各有各的風采！>裝修效果圖丨34組玄關門廳過道效果圖，各有各的風采！</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/cf451d6f.html alt=菏澤34宗土地掛牌出讓！附位置、用途... class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f050c7f758f144c4a1910e952b100314 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/cf451d6f.html title=菏澤34宗土地掛牌出讓！附位置、用途...>菏澤34宗土地掛牌出讓！附位置、用途...</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/9fd04781.html alt=34種常見炎症的聯合用藥，內附炎症類型與原因，說的很詳細 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/f59de3b9-9830-403c-80ee-4c8127db72cd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/9fd04781.html title=34種常見炎症的聯合用藥，內附炎症類型與原因，說的很詳細>34種常見炎症的聯合用藥，內附炎症類型與原因，說的很詳細</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/6c040a8e.html alt=34人自願認罪認罰，常文傑等涉黑案公開庭審 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/7f75d911bd684cbf8edb26f9e38153d7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/6c040a8e.html title=34人自願認罪認罰，常文傑等涉黑案公開庭審>34人自願認罪認罰，常文傑等涉黑案公開庭審</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>