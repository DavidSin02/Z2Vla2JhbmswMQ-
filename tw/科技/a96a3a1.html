<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 | 极客快訊</title><meta property="og:title" content="嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/a9f8dacb3f5c4b27becd312c01203d69"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a96a3a1.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a96a3a1.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a96a3a1.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a96a3a1.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a96a3a1.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a96a3a1.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a96a3a1.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a96a3a1.html><meta property="article:published_time" content="2020-10-29T21:05:41+08:00"><meta property="article:modified_time" content="2020-10-29T21:05:41+08:00"><meta name=Keywords content><meta name=description content="嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/a96a3a1.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>本文主要給大家分享網絡七層概念之鏈路層，後續章節會跟大家講述物理層、</p><p>傳輸層、應用層等，歡迎學習嵌入式網絡編程的朋友關注、轉載和發表評論！</p><p>（絕對的好文，建議先收藏和轉載！）</p><p><strong>本文的主要內容為：</strong></p><p><strong>鏈路層提供的服務</strong></p><p><strong>鏈路層子層</strong></p><p><strong>網絡適配器</strong></p><p><strong>曼徹斯特編碼</strong></p><p><strong>LAN 地址和 ARP</strong></p><p><strong>mac 地址</strong></p><p><strong>ARP 地址解析協議</strong></p><p><strong>術語</strong></p><p><strong>以太網</strong></p><p><strong>以太網基礎</strong></p><p><strong>以太網分類和發展</strong></p><p><strong>WLAN(無線局域網)</strong></p><p><strong>集線器、網橋和交換機</strong></p><p><strong>集線器</strong></p><p><strong>網橋</strong></p><p><strong>交換機</strong></p><p><strong>PPP（Point-to-Point Protocol）點到點協議</strong></p><p>鏈路層協議用來在單段鏈路上傳輸分組。鏈路層協議定義了在鏈路兩端的主機之間交互的分組格式</p><p>（PDU），以及當發送和接受分組時這些節點採取的動作。鏈路層協議交換的數據單元為幀frame），每個鏈路層幀通常封裝了一個網絡層的數據報。</p><p>當發送和接收幀時，鏈路層協議所採取的動作包括差錯檢測、重傳、流量控制和隨機訪問。鏈路層 協議包括以太網、802.11WLAN、令牌環和 PPP；在很多場合下 ATM 也視作鏈路層協議。</p><p>網絡層的任務是端到端的將袁術層報文段從源主機傳送到目的主機，而鏈路層協議的任務是節點到 節點的將網絡層的數據報傳送通過路徑中的單段鏈路。鏈路層的一個重要特點是數據報在路徑的不同鏈 路上可能由不同鏈路層協議處理。例如：數據報在第一段鏈路上可能由以太網處理，在最後一段鏈路上 可能由 PPP 處理，在中間的所有鏈路上有幀中繼處理。不同的鏈路層協議提供的服務可能是不同的。例如：鏈路層協議可能提供、也可能不提供可靠的交付。因此網絡層必須能夠在各段鏈路層提供異構服務 的情況下，完成端到端的工作。</p><p><strong>4.1.1 鏈路層提供的服務</strong></p><p><strong>TCP/IP 協議族中鏈路層的作用主要有 3 個：</strong></p><p><strong>1. 為 IP 模塊發送和接收 IP 數據幀；</strong></p><p><strong>2. 為 ARP 模塊發送請求和接收應答；</strong></p><p><strong>3. 為安全准入模塊發送和接收控制信息。而鏈路層協議提供的服務包括</strong>：</p><p>· <strong>成幀</strong>：所有的鏈路層協議都在網絡層數據報傳送到鏈路上之前，用鏈路層幀將其封裝。幀 由一個數據字段和若干首部字段組成，網絡層數據報就插在數據字段中。（幀可能也包括尾部字段；然而我們把首部字段和尾部字段合併成為首部字段。）該幀的結構由數據鏈路協議規定。</p><p>· <strong>鏈路訪問</strong>：媒體訪問控制（MAC）協議定義了幀在鏈路上傳輸的規則。對於一端只有一個發送方、另一端只有一個接收方的點對點鏈路，MAC 協議比較簡單（或者不存在），即任何時候只要鏈路空閒，發送方都能夠發送幀。更有趣的情況是多個節點共享一個廣播鏈路， 即所謂的多路訪問問題。</p><p>· <strong>可靠傳輸</strong>：當鏈路層協議提供可靠的傳輸服務時，它保證將每個網絡層的數據報無差錯地通過鏈路層。和運輸層可靠的數據傳輸服務（TCP）類似，鏈路層可靠的傳輸服務是通過確認和重傳來獲得。</p><p>· <strong>流量控制</strong>：流量控制用於防止在端口阻塞的情況下丟幀，這種方法是當發送或接收緩衝區開始溢出時通過將阻塞信號發送回源地址實現的。流量控制可以有效的防止由於網 絡中瞬間的大量數據對網絡帶來的衝擊，保證用戶網絡高效而穩定的運行。</p><p>· <strong>差錯檢測</strong>：當幀中的一個比特作為 1 傳輸時，接收方節點可能錯誤地判斷為零，反之亦然。這種比特差錯是由信號衰減和電磁干擾噪聲導致的。因為轉發有差錯的數據報是沒有意義的，許多鏈路層協議提供一種機制以檢測是否存在一個或多個差錯。這是通過發送節點在幀中設置差錯檢測比特，讓接收方節點進行差錯檢測來實現的。</p><p>· <strong>差錯糾正</strong>：差錯糾正和差錯檢測類似，區別在於接收方不僅能檢測是否幀中引入了差錯， 而且能夠準確地判斷幀中的差錯出現在哪。</p><p>· <strong>半雙工與全雙工</strong>：採用全雙工傳輸時，鏈路兩端的節點可以同時傳輸分組。採用半雙工傳輸時，節點不能同時傳輸和接收。</p><h1>4.1.2 鏈路層子層</h1><p>IEEE802 系列標準把數據鏈路層分成 LLC（Logical Link Control，邏輯鏈路控制）和 MAC（Media Access Control，媒介接入控制）兩個子層。LLC 子層在 IEEE802.2 標準中定義，為 802 標準系列共用； 而 MAC 子層協議則依賴於各自的物理層。IEEE802.15.4 的 MAC 層能支持多種 LLC 標準，通過 SSCS（Service-Specific Convergence Sublayer，業務相關的會聚子層）協議承載 IEEE802.2 類型一的 LLC 標準，同時也允許其他 LLC 標準直接使用 IEEE802.15.4 的 MAC 層的服務。</p><p><strong>劃分 LLC 與 MAC 子層原因</strong>：</p><p>· 局域網基本上採用共享介質環境，從而數據鏈路層必須考慮介質訪問控制機制；</p><p>· 介質訪問控制機制與物理介質、物理設備和物理拓撲等涉及硬件實現的部分直接有關；</p><p>· 分為兩個子層，可保證層服務的透明性，在形式上保持與 OSI 模型的一致性。</p><p>· 使整個體系結構的可擴展性更好，以備將來接受新的介質與介質訪問控制方法。</p><h1>· LLC 邏輯鏈路控制子層</h1><p>LLC 子層在 IEEE802.2 標準中定義，為 802 標準系列共用；而 MAC 子層協議則依賴於各自的物理層。IEEE802.15.4 的 MAC 層能支持多種 LLC 標準，通過 SSCS（Service-Specific Convergence</p><p>Sublayer，業務相關的會聚子層）協議承載 IEEE802.2 類型一的 LLC 標準，同時也允許其他 LLC 標準直接使用 IEEE802.15.4 的 MAC 層的服務。</p><p>數據鏈路層的 LLC 子層用於設備間單個連接的錯誤控制，流量控制,數據報的分段與重組，數據報的順序傳輸。</p><p>與 MAC 層不同，LLC 和物理媒介全無關係。媒介是 CSMA/CD 的 802.3 還是 802.5 的令牌環都沒關係。它在 LAN 中是獨立的 802.2。在 LLC 之上的網絡層可以是無連接、響應的無連接或面向連接的不同業務。</p><p>LLC 用業務接入點 SAP 訪問上層協議，有了 SAP，站點就能在 LLC 層只用一個接口同時與幾個高層協議玩。一個 SAP 是簡單的地址或協議 ID，內容則為空的 LLC 幀。LLC 協議數據單元(LLCPDU)即 LPDU。它包括：DSAP(目的 SAP)/SSAP(源 SAP);一個定義吞吐量優先級的控制域(Controlfield);和含帶數據的信息域。在接收方，DSAP 例如協議 ID 就是消息要被遞送的，通常 DSAP 和 SSAP 是一樣的，因為兩端只有在同種協議間才能通信。例如當 SAP 為 AA，代表 SNAP(子層接入協議)。SNAP 是個非標準化的，或廠商特定的協議，用於接入協議的業務。例如當 SAP 為 06，則代表 IP 協議；當 SAP 為 FO，代表 NetBIOS(網絡基本輸入/輸出協議)。SAP 為 FF 表示廣播的 Global 協議。</p><h1>· MAC 介質訪問控制子層</h1><p>MAC 主要負責控制與連接物理層的物理介質。在發送數據的時候，MAC 協議可以事先判斷是否可以發送數據，如果可以發送將給數據加上一些控制信息，最終將數據以及控制信息以規定的格式發送 到物理層；在接收數據的時候，MAC 協議首先判斷輸入的信息並是否發生傳輸錯誤，如果沒有錯誤，則去掉控制信息發送至 LLC（邏輯鏈路控制）層。</p><p>不管是在傳統的有線局域網（LAN）中還是在目前流行的無線局域網（WLAN）中，MAC 協議都被廣泛地應用。在傳統局域網中，各種傳輸介質的物理層對應到相應的 MAC 層，目前普遍使用的網絡採用的是 IEEE 802.3 的 MAC 層標準，採用 CSMA/CD 訪問控制方式；而在無線局域網中，MAC 所對應的標準為IEEE 802.11，其工作方式採用 DCF（分佈控制）和 PCF（中心控制）。</p><p>CDMA2000 一 1x 系統中引入 MAC 子層是為了實現在空中接口容量範圍內，允許話音、電路型數據和分組型數據業務的組合且同時傳送。在 MAC 子層還採用了 QoS 機制來平衡併發的多個服務的不同 QoS 要求。MAC 子層必須按照物理層信道的定時要求，及時地向物理層中特定信道發送數據或從那裡接收數據。在 CDMA20000—1 x 中，MAC 子層承擔如下兩個重要功能， (1)"盡力發送(Best EffortDelivery)"由無線鏈路協議(RLP)"盡力而為"地保證傳輸的可靠性，在無線鏈路上實現適度的可靠傳輸。 (2)複用(Mux)和 QoS 控制：通過協滴由多業務產生的、有衝突的發送業務到物理信道的請求，以及為接人請求安排合適的優先級．來確保實施事先阱商好的 QoS 級別。 MAC 子層還要完成具體的邏輯信道到物理信道的映射，儘管這個映射可能在 MAC 子層以上的層中已經定義了，但最終的轉換過程是在 MAC 子層和物理層之間發雉的。 由圖 6～4 可知，MAC 子層包含 3 個主要部分：信令無線突發協議(sRBP)、無線鏈路協議(RLP)以及複用及 QoS 單元。其 SRBP 和 RLP 分刖完成信令信息和業務信息的"盡力傳送"功能， 保證信令和業務的傳送；複用及 QoS 單元實現將上層數據映射到物理層，以及將物理層收到的數據轉發到相應的上層。 1 SRBP SRBP 用於將短數據突發以及信令提交給複用單元，它在 MAC 子層中是一個刑信令消息提供無連接協議的實體。它與複用單元中公共信道(前向同步信道、尋呼信道、前向公共控制信道、反向接人信道等)的操作相關聯，並控制隨機接人信道的接人過程。</p><h1>4.1.3 網絡適配器定義</h1><p>將計算機、工作站、服務器等設備連接到網絡上的通信接口裝置。在很多情況下，它是一個單獨的網絡接口卡(NIC)，即"網卡"。</p><p>網絡適配器又稱網卡或網絡接口卡（NIC），英文名 NetworkInterfaceCard。網絡適配器的內核是鏈路層控制器，該控制器通常是實現了許多鏈路層服務的單個特定目的的芯片，這些服務包括成幀，鏈 路接入，流量控制，差錯檢測等。網絡適配器是使計算機聯網的設備，平常所說的網卡就是將 PC 機和</p><p>LAN 連接的網絡適配器。網卡（NIC） 插在計算機主板插槽中，負責將用戶要傳遞的數據轉換為網絡上其它設備能夠識別的格式，通過網絡介質傳輸。它的主要技術參數為帶寬、總線方式、電氣接口方式等。</p><h1>網絡類型：</h1><p>現在比較流行的有以太網，令牌環網，FDDI 網等，選擇時應根據網絡的類型來選擇相對應的網卡。</p><p><strong>傳輸速率：</strong></p><p>應根據服務器或工作站的帶寬需求並結合物理傳輸介質所能提供的最大傳輸速率來選擇網卡的傳輸速率。以以太網為例，可選擇的速率就有 10Mbps，10/100Mbps，1000Mbps，甚至 10Gbps 等多種，但不是速率越高就越合適。</p><h1>總線類型：</h1><p>計算機中常見的總線插槽類型有：ISA、EISA、VESA、PCI 和 PCMCIA 等。在服務器上通常使用 PCI 或 EISA 總線的智能型網卡，工作站則採用可用 PCI 或 ISA 總線的普通網卡，在筆記本電腦則用 PCMCIA 總線的網卡或採用並行接口的便攜式網卡。</p><h1>網卡支持的電纜接口：</h1><p>網卡最終是要與網絡進行連接，所以也就必須有一個接口使網線通過它與其它計算機網絡設備連接 起來。不同的網絡接口適用於不同的網絡類型，目前常見的接口主要有以太網的 RJ-45 接口、細同軸電纜的 BNC 接口和粗同軸電 AUI 接口、FDDI 接口、ATM 接口等。</p><p>（1） RJ-45 接口：這是最為常見的一種網卡，也是應用最廣的一種接口類型網卡，這主要得益於雙絞線以太網應用的普及。</p><p>（2） AUI 接口：這種接口類型的網卡對應用於以粗同軸電纜為傳輸介質的以太網或令牌網中，這種接口類型的網卡目前更是很少見。</p><p>（3） FDDI 接口：這種接口的網卡是適應於 FDDI（光纖分佈數據接口）網絡中，這種網絡具有100Mbps的帶寬，但它所使用的傳輸介質是光纖。</p><p>（4） BNC 接口：這種接口網卡對應用於用細同軸電纜為傳輸介質的以太網或令牌網中，目前這種接口類型的網卡較少見，主要因為用細同軸電纜作為傳輸介質的網絡就比較少。</p><p>（5） ATM 接口：這種接口類型的網卡是應用於 ATM（異步傳輸模式）光纖（或雙絞線）網絡中。它能提供物理的傳輸速度達 155Mbps</p><p><strong>網絡適配器的主要作用</strong></p><p>1 它是主機與介質的橋樑設備</p><p>2 實現主機與介質之間的電信號匹配</p><p>3 提供數據緩衝能力</p><p>4 控制數據傳送的功能（網卡一方面負責接收網絡上傳過來的數據包，解包後，將數據通過上的總 線傳輸給本地計算機；另一方面它將本地計算機上的數據打包後送入網絡。）</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a9f8dacb3f5c4b27becd312c01203d69><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>圖 4-1 網絡適配器</p><p>如上圖所示，適配器的主要部分是總線接口和鏈路接口。總線接口負責和適配器父節點通信。它在適配器和父節點之間傳輸數據和控制信息。鏈路接口負責實現鏈路層協議。除了將數據報形成幀和接收電路。對於常用的鏈路層技術（例如以太網）鏈路接口使用能夠在是芯片市場上買到的芯片組來實現。</p><h1>4.1.4 曼徹斯特編碼</h1><p>曼徹斯特編碼（Manchester Encoding），也叫做相位編碼(PE)，是一個同步時鐘編碼技術，<strong>被物理層使用來編碼一個同步位流的時鐘和數據。</strong>曼徹斯特編碼被用在以太網媒介系統中。曼徹斯特編碼提供一個簡單的方式給編碼簡單的二進制序列而沒有長的週期沒有轉換級別，因而防止時鐘同步的丟失，或來自低頻率位移在貧乏補償的模擬鏈接位錯誤。在這個技術下，實際上的二進制數據被傳輸通過這個電纜，不是作為一個序列的邏輯 1 或 0 來發送的（技術上叫做反向不歸零制(NRZ)）。</p><p>相反地，這些位被轉換為一個稍微不同的格式，它通過使用直接的二進制編碼有很多的優點。曼徹斯特編碼，常用於局域網傳輸。在曼徹斯特編碼中，每一位的中間有一跳變，位中間的跳變既作時鐘信號，又作數據信號；從低到高跳變表示"1"，從高到低跳變表示"0"。還有一種是差分曼徹斯特編碼，每位中間的跳變僅提供時鐘定時，而用每位開始時有無跳變表示"0"或"1"，有跳變為"0"，無跳變為"1"。</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/294625758cc7460a8631abefbe1f6f76><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>圖 4-2 曼徹斯特編碼</p><h1>4.2 LAN 地址和 ARP</h1><p><br></p><p>網卡雖然有很多種，不過，有一點是一致的，那就是每塊網卡都有一個世界惟一的 ID 號，也叫做MAC（Media Access Control）地址。MAC 地址被燒錄於網卡的 ROM 中，就像是我們每個人的遺傳基因密碼 DNA 一樣，即使在全世界也絕對不會重複。MAC 地址用於在網絡中標識電腦的身份，實現網絡中不同電腦之間的通信和信息交換。</p><h1>4.2.1 mac 地址</h1><p><br></p><p>在局域網中，硬件地址又稱為物理地址，或 MAC 地址。 802 標準所說的"地址"嚴格地講應當是每一個站的"名字"或標識符。 但鑑於大家都早已習慣了將這種 48 位的"名字"稱為"地址"，所以本書也採用這種習慣用法，儘管這種說法並不太嚴格。</p><p>IEEE 的註冊管理機構 RA（Registration Authority ） 負責向廠家分配地址字段的前三個字節(即高位 24 位)。地址字段中的後三個字節(即低位 24 位)由廠家自行指派，稱為擴展標識符， 必須保證生產出的適配器沒有重複地址。一個地址塊可以生成 224 個不同的地址。這種 48 位地址稱為 MAC-48，它的通用名稱是 EUI-48。"MAC 地址"實際上就是適配器地址或適配器標識符EUI-48。</p><p>MAC 地址字段可以採用兩種形式之一：6B 全球範圍，2B 單位範圍</p><p>· 地址塊：地址字段的前 3 個字節（高 24 位）由 IEEE 統一分配給廠商，低 24 位由廠商分配</p><p>· 地址類型標識：地址字段的第一字節的最低位 I/G 0 -- 單個站地址； 1 -- 組地址</p><p>· 地址範圍標識：地址字段的第一字節的最低第二位 G/L 0 -- 局部管理； 1 -- 全局管理</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c867ef93c6b34205bd1ebd93f114315b><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>圖 4-3 mac 地址</p><p>適配器從網絡上每收到一個 MAC 幀就首先用硬件檢查 MAC 幀中的 MAC 地址.</p><p>· 如果是發往本站的幀則收下，然後再進行其他的處理。</p><p>· 否則就將此幀丟棄，不再進行其他的處理。</p><p>"發往本站的幀"包括以下三種幀：</p><p>· 單播(unicast)幀（一對一）</p><p>· 廣播(broadcast)幀（一對全體）</p><p>· 多播(multicast)幀（一對多）</p><p>所有的適配器可識別廣播和單播幀，第一字節的最低位為 I/G 位，I/G=0 是單播，I/G=1 廣播。比如 01-00-5E-A0-B1-C3。IEEE 實際分配 23 位地址。</p><h1>4.2.2 ARP 地址解析協議</h1><p><br></p><p>ARP，即地址解析協議，實現<strong>通過 IP 地址得知其物理地址</strong>。在 TCP/IP 網絡環境下，每個主機都分配了一個 32 位的 IP 地址，這種互聯網地址是在網際範圍標識主機的一種邏輯地址。為了讓報文在物理網路上傳送，必須知道對方目的主機的物理地址。這樣就存在把 IP 地址變換成物理地址的地址轉換問題。以以太網環境為例，為了正確地向目的主機傳送報文，必須把目的主機的 32 位IP 地址轉換成為 48 位以太網的地址。這就需要在互連層有一組服務將 IP 地址轉換為相應物理地址，這組協議就是 ARP 協議。</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/20092fff749c4b7c8218a5ca04408bf9><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>圖 4-4 LAN 內 arp 請求</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7421f0732ae440b08a655f6ee5469100><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>圖 4-5 arp 請求數據包</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c5fe8916acae4edb8da3f7f3c138b452><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>圖 4-6 arp 查詢</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1fa5af527a5c487584fd2a59d1a176bd><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>圖 4-7 ARP 請求</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/cbb71a41f3eb4598aeddeac7a02d48e1><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>圖 4-8 ARP 響應</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/a344e07871d146c19408cdc48a4af4b6><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>圖 4-9 接收方主機不再同一個鏈路</p><h1>基本功能</h1><p><br></p><p>在以太網協議中規定，同一局域網中的一臺主機要和另一臺主機進行直接通信，必須要知道目標主機的 MAC 地址。而在 TCP/IP 協議棧中，網絡層和傳輸層只關心目標主機的 IP 地址。這就導致在以太網中使用 IP 協議時，數據鏈路層的以太網協議接到上層 IP 協議提供的數據中，只包含目的主機的 IP 地址。於是需要一種方法，根據目的主機的 IP 地址，獲得其 MAC 地址。這就是 ARP 協議要做的事情。所謂地址解析（address resolution）就是主機在發送幀前將目標 IP 地址轉換成目標 MAC 地址的過程。</p><p>另外，當發送主機和目的主機不在同一個局域網中時，即便知道目的主機的 MAC 地址，兩者也不能直接通信，必須經過路由轉發才可以。所以此時，發送主機通過 ARP 協議獲得的將不是目的主機的真實 MAC 地址，而是一臺可以通往局域網外的路由器的某個端口的 MAC 地址。於是此後發送主機發往目的主機的所有幀，都將發往該路由器，通過它向外發送。這種情況稱為 ARP 代理（ARP Proxy）。</p><h1>ARP 流程</h1><p>在每檯安裝有 TCP/IP 協議的電腦裡都有一個 ARP 緩存表，表裡的 IP 地址與 MAC 地址是一一對應的。</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/97660194588841f2b64a9af4228d70bd><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>圖 4-10 命令 arp –a</p><p>以主機 A（192.168.1.5）向主機 B（192.168.1.1）發送數據為例。當發送數據時，主機 A 會在自己的 ARP 緩存表中尋找是否有目標 IP 地址。如果找到了，也就知道了目標 MAC 地址，直接把目標 MAC 地址寫入幀裡面發送就可以了；如果在 ARP 緩存表中沒有找到目標 IP 地址，主機 A 就會在網絡上發送一個廣播，A 主機 MAC 地址是"主機 A 的 MAC 地址"，這表示向同一網段內的所有主機發出這樣的詢問："我是 192.168.1.5，我的硬件地址是"主機 A 的 MAC 地址".請問 IP 地址為192.168.1.1 的 MAC 地址是什麼？"網絡上其他主機並不響應 ARP 詢問，只有主機 B 接收到這個幀時，才向主機 A 做出這樣的迴應："192.168.1.1 的 MAC 地址是 00-aa-00-62-c6-09"。這樣，主機 A 就知道了主機 B 的 MAC 地址，它就可以向主機 B 發送信息了。同時 A 和 B 還同時都更新了自己的 ARP 緩存表（因為 A 在詢問的時候把自己的 IP 和 MAC 地址一起告訴了 B），下次 A 再向主機 B 或者 B 向 A 發送信息時，直接從各自的 ARP 緩存表裡查找就可以了。ARP 緩存表採用了老化機制（即設置了生存時間 TTL），在一段時間內（一般 15 到 20 分鐘）如果表中的某一行沒有使用，就會被刪除，這樣可以大大減少 ARP 緩存表的長度，加快查詢速度。</p><h1>RARP 反向地址解析協議</h1><p><br></p><p>反向地址解析協議用於一種特殊情況，如果站點被初始化後，只有自己的物理網絡地址而沒有IP 地址，則它可以通過 RARP 協議，併發出廣播請求，徵求自己的 IP 地址，而 RARP 服務器則負責回答。這樣無 IP 的站點可以通過 RARP 協議取得自己的 IP 地址，這個地址在下一次系統重新開始以前都有效，不用連續廣播請求。RARP 廣泛用於獲取無盤工作站的 IP 地址。</p><h1>4.2.3 術語</h1><p><br></p><p>· 衝突（Collision）：</p><p>· 數據衝突。當衝突發生時，物理網段上的數據都不再有效。</p><p>· 衝突域：</p><p>· 在同一個衝突域中的每一個節點都能收到所有被髮送的幀。 影響衝突產生的因素：</p><p>· 同一衝突域中節點的數量越多</p><p>· 數據分組的長度</p><p>· 網絡的直徑等因素</p><p>•</p><p>解決方案：</p><p>· 衝突影響以太網性能。由於衝突的存在使得傳統的以太網在負載超過 40％時，效率將明顯下降。</p><p>· 使用網橋和交換機將網絡分段，將一個大的衝突域劃分為若干小衝突域。</p><p>•</p><p>· 廣播：</p><p>· 在網絡傳輸中，向所有連通的節點發送消息稱為廣播。</p><p>· 廣播域：</p><p>· 網絡中能接收任何一設備發出的廣播幀的所有設備的集合。</p><p>· 廣播網絡和廣播的區別：</p><p>· 廣播網絡指網絡中所有的節點都可以收到傳輸的數據幀，不管該幀是否是發給這些節點。非目的節點的主機雖然收到該數據幀但不做處理。</p><p>· 廣播是指由廣播幀構成的數據流量，這些廣播幀以廣播地址（地址的每一位都為"1"）為目的地址，告之網絡中所有的計算機接收此幀並處理它。</p><p><strong>4.3 以太網</strong></p><p><strong>4.3.1 以太網基礎</strong></p><p>以太網即 Ethernet 是 Xerox、DigitalEquipment 和 Intel 三家公司開發的局域網組網規範，於 80年代初首次出版，稱為 DIX1.0。1982 年修改後的版本為 DIX2.0。這三家公司將此規範提交給 IEEE(電子電氣工程師協會)802 委員會，經過 IEEE 成員的修改並通過，變成了 IEEE 的正式標準，並編號為IEEE802.3。Ethernet 和 IEEE802.3 雖然有很多規定不同，但術語 Ethernet 通常認為與 802.3 是兼容的。IEEE 將 802.3 標準提交國際標準化組織(ISO)第一聯合技術委員會(JTC1),再次經過修訂變成了國際標準 ISO8802.3。</p><p>以太網。指的是由 Xerox 公司創建並由 Xerox,Intel 和 DEC 公司聯合開發的基帶局域網規範。以太網絡使用 CSMA/CD(載波監聽多路訪問及衝突檢測技術)技術，並以 10M/S 的速率運行在多種類型的電纜上。以太網與 IEEE802·3 系列標準相類似。</p><p>它不是一種具體的網絡，是一種技術規範。</p><p>以太網是當今現有局域網採用的最通用的通信協議標準。該標準定義了在局域網（LAN）中採用的 電纜類型和信號處理方法。以太網在互聯設備之間以 10~100Mbps 的速率傳送信息包，雙絞線電纜</p><p>10BaseT 以太網由於其低成本、高可靠性以及 10Mbps 的速率而成為應用最為廣泛的以太網技術。直擴的無線以太網可達 11Mbps，許多製造供應商提供的產品都能採用通用的軟件協議進行通信，開放性最好。</p><h1>拓撲結構</h1><p><br></p><p>總線型：所需的電纜較少、價格便宜、管理成本高，不易隔離故障點、採用共享的訪問機制，易造 成網絡擁塞。早期以太網多使用總線型的拓撲結構，採用同軸纜作為傳輸介質，連接簡單，通常在小規</p><p>模的網絡中不需要專用的網絡設備，但由於它存在的固有缺陷，已經逐漸被以集線器和交換機為核心的 星型網絡所代替。</p><p>星型：管理方便、容易擴展、需要專用的網絡設備作為網絡的核心節點、需要更多的網線、對核心 設的可靠性要求高。採用專用的網絡設備（如集線器或交換機）作為核心節點，通過雙絞線將局域網中 的各臺主機連接到核心節點上，這就形成了星型結構。星型網絡雖然需要的線纜比總線型多，但佈線和 連接器比總線型的要便宜。此外，星型拓撲可以通過級聯的方式很方便的將網絡擴展到很大的規模，因 此得到了廣泛的應用，被絕大部分的以太網所採用。</p><h1>傳輸介質</h1><p><br></p><p>以太網可以採用多種連接介質，包括同軸纜、雙絞線和光纖等。其中雙絞線多用於從主機到集線器 或交換機的連接，而光纖則主要用於交換機間的級聯和交換機到路由器間的點到點鏈路上。同軸纜作為 早期的主要連接介質已經逐漸趨於淘汰。</p><h1>接口的工作模式</h1><p><br></p><p>以太網卡可以工作在兩種模式下：半雙工和全雙工。</p><p>半雙工：半雙工傳輸模式實現以太網載波監聽多路訪問衝突檢測。傳統的共享 LAN 是在半雙工下工作的，在同一時間只能傳輸單一方向的數據。當兩個方向的數據同時傳輸時，就會產生衝突，這會降低 以太網的效率。</p><p>全雙工：全雙工傳輸是採用點對點連接，這種安排沒有衝突，因為它們使用雙絞線中兩個獨立的線路，這等於沒有安裝新的介質就提高了帶寬。例如在上例的車站間又加了一條並行的鐵軌，同時可有兩列火車雙向通行。在雙全工模式下，衝突檢測電路不可用，因此每個雙全工連接只用一個端口，用於點對點連接。標準以太網的傳輸效率可達到 50％～60％的帶寬，雙全工在兩個方向上都提供 100％的效率。</p><p>以太網採用帶衝突檢測的載波幀聽多路訪問（CSMA/CD）機制。以太網中節點都可以看到在網絡中 發送的所有信息，因此，我們說以太網是一種廣播網絡。以太網的工作過程如下：</p><h1>工作步驟</h1><p><br></p><p>當以太網中的一臺主機要傳輸數據時，它將按如下步驟進行：</p><p>1、幀聽信道上收否有信號在傳輸。如果有的話，表明信道處於忙狀態，就繼續幀聽，直到信道空 閒為止。</p><p>2、若沒有幀聽到任何信號，就傳輸數據</p><p>3、傳輸的時候繼續幀聽，如發現衝突則執行退避算法，隨機等待一段時間後，重新執行步驟 1（當衝突發生時，涉及衝突的計算機會發送一個擁塞序列，以警告所有的節點）</p><p>4、若未發現衝突則發送成功，計算機會返回到幀聽信道狀態。</p><p>注意：每臺計算機一次只允許發送一個包，所有計算機在試圖再一次發送數據之前，必須在最近一 次發送後等待 9.6 微秒（以 10Mbps 運行）。</p><h1>4.3.2 以太網分類和發展</h1><p><br></p><p>現在最常用的以太網技術包括 10Base2（它在總線拓撲中使用細同軸電纜，傳輸速率是 10Mbit/s）、</p><p>10BaseT（它在星形拓撲中使用雙絞銅線，傳輸速率為 10 Mbit/s）、100BaseT（它通常在星形拓撲中使用雙絞銅線，速率為 100 Mbit/s）和吉比特以太網（它同時使用光纖盒雙絞銅線，速率 1Gbit/s）。這些以太網技術由 IEEE802.3 工作組標準化。由於這個原因，以太網 LAN 經常被稱為 802.3 以太網。</p><p>轉發器：也叫做網絡轉發器，是一類重建到來的電子、無線或光學信號的網絡設備。有了物理媒體如以太網或 Wi-Fi ，數據傳輸在信號降級之前僅能跨越一個有限範圍。轉發器嘗試來保護信號的完整性和擴展數據能夠安全傳輸的距離。在網絡互連時用在 ISO 物理層的中繼系統。</p><h1>一、標準以太網</h1><p>開始以太網只有 10Mbps 的吞吐量，使用的是帶有衝突檢測的載波偵聽多路訪問（ CSMA／CD， Carrier Sense Multiple Access/Collision Detection）的訪問控制方法，這種早期的 10Mbps 以太網稱之為標準以太網。以太網可以使用粗同軸電纜、細同軸電纜、非屏蔽雙絞線、屏蔽雙絞線和光纖等多種傳輸介質進行連接，並且在 IEEE 802.3 標準中，為不同的傳輸介質制定了不同的物理層標準， 在這些標準中前面的數字表示傳輸速度， 單位是"Mbps"， 最後的一個數字表示單段網線長度（基準單位是 100m），Base 表示"基帶"的意思， Broad 代表"帶寬"。</p><p>·10Base－5 使用直徑為 0.4 英寸、阻抗為 50Ω粗同軸電纜， 也稱粗纜以太網， 最大網段長度為 500m， 基帶傳輸方法， 拓撲結構為總線型； 10Base－ 5 組網主要硬件設備有： 粗同軸電纜、帶有 AUI 插口的以太網卡、中繼器 、收發器、收發器電纜、終結器等。</p><p>·10Base－2 使用直徑為 0.2 英寸、阻抗為 50Ω細同軸電纜， 也稱細纜以太網，最大網段長度為 185m， 基帶傳輸方法， 拓撲結構為總線型； 10Base－ 2 組網主要硬件設備有： 細同軸電纜、帶有 BNC 插口的以太網卡、中繼器、T 型連接器 、終結器等。</p><p>·10Base－ T 使用雙絞線電纜， 最大網段長度為 100m， 拓撲結構為星型； 10Base－ T 組網主要硬件設備有：3 類或 5 類非屏蔽雙絞線、帶有 RJ-45 插口的以太網卡、集線器、交換機、RJ-45 插頭等。</p><p>· 1Base－ 5 使用雙絞線電纜，最大網段長度為 500m，傳輸速度為 1Mbps；</p><p>·10Broad－ 36 使用同軸電纜（ RG－59／U CATV）， 網絡的最大跨度為 3600m， 網段長度最大為 1800m，是一種寬帶傳輸方式；</p><p>·10Base－F 使用光纖傳輸介質，傳輸速率為 10Mbps；</p><p><strong>二、快速以太網</strong></p><p>隨著網絡的發展，傳統標準的以太網技術已難以滿足日益增長的網絡數據流量速度需求。在</p><p>1993 年 10 月以前，對於要求 10Mbps 以上數據流量的 LAN 應用，只有光纖分佈式數據接口（FDDI） 可供選擇，但它是一種價格非常昂貴的、基於 100Mpbs 光纜的 LAN。1993 年 10 月，Grand Junction公司推出了世界上第一臺快速以太網集線器 Fastch10／100 和網絡接口卡 FastNIC100， 快速以太網技術正式得以應用。隨後 Intel、SynOptics、3COM、BayNetworks 等公司亦相繼推出自己的快速以太網裝置。與此同時，IEEE802 工程組亦對 100Mbps 以太網的各種標準，如 100BASE－TX、100BASE－T4、MII、中繼器、全雙工等標準進行了研究。1995 年 3 月 IEEE 宣佈了 IEEE802.3u100BASE－ T 快速以太網標準（Fast Ethernet），就這樣開始了快速以太網的時代。</p><p>快速以太網與原來在 100Mbps 帶寬下工作的 FDDI 相比它具有許多的優點，最主要體現在快速以太網技術可以有效的保障用戶在佈線基礎實施上的投資， 它支持 3、4、5 類雙絞線以及光纖的連接，能有效的利用現有的設施。 快速以太網的不足其實也是以太網技術的不足，那就是快速以太網仍是基於 CSMA／ CD 技術，當網絡負載較重時，會造成效率的降低，當然這可以使用交換技術來彌補。 100Mbps 快速以太網標準又分為：100BASE－TX 、100BASE－FX、100BASE－T4 三個子類。</p><p>· 100BASE－ TX： 是一種使用 5 類數據級無屏蔽雙絞線或屏蔽雙絞線的快速以太網技術。它使用兩對雙絞線，一對用於發送，一對用於接收數據。在傳輸中使用 4B／5B 編碼方式，信號頻率為 125MHz。符合 EIA586 的 5 類佈線標準和 IBM 的 SPT 1 類佈線標準。使用同 10BASE－T 相同的 RJ－45 連接器。它的最大網段長度為 100 米。它支持全雙工的數據傳輸。</p><p>· 100BASE － FX ： 是一種使用光纜的快速以太網技術， 可使用單模和多模光纖（ 62.5 和</p><p>125um） 多模光纖連接的最大距離為 550 米。單模光纖連接的最大距離為 3000 米。在傳輸中使用 4B／ 5B 編碼方式，信號頻率為 125MHz。它使用 MIC／FDDI 連接器、ST 連接器或 SC 連接器。它的最大網段長度為 150m、412m、2000m 或更長至 10 公里，這與所使用的光纖類型和工作模式有關， 它支持全雙工的數據傳輸。100BASE－FX 特別適合於有電氣干擾的環境、較大距離連接、或高保密環境等情況下的適用。</p><p>· 100BASE－T4：是一種可使用 3、4、5 類無屏蔽雙絞線或屏蔽雙絞線的快速以太網技術。100Base-T4 使用 4 對雙絞線， 其中的三對用於在 33MHz 的頻率上傳輸數據，每一對均工作於半雙工模式。第四對用於 CSMA/CD 衝突檢測。在傳輸中使用 8B／6T 編碼方式，信號頻率為 25MHz， 符合 EIA586 結構化佈線標準。它使用與 10BASE－T 相同的 RJ－45 連接器，最大網段長度為 100 米。</p><h1>三、千兆以太網</h1><p>千兆以太網技術作為最新的高速以太網技術，給用戶帶來了提高核心網絡的有效解決方案， 這種解決方案的最大優點是繼承了傳統以太技術價格便宜的優點。 千兆技術仍然是以太技術， 它採用了與 10M 以太網相同的幀格式、幀結構、網絡協議、全/半雙工工作方式、流控模式以及佈線系統。由於該技術不改變傳統以太網的桌面應用、操作系統，因此可與 10M 或 100M 的以太網很好地配合工作。升級到千兆以太網不必改變網絡應用程序、網管部件和網絡操作系統， 能夠最大程度地投資保護。 為了能夠偵測到 64Bytes 資料框的碰撞，Gigabit Ethernet 所支持的距離更短。Gigabit Ethernet 支持的網絡類型，如下表所示：</p><p>傳輸介質 距離</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/62166c8996f04fb1909f0a293d3ec935><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>千兆以太網技術有兩個標準： IEEE802.3z 和 IEEE802.3ab。IEEE802.3z 制定了光纖和短程銅線連接方案的標準。IEEE802.3ab 制定了五類雙絞線上較長距離連接方案的標準。</p><p><strong>1. IEEE802.3z</strong></p><p>IEEE802.3z 工作組負責制定光纖（單模或多模）和同軸電纜的全雙工鏈路標準。IEEE802.3z 定 義 了 基 於 光 纖 和 短 距 離 銅 纜 的 1000Base-X ， 採 用 8B/10B 編 碼 技 術 ， 信 道 傳 輸 速 度 為</p><p>1.25 Gbit/s，去耦後實現 1000Mbit/s 傳輸速度。 IEEE802.3z 具有下列千兆以太網標準：</p><p>· 1000Base-SX 只支持多模光纖， 可以採用直徑為 62.5um 或 50um 的多模光纖，工作波長為 770-860nm，傳輸距離為 220-550m。</p><p>· 1000Base-LX 多模光纖：可以採用直徑為 62.5um 或 50um 的多模光纖，工作波長範圍為1270-1355nm，傳輸距離為 550m。</p><p>單模光纖： 可以支持直徑為 9um 或 10um 的單模光纖， 工作波長範圍為 1270-1355nm， 傳輸距離為 5km 左右。</p><p>· 1000Base-CX 採用 150 歐屏蔽雙絞線（STP），傳輸距離為 25m。</p><p><strong>2. IEEE802.3ab</strong></p><p>IEEE802.3ab 工作組負責制定基於 UTP 的半雙工鏈路的千兆以太網標準，產生 IEEE802.3ab 標準及協議。IEEE802.3ab 定義基於 5 類 UTP 的 1000Base-T 標準， 其目的是在 5 類 UTP 上以</p><p>1000Mbit/s 速率傳輸 100m。 IEEE802.3ab 標準的意義主要有兩點：</p><p>(1) 保護用戶在 5 類 UTP 佈線系統上的投資。</p><p>(2) 1000Base-T 是 100Base-T 自然擴展， 與 10Base-T、100Base-T 完全兼容。不過， 在 5 類 UTP 上達到 1000Mbit/s 的傳輸速率需要解決 5 類 UTP 的串擾和衰減問題，因此，使 IEEE802.3ab 工作組的開發任務要比 IEEE802.3z 複雜些 。</p><h1>四、萬兆以太網</h1><p>萬兆以太網規範包含在 IEEE 802.3 標準的補充標準 IEEE 802.3ae 中， 它擴展了 IEEE802.3 協議和 MAC 規範使其支持 10Gb/s 的傳輸速率。除此之外，通過 WAN 界面子層（WIS： WAN interface sublayer），10 千兆位以太網也能被調整為較低的傳輸速率， 如 9.584640 Gb/s（ OC-192）， 這就允許 10 千兆位以太網設備與同步光纖網絡（SONET） STS -192c 傳輸格式相兼容。</p><p>· 10GBASE-SR 和 10GBASE-SW 主要支持短波（850 nm）多模光纖（MMF），光纖距離為 2m到 300 m 。</p><p>10GBASE-SR 主要支持"暗光纖"（ dark fiber）， 暗光纖是指沒有光傳播並且不與任何設備連接的光纖。</p><p>10GBASE-SW 主要用於連接 SONET 設備，它應用於遠程數據通信。</p><p>· 10GBASE-LR 和 10GBASE-LW 主要支持長波（1310nm）單模光纖（SMF），光纖距離為 2m到 10km （約 32808 英尺）。</p><p>10GBASE-LW 主要用來連接 SONET 設備時，10GBASE-LR 則用來支持"暗光纖"（ dark fiber）。</p><p>· 10GBASE-ER 和 10GBASE-EW 主要支持超長波（1550nm）單模光纖（SMF），光纖距離為 2m到 40km （約 131233 英尺）。</p><p>10GBASE-EW 主要用來連接 SONET 設備，10GBASE-ER 則用來支持"暗光纖"（ dark fiber）。</p><p>· 10GBASE-LX4 採用波分複用技術， 在單對光纜上以四倍光波長髮送信號。系統運行在1310nm 的多模或單模暗光纖方式下。該系統的設計目標是針對於 2m 到 300 m 的多模光纖模式或 2m 到 10km 的單模光纖模式。</p><h1>4.4 WLAN(無線局域網)</h1><p><br></p><p>WLAN是以太網的無線電介質版本，以太網脫胎於ALOHA（1960年代由美國夏威夷大學主導研究的一 種共享無線網絡技術，ALOHA是夏威夷原住民語Hello的意思），ALOHA就是一種無線技術，所以WLAN和ALOHA也有很深的淵源。WLAN標準化工作開始於1997年，而Richard寫書是在1993年，所以當時他並沒有研究這項技術。WLAN的標準化技術是由IEEE 802.11委員會領導的，通常我們認為WLAN = 802.11 = WiFi， 但最耳熟能詳的是時髦的WiFi，稍微專業一點的知道WLAN，更專業的才知道802.11。</p><p>WLAN的通信介質是同頻無線電（通常被劃分為不同頻段的Channel信道），無線電是在自由空間傳播的，無線電通信具備開放接入的特點，也是一種共享介質模型，因此也存在衝突的可能，WLAN解決多 點通信衝突的解決方法是CSMA/CA（載波監聽、多點接入、衝突避免，Avoidance避免），為何不是CSMA/CD 呢，因為WLAN的無線信號在開放空間內傳輸，信號並不強（大多WLAN設備在開放空間全向覆蓋半徑為100m，特殊情況使用定向天線可達10km），能量容易被金屬等材料吸收，有可能無法覆蓋到空間，載波介質在空間中可能是斷續的，而不是連續的，因而無法保證所有節點都可以互相監聽，而以太網則在專 門的線纜內傳遞，線纜上的節點都能夠進行監聽，如上圖中Infrastructure模式中終端4和終端2因為距 離較遠可能就無法互相監聽，也就檢測不到衝突，因此無線電介質上多點接入的衝突主要是靠事先避免（Avoidance），而非事後檢測（Detection）。在WLAN中，所有節點被稱為station簡稱STA，在ad hoc（此為拉丁語，意為特殊）模式中，所有STA都是對等的，所以也叫Peer to Peer模式；在Infrastructure 模式中，有一個特殊的STA稱為Access Point（無線接入點，簡稱AP），其餘STA都要與AP建立連接，STA 之間的通信都要由AP轉發。兩種模式中，Infrastructure模式更加常見，WLAN在這種模式中也擴展出了極其豐富的應用。總體來說這兩種模式的差別在於轉發上：</p><p>IEEE 802.11委員會針對WLAN所做的標準非常多，有涉及介質層面的802.11a/b/g/n，也有MAC層面的802.11i/e等等，除此之外，無線信號相關的射頻理論知識也有一個非常龐大的體系，可以說比TCP/IP 框架複雜專業得多。限於能力和時間原因，不在本文中專門介紹，讀者可以從已出版的書籍中找到相關 知識。</p><h1>WLAN連接模式。</h1><p><br></p><p><strong>無線局域網的組網方式一：對等網絡，又稱Ad-Hoc方式</strong></p><p>由一組有無線網絡接口的計算機組成。同一Ad-Hoc網絡中的計算機要有相同的工作組名、ESSID 和密碼。配置簡單，在管理和預先設置方面沒有要求。可以實現點對點與點對多點連接。但不能連接外部網絡。適用於用戶數相對較少的網絡規模。以下圖為例，因為信號強弱的緣故，STA1 無法檢測到TA4，只能檢測到STA2，那麼STA1只能與STA2通信，而無法與STA3、4通信，也就是說ad hoc模式中，通信無法中轉；</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f3320636622c442ca2acba35646c810e><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>圖4-11 Ad-hoc方式</p><h1>無線局域網的組網方式二：基礎結構網絡</h1><p>最常見的無線局域網構建模式，又稱Infrastucture方式。以AP為中心，實現對網絡訪問 集中控制。 其弱點是AP成為單故障點；可與有線網絡結合起來使用。</p><p>如下圖中，所有的STA必須連接到AP，STA1、2、3、4皆連接到同一個AP，那麼STA1要和STA4 通信時，即使STA1、STA4因為信號足夠好，STA1也要講數據幀交給AP來轉發，也就是說Infrastructure模式中，所有數據都必須由AP進行中轉，AP就是所謂的Infrastructure（基礎設施）中的一部分，在WLAN中，完整基礎設施的名稱是distributed system分佈式系統，現代的大型無線網絡中，一個DS通常由若干AP以及連接這些AP的有線網絡、AP控制器構成（AP控制 器可以控制若干個AP共同覆蓋一個比較大的區域範圍）。</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/07622e3ef74143e8a3a7b05371b6319d><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>圖4-12 基礎結構網絡</p><h1>· 為什麼需要無線局域網？</h1><p>· 有線網絡所存在的使用限制：</p><p>· 具有空曠場地的建築物內；</p><p>· 具有複雜周圍環境的製造業工廠、貨物倉庫內；</p><p>· 機場、車站、碼頭、股票交易場所等一些用戶頻繁移動的公共場所內；</p><p>· 缺少網絡電纜而又不能打洞佈線的歷史建築物內；</p><p>· 受自然條件影響而無法實施佈線的環境，如存在河道；</p><p>· 在一些需要臨時增設網絡節點的場合，如體育比賽場地、展示會等</p><h1>· 支持無線局域網的技術標準主要有：</h1><p>· 藍牙技術：手機或PDA為主要設計對象</p><p>· HomeRF技術：主要服務為家庭無線網絡</p><p>· IEEE 802.11系列：無線局域網標準</p><h1>· 覆蓋無線局域網的物理層和MAC子層：</h1><p>· 物理層標準規定了無線傳輸信號等基礎規範，如802.11a、802.11b、802.11d、802.11g、802.11h 。</p><p>· MAC子層標準包括802.11e、802.11f、802.11i。</p><p>· IEEE 802.11系列：無線局域網標準</p><h1>· 紅外線(IR)</h1><p>採用波長小於1μｍ的紅外線作為傳輸媒體，有較強的方向性，受陽光干擾大。它支持1～2Mbit/s 數據速率，適於近距離通信。</p><h1>· 無線電波方式(具有覆蓋範圍大，抗干擾、抗噪聲、抗衰減和保密性好的優點)</h1><p>· 直接序列式擴頻（DSSS）：支持1～2Mbit/s數據速率</p><p>· 跳頻擴展頻譜（FHSS） ：支持1Mbit/s數據速率</p><p>· 採用帶衝突避免的載波偵聽多路訪問（Carrier Sense Multiple Access/Collision Avoidation ）協議 ，簡稱 CSMA/CA。</p><p>· 在CSMA/CD基礎上，引入了稱為請求發送/清除發送（RTS/CTS）的機制。</p><p>若發送目的地是無線節點，則當數據到達基站時，基站向無線節點發送一個RTS幀，請求一段用 來發送數據的專用時間。接收到RTS請求幀的無線節點將回應一個CTS幀，表示它將中斷其他所有的通信 直到該基站傳送數據結束。</p><p>其他設備可監聽到傳輸事件的發生，同時將在此時間段的傳輸任務向後推遲。這樣，節點間傳 送數據時發生衝突的概率就會大大的減小。</p><h1>無線局域網設備</h1><p><br></p><p>· 無線網卡：</p><p>相當於有線網卡在有線局域網中的作用。按總線類型可分為適用於臺式機的PCI接口的無線網 卡，適用筆記本的PCMCIA接口的無線網卡，筆記本和臺式機均適用的USB接口的無線網卡。</p><p>· 無線訪問接入點（AP）：</p><p>無線局域網中進行數據發送和接收的集中設備，相當於有線網絡中的集線器。</p><p>通常，一個AP能夠在幾十至上百米的範圍內連接多個無線用戶。AP可以通過標準的Ethernet電纜 與傳統的有線網絡相聯，從而可作為無線網絡和有線網絡的連接點。</p><p>· 無線網橋：</p><p>用於無線或有線局域網之間的無線互連。</p><p>· 天線(Antenna) ：</p><p>將信號源發送的信號藉由天線傳送至遠處。</p><p>天線有定向性(Uni-directional)與全向性(Omni-directional)之分，前者較適合於長距離使 用，而後者則較適合區域性之應用。</p><p>· 無線路由器 ：</p><p>集成了無線AP的接入功能和路由器的第三層路徑選擇功能的無線連網設備。</p><h1>4.5 集線器、網橋和交換機</h1><p><br></p><p>一個機構（包括公司、大學和高中）通常包括許多部門，每個部門都有自己的以太網 LAN，並對它進行 管理。很顯然，各個機構也希望各部門互聯它們的 LAN 網段。在本節我們將考慮連接 LAN 的 3 中不同方法：集線器、網橋和交換機。</p><h1>4.5.1 集線器定義：</h1><p>集線器的英文稱為"Hub"。"Hub"是"中心"的意思，集線器的主要功能是對接收到的信號進行 再生整形放大，以擴大網絡的傳輸距離，同時把所有節點集中在以它為中心的節點上。它工作於 OSI(開放系統互聯參考模型)參考模型第一層，即"物理層"。集線器與網卡、網線等傳輸介質一樣，屬於局域網中的基礎設備，採用 CSMA/CD（一種檢測協議）訪問方式。</p><p>集線器（HUB）屬於數據通信系統中的基礎設備，它和雙絞線等傳輸介質一樣，是一種不需任何軟 件支持或只需很少管理軟件管理的硬件設備。它被廣泛應用到各種場合。集線器工作在局域網(LAN)環</p><p>境，像網卡一樣，應用於 OSI 參考模型第一層，因此又被稱為物理層設備。集線器內部採用了電器互聯， 當維護 LAN 的環境是邏輯總線或環型結構時，完全可以用集線器建立一個物理上的星型或樹型網絡結構。在這方面，集線器所起的作用相當於多端口的中繼器。其實，集線器實際上就是中繼器的一種，其區別僅在於集線器能夠提供更多的端口服務，所以集線器又叫多口中繼器。</p><h1>原理：</h1><p><br></p><p>我們知道在環型網絡中只存在一個物理信號傳輸通道，都是通過一條傳輸介質來傳輸的，這樣就存在各節點爭搶信道的矛盾，傳輸效率較低。引入集線器這一網絡集線設備後，每一個站是用它自己專用的傳輸介質連接到集線器的，各節點間不再只有一個傳輸通道，各節點發回來的信號通過集線器集中， <strong>集線器再把信號整形、放大後發送到所有節點上</strong>，這樣至少在上行通道上不再出現碰撞現象。但基於集線器的網絡仍然是一個共享介質的局域網，這裡的"共享"其實就是集線器內部總線，所以當上行通道與下行通道同時發送數據時仍然會存在信號碰撞現象。當集線器將從其內部端口檢測到碰撞時，產生碰撞強化信號（Jam）向集線器所連接的目標端口進行傳送。 這時所有數據都將不能發送成功，形成網絡</p><p>"大塞車"。</p><p>正因為集線器的這一不足之處，所以它不能單獨應用於較大網絡中（通常是與交換機等設備一起分擔小部分的網絡通信負荷），就像在大城市中心不能有單車道一樣，因為網絡越大，出現網絡碰撞現象的機會就越大。也正因如此，集線器的數據傳輸效率是比較低的，因為它在同一時刻只能有一個方向的 數據傳輸，也就是所謂的"單工"方式。如果網絡中要選用集線器作為單一的集線設備，則網絡規模最好 在 10 臺以內，而且集線器帶寬應為 10/100Mbps 以上。</p><p>集線器除了<strong>共享帶寬</strong>這一不足之處外，還有一個方面在選擇集線器時必須要考慮到，那就是它的廣播方式。因為集線器屬於純硬件網絡底層設備，基本上不具有"智能記憶"能力，更別說"學習"能力了。它也不具備交換機所具有的 MAC 地址表，所以它發送數據時都是沒有針對性的，而是採用廣播方式發送。也就是說當它要向某節點發送數據時，不是直接把數據發送到目的節點，而是把數據包發送到與集線器相連的所有節點，圖示如圖 2 所示。</p><p>這種廣播發送數據方式有兩方面不足：（1）用戶數據包向所有節點發送，很可能帶來數據通信的不安全因素，一些別有用心的人很容易就能非法截獲他人的數據包；（2）由於所有數據包都是向所有節點同時發送，加上以上所介紹的共享帶寬方式，就更加可能造成網絡塞車現象，更加降低了網絡執行效率。</p><h1>特點：</h1><p><br></p><p>依據 IEEE 802．3 協議，集線器功能是隨機選出某一端口的設備，並讓它獨佔全部帶寬，與集線器的上聯設備(交換機、路由器或服務器等)進行通信。由此可以看出，集線器在工作時具有以下兩個特點。</p><p>（1） Hub 只是一個多端口的信號放大設備，工作中當一個端口接收到數據信號時，由於信號在從源端口到 Hub 的傳輸過程中已有了衰減，所以 Hub 便將該信號進行整形放大，使被衰減的信號再生(恢復)到發送時的狀態，緊接著轉發到其他所有處於工作狀態的端口上。從 Hub 的工作方式可以看出，它在網絡中只起到信號放大和重發作用，其目的是擴大網絡的傳輸範圍，而不具備信號的定向傳送能力， 是—個標準的共享式設備。</p><p>（2） Hub 只與它的上聯設備(如上層 Hub、交換機或服務器)進行通信，同層的各端口之間不會直接進行通信，而是通過上聯設備再將信息廣播到所有端口上。由此可見，即使是在同一 Hub 的不同兩個端口之間進行通信，都必須要經過兩步操作：第一步是將信息上傳到上聯設備；第二步是上聯設備再將 該信息廣播到所有端口上。</p><h1>4.5.2 網橋</h1><p><br></p><p><strong>定義：</strong></p><p>一種在鏈路層實現中繼，常用於連接兩個或更多個局域網的網絡互連設備。網橋（Bridge）像一個聰明的中繼器。中繼器從一個網絡電纜裡接收信號， 放大它們，將其送入下一個電纜。相比較而言， 網橋對從關卡上傳下來的信息更敏銳一些。網橋是一種對幀進行轉發的技術，根據 MAC 分區塊，可隔離碰撞。網橋將網絡的多個網段在數據鏈路層連接起來。</p><h1>網橋種類</h1><p><br></p><p>遠程網橋: 由兩個半橋構成</p><p>透明網橋： 即插即用，支撐樹算法</p><p>源路由網橋：用於 802.5，發現幀發現路由<strong>功能：</strong></p><p>中繼器、網橋以及路由器主要解決的是網絡通信線路的連接問題，所以他們工作在 OSI 的第三層。中繼器實現網絡間物理層的互連。中繼器從一個網絡段上接受信號將之放大，重新定時後傳送到另一個網絡段上，以延長局域網的電纜長度。路由器是網絡層的互連設備，不但可以用於局域網之間的互連， 還可以在廣域網之間、廣域網與局域網之間實現互連功能，它不僅可以存儲和轉發分組，還具有路徑選擇、多路重發和錯誤檢測的功能。</p><h1>數據過濾和轉發</h1><p><br></p><p>網橋的功能之一就是數據的過濾和轉發。網橋首先要確定收到幀的目的設備是否在這個數據幀本身 所在的網段上。如果目的設備在這個網段上，網橋就不會將這個數據幀送到其他網橋端口，這就是一個 過濾的例子。過濾是對幀的處理過程，它阻止幀通過網橋。過濾有三種基本類型：</p><p>· 目的地址過濾</p><p>· 源地址過濾</p><p>· 協議過濾<strong>自學習能力</strong></p><p>當一幀到達時，網橋必須決定將其過濾還是轉發。如果要轉發，則必須決定發送哪個局域網。此決 策通過查閱網橋中一張大型散列表裡的目的地址來確定。該表可列出每個可能的目的地，以及它屬於哪一條輸出線路（LAN）。</p><h1>連接廣域網絡</h1><p><br></p><p>隨著企業網的發展，網絡覆蓋的地理區域要求越來越廣闊。網橋可以互連相距遙遠的局域網，如下 圖所示，這樣就可以解決一些企業發展自己網絡的需要。這種功能的實現是由廣域網網橋來完成的。在 最開始我們就提到，廣域網網橋也叫半網橋，他們成對的在一起工作。每個網橋的一個端口連接在租用 的線路上或者與一個 X25 網絡相連。各個網橋相互合作，通過使用類似於 SDLC 或 HDLC 的協議經過點到點鏈路來路由數據幀，或使用 X25 經過公共網絡路由數據幀。</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/71266a0e4fee4dea8dde11f9711dbbf4><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>圖 4-13 廣域網網橋</p><p>在通過廣域網絡進行互連時，必須考慮廣域網接入時延和信息傳送時延。顯然廣域網中傳輸距離越 長，信息傳送延遲就越大，而相應的數據傳輸效率就越底，一般推薦，基於網橋的廣域網絡連接的計算 機網絡覆蓋距離不應該超過 20km 以保證較底的傳輸時延。廣域網絡訪的訪問時間在於網橋基於數據鏈路層工作，所以採用的點到點直達通道，一般不希望數據傳輸在廣域網落中經過複雜的交換，這和路由</p><p>器和網橋式路由器是不同的，即網橋中期望數據幀快速傳輸。</p><p><strong>設備管理</strong></p><p>· 配置管理 :這一功能包括，網絡中所有網橋的操作和網橋的操作參數設置。網橋的操作有初</p><p>始化、重置和關閉，網橋的操作參數設置包括過濾表的生存時間、幀傳播延時控制。</p><p>· 故障管理 :這一功能可以及時報告網絡故障，並對網絡故障進行修整。</p><p>· 性能管理 :統計網橋各端口推進和數據幀的丟失數量。</p><p>· 安全管理 <strong>:</strong>網橋可以通過一些設置以滿足一定的安全需求。它可以設置不同的設備網橋訪問時間，或者配置用戶修改和訪問網橋的參數。其中各廠家對於安全管理實現方式各不相同。</p><p><strong>網橋的工作原理</strong></p><p>數據鏈路層互聯的設備是網橋(bridge)，在網絡互聯中它起到數據接收、地址過濾與數據轉發的作用，</p><p>用來實現多個網絡系統之間的數據交換。網橋的基本特徵</p><p>1．網橋在數據鏈路層上實現局域網互連；</p><p>2．網橋能夠互連兩個採用不同數據鏈路層協議、不同傳輸介質與不同傳輸速率的網絡</p><p>3．網橋以接收、存儲、地址過濾與轉發的方式實現互連的網絡之間的通信；</p><p>4．網橋需要互連的網絡在數據鏈路層以上採用相同的協議</p><p>5．網橋可以分隔兩個網絡之間的通信量，有利於改善互連網絡的性能與安全性。 <strong>網橋的侷限性</strong></p><p>網橋具有迅速高效、自適應能力強的特點，同時，與其他工作在高層的網絡互連設備相比較，它的 使用和安裝都相對簡單。但是網橋也存在問題，特別是在與廣播幀相關的應用上。廣播式通信所帶來的 結果是整個網絡都能看見存在於某對設備間的問題。</p><h1>4.5.3 交換機定義</h1><p>交換機(英文：Switch，意為"開關")是一種用於電信號轉發的網絡設備。它可以為接入交換機的任意兩個網絡節點提供獨享的電信號通路。最常見的交換機是以太網交換機。其他常見的還有電話語音 交換機、光纖交換機等。</p><h1>原理</h1><p>工作在數據鏈路層。交換機擁有一條很高帶寬的背部總線和內部交換矩陣。交換機的所有的端口都 掛接在這條背部總線上，控制電路收到數據包以後，處理端口會查找內存中的地址對照表以確定目的</p><p>MAC（網卡的硬件地址）的 NIC（網卡）掛接在哪個端口上，通過內部交換矩陣迅速將數據包傳送到目的端口，目的 MAC 若不存在，廣播到所有的端口，接收端口迴應後交換機會"學習"新的地址，並把它添加入內部 MAC 地址表中。使用交換機也可以把網絡"分段"，通過對照 MAC 地址表，交換機只允許必要的網絡流量通過交換機。通過交換機的過濾和轉發，可以有效的減少衝突域，但它不能劃分網絡層廣播，即廣播域。交換機在同一時刻可進行多個端口對之間的數據傳輸。每一端口都可視為獨立的網段，連接在其上的網絡設備獨自享有全部的帶寬，無須同其他設備競爭使用。當節點 A 向節點 D 發送數據時，節點 B 可同時向節點 C 發送數據，而且這兩個傳輸都享有網絡的全部帶寬，都有著自己的虛擬連接。假使這裡使用的是 10Mbps 的以太網交換機，那麼該交換機這時的總流通量就等於 2×10Mbps=20Mbps，而使用 10Mbps 的共享式 HUB 時，一個 HUB 的總流通量也不會超出 10Mbps。總之，交換機是一種基於 MAC 地址識別，能完成封裝轉發數據包功能的網絡設備。交換機可以"學習"MAC 地址，並把其存放在內部地址表中，通過在數據幀的始發者和目標接收者之間建立臨時的交換路徑，使數據幀直接由源地址到達 目的地址。</p><p><strong>人工交換</strong></p><p>電信號交換的歷史應當追溯到電話出現的初期。當電話被髮明後，只需要一根足夠長的導線，加上 末端的兩臺電話，就可以使相距很遠的兩個人進行語音交談。</p><p>電話增多後，要使每個擁有電話的人都能相互通信，我們不可能每兩臺電話機之間有拉上一根線。 於是人們設立了電話局，每個電話用戶都接一根線到電話局的一個大電路板上。當 A 希望和 B 通話時， 就請求電話局的接線員接通 B 的電話。接線員用一根導線，一頭插在 A 接到電路板上的孔，另一頭插到B 的孔，這就是"接續"，相當於臨時給 A 和 B 拉了一條電話線，這時雙方就可以通話了。當通話完畢後，接線員將電線拆下，這就是"拆線"。整個過程就是"人工交換"，它實際上就是一個"合上開關" 和"斷開開關"的過程。因此，把"交換"譯為"開關"從技術上講更容易讓人理解。</p><p><strong>以太網交換機</strong></p><p>隨著計算機及其互聯技術（也即通常所謂的"網絡技術"）的迅速發展，以太網成為了迄今為止普 及率最高的短距離二層計算機網絡。而以太網的核心部件就是以太網交換機。</p><p>不論是人工交換還是程控交換，都是為了傳輸語音信號，是需要獨佔線路的"電路交換"。而以太 網是一種計算機網絡，需要傳輸的是數據，因此採用的是"分組交換"。但無論採取哪種交換方式，交 換機為兩點間提供"獨享通路"的特性不會改變。就以太網設備而言，交換機和集線器的本質區別就在 於：當 A 發信息給 B 時，如果通過集線器，則接入集線器的所有網絡節點都會收到這條信息（也就是以廣播形式發送），只是網卡在硬件層面就會過濾掉不是發給本機的信息；而如果通過交換機，除非 A 通知交換機廣播，否則發給 B 的信息 C 絕不會收到（獲取交換機控制權限從而監聽的情況除外）。</p><p>目前，以太網交換機廠商根據市場需求，推出了三層甚至四層交換機。但無論如何，其核心功能仍 是二層的以太網數據包交換，只是帶有了一定的處理 IP 層甚至更高層數據包的能力。</p><h1>光交換</h1><p>光交換是人們正在研製的下一代交換技術。目前所有的交換技術都是基於電信號的，即使是目前的 光纖交換機也是先將光信號轉為電信號，經過交換處理後，再轉回光信號發到另一根光纖。由於光電轉 換速率較低，同時電路的處理速度存在物理學上的瓶頸，因此人們希望設計出一種無需經過光電轉換的</p><p>"光交換機"，其內部不是電路而是光路，邏輯原件不是開關電路而是開關光路。這樣將大大提高交換 機的處理速率。</p><p><strong>分類</strong></p><p>交換機的傳輸模式有全雙工，半雙工，全雙工/半雙工自適應交換機的全雙工是指交換機在發送數據的同時也能夠接收數據，兩者同步進行，這好像我們平時打電話一樣，說話的同時也能夠聽到對方的聲音。目前的交換機都支持全雙工。全雙工的好處在於遲延小， 速度快。</p><p>提到全雙工，就不能不提與之密切對應的另一個概念，那就是"半雙工"，所謂半雙工就是指一個時間段內只有一個動作發生，舉個簡單例子，一條窄窄的馬路，同時只能有一輛車通過，當目前有兩輛車對開，這種情況下就只能一輛先過，等到頭兒後另一輛再開，這個例子就形象的說明了半雙工的原理。 早期的對講機、以及早期集線器等設備都是實行半雙工的產品。隨著技術的不斷進步，半雙工會逐漸退出歷史舞臺。</p><p><strong>功能</strong></p><p>交換機的主要功能包括物理編址、網絡拓撲結構、錯誤校驗、幀序列以及流控。目前交換機還具備 了一些新的功能，如對 VLAN（虛擬局域網）的支持、對鏈路匯聚的支持，甚至有的還具有防火牆的功能。</p><p><strong>學習</strong>：以太網交換機瞭解每一端口相連設備的 MAC 地址，並將地址同相應的端口映射起來存放在交換機緩存中的 MAC 地址表中。</p><p><strong>轉發/過濾</strong>：當一個數據幀的目的地址在 MAC 地址表中有映射時，它被轉發到連接目的節點的端口而不是所有端口（如該數據幀為廣播/組播幀則轉發至所有端口）。</p><p><strong>消除迴路</strong>：當交換機包括一個冗餘迴路時，以太網交換機通過生成樹協議避免迴路的產生，同時允 許存在後備路徑。</p><p>交換機除了能夠連接同種類型的網絡之外，還可以在不同類型的網絡（如以太網和快速以太網）之 間起到互連作用。如今許多交換機都能夠提供支持快速以太網或 FDDI 等的高速連接端口，用於連接網絡中的其它交換機或者為帶寬佔用量大的關鍵服務器提供附加帶寬。</p><p>一般來說，交換機的每個端口都用來連接一個獨立的網段，但是有時為了提供更快的接入速度，我 們可以把一些重要的網絡計算機直接連接到交換機的端口上。這樣，網絡的關鍵服務器和重要用戶就擁 有更快的接入速度，支持更大的信息流量。</p><h1>交換機的基本功能：</h1><p>1． 像集線器一樣，交換機提供了大量可供線纜連接的端口，這樣可以採用星型拓撲佈線。</p><p>2． 像中繼器、集線器和網橋那樣，當它轉發幀時，交換機會重新產生一個不失真的方形電信號。</p><p>3． 像網橋那樣，交換機在每個端口上都使用相同的轉發或過濾邏輯。</p><p>4． 像網橋那樣，交換機將局域網分為多個衝突域，每個衝突域都是有獨立的寬帶，因此大大提高</p><p>了局域網的帶寬。</p><p>5． 除了具有網橋、集線器和中繼器的功能以外，交換機還提供了更先進的功能，如虛擬局域網</p><p>（VLAN）和更高的性能。 <strong>交換機與路由器的區別</strong></p><p>傳統交換機從網橋發展而來，屬於 OSI 第二層即數據鏈路層設備。它根據 MAC 地址尋址，通過站表選擇路由，站表的建立和維護由交換機自動進行。路由器屬於 OSI 第三層即網絡層設備，它根據 IP 地址進行尋址，通過路由表路由協議產生。交換機最大的好處是快速，由於交換機只須識別幀中 MAC 地址， 直接根據 MAC 地址產生選擇轉發端口算法簡單，便於 ASIC 實現，因此轉發速度極高。但交換機的工作機制也帶來一些問題。</p><p>1．迴路：根據交換機地址學習和站表建立算法，交換機之間不允許存在迴路。一旦存在迴路，必須啟動生成樹算法，阻塞掉產生迴路的端口。而路由器的路由協議沒有這個問題，路由器之間可以有多 條通路來平衡負載，提高可靠性。</p><p>2．負載集中：交換機之間只能有一條通路，使得信息集中在一條通信鏈路上，不能進行動態分配， 以平衡負載。而路由器的路由協議算法可以避免這一點，OSPF 路由協議算法不但能產生多條路由，而且能為不同的網絡應用選擇各自不同的最佳路由。</p><p>3．廣播控制：交換機只能縮小衝突域，而不能縮小廣播域。整個交換式網絡就是一個大的廣播域， 廣播報文散到整個交換式網絡。而路由器可以隔離廣播域，廣播報文不能通過路由器繼續進行廣播。</p><p>4．子網劃分：交換機只能識別 MAC 地址。MAC 地址是物理地址，而且採用平坦的地址結構，因此不能根據 MAC 地址來劃分子網。而路由器識別 IP 地址，IP 地址由網絡管理員分配，是邏輯地址且 IP 地址具有層次結構，被劃分成網絡號和主機號，可以非常方便地用於劃分子網，路由器的主要功能就是 用於連接不同的網絡。</p><p>5．保密問題：雖說交換機也可以根據幀的源 MAC 地址、目的 MAC 地址和其他幀中內容對幀實施過濾，但路由器根據報文的源 IP 地址、目的 IP 地址、TCP 端口地址等內容對報文實施過濾，更加直觀方便。</p><h1>4.6 PPP（Point-to-Point Protocol）點到點協議</h1><p><br></p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fb24619a5f8443348bef7e9940365a71><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>有人經常把PPP和P2P混淆，其實瞭解字面意思後就知道二者之間風馬牛不相及，PPP是一種鏈路層 協議，P2P則只是一種通信模型。之前介紹的以太網、WLAN都是多點接入鏈路技術，以太網儘管實現了 點到點介質，但鏈路依然是多點接入的。</p><p>圖 4-14 常見單鏈路 PPP</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/61d1e87ce9ed4a659dc5897f5f88a033><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>圖 4-15 擴展的多鏈路 Multi-Link PPP</p><p>而PPP就是專門為點到點鏈路設計的協議，介質是點到點的，鏈路也是點到點的。如上圖所示，PPP 的物理介質有可能不是連續的，但PPP鏈路建立之前要求先建立連續通信介質。這可能聽起來有點危言聳聽，怎麼建立連續介質呢？我們忽略了人在網絡中的重要性，網絡是人設計的，當然我們有建立連續 介質的權利，比如電話，要求人撥電話號碼，撥號就是一個建立連續介質的過程，可以說PPP鏈路和以太網很不一樣的特點就是"按需接入"，而以太網、WLAN都是"自由接入"特點，因此使用PPP協議的物理層通常是Modem、廣域網專線這樣的場景。PPP的鏈路層模型如下所示：</p><div class=pgc-img><img alt=嵌入式linux網絡編程—學TCPIP網絡的看過來，終於有人講清楚了 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4f85b56d704d4148b4491f4bf6d24846><div class=pgc-img-handler><div class="pgc-img-button editorImage fix-android"><section></section></div><div class="pgc-img-button setImageCover fix-android"><section></section></div><div class="pgc-img-button deleteImage fix-android"><section></section></div></div><div class=pgc-img-border></div></div><p>圖4-16 PPP鏈路層次模型</p><p>· 媒介和物理層已經介紹了撥號（Dial-up）線路，該線路最明顯的就是傳統Modem撥號和它的升級版本ADSL Modem和3G撥號，以及虛擬撥號，既在以太網/WLAN上建立虛擬撥號鏈路，我們稱為PPP over Ethernet，簡稱PPPoE；撥號線路的特點可以建立長距鏈路（如建立從南國廣州到東北哈爾濱的鏈路），但是帶寬小，而且不穩定，只能適合個人用戶，如果是企業或者研究機 構，則要求帶寬高一些，穩定的鏈路，這就是廣域網中的串行線路，分同步、異步兩種，目前 同步SDH線路應用廣泛一些，有通常比較常見的帶寬選項有2M、155M、622M、2.5G，當然帶寬越高，要掏的銀子也少不了；</p><p>· PPP工作在鏈路層，最底層的是鏈路控制協議，Link Control Protocol，作用是建立、配置、測試網絡數據連接，也就是說在物理層在人的干預下建立連續介質後，介質兩端的LCP就要開工了，協商雙方的參數是不是相互兼容，如果各種必要參數OK，那麼LCP宣告PPP鏈路已經建立好了，把工作移交給上一層；</p><p>· LCP的上一層是認證模塊，這是一個由LCP協商出來的可選模塊，共有2種認證方式：<strong>PAP</strong></p><p>（Password Authentication Protocol密碼認證協議）和<strong>CHAP</strong>（Challenge Authentication</p><p>Protocol挑戰認證協議），這兩種認證都採用用戶名、密碼認證，可以確認撥號者身份，兩種協議的差別在於安全性，PAP在線路上傳輸用戶名、密碼的明文，CHAP則傳送MD5計算後的摘要， 比較安全；認證一般用在個人使用撥號線路中，目的是確保受信撥號，認證完了也可以計費收錢，而串行線路是專線，也就是介質是無需撥號提前建好，專門給某兩個終端使用，銀子也是提前就付了的，使用專線的也基本上是大客戶，認證沒有必要；</p><p>· 認證通過或者免認證後就是NCP（Network Control Protocol網絡控制協議）進行最後的收尾了，NCP是一個家族的統稱，PPP為不同的網絡層協議專門制定NCP，如網絡層是IPv4，那麼就叫IPCP，如果是IPv6，那麼就是IPv6CP，如果是OSI，那就叫OSICP，但OSI協議自出生就被IPv4 牢牢扼殺住，能一睹其芳容的機會很少，除OSI之外還有一些被IPv4/IPv6幹廢的網絡層協議有</p><p>DECnet、Appletalk等，它們都在PPP上有自己的NCP；NCP的作用是協商鏈路兩側終端的網絡層地址信息、壓縮之類的參數，NCP竣工後，網絡層協議就可以在PPP鏈路上歡暢運行了。</p><p>· PPP的主要擴展包括Multi-Link PPP（多鏈路PPP）、PPP壓縮（Compression）等技術。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>網絡</a></li><li><a>linux</a></li><li><a>編程</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/6049529.html alt=嵌入式linux網絡編程——你所不知道的計算機網絡系統，精品講解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/23be2c97fd8344c9aef5fb19168425ef style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6049529.html title=嵌入式linux網絡編程——你所不知道的計算機網絡系統，精品講解>嵌入式linux網絡編程——你所不知道的計算機網絡系統，精品講解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7e66a0e7.html alt=Linux網絡編程——UDP廣播詳解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a2667182b3d34b2e98e8503a00af90fd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7e66a0e7.html title=Linux網絡編程——UDP廣播詳解>Linux網絡編程——UDP廣播詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c500d29b.html alt="高級網絡編程之疑症：TCP 的 Peer 兩端同時斷開連接" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/153201394276200d66036c8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c500d29b.html title="高級網絡編程之疑症：TCP 的 Peer 兩端同時斷開連接">高級網絡編程之疑症：TCP 的 Peer 兩端同時斷開連接</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8e97f2ef.html alt=linux系統編程—深入理解線程安全和可重入函數 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1ee6cfb4a26146468f84f34dc34ebbdf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8e97f2ef.html title=linux系統編程—深入理解線程安全和可重入函數>linux系統編程—深入理解線程安全和可重入函數</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/b9996341.html alt=linux系統編程之文件的內核結構file和dup實現重定向 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/2083db3dd90d4239bc06386a79bc693c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/b9996341.html title=linux系統編程之文件的內核結構file和dup實現重定向>linux系統編程之文件的內核結構file和dup實現重定向</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/42e7ad9.html alt="網絡編程 用戶態協議棧之 TCP/IP 的設計" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f1ee5eb624d94284bf71514f3cc5ea7b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/42e7ad9.html title="網絡編程 用戶態協議棧之 TCP/IP 的設計">網絡編程 用戶態協議棧之 TCP/IP 的設計</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/731d1aa.html alt="網絡編程 - TCP/IP協議" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b35dbde7fc6b4b9da051bf33eace2319 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/731d1aa.html title="網絡編程 - TCP/IP協議">網絡編程 - TCP/IP協議</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/103109d.html alt=Linux網絡編程——無連接和面向連接協議的區別 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/38755fbc61154d06a243d159fdae398b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/103109d.html title=Linux網絡編程——無連接和面向連接協議的區別>Linux網絡編程——無連接和面向連接協議的區別</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ea1bb612.html alt=光纜——未來網絡主導 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e75c1afe12354a93bad8495ad1057693 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ea1bb612.html title=光纜——未來網絡主導>光纜——未來網絡主導</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bdc59733.html alt="網絡詞名場面是什麼意思 名場面是什麼梗" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bdc59733.html title="網絡詞名場面是什麼意思 名場面是什麼梗">網絡詞名場面是什麼意思 名場面是什麼梗</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a002ca18.html alt=王一博那句年度網絡流行語「不愧是我」的：正版英文翻譯 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/26add5cdc08e4214800b25e21b623eb1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a002ca18.html title=王一博那句年度網絡流行語「不愧是我」的：正版英文翻譯>王一博那句年度網絡流行語「不愧是我」的：正版英文翻譯</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ad6f0929.html alt=谷歌大腦發佈神經網絡的「核磁共振」，並公開相關代碼 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/65c4000bda98898dcdbb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ad6f0929.html title=谷歌大腦發佈神經網絡的「核磁共振」，並公開相關代碼>谷歌大腦發佈神經網絡的「核磁共振」，並公開相關代碼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8dce33e7.html alt=理解生成對抗網絡，一步一步推理得到GANs（一） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/bee194d6fbec4d6f82e82998def3f7a3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8dce33e7.html title=理解生成對抗網絡，一步一步推理得到GANs（一）>理解生成對抗網絡，一步一步推理得到GANs（一）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1fe1c2dd.html alt=瞭解生成對抗網絡（GAN） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/634604de44ad4d17931ccc0bcf3e46ef style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1fe1c2dd.html title=瞭解生成對抗網絡（GAN）>瞭解生成對抗網絡（GAN）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9cfcdd6f.html alt=《JAVA編程思想》5分鐘速成：第8章（多態） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/399a29d93fde48fca4bae44dffbced07 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9cfcdd6f.html title=《JAVA編程思想》5分鐘速成：第8章（多態）>《JAVA編程思想》5分鐘速成：第8章（多態）</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>