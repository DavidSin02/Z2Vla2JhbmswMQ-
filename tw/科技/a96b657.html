<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>天氣情況圖像分類訓練營材料第二期：傳統計算機視覺 | 极客快訊</title><meta property="og:title" content="天氣情況圖像分類訓練營材料第二期：傳統計算機視覺 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/f8eac2974ff448ab99796726896edcb5"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a96b657.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a96b657.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a96b657.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a96b657.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a96b657.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a96b657.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/a96b657.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/a96b657.html><meta property="article:published_time" content="2020-10-29T20:50:55+08:00"><meta property="article:modified_time" content="2020-10-29T20:50:55+08:00"><meta name=Keywords content><meta name=description content="天氣情況圖像分類訓練營材料第二期：傳統計算機視覺"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/a96b657.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>天氣情況圖像分類訓練營材料第二期：傳統計算機視覺</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>第二期 傳統計算機視覺案例</h1><p><br></p><p>導言</p><p>傳統計算機視覺方法使用成熟的 CV 技術處理目標檢測問題，如特徵描述子（SIFT、SUR、BRIEF 等）。在深度學習興起前，圖像分類等任務需要用到特徵提取步驟，特徵即圖像中描述性或信息性的小圖像塊。這一步可能涉及多種 CV 算法，如邊緣檢測、角點檢測或閾值分割算法。</p><p>從圖像中提取出足夠多的特徵後，這些特徵可形成每個目標類別的定義（即「詞袋」）。預測階段中，在其他圖像中搜索這些定義。如果在一張圖像中找到了另一張圖像詞袋中的絕大多數特徵，則該圖像也包含同樣的目標（如椅子、馬等）。</p><p>內容</p><p><strong>本期訓練營主要內容如下：</strong></p><ol start=1><li>圖像數據的統計特徵介紹</li><li>圖像數據的特徵提取</li><li>機器學習的基礎概念與技術</li><li>基於SVM的圖像分類</li></ol><p>圖像數據的統計特徵介紹</p><p>局部特徵從總體上說是圖像或在視覺領域中一些有別於其周圍的地方；局部特徵通常是描述一塊區域，使其能具有高可區分度；局部特徵的好壞直接會決定著後面分類、識別是否會得到一個好的結果。</p><p>局部特徵應該具有的特點： 可重複性、可區分性、準確性、有效性（特徵的數量、特徵提取的效率）、魯棒性（穩定性、不變性）。</p><p><strong>下面主要介紹SIFT和HOG這兩種特徵提取方法。</strong></p><p>特徵提取通常都需要對圖像進行灰度化，這主要是基於以下兩個原因。</p><ol start=1><li>可以把灰度理解為圖像的強度。識別物體，最關鍵的因素是梯度，梯度意味著邊緣，通常使用灰度來計算梯度。</li><li>顏色，易受光照影響，難以提供關鍵信息，故將圖像進行灰度化，同時也可以加快特徵提取的速度。</li></ol><p>SIFT（尺度不變特徵變換）</p><p><strong>SIFT特徵提取的實質</strong></p><p>在不同的尺度空間上查找關鍵點(特徵點)，並計算出關鍵點的方向。SIFT所查找到的關鍵點是一些十分突出、不會因光照、仿射變換和噪音等因素而變化的點，如角點、邊緣點、暗區的亮點及亮區的暗點等。</p><p><strong>SIFT特徵提取的方法</strong></p><ol start=1><li>構建DOG尺度空間</li><li>模擬圖像數據的多尺度特徵，大尺度抓住概貌特徵，小尺度注重細節特徵。通過構建高斯金字塔（每一層用不同的參數σ做高斯模糊（加權）），保證圖像在任何尺度都能有對應的特徵點，即保證尺度不變性。</li><li>關鍵點搜索和定位：</li><li>確定是否為關鍵點，需要將該點與同尺度空間不同</li><li>值的圖像中的相鄰點比較，如果該點為max或min，則為一個特徵點。找到所有特徵點後，要去除低對比度和不穩定的邊緣效應的點，留下具有代表性的關鍵點（比如，正方形旋轉後變為菱形，如果用邊緣做識別，4條邊就完全不一樣，就會錯誤；如果用角點識別，則穩定一些）。去除這些點的好處是增強匹配的抗噪能力和穩定性。最後，對離散的點做曲線擬合，得到精確的關鍵點的位置和尺度信息。</li><li>方向賦值：</li><li>為了實現旋轉不變性，需要根據檢測到的關鍵點的局部圖像結構為特徵點賦值。具體做法是用梯度方向直方圖。在計算直方圖時，每個加入直方圖的採樣點都使用圓形高斯函數進行加權處理，也就是進行高斯平滑。這主要是因為SIFT算法只考慮了尺度和旋轉不變形，沒有考慮仿射不變性。通過高斯平滑，可以使關鍵點附近的梯度幅值有較大權重，從而部分彌補沒考慮仿射不變形產生的特徵點不穩定。注意，一個關鍵點可能具有多個關鍵方向，這有利於增強圖像匹配的魯棒性。</li><li>關鍵點描述子的生成：</li><li>關鍵點描述子不但包括關鍵點，還包括關鍵點周圍對其有貢獻的像素點。這樣可使關鍵點有更多的不變特性，提高目標匹配效率。在描述子採樣區域時，需要考慮旋轉後進行雙線性插值，防止因旋轉圖像出現白點。同時，為了保證旋轉不變性，要以特徵點為中心，在附近領域內旋轉</li><li>角，然後計算採樣區域的梯度直方圖，形成n維SIFT特徵矢量。最後，為了去除光照變化的影響，需要對特徵矢量進行歸一化</li></ol><p>更多內容可以參考：https://blog.csdn.net/happyer88/article/details/45817305</p><p>HOG（方向梯度直方圖）</p><p><strong>HOG特徵提取的實質</strong></p><p>通過計算和統計圖像局部區域的梯度方向直方圖來構成特徵。Hog特徵結合SVM分類器已經被廣泛應用於圖像識別中，尤其在行人檢測中獲得了極大的成功。</p><p><strong>HOG特徵提取的方法</strong></p><ol start=1><li>灰度化；</li><li>採用Gamma校正法對輸入圖像進行顏色空間的標準化（歸一化），目的是調節圖像的對比度，降低圖像局部的陰影和光照變化所造成的影響，同時可以抑制噪音的干擾；</li><li>計算圖像每個像素的梯度（包括大小和方向），主要是為了捕獲輪廓信息，同時進一步弱化光照的干擾；</li><li>將圖像劃分成小cells（例如6* 6像素/cell）；</li><li>統計每個cell的梯度直方圖（不同梯度的個數），即可形成每個cell的descriptor；</li><li>將每幾個cell組成一個block（例如3* 3個cell/block），一個block內所有cell的特徵descriptor串聯起來便得到該block的HOG特徵descriptor。</li><li>將圖像image內的所有block的HOG特徵descriptor串聯起來就可以得到該image（你要檢測的目標）的HOG特徵descriptor了。這個就是最終的可供分類使用的特徵向量了。</li></ol><p>更多內容參考：https://blog.csdn.net/zouxy09/article/details/7929348</p><p>除此之外，還有SURF、ORB、LBP、HAAR等特徵提取的方法，就不一一介紹了。感興趣的同學可以自行搜索。</p><p>圖像數據的特徵提取</p><p>基於opencv自帶的函數進行圖像特徵提取，由於SIFT有版權問題，所以新版本的opencv刪除了這個函數，所以下面只介紹用opencv提取HOG特徵的方法，HOG提取出的特徵向量是SVM的基礎。</p><p>HOG</p><p>Out[28]:</p><p>array([0.01280915, 0.00275154, 0.00823365, ..., 0.02358788, 0.02959047,</p><p>0.03718631], dtype=float32)</p><p>機器學習的基礎概念與技術</p><p>機器學習是一門多領域交叉學科，涉及概率論、統計學、逼近論、凸分析、算法複雜度理論等多門學科。專門研究計算機怎樣模擬或實現人類的學習行為，以獲取新的知識或技能，重新組織已有的知識結構使之不斷改善自身的性能。它是人工智能的核心，是使計算機具有智能的根本途徑。</p><p>機器學習是人工智能及模式識別領域的共同研究熱點，其理論和方法已被廣泛應用於解決工程應用和科學領域的複雜問題。自 20世紀80年代以來，機器學習作為實現人工智能的途徑，在人工智能界引起了廣泛的興趣，特別是近十幾年來，機器學習領域的研究工作發展很快，它已成為人工智能的重要課題之一。機器學習不僅在基於知識的系統中得到應用，而且在自然語言理解、非單調推理、機器視覺、模式識別等許多領域也得到了廣泛應用。</p><p>更多內容可參見社區項目：https://www.kesci.com/home/project/5c483e3489f4aa002b85a3d5</p><p>基於SVM的圖像分類</p><p>支持向量機（Support Vector Machine, SVM）是一類監督學習（supervised learning）方式對數據進行分類的廣義線性分類器（generalized linear classifier），其決策邊界是對學習樣本求解的最大邊距超平面（maximum-margin hyperplane）。</p><p>對SVM的介紹參見社區項目：https://www.kesci.com/home/project/5de08a8dca27f8002c4afe3b</p><p>基於SVM的圖像分類需要依靠HOG提取的特徵，擬合模型時將HOG提取出的特徵向量作為X，將樣本的類別標籤作為y</p><div class=pgc-img><img alt=天氣情況圖像分類訓練營材料第二期：傳統計算機視覺 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/f8eac2974ff448ab99796726896edcb5><p class=pgc-img-caption></p></div><p>Out[50]:</p><p>6000</p><p>一共有6000張圖片，選取前500張作為示例（前400張為訓練集，後100張為測試集）。</p><div class=pgc-img><img alt=天氣情況圖像分類訓練營材料第二期：傳統計算機視覺 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5de41ddbb73845ac84f713ca288a8d4b><p class=pgc-img-caption></p></div><p>Out[51]:</p><p>{'cloudy', 'sunny'}</p><p>可以看出標註只有cloudy和sunny兩種，令cloudy=0，sunny=1</p><p>訓練集： 0.965</p><p>測試集： 0.45</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>天氣</a></li><li><a>情況</a></li><li><a>圖像</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/2c3db761.html alt=計算機中數字、文字、圖像、聲音和視頻的表示與編碼 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8d1d3ec88f2c4a158c7efe55b21d6ed7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2c3db761.html title=計算機中數字、文字、圖像、聲音和視頻的表示與編碼>計算機中數字、文字、圖像、聲音和視頻的表示與編碼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d05d1fbb.html alt=2019年杭州日照時數仍然為0！接下來的天氣簡直不敢相信 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2b306ff771d84ea5aa6d17e51282f4db style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d05d1fbb.html title=2019年杭州日照時數仍然為0！接下來的天氣簡直不敢相信>2019年杭州日照時數仍然為0！接下來的天氣簡直不敢相信</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fa62c53a.html alt=「天氣」去年12月至今，累積日照時數僅145小時！把我少晒的2個月太陽還給我！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RGkYWjmAr78OEh style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fa62c53a.html title=「天氣」去年12月至今，累積日照時數僅145小時！把我少晒的2個月太陽還給我！>「天氣」去年12月至今，累積日照時數僅145小時！把我少晒的2個月太陽還給我！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2a5fd7a4.html alt="湖南日照時數達歷史同期最低 今明天遇雨雪天氣" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RFBrjkc5ABCWie style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2a5fd7a4.html title="湖南日照時數達歷史同期最低 今明天遇雨雪天氣">湖南日照時數達歷史同期最低 今明天遇雨雪天氣</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b0bf8fb0.html alt=蒙圭亞：任何情況下，我都會準備好比賽 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/30cb1c66bb004ca1be4beb7a825a65f0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b0bf8fb0.html title=蒙圭亞：任何情況下，我都會準備好比賽>蒙圭亞：任何情況下，我都會準備好比賽</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3250f321.html alt=今年大範圍雨雪天氣來臨！發電廠防潮防雨防雪必知的11個安全點 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/22dde1085dce4d769f962a813386781e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3250f321.html title=今年大範圍雨雪天氣來臨！發電廠防潮防雨防雪必知的11個安全點>今年大範圍雨雪天氣來臨！發電廠防潮防雨防雪必知的11個安全點</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1b218e68.html alt=圖像拼接算法及實現（一） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1534489824878547eee8fc2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1b218e68.html title=圖像拼接算法及實現（一）>圖像拼接算法及實現（一）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a83fc784.html alt=什麼情況下選擇熱電偶？什麼情況下選擇熱電阻？哪個更合適？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2de8699bda574d39b3c83e6e8e505ade style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a83fc784.html title=什麼情況下選擇熱電偶？什麼情況下選擇熱電阻？哪個更合適？>什麼情況下選擇熱電偶？什麼情況下選擇熱電阻？哪個更合適？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b386bc47.html alt=天氣漸熱，空調維修的高峰期也要來！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/02df47d809094258884eaf99331942ec style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b386bc47.html title=天氣漸熱，空調維修的高峰期也要來！>天氣漸熱，空調維修的高峰期也要來！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/07d16e44.html alt=高速公路開車，遇到這種情況，到底應該從哪邊車道超車？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/fac013e6f37449be93343c6c4d009a3f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/07d16e44.html title=高速公路開車，遇到這種情況，到底應該從哪邊車道超車？>高速公路開車，遇到這種情況，到底應該從哪邊車道超車？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2a4e8584.html alt=2月4日懷寧縣新型冠狀病毒感染的肺炎疫情情況通報 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/e38c38fa005d4bcaa58978b789a0a0b1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2a4e8584.html title=2月4日懷寧縣新型冠狀病毒感染的肺炎疫情情況通報>2月4日懷寧縣新型冠狀病毒感染的肺炎疫情情況通報</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ca96c71c.html alt=潮溼天氣注意油漆工工期延長 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/fd9d87c2-9bb1-448f-aa86-7499ac82570e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ca96c71c.html title=潮溼天氣注意油漆工工期延長>潮溼天氣注意油漆工工期延長</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e7992fac.html alt=如何分類？哪種情況會被罰款？罰多少？武漢生活垃圾分類政策解讀 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e7992fac.html title=如何分類？哪種情況會被罰款？罰多少？武漢生活垃圾分類政策解讀>如何分類？哪種情況會被罰款？罰多少？武漢生活垃圾分類政策解讀</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cc849248.html alt=卡納瓦羅：天氣熱影響狀態，塔利斯卡冷靜，給了保利尼奧爆發！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1533219280246cd138f6f21 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cc849248.html title=卡納瓦羅：天氣熱影響狀態，塔利斯卡冷靜，給了保利尼奧爆發！>卡納瓦羅：天氣熱影響狀態，塔利斯卡冷靜，給了保利尼奧爆發！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1d63e45e.html alt=厄爾尼諾全面影響天氣？一大早東北成全國高溫中心，或熱得破紀錄 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/93a802b091fe457a9f2228330f32e210 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1d63e45e.html title=厄爾尼諾全面影響天氣？一大早東北成全國高溫中心，或熱得破紀錄>厄爾尼諾全面影響天氣？一大早東北成全國高溫中心，或熱得破紀錄</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>