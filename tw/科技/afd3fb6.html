<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>從數據民工到數據白領蛻變之旅-使用dotNET腳本實現SSIS無限擴展 | 极客快訊</title><meta property="og:title" content="從數據民工到數據白領蛻變之旅-使用dotNET腳本實現SSIS無限擴展 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/cd90f4d4adbc43f39adefe9a644b97f2"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/afd3fb6.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/afd3fb6.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/afd3fb6.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/afd3fb6.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/afd3fb6.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/afd3fb6.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/afd3fb6.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/afd3fb6.html><meta property="article:published_time" content="2020-10-29T21:06:50+08:00"><meta property="article:modified_time" content="2020-10-29T21:06:50+08:00"><meta name=Keywords content><meta name=description content="從數據民工到數據白領蛻變之旅-使用dotNET腳本實現SSIS無限擴展"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/afd3fb6.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>從數據民工到數據白領蛻變之旅-使用dotNET腳本實現SSIS無限擴展</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><blockquote><p>在前面一文中，正式引出了SSIS專業數據ETL工具，筆者僅能作引路作用，未能使用文章的方式給大家寫出更多的入門級的文章，希望讀者們可以自行根據分享的學習資源自行完成入門及進階的學習。</p><p>同時也想給大家分享到SSIS的能力邊界性，讓大家可以先打開思路，見識到其能力的所在，日後在學習過程中，可以有更清晰的進步方向。</p></blockquote><p><strong>dotNET遇上SSIS</strong></p><p>在筆者過往的文章裡已經反覆提到過，學習dotNET的性價比是比較高的，不止於可以做任何專業程序員做的領域，更是可以讓我們這些業餘的人員大有作為，例如可以開發OFFICE插件，可以使用PowerShell來做運維（會dotNET的很快上手，都是廣義的dotNET體系），同時在微軟的產品系裡開放了各產品的對象模型，使我們可以輕鬆地和各大產品作交互如Windows的WMI模型，Sqlserver的SMO、AMO模型，當然還有我們熟悉的OFFICE對象模型等。</p><p>今天來到SSIS中，我們可以有另外一層能力，讓dotNET和SSIS集成，在SSIS中，提供了VSTA的開放接口（Visual Studio Tools For Application），相對於VSTO（Visual Studio Tools For Office）來說，一個是對OFFICE產品，一個是對程序，這裡的程序就是SSIS。</p><p>所以我們可以在SSIS環境下使用dotNET語言，這個極大地增強了我們的數據ETL能力，大凡dotNET能夠做的部分，SSIS也可以加上這些能力，並且起點是SSIS給我們做好了模板，自動化寫了許多設計代碼，就如Winform開發拖拉控件一樣的體驗，我們在SSIS中，VSTA已經為我們做了非常棒的框架，可以讓我們在數據流中輕鬆訪問我們的數據對象。</p><p><strong>實際演示</strong></p><p>本篇只是導讀類，並非要手把手教會大家，讀者們僅需瞭解下SSIS的功能擴展邊界，評估此工具能夠給自己的數據方案做到何種程度，真正要學習時，建議仍然需要按步就班，從低到高地不斷地進步。</p><p>在dotNET的自帶的類庫中，已經提供了非常強大的數據處理能力，特別是linq查詢和我們很常用到的文件類操作，字符串處理特別是正則處理等，這裡不展開，此篇給大家一個開放的思路，怎樣從外界尋獲更多的資源來武裝自己的數據處理方案，給大家帶來在SSIS環境下調用百度AI接口，讓非結構化的數據轉換為可分析的結構化數據供下游Excel、PowerBI等分析工具使用。</p><p>在Excel催化劑上同樣實現了此功能，詳見以下文章。</p><p>第15波-接入AI人工智能NLP自然語言處理https://www.jianshu.com/p/56a0616125fa</p><p><strong>準備工作</strong></p><p>獲取百度AI的SDK，可以在百度AI後臺有跳轉鏈接到github，下載整個項目再編譯。</p><p>因SSIS需要簽名的dll類庫，在Nuget上的百度AI類庫，沒有進行簽名操作，故不能直接在Nuget上下載。</p><p>同樣地SSIS對外部dll引用的要求是需要註冊到GAC容器中。所以需要對下載編譯好的dll使用gacutil工具註冊到GAC中，具體自行查閱相關文檔。</p><p><strong>使用腳本組件實現百度AI的調用</strong></p><p>在本篇的SSIS包任務中，加上了一個腳本組件，從源Excel文件中抽取數據，經過腳本組件的轉換，將內容發送到百度AI上，讓其幫忙返回結果，最終轉換後的結果寫入到目標表中。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=從數據民工到數據白領蛻變之旅-使用dotNET腳本實現SSIS無限擴展 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/cd90f4d4adbc43f39adefe9a644b97f2><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p>腳本組件中，我們通過評論內容，經過百度AI的接口調用後，返回多列結構化定量的數據。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=從數據民工到數據白領蛻變之旅-使用dotNET腳本實現SSIS無限擴展 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6243c387c8244602939b4823e0cdb34a><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p>使用的百度AI接口如下：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=從數據民工到數據白領蛻變之旅-使用dotNET腳本實現SSIS無限擴展 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/257c1b9910a84c8ea11659b312bb9b88><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><div class=pgc-img><img alt=從數據民工到數據白領蛻變之旅-使用dotNET腳本實現SSIS無限擴展 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e573ae13c7f94d19aee359d4ee9ee1a4><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p>經過簡單幾句代碼的調用，即可完成了我們所需的功能，能夠有這樣的能力，是基於百度已經給我們做好了SDK，直接調用即可，同時SSIS也根據我們需要的功能幫我們自動生成了強類型的類庫供簡單調用。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=從數據民工到數據白領蛻變之旅-使用dotNET腳本實現SSIS無限擴展 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1cf6c0d142c54b6aa4004b0b179a4edd><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p>SSIS中的VSTA框架已經幫我們做了大量的工作，根據我們界面的配置信息自動生成了代碼Wrapper包裝器。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=從數據民工到數據白領蛻變之旅-使用dotNET腳本實現SSIS無限擴展 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/aaed2f29f6664b219924dda8a2fa6030><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p>最後我們回到數據庫中可發現，已經從我們Excel的兩列數據，經過轉換後，生成了其他四列的數據。此時我們已經完成了從非結構化的文本評論數據，轉變為可分析的情感傾向的分析。整個過程無需我們懂什麼高深的人工智能、機器學習之類的算法，只需懂自己想要什麼，讓BAT們幫我們做成即中。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=從數據民工到數據白領蛻變之旅-使用dotNET腳本實現SSIS無限擴展 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1d99ae8d95424e90a144dee437b7dd48><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p>看到上圖中有許多默認的0和結果為空的記錄行，相信已經開始有讀者想表達下意見，SSIS生成的數據不靠譜，調用20條，只有7條數據返回。</p><p>本次的測試恰恰讓大家可以見識到企業級ETL的工具之威力，筆者完全不需懂多線程、併發性之類的高深知識，簡單幾句的業務轉換代碼，SSIS已經幫我們完成了併發性調用，並且調用的速度實在太快，連百度AI都不接受，直接返回錯誤告訴併發量超標了。</p><p>當然此僅演示示例，實際中因為外部接口的併發性限制等原因，需要限制速度等操作，需要根據實際情況再對代碼進行優化，使其真正能夠滿足我們預期的需求。</p><p><strong>結語</strong></p><p>本篇帶領讀者們一窺SSIS的能力邊界，讓我們心中有數，具體使用SSIS有何不能做到的事情。</p><p>在我們中小企業的數據場景裡，筆者這裡可以很有把握地告之，實在沒有什麼是不能做到的，若有恐怕也僅僅是我們對其的認知水平和掌握水平的高低差異而已。</p><p>將程序員的廣闊輪子世界接入SSIS中，並將各大廠商提供的SAAS消費級服務一併接入，恐怕只差我們的想像力而已，在SSIS的世界中，數據將如期地按我們想要的形式完成ETL的過程。</p><p><em>筆者未來聚焦在數據領域的分享，不限於Excel，會分享更多Sqlserver、dotNET、Azure、PowerBI等話題，升級數據分析的能力，歡迎繼續關注。</em>*</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>數據</a></li><li><a>白領</a></li><li><a>蛻變</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/01e18262.html alt="2019級軍訓 | 蛻變中的成長，在西京學院我們一起經歷的軍訓" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/5e6d48b6fc5a49f480f9de7e22ab7958 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/01e18262.html title="2019級軍訓 | 蛻變中的成長，在西京學院我們一起經歷的軍訓">2019級軍訓 | 蛻變中的成長，在西京學院我們一起經歷的軍訓</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a5ff8793.html alt=北海70年魅力蛻變！一組老照片看北海城市發展變化 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1882b492aed44fdfa6eeab0473ab8479 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a5ff8793.html title=北海70年魅力蛻變！一組老照片看北海城市發展變化>北海70年魅力蛻變！一組老照片看北海城市發展變化</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/862c99dd.html alt=數據告訴你，為什麼要在上升趨勢買入和下降趨勢賣出 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3e507bb24abc482fb28df1121a7ee097 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/862c99dd.html title=數據告訴你，為什麼要在上升趨勢買入和下降趨勢賣出>數據告訴你，為什麼要在上升趨勢買入和下降趨勢賣出</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1f742b21.html alt="數據科學家常犯的 10 個編程錯誤" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1f742b21.html title="數據科學家常犯的 10 個編程錯誤">數據科學家常犯的 10 個編程錯誤</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d5773fc2.html alt=數據科學家常遇到的10個錯誤 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/59f660bac8b541888e71459b604ba733 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d5773fc2.html title=數據科學家常遇到的10個錯誤>數據科學家常遇到的10個錯誤</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5ff7d77e.html alt=WORD表格的數據老闆讓增加合計，同事用計算器計算，我3秒鐘搞定 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f120ed2c1ed549e39bfa60bb3a86d591 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5ff7d77e.html title=WORD表格的數據老闆讓增加合計，同事用計算器計算，我3秒鐘搞定>WORD表格的數據老闆讓增加合計，同事用計算器計算，我3秒鐘搞定</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cea55527.html alt="多列數據合併一列，還在用數據透視就out了，用=號只要三步完成" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/7aa6ee1b961f467e8090ed56f45c110f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cea55527.html title="多列數據合併一列，還在用數據透視就out了，用=號只要三步完成">多列數據合併一列，還在用數據透視就out了，用=號只要三步完成</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/37396ded.html alt=數據結構系列：哈希表？這涉及的是“加密/區塊鏈”等技術的核心 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3609570de59a49a9be5667dd9a637f65 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/37396ded.html title=數據結構系列：哈希表？這涉及的是“加密/區塊鏈”等技術的核心>數據結構系列：哈希表？這涉及的是“加密/區塊鏈”等技術的核心</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0e2547f1.html alt=「數據結構」Hash表 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/617a6d43032e4efbac6b996c9bb5ab11 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0e2547f1.html title=「數據結構」Hash表>「數據結構」Hash表</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b37254e1.html alt=備戰秋招——算法與數據結構（5） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ab6859411bd8435bb2616d6fef468556 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b37254e1.html title=備戰秋招——算法與數據結構（5）>備戰秋招——算法與數據結構（5）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f605b4b8.html alt=懂了數據結構框架思維，一切算法不過是紙老虎 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ad2c8a60d9634e0aa36b5d8a664de355 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f605b4b8.html title=懂了數據結構框架思維，一切算法不過是紙老虎>懂了數據結構框架思維，一切算法不過是紙老虎</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e03941dc.html alt=數據結構一(哈希表)想進大廠的必備知識點 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/86ad7a2f62cc48f98bbe53b42ca4bf9a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e03941dc.html title=數據結構一(哈希表)想進大廠的必備知識點>數據結構一(哈希表)想進大廠的必備知識點</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/385a3c55.html alt="數據結構中的 Hash 表" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/0e43812c-6f05-4cf6-af7e-18011d0a316a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/385a3c55.html title="數據結構中的 Hash 表">數據結構中的 Hash 表</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7739dc7a.html alt=Python數據可視化Matplotlib，如何在一副圖像中顯示多組柱形圖？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/5d4a0000046e1bea8b90 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7739dc7a.html title=Python數據可視化Matplotlib，如何在一副圖像中顯示多組柱形圖？>Python數據可視化Matplotlib，如何在一副圖像中顯示多組柱形圖？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/46925324.html alt=什麼，每組數據都要直觀顯示出趨勢？別慌，迷你圖來幫你 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/dacc2e5d44c547fbb97f666290862260 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/46925324.html title=什麼，每組數據都要直觀顯示出趨勢？別慌，迷你圖來幫你>什麼，每組數據都要直觀顯示出趨勢？別慌，迷你圖來幫你</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>