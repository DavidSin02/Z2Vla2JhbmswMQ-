<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>基於 ECC 的私鑰轉為公鑰的過程 | 极客快訊</title><meta property="og:title" content="基於 ECC 的私鑰轉為公鑰的過程 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b059d03.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b059d03.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b059d03.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b059d03.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b059d03.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b059d03.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b059d03.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b059d03.html><meta property="article:published_time" content="2020-10-29T20:51:34+08:00"><meta property="article:modified_time" content="2020-10-29T20:51:34+08:00"><meta name=Keywords content><meta name=description content="基於 ECC 的私鑰轉為公鑰的過程"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/b059d03.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>基於 ECC 的私鑰轉為公鑰的過程</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>基本知識</h1><p>ECC 體系中，私鑰是一個大型隨機數，而公鑰則是私鑰乘以橢圓曲線上的基點後對應的點。</p><p>meet-one/private-to-public 是 MEET.ONE 開發的私鑰轉公鑰工具。</p><p>EOS 支持的 EC 有兩種：secp256k1（以下簡稱 k1）、secp256r1，下面以 k1 為例，結合 Node.js 和 Python 代碼介紹轉換過程。</p><h1 class=pgc-h-arrow-right>涉及算法</h1><ul><li><strong>BASE58</strong>：編解碼私鑰、公鑰。</li><li><strong>SHA-256</strong>：校驗私鑰，本文忽略此步。</li><li><strong>ECC, secp256k1</strong>：計算公鑰。</li><li><strong>RIPEMD-160</strong>：校驗公鑰。</li></ul><h1 class=pgc-h-arrow-right>轉換過程</h1><h1 class=pgc-h-arrow-right>1. 解碼私鑰</h1><p>假設私鑰為：5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3，這是 base58 編碼，用 bs58 庫解碼：</p><pre><code>const bs = require(&#39;bs58&#39;)bs.decode(&#39;5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3&#39;)</code></pre><p>得到 &lt;Buffer 80 d2 65 3f f7 cb b2 d8 ff 12 9a c2 7e f5 78 1c e6 8b 25 58 c4 1a 74 af 1f 2d dc a6 35 cb ee f0 7d aa 08 64 4a>，其中第 1 個字節 0x80 是類型，末尾的 4 字節是校驗碼。</p><p>這裡我們不關心校驗碼，也可以直接用 bs58check 解碼：</p><pre><code>const bsc = require(&#39;bs58check&#39;)bsc.decode(&#39;5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3&#39;)</code></pre><p>得到 &lt;Buffer 80 d2 65 3f f7 cb b2 d8 ff 12 9a c2 7e f5 78 1c e6 8b 25 58 c4 1a 74 af 1f 2d dc a6 35 cb ee f0 7d>，去掉首字節後為：</p><p>d2 65 3f f7 cb b2 d8 ff 12 9a c2 7e f5 78 1c e6 8b 25 58 c4 1a 74 af 1f 2d dc a6 35 cb ee f0 7d</p><p>這是 256bit 整數的 Big endian 字節流表示，轉為 16 進制整形為 0xd2653ff7cbb2d8ff129ac27ef5781ce68b2558c41a74af1f2ddca635cbeef07d，記為 pk。</p><h1 class=pgc-h-arrow-right>2. 構造橢圓曲線，求公鑰的座標</h1><p>根據 SECG 規定的 k1 的參數，我們用基於 Python 的 SAGE 構造 k1 對應的橢圓曲線，然後計算 pk * G：</p><pre><code>a = 0b = 7p = 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2fGx = 0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798Gy = 0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8E = EllipticCurve (GF(p), [a, b])pk = 0xd2653ff7cbb2d8ff129ac27ef5781ce68b2558c41a74af1f2ddca635cbeef07dG = E(Gx, Gy)pk * G</code></pre><p>結果為：(87237761414843254130560834629777710286905276524352264071298714336416392033743 : 108016191455113306196371645921919775466659772908675410052799661524790827329728 : 1)</p><p><strong>注：這裡的 (x : y : z) 是射影座標，一般採用笛卡爾座標系表示，為 (x/z, y/z)。</strong></p><h1 class=pgc-h-arrow-right>3. 編碼公鑰</h1><p>取 x 值：87237761414843254130560834629777710286905276524352264071298714336416392033743</p><p>16 進製為：0xc0ded2bc1f1305fb0faac5e6c03ee3a1924234985427b6167ca569d13df435cf</p><p>Big endian 字節流表示為：[0xc0, 0xde, 0xd2, 0xbc, 0x1f, 0x13, 0x05, 0xfb, 0x0f, 0xaa, 0xc5, 0xe6, 0xc0, 0x3e, 0xe3, 0xa1, 0x92, 0x42, 0x34, 0x98, 0x54, 0x27, 0xb6, 0x16, 0x7c, 0xa5, 0x69, 0xd1, 0x3d, 0xf4, 0x35, 0xcf]</p><p>由於 y 值是偶數，所以添加一個前綴 2，得到：[2, 0xc0, 0xde, 0xd2, 0xbc, 0x1f, 0x13, 0x05, 0xfb, 0x0f, 0xaa, 0xc5, 0xe6, 0xc0, 0x3e, 0xe3, 0xa1, 0x92, 0x42, 0x34, 0x98, 0x54, 0x27, 0xb6, 0x16, 0x7c, 0xa5, 0x69, 0xd1, 0x3d, 0xf4, 0x35, 0xcf]</p><p><strong>注：若 y 為奇數，則前綴為 3。</strong></p><p><strong>注：為什麼這麼規定？只用 x 值和 y 值的奇偶性表示一個點，這叫公鑰的壓縮格式。因為只要有 x，就可以通過 k1 的橢圓曲線方程式 $y^2 = x^3 + 7 \mod p$ 求出 y，但此時 y 會有兩個解，又由於 p 是一個大質數，必定為奇數，故兩個 y 解的和 mod p 一定等於 0，即一奇一偶，所以用 x 和 y 的奇偶性標誌即可代表這個點。</strong></p><p>接著求校驗碼：</p><pre><code>const ripemd160 = require(&#39;ripemd160&#39;)new ripemd160().update(Buffer.from([2, 0xc0, 0xde, 0xd2, 0xbc, 0x1f, 0x13, 0x05, 0xfb, 0x0f, 0xaa, 0xc5, 0xe6, 0xc0, 0x3e, 0xe3, 0xa1, 0x92, 0x42, 0x34, 0x98, 0x54, 0x27, 0xb6, 0x16, 0x7c, 0xa5, 0x69, 0xd1, 0x3d, 0xf4, 0x35, 0xcf])).digest()</code></pre><p>得到：&lt;Buffer eb 05 f9 d2 c6 dd 62 f7 f2 a0 f7 61 ea 1d 8c 0b 84 4a 3b 52>，取前 4 字節，添加到末尾，得到：[2, 0xc0, 0xde, 0xd2, 0xbc, 0x1f, 0x13, 0x05, 0xfb, 0x0f, 0xaa, 0xc5, 0xe6, 0xc0, 0x3e, 0xe3, 0xa1, 0x92, 0x42, 0x34, 0x98, 0x54, 0x27, 0xb6, 0x16, 0x7c, 0xa5, 0x69, 0xd1, 0x3d, 0xf4, 0x35, 0xcf, 0xeb, 0x05, 0xf9, 0xd2]</p><p>然後，base58 編碼：</p><pre><code>const bs = require(&#39;bs58&#39;)bs.encode(Buffer.from([2, 0xc0, 0xde, 0xd2, 0xbc, 0x1f, 0x13, 0x05, 0xfb, 0x0f, 0xaa, 0xc5, 0xe6, 0xc0, 0x3e, 0xe3, 0xa1, 0x92, 0x42, 0x34, 0x98, 0x54, 0x27, 0xb6, 0x16, 0x7c, 0xa5, 0x69, 0xd1, 0x3d, 0xf4, 0x35, 0xcf, 0xeb, 0x05, 0xf9, 0xd2]))</code></pre><p>得到：6MRyAjQq8ud7hVNYcfnVPJqcVpscN5So8BhtHuGYqET5GDW5CV，加上前綴 EOS，即為公鑰。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>ECC</a></li><li><a>轉為</a></li><li><a>公鑰</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/e2247cdf.html alt=掃描的pdf文本轉為word？這款工具要知道 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d0167016b7dd47ea85a1cec8804c539e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e2247cdf.html title=掃描的pdf文本轉為word？這款工具要知道>掃描的pdf文本轉為word？這款工具要知道</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/57b50f9e.html alt=黃石市長：疫情轉為內部擴散型，傳播途徑不清晰，部分病例症狀不太明顯 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RopBFTe8SoUNj9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/57b50f9e.html title=黃石市長：疫情轉為內部擴散型，傳播途徑不清晰，部分病例症狀不太明顯>黃石市長：疫情轉為內部擴散型，傳播途徑不清晰，部分病例症狀不太明顯</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/3a70252.html alt=國有大行加速存量房貸利率轉為LPR：8月25日起批量轉換 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/3a70252.html title=國有大行加速存量房貸利率轉為LPR：8月25日起批量轉換>國有大行加速存量房貸利率轉為LPR：8月25日起批量轉換</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/9a6f4f7.html alt="存量房貸將批量轉為LPR  貸款人“被強轉”後還有第三種選擇嗎？" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/S8Hz2fU7Tm5kJk style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/9a6f4f7.html title="存量房貸將批量轉為LPR  貸款人“被強轉”後還有第三種選擇嗎？">存量房貸將批量轉為LPR 貸款人“被強轉”後還有第三種選擇嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/b1c0c00.html alt=影響急性肝炎轉為慢性肝炎的因素有哪些呢？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/896cec15feba473cb1c5c8520203aac5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/b1c0c00.html title=影響急性肝炎轉為慢性肝炎的因素有哪些呢？>影響急性肝炎轉為慢性肝炎的因素有哪些呢？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/566c5a7.html alt=陀螺旋轉為什麼不會倒？活了這麼久今天終於知道了 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/691aee96d26741968475e9b0d51bb7a7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/566c5a7.html title=陀螺旋轉為什麼不會倒？活了這麼久今天終於知道了>陀螺旋轉為什麼不會倒？活了這麼久今天終於知道了</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d414f3c.html alt=8月14日，公鑰觀察 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/02fc899216fc44cc847ba9bc28323eae style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d414f3c.html title=8月14日，公鑰觀察>8月14日，公鑰觀察</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a55532a.html alt=8月15日，公鑰觀察 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9c3328556d89468cb1185aed2c4d45d6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a55532a.html title=8月15日，公鑰觀察>8月15日，公鑰觀察</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7b2418d.html alt=“黑客”深度學習之“公鑰基礎設施（PKI）詳解” class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/516a1b9bdfa44d72891561d99ce80057 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7b2418d.html title=“黑客”深度學習之“公鑰基礎設施（PKI）詳解”>“黑客”深度學習之“公鑰基礎設施（PKI）詳解”</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2a0046d.html alt=「讀懂比特幣」紛亂有序的私鑰、公鑰和地址 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/1d003ea1-ebf6-42d6-9f32-9bd7139c1c33 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2a0046d.html title=「讀懂比特幣」紛亂有序的私鑰、公鑰和地址>「讀懂比特幣」紛亂有序的私鑰、公鑰和地址</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9347eb2.html alt=一個小故事，讓你明白公鑰，私鑰，https class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/9222491b-ed14-44c1-9025-77e8fe61f9c0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9347eb2.html title=一個小故事，讓你明白公鑰，私鑰，https>一個小故事，讓你明白公鑰，私鑰，https</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/92c7b99.html alt=什麼是公鑰密碼 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/92c7b99.html title=什麼是公鑰密碼>什麼是公鑰密碼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/00b50bc.html alt=什麼是：地址、公鑰、密碼、私鑰、助記詞、Keystore？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6bbce0c133d44cb9b3ab8b26365b0303 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/00b50bc.html title=什麼是：地址、公鑰、密碼、私鑰、助記詞、Keystore？>什麼是：地址、公鑰、密碼、私鑰、助記詞、Keystore？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/13331db.html alt="使用公鑰/私鑰對設定免密的 Linux 登錄方式" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2276426814ab465eb251dd31343c9824 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/13331db.html title="使用公鑰/私鑰對設定免密的 Linux 登錄方式">使用公鑰/私鑰對設定免密的 Linux 登錄方式</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5c0b2ca.html alt=使用公鑰遠程Linux機器和跳轉Linux class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9b74af6790ed4fbe931c3b2085a8b0cc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5c0b2ca.html title=使用公鑰遠程Linux機器和跳轉Linux>使用公鑰遠程Linux機器和跳轉Linux</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>