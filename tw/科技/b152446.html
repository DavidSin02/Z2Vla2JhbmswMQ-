<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>ã€Œasp.net core ç³»åˆ—ã€12 æ•¸æ“šåŠ å¯†ç®—æ³•ï¼ˆå¸¸è¦‹åŠ å¯†ç®—æ³•ï¼‰ | æå®¢å¿«è¨Š</title><meta property="og:title" content="ã€Œasp.net core ç³»åˆ—ã€12 æ•¸æ“šåŠ å¯†ç®—æ³•ï¼ˆå¸¸è¦‹åŠ å¯†ç®—æ³•ï¼‰ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/dfic-imagehandler/335a391e-e2b1-4ea2-b20d-51cacaf5c5f5"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b152446.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b152446.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b152446.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b152446.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b152446.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b152446.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b152446.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b152446.html><meta property="article:published_time" content="2020-10-29T20:52:29+08:00"><meta property="article:modified_time" content="2020-10-29T20:52:29+08:00"><meta name=Keywords content><meta name=description content="ã€Œasp.net core ç³»åˆ—ã€12 æ•¸æ“šåŠ å¯†ç®—æ³•ï¼ˆå¸¸è¦‹åŠ å¯†ç®—æ³•ï¼‰"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/b152446.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>ã€Œasp.net core ç³»åˆ—ã€12 æ•¸æ“šåŠ å¯†ç®—æ³•ï¼ˆå¸¸è¦‹åŠ å¯†ç®—æ³•ï¼‰</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><h1 class="md-end-block md-heading">0. å‰è¨€</h1><p>é€™ä¸€ç¯‡æˆ‘å€‘å°‡ä»‹ç´¹ä¸€ä¸‹.net core çš„åŠ å¯†å’Œè§£å¯†ã€‚åœ¨Webæ‡‰ç”¨ç¨‹åºä¸­ï¼Œç”¨æˆ¶çš„å¯†ç¢¼æœƒä½¿ç”¨MD5å€¼ä½œç‚ºå¯†ç¢¼æ•¸æ“šå­˜å„²èµ·ä¾†ã€‚è€Œåœ¨å…¶ä»–çš„æƒ…æ³ä¸‹ï¼Œä¹Ÿæœƒä½¿ç”¨åŠ å¯†å’Œè§£å¯†çš„åŠŸèƒ½ã€‚</p><p>å¸¸è¦‹çš„åŠ å¯†ç®—æ³•åˆ†ç‚ºå°ç¨±åŠ å¯†å’Œéå°ç¨±åŠ å¯†ã€‚æ‰€è¬‚çš„å°ç¨±åŠ å¯†æ˜¯æŒ‡åŠ å¯†å¯†é‘°å’Œè§£å¯†å¯†é‘°æ˜¯åŒä¸€å€‹ï¼Œéå°ç¨±åŠ å¯†æ˜¯å€¼åŠ å¯†å¯†é‘°å’Œè§£å¯†å¯†é‘°ä¸åŒã€‚è€Œæˆ‘å€‘å¸¸æ‡‰ç”¨åœ¨ä¿å­˜ç”¨æˆ¶ç™»éŒ„å¯†ç¢¼é€™å€‹éç¨‹ä¸­çš„MD5æœ¬è³ªä¸Šä¸¦ä¸æ˜¯åŠ å¯†ç®—æ³•ï¼Œè€Œæ˜¯ä¸€ç¨®ä¿¡æ¯æ‘˜è¦ç®—æ³•ã€‚ä¸éMD5å„˜é‡ä¿è­‰äº†æ¯å€‹å­—ç¬¦ä¸²æœ€å¾Œè¨ˆç®—å‡ºä¾†çš„å€¼éƒ½ä¸ä¸€æ¨£ï¼Œæ‰€ä»¥åœ¨å¯†ç¢¼ä¿å­˜ä¸­å¸¸ç”¨MD5ä½œç‚ºä¿å¯†å€¼ã€‚</p><p><br></p><div class=pgc-img><img alt="ã€Œasp.net core ç³»åˆ—ã€12 æ•¸æ“šåŠ å¯†ç®—æ³•ï¼ˆå¸¸è¦‹åŠ å¯†ç®—æ³•ï¼‰" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/335a391e-e2b1-4ea2-b20d-51cacaf5c5f5><p class=pgc-img-caption></p></div><p><br></p><h1 class="md-end-block md-heading">1. å¸¸è¦‹å°ç¨±åŠ å¯†ç®—æ³•</h1><p>å°ç¨±åŠ å¯†ç®—æ³•ï¼Œç°¡å–®çš„èªªå°±æ˜¯åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é‘°é€²è¡Œé‹ç®—ã€‚å°æ–¼å¤§å¤šæ•¸åŠ å¯†ç®—æ³•ï¼Œè§£å¯†å’ŒåŠ å¯†æ˜¯ä¸€å€‹äº’é€†çš„é‹ç®—ã€‚å°ç¨±åŠ å¯†ç®—æ³•çš„å®‰å…¨æ€§å–æ±ºæ–¼å¯†é‘°çš„é•·åº¦ï¼Œå¯†é‘°è¶Šé•·è¶Šå®‰å…¨ã€‚ç•¶ç„¶ï¼Œä¸å»ºè­°ä½¿ç”¨éé•·çš„å¯†é‘°ã€‚</p><p>é‚£éº¼ï¼Œæˆ‘å€‘ä¾†çœ‹çœ‹å¸¸è¦‹çš„å°ç¨±åŠ å¯†ç®—æ³•æœ‰å“ªäº›å§ï¼Œä»¥åŠC#è©²å¦‚ä½•å¯¦ç¾ã€‚</p><h2 class="md-end-block md-heading">1.1 DES å’Œ DESede ç®—æ³•</h2><p>DESç®—æ³•å’ŒDESedeç®—æ³•ï¼ˆåˆç¨±ä¸‰é‡DESç®—æ³•ï¼‰ çµ±ç¨±DESç³»åˆ—ç®—æ³•ã€‚DESå…¨ç¨±ç‚ºData Encryption Standardï¼Œå³æ•¸æ“šåŠ å¯†æ¨™æº–ï¼Œæ˜¯ä¸€ç¨®ä½¿ç”¨å¯†é‘°åŠ å¯†çš„å¡Šç®—æ³•ã€‚è€ŒDESedeå°±æ˜¯é‡å°åŒä¸€å¡Šæ•¸æ“šåšä¸‰æ¬¡DESåŠ å¯†ã€‚é€™è£¡å°±ä¸å°åŸç†åšéå¤šçš„ä»‹ç´¹äº†ï¼Œä¾†çœ‹çœ‹.net coreè£¡å¦‚ä½•å¯¦ç¾DESåŠ /è§£å¯†å§ã€‚</p><p>åœ¨Utilsé …ç›®è£¡ï¼Œå‰µå»ºç›®éŒ„Securityï¼š</p><p>åœ¨Securityç›®éŒ„ä¸‹ï¼Œå‰µå»ºDESHelperé¡ï¼š</p><pre><code>namespace Utils.Security{ Â  Â public class DesHelper Â   { Â  Â  Â  Â  Â   }}</code></pre><p>åŠ å¯†è§£å¯†å¯¦ç¾ï¼š</p><pre><code>using System;using System.IO;using System.Security.Cryptography;using System.Text;â€‹namespace Utils.Security{ Â  Â public static class DesHelper Â   { Â  Â  Â  Â static DesHelper() Â  Â  Â   { Â  Â  Â  Â  Â  Â DesHandler = Â DES.Create("DES"); Â  Â  Â  Â  Â  Â DesHandler.Key = Convert.FromBase64String("L1yzjGB2sI4="); Â  Â  Â  Â  Â  Â DesHandler.IV = Convert.FromBase64String("uEcGI4JSAuY="); Â  Â  Â   }â€‹ Â  Â  Â  Â private static DES DesHandler { get; }â€‹ Â  Â  Â  Â /// &lt;summary&gt; Â  Â  Â  Â /// åŠ å¯†å­—ç¬¦ Â  Â  Â  Â /// &lt;/summary&gt; Â  Â  Â  Â /// &lt;param name="source"&gt;&lt;/param&gt; Â  Â  Â  Â /// &lt;returns&gt;&lt;/returns&gt; Â  Â  Â  Â public static string Encrypt(string source) Â  Â  Â   { Â  Â  Â  Â  Â  Â try Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â using (var memStream = new MemoryStream()) Â  Â  Â  Â  Â  Â  Â  Â using (var cryptStream = new CryptoStream(memStream, DesHandler.CreateEncryptor(DesHandler.Key, DesHandler.IV), Â  Â  Â  Â  Â  Â  Â  Â  Â  Â CryptoStreamMode.Write)) Â  Â  Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â  Â  Â var bytes = Encoding.UTF8.GetBytes(source); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â cryptStream.Write(bytes, 0, bytes.Length); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â cryptStream.FlushFinalBlock(); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return Convert.ToBase64String(memStream.ToArray()); Â  Â  Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â  Â catch (Exception e) Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â Console.WriteLine(e); Â  Â  Â  Â  Â  Â  Â  Â return null; Â  Â  Â  Â  Â   } Â  Â  Â   }â€‹ Â  Â  Â  Â /// &lt;summary&gt; Â  Â  Â  Â /// è§£å¯† Â  Â  Â  Â /// &lt;/summary&gt; Â  Â  Â  Â /// &lt;param name="source"&gt;&lt;/param&gt; Â  Â  Â  Â /// &lt;returns&gt;&lt;/returns&gt; Â  Â  Â  Â public static string Decrypt(string source) Â  Â  Â   { Â  Â  Â  Â  Â  Â try Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â using (var mStream = new MemoryStream(Convert.FromBase64String(source))) Â  Â  Â  Â  Â  Â  Â  Â using (var cryptoStream = Â  Â  Â  Â  Â  Â  Â  Â  Â  Â new CryptoStream(mStream, DesHandler.CreateDecryptor(DesHandler.Key, DesHandler.IV), CryptoStreamMode.Read)) Â  Â  Â  Â  Â  Â  Â  Â using (var reader = new StreamReader(cryptoStream)) Â  Â  Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return reader.ReadToEnd(); Â  Â  Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â  Â catch (Exception e) Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â Console.WriteLine(e); Â  Â  Â  Â  Â  Â  Â  Â return null; Â  Â  Â  Â  Â   } Â  Â  Â   } Â   }}</code></pre><p>æ¯æ¬¡èª¿ç”¨DesHandler = DES.Create("DES"); éƒ½æœƒé‡æ–°ç²å¾—ä¸€å€‹DESç®—æ³•å¯¦ç¾å¯¦ä¾‹ï¼Œé€™æ¨£æ¯æ¬¡ç²å–çš„å¯¦ä¾‹ä¸­Keyã€IVé€™å…©å€‹å±¬æ€§çš„å€¼ä¹Ÿæœƒç™¼ç”Ÿè®ŠåŒ–ã€‚å¦‚æœç›´æ¥ä½¿ç”¨æœƒå‡ºç¾é€™æ¬¡åŠ å¯†çš„æ•¸æ“šä¸‹æ¬¡å°±æ²’æ³•è§£å¯†äº†ï¼Œç‚ºäº†æ¸›å°‘é€™ç¨®æƒ…æ³ï¼Œæ‰€ä»¥ä»£ç¢¼è™•æ‰‹å‹•è³¦å€¼äº†Keyã€IVé€™å…©å€‹å±¬æ€§ã€‚</p><p><br></p><h2 class="md-end-block md-heading">1.2 AES åŠ å¯†ç®—æ³•</h2><p>AESç®—æ³•ï¼ˆAdvanced Encryption Standardï¼‰ä¹Ÿå°±æ˜¯é«˜ç´šæ•¸æ“šåŠ å¯†æ¨™æº–ç®—æ³•ï¼Œæ˜¯ç‚ºäº†è§£æ±ºDESç®—æ³•ä¸­çš„å­˜åœ¨çš„æ¼æ´è€Œæå‡ºçš„ç®—æ³•æ¨™æº–ã€‚ç¾è¡Œçš„AESç®—æ³•æ ¸å¿ƒæ˜¯Rijndaelç®—æ³•ã€‚ç•¶ç„¶äº†ï¼Œé€™å€‹ä¸ç”¨å¤ªéæ–¼é—œå¿ƒã€‚æˆ‘å€‘ç›´æ¥çœ‹çœ‹æ˜¯å¦‚ä½•å¯¦ç¾å§ï¼š</p><p>åŒæ¨£ï¼Œåœ¨Securityç›®éŒ„å‰µå»ºä¸€å€‹AesHelperé¡ï¼š</p><pre><code>namespace Utils.Security{ Â  Â public static class AesHelper Â   { Â  Â  Â  Â  Â   }}</code></pre><p>å…·é«”çš„åŠ è§£å¯†å¯¦ç¾ï¼š</p><pre><code>using System;using System.IO;using System.Security.Cryptography;â€‹namespace Utils.Security{ Â  Â public static class AesHelper Â   { Â  Â  Â  Â static AesHelper() Â  Â  Â   { Â  Â  Â  Â  Â  Â AesHandler = Aes.Create(); Â  Â  Â  Â  Â  Â AesHandler.Key = Convert.FromBase64String("lB2BxrJdI4UUjK3KEZyQ0obuSgavB1SYJuAFq9oVw0Y="); Â  Â  Â  Â  Â  Â AesHandler.IV = Convert.FromBase64String("6lra6ceX26Fazwj1R4PCOg=="); Â  Â  Â   }â€‹ Â  Â  Â  Â private static Aes AesHandler { get; }â€‹ Â  Â  Â  Â public static string Encrypt(string source) Â  Â  Â   { Â  Â  Â  Â  Â  Â using (var mem = new MemoryStream()) Â  Â  Â  Â  Â  Â using (var stream = new CryptoStream(mem, AesHandler.CreateEncryptor(AesHandler.Key, AesHandler.IV), Â  Â  Â  Â  Â  Â  Â  Â CryptoStreamMode.Write)) Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â using (var writer = new StreamWriter(stream)) Â  Â  Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â  Â  Â writer.Write(source); Â  Â  Â  Â  Â  Â  Â   } Â   Â  Â  Â  Â  Â  Â  Â  Â return Convert.ToBase64String(mem.ToArray()); Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â  Â  Â  Â  Â   }â€‹ Â  Â  Â  Â public static string Decrypt(string source) Â  Â  Â   { Â  Â  Â  Â  Â  Â var data = Convert.FromBase64String(source); Â  Â  Â  Â  Â  Â using (var mem = new MemoryStream(data)) Â  Â  Â  Â  Â  Â using (var crypto = new CryptoStream(mem, AesHandler.CreateDecryptor(AesHandler.Key, AesHandler.IV), Â  Â  Â  Â  Â  Â  Â  Â CryptoStreamMode.Read)) Â  Â  Â  Â  Â  Â using (var reader = new StreamReader(crypto)) Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â return reader.ReadToEnd(); Â  Â  Â  Â  Â   } Â  Â  Â   } Â   }}</code></pre><p><br></p><div class=pgc-img><img alt="ã€Œasp.net core ç³»åˆ—ã€12 æ•¸æ“šåŠ å¯†ç®—æ³•ï¼ˆå¸¸è¦‹åŠ å¯†ç®—æ³•ï¼‰" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/72a70d8c-7e00-49fd-a447-0b03630f3d0d><p class=pgc-img-caption></p></div><p><br></p><h1 class="md-end-block md-heading">2. å¸¸è¦‹éå°ç¨±åŠ å¯†ç®—æ³•</h1><p>éå°ç¨±åŠ å¯†ç®—æ³•ï¼ŒæŒ‡çš„æ˜¯åŠ å¯†å¯†é‘°å’Œè§£å¯†å¯†é‘°ä¸¦ä¸ç›¸åŒã€‚éå°ç¨±åŠ å¯†ç®—æ³•çš„å¯†é‘°é€šå¸¸æˆå°å‡ºç¾ï¼Œåˆ†ç‚ºå…¬é–‹å¯†é‘°å’Œç§æœ‰å¯†é‘°ã€‚å…¬é–‹å¯†é‘°å¯ä»¥ä»¥å…¬é–‹çš„å½¢å¼ç™¼çµ¦æ•¸æ“šäº¤äº’æ–¹ï¼Œè€Œä¸æœƒç”¢ç”Ÿæ´©å¯†çš„é¢¨éšªã€‚å› ç‚ºéå°ç¨±åŠ å¯†ç®—æ³•ï¼Œç„¡æ³•é€šéå…¬é–‹å¯†é‘°æ¨ç®—ç§æœ‰å¯†é‘°ï¼Œåä¹‹äº¦ç„¶ã€‚</p><p>é€šå¸¸ï¼Œéå°ç¨±åŠ å¯†ç®—æ³•æ˜¯ç”¨å…¬é‘°é€²è¡ŒåŠ å¯†ï¼Œä½¿ç”¨ç§é‘°é€²è¡Œè§£å¯†ã€‚</p><h2 class="md-end-block md-heading">2.1 RSAç®—æ³•</h2><p>RSAç®—æ³•æ˜¯æ¨™æº–çš„éå°ç¨±åŠ å¯†ç®—æ³•ï¼Œåå­—ä¾†æºæ˜¯ä¸‰ä½ç™¼æ˜è€…çš„å§“æ°é¦–å­—æ¯ã€‚RSAå…¬é–‹å¯†é‘°å¯†ç¢¼é«”åˆ¶æ˜¯ä¸€ç¨®ä½¿ç”¨ä¸åŒçš„åŠ å¯†å¯†é‘°èˆ‡è§£å¯†å¯†é‘°ï¼Œâ€œç”±å·²çŸ¥åŠ å¯†å¯†é‘°æ¨å°å‡ºè§£å¯†å¯†é‘°åœ¨è¨ˆç®—ä¸Šæ˜¯ä¸å¯è¡Œçš„â€å¯†ç¢¼é«”åˆ¶ ã€‚å…¶å®‰å…¨æ€§å–æ±ºæ–¼å¯†é‘°çš„é•·åº¦ï¼Œ1024ä½çš„å¯†é‘°å¹¾ä¹ä¸å¯èƒ½è¢«ç ´è§£ã€‚</p><p>åŒæ¨£ï¼Œåœ¨Utils.Securityä¸‹å‰µå»ºRSAHelperé¡ï¼š</p><pre><code>namespace Utils.Security{ Â  Â public static class RsaHelper Â   { Â  Â  Â  Â  Â   }}</code></pre><p>å…·é«”å¯¦ç¾ï¼š</p><pre><code>using System;using System.Security.Cryptography;â€‹namespace Utils.Security{ Â  Â public static class RsaHelper Â   { Â  Â  Â  Â public static RSAParameters PublicKey { get; private set; } Â  Â  Â  Â public static RSAParameters PrivateKey { get; private set; }â€‹ Â  Â  Â  Â static RsaHelper() Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â  Â   }â€‹ Â  Â  Â  Â public static void InitWindows() Â  Â  Â   { Â  Â  Â  Â  Â  Â var parameters = new CspParameters() Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â KeyContainerName = "RSAHELPER" // é»˜èªçš„RSAä¿å­˜å¯†é‘°çš„å®¹å™¨åç¨± Â  Â  Â  Â  Â   }; Â  Â  Â  Â  Â  Â var handle = new RSACryptoServiceProvider(parameters); Â  Â  Â  Â  Â  Â PublicKey = handle.ExportParameters(false); Â  Â  Â  Â  Â  Â PrivateKey = handle.ExportParameters(true); Â  Â  Â   }â€‹ Â  Â  Â  Â public static void ExportKeyPair(string publicKeyXmlString, string privateKeyXmlString) Â  Â  Â   { Â  Â  Â  Â  Â  Â var handle Â = new RSACryptoServiceProvider(); Â  Â  Â  Â  Â  Â handle.FromXmlString(privateKeyXmlString); Â  Â  Â  Â  Â  Â PrivateKey = handle.ExportParameters(true); Â  Â  Â  Â  Â  Â handle.FromXmlString(publicKeyXmlString); Â  Â  Â  Â  Â  Â PublicKey = handle.ExportParameters(false); Â  Â  Â   } Â  Â  Â  Â public static byte[] Encrypt(byte[] dataToEncrypt) Â  Â  Â   { Â  Â  Â  Â  Â  Â try Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â byte[] encryptedData; Â  Â  Â  Â  Â  Â  Â  Â using (RSACryptoServiceProvider RSA = new RSACryptoServiceProvider()) Â  Â  Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â  Â  Â RSA.ImportParameters(PublicKey); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â encryptedData = RSA.Encrypt(dataToEncrypt, true); Â  Â  Â  Â  Â  Â  Â   }â€‹ Â  Â  Â  Â  Â  Â  Â  Â return encryptedData; Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â  Â catch (CryptographicException e) Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â Console.WriteLine(e.Message); Â  Â  Â  Â  Â  Â  Â  Â return null; Â  Â  Â  Â  Â   } Â  Â  Â   }â€‹ Â  Â  Â  Â public static byte[] Decrypt(byte[] dataToDecrypt) Â  Â  Â   { Â  Â  Â  Â  Â  Â try Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â byte[] decryptedData; Â  Â  Â  Â  Â  Â  Â  Â using (var rsa = new RSACryptoServiceProvider()) Â  Â  Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â  Â  Â rsa.ImportParameters(PrivateKey); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â decryptedData = rsa.Decrypt(dataToDecrypt, true); Â  Â  Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â  Â  Â  Â return decryptedData; Â  Â  Â  Â  Â   } Â  Â  Â  Â  Â  Â catch (CryptographicException e) Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â Console.WriteLine(e.ToString()); Â  Â  Â  Â  Â  Â  Â  Â return null; Â  Â  Â  Â  Â   } Â  Â  Â   } Â   }}</code></pre><p>å› ç‚ºRSAçš„ç‰¹æ®Šæ€§ï¼Œéœ€è¦é å…ˆè¨­ç½®å¥½å…¬é‘°å’Œç§é‘°ã€‚C# æ”¯æŒå¤šç¨®æ–¹å¼å°å…¥å¯†é‘°ï¼Œé€™è£¡å°±ä¸åšéå¤šä»‹ç´¹äº†ã€‚</p><p><br></p><div class=pgc-img><img alt="ã€Œasp.net core ç³»åˆ—ã€12 æ•¸æ“šåŠ å¯†ç®—æ³•ï¼ˆå¸¸è¦‹åŠ å¯†ç®—æ³•ï¼‰" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/dfic-imagehandler/3ee51ffc-67e7-4752-a321-9fb60165d97b><p class=pgc-img-caption></p></div><p><br></p><h1 class="md-end-block md-heading">3. ä¿¡æ¯æ‘˜è¦ç®—æ³•</h1><p>é€™ç¨®ç®—æ³•åš´æ ¼æ„ç¾©ä¸Šä¸¦ä¸æ˜¯åŠ å¯†ç®—æ³•ï¼Œå› ç‚ºå®ƒå®Œå…¨ä¸å¯é€†ã€‚ä¹Ÿå°±æ˜¯èªªï¼Œä¸€æ—¦é€²è¡Œä½¿ç”¨è©²é¡å‹ç®—æ³•åŠ å¯†å¾Œï¼Œç„¡æ³•è§£å¯†é‚„åŸå‡ºæ•¸æ“šã€‚ç•¶ç„¶äº†ï¼Œä¹Ÿæ­£æ˜¯å› ç‚ºé€™ç¨®ç‰¹æ€§å¸¸å¸¸è¢«ç”¨ä¾†åšå¯†ç¢¼çš„ä¿å­˜ã€‚å› ç‚ºé€™æ¨£å¯ä»¥é¿å…æŸäº›äººæ‹¿åˆ°æ•¸æ“šåº«èˆ‡ä»£ç¢¼å¾Œï¼Œå¯ä»¥ç°¡å–®åæ¨å‡ºç”¨æˆ¶çš„å¯†ç¢¼ã€‚</p><h2 class="md-end-block md-heading">3.1 MD5ç®—æ³•</h2><p>æœ€å¸¸ç”¨çš„ä¿¡æ¯æ‘˜è¦ç®—æ³•å°±æ˜¯MD5 åŠ å¯†ç®—æ³•ï¼ŒMD5ä¿¡æ¯æ‘˜è¦ç®—æ³•ï¼ˆè‹±èªï¼šMD5 Message-Digest Algorithmï¼‰ï¼Œä¸€ç¨®è¢«å»£æ³›ä½¿ç”¨çš„å¯†ç¢¼æ•£åˆ—å‡½æ•¸ï¼Œå¯ä»¥ç”¢ç”Ÿå‡ºä¸€å€‹128ä½ï¼ˆ16å­—ç¯€ï¼‰çš„æ•£åˆ—å€¼ï¼ˆhash valueï¼‰ï¼Œç”¨æ–¼ç¢ºä¿ä¿¡æ¯å‚³è¼¸å®Œæ•´ä¸€è‡´ã€‚</p><p>åŸç†ä¸è§£é‡‹ï¼Œæˆ‘å€‘çœ‹ä¸‹å¦‚ä½•å¯¦ç¾ï¼Œç…§ä¾‹ç¾åœ¨Securityä¸‹å‰µå»ºMD5Helperï¼š</p><pre><code>namespace Utils.Security{ Â  Â public static class Md5Helper Â   { Â  Â  Â  Â  Â   }}</code></pre><p>å…·é«”å¯¦ç¾ï¼š</p><pre><code>using System.Security.Cryptography;using System.Text;â€‹namespace Utils.Security{ Â  Â public static class Md5Helper Â   { Â  Â  Â  Â private static MD5 Hanlder { get; } = new MD5CryptoServiceProvider();â€‹ Â  Â  Â  Â public static string GetMd5Str(string source) Â  Â  Â   { Â  Â  Â  Â  Â  Â var data = Encoding.UTF8.GetBytes(source); Â  Â  Â  Â  Â  Â var security = Hanlder.ComputeHash(data); Â  Â  Â  Â  Â  Â var sb = new StringBuilder(); Â  Â  Â  Â  Â  Â foreach (var b in security) Â  Â  Â  Â  Â   { Â  Â  Â  Â  Â  Â  Â  Â sb.Append(b.ToString("X2")); Â  Â  Â  Â  Â   }â€‹ Â  Â  Â  Â  Â  Â return sb.ToString(); Â  Â  Â   } Â   }}</code></pre><p><br></p><h1 class="md-end-block md-heading">4 ç¸½çµ</h1><p>é€™ä¸€ç¯‡ç°¡å–®ä»‹ç´¹äº†å››ç¨®å¸¸ç”¨çš„åŠ å¯†ç®—æ³•çš„å¯¦ç¾ï¼Œç•¶ç„¶æœ€å¸¸ç”¨çš„å°±æ˜¯ MD5ï¼Œå› ç‚ºé€™å€‹æ˜¯å¤§å¤šæ•¸ç³»çµ±ç”¨ä¾†åšå¯†ç¢¼ä¿å­˜çš„åŠ å¯†ç®—æ³•ã€‚</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>åŠ å¯†ç®—æ³•</a></li><li><a>asp</a></li><li><a>net</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/a25d86b.html alt="ã€Œasp.net core ç³»åˆ—ã€ å±¬æ€§è·¯ç”±çš„è¨­ç½®" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/00a605c45f9d4b0a811158b81b2318b5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a25d86b.html title="ã€Œasp.net core ç³»åˆ—ã€ å±¬æ€§è·¯ç”±çš„è¨­ç½®">ã€Œasp.net core ç³»åˆ—ã€ å±¬æ€§è·¯ç”±çš„è¨­ç½®</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d6f37ae2.html alt=".net Socketé€šä¿¡å¯¦é«”å”è­°è½‰æ›" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1535627546473b94af494cb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d6f37ae2.html title=".net Socketé€šä¿¡å¯¦é«”å”è­°è½‰æ›">.net Socketé€šä¿¡å¯¦é«”å”è­°è½‰æ›</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/32ee6540.html alt=JAVAä¸ŠåŠ å¯†ç®—æ³•çš„å¯¦ç¾ç”¨ä¾‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6aa97b7dfebc473ebb4ea11cc67c6614 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/32ee6540.html title=JAVAä¸ŠåŠ å¯†ç®—æ³•çš„å¯¦ç¾ç”¨ä¾‹>JAVAä¸ŠåŠ å¯†ç®—æ³•çš„å¯¦ç¾ç”¨ä¾‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8ad3e14e.html alt=æ¶æ§‹å¸«åŸºç¤ï¼šå°ç¨±å¯†é‘°åŠ å¯†ç®—æ³•ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/bfcf850c-1bdf-44e3-995d-1667bb3c3a02 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8ad3e14e.html title=æ¶æ§‹å¸«åŸºç¤ï¼šå°ç¨±å¯†é‘°åŠ å¯†ç®—æ³•ï¼Ÿ>æ¶æ§‹å¸«åŸºç¤ï¼šå°ç¨±å¯†é‘°åŠ å¯†ç®—æ³•ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6ca2762d.html alt=å¯†ç¢¼å­¸åŸºç¤ï¼šAESåŠ å¯†ç®—æ³• class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/deb209a70991491a8637d3fbe44268b7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6ca2762d.html title=å¯†ç¢¼å­¸åŸºç¤ï¼šAESåŠ å¯†ç®—æ³•>å¯†ç¢¼å­¸åŸºç¤ï¼šAESåŠ å¯†ç®—æ³•</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/d119f135.html alt=å€å¡Šéˆä¸­çš„å¯†ç¢¼å­¸ç³»åˆ—ä¹‹å°ç¨±åŠ å¯†ç®—æ³•DESï¼ˆå…­ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/c49c7b9451f240e0a851fd35325cbc71 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/d119f135.html title=å€å¡Šéˆä¸­çš„å¯†ç¢¼å­¸ç³»åˆ—ä¹‹å°ç¨±åŠ å¯†ç®—æ³•DESï¼ˆå…­ï¼‰>å€å¡Šéˆä¸­çš„å¯†ç¢¼å­¸ç³»åˆ—ä¹‹å°ç¨±åŠ å¯†ç®—æ³•DESï¼ˆå…­ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/70493177.html alt=ç¸±è§€åŠ å¯†ç®—æ³•çš„æŠ€è¡“ç™¼å±•è·¯ç·š class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7de85cc97db4425299197a9088f3d8c6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/70493177.html title=ç¸±è§€åŠ å¯†ç®—æ³•çš„æŠ€è¡“ç™¼å±•è·¯ç·š>ç¸±è§€åŠ å¯†ç®—æ³•çš„æŠ€è¡“ç™¼å±•è·¯ç·š</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/8813a52e.html alt=åŸºæ–¼3D-LSCMçš„åœ–åƒæ··æ²ŒåŠ å¯†ç®—æ³• class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/Ro5r3ywEg0wfuC style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/8813a52e.html title=åŸºæ–¼3D-LSCMçš„åœ–åƒæ··æ²ŒåŠ å¯†ç®—æ³•>åŸºæ–¼3D-LSCMçš„åœ–åƒæ··æ²ŒåŠ å¯†ç®—æ³•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ce92e32b.html alt=AESåŠ å¯†ç®—æ³•æµç¨‹ä»‹ç´¹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/810ceabb43b94c2a8d126c271c2c998a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ce92e32b.html title=AESåŠ å¯†ç®—æ³•æµç¨‹ä»‹ç´¹>AESåŠ å¯†ç®—æ³•æµç¨‹ä»‹ç´¹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/eca4add1.html alt=åŠ å¯†ç®—æ³•å­¸ç¿’ï¼ˆä¸‰ï¼‰ä¹‹AESåŠ å¯† class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/d531d9c2-4c0a-4abf-bdfb-aded253aa742 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/eca4add1.html title=åŠ å¯†ç®—æ³•å­¸ç¿’ï¼ˆä¸‰ï¼‰ä¹‹AESåŠ å¯†>åŠ å¯†ç®—æ³•å­¸ç¿’ï¼ˆä¸‰ï¼‰ä¹‹AESåŠ å¯†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3c573709.html alt=å°ç¨±åŠ å¯†ç®—æ³•å’Œéå°ç¨±åŠ å¯†ç®—æ³• class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/36aa3af1a53f48b998bfb35b9f90f786 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3c573709.html title=å°ç¨±åŠ å¯†ç®—æ³•å’Œéå°ç¨±åŠ å¯†ç®—æ³•>å°ç¨±åŠ å¯†ç®—æ³•å’Œéå°ç¨±åŠ å¯†ç®—æ³•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d95b40b8.html alt=æ•¸æ“šåŠ å¯†ç®—æ³•èˆ‡è³ªæ•¸ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/bebad180331a456a93c8d1f8ee1b47bf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d95b40b8.html title=æ•¸æ“šåŠ å¯†ç®—æ³•èˆ‡è³ªæ•¸>æ•¸æ“šåŠ å¯†ç®—æ³•èˆ‡è³ªæ•¸</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fc9b15f2.html alt=ç”¨å¯¦ä¾‹çµ¦æ–°æ‰‹è¬›è§£RSAåŠ å¯†ç®—æ³• class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/44c32b49a3d14b59a4a1e6cc11dd064e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fc9b15f2.html title=ç”¨å¯¦ä¾‹çµ¦æ–°æ‰‹è¬›è§£RSAåŠ å¯†ç®—æ³•>ç”¨å¯¦ä¾‹çµ¦æ–°æ‰‹è¬›è§£RSAåŠ å¯†ç®—æ³•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9fa1e7d9.html alt=æ¼«éŠå°ç¨±åŠ å¯†ç®—æ³• class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/8939f77805e342b2b00b2d9061c127bf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9fa1e7d9.html title=æ¼«éŠå°ç¨±åŠ å¯†ç®—æ³•>æ¼«éŠå°ç¨±åŠ å¯†ç®—æ³•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7b535bd.html alt=æ•¸æ“šå®‰å…¨ç®¡ç†ï¼šRSAåŠ å¯†ç®—æ³•ï¼Œç°½åé©—ç±¤æµç¨‹è©³è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/54fdd0ce6e2149d08cf8e21ff0ea8b49 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7b535bd.html title=æ•¸æ“šå®‰å…¨ç®¡ç†ï¼šRSAåŠ å¯†ç®—æ³•ï¼Œç°½åé©—ç±¤æµç¨‹è©³è§£>æ•¸æ“šå®‰å…¨ç®¡ç†ï¼šRSAåŠ å¯†ç®—æ³•ï¼Œç°½åé©—ç±¤æµç¨‹è©³è§£</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>