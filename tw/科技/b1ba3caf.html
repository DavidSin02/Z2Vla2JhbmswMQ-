<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>教你學Python30-支持向量機SVM基礎 | 极客快訊</title><meta property="og:title" content="教你學Python30-支持向量機SVM基礎 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/07db0cc84ff24bd5ae7a4632bd7f97b3"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b1ba3caf.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b1ba3caf.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b1ba3caf.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b1ba3caf.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b1ba3caf.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b1ba3caf.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b1ba3caf.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b1ba3caf.html><meta property="article:published_time" content="2020-10-29T21:09:42+08:00"><meta property="article:modified_time" content="2020-10-29T21:09:42+08:00"><meta name=Keywords content><meta name=description content="教你學Python30-支持向量機SVM基礎"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/b1ba3caf.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>教你學Python30-支持向量機SVM基礎</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>​</h1><h3 class=pgc-h-arrow-right>一、前言</h3><p>對於SVM這個理論，本人感覺是非常難理解的 借鑑了很多大佬的筆記和視頻 還是想以自己能理解的方式進行闡述清楚SVM是什麼東西 他的具體實現 所以我儘量少點涉及公式什麼的 通俗的介紹SVM</p><h3 class=pgc-h-arrow-right>二、什麼是SVM</h3><p>SVM的英文全稱是Support Vector Machines，我們叫它支持向量機。支持向量機是我們用於分類的一種算法。讓我們以一個小故事的形式，開啟我們的SVM之旅吧。</p><p>在很久以前的情人節，一位大俠要去救他的愛人，但天空中的魔鬼和他玩了一個遊戲。</p><p>魔鬼在桌子上似乎有規律放了兩種顏色的球，說："你用一根棍分開它們？要求：儘量在放更多球之後，仍然適用。"</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/07db0cc84ff24bd5ae7a4632bd7f97b3><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>於是大俠這樣放，乾的不錯？</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c140f694950f44a095a11c8063811d5a><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>然後魔鬼，又在桌上放了更多的球，似乎有一個球站錯了陣營。顯然，大俠需要對棍做出調整。</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fa31c3081c04446181a65fd679864e86><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p><strong>SVM就是試圖把棍放在最佳位置，好讓在棍的兩邊有儘可能大的間隔。這個間隔就是球到棍的距離。</strong></p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5a583da11e3443129d893f6061c1ba11><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>現在好了，即使魔鬼放了更多的球，棍仍然是一個好的分界線。</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/54ed7e9f305a45bd83d6bd9156eee3a6><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>魔鬼看到大俠已經學會了一個trick(方法、招式)，於是魔鬼給了大俠一個新的挑戰。</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3353c09e7ebd41f58571aaeed7db371f><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>現在，大俠沒有棍可以很好幫他分開兩種球了，現在怎麼辦呢？當然像所有武俠片中一樣大俠桌子一拍，球飛到空中。然後，憑藉大俠的輕功，大俠抓起一張紙，插到了兩種球的中間。</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ca6ec6913fcb43f6b8bf691aea5eec00><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>現在，從空中的魔鬼的角度看這些球，這些球看起來像是被一條曲線分開了。</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d589d0a04c1543e58da303511ea3ca63><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>再之後，無聊的大人們，把這些球叫做data，把棍子叫做classifier(分類器也可叫做分隔超平面), 找到最大間隔的trick叫做optimization(最優化)，拍桌子叫做kernelling(核函數), 那張紙叫做hyperplane(超平面)。</p><p>更為直觀地感受一下吧(需要翻牆)：https://www.youtube.com/watch?v=3liCbRZPrZA</p><p>概述一下：</p><p>當一個分類問題，數據是線性可分的，也就是用一根棍就可以將兩種小球分開的時候，我們只要將棍的位置放在讓小球距離棍的距離最大化的位置即可，尋找這個最大間隔的過程，就叫做最優化，這條分隔直線稱為分隔超平面(separating hyperplane)。但是，現實往往是很殘酷的，一般的數據是線性不可分的，也就是找不到一個棍將兩種小球很好的分類。這個時候，我們就需要像大俠一樣，將小球拍起，用一張紙代替小棍將小球進行分類。想要讓數據飛起，我們需要的東西就是核函數(kernel)，用於切分小球的紙，就是超平面。</p><p>也許這個時候，你還是似懂非懂，沒關係。根據剛才的描述，可以看出，問題是從線性可分延伸到線性不可分的。那麼，我們就按照這個思路，進行原理性的剖析。</p><h3 class=pgc-h-arrow-right>三、線性SVM</h3><p>先看下線性可分的二分類問題。</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/a802ea3b03b24c4ba6f0791efe2ff105><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>上圖中的(a)是已有的數據，紅色和藍色分別代表兩個不同的類別。數據顯然是線性可分的，但是將兩類數據點分開的直線顯然不止一條。上圖的(b)和(c)分別給出了B、C兩種不同的分類方案，其中黑色實線為分界線，術語稱為‘分隔超平面’。每個分隔超平面對應了一個線性分類器。雖然從分類結果上看，分類器A和分類器B的效果是相同的。但是他們的性能是有差距的，看下圖：</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/356302a304ac47bdac97fb416e2e9069><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>在分隔超平面不變的情況下，我又添加了一個紅點。可以看到，分類器B依然能很好的分類結果，而分類器C則出現了分類錯誤。顯然分類器B的分隔超平面放置的位置優於分類器C的分隔超平面放置的位置，SVM算法也是這麼認為的，它的依據就是分類器B的分類間隔比分類器C的分類間隔大。這裡涉及到第一個SVM獨有的概念"分類間隔"。在保證分隔超平面方向不變且不會出現錯分樣本的情況下移動分隔超平面，會在原來的分隔超平面兩側找到兩個極限位置（越過該位置就會產生錯分現象），如虛線所示。虛線的位置由分隔超平面的方向和距離原分隔超平面最近的幾個樣本的位置決定。而這兩條平行虛線正中間的分界線就是在保持當前分隔超平面方向不變的前提下的最優分隔超平面。兩條虛線之間的垂直距離就是這個最優分隔超平面對應的分類間隔。顯然每一個可能把數據集正確分開的方向都有一個最優分隔超平面（有些方向無論如何移動分隔超平面的位置也不可能將兩類樣本完全分開），而不同方向的最優分隔超平面的分類間隔通常是不同的，那個具有“最大間隔”的分隔超平面就是SVM要尋找的最優解。而這個真正的最優解對應的兩側虛線所穿過的樣本點，就是SVM中的支持樣本點，稱為"支持向量"。也就是圖中被虛線穿過的紅點和藍點裡面有黑色標記的樣本點就是SVM的支持向量。</p><p>ok到這部分我們還沒有涉及到複雜的公式推導 下面我們就會涉及到一點公式推導了 我儘量用簡答明理的方式來說明</p><p>我們求解這個‘分隔超平面’的過程，也就是求出線性可分數據那條分類直線的過程，然後求出最大的分類間隔，就是最優化。</p><p>一個最優化問題通常有兩個基本的因素：1）目標函數，也就是你希望什麼東西的什麼指標達到最好；2）優化對象，你期望通過改變哪些因素來使你的目標函數達到最優。</p><p><strong>(1)"分類間隔"方程</strong></p><p>在線性SVM算法中，目標函數顯然就是那個"分類間隔"，而優化對象則是分隔超平面。</p><p>我們可以看下圖：</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b23a112c2f7b4776ae4f2b1bf63153df><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>分隔超平面的形式可寫成$w^x+b$ 我們已經知道分類間隔的大小實際上就是支持向量(虛線穿過的點)對應的樣本點到分隔超平面的距離的二倍。圖中d求出來就是分類間隔。</p><p>我們高中都學過，點到直線的距離距離公式如下：</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d8f194bad1e743c5bfecc40f82df86ad><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>現在，將直線方程擴展到多維，求得我們現在的超平面方程，對公式進行如下變形：</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e84f32b750a24956942ee08f5eb5e69e><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>我們目的是為了找出一個分類效果好的超平面作為分類器。分類器的好壞的評定依據是分類間隔W=2d的大小，即分類間隔w越大，我們認為這個超平面的分類效果越好。此時，求解超平面的問題就變成了求解分類間隔W最大化的為題。W的最大化也就是d最大化的。</p><p>在這裡我們看到兩條虛線是優化的變量d的取值範圍 也就是在這裡我們設定直線值大於1的是紅色球 小於1的是藍色球</p><p>即：假設超平面可以完全正確地將所有樣本分類，則對於任意一個樣本（xi，yi）來說都有如下性質（注：這裡樣本的類別標籤y_i用+1代表正例，-1代表反例）：</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c5acc460e6a84731a584646ee8177c01><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>上述方程即給出了SVM最優化問題的約束條件。這樣標記方便我們將上述方程變成如下形式：也就可以理解為所有樣本點到直線$wx+b=0$的距離都大於1.</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/49e70562ec644551af440f574c3910ab><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p><strong>（2）"分隔超平面"方程</strong></p><p>我們會頭疼這裡的具體推倒是怎麼產生的那，比如$w^x+b$分隔超平面的公式為什麼寫成這樣 以及從二維的點到直線距離擴展為多維的是怎麼擴展的那 其實是很簡單的 我們來簡單說下</p><p>我們都知道二維空間下一條直線的方式如下所示：$y=ax+b$</p><p>現在我們做個小小的改變，讓原來的x軸變成x1，y軸變成x2：$x_2=ax_1+b$</p><p>移項得：$ax_1-x_2+b=0$</p><p>將公式向量化得：</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0f3f28adde584b08ac92960dbf49263f><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>進一步向量化，用w列向量和x列向量和標量γ進一步向量化：$w^T+b=0$</p><p>其中，向量w和x分別為：</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a5cc2589c0d64ab69cecfc272e511e16><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>二維空間的直線方程已經推導完成，將其推廣到n維空間，就變成了超平面方程。(一個超平面，在二維空間的例子就是一個直線)但是它的公式沒變，依然是：$w^T+b=0$</p><p>不同之處在於：</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b6f223754f214394844913f9525f81a2><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>這樣推倒之後我們可以非常直觀的看出來分隔超平面這條直線和分類間隔是怎麼從一維擴展到多維的了。</p><p><strong>(3)線性SVM優化問題基本描述</strong></p><p>現在整合一下思路，我們已經得到我們的目標函數：</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/b779028ae75f4c81828ec4258fc170b6><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>我們的優化目標是是d最大化。我們已經說過，我們是用支持向量上的樣本點求解d的最大化的問題的。那麼支持向量上的樣本點有什麼特點呢？</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/c75bee40e8064cf5b07a6a42341637a5><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>所有支持向量上的樣本點，都滿足如上公式。如果不贊同，請重看"分類間隔"方程推導過程。也就是這個方程絕對值都是滿足等於1的。</p><p>現在我們就可以將我們的目標函數進一步化簡：</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0eda127768324b0ab8bd0305d1493f3c><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>因為，我們只關心支持向量上的點。隨後我們求解d的最大化問題變成了||w||的最小化問題。進而||w||的最小化問題等效於</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ad75b76ed72a406d96e04ff7190291d9><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>為什麼要做這樣的等效呢？這是為了在進行最優化的過程中對目標函數求導時比較方便，但這絕對不影響最優化問題最後的求解。我們將最終的目標函數和約束條件放在一起進行描述：</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e482506c53bd4d9fa0e5cd6235610bce><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>現在我們的優化問題變成了如上的形式</p><p>這裡n是樣本點的總個數，縮寫s.t.表示"Subject to"，是"服從某某條件"的意思。上述公式描述的是一個典型的不等式約束條件下的二次型函數優化問題，同時也是支持向量機的基本數學模型。</p><p>SVM就是來解決上面這個方程的優化問題。再經過拉格朗日公式和KKT條件等數學運算最後找出分類器定義中的w和b。</p><p>我這樣只是把簡單的SVM最基本的概念講清楚了 對於更復雜的SVM優化問題 以及優化我們可以參照這個網址進行理解：https://cuijiahua.com/blog/2017/11/ml_8_svm_1.html</p><p>總之經過複雜的推論 拉格朗日公式和KKT條件等數學運算之後 現在我們的優化問題變成了如下的形式：</p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f7f4d461694644278e6fdee6ffd7bee7><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p><p>現在我們的優化問題變成了如上的形式。對於這個問題，我們有更高效的優化算法，即序列最小優化（SMO）算法。我們通過這個優化算法能得到α，再根據α，我們就可以求解出w和b，進而求得我們最初的目的：找到分隔超平面。</p><p>下面我們來談談SVM的一種高效的優化算法，序列最小化SMO算法</p><h3 class=pgc-h-arrow-right>四、序列最小化SMO算法</h3><p>對於上面提到的最優化的這個問題，我們有更高效的優化算法，即序列最小優化（SMO）算法。我們通過這個優化算法能得到α，再根據α，我們就可以求解出w和b，進而求得我們最初的目的：找到分隔超平面。</p><h3 class=pgc-h-arrow-right>序列最小優化(Sequential Minimal Optimization, SMO)</h3><ul><li>創建作者：John Platt</li><li>創建時間：1996年</li><li>SMO用途：用於訓練 SVM</li><li>SMO目標：求出一系列 alpha 和 b,一旦求出 alpha，就很容易計算出權重向量 w 並得到分隔超平面。</li><li>SMO思想：是將大優化問題分解為多個小優化問題來求解的。</li><li>SMO原理：每次循環選擇兩個 alpha 進行優化處理，一旦找出一對合適的 alpha，那麼就增大一個同時減少一個。這裡指的合適必須要符合一定的條件這兩個 alpha 必須要在間隔邊界之外這兩個 alpha 還沒有進行過區間化處理或者不在邊界上。</li></ul><p>SMO 偽代碼大致如下：</p><pre><code>創建一個 alpha 向量並將其初始化為0向量當迭代次數小於最大迭代次數時(外循環)    對數據集中的每個數據向量(內循環)：        如果該數據向量可以被優化            隨機選擇另外一個數據向量            同時優化這兩個向量            如果兩個向量都不能被優化，退出內循環    如果所有向量都沒被優化，增加迭代數目，繼續下一次循環</code></pre><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><h3 class=pgc-h-arrow-right>五、編程求解線性SVM</h3><p>已經梳理完了SMO算法實現步驟，接下來按照這個思路編寫代碼，進行實戰練習。</p><p>SVM開發流程</p><ol start=1><li>收集數據：可以使用任意方法。</li><li>準備數據：需要數值型數據。</li><li>分析數據：有助於可視化分隔超平面。</li><li>訓練算法：SVM的大部分時間都源自訓練，該過程主要實現兩個參數的調優。</li><li>測試算法：十分簡單的計算過程就可以實現。</li><li>使用算法：幾乎所有分類問題都可以使用SVM，值得一提的是，SVM本身是一個二類分類器，對多類問題應用SVM需要對代碼做一些修改。</li></ol><p><br></p><p>喜歡點下關注，你的關注是我寫作的最大支持</p><p><br></p><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4e5b16898cf147bd9f60a0ad4cf0a122><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=教你學Python30-支持向量機SVM基礎 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dfb7b7ef19ea482195ec8bf365e4fc65><p class=pgc-img-caption></p></div><p>​</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Python30</a></li><li><a>SVM</a></li><li><a>基礎</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/6d006e47.html alt=鋼結構設計基礎知識問答 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/63b48928-d7cd-4346-b80f-4f77015517c1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6d006e47.html title=鋼結構設計基礎知識問答>鋼結構設計基礎知識問答</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/775df7fb.html alt=素描五官基礎知識，學素描的同學可參考 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/99b7762898d34e2f9a667c431fc7da6b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/775df7fb.html title=素描五官基礎知識，學素描的同學可參考>素描五官基礎知識，學素描的同學可參考</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c480db6b.html alt=梯度，散度，旋度的重要基礎：對向量場的詮釋 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/c8ce2cc3bb0f4a5da0dcbc0a881f9617 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c480db6b.html title=梯度，散度，旋度的重要基礎：對向量場的詮釋>梯度，散度，旋度的重要基礎：對向量場的詮釋</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6fe27eab.html alt="前端 | HTML入門基礎知識-網頁" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/e7a0b61194f445b8b9e5ae330961d2ea style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6fe27eab.html title="前端 | HTML入門基礎知識-網頁">前端 | HTML入門基礎知識-網頁</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/40b3969a.html alt=專業音頻基礎概念｜數字音頻是如何工作的？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3684bfc4e93447a5bdfd6d573beec22c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/40b3969a.html title=專業音頻基礎概念｜數字音頻是如何工作的？>專業音頻基礎概念｜數字音頻是如何工作的？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ad3faa79.html alt=立體聲系統基礎篇 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/15288739589536026ad6bae style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ad3faa79.html title=立體聲系統基礎篇>立體聲系統基礎篇</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/18bd39d8.html alt=齒輪基礎知識 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b8e178319e2c4b88a1865f903306a26b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/18bd39d8.html title=齒輪基礎知識>齒輪基礎知識</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3555f615.html alt=流體粘度傳感器的基礎知識與應用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/7f6d9f85a08146e5a84877ef92c212d7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3555f615.html title=流體粘度傳感器的基礎知識與應用>流體粘度傳感器的基礎知識與應用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/000afa08.html alt="Spring Boot 2.x基礎教程：Swagger接口分類與各元素排序問題詳解" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/daa2cfd29ec34306a4be6f3f257b824b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/000afa08.html title="Spring Boot 2.x基礎教程：Swagger接口分類與各元素排序問題詳解">Spring Boot 2.x基礎教程：Swagger接口分類與各元素排序問題詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c6e14bc6.html alt=SQL基礎知識——事務 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/773e21df09dc4e3e8403a0a62994039d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c6e14bc6.html title=SQL基礎知識——事務>SQL基礎知識——事務</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9552c1b8.html alt="軟件開發中數據庫必備基礎01 - 圖解事務基礎" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e4e00ac778db451792b955bde23add02 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9552c1b8.html title="軟件開發中數據庫必備基礎01 - 圖解事務基礎">軟件開發中數據庫必備基礎01 - 圖解事務基礎</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c4961ebc.html alt=監控攝像頭基礎知識，學會自己也知道如何選擇 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/98be6b1a1ad6410ea61d5fc243b44939 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c4961ebc.html title=監控攝像頭基礎知識，學會自己也知道如何選擇>監控攝像頭基礎知識，學會自己也知道如何選擇</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a12da43e.html alt="金屬材料學 一些基礎知識" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/50ac00002279849cb698 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a12da43e.html title="金屬材料學 一些基礎知識">金屬材料學 一些基礎知識</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d60e504d.html alt=Java基礎之多態，動態綁定多態的代碼案例，簡單卻很重要 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ab338c7287fe4649a96227987579c844 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d60e504d.html title=Java基礎之多態，動態綁定多態的代碼案例，簡單卻很重要>Java基礎之多態，動態綁定多態的代碼案例，簡單卻很重要</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e27caade.html alt=python基礎知識，多態實例講解以及多態的作用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/2506d9fe7f6641a6a12c35a35a9335db style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e27caade.html title=python基礎知識，多態實例講解以及多態的作用>python基礎知識，多態實例講解以及多態的作用</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>