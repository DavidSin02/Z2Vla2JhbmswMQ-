<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>文本搜索神器Grep | 极客快訊</title><meta property="og:title" content="文本搜索神器Grep - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/06f967c17abb43d592698a2a4a48a267"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b8b5528.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b8b5528.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b8b5528.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b8b5528.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b8b5528.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b8b5528.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/b8b5528.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/b8b5528.html><meta property="article:published_time" content="2020-10-29T20:50:14+08:00"><meta property="article:modified_time" content="2020-10-29T20:50:14+08:00"><meta name=Keywords content><meta name=description content="文本搜索神器Grep"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/b8b5528.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>文本搜索神器Grep</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><br></p><p>假設有一個文件（或一堆文件），並且想要在這些文件中搜索特定的字符串或配置關鍵字。Windows下，你可能會打開這些文件用搜索框（CTRL+F）輸入關鍵字點搜索，這很麻煩而且還不能隨心所欲的搜。在Linux就不同了，我們可以用Grep，可以用正則表達式隨心所欲的搜，不僅可以搜一個文件，還可以搜一堆文件。搜索的入口和出口可以對接上管道，搜索別的工具的結構或者把搜索結果傳遞給其他工具用。</p><div class=pgc-img><img alt=文本搜索神器Grep onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/06f967c17abb43d592698a2a4a48a267><p class=pgc-img-caption></p></div><p>今天我們就來講Linux Shell下的文本處理三劍客之Grep。為了瞭解其用法最簡便方法是使用系統幫助和man:</p><div class=pgc-img><img alt=文本搜索神器Grep onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/9e522d092a5840669af888eea1b496f1><p class=pgc-img-caption></p></div><p><br></p><div class=pgc-img><img alt=文本搜索神器Grep onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7d27b38ac565436fa56826199709ce5e><p class=pgc-img-caption></p></div><p>其中man的比較詳細，來自於其幫助手冊,在linux（centos為例）下查詢內置命令幫助手冊的方法是用<strong>rpm -qd grep</strong></p><p>-q表示查詢；-d表示列出其文檔（document）:</p><p><strong>rpm -qd grep</strong></p><div class=pgc-img><img alt=文本搜索神器Grep onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/26a35bf62be84b719ff359fe8f690b93><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>grep基礎</h1><p>在開始之前，我們以centos自帶的字典文件為範例，該文件位於/usr/share/dict/words</p><p>wc /usr/share/dict/words</p><p>479829 479829 4953699 /usr/share/dict/words</p><p>文件包含48萬個單詞，一行一個單詞，由centos的word包提供。grep 也有一個-c(--count)選項對搜索匹配的行進行統計，我們先來用他來統計下它的單詞樹</p><p>grep --count '.' /usr/share/dict/words</p><p>479829</p><p>這和wc的結果一樣。</p><p>搜索中我們制定了模式為".",表示搜索包含至少一個字符，空格，空格，製表符等的行。</p><h1 class=pgc-h-arrow-right>grep正則表達式基礎</h1><p>grep最重要兩個優點：一個是搜索相當快，一個是支持正則表達式（RE,regexes）。正則表達式讓grep變得更強大。所以我們首先要介紹下正則表達式基礎。</p><h1 class=pgc-h-arrow-right>開頭</h1><p>假設我們想搜以C開頭單詞，我們需要要使用正則模式的開頭模式:(^)加一個開頭字符。比如：</p><div class=pgc-img><img alt=文本搜索神器Grep onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/54f5887959294b20b83d38f5b23750d8><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>結尾</h1><p>要搜索以特定字符結尾的模式，使用符號($)表示字符串的結尾。比如要搜索以sth結尾的單詞</p><p>grep 'sth$' /usr/share/dict/words</p><div class=pgc-img><img alt=文本搜索神器Grep onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/69a4f3d43dda4e2fb43cd02de23d3a70><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>其他RE模式</h1><p>正則表達式語法很複雜，而且各個系統可能略有差異，具體需要參考對應文檔，grep中常用的語法還有：</p><p><strong>.</strong> 表示單個字符</p><p><strong>* </strong>表示其之前字符出現0次或者多次，比如.*表示任意字符。</p><p><strong>+ </strong>表示其之前字符出現1個或者多個。注意這個只在強化的egrep或者grep -E下可用。基本grep下要用\+</p><p><strong>?</strong> 表示其之前字符出現0個或者一個。基本grep下要用\?</p><p><strong>{}</strong>表示之前字符出現的次數限定，比如：{n} n次，{n，m}n到m次，{n,}至少n次，{0，m}最多m次。grep下要用\{n\}</p><p><strong>[a-z] [0-9]</strong> 表示a~z,0~9的範圍。</p><p><strong>[^] </strong>取反，表示匹配除了範圍之外的模式。</p><p><strong>\&lt;, \b</strong>: 詞首，<strong>\>, \b</strong>：詞尾。</p><p><strong>() </strong>表示分組。基本grep下要用\(\)。</p><p><strong>| </strong>表示邏輯或，匹配多個表達式的任何一個。基本grep下要用\|</p><h1 class=pgc-h-arrow-right>清除註釋（-v）</h1><p>前面初窺grep的門道，我們接著以一些實例來說明寫grep的具體應用。我們知道在linux下很多配置文件都包含了大量的註釋（#開頭的行），解釋很詳盡，但是一般我們不願去仔細瞭解，所以希望瀏覽時候去除掉。我們以ntp.conf為例：</p><p>cat /etc/ntp.conf</p><div class=pgc-img><img alt=文本搜索神器Grep onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6fb1dfba6b6f4da2b41215dde0a08a2b><p class=pgc-img-caption></p></div><p>grep 的-v選項表示排除模式，表示顯示所有不匹配的內容，比如要去除ntp.conf中的註釋我們使用：</p><p>grep -v '^#' /etc/ntp.conf</p><div class=pgc-img><img alt=文本搜索神器Grep onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/80a265cff42945e482919895d71049a7><p class=pgc-img-caption></p></div><p>上面所有註釋行都用空行了，顯示清晰了一點，但是看著也有點彆扭，不是嗎？</p><p>那我們就想辦法去掉空行，方法也簡單就是用管道對接到另一個grep，再去除掉空行($)</p><p>grep -v '^#' /etc/ntp.conf |grep -v '^$'</p><div class=pgc-img><img alt=文本搜索神器Grep onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b9b7d5212848410987d77ee3c11ffc7f><p class=pgc-img-caption></p></div><p>OK，這下清爽多了。</p><h1 class=pgc-h-arrow-right>僅輸出/et /passwd用戶名（-o）</h1><p>為了演示grep的功能和正則表達式的用法，我們需要解析/etc/passwd文件並僅打印用戶名。</p><p>cat /etc/passwd</p><div class=pgc-img><img alt=文本搜索神器Grep onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/91a84cd1bef84ab6bb023f005f8a67f0><p class=pgc-img-caption></p></div><p>文件中各行的字段具體含義：</p><p>&lt;name用戶名>:&lt;明碼密碼，現在都為x表示在shadow加密保存>:&lt;UID>:&lt;GID>:&lt;GECOS用戶備註信息>:&lt;用戶目錄>:&lt;shell></p><p>為了僅輸出用戶名，可以使用如下查詢</p><p>grep -o '^[a-zA-Z_-]\+' /etc/passwd</p><div class=pgc-img><img alt=文本搜索神器Grep onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3259ad079cfd4f3693f7fcf111c94f9d><p class=pgc-img-caption></p></div><p>在上面的grep命令中，我們使用了grep -o（--only-matching）選項，表示僅顯示匹配&lt;PATTERN>的行那部分。</p><h1 class=pgc-h-arrow-right>顯示臨近行（-C,-A,-B）</h1><p>我們在查看日誌時候，有時不能只看匹配的行，而需要上下文信息。grep也提供了這樣的功能，顯示匹配行之前或者之後的行。這在故障排查過程中非常有用，你再也不需要打開文章，定位，然後再看上下文了。</p><p><strong>-C n</strong> 表示打印匹配行及前後n行的信息。此處-C可以省略,用-n</p><p><strong>-A n</strong>表示打印匹配行及之後n行的信息。</p><p><strong>-B n</strong>表示打印匹配行及之前n行的信息。</p><p>比如我們搜索tomcat catalina.out日誌中的嚴重錯誤，可以用：</p><p>grep 'SEVERE: Error' catalina.out</p><div class=pgc-img><img alt=文本搜索神器Grep onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c90078f0d95d4022b3c17c8722b5573d><p class=pgc-img-caption></p></div><p>由於缺乏上下文，具體信息無法獲取。這時候就可以使用-C</p><p>grep -20 'SEVERE: Error' catalina.out</p><p>這樣可以獲取完成錯誤信息進行錯誤定位：</p><div class=pgc-img><img alt=文本搜索神器Grep onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1db4985fba3d465fad5bc5c94499e6d0><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>搜索二進制文件（-a）</h1><p>grep 是一個文本三劍客之一，但是文本劍客並不意味著他就只能處理文本文件了。實際上對二進制文件也是可以的。這就是grep的-a(--binary-files=text)選項，可以對二進制的文本進行搜索和顯示。這在安全領域很有用，比如有時候需要對某些文件判斷是否有害，是否有木馬，可以簡單用grep搜索其特徵即可。我們舉個例子比如，對一個java class文件x.class，我們用javap解析這個類文件</p><p>javap x.class</p><div class=pgc-img><img alt=文本搜索神器Grep onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/07bbd52b896044b5ba1151e4822c9d80><p class=pgc-img-caption></p></div><p>我們用grep –a查看：</p><p>grep -a '.' x.class</p><div class=pgc-img><img alt=文本搜索神器Grep onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a59e7a01fc6f40e9881d7ea131c7296f><p class=pgc-img-caption></p></div><p>有World，我們用他做關鍵字搜索</p><p>grep -ia 'world' x.class</p><p>就能搜到結果：</p><p>ello World,..</p><p>java/lang/Objectjava/lang/SystemoutLjava/io/PrintStream;java/io/PrintStreamprintln(Ljava/lang/String;)</p><p>注意上面用了-i選項，表示忽略大小寫，也是常用的grep選項之一。</p><h1 class=pgc-h-arrow-right>總結</h1><p>本文我們介紹了Linux下的shell三劍客之一，文本搜索神器grep，希望能對大家有所幫助。其他兩個劍客是流式文本處理工具sed 和awk語言，以後有機會我們再做介紹。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Grep</a></li><li><a>神器</a></li><li><a>文本</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/79345f02.html alt=中廣核人的勞動工具，都有哪些“神器”? class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/Rxou7qLEWGzB1J style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/79345f02.html title=中廣核人的勞動工具，都有哪些“神器”?>中廣核人的勞動工具，都有哪些“神器”?</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fd69c3f3.html alt=農村打樁神器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f4ee19a29b1e4a45aa43ed06db7e5a2f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fd69c3f3.html title=農村打樁神器>農村打樁神器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e7bb7e22.html alt=助力編輯的“神器”，新一代的文本校對工具 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/354f86819caa45b89e458c629bc1e55c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e7bb7e22.html title=助力編輯的“神器”，新一代的文本校對工具>助力編輯的“神器”，新一代的文本校對工具</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5e37e483.html alt=基於Transformer模型的中文文本自動校對研究 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RnA5iHG5yimfrr style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5e37e483.html title=基於Transformer模型的中文文本自動校對研究>基於Transformer模型的中文文本自動校對研究</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ddd1d6c9.html alt=溼紙巾是帶娃神器，但用錯小心坑了娃！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1537156272910168e6845b4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ddd1d6c9.html title=溼紙巾是帶娃神器，但用錯小心坑了娃！>溼紙巾是帶娃神器，但用錯小心坑了娃！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ef3a2785.html alt=7點了解新風系統，到底是雞肋還是神器？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ad0966f5c03d4c479620ffa9d58befca style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ef3a2785.html title=7點了解新風系統，到底是雞肋還是神器？>7點了解新風系統，到底是雞肋還是神器？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/84f64628.html alt=給PDF批量添加文本鏈接 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b2563acb0efb4e7394cabb8fb4a7461b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/84f64628.html title=給PDF批量添加文本鏈接>給PDF批量添加文本鏈接</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/308c027f.html alt=Inventor教程之工程圖文本標註 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/05b2d1214af84a4db766220598e8e2b9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/308c027f.html title=Inventor教程之工程圖文本標註>Inventor教程之工程圖文本標註</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/34678f5f.html alt=excel小技巧，限制文本長度 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1536886321532590f2ae066 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/34678f5f.html title=excel小技巧，限制文本長度>excel小技巧，限制文本長度</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/75cee8d2.html alt=如何統一文本的格式——辦公必備 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/568800039e02905458a5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/75cee8d2.html title=如何統一文本的格式——辦公必備>如何統一文本的格式——辦公必備</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/86fe6bc5.html alt=文本內容的處理技巧 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/c97c39f4269d4106a459879c91118d8e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/86fe6bc5.html title=文本內容的處理技巧>文本內容的處理技巧</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/815a0e38.html alt=Excel中如何將文本轉換方向 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/6539/4800626177 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/815a0e38.html title=Excel中如何將文本轉換方向>Excel中如何將文本轉換方向</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/003a6d76.html alt=網頁文本不讓複製粘貼？教你4個破解技巧，全網任意複製 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1810307723974cfc8ebd44d83bac1472 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/003a6d76.html title=網頁文本不讓複製粘貼？教你4個破解技巧，全網任意複製>網頁文本不讓複製粘貼？教你4個破解技巧，全網任意複製</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e93a92af.html alt=智能錄音筆，辦公人員的信息記錄神器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/80884bd232b14f67bdaf38ebabe2bcc2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e93a92af.html title=智能錄音筆，辦公人員的信息記錄神器>智能錄音筆，辦公人員的信息記錄神器</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/bb170ef0.html alt=烘焙材料中的神器—果膠 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1535438230379758711f4be style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/bb170ef0.html title=烘焙材料中的神器—果膠>烘焙材料中的神器—果膠</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>