<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>機器視覺之halcon入門（4）-字符識別 | 极客快訊</title><meta property="og:title" content="機器視覺之halcon入門（4）-字符識別 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/809bc1278e6846cd9b8c77a657cf57e0"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bb9009e1.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bb9009e1.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bb9009e1.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bb9009e1.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bb9009e1.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bb9009e1.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bb9009e1.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bb9009e1.html><meta property="article:published_time" content="2020-11-14T21:05:00+08:00"><meta property="article:modified_time" content="2020-11-14T21:05:00+08:00"><meta name=Keywords content><meta name=description content="機器視覺之halcon入門（4）-字符識別"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/bb9009e1.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>機器視覺之halcon入門（4）-字符識別</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>第1節 <strong>第二個halcon程序</strong></p><p><strong>2.3.1 第二個halcon程序：字符識別</strong></p><p>寫這一章的時候距離第一章寫完已經有2周之久了。為什麼隔了這麼久呢，因為我偷懶了，沒有堅持下來。。。結果現在激情大不如寫第一節的時候，好在我複習了第一節的最後一段話！瞬間滿血復活！</p><p>話不多說我們言歸正傳。上一節我們學會了一些簡單的圖像處理，這一節我們來學習怎麼實現對字符的識別！老規矩，先直接上代碼（2-3-1-1）和圖片（2-3-1-2）：</p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/809bc1278e6846cd9b8c77a657cf57e0><p class=pgc-img-caption>圖 2-3-1-1</p></div><p><strong></strong></p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1ab32eecfb7d42129887b03253d1abd1><p class=pgc-img-caption>圖 2-3-1-2</p></div><p>圖片下載鏈接：群共享文件。</p><p>對的，就是我隨便照的一張辦公室牆上的貼圖。我們的目的是識別上面的"HAPPY NEW YEAR"，漢字還不行，因為沒有庫，需要自己訓練。到了這一節的小夥伴應該對halcon的思路有了一定的瞭解了，我就不粗魯的直接分析代碼了。先說下字符識別的思路吧：首先通過圖像處理找到圖片中字符區域，然後依次一個字母一個字母的識別，最後輸出。（首先...然後...最後...這格式。果然還是小時候學的東西是最牢固的）。</p><p>首先當然是讀取圖片了，然後把3通道圖片分成單通道的，這個你都會了的。</p><p>read_image (Image, 'F:/work/newbook/字符識別.jpg')</p><p>decompose3 (Image, Image1, Image2, Image3)</p><p>接下來這一步：</p><p><strong>gen_rectangle1 (ROI_0, 560.594, 483.602, 647.781, 688.539)：</strong>生成一個1型的矩形，1型就是絕對水平的矩形，halcon裡面還有2型的就是帶角度的。確定一個1型矩形你給一個左上角的點和一個右下角的點就可以了，所以後面的4個參數就是這兩個點的橫縱座標。第一參數是圖標輸出的矩形了，當然這個矩形是一個region（與本算子相關的知識點，詳見本節TIPS 1,2）。</p><p>直接輸入兩個點的橫縱座標是方便，但是有的時候也不方便，比如我這個時候，我就不知道該生成多大的矩形。為什麼要生成一個矩形？是這樣的，我要找到字符的區域，按照常規的我得通過圖像的分析處理最後得到那幾個英文字母，但是我要介紹功能嘛，所以用了一招自畫ROI的方法：</p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/34de4a8417e44fa4aaaf39504bf80412><p class=pgc-img-caption>圖 2-3-1-3</p></div><p>如上圖（2-3-1-3），單擊圖像窗口上畫圓的按鈕，彈出下面的矩形框，然後點擊"繪製"按鈕，裡面選擇繪製"軸平行矩形"，當然工具欄下面的一行各個鉛筆下面加圓形矩形的是快捷按鈕，直接點擊就可以畫了。（這裡面的按鍵比較少，個人建議你有空都點開看一看。）</p><p>如下圖（2-3-1-4）畫出一個矩形，剛好覆蓋了英文字母，自己可以學著稍微調整一下細節部分。</p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7cde944de1074ab28d604c4999d627d7><p class=pgc-img-caption>圖 2-3-1-4</p></div><p><strong>reduce_domain (Image3, ROI_0, ImageReduced)：</strong>這一算子相信大家都已經很熟悉了，畢竟上一節已經用了兩次了，這兒再強調下，它輸出的是一個目標區域的圖像。用了這一招，可以立馬去掉旁邊所有的干擾，實在是好。如下左圖（2-3-1-5）。</p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/17859942e15b40ea9608fb0c73a80021><p class=pgc-img-caption>圖2-3-1-5</p></div><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/00006d6e622d4ce6bc594a5762be4200><p class=pgc-img-caption>圖2-3-1-6</p></div><p><strong>binary_threshold(ImageReduced,Region,'max_separability','dark',UsedThreshold)：</strong></p><p>這個算子的目的跟threshold一樣，我們就叫它二值化自動閾值吧。但是沒有了threshold裡面的閾值參數，這樣對圖像的亮暗要求就沒有那麼大了。第一個參數是輸入圖像，第二個參數是經過閾值處理後得到的區域，為輸出。第三個參數是自動閾值的方法，有兩種，一種是默認的，應該就是等同於threshold的一種分發，另外一種是對其直方圖做平滑處理後再自動閾值。具體的我也沒試過第二種，每次都用的第一種。。。所以建議正在入門的各位大佬也不要花時間在這個細節上了。第四個參數是二值化閾值分割後，你要輸出暗的那一塊，還是亮的那一塊啊，總得告訴下halcon嘛，我們這個明顯就是暗的部分啦，所以我選的'dark'，最後一個參數就是它自動閾值也得有一個值嘛，halcon很自信的把它算出來的自動閾值的值告訴你了。有點狂……你有沒有好奇它是怎麼算出來的 ？它怎麼就知道從哪裡分割，哈哈，所以說"學好數理化，走遍天下都不怕"。如果你沒有足夠的數學知識，你就得自己根據圖像來慢慢調整閾值threshold，如果你數學學得好，就可以自己算出這個值。看把我能的！哈哈~當然現在的你也沒有必要知道，有興趣的可以看一下，我寫在本節TIPS 3裡面。畢竟牛都吹完了，不寫出來，怕你們以為我也不知道。</p><p>接下來就是去掉一些不是字符的部分，首先，求連通域：</p><p><strong>connection (Region, ConnectedRegions)：</strong></p><p><strong>select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 150, 99999)：</strong>第一個算子就不用介紹啦，第二個我得說下：第一節裡面用的是select_shape_std（）算子，這個裡面可以選擇最大面積的，但是我們不是每次都只需要找出來最大面積的那個，比如這次，我們要找出來的是兩排差不多大小的字符，那就要用到這個功能強大的算子了。這個算子第一個參數是需要篩選的region（大多數情況下都是connection之後的，因為選嘛，大多數情況都是在很多個裡面選）。這中間有個小邏輯（詳見本節TIPS 4）。回到這個算子，第二個參數就是選出來的region了，第三個參數是你根據什麼特徵來篩選，本例中是根據面積特徵，那麼對應的第四、第五個參數就是面積的上下限了，篩選面積在150到99999像素之間的區域。那個'and'，是當你有好幾個參數特徵要選擇的時候，是同時滿足所有的特徵還是隻要滿足其中之一就可以呢，就要選擇一下是'and'還是'or'了，其它時候比如我這時候，只有一個面積特徵，那就只需要默認"and"就可以了。（其實這個算子，還可以利用特徵直方圖來實現，詳見本節TIPS 5）效果如下左圖（2-3-1-7和2-3-1-8）：</p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ca298b5b9079427e821dbb96bd1ad0ac><p class=pgc-img-caption>圖 2-3-1-7</p></div><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/565def1270c04533981a5f3a58be0990><p class=pgc-img-caption>圖2-3-1-8</p></div><p>根據上右圖可以看到（2-3-1-8），我們已經篩選出來"happy new year"了，而且去掉了旁邊的干擾的小區域。但是聰明的你同時肯定也發現了，"hap"、"ne"、"ye"、"ar"都被連在了一起，當成了一個區域，這就是項目上常遇到的情況。要是剛好都一個一個的那就簡單了，誰都可以做視覺了。但是這樣其實也不難，我這兒有一招對字符的分割常用的招式，其實有兩招了，另一招以後再說，這兒用的是第一招：首先：</p><p><strong>union1 (SelectedRegions, RegionUnion)：</strong>懂英文的或者會查英漢字典的都知道這個算子的意思是聯合，就是把很多個region合併成一個region，它跟connection可以算是一組逆運算了（既然有union1，那肯定就有union2了，union1和union2的區別是什麼呢？詳見本節 TIPS 6）。如下左圖（2-3-1-9）。</p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fc047b0ca10944afa06f9bdfe3a7fc72><p class=pgc-img-caption>圖 2-3-1-9</p></div><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f97b4b50b6ff4bd9b1792cd937eaee95><p class=pgc-img-caption>圖2-3-1-10</p></div><p>接下來是填充：</p><p>fill_up (RegionUnion, RegionFillUp)：這個算子沒什麼多說的了，見上右圖（2-3-1-10），孔洞已經被填充了。</p><p>填充之後，再做開運算：</p><p><strong>opening_rectangle1 (RegionFillUp, RegionOpening, 1, 3)：</strong>這個算子意思為以1型矩形作為結構元素進行開運算。後面兩個數字為矩形結構元素寬和高。可以這麼說，任何圖像處理軟件都避免不了這兩組算法：開閉運算和膨脹腐蝕運算。因為都有，所以這個理論我就不講了，但是你必須要懂！你可以去百度下，有很詳細的、很通俗易懂的解釋。我若講也是照著百度的來講，還得重開一節，太有湊字數的嫌疑了。本人不屑於那麼做，我都是堂堂正正的廢話來湊字數！那麼你先去百度下什麼叫開閉運算，什麼叫膨脹腐蝕吧^_^。（關於開閉運算的一些算子，詳見本節TIPS 7）。</p><p>好，假設現在你已經知道了，我們繼續講解。像我們這種情況，用開運算，目的很明顯：就是把粘連在一起的字符分開，方便接下來的字符識別。字符都是水平相連，而垂直方向沒有相連的，所以，結構元我設計成公式中的參數，寬比高小，你們也可以試著調一下其它參數，感受下，別偷懶，感受下！聽話~</p><p>你多試幾下不同參數，就能理解為什麼我要先fill_up再開運算了。因為英文字符常有孔洞，填充後再開運算效果會比較好。如下左圖（2-3-1-11）。然後咱們再這些字符恢復原狀，把填充的 孔洞重新露出來，怎麼做呢？</p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9ebb1891187d481a9322fd0c962c551e><p class=pgc-img-caption>圖 2-3-1-11</p></div><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c0110de2ece3454c94a6694c71124eb0><p class=pgc-img-caption>圖2-3-1-12</p></div><p><strong>intersection (RegionOpening, RegionUnion, RegionIntersection)：</strong>說實話，學halcon以來我學了不少單詞，比如這個intersection：交集。那就很簡單了，求交集，三個參數的意思就是A∩B=C，看單詞也差不多知道。本例中就是把開運算過後的RegionOpening和沒有開運算，但是也沒有填充過的RegionUnion求交集，就可以得到想要的既不粘連，又沒有孔洞的RegionInersection了！如上右圖（2-3-1-12）。然後再求個連通域就可以得到一個一個分開的字符了（其實分開字符可以有很多種方法，詳見本節TIPS 8）。也就是：</p><p>connection (RegionIntersection, ConnectedRegions1)：如下左圖（2-3-1-13）：</p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a11a4720bd024793bcb97ce4d45f91d4><p class=pgc-img-caption>圖 2-3-1-13</p></div><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2fe04242ab6f44899e493d311a85f696><p class=pgc-img-caption>圖2-3-1-14</p></div><p>到這一節，connection算子之後，可以說眾所周知，我們獲得了一個region的集合ConnectedRegions1，裡面有每個字母的region。但是順序呢？這些字母的順序是怎樣的呢？本例中是從左到右的兩排，還算規整，要是region是無序亂排列的呢？它們在集合ConnectedRegions1裡面的順序是什麼呢？這就用到下面這個算子了：</p><p><strong>sort_region (ConnectedRegions1, SortedRegions, 'character', 'true', 'row'):</strong>這是個知識點了，它的功能是給一堆region排序。第一個參數是扔進來要排序的一堆region，第二個是輸出的排好序的region，第三個參數是排序的規則，按F1可以看到，有按照左上角的點來排序，有按照右下角的點等等。對於字符，一般都是我上面用到的方法'character'，排序一定是從小到大嗎？不一定哦，除非你的第四個參數選擇的是'true'，這個參數的意思是是否為升序排列，如果是'false'，就是降序排列啦。單詞是水平的最後一個參數就是'row'，反之則'column'。</p><p>（排完序之後，該怎麼檢查是否是按照自己的意願排序的呢？詳見本節TIPS 9）。字符分開了，也排好序了。一般預處理也就到此為止了。可以進行字符的識別了。字符識別的靈魂代碼主要是下面兩行：</p><p><strong>read_ocr_class_mlp ('Document_0-9A-Z_NoRej.omc', OCRHandle)：</strong>從文件中讀取一個OCR分類器；</p><p><strong>do_ocr_multi_class_mlp (SortedRegions, ImageReduced, OCRHandle, Class, Confidence)：</strong>用OCR分類器對多個字符進行分類。</p><p>字符的識別其實很簡單，也就上面的兩步，我就放一起講了。就像警察抓到嫌疑人，要識別下他是不是在逃的罪犯，首先，警察得有一本在逃罪犯的資料手測，有相片、身高、體重等資料。我們要識別這個字符是什麼，也得有一本這樣的資料。這本資料halcon為你準備好了。當然它只准備了A到Z，0到9這36個。所以用這本資料就可以識別字符和數字了。拿到這本資料的算子就是上面的第一個read_ocr_class_mlp()，你選中這個算子，按F1後，就能在下面的參數欄裡面找到這本資料，對的，它有很多本，你看著選。。。（見下圖2-3-1-15）然後halcon需要把資料存到句柄OCRHandle裡面。這樣我們就可以進行第二步識別了，也就是第二的算子。第一個參數放的你要識別的字符region，第二個是這些region屬於哪張圖片（這個得是單通道的），第三個參數就是存資料的句柄了。有了這三個就可以讀出來了，讀完後那些字符以數組的形式保存在Class裡面，同時它還反饋給你一個自信度數組Confidence，向你反饋它對自己識別的每個字符的自信程度。也算是給你一個自動篩選的參數，這兒我們用不著，其它情況下可能用得著。大多數情況下都得0.95以上才能算是準的吧。</p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6fc54fedae584dc1a053c141d9b06452><p class=pgc-img-caption>圖 2-3-1-15</p></div><p>這兩步執行完，人生也成功了一大半了。額不，這個程序也完成了一大半了。。。咳咳。。。接下來就是顯示了。在哪顯示？怎麼顯示？這兩個既是問題也是思路。首先是顯示的位置，我們就近原則就在這幾個字符的上方，一個一個按照照片中字符的相對位置顯示。</p><p><strong>area_center (SortedRegions, Area, Row, Column)：</strong>獲得區域的面積和中心座標。所以通過這個算子先獲得照片中每個字符的位置，這一步簡單，你都會了的（這句是我同事的口頭禪）。</p><p>接下來我們利用一個for循環，逐個輸出字母：</p><p>for i:=0 to |Area|-1 by 1</p><p>disp_message (200000, Class[i], 'image', Row[i]-150, Column[i], 'black', 'true')</p><p>endfor</p><p>i從0開始，到數組Area的個數-1為止。每次循環i+1。循環執行的disp_message就是顯示消息的意思了。裡面第一個參數是在哪個窗口顯示，第二個參數是要顯示的內容，第三個參數就是兩個座標你是要按照圖像的座標系來，還是按照窗口的座標系來，第四個，第五個參數就是你要顯示的位置的橫縱座標了。畢竟一個800 X 600的窗口是可以顯示一張1024 X 800的圖片的，那座標肯定是有一定縮放的對吧？我這裡用的就是按照圖像的座標來。第六個參數就是字體的顏色了，第七個參數是字符要不要後面加個背景顏色，true就是加，我是這麼理解的，其實也差不多就是這個意思。這個算子雖然簡單，參數還挺多，不過好在都是一些簡單的參數。那我上面一個for循環的意思就是在每個圖像字符中心位置的上方150個像素處依次顯示我識別出來的字符。雖然說了這麼多話，但是"言語從來沒能將我的情意表達千萬分之一"，還是看圖吧（2-3-1-16）！</p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5c68649183e14ba5a4462ff444474787><p class=pgc-img-caption>圖 2-3-1-16</p></div><p>這就是簡單的字符識別了。每個字符按照相對位置依次排列，後面的淺色背景就是我上面第七個參數選擇了'true'的結果，你可以試試改'false'再看看效果。</p><p>按照慣例：我們再回憶下總體的思路吧！先是拍一張含有字符的圖片，（還是提醒下吧，儘量正對著拍，不要傾斜太多角度，那樣你得旋轉到正面才行，但是我又沒教你怎麼旋轉。。。）第二步，形態學圖像處理，找到字符的區域，並分割好它們，確保一個字符一個region；第三步排好順序，找到資料本，讀取；第四步顯示出來。</p><p>老實說，這一節內容還是很簡單的，但是不可否認知識點也是特別多。這一章其實還可以很擴展。比如車牌識別，車牌識別就涉及到車牌前面的漢字識別。這些我原計劃都說說的。後來覺得越扯越多，你們越容易記不住。就忍住了。這兒我就給那些比較厲害的學生一些思路吧：車牌識別可以有很多種方法，你最好自己先嚐試下，然後再百度網上找例程。漢字的識別例子網上會比較少，但是halcon是可以訓練的，就是說你可以自己弄個小資料本里面記載了34個漢字的信息，主要步驟也就5步。我學halcon第一年琢磨了1周多弄會，至今沒用到過。這也是我決定不在這本書講解的原因。</p><p>最後，一起來複習下本節學到的新算子。本節新內容有點多：</p><p>1)gen_rectangle1 (ROI_0, 560.594, 483.602, 647.781, 688.539)：</p><p>2)binary_threshold(ImageReduced,Region,'max_separability','dark',UsedThreshold):</p><p>3)select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 150, 99999)：</p><p>4)union1 (SelectedRegions, RegionUnion)：</p><p>5)opening_rectangle1 (RegionFillUp, RegionOpening, 1, 3)：</p><p>6)intersection (RegionOpening, RegionUnion, RegionIntersection)：</p><p>7)sort_region (ConnectedRegions1, SortedRegions, 'character', 'true', 'row'):</p><p>8)read_ocr_class_mlp ('Document_0-9A-Z_NoRej.omc', OCRHandle)：</p><p>9)do_ocr_multi_class_mlp (SortedRegions, ImageReduced, OCRHandle, Class, Confidence)：</p><p>10)area_center (SortedRegions, Area, Row, Column)：</p><p><strong>本節TIPS：</strong></p><p>1）2型矩形就是帶角度的矩形，比1型矩形多了一個角度，同時參數表達方式也變了，是中心點的橫縱座標和角度外加矩形長寬的一半。你可以F1進入幫助，然後找到gen_rectangle2()看看參數說明。</p><p>2） halcon裡面以"gen_"開頭的算子都是"生成……"的意思，從無到有。所以你以後你想生成什麼，不妨試試F1裡面搜索下gen，然後找找看，比如生成一個圓形，一個橢圓，一條線，一個點，一個3D模型……不過，也不是所有的生成都是"gen_"開頭哦。</p><p>3） 設自動閾值的值為t1，自己定一個精度n=1</p><p>第一步：將圖像按照灰度值0-t1，t1-255分為兩個部分，然後分別求出兩部分的灰度平均值G1,G2；</p><p>第二步：t2=abs（G2-G1）；</p><p>第三步：若abs（t2-t1）>n，則t1=t2（把t2賦值給t1），返回第一步；若&lt;=n，則t1為自動閾值的值。</p><p>厲害了吧？哼哼！</p><p>4） 什麼邏輯呢？就是halcon有很多算子，近2000個了，這就像很多武功的招式一樣，招式多了就有連招，halcon的很多算子也是，經常有些小套路，好幾個算子連用，就可以達到某個目的。那這些小套路作為新手的你怎麼才能知道呢？所以說這本書還是沒買虧，我來告訴你吧：比如咱們這個算子select_shape()，它的上一招在下圖的位置（2-3-1-17）：</p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/724de634c71a4527b74d0c37d7fc5363><p class=pgc-img-caption>圖 2-3-1-17</p></div><p>下一招就是圖片裡面的後繼函數啦，<strong>有時候你新學一個算子，怎麼用都報錯的時候，可以看看它的前趨函數，說不定你前面漏了什麼。</strong>同樣，有時候你新學一個算子，不知道用了之後有什麼用的時候，也可以看看它的後繼函數！學到了嗎？嘿嘿。。。</p><p>5） 如下圖（2-3-1-18）紅框框處，點擊：</p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6d198fdf479e4c689f52201956c12d42><p class=pgc-img-caption>圖 2-3-1-18</p></div><p>就會彈出下圖（2-3-1-19）的特徵直方圖：</p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/bf61f8dfa637481f876cc4248b6d2c88><p class=pgc-img-caption>圖 2-3-1-19</p></div><p>什麼叫特徵直方圖？就是用直方圖來反應特徵唄。對吧？相對於正文中教的灰度直方圖，就是用直方圖來反應灰度值信息了，所以灰度直方圖是針對圖片的，而特徵直方圖是針對region的！但是halcon裡面region也可以有很多特徵的，這個就需要在特徵欄進行選擇。剛彈出來的這個表在圖中矩形框內是一個叉號，你要點擊一下才能把它變成我這兒的對勾。特徵後面三列第一列暫時別管，後面是這個特徵的最小最大值，比如我圖中特徵第一行，選擇的是area，最小化下面是0，最大化下面是2000，就是篩選面積在0到2000之間的region。有時候一個面積特徵還不夠，咱們還需要多一些特徵，就可以我畫的橢圓裡面進行增刪特徵，點加號就是再添加一個特徵篩選了。可是添加的還是默認是area，再在我畫的藍色矩形處點擊向下箭頭（這個向下箭頭要點擊一下才會出來的哦）。就可以在裡面找到自己想要的特徵來進行篩選了。而最大最小值的設定方法，可以直接在列表裡面賦值，也可以通過拉動直方圖上的紅線綠線，對照直方圖進行選定。選好後，點擊"插入代碼"，就可以自動生成select_shape()代碼了！</p><p>6） union1一個輸入參數，把一個參數表示的一堆region合併成一個；union2兩個輸入參數，把兩個參數表示的兩個單region合併成一個。</p><p>7） 打漁方法：<strong>F1進入幫助頁面，在左上角搜索欄輸入opening</strong>，如下圖（2-3-1-20）</p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4668bd2724604b4ab085db0ab772d159><p class=pgc-img-caption>圖 2-3-1-20</p></div><p>紅框裡面的4個算子，第一個算子是用已知的（也就是可以自定義形狀的）結構元進行開運算，但是你在用之前，要先生成這個結構元，也就是一個region而已；第二個算子是用圓形結構元來進行開運算；第三個算子是用一個字母來做結構元開運算（說實話這個算子我從來沒用過）；第四個算子是用1型矩形進行開運算，就是這一節我們用到的。</p><p>同樣對於閉運算肯定也有這4個。再同樣，腐蝕膨脹也有對應的好幾個，你會F1就能找到比我解釋更詳盡的解釋。目前階段我給的建議是：看得懂的幾個算子就記小本本上，看不懂的就放那別理它。</p><p>8） 一千種圖像，可以說有一千種方式分割出字符都不為過。但是程序永遠只需要一種方法：最實用的那種！關於本例中的圖像，我還可以用下面的方法來分割字符，也是常用的方法來實現：</p><p>erosion_rectangle1 (RegionUnion, RegionErosion, 0.5, 3)</p><p>dilation_rectangle1 (RegionErosion, RegionDilation, 0.5,3)</p><p>connection (RegionDilation, ConnectedRegions1)</p><p>先腐蝕再膨脹。剛好你可以複習下剛百度的這幾個算子意思。這中間的數學意義，妙不可言。可惜不在我本書的講解範圍內，數學好的自己理解，差點的百度吧，應該也有。實在不行記住方法就夠啦，誰管你懂不懂原理！</p><p>9） 怎麼看到排序後的region是否按照自己意願排序的？如下圖，點擊排完序的regions，然後在圖像窗口點擊每一個小region，就可以看到這個region的排序了。注意：halcon裡面數組的序列號是從0開始，圖像圖形以及region的序列號是從1開始。如下圖的"H"是第一個region不是第二個。</p><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e23a7cd00e8c434c971c1e0f13235a47><p class=pgc-img-caption>圖 2-3-1-21</p></div><div class=pgc-img><img alt=機器視覺之halcon入門（4）-字符識別 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ef89063b9d814f61b46162df6a5514fc><p class=pgc-img-caption>圖 2-3-1-22</p></div></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>機器</a></li><li><a>視覺</a></li><li><a>halcon</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/77b8a03.html alt=機器視覺之halcon入門（6）-一文弄懂halcon連接相機 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0d362df7ed484fbbb7ee0a8e99df8443 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/77b8a03.html title=機器視覺之halcon入門（6）-一文弄懂halcon連接相機>機器視覺之halcon入門（6）-一文弄懂halcon連接相機</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cfb83fa2.html alt=機器視覺｜晏磊：航空遙感平臺通用物理模型及可變基高比系統精度評價 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1530929302432561dc6cda6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cfb83fa2.html title=機器視覺｜晏磊：航空遙感平臺通用物理模型及可變基高比系統精度評價>機器視覺｜晏磊：航空遙感平臺通用物理模型及可變基高比系統精度評價</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ee69f5ac.html alt=基於機器視覺技術快速準確地確定收穫後幹大豆種子的品質 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/519b968bf69146fda9bf55f89779d373 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ee69f5ac.html title=基於機器視覺技術快速準確地確定收穫後幹大豆種子的品質>基於機器視覺技術快速準確地確定收穫後幹大豆種子的品質</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b792ed3a.html alt=機器視覺檢測設備的外觀缺陷檢測的原理淺析 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/35e3f8d87f5d4c96937309010c5a5ec7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b792ed3a.html title=機器視覺檢測設備的外觀缺陷檢測的原理淺析>機器視覺檢測設備的外觀缺陷檢測的原理淺析</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ab89c564.html alt=機器視覺表面缺陷檢測綜述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/bd400c5fc7d049df8d5ce365faec81f6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ab89c564.html title=機器視覺表面缺陷檢測綜述>機器視覺表面缺陷檢測綜述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/af8d9e1a.html alt=機器視覺表面缺陷檢測設備綜述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b75804e4e383426595973d8b7b2b2c6f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/af8d9e1a.html title=機器視覺表面缺陷檢測設備綜述>機器視覺表面缺陷檢測設備綜述</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6938b43a.html alt=【乾貨】機器視覺檢測基礎——鏡頭篇（1） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ad30e323d1c749d98d78304890799ce1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6938b43a.html title=【乾貨】機器視覺檢測基礎——鏡頭篇（1）>【乾貨】機器視覺檢測基礎——鏡頭篇（1）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/50af5e85.html alt=工業機器人「視覺檢測」的原理剖析 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2a361cbe48874f73892d766805cbb40a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/50af5e85.html title=工業機器人「視覺檢測」的原理剖析>工業機器人「視覺檢測」的原理剖析</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e9168ecd.html alt=機器視覺之紙容器視覺檢測系統 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/e1d9cf4e0aaa4e4c968eab2cb1035225 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e9168ecd.html title=機器視覺之紙容器視覺檢測系統>機器視覺之紙容器視覺檢測系統</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6bdaa6af.html alt=機器視覺檢測在越來越多的行業中得到應用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/fc1d944a5f744c39bf21afa554414d7c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6bdaa6af.html title=機器視覺檢測在越來越多的行業中得到應用>機器視覺檢測在越來越多的行業中得到應用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/50f22468.html alt=機器視覺檢測的分類和應用主要有哪些？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/54d95f76c7df429a98b3a5cdfd9b3cf9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/50f22468.html title=機器視覺檢測的分類和應用主要有哪些？>機器視覺檢測的分類和應用主要有哪些？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/eca8fc3d.html alt=機器視覺檢測的最新技術趨勢是什麼，它將面臨什麼挑戰？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0a16f6ef272245018dda4835005d10c7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/eca8fc3d.html title=機器視覺檢測的最新技術趨勢是什麼，它將面臨什麼挑戰？>機器視覺檢測的最新技術趨勢是什麼，它將面臨什麼挑戰？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bb3a6e81.html alt=機器視覺檢測設備有哪些？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/98103dcf000c4ab8b87213297fdebfa6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bb3a6e81.html title=機器視覺檢測設備有哪些？>機器視覺檢測設備有哪些？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9eb5372c.html alt=機器視覺自動檢測技術精確檢測產品裂紋與劃痕 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/05f3d7e2badf4022924ad69d62bde4a8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9eb5372c.html title=機器視覺自動檢測技術精確檢測產品裂紋與劃痕>機器視覺自動檢測技術精確檢測產品裂紋與劃痕</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/10263c40.html alt=機器視覺，視覺檢測，圖像處理常用技巧實現穩定檢測 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a3ed009160fb41dcb845fe14391864ed style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/10263c40.html title=機器視覺，視覺檢測，圖像處理常用技巧實現穩定檢測>機器視覺，視覺檢測，圖像處理常用技巧實現穩定檢測</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>