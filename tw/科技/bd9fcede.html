<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Zookeeper安裝、配置及集群搭建 | 极客快訊</title><meta property="og:title" content="Zookeeper安裝、配置及集群搭建 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/7bf766de47f44c979a57d93b215507e5"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bd9fcede.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bd9fcede.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bd9fcede.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bd9fcede.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bd9fcede.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bd9fcede.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bd9fcede.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bd9fcede.html><meta property="article:published_time" content="2020-11-14T21:03:23+08:00"><meta property="article:modified_time" content="2020-11-14T21:03:23+08:00"><meta name=Keywords content><meta name=description content="Zookeeper安裝、配置及集群搭建"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/bd9fcede.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Zookeeper安裝、配置及集群搭建</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><h1><strong>一、 簡介</strong></h1><p><strong>1.1 Zookeeper簡介</strong></p><p>1.1.1 分佈式系統</p><div class=pgc-img><img alt=Zookeeper安裝、配置及集群搭建 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7bf766de47f44c979a57d93b215507e5><p class=pgc-img-caption></p></div><pre> 上述這張圖，在這圖中有三臺機器，每臺機器各跑一個應用程序。然後我們將這三臺機器通過網絡將其連接起來，構成一個系統來為用戶提供服務，對用戶來說這個系統的架構是透明的，他感覺不到我這個系統是一個什麼樣的架構。那麼我們就可以把這種系統稱作一個分佈式系統。 目前，在分佈式協調技術方面做得比較好的就是Google的Chubby還有Apache的ZooKeeper他們都是分佈式鎖的實現者。既然有了Chubby為什麼還要弄一個ZooKeeper，難道Chubby做得不夠好嗎？主要是Chbby是非開源的，Google自家 用。後來雅虎模仿Chubby開發出了ZooKeeper，也實現了類似的分佈式鎖的功能，並且將ZooKeeper作為一種開源的程序捐獻給了Apache，那麼這樣就可以使用ZooKeeper所提供鎖服務。而且在分佈式領域久經考驗，它的可靠性，可用性都是經過理論和實踐的驗證的。</pre><p>1.1.2 分佈式的問題</p><pre> 分佈式應用是非常困難的，主要原因就是局部故障。一個消息通過網絡在兩個節點之間傳遞時，網絡如果發生故障，發送方並不知道接收方是否接收到了這個消息。可能在網絡故障前就收到了此消息，也可能沒有收到，又或者可能接收方的進程死了。發送方瞭解情況的唯一方法就是再次連接發送方，並向他進行詢問。 這就是局部故障：根本不知道操作是否失敗。因此，大部分分佈式應用需要一個主控、協調控制器來管理物理分佈的子進程。目前，大部分應用需要開發私有的協調程序，缺乏一個通用的機制。協調程序的反覆編寫浪費，且難以形成通用、伸縮性好的協調器。協調服務非常容易出錯，並很難從故障中恢復。例如：協調服務很容易處於競態甚至死鎖。Zookeeper的設計目的，是為了減輕分佈式應用程序所承擔的協調任務。 Zookeeper並不能阻止局部故障的發生，因為它們的本質是分佈式系統。他當然也不會隱藏局部故障。ZooKeeper的目的就是提供一些工具集，用來建立安全處理局部故障的分佈式應用。</pre><p>1.1.3 Zookeeper是什麼</p><pre> ZooKeeper譯名為“動物園管理員”。動物園裡當然有好多的動物，遊客可以根據動物園提供的嚮導圖到不同的場館觀賞各種類型的動物，而不是像走在原始叢林裡，心驚膽顫的被動物所觀賞。為了讓各種不同的動物呆在它們應該呆的地方，而不是相互串門，或是相互廝殺，就需要動物園管理員按照動物的各種習性加以分類和管理，這樣我們才能更加放心安全的觀賞動物。 回到企業級應用系統中，隨著信息化水平的不斷提高，企業級系統變得越來越龐大臃腫，性能急劇下降，客戶抱怨頻頻。拆分系統是目前我們可選擇的解決系統可伸縮性和性能問題的唯一行之有效的方法。但是拆分系統同時也帶來了系統的複雜性——各子系統不是孤立存在的，它們彼此之間需要協作和交互，這就是我們常說的分佈式系統。各個子系統就好比動物園裡的動物，為了使各個子系統能正常為用戶提供統一的服務，必須需要一種機制來進行協調——這就是ZooKeeper（動物園管理員）。 Zoopkeeper 提供了一套很好的分佈式集群管理的機制，就是它這種基於層次型的目錄樹的數據結構，並對樹中的節點進行有效管理，從而可以設計出多種多樣的分佈式的數據管理模型。 ZooKeeper是一個分佈式小文件系統，並且被設計為高可用性。通過選舉算法和集群複製可以避免單點故障，由於是文件系統，所以即使所有的ZooKeeper節點全部掛掉，數據也不會丟失，重啟服務器之後，數據即可恢復。另外ZooKeeper的節點更新是原子的，也就是說更新不是成功就是失敗。通過版本號，ZooKeeper實現了更新的樂觀鎖，當版本號不相符時，則表示待更新的節點已經被其他客戶端提前更新了，而當前的整個更新操作將全部失敗。當然所有的一切ZooKeeper已經為開發者提供了保障，我們需要做的只是調用API。與此同時，隨著分佈式應用的的不斷深入，需要對集群管理逐步透明化監控集群和作業狀態，可以充分利ZK的獨有特性。 ZooKeeper性能上的特點決定了它能夠用在大型的、分佈式的系統當中。從可靠性方面來說，它並不會因為一個節點的錯誤而崩潰。除此之外，它嚴格的序列訪問控制意味著複雜的控制原語可以應用在客戶端上。ZooKeeper在一致性、可用性、容錯性的保證，也是ZooKeeper的成功之處，它獲得的一切成功都與它採用的協議——Zab協議是密不可分的</pre><p>1.14 Zookeeper的應用</p><pre> ZooKeeper本質上是一個分佈式的小文件存儲系統。原本是Apache Hadoop的一個組件，現在被拆分為一個Hadoop的獨立子項目，在HBase（Hadoop的另外一個被拆分出來的子項目，用於分佈式環境下的超大數據量的（DBMS）中也用到了ZooKeeper集群。 Hadoop，使用Zookeeper的事件處理確保整個集群只有一個NameNode，存儲配置信息等. HBase，使用Zookeeper的事件處理確保整個集群只有一個HMaster，察覺HRegionServer聯機和宕(dàng)機，存儲訪問控制列表等。 在ZooKeeper誕生的地方——Yahoo!他被用作雅虎消息代理的協調和故障恢復服務。雅虎消息代理是一個高度可擴展的發佈-訂閱系統，他管理著成千上萬臺聯及程序和信息控制系統。它的吞吐量標準已經達到大約每秒10000基於寫操作的工作量。對於讀操作的工作量來說，它的吞吐量標準還要高几倍。</pre><p>1.15 Zookeeper的特點</p><pre> 分佈式環境下的程序和活動為了達到協調一致目的，通常具有某些共同的特點，例如，簡單性、有序性等。ZooKeeper不但在這些目標的實現上有自身特點，並且具有獨特優勢</pre><p>簡單化</p><pre> ZooKeeper允許各分佈式進程通過一個共享的命名空間相互聯繫，該命名空間類似於一個標準的層次型的文件系統：由若干註冊了的數據節點構成(用Zookeeper的術語叫znode)，這些節點類似於文件和目錄。典型的文件系統是基於存儲設備的，文傳統的文件系統主要用於存儲功能，然而ZooKepper的數據是保存在內存中的。也就是說，可以獲得高吞吐和低延遲。 ZooKeeper的實現非常重視高性能、高可靠，以及嚴格的有序訪問。 高性能保證了ZooKeeper可以用於大型的分佈式系統，高可靠保證了ZooKeeper不會發生單點故障，嚴格的順序訪問保證了客戶端可以獲得複雜的同步操作原語。 </pre><p>健壯性</p><pre> 就像ZooKeeper需要協調的分佈式系統一樣，它本身就是具有冗餘結構，它構建在一系列主機之上，叫做一個”ensemble”。 構成ZooKeeper服務的各服務器之間必須相互知道，它們維護著一個狀態信息的內存映像，以及在持久化存儲中維護著事務日誌和快照。只要大部分服務器正常工作，ZooKeeper服務就能正常工作。 客戶端連接到一臺ZooKeeper服務器。客戶端維護這個TCP連接，通過這個連接，客戶端可以發送請求、得到應答，得到監視事件以及發送心跳。如果這個連接斷了，客戶端可以連接到另一個ZooKeeper服務器。</pre><p>有序性</p><pre> ZooKeeper給每次更新附加一個數字標籤，表明ZooKeeper中的事務順序，後續操作可以利用這個順序來完成更高層次的抽象功能，例如同步原語。</pre><p>速度優勢</p><pre> ZooKeeper特別適合於以讀為主要負荷的場合。ZooKeeper可以運行在數千臺機器上，如果大部分操作為讀，例如讀寫比例為10:1，ZooKeeper的效率會很高。</pre><p><strong>1.2 ZooKeeper數據模型</strong></p><pre> ZooKeeper所提供的服務主要是通過：數據結構+原語+watcher機制，三個部分來實現的。</pre><p>1.2.1 ZooKeeper數據模型Znode</p><div class=pgc-img><img alt=Zookeeper安裝、配置及集群搭建 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/61f2a81c5f8745d3a3f6f3ff9592f498><p class=pgc-img-caption></p></div><pre>從圖中可以看出ZooKeeper的數據模型，在結構上和標準文件系統的非常相似，都是採用這種樹形層次結構，ZooKeeper樹中的每個節點被稱為—Znode。和文件系統的目錄樹一樣，ZooKeeper樹中的每個節點可以擁有子節點。但也有不同之處：</pre><p>引用方式</p><pre>Zonde通過路徑引用，如同Unix中的文件路徑。路徑必須是絕對的，因此他們必須由斜槓字符來開頭。除此以外，他們必須是唯一的，也就是說每一個路徑只有一個表示，因此這些路徑不能改變。在ZooKeeper中，路徑由Unicode字符串組成，並且有一些限制。字符串"/zookeeper"用以保存管理信息，比如關鍵配額信息。</pre><p>Znode結構</p><pre> ZooKeeper命名空間中的Znode，兼具文件和目錄兩種特點。既像文件一樣維護著數據、元信息、ACL、時間戳等數據結構，又像目錄一樣可以作為路徑標識的一部分。圖中的每個節點稱為一個Znode。 每個Znode由3部分組成: 	stat：此為狀態信息, 描述該Znode的版本, 權限等信息 	data：與該Znode關聯的數據 	children：該Znode下的子節點 ZooKeeper雖然可以關聯一些數據，但並沒有被設計為常規的數據庫或者大數據存儲，相反的是，它用來管理調度數據，比如分佈式應用中的配置文件信息、狀態信息、彙集位置等等。這些數據的共同特性就是它們都是很小的數據，通常以KB為大小單位。ZooKeeper的服務器和客戶端都被設計為嚴格檢查並限制每個Znode的數據大小至多1M，但常規使用中應該遠小於此值。</pre><p>數據訪問</p><pre> ZooKeeper中的每個節點存儲的數據要被原子性的操作。也就是說讀操作將獲取與節點相關的所有數據，寫操作也將替換掉節點的所有數據。另外，每一個節點都擁有自己的ACL(訪問控制列表)，這個列表規定了用戶的權限，即限定了特定用戶對目標節點可以執行的操作。</pre><p>節點類型</p><pre> ZooKeeper中的節點有兩種，分別為臨時節點和永久節點。節點的類型在創建時即被確定，並且不能改變。 臨時節點：該節點的生命週期依賴於創建它們的會話。一旦會話(Session)結束，臨時節點將被自動刪除，當然可以也可以手動刪除。雖然每個臨時的Znode都會綁定到一個客戶端會話，但他們對所有的客戶端還是可見的。另外，ZooKeeper的臨時節點不允許擁有子節點。 永久節點：該節點的生命週期不依賴於會話，並且只有在客戶端顯示執行刪除操作的時候，他們才能被刪除。</pre><p>順序節點</p><pre> 當創建Znode的時候，用戶可以請求在ZooKeeper的路徑結尾添加一個遞增的計數。這個計數對於此節點的父節點來說是唯一的，它的格式為"%10d"(10位數字，沒有數值的數位用0補充，例如"0000000001")。當計數值大於232-1時，計數器將溢出。</pre><p>觀察</p><pre> 客戶端可以在節點上設置watch，我們稱之為監視器。當節點狀態發生改變時(Znode的增、刪、改)將會觸發watch所對應的操作。當watch被觸發時，ZooKeeper將會向客戶端發送且僅發送一條通知，因為watch只能被觸發一次，這樣可以減少網絡流量。</pre><p>1.2.2 ZooKeeper中的時間</p><pre>ZooKeeper有多種記錄時間的形式，其中包含以下幾個主要屬性： </pre><p>Zxid</p><pre> 致使ZooKeeper節點狀態改變的每一個操作都將使節點接收到一個Zxid格式的時間戳，並且這個時間戳全局有序。也就是說，也就是說，每個對 節點的改變都將產生一個唯一的Zxid。如果Zxid1的值小於Zxid2的值，那麼Zxid1所對應的事件發生在Zxid2所對應的事件之前。實際 上，ZooKeeper的每個節點維護者三個Zxid值，為別為：cZxid、mZxid、pZxid。 cZxid： 是節點的創建時間所對應的Zxid格式時間戳。 cZxid： 是節點的創建時間所對應的Zxid格式時間戳。 mZxid：是節點的修改時間所對應的Zxid格式時間戳。 實現Zxid是一個64位的數字，它高32位是epoch用來標識leader關係是否改變，每次一個leader被選出來，它都會有一個新的epoch。低32位是個遞增計數。</pre><p>版本號</p><pre> 對節點的每一個操作都將致使這個節點的版本號增加。每個節點維護著三個版本號，他們分別為： version：節點數據版本號 cversion：子節點版本號 aversion：節點所擁有的ACL版本號</pre><p>1.2.3 ZooKeeper節點屬性</p><div class=pgc-img><img alt=Zookeeper安裝、配置及集群搭建 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/507cda32cfa74eeab7abfe7d8338053e><p class=pgc-img-caption></p></div><p><strong>1.3 ZooKeeper服務中操作</strong></p><div class=pgc-img><img alt=Zookeeper安裝、配置及集群搭建 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/be39f2db693347b9890200abbc8bcbe4><p class=pgc-img-caption></p></div><pre> 更新ZooKeeper操作是有限制的。delete或setData必須明確要更新的Znode的版本號，我們可以調用exists找到。如果版本號不匹配，更新將會失敗。 更新ZooKeeper操作是非阻塞式的。因此客戶端如果失去了一個更新(由於另一個進程在同時更新這個Znode)，他可以在不阻塞其他進程執行的情況下，選擇重新嘗試或進行其他操作。 儘管ZooKeeper可以被看做是一個文件系統，但是處於便利，摒棄了一些文件系統地操作原語。因為文件非常的小並且使整體讀寫的，所以不需要打開、關閉或是尋地的操作。</pre><p><strong>1.4 Watch觸發器</strong></p><p>1.4.1 watch概述</p><pre> ZooKeeper可以為所有的讀操作設置watch，這些讀操作包括：exists()、getChildren()及getData()。watch事件是一次性的觸發器，當watch的對象狀態發生改變時，將會觸發此對象上watch所對應的事件。watch事件將被異步地發送給客戶端，並且ZooKeeper為watch機制提供了有序的一致性保證。理論上，客戶端接收watch事件的時間要快於其看到watch對象狀態變化的時間。</pre><p>1.4.2 watch類型</p><p>ZooKeeper所管理的watch可以分為兩類：</p><pre>數據watch(data watches)：getData和exists負責設置數據watch孩子watch(child watches)：getChildren負責設置孩子watch</pre><p>可以通過操作<strong>返回的數據</strong>來設置不同的watch：</p><pre>getData和exists：返回關於節點的數據信息getChildren：返回孩子列表</pre><p>返回</p><pre>一個成功的setData操作將觸發Znode的數據watch一個成功的create操作將觸發Znode的數據watch以及孩子watch一個成功的delete操作將觸發Znode的數據watch以及孩子watch</pre><p>1.4.3 watch註冊與觸發</p><div class=pgc-img><img alt=Zookeeper安裝、配置及集群搭建 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2a8cd51726e44f219a8e6691e14c88bb><p class=pgc-img-caption></p></div><pre> exists操作上的watch，在被監視的Znode創建、刪除或數據更新時被觸發。 getData操作上的watch，在被監視的Znode刪除或數據更新時被觸發。在被創建時不能被觸發，因為只有Znode一定存在，getData操作才會成功。 getChildren操作上的watch，在被監視的Znode的子節點創建或刪除，或是這個Znode自身被刪除時被觸發。可以通過查看watch事件類型來區分是Znode，還是他的子節點被刪除：NodeDelete表示Znode被刪除NodeDeletedChanged表示子節點被刪除。</pre><pre> Watch由客戶端所連接的ZooKeeper服務器在本地維護，因此watch可以非常容易地設置、管理和分派。當客戶端連接到一個新的服務器 時，任何的會話事件都將可能觸發watch。另外，當從服務器斷開連接的時候，watch將不會被接收。但是，當一個客戶端重新建立連接的時候，任何先前 註冊過的watch都會被重新註冊。</pre><pre> Zookeeper的watch實際上要處理兩類事件： 連接狀態事件(type=None, path=null) 這類事件不需要註冊，也不需要我們連續觸發，我們只要處理就行了。 節點事件 節點的建立，刪除，數據的修改。它是one time trigger，我們需要不停的註冊觸發，還可能發生事件丟失的情況。</pre><pre>節點事件的觸發，通過函數exists，getData或getChildren來處理這類函數，有雙重作用：	註冊觸發事件	函數本身的功能函數的本身的功能又可以用異步的回調函數來實現,重載processResult()過程中處理函數本身的的功能</pre><p><strong>1.5 Zookeeper分佈式應用</strong></p><p>1.5.1 Master啟動</p><pre> 使用Zookeeper啟動了兩個主節點，"主節點-A"和"主節點-B"他們啟動以後，都向ZooKeeper去註冊一個節點。我們 假設"主節點-A"鎖註冊地節點是"master-00001"，"主節點-B"註冊的節點是"master-00002"，註冊完以後進行選舉，編號最 小的節點將在選舉中獲勝獲得鎖成為主節點，也就是我們的"主節點-A"將會獲得鎖成為主節點，然後"主節點-B"將被阻塞成為一個備用節點。那麼，通過這 種方式就完成了對兩個Master進程的調度。</pre><div class=pgc-img><img alt=Zookeeper安裝、配置及集群搭建 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/69f4c9562d4040879190cccf67f64eef><p class=pgc-img-caption></p></div><p>1.5.2 Master故障</p><pre>如果"主節點-A"掛了，這時候他所註冊的節點將被自動刪除，ZooKeeper會自動感知節點的變化，然後再次發出選舉，這時候"主節點-B"將在選舉中獲勝，替代"主節點-A"成為主節點。</pre><div class=pgc-img><img alt=Zookeeper安裝、配置及集群搭建 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/62715e6ddcfd4adeb2ee529ab145f186><p class=pgc-img-caption></p></div><p>1.5.3 Master 恢復</p><div class=pgc-img><img alt=Zookeeper安裝、配置及集群搭建 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ddf1607dca6d4486815b6dc8486075c6><p class=pgc-img-caption></p></div><pre>如果主節點恢復了，他會再次向ZooKeeper註冊一個節點，這時候他註冊的節點將會是"master-00003"，ZooKeeper會感知節點的變化再次發動選舉，這時候"主節點-B"在選舉中會再次獲勝繼續擔任"主節點"，"主節點-A"會擔任備用節點</pre><h1><strong>二、 安裝與配置</strong></h1><p><strong>2.1 上傳和解壓</strong></p><pre>從官網下載地址下載Zookeeper 3.4.6，然後上傳到服務器，存儲目錄還是在/opt/work下。</pre><div class=pgc-img><img alt=Zookeeper安裝、配置及集群搭建 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d32ed2eaed464f52b1c30517255638d0><p class=pgc-img-caption></p></div><p><strong>2.2 配置和啟動</strong></p><p>進入到配置文件目錄進行配置</p><p>命令</p><pre>cp /opt/work/zookeeper-3.4.6/conf/zoo_sample.cfg /opt/work/zookeeper-3.4.6/conf/zoo.cfgvim /opt/work/zookeeper-3.4.6/conf/zoo.cfg 指定數據目錄和日誌目錄mkdir /opt/work/zookeeper-3.4.6/logs 創建日誌目錄</pre><div class=pgc-img><img alt=Zookeeper安裝、配置及集群搭建 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/24bf6cf9ee464dff9e8f8ff4ed39c51c><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=Zookeeper安裝、配置及集群搭建 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9af47c39713546a0b396d32d4646b3a9><p class=pgc-img-caption></p></div><p>讓Zookeeper添加到環境變量</p><p>命令：</p><pre>vim /etc/profile 編輯在末尾新增： export ZOOKEEPER_HOME=/opt/work/zookeeper-3.4.6/ export PATH=$ZOOKEEPER_HOME/bin:$PATH export PATH source /etc/profile 環境變量生效zkServer.sh start 	啟動zkServer.sh status 	查看狀態zkServer.sh restart 重啟zkServer.sh stop 停止</pre><div class=pgc-img><img alt=Zookeeper安裝、配置及集群搭建 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/da5c73b188a344868c4ac0c0a75feeb9><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=Zookeeper安裝、配置及集群搭建 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c5993047edb744a9a11ba874b600a354><p class=pgc-img-caption></p></div><h1><strong>三、 集群搭建</strong></h1><p><strong>3.1 安裝 zookeeper</strong></p><pre>下載地址https://www.apache.org/dyn/closer.cgi/zookeeper/</pre><p><strong>3.2 解壓</strong></p><pre>此處使用的是zookeeper-3.4.11.tar.gz 解壓位置在/ usr/local 下</pre><p><strong>3.3 創建數據目錄</strong></p><pre>此處我們在 zookeeper 的安裝目錄中創建一個 data 目錄和 logs 目錄,分別用於存放數據和日誌, 目錄和名字可以自己更改,但是後面配置的時候需要和此處創建的目錄位置一致</pre><p><strong>3.4 創建服務標記</strong></p><pre>服務標記的作用是用於區分每個 zookeeper 節點的, 在我們上面步驟創建的 data 目錄下面創建一個叫 myid 的文件,沒有後綴名,在裡面添加內容 ,內容為1-255任意數據,但是不同的節點必須唯一</pre><p><strong>3.5 修改配置文件</strong></p><pre>將 conf 目錄下的 zoo_sample.cf 重命名為 zoo.cfg(zookeeper 默認加載的文件名)</pre><div class=pgc-img><img alt=Zookeeper安裝、配置及集群搭建 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e4019a4c982b4407bd12d1155331c57f><p class=pgc-img-caption></p></div><p><strong>3.6 啟動</strong></p><pre>通過 bin 目錄中執行 ./zkServer.sh start 啟動每個節點,可以通過 ./zkServer.sh status 來查看狀態</pre></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Zookeeper</a></li><li><a>安裝</a></li><li><a>集群</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/041eb04f.html alt=阿里雲服務器快速建網站_安裝BT寶塔面板和wordpress class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/f2aaf81828344428b39b2102e2a62c2a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/041eb04f.html title=阿里雲服務器快速建網站_安裝BT寶塔面板和wordpress>阿里雲服務器快速建網站_安裝BT寶塔面板和wordpress</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/135c11db.html alt=知道手機基站是怎麼安裝的嗎？工藝有哪些要求 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3dc892aae9c74d6a80d6579347b13473 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/135c11db.html title=知道手機基站是怎麼安裝的嗎？工藝有哪些要求>知道手機基站是怎麼安裝的嗎？工藝有哪些要求</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/903d7c21.html alt=監控工程安裝網線距離大於100米怎麼辦？200米距離用什麼？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d41aa8af490947e1b20ede2499b5631f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/903d7c21.html title=監控工程安裝網線距離大於100米怎麼辦？200米距離用什麼？>監控工程安裝網線距離大於100米怎麼辦？200米距離用什麼？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0ab35864.html alt=【軸承知識】如何安裝和檢驗來提高軸承使用壽命 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b3ff2afcb84b42b2a7ed4b4dfe9c26ed style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0ab35864.html title=【軸承知識】如何安裝和檢驗來提高軸承使用壽命>【軸承知識】如何安裝和檢驗來提高軸承使用壽命</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1a91726f.html alt=安裝在軸承組中的預載荷 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/46beeeaacb1f4f899bf5ce8165e31c41 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1a91726f.html title=安裝在軸承組中的預載荷>安裝在軸承組中的預載荷</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/53a3885b.html alt=製冷劑溫度傳感器的原理、安裝位置、檢測方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/aabfe3a641ba44b8be37b20d7453dde6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/53a3885b.html title=製冷劑溫度傳感器的原理、安裝位置、檢測方法>製冷劑溫度傳感器的原理、安裝位置、檢測方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/43412662.html alt=衛津路改造工程河道混凝土管涵安裝進入收尾階段 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/S0oGD715VhJEGW style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/43412662.html title=衛津路改造工程河道混凝土管涵安裝進入收尾階段>衛津路改造工程河道混凝土管涵安裝進入收尾階段</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a8d0ee4a.html alt=密封墊片的安裝和材料的選擇 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/15306913948994eeb7c8b68 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a8d0ee4a.html title=密封墊片的安裝和材料的選擇>密封墊片的安裝和材料的選擇</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c79765a9.html alt=報警閥組的設置、安裝與驗收 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c79765a9.html title=報警閥組的設置、安裝與驗收>報警閥組的設置、安裝與驗收</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f3fa9df7.html alt=防振錘的安裝位置距線夾出口的距離計算（注電案例619） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/4abef6964b1c40ee887e52ea0d5b388e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f3fa9df7.html title=防振錘的安裝位置距線夾出口的距離計算（注電案例619）>防振錘的安裝位置距線夾出口的距離計算（注電案例619）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9f7978f6.html alt=配電箱安裝要求是什麼？看專家怎麼做的！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/2174937f0f624168b50dca57c885f74c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9f7978f6.html title=配電箱安裝要求是什麼？看專家怎麼做的！>配電箱安裝要求是什麼？看專家怎麼做的！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8675694a.html alt=安裝在鐵軌上的火車減速制動系統 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/33e6c331361f4b598793f476fd4812aa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8675694a.html title=安裝在鐵軌上的火車減速制動系統>安裝在鐵軌上的火車減速制動系統</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/48be9082.html alt=「注消每日考點」室外消火栓的安裝調試與檢測驗收 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/48be9082.html title=「注消每日考點」室外消火栓的安裝調試與檢測驗收>「注消每日考點」室外消火栓的安裝調試與檢測驗收</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c1c8b704.html alt=家裝水電、排水、改造安裝必備數據大全 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/93894501-22ab-45e9-aa61-b7449ffe7927 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c1c8b704.html title=家裝水電、排水、改造安裝必備數據大全>家裝水電、排水、改造安裝必備數據大全</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e5079544.html alt=給排水安裝施工工藝基本要求，看看大企業是怎麼做的 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/5d28a08c123145c39b2fbacb87b1736f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e5079544.html title=給排水安裝施工工藝基本要求，看看大企業是怎麼做的>給排水安裝施工工藝基本要求，看看大企業是怎麼做的</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>