<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>一種高級的DoS攻擊-Hash碰撞攻擊 | 极客快訊</title><meta property="og:title" content="一種高級的DoS攻擊-Hash碰撞攻擊 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/c1c0537cde484d3daea887e3ef059355"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bdcc4e56.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bdcc4e56.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bdcc4e56.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bdcc4e56.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bdcc4e56.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bdcc4e56.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/bdcc4e56.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/bdcc4e56.html><meta property="article:published_time" content="2020-11-14T21:07:43+08:00"><meta property="article:modified_time" content="2020-11-14T21:07:43+08:00"><meta name=Keywords content><meta name=description content="一種高級的DoS攻擊-Hash碰撞攻擊"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/bdcc4e56.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>一種高級的DoS攻擊-Hash碰撞攻擊</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><a class=pgc-link data-content=mp data-source=innerLink href=https://www.toutiao.com/item/6882629165695271438/ rel="noopener noreferrer" target=_blank>目錄-常見web安全問題</a></p><p><strong>什麼是Hash碰撞攻擊</strong></p><p><strong><span style="color:#4d4d4d;--tt-darkmode-color: #999999">就是通過精心構造數據，使得所有數據全部碰撞，人為將哈希表變成一個退化的單鏈表，此時哈希表各種操作的時間均提升了一個數量級，因此會消耗大量CPU資源，導致系統無法快速響應請求，從而達到拒絕服務攻擊（DoS）的目的。</span></strong></p><p>隨著RESTful風格的接口普及，程序員默認都會使用json作為數據傳遞的方式。json格式的數據冗餘少，兼容性高，從提出到現在已被廣泛的使用，可以說成為了Web的一種標準。無論我們服務端使用什麼語言，我們拿到json格式的數據之後都需要做jsonDecode(),將json串轉換為json對象，而對象默認會存儲於Hash Table，而Hash Table很容易被碰撞攻擊。我只要將攻擊數據放在json中，服務端程序在做jsonDecode()時必定中招，中招後CPU會立刻飆升至100%。16核的CPU，16個請求就能達到DoS的目的。</p><p><br></p><p><strong><span style="color:#4f4f4f;--tt-darkmode-color: #979797">哈希表碰撞攻擊的基本原理</span></strong></p><p><span style="color:#4d4d4d;--tt-darkmode-color: #999999">哈希表是一種查找效率極高的數據結構，很多語言都在內部實現了哈希表。PHP中的哈希表是一種極為重要的數據結構，不但用於表示Array數據類型，還在Zend虛擬機內部用於存儲上下文環境信息（執行上下文的變量及函數均使用哈希表結構存儲）。</span></p><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">理想情況下哈希表插入和查找操作的時間複雜度均為O(1)，任何一個數據項可以在一個與哈希表長度無關的時間內計算出一個哈希值（key），然後在常量時間內定位到一個桶（術語bucket，表示哈希表中的一個位置）。當然這是理想情況下，因為任何哈希表的長度都是有限的，所以一定存在不同的數據項具有相同哈希值的情況，此時不同數據項被</span><span style="color:#4d4d4d;--tt-darkmode-color: #999999">定為</span><span style="color:#4d4d4d;--tt-darkmode-color: #999999">到同一個桶，稱為碰撞（collision）。哈希表的實現需要解決碰撞問題，碰撞解決大體有兩種思路，第一種是根據某種原則將被碰撞數據</span><span style="color:#4d4d4d;--tt-darkmode-color: #999999">定為</span><span style="color:#4d4d4d;--tt-darkmode-color: #999999">到其它桶，例如線性探測——如果數據在插入時發生了碰撞，則順序查找這個桶後面的桶，將其放入第一個沒有被使用的桶；第二種策略是每個桶不是一個只能容納單個數據項的位置，而是一個可容納多個數據的數據結構（例如鏈表或紅黑樹），所有碰撞的數據以某種數據結構的形式組織起來。</span></p><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">不論使用了哪種碰撞解決策略，都導致插入和查找操作的時間複雜度不再是O(1)。以查找為例，不能通過key定位到桶就結束，必須還要比較原始key（即未做哈希之前的key）是否相等，如果不相等，則要使用與插入相同的算法繼續查找，直到找到匹配的值或確認數據不在哈希表中。</span></p><p style=text-align:start><span style="color:#4d4d4d;--tt-darkmode-color: #999999">PHP是使用單鏈表存儲碰撞的數據，因此實際上PHP哈希表的平均查找複雜度為O(L)，其中L為桶鏈表的平均長度；而最壞複雜度為O(N)，此時所有數據全部碰撞，哈希表退化成單鏈表。下圖PHP中正常哈希表和退化哈希表的示意圖。</span></p><div class=pgc-img><img alt=一種高級的DoS攻擊-Hash碰撞攻擊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c1c0537cde484d3daea887e3ef059355><p class=pgc-img-caption></p></div><p>圖中可以看到，當退出後的哈希表，所有數據都會碰撞，導致服務端CPU100。</p><h1 class=pgc-h-arrow-right><span style="color:#4f4f4f;--tt-darkmode-color: #979797">如何防禦</span></h1><ul><li><span style="color:#4d4d4d;--tt-darkmode-color: #999999">打補丁，修改hash算法。</span></li><li><span style="color:#4d4d4d;--tt-darkmode-color: #999999">限制POST的參數個數，限制POST的請求長度。</span></li><li><span style="color:#4d4d4d;--tt-darkmode-color: #999999">使用防火牆檢測異常請求</span></li><li><span style="color:#4d4d4d;--tt-darkmode-color: #999999">增加權限驗證，最大可能的在jsonDecode()之前把非法用戶拒絕</span></li><li><span style="color:#4d4d4d;--tt-darkmode-color: #999999">重寫jsonDecode()方法</span></li></ul><p><br></p><blockquote class=pgc-blockquote-abstract><p><span style="color:#707070;--tt-darkmode-color: #707070">備註:</span></p><p style=text-align:justify><span style="color:#707070;--tt-darkmode-color: #707070">這篇文章摘抄來自網絡。我打算總結一些列架構師需要的優秀文章，由於自己</span><span style="color:#707070;--tt-darkmode-color: #707070">寫會</span><span style="color:#707070;--tt-darkmode-color: #707070">花太多時間，我決定做一個搬運工，為大家篩選優秀的文章，最後我會做成索引方便大家查找。</span></p></blockquote></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>攻擊</a></li><li><a>一種</a></li><li><a>高級</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E9%81%8A%E6%88%B2/5fced757.html alt=口令攻擊方法是一種最常見的攻擊方法，也是最有效的攻擊方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9c13c9269ec547bb925d5d524dfda7b4 style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/5fced757.html title=口令攻擊方法是一種最常見的攻擊方法，也是最有效的攻擊方法>口令攻擊方法是一種最常見的攻擊方法，也是最有效的攻擊方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/531aa85.html alt=歧義，一種高級的錯誤 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/531aa85.html title=歧義，一種高級的錯誤>歧義，一種高級的錯誤</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/faa0028.html alt=最近火了一種鞋子，叫“黑色大頭皮鞋”，高級百搭顯氣質 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p9.pstatp.com/large/dfic-imagehandler/cff0acd3-69af-4d77-b088-9e39f03aae2f style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/faa0028.html title=最近火了一種鞋子，叫“黑色大頭皮鞋”，高級百搭顯氣質>最近火了一種鞋子，叫“黑色大頭皮鞋”，高級百搭顯氣質</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f4df1c1a.html alt="有一種音頻編碼技術叫MQA，聲音質感優於TIDAL HiFi（CD等級）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/6383bc881ccf4674aa3074a767f7f743 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f4df1c1a.html title="有一種音頻編碼技術叫MQA，聲音質感優於TIDAL HiFi（CD等級）">有一種音頻編碼技術叫MQA，聲音質感優於TIDAL HiFi（CD等級）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d4044e1f.html alt=2019年中式烹調師（高級）安全生產模擬考試題庫及答案（一） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d4044e1f.html title=2019年中式烹調師（高級）安全生產模擬考試題庫及答案（一）>2019年中式烹調師（高級）安全生產模擬考試題庫及答案（一）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f855d5ae.html alt=2019年中式烹調師（高級）安全生產模擬考試題庫及答案（二） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9796cfd44f754f9ab22310d91088423e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f855d5ae.html title=2019年中式烹調師（高級）安全生產模擬考試題庫及答案（二）>2019年中式烹調師（高級）安全生產模擬考試題庫及答案（二）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2161eb1b.html alt=一種可以除去砷的綠色方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2161eb1b.html title=一種可以除去砷的綠色方法>一種可以除去砷的綠色方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/30ef85ba.html alt=「今日賓川」有一種青春叫軍訓，那些年我們一起軍訓的日子 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1534765722006c4a614cbda style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/30ef85ba.html title=「今日賓川」有一種青春叫軍訓，那些年我們一起軍訓的日子>「今日賓川」有一種青春叫軍訓，那些年我們一起軍訓的日子</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6facd8bb.html alt=一種限滑可鎖的差速器總成-託森差速器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/377c51f9d3b3443796bd2aeacc50bf97 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6facd8bb.html title=一種限滑可鎖的差速器總成-託森差速器>一種限滑可鎖的差速器總成-託森差速器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5ec4d0cb.html alt="上海光機所提出一種基於濾波PRBS信號相位調製的線寬展寬方法，實現光纖激光<5GHz線寬1.27kW輸出" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ea110b92b2c84fa8bbf54234ec0e1ee3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5ec4d0cb.html title="上海光機所提出一種基於濾波PRBS信號相位調製的線寬展寬方法，實現光纖激光<5GHz線寬1.27kW輸出">上海光機所提出一種基於濾波PRBS信號相位調製的線寬展寬方法，實現光纖激光&lt;5GHz線寬1.27kW輸出</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0e7787ae.html alt="陳邕  素描既是一種獨立的藝術表現形式" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/0967d56ed7a845338717c864fefa6729 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0e7787ae.html title="陳邕  素描既是一種獨立的藝術表現形式">陳邕  素描既是一種獨立的藝術表現形式</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bf1b008b.html alt=世界上有一種動物的耙耙是方形的 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/6823/2478391326 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bf1b008b.html title=世界上有一種動物的耙耙是方形的>世界上有一種動物的耙耙是方形的</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e9b5e60d.html alt=承認錯誤也是一種勇敢 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1523331859560d5a2bd44e6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e9b5e60d.html title=承認錯誤也是一種勇敢>承認錯誤也是一種勇敢</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1875bfc7.html alt=生活中，敢於承認自己的錯誤，是一種成熟的表現 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/614f4c5c-9032-4849-91af-41b95d34c617 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1875bfc7.html title=生活中，敢於承認自己的錯誤，是一種成熟的表現>生活中，敢於承認自己的錯誤，是一種成熟的表現</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8a49ad87.html alt=Excel高級技巧051-不用公式進行兩列求和 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b058ed4d9d794ddf86567e0baa407b56 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8a49ad87.html title=Excel高級技巧051-不用公式進行兩列求和>Excel高級技巧051-不用公式進行兩列求和</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>