<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>é¢è©¦å¿…å‚™ï¼šHashMapæºç¢¼è§£æ | æå®¢å¿«è¨Š</title><meta property="og:title" content="é¢è©¦å¿…å‚™ï¼šHashMapæºç¢¼è§£æ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/03f9864cd43d4878900fc2a9784d702e"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c538446f.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c538446f.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c538446f.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c538446f.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c538446f.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c538446f.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c538446f.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c538446f.html><meta property="article:published_time" content="2020-10-29T21:09:20+08:00"><meta property="article:modified_time" content="2020-10-29T21:09:20+08:00"><meta name=Keywords content><meta name=description content="é¢è©¦å¿…å‚™ï¼šHashMapæºç¢¼è§£æ"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/c538446f.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>é¢è©¦å¿…å‚™ï¼šHashMapæºç¢¼è§£æ</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><pre><code>èªçœŸå¯«æ–‡ç« ï¼Œç”¨å¿ƒåšåˆ†äº«ã€‚å…¬çœ¾è™Ÿï¼šJavaè€•è€˜è€…</code></pre><p>æ•´å€‹HashMapç¤ºæ„åœ–ï¼š</p><div class=pgc-img><img alt=é¢è©¦å¿…å‚™ï¼šHashMapæºç¢¼è§£æ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/03f9864cd43d4878900fc2a9784d702e><p class=pgc-img-caption></p></div><p>HashMapçš„æºç¢¼ä¸­ï¼Œå……æ–¥å€‹å„ç¨®ä½é‹ç®—ä»£æ›¿å¸¸è¦é‹ç®—çš„åœ°æ–¹ï¼Œä»¥æå‡æ•ˆç‡ï¼š</p><ul><li>èˆ‡é‹ç®—æ›¿ä»£æ¨¡é‹ç®—ã€‚ç”¨ hash & (table.length-1) æ›¿ä»£ hash % (table.length)</li><li>ç”¨if ((e.hash & oldCap) == 0)åˆ¤æ–·æ“´å®¹å¾Œï¼Œç¯€é»eè™•æ–¼ä½å€é‚„æ˜¯é«˜å€ã€‚</li></ul><h2 class=pgc-h-arrow-right>3 éˆè¡¨ç¯€é»Node</h2><p>åœ¨é–‹å§‹ä¹‹å‰ï¼Œæˆ‘å€‘å…ˆçœ‹ä¸€ä¸‹æ›è¼‰åœ¨å“ˆå¸Œè¡¨ä¸Šçš„å…ƒç´ ï¼Œéˆè¡¨çš„çµæ§‹ï¼š</p><pre><code>    static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; {        final int hash;//å“ˆå¸Œå€¼        final K key;//key        V value;//value        Node&lt;K,V&gt; next;//éˆè¡¨å¾Œç½®ç¯€é»        Node(int hash, K key, V value, Node&lt;K,V&gt; next) {            this.hash = hash;            this.key = key;            this.value = value;            this.next = next;        }        public final K getKey()        { return key; }        public final V getValue()      { return value; }        public final String toString() { return key + "=" + value; }        //æ¯ä¸€å€‹ç¯€é»çš„hashå€¼ï¼Œæ˜¯å°‡keyçš„hashCode å’Œ valueçš„hashCode äº¦æˆ–å¾—åˆ°çš„ã€‚        public final int hashCode() {            return Objects.hashCode(key) ^ Objects.hashCode(value);        }        //è¨­ç½®æ–°çš„value åŒæ™‚è¿”å›èˆŠvalue        public final V setValue(V newValue) {            V oldValue = value;            value = newValue;            return oldValue;        }        public final boolean equals(Object o) {            if (o == this)                return true;            if (o instanceof Map.Entry) {                Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;                if (Objects.equals(key, e.getKey()) &amp;&amp;                    Objects.equals(value, e.getValue()))                    return true;            }            return false;        }    }</code></pre><p><strong>ç”±æ­¤å¯çŸ¥ï¼Œé€™æ˜¯ä¸€å€‹å–®éˆè¡¨~ã€‚<br>æ¯ä¸€å€‹ç¯€é»çš„hashå€¼ï¼Œæ˜¯å°‡keyçš„hashCode å’Œ valueçš„hashCode äº¦æˆ–å¾—åˆ°çš„ã€‚</strong></p><h2 class=pgc-h-arrow-right>4 æ§‹é€ å‡½æ•¸</h2><pre><code>    //æœ€å¤§å®¹é‡ 2çš„30æ¬¡æ–¹    static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30;    //é»˜èªçš„åŠ è¼‰å› å­    static final float DEFAULT_LOAD_FACTOR = 0.75f;    //å“ˆå¸Œæ¡¶ï¼Œå­˜æ”¾éˆè¡¨ã€‚ é•·åº¦æ˜¯2çš„Næ¬¡æ–¹ï¼Œæˆ–è€…åˆå§‹åŒ–æ™‚ç‚º0.    transient Node&lt;K,V&gt;[] table;    //åŠ è¼‰å› å­ï¼Œç”¨æ–¼è¨ˆç®—å“ˆå¸Œè¡¨å…ƒç´ æ•¸é‡çš„é–¾å€¼ã€‚  threshold = å“ˆå¸Œæ¡¶.length * loadFactor;    final float loadFactor;    //å“ˆå¸Œè¡¨å…§å…ƒç´ æ•¸é‡çš„é–¾å€¼ï¼Œç•¶å“ˆå¸Œè¡¨å…§å…ƒç´ æ•¸é‡è¶…éé–¾å€¼æ™‚ï¼Œæœƒç™¼ç”Ÿæ“´å®¹resize()ã€‚    int threshold;    public HashMap() {        //é»˜èªæ§‹é€ å‡½æ•¸ï¼Œè³¦å€¼åŠ è¼‰å› å­ç‚ºé»˜èªçš„0.75f        this.loadFactor = DEFAULT_LOAD_FACTOR; // all other fields defaulted    }    public HashMap(int initialCapacity) {        //æŒ‡å®šåˆå§‹åŒ–å®¹é‡çš„æ§‹é€ å‡½æ•¸        this(initialCapacity, DEFAULT_LOAD_FACTOR);    }    //åŒæ™‚æŒ‡å®šåˆå§‹åŒ–å®¹é‡ ä»¥åŠ åŠ è¼‰å› å­ï¼Œ ç”¨çš„å¾ˆå°‘ï¼Œä¸€èˆ¬ä¸æœƒä¿®æ”¹loadFactor    public HashMap(int initialCapacity, float loadFactor) {        //é‚Šç•Œè™•ç†        if (initialCapacity &lt; 0)            throw new IllegalArgumentException("Illegal initial capacity: " +                                               initialCapacity);        //åˆå§‹å®¹é‡æœ€å¤§ä¸èƒ½è¶…é2çš„30æ¬¡æ–¹        if (initialCapacity &gt; MAXIMUM_CAPACITY)            initialCapacity = MAXIMUM_CAPACITY;        //é¡¯ç„¶åŠ è¼‰å› å­ä¸èƒ½ç‚ºè² æ•¸        if (loadFactor &lt;= 0 || Float.isNaN(loadFactor))            throw new IllegalArgumentException("Illegal load factor: " +                                               loadFactor);        this.loadFactor = loadFactor;        //è¨­ç½®é–¾å€¼ç‚º  ã€‹=åˆå§‹åŒ–å®¹é‡çš„ 2çš„næ¬¡æ–¹çš„å€¼        this.threshold = tableSizeFor(initialCapacity);    }    //æ–°å»ºä¸€å€‹å“ˆå¸Œè¡¨ï¼ŒåŒæ™‚å°‡å¦ä¸€å€‹map m è£¡çš„æ‰€æœ‰å…ƒç´ åŠ å…¥è¡¨ä¸­    public HashMap(Map&lt;? extends K, ? extends V&gt; m) {        this.loadFactor = DEFAULT_LOAD_FACTOR;        putMapEntries(m, false);    }</code></pre><pre><code>    //æ ¹æ“šæœŸæœ›å®¹é‡capï¼Œè¿”å›2çš„næ¬¡æ–¹å½¢å¼çš„ å“ˆå¸Œæ¡¶çš„å¯¦éš›å®¹é‡ lengthã€‚ è¿”å›å€¼ä¸€èˆ¬æœƒ&gt;=cap     static final int tableSizeFor(int cap) {    //ç¶“éä¸‹é¢çš„ æˆ– å’Œä½ç§» é‹ç®—ï¼Œ næœ€çµ‚å„ä½éƒ½æ˜¯1ã€‚        int n = cap - 1;        n |= n &gt;&gt;&gt; 1;        n |= n &gt;&gt;&gt; 2;        n |= n &gt;&gt;&gt; 4;        n |= n &gt;&gt;&gt; 8;        n |= n &gt;&gt;&gt; 16;        //åˆ¤æ–·næ˜¯å¦è¶Šç•Œï¼Œè¿”å› 2çš„næ¬¡æ–¹ä½œç‚º tableï¼ˆå“ˆå¸Œæ¡¶ï¼‰çš„é–¾å€¼        return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;    }</code></pre><pre><code>    //å°‡å¦ä¸€å€‹Mapçš„æ‰€æœ‰å…ƒç´ åŠ å…¥è¡¨ä¸­ï¼Œåƒæ•¸evictåˆå§‹åŒ–æ™‚ç‚ºfalseï¼Œå…¶ä»–æƒ…æ³ç‚ºtrue    final void putMapEntries(Map&lt;? extends K, ? extends V&gt; m, boolean evict) {        //æ‹¿åˆ°mçš„å…ƒç´ æ•¸é‡        int s = m.size();        //å¦‚æœæ•¸é‡å¤§æ–¼0        if (s &gt; 0) {            //å¦‚æœç•¶å‰è¡¨æ˜¯ç©ºçš„            if (table == null) { // pre-size                //æ ¹æ“šmçš„å…ƒç´ æ•¸é‡å’Œç•¶å‰è¡¨çš„åŠ è¼‰å› å­ï¼Œè¨ˆç®—å‡ºé–¾å€¼                float ft = ((float)s / loadFactor) + 1.0F;                //ä¿®æ­£é–¾å€¼çš„é‚Šç•Œ ä¸èƒ½è¶…éMAXIMUM_CAPACITY                int t = ((ft &lt; (float)MAXIMUM_CAPACITY) ?                         (int)ft : MAXIMUM_CAPACITY);                //å¦‚æœæ–°çš„é–¾å€¼å¤§æ–¼ç•¶å‰é–¾å€¼                if (t &gt; threshold)                    //è¿”å›ä¸€å€‹ ã€‹=æ–°çš„é–¾å€¼çš„ æ»¿è¶³2çš„næ¬¡æ–¹çš„é–¾å€¼                    threshold = tableSizeFor(t);            }            //å¦‚æœç•¶å‰å…ƒç´ è¡¨ä¸æ˜¯ç©ºçš„ï¼Œä½†æ˜¯ mçš„å…ƒç´ æ•¸é‡å¤§æ–¼é–¾å€¼ï¼Œèªªæ˜ä¸€å®šè¦æ“´å®¹ã€‚            else if (s &gt; threshold)                resize();            //éæ­· m ä¾æ¬¡å°‡å…ƒç´ åŠ å…¥ç•¶å‰è¡¨ä¸­ã€‚            for (Map.Entry&lt;? extends K, ? extends V&gt; e : m.entrySet()) {                K key = e.getKey();                V value = e.getValue();                putVal(hash(key), key, value, false, evict);            }        }    }</code></pre><div class=pgc-img><img alt=é¢è©¦å¿…å‚™ï¼šHashMapæºç¢¼è§£æ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/dfic-imagehandler/071243af-fdce-413e-bf2e-c572a9263352><p class=pgc-img-caption></p></div><pre><code>    //å°‡å¦ä¸€å€‹Mapçš„æ‰€æœ‰å…ƒç´ åŠ å…¥è¡¨ä¸­ï¼Œåƒæ•¸evictåˆå§‹åŒ–æ™‚ç‚ºfalseï¼Œå…¶ä»–æƒ…æ³ç‚ºtrue    final void putMapEntries(Map&lt;? extends K, ? extends V&gt; m, boolean evict) {        //æ‹¿åˆ°mçš„å…ƒç´ æ•¸é‡        int s = m.size();        //å¦‚æœæ•¸é‡å¤§æ–¼0        if (s &gt; 0) {            //å¦‚æœç•¶å‰è¡¨æ˜¯ç©ºçš„            if (table == null) { // pre-size                //æ ¹æ“šmçš„å…ƒç´ æ•¸é‡å’Œç•¶å‰è¡¨çš„åŠ è¼‰å› å­ï¼Œè¨ˆç®—å‡ºé–¾å€¼                float ft = ((float)s / loadFactor) + 1.0F;                //ä¿®æ­£é–¾å€¼çš„é‚Šç•Œ ä¸èƒ½è¶…éMAXIMUM_CAPACITY                int t = ((ft &lt; (float)MAXIMUM_CAPACITY) ?                         (int)ft : MAXIMUM_CAPACITY);                //å¦‚æœæ–°çš„é–¾å€¼å¤§æ–¼ç•¶å‰é–¾å€¼                if (t &gt; threshold)                    //è¿”å›ä¸€å€‹ ã€‹=æ–°çš„é–¾å€¼çš„ æ»¿è¶³2çš„næ¬¡æ–¹çš„é–¾å€¼                    threshold = tableSizeFor(t);            }            //å¦‚æœç•¶å‰å…ƒç´ è¡¨ä¸æ˜¯ç©ºçš„ï¼Œä½†æ˜¯ mçš„å…ƒç´ æ•¸é‡å¤§æ–¼é–¾å€¼ï¼Œèªªæ˜ä¸€å®šè¦æ“´å®¹ã€‚            else if (s &gt; threshold)                resize();            //éæ­· m ä¾æ¬¡å°‡å…ƒç´ åŠ å…¥ç•¶å‰è¡¨ä¸­ã€‚            for (Map.Entry&lt;? extends K, ? extends V&gt; e : m.entrySet()) {                K key = e.getKey();                V value = e.getValue();                putVal(hash(key), key, value, false, evict);            }        }    }</code></pre><p>å…ˆçœ‹ä¸€ä¸‹æ“´å®¹å‡½æ•¸ï¼š é€™æ˜¯ä¸€å€‹é‡é»ï¼é‡é»ï¼é‡é»ï¼<br><strong>åˆå§‹åŒ–æˆ–åŠ å€å“ˆå¸Œæ¡¶å¤§å°ã€‚å¦‚æœæ˜¯ç•¶å‰å“ˆå¸Œæ¡¶æ˜¯null,åˆ†é…ç¬¦åˆç•¶å‰é–¾å€¼çš„åˆå§‹å®¹é‡ç›®æ¨™ã€‚<br>å¦å‰‡ï¼Œå› ç‚ºæˆ‘å€‘æ“´å®¹æˆä»¥å‰çš„å…©å€ã€‚<br>åœ¨æ“´å®¹æ™‚ï¼Œè¦æ³¨æ„å€åˆ†ä»¥å‰åœ¨å“ˆå¸Œæ¡¶ç›¸åŒindexçš„ç¯€é»ï¼Œç¾åœ¨æ˜¯åœ¨ä»¥å‰çš„indexè£¡ï¼Œé‚„æ˜¯index+oldlength è£¡</strong></p><pre><code>final Node&lt;K,V&gt;[] resize() {        //oldTab ç‚ºç•¶å‰è¡¨çš„å“ˆå¸Œæ¡¶        Node&lt;K,V&gt;[] oldTab = table;        //ç•¶å‰å“ˆå¸Œæ¡¶çš„å®¹é‡ length        int oldCap = (oldTab == null) ? 0 : oldTab.length;        //ç•¶å‰çš„é–¾å€¼        int oldThr = threshold;        //åˆå§‹åŒ–æ–°çš„å®¹é‡å’Œé–¾å€¼ç‚º0        int newCap, newThr = 0;        //å¦‚æœç•¶å‰å®¹é‡å¤§æ–¼0        if (oldCap &gt; 0) {            //å¦‚æœç•¶å‰å®¹é‡å·²ç¶“åˆ°é”ä¸Šé™            if (oldCap &gt;= MAXIMUM_CAPACITY) {                //å‰‡è¨­ç½®é–¾å€¼æ˜¯2çš„31æ¬¡æ–¹-1                threshold = Integer.MAX_VALUE;                //åŒæ™‚è¿”å›ç•¶å‰çš„å“ˆå¸Œæ¡¶ï¼Œä¸å†æ“´å®¹                return oldTab;            }//å¦å‰‡æ–°çš„å®¹é‡ç‚ºèˆŠçš„å®¹é‡çš„å…©å€ã€‚             else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp;                     oldCap &gt;= DEFAULT_INITIAL_CAPACITY)//å¦‚æœèˆŠçš„å®¹é‡å¤§æ–¼ç­‰æ–¼é»˜èªåˆå§‹å®¹é‡16                //é‚£éº¼æ–°çš„é–¾å€¼ä¹Ÿç­‰æ–¼èˆŠçš„é–¾å€¼çš„å…©å€                newThr = oldThr &lt;&lt; 1; // double threshold        }//å¦‚æœç•¶å‰è¡¨æ˜¯ç©ºçš„ï¼Œä½†æ˜¯æœ‰é–¾å€¼ã€‚ä»£è¡¨æ˜¯åˆå§‹åŒ–æ™‚æŒ‡å®šäº†å®¹é‡ã€é–¾å€¼çš„æƒ…æ³        else if (oldThr &gt; 0) // initial capacity was placed in threshold            newCap = oldThr;//é‚£éº¼æ–°è¡¨çš„å®¹é‡å°±ç­‰æ–¼èˆŠçš„é–¾å€¼        else {}//å¦‚æœç•¶å‰è¡¨æ˜¯ç©ºçš„ï¼Œè€Œä¸”ä¹Ÿæ²’æœ‰é–¾å€¼ã€‚ä»£è¡¨æ˜¯åˆå§‹åŒ–æ™‚æ²’æœ‰ä»»ä½•å®¹é‡/é–¾å€¼åƒæ•¸çš„æƒ…æ³               // zero initial threshold signifies using defaults            newCap = DEFAULT_INITIAL_CAPACITY;//æ­¤æ™‚æ–°è¡¨çš„å®¹é‡ç‚ºé»˜èªçš„å®¹é‡ 16            newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);//æ–°çš„é–¾å€¼ç‚ºé»˜èªå®¹é‡16 * é»˜èªåŠ è¼‰å› å­0.75f = 12        }        if (newThr == 0) {//å¦‚æœæ–°çš„é–¾å€¼æ˜¯0ï¼Œå°æ‡‰çš„æ˜¯  ç•¶å‰è¡¨æ˜¯ç©ºçš„ï¼Œä½†æ˜¯æœ‰é–¾å€¼çš„æƒ…æ³            float ft = (float)newCap * loadFactor;//æ ¹æ“šæ–°è¡¨å®¹é‡ å’Œ åŠ è¼‰å› å­ æ±‚å‡ºæ–°çš„é–¾å€¼            //é€²è¡Œè¶Šç•Œä¿®å¾©            newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ?                      (int)ft : Integer.MAX_VALUE);        }        //æ›´æ–°é–¾å€¼         threshold = newThr;        @SuppressWarnings({"rawtypes","unchecked"})        //æ ¹æ“šæ–°çš„å®¹é‡ æ§‹å»ºæ–°çš„å“ˆå¸Œæ¡¶            Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap];        //æ›´æ–°å“ˆå¸Œæ¡¶å¼•ç”¨        table = newTab;        //å¦‚æœä»¥å‰çš„å“ˆå¸Œæ¡¶ä¸­æœ‰å…ƒç´         //ä¸‹é¢é–‹å§‹å°‡ç•¶å‰å“ˆå¸Œæ¡¶ä¸­çš„æ‰€æœ‰ç¯€é»è½‰ç§»åˆ°æ–°çš„å“ˆå¸Œæ¡¶ä¸­        if (oldTab != null) {            //éæ­·è€çš„å“ˆå¸Œæ¡¶            for (int j = 0; j &lt; oldCap; ++j) {                //å–å‡ºç•¶å‰çš„ç¯€é» e                Node&lt;K,V&gt; e;                //å¦‚æœç•¶å‰æ¡¶ä¸­æœ‰å…ƒç´ ,å‰‡å°‡éˆè¡¨è³¦å€¼çµ¦e                if ((e = oldTab[j]) != null) {                    //å°‡åŸå“ˆå¸Œæ¡¶ç½®ç©ºä»¥ä¾¿GC                    oldTab[j] = null;                    //å¦‚æœç•¶å‰éˆè¡¨ä¸­å°±ä¸€å€‹å…ƒç´ ï¼Œï¼ˆæ²’æœ‰ç™¼ç”Ÿå“ˆå¸Œç¢°æ’ï¼‰                    if (e.next == null)                        //ç›´æ¥å°‡é€™å€‹å…ƒç´ æ”¾ç½®åœ¨æ–°çš„å“ˆå¸Œæ¡¶è£¡ã€‚                        //æ³¨æ„é€™è£¡å–ä¸‹æ¨™ æ˜¯ç”¨ å“ˆå¸Œå€¼ èˆ‡ æ¡¶çš„é•·åº¦-1 ã€‚ ç”±æ–¼æ¡¶çš„é•·åº¦æ˜¯2çš„næ¬¡æ–¹ï¼Œé€™éº¼åšå…¶å¯¦æ˜¯ç­‰æ–¼ ä¸€å€‹æ¨¡é‹ç®—ã€‚ä½†æ˜¯æ•ˆç‡æ›´é«˜                        newTab[e.hash &amp; (newCap - 1)] = e;                        //å¦‚æœç™¼ç”Ÿéå“ˆå¸Œç¢°æ’ ,è€Œä¸”æ˜¯ç¯€é»æ•¸è¶…é8å€‹ï¼Œè½‰åŒ–æˆäº†ç´…é»‘æ¨¹ï¼ˆæš«ä¸”ä¸è«‡ é¿å…éæ–¼è¤‡é›œï¼Œ å¾ŒçºŒå°ˆé–€ç ”ç©¶ä¸€ä¸‹ç´…é»‘æ¨¹ï¼‰                    else if (e instanceof TreeNode)                        ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap);                    //å¦‚æœç™¼ç”Ÿéå“ˆå¸Œç¢°æ’ï¼Œç¯€é»æ•¸å°æ–¼8å€‹ã€‚å‰‡è¦æ ¹æ“šéˆè¡¨ä¸Šæ¯å€‹ç¯€é»çš„å“ˆå¸Œå€¼ï¼Œä¾æ¬¡æ”¾å…¥æ–°å“ˆå¸Œæ¡¶å°æ‡‰ä¸‹æ¨™ä½ç½®ã€‚                    else { // preserve order                        //å› ç‚ºæ“´å®¹æ˜¯å®¹é‡ç¿»å€ï¼Œæ‰€ä»¥åŸéˆè¡¨ä¸Šçš„æ¯å€‹ç¯€é»ï¼Œç¾åœ¨å¯èƒ½å­˜æ”¾åœ¨åŸä¾†çš„ä¸‹æ¨™ï¼Œå³lowä½ï¼Œ æˆ–è€…æ“´å®¹å¾Œçš„ä¸‹æ¨™ï¼Œå³highä½ã€‚ highä½=  lowä½+åŸå“ˆå¸Œæ¡¶å®¹é‡                        //ä½ä½éˆè¡¨çš„é ­çµé»ã€å°¾ç¯€é»                        Node&lt;K,V&gt; loHead = null, loTail = null;                        //é«˜ä½éˆè¡¨çš„é ­ç¯€é»ã€å°¾ç¯€é»                        Node&lt;K,V&gt; hiHead = null, hiTail = null;                        Node&lt;K,V&gt; next;//è‡¨æ™‚ç¯€é» å­˜æ”¾eçš„ä¸‹ä¸€å€‹ç¯€é»                        do {                            next = e.next;                            //é€™è£¡åˆæ˜¯ä¸€å€‹åˆ©ç”¨ä½é‹ç®— ä»£æ›¿å¸¸è¦é‹ç®—çš„é«˜æ•ˆé»ï¼š åˆ©ç”¨å“ˆå¸Œå€¼ èˆ‡ èˆŠçš„å®¹é‡ï¼Œå¯ä»¥å¾—åˆ°å“ˆå¸Œå€¼å»æ¨¡å¾Œï¼Œæ˜¯å¤§æ–¼ç­‰æ–¼oldCapé‚„æ˜¯å°æ–¼oldCapï¼Œç­‰æ–¼0ä»£è¡¨å°æ–¼oldCapï¼Œæ‡‰è©²å­˜æ”¾åœ¨ä½ä½ï¼Œå¦å‰‡å­˜æ”¾åœ¨é«˜ä½                            if ((e.hash &amp; oldCap) == 0) {                                //çµ¦é ­å°¾ç¯€é»æŒ‡é‡è³¦å€¼                                if (loTail == null)                                    loHead = e;                                else                                    loTail.next = e;                                loTail = e;                            }//é«˜ä½ä¹Ÿæ˜¯ç›¸åŒçš„é‚è¼¯                            else {                                if (hiTail == null)                                    hiHead = e;                                else                                    hiTail.next = e;                                hiTail = e;                            }//å¾ªç’°ç›´åˆ°éˆè¡¨çµæŸ                        } while ((e = next) != null);                        //å°‡ä½ä½éˆè¡¨å­˜æ”¾åœ¨åŸindexè™•ï¼Œ                        if (loTail != null) {                            loTail.next = null;                            newTab[j] = loHead;                        }                        //å°‡é«˜ä½éˆè¡¨å­˜æ”¾åœ¨æ–°indexè™•                        if (hiTail != null) {                            hiTail.next = null;                            newTab[j + oldCap] = hiHead;                        }                    }                }            }        }        return newTab;    }</code></pre><p>å†çœ‹ä¸€ä¸‹ å¾€å“ˆå¸Œè¡¨è£¡æ’å…¥ä¸€å€‹ç¯€é»çš„putValå‡½æ•¸,å¦‚æœåƒæ•¸onlyIfAbsentæ˜¯trueï¼Œé‚£éº¼ä¸æœƒè¦†è“‹ç›¸åŒkeyçš„å€¼valueã€‚å¦‚æœevictæ˜¯falseã€‚é‚£éº¼è¡¨ç¤ºæ˜¯åœ¨åˆå§‹åŒ–æ™‚èª¿ç”¨çš„</p><pre><code>    final V putVal(int hash, K key, V value, boolean onlyIfAbsent,                   boolean evict) {        //tabå­˜æ”¾ ç•¶å‰çš„å“ˆå¸Œæ¡¶ï¼Œ pç”¨ä½œè‡¨æ™‚éˆè¡¨ç¯€é»          Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i;        //å¦‚æœç•¶å‰å“ˆå¸Œè¡¨æ˜¯ç©ºçš„ï¼Œä»£è¡¨æ˜¯åˆå§‹åŒ–        if ((tab = table) == null || (n = tab.length) == 0)            //é‚£éº¼ç›´æ¥å»æ“´å®¹å“ˆå¸Œè¡¨ï¼Œä¸¦ä¸”å°‡æ“´å®¹å¾Œçš„å“ˆå¸Œæ¡¶é•·åº¦è³¦å€¼çµ¦n            n = (tab = resize()).length;        //å¦‚æœç•¶å‰indexçš„ç¯€é»æ˜¯ç©ºçš„ï¼Œè¡¨ç¤ºæ²’æœ‰ç™¼ç”Ÿå“ˆå¸Œç¢°æ’ã€‚ ç›´æ¥æ§‹å»ºä¸€å€‹æ–°ç¯€é»Nodeï¼Œæ›è¼‰åœ¨indexè™•å³å¯ã€‚        //é€™è£¡å†å›‰å—¦ä¸€ä¸‹ï¼Œindex æ˜¯åˆ©ç”¨ å“ˆå¸Œå€¼ &amp; å“ˆå¸Œæ¡¶çš„é•·åº¦-1ï¼Œæ›¿ä»£æ¨¡é‹ç®—        if ((p = tab[i = (n - 1) &amp; hash]) == null)            tab[i] = newNode(hash, key, value, null);        else {//å¦å‰‡ ç™¼ç”Ÿäº†å“ˆå¸Œè¡çªã€‚            //e            Node&lt;K,V&gt; e; K k;            //å¦‚æœå“ˆå¸Œå€¼ç›¸ç­‰ï¼Œkeyä¹Ÿç›¸ç­‰ï¼Œå‰‡æ˜¯è¦†è“‹valueæ“ä½œ            if (p.hash == hash &amp;&amp;                ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))                e = p;//å°‡ç•¶å‰ç¯€é»å¼•ç”¨è³¦å€¼çµ¦e            else if (p instanceof TreeNode)//ç´…é»‘æ¨¹æš«ä¸”ä¸è«‡                e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value);            else {//ä¸æ˜¯è¦†è“‹æ“ä½œï¼Œå‰‡æ’å…¥ä¸€å€‹æ™®é€šéˆè¡¨ç¯€é»                //éæ­·éˆè¡¨                for (int binCount = 0; ; ++binCount) {                    if ((e = p.next) == null) {//éæ­·åˆ°å°¾éƒ¨ï¼Œè¿½åŠ æ–°ç¯€é»åˆ°å°¾éƒ¨                        p.next = newNode(hash, key, value, null);                        //å¦‚æœè¿½åŠ ç¯€é»å¾Œï¼Œéˆè¡¨æ•¸é‡ã€‹=8ï¼Œå‰‡è½‰åŒ–ç‚ºç´…é»‘æ¨¹                        if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st                            treeifyBin(tab, hash);                        break;                    }                    //å¦‚æœæ‰¾åˆ°äº†è¦è¦†è“‹çš„ç¯€é»                    if (e.hash == hash &amp;&amp;                        ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))                        break;                    p = e;                }            }            //å¦‚æœeä¸æ˜¯nullï¼Œèªªæ˜æœ‰éœ€è¦è¦†è“‹çš„ç¯€é»ï¼Œ            if (e != null) { // existing mapping for key                //å‰‡è¦†è“‹ç¯€é»å€¼ï¼Œä¸¦è¿”å›åŸoldValue                V oldValue = e.value;                if (!onlyIfAbsent || oldValue == null)                    e.value = value;                //é€™æ˜¯ä¸€å€‹ç©ºå¯¦ç¾çš„å‡½æ•¸ï¼Œç”¨ä½œLinkedHashMapé‡å¯«ä½¿ç”¨ã€‚                afterNodeAccess(e);                return oldValue;            }        }        //å¦‚æœåŸ·è¡Œåˆ°äº†é€™è£¡ï¼Œèªªæ˜æ’å…¥äº†ä¸€å€‹æ–°çš„ç¯€é»ï¼Œæ‰€ä»¥æœƒä¿®æ”¹modCountï¼Œä»¥åŠè¿”å›nullã€‚        //ä¿®æ”¹modCount        ++modCount;        //æ›´æ–°sizeï¼Œä¸¦åˆ¤æ–·æ˜¯å¦éœ€è¦æ“´å®¹ã€‚        if (++size &gt; threshold)            resize();        //é€™æ˜¯ä¸€å€‹ç©ºå¯¦ç¾çš„å‡½æ•¸ï¼Œç”¨ä½œLinkedHashMapé‡å¯«ä½¿ç”¨ã€‚        afterNodeInsertion(evict);        return null;    }</code></pre><p>newNodeå¦‚ä¸‹ï¼šæ§‹å»ºä¸€å€‹éˆè¡¨ç¯€é»</p><pre><code>    // Create a regular (non-tree) node    Node&lt;K,V&gt; newNode(int hash, K key, V value, Node&lt;K,V&gt; next) {        return new Node&lt;&gt;(hash, key, value, next);    }</code></pre><pre><code>    // Callbacks to allow LinkedHashMap post-actions    void afterNodeAccess(Node&lt;K,V&gt; p) { }    void afterNodeInsertion(boolean evict) { }</code></pre><p>å°çµï¼š</p><ul><li>é‹ç®—å„˜é‡éƒ½ç”¨<strong>ä½é‹ç®—</strong>ä»£æ›¿<strong>ï¼Œæ›´é«˜æ•ˆ</strong>ã€‚</li><li>å°æ–¼<strong>æ“´å®¹</strong>å°è‡´éœ€è¦æ–°å»ºæ•¸çµ„å­˜æ”¾æ›´å¤šå…ƒç´ æ™‚ï¼Œé™¤äº†è¦å°‡è€æ•¸çµ„ä¸­çš„å…ƒç´ é·ç§»éä¾†ï¼Œä¹Ÿè¨˜å¾—å°‡<strong>è€æ•¸çµ„ä¸­çš„å¼•ç”¨ç½®null</strong>ï¼Œä»¥ä¾¿<strong>GC</strong></li><li>å–ä¸‹æ¨™ æ˜¯ç”¨ <strong>å“ˆå¸Œå€¼ èˆ‡é‹ç®— ï¼ˆæ¡¶çš„é•·åº¦-1ï¼‰</strong> i = (n - 1) & hashã€‚ ç”±æ–¼æ¡¶çš„é•·åº¦æ˜¯2çš„næ¬¡æ–¹ï¼Œé€™éº¼åšå…¶å¯¦æ˜¯ç­‰æ–¼ ä¸€å€‹<strong>æ¨¡é‹ç®—</strong>ã€‚ä½†æ˜¯<strong>æ•ˆç‡æ›´é«˜</strong></li><li>æ“´å®¹æ™‚ï¼Œå¦‚æœç™¼ç”Ÿéå“ˆå¸Œç¢°æ’ï¼Œç¯€é»æ•¸å°æ–¼8å€‹ã€‚å‰‡è¦æ ¹æ“šéˆè¡¨ä¸Šæ¯å€‹ç¯€é»çš„å“ˆå¸Œå€¼ï¼Œä¾æ¬¡æ”¾å…¥æ–°å“ˆå¸Œæ¡¶å°æ‡‰ä¸‹æ¨™ä½ç½®ã€‚</li><li>å› ç‚ºæ“´å®¹æ˜¯å®¹é‡ç¿»å€ï¼Œæ‰€ä»¥åŸéˆè¡¨ä¸Šçš„æ¯å€‹ç¯€é»ï¼Œç¾åœ¨å¯èƒ½å­˜æ”¾åœ¨åŸä¾†çš„ä¸‹æ¨™ï¼Œå³lowä½ï¼Œ æˆ–è€…æ“´å®¹å¾Œçš„ä¸‹æ¨™ï¼Œå³highä½ã€‚ highä½= lowä½+åŸå“ˆå¸Œæ¡¶å®¹é‡</li><li>åˆ©ç”¨<strong>å“ˆå¸Œå€¼ èˆ‡é‹ç®— èˆŠçš„å®¹é‡</strong> ï¼Œif ((e.hash & oldCap) == 0),å¯ä»¥å¾—åˆ°å“ˆå¸Œå€¼å»æ¨¡å¾Œï¼Œæ˜¯å¤§æ–¼ç­‰æ–¼oldCapé‚„æ˜¯å°æ–¼oldCapï¼Œç­‰æ–¼0ä»£è¡¨å°æ–¼oldCapï¼Œ<strong>æ‡‰è©²å­˜æ”¾åœ¨ä½ä½ï¼Œå¦å‰‡å­˜æ”¾åœ¨é«˜ä½</strong>ã€‚é€™è£¡åˆæ˜¯ä¸€å€‹åˆ©ç”¨ä½é‹ç®— ä»£æ›¿å¸¸è¦é‹ç®—çš„é«˜æ•ˆé»</li><li>å¦‚æœè¿½åŠ ç¯€é»å¾Œï¼Œéˆè¡¨æ•¸é‡ã€‹=8ï¼Œå‰‡è½‰åŒ–ç‚ºç´…é»‘æ¨¹</li><li>æ’å…¥ç¯€é»æ“ä½œæ™‚ï¼Œæœ‰ä¸€äº›ç©ºå¯¦ç¾çš„å‡½æ•¸ï¼Œç”¨ä½œLinkedHashMapé‡å¯«ä½¿ç”¨ã€‚</li></ul><div class=pgc-img><img alt=é¢è©¦å¿…å‚™ï¼šHashMapæºç¢¼è§£æ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/dfic-imagehandler/e4da6289-875b-4f33-92d6-c5449e91eadb><p class=pgc-img-caption></p></div><h2 class=pgc-h-arrow-right>5 å¢ã€æ”¹</h2><h3 class=pgc-h-arrow-right>1å¾€è¡¨ä¸­æ’å…¥æˆ–è¦†è“‹ä¸€å€‹key-value</h3><pre><code>    public V put(K key, V value) {        //å…ˆæ ¹æ“škeyï¼Œå–å¾—hashå€¼ã€‚ å†èª¿ç”¨ä¸Šä¸€ç¯€çš„æ–¹æ³•æ’å…¥ç¯€é»        return putVal(hash(key), key, value, false, true);    }</code></pre><p>é€™å€‹æ ¹æ“škeyå–hashå€¼çš„å‡½æ•¸ä¹Ÿè¦é—œæ³¨ä¸€ä¸‹ï¼Œå®ƒç¨±ä¹‹ç‚ºâ€œæ“¾å‹•å‡½æ•¸â€ï¼Œé—œæ–¼é€™å€‹å‡½æ•¸çš„ç”¨è™• é–‹é ­å·²ç¶“ç¸½çµéäº†ï¼š</p><pre><code>    static final int hash(Object key) {        int h;        return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);    }</code></pre><p>è€Œkeyçš„hashå€¼ï¼Œä¸¦ä¸åƒ…åƒ…åªæ˜¯keyå°è±¡çš„hashCode()æ–¹æ³•çš„è¿”å›å€¼ï¼Œé‚„æœƒç¶“é<strong>æ“¾å‹•å‡½æ•¸</strong>çš„æ“¾å‹•ï¼Œä»¥ä½¿hashå€¼æ›´åŠ å‡è¡¡ã€‚<br>å› ç‚ºhashCode()æ˜¯inté¡å‹ï¼Œå–å€¼ç¯„åœæ˜¯40å¤šå„„ï¼Œåªè¦å“ˆå¸Œå‡½æ•¸æ˜ å°„çš„æ¯”è¼ƒå‡å‹»é¬†æ•£ï¼Œç¢°æ’æ©Ÿç‡æ˜¯å¾ˆå°çš„ã€‚<br>ä½†å°±ç®—åŸæœ¬çš„hashCode()å–å¾—å¾ˆå¥½ï¼Œæ¯å€‹keyçš„hashCode()ä¸åŒï¼Œä½†æ˜¯ç”±æ–¼HashMapçš„å“ˆå¸Œæ¡¶çš„é•·åº¦é æ¯”hashå–å€¼ç¯„åœå°ï¼Œé»˜èªæ˜¯16ï¼Œæ‰€ä»¥ç•¶å°hashå€¼ä»¥æ¡¶çš„é•·åº¦å–é¤˜ï¼Œä»¥æ‰¾åˆ°å­˜æ”¾è©²keyçš„æ¡¶çš„ä¸‹æ¨™æ™‚ï¼Œç”±æ–¼å–é¤˜æ˜¯é€šéèˆ‡æ“ä½œå®Œæˆçš„ï¼Œæœƒå¿½ç•¥hashå€¼çš„é«˜ä½ã€‚å› æ­¤åªæœ‰hashCode()çš„ä½ä½åƒåŠ é‹ç®—ï¼Œç™¼ç”Ÿä¸åŒçš„hashå€¼ï¼Œä½†æ˜¯å¾—åˆ°çš„indexç›¸åŒçš„æƒ…æ³çš„æ©Ÿç‡æœƒå¤§å¤§å¢åŠ ï¼Œé€™ç¨®æƒ…æ³ç¨±ä¹‹ç‚º<strong>hashç¢°æ’ã€‚</strong> å³ï¼Œç¢°æ’ç‡æœƒå¢å¤§ã€‚</p><p><strong>æ“¾å‹•å‡½æ•¸</strong>å°±æ˜¯ç‚ºäº†è§£æ±ºhashç¢°æ’çš„ã€‚å®ƒæœƒç¶œåˆhashå€¼é«˜ä½å’Œä½ä½çš„ç‰¹å¾µï¼Œä¸¦å­˜æ”¾åœ¨ä½ä½ï¼Œå› æ­¤åœ¨èˆ‡é‹ç®—æ™‚ï¼Œç›¸ç•¶æ–¼é«˜ä½ä½ä¸€èµ·åƒèˆ‡äº†é‹ç®—ï¼Œä»¥æ¸›å°‘hashç¢°æ’çš„æ¦‚ç‡ã€‚ï¼ˆåœ¨JDK8ä¹‹å‰ï¼Œæ“¾å‹•å‡½æ•¸æœƒæ“¾å‹•å››æ¬¡ï¼ŒJDK8ç°¡åŒ–äº†é€™å€‹æ“ä½œï¼‰</p><h3 class=pgc-h-arrow-right>2å¾€è¡¨ä¸­æ‰¹é‡å¢åŠ æ•¸æ“š</h3><pre><code>    public void putAll(Map&lt;? extends K, ? extends V&gt; m) {        //é€™å€‹å‡½æ•¸ä¸Šä¸€ç¯€ä¹Ÿå·²ç¶“åˆ†æéã€‚//å°‡å¦ä¸€å€‹Mapçš„æ‰€æœ‰å…ƒç´ åŠ å…¥è¡¨ä¸­ï¼Œåƒæ•¸evictåˆå§‹åŒ–æ™‚ç‚ºfalseï¼Œå…¶ä»–æƒ…æ³ç‚ºtrue        putMapEntries(m, true);    }</code></pre><h3 class=pgc-h-arrow-right>3 åªæœƒå¾€è¡¨ä¸­æ’å…¥ key-value, è‹¥keyå°æ‡‰çš„valueä¹‹å‰å­˜åœ¨ï¼Œä¸æœƒè¦†è“‹ã€‚ï¼ˆjdk8å¢åŠ çš„æ–¹æ³•ï¼‰</h3><pre><code>    @Override    public V putIfAbsent(K key, V value) {        return putVal(hash(key), key, value, true, true);    }</code></pre><h2 class=pgc-h-arrow-right>6 åˆª</h2><h3 class=pgc-h-arrow-right>ä»¥keyç‚ºæ¢ä»¶åˆªé™¤</h3><p>å¦‚æœkeyå°æ‡‰çš„valueå­˜åœ¨ï¼Œå‰‡åˆªé™¤é€™å€‹éµå€¼å°ã€‚ ä¸¦è¿”å›valueã€‚å¦‚æœä¸å­˜åœ¨ è¿”å›nullã€‚</p><pre><code>    public V remove(Object key) {        Node&lt;K,V&gt; e;        return (e = removeNode(hash(key), key, null, false, true)) == null ?            null : e.value;    }</code></pre><p>//å¾å“ˆå¸Œè¡¨ä¸­åˆªé™¤æŸå€‹ç¯€é»ï¼Œ å¦‚æœåƒæ•¸matchValueæ˜¯trueï¼Œå‰‡å¿…é ˆkey ã€valueéƒ½ç›¸ç­‰æ‰åˆªé™¤ã€‚<br>//å¦‚æœmovableåƒæ•¸æ˜¯falseï¼Œåœ¨åˆªé™¤ç¯€é»æ™‚ï¼Œä¸ç§»å‹•å…¶ä»–ç¯€é»</p><pre><code>    final Node&lt;K,V&gt; removeNode(int hash, Object key, Object value,                               boolean matchValue, boolean movable) {        // p æ˜¯å¾…åˆªé™¤ç¯€é»çš„å‰ç½®ç¯€é»        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, index;        //å¦‚æœå“ˆå¸Œè¡¨ä¸ç‚ºç©ºï¼Œå‰‡æ ¹æ“šhashå€¼ç®—å‡ºçš„indexä¸‹ æœ‰ç¯€é»çš„è©±ã€‚        if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp;            (p = tab[index = (n - 1) &amp; hash]) != null) {            //nodeæ˜¯å¾…åˆªé™¤ç¯€é»            Node&lt;K,V&gt; node = null, e; K k; V v;            //å¦‚æœéˆè¡¨é ­çš„å°±æ˜¯éœ€è¦åˆªé™¤çš„ç¯€é»            if (p.hash == hash &amp;&amp;                ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))                node = p;//å°‡å¾…åˆªé™¤ç¯€é»å¼•ç”¨è³¦çµ¦node            else if ((e = p.next) != null) {//å¦å‰‡å¾ªç’°éæ­· æ‰¾åˆ°å¾…åˆªé™¤ç¯€é»ï¼Œè³¦å€¼çµ¦node                if (p instanceof TreeNode)                    node = ((TreeNode&lt;K,V&gt;)p).getTreeNode(hash, key);                else {                    do {                        if (e.hash == hash &amp;&amp;                            ((k = e.key) == key ||                             (key != null &amp;&amp; key.equals(k)))) {                            node = e;                            break;                        }                        p = e;                    } while ((e = e.next) != null);                }            }            //å¦‚æœæœ‰å¾…åˆªé™¤ç¯€é»nodeï¼Œ  ä¸” matchValueç‚ºfalseï¼Œæˆ–è€…å€¼ä¹Ÿç›¸ç­‰            if (node != null &amp;&amp; (!matchValue || (v = node.value) == value ||                                 (value != null &amp;&amp; value.equals(v)))) {                if (node instanceof TreeNode)                    ((TreeNode&lt;K,V&gt;)node).removeTreeNode(this, tab, movable);                else if (node == p)//å¦‚æœnode ==  pï¼Œèªªæ˜æ˜¯éˆè¡¨é ­æ˜¯å¾…åˆªé™¤ç¯€é»                    tab[index] = node.next;                else//å¦å‰‡å¾…åˆªé™¤ç¯€é»åœ¨è¡¨ä¸­é–“                    p.next = node.next;                ++modCount;//ä¿®æ”¹modCount                --size;//ä¿®æ”¹size                afterNodeRemoval(node);//LinkedHashMapå›èª¿å‡½æ•¸                return node;            }        }        return null;    }</code></pre><pre><code>    void afterNodeRemoval(Node&lt;K,V&gt; p) { }è¤‡è£½ä»£ç¢¼</code></pre><h3 class=pgc-h-arrow-right>ä»¥key value ç‚ºæ¢ä»¶åˆªé™¤</h3><pre><code>    @Override    public boolean remove(Object key, Object value) {        //é€™è£¡å‚³å…¥äº†value åŒæ™‚matchValueç‚ºtrue        return removeNode(hash(key), key, value, true, true) != null;    }</code></pre><h2 class=pgc-h-arrow-right>7 æŸ¥</h2><h3 class=pgc-h-arrow-right>ä»¥keyç‚ºæ¢ä»¶ï¼Œæ‰¾åˆ°è¿”å›valueã€‚æ²’æ‰¾åˆ°è¿”å›null</h3><pre><code>    public V get(Object key) {        Node&lt;K,V&gt; e;        //å‚³å…¥æ“¾å‹•å¾Œçš„å“ˆå¸Œå€¼ å’Œ key æ‰¾åˆ°ç›®æ¨™ç¯€é»Node        return (e = getNode(hash(key), key)) == null ? null : e.value;    }</code></pre><pre><code>    //å‚³å…¥æ“¾å‹•å¾Œçš„å“ˆå¸Œå€¼ å’Œ key æ‰¾åˆ°ç›®æ¨™ç¯€é»Node    final Node&lt;K,V&gt; getNode(int hash, Object key) {        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; int n; K k;        //æŸ¥æ‰¾éç¨‹å’Œåˆªé™¤åŸºæœ¬å·®ä¸å¤šï¼Œ æ‰¾åˆ°è¿”å›ç¯€é»ï¼Œå¦å‰‡è¿”å›null        if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp;            (first = tab[(n - 1) &amp; hash]) != null) {            if (first.hash == hash &amp;&amp; // always check first node                ((k = first.key) == key || (key != null &amp;&amp; key.equals(k))))                return first;            if ((e = first.next) != null) {                if (first instanceof TreeNode)                    return ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);                do {                    if (e.hash == hash &amp;&amp;                        ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))                        return e;                } while ((e = e.next) != null);            }        }        return null;    }</code></pre><h3 class=pgc-h-arrow-right>åˆ¤æ–·æ˜¯å¦åŒ…å«è©²key</h3><pre><code>    public boolean containsKey(Object key) {        return getNode(hash(key), key) != null;    }</code></pre><h3 class=pgc-h-arrow-right>åˆ¤æ–·æ˜¯å¦åŒ…å«value</h3><pre><code>    public boolean containsValue(Object value) {        Node&lt;K,V&gt;[] tab; V v;        //éæ­·å“ˆå¸Œæ¡¶ä¸Šçš„æ¯ä¸€å€‹éˆè¡¨        if ((tab = table) != null &amp;&amp; size &gt; 0) {            for (int i = 0; i &lt; tab.length; ++i) {                for (Node&lt;K,V&gt; e = tab[i]; e != null; e = e.next) {                    //å¦‚æœæ‰¾åˆ°valueä¸€è‡´çš„è¿”å›true                    if ((v = e.value) == value ||                        (value != null &amp;&amp; value.equals(v)))                        return true;                }            }        }        return false;    }</code></pre><h3 class=pgc-h-arrow-right>java8æ–°å¢ï¼Œå¸¶é»˜èªå€¼çš„getæ–¹æ³•</h3><p>ä»¥keyç‚ºæ¢ä»¶ï¼Œæ‰¾åˆ°äº†è¿”å›valueã€‚å¦å‰‡è¿”å›defaultValue</p><pre><code>    @Override    public V getOrDefault(Object key, V defaultValue) {        Node&lt;K,V&gt; e;        return (e = getNode(hash(key), key)) == null ? defaultValue : e.value;    }</code></pre><h3 class=pgc-h-arrow-right>éæ­·</h3><pre><code>    //ç·©å­˜ entrySet    transient Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;     */    public Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet() {        Set&lt;Map.Entry&lt;K,V&gt;&gt; es;        return (es = entrySet) == null ? (entrySet = new EntrySet()) : es;    }</code></pre><pre><code>    final class EntrySet extends AbstractSet&lt;Map.Entry&lt;K,V&gt;&gt; {        public final int size()                 { return size; }        public final void clear()               { HashMap.this.clear(); }        //ä¸€èˆ¬æˆ‘å€‘ç”¨åˆ°EntrySetï¼Œéƒ½æ˜¯ç‚ºäº†ç²å–iterator        public final Iterator&lt;Map.Entry&lt;K,V&gt;&gt; iterator() {            return new EntryIterator();        }        //æœ€çµ‚é‚„æ˜¯èª¿ç”¨getNodeæ–¹æ³•        public final boolean contains(Object o) {            if (!(o instanceof Map.Entry))                return false;            Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;) o;            Object key = e.getKey();            Node&lt;K,V&gt; candidate = getNode(hash(key), key);            return candidate != null &amp;&amp; candidate.equals(e);        }        //æœ€çµ‚é‚„æ˜¯èª¿ç”¨removeNodeæ–¹æ³•        public final boolean remove(Object o) {            if (o instanceof Map.Entry) {                Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;) o;                Object key = e.getKey();                Object value = e.getValue();                return removeNode(hash(key), key, value, true, true) != null;            }            return false;        }        //ã€‚ã€‚ã€‚    }</code></pre><p>//EntryIteratorçš„å¯¦ç¾ï¼š</p><pre><code>    final class EntryIterator extends HashIterator        implements Iterator&lt;Map.Entry&lt;K,V&gt;&gt; {        public final Map.Entry&lt;K,V&gt; next() { return nextNode(); }    }</code></pre><pre><code>    abstract class HashIterator {        Node&lt;K,V&gt; next;        // next entry to return        Node&lt;K,V&gt; current;     // current entry        int expectedModCount;  // for fast-fail        int index;             // current slot        HashIterator() {            //å› ç‚ºhashmapä¹Ÿæ˜¯ç·šç¨‹ä¸å®‰å…¨çš„ï¼Œæ‰€ä»¥è¦ä¿å­˜modCountã€‚ç”¨æ–¼fail-fastç­–ç•¥            expectedModCount = modCount;            Node&lt;K,V&gt;[] t = table;            current = next = null;            index = 0;            //next åˆå§‹æ™‚ï¼ŒæŒ‡å‘ å“ˆå¸Œæ¡¶ä¸Šç¬¬ä¸€å€‹ä¸ç‚ºnullçš„éˆè¡¨é ­            if (t != null &amp;&amp; size &gt; 0) { // advance to first entry                do {} while (index &lt; t.length &amp;&amp; (next = t[index++]) == null);            }        }        public final boolean hasNext() {            return next != null;        }        //ç”±é€™å€‹æ–¹æ³•å¯ä»¥çœ‹å‡ºï¼Œéæ­·HashMapæ™‚ï¼Œé †åºæ˜¯æŒ‰ç…§å“ˆå¸Œæ¡¶å¾ä½åˆ°é«˜ï¼Œéˆè¡¨å¾å‰å¾€å¾Œï¼Œä¾æ¬¡éæ­·çš„ã€‚å±¬æ–¼ç„¡åºé›†åˆã€‚        final Node&lt;K,V&gt; nextNode() {            Node&lt;K,V&gt;[] t;            Node&lt;K,V&gt; e = next;            //fail-fastç­–ç•¥            if (modCount != expectedModCount)                throw new ConcurrentModificationException();            if (e == null)                throw new NoSuchElementException();            //ä¾æ¬¡å–éˆè¡¨ä¸‹ä¸€å€‹ç¯€é»ï¼Œ            if ((next = (current = e).next) == null &amp;&amp; (t = table) != null) {                //å¦‚æœç•¶å‰éˆè¡¨ç¯€é»éæ­·å®Œäº†ï¼Œå‰‡å–å“ˆå¸Œæ¡¶ä¸‹ä¸€å€‹ä¸ç‚ºnullçš„éˆè¡¨é ­                do {} while (index &lt; t.length &amp;&amp; (next = t[index++]) == null);            }            return e;        }        public final void remove() {            Node&lt;K,V&gt; p = current;            if (p == null)                throw new IllegalStateException();            ////fail-fastç­–ç•¥            if (modCount != expectedModCount)                throw new ConcurrentModificationException();            current = null;            K key = p.key;            //æœ€çµ‚é‚„æ˜¯åˆ©ç”¨removeNode åˆªé™¤ç¯€é»            removeNode(hash(key), key, null, false, false);            expectedModCount = modCount;        }    }</code></pre></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>é¢è©¦</a></li><li><a>å¿…å‚™</a></li><li><a>HashMap</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/b10623ce.html alt=ä½ ä¸å¾—ä¸çŸ¥é“çš„HashMapé¢è©¦é€£ç’°ç‚® class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/278ed0687f4d436f9cb8389a38b1603e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b10623ce.html title=ä½ ä¸å¾—ä¸çŸ¥é“çš„HashMapé¢è©¦é€£ç’°ç‚®>ä½ ä¸å¾—ä¸çŸ¥é“çš„HashMapé¢è©¦é€£ç’°ç‚®</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ae15b401.html alt="æœ‰é—œ HashMap é¢è©¦æœƒå•çš„ä¸€åˆ‡" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/25263d0d73a143bab5e44096efdd931d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ae15b401.html title="æœ‰é—œ HashMap é¢è©¦æœƒå•çš„ä¸€åˆ‡">æœ‰é—œ HashMap é¢è©¦æœƒå•çš„ä¸€åˆ‡</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3e2c89d5.html alt="é¢è©¦å®˜ï¼šç‚ºä»€éº¼ HashMap çš„åŠ è¼‰å› å­æ˜¯0.75ï¼Ÿ" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/15a700f4ff6a4082a566db903915ea1b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3e2c89d5.html title="é¢è©¦å®˜ï¼šç‚ºä»€éº¼ HashMap çš„åŠ è¼‰å› å­æ˜¯0.75ï¼Ÿ">é¢è©¦å®˜ï¼šç‚ºä»€éº¼ HashMap çš„åŠ è¼‰å› å­æ˜¯0.75ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/473f3fde.html alt=é¢è©¦å¿…å‚™--Linuxæ–‡ä»¶ç³»çµ± class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3a3f553730564e71a9aef13c31d7b2b5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/473f3fde.html title=é¢è©¦å¿…å‚™--Linuxæ–‡ä»¶ç³»çµ±>é¢è©¦å¿…å‚™--Linuxæ–‡ä»¶ç³»çµ±</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/61ae03dd.html alt=é¢è©¦å¿…å‚™ï¼šæ”¯æŒå‘é‡æ©Ÿï¼ˆSVMï¼‰é‡è¦çŸ¥è­˜é»ç¸½çµ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/61ae03dd.html title=é¢è©¦å¿…å‚™ï¼šæ”¯æŒå‘é‡æ©Ÿï¼ˆSVMï¼‰é‡è¦çŸ¥è­˜é»ç¸½çµ>é¢è©¦å¿…å‚™ï¼šæ”¯æŒå‘é‡æ©Ÿï¼ˆSVMï¼‰é‡è¦çŸ¥è­˜é»ç¸½çµ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/253ce164.html alt=HashMapé¢è©¦å°ˆé¡Œï¼šå¸¸å•å…­é¡Œæ·±å…¥è§£æ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/75bf5de0-37fd-469c-b6b3-8067c551568a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/253ce164.html title=HashMapé¢è©¦å°ˆé¡Œï¼šå¸¸å•å…­é¡Œæ·±å…¥è§£æ>HashMapé¢è©¦å°ˆé¡Œï¼šå¸¸å•å…­é¡Œæ·±å…¥è§£æ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dabba596.html alt=ä¸€å€‹HashMapèƒ½è·Ÿé¢è©¦å®˜æ‰¯ä¸ŠåŠå€‹å°æ™‚ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3c09bf1ad1b54adaab3db4be30c10c8b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dabba596.html title=ä¸€å€‹HashMapèƒ½è·Ÿé¢è©¦å®˜æ‰¯ä¸ŠåŠå€‹å°æ™‚>ä¸€å€‹HashMapèƒ½è·Ÿé¢è©¦å®˜æ‰¯ä¸ŠåŠå€‹å°æ™‚</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c64cd474.html alt=HashMapï¼Ÿé¢è©¦ï¼Ÿæˆ‘æ˜¯èª°ï¼Ÿæˆ‘åœ¨å“ª class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8aa437a2fb3143e7a345a46a36d2c81e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c64cd474.html title=HashMapï¼Ÿé¢è©¦ï¼Ÿæˆ‘æ˜¯èª°ï¼Ÿæˆ‘åœ¨å“ª>HashMapï¼Ÿé¢è©¦ï¼Ÿæˆ‘æ˜¯èª°ï¼Ÿæˆ‘åœ¨å“ª</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5a4f8a1a.html alt=ã€Œæœ€å®Œæ•´ç³»åˆ—ã€JAVA-å®¹å™¨ç¯‡-HashMapé¢è©¦æœ€è©³è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/71d7c60ccb9e4e57acda3ded903a1fd5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5a4f8a1a.html title=ã€Œæœ€å®Œæ•´ç³»åˆ—ã€JAVA-å®¹å™¨ç¯‡-HashMapé¢è©¦æœ€è©³è§£>ã€Œæœ€å®Œæ•´ç³»åˆ—ã€JAVA-å®¹å™¨ç¯‡-HashMapé¢è©¦æœ€è©³è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/36eefc47.html alt=é¢è©¦å¿…å•çš„HashMapï¼Œä½ çœŸçš„ç­è§£å—ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/19a8d23522b640b4a8d8a927514eca33 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/36eefc47.html title=é¢è©¦å¿…å•çš„HashMapï¼Œä½ çœŸçš„ç­è§£å—ï¼Ÿ>é¢è©¦å¿…å•çš„HashMapï¼Œä½ çœŸçš„ç­è§£å—ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ff690c4.html alt=é¢è©¦å¿…å‚™-åˆ†ä½ˆå¼äº‹å‹™æ–¹æ¡ˆ-å…©éšæ®µæäº¤ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/6e7df1e7193f4f8a8b2a4be269f569fb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ff690c4.html title=é¢è©¦å¿…å‚™-åˆ†ä½ˆå¼äº‹å‹™æ–¹æ¡ˆ-å…©éšæ®µæäº¤>é¢è©¦å¿…å‚™-åˆ†ä½ˆå¼äº‹å‹™æ–¹æ¡ˆ-å…©éšæ®µæäº¤</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f0ff6432.html alt=é‹¼çµæ§‹å¿…å‚™çŸ¥è­˜38å• class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f0ff6432.html title=é‹¼çµæ§‹å¿…å‚™çŸ¥è­˜38å•>é‹¼çµæ§‹å¿…å‚™çŸ¥è­˜38å•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bb258a5a.html alt=é‹¼çµæ§‹å¿…å‚™çŸ¥è­˜38å•ï¼Œä½ çš„æ™‰ç´šä¹‹è·¯ï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1535975955779bcac330762 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bb258a5a.html title=é‹¼çµæ§‹å¿…å‚™çŸ¥è­˜38å•ï¼Œä½ çš„æ™‰ç´šä¹‹è·¯ï¼>é‹¼çµæ§‹å¿…å‚™çŸ¥è­˜38å•ï¼Œä½ çš„æ™‰ç´šä¹‹è·¯ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/677306ff.html alt=é¢è©¦ç¸½çµï¼šé—œæ–¼MySQLäº‹å‹™çš„10å€‹å•é¡Œå¸¸è¦‹é¢è©¦å•ç­” class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/1669c986-315c-4339-a5a0-a918a47f2e57 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/677306ff.html title=é¢è©¦ç¸½çµï¼šé—œæ–¼MySQLäº‹å‹™çš„10å€‹å•é¡Œå¸¸è¦‹é¢è©¦å•ç­”>é¢è©¦ç¸½çµï¼šé—œæ–¼MySQLäº‹å‹™çš„10å€‹å•é¡Œå¸¸è¦‹é¢è©¦å•ç­”</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b4e33540.html alt="æ”¶è— | é€™äº›èˆªæ¸¬å¿…å‚™çš„çŸ¥è­˜é»ä½ ç­è§£å—ï¼Ÿ" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b4e33540.html title="æ”¶è— | é€™äº›èˆªæ¸¬å¿…å‚™çš„çŸ¥è­˜é»ä½ ç­è§£å—ï¼Ÿ">æ”¶è— | é€™äº›èˆªæ¸¬å¿…å‚™çš„çŸ¥è­˜é»ä½ ç­è§£å—ï¼Ÿ</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>