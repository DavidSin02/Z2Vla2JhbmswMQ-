<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Python接口測試實踐，一份值得收藏的用例封裝及測試報告生成指南 | 极客快訊</title><meta property="og:title" content="Python接口測試實踐，一份值得收藏的用例封裝及測試報告生成指南 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/195b22509d1b4a7b85d96fa32b962292"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c79afc07.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c79afc07.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c79afc07.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c79afc07.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c79afc07.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c79afc07.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c79afc07.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c79afc07.html><meta property="article:published_time" content="2020-11-14T21:01:26+08:00"><meta property="article:modified_time" content="2020-11-14T21:01:26+08:00"><meta name=Keywords content><meta name=description content="Python接口測試實踐，一份值得收藏的用例封裝及測試報告生成指南"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/c79afc07.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Python接口測試實踐，一份值得收藏的用例封裝及測試報告生成指南</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><strong>一、首先，我們想，什麼是 API 測試？</strong></p><p>API 測試其實是一種用程序或工具來發送數據，同時驗收系統的返回值的方法。這種測試更偏向於業務實現邏輯。常見的網絡協議有 TCP、Http、webservice、socket 等，http?和 webservice 都是基於 TCP/IP 協議的應用層協議，webservice 是基於 http 的 soap 協議傳輸數據。</p><div class=pgc-img><img alt=Python接口測試實踐，一份值得收藏的用例封裝及測試報告生成指南 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/195b22509d1b4a7b85d96fa32b962292><p class=pgc-img-caption></p></div><p><strong>二、接口自動化測試的基本流程有（如圖）：</strong></p><p>1、在測試工具中登記待測交易的接口報文格式；</p><p>2、編寫測試案例，向案例中添加交易接口並進行配置關聯；</p><p>3、準備測試數據並對測試數據進行參數化；</p><p>4、測試工具自動執行自動化測試案例；</p><p>5、測試工具比對預期結果和返回結果，驗證案例是否執行成功。</p><div class=pgc-img><img alt=Python接口測試實踐，一份值得收藏的用例封裝及測試報告生成指南 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/df4745d36674448d875a72577f96d914><p class=pgc-img-caption></p></div><p><strong>三、接口測試發現的典型問題</strong></p><p>接口測試經常遇到的bug和問題，如下：</p><p>（1）傳入參數處理不當，導致程序crash；</p><p>（2）類型溢出，導致數據讀出和寫入不一致；</p><p>（3）因對象權限未進行校驗，可以訪問其他用戶敏感信息；</p><p>（4）狀態處理不當，導致邏輯出現錯亂；</p><p>（5）邏輯校驗不完善，可利用漏洞獲取非正當利益等。</p><p><strong>四、舉例天氣API接口實戰</strong></p><p>我們今天就主要以天氣API接口為例，使用python語言實現用例編寫、封裝及報告生成功能。</p><p><strong>API信息：</strong></p><p>天氣API：http://www.51testing.com/html/88/n-4465288.html</p><p>URL:http://t.weather.sojson.com/api/weather/city/101030100</p><p>請求方式：get</p><p>參數：city 城市名稱</p><p><strong>①代碼實現查詢北京的天氣信息</strong></p><p>步驟：</p><p>1、新建 weather_api_test.py文件</p><p>代碼實現</p><p>#-*-coding:GBK -*-</p><p>import requests</p><p>from pip._vendor.requests.models import Response</p><p>url='http://t.weather.sojson.com/api/weather/city/101030100'</p><p>r=requests.get(url)</p><p>response_data=r.json()</p><p>print(r.text)</p><p>返回結果：</p><div class=pgc-img><img alt=Python接口測試實踐，一份值得收藏的用例封裝及測試報告生成指南 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3af20fe1711e458684549610863466ad><p class=pgc-img-caption></p></div><p><strong>②用例集成到Unittest</strong></p><p>1、針對不同的參數場景進行測試</p><p>2、設置斷言判斷執行結果是否符合預期</p><p>實現原理：</p><p>首先導入requests 庫、unitest 、時間庫</p><p>其次，創建天氣class類</p><p>然後，分別創建4個函數，分別實現存放路徑、正常傳參、異常傳參、缺省參數功能</p><p>3、用例設計</p><div class=pgc-img><img alt=Python接口測試實踐，一份值得收藏的用例封裝及測試報告生成指南 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a34e2d6081464e02b71eae475373127f><p class=pgc-img-caption></p></div><p>代碼實現：</p><p>新建 weather_api_unitest.py文件</p><p>#-*-coding:GBK -*-</p><p>import unittest</p><p>import requests</p><p>from time import sleep</p><p>class weathertest(unittest.TestCase):</p><p>def setUp(self):</p><p>self.url='http://t.weather.sojson.com/api/weather/city/101030100'</p><p>self.url_error='http://t.weather.sojson.com/api/weather/city/101030101'</p><p>self.url_no='http://t.weather.sojson.com/api/weather/city'</p><p>#參數正常</p><p>def test_weather_tianjing(self):</p><p>r=requests.get(self.url)</p><p>result=r.json()</p><p>self.assertEqual(result['status'],200)</p><p>self.assertEqual(result['message'],'success感謝又拍雲(upyun.com)提供CDN贊助')</p><p>sleep(3)</p><p>#參數異常</p><p>def test_weather_param_error(self):</p><p>r=requests.get(self.url_error)</p><p>result=r.json()</p><p>self.assertEqual(result['status'],400)</p><p>self.assertEqual(result['message'],'獲取失敗')</p><p>sleep(3)</p><p>#參數缺省</p><p>def test_weather_no_param(self):</p><p>r=requests.get(self.url_no)</p><p>result=r.json()</p><p>self.assertEqual(result['status'],404)</p><p>self.assertEqual(result['message'],'Request resource not found.')</p><p>sleep(3)</p><p>if __name__=='_main_':</p><p>unittest.main()</p><p><strong>③測試報告生成</strong></p><p>1、創建文件夾如圖，把測試用例放到test_case目錄下</p><div class=pgc-img><img alt=Python接口測試實踐，一份值得收藏的用例封裝及測試報告生成指南 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6fd0877778fc4c198cd325463163e844><p class=pgc-img-caption></p></div><p>2、下載BSTestRunner模塊並放置到python Lib文件夾下</p><p>如路徑 C:\Python34\Lib</p><p>3、創建run.py 文件</p><p>代碼：</p><p>import unittest</p><p>from BSTestRunner import BSTestRunner</p><p>import time</p><p>#指定測試用例和報告路徑</p><p>test_dir='./test_case'</p><p>report_dir='./reports'</p><p>#加載測試用例</p><p>discover=unittest.defaultTestLoader.discover(test_dir, pattern='weather_api_unittest.py')</p><p>#定義報告格式</p><p>now=time.strftime('%Y-%m-%d %H_%M_%S')</p><p>report_name=report_dir+'/'+now+'test_report.html'</p><p>#運行用例並生成測試報告</p><p>with open(report_name,'wb') as f:</p><p>runner=BSTestRunner(stream=f,title="weather api test report",description="china city weather test report")</p><p>runner.run(discover)</p><p>4、運行run.py，在reports文件夾下查看生成的報告</p><div class=pgc-img><img alt=Python接口測試實踐，一份值得收藏的用例封裝及測試報告生成指南 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/b853837191c4415bb8f073df87b1af4e><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=Python接口測試實踐，一份值得收藏的用例封裝及測試報告生成指南 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/925efafc116f48eab183eb0286a5ec91><p class=pgc-img-caption></p></div><p><strong>五、總結</strong></p><p>最後我們再來總結一下接口測試的常用知識點和你需要掌握的。</p><p>1、requests發送get請求和post請求的方法</p><p>get(url, params=None, **kwargs)</p><p>post(url, data=None, json=None, **kwargs)</p><p>2、parmas參數和data參數的區別</p><p>由於get請求無請求體，post請求有請求體。</p><p>使用params參數時，默認會把參數附加到url後面，所以發送get請求時應使用params參數。</p><p>使用data參數時，參數會存放到請求體中，所以發送post請求時不能使用params，應使用data，除非接口及支持get又支持post，同樣get請求也不能使用data參數。</p><p>3、如何使用Seesion解決接口保持狀態的問題</p><p>初始化Session實例，通過這個實例調用request()方法發送請求。</p><p>4、最重要的一個封裝方法，並掌握這個封裝該如何使用</p><p>主要針對get和post請求的接口。</p><p>總之，API 測試上手很簡單，但做得好，做成工程化還真需要費一點力氣，一些技術細節的把控和提升，會無形中提升整體的測試水準；而如何讓 API 測試真正在我們的日常工作中發揮出最大作用，也需慢慢研究和調整的。</p><p><strong>請關注+私信回覆：“測試”就可以免費拿到軟件測試學習資料。</strong></p><div class=pgc-img><img alt=Python接口測試實踐，一份值得收藏的用例封裝及測試報告生成指南 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/6a8aceadda87417cb7fc23b33e78c89f><p class=pgc-img-caption></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>測試</a></li><li><a>Python</a></li><li><a>實踐</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/b6acbddb.html alt=「壓鑄實踐」大截面ZA27鋅合金蝸輪的雙重擠壓鑄造應用案例 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/972374c8b24644389e188cb290249f17 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b6acbddb.html title=「壓鑄實踐」大截面ZA27鋅合金蝸輪的雙重擠壓鑄造應用案例>「壓鑄實踐」大截面ZA27鋅合金蝸輪的雙重擠壓鑄造應用案例</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/91eece92.html alt="只需 45 秒，Python 給故宮畫一組手繪圖！" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/df1bd890ffee4a439e9f5142ae42c102 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/91eece92.html title="只需 45 秒，Python 給故宮畫一組手繪圖！">只需 45 秒，Python 給故宮畫一組手繪圖！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8aab963e.html alt=Python手繪圖瞭解一下！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/746c9e6e214b48b2a0215fc9e151cdc8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8aab963e.html title=Python手繪圖瞭解一下！>Python手繪圖瞭解一下！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cfd854c6.html alt=故宮下雪了！我用Python給它畫了一組手繪圖，僅用45秒（附代碼） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/774d2f0a372f48c589ec84dd3a164dd9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cfd854c6.html title=故宮下雪了！我用Python給它畫了一組手繪圖，僅用45秒（附代碼）>故宮下雪了！我用Python給它畫了一組手繪圖，僅用45秒（附代碼）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6d1c2a0c.html alt=塑料扯斷伸長率的概念及測試要點 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/6fe0ba07-c929-4046-9216-7f6d5eaa1716 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6d1c2a0c.html title=塑料扯斷伸長率的概念及測試要點>塑料扯斷伸長率的概念及測試要點</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ebbbc375.html alt=時間繼電器測試儀的使用方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1205bf787f1f4de6a5f1e73e7737887b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ebbbc375.html title=時間繼電器測試儀的使用方法>時間繼電器測試儀的使用方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b433c17e.html alt="四十、Python模塊random: 偽隨機數據生成與隨機元素抽取" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/25f231d6-c1ce-4cf8-8988-5da509a0c26a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b433c17e.html title="四十、Python模塊random: 偽隨機數據生成與隨機元素抽取">四十、Python模塊random: 偽隨機數據生成與隨機元素抽取</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bee6be40.html alt=河北省邯鄲市計量測試所大力實施專業技能提升行動 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bee6be40.html title=河北省邯鄲市計量測試所大力實施專業技能提升行動>河北省邯鄲市計量測試所大力實施專業技能提升行動</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9b084990.html alt=介質損耗測試儀的操作方法與注意事項 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/1a746168-e5df-4643-9117-3f1fb4faf100 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9b084990.html title=介質損耗測試儀的操作方法與注意事項>介質損耗測試儀的操作方法與注意事項</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d38b572e.html alt=有關於射頻測試設備：電纜/天線分析儀 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/0e79c2e668d84f09be994180e66f90c8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d38b572e.html title=有關於射頻測試設備：電纜/天線分析儀>有關於射頻測試設備：電纜/天線分析儀</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/04486eba.html alt=Python爬蟲使用selenium爬取群成員信息（全自動實現自動登陸） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/e11e69f643584941aaa2b71ee6ed3d7f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/04486eba.html title=Python爬蟲使用selenium爬取群成員信息（全自動實現自動登陸）>Python爬蟲使用selenium爬取群成員信息（全自動實現自動登陸）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/86b46e6d.html alt=Python爬蟲教程，利用Python採集QQ群成員信息 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6d6cce76ad48405c9dbb960d4617bcef style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/86b46e6d.html title=Python爬蟲教程，利用Python採集QQ群成員信息>Python爬蟲教程，利用Python採集QQ群成員信息</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b096e432.html alt=餐飲業的共益實踐案例：是什麼留住了海底撈的員工？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3253c0fd3b54497282e5ebfb67cc350c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b096e432.html title=餐飲業的共益實踐案例：是什麼留住了海底撈的員工？>餐飲業的共益實踐案例：是什麼留住了海底撈的員工？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7739dc7a.html alt=Python數據可視化Matplotlib，如何在一副圖像中顯示多組柱形圖？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/5d4a0000046e1bea8b90 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7739dc7a.html title=Python數據可視化Matplotlib，如何在一副圖像中顯示多組柱形圖？>Python數據可視化Matplotlib，如何在一副圖像中顯示多組柱形圖？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e0f90fbd.html alt=透氣性、透氣度測試知多少？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/45ac8fb9-3365-4327-901d-b21b7cd9cbbf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e0f90fbd.html title=透氣性、透氣度測試知多少？>透氣性、透氣度測試知多少？</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>