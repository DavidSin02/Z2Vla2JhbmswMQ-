<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>æ©Ÿå™¨å­¸ç¿’å…¥é–€ç¬¬1ç« ï¼šç›£ç£å­¸ç¿’å’Œæ¨¸ç´ è²è‘‰æ–¯åˆ†é¡-ç¬¬2éƒ¨åˆ†ï¼ˆç·¨ç¢¼ï¼‰ | æå®¢å¿«è¨Š</title><meta property="og:title" content="æ©Ÿå™¨å­¸ç¿’å…¥é–€ç¬¬1ç« ï¼šç›£ç£å­¸ç¿’å’Œæ¨¸ç´ è²è‘‰æ–¯åˆ†é¡-ç¬¬2éƒ¨åˆ†ï¼ˆç·¨ç¢¼ï¼‰ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/a6894d2d1ea64a8eb3bad2b892648639"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c9b52b0.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c9b52b0.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c9b52b0.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c9b52b0.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c9b52b0.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c9b52b0.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/c9b52b0.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/c9b52b0.html><meta property="article:published_time" content="2020-10-29T21:07:51+08:00"><meta property="article:modified_time" content="2020-10-29T21:07:51+08:00"><meta name=Keywords content><meta name=description content="æ©Ÿå™¨å­¸ç¿’å…¥é–€ç¬¬1ç« ï¼šç›£ç£å­¸ç¿’å’Œæ¨¸ç´ è²è‘‰æ–¯åˆ†é¡-ç¬¬2éƒ¨åˆ†ï¼ˆç·¨ç¢¼ï¼‰"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/c9b52b0.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>æ©Ÿå™¨å­¸ç¿’å…¥é–€ç¬¬1ç« ï¼šç›£ç£å­¸ç¿’å’Œæ¨¸ç´ è²è‘‰æ–¯åˆ†é¡-ç¬¬2éƒ¨åˆ†ï¼ˆç·¨ç¢¼ï¼‰</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><p><br></p><div class=pgc-img><img alt=æ©Ÿå™¨å­¸ç¿’å…¥é–€ç¬¬1ç« ï¼šç›£ç£å­¸ç¿’å’Œæ¨¸ç´ è²è‘‰æ–¯åˆ†é¡-ç¬¬2éƒ¨åˆ†ï¼ˆç·¨ç¢¼ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a6894d2d1ea64a8eb3bad2b892648639><p class=pgc-img-caption>The question of whether a computer can think is no more interesting than the question of whether a s</p></div><p><br></p><p>æ³¨æ„ï¼šå¦‚æœæ‚¨æ²’æœ‰é–±è®€éç¬¬ä¸€éƒ¨åˆ†ï¼Œå³æ¨¸ç´ è²è‘‰æ–¯ç†è«–ï¼Œæˆ‘å»ºè­°æ‚¨é€šè®€å®ƒã€‚</p><p>åœ¨é€™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘å€‘å°‡æ¢ç´¢sklearnåº«ã€‚ pythonä¸­çš„sklearnæä¾›äº†æº–å‚™ä½¿ç”¨æµè¡Œçš„æ©Ÿå™¨å­¸ç¿’ç®—æ³•ï¼Œä¾‹å¦‚Naive Bayesã€‚ ï¼ˆå®ƒæ¶‰åŠå…¶ä»–äººï¼Œä¾‹å¦‚SVMï¼Œé€™å°‡åœ¨ä»¥å¾Œçš„æ–‡ç« ä¸­ä»‹ç´¹ï¼‰ã€‚ æœ‰äº†é€™å€‹ï¼Œæ‚¨å°±ä¸å¿…æ‰‹å‹•ç·¨ç¢¼è‡ªå·±çš„Naive Bayeså¯¦ç¾ã€‚</p><div class=pgc-img><img alt=æ©Ÿå™¨å­¸ç¿’å…¥é–€ç¬¬1ç« ï¼šç›£ç£å­¸ç¿’å’Œæ¨¸ç´ è²è‘‰æ–¯åˆ†é¡-ç¬¬2éƒ¨åˆ†ï¼ˆç·¨ç¢¼ï¼‰ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/21531acc949d4084a774a2de9a017973><p class=pgc-img-caption>Give a man a program, frustrate him for a day.Teach a man to program, frustrate him for a lifetime.</p></div><h1 class=pgc-h-arrow-right><strong>ç·¨ç¢¼ç·´ç¿’</strong></h1><p>åœ¨æœ¬ç·´ç¿’ä¸­ï¼Œæˆ‘å€‘å°‡ä½¿ç”¨æ¨™è¨˜ç‚º"åƒåœ¾éƒµä»¶"æˆ–"éåƒåœ¾éƒµä»¶"çš„é›»å­éƒµä»¶é›†è¨“ç·´æ¨¡å‹ã€‚ æœ‰702å°é›»å­éƒµä»¶ï¼Œå‡åˆ†ç‚ºåƒåœ¾éƒµä»¶å’Œéåƒåœ¾éƒµä»¶é¡åˆ¥ã€‚ æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘å°‡åœ¨260å°é›»å­éƒµä»¶ä¸­æ¸¬è©¦è©²æ¨¡å‹ã€‚ æˆ‘å€‘å°‡è¦æ±‚æ¨¡å‹é æ¸¬æ­¤é›»å­éƒµä»¶çš„é¡åˆ¥ï¼Œä¸¦å°‡æº–ç¢ºæ€§èˆ‡æˆ‘å€‘å·²ç¶“çŸ¥é“çš„æ­£ç¢ºåˆ†é¡é€²è¡Œæ¯”è¼ƒã€‚</p><p>é€™æ˜¯æ–‡æœ¬æ•¸æ“šæŒ–æ˜çš„ç¶“å…¸ç¤ºä¾‹ã€‚</p><h1 class=pgc-h-arrow-right><strong>å…ˆæ±ºæ¢ä»¶</strong></h1><p>æœ¬æ•™ç¨‹å‡å®šç·¨ç¢¼å·¥ä½œæ˜¯åœ¨åŸºæ–¼Debiançš„Linuxä¸Šå®Œæˆçš„ã€‚ å®‰è£èªªæ˜å¯èƒ½æœƒå› æ‰€ä½¿ç”¨çš„æ“ä½œç³»çµ±è€Œç•°ï¼Œä½†æ˜¯pythonä»£ç¢¼ä¿æŒä¸è®Šã€‚</p><p>Â· å®‰è£Pythonã€‚</p><p>Â· å®‰è£Pipã€‚</p><p>Â· ç‚ºpythonå®‰è£sklearnï¼špip install scikit-learn</p><p>Â· å®‰è£numpyï¼špip install numpy</p><p>Â· å®‰è£SciPyï¼špip install scipy</p><h1 class=pgc-h-arrow-right><strong>0.ä¸‹è¼‰</strong></h1><p>æˆ‘å·²ç¶“ç‚ºæ•¸æ“šé›†å’Œç¤ºä¾‹ä»£ç¢¼å‰µå»ºäº†ä¸€å€‹gitå­˜å„²åº«ã€‚ ã€‚ æœ¬ç« è¨è«–äº†ç›¸åŒçš„æ•¸æ“šé›†ã€‚ æˆ‘å»ºè­°æ‚¨ç¹¼çºŒè¨è«–ä¸¦è‡ªå·±ç·¨å¯«ä»£ç¢¼ã€‚ è¬ä¸€å®ƒå¤±æ•—äº†ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨/åƒè€ƒæˆ‘çš„ç‰ˆæœ¬ä¾†äº†è§£å·¥ä½œã€‚</p><h1 class=pgc-h-arrow-right><strong>1.æ¸…æ½”å’Œæº–å‚™æ•¸æ“š</strong></h1><p>æˆ‘å€‘æœ‰å…©å€‹æ–‡ä»¶å¤¾test-mailå’Œtrain-mailã€‚ æˆ‘å€‘å°‡ä½¿ç”¨åŸ¹è¨“éƒµä»¶ä¾†è¨“ç·´æ¨¡å‹ã€‚ æ¨£æœ¬é›»å­éƒµä»¶æ•¸æ“šé›†å¦‚ä¸‹æ‰€ç¤ºï¼š</p><blockquote class=pgc-blockquote-abstract><p>Subject: re : 2 . 882 s - > np np> deat : sun , 15 dec 91 2 : 25 : 2 est > : michael &lt; mmorse @ vm1 . yorku . ca > > subject : re : 2 . 864 query > > wlodek zadrozny ask " anything interest " > construction " s > np np " . . . second , > much relate : consider construction form > discuss list late reduplication ? > logical sense " john mcnamara name " tautologous thus , > level , indistinguishable " , , here ? " . ' john mcnamara name ' tautologous support those logic-base semantics irrelevant natural language . sense tautologous ? supplies value attribute follow attribute value . fact value name-attribute relevant entity ' chaim shmendrik ' , ' john mcnamara name ' false . tautology , . ( reduplication , either . )</p></blockquote><p><br></p><p>ç¬¬ä¸€è¡Œæ˜¯ä¸»é¡Œï¼Œå…§å®¹å¾ç¬¬ä¸‰è¡Œé–‹å§‹ã€‚</p><p>å¦‚æœæ‚¨å°èˆªåˆ°ä»»ä½•åŸ¹è¨“éƒµä»¶æˆ–æ¸¬è©¦éƒµä»¶ï¼Œæ‚¨å°‡çœ‹åˆ°å…©ç¨®æ ¼å¼çš„æ–‡ä»¶å</p><pre><code>number-numbermsg[number].txt : example 3-1msg1.txt (this are non spam emails)ORspmsg[Number].txt : example spmsga162.txt (these files are of spam emails).</code></pre><p><br></p><p>æ–‡æœ¬æ•¸æ“šæŒ–æ˜ä»»å‹™çš„ç¬¬ä¸€æ­¥æ˜¯æ¸…ç†ä¸¦æº–å‚™æ¨¡å‹æ•¸æ“šã€‚ åœ¨æ¸…æ½”éç¨‹ä¸­ï¼Œæˆ‘å€‘å¾æ–‡æœ¬ä¸­åˆªé™¤äº†ä¸éœ€è¦çš„å–®è©ï¼Œè¡¨é”å¼å’Œç¬¦è™Ÿã€‚</p><p>è€ƒæ…®ä¸€å€‹æ–‡æœ¬ï¼š</p><blockquote class=pgc-blockquote-abstract><p>â€œHi, this is Alice. Hope you are doing well and enjoying your vacation.â€</p></blockquote><p>é€™è£¡çš„"æ˜¯"ï¼Œ"é€™å€‹"ï¼Œ"æ˜¯"ç­‰å­—æ¨£ä¸¦æ²’æœ‰çœŸæ­£æœ‰åŠ©æ–¼åˆ†æã€‚ é€™æ¨£çš„å–®è©ä¹Ÿç¨±ç‚ºåœç”¨è©ã€‚å› æ­¤ï¼Œåœ¨æœ¬ç·´ç¿’ä¸­ï¼Œæˆ‘å€‘åƒ…è€ƒæ…®é›»å­éƒµä»¶ä¸­æœ€å¸¸è¦‹çš„3000å€‹å–®è©ã€‚ ä»¥ä¸‹æ˜¯ä»£ç¢¼æ®µã€‚</p><p>æ¸…ç†å®Œæˆ‘å€‘éœ€è¦çš„æ¯å€‹é›»å­éƒµä»¶æ–‡æª”ä¹‹å¾Œï¼Œæˆ‘å€‘æ‡‰è©²ä»¥å–®è©é »ç‡çš„æŸç¨®çŸ©é™£è¡¨ç¤ºå½¢å¼ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœæ–‡æª”åŒ…å«æ–‡æœ¬ï¼š"å—¨ï¼Œé€™æ˜¯æ„›éº—çµ²ã€‚ æ„›éº—çµ²ç”Ÿæ—¥å¿«æ¨‚"æ¸…æ´—å¾Œï¼Œæˆ‘å€‘æƒ³è¦ä¸€äº›æ±è¥¿</p><pre><code>word      :   Hi this is Alice Happy Birthdayfrequency :   1   1    1  2      1      </code></pre><p><br></p><p>æˆ‘å€‘éœ€è¦æ¯å€‹æ–‡æª”ã€‚ ä¸‹é¢çš„extract_featuresï¼ˆç¬¬2ç¯€ï¼‰å‡½æ•¸åŸ·è¡Œæ­¤æ“ä½œï¼Œç„¶å¾Œç‚ºæ¯å€‹æ–‡æª”åˆªé™¤ä¸å¤ªå¸¸è¦‹çš„å–®è©ã€‚</p><pre><code>def make_Dictionary(root_dir):   all_words = []   emails = [os.path.join(root_dir,f) for f in os.listdir(root_dir)]   for mail in emails:        with open(mail) as m:            for line in m:                words = line.split()                all_words += words   dictionary = Counter(all_words)   # if you have python version 3.x use commented version.   # list_to_remove = list(dictionary)   list_to_remove = dictionary.keys()   for item in list_to_remove:       # remove if numerical.        if item.isalpha() == False:            del dictionary[item]        elif len(item) == 1:            del dictionary[item]    # consider only most 3000 common words in dictionary.   dictionary = dictionary.most_common(3000)   return dictionary</code></pre><p>make_Dictionaryå¾æ–‡ä»¶å¤¾ä¸­è®€å–é›»å­éƒµä»¶æ–‡ä»¶ï¼Œç‚ºæ‰€æœ‰å–®è©æ§‹å»ºå­—å…¸ã€‚ æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘åˆªé™¤é•·åº¦ä¸æ˜¯1ä¸”ä¸æ˜¯ç´”ç²¹å­—æ¯çš„å–®è©ã€‚</p><p>æœ€å¾Œï¼Œæˆ‘å€‘åªæå–å‡º3000å€‹æœ€å¸¸ç”¨çš„å–®è©ã€‚</p><h1 class=pgc-h-arrow-right><strong>2.æå–ç‰¹å¾µå’Œç›¸æ‡‰çš„æ¨™ç±¤çŸ©é™£ã€‚</strong></h1><p>æ¥ä¸‹ä¾†è—‰åŠ©å­—å…¸ï¼Œæˆ‘å€‘ç”Ÿæˆæ¨™ç±¤å’Œè©é »çŸ©é™£</p><pre><code>word      :   Hi this is Alice Happy Birthdayfrequency :   1   1    1  2      1      1word      :   Hi this is Alice Happy Birthdayfrequency :   1   1    1  2      1      1</code></pre><pre><code>def extract_features(mail_dir):  files = [os.path.join(mail_dir,fi) for fi in os.listdir(mail_dir)]  features_matrix = np.zeros((len(files),3000))  train_labels = np.zeros(len(files))  count = 0;  docID = 0;  for fil in files:    with open(fil) as fi:      for i,line in enumerate(fi):        if i == 2:          words = line.split()          for word in words:            wordID = 0            for i,d in enumerate(dictionary):              if d[0] == word:                wordID = i                features_matrix[docID,wordID] = words.count(word)      train_labels[docID] = 0;      filepathTokens = fil.split('/')      lastToken = filepathTokens[len(filepathTokens) - 1]      if lastToken.startswith("spmsg"):          train_labels[docID] = 1;          count = count + 1      docID = docID + 1  return features_matrix, train_labels</code></pre><p><br></p><h1 class=pgc-h-arrow-right><strong>3ï¼Œä½¿ç”¨sklearnå¤©çœŸè²è‘‰æ–¯é€²è¡Œè¨“ç·´å’Œé æ¸¬</strong></h1><p>sklearn Naive Bayesçš„æ–‡æª”ï¼ˆåœ¨æ­¤ï¼‰æ¸…æ¥šåœ°èªªæ˜äº†ç”¨æ³•å’Œåƒæ•¸ã€‚</p><p>åŸºæœ¬ä¸Šï¼Œsklearn Naive Bayesç‚ºæ¨¡å‹è¨“ç·´æä¾›äº†ä¸‰ç¨®é¸æ“‡ï¼š</p><p>Â· é«˜æ–¯ï¼šç”¨æ–¼åˆ†é¡ï¼Œä¸¦å‡è¨­è¦ç´ æœå¾æ­£æ…‹åˆ†ä½ˆã€‚</p><p>Â· å¤šé …å¼ï¼šç”¨æ–¼é›¢æ•£è¨ˆæ•¸ã€‚ ä¾‹å¦‚ï¼Œå‡è¨­æˆ‘å€‘æœ‰ä¸€å€‹æ–‡æœ¬åˆ†é¡å•é¡Œã€‚ åœ¨é€™è£¡ï¼Œæˆ‘å€‘å¯ä»¥è€ƒæ…®é€²ä¸€æ­¥é€²è¡Œbernoulliå¯¦é©—ï¼Œè€Œä¸æ˜¯"åœ¨æ–‡æª”ä¸­å‡ºç¾å–®è©"ï¼Œè€Œæ˜¯"è¨ˆç®—åœ¨æ–‡æª”ä¸­å‡ºç¾å–®è©çš„é »ç‡"ï¼Œæ‚¨å¯ä»¥å°‡å…¶è¦–ç‚º"è§€å¯Ÿåˆ°çµæœæ•¸x_içš„æ¬¡æ•¸" åœ¨næ¬¡å¯©åˆ¤ä¸­"ã€‚</p><p>Â· ä¼¯åŠªåˆ©ï¼ˆBernoulliï¼‰ï¼šå¦‚æœæ‚¨çš„ç‰¹å¾µå‘é‡æ˜¯äºŒé€²åˆ¶ï¼ˆå³é›¶å’Œä¸€ï¼‰ï¼Œå‰‡äºŒé …å¼æ¨¡å‹å¾ˆæœ‰ç”¨ã€‚ ä¸€ç¨®æ‡‰ç”¨æ˜¯ä½¿ç”¨"å–®è©è¢‹"æ¨¡å‹é€²è¡Œæ–‡æœ¬åˆ†é¡ï¼Œå…¶ä¸­1å’Œ0åˆ†åˆ¥æ˜¯"å–®è©å‡ºç¾åœ¨æ–‡æª”ä¸­"å’Œ"å–®è©æ²’æœ‰å‡ºç¾åœ¨æ–‡æª”ä¸­"ã€‚</p><p>åœ¨æœ¬ç·´ç¿’ä¸­ï¼Œæˆ‘å€‘å°‡ä½¿ç”¨é«˜æ–¯ã€‚ ç¤ºä¾‹ä»£ç¢¼ç‰‡æ®µå¦‚ä¸‹æ‰€ç¤º</p><pre><code>TRAIN_DIR = "../train-mails"TEST_DIR = "../test-mails"dictionary = make_Dictionary(TRAIN_DIR)# using functions mentioned above.features_matrix, labels = extract_features(TRAIN_DIR)test_feature_matrix, test_labels = extract_features(TEST_DIR)from sklearn.naive_bayes import GaussianNBmodel = GaussianNB()#train modelmodel.fit(features_matrix, labels)#predictpredicted_labels = model.predict(test_feature_matrix)</code></pre><p><br></p><h1 class=pgc-h-arrow-right><strong>4.æº–ç¢ºæ€§å¾—åˆ†</strong></h1><p>æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘æ¯”è¼ƒé æ¸¬æ¨™ç±¤çš„æº–ç¢ºæ€§å¾—åˆ†ã€‚ æº–ç¢ºæ€§åˆ†æ•¸åªæ˜¯æ­£ç¢ºé æ¸¬çš„ç™¾åˆ†æ¯”ã€‚ å†æ¬¡ï¼Œsklearnç‚ºæº–ç¢ºåº¦åˆ†æ•¸è¨ˆç®—æä¾›äº†ç°¡æ½”çš„å¯¦ç¾ã€‚</p><pre><code>from sklearn.metrics import accuracy_scoreaccuracy = accuracy_score(test_labels, predicted_labels)</code></pre><h1 class=pgc-h-arrow-right><strong>5.æ‹¼æ¹Šåœ¨ä¸€èµ·</strong></h1><pre><code>import osimport numpy as npfrom collections import Counterfrom sklearn.naive_bayes import GaussianNBfrom sklearn.metrics import accuracy_scoredef make_Dictionary(root_dir):   all_words = []   emails = [os.path.join(root_dir,f) for f in os.listdir(root_dir)]    for mail in emails:        with open(mail) as m:            for line in m:                words = line.split()                all_words += words    dictionary = Counter(all_words)    list_to_remove = dictionary.keys()    for item in list_to_remove:        if item.isalpha() == False:            del dictionary[item]        elif len(item) == 1:            del dictionary[item]    dictionary = dictionary.most_common(3000)    return dictionarydef extract_features(mail_dir):  files = [os.path.join(mail_dir,fi) for fi in os.listdir(mail_dir)]  features_matrix = np.zeros((len(files),3000))  train_labels = np.zeros(len(files))  count = 0;  docID = 0;  for fil in files:    with open(fil) as fi:      for i,line in enumerate(fi):        if i == 2:          words = line.split()          for word in words:            wordID = 0            for i,d in enumerate(dictionary):              if d[0] == word:                wordID = i                features_matrix[docID,wordID] = words.count(word)      train_labels[docID] = 0;      filepathTokens = fil.split('/')      lastToken = filepathTokens[len(filepathTokens) - 1]      if lastToken.startswith("spmsg"):          train_labels[docID] = 1;          count = count + 1      docID = docID + 1  return features_matrix, train_labelsTRAIN_DIR = "../train-mails"TEST_DIR = "../test-mails"dictionary = make_Dictionary(TRAIN_DIR)print "reading and processing emails from file."features_matrix, labels = extract_features(TRAIN_DIR)test_feature_matrix, test_labels = extract_features(TEST_DIR)model = GaussianNB()print "Training model."#train modelmodel.fit(features_matrix, labels)predicted_labels = model.predict(test_feature_matrix)print "FINISHED classifying. accuracy score : "print accuracy_score(test_labels, predicted_labels)</code></pre><p><br></p><p>åœ¨ä¸‹é¢å¯«ä¸‹æ‚¨ç²å¾—çš„æº–ç¢ºåº¦å¾—åˆ†ï¼</p><h1 class=pgc-h-arrow-right><strong>ä»»å‹™çµ¦ä½ </strong></h1><p>Â· è©¦ç”¨å…¶ä»–æ¨¡å‹; å¤šé …å¼å’Œä¼¯åŠªåˆ©ï¼Œä¸¦æ¯”è¼ƒæ‚¨ç²å¾—çš„æº–ç¢ºæ€§å¾—åˆ†ã€‚</p><p>Â· å˜—è©¦å°‡æœ€å¸¸ç”¨è©çš„æ•¸é‡å¾3000æ›´æ”¹ç‚ºå¤§å’Œå°ï¼Œç„¶å¾Œç¹ªè£½ç²å¾—çš„ç²¾åº¦åœ–è¡¨ã€‚</p><p>è«‹åœ¨æ‚¨çš„æƒ³æ³•ä¸‹æ–¹ç•™è¨€ã€‚</p><h1 class=pgc-h-arrow-right><strong>çµè«–</strong></h1><p>æ¨¸ç´ è²è‘‰æ–¯è€ƒæ…®åŠŸèƒ½çš„ç¨ç«‹æ€§ã€‚ ä¾‹å¦‚ï¼Œå®ƒå‡è¨­ä¸€å€‹å–®è©/ç‰¹å¾µçš„å‡ºç¾èˆ‡å¦ä¸€å–®è©/ç‰¹å¾µç„¡é—œã€‚ ä½†æ˜¯åœ¨ç¾å¯¦ç”Ÿæ´»ä¸­å¯èƒ½ä¸¦éå¦‚æ­¤ï¼ˆGoodä¹‹å¾Œï¼Œmoringçš„ç™¼ç”Ÿç‡å¾ˆé«˜ï¼‰ã€‚ æˆ‘å¸Œæœ›ç¬¬ä¸€ç« ï¼ˆç†è«–å’Œé€™ä¸€ç« ï¼‰å°æ¨¸ç´ è²è‘‰æ–¯æœ‰è±å¯Œçš„è¦‹è§£ã€‚</p><p>åœ¨é€™è£¡ï¼Œæˆ‘å¾ˆæ¨‚æ„ç‚ºæ‚¨æä¾›å»ºè­°å’Œåé¥‹ã€‚ éš¨æ„è©•è«–æ‚¨çš„æƒ³æ³•ï¼Œåé¥‹æˆ–æƒ³æ³•ã€‚</p><p><br></p><div class=pgc-img><img alt=æ©Ÿå™¨å­¸ç¿’å…¥é–€ç¬¬1ç« ï¼šç›£ç£å­¸ç¿’å’Œæ¨¸ç´ è²è‘‰æ–¯åˆ†é¡-ç¬¬2éƒ¨åˆ†ï¼ˆç·¨ç¢¼ï¼‰ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/b0736470d40441459f3a66f3f969d6f9><p class=pgc-img-caption>The bugs!</p></div><p><br></p><p>(æœ¬æ–‡ç¿»è­¯è‡ªSavan Patelçš„æ–‡ç« ã€ŠChapter 1 : Supervised Learning and Naive Bayes Classification â€” Part 2 (Coding)ã€‹ï¼Œåƒè€ƒï¼šhttps://medium.com/machine-learning-101/chapter-1-supervised-learning-and-naive-bayes-classification-part-2-coding-5966f25f1475)</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>æ©Ÿå™¨</a></li><li><a>å­¸ç¿’</a></li><li><a>å…¥é–€</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/f71cd4af.html alt=æ©Ÿå™¨å­¸ç¿’å…¥é–€ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æ©Ÿï¼‰â€”ç·¨ç¢¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/28eb40e101e44cfb8b88aac745d012d6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f71cd4af.html title=æ©Ÿå™¨å­¸ç¿’å…¥é–€ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æ©Ÿï¼‰â€”ç·¨ç¢¼>æ©Ÿå™¨å­¸ç¿’å…¥é–€ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æ©Ÿï¼‰â€”ç·¨ç¢¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/c75c54fc.html alt=æ©Ÿå™¨å­¸ç¿’å…¥é–€ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æ©Ÿï¼‰â€”ç†è«– class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/db2b59aa64f64e189449ae9773356bed style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/c75c54fc.html title=æ©Ÿå™¨å­¸ç¿’å…¥é–€ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æ©Ÿï¼‰â€”ç†è«–>æ©Ÿå™¨å­¸ç¿’å…¥é–€ç¬¬2ç« ï¼šSVMï¼ˆæ”¯æŒå‘é‡æ©Ÿï¼‰â€”ç†è«–</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4b5cbda.html alt=æ©Ÿå™¨å­¸ç¿’å…¥é–€ï¼šåå·®å’Œæ–¹å·® class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e4d7bca8189b4528b0f564ee473d2a68 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4b5cbda.html title=æ©Ÿå™¨å­¸ç¿’å…¥é–€ï¼šåå·®å’Œæ–¹å·®>æ©Ÿå™¨å­¸ç¿’å…¥é–€ï¼šåå·®å’Œæ–¹å·®</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dc2af9c9.html alt=æ©Ÿå™¨å­¸ç¿’ç­†è¨˜(ä¸ƒ)â€”â€”åˆè­˜é‚è¼¯è¿´æ­¸ã€ä¸åŒæ–¹æ³•æ¨å°æ¢¯åº¦å…¬å¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/13adbab9c7f94c7fa81d49a98861b051 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dc2af9c9.html title=æ©Ÿå™¨å­¸ç¿’ç­†è¨˜(ä¸ƒ)â€”â€”åˆè­˜é‚è¼¯è¿´æ­¸ã€ä¸åŒæ–¹æ³•æ¨å°æ¢¯åº¦å…¬å¼>æ©Ÿå™¨å­¸ç¿’ç­†è¨˜(ä¸ƒ)â€”â€”åˆè­˜é‚è¼¯è¿´æ­¸ã€ä¸åŒæ–¹æ³•æ¨å°æ¢¯åº¦å…¬å¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e214e6d7.html alt=æ·±åº¦å­¸ç¿’/æ©Ÿå™¨å­¸ç¿’å…¥é–€æ•¸å­¸çŸ¥è­˜æ•´ç†ï¼ˆäºŒï¼‰æ¢¯åº¦èˆ‡å°æ•¸ï¼Œæ³°å‹’å±•é–‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1540372101455de0fb74774 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e214e6d7.html title=æ·±åº¦å­¸ç¿’/æ©Ÿå™¨å­¸ç¿’å…¥é–€æ•¸å­¸çŸ¥è­˜æ•´ç†ï¼ˆäºŒï¼‰æ¢¯åº¦èˆ‡å°æ•¸ï¼Œæ³°å‹’å±•é–‹>æ·±åº¦å­¸ç¿’/æ©Ÿå™¨å­¸ç¿’å…¥é–€æ•¸å­¸çŸ¥è­˜æ•´ç†ï¼ˆäºŒï¼‰æ¢¯åº¦èˆ‡å°æ•¸ï¼Œæ³°å‹’å±•é–‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f3767255.html alt=è¬›é€æ©Ÿå™¨å­¸ç¿’ä¸­çš„æ¢¯åº¦ä¸‹é™ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5c80301e53424671bc22755be2e4ee33 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f3767255.html title=è¬›é€æ©Ÿå™¨å­¸ç¿’ä¸­çš„æ¢¯åº¦ä¸‹é™>è¬›é€æ©Ÿå™¨å­¸ç¿’ä¸­çš„æ¢¯åº¦ä¸‹é™</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ce278cf4.html alt=æ©Ÿå™¨å­¸ç¿’æ™‚ä»£çš„å“ˆå¸Œç®—æ³•ï¼Œå°‡å¦‚ä½•æ›´é«˜æ•ˆåœ°ç´¢å¼•æ•¸æ“š class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1525617261534ad07c6455c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ce278cf4.html title=æ©Ÿå™¨å­¸ç¿’æ™‚ä»£çš„å“ˆå¸Œç®—æ³•ï¼Œå°‡å¦‚ä½•æ›´é«˜æ•ˆåœ°ç´¢å¼•æ•¸æ“š>æ©Ÿå™¨å­¸ç¿’æ™‚ä»£çš„å“ˆå¸Œç®—æ³•ï¼Œå°‡å¦‚ä½•æ›´é«˜æ•ˆåœ°ç´¢å¼•æ•¸æ“š</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/346037ff.html alt=æ·ºè«‡æ©Ÿå™¨å­¸ç¿’æ™‚ä»£çš„å“ˆå¸Œç®—æ³•ï¼ˆä¸€ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1525788510275af3193bcdc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/346037ff.html title=æ·ºè«‡æ©Ÿå™¨å­¸ç¿’æ™‚ä»£çš„å“ˆå¸Œç®—æ³•ï¼ˆä¸€ï¼‰>æ·ºè«‡æ©Ÿå™¨å­¸ç¿’æ™‚ä»£çš„å“ˆå¸Œç®—æ³•ï¼ˆä¸€ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2d4007c7.html alt=â€œé»‘å®¢â€å…¥é–€å­¸ç¿’ä¹‹â€œWindowsçµ„ç­–ç•¥â€ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ea21244d5f5c420ebef29650f3fafd1c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2d4007c7.html title=â€œé»‘å®¢â€å…¥é–€å­¸ç¿’ä¹‹â€œWindowsçµ„ç­–ç•¥â€>â€œé»‘å®¢â€å…¥é–€å­¸ç¿’ä¹‹â€œWindowsçµ„ç­–ç•¥â€</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a55cbbea.html alt=æ©Ÿå™¨å­¸ç¿’ç¸½çµï¼ˆåŸºç¤ï¼‰ï¼šåå·®å’Œæ–¹å·®ã€iidã€åˆ†ä½ˆ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a9681e5f716547e288303eae292c5b3e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a55cbbea.html title=æ©Ÿå™¨å­¸ç¿’ç¸½çµï¼ˆåŸºç¤ï¼‰ï¼šåå·®å’Œæ–¹å·®ã€iidã€åˆ†ä½ˆ>æ©Ÿå™¨å­¸ç¿’ç¸½çµï¼ˆåŸºç¤ï¼‰ï¼šåå·®å’Œæ–¹å·®ã€iidã€åˆ†ä½ˆ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c914526c.html alt=æ–°æ‰‹å…¥é–€PLCï¼ŒæŒæ¡å­¸ç¿’æ–¹æ³•æ˜¯é—œéµ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/15355275026304e8d787f10 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c914526c.html title=æ–°æ‰‹å…¥é–€PLCï¼ŒæŒæ¡å­¸ç¿’æ–¹æ³•æ˜¯é—œéµ>æ–°æ‰‹å…¥é–€PLCï¼ŒæŒæ¡å­¸ç¿’æ–¹æ³•æ˜¯é—œéµ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/41b2e34d.html alt=æ©Ÿå™¨å­¸ç¿’æ•¸å­¸ç¯‡â€”åŸºç¤æ•¸å­¸çŸ¥è­˜æ¸…å–® class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/59470000766ddb369113 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/41b2e34d.html title=æ©Ÿå™¨å­¸ç¿’æ•¸å­¸ç¯‡â€”åŸºç¤æ•¸å­¸çŸ¥è­˜æ¸…å–®>æ©Ÿå™¨å­¸ç¿’æ•¸å­¸ç¯‡â€”åŸºç¤æ•¸å­¸çŸ¥è­˜æ¸…å–®</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fee3515e.html alt=æ©Ÿå™¨å­¸ç¿’ä¹‹ç·šæ€§ä»£æ•¸é€ŸæŸ¥è¡¨ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/153089168574158dba8fa5a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fee3515e.html title=æ©Ÿå™¨å­¸ç¿’ä¹‹ç·šæ€§ä»£æ•¸é€ŸæŸ¥è¡¨>æ©Ÿå™¨å­¸ç¿’ä¹‹ç·šæ€§ä»£æ•¸é€ŸæŸ¥è¡¨</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6cc52e2b.html alt=ä½¿ç”¨æ©Ÿå™¨å­¸ç¿’çš„æ‰‹å¯«æ•¸å­—è­˜åˆ¥ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1f78eeb0e00a46b789e4bcb4ad07d97b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6cc52e2b.html title=ä½¿ç”¨æ©Ÿå™¨å­¸ç¿’çš„æ‰‹å¯«æ•¸å­—è­˜åˆ¥>ä½¿ç”¨æ©Ÿå™¨å­¸ç¿’çš„æ‰‹å¯«æ•¸å­—è­˜åˆ¥</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f575bcd3.html alt=å°ˆç‚ºæ©Ÿå™¨å­¸ç¿’æ‰“é€ çš„åŠå°é«”å™¨ä»¶ï¼šå¯é€²è¡Œä»»æ„é‚è¼¯é‹ç®— class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4654f6d6a6dd496ebbf6787bb43a7231 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f575bcd3.html title=å°ˆç‚ºæ©Ÿå™¨å­¸ç¿’æ‰“é€ çš„åŠå°é«”å™¨ä»¶ï¼šå¯é€²è¡Œä»»æ„é‚è¼¯é‹ç®—>å°ˆç‚ºæ©Ÿå™¨å­¸ç¿’æ‰“é€ çš„åŠå°é«”å™¨ä»¶ï¼šå¯é€²è¡Œä»»æ„é‚è¼¯é‹ç®—</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>