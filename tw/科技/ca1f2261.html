<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>經常用 HashMap？這 6 個問題回答下 | 极客快訊</title><meta property="og:title" content="經常用 HashMap？這 6 個問題回答下 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/RacA10eJBQSfiV"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ca1f2261.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ca1f2261.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/ca1f2261.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ca1f2261.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ca1f2261.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/ca1f2261.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/ca1f2261.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ca1f2261.html><meta property="article:published_time" content="2020-10-29T21:09:19+08:00"><meta property="article:modified_time" content="2020-10-29T21:09:19+08:00"><meta name=Keywords content><meta name=description content="經常用 HashMap？這 6 個問題回答下"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/ca1f2261.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>經常用 HashMap？這 6 個問題回答下</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><strong>一、HashMap的實現原理 ?</strong></p><p>此題可以組成如下連環炮來問</p><ul><li><p>你看過HashMap源碼嘛，知道原理嘛?</p></li><li><p>為什麼用數組+鏈表？</p></li><li><p>hash衝突你還知道哪些解決辦法？</p></li><li><p>我用LinkedL<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t代替數組結構可以麼?</p></li><li><p>既然是可以的,為什麼HashMap不用LinkedL<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t,而選用數組?</p></li></ul><p></p><h3><strong>1. 你看過HashMap源碼嘛，知道原理嘛?</strong></h3><p>針對這個問題，嗯，當然是必須看過HashMap源碼。至於原理，下面那張圖很清楚了:</p><img alt="經常用 HashMap？這 6 個問題回答下" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RacA10eJBQSfiV><p>HashMap採用Entry數組來存儲key-value對，每一個鍵值對組成了一個Entry實體，Entry類實際上是一個單向的鏈表結構，它具有Next指針，可以連接下一個Entry實體。</p><p>只是在JDK1.8中，鏈表長度大於8的時候，鏈表會轉成紅黑樹！</p><p></p><h3><strong>2. 為什麼用數組+鏈表？</strong></h3><p>數組是用來確定桶的位置，利用元素的key的hash值對數組長度取模得到.</p><p>鏈表是用來解決hash衝突問題，當出現hash值一樣的情形，就在數組上的對應位置形成一條鏈表。ps:這裡的hash值並不是指hashcode，而是將hashcode高低十六位異或過的。至於為什麼要這麼做，繼續往下看。</p><p></p><h3><strong>3.hash衝突你還知道哪些解決辦法？</strong></h3><p>比較出名的有四種(1)開放定址法(2)鏈地址法(3)再哈希法(4)公共溢出區域法</p><p>ps:大家有興趣拓展的，自己去<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-6">搜一下</i>就懂了，這個就不拓展了！</p><p></p><h3><strong>4.我用LinkedL<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t代替數組結構可以麼?</strong></h3><p>這裡我稍微說明一下，此題的意思是，源碼中是這樣的</p><pre><pre><code>Entry table = new Entry[capacity];</code></pre></pre><p>ps：Entry就是一個鏈表節點。</p><p>那我用下面這樣表示</p><pre><pre><code>L<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t&lt;Entry&gt; table = new LinkedL<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t&lt;Entry&gt;;</code></pre></pre><p>是否可行?</p><p>答案很明顯，必須是可以的。</p><p></p><h3><strong>5.既然是可以的,為什麼HashMap不用LinkedL<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t,而選用數組?</strong></h3><p>因為用數組效率最高！</p><p>在HashMap中，定位桶的位置是利用元素的key的哈希值對數組長度取模得到。此時，我們已得到桶的位置。顯然數組的查找效率比LinkedL<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t大。</p><p>那ArrayL<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t，底層也是數組，查找也快啊，為啥不用ArrayL<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t?</p><p>(煙哥寫到這裡的時候，不禁覺得自己真有想法，自己把自己問死了，還好我靈機一動想出了答案)</p><p>因為採用基本數組結構，擴容機制可以自己定義，HashMap中數組擴容剛好是2的次冪，在做取模運算的效率高。</p><p>而ArrayL<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t的擴容機制是1.5倍擴容，那ArrayL<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t為什麼是1.5倍擴容這就不在本文說明了。</p><p></p><h2><strong>二、HashMap在什麼條件下擴容?</strong></h2><p>此題可以組成如下連環炮來問</p><ul><li><p>HashMap在什麼條件下擴容?</p></li><li><p>為什麼擴容是2的n次冪?</p></li><li><p>為什麼為什麼要先高16位異或低16位再取模運算?</p></li></ul><p></p><h3><strong>1. HashMap在什麼條件下擴容?</strong></h3><p>如果bucket滿了(超過load factor*current capacity)，就要resize。</p><p>load factor為0.75，為了最大程度避免哈希衝突</p><p>current capacity為當前數組大小。</p><p></p><h3><strong>2. 為什麼擴容是2的次冪?</strong></h3><p>HashMap為了存取高效，要儘量較少碰撞，就是要儘量把數據分配均勻，每個鏈表長度大致相同，這個實現就在把數據存到哪個鏈表中的算法；這個算法實際就是取模，hash%length。</p><p>但是，大家都知道這種運算不如位移運算快。</p><p>因此，源碼中做了優化hash&(length-1)。</p><p>也就是說hash%length==hash&(length-1)</p><p>那為什麼是2的n次方呢？</p><p>因為2的n次方實際就是1後面n個0，2的n次方-1，實際就是n個1。</p><p>例如長度為8時候，3&(8-1)=3 2&(8-1)=2 ，不同位置上，不碰撞。</p><p>而長度為5的時候，3&(5-1)=0 2&(5-1)=0，都在0上，出現碰撞了。</p><p>所以，保證容積是2的n次方，是為了保證在做(length-1)的時候，每一位都能&1 ，也就是和1111……1111111進行與運算。</p><p></p><h3><strong>3.為什麼為什麼要先高16位異或低16位再取模運算?</strong></h3><p>我先晒一下，jdk1.8裡的hash方法。1.7的比較複雜，咱就不看了。</p><img alt="經常用 HashMap？這 6 個問題回答下" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RacA10yEXgBKoq><p>hashmap這麼做，只是為了降低hash衝突的機率。</p><p>打個比方，當我們的length為16的時候，哈希碼(字符串“abcabcabcabcabc”的key對應的哈希碼)對(16-1)與操作，對於多個key生成的hashCode，只要哈希碼的後4位為0，不論不論高位怎麼變化，最終的結果均為0。</p><p>如下圖所示</p><img alt="經常用 HashMap？這 6 個問題回答下" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RacA11DDIB36at><p>而<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">加上</i>高16位異或低16位的“擾動函數”後，結果如下</p><img alt="經常用 HashMap？這 6 個問題回答下" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RacA11T2UV6xJP><p>可以看到: 擾動函數優化前：1954974080 % 16 = 1954974080 & (16 - 1) = 0 擾動函數優化後：1955003654 % 16 = 1955003654 & (16 - 1) = 6 很顯然，減少了碰撞的機率。</p><p></p><h2><strong>三、講講hashmap的get/put的過程?</strong></h2><p>此題可以組成如下連環炮來問</p><ul><li><p>知道hashmap中put元素的過程是什麼樣麼?</p></li><li><p>知道hashmap中get元素的過程是什麼樣麼？</p></li><li><p>你還知道哪些hash算法？</p></li><li><p>說說String中hashcode的實現?(此題很多大廠問過)</p></li></ul><p></p><h3><strong>1. 知道hashmap中put元素的過程是什麼樣麼?</strong></h3><p>對key的hashCode做hash運算，計算index;</p><p>如果沒碰撞直接放到bucket裡；</p><p>如果碰撞了，以鏈表的形式存在buckets後；</p><p>如果碰撞導致鏈表過長(大於等於TREEIFY_THRESHOLD)，就把鏈表轉換成紅黑樹(JDK1.8中的改動)；</p><p>如果節點已經存在就替換old value(保證key的唯一性)</p><p>如果bucket滿了(超過load factor*current capacity)，就要resize。</p><p></p><h3><strong>2. 知道hashmap中get元素的過程是什麼樣麼?</strong></h3><p>對key的hashCode做hash運算，計算index;</p><p>如果在bucket裡的第一個節點裡直接命中，則直接返回；</p><p>如果有衝突，則通過key.equals(k)去查找對應的Entry;</p><ul><li><p>若為樹，則在樹中通過key.equals(k)查找，O(logn)；</p><br></li><li><p>若為鏈表，則在鏈表中通過key.equals(k)查找，O(n)。</p></li></ul><p></p><h3><strong>3. 你還知道哪些hash算法？</strong></h3><p>先說一下hash算法幹嘛的，Hash函數是指把一個大範圍映射到一個小範圍。把大範圍映射到一個小範圍的目的往往是為了節省空間，使得數據容易保存。</p><p>比較出名的有MurmurHash、MD4、MD5等等</p><p></p><h3><strong>4. 說說String中hashcode的實現?(此題頻率很高)</strong></h3><pre><pre><code>public int hashCode {</code><code> int h = hash;</code><code> if (h == 0 &amp;&amp; value.length &gt; 0) {</code><code> char val = value;</code><code> for (int i = 0; i &lt; value.length; i++) { // 歡迎<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-5">關注</i><i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-5">微信</i><i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">公眾號</i> Web項目聚集地 </code><code> h = 31 * h + val[i];</code><code> }</code><code> hash = h;</code><code> }</code><code> return h;</code><code>}</code></pre></pre><p>String類中的hashCode計算方法還是比較簡單的，就是以31為權，每一位為字符的ASCII值進行運算，用自然溢出來等效取模。</p><p>哈希計算公式可以計為<strong>s[0]31^(n-1) + s[1]31^(n-2) + … + s[n-1]</strong></p><p>那為什麼以31為質數呢?</p><p>主要是因為31是一個奇質數，所以31*i=32*i-i=(i&lt;&lt;5)-i，這種位移與減法<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-3">結合</i>的計算相比一般的運算快很多。</p><p></p><h2><strong>四、為什麼hashmap的在鏈表元素數量超過8時改為紅黑樹?</strong></h2><p>此題可以組成如下連環炮來問</p><ul><li><p>知道jdk1.8中hashmap改了啥麼?</p></li><li><p>為什麼在解決hash衝突的時候，不直接用紅黑樹?而選擇先用鏈表，再轉紅黑樹?</p></li><li><p>我不用紅黑樹，用二叉查找樹可以麼?</p></li><li><p>那為什麼閥值是8呢?</p></li><li><p>當鏈表轉為紅黑樹後，什麼時候退化為鏈表?</p></li></ul><p></p><h3><strong>1. 知道jdk1.8中hashmap改了啥麼?</strong></h3><ul><li><p>由<strong>數組+鏈表</strong>的結構改為<strong>數組+鏈表+紅黑樹</strong>。</p></li><li><p>優化了高位運算的hash算法：h^(h>>>16)</p></li><li><p>擴容後，元素要麼是在原位置，要麼是在原位置再移動2次冪的位置，且鏈表順序不變。</p></li></ul><p>最後一條是重點，因為最後一條的變動，hashmap在1.8中，不會在出現死循環問題。</p><p></p><h3><strong>2. 為什麼在解決hash衝突的時候，不直接用紅黑樹?而選擇先用鏈表，再轉紅黑樹?</strong></h3><p>因為紅黑樹需要進行左旋，右旋，變色這些操作來保持平衡，而單鏈表不需要。</p><p>當元素小於8個當時候，此時做查詢操作，鏈表結構已經能保證查詢性能。當元素大於8個的時候，此時需要紅黑樹來加快查詢速度，但是新增節點的效率變慢了。</p><p>因此，如果一開始就用紅黑樹結構，元素太少，新增效率又比較慢，無疑這是浪費性能的。</p><p></p><h3><strong>3. 我不用紅黑樹，用二叉查找樹可以麼?</strong></h3><p>可以。但是二叉查找樹在特殊情況下會變成一條線性結構（這就跟原來使用鏈表結構一樣了，造成很深的問題），遍歷查找會非常慢。</p><p></p><h3><strong>4. 那為什麼閥值是8呢?</strong></h3><p>不知道，等jdk作者來回答。</p><p>這道題，網上能找到的答案都是扯淡。</p><p>我隨便貼一個牛客網的答案，如下圖所示</p><img alt="經常用 HashMap？這 6 個問題回答下" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/RacA11jG1xJsLC><p>看出bug沒？交點是6.<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-2">64</i>？交點分明是4，好麼。</p><p>log4=2，4/2=2。</p><p>jdk作者選擇8，一定經過了嚴格的運算，覺得在長度為8的時候，與其保證鏈表結構的查找開銷，不如轉換為紅黑樹，改為維持其平衡開銷。</p><p></p><h3><strong>5. 當鏈表轉為紅黑樹後，什麼時候退化為鏈表?</strong></h3><p>為6的時候退轉為鏈表。中間有個差值7可以防止鏈表和樹之間頻繁的轉換。假設一下，如果設計成鏈表個數超過8則鏈表轉換成樹結構，鏈表個數小於8則樹結構轉換成鏈表，如果一個HashMap不停的插入、刪除元素，鏈表個數在8左右徘徊，就會頻繁的發生樹轉鏈表、鏈表轉樹，效率會很低。</p><p></p><h2><strong>五、HashMap的併發問題?</strong></h2><p>此題可以組成如下連環炮來問</p><ul><li><p>HashMap在併發編程環境下有什麼問題啊?</p></li><li><p>在jdk1.8中還有這些問題麼?</p></li><li><p>你一般怎麼解決這些問題的？</p></li></ul><p>HashMap在併發編程環境下有什麼問題啊?</p><ul><li><p>(1)多線程擴容，引起的死循環問題</p></li><li><p>(2)多線程put的時候可能導致元素丟失</p></li><li><p>(3)put非元素後get出來的卻是</p></li></ul><p>在jdk1.8中還有這些問題麼?</p><p>在jdk1.8中，死循環問題已經解決。其他兩個問題還是存在。</p><p>你一般怎麼解決這些問題的？</p><p>比如ConcurrentHashmap，Hashtable等線程安全等集合類。</p><p></p><h2><strong>六、你一般用什麼作為HashMap的key?</strong></h2><p>此題可以組成如下連環炮來問</p><ul><li><p>健可以為值麼?</p></li><li><p>你一般用什麼作為HashMap的key?</p></li><li><p>我用可變類當HashMap的key有什麼問題?</p></li><li><p>如果讓你實現一個自定義的class作為HashMap的key該如何實現？</p></li></ul><p></p><h3><strong>1. 健可以為值麼?</strong></h3><p>必須可以，key為的時候，hash算法最後的值以0來計算，也就是放在數組的第一個位置。</p><img alt="經常用 HashMap？這 6 個問題回答下" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/RacA1RJ1ZMnqOx><p></p><h3><strong>2. 你一般用什麼作為HashMap的key?</strong></h3><p>一般用Integer、String這種不可變類當HashMap當key，而且String最為常用。</p><p>(1)因為字符串是不可變的，所以在它創建的時候hashcode就被緩存了，不需要重新計算。</p><p>這就使得字符串很適合作為Map中的鍵，字符串的處理速度要快過其它的鍵對象。</p><p>這就是HashMap中的鍵往往都使用字符串。</p><p>(2)因為獲取對象的時候要用到equals和hashCode方法，那麼鍵對象正確的重寫這兩個方法是非常重要的,這些類已經很規範的覆寫了hashCode以及equals方法。</p><p></p><h3><strong>3. 我用可變類當HashMap的key有什麼問題?</strong></h3><p>hashcode可能發生改變，導致put進去的值，無法get出，如下所示</p><pre><pre><code>HashMap&lt;L<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t&lt;String&gt;, Object&gt; changeMap = new HashMap&lt;&gt;;</code><code>L<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t&lt;String&gt; l<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t = new ArrayL<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t&lt;&gt;;</code><code>l<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t.add("hello");</code><code>Object objectValue = new Object;</code><code>changeMap.put(l<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t, objectValue);</code><code>System.out.println(changeMap.get(l<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t));</code><code>l<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t.add("hello world");//hashcode發生了改變 </code><code>System.out.println(changeMap.get(l<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>t));</code></pre></pre><p>輸出值如下</p><pre><pre><code>java.lang.Object@74a14482</code></pre></pre><p></p><h3><strong>4.如果讓你實現一個自定義的class作為HashMap的key該如何實現？</strong></h3><p>此題考察兩個知識點</p><ul><li><p>重寫hashcode和equals方法注意什麼?</p></li><li><p>如何設計一個不變類</p></li></ul><p>針對問題一，記住下面四個原則即可</p><p>(1)兩個對象相等，hashcode一定相等</p><p>(2)兩個對象不等，hashcode不一定不等</p><p>(3)hashcode相等，兩個對象不一定相等</p><p>(4)hashcode不等，兩個對象一定不等</p><p>針對問題二，記住如何寫一個不可變類</p><p>(1)類添加final修飾符，保證類不被繼承。</p><p>如果類可以被繼承會破壞類的不可變性機制，只要繼承類覆蓋父類的方法並且繼承類可以改變成員變量值，那麼一旦子類以父類的形式出現時，不能保證當前類是否可變。</p><p>(2)保證所有成員變量必須私有，並且<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">加上</i>final修飾</p><p>通過這種方式保證成員變量不可改變。但只做到這一步還不夠，因為如果是對象成員變量有可能再外部改變其值。所以第4點彌補這個不足。</p><p>(3)不提供改變成員變量的方法，包括setter</p><p>避免通過其他接口改變成員變量的值，破壞不可變特性。</p><p>(4)通過構造器初始化所有成員，進行深拷貝(deep copy)</p><p>如果構造器傳入的對象直接賦值給成員變量，還是可以通過對傳入對象的修改進而導致改變內部變量的值。例如：</p><pre><pre><code>public final class ImmutableDemo { </code><code> private final int myArray; </code><code> public ImmutableDemo(int[] array) { </code><code> th<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>.myArray = array; // wrong。 歡迎<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-5">關注</i><i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-5">微信</i><i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-4">公眾號</i> Web項目聚集地 </code><code> } </code><code>}</code></pre></pre><p>這種方式不能保證不可變性，myArray和array指向同一塊內存地址，用戶可以在ImmutableDemo之外通過修改array對象的值來改變myArray內部的值。</p><p>為了保證內部的值不被修改，可以採用深度copy來創建一個新內存保存傳入的值。正確做法：</p><pre><pre><code>public final class MyImmutableDemo { </code><code> private final int myArray; </code><code> public MyImmutableDemo(int[] array) { </code><code> th<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-1">is</i>.myArray = array.clone;</code><code> } </code><code>}</code></pre></pre><p>(5) 在getter方法中，不要直接返回對象本身，而是克隆對象，並返回對象的拷貝</p><p>這種做法也是防止對象外洩，防止通過getter獲得內部可變成員對象後對成員變量直接操作，導致成員變量發生改變。</p><p>本文章由Web項目聚集地(<i class="chrome-extension-mutihighlight chrome-extension-mutihighlight-style-5">id：</i>web_resource)排版整理，轉載文章請聯繫原作者，使用排版請著名出處。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>HashMap</a></li><li><a>問題</a></li><li><a>常用</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/c3d4fb6a.html alt=常用航測相機彙總 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/5df1892b-62d4-4bd5-bd7c-95b2344b201e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c3d4fb6a.html title=常用航測相機彙總>常用航測相機彙總</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2f87337a.html alt=收不到交警便民通知？可能是這裡出了問題 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/bdf88511c83f431c9f75609d9e44d585 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2f87337a.html title=收不到交警便民通知？可能是這裡出了問題>收不到交警便民通知？可能是這裡出了問題</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8db1a012.html alt=問題408:在變壓器送電前後怎樣檢測差動保護裝置？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e7912ea051664f678d2616da1c042a37 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8db1a012.html title=問題408:在變壓器送電前後怎樣檢測差動保護裝置？>問題408:在變壓器送電前後怎樣檢測差動保護裝置？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/df81fac3.html alt=5種常用的石膏固定技術，你掌握了嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/dca8c2f6b7b248c48d855972263d8230 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/df81fac3.html title=5種常用的石膏固定技術，你掌握了嗎？>5種常用的石膏固定技術，你掌握了嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a6d0ded0.html alt=常用帶電作業工具的使用與保管 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/ba454cb5-1d3f-4139-ae89-2d1f9b6ce6ce style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a6d0ded0.html title=常用帶電作業工具的使用與保管>常用帶電作業工具的使用與保管</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/84e317ac.html alt=檢測虛設問題，應當採取強有力的措施加以解決 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/115bad769be144f19346317e77eed4b3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/84e317ac.html title=檢測虛設問題，應當採取強有力的措施加以解決>檢測虛設問題，應當採取強有力的措施加以解決</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dfdb3278.html alt=南通中海問題多多？！竟遭市住建局通報批評 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RZ6gaqQHcJXxWV style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dfdb3278.html title=南通中海問題多多？！竟遭市住建局通報批評>南通中海問題多多？！竟遭市住建局通報批評</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3afc3600.html alt="歡居改造家 一篇看懂，砌牆需要注意的問題有哪些，再也不怕被坑" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/fe51a7bcc26445fa95824ca74c172f17 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3afc3600.html title="歡居改造家 一篇看懂，砌牆需要注意的問題有哪些，再也不怕被坑">歡居改造家 一篇看懂，砌牆需要注意的問題有哪些，再也不怕被坑</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/97268c50.html alt=蛋糕製作中的十一個常見問題及原因 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/2658ec69-8ea5-490e-a30a-08c8ed990c73 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/97268c50.html title=蛋糕製作中的十一個常見問題及原因>蛋糕製作中的十一個常見問題及原因</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7245dc43.html alt=別說我沒提醒你！螺栓連接有問題，趕緊測一下扭矩！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/35dce4fcbaa64306ab138cc84d150d4e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7245dc43.html title=別說我沒提醒你！螺栓連接有問題，趕緊測一下扭矩！>別說我沒提醒你！螺栓連接有問題，趕緊測一下扭矩！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/56faa63d.html alt=航空發動機軸承問題解析：慎重選用軸承遊隙和​防止軸承打滑 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/fa005c54189c4c61bf01b5c6f8afe285 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/56faa63d.html title=航空發動機軸承問題解析：慎重選用軸承遊隙和​防止軸承打滑>航空發動機軸承問題解析：慎重選用軸承遊隙和​防止軸承打滑</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7deecdbb.html alt=定製文件櫃需要注意哪些問題 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/931a82db62a14175b712856354243b2e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7deecdbb.html title=定製文件櫃需要注意哪些問題>定製文件櫃需要注意哪些問題</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/25ca0d4f.html alt=有些暗傷，破解與和解，從來都不是問題 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b5e2b6f988c141fdbd859d5f5e943129 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/25ca0d4f.html title=有些暗傷，破解與和解，從來都不是問題>有些暗傷，破解與和解，從來都不是問題</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2cb59e3c.html alt=瞭解HashMap底層設計思想，教你手寫一個迷你版的HashMap class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d7714f65761648ee9b73a6bd5cca2fcb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2cb59e3c.html title=瞭解HashMap底層設計思想，教你手寫一個迷你版的HashMap>瞭解HashMap底層設計思想，教你手寫一個迷你版的HashMap</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3a5fae7e.html alt=HashMap源碼分析 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/4852d5083ec340be9f50ded10636e4b0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3a5fae7e.html title=HashMap源碼分析>HashMap源碼分析</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>