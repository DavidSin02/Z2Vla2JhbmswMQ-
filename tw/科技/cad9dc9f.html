<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>每天跑這麼多自動化用例，你能發現BUG嗎？ | 极客快訊</title><meta property="og:title" content="每天跑這麼多自動化用例，你能發現BUG嗎？ - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/942c5f7624bf4d0791805e6d8b88ecf8"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cad9dc9f.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cad9dc9f.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cad9dc9f.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cad9dc9f.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cad9dc9f.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cad9dc9f.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cad9dc9f.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cad9dc9f.html><meta property="article:published_time" content="2020-11-14T21:01:26+08:00"><meta property="article:modified_time" content="2020-11-14T21:01:26+08:00"><meta name=Keywords content><meta name=description content="每天跑這麼多自動化用例，你能發現BUG嗎？"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/cad9dc9f.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>每天跑這麼多自動化用例，你能發現BUG嗎？</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>什麼是測試用例的有效性？</h1><p>我們的測試用例有兩個比較關鍵的部分：</p><p><strong>1）調用被測代碼：</strong>例如下面的RuleService.getLastRuleByClientId(ClientId)</p><p><strong>2）進行結果Check：</strong>例如下面的AssertEqual(OrderId,"ABCD1234")</p><div class=pgc-img><img alt=每天跑這麼多自動化用例，你能發現BUG嗎？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/942c5f7624bf4d0791805e6d8b88ecf8><p class=pgc-img-caption></p></div><p>我們希望一組測試用例不僅能夠“觸發被測代碼的各種分支”，還能夠做好結果校驗。</p><ul><li>當業務代碼出現問題的時候，測試用例可以發現這個問題，我們就認為這一組測試用例是有效的。</li><li>當業務代碼出現問題的時候，測試用例沒能發現這個問題，我們就認為這一組測試用例是無效的。</li></ul><p>我們對測試用例有效性的理論建模是：</p><p><strong>>> 測試有效性 = 被發現的問題數 / 出現問題的總數</strong></p><p>為什麼要評估測試用例的有效性？</p><div class=pgc-img><img alt=每天跑這麼多自動化用例，你能發現BUG嗎？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/74b5dd47389c487b949ce640e4c39a66><p class=pgc-img-caption></p></div><p>測試用例有效性評估的方法？基於故障覆盤的模式成本太高，我們希望能夠主動創造問題來評估測試用例的有效性。</p><p>我們找到了一種衡量“測試有效性”的方法，變異測試(mutation testing)</p><div class=pgc-img><img alt=每天跑這麼多自動化用例，你能發現BUG嗎？ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/505e113de83d473a9e733cbcbd618739><p class=pgc-img-caption></p></div><p>變異測試的例子</p><div class=pgc-img><img alt=每天跑這麼多自動化用例，你能發現BUG嗎？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2e7742ea53934a659160afc81147a0ae><p class=pgc-img-caption></p></div><p>通過變異測試的方式：讓注入變異後的業務代碼作為“測試用例”，來測試“測試代碼”。</p><p>我們實現了多種規則，可以主動的注入下面這些變異：</p><div class=pgc-img><img alt=每天跑這麼多自動化用例，你能發現BUG嗎？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3ef9dbb6a63e45b8ad3cea425f05a758><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>如何優雅的評估測試有效性？</h1><p>為了全自動的進行測試有效性評估，我們做了一個變異機器人，其主要運作是：</p><ul><li>往被測代碼中寫入一個BUG（即：變異）</li><li>執行測試</li><li>把測試結果和無變異時的測試結果做比對，判斷是否有新的用例失敗</li><li>重複1-3若干次，每次注入一個不同的Bug</li><li>統計該系統的“測試有效性”</li></ul><div class=pgc-img><img alt=每天跑這麼多自動化用例，你能發現BUG嗎？ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/28ef15f09b3349f081b1d4d5085d7625><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right>變異機器人的優點：</h1><p><strong>防錯上線：</strong>變異是單獨拉代碼分支，且該代碼分支永遠不會上線，不影響生產。</p><p><strong>全自動：</strong>只需要給出系統代碼的git地址，即可進行評估，得到改進報告。</p><p><strong>高效：</strong>數小時即可完成一個系統的測試有效性評估。</p><p><strong>擴展性：</strong>該模式可以支持JAVA以及JAVA以外的多種語系。</p><p><strong>適用性：</strong>該方法不僅適用於單元測試，還適用於其他自動化測試，例如接口測試、功能測試、集成測試。</p><h1 class=pgc-h-arrow-right>變異機器人的使用門檻：</h1><p><strong>測試成功率：</strong>只會選擇通過率100%的測試用例，所對應的業務代碼做變異注入。</p><p><strong>測試覆蓋率：</strong>只會注入被測試代碼覆蓋的業務代碼，測試覆蓋率越高，評估越準確。</p><h1 class=pgc-h-arrow-right>高配版變異機器人</h1><p>我們正在打造的高配版變異機器人擁有**三大核心競爭力**</p><p><strong>分鐘級的系統評估效率</strong></p><p>為了保證評估的準確性，100個變異將會執行全量用例100遍，每次執行時間長是一大痛點。</p><p>高配版變異機器人給出的解法：</p><p><strong>並行注入：</strong>基於代碼覆蓋率，識別UT之間的代碼覆蓋依賴關係，將獨立的變異合併到一次自動化測試中。</p><p><strong>熱部署：</strong>基於字節碼做更新，減少變異和部署的過程。</p><p><strong>精準測試：</strong>基於UT代碼覆蓋信息，只運行和本次變異相關的UT（該方法不僅適用於UT，還適用於其他自動化測試，例如接口測試、功能測試、集成測試）</p><p><strong>學習型注入經驗庫</strong></p><p>為了避免“殺蟲劑”效應，注入規則需要不斷的完善。</p><p>高配版變異機器人給出的解法：故障學習，基於故障學習算法，不斷學習歷史的代碼BUG，並轉化為注入經驗。可學習型經驗庫目前覆蓋螞蟻金服的代碼庫，明年會覆蓋開源社區。</p><p><strong>兼容不穩定環境</strong></p><p>集成測試環境會存在一定的不穩定，難以判斷用例失敗是因為“發現了變異”還是“環境出了問題”，導致測試有效性評估存在誤差。</p><p>高配版變異機器人給出的解法：</p><p><strong>高頻跑：</strong>同樣的變異跑10次，對多次結果進行統計分析，減少環境問題引起的偶發性問題。</p><p><strong>環境問題自動定位：</strong>接入附屬的日誌服務，它會基於用例日誌/系統錯誤日誌構建的異常場景，自動學習“因環境問題導致的用例失敗”，準確區分出用例是否發現變異。</p><h1 class=pgc-h-arrow-right>落地效果如何？</h1><p>我們在螞蟻金服的一個部門進行了實驗，得出了這樣的數據：</p><div class=pgc-img><img alt=每天跑這麼多自動化用例，你能發現BUG嗎？ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/31e920bf431647bf8a3543b934cccee2><p class=pgc-img-caption></p></div><p>換言之，幾個系統的測試有效性為：系統A 72%，系統B 56%，系統C 70%</p><p><strong>測試有效性(%) = 1 - 未發現注入數 / 注入數</strong></p><h1 class=pgc-h-arrow-right>更多的測試有效性度量手段</h1><p>基於代碼注入的測試有效性度量，只是其中的一種方法，我們日常會用到的方法有這麼幾種：</p><p><strong>代碼注入：</strong>向代碼注入變異，看測試用例是否能發現該問題</p><p><strong>內存注入：</strong>修改API接口的返回內容，看測試用例是否能發現該問題</p><p><strong>靜態掃描：</strong>掃描測試代碼裡是否做了Assert等判斷，看Assert場景與被測代碼分支的關係</p><p>... 還有更多其他的度量手段</p><h1 class=pgc-h-arrow-right>Meet the testcase again</h1><p>測試有效性可以作為基石，驅動很多事情向好發展：</p><ul><li>讓測試用例變得更能發現問題。</li><li>讓無效用例可被識別、清理。</li><li>創造一個讓技術人員真正思考如何寫好TestCase的質量文化。</li><li>測試左移與敏捷的前置條件。</li><li>......</li></ul><p>寫到最後，想起了同事給我講的一個有趣的人生經歷：</p><p>“大二期間在一家出版社編輯部實習，工作內容就是校對文稿中的各種類型的錯誤；編輯部考核校對質量的辦法是，人為的事先在文稿中加入各種類型的錯誤，然後根據你的錯誤發現率來衡量，並計算實習工資。”</p><p>“你幹得咋樣？”</p><p>“我學習了他們的規則，寫了個程序來查錯，拿到了第一個滿分”</p><p>“厲害了...”</p><p>“第二個月就不行了，他們不搞錯別字了，搞了一堆語法、語義、中心思想的錯誤... 我就專心幹活兒了”</p><p>“...”</p><p><strong>殊途同歸，其致一也。</strong></p><p><br></p><p>文章來源：AlibabaTechQA</p><p>開發者社區整理</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>這麼</a></li><li><a>自動化</a></li><li><a>用例</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/75f4c0d3.html alt=運輸和物流行業人工智能和自動化的用例 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/6a43de780ef2427aa8877ebfadef613c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/75f4c0d3.html title=運輸和物流行業人工智能和自動化的用例>運輸和物流行業人工智能和自動化的用例</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7bd06eba.html alt=超震撼的歐美公鐵兩用車，沒想到有這麼多用途 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2a8d17dd47ec44dcb46bb714e4fc4b3f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7bd06eba.html title=超震撼的歐美公鐵兩用車，沒想到有這麼多用途>超震撼的歐美公鐵兩用車，沒想到有這麼多用途</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a73cf80a.html alt="自動化彈性伸縮如何支持百萬級核心錯峰混部 | 架構沙龍回顧" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/61d58d713ab649708f7796af3bc5f21b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a73cf80a.html title="自動化彈性伸縮如何支持百萬級核心錯峰混部 | 架構沙龍回顧">自動化彈性伸縮如何支持百萬級核心錯峰混部 | 架構沙龍回顧</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9e2d615f.html alt=流浪了這麼多年，我最後還是死了…… class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/SGEhDSs4csHp0N style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9e2d615f.html title=流浪了這麼多年，我最後還是死了……>流浪了這麼多年，我最後還是死了……</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/998130e4.html alt=聽了這麼久的拳擊，知道這些嗎 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/434b00023ddd03d0223a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/998130e4.html title=聽了這麼久的拳擊，知道這些嗎>聽了這麼久的拳擊，知道這些嗎</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/10196651.html alt=高層住宅這麼密，冬天能有日照嗎？國家規定日照最少要多長時間？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/6079ee8f-c9f6-45a6-befe-4d89e9f9ecdc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/10196651.html title=高層住宅這麼密，冬天能有日照嗎？國家規定日照最少要多長時間？>高層住宅這麼密，冬天能有日照嗎？國家規定日照最少要多長時間？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bd7a84b7.html alt=鑑別被追尾車就是這麼簡單！這4個方法你都瞭解嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a51a16723af8485ab69705c547ea4fd8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bd7a84b7.html title=鑑別被追尾車就是這麼簡單！這4個方法你都瞭解嗎？>鑑別被追尾車就是這麼簡單！這4個方法你都瞭解嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a2071e8e.html alt=磚混結構施工方案，自建房就該這麼幹 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5f8e058930504f6187918f035fcdae38 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a2071e8e.html title=磚混結構施工方案，自建房就該這麼幹>磚混結構施工方案，自建房就該這麼幹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/edc7ccb7.html alt=九齒釘耙擁有這麼多強大功能，八戒為何從不展示？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/c7de69f4b84443989183f933a2ecfe66 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/edc7ccb7.html title=九齒釘耙擁有這麼多強大功能，八戒為何從不展示？>九齒釘耙擁有這麼多強大功能，八戒為何從不展示？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1afbb1e9.html alt=全世界最短高速公路，耗資3.4萬，長度竟這麼短，司機：限速嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d93d0777370447dfa68b6f0cfabbce6d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1afbb1e9.html title=全世界最短高速公路，耗資3.4萬，長度竟這麼短，司機：限速嗎？>全世界最短高速公路，耗資3.4萬，長度竟這麼短，司機：限速嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a1ff65af.html alt=SUMIF函數還可以這麼用？Excel多列求和技巧分享 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/365914e7fd834f4db9c1708941a54153 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a1ff65af.html title=SUMIF函數還可以這麼用？Excel多列求和技巧分享>SUMIF函數還可以這麼用？Excel多列求和技巧分享</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/164e69c4.html alt=定了！蕭山的村級班子要這麼選！可一票否決、推進“一肩挑”、後備有年齡要求…… class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/R69kBo0BbZoONc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/164e69c4.html title=定了！蕭山的村級班子要這麼選！可一票否決、推進“一肩挑”、後備有年齡要求……>定了！蕭山的村級班子要這麼選！可一票否決、推進“一肩挑”、後備有年齡要求……</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/db7606e8.html alt=中美高中差異分析：差距咋就這麼大吶？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/096326f612d14693b6bc8f2234bcddeb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/db7606e8.html title=中美高中差異分析：差距咋就這麼大吶？>中美高中差異分析：差距咋就這麼大吶？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/434fd028.html alt=後悔沒有早知道！原來牆面基底這麼重要！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/15260010501682dc3c1e7df style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/434fd028.html title=後悔沒有早知道！原來牆面基底這麼重要！>後悔沒有早知道！原來牆面基底這麼重要！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e6372c2e.html alt=數控機床自動化上下料機械手的好處 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e6372c2e.html title=數控機床自動化上下料機械手的好處>數控機床自動化上下料機械手的好處</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>