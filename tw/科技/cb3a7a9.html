<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Kali Linux 祕籍之BASH+Ping輕鬆搞定跨三層網絡自動IP存活檢測 | 极客快訊</title><meta property="og:title" content="Kali Linux 祕籍之BASH+Ping輕鬆搞定跨三層網絡自動IP存活檢測 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/15279909101092ffdd61501"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cb3a7a9.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cb3a7a9.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cb3a7a9.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cb3a7a9.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cb3a7a9.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cb3a7a9.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cb3a7a9.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cb3a7a9.html><meta property="article:published_time" content="2020-10-29T20:54:13+08:00"><meta property="article:modified_time" content="2020-10-29T20:54:13+08:00"><meta name=Keywords content><meta name=description content="Kali Linux 祕籍之BASH+Ping輕鬆搞定跨三層網絡自動IP存活檢測"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/cb3a7a9.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Kali Linux 祕籍之BASH+Ping輕鬆搞定跨三層網絡自動IP存活檢測</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><div class=pgc-img><img alt="Kali Linux 祕籍之BASH+Ping輕鬆搞定跨三層網絡自動IP存活檢測" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15279909101092ffdd61501><p class=pgc-img-caption></p></div><p><strong>本祕籍簡介：</strong></p><p>第三層的發現可能是網絡管理員和技術人員中最常用的工具。 第三層的發現使用著名的ICMP ping 來識別活動主機。 此祕籍演示瞭如何使用ping 工具在遠程主機上執行第三層發現。</p><p><strong>準備</strong></p><p>使用ping 執行第三層發現不需要實驗環境，因為Internet 上的許多系統都將回復ICMP 回顯請求。 但是，強烈建議你只在您自己的實驗環境中執行任何類型的網絡掃描，除非你完全熟悉您受到任何管理機構施加的法律法規。 如果你希望在實驗環境中執行此技術，你需要至少有一個響應ICMP 請求的系統。</p><p><strong>操作步驟</strong></p><p>大多數在IT 行業工作的人都相當熟悉ping 工具。 要使用ping 確定主機是否處於活動狀態，你只需要向命令傳遞參數來定義要測試的IP 地址：</p><blockquote><p>root@kali:~# ping 172.16.155.1</p><p>PING 172.16.155.1 (172.16.155.1) 56(84) bytes of data.</p><p>64 bytes from 172.16.155.1: icmp_seq=1 ttl=64 time=0.209 ms</p><p>64 bytes from 172.16.155.1: icmp_seq=2 ttl=64 time=0.230 ms</p><p>64 bytes from 172.16.155.1: icmp_seq=3 ttl=64 time=0.351 ms</p><p>^C</p><p>--- 172.16.155.1 ping statistics ---</p><p>3 packets transmitted, 3 received, 0% packet loss, time 2055ms</p><p>rtt min/avg/max/mdev = 0.209/0.263/0.351/0.063 ms</p></blockquote><p>發出此命令時，ICMP 回顯請求將直接發送到提供的IP 地址。 為了接收對此ICMP回顯請求的回覆，必須滿足幾個條件。 這些條件如下：測試的IP 地址必須分配給系統系統必須處於活動狀態並在線必須存在從掃描系統到目標IP 的可用路由系統必須配置為響應ICMP 流量掃描系統和配置為丟棄ICMP 流量的目標IP 之間沒有基於主機或網絡防火牆你可以看到， 有很多變量成為ICMP 發現的成功因素。 正是由於這個原因，ICMP可能有點不可靠，但與ARP 不同，它是一個可路由的協議，可用於發現局域網外的主機。 請注意，在前面的示例中，在ping 命令顯示的輸出中出現^ C 。 這表示使用了轉義序列（具體來說，Ctrl + C ）來停止進程。 與Windows 不同，默認情況下，集成到Linux 操作系統的ping 命令會無限ping 目標主機。 但是，-c 選項可用於指定要發送的ICMP 請求數。 使用此選項，一旦達到超時或每個發送的數據包的回覆已接收，過程將正常結束。 看看下面的命令：</p><blockquote><p>root@kali:~# ping 172.16.155.1 -c 2</p><p>PING 172.16.155.1 (172.16.155.1) 56(84) bytes of data.</p><p>64 bytes from 172.16.155.1: icmp_seq=1 ttl=64 time=0.342 ms</p><p>64 bytes from 172.16.155.1: icmp_seq=2 ttl=64 time=0.147 ms</p><p>--- 172.16.155.1 ping statistics ---</p><p>2 packets transmitted, 2 received, 0% packet loss, time 1009ms</p><p>rtt min/avg/max/mdev = 0.147/0.244/0.342/0.098 ms</p></blockquote><p>與ARPing 相同的方式可以在bash 腳本中使用，通過並行地循環遍歷多個IP，ping 可以與bash 腳本結合使用，來在多個主機上並行執行第三層發現。 為了編寫腳本，我們需要確定與成功和失敗的ping 請求相關的各種響應。 為此，我們應該首先ping 一個我們知道它活動並響應ICMP 的主機，然後使用ping 請求跟蹤一個無響應的地址。 以下命令演示了這一點：</p><blockquote><p>root@kali:~# ping 172.16.155.1 -c 1</p><p>PING 172.16.155.1 (172.16.155.1) 56(84) bytes of data.</p><p>64 bytes from 172.16.155.1: icmp_seq=1 ttl=64 time=0.403 ms</p><p>--- 172.16.155.1 ping statistics ---</p><p>1 packets transmitted, 1 received, 0% packet loss, time 0ms</p><p>rtt min/avg/max/mdev = 0.403/0.403/0.403/0.000 ms</p><p>root@kali:~# ping 172.16.155.100 -c 1</p><p>PING 172.16.155.100 (172.16.155.100) 56(84) bytes of data.</p><p>From 172.16.155.150 icmp_seq=1 Destination Host Unreachable</p><p>--- 172.16.155.100 ping statistics ---</p><p>1 packets transmitted, 0 received, +1 errors, 100% packet loss, time 0ms</p></blockquote><p>與ARPing 請求一樣，來自唯一字符串的字節只存在在與活動IP 地址相關的輸出中，並且也位於包含此地址的行上。 使用同樣的方式，我們可以使用grep 和cut 的組合,從任何成功的ping 請求中提取IP 地址：</p><blockquote><p>root@kali:~# ping 172.16.155.1 -c 1 |grep 'bytes from'</p><p>64 bytes from 172.16.155.1: icmp_seq=1 ttl=64 time=0.248 ms</p><p>root@kali:~# ping 172.16.155.1 -c 1 |grep 'bytes from'|cut -d ' ' -f 4</p><p>172.16.155.1:</p><p>root@kali:~# ping 172.16.155.1 -c 1 |grep 'bytes from'|cut -d ' ' -f 4|cut -d ':' -f 1</p><p>172.16.155.1</p><p>root@kali:~#</p></blockquote><p>通過在包含一系列目標IP 地址的循環中使用此任務序列，我們可以快速識別響應ICMP 回顯請求的活動主機。 輸出是一個簡單的的活動IP 地址列表。 使用此技術的示例腳本如下所示：</p><blockquote><p>#!/bin/bash</p><p>if [ "$#" -ne 1 ]; then</p><p>echo "Usage - ./ping_sweep.sh [/24 network address]"</p><p>echo "Example - ./ping_sweep.sh 172.16.155.0"</p><p>echo "Example will perform an ICMP ping sweep of the 172.16.155.0/24 network"</p><p>exit</p><p>fi</p><p>prefix=$(echo $1 | cut -d '.' -f 1-3)</p><p>for addr in $(seq 1 254); do</p><p>ping -c 1 $prefix.$addr | grep "bytes from" | cut -d ' ' -f 4 |cut -d ":" -f 1 &</p><p>done</p></blockquote><p>在提供的bash腳本中，第一行定義了bash 解釋器的位置。 接下來的代碼塊執行測試來確定是否提供了預期的一個參數。 這通過評估提供的參數的數量是否不等於1來確定。 如果未提供預期參數，則輸出腳本的用法，並且退出腳本。 用法輸出表明，腳本接受/ 24 網絡地址作為參數。 下一行代碼從提供的網絡地址中提取網絡前綴。 例如，如果提供的網絡地址是192.168.11.0 ，則前綴變量將被賦值為192.168.11 。 然後使用for 循環遍歷最後一個字節的值，來在本地/ 24 網絡中生成每個可能的IP 地址。 對於每個可能的IP 地址，執行單個ping 命令。 然後通過管道傳輸每個請求的響應，然後使用grep 來提取帶有短語bytes 的行。 這隻會提取包含活動主機的IP 地址的行。 最後，使用一系列cut 函數從該輸出中提取IP 地址。 請注意，在for 循環任務的末尾使用& 符號，而不是分號。 該符號能夠並行執行任務，而不是順序執行。 這極大地減少了掃描IP 範圍所需的時間。 然後，可以使用句號和斜槓，並帶上是可執行腳本的名稱來執行腳本：</p><blockquote><p>root@kali:~# chmod +x ./ping.sh #給腳本文件增加執行權限</p><p>root@kali:~# ls -al ./ping.sh</p><p>-rwxr-xr-x 1 root root 382 May 29 06:27 ./ping.sh</p><p>root@kali:~# ./ping.sh</p><p>Usage - ./ping_sweep.sh [/24 network address]</p><p>Example - ./ping_sweep.sh 172.16.155.0</p><p>Example will perform an ICMP ping sweep of the 172.16.155.0/24 network</p><p>root@kali:~# ./ping.sh 172.16.155.0</p><p>172.16.155.2</p><p>172.16.155.1</p><p>172.16.155.150</p><p>root@kali:~#</p></blockquote><p>當在沒有提供任何參數的情況下執行時，腳本會返回用法。 但是，當使用網絡地址值執行時，任務序列開始執行，並返回活動IP 地址的列表。 如前面的腳本中所討論的那樣，此腳本的輸出也可以重定向到文本文件，來供將來使用。 這可以使用尖括號，後跟輸出文件的名稱來實現。</p><blockquote><p>root@kali:~# ./ping.sh 172.16.155.0 > output.txt</p><p>root@kali:~# ls output.txt</p><p>output.txt</p><p>root@kali:~# cat output.txt</p><p>172.16.155.2</p><p>172.16.155.1</p><p>172.16.155.150</p></blockquote><p>在提供的示例中，ls 命令用於確認輸出文件已創建。 通過將文件名作為參數傳遞給cat 命令，可以查看此輸出文件的內容。</p><p><strong>工作原理</strong></p><p>Ping 是IT 行業中眾所周知的工具，其現有功能能用於識別活動主機。 然而，它的目的是為了發現單個主機是否存活，而不是作為掃描工具。 這個祕籍中的bash 腳本基本上與在/ 24 CIDR範圍中對每個可能的IP 地址使用ping 相同。 但是，我們不需要手動執行這種繁瑣的任務，bash 允許我們通過循環傳遞任務序列來快速，輕鬆地執行此任務。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Kali</a></li><li><a>Linux</a></li><li><a>BASH</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/9c23185.html alt=Kali Linux進階篇：Shadon網絡空間搜索引擎使用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/243103baabda46f1be0f4976d4c45c03 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9c23185.html title=Kali Linux進階篇：Shadon網絡空間搜索引擎使用>Kali Linux進階篇：Shadon網絡空間搜索引擎使用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/524f85c.html alt=Kali Linux進階篇：鍾馗之眼網絡空間搜索引擎使用教程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/333368714f984dfdbaa0d43e619a6ac6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/524f85c.html title=Kali Linux進階篇：鍾馗之眼網絡空間搜索引擎使用教程>Kali Linux進階篇：鍾馗之眼網絡空間搜索引擎使用教程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1bb05aa.html alt="Kali Linux滲透工具【八】:系統命令注入漏洞工具 – Commix使用" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/6289884d157749ecbd5560917c270c9b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1bb05aa.html title="Kali Linux滲透工具【八】:系統命令注入漏洞工具 – Commix使用">Kali Linux滲透工具【八】:系統命令注入漏洞工具 – Commix使用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d6b5f7f.html alt="Kali Linux滲透工具（十一）Java自動化SQL注入工具jSQL使用技巧" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5ff61936776a4c9bbb4082a97175ddfd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d6b5f7f.html title="Kali Linux滲透工具（十一）Java自動化SQL注入工具jSQL使用技巧">Kali Linux滲透工具（十一）Java自動化SQL注入工具jSQL使用技巧</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/286d1d05.html alt=Linux怎麼樣編譯c程序文件(編譯最新版ffmpeg為例) class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/67e5890abdc3408c9e6e28c61ce6c847 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/286d1d05.html title=Linux怎麼樣編譯c程序文件(編譯最新版ffmpeg為例)>Linux怎麼樣編譯c程序文件(編譯最新版ffmpeg為例)</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7e4b1039.html alt=Linux用戶、用戶組與文檔屬性 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/54f39d7a23d64846b3fee43d438f13bb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7e4b1039.html title=Linux用戶、用戶組與文檔屬性>Linux用戶、用戶組與文檔屬性</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bcacd8fd.html alt=Linux系統——用戶、用戶組、權限和文件屬性 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bcacd8fd.html title=Linux系統——用戶、用戶組、權限和文件屬性>Linux系統——用戶、用戶組、權限和文件屬性</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dad48786.html alt=Linux併發服務器模型一、多進程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dad48786.html title=Linux併發服務器模型一、多進程>Linux併發服務器模型一、多進程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e1360dd4.html alt=「Linux」高併發服務器模型（多進程和多線程實例模型） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/170e1596c32348f39d6ace1f327e45d5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e1360dd4.html title=「Linux」高併發服務器模型（多進程和多線程實例模型）>「Linux」高併發服務器模型（多進程和多線程實例模型）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2806cf4d.html alt=嵌入式Linux編程——程序員小白不懂的進程、信號量、併發、互斥 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6fea5f2744614de3884ab26fa09e5a40 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2806cf4d.html title=嵌入式Linux編程——程序員小白不懂的進程、信號量、併發、互斥>嵌入式Linux編程——程序員小白不懂的進程、信號量、併發、互斥</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d3d9f3d8.html alt=搞懂Linux內存管理，僅此一篇 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0ae3e7cee0234c4cb9cdef0039d2c4d0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d3d9f3d8.html title=搞懂Linux內存管理，僅此一篇>搞懂Linux內存管理，僅此一篇</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/838d476c.html alt=Linux內核的整體架構 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a7aaf296a7c14809b8c0ce535a02205d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/838d476c.html title=Linux內核的整體架構>Linux內核的整體架構</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7102c077.html alt=什麼Linux，Linux內核及Linux操作系統，整體架構介紹 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/af09f220163b49399261735b49fe1790 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7102c077.html title=什麼Linux，Linux內核及Linux操作系統，整體架構介紹>什麼Linux，Linux內核及Linux操作系統，整體架構介紹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7e66a0e7.html alt=Linux網絡編程——UDP廣播詳解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a2667182b3d34b2e98e8503a00af90fd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7e66a0e7.html title=Linux網絡編程——UDP廣播詳解>Linux網絡編程——UDP廣播詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6b48b90b.html alt=Linux系統常用命令大全 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6b48b90b.html title=Linux系統常用命令大全>Linux系統常用命令大全</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>