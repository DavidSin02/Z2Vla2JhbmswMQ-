<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>第二講，Ceph存儲架構 | 极客快訊</title><meta property="og:title" content="第二講，Ceph存儲架構 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/0a51454c0139426fa94bc557f185de3e"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cb695db6.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cb695db6.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cb695db6.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cb695db6.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cb695db6.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cb695db6.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cb695db6.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cb695db6.html><meta property="article:published_time" content="2020-11-14T21:03:23+08:00"><meta property="article:modified_time" content="2020-11-14T21:03:23+08:00"><meta name=Keywords content><meta name=description content="第二講，Ceph存儲架構"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/cb695db6.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>第二講，Ceph存儲架構</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>大家好！在上一節給大家講了關於Ceph存儲系統的簡單介紹。也簡單介紹了Raid方式的一些瓶頸，我們首先比較一下Raid的瓶頸與Ceph如何解決它的瓶頸問題後，再深入瞭解其工作原理，大家可以在簡單的對比之間瞭解Ceph為什麼稱為“未來的存儲”。</p><div class=pgc-img><img alt=第二講，Ceph存儲架構 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/0a51454c0139426fa94bc557f185de3e><p class=pgc-img-caption></p></div><h1>容量比較</h1><p>Raid：一臺服務器做Raid的最大容量就是取決於一開始做Raid單塊硬盤的容量×（盤位-1），例如一共有8個盤位的服務器都滿上硬盤，每塊4TB大小，其中一塊是校驗盤，不做熱備盤的情況下，最大容量就是4*7=28TB</p><p>Ceph：它不是以單臺服務器計算容量，它是一個集群，它的容量是多臺服務器的硬盤總和，而且支持橫向和縱向擴展，盤位插滿不要緊，加服務器就可以了，也就是隻要你有足夠的資金和地方是可以無限擴展容量的。</p><h1>硬件要求</h1><p>Raid：要求每塊硬盤容量要相等，轉速要相等，最好是同一個品牌和型號的磁盤，這個對於企業級的用戶來說可是很要命，一般服務器都是用10年，甚至20年都有可能，沒什麼事情誰也不想動服務器，畢竟服務器重要的不是硬件，而是裡面的業務系統和數據，數據丟失可是嚴重信息安全事故。所以一開始做Raid就要考慮這一點，基本上都是滿上硬盤，如果資金充足的企業會選擇滿上當時最大容量的磁盤，因為隨著信息技術的快速發展誰也不知道未來還能不能買回一模一樣的磁盤，也就是說一開始就決定了該服務器的最大容量，而且隨著時間的發展，風險就越大。注意：同一個Raid使用不同類型的磁盤將可能給你帶來致命的數據安全問題。</p><p>Ceph：服務器磁盤首先不需要做Raid，也就是說不需要相同的硬盤，每增加一個硬盤可增加一個OSD，OSD是Ceph存儲對象的地方，每個OSD沒有要求一定要相同，也就是說10年前最大容量的磁盤是1TB，現在有8TB的，我可以插一塊8TB的進去，那總的容量就增加8TB，當然轉速最好相同，不然會影響I/O操作。</p><h1>單點故障</h1><p>Raid：Raid5可允許一塊磁盤損壞，Raid6可允許兩塊磁盤損壞。Raid是以磁盤級別來做保護的。</p><p>Ceph：以集群形式出現，至少3臺主機做一個集群，以副本形式存儲數據，只要不是兩臺主機同時損壞不能用都不會影響集群裡面的業務系統和數據。</p><h1>高可用性</h1><p>Raid：服務器的網絡中斷會讓企業立馬訪問不了這臺服務器的業務系統，服務器其他硬件故障導致無法正常啟動也會使得業務中斷，對於企業來說，不管大中小型的企業都不希望在工作過程中被中斷業務系統，而且往往服務器出故障僅僅是重啟也要等不少時間，更別說是修復或更換硬件。</p><p>Ceph：以集群和副本形式出現，只要業務系統的副本≥2，那麼任意一臺服務器出故障也不會影響到業務系統正常使用，所謂的故障包括網絡和硬件。在故障服務器上的虛擬機會自動切換到正常服務器上繼續運行，注意：切換過程需要看系統是否支持不中斷切換，小編測試過幾款系統在切換過程虛擬機需要有一次重啟動作，因為涉及到內存，CPU是否也做分佈式計算問題，就不僅僅是存儲上的功能問題。但是虛擬機的重啟總比整臺服務器重啟時間要快多了，至少有足夠時間給你維修故障服務器。</p><p>以上四點對於企業數據的安全性和業務系統的可靠性是非常重要的。</p><p>下面簡單講述Ceph的架構</p><h1>Ceph存儲架構</h1><div class=pgc-img><img alt=第二講，Ceph存儲架構 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/18527c36532646f3961e6f9b6798f4dd><p class=pgc-img-caption></p></div><p>Ceph存儲集群由幾個不同的軟件守護進程組成，每個守護進程負責Ceph的一個獨特功能並將值添加到相應的組件中。每個守護進程是彼此獨立的。</p><p>Ceph中的一切都以對象的形式存儲，而RADOS就負責存儲這些對象，而不考慮它們的數據類型。RADOS層確保數據一致性和可靠性。對於數據一致性，它執行數據複製、故障檢測和恢復，還包括數據在集群節點間的遷移和再平衡。</p><p>一旦應用程序訪問Ceph集群執行寫操作，數據將會以對象的形式存儲在Ceph對象存儲設備OSD中，這是Ceph集群中存儲實際用戶數據並響應客戶端讀操作請求的唯一組件。通過，一個OSD守護進程與集群的一個物理磁盤綁定。</p><p><strong>Ceph Monitor（MON）組件</strong></p><p>通過一系列的map來跟蹤整個集群的健康狀態，map的組件有：OSD，MON，PG，和CRUSH。所有節點都想monitor節點報告狀態，monitor本身不存放實際數據。</p><p><strong>librados庫</strong></p><p>是一種用來簡化訪問RADOS的方法，它目前支持PHP，Rudy，java，python，C和C++語言。它提供了Ceph存儲集群的一個本地接口RADOS，並且是其他服務的基礎，以及為CephFS提供POSIX接口。librados API支持直接訪問RADOS，使得開發者能夠創建自己的接口來訪問Ceph集群存儲。</p><p><strong>Ceph塊設備</strong></p><p>原來叫RADOS塊設備（RBD），它對外提供塊存儲，它可以被映射、格式化進而像其他磁盤一樣掛載到服務器。</p><p><strong>Ceph對象網關</strong></p><p>RADOS網關（RGW），它提供一個兼容Amazon S3和OpenStack對象存儲API（Swift）的restful API接口。RGW還支持多租戶和OpenStack的Keystone身份驗證服務。</p><p><strong>Ceph元數據服務器（MDS）</strong></p><p>負責跟蹤文件層次結構並存儲只供CephFS使用的元數據。Ceph塊設備和RADOS網關不需要元數據。</p><p><strong>Ceph文件系統（CephFS）</strong></p><p>提供一個任意大小且兼容POSIX的分佈式文件系統。CephFS依賴Ceph MDS來跟蹤文件層次結構，即元數據。</p><p><strong>Ceph RADOS</strong></p><p>RADOS是Ceph存儲系統的核心，也稱為Ceph存儲集群。Ceph所有優秀特性都是由RADOS提供的，包括分佈式對象存儲、高可用性、高可靠性、沒有單點故障、自我修復以及自我管理等。Ceph的數據訪問方法（如RBD、CephFS、RADOSGW和librados）的所有操作都是在RADOS層之上構建的。</p><p>當Ceph集群接收到來自客戶端的寫請求時，CRUSH算法首先計算出存儲位置，以此決定應該將數據寫入什麼地方。然後這些信息傳遞到RADOS層進行進一步處理。最後，這些對象存儲在OSD中。</p><p><strong>Ceph OSD</strong></p><p>Ceph的OSD是Ceph集群中最重要的一個基礎組件，它負責將實際的數據以對象形式存儲在每一個集群節點的物理磁盤中。Ceph集群包含多個OSD，對於任何讀寫操作，客戶端首先向monitor請求集群的map，然後，它們就可以無須monitor的干預直接與OSD進行I/O操作。</p><p>Ceph的核心特性都始於OSD，根據配置的副本數，Ceph通過跨集群節點複製每個對象多次來提供可靠性，同時提供高可用性和容錯性。OSD上的每個對象都有一個主副本和幾個輔副本，輔副本分散在其他OSD上。在磁盤發生故障的時候，Ceph的OSD守護進程會自動與其他OSD通信，從而開始執行恢復操作。</p><p>關於Ceph存儲架構先介紹到這裡，感謝大家閱讀，後面將繼續為大家介紹Ceph存儲系統的其他特性和功能，敬請關注下一期。謝謝！</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Ceph</a></li><li><a>存儲架構</a></li><li><a>第二</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/0e65b3f7.html alt=分佈式存儲Ceph可靠性的量化分析 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/c4bbbd3f6cdc4f2ab77a1580836190f5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0e65b3f7.html title=分佈式存儲Ceph可靠性的量化分析>分佈式存儲Ceph可靠性的量化分析</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ef109a93.html alt=全球存儲簡史（第二版） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/c0e3f412509e4c6e89654aa0ae37de46 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ef109a93.html title=全球存儲簡史（第二版）>全球存儲簡史（第二版）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6762d368.html alt=Ceph：一個可擴展，高性能分佈式文件系統 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ff0a5bf835654f29a633e5299f24d8b7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6762d368.html title=Ceph：一個可擴展，高性能分佈式文件系統>Ceph：一個可擴展，高性能分佈式文件系統</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/aa3aa4fe.html alt=直播第二彈：ProGRP！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/6fa20006c08aac091532 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/aa3aa4fe.html title=直播第二彈：ProGRP！>直播第二彈：ProGRP！</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/049d288d.html alt=第二週山商新聞 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/49778ce137bc4b03bf5daa1dfe3ff938 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/049d288d.html title=第二週山商新聞>第二週山商新聞</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/871d4447.html alt=揭陽第二高峰 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/fc18e2d4f7864d5e8115f117cc051425 style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/871d4447.html title=揭陽第二高峰>揭陽第二高峰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d3a5c53.html alt=Ceph、GlusterFS等五大常見存儲系統PK class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/29470d16c1eb43bea1e2ebadbb0fe318 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d3a5c53.html title=Ceph、GlusterFS等五大常見存儲系統PK>Ceph、GlusterFS等五大常見存儲系統PK</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4cce349.html alt=千萬級即時通訊消息推送和存儲架構的實現 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/348af1a261e94fdd9445141aa3d97bb7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4cce349.html title=千萬級即時通訊消息推送和存儲架構的實現>千萬級即時通訊消息推送和存儲架構的實現</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a07fb3d.html alt=汽輪機第二講——汽輪機的停機 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/7078c61f270a497e9d7b74c8235aee0c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a07fb3d.html title=汽輪機第二講——汽輪機的停機>汽輪機第二講——汽輪機的停機</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0c30b9a.html alt=力學第二講：力的描述 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/f3066947a8fb4a4baa02e436298e2f22 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0c30b9a.html title=力學第二講：力的描述>力學第二講：力的描述</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/ca35a5f.html alt=第二節歷史背景 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/ca35a5f.html title=第二節歷史背景>第二節歷史背景</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1fdc63d.html alt=「存儲架構」塊存儲、文件存儲和對象存儲(第1節) class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/68861b5601a142ee8946c8deaa5ea9e2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1fdc63d.html title=「存儲架構」塊存儲、文件存儲和對象存儲(第1節)>「存儲架構」塊存儲、文件存儲和對象存儲(第1節)</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/caeeece.html alt=學會第二層思考 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p1.pstatp.com/large/pgc-image/0a668a8ad5f14779a8d7b902dc68c48d style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/caeeece.html title=學會第二層思考>學會第二層思考</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/d9aa5d2.html alt=投資中一定要知道的第二層思維 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p1.pstatp.com/large/pgc-image/1525c4173df74142aae6799e0620b632 style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/d9aa5d2.html title=投資中一定要知道的第二層思維>投資中一定要知道的第二層思維</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/1d47b7f.html alt=永生的不同境界——第二層 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p3.pstatp.com/large/pgc-image/d8fca6ccf21740119aa3aad4cd6e4554 style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/1d47b7f.html title=永生的不同境界——第二層>永生的不同境界——第二層</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>