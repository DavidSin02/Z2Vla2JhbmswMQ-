<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>生成對抗網絡（GAN）的數學原理全解 | 极客快訊</title><meta property="og:title" content="生成對抗網絡（GAN）的數學原理全解 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/683f230be4bf47319263888f821593ee"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cd1b5612.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cd1b5612.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cd1b5612.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cd1b5612.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cd1b5612.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cd1b5612.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cd1b5612.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cd1b5612.html><meta property="article:published_time" content="2020-11-14T21:04:42+08:00"><meta property="article:modified_time" content="2020-11-14T21:04:42+08:00"><meta name=Keywords content><meta name=description content="生成對抗網絡（GAN）的數學原理全解"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/cd1b5612.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>生成對抗網絡（GAN）的數學原理全解</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>原文地址:https://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247512178&idx=1&sn=be91d6291e36c5b2fa5dd1b98e9f3a21</p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">作者｜孫裕道</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">學校｜北京郵電大學博士生</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">研究方向｜GAN圖像生成、情緒對抗樣本生成</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/683f230be4bf47319263888f821593ee><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">論文標題：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">A Mathematical Introduction to Generative Adversarial Nets</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">論文鏈接：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">https://arxiv.org/abs/2009.00169</span></p><p><br></p><h1 class=pgc-h-arrow-right><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">引言</span></h1><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">Goodfellow 大神的開創性工作 GAN 自 2014 年誕生以來，GAN 就受到了極大的關注，並且這種關注導致了 GANs 的新思想、新技術和新應用的爆炸式增長。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">GAN 的原論文中的證明會有一些不嚴謹的地方，並且在算法中為了訓練效率更高，也有很多簡化，其實這也是這個領域的一個常見現象，在北大的深度學習的數學原理的暑期課上，老師就提到過 </span><strong><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">深度學習中數學嚴謹證明佔 6 成</span></strong><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313"> 。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">言外之意就是該領域的證明過程並沒有純數學的那麼嚴謹，當從計算機科學工程師角度去推導證明的</span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">時</span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">候，往往會有跟實際相悖的前提假設，但是從該假設推導出來的結論卻是與實驗結果相符或者該結論會對解決實際問題中有一定的指導意義。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">該作者是一個數學底蘊很強的 AI 研究者，該論文的目的是試圖從數學的角度對 GANs 進行概述，是一篇不可多得好有關 GAN 數學原理的理論性文章，論文中涉及到大量的數學原理和很多讓人眼花繚亂的數學符號，可以把它當成一個 GAN 的理論手冊，對哪一塊感興趣就可以認真研讀一番 。</span></p><h1 class=pgc-h-arrow-right><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">GAN背景介紹</span></h1><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">榮獲圖靈獎品有深度學習三劍客之稱的 Yann LeCun 稱曾表示“GAN 的提出是最近 10 年在深度學習中最有趣的想法”。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">下圖表示這 2014 到 2018 年以來有關 GAN 的論文的每個月發表數量，可以看出在 2014 年提出後到 2016 年相關的論文是比較少的，但是從 2016 年，或者是 2017 年到今年這兩年的時間，相關的論文是真的呈現井噴式增長。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">GAN 的應用十分廣泛，它的應用包括圖像合成、圖像編輯、風格遷移、圖像超分辨率以及圖像轉換，數據增強等。</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/fc82106a36d94d019b82272853670d50><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">在這篇論文中，作者將嘗試從一個更數學的角度為初學者介紹 GAN，要完全理解 GANs，還必須研究其算法和應用，但理解數學原理是理解 GANs 的關鍵的第一步，有了它，GANs 的其他變種將更容易掌握。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">GAN 的目標是解決以下問題：假設有一組對象數據集，例如，一組貓的圖像，或者手寫的漢字，或者梵高的繪畫等等，GAN 可以通過噪聲生成相似的對象，原理是神經網絡通過使用訓練數據集對網絡參數進行適當調整，並且深度神經網絡可以用來近似任何函數。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">對於 GAN 判別器函數 D 和生成函數 G 建模為神經網絡，其中具體 GAN 的模型如下圖所示，GAN 網絡實際上包含了 2 個網絡，一個是生成網絡 G 用於生成假樣本,另一個是判別網絡 D 用於判別樣本的真假，並且為了引入對抗損失，通過對抗訓練的方式讓生成器能夠生成高質量的圖片。</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/013db93073b44f5889defa1c3dd56d9d><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">具體的，對抗學習可以通過判別函數和生成函數之間的目標函數的極大極小值來實現。生成器 G 將來自於分佈隨機樣本轉化為生成樣本。判別器試圖將它們與來自分佈的訓練真實樣本區分開來，而 G 試圖使生成的樣本在分佈上與訓練樣本相似。</span></p><h1 class=pgc-h-arrow-right><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">GAN的數學公式</span></h1><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">GAN的對抗博弈可以通過判別函數和生成函數之間的目標函數的極大極小值來進行數學化的表示。生成器將隨機樣本分佈轉化為生成樣本。判別器試圖將它們與來自分佈的訓練樣本區分開來，而試圖使生成的樣本在分佈上與訓練樣本相似。對抗的目標損失函數如下所示</span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">為</span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">其中公式中，表示關於下標中指定分佈的期望值。GAN 解決的極小極大值的描述如下所示：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">直觀上，對於給定的生成器，優化判別器以區分生成的樣本，其原理是嘗試將高值分配給來自分佈的真實樣本，並將低值分配給生成的樣本。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">相反，對於給定的鑑別器，優化，使得生成的樣本將試圖“愚弄”判別器以分配高值。 設 ，其分佈為 ，可以用 和 重寫 為：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/182ae5ed70ba4787bdc6ca2d6d1777d2><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">將上面的極大極小問題變為如下公式：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">假設具有密度，具有密度函數（需要注意的是隻有當時才會發生）。綜上所述最終可以寫成：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/08a7753a1f464de38ed85bf3ef9ef508><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">可以觀察到，在某些的的約束下，上述值與等效。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">論文中有大量公式和證明，會看的讓人很頭大，而且不同的命題和不同的定理交錯出現，為了讀者能夠減少閱讀障礙，我從中挑選了一些自認為比較重要的定理和命題，並且給它們重新進行了排序整理。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">命題1： 給定在上的概率分佈和，其中它們的概率密度函數為和，則有如下：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ef12f9ce70084b30b6ecbee79971d5c0><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">其中，，的取值範圍為（sup表示上確界）。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">定理1： 設是上的概率密度函數。對於密度函數為和的概率分佈，其極大極小值問題可以描述為：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">對所有，可以解</span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">得</span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">and。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">定理 1 說極大極小問題的解就是 Ian Goodfellow 在 2014 年那篇論文中推導出的 GAN 的優化解。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">定理2： 設為上給定的概率分佈。對於概率分佈和函數，則有：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">其中，and對於來說幾乎處處存在。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">命題2： 如果在每個訓練週期中，允許鑑別器達到其最佳給定，然後更新，根據最小化準則有：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6ae6eb7623ac44eea8c908c51ee77a22><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">其中，分佈是收斂於分佈。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">從純數學的角度來看，這個命題 2 並不嚴謹。然而，它為解決 GAN 極小極大問題提供了一個實用的框架。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">綜上命題和定理可以將其歸納為如下的 GAN 算法框架，為了表達清晰，重新整理了一下該算法框架。</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/4a281c7d518e4fc1b107f549ea77c231><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">f-散度和f-GAN</span></h1><h1 class=pgc-h-arrow-right><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">4.1 f-散度</span></h1><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">GAN 的核心本質是通過對抗訓練將隨機噪聲的分佈拉近到真實的數據分佈，那麼就需要一個度量概率分佈的指標—散度。 我們熟知的散度有 KL 散度公式如下（KL 散度有一個缺點就是距離不對稱性，所以說它不是傳統真正意義上的距離度量方法）。</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f570528e479e4111881b9d0427800eae><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">和 JS 散度公式如下（JS 散度是改進了 KL 散度的距離不對稱性）：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/dad141adb2af4bf8a8870b31bae4e8c3><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">但是其實能將所有我們熟知</span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">散度</span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">歸結到一個大類那就是 f- 散度，具體的定義如下所示：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">定義1： 設和是上的兩個概率密度函數。則和的 f- 散度定義為：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/79a15eca2b21459399b3d6010c28b221><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">其中，如果時，會有。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">需要搞清楚一點事的 f- 散度依據所選函數不一樣，距離的不對稱也不一樣。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">命題3： 設是域上的嚴格凸函數，使得。假設（相當於）或，其中。則有，當且僅當。</span></p><h1 class=pgc-h-arrow-right><strong><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">4.2 凸函數和凸共軛</span></strong></h1><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">凸函數 的凸共軛也被稱為的 Fenchel 變換或 Fenchel-Legendre 變換，它是著名的 Legendre 變換的推廣。設是定義在區間上的凸函數，則其凸共軛定義為：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/fe2b701f548e4587baa169d441bc9d46><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">引理1： 假設是嚴格凸的，且在其域上連續可微，其中與。則有：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dd9b1089394547f3ab2fa48de95854fa><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">命題4： 設是上的凸函數，其值域在內。那麼是凸的並且是下半連續的。此外，如果是下半連續的，則滿足 Fenchel 對偶。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">下表列出了一些常見凸函數的凸對偶，如下表所示：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/8c465df99e724ae8aa60ee0b89900fc7><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><strong><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">4.3 用凸對偶估計f-散度</span></strong></h1><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">為了估計樣本的 f- 散度可以使用 f 的凸對偶，具體的推導公式如下所示：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0f3015674677481f8df7d2c8e11bb6fa><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">其中是任何 Borel 函數，這樣就得到了所有的 Borel 函數如下所示：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/91fd4c1ee53046e8b112ec3a4af74f4c><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">命題5： 設是嚴格凸的且在上連續可微的，設，是上的 Borel 概率測度，使得，則有：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">其中是一個優化器。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">定理3： 設是凸的，使得的域對某些包含，設是上的 Borel 概率測度，則有：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">其中對於所有的 Borel 函數有。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">定理4： 設是下半連續凸函數，使得的域具有。設為上的 Borel 概率測度，使得，其中和 。那麼：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/72dc5282c17e4b28bbf0d57c05aed051><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">其中對於所有的 Borel 函數有。</span></p><h1 class=pgc-h-arrow-right><strong><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">4.4 f-GAN和VDM</span></strong></h1><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">用 f- </span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">散度</span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">來表示 GAN 的推廣。對於給定的概率分佈，f-GAN 的目標是最小化相對於概率分佈的 f- 散度。在樣本空間中，f-GAN 解決了下面的極大極小問題：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">可以將如上的優化問題稱為變分散度最小化（VDM）。注意 VDM 看起來類似於 GAN 中的極大極小值問題，其中 Borel 函數被稱為評判函數。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">定理5： 設是一個下半連續嚴格凸函數，使得的域。進一步假定在其域上是連續可微的，且並且。設 上的 Borel 概率測度，則有如下公式：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">其中對於所有的 Borel 函數有。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">綜上所述，下面為 f-GAN 的算法流程框架。</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5e186b137f9a47a3ab40b2bb0dfbcdfc><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><strong><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">4.4.1 Example1:</span></strong></h1><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">當函數，這裡的f-散度就是為我們熟知的 KL 散度。則它的共軛函數為，其中，其相應的目標函數為：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">其中，忽略掉常數 +1 的常數項，並且，然後會有我們最原始的那種 GAN 的形式：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5db1ba8227ea43a0a095ae550908037b><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><strong><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">4.4.2 Example2:</span></strong></h1><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">這就是詹森-香農散度，該函數的共軛函數為，域。相應的 f-GAN 的目標函數為：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a5753839577e43d385d765f44b44fe20><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">其中，，，所以進一步可以化簡為：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">其中在這個公式中忽略掉常數項。</span></p><h1 class=pgc-h-arrow-right><strong><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">4.4.3 Example3: ,</span></strong></h1><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">該函數的共軛函數為，域。當不是嚴格凸的連續可微時，相應的 f-GAN 目標函數如下所示：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">上面這個目標函數的形式就是 Wasserstein GAN 的目標函數。</span></p><h1 class=pgc-h-arrow-right><strong><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">4.4.4 Example4:</span></strong></h1><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">已知，所以該函數為嚴格凸函數。相應的 f-GAN 的目標函數為：</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">對上公式進一步求解可得：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0a03e7c819b44dacb78edad7a0e1fdb4><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">其中裡面有</span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">原始</span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313"> GAN 論文中使用的“logD”技巧，用於 GAN 解決梯度飽和問題。</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">GAN的具體實例</span></p><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">對於 GAN 的應用實例，我沒有按照論文中給出的實例進行介紹，我介紹了在自己的感官上覺得不錯的 GAN。</span></p><h1 class=pgc-h-arrow-right><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">5.1 WGAN</span></h1><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">訓練一個 GAN 可能很困難，它經常會遇到各種問題，其中最主要的問題有以下三點：</span></p><ul><li><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">消失梯度：這種情況經常發生，特別是當判別器太好時，這會阻礙</span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">生辰器</span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">的改進。使用最佳的判別器時，由於梯度的消失，訓練可能失敗，因此無法提供足夠的信息給生成器改進。</span></li><li><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">模式塌縮：這是指生成器開始反覆產生相同的輸出（或一小組輸出）的現象。如果判別器陷入局部最小值，那麼下一個生成器迭代就很容易找到判別器最合理的輸出。判別器永遠無法學會走出陷阱。</span></li><li><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">收斂失敗：由於許多因素（已知和未知），GANs 經常無法收斂。</span></li></ul><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">WGAN 做了一個簡單的修改，用 Wasserstein 距離（也稱為推土機（EM）距離）代替 GAN 中的 Jensen-Shannon 散度損失函數。不要忽視這一修改的意義：這是自 GAN 誕生以來本課題最重要的進展之一，因為 EM 距離的使用有效地解決了基於散度的 GAN 的一些突出缺點，從而可以減輕 GANs 訓練中常見的故障模式。</span></p><h1 class=pgc-h-arrow-right><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">5.2 DCGAN</span></h1><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">DCGAN 是將卷積引入到 GAN 的訓練過程中，使得參數量和訓練效果更好，它實際訓練 GANs 中提供了很多的指導方向，具體有如下五點：</span></p><ul><li><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">用跨步卷積替換生成器和判別器中的任何池化層。</span></li><li><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">在生成器和鑑別器中使用批處理規範化。</span></li><li><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">移除完全連接的隱藏層以獲得更深層的架構。</span></li><li><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">除了使用 Tanh 的輸出之外，在生成器中對所有層使用 ReLU 激活，。</span></li><li><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">在所有層的判別器中使用 LeakyReLU 激活。</span></li></ul><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">需要注意的是判別器是從高維向量到低維向量是卷積過程，如下圖所示：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/106f51de0284463196a247d4fdb51f67><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">生成器是低維向量到高維向量是一個反捲積過程，反捲積又名轉置卷積和微步卷積，卷積和反捲積兩者的區別在於 padding 的方式不同，看看下面這張圖片就可以明白了：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/065cce253a084555ab8e2a8eb6227520><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">DCGAN 還有一個重要的創新之處在於將矢量加法引入到圖像生成中，如下圖所示：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/22bbb0687e0b47c9b17869025870ef4f><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><strong><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">5.3 StyleGAN</span></strong></h1><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">StyleGAN 提出了一個新的生成器框架，號稱能夠控制所生成圖像的高層級屬性，如髮型、雀斑等；並且生成的圖像在一些評價標準上得分更好，作為無監督學習的一種 GAN，它能夠從噪聲生成高分辨率的高清圖像。具體的算法框架原理圖如下所示：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a8db9d89f31a46b1986611c5f8a07d83><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">StyleGAN 中生成的圖像之清晰，細節之豐富由下圖可見一斑，當然訓練的成本也是很高的。</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3b9d4c022e8a44388bfa5c17ffc70629><p class=pgc-img-caption></p></div><h1 class=pgc-h-arrow-right><strong><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">5.4 zi2zi</span></strong></h1><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">zi2zi 是我最喜歡的 GAN 的一種應用，它是利用 GAN 來對字體風格進行轉換，以前的工作是處理類似的中文字體轉化問題，結果不是很理想，</span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">糾</span><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">其原因有生成的圖片通常很模糊，對更多的有風格的字體處理時效果不好，每次只能有限地學習和輸出一種目標字體風格，GAN 能很好的解決以上問題，其模型框架如下圖所示：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dac4e0846d6e4c5598731af007ae2b7c><p class=pgc-img-caption></p></div><p><span style="background-color:#fefefe;--tt-darkmode-bgcolor: #131313">中文字符，不論簡體還是繁體，或者日本文，都用相同的原理構建並有著一系列相同的根基，其中具體的實現結果如下圖所示：</span></p><div class=pgc-img><img alt=生成對抗網絡（GAN）的數學原理全解 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/81ebd655ac05462bbbfb188e5e5a4080><p class=pgc-img-caption></p></div><p>原文地址:https://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247512178&idx=1&sn=be91d6291e36c5b2fa5dd1b98e9f3a21</p><p>原文作者:孫裕道</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>對抗</a></li><li><a>網絡</a></li><li><a>GAN</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/8dce33e7.html alt=理解生成對抗網絡，一步一步推理得到GANs（一） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/bee194d6fbec4d6f82e82998def3f7a3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8dce33e7.html title=理解生成對抗網絡，一步一步推理得到GANs（一）>理解生成對抗網絡，一步一步推理得到GANs（一）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1fe1c2dd.html alt=瞭解生成對抗網絡（GAN） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/634604de44ad4d17931ccc0bcf3e46ef style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1fe1c2dd.html title=瞭解生成對抗網絡（GAN）>瞭解生成對抗網絡（GAN）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ea1bb612.html alt=光纜——未來網絡主導 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e75c1afe12354a93bad8495ad1057693 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ea1bb612.html title=光纜——未來網絡主導>光纜——未來網絡主導</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bdc59733.html alt="網絡詞名場面是什麼意思 名場面是什麼梗" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bdc59733.html title="網絡詞名場面是什麼意思 名場面是什麼梗">網絡詞名場面是什麼意思 名場面是什麼梗</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a002ca18.html alt=王一博那句年度網絡流行語「不愧是我」的：正版英文翻譯 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/26add5cdc08e4214800b25e21b623eb1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a002ca18.html title=王一博那句年度網絡流行語「不愧是我」的：正版英文翻譯>王一博那句年度網絡流行語「不愧是我」的：正版英文翻譯</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ad6f0929.html alt=谷歌大腦發佈神經網絡的「核磁共振」，並公開相關代碼 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/65c4000bda98898dcdbb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ad6f0929.html title=谷歌大腦發佈神經網絡的「核磁共振」，並公開相關代碼>谷歌大腦發佈神經網絡的「核磁共振」，並公開相關代碼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2a9a3956.html alt="100 個網絡基礎知識普及，看完成半個網絡高手！" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/955ea722-be77-4b2d-b87a-64a8a04c8ea8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2a9a3956.html title="100 個網絡基礎知識普及，看完成半個網絡高手！">100 個網絡基礎知識普及，看完成半個網絡高手！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/78c87167.html alt=奧迪A7車載電路與網絡連接之網絡連接 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d34213e3b03545bd8e87ab074b54ca0f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/78c87167.html title=奧迪A7車載電路與網絡連接之網絡連接>奧迪A7車載電路與網絡連接之網絡連接</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8a15db0b.html alt=網絡上共享跨平臺的點對點文件 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/666bf87a9e16425ea1c9adc4f2c10acd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8a15db0b.html title=網絡上共享跨平臺的點對點文件>網絡上共享跨平臺的點對點文件</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2b6ecb90.html alt=網絡基礎知識術語你知道哪些？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2b6ecb90.html title=網絡基礎知識術語你知道哪些？>網絡基礎知識術語你知道哪些？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6474ccee.html alt=點對點網絡的基本知識分享 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8678a34470a144ad88fc0487f0d8da91 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6474ccee.html title=點對點網絡的基本知識分享>點對點網絡的基本知識分享</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a61e29b6.html alt="幫助信息網絡犯罪活動罪 | 廈門刑事律師--辦案資料" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a61e29b6.html title="幫助信息網絡犯罪活動罪 | 廈門刑事律師--辦案資料">幫助信息網絡犯罪活動罪 | 廈門刑事律師--辦案資料</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ded83afe.html alt=博士論文摘要｜馬下平：“陸態網絡”並址站歸心基線精密解算及GNSS基準站數據處理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/53350006726e50ef72f9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ded83afe.html title=博士論文摘要｜馬下平：“陸態網絡”並址站歸心基線精密解算及GNSS基準站數據處理>博士論文摘要｜馬下平：“陸態網絡”並址站歸心基線精密解算及GNSS基準站數據處理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0a866966.html alt=王鋒教授：如何對抗濃度猝滅效應以提升上轉換納米顆粒的發光性能 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1ac39eca4fa74d73b01cc070d7d48eca style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0a866966.html title=王鋒教授：如何對抗濃度猝滅效應以提升上轉換納米顆粒的發光性能>王鋒教授：如何對抗濃度猝滅效應以提升上轉換納米顆粒的發光性能</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/65c66d61.html alt=網絡分析儀校準很頭疼，三大要點得記住！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/41dd3f31e88f48688e75d64978b36acf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/65c66d61.html title=網絡分析儀校準很頭疼，三大要點得記住！>網絡分析儀校準很頭疼，三大要點得記住！</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>