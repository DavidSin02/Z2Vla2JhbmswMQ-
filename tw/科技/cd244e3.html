<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>西門子S7程序結構與程序設計：老知識，新講解 | 极客快訊</title><meta property="og:title" content="西門子S7程序結構與程序設計：老知識，新講解 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/153552396273392518361e4"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cd244e3.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cd244e3.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cd244e3.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cd244e3.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cd244e3.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cd244e3.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/cd244e3.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/cd244e3.html><meta property="article:published_time" content="2020-10-29T20:59:51+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:51+08:00"><meta name=Keywords content><meta name=description content="西門子S7程序結構與程序設計：老知識，新講解"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/cd244e3.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>西門子S7程序結構與程序設計：老知識，新講解</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><blockquote><p>S7程序結構與程序設計：老知識，新講解</p></blockquote><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/153552396273392518361e4><p class=pgc-img-caption></p></div><p><strong>1 S7 CPU中的程序</strong></p><p><strong>a 用戶程序中的塊結構</strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1535524228806fd22103b38><p class=pgc-img-caption></p></div><p><strong>b 用戶程序結構</strong></p><p><strong>（1） 線性程序（線性編程）</strong></p><p><strong>將整個用戶程序連續放置在一個循環程序塊（OB1）中，塊中的程序按順序執行，CPU通過反覆執行OB1來實現自動化控制任務。這種結構和PLC所代替的硬接線繼電器控制類似，CPU逐條地處理指令。事實上所有的程序都可以用線性結構實現，不過，線性結構一般適用於相對簡單的程序編寫。</strong></p><p><strong>（2）分部式程序（分部編程、分塊編程）</strong></p><p><strong>將整個程序按任務分成若干個部分，並分別放置在不同的功能（FC）、功能塊（FB）及組織塊中，在一個塊中可以進一步分解成段。在組織塊OB1中包含按順序調用其他塊的指令，並控制程序執行。在分部程序中，既無數據交換，也不存在重複利用的程序代碼。功能（FC）和功能塊（FB）不傳遞也不接收參數，分部程序結構的編程效率比線性程序有所提高，程序測試也較方便，對程序員的要求也不太高。對不太複雜的控制程序可考慮採用這種程序結構。</strong></p><p><strong>（3）結構化程序（結構化編程或模塊化編程）</strong></p><p><strong>處理複雜自動化控制任務的過程中，為了使任務更易於控制，常把過程要求類似或相關的功能進行分類，分割為可用於幾個任務的通用解決方案的小任務，這些小任務以相應的程序段表示，稱為塊（FC或FB）。OB1通過調用這些程序塊來完成整個自動化控制任務。結構化程序的特點是每個塊（FC或FB）在OB1中可能會被多次調用，以完成具有相同過程工藝要求的不同控制對象。這種結構可簡化程序設計過程、減小代碼長度、提高編程效率，比較適合於較複雜自動化控制任務的設計。</strong></p><p><strong></strong></p><p><strong>c I/O過程映像</strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15355242446962aecc6907c><p class=pgc-img-caption></p></div><p><strong>d 程序循環執行</strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15355242583932f686e3fef><p class=pgc-img-caption></p></div><p><strong></strong></p><p><strong>2 數據塊中的數據存儲</strong></p><p><strong>a 數據存儲區</strong></p><p><strong>數據以用戶程序變量的形式存儲，且具有唯一性。數據可以存儲在輸入過程映像存儲器（PII）、輸出過程映像存儲器（PIQ）、位存儲器（M）、局部數據堆棧（L堆棧）及數據塊（DB）中。可以採用基本數據類型、複雜數據類型或參數類型。根據訪問方式的不同，這些數據可以在全局符號表或共享數據塊中聲明，稱為全局變量；也可以在OB、FC和FB的變量聲明表中聲明，稱為局部變量。當塊被執行時，變量將固定地存儲在過程映像區（PII或PIQ）、位存儲器區（M）、數據塊（DB）或局部堆棧（L）中。</strong></p><p><strong></strong></p><p><strong>b 數據塊</strong></p><p><strong>數據塊定義在S7 CPU的存儲器中，用戶可在存儲器中建立一個或多個數據塊。每個數據塊可大可小，但CPU對數據塊數量及數據總量有限制。數據塊（DB）可用來存儲用戶程序中邏輯塊的變量數據（如：數值）。與臨時數據不同，當邏輯塊執行結束或數據塊關閉時，數據塊中的數據保持不變。用戶程序可以位、字節、字或雙字操作訪問數據塊中的數據，可以使用符號或絕對地址。</strong></p><p><strong>（1）數據塊的分類</strong></p><p><strong>共享數據塊又稱全局數據塊。用於存儲全局數據，所有邏輯塊（OB、FC、FB）都可以訪問共享數據塊存儲的信。背景數據塊用作“私有存儲器區”，即用作功能塊（FB）的“存儲器”。FB的參數和靜態變量安排在它的背景數據塊中。背景數據塊不是由用戶編輯的，而是由編輯器生成的。用戶定義數據塊（DB of Type）是以UDT為模板所生成的數據塊。創建用戶定義數據塊（DB of Type）之前，必須先創建一個用戶定義數據類型，如UDT1，並在LAD/STL/FBD S7程序編輯器內定義。</strong></p><p><strong>（2）數據塊寄存器</strong></p><p><strong>CPU有兩個數據塊寄存器：DB和DI寄存器。這樣，可以同時打開兩個數據塊。</strong></p><p><strong></strong></p><p><strong>c 數據塊的數據結構</strong></p><p><strong>在STEP 7中數據塊的數據類型可以採用基本數據類型、複雜數據類型或用戶定義數據類型（UDT）。</strong></p><p><strong>（1）基本數據類型</strong></p><p><strong>根據IEC1131-3定義，長度不超過32位，可利用STEP 7基本指令處理，能完全裝入S7處理器的累加器中。基本數據類型包括：</strong></p><p><strong>位數據類型：BOOL、BYTE、WORD、DWORD、CHAR</strong></p><p><strong>數字數據類型：INT、DINT、REAL</strong></p><p><strong>定時器類型：S5TIME、TIME、DATE、TIME_OF_DAY</strong></p><p><strong></strong></p><p><strong>（2）複雜數據類型</strong></p><p><strong>複雜數據類型只能結合共享數據塊的變量聲明使用。複雜數據類型可大於32位，用裝入指令不能把複雜數據類型完全裝入累加器，一般利用庫中的標準塊（“IEC”S7程序）處理複雜數據類型。複雜數據類型包括：</strong></p><p><strong>時間（DATE_AND_TIME）類型</strong></p><p><strong>矩陣（ARRAY）類型</strong></p><p><strong>結構（STRUCT）類型</strong></p><p><strong>字符串（STRING）類型</strong></p><p><strong></strong></p><p><strong>（3）用戶定義數據類型</strong></p><p><strong>STEP 7允許利用數據塊編輯器，將基本數據類型和複雜數據類型組合成長度大於32位用戶定義數據類型（UDT：User-Defined dataType）。用戶定義數據類型不能存儲在PLC中，只能存放在硬盤上的UDT塊中。可以用用戶定義數據類型作“模板”建立數據塊，以節省錄入時間。可用於建立結構化數據塊、建立包含幾個相同單元的矩陣、在帶有給定結構的FC和FB中建立局部變量。</strong></p><p><strong>創建用戶定義數據類型</strong></p><p><strong>創建一個名稱為UDT1的用戶定義數據類型，數據結構如下，則可按以下幾個步驟完成。</strong></p><p><strong>STRUCT</strong></p><p><strong>Speed:INT</strong></p><p><strong>Current:REAL</strong></p><p><strong>END_STRUCT</strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1535524280679580b4a901c><p class=pgc-img-caption></p></div><p><strong>打開UDT1，並編輯：</strong></p><p><strong></strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15355242902409ecb87d3e5><p class=pgc-img-caption></p></div><p><strong></strong></p><p><strong></strong></p><p><strong>d 建立數據塊</strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535524302652c78d7df1e3><p class=pgc-img-caption></p></div><p><strong>在STEP 7中，為了避免出現系統錯誤，在使用數據塊之前，必須先建立數據塊，並在塊中定義變量（包括變量符號名、數據類型以及初始值等）。數據塊中變量的順序及類型決定了數據塊的數據結構，變量的數量決定了數據塊的大小。數據塊建立後，還必須同程序塊一起下載到CPU中，才能被程序塊訪問。</strong></p><p><strong>（1）建立數據塊</strong></p><p><strong>（2）定義變量並下載數據塊</strong></p><p><strong>在DB1中聲明5個變量：</strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1535524316147ff78550a4d><p class=pgc-img-caption></p></div><p><strong>變量定義完成後，應單擊保存按鈕保存並編譯（測試）。如果沒有錯誤則需要單擊下載按鈕，像邏輯塊一樣，將數據塊下載到CPU。</strong></p><p><strong></strong></p><p><strong>e 訪問數據塊</strong></p><p><strong>在用戶程序中可能存在多個數據塊，而每個數據塊的數據結構並不完全相同，因此在訪問數據塊時，必須指明數據塊的編號、數據類型與位置。如果訪問不存在的數據單元或數據塊，而且沒有編寫錯誤處理OB塊，CPU將進入STOP模式。</strong></p><p><strong>（1）尋址數據塊</strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1535524327542d9e33b5b84><p class=pgc-img-caption></p></div><p><strong></strong></p><p><strong>（2）訪問數據塊</strong></p><p><strong>在STEP 7中可以採用傳統訪問方式，即先打開後訪問；也可以採用完全表示的直接訪問方式。</strong></p><p><strong></strong></p><p><strong>舉例1：打開並訪問共享數據塊：</strong></p><p>OPN “My_DB” //打開數據塊DB1，作為共享數據塊</p><p>L DBW2 //將DB1的數據字DBW2裝入累加器1的低字中</p><p>T MW0 //將累加器1低字中的內容傳送到存儲字MW0</p><p>OPN DB2 //打開數據塊DB2，作為共享數據塊，同時關閉數據塊DB1</p><p>L DB10 //裝入共享數據塊DB2的長度</p><p>L MD10 //將MD10裝入累加器</p><p>&lt;D //比較數據塊DB2的長度是否足夠長</p><p>JC ERRO //如果長度小於存儲雙字MD10中的數值，則跳轉到ERRO</p><p><strong></strong></p><p><strong>用指令“OPN DB...”打開共享數據塊（自動關閉之前打開的共享數據塊），如果DB已經打開，則可用裝入（L）或傳送（T）指令訪問數據塊。</strong></p><p><strong>舉例2：打開並訪問背景數據塊:</strong></p><p>OPN DB1 //打開數據塊DB1，作為共享數據塊</p><p>L DBW2 //將DB1的數據字DBW2裝入累加器1的低字中</p><p>T MW0 //將累加器1低字中的內容傳送到存儲字MW0</p><p>T DBW4 //將累加器1低字中的內容傳送到DB1的數據字DBW4</p><p>OPN DI2 //打開數據塊DB2，作為背景數據塊</p><p>L DIB2 //將DB2的數據字節DBB2裝入累加器1低字的低字節中</p><p>L DIB10 //累加器1低字節的內容傳送到DB2的數據字節DBB10</p><p><strong>（3）直接訪問數據塊</strong></p><p><strong>在指令中同時給出數據塊的編號和數據在數據塊中的地址。可以用絕對地址，也可以用符號地址直接訪問數據塊。</strong></p><p><strong>用絕對地址直接訪問數據塊，如：</strong></p><p>L DB1.DBW2 //打開數據塊DB1，並裝入地址為2字數據單元</p><p>T DB1.DBW4 //將數據傳送到數據塊DB1的數據字單元DBW4</p><p><strong>用符號地址直接訪問數據塊 ，如：</strong></p><p>L “My_DB”.V1 //打開符號名為“My_DB”的數據塊</p><p>//並裝入名為V1的數據單元</p><p><strong></strong></p><p><strong>3 邏輯塊（FC和FB）的結構及編程</strong></p><p><strong>功能（FC）、功能塊（FB）和組織塊（OB）統稱為邏輯塊（或程序塊）。功能塊（FB）有一個數據結構與該功能塊的參數完全相同的數據塊，稱為背景數據塊，背景數據塊依附於功能塊，它隨著功能塊的調用而打開，隨著功能塊的結束而關閉。存放在背景數據塊中的數據在功能塊結束時繼續保持。而功能（FC）則不需要背景數據塊，功能調用結束後數據不能保持。組織塊（OB）是由操作系統直接調用的邏輯塊。</strong></p><p><strong>a 邏輯塊（FC和FB）的結構</strong></p><p><strong>邏輯塊（OB、FB、FC）由變量聲明表、代碼段及其屬性等幾部分組成。</strong></p><p><strong>（1）局部變量聲明表（局部數據）</strong></p><p><strong>每個邏輯塊前部都有一個變量聲明表，稱為局部變量聲明表。</strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/153552435612235e04a4c73><p class=pgc-img-caption></p></div><p><strong>局部數據分為參數和局部變量兩大類，局部變量又包括靜態變量和臨時變量（暫態變量）兩種。</strong></p><p><strong>對於功能塊（FB），操作系統為參數及靜態變量分配的存儲空間是背景數據塊。這樣參數變量在背景數據塊中留有運行結果備份。在調用FB時，若沒有提供實參，則功能塊使用背景數據塊中的數值。操作系統在L堆棧中給FB的臨時變量分配存儲空間。</strong></p><p><strong>對於功能（FC），操作系統在L堆棧中給FC的臨時變量分配存儲空間。由於沒有背景數據塊，因而FC不能使用靜態變量。輸入、輸出、I/O參數以指向實參的指針形式存儲在操作系統為參數傳遞而保留的額外空間中。</strong></p><p><strong>對於組織塊（OB）來說，其調用是由操作系統管理的，用戶不能參與。因此，OB只有定義在L堆棧中的臨時變量。</strong></p><p><strong></strong></p><p><strong>（2）邏輯塊局部變量的數據類型</strong></p><p><strong>局部變量可以是基本數據類型或複式數據類型，也可以是專門用於參數傳遞的所謂的“參數類型”。參數類型包括定時器、計數器、塊的地址或指針等。</strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15355243751414c56a2fcd4><p class=pgc-img-caption></p></div><p><strong>（3）邏輯塊的調用過程及內存分配</strong></p><p><strong>CPU提供塊堆棧（B堆棧）來存儲與處理被中斷塊的有關信息。</strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1535524388941a4462d316a><p class=pgc-img-caption></p></div><p><strong>用戶程序使用的堆棧：</strong></p><p><strong>局部數據堆棧簡稱L堆棧，是CPU中單獨的存儲器區，可用來存儲邏輯塊的局部變量（包括OB的起始信息）、調用功能（FC）時要傳遞的實際參數、梯形圖程序中的中間邏輯結果等。可以按位、字節、字和雙字來存取。</strong></p><p><strong>塊堆棧簡稱B堆棧，是CPU系統內存中的一部分，用來存儲被中斷的塊的類型、編號、優先級和返回地址；中斷時打開的共享數據塊和背景數據塊的編號；臨時變量的指針（被中斷塊的L堆棧地址）。</strong></p><p><strong>中斷堆棧簡稱I堆棧，用來存儲當前累加器和地址寄存器的內容、數據塊寄存器DB和DI的內容、局域數據的指針、狀態字、MCR（主控繼電器）寄存器和B堆棧的指針。</strong></p><p><strong></strong></p><p><strong>調用功能塊（FB）時的堆棧操作</strong></p><p><strong>當調用功能塊（FB）時，會有以下事件發生：</strong></p><p><strong>①調用塊的地址和返回位置存儲在塊堆棧中，調用塊的臨時變量壓入L堆棧；②數據塊DB寄存器內容與DI寄存器內容交換；③新的數據塊地址裝入DI寄存器；④被調用塊的實參裝入DB和L堆棧上部；⑤當功能塊FB結束時，先前塊的現場信息從塊堆棧中彈出，臨時變量彈出L堆棧；⑥DB和DI寄存器內容交換。</strong></p><p><strong>當調用功能塊（FB）時，STEP 7並不一定要求給FB形參賦予實參，除非參數是複式數據類型的I/O形參或參數類型形參。如果沒有給FB的形參賦予實參，則功能塊（FB）就調用背景數據塊內的數值，該數值是在功能塊（FB）的變量聲明表或背景數據塊內為形參所設置初始數值。</strong></p><p><strong></strong></p><p><strong>調用功能（FC）時的堆棧操作</strong></p><p><strong>當調用功能（FC）時會有以下事件發生：</strong></p><p><strong>功能（FC）實參的指針存到調用塊的L堆棧；調用塊的地址和返回位置存儲在塊堆棧，調用塊的局部數據壓入L堆棧；功能（FC）存儲臨時變量的L堆棧區被推入L堆棧上部；當被調用功能（FC）結束時，先前塊的信息存儲在塊堆棧中，臨時變量彈出L堆棧。 因為功能（FC）不用背景數據塊，不能分配初始數值給功能（FC）的局部數據，所以必須給功能（FC）提供實參。</strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535524420448e7c43c8d0c><p class=pgc-img-caption>以功能（FC）調用為例，L堆棧操作示意如圖所示。</p></div><p><strong>b 邏輯塊（FC和FB）的編程</strong></p><p><strong>對邏輯塊編程時必須編輯下列三個部分：</strong></p><p><strong>變量聲明：分別定義形參、靜態變量和臨時變量（FC塊中不包括靜態變量）；確定各變量的聲明類型（Decl.）、變量名（Name）和數據類型（Data Type），還要為變量設置初始值（Initial Value）。如果需要還可為變量註釋（Comment）。在增量編程模式下，STEP 7將自動產生局部變量地址（Address）。</strong></p><p><strong>代碼段：對將要由PLC進行處理的塊代碼進行編程。</strong></p><p><strong>塊屬性：塊屬性包含了其它附加的信息，例如由系統輸入的時間標誌或路徑。此外，也可輸入相關詳細資料。</strong></p><p><strong>（1）臨時變量的定義和使用</strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535524457715a0ed520e06><p class=pgc-img-caption></p></div><p><strong>（2）查看局部數據堆棧的佔用</strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/15355244699629a12925656><p class=pgc-img-caption></p></div><p><strong>（3）查看塊所需字節數</strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1535524490235bdeb89a8c3><p class=pgc-img-caption></p></div><p><strong>（4）定義形式參數</strong></p><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15355245010220522286fab><p class=pgc-img-caption></p></div><p><strong>（5）編寫控制程序</strong></p><p><strong>編寫邏輯塊（FC和FB）程序時，可以用以下兩種方式使用局部變量：</strong></p><p><strong>①使用變量名，此時變量名前加前綴“#”，以區別於在符號表中定義的符號地址。增量方式下，前綴會自動產生。</strong></p><p><strong>②直接使用局部變量的地址，這種方式只對背景數據塊和L堆棧有效。</strong></p><p><strong>在調用FB塊時，要說明其背景數據塊。背景數據塊應在調用前生成，其順序格式與變量聲明表必須保持一致。</strong></p><p><strong></strong></p><p><strong></strong></p><p><strong></strong></p><blockquote><p><strong>更多PLC設計案例，關注頭條號：溪谷公眾號。</strong></p><p><strong></strong></p><p><strong>覺得有用就點擊關注吧~</strong></p><p><strong>享受更多最新實用PLC乾貨知識！</strong></p><p><strong>（溪谷公眾號）</strong></p></blockquote><div class=pgc-img><img alt=西門子S7程序結構與程序設計：老知識，新講解 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1535524568431bcb137b681><p class=pgc-img-caption></p></div></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>程序</a></li><li><a>西門子</a></li><li><a>S7</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/ea62b7ce.html alt=西門子S7-300下載後停機了？怎麼找故障？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1536064859530d698e386b0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ea62b7ce.html title=西門子S7-300下載後停機了？怎麼找故障？>西門子S7-300下載後停機了？怎麼找故障？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9e7b9f23.html alt="西門子S7-1500 PLC的基本數據類型" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b66e147b6b5447c5b208c67bd24adad7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9e7b9f23.html title="西門子S7-1500 PLC的基本數據類型">西門子S7-1500 PLC的基本數據類型</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/37260344.html alt="西門子S7-200SMART PLC 循環走馬燈如何編寫？" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/4ff65441e7ce47d19a3373f98cc10d82 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/37260344.html title="西門子S7-200SMART PLC 循環走馬燈如何編寫？">西門子S7-200SMART PLC 循環走馬燈如何編寫？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/407d4a4f.html alt=西門子S7-300利用循環左移指令實現自復位按鈕一鍵啟停 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/37d30003bef90889115a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/407d4a4f.html title=西門子S7-300利用循環左移指令實現自復位按鈕一鍵啟停>西門子S7-300利用循環左移指令實現自復位按鈕一鍵啟停</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/38866f8c.html alt=西門子S7-1200，如何在FB塊中使用操作定時器？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1fcd95c6bb184bc2925a32c27fd70940 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/38866f8c.html title=西門子S7-1200，如何在FB塊中使用操作定時器？>西門子S7-1200，如何在FB塊中使用操作定時器？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/77aec7af.html alt="西門子S7-300PLC 通過SM331模塊對熱電偶進行採集設置" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1540180249572cd69d4211b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/77aec7af.html title="西門子S7-300PLC 通過SM331模塊對熱電偶進行採集設置">西門子S7-300PLC 通過SM331模塊對熱電偶進行採集設置</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/875eec94.html alt=西門子S7-1500MODBUS通訊知識一文總結 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/29c72b89f7f2466cb90f74a0b2577ca7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/875eec94.html title=西門子S7-1500MODBUS通訊知識一文總結>西門子S7-1500MODBUS通訊知識一文總結</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/04adffdc.html alt=可編程控制器（西門子S7-300）的通訊網絡介紹 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7cd9f5d6efe64d1e8874dc4335547a6c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/04adffdc.html title=可編程控制器（西門子S7-300）的通訊網絡介紹>可編程控制器（西門子S7-300）的通訊網絡介紹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cb99bd5e.html alt=西門子S7-200SMART通過PROFINET連接V90實現速度控制的方案1 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/4d14be560a9c483f8fe422baffa881f4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cb99bd5e.html title=西門子S7-200SMART通過PROFINET連接V90實現速度控制的方案1>西門子S7-200SMART通過PROFINET連接V90實現速度控制的方案1</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/48560d50.html alt="西門子S7-300（Step7 v5.5軟件）仿真器PLCSIM_V54_SP5安裝說明" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/15401773108505523528a33 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/48560d50.html title="西門子S7-300（Step7 v5.5軟件）仿真器PLCSIM_V54_SP5安裝說明">西門子S7-300（Step7 v5.5軟件）仿真器PLCSIM_V54_SP5安裝說明</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/72f9408c.html alt=入門西門子S7-200PLC，工程師詳細解析包裝秤編程控制程序案例 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/154028213168186ae00708b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/72f9408c.html title=入門西門子S7-200PLC，工程師詳細解析包裝秤編程控制程序案例>入門西門子S7-200PLC，工程師詳細解析包裝秤編程控制程序案例</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ac3bf48.html alt="基於西門子S7-200 SMART PLC的PID無擾動手動-自動切換方法" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8b32378fa21b4789ac4af3aeb065d579 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ac3bf48.html title="基於西門子S7-200 SMART PLC的PID無擾動手動-自動切換方法">基於西門子S7-200 SMART PLC的PID無擾動手動-自動切換方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ec066a0.html alt="深入剖析西門子 S7-200 PLC的常用數據存儲區" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6a86e8c2577e4f30a19c800f9ed5fb9f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ec066a0.html title="深入剖析西門子 S7-200 PLC的常用數據存儲區">深入剖析西門子 S7-200 PLC的常用數據存儲區</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3d9462d.html alt="西門子S7-300 PLC 的50個經典問題，都懂了你就是專家" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/9bebd2b74bd24c6a9eb04f29184c6d4a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3d9462d.html title="西門子S7-300 PLC 的50個經典問題，都懂了你就是專家">西門子S7-300 PLC 的50個經典問題，都懂了你就是專家</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e55cddd.html alt=西門子S7-1200使用診斷緩衝區,查看CPU停機原因 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d107716a998f4acd8f34d81decb5a937 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e55cddd.html title=西門子S7-1200使用診斷緩衝區,查看CPU停機原因>西門子S7-1200使用診斷緩衝區,查看CPU停機原因</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>