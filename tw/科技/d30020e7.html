<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>基於再抽樣技術的交互式大數據分析 | 极客快訊</title><meta property="og:title" content="基於再抽樣技術的交互式大數據分析 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/0c8457cd9f384a78969a492cb974791f"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d30020e7.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d30020e7.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d30020e7.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d30020e7.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d30020e7.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d30020e7.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d30020e7.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d30020e7.html><meta property="article:published_time" content="2020-10-29T21:10:45+08:00"><meta property="article:modified_time" content="2020-10-29T21:10:45+08:00"><meta name=Keywords content><meta name=description content="基於再抽樣技術的交互式大數據分析"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/d30020e7.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>基於再抽樣技術的交互式大數據分析</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p><strong>第一章：再抽樣技術與交互式分析</strong></p><p><br></p><p>本文關注基於再抽樣（subsampling）技術的交互式（interactive）大數據分析。為此，我們總結了一套規範的分析方法論，研究了支撐該方法論的統計學理論基礎，並開發了便捷的Python開源軟件包（clubear）。本文有三個關鍵詞<strong>：大數據（massive data），再抽樣（sub-sampling）與交互式（interactive）</strong>。對這三個關鍵詞，下面將逐一詳細講解。</p><p><br></p><p><strong>1.1 本文對大數據的定義</strong></p><p>大數據，這似乎是一個被四處濫用的詞語，而且定義極其模糊。為了避免不必要的誤會，下面會對本文所涉及的“大數據”做一個儘可能準確的描述，以便於快速甄別這是不是你關心的大數據內容。</p><p>首先強調一點，本文研究的都是傳統的結構化數據。因此，非結構化數據（例如：圖像、聲音、自然語言相關的數據）都不是本文關注的內容。顯然，這並不是因為這些非結構化數據不重要，而僅僅是因為本文的能力有限，目前還無法覆蓋這些重要的內容。但是，從另一方面看，即使對非常規範的結構化大數據，人們似乎仍然非常缺乏便捷的分析方法論，以及支撐它的軟件工具。因此，本文嘗試在這個方面做一些探索。</p><p>其次需要討論的是，本文所關注的“大數據”到底有多大？對“大”的定義到底是什麼？這裡你需要認真閱讀，因為下面將嚴格界定本文所謂的“大數據”到底有多大。首先，本文關注的數據量顯然不能太小。那麼到底多小的數據才叫做小呢？同樣一個數據，對某些人而言就是很大，而對某些人而言就很小。為什麼？因為所擁有的計算設備（例如：計算機）各不相同。例如，硬盤上1G的數據，對大多數普通人的個人電腦而言是很大的。這種很大表現在分析處理該數據時很艱難。因為常見的數據分析軟件（例如：Excel，R，Python等）都很難一次性地將這些數據讀入內存。或者能讀入，但是讀入很慢，處理很慢，對用戶的響應很慢。簡單三個字概括這種體驗就是：很不爽。但是，如果擁有一個32G內存的工作站，這樣體驗就會好很多。此時，可以把數據一次性讀入內存。雖然讀入內存這個過程仍然很慢，會產生不小的用戶等待時間。但是，數據一旦讀入內存，處理起來還是非常快的。從這個位置開始，之後的分析工作中，可能不會太感受到1G數據與1K數據之間特別明顯的差距。因此，同樣1G的數據，對於一個普通的個人電腦用戶而言，可能就很大；而對於一個擁有高性能工作站的用戶而言，就不是很大，甚至仍然屬於小數據的範疇。</p><p>由此可見，所謂數據大小，是沒有絕對標準的。數據的大小是相對於所擁有的計算設備而言的。因此，本文定義一個數據叫“小數據”，如果該數據能夠被目標計算設備（例如：一臺服務器）一次性輕鬆讀入內存。相反，本文定義一個數據叫做“大數據”，如果該數據無法被目標計算設備（例如：一臺個人電腦）一次性讀入內存（或者讀入過程很痛苦，讀入後的處理效率很低）。因此，本文對大小數據的定義並不依賴於任何虛無縹緲的概念，而是依賴於用戶的切實體驗。只要讓常見的分析方法和軟件（傳統分析方法和軟件一般要求數據一次性讀入內存）難以計算處理的數據，就是本文所界定的大數據。</p><p>但是，不是所有的大數據都能夠被本文即將介紹的方法論處理（至少目前為止）。如果一個數據實在太大，大到了一臺機器放不下（例如：1P的數據），而必須採用分佈式存儲系統。那麼很遺憾，本文即將介紹的再抽樣方法也處理不了。本文的方法依賴於高效的再抽樣算法，這需要計算機提供匹配的硬件支持。如果所有數據都放在一臺機器的硬盤上（最好還是固態硬盤），那麼再抽樣算法就可以被非常高效的執行。相反，如果數據被分佈式存儲在不同的計算機上，那麼再抽樣算法就必須去頻繁地訪問不同的計算機，這會產生大量的通訊成本（communication cost）。這會大大降低再抽樣算法的抽樣效率。這顯然是再抽樣算法的一個缺點和侷限性，請一定知曉。</p><p>因此，本文能處理的數據量，應該遠小於你的硬盤。因為，只有這樣大小的數據才能夠在硬盤上被高效地抽樣處理。請問：這樣的數據量有多大呢？假設你的電腦硬盤是1T，那麼我們能處理的數據量得比這個小很多，最好不要超過10G。小聲問一句，10G對你來說夠大了不？對很多朋友而言，10G這個數據量太小了，完全不能滿足需求。但是，對於更多的朋友而言，10G的數據量是足夠大的，甚至是典型的。如果10G對你而言足夠大了，那麼請你跟我一起走完下面的再抽樣和交互式的旅程，非常精彩！整個過程，不需要高大上的分佈式系統，只需要最普通的電腦（例如：你的筆記本），還有Python就可以了。只要滿足這兩個條件，就非常便捷快速地享受大數據分析帶給你的快樂。</p><p><br></p><p><strong>1.2 為什麼不考慮分佈式</strong></p><p>再次強調，即將跟大家分享的數據分析框架只需要一臺普通的計算設備（例如：你的筆記本電腦），不需要龐大的分佈式系統。為什麼不考慮分佈式的計算框架（例如：Hadoop, Spark）呢？原因很簡單，因為在大多數以分析建模為目標的情形下，分佈式框架昂貴、複雜，而且似乎沒必要。盲目地追隨分佈式，會帶來太多深坑。</p><p><strong>第一個深坑：預算問題。</strong>要採用分佈式系統，你就需要添置計算資源，請問如何添置？如果是購買，那麼能入眼的工作站（或者服務器）再便宜也得1萬+。至少得是2臺吧？要不怎麼叫分佈式？如果是租，大家可以在各大雲服務提供商平臺（例如：阿里雲、華為雲等）去查詢一下價格。你會發現租金其實一點也不便宜，比買還貴，一年沒有1萬+的預算，你租不起任何像樣的服務器。請問：你要添置幾臺服務器？什麼樣的？需要多少預算支持？是一次性投入？還是每年持續投入？當你回答完這些問題後，下一個問題馬上就來了：你要做什麼高大上的數據分析，能帶來什麼好處，能夠支撐這麼大的預算？在絕大多數情況下，你會發現這個問題很難回答。數據分析已經融入到企業的方方面面，對企業業務運營有貢獻，這是毫無爭議的。但是，具體到你要做的這個特定分析，能產生什麼特定的價值，並且可以用貨幣衡量，這太難了！面對這樣的困境，如何說服領導這樣的分析能支撐這樣的預算，這是一件很艱難或者根本不可能的任務。</p><p><strong>第二個深坑：技術問題。</strong>好，假設你終於說服領導購買了必要的計算資源。下一個問題來了：你會嗎？你懂嗎？這個會和懂包含兩個方面。首先，你會安裝相應的軟件資源嗎？其次，安裝好之後你會用嗎？例如你要用Hadoop和Spark，你有必要的Python基礎嗎？有了必要的Python基礎，你懂Hadoop和Spark的Map-Reduce框架嗎？你懂Hadoop和Spark之間的區別嗎？這中間可能還會牽涉到其他的技術（例如：Hive）等。如果僅僅是用這些分佈式系統做一些簡單的代數運算，可能還好。如果再追問一句：如何用Spark做邏輯迴歸呢？你會發覺整個人都不好了。因為你對這些問題的答案很可能都是否定的。當然，不會沒關係，不懂沒關係，可以學習嘛。那麼這些技術框架好學嗎？顯然不好學。因為，大多數情況下，你可能有一個屬於自己的筆記本（或者臺式機），但是你沒有分佈式計算平臺。連平臺都沒有，你怎麼學？好，假設你有平臺了，那就好學了嗎？答：還是很不容易。大多數情況下，這些平臺都是建立在linux操作系統上的。因此，你得先學linux的基本操作。例如：在小黑窗（終端）中通過鍵盤操作，如何進入不同的目錄，如何刪除文件，如何更改文件名等。對於一個喜歡WIN或者MAC視窗操作的你來說，這需要一點點時間。你看，不是說好要學習分佈式框架（例如：Hadoop）嗎？這折騰半天，連Hadoop的邊都還沒有碰到呢。終於，你所有準備工作都做好了，你會發現分佈式框架的學習是有一定難度的。當然，不排除這種可能，天賦秉異的你自學成才，畢竟這樣的小夥伴比比皆是。但是，對於絕大多數像我這樣的普通人，沒有老師帶路，是很難上手的。這也是為什麼與分佈式平臺基礎操作相關的培訓課程比比皆是的原因。這說明這個學習是不容易的。</p><p><strong>第三個深坑：必要性問題。</strong>什麼樣的工作真的需要分佈式計算框架，非要如此大動干戈呢？顯然，這樣的工作場景確實存在。例如，對於一個有海量註冊用戶的電商網站，會面臨用戶的消費記錄、會員積分、基本信息變更等計算任務。這樣的計算任務每天都有，而且要求絕對準確。任何不準確不是給消費者帶來損失，就是給自己帶來損失。因此，這樣的數據處理就有兩個特點：第一、不能容許任何誤差；第二、面面俱到。所謂面面俱到就是要求每個賬戶樣本都要涉及，不能忽略或者拋棄其中任何一個，因此任何抽樣算法都不可能有用武之地。因此，這樣的業務場景必須用分佈式（或者類似的）計算框架處理。畢竟，這不可能是單機能完成的任務。但是，如果是做數據分析呢？大多數分析有必要絕對準確嗎？有必要面面俱到嗎？與此相關的另一個問題是：數據分析對誤差是容許的嗎？如果你認為數據分析是不允許任何誤差，那麼請舉一個例子，我相信這樣的例子很少。事實上，幾乎所有的數據分析都是誤差容許的，而且是必須誤差容許的。原因很簡單，因為所謂數據分析，分析的就是不確定性（例如：消費行為、市場走勢）。因此，對於絕大多數數據分析而言，壓根就不存在絕對正確的結果。但是，可以有相對靠譜的結果。在相對靠譜的前提下，大方向一致的分析結果，對實際工作的幫助都是一樣的。如果高精度分析結果和足夠精度分析結果所需要的時間成本都是一樣的，那麼顯然更喜歡高精度分析結果，因為不要白不要。但是，如果高精度分析結果是以巨大的時間成本為代價的呢？如果高精度分析結果是以巨大預算為代價的呢？這就得謹慎考慮了。大多數情況下，那個精度差一點（但是還可以接受），但是時間成本低很多，預算成本低很多的方案，更受歡迎。</p><p><br></p><p>當然，必須強調一點，這裡並不是在否認分佈式系統的巨大價值和現實意義。任何對此的質疑都是可笑的。這裡強調的是：面對分析任務的時候，很可能（甚至大概率），你是不需要分佈式系統支持的，這裡需要一點點審慎的思考。</p><p><br></p><p><strong>1.3 論數據分析的誤差容許性</strong></p><p>請注意，幾乎所有的數據分析都是誤差容許的，因為幾乎所有的數據分析都不可能做到絕對精確的，而最終的數據分析都是用來支撐決策的（推薦、廣告、投資等）。對於決策而言，超級精確的結果和足夠精確的結果是一樣的。例如，一個自動化推薦系統，是否應該給一個用戶推薦華為手機呢？通過超級精確的模型測算髮現，該用戶購買華為手機的概率為65%，因此應該推薦。另外一個足夠精確的模型測算髮現，該用戶購買華為手機的概率為64.5%，請問推薦結果會變嗎？答：不會，仍然是推薦。由此可見，對於個性化推薦這個業務場景而言，決策對分析結果是誤差容許的。為什麼會產生誤差容許現象？因為：分析的對象（例如：購買行為）是高度不確定的，分析結果（例如：購買概率）常常是連續的，而決策（是否推薦）是離散的。因此，幾乎所有的數據分析都有很高的誤差容許度。</p><p>為了幫助你建立一個直觀感受，跟你分享一個實際數據分析的案例。在本文中我們簡稱該數據為“航空數據”（airline data）。該數據來自美國統計學會（American Statistical Association）官方網站（http://stat-computing.org/dataexpo/2009/），可以公開下載。對此應該首先對數據的提供者表示深深的感謝。該數據對本文非常重要，因為將以該數據為主要案例，演示整個方法論框架以及代碼操作。後面會對該數據做一個更加詳細的介紹，這裡只做最簡單說明。這是一個關於航班信息的數據，有大概1.2億行觀測，在硬盤上佔據12G的空間。</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0c8457cd9f384a78969a492cb974791f><p class=pgc-img-caption></p></div><p><strong>圖1.1：基於航空數據全樣本的均值估計</strong></p><p>為便於討論，這裡只考察其中一個變量Distance。該變量表示某一航班從起點城市到終點城市，所經歷的飛行距離，單位為英里（Mile）。假設管理者想了解一下該變量的均值。如果要對全樣本計算，一個相對方便的做法是利用Python的Pandas庫中的read_csv函數，將數據讀入處理。由於該數據量很大，對絕大多數工作站而言，無法一次性讀入。因此必須分塊讀入，分塊計算，最後彙總。這就立刻產生了不小的代碼需求（見圖1.1）。假設你有一定的Python基礎，因此沒有對代碼做特別詳細的解釋。這裡僅僅對最關鍵的部分做一個強調，那就是通過pd.read_csv函數中的iterator和chunksize兩個參數控制，讓程序將原始數據分塊讀入（iterator=True），分塊計算處理。每次讀入行數是chunksize=10**6。顯然，不會這麼巧最後一塊數據（chunk）大小正好是chunksize=10**6，那麼iterator=True這個參數會讓pd.read_csv根據實際情況讀入殘餘數據而不報錯。</p><p>先不說最後結果如何，整個代碼是有一點難度的。如果不是熟練手，自己去寫上面這個代碼，是非常容易出各種錯誤的。假設最後代碼終於寫好了，可以在服務器上開始運行。最後，一共完成了124個迭代，大概等於124*10**6=1.24億行數據。最終計算獲得的樣本均值為：701.699英里。總共耗時（含124次print時間）157秒，超過2.5分鐘。時間長嗎？也許你會說，時間不長呀！對，如果你把上面的代碼複製粘貼直接運行，而且你確認最後的結果就是你想要的，那麼2.5分鐘時間真的不長。但是，實際的時間消耗會遠遠大於2.5分鐘，這源於幾個原因。</p><p>第一、你要自己寫代碼，你會根據研究或者業務需求的變化（可能都是雞毛蒜皮的變化）不停地修改你的代碼，並因此面對新的代碼錯誤，從而產生不小的代碼修正時間。我自認為是一個數據分析方面非常熟練的Python編程人員，寫上面的代碼也花了我10分鐘的時間，因為中間有各種意想不到的問題出現（例如：編碼問題），需要試錯。</p><p>第二、更糟糕的是需求不停變化，而且具有不確定性。幾乎沒有任何一個數據分析的需求是穩定的、不變的。例如，根據初步分析計算結果發現各種問題（例如：數據有異常值，分佈厚尾等），因此需要相應的數據處理（例如：刪除、變換）。這樣的改動需求很多，每一次小小的變化和改動，都要2.5分鐘。請問你是否能夠消耗得起？事實上，即使面對很小的數據量（例如：1千行），各種奇葩的問題也層出不窮。更何況1.2億行的大數據，不知道要出多少狀況。每次消耗2.5分鐘，請問誰消耗得起？</p><p>相反，如果放棄對“全樣本計算”的執著，事情會簡單很多。如前所述，幾乎所有的數據分析都是誤差容許的。事實上，統計學推斷的一個核心智慧就是對誤差的評價和判斷（例如：標準誤差的測算）。畢竟，統計學研究的不是統計，統計學研究的是不確定性。在不確定性存在的情況下，沒有任何分析能夠絕對準確。即使全樣本數據也是對總體的一個估計，也是有誤差的。當然，因為全樣本的樣本量很大（N=1.2*10**8），所以相應估計量的精度一定最高。按照標準的基於獨立同分布假設的統計學理論可以知道，均值的標準誤差（SE：standard error）為：SE=Std/sqrt(N)，其中Std為標準差，N為樣本量。對於航空數據的Distance指標而言，標準差（Std）大概為549.67（見圖1.2）。因此，全樣本均值的標準誤差SE大概為：549.67/sqrt(1.2*10**8)=0.05英里。一英里大概是1.6公里，那麼0.05英里大概是80米。而0.05英里大概是平均航空距離701英里（見圖1.1）的萬分之1不到。請問：真有這個必要嗎？什麼樣的管理決策需要萬分之1的精確度？</p><p>答案顯然是否定的。也許精確到10英里範圍內就非常好了。如果能接受這個標準，那麼就可以接受再抽樣（subsampling）算法。什麼是再抽樣？從統計學理論的角度看，任何實際數據，無論多大，都是從一個概率分佈生成的。這個抽象的概率分佈才是總體。而我們看到的航空數據是一個抽樣數據，是從總體中隨機抽取的。而這個樣本太大了（N=1.2*10**8）。而所謂再抽樣算法就是從這個樣本中再隨機的抽取一個小樣本（例如：n=10**4），然後基於小樣本計算同樣的統計量（例如：樣本均值）。小樣本帶來的優點很明顯，那就是：快！因為再抽樣樣本的樣本量n（請注意區分n和N）很小，因此可以快速獲得，快速分析，並形成快速反饋。當然，小樣本的缺點也很明顯，那就是：一次再抽樣所產生的精度可能達不到我們需求（例如：誤差1英里）。</p><p>再抽樣算法的精度問題很好解決，那就是多做幾次再抽樣，每次都計算同樣的統計量，然後再用科學規範的方法將每次再抽樣的計算結果整合在一起。請注意整合再抽樣計算結果的方法很多，不一定是把各個結果再算一個均值這麼簡單，這裡需要紮實的統計學理論去做支撐。但是，無論任何整合方法，目標都是一致的，那就是要形成一個更加準確的估計量。理論上要求，如果再抽樣的次數趨向於正無窮，那麼最終估計量的精度應該和全樣本估計完全一致。這是一個重要的理論要求，它保證了人們採納的再抽樣方法（含抽樣方法以及計算方法）的大方向是正確的。但是，在實際工作中，顯然沒人希望做無窮多次再抽樣，那樣的計算成本豈不是無窮大！</p><p>那到底要多大的再抽樣樣本以及次數呢？給大家一個直觀的感受，請見圖1.2。這是基於我們開發的Python開源軟件包clubear的計算結果。在這裡，我們設定再抽樣的樣本量是n=10**4。這個樣本量應該越大越好，但是不能大到影響計算速度。一個簡單的規則是，在每次抽樣的時間不超過（例如）1秒的情況下，樣本量越大越好。我們這裡的初步測試結果顯示，n=10**4完全可以滿足這個結果，請注意這已經是一個不小的樣本量了。</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5351b42b539644f78ee2c0090cab1534><p class=pgc-img-caption></p></div><p><strong>圖1.2：基於clubear再抽樣算法獲得的均值估計</strong></p><p>請問如何確認再抽樣的次數呢？答：不需要確認。給一個相對大一點點的數字，讓程序跑去吧。很遺憾，紙面上沒法呈現clubear能帶給你的卓越體驗。因此，強烈建議你下載安裝該軟件包（linux終端命令：pip install clubear），然後測試一下。你會看到標準誤差SE，隨著再抽樣次數的增加，動態變化，並逐步降低。如果，人們認為10英里的精度就可以接受，那麼你會發現迭代次數niter=10是綽綽有餘的（對應的SE為：174.0/100=1.74）。最終獲得的均值估計是多少呢？答：701.45英里（見圖1.2）。這顯然是一個帶有再抽樣誤差的估計量，因為它跟全樣本計算結果701.4英里（見圖1.1）不一樣。但是，差多少呢？不到1英里。對於實際決策有影響嗎？我認為沒有。但是，獲得的體驗好太多。因為，整個計算過程只需要3.0秒。跟全樣本計算所需要的157秒（見圖1.1）相比，這是一個157/3大概50倍的改善。這樣的體驗是不是更好？當然，這樣體驗的獲得，是以精度的犧牲為代價的。相對於全樣本分析而言，再抽樣所產生的統計精度要差不小。但是，如圖1.2展示，這樣的精度可能對實際工作而言是完全足夠了。</p><p><br></p><p><strong>1.4、支撐再抽樣算法的核心理論</strong></p><p>通過上面的分享，我希望你能體驗到再抽樣算法帶給你的卓越體驗。面對一個沒法一次性讀入內存的大數據時，你不再恐懼害怕，取而代之的是很好的操控感，而如此卓越的操控感是以高效的再抽樣算法，以及相關的統計學理論為支撐的。本節將對相關的統計學理論做一個高度概括的討論。</p><p>請注意，任何一種統計分析本質上都是在計算各種統計量，並通過合理的圖表呈現出來。而這些統計量中，絕大多數都是矩估計（或它的等價量）。常見的統計量（例如：樣本均值、方差、最小二乘估計）都是矩估計。絕大多數模型的極大似然估計，也可以通過泰勒展開，被簡單的矩估計近似，並因此有了極限分佈理論。甚至，很多誕生於非光滑目標函數（例如：分位數迴歸）的估計量，其極限行為也可以被簡單的矩估計近似。因此，矩估計是研究理解很多複雜統計學方法的一個不錯起點，對於本文關注的再抽樣方法而言，也是這樣的。因此，接下來將通過一個簡單的、非線性的矩估計，說明再抽樣算法背後的統計學理論，並由此引申出關於再抽樣樣本量n和全樣本量N之間的互動關係。</p><p>假設全樣本為</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/00d88e4850934578b5289ed2c5a79a52><p class=pgc-img-caption></p></div><p>，其中N是全樣本的樣本量。對於航空數據而言，N大概就是1.2億，這是一個很大的數字。然後，通過合理的抽樣方法（例如：有放回簡單隨機抽樣），獲得了一個再抽樣樣本（subsample），記為</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/42ea61b2441f46d08ff9a5d708edf8be><p class=pgc-img-caption></p></div><p>，其中</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/bc24ff604ab045f484ca2b3fd5555ae4><p class=pgc-img-caption></p></div><p>標記的是第幾次再抽樣，假設每次再抽樣的樣本量為</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/6ee4f90eff71493ba541a7a988d5ce0f><p class=pgc-img-caption></p></div><p>。對於圖1.2展示的案例而言</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/139447573da94ef48f80029d63a86314><p class=pgc-img-caption></p></div><p>是1萬（10**4）。假設對於每個樣本</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/6c2e490051ae42cfb640d0d6ef045cf3><p class=pgc-img-caption></p></div><p>採集了一個變量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5b5d82b103aa4de39335465c9748813d><p class=pgc-img-caption></p></div><p>（例如：圖1.2中的Distance變量），該變量的均值為</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a387f033eda64323b414866c7e4ab771><p class=pgc-img-caption></p></div><p>。對於航空數據Distance而言，這可不是我們在圖1.1中看到的那個701.699。要知道701.699也是一個估計量（全樣本均值）的一個具體實現。而</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b3d47e71a92a423e94c209ec8cd09d21><p class=pgc-img-caption></p></div><p>是該統計量的期望（或者無窮次實現後的均值）。再假設，人們感興趣的參數是關於均值的一個非線性變換</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/58be5ec32c4c4541874634373c14a48d><p class=pgc-img-caption></p></div><p>，其中</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/200424225b954575ac37dbaf89ae61da><p class=pgc-img-caption></p></div><p>是一個已知的可微可導的函數。請問應該如何估計</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b8de3194a02f40749df66e6504af8b14><p class=pgc-img-caption></p></div><p>？如果可以對全樣本做便捷的計算，最簡單的估計量就是矩估計。具體而言，首先估計</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ba1ad16573f04957bd587a44a61dc37e><p class=pgc-img-caption></p></div><p>的樣本均值：</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0958de37c8a1446d94b700faa98a3f3e><p class=pgc-img-caption></p></div><p>=</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9c2f8cb544024288863171c90f43457b><p class=pgc-img-caption></p></div><p>（例如：圖1.1中的701.699），然後對</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b8de3194a02f40749df66e6504af8b14><p class=pgc-img-caption></p></div><p>產生一個矩估計為：</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7881f7dc0586494db258f9af6792a5e1><p class=pgc-img-caption></p></div><p>。在假設一切良好技術條件（例如：有限二階矩）成立的條件下，該矩估計可以通過下面的泰勒展開來近似：</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5594311802f343dba6cf94ca975f9ae7><p class=pgc-img-caption></p></div><p></p><p>其中</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c9468afcab2046ff981be0cd5716c8b5><p class=pgc-img-caption></p></div><p>和</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8bd5bff2d2b642d18d8946ad9a62c20e><p class=pgc-img-caption></p></div><p>分別是</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f6d9b45d66a947c2bb8029897f3ee28b><p class=pgc-img-caption></p></div><p>函數在</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ba1ad16573f04957bd587a44a61dc37e><p class=pgc-img-caption></p></div><p>這一點的一階導數和二階導數。請注意，約等號的左邊是矩估計，右邊第一項是目標參數</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b8de3194a02f40749df66e6504af8b14><p class=pgc-img-caption></p></div><p>，第二項是一箇中心化的樣本均值</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/cd68f770b1b0420f89f1385a8ee84f44><p class=pgc-img-caption></p></div><p>，當然前面還被乘以了一個係數</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c9468afcab2046ff981be0cd5716c8b5><p class=pgc-img-caption></p></div><p>。因此，第二項的均值為0，方差為</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d877acc9c3a14d518e81a6dc3adf0a81><p class=pgc-img-caption></p></div><p>，其中</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/3dad9be8d44e4508a6874ad19f07fb56><p class=pgc-img-caption></p></div><p>是</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/f84da1d4471949ca8189628a5777ab06><p class=pgc-img-caption></p></div><p>的方差。根據中心極限定律，該項的大樣本分佈應該接近正態。所有相關討論說明，該項的大小大概為</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/05c5560fede04f0ab6c87a3d1cc74e27><p class=pgc-img-caption></p></div><p>。而正是因為第二項的存在，成就了矩估計</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/a4e2809f396f4493b79def00b105339e><p class=pgc-img-caption></p></div><p>的極限正態性。值得重點討論一下的是約等號右面的第三項。如果忽略前面的常數</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1503479c9e8e4a8990068842148702fb><p class=pgc-img-caption></p></div><p>，那麼該項的大小主要受</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e16bc6a92cce420286ee37ce2f28f67d><p class=pgc-img-caption></p></div><p>影響。請注意這是一個非負的隨機變量，因此它的大小可以通過它的期望刻畫，即：</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/db02d3dad1344638948998ea5707ff5b><p class=pgc-img-caption></p></div><p>。這說明，該項的大小為</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e1f78e402f7e4922a999675d05ecb7a9><p class=pgc-img-caption></p></div><p>，這是一個比</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4fe04c09d1cc423c83ac99f129ad414d><p class=pgc-img-caption></p></div><p>要小很多的量。因此，第三項雖然存在，但是並不會影響矩估計</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0dd1203c1b4b4b24a3d51045d9409b58><p class=pgc-img-caption></p></div><p>的極限性質，因此在傳統的極限性質研究中都被忽略了。請注意，目前的討論都是基於全樣本</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/709416c2d5054d8aac84b53ea9cf0778><p class=pgc-img-caption></p></div><p>的。</p><p>接下來討論基於再抽樣子樣本（subsample）的計算。可以將上面的計算重複一遍，但是不是對全樣本</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8af00189cc684b32a3e6b7fc001824fb><p class=pgc-img-caption></p></div><p>，而是對再抽樣的子樣本</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3ea51a16c78f4151ac3b3f89d764571e><p class=pgc-img-caption></p></div><p>。例如，可以基於第</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ede6359a6a8349f4816fc03613a33503><p class=pgc-img-caption></p></div><p>個子樣本重新計算</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5e7d186680064ede80f9da031eccb0ff><p class=pgc-img-caption></p></div><p>如下：</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/02f8faae88e84a85a616194e22b7efbc><p class=pgc-img-caption></p></div><p>，並因此對目標參數</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e59954c35d8241c1bd632e7e4de8797f><p class=pgc-img-caption></p></div><p>計算矩估計為：</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1eed6c78c877425cab398162a27d161a><p class=pgc-img-caption></p></div><p>，其泰勒展開為：</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/943b8e13c6ad42b38a6cc96abd5fbc93><p class=pgc-img-caption></p></div><p></p><p>可以從理論上嚴格證明，之前關於</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e67e54b3bb964012915a0953d6ec4365><p class=pgc-img-caption></p></div><p>泰勒展開的所有討論對</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ca4dc633ddf44adb97e268b2be4dfa44><p class=pgc-img-caption></p></div><p>也都成立，唯一的區別是全樣本量N變成了子樣本量n。顯然，子樣本估計量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d3f1a239d6e948868552394ff46d9931><p class=pgc-img-caption></p></div><p>的精確度不如全樣本估計量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ceffc18fa31e478eb3890edb83bf477c><p class=pgc-img-caption></p></div><p>，因為它們的收斂速度不相同。為了彌補這個缺陷，可以將來自不同子樣本的估計量再做一個平均，整合獲得一個更優質的估計量如下：</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/73416f9cce8846c899dc42bca2ca57e0><p class=pgc-img-caption></p></div><p>關於該估計量，首先關注一下它的方差。主要由上式約等號右側的第二項決定。同單個的子樣本估計</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/e0b5b762d95249e689970f6eb0c4b0a8><p class=pgc-img-caption></p></div><p>相比，這部分的方差會變得更小。如果再抽樣的子樣本n比N小很多，而且</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/745b4372cb354776a47c4af3407ae608><p class=pgc-img-caption></p></div><p>不是很大，那麼不同的子樣本之間是幾乎獨立的。因此，被進一步平均後的估計量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4f3d7cba53c843348e22a040744acfbe><p class=pgc-img-caption></p></div><p>會隨著K的增加不斷變小。一般情況下，無論</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0e325c8c6bca4478a7a5a874b29e9013><p class=pgc-img-caption></p></div><p>多大，</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/dc7c8fc67b55497b90b71c54489178f5><p class=pgc-img-caption></p></div><p>的方差都不可能比全樣本估計量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a2728d2d43244368a61119e0296a7ebe><p class=pgc-img-caption></p></div><p>更小，因為後者可能是理論上的最優估計。但是，可以嚴格證明，只要</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2c863baebb994d3d86d55d957fbd7c9f><p class=pgc-img-caption></p></div><p>足夠大，再抽樣估計量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/476ce9b7cd02400a9fd47ab9c5867537><p class=pgc-img-caption></p></div><p>的方差可以無限逼近全樣本估計量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ebbd681eecc6434ead7a3e625dfdb33a><p class=pgc-img-caption></p></div><p>的方差。這說明什麼？這說明從方差的角度看，再抽樣估計可以做到與全樣本估計量無限接近的程度，這是一個優良的性質。</p><p>但是，決定一個估計量精度的不僅僅有方差，還有偏差。因此，我們還需要研究一下</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/476ce9b7cd02400a9fd47ab9c5867537><p class=pgc-img-caption></p></div><p>的期望同目標參數</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/acf70b79fe7f4ca19e540c2256f5ccfd><p class=pgc-img-caption></p></div><p>的關係。你會發現，這主要由</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/47a9809bfb5d41ed970b0514e062237f><p class=pgc-img-caption></p></div><p>泰勒展開中的第三項的期望決定，那就是：</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/d82d1e8bebf14b21b15b7441b606bb74><p class=pgc-img-caption></p></div><p></p><p>一個非常令人遺憾的現象發生了。再抽樣估計量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fb0e0d4597524cc08e3a1ca2a7a13acb><p class=pgc-img-caption></p></div><p>的偏差，跟再抽樣的次數</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a3655ef813c5420eab60a5aa7ce8d1dc><p class=pgc-img-caption></p></div><p>之間毫無關係，不會隨著再抽樣次數</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ba51d1f30e18467b8f09828388140060><p class=pgc-img-caption></p></div><p>的增加而減小。這個結果並不令人意外，因為在給定全樣本</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d118c7c785c0493d9611ae431b9f7894><p class=pgc-img-caption></p></div><p>的前提下，不同的子樣本</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/098b8db9ccb64fbabbfca040d0c15436><p class=pgc-img-caption></p></div><p>是獨立同分布生成的。那麼，它們所產生的子樣本估計量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7978bd042dea43e48a4393080cdb4125><p class=pgc-img-caption></p></div><p>是同分布的，共享相同的偏差。因此，最終平均後的偏差並不會隨著再抽樣次數</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8337bc69d31f4977829f9984953cc899><p class=pgc-img-caption></p></div><p>的增加而減小。這是一個令人感到遺憾的消息。</p><p>再仔細看一下，這個消息雖然不是啥好消息，但是也沒有糟糕透頂，為什麼？請注意最優估計量是全樣本估計量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8426bd8f7b5e4de6b08e65d05cc41b7e><p class=pgc-img-caption></p></div><p>，它的收斂速度是</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3ef534d817ab407480d6bec027c4d5b7><p class=pgc-img-caption></p></div><p>，而再抽樣估計量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/18270046aaf74c66a0c6a7235cd338fa><p class=pgc-img-caption></p></div><p>的偏差是</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/77477798fe654121bd0dbbf1e5b0da2e><p class=pgc-img-caption></p></div><p>。因此，只要再抽樣估計量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/110d1e8456b44c9597654e38edfd0d31><p class=pgc-img-caption></p></div><p>的偏差比全樣本估計量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2a7bc559188741d38dc927253b8d4ab7><p class=pgc-img-caption></p></div><p>的標準差小很多，那麼再抽樣所產生的的偏差就是可忽略的。這就要求再抽樣的樣本量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a246d3df1a984bb9bf92a45aaf11838e><p class=pgc-img-caption></p></div><p>最好要遠遠大於全樣本量開根號，即</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0a9f9dbd1a4349bd9482787bd9daabee><p class=pgc-img-caption></p></div><p>。這意味著什麼呢？如果全樣本量是</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/0da694fb7c2347cdb6e213f13996e4a0><p class=pgc-img-caption></p></div><p>=100萬，那麼只要再抽樣的子樣本量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d6711c0e492e4b0f878f93299ed7d404><p class=pgc-img-caption></p></div><p>遠遠大於1000，再賦予一個足夠大的</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8aa4ea612d6045b3a050a31ebd29e32b><p class=pgc-img-caption></p></div><p>，那麼再抽樣所產生的的估計量的精度可以非常逼近全樣本統計量的精度。如果全樣本量是</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/83d132e14599488e9b3cb8d984a0e6e6><p class=pgc-img-caption></p></div><p>=1億，那麼再抽樣的子樣本量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7cb770e4456543d9ba76b51673203571><p class=pgc-img-caption></p></div><p>最好要遠遠大於10000。請問這個要求高嗎？答：並不高，尤其考慮到計算機的性能還在不停的改進。</p><p>當然本節討論的是最簡單的估計量（矩估計），以及最簡單的子樣本估計量整合方法（簡單平均）。在實際工作中，我們可能會碰到更復雜的估計量以及更精心設計的整合方法，它們的統計學性質需要重新研究探討。但是有趣的是，在絕大多數常見情況下，這個關於</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3d2c07c4ac984c74a077d08a6ad703f6><p class=pgc-img-caption></p></div><p>和</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/6615ae3dd33a4cbfa988da56111bd762><p class=pgc-img-caption></p></div><p>的規律都是成立的。只要再抽樣的樣本量</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3d2c07c4ac984c74a077d08a6ad703f6><p class=pgc-img-caption></p></div><p>遠大於全樣本量開根號</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b9f179247927499e8659274b1bce37cf><p class=pgc-img-caption></p></div><p>，相關估計量的統計學性質可以無限接近全樣本的最優估計量。這就構成了再抽樣算法最核心的理論基礎。</p><p>但是，這裡需要再強調一點。上面的討論是關於再抽樣算法的理論性質。這些討論說明，再抽樣算法的大方向是正確的。而這些理論並不是要人們去追逐全樣本的精度。對此，前面一節已經做了非常詳細的討論。對於絕大多數實際分析問題，全樣本精度是沒必要追求的。而且，如果通過再抽樣算法獲得全樣本統計量一樣的精度，事實上付出的計算成本更高（因為這要不小的</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a808130b3b2040ff89064fadb14a70c6><p class=pgc-img-caption></p></div><p>，以及非常大的</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/af9ef8696b44421786406ce8f3823eec><p class=pgc-img-caption></p></div><p>）。因此，上面的討論僅僅是一個理論層面的討論。面對真實的數據分析，再抽樣算法的核心就是：犧牲不必要精度，節省寶貴時間。</p><p><br></p><p><strong>1.5再抽樣算法的建模框架</strong></p><p>在瞭解再抽樣算法的統計學理論基礎後，再討論一下建模分析的基本框架。為此，需要首先探討一下，大規模數據分析和傳統數據分析在計算體驗上的核心區別。</p><p>還是以航空數據為例。假設該數據的樣本量不大，只要1.2萬，因此可以被輕鬆讀入內存。讀入內存後你很快能獲得以下發現。第一、有的指標是定量的（例如：距離 Distance），而有的指標是定性的（例如：目標城市Dest）。第二、很多定量指標，有不少的缺失，或者不合理記錄。為此，你可能需要把這些數據清理掉。第三、你還可以發現很多數據的分佈是嚴重厚尾的（例如：延遲到達時間ArrDelay），其非中心化峰度（Kurtosis）可以高達20+，其簡單的直方圖如圖1.3所示。對於這樣的變量，你可能需要做一些必要的處理（例如：離散化），才能放心進入下一個分析流程。還有第四、第五，等等很多。當然，這都不是問題。畢竟樣本量很小，只有1.2萬。如此小樣本的數據就像一鍋水，體量太小了。你完全可以將其玩弄於股掌之間，反覆倒騰，直到把這一鍋水的所有問題全部解決掉，然後再下米做飯（建立模型）。對，這就是我們傳統的數據分析方法，非常便捷。</p><div class=pgc-img><img alt=基於再抽樣技術的交互式大數據分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b5a48a9b3069490aabe776481ac342ff><p class=pgc-img-caption></p></div><p><strong>圖1.3：基於再抽樣算法的直方圖</strong></p><p>但是，如果咱們將要處理的數據樣本量不是1.2萬，而是1.2億。你面對的問題不是一鍋水，而是一個大大的水池，湖泊，甚至。請問數據清理過程又該如何調整呢？是否還能直接跳到水裡，把整個水庫都清理乾淨？這是顯然不可能的，或者可能但是成本極其高昂。大家從圖1.1展示的案例就可以看到，像計算樣本均值這樣簡單的工作，所消耗的計算成本都是如此高昂，更何況那些更復雜並且數目眾多的數據清理操作。如此產生的時間成本太昂貴了，沒人能夠輕易承受。那應該怎麼辦呢？</p><p>面對這樣的問題，傳統的生活經驗會給我們很多智慧。第一個智慧，也是最大的智慧就是：懷疑！我們真的需要一水庫這麼大的數據量嗎？通過圖1.2所展示的實驗可以看到，答案是否定的。在絕大多數情況下，很可能一個池塘的水量就綽綽有餘了。因此，第二個智慧來了。與其跳進水庫去做清理工作（這是一個成本太高，甚至壓根不可能的工作），不如在水庫邊上架設一個水泵（pump），根據需求量往外抽水。抽出來的水暫時存儲在一個蓄水池（tank）裡，作進一步加工處理。加工後的水，再做最後輸出。因此，人們不需要對整個水庫的水操心，但是需要精心設置水泵和蓄水池的各種參數。例如，應該對水泵的抽水量（subsample size）有一個合理設定。太大的抽水量會消耗太多時間，但是太小有可能達不到需要的精度，因此需要設置一個合理的抽水量。把抽出來的水暫時儲存在一個蓄水池裡。然後對蓄水池的水，做各種消毒措施（例如：清理異常值，產生新變量等），最後保證從蓄水池出來的水可以放心做飯，用於建模（model）。</p><p>你看，這就是我們再抽樣方法建模的基本框架。分為三個環節：抽水（pump），蓄水（tank），做飯（model）。這三個階段分別對應了clubear開源Python包的三個class：pump，tank，以及model。請你一定要深刻理解，這樣有助於後面的代碼學習。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>抽樣</a></li><li><a>技術</a></li><li><a>大數據</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/ba69be51.html alt=大數據分析主要有哪些技術 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/577b5f4322d74f36bc6561d31c2464fc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ba69be51.html title=大數據分析主要有哪些技術>大數據分析主要有哪些技術</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/659864ae.html alt=大數據分析必備的6個核心技術 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/708ece4f-cd28-4374-8d30-23c3dba10f26 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/659864ae.html title=大數據分析必備的6個核心技術>大數據分析必備的6個核心技術</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/814df086.html alt=大數據系統及分析技術 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f24ed9184a734eba9b8369c4a24a4d8c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/814df086.html title=大數據系統及分析技術>大數據系統及分析技術</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/93727dba.html alt="技術帖 | 3分鐘搞定各種測試分析技術" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/f055e0a4477240088de2abb7cd696cfa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/93727dba.html title="技術帖 | 3分鐘搞定各種測試分析技術">技術帖 | 3分鐘搞定各種測試分析技術</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2d0ddee5.html alt=建築房屋結構平衡技術要求，你都會知道嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/5e7d0001715d878ed66c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2d0ddee5.html title=建築房屋結構平衡技術要求，你都會知道嗎？>建築房屋結構平衡技術要求，你都會知道嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/47c8cac0.html alt=新《裝配式混凝土建築技術標準》有哪些改變？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1540524372015dc56ec3fb9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/47c8cac0.html title=新《裝配式混凝土建築技術標準》有哪些改變？>新《裝配式混凝土建築技術標準》有哪些改變？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b6c2fc2b.html alt=鈦合金精密鑄造技術發展現狀 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/SCynkUUBbHN8CF style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b6c2fc2b.html title=鈦合金精密鑄造技術發展現狀>鈦合金精密鑄造技術發展現狀</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d2e8af08.html alt=傾斜航攝技術小知識——航線設計篇 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RS1ucOiDvLRlVt style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d2e8af08.html title=傾斜航攝技術小知識——航線設計篇>傾斜航攝技術小知識——航線設計篇</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d597da51.html alt=黃河電力技術公司在龍羊峽進行無人機傾斜攝影測量 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1528429551298e033646798 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d597da51.html title=黃河電力技術公司在龍羊峽進行無人機傾斜攝影測量>黃河電力技術公司在龍羊峽進行無人機傾斜攝影測量</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cdb604f6.html alt=《雷神4：愛與雷》將採用“虛擬製作”技術 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/83a320a69b0f44e3baf7db07faac3c65 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cdb604f6.html title=《雷神4：愛與雷》將採用“虛擬製作”技術>《雷神4：愛與雷》將採用“虛擬製作”技術</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c08f7fcf.html alt=寶信軟件：公司聚焦大數據、人工智能、虛擬製造等七大關鍵技術的研究 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c08f7fcf.html title=寶信軟件：公司聚焦大數據、人工智能、虛擬製造等七大關鍵技術的研究>寶信軟件：公司聚焦大數據、人工智能、虛擬製造等七大關鍵技術的研究</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1cd5b6b6.html alt=虛擬現實技術在智能製造領域具有重要的應用價值 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3ed327880d3b4c5384619f21d6c81823 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1cd5b6b6.html title=虛擬現實技術在智能製造領域具有重要的應用價值>虛擬現實技術在智能製造領域具有重要的應用價值</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3a2b0c81.html alt="虛擬製造的基石：數值模擬技術 | 加快實現工業數字化" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/2f2c32f4bd734f9face045546d45a665 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3a2b0c81.html title="虛擬製造的基石：數值模擬技術 | 加快實現工業數字化">虛擬製造的基石：數值模擬技術 | 加快實現工業數字化</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ee69f5ac.html alt=基於機器視覺技術快速準確地確定收穫後幹大豆種子的品質 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/519b968bf69146fda9bf55f89779d373 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ee69f5ac.html title=基於機器視覺技術快速準確地確定收穫後幹大豆種子的品質>基於機器視覺技術快速準確地確定收穫後幹大豆種子的品質</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e203d547.html alt=和你一起的軍訓，下雨也甜蜜｜四川託普信息技術職業學院軍訓記 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/4cd61c2a490f48ebb0aa74d30ec8766b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e203d547.html title=和你一起的軍訓，下雨也甜蜜｜四川託普信息技術職業學院軍訓記>和你一起的軍訓，下雨也甜蜜｜四川託普信息技術職業學院軍訓記</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>