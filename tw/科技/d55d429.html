<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>當Excel公式參數動態變化時，怎樣改造公式，讓公式可以隨意填充 | 极客快訊</title><meta property="og:title" content="當Excel公式參數動態變化時，怎樣改造公式，讓公式可以隨意填充 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/b4bc75f5344c482bb7e47e08f7197df0"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d55d429.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d55d429.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d55d429.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d55d429.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d55d429.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d55d429.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d55d429.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d55d429.html><meta property="article:published_time" content="2020-10-29T20:58:17+08:00"><meta property="article:modified_time" content="2020-10-29T20:58:17+08:00"><meta name=Keywords content><meta name=description content="當Excel公式參數動態變化時，怎樣改造公式，讓公式可以隨意填充"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/d55d429.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>當Excel公式參數動態變化時，怎樣改造公式，讓公式可以隨意填充</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>這篇文章的中心有兩個：</p><ul><li><strong>當公式參數動態變化時，怎樣將功能單一的公式變成可以橫向/縱向隨意填充的公式。</strong></li><li><strong>如何實現批量線性計算</strong>。</li></ul><p>除此之外，你將會對絕對引用和相對引用有更深的認識。</p><p>如圖，左側是原始數據表，當你修改綠色部分的x、y值時，公式計算的結果會自動更新，你還可以橫向\縱向隨意拖拉公式。</p><div class=pgc-img><img alt=當Excel公式參數動態變化時，怎樣改造公式，讓公式可以隨意填充 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b4bc75f5344c482bb7e47e08f7197df0><p class=pgc-img-caption></p></div><p>不瞭解線性內插值的朋友，可以先閱讀以下文章，這樣對閱讀本文會有所幫助。</p><p>《<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6675925523555680775/?group_id=6675925523555680775" target=_blank>促銷物品價格怎麼定？我用Excel一維線性插值和二維線性插值</a>》。</p><p>當然，如果你對線性內插值不感興趣的話，也可以忽略上面的文章，閱讀以下內容時，只看重<strong>如何讓公式變得更強大</strong>即可。</p><h1><strong>一維線性內插值</strong></h1><p><strong>步驟① 分析單一的函數和需求。</strong></p><p>再回憶一下一維線性內插值函數TREND的用法：“=TREND(已知相鄰y值,已知相鄰x值,新x值)”。</p><p>所以，當要計算的x值變化時，“相鄰y值”和“相鄰x值”也會跟著變化。</p><div class=pgc-img><img alt=當Excel公式參數動態變化時，怎樣改造公式，讓公式可以隨意填充 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4bf9bb8c1c4542ed99700635a8435f06><p class=pgc-img-caption></p></div><p>所以，當你遇到像這樣公式參數會動態變化時，就需要改造一下公式，使得公式更加智能。</p><p><strong>步驟② 逐一分析函數參數，修改參數。</strong></p><p>TREND函數3個參數，最後一個參數固定在D4單元格，所以不需要修改它。</p><p>前兩個參數和最後一個參數相關，它們取得是最後一個參數相鄰處的x、y值，所以可以使用OFFSET函數獲得它們。</p><pre>已知相鄰x值：=OFFSET(B$1,MATCH(D4,A$2:A$188),,2)已知相鄰y值：=OFFSET(A$1,MATCH(D4,A$2:A$188),,2)</pre><div class=pgc-img><img alt=當Excel公式參數動態變化時，怎樣改造公式，讓公式可以隨意填充 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/070b33f3d5054ad2a497cc36ef178e96><p class=pgc-img-caption></p></div><p>這樣，我們就用兩個OFFSET函數替換掉TREND函數的前兩個參數。公式變長了，但也更智能了。</p><p><strong>③ 你可以隨意修改x值，它會自動找出相鄰的x、y值，並且計算出結果。</strong></p><div class=pgc-img><img alt=當Excel公式參數動態變化時，怎樣改造公式，讓公式可以隨意填充 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9871f7083b9c49ed9c711605852bf0cb><p class=pgc-img-caption></p></div><p><strong>④ 你也可以向下批量填充公式。</strong></p><div class=pgc-img><img alt=當Excel公式參數動態變化時，怎樣改造公式，讓公式可以隨意填充 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a2367fa731114fae8367c4b3e5d19bac><p class=pgc-img-caption></p></div><p>這就實現了批量一維線性內插值計算。</p><h1><strong>二維線性內插值</strong></h1><p>二維線性內插值可以拆分成橫向一維內插值和縱向一維內插值。</p><p>前面我們已經寫出了一維線性內插值公式，它可以讓你批量向下填充。怎樣讓它可以向右填充呢？</p><p><strong>步驟① 找出公式中有幾個單元格引用，逐一修改它們的引用類型。</strong></p><div class=pgc-img><img alt=當Excel公式參數動態變化時，怎樣改造公式，讓公式可以隨意填充 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/909a1b2d41494db2b26b53a51b88885b><p class=pgc-img-caption></p></div><p>如上圖所示，TREND公式中有G4、B$1、A$1、A$2:A$188。</p><ul><li>G4單元格表示要計算的x值，公式向下填充時，x值逐行發生變化，而向右填充時，則維持不變，所以，需將公式中的G4必須變成$G4。</li></ul><div class=pgc-img><img alt=當Excel公式參數動態變化時，怎樣改造公式，讓公式可以隨意填充 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/7ceb2d5e322647d2a79a397fb0611ab4><p class=pgc-img-caption></p></div><ul><li>B$1在公式“OFFSET(B$1,MATCH(D4,A$2:A$188),,2)”中，它是我們查找第幾列的基準點。公式向下填充時，要查找的y值始終都在同一列，而向右填充時，y值的列號就要發生變化。所以 B$1的引用類型不必修改。</li><li>A$1在公式“OFFSET(A$1,MATCH(D4,A$2:A$188),,2)”中，它是我們查找第幾行數據的基準點，不管向下還是向右填充，都不變。所以，需將它修改成$A$1。</li></ul><div class=pgc-img><img alt=當Excel公式參數動態變化時，怎樣改造公式，讓公式可以隨意填充 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ce764949e1bc40babc42f77ebb813a2b><p class=pgc-img-caption></p></div><ul><li>同理，A$2:A$188需修改成$A$2:$A$188。</li></ul><p>這樣的公式，既可以向下填充，也可以向右填充。</p><div class=pgc-img><img alt=當Excel公式參數動態變化時，怎樣改造公式，讓公式可以隨意填充 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/9b0acd31613044ddbd22ee195ec135b5><p class=pgc-img-caption></p></div><p><strong>步驟②：按照前面的方法，寫出縱向線性插值計算公式。</strong></p><div class=pgc-img><img alt=當Excel公式參數動態變化時，怎樣改造公式，讓公式可以隨意填充 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/978acc93e9954cb2b0184a2857f354ea><p class=pgc-img-caption></p></div><p>注意，我們在寫縱向插值公式時，以橫向插值公式的結果作為基礎數據表。這樣縱向插值計算結果就是我們想要的二維線性插值結果啦。</p><p><strong>步驟③ ：拖動填充公式。</strong></p><p>填寫好x、y值後，拖動公式即可獲得二維線性插值結果。</p><div class=pgc-img><img alt=當Excel公式參數動態變化時，怎樣改造公式，讓公式可以隨意填充 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/80f588d32ede4271ac380db3c83aa87b><p class=pgc-img-caption></p></div><h1><strong>建議</strong></h1><p>① 如果你的原始數據比較多，建議將橫向和縱向插值表剪切到單獨的工作表中。如果你常常需要線性內插值，我建議你花點時間做一個這樣的表格，這以後，每次就只要修改原始數據表，以及要計算的x、y值即可輕鬆獲得結果。</p><p>② 不建議你將橫向和縱向公式整合成一個公式，雖然網上有人這樣做。但是這樣公式就會變得超長，而且難以理解，不利於長期維護。</p><p><strong>相關閱讀：《<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6587181798298485252/?group_id=6587181798298485252" target=_blank>WPS Excel 獲取動態數據函數offset的基本用法</a>》、《<a class=pgc-link data-content=mp href="https://www.toutiao.com/i6589127687300710926/?group_id=6589127687300710926" target=_blank>WPS Excel：如何比較兩列數據（match函數法）</a>》。</strong></p><hr><p>學習，為了更好的生活。歡迎點贊、評論、關注和點擊頭像。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>公式</a></li><li><a>Excel</a></li><li><a>參數</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/e684bf8f.html alt=Excel表格內容合併公式（辦公常用公式） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f0ee1807cfdb4d10950075add2f311df style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e684bf8f.html title=Excel表格內容合併公式（辦公常用公式）>Excel表格內容合併公式（辦公常用公式）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0632295.html alt="Excel 正序、逆序編號，這到底是普通公式還是數組公式？" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ab5066bc5aad46c8a65c0f3fc9c84484 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0632295.html title="Excel 正序、逆序編號，這到底是普通公式還是數組公式？">Excel 正序、逆序編號，這到底是普通公式還是數組公式？</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/cb5afa2.html alt=Excel函數公式：用Excel製作抽獎器，你會嗎 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p1.pstatp.com/large/5b570003a86a49664f86 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/cb5afa2.html title=Excel函數公式：用Excel製作抽獎器，你會嗎>Excel函數公式：用Excel製作抽獎器，你會嗎</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/25bebf48.html alt=關於齒輪的參數及計算公式大全 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/54cfb37ea965443daf82a218b503ddbc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/25bebf48.html title=關於齒輪的參數及計算公式大全>關於齒輪的參數及計算公式大全</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0e83a16d.html alt=聚四氟乙烯材料如何合理選取切削參數？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0e83a16d.html title=聚四氟乙烯材料如何合理選取切削參數？>聚四氟乙烯材料如何合理選取切削參數？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9037b10c.html alt=Excel多條件計數技巧，返回多個符合條件的值，批量操作超輕鬆 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0fbbe87710244f2dbb62f8ac2dfbf5f6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9037b10c.html title=Excel多條件計數技巧，返回多個符合條件的值，批量操作超輕鬆>Excel多條件計數技巧，返回多個符合條件的值，批量操作超輕鬆</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4ea3618a.html alt="Excel萬金油套路詳解 單條件查找返回多行數據" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2633664673fd439a862a2527763e82c7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4ea3618a.html title="Excel萬金油套路詳解 單條件查找返回多行數據">Excel萬金油套路詳解 單條件查找返回多行數據</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/32e171a3.html alt=5個必須學會的Excel求和公式，可直接套用，省時省力！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1535450928204b2d8afb96c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/32e171a3.html title=5個必須學會的Excel求和公式，可直接套用，省時省力！>5個必須學會的Excel求和公式，可直接套用，省時省力！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a9c3cd10.html alt="6個最快的 Excel表格求和 方法" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ed973ea536f34ff38b17ba457fd16350 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a9c3cd10.html title="6個最快的 Excel表格求和 方法">6個最快的 Excel表格求和 方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3366e549.html alt=Excel中求合計，求小計原來有這麼簡單易學的方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/6c819460f0c740a8b28e1fac92132b52 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3366e549.html title=Excel中求合計，求小計原來有這麼簡單易學的方法>Excel中求合計，求小計原來有這麼簡單易學的方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/30e1a9cb.html alt=Excel中，如何統計列數呢？一個設置搞定 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1521683037053abb4c6de06 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/30e1a9cb.html title=Excel中，如何統計列數呢？一個設置搞定>Excel中，如何統計列數呢？一個設置搞定</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/accc98e1.html alt=Excel合併單元格彙總求和、計數，一個公式搞定，直接套用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/c9d2e965-4179-4b0a-aace-c6de13b42ebe style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/accc98e1.html title=Excel合併單元格彙總求和、計數，一個公式搞定，直接套用>Excel合併單元格彙總求和、計數，一個公式搞定，直接套用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d1ac3026.html alt=Excel多行、多列、多條件不能求和？兩個方法任君選擇 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/cfc5688b1dea4ca483e92f15d39644f7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d1ac3026.html title=Excel多行、多列、多條件不能求和？兩個方法任君選擇>Excel多行、多列、多條件不能求和？兩個方法任君選擇</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/43a11efd.html alt=Excel如何隔列求和？3分鐘就能夠學會的超簡單方法教給你 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f5f148e9f2664611a438c6444c0a65ae style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/43a11efd.html title=Excel如何隔列求和？3分鐘就能夠學會的超簡單方法教給你>Excel如何隔列求和？3分鐘就能夠學會的超簡單方法教給你</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9ea976e7.html alt=Excel小技巧：多行多列快速求和，這招你得會！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/66a70002b0d930dae28c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9ea976e7.html title=Excel小技巧：多行多列快速求和，這招你得會！>Excel小技巧：多行多列快速求和，這招你得會！</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>