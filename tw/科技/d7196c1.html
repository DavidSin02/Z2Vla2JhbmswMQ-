<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ | æå®¢å¿«è¨Š</title><meta property="og:title" content="æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/6ee200033390f3f6b2ca"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d7196c1.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d7196c1.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d7196c1.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d7196c1.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d7196c1.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d7196c1.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/d7196c1.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/d7196c1.html><meta property="article:published_time" content="2020-10-29T21:05:34+08:00"><meta property="article:modified_time" content="2020-10-29T21:05:34+08:00"><meta name=Keywords content><meta name=description content="æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/d7196c1.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><h1>å…§å®¹å°è®€</h1><blockquote><p>MNISTåªåŒ…å«70000å¼µ28x28åƒç´ çš„æ‰‹å¯«æ•¸å­—çš„å–®é€šé“ç°åº¦åœ–ï¼Œå°æ–¼ç¾åœ¨çš„ç®—åŠ›ä¾†èªªæ˜¯å¾ˆå°çš„æ•¸æ“šã€‚æˆ‘å®šç¾©ä¸€å€‹æ¨¡å‹è¨“ç·´å‡½æ•¸ï¼Œç›®æ¨™æ˜¯ä¸æ–·å„ªåŒ–æ¬Šé‡å’Œåå·®å¾—åˆ°æœ€ä½³çµ„åˆã€‚ç¾åœ¨è¼¸å…¥å±¤åˆ°éš±è—å±¤æˆ‘é¸æ“‡äº†ReLuä½œç‚ºæ¿€æ´»å‡½æ•¸ï¼Œå¾åœ–å½¢ä¸­çœ‹å‡ºå®ƒå…·å‚™å·¦å´ç¡¬é£½å’Œçš„ç‰¹æ€§ã€‚æ¥ä¸‹ä¾†è‡ªç„¶å°±æœƒæ€è€ƒï¼Œæ¬Šé‡å’Œåå·®å¦‚ä½•è¿­ä»£å„ªåŒ–å‘¢? é¦–å…ˆæ­£å‘å‚³æ’­è¨ˆç®—å‡ºoutput_layerç¯€é»ï¼Œç”¨æå¤±å‡½æ•¸è¨ˆç®—ä¸€ä¸‹å’Œæ¨™è¨»yçš„å·®è·ï¼Œæ ¹æ“šæå¤±å¤§å°è¿”å›ä¾†ä¿®æ­£æ¬Šé‡å’Œåå·®ï¼Œé€™å€‹é€šééˆå¼æ³•å‰‡å°å¤šå±¤è¤‡åˆå‡½æ•¸æ±‚å°çš„éç¨‹å°±æ˜¯åå‘å‚³æ’­ï¼Œå…¶ç›®æ¨™å°±æ˜¯è¦æœ€å°åŒ–è¨“ç·´é›†ä¸Šçš„ç´¯ç©èª¤å·®ã€‚ç¬¬äºŒç¨®æ–¹å¼æ˜¯æ¯è·‘è¨“ç·´é›†ä¸­çš„ä¸€æ¢æ•¸æ“šå°±è¨ˆç®—æå¤±å‡½æ•¸ä¸¦æ›´æ–°åƒæ•¸ï¼Œé€Ÿåº¦æ¯”è¼ƒå¿«ï¼Œä½†æ”¶æ–‚æ€§ä¸å¤ªå¥½ï¼Œå¯èƒ½æœƒå‡ºç¾è¼ƒå¤šæ¯›åˆºåœ¨æœ€å„ªé»é™„è¿‘æ–æ“ºã€‚å®Œæˆæ¨¡å‹è¨“ç·´ä»£ç¢¼å¾Œå¯ä»¥å†å®šç¾©ä¸€å€‹äº¤å‰ç†µæå¤±å‡½æ•¸ä¾†è§€å¯Ÿæ”¶æ–‚æ•ˆæœï¼Œè¿­ä»£åˆ°ä¸‰äº”åƒæ¬¡çš„æ™‚å€™å…¶å¯¦å·²ç¶“å·®ä¸å¤šäº†ï¼Œå¾Œé¢çš„å¹¾è¬æ¬¡å­¸ç¿’ä¾ç„¶æœƒä¸æ™‚å‡ºç¾ä¸€äº›æ¯›åˆºå½±éŸ¿æº–ç¢ºç‡ã€‚</p></blockquote><p>MNISTå°±æ˜¯æ©Ÿå™¨å­¸ç¿’çš„Hello World, æˆ–è€…èªªåœ–ç‰‡è™•ç†çš„Lena, æ˜¯å¿…ä¸å¯å°‘çš„ç¶“å…¸åˆé«”é©—ã€‚å®ƒå·²æœ‰20å¤šå¹´çš„æ­·å²ï¼Œä½†æ˜¯åˆ°ä»Šå¤©ä¾ç„¶é­…åŠ›ä¸æ¸›ï¼Œä¾ç„¶æ˜¯æœ€é«˜å¼•ç”¨çš„æ•¸æ“šé›†ã€‚MNISTåªåŒ…å«70000å¼µ28x28åƒç´ çš„æ‰‹å¯«æ•¸å­—çš„å–®é€šé“ç°åº¦åœ–ï¼Œå°æ–¼ç¾åœ¨çš„ç®—åŠ›ä¾†èªªæ˜¯å¾ˆå°çš„æ•¸æ“šã€‚</p><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6ee200033390f3f6b2ca></p><p>Denise Krebs on Flickr</p><p>ç¶²ä¸Šå¤§å¤šæ•¸çš„MNISTæ•™ç¨‹ï¼ŒåŒ…æ‹¬TensorfFlowå®˜æ–¹æ•™ç¨‹å¸¶çµ¦æˆ‘å€‘çš„éƒ½æ˜¯ä¸€ç¨®è‡ªç„¶ä¸»ç¾©çš„å­¸ç¿’é«”é©—ï¼Œçµ¦å‡ºä»£ç¢¼ç¤ºä¾‹ç°¡å–®æ•™æœƒæ­¥é©Ÿï¼Œå°è‘—ä»£ç¢¼æ•²ä¸€ä¸‹å°±èƒ½é‹è¡Œï¼Œç•¢ç«Ÿåƒèˆ‡æ„Ÿä¸å¤ ã€‚å¾çµæ§‹ä¸»ç¾©çš„å­¸ç¿’æ–¹å¼ä¾†çœ‹ï¼Œæˆ‘å€‘æ‡‰è©²è‡³å°‘å˜—è©¦ä¸€æ¬¡ä¸ç”¨ä»»ä½•æ·±åº¦å­¸ç¿’çš„ç¾æˆæ¡†æ¶ï¼Œç´”æ‰‹å·¥å¾é›¶é–‹å§‹å¯¦ç¾ä¸€æ¬¡ç¥ç¶“ç¶²çµ¡ï¼Œä¸¦ä¸”æ‰“é–‹å…¶ä¸­çš„é»‘ç›’ï¼Œä»¥å¯è¦–åŒ–çš„å‘ˆç¾æ–¹å¼å½¢è±¡ç†è§£ç¥ç¶“ç¶²çµ¡å¦‚ä½•å·¥ä½œï¼Œé€™å°±æ˜¯æˆ‘å¯«æ­¤æ–‡çš„ç›®çš„ã€‚</p><p><strong>æ•¸æ“šæº–å‚™ (Data Preparation)</strong></p><p>MNISTæ•¸æ“šé›†ä¸­Train datasetæœ‰60000å¼µåœ–ç‰‡èˆ‡ç›¸æ‡‰çš„æ¨™è¨»ï¼Œå…¶ä¸­55000å¼µè¨“ç·´é›†ï¼Œ5000å¼µé©—è­‰é›†(Validation)ï¼ŒTest datasetæœ‰10000å¼µè¨“ç·´é›†ï¼Œä¸‹è¼‰å®Œé€™å››å€‹æ–‡ä»¶å¾Œæˆ‘ä¿å­˜åˆ°MNIST-dataç›®éŒ„ä¸‹ã€‚</p><blockquote><p>train-images-idx3-ubyte.gz: training set images (9912422 bytes)<br>train-labels-idx1-ubyte.gz: training set labels (28881 bytes)<br>t10k-images-idx3-ubyte.gz: test set images (1648877 bytes)<br>t10k-labels-idx1-ubyte.gz: test set labels (4542 bytes)</p></blockquote><p>æ•¸æ“šé›†å°±æ˜¯é€™éº¼å››å€‹æ–‡ä»¶ï¼Œéƒ½æ˜¯ç‰¹æ®Šçš„Binaryæ ¼å¼ã€‚è§£æèµ·ä¾†è²»é»åŠŸå¤«ï¼Œä¸éTensorFlowå·²å°è£å¥½äº†ä¾¿åˆ©çš„æ¥å£ - input_data.read_data_setsã€‚é›–ç„¶é€™æ¬¡æˆ‘ä¸ç”¨TensorFlowæ¡†æ¶çš„ç¥ç¶“ç¶²çµ¡ï¼Œä½†æ˜¯è§£ææ•¸æ“šéƒ¨åˆ†å€Ÿç”¨ä¸€ä¸‹ç„¡å¦¨ã€‚é€™å€‹å‡½æ•¸æœƒè‡ªå‹•å˜—è©¦ä¸‹è¼‰æ•¸æ“šé›†åˆ°æŒ‡å®šç›®éŒ„ä¸­ï¼Œä¸éå¼·çƒˆå»ºè­°è‡ªå·±æ‰‹å·¥ä¸‹è¼‰å¥½é€™å››å€‹æ–‡ä»¶ï¼Œç”±æ–¼ä¸å¯æè¿°çš„åŸå› ï¼Œç”¨é€™å€‹æ–¹æ³•ç›´æ¥ä¸‹è¼‰æ•¸æ“šåŸºæœ¬éƒ½æ˜¯ä»¥time outå¤±æ•—å‘Šçµ‚ã€‚ç¬¬ä¸€å€‹åƒæ•¸æ˜¯æŒ‡å®šçš„æ•¸æ“šé›†å­˜æ”¾è·¯å¾‘ï¼Œç¬¬äºŒå€‹åƒæ•¸æ±ºå®šæ˜¯å¦ä»¥ç¨ç†±éµ(one-hot)å½¢å¼è®€å–æ¨™ç±¤ï¼Œå¦‚æœè¨­ç‚ºTrueå‰‡ä»¥10ç¶­å‘é‡å½¢å¼ä»£è¡¨ä¸€å€‹æ•¸å­—ã€‚</p><blockquote><p>mndata = input_data.read_data_sets("MNIST-data/", one_hot=True)</p></blockquote><p>åˆ†åˆ¥ç²å–è¨“ç·´é›†å’Œæ¸¬è©¦é›†çš„åœ–ç‰‡å’Œæ¨™è¨»</p><blockquote><p>X_train=mndata.train.images # training set<br>y_train=mndata.train.labels<br>X_test=mndata.test.images # testing set<br>y_test=mndata.test.labels</p></blockquote><p>ç„¶å¾Œå¯«ä¸€å€‹ç•«åœ–çš„å‡½æ•¸ï¼Œè®€å–çŸ©é™£æ•¸æ“šåœ¨è¡¨æ ¼ä¸­å±•ç¤ºï¼Œåƒ…å±•ç¤ºé0æ•¸å­—ä¸”ä¿ç•™å…©ä½å°æ•¸ã€‚</p><blockquote><p># visualize grid data of a matrix, zero cell shown as empty<br>def plt_grid(data):<br>fig, ax = plt.subplots()<br>fig.set_size_inches(30,30)<br>width, height = data.shape</p><p>#imshow portion<br>imshow_data = np.random.rand(width, height)<br>ax.imshow(imshow_data, cmap=plt.cm.Pastel1, interpolation='nearest')</p><p>for x in range(0, height):<br>for y in range(0, width):<br>if (data[y][x]>0):<br>ax.text(x, y, np.round(data[y][x],2), va='center', ha='center', fontsize=20)<br>plt.show()</p></blockquote><p>éš¨ä¾¿æ‰¾å€‹å‰åˆ©æ•¸å­—88ä½œç‚ºindex, å¾è¨“ç·´é›†ä¸­æŠ½ä¸€å¼µåœ–ç‰‡æ‰“å°åŸå§‹æ•¸æ“šçœ‹çœ‹é€™å€‹28x28çš„çŸ©é™£è£¡åˆ°åº•å­˜æ”¾äº†ä»€éº¼</p><blockquote><p>plt_grid(X_train[88].reshape(28,28))</p></blockquote><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6ee60001d25df9767538></p><p>æ•¸å­—3</p><p>é0çš„æ•¸å€¼æœ¬èº«å°±å·²ç¶“èƒ½çœ‹åˆ°æ•¸å­—çš„å½¢ç‹€äº†ï¼Œæ˜¯å€‹3. æ•¸å€¼è¶Šæ¥è¿‘1è¡¨ç¤ºé¡è‰²è¶Šç™½ï¼Œé‚Šç·£çš„é¡è‰²æ‡‰è©²æ˜¯æ¯”è¼ƒç°çš„ï¼Œè€ŒèƒŒæ™¯æ•¸å€¼ç‚º0è‡ªç„¶å°±æ˜¯é»‘è‰²ã€‚</p><p>æ‰“å°ç›¸æ‡‰çš„æ¨™ç±¤å‡ºä¾†ä¹Ÿæ˜¯3: [ 0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]</p><p>ä¸‹é¢æˆ‘å†ç›´æ¥æŠŠåœ–ç‰‡æŠ½å‡ºä¾†æ‰“å°å°æ¯”ä¸€ä¸‹ï¼Œæœä¸å…¶ç„¶, å’Œä¸Šåœ–é•·çš„ä¸€æ¨¡ä¸€æ¨£ã€‚</p><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6ee60001d25e98f04787></p><p><strong>ç¶²çµ¡æ¶æ§‹ (Network Layouts)</strong></p><p>æ•¸æ“šæº–å‚™å¥½å¾Œå°±é–‹å§‹è¨­è¨ˆç¥ç¶“ç¶²çµ¡äº†, ç°¡å–®ä¸€é»å°±ä¸‰å±¤: input layer, hidden layer, output layer</p><p>input layer(è¼¸å…¥å±¤)çš„ç¯€é»å°±æ˜¯è¦é¤µçµ¦ç¥ç¶“ç¶²çµ¡çš„åƒç´ å€¼ï¼Œå…±784å€‹ç¯€é»ã€‚</p><p>hidden layer(éš±è—å±¤)å¯ä»¥è®“ç¶²çµ¡åœ¨æŠ½è±¡å±¤æ¬¡ä¸Šå­¸ç¿’ç‰¹å¾µï¼Œé›–ç„¶æˆ‘åªæ”¾ä¸€å±¤ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æœ‰å¤šå±¤ã€‚å°‘é‡éš±è—å±¤æœƒå¾—åˆ°æ·ºå±¤ç¥ç¶“ç¶²çµ¡SNNï¼Œéš±è—å±¤å¾ˆå¤šæ™‚å°±æ˜¯æ·±å±¤ç¥ç¶“ç¶²çµ¡DNNã€‚ç†è«–ä¸Šï¼Œå–®éš±è—å±¤ç¥ç¶“ç¶²çµ¡ä¹Ÿå¯ä»¥é€¼è¿‘ä»»ä½•é€£çºŒå‡½æ•¸ï¼Œåªè¦ç¥ç¶“å…ƒæ•¸é‡å¤ å¤šã€‚å¦‚æœå¢åŠ éš±è—å±¤æˆ–è€…éš±è—å±¤ç¥ç¶“å…ƒçš„æ•¸é‡ï¼Œç¥ç¶“ç¶²çµ¡çš„å®¹é‡æœƒè®Šå¤§ï¼Œç©ºé–“è¡¨é”èƒ½åŠ›æœƒè®Šå¼·ï¼Œä½†å¦‚æœå¤ªå¤šçš„è©±ä¹Ÿå®¹æ˜“éæ“¬åˆã€‚å…ˆæš«å®š15å€‹ç¯€é»å§ã€‚</p><p>output layer(è¼¸å‡ºå±¤)æœ‰10å€‹ç¯€é»ï¼Œå› ç‚ºåœ–ç‰‡è¦åˆ†é¡æ˜ å°„åˆ°åå€‹æ•¸å­—ä¸Šã€‚</p><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/6ee50002bef9200dccef></p><p>Neural Network and Deep Learning</p><p><strong>æ¬Šé‡å’Œåå·® (Weights and Bias)</strong></p><p>ä¸Šåœ–ä¸­å…©å€‹ç¥ç¶“å…ƒä¹‹é–“çš„æ¯ä¸€æ¢é€£ç·šéƒ½ä»£è¡¨ä¸€å€‹æ¬Šé‡å€¼ï¼Œç¥ç¶“ç¶²çµ¡é€šéä¸æ–·èª¿æ•´æ¬Šé‡ä¾†é€¼è¿‘çµæœã€‚é¦–å…ˆæŠŠä¸€çµ„æ¬Šé‡æ‡‰ç”¨åœ¨input layerçš„ç¯€é»ä¸Šï¼ŒåŠ ä¸Šåå·®å€¼å¾Œå¾—åˆ°hidden layerçš„ç¯€é»ï¼Œç„¶å¾Œå°hidden layerçš„ç¯€é»æ‡‰ç”¨å¦ä¸€çµ„æ¬Šé‡ï¼ŒåŠ ä¸Šåå·®å€¼å¾Œæœ€çµ‚å¾—åˆ°output layerçš„ç¯€é»ã€‚</p><p>å…ˆè¨­ç½®ä¸€ä¸‹å…©çµ„æ¬Šé‡å’Œåå·®çš„åˆå§‹å€¼ï¼Œå¾Œé¢å†çœ‹å¦‚ä½•æ›´æ–°é€™äº›æ¬Šé‡å’Œåå·®ã€‚æˆ‘å®šç¾©ä¸€å€‹æ¨¡å‹è¨“ç·´å‡½æ•¸ï¼Œç›®æ¨™æ˜¯ä¸æ–·å„ªåŒ–æ¬Šé‡å’Œåå·®å¾—åˆ°æœ€ä½³çµ„åˆã€‚ç¬¬ä¸€çµ„æ¬Šé‡æ˜¯ä¸€å€‹784 x 15çš„çŸ©é™£ï¼Œç¬¬äºŒçµ„æ¬Šé‡æ˜¯ä¸€å€‹15 x 10çš„çŸ©é™£ï¼Œç”¨éš¨æ©Ÿå‡½æ•¸ç”Ÿæˆä¸€å †0åˆ°1ä¹‹é–“çš„æµ®é»æ•¸å€¼ï¼Œåå·®å°±å…ˆéƒ½è¨­ç‚º0. å…©çµ„æ¬Šé‡éƒ½é™¤ä»¥5æ˜¯æˆ‘åœ¨èª¿åƒéç¨‹ä¸­ç™¼ç¾åˆå§‹æ¬Šé‡æ•¸å€¼è¦æ›´å°ä¸€äº›æ•ˆæœæ¯”è¼ƒå¥½ï¼Œéš¨ä¾¿æ‹çš„ä¸€å€‹æ•¸ã€‚</p><blockquote><p>input_layer_size = 28 * 28<br>hidden_layer_size = 15<br>output_layer_size = 10</p><p>def train_model():<br># init weights and bias<br>np.random.seed(1)<br>W1 = np.random.random([input_layer_size, hidden_layer_size])/5 # 784 x 15<br>b1 = np.zeros((1, hidden_layer_size))<br>W2 = np.random.random([hidden_layer_size, output_layer_size])/5 # 15 x 10<br>b2 = np.zeros((1, output_layer_size))</p></blockquote><p>ç¾åœ¨å¯ä»¥æŠŠæ¬Šé‡W1ä¹Ÿæ‰“å°å‡ºä¾†çœ‹çœ‹ï¼Œæˆ‘åªæ‹¿è¼¸å…¥å±¤ç¬¬ä¸€å€‹ç¯€é»å’Œéš±è—å±¤ç¬¬ä¸€å€‹ç°¡å–®ä¹‹é–“çš„ä¸€æ ¹ç·šä¾†æŸ¥çœ‹ã€‚å¯ä»¥çœ‹åˆ°éƒ½æ˜¯éå¸¸å¾®å°çš„éš¨æ©Ÿæ•¸å­—ï¼Œæœ€å¤§ä¸æœƒè¶…é0.2</p><blockquote><p>plt_grid(W1.T[0].reshape(28,28))</p></blockquote><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6ee400030db6324f2555></p><p>ç¬¬ä¸€æ¢ç·šæ¬Šé‡</p><p>å¾Œä¾†åœ¨è¨“ç·´50000æ¬¡ä¹‹å¾Œå¯ä»¥ç”¨pltå°‡åå€‹æ•¸å­—æ¬Šé‡çš„ç†±åŠ›åœ–å¯è¦–åŒ–å‘ˆç¾:</p><blockquote><p>for i in range(10):<br>plt.subplot(2, 5, i+1)<br>weight = W1[:,i]<br>plt.title(i)<br>plt.imshow(weight.reshape([28,28]), cmap=plt.get_cmap('seismic'))<br>frame1 = plt.gca()<br>frame1.axes.get_xaxis().set_visible(False)<br>frame1.axes.get_yaxis().set_visible(False)</p></blockquote><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/6ee2000333910cb8c03c></p><p>Weight Heatmap</p><p><strong>æ¿€æ´»å‡½æ•¸ (Activation Function)</strong></p><p>Montreal å¤§å­¸çš„ Bengio æ•™æˆåœ¨ ICML 2016 ä¸­çµ¦å‡ºäº†æ¿€æ´»å‡½æ•¸å®šç¾©: æ¿€æ´»å‡½æ•¸æ˜¯æ˜ å°„ h:Râ†’Rï¼Œä¸”å¹¾ä¹è™•è™•å¯å°ã€‚</p><p>å¼•å…¥æ¿€æ´»å‡½æ•¸æ˜¯ç‚ºäº†å°‡æ¬Šå€¼è½‰åŒ–ç‚ºåˆ†é¡çµæœï¼Œæœ‰å¤šé‡é¸æ“‡: Sigmoid(Så‹), Tanh(é›™åˆ‡æ­£åˆ‡), ReLu(åªä¿ç•™éé›¶), Softmax(æ­¸ä¸€åŒ–) etc. é€™äº›å¸¸ç”¨çš„æ¿€æ´»å‡½æ•¸å¤šæ•¸éƒ½æ˜¯éç·šæ€§çš„ï¼Œç‚ºäº†å½Œè£œç·šæ€§å‡½æ•¸å€åˆ†åº¦ä¸å¤ å¥½çš„çŸ­æ¿ï¼Œè€Œä¸”æ¿€æ´»å‡½æ•¸è¦èƒ½ä¿è­‰æ•¸æ“šè¼¸å…¥èˆ‡è¼¸å‡ºä¹Ÿæ˜¯å¯å¾®çš„ã€‚æœ¬ä¾†æˆ‘å˜—è©¦ç”¨Sigmoidä½œç‚ºæ¿€æ´»å‡½æ•¸ï¼Œä½†æ˜¯å¯èƒ½ç”±æ–¼æˆ‘çš„å¯¦ç¾æ–¹å¼å°è‡´æ•ˆæœä¸å¥½ï¼Œæº–ç¢ºç‡åˆ°70%å¤šæˆ‘å°±å„ªåŒ–ä¸ä¸‹å»äº†ï¼Œå¯èƒ½å®ƒæœ¬èº«ç”±æ–¼è»Ÿé£½å’Œæ€§ä¹Ÿå®¹æ˜“å‡ºç¾æ¢¯åº¦æ¶ˆå¤±çš„å•é¡Œï¼Œåªå¥½æš«æ™‚æ”¾æ£„ã€‚</p><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6ee400030db7c8a5f18f></p><p>ä¸Šé¢é€™å¥è©±æˆ‘å†è§£é‡‹ä¸€ä¸‹ï¼ŒSigmoidå°±æ˜¯è™•è™•å¯å°çš„Så‹æ›²ç·šï¼Œä¸”å…©å´å°æ•¸è¶¨è¿‘æ–¼0ï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸€å€‹è»Ÿé£½å’Œå‡½æ•¸ï¼Œè€Œä¸”å·¦å³å…©å´éƒ½æ˜¯è»Ÿé£½å’Œã€‚ä¸€æ—¦è½å…¥äº†è»Ÿé£½å’Œå€f'(x)å°±æ¥è¿‘æ–¼0äº†ï¼Œç„¡æ³•å†ç¹¼çºŒå‚³éæ¢¯åº¦ï¼Œé€™å°±æ˜¯æ‰€è¬‚çš„æ¢¯åº¦æ¶ˆå¤±ã€‚</p><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6ee70000b641874e0002></p><p>Sigmoidåœ–å½¢</p><p>ç¾åœ¨è¼¸å…¥å±¤åˆ°éš±è—å±¤æˆ‘é¸æ“‡äº†ReLuä½œç‚ºæ¿€æ´»å‡½æ•¸ï¼Œå¾åœ–å½¢ä¸­çœ‹å‡ºå®ƒå…·å‚™å·¦å´ç¡¬é£½å’Œçš„ç‰¹æ€§ã€‚</p><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/6ee50002befac5b3752a></p><p>ReLu Formula</p><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6ee60001d25f8187a1ea></p><p>ReLu åœ–å½¢</p><p>ä»£ç¢¼å¯¦ç¾å¦‚ä¸‹</p><blockquote><p>def relu(x):<br>return np.maximum(x, 0)</p></blockquote><p>å¾éš±è—å±¤åˆ°è¼¸å‡ºå±¤æˆ‘é¸æ“‡äº†softmaxä½œç‚ºæ¿€æ´»å‡½æ•¸</p><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6ee70000b6427c984347></p><p>Softmax Formula</p><p>åºåˆ—ä¸­æœ€å¤§çš„é‚£å€‹æ•¸æ˜ å°„çš„åˆ†é‡é€¼è¿‘æ–¼ 1, å…¶ä»–å°±é€¼è¿‘æ–¼ 0ï¼Œéå¸¸é©åˆå¤šåˆ†é¡å•é¡Œã€‚å–æŒ‡æ•¸æ˜¯ç‚ºäº†è®“é¦¬å¤ªæ•ˆæ‡‰å‡¸é¡¯ï¼Œå¤§æ•¸é€²ä¸€æ­¥æ”¾å¤§ï¼ŒåŒæ™‚ä¹Ÿæ»¿è¶³äº†å¯å°å‡½æ•¸çš„éœ€æ±‚ã€‚</p><p>Softmaxä»£ç¢¼å¯¦ç¾å¦‚ä¸‹ (å¦‚æœå‡ºç¾overflowçš„è©±å¯ä»¥åƒè€ƒscikit-learnæºç¢¼çš„å¯¦ç¾æ–¹å¼)</p><blockquote><p>def softmax(x):<br>e_x = np.exp(x - np.max(x))<br>return e_x / e_x.sum()</p></blockquote><p><strong>æ­£å‘å‚³æ’­(Forward Propagation)</strong></p><p>æ­£å‘å‚³æ’­çš„è¨ˆç®—å°±æ˜¯æŠŠè¼¸å…¥å±¤åˆ°éš±è—å±¤çš„ç¯€é»èˆ‡æ¬Šé‡å’Œåå·®çµåˆï¼Œè¨ˆç®—å‡ºè¼¸å‡ºå±¤ç¯€é»çš„éç¨‹ã€‚<br>å°æ–¼é€™å€‹ä¸‰å±¤ç¶²çµ¡ï¼Œå‡å®šxæ˜¯åŒ…å«ä¸€å€‹å–®ä¸€è¨“ç·´æ¨£æœ¬çš„åˆ—å‘é‡ã€‚å‰‡å‘é‡åŒ–çš„æ­£å‘å‚³æ’­æ­¥é©Ÿå¦‚ä¸‹ï¼š(é€™å€‹åœ–æˆ‘ç•«å®Œä»¥å¾Œæ„Ÿè¦ºç”¨æ›´åš´è¬¹çš„æ–¹å¼ä¾†æè¿°çš„è©±ï¼Œå››å€‹æ¨™è¨»æ‡‰è©²æ˜¯éš±è—å±¤çš„è¼¸å…¥ï¼Œéš±è—å±¤çš„è¼¸å‡ºï¼Œè¼¸å‡ºå±¤çš„è¼¸å…¥ï¼Œè¼¸å‡ºå±¤çš„è¼¸å…¥ï¼Œä½†æ‡¶å¾—æ”¹åœ–äº†)</p><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/6ee200033392be486202></p><p>Forward Propagation</p><p>å‡è¨­æˆ‘è¦è¨“ç·´50000æ¬¡ï¼Œtrain_modelæ–¹æ³•ä¸­åŠ å…¥æ­£å‘å‚³æ’­çš„å¾ªç’°ä»£ç¢¼å¯¦ç¾å¦‚ä¸‹</p><blockquote><p>batch= 50000<br>for i in range(0, batch):<br>X = X_train[i]<br>y = y_train[i]</p><p>input_layer = X.dot(W1)<br>hidden_layer = relu(input_layer + b1)<br>output_layer = np.dot(hidden_layer, W2) + b2<br>output_probs = softmax(output_layer)</p></blockquote><p>æˆ‘é‚„æ˜¯ç¹¼çºŒæ‹¿indexç‚º88çš„æ•¸å­—3åœ–ç‰‡ç‚ºä¾‹çœ‹çœ‹å„å±¤æ˜¯ä»€éº¼æ•¸å­—</p><p>input_layeræ˜¯è¼¸å…¥å±¤çŸ©é™£èˆ‡æ¬Šé‡1çŸ©é™£ç›¸ä¹˜å¾—åˆ°15ç¶­å‘é‡</p><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6ee70000b643db70a946></p><p>input_layer</p><p>hidden_layeræ˜¯ä¸Šä¸€å±¤åŠ ä¸Šåå·®1ä½œç‚ºReLuçš„è¼¸å…¥è¨ˆç®—å‡ºä¾†çš„, ç¶­åº¦åŒä¸Š</p><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p9.pstatp.com/large/6ee10003f4e8682c1c90></p><p>Hidden Layer</p><p>æ­¤æ™‚æ¬Šé‡2æ˜¯15x10çš„çŸ©é™£</p><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/6ee60001d260fa9e6fff></p><p>W2</p><p>æ¬Šé‡2å’Œhidden_layerçŸ©é™£ç›¸ä¹˜åŠ ä¸Šåå·®2å¾—åˆ°åç¶­å‘é‡output_layer, é€™è£¡æœ€å¤§çš„æ•¸å­—æ˜¯ç¬¬ä¹ä½çš„20.09</p><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/6ee2000333933ca14ae4></p><p>output_layer</p><p>output_layerä½œç‚ºsoftmaxè¼¸å…¥è¨ˆç®—å¾Œå¾—åˆ°æœ€çµ‚çµæœoutput_probs, ç¬¬ä¹ä½è¢«è½‰æˆäº†éå¸¸æ¥è¿‘1çš„ä¸€å€‹å°æ•¸ï¼Œä¹Ÿæ˜¯åºåˆ—ä¸­æœ€å¤§çš„æ•¸å­—ã€‚é€™æ˜¯è¨“ç·´ä¹‹åˆçš„æ•¸å€¼ï¼Œå¯¦éš›ä¸Šæœ€å¤§çš„æ•¸å­—æ‡‰è©²åœ¨ç¬¬å››ä½ï¼Œæ‰€ä»¥æ­¤æ™‚èª¤å·®æ¯”è¼ƒå¤§ã€‚å¤§æ¦‚åœ¨å­¸ç¿’3000æ¬¡ä¹‹å¾Œå·²ç¶“èƒ½è¼ƒå¤§æ¦‚ç‡çš„åœ¨ç¬¬å››ä½é€¼è¿‘1</p><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6ee50002befb6df58064></p><p>output_probs</p><p><strong>åå‘å‚³æ’­ (Backward Propagation)</strong></p><p>æ¥ä¸‹ä¾†è‡ªç„¶å°±æœƒæ€è€ƒï¼Œæ¬Šé‡å’Œåå·®å¦‚ä½•è¿­ä»£å„ªåŒ–å‘¢? é¦–å…ˆæ­£å‘å‚³æ’­è¨ˆç®—å‡ºoutput_layerç¯€é»ï¼Œç”¨æå¤±å‡½æ•¸è¨ˆç®—ä¸€ä¸‹å’Œæ¨™è¨»yçš„å·®è·ï¼Œæ ¹æ“šæå¤±å¤§å°è¿”å›ä¾†ä¿®æ­£æ¬Šé‡å’Œåå·®ï¼Œé€™å€‹é€šééˆå¼æ³•å‰‡å°å¤šå±¤è¤‡åˆå‡½æ•¸æ±‚å°çš„éç¨‹å°±æ˜¯åå‘å‚³æ’­ï¼Œå…¶ç›®æ¨™å°±æ˜¯è¦æœ€å°åŒ–è¨“ç·´é›†ä¸Šçš„ç´¯ç©èª¤å·®ã€‚</p><p>åœ¨å‰æ–‡"<a target=_blank>äººå·¥ç¥ç¶“å…ƒæ˜¯å¦‚ä½•æ¨¡æ“¬ç”Ÿç‰©ç¥ç¶“å…ƒçš„</a>"ä¸­æˆ‘æåˆ°æ©Ÿå™¨å­¸ç¿’éœ€è¦ä¸æ–·èª¿æ•´weightå’Œbiasä¾†é€æ­¥é€¼è¿‘é æœŸçš„è¼¸å‡ºå€¼ï¼Œ<strong>è€Œä¸”å¿…é ˆä¿è­‰weightå’Œbiasçš„å¾®å°è®ŠåŒ–ä¹Ÿåªæœƒå¸¶ä¾†è¼¸å‡ºå€¼çš„å¾®å°è®ŠåŒ–.</strong></p><p>èª¿åƒçš„éç¨‹å°±åƒæ‰“é«˜çˆ¾å¤«ä¸€æ¨£ï¼Œç›®æ¨™æ˜¯ä»¥æœ€å°‘çš„æ†æ•¸å°‡çƒæ‰“é€²æ´ï¼Œå¦‚æœéæ–¼è¬¹æ…å¯èƒ½è€—è²»çš„æ†æ•¸å¤ªå¤šï¼Œå¦‚æœå¤ªéæ¿€é€²å¯èƒ½çƒè¢«æ‰“é€²äº†æ²™æ± æˆ–è€…æ°´å‘ï¼Œæ¬²é€Ÿå‰‡ä¸é”ã€‚æ¯ä¸€æ†éƒ½è¦è®“çƒé›¢çƒæ´æ›´è¿‘ï¼Œé€²å…¥æœå¶ºçš„æ™‚å€™é‚„è¦ç¢ºä¿ä¸è¦ç”¨åŠ›éåº¦è®“çƒè·‘éé ­äº†ã€‚(è¦‹ä¸‹æ–‡<strong>å­¸ç¿’ç‡</strong>)</p><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6ee70000b6445aa7d4e4></p><p>åœ¨train_modelæ–¹æ³•ä¸­ç¹¼çºŒå¯¦ç¾é€™å€‹é€†å‘éç¨‹, è¨ˆç®—è¼¸å‡ºå±¤çš„error, å†å°‡æ­¤erroré€†å‘å‚³æ’­åˆ°éš±è—å±¤ï¼Œæœ€å¾Œæ ¹æ“šéš±è—å±¤çš„errorä¾†å°é€£æ¥æ¬Šé‡èˆ‡åå·®é€²è¡Œèª¿æ•´ï¼Œè¿­ä»£å¾ªç’°ä¸‹å»ä¸æ–·æ›´æ–°è®“erroræ”¶æ–‚ã€‚æ ¸å¿ƒé‚è¼¯æ˜¯æ¢¯åº¦ä¸‹é™çš„ç®—æ³•ï¼Œé€™è£¡æœ‰ä¸‰ç¨®é¸æ“‡: æ‰¹é‡æ¢¯åº¦ä¸‹é™(Batch Gradient Descent)ï¼Œéš¨æ©Ÿæ¢¯åº¦ä¸‹é™(Stochastic Gradient Descent)å’Œå°æ‰¹é‡æ¢¯åº¦ä¸‹é™ã€‚</p><p>ç¬¬ä¸€ç¨®æ–¹å¼éæ­·å®Œæ•´è¨“ç·´é›†ç®—å‡ºä¸€å€‹æå¤±å‡½æ•¸ï¼Œç„¶å¾Œæ›´æ–°åƒæ•¸å†è·‘ä¸€æ¬¡å®Œæ•´è¨“ç·´é›†ï¼Œå¦‚æ­¤è¿­ä»£å¾ªç’°ï¼Œæ‰€ä»¥è¨ˆç®—é‡å¾ˆææ€–ã€‚ç¬¬äºŒç¨®æ–¹å¼æ˜¯æ¯è·‘è¨“ç·´é›†ä¸­çš„ä¸€æ¢æ•¸æ“šå°±è¨ˆç®—æå¤±å‡½æ•¸ä¸¦æ›´æ–°åƒæ•¸ï¼Œé€Ÿåº¦æ¯”è¼ƒå¿«ï¼Œä½†æ”¶æ–‚æ€§ä¸å¤ªå¥½ï¼Œå¯èƒ½æœƒå‡ºç¾è¼ƒå¤šæ¯›åˆºåœ¨æœ€å„ªé»é™„è¿‘æ–æ“ºã€‚æœ€å¾Œä¸€å€‹æ˜¯å‰å…©è€…çš„é€™ç¨®æ–¹æ¡ˆï¼Œæ—¢ä¸æ˜¯è·‘å…¨é‡æ•¸æ“šè€Œä¸æ˜¯è·‘å–®å€‹æ•¸æ“šï¼Œè€Œæ˜¯æ‹¿ä¸€å°æ‰¹æ•¸æ“šä¾†è¨ˆç®—æå¤±å‡½æ•¸æ›´æ–°åƒæ•¸ã€‚æˆ‘å…ˆç”¨SGDä¾†è·‘ï¼Œå¾Œé¢å¯ä»¥é€šéåœ–åƒçœ‹åˆ°æ¯›åˆºçš„å•é¡Œã€‚</p><p>ç”¨æ•¸å­¸èªè¨€ä¾†æè¿°ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•çš„æ ¸å¿ƒæ˜¯<strong>å¤šå…ƒå‡½æ•¸æ±‚å¾®</strong>ï¼Œé‡å°æ¯ä¸€å€‹è®Šé‡éƒ½åˆ†åˆ¥æ±‚å¾®ï¼Œæ¯ä¸€æ¬¡è¿­ä»£éƒ½ç”¨å¤šå…ƒå‡½æ•¸æ¸›å»å¤šå…ƒå‡½æ•¸çš„å¾®åˆ†èˆ‡å­¸ç¿’ç‡çš„ä¹˜ç©ã€‚ä¸‹é¢ä»£ç¢¼ä¸­ç¬¬ä¸€è¡Œè¨­ç½®çš„åƒæ•¸æ˜¯å­¸ç¿’ç‡ï¼Œé€™å€‹åƒæ•¸æ˜¯è¦åœ¨ç²¾åº¦å’Œé€Ÿåº¦ä¹‹é–“æ‰¾åˆ°å¹³è¡¡ï¼Œå­¸ç¿’ç‡å¤ªå¤§å‰‡è¨“ç·´çš„å¿«ä½†ç²¾åº¦ä¸å¤ (æ¯æ¬¡æ“Šçƒéƒ½å¾ˆå¤§åŠ›)ï¼Œå­¸ç¿’ç‡å¤ªå°å‰‡æå‡ç²¾åº¦ä½†éæ–¼è€—è²»æ™‚é–“(æ¯æ¬¡æ“Šçƒéƒ½å°å¿ƒç¿¼ç¿¼è¼•è¼•æ®æ†ä¿è­‰ç²¾æº–)ï¼Œé€™è£¡è¨­ç½®çš„å­¸ç¿’ç‡æ˜¯å›ºå®šçš„ï¼Œé€™æ¨£çš„éœæ…‹è¨­ç½®é¡¯ç„¶ä¸æœƒæ˜¯æœ€ä½³é¸æ“‡ï¼Œä¸éè™•æ–¼å­¸ç¿’ç›®çš„ä¹Ÿå¤ äº†ã€‚</p><blockquote><p>learning_rate = .01<br>reg_lambda = .01</p><p>output_error = (output_probs - y) / output_probs.shape[0]</p><p>hidden_error = np.dot(output_error, W2.T)<br>hidden_error[hidden_layer &lt;= 0] = 0</p><p># gradient layer2 weights and bias<br>g2_weights = np.dot(hidden_layer.T, output_error)<br>g2_bias = np.sum(output_error, axis = 0, keepdims = True)</p><p># gradient layer1 weights and bias<br>g1_weights = np.dot(X.reshape(input_layer_size,1), hidden_error)<br>g1_bias = np.sum(hidden_error, axis = 0, keepdims = True)</p><p># gradient descent parameter update<br>W1 -= learning_rate * g1_weights<br>b1 -= learning_rate * g1_bias<br>W2 -= learning_rate * g2_weights<br>b2 -= learning_rate * g2_bias</p></blockquote><p><strong>æ­£å‰‡åŒ–å¹²æ“¾ (Regularization Terms)</strong></p><p>ç‚ºäº†è®“æ“¬åˆæ•ˆæœæ›´å¥½å¯ä»¥åœ¨errorå¾Œé¢åŠ å…¥æ­£å‰‡å¹²æ“¾é …, è®“æ¨¡å‹å’Œæ¨£æœ¬ä¸è¦å®Œå…¨æ“¬åˆï¼Œç•¶å‡ºç¾æ¬ æ“¬æ™‚å¹²æ“¾é …çš„å½±éŸ¿è¦å°ï¼Œç•¶å‡ºç¾éæ“¬æ™‚å¹²æ“¾é …çš„å½±éŸ¿è¦å¤§ã€‚reg_lambdaå°±æ˜¯è¨­ç½®çš„æ“¬åˆåƒæ•¸ï¼Œæ‰€ä»¥å¯ä»¥åœ¨æ›´æ–°wå’Œbä¹‹å‰å†åŠ å…©è¡Œä»£ç¢¼ã€‚</p><blockquote><p># add regularization terms<br>g2_weights += reg_lambda * W2<br>g1_weights += reg_lambda * W1</p></blockquote><p><strong>é æ¸¬å‡½æ•¸</strong></p><p>é€™å€‹é‚è¼¯å¾ˆç°¡å–®ï¼Œå’Œè¨“ç·´é›†çš„æ­£å‘å‚³æ’­å®Œå…¨ä¸€æ¨£ï¼Œåªä¸éè¼¸å…¥åƒæ•¸æ›æˆæ¸¬è©¦é›†æ•¸æ“šï¼Œä»£å…¥å·²ç¶“è¨“ç·´å¥½çš„æ¬Šé‡å’Œåå·®ï¼Œçµ±è¨ˆæ­£ç¢ºé æ¸¬çš„æ¯”ä¾‹ã€‚</p><blockquote><p>input_layer = np.dot(X_test[:10000], W1)<br>hidden_layer = relu(input_layer + b1)<br>scores = np.dot(hidden_layer, W2) + b2<br>probs = softmax(scores)<br>print ('Test accuracy: {0}%'.format(accuracy(probs, y_test[:10000])))</p></blockquote><p>å®Œæˆæ¨¡å‹è¨“ç·´ä»£ç¢¼å¾Œå¯ä»¥å†å®šç¾©ä¸€å€‹äº¤å‰ç†µæå¤±å‡½æ•¸ä¾†è§€å¯Ÿæ”¶æ–‚æ•ˆæœï¼Œè¿­ä»£åˆ°ä¸‰äº”åƒæ¬¡çš„æ™‚å€™å…¶å¯¦å·²ç¶“å·®ä¸å¤šäº†ï¼Œå¾Œé¢çš„å¹¾è¬æ¬¡å­¸ç¿’ä¾ç„¶æœƒä¸æ™‚å‡ºç¾ä¸€äº›æ¯›åˆºå½±éŸ¿æº–ç¢ºç‡ã€‚</p><blockquote><p>def cross_entropy_loss(probs, y_onehot):<br>indices = np.argmax(y_onehot, axis = 0).astype(int)<br>predicted_prob = probs[np.arange(len(probs)), indices]<br>log_preds = np.log(predicted_prob)<br>loss = -1.0 * np.sum(log_preds) / len(log_preds)<br>return loss</p></blockquote><p><img alt=æ‰‹å·¥æ‰“é€ ç¥ç¶“ç¶²çµ¡ï¼šé€è¦–åˆ†æ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6ee200033394c684d879></p><p>æœ€å¾ŒæŠŠä¸Šé¢çš„ä»£ç¢¼é‡æ§‹ä¸€ä¸‹æ•´åˆèµ·ä¾†è²¼å‡ºå®Œæ•´ä»£ç¢¼(ä¸åŒ…å«èª¿è©¦æ‰“å°åœ–ç‰‡å’Œæ—¥èªŒ)ï¼Œé æ¸¬æº–ç¢ºç‡90%, ä¸‹ä¸€ç¯‡æˆ‘å°‡æ”¹ç”¨TensorFlowå°Fashion MNISTé æ¸¬ï¼Œä¸¦æå‡æº–ç¢ºç‡ã€‚</p><blockquote><p>import numpy as np</p><p>from tensorflow.examples.tutorials.mnist import input_data</p><p>import matplotlib.pyplot as plt</p><p>mndata = input_data.read_data_sets("MNIST-data/", one_hot=True)</p><p>X_train=mndata.train.images # training set</p><p>y_train=mndata.train.labels</p><p>X_test=mndata.test.images # testing set</p><p>y_test=mndata.test.labels</p><p>input_layer_size = 28 * 28</p><p>hidden_layer_size = 15</p><p>output_layer_size = 10</p><p>reg_lambda = .01</p><p>learning_rate = .01</p><p># visualize grid data of a matrix, zero cell shown as empty</p><p>def plt_grid(data):</p><p>fig, ax = plt.subplots()</p><p>fig.set_size_inches(30,30)</p><p>width, height = data.shape</p><p>#imshow portion</p><p>imshow_data = np.random.rand(width, height, 2)</p><p>ax.imshow(imshow_data, cmap=plt.cm.Pastel1, interpolation='nearest')</p><p>for x in range(0, height):</p><p>for y in range(0, width):</p><p>if (data[y][x]>0):</p><p>ax.text(x, y, np.round(data[y][x],8), va='center',</p><p>ha='center', fontsize=20)</p><p>plt.show()</p><p>def softmax(x):</p><p>e_x = np.exp(x - np.max(x))</p><p>return e_x / e_x.sum()</p><p>def relu(x):</p><p>return np.maximum(x, 0)</p><p>def cross_entropy_loss(probs, y_onehot):</p><p>indices = np.argmax(y_onehot, axis = 0).astype(int)</p><p>predicted_prob = probs[np.arange(len(probs)), indices]</p><p>log_preds = np.log(predicted_prob)</p><p>loss = -1.0 * np.sum(log_preds) / len(log_preds)</p><p>return loss</p><p># init weights and bias</p><p>def init_weights_bias():</p><p>np.random.seed(1)</p><p>W1 = np.random.random([input_layer_size, hidden_layer_size])/5 # 784 x 15</p><p>b1 = np.zeros((1, hidden_layer_size))</p><p>W2 = np.random.random([hidden_layer_size, output_layer_size])/5 # 15 x 10</p><p>b2 = np.zeros((1, output_layer_size))</p><p>model = { 'W1': W1, 'b1': b1, 'W2': W2, 'b2': b2}</p><p>return model</p><p># derivative weights and bias</p><p>def derivative_weights_bias(output_error, hidden_layer, X, model):</p><p>W1, _, W2, _ = model['W1'], model['b1'], model['W2'], model['b2']</p><p>hidden_error = np.dot(output_error, W2.T)</p><p>hidden_error[hidden_layer &lt;= 0] = 0</p><p># gradient layer2 weights and bias</p><p>g2_weights = np.dot(hidden_layer.T, output_error)</p><p>g2_bias = np.sum(output_error, axis = 0, keepdims = True)</p><p># gradient layer1 weights and bias</p><p>g1_weights = np.dot(X.reshape(input_layer_size,1), hidden_error)</p><p>g1_bias = np.sum(hidden_error, axis = 0, keepdims = True)</p><p># add regularization terms</p><p>g2_weights += reg_lambda * W2</p><p>g1_weights += reg_lambda * W1</p><p>param = { 'dW1': g1_weights, 'db1': g1_bias, 'dW2': g2_weights, 'db2': g2_bias}</p><p>return param</p><p>def forward_propagation(X, model):</p><p>W1, b1, W2, b2 = model['W1'], model['b1'], model['W2'], model['b2']</p><p>input_layer = np.dot(X, W1)</p><p>hidden_layer = relu(input_layer + b1)</p><p>output_layer = np.dot(hidden_layer, W2) + b2</p><p>probs = softmax(output_layer)</p><p>return probs, hidden_layer</p><p>def accuracy(predictions, labels):</p><p>preds_correct_boolean = np.argmax(predictions, 1) == np.argmax(labels, 1)</p><p>correct_predictions = np.sum(preds_correct_boolean)</p><p>accuracy = 100.0 * correct_predictions / predictions.shape[0]</p><p>return accuracy</p><p>#predict test set</p><p>def predict(X, model):</p><p>W1, b1, W2, b2 = model['W1'], model['b1'], model['W2'], model['b2']</p><p>input_layer = np.dot(X_test[:10000], W1)</p><p>hidden_layer = relu(input_layer + b1)</p><p>output_layer = np.dot(hidden_layer, W2) + b2</p><p>probs = softmax(output_layer)</p><p>print ('Test accuracy: {0}%'.format(accuracy(probs, y_test[:10000])))</p><p># - batch: Size of passes through the training data for gradient descent</p><p>def train_model(batch, X, y):</p><p>model = init_weights_bias()</p><p>W1, b1, W2, b2 = model['W1'], model['b1'], model['W2'], model['b2']</p><p># Gradient descent. For each batch...</p><p>for i in range(0, batch):</p><p>output_probs, hidden_layer = forward_propagation(X[i], model)</p><p>output_error = (output_probs - y[i]) / output_probs.shape[0]</p><p>param = derivative_weights_bias(output_error, hidden_layer, X[i], model)</p><p>dW1, db1, dW2, db2 = param['dW1'], param['db1'], param['dW2'], param['db2']</p><p># gradient descent parameter update</p><p>W1 -= learning_rate * dW1</p><p>b1 -= learning_rate * db1</p><p>W2 -= learning_rate * dW2</p><p>b2 -= learning_rate * db2</p><p>model = { 'W1': W1, 'b1': b1, 'W2': W2, 'b2': b2}</p><p>loss = cross_entropy_loss(output_probs, y[i])</p><p>if (i % 2000 == 0):</p><p>print('loss @ %d is %f' % (i, loss))</p><p>return model</p><p>model = train_model(50000, X_train[:50000], y_train[:50000])</p><p>predict(X_test[:10000], model)</p></blockquote><p><em>References:</em></p><p><em><a rel=nofollow target=_blank>Neural Network Vectorization</a></em></p><p><em><a rel=nofollow target=_blank>Neural Network and Deep Learning</a></em></p><p><em>Not another MNIST tutorial with TensorFlow OReilly Media</em></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>ç¥ç¶“</a></li><li><a>ç¶²çµ¡</a></li><li><a>é€è¦–</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/ad6f0929.html alt=è°·æ­Œå¤§è…¦ç™¼ä½ˆç¥ç¶“ç¶²çµ¡çš„ã€Œæ ¸ç£å…±æŒ¯ã€ï¼Œä¸¦å…¬é–‹ç›¸é—œä»£ç¢¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/65c4000bda98898dcdbb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ad6f0929.html title=è°·æ­Œå¤§è…¦ç™¼ä½ˆç¥ç¶“ç¶²çµ¡çš„ã€Œæ ¸ç£å…±æŒ¯ã€ï¼Œä¸¦å…¬é–‹ç›¸é—œä»£ç¢¼>è°·æ­Œå¤§è…¦ç™¼ä½ˆç¥ç¶“ç¶²çµ¡çš„ã€Œæ ¸ç£å…±æŒ¯ã€ï¼Œä¸¦å…¬é–‹ç›¸é—œä»£ç¢¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2bc1496a.html alt=ç‚ºäº†æ›´å¥½çš„æ·±åº¦ç¥ç¶“ç¶²çµ¡è¦–è¦ºï¼Œåªéœ€æ·»åŠ åé¥‹ï¼ˆå¾ªç’°ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/17fccfd7096d44eeb3921bbd0dc29a13 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2bc1496a.html title=ç‚ºäº†æ›´å¥½çš„æ·±åº¦ç¥ç¶“ç¶²çµ¡è¦–è¦ºï¼Œåªéœ€æ·»åŠ åé¥‹ï¼ˆå¾ªç’°ï¼‰>ç‚ºäº†æ›´å¥½çš„æ·±åº¦ç¥ç¶“ç¶²çµ¡è¦–è¦ºï¼Œåªéœ€æ·»åŠ åé¥‹ï¼ˆå¾ªç’°ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fd4c22a3.html alt=ä½ é‚„ä¸çŸ¥é“ç¥ç¶“ç¶²çµ¡æ˜¯å•¥ï¼Ÿååˆ†é˜æ•™ä½ è·Ÿä¸Šäººå·¥æ™ºèƒ½ç†±æ½® class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/470f0001d893b2ad09e2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fd4c22a3.html title=ä½ é‚„ä¸çŸ¥é“ç¥ç¶“ç¶²çµ¡æ˜¯å•¥ï¼Ÿååˆ†é˜æ•™ä½ è·Ÿä¸Šäººå·¥æ™ºèƒ½ç†±æ½®>ä½ é‚„ä¸çŸ¥é“ç¥ç¶“ç¶²çµ¡æ˜¯å•¥ï¼Ÿååˆ†é˜æ•™ä½ è·Ÿä¸Šäººå·¥æ™ºèƒ½ç†±æ½®</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5d2a6211.html alt=ç¥ç¶“ç¶²çµ¡èˆ‡åœ–éˆæ©Ÿçš„è¤‡é›œåº¦åšå¼ˆ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/4af200040ff1f5233c1c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5d2a6211.html title=ç¥ç¶“ç¶²çµ¡èˆ‡åœ–éˆæ©Ÿçš„è¤‡é›œåº¦åšå¼ˆ>ç¥ç¶“ç¶²çµ¡èˆ‡åœ–éˆæ©Ÿçš„è¤‡é›œåº¦åšå¼ˆ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cc9d1be9.html alt=åŸºæ–¼äºŒç¶­ææ–™ã€ç”¨æ–¼äººå·¥ç¥ç¶“ç¶²çµ¡çš„é«˜å¯†åº¦æ†¶é˜»é™£åˆ—çš„æ™¶åœ“ç´šé›†æˆ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/3c0b503678da4b15be05f6f56c0d213f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cc9d1be9.html title=åŸºæ–¼äºŒç¶­ææ–™ã€ç”¨æ–¼äººå·¥ç¥ç¶“ç¶²çµ¡çš„é«˜å¯†åº¦æ†¶é˜»é™£åˆ—çš„æ™¶åœ“ç´šé›†æˆ>åŸºæ–¼äºŒç¶­ææ–™ã€ç”¨æ–¼äººå·¥ç¥ç¶“ç¶²çµ¡çš„é«˜å¯†åº¦æ†¶é˜»é™£åˆ—çš„æ™¶åœ“ç´šé›†æˆ</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/6062a4c0.html alt=BPç¥ç¶“ç¶²çµ¡çš„ç·šæ€§æœ¬è³ªçš„ç†è§£å’Œå‰–æ-å·ç©å°ç™½çš„éš¨æ©Ÿä¸–ç•Œ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6d474536ff3d4b1fba0cbfc85968ff6f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/6062a4c0.html title=BPç¥ç¶“ç¶²çµ¡çš„ç·šæ€§æœ¬è³ªçš„ç†è§£å’Œå‰–æ-å·ç©å°ç™½çš„éš¨æ©Ÿä¸–ç•Œ>BPç¥ç¶“ç¶²çµ¡çš„ç·šæ€§æœ¬è³ªçš„ç†è§£å’Œå‰–æ-å·ç©å°ç™½çš„éš¨æ©Ÿä¸–ç•Œ</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/f149efd9.html alt=ç”¨æ–¼èª¿æ•´æ·±åº¦ç¥ç¶“ç¶²çµ¡çš„ç°¡å–®åƒè€ƒæŒ‡å— class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/15379529924702cde52ac04 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/f149efd9.html title=ç”¨æ–¼èª¿æ•´æ·±åº¦ç¥ç¶“ç¶²çµ¡çš„ç°¡å–®åƒè€ƒæŒ‡å—>ç”¨æ–¼èª¿æ•´æ·±åº¦ç¥ç¶“ç¶²çµ¡çš„ç°¡å–®åƒè€ƒæŒ‡å—</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0396dba3.html alt=è²è‘‰æ–¯ç¥ç¶“ç¶²çµ¡(ç³»åˆ—)ï¼šç¬¬äºŒç¯‡ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RKYlnth9DPo8ac style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0396dba3.html title=è²è‘‰æ–¯ç¥ç¶“ç¶²çµ¡(ç³»åˆ—)ï¼šç¬¬äºŒç¯‡>è²è‘‰æ–¯ç¥ç¶“ç¶²çµ¡(ç³»åˆ—)ï¼šç¬¬äºŒç¯‡</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a4bbdd29.html alt=é‡å°æ·±åº¦ç¥ç¶“ç¶²çµ¡çš„ç°¡å–®é»‘ç›’å°æŠ—æ”»æ“Š class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b9ec712cd33442338496141ebfcecb45 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a4bbdd29.html title=é‡å°æ·±åº¦ç¥ç¶“ç¶²çµ¡çš„ç°¡å–®é»‘ç›’å°æŠ—æ”»æ“Š>é‡å°æ·±åº¦ç¥ç¶“ç¶²çµ¡çš„ç°¡å–®é»‘ç›’å°æŠ—æ”»æ“Š</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cafcc06.html alt=æ¨¡å¼è­˜åˆ¥èˆ‡ç¥ç¶“ç¶²çµ¡çš„ç™¼å±• class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1523254283784d3d276a90f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cafcc06.html title=æ¨¡å¼è­˜åˆ¥èˆ‡ç¥ç¶“ç¶²çµ¡çš„ç™¼å±•>æ¨¡å¼è­˜åˆ¥èˆ‡ç¥ç¶“ç¶²çµ¡çš„ç™¼å±•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fcf9e89.html alt=BPç¥ç¶“ç¶²çµ¡å­¸ç¿’ç­†è¨˜ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/fc5cec456c184c48b1ee22a233b9ee0b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fcf9e89.html title=BPç¥ç¶“ç¶²çµ¡å­¸ç¿’ç­†è¨˜>BPç¥ç¶“ç¶²çµ¡å­¸ç¿’ç­†è¨˜</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9f3924a.html alt=æ©Ÿå™¨å­¸ç¿’ï¼šç¥ç¶“ç¶²çµ¡å­¸ç¿’ä¹‹å¤šå±¤å‰é¥‹ç¥ç¶“ç¶²çµ¡ï¼ˆä¸€ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a0a4cd0f7d9244a6a12da3c0af6893a5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9f3924a.html title=æ©Ÿå™¨å­¸ç¿’ï¼šç¥ç¶“ç¶²çµ¡å­¸ç¿’ä¹‹å¤šå±¤å‰é¥‹ç¥ç¶“ç¶²çµ¡ï¼ˆä¸€ï¼‰>æ©Ÿå™¨å­¸ç¿’ï¼šç¥ç¶“ç¶²çµ¡å­¸ç¿’ä¹‹å¤šå±¤å‰é¥‹ç¥ç¶“ç¶²çµ¡ï¼ˆä¸€ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/556321d.html alt=æ©Ÿå™¨å­¸ç¿’ï¼šç¥ç¶“ç¶²çµ¡å­¸ç¿’ä¹‹å¤šå±¤å‰é¥‹ç¥ç¶“ç¶²çµ¡ï¼ˆäºŒï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/2d53a815-ab09-4da3-94a2-5b6843366e3a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/556321d.html title=æ©Ÿå™¨å­¸ç¿’ï¼šç¥ç¶“ç¶²çµ¡å­¸ç¿’ä¹‹å¤šå±¤å‰é¥‹ç¥ç¶“ç¶²çµ¡ï¼ˆäºŒï¼‰>æ©Ÿå™¨å­¸ç¿’ï¼šç¥ç¶“ç¶²çµ¡å­¸ç¿’ä¹‹å¤šå±¤å‰é¥‹ç¥ç¶“ç¶²çµ¡ï¼ˆäºŒï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/f3732f4.html alt=ä¸€æ–‡å¹«ä½ æ¢³ç†æ¸…æ¥šæ·±åº¦ç¥ç¶“ç¶²çµ¡çš„åŸºç¤çŸ¥è­˜ï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2f16bcb220e14085a04994454ea4998a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/f3732f4.html title=ä¸€æ–‡å¹«ä½ æ¢³ç†æ¸…æ¥šæ·±åº¦ç¥ç¶“ç¶²çµ¡çš„åŸºç¤çŸ¥è­˜ï¼>ä¸€æ–‡å¹«ä½ æ¢³ç†æ¸…æ¥šæ·±åº¦ç¥ç¶“ç¶²çµ¡çš„åŸºç¤çŸ¥è­˜ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/2d00c65.html alt=ç†è§£ç¥ç¶“ç¶²çµ¡ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/15409758920775d7570f483 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/2d00c65.html title=ç†è§£ç¥ç¶“ç¶²çµ¡>ç†è§£ç¥ç¶“ç¶²çµ¡</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>