<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>java æ‰‹å¯«ä½µç™¼æ¡†æ¶ï¼ˆä¸€ï¼‰ç•°æ­¥æŸ¥è©¢è½‰åŒæ­¥çš„7ç¨®å¯¦ç¾æ–¹å¼ | æå®¢å¿«è¨Š</title><meta property="og:title" content="java æ‰‹å¯«ä½µç™¼æ¡†æ¶ï¼ˆä¸€ï¼‰ç•°æ­¥æŸ¥è©¢è½‰åŒæ­¥çš„7ç¨®å¯¦ç¾æ–¹å¼ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/tos-cn-i-k3u1fbpfcp/1d3022027b8243cabafea485206c0cbe"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/db45996.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/db45996.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/db45996.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/db45996.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/db45996.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/db45996.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/db45996.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/db45996.html><meta property="article:published_time" content="2020-10-29T20:59:18+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:18+08:00"><meta name=Keywords content><meta name=description content="java æ‰‹å¯«ä½µç™¼æ¡†æ¶ï¼ˆä¸€ï¼‰ç•°æ­¥æŸ¥è©¢è½‰åŒæ­¥çš„7ç¨®å¯¦ç¾æ–¹å¼"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/db45996.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>java æ‰‹å¯«ä½µç™¼æ¡†æ¶ï¼ˆä¸€ï¼‰ç•°æ­¥æŸ¥è©¢è½‰åŒæ­¥çš„7ç¨®å¯¦ç¾æ–¹å¼</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right><strong>åºè¨€</strong></h1><p>æœ¬ç¯€å°‡å­¸ç¿’ä¸€ä¸‹å¦‚ä½•å¯¦ç¾ç•°æ­¥æŸ¥è©¢è½‰åŒæ­¥çš„æ–¹å¼ï¼Œå…±è¨ˆä»‹ç´¹äº† 7 ç¨®å¸¸è¦‹çš„å¯¦ç¾æ–¹å¼ã€‚</p><p>æ€ç¶­å°åœ–å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt="java æ‰‹å¯«ä½µç™¼æ¡†æ¶ï¼ˆä¸€ï¼‰ç•°æ­¥æŸ¥è©¢è½‰åŒæ­¥çš„7ç¨®å¯¦ç¾æ–¹å¼" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/tos-cn-i-k3u1fbpfcp/1d3022027b8243cabafea485206c0cbe><p class=pgc-img-caption></p></div><p><span style="color:#888;--tt-darkmode-color: #888888">æ€ç¶­å°åœ–</span></p><h1 class=pgc-h-arrow-right><strong>ç•°æ­¥è½‰åŒæ­¥</strong></h1><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">æ¥­å‹™éœ€æ±‚</span></span></strong></h1><p>æœ‰äº›æ¥å£æŸ¥è©¢åé¥‹çµæœæ˜¯ç•°æ­¥è¿”å›çš„ï¼Œç„¡æ³•ç«‹åˆ»ç²å–æŸ¥è©¢çµæœã€‚</p><p>æ¯”å¦‚æ¥­å‹™é–‹ç™¼ä¸­æˆ‘å€‘èª¿ç”¨å…¶ä»–ç³»çµ±ï¼Œä½†æ˜¯çµæœçš„è¿”å›ç¢ºå¯¦é€šçŸ¥çš„ã€‚</p><p>æˆ–è€… rpc å¯¦ç¾ä¸­ï¼Œclient èª¿ç”¨ server ç«¯ï¼Œçµæœä¹Ÿæ˜¯ç•°æ­¥è¿”å›çš„ï¼Œé‚£éº¼å¦‚ä½•åŒæ­¥ç²å–èª¿ç”¨çµæœå‘¢ï¼Ÿ</p><ul><li>æ­£å¸¸è™•ç†é‚è¼¯</li></ul><p>è§¸ç™¼ç•°æ­¥æ“ä½œï¼Œç„¶å¾Œå‚³éä¸€å€‹å”¯ä¸€æ¨™è­˜ã€‚</p><p>ç­‰åˆ°ç•°æ­¥çµæœè¿”å›ï¼Œæ ¹æ“šå‚³å…¥çš„å”¯ä¸€æ¨™è­˜ï¼ŒåŒ¹é…æ­¤æ¬¡çµæœã€‚</p><ul><li>å¦‚ä½•è½‰æ›ç‚ºåŒæ­¥</li></ul><p>æ­£å¸¸çš„æ‡‰ç”¨å ´æ™¯å¾ˆå¤šï¼Œä½†æ˜¯æœ‰æ™‚å€™ä¸æƒ³åšæ•¸æ“šå­˜å„²ï¼Œåªæ˜¯æƒ³ç°¡å–®ç²å–èª¿ç”¨çµæœã€‚</p><p>å³æƒ³é”åˆ°åŒæ­¥æ“ä½œçš„çµæœï¼Œæ€éº¼è¾¦å‘¢ï¼Ÿ</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">æ€è·¯</span></span></strong></h1><ol start=1><li>ç™¼èµ·ç•°æ­¥æ“ä½œ</li><li>åœ¨ç•°æ­¥çµæœè¿”å›ä¹‹å‰ï¼Œä¸€ç›´ç­‰å¾…(å¯ä»¥è¨­ç½®è¶…æ™‚)</li><li>çµæœè¿”å›ä¹‹å¾Œï¼Œç•°æ­¥æ“ä½œçµæœçµ±ä¸€è¿”å›</li></ol><h1 class=pgc-h-arrow-right><strong>å¸¸è¦‹çš„å¯¦ç¾æ–¹å¼</strong></h1><ul><li>å¾ªç’°ç­‰å¾…</li><li>wait & notify</li><li>ä½¿ç”¨æ¢ä»¶é–</li><li>ä½¿ç”¨ CountDownLatch</li><li>ä½¿ç”¨ CyclicBarrier</li><li>Future</li><li>Spring EventListener</li></ul><p>ä¸‹é¢æˆ‘å€‘ä¸€èµ·ä¾†å­¸ç¿’ä¸‹é€™å¹¾ç¨®å¯¦ç¾æ–¹å¼ã€‚</p><h1 class=pgc-h-arrow-right><strong>å¾ªç’°ç­‰å¾…</strong></h1><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">èªªæ˜</span></span></strong></h1><p>å¾ªç’°ç­‰å¾…æ˜¯æœ€ç°¡å–®çš„ä¸€ç¨®å¯¦ç¾æ€è·¯ã€‚</p><p>æˆ‘å€‘èª¿ç”¨å°æ–¹ä¸€å€‹è«‹æ±‚ï¼Œåœ¨æ²’æœ‰çµæœä¹‹å‰ä¸€ç›´å¾ªç’°æŸ¥è©¢å³å¯ã€‚</p><p>é€™å€‹çµæœå¯ä»¥åœ¨å…§å­˜ä¸­ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨ redis ç·©å­˜æˆ–è€… mysql ç­‰æ•¸æ“šåº«ä¸­ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">ä»£ç¢¼å¯¦ç¾</span></span></strong></h1><h1 class=pgc-h-arrow-right><strong>å®šç¾©æŠ½è±¡çˆ¶é¡</strong></h1><p>ç‚ºäº†ä¾¿æ–¼å¾Œé¢çš„å…¶ä»–å¹¾ç¨®å¯¦ç¾æ–¹å¼çµ±ä¸€ï¼Œæˆ‘å€‘é¦–å…ˆå®šç¾©ä¸€å€‹æŠ½è±¡çˆ¶é¡ã€‚</p><pre><code>/**Â *Â æŠ½è±¡æŸ¥è©¢çˆ¶é¡Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ abstractÂ classÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(AbstractQuery.class);Â Â Â Â protectedÂ StringÂ result;Â Â Â Â publicÂ voidÂ asyncToSync()Â {Â Â Â Â Â Â Â Â startQuery();Â Â Â Â Â Â Â Â newÂ Thread(newÂ Runnable()Â {Â Â Â Â Â Â Â Â Â Â Â Â publicÂ voidÂ run()Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â remoteCall();Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â }).start();Â Â Â Â Â Â Â Â endQuery();Â Â Â Â }Â Â Â Â protectedÂ voidÂ startQuery()Â {Â Â Â Â Â Â Â Â log.info("é–‹å§‹æŸ¥è©¢...");Â Â Â Â }Â Â Â Â /**Â Â Â Â Â *Â é ç¨‹èª¿ç”¨Â Â Â Â Â */Â Â Â Â protectedÂ voidÂ remoteCall()Â {Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â log.info("é ç¨‹èª¿ç”¨é–‹å§‹");Â Â Â Â Â Â Â Â Â Â Â Â TimeUnit.SECONDS.sleep(5);Â Â Â Â Â Â Â Â Â Â Â Â resultÂ =Â "success";Â Â Â Â Â Â Â Â Â Â Â Â log.info("é ç¨‹èª¿ç”¨çµæŸ");Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â log.error("é ç¨‹èª¿ç”¨å¤±æ•—",Â e);Â Â Â Â Â Â Â Â }Â Â Â Â }Â Â Â Â /**Â Â Â Â Â *Â æŸ¥è©¢çµæŸÂ Â Â Â Â */Â Â Â Â protectedÂ voidÂ endQuery()Â {Â Â Â Â Â Â Â Â log.info("å®ŒæˆæŸ¥è©¢ï¼Œçµæœç‚ºï¼š"Â +Â result);Â Â Â Â }}</code></pre><h1 class=pgc-h-arrow-right><strong>ä»£ç¢¼å¯¦ç¾</strong></h1><p>å¯¦ç¾é‚„æ˜¯éå¸¸ç°¡å–®çš„ï¼Œåœ¨æ²’æœ‰çµæœä¹‹å‰ä¸€ç›´å¾ªç’°ã€‚</p><p><span style="color:#ef7060;--tt-darkmode-color: #EF7060">TimeUnit.MILLISECONDS.sleep(10);</span> é€™è£¡å¾ªç’°ç­‰å¾…çš„å°ç¡ä¸€æœƒå…’æ˜¯æ¯”è¼ƒé‡è¦çš„ï¼Œé¿å… cpu é£†å‡ï¼Œä¹Ÿå¯ä»¥é™ä½ç‚º 1msï¼Œæ ¹æ“šè‡ªå·±çš„æ¥­å‹™èª¿æ•´å³å¯ã€‚</p><pre><code>/**Â *Â å¾ªç’°ç­‰å¾…Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ classÂ LoopQueryÂ extendsÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(LoopQuery.class);Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ endQuery()Â {Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â whileÂ (StringUtil.isEmpty(result))Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //å¾ªç’°ç­‰å¾…ä¸€ä¸‹Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TimeUnit.MILLISECONDS.sleep(10);Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â Â Â Â Â //ç²å–çµæœÂ Â Â Â Â Â Â Â Â Â Â Â log.info("å®ŒæˆæŸ¥è©¢ï¼Œçµæœç‚ºï¼š"Â +Â result);Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â }}</code></pre><h1 class=pgc-h-arrow-right><strong>æ¸¬è©¦</strong></h1><pre><code>LoopQueryÂ loopQueryÂ =Â newÂ LoopQuery();loopQuery.asyncToSync();</code></pre><ul><li>æ—¥èªŒ</li></ul><pre><code>[INFO]Â [2020-10-08Â 09:50:43.330]Â [main]Â [c.g.h.s.t.d.AbstractQuery.startQuery]Â -Â é–‹å§‹æŸ¥è©¢...[INFO]Â [2020-10-08Â 09:50:43.331]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â é ç¨‹èª¿ç”¨é–‹å§‹[INFO]Â [2020-10-08Â 09:50:48.334]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â é ç¨‹èª¿ç”¨çµæŸ[INFO]Â [2020-10-08Â 09:50:48.343]Â [main]Â [c.g.h.s.t.d.LoopQuery.endQuery]Â -Â å®ŒæˆæŸ¥è©¢ï¼Œçµæœç‚ºï¼šsuccess</code></pre><p>é€™è£¡å¯ä»¥çœ‹åˆ°é ç¨‹èª¿ç”¨æ˜¯ <span style="color:#ef7060;--tt-darkmode-color: #EF7060">Thread-0</span> ç·šç¨‹åŸ·è¡Œçš„ï¼Œé ç¨‹èª¿ç”¨çš„è€—æ™‚ç‚º 5Sã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">è¶…æ™‚ç‰¹æ€§</span></span></strong></h1><h1 class=pgc-h-arrow-right><strong>ç‚ºä»€éº¼éœ€è¦è¶…æ™‚æ™‚é–“</strong></h1><p>ä¸Šé¢çš„å¯¦ç¾å­˜åœ¨ä¸€å€‹å•é¡Œï¼Œé‚£å°±æ˜¯å¾ªç’°ç­‰å¾…æ²’æœ‰è¶…æ™‚æ™‚é–“ã€‚</p><p>æˆ‘å€‘çš„ä¸€å€‹ç¶²çµ¡è«‹æ±‚ï¼Œå¯èƒ½å­˜åœ¨å¤±æ•—ï¼Œä¹Ÿå¯èƒ½å°æ–¹æ”¶åˆ°è«‹æ±‚ä¹‹å¾Œæ²’æœ‰æ­£ç¢ºè™•ç†ã€‚</p><p>æ‰€ä»¥å¦‚æœæˆ‘å€‘ä¸€ç›´ç­‰å¾…ï¼Œå¯èƒ½æ°¸é ä¹Ÿæ²’æœ‰çµæœï¼Œæˆ–è€…å¾ˆä¹…ä¹‹å¾Œæ‰æœ‰çµæœã€‚é€™åœ¨æ¥­å‹™ä¸Šæ˜¯ä¸å¯å¿å—çš„ï¼Œæ‰€ä»¥éœ€è¦æ·»åŠ ä¸€å€‹è¶…æ™‚æ™‚é–“ã€‚</p><h1 class=pgc-h-arrow-right><strong>ä»£ç¢¼å¯¦ç¾</strong></h1><pre><code>/**Â *Â å¾ªç’°ç­‰å¾…-åŒ…å«è¶…æ™‚æ™‚é–“Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ classÂ LoopTimeoutQueryÂ extendsÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(LoopTimeoutQuery.class);Â Â Â Â /**Â Â Â Â Â *Â è¶…æ™‚æ™‚é–“Â Â Â Â Â */Â Â Â Â privateÂ longÂ timeoutMillsÂ =Â 3000;Â Â Â Â publicÂ LoopTimeoutQuery()Â {Â Â Â Â }Â Â Â Â publicÂ LoopTimeoutQuery(longÂ timeoutMills)Â {Â Â Â Â Â Â Â Â this.timeoutMillsÂ =Â timeoutMills;Â Â Â Â }Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ endQuery()Â {Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â finalÂ longÂ endTimeMillsÂ =Â System.currentTimeMillis()Â +Â timeoutMills;Â Â Â Â Â Â Â Â Â Â Â Â whileÂ (StringUtil.isEmpty(result))Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â è¶…æ™‚åˆ¤æ–·Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if(System.currentTimeMillis()Â &gt;=Â endTimeMills)Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â throwÂ newÂ RuntimeException("è«‹æ±‚è¶…æ™‚");Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //å¾ªç’°ç­‰å¾…ä¸€ä¸‹Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TimeUnit.MILLISECONDS.sleep(10);Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â Â Â Â Â //ç²å–çµæœÂ Â Â Â Â Â Â Â Â Â Â Â log.info("å®ŒæˆæŸ¥è©¢ï¼Œçµæœç‚ºï¼š"Â +Â result);Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â }}</code></pre><h1 class=pgc-h-arrow-right><strong>æ¸¬è©¦</strong></h1><pre><code>LoopTimeoutQueryÂ loopQueryÂ =Â newÂ LoopTimeoutQuery();loopQuery.asyncToSync();</code></pre><p>æ—¥èªŒå¦‚ä¸‹ï¼š</p><pre><code>[INFO]Â [2020-10-08Â 10:04:58.091]Â [main]Â [c.g.h.s.t.d.AbstractQuery.startQuery]Â -Â é–‹å§‹æŸ¥è©¢...[INFO]Â [2020-10-08Â 10:04:58.092]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â é ç¨‹èª¿ç”¨é–‹å§‹ExceptionÂ inÂ threadÂ "main"Â java.lang.RuntimeException:Â è«‹æ±‚è¶…æ™‚Â atÂ com.github.houbb.sync.test.demo.LoopTimeoutQuery.endQuery(LoopTimeoutQuery.java:38)Â atÂ com.github.houbb.sync.test.demo.AbstractQuery.asyncToSync(AbstractQuery.java:26)Â atÂ com.github.houbb.sync.test.demo.LoopTimeoutQuery.main(LoopTimeoutQuery.java:55)[INFO]Â [2020-10-08Â 10:05:03.097]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â é ç¨‹èª¿ç”¨çµæŸ</code></pre><p>è¶…æ™‚æ™‚é–“æ˜¯å¯ä»¥è¨­å®šçš„ï¼Œå¹³æ™‚é–‹ç™¼ä¸­å¯ä»¥æ ¹æ“šè‡ªå·±çš„éŸ¿æ‡‰æ™‚é–“è¨­ç½®ã€‚</p><p>å¦‚æœè«‹æ±‚è¶…æ™‚ï¼Œè€ƒæ…®å°æ‡‰çš„å…œåº•æ–¹æ¡ˆã€‚</p><h1 class=pgc-h-arrow-right><strong>åŸºæ–¼ wait() & notifyAll()</strong></h1><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">ç°¡ä»‹</span></span></strong></h1><p>å¯¦éš›ä¸Š loop å¾ªç’°é‚„æ˜¯æ¯”è¼ƒæ¶ˆè€—æ€§èƒ½çš„ï¼Œå°æ–¼é€™ç¨®ç­‰å¾…ç‰¹æ€§, jdk å¯¦éš›ä¸Šç‚ºæˆ‘å€‘å°è£äº†å¤šç¨®ç‰¹æ€§ã€‚</p><p>æ¯”å¦‚æœ€å¸¸è¦‹çš„ wait() é€²å…¥ç­‰å¾…ï¼ŒnotifyAll() å–šé†’ç­‰å¾…çš„çµ„åˆæ–¹å¼ã€‚</p><p>é€™å€‹åŒæ™‚ä¹Ÿæ˜¯é˜»å¡éšŠåˆ—çš„å¯¦ç¾æ€æƒ³ï¼Œé˜»å¡éšŠåˆ—æˆ‘å€‘å°±ä¸ä»‹ç´¹äº†ï¼Œæˆ‘å€‘ä¾†çœ‹ä¸€ä¸‹ wait+notify çš„å¯¦ç¾æ–¹å¼ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">java å¯¦ç¾</span></span></strong></h1><pre><code>packageÂ com.github.houbb.sync.test.demo;importÂ com.github.houbb.log.integration.core.Log;importÂ com.github.houbb.log.integration.core.LogFactory;/**Â *Â wait+notifyÂ å¯¦ç¾Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ classÂ WaitNotifyQueryÂ extendsÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(WaitNotifyQuery.class);Â Â Â Â /**Â Â Â Â Â *Â è²æ˜å°è±¡Â Â Â Â Â */Â Â Â Â privateÂ finalÂ ObjectÂ lockÂ =Â newÂ Object();Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ remoteCall()Â {Â Â Â Â Â Â Â Â super.remoteCall();Â Â Â Â Â Â Â Â synchronizedÂ (lock)Â {Â Â Â Â Â Â Â Â Â Â Â Â log.info("é ç¨‹ç·šç¨‹åŸ·è¡Œå®Œæˆï¼Œå–šé†’æ‰€æœ‰ç­‰å¾…ã€‚");Â Â Â Â Â Â Â Â Â Â Â Â lock.notifyAll();Â Â Â Â Â Â Â Â }Â Â Â Â }Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ endQuery()Â {Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â //Â ç­‰å¾…Â 10sÂ Â Â Â Â Â Â Â Â Â Â Â synchronizedÂ (lock)Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log.info("ä¸»ç·šç¨‹é€²å…¥ç­‰å¾…");Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lock.wait(10Â *Â 1000);Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â super.endQuery();Â Â Â Â }Â Â Â Â publicÂ staticÂ voidÂ main(String[]Â args)Â {Â Â Â Â Â Â Â Â WaitNotifyQueryÂ queryÂ =Â newÂ WaitNotifyQuery();Â Â Â Â Â Â Â Â query.asyncToSync();Â Â Â Â }}</code></pre><p>æ³¨æ„ï¼šç·¨ç¨‹æ™‚éœ€è¦ä½¿ç”¨ synchronized ä¿è­‰é–çš„æŒæœ‰è€…ç·šç¨‹å®‰å…¨ï¼Œä¸ç„¶æœƒå ±éŒ¯ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">æ¸¬è©¦</span></span></strong></h1><p>æ—¥èªŒå¦‚ä¸‹ï¼š</p><pre><code>[INFO]Â [2020-10-08Â 11:05:50.769]Â [main]Â [c.g.h.s.t.d.AbstractQuery.startQuery]Â -Â é–‹å§‹æŸ¥è©¢...[INFO]Â [2020-10-08Â 11:05:50.770]Â [main]Â [c.g.h.s.t.d.WaitNotifyQuery.endQuery]Â -Â ä¸»ç·šç¨‹é€²å…¥ç­‰å¾…[INFO]Â [2020-10-08Â 11:05:50.770]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â é ç¨‹èª¿ç”¨é–‹å§‹[INFO]Â [2020-10-08Â 11:05:55.772]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â é ç¨‹èª¿ç”¨çµæŸ[INFO]Â [2020-10-08Â 11:05:55.773]Â [Thread-0]Â [c.g.h.s.t.d.WaitNotifyQuery.remoteCall]Â -Â é ç¨‹ç·šç¨‹åŸ·è¡Œå®Œæˆï¼Œå–šé†’æ‰€æœ‰ç­‰å¾…ã€‚[INFO]Â [2020-10-08Â 11:05:55.773]Â [main]Â [c.g.h.s.t.d.AbstractQuery.endQuery]Â -Â å®ŒæˆæŸ¥è©¢ï¼Œçµæœç‚ºï¼šsuccess</code></pre><h1 class=pgc-h-arrow-right><strong>åŸºæ–¼æ¢ä»¶é–çš„å¯¦ç¾</strong></h1><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">æ¢ä»¶é–ç°¡ä»‹</span></span></strong></h1><p>å¦‚æœä½ æƒ³ç·¨å¯«ä¸€å€‹å«æœ‰å¤šå€‹æ¢ä»¶è¬‚è©çš„ä½µç™¼å°è±¡,æˆ–è€…ä½ æƒ³ç²å¾—æ¯”æ¢ä»¶éšŠåˆ—çš„å¯è¦‹æ€§ä¹‹å¤–æ›´å¤šçš„æ§åˆ¶æ¬Š,é‚£éº¼é¡¯å¼çš„Lockå’ŒConditionçš„å¯¦ç¾é¡æä¾›äº†ä¸€å€‹<strong>æ¯”å…§éƒ¨é–å’Œæ¢ä»¶éšŠåˆ—æ›´åŠ éˆæ´»çš„é¸æ“‡ã€‚</strong></p><p>å¦‚åŒLockæä¾›äº†æ¯”å…§éƒ¨åŠ é–è¦è±å¯Œå¾—å¤šçš„ç‰¹å¾µé›†ä¸€æ¨£,Conditionä¹Ÿæä¾›äº†æ¯”å…§éƒ¨æ¢ä»¶éšŠåˆ—è¦è±å¯Œå¾—å¤šçš„ç‰¹å¾µé›†:</p><p>æ¯å€‹é–å¯ä»¥æœ‰å¤šå€‹ç­‰å¾…é›†(å› awaitæ›èµ·çš„ç·šç¨‹çš„é›†åˆ)ã€å¯ä¸­æ–·/ä¸å¯ä¸­æ–·çš„æ¢ä»¶ç­‰å¾…ã€åŸºæ–¼æ™‚é™çš„ç­‰å¾…ä»¥åŠå…¬å¹³/éå…¬å¹³éšŠåˆ—ä¹‹é–“çš„é¸æ“‡.</p><blockquote class=pgc-blockquote-abstract><p><span style="background-color:#fff9f9;--tt-darkmode-bgcolor: #151515">Condition ä»‹ç´¹</span></p></blockquote><p>æ³¨æ„äº‹é …:</p><p>waitã€notifyå’ŒnotifyAllåœ¨Conditionå°è±¡ä¸­çš„å°ç­‰é«”æ˜¯awaitã€signalå’ŒsignalAll.</p><p>ä½†æ˜¯,Conditionç¹¼æ‰¿èˆ‡Object,é€™æ„å‘³è‘—å®ƒä¹Ÿæœ‰waitå’Œnotifyæ–¹æ³•.</p><p>ä¸€å®šè¦ç¢ºä¿ä½¿ç”¨äº†æ­£ç¢ºçš„ç‰ˆæœ¬â€“awaitå’Œsignal!</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">java å¯¦ç¾</span></span></strong></h1><p>ç‚ºäº†æ¼”ç¤ºç°¡å–®ï¼Œæˆ‘å€‘ç›´æ¥é¸æ“‡å¯é‡å…¥é–å³å¯ã€‚</p><p>ä¸€å€‹Conditionå’Œä¸€å€‹å–®ç¨çš„Lockç›¸é—œè¯,å°±åƒæ¢ä»¶éšŠåˆ—å’Œå–®ç¨çš„å…§éƒ¨é–ç›¸é—œè¯ä¸€æ¨£;</p><p>èª¿ç”¨èˆ‡Conditionç›¸é—œè¯çš„Lockçš„Lock.newConditionæ–¹æ³•,å¯ä»¥å‰µå»ºä¸€å€‹Condition.</p><pre><code>packageÂ com.github.houbb.sync.test.demo;importÂ com.github.houbb.log.integration.core.Log;importÂ com.github.houbb.log.integration.core.LogFactory;importÂ java.util.concurrent.locks.Condition;importÂ java.util.concurrent.locks.Lock;importÂ java.util.concurrent.locks.ReentrantLock;/**Â *Â æ¢ä»¶é–å¯¦ç¾Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ classÂ LockConditionQueryÂ extendsÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(LockConditionQuery.class);Â Â Â Â privateÂ finalÂ LockÂ lockÂ =Â newÂ ReentrantLock();Â Â Â Â privateÂ finalÂ ConditionÂ conditionÂ =Â lock.newCondition();Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ remoteCall()Â {Â Â Â Â Â Â Â Â lock.lock();Â Â Â Â Â Â Â Â try{Â Â Â Â Â Â Â Â Â Â Â Â super.remoteCall();Â Â Â Â Â Â Â Â Â Â Â Â log.info("é ç¨‹ç·šç¨‹åŸ·è¡Œå®Œæˆï¼Œå–šé†’æ‰€æœ‰ç­‰å¾…ç·šç¨‹ã€‚");Â Â Â Â Â Â Â Â Â Â Â Â condition.signalAll();Â Â Â Â Â Â Â Â }Â finallyÂ {Â Â Â Â Â Â Â Â Â Â Â Â lock.unlock();Â Â Â Â Â Â Â Â }Â Â Â Â }Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ endQuery()Â {Â Â Â Â Â Â Â Â lock.lock();Â Â Â Â Â Â Â Â try{Â Â Â Â Â Â Â Â Â Â Â Â //Â ç­‰å¾…Â Â Â Â Â Â Â Â Â Â Â Â log.info("ä¸»ç·šç¨‹é€²å…¥ç­‰å¾…");Â Â Â Â Â Â Â Â Â Â Â Â condition.await();Â Â Â Â Â Â Â Â Â Â Â Â super.endQuery();Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â finallyÂ {Â Â Â Â Â Â Â Â Â Â Â Â lock.unlock();Â Â Â Â Â Â Â Â }Â Â Â Â }Â Â Â Â publicÂ staticÂ voidÂ main(String[]Â args)Â {Â Â Â Â Â Â Â Â LockConditionQueryÂ queryÂ =Â newÂ LockConditionQuery();Â Â Â Â Â Â Â Â query.asyncToSync();Â Â Â Â }}</code></pre><p>å¯¦ç¾ä¹Ÿæ¯”è¼ƒç°¡å–®ï¼Œæˆ‘å€‘åœ¨æ–¹æ³•é€²å…¥ï¼Œèª¿ç”¨ lock.lock() åŠ é–ï¼Œfinally ä¸­èª¿ç”¨ lock.unlock() é‡‹æ”¾é–ã€‚</p><p><span style="color:#ef7060;--tt-darkmode-color: #EF7060">condition.await();</span> é€²å…¥ç­‰å¾…ï¼›<span style="color:#ef7060;--tt-darkmode-color: #EF7060">condition.signalAll();</span> å–šé†’æ‰€æœ‰ç­‰å¾…ç·šç¨‹ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">æ¸¬è©¦æ—¥èªŒ</span></span></strong></h1><pre><code>[INFO]Â [2020-10-08Â 12:33:40.985]Â [main]Â [c.g.h.s.t.d.AbstractQuery.startQuery]Â -Â é–‹å§‹æŸ¥è©¢...[INFO]Â [2020-10-08Â 12:33:40.986]Â [main]Â [c.g.h.s.t.d.LockConditionQuery.endQuery]Â -Â ä¸»ç·šç¨‹é€²å…¥ç­‰å¾…[INFO]Â [2020-10-08Â 12:33:40.987]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â é ç¨‹èª¿ç”¨é–‹å§‹[INFO]Â [2020-10-08Â 12:33:45.990]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â é ç¨‹èª¿ç”¨çµæŸ[INFO]Â [2020-10-08Â 12:33:45.991]Â [Thread-0]Â [c.g.h.s.t.d.LockConditionQuery.remoteCall]Â -Â é ç¨‹ç·šç¨‹åŸ·è¡Œå®Œæˆï¼Œå–šé†’æ‰€æœ‰ç­‰å¾…ç·šç¨‹ã€‚[INFO]Â [2020-10-08Â 12:33:45.993]Â [main]Â [c.g.h.s.t.d.AbstractQuery.endQuery]Â -Â å®ŒæˆæŸ¥è©¢ï¼Œçµæœç‚ºï¼šsuccess</code></pre><h1 class=pgc-h-arrow-right><strong>CountDownLatch é–‰é–å¯¦ç¾</strong></h1><p>CountDownLatch/Future/CyclicBarrier é€™ä¸‰å€‹éƒ½æ˜¯ jdk ç‚ºæˆ‘å€‘æä¾›çš„åŒæ­¥å·¥å…·é¡ï¼Œæˆ‘å€‘æ­¤è™•åªåšç°¡å–®ä»‹ç´¹ã€‚</p><p>è©³æƒ…åƒè¦‹ï¼š</p><blockquote class=pgc-blockquote-abstract><p><span style="background-color:#fff9f9;--tt-darkmode-bgcolor: #151515">JCIP-19-åŒæ­¥å·¥å…·é¡ã€‚é–‰é–/æŸµæ¬„/ä¿¡è™Ÿé‡/é˜»å¡éšŠåˆ—/FutureTask</span></p></blockquote><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">CountDownLatch ç°¡ä»‹</span></span></strong></h1><p>é–‰é–æ˜¯ä¸€ç¨®åŒæ­¥å·¥å…·é¡ï¼Œå¯ä»¥å»¶é²ç·šç¨‹çš„é€²åº¦ç›´åˆ°å…¶é”åˆ°çµ‚æ­¢ç‹€æ…‹ã€‚</p><p>é–‰é–çš„ä½œç”¨ç›¸ç•¶æ–¼ä¸€æ‰‡é–€ï¼šåœ¨é–‰é–åˆ°é”çµæŸç‹€æ…‹ä¹‹å‰ï¼Œé€™æ‰‡é–€ä¸€ç›´æ˜¯é—œé–‰çš„ï¼Œä¸¦ä¸”æ²’æœ‰ä»»ä½•ç·šç¨‹èƒ½é€šéï¼Œç•¶åˆ°é”çµæŸç‹€æ…‹æ™‚ï¼Œé€™æ‰‡é–€æœƒæ‰“é–‹ä¸¦å…è¨±æ‰€æœ‰çš„ç·šç¨‹é€šéã€‚</p><p>ç•¶é–‰é–åˆ°é”çµæŸç‹€æ…‹å¾Œï¼Œå°‡ä¸æœƒå†æ”¹è®Šç‹€æ…‹ï¼Œå› æ­¤é€™æ‰‡é–€å°‡æ°¸é ä¿æŒæ‰“é–‹ç‹€æ…‹ã€‚</p><p>é–‰é–å¯ä»¥ç”¨ä¾†ç¢ºä¿æŸäº›æ´»å‹•ç›´åˆ°å…¶å®ƒæ´»å‹•éƒ½å®Œæˆå¾Œæ‰ç¹¼çºŒåŸ·è¡Œã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">java ä»£ç¢¼å¯¦ç¾</span></span></strong></h1><pre><code>importÂ com.github.houbb.log.integration.core.Log;importÂ com.github.houbb.log.integration.core.LogFactory;importÂ java.util.concurrent.CountDownLatch;importÂ java.util.concurrent.TimeUnit;/**Â *Â CountDownLatchÂ å¯¦ç¾Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ classÂ CountDownLatchQueryÂ extendsÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(CountDownLatchQuery.class);Â Â Â Â /**Â Â Â Â Â *Â é–‰é–Â Â Â Â Â *Â èª¿ç”¨1æ¬¡ï¼Œå¾ŒçºŒæ–¹æ³•å³å¯é€šè¡Œã€‚Â Â Â Â Â */Â Â Â Â privateÂ finalÂ CountDownLatchÂ countDownLatchÂ =Â newÂ CountDownLatch(1);Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ remoteCall()Â {Â Â Â Â Â Â Â Â super.remoteCall();Â Â Â Â Â Â Â Â //Â èª¿ç”¨ä¸€æ¬¡é–‰é–Â Â Â Â Â Â Â Â countDownLatch.countDown();Â Â Â Â }Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ endQuery()Â {Â Â Â Â Â Â Â Â tryÂ {//Â Â Â Â Â Â Â Â Â Â Â Â countDownLatch.await();Â Â Â Â Â Â Â Â Â Â Â Â countDownLatch.await(10,Â TimeUnit.SECONDS);Â Â Â Â Â Â Â Â Â Â Â Â log.info("å®ŒæˆæŸ¥è©¢ï¼Œçµæœç‚ºï¼š"Â +Â result);Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â }Â Â Â Â publicÂ staticÂ voidÂ main(String[]Â args)Â {Â Â Â Â Â Â Â Â CountDownLatchQueryÂ loopQueryÂ =Â newÂ CountDownLatchQuery();Â Â Â Â Â Â Â Â loopQuery.asyncToSync();Â Â Â Â }}</code></pre><p>æˆ‘å€‘åœ¨è¿”å›çµæœä¹‹å‰èª¿ç”¨ <span style="color:#ef7060;--tt-darkmode-color: #EF7060">countDownLatch.await(10, TimeUnit.SECONDS);</span> é€²è¡Œç­‰å¾…ï¼Œé€™è£¡å¯ä»¥æŒ‡å®šè¶…æ™‚æ™‚é–“ã€‚</p><p>remoteCall() é ç¨‹å®Œæˆå¾Œï¼ŒåŸ·è¡Œä¸€ä¸‹ <span style="color:#ef7060;--tt-darkmode-color: #EF7060">countDownLatch.countDown();</span>ï¼Œé€²è€Œå¯ä»¥è®“ç¨‹åºç¹¼çºŒåŸ·è¡Œä¸‹å»ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">æ¸¬è©¦</span></span></strong></h1><h1 class=pgc-h-arrow-right><strong>ä»£ç¢¼</strong></h1><pre><code>CountDownLatchQueryÂ loopQueryÂ =Â newÂ CountDownLatchQuery();loopQuery.asyncToSync();</code></pre><h1 class=pgc-h-arrow-right><strong>æ—¥èªŒ</strong></h1><pre><code>[INFO]Â [2020-10-08Â 10:24:03.348]Â [main]Â [c.g.h.s.t.d.AbstractQuery.startQuery]Â -Â é–‹å§‹æŸ¥è©¢...[INFO]Â [2020-10-08Â 10:24:03.350]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â é ç¨‹èª¿ç”¨é–‹å§‹[INFO]Â [2020-10-08Â 10:24:08.353]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â é ç¨‹èª¿ç”¨çµæŸ[INFO]Â [2020-10-08Â 10:24:08.354]Â [main]Â [c.g.h.s.t.d.CountDownLatchQuery.endQuery]Â -Â å®ŒæˆæŸ¥è©¢ï¼Œçµæœç‚ºï¼šsuccess</code></pre><p>jdk æä¾›çš„é–‰é–åŠŸèƒ½é‚„æ˜¯éå¸¸çš„æ–¹ä¾¿çš„ã€‚</p><h1 class=pgc-h-arrow-right><strong>CyclicBarrier æŸµæ¬„</strong></h1><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">ç°¡ä»‹</span></span></strong></h1><p>æŸµæ¬„ï¼ˆBarrierï¼‰é¡ä¼¼æ–¼é–‰é–ï¼Œå®ƒèƒ½é˜»å¡ä¸€çµ„ç·šç¨‹ç›´åˆ°æŸå€‹äº‹ä»¶ç™¼ç”Ÿ[CPJ 4.4.3]ã€‚é–‰é–æ˜¯ä¸€æ¬¡æ€§å°è±¡ï¼Œä¸€æ—¦é€²å…¥æœ€çµ‚ç‹€æ…‹ï¼Œå°±ä¸èƒ½è¢«é‡ç½®äº†ã€‚</p><p><strong>æŸµæ¬„èˆ‡é–‰é–çš„é—œéµå€åˆ¥åœ¨æ–¼ï¼Œæ‰€æœ‰ç·šç¨‹å¿…é ˆåŒæ™‚é”åˆ°æŸµæ¬„ä½ç½®ï¼Œæ‰èƒ½ç¹¼çºŒåŸ·è¡Œã€‚é–‰é–ç”¨æ–¼ç­‰å¾…äº‹ä»¶ï¼Œè€ŒæŸµæ¬„ç”¨æ–¼ç­‰å¾…å…¶ä»–ç·šç¨‹ã€‚</strong></p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">java å¯¦ç¾</span></span></strong></h1><pre><code>packageÂ com.github.houbb.sync.test.demo;importÂ com.github.houbb.log.integration.core.Log;importÂ com.github.houbb.log.integration.core.LogFactory;importÂ java.util.concurrent.BrokenBarrierException;importÂ java.util.concurrent.CyclicBarrier;/**Â *Â CyclicBarrierÂ å¯¦ç¾Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ classÂ CyclicBarrierQueryÂ extendsÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(CyclicBarrierQuery.class);Â Â Â Â privateÂ CyclicBarrierÂ cyclicBarrierÂ =Â newÂ CyclicBarrier(2);Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ remoteCall()Â {Â Â Â Â Â Â Â Â super.remoteCall();Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â cyclicBarrier.await();Â Â Â Â Â Â Â Â Â Â Â Â log.info("é ç¨‹èª¿ç”¨é€²å…¥ç­‰å¾…");Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ |Â BrokenBarrierExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â }Â Â Â Â @OverrideÂ Â Â Â protectedÂ voidÂ endQuery()Â {Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â cyclicBarrier.await();Â Â Â Â Â Â Â Â Â Â Â Â log.info("ä¸»ç·šç¨‹é€²å…¥ç­‰å¾…");Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ |Â BrokenBarrierExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â super.endQuery();Â Â Â Â }}</code></pre><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">æ¸¬è©¦</span></span></strong></h1><h1 class=pgc-h-arrow-right><strong>ä»£ç¢¼</strong></h1><pre><code>publicÂ staticÂ voidÂ main(String[]Â args)Â {Â Â Â Â CyclicBarrierQueryÂ cyclicBarrierQueryÂ =Â newÂ CyclicBarrierQuery();Â Â Â Â cyclicBarrierQuery.asyncToSync();}</code></pre><h1 class=pgc-h-arrow-right><strong>æ—¥èªŒ</strong></h1><pre><code>[INFO]Â [2020-10-08Â 10:39:00.890]Â [main]Â [c.g.h.s.t.d.AbstractQuery.startQuery]Â -Â é–‹å§‹æŸ¥è©¢...[INFO]Â [2020-10-08Â 10:39:00.892]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â é ç¨‹èª¿ç”¨é–‹å§‹[INFO]Â [2020-10-08Â 10:39:05.894]Â [Thread-0]Â [c.g.h.s.t.d.AbstractQuery.remoteCall]Â -Â é ç¨‹èª¿ç”¨çµæŸ[INFO]Â [2020-10-08Â 10:39:05.895]Â [Thread-0]Â [c.g.h.s.t.d.CyclicBarrierQuery.remoteCall]Â -Â é ç¨‹èª¿ç”¨é€²å…¥ç­‰å¾…[INFO]Â [2020-10-08Â 10:39:05.895]Â [main]Â [c.g.h.s.t.d.CyclicBarrierQuery.endQuery]Â -Â ä¸»ç·šç¨‹é€²å…¥ç­‰å¾…[INFO]Â [2020-10-08Â 10:39:05.896]Â [main]Â [c.g.h.s.t.d.AbstractQuery.endQuery]Â -Â å®ŒæˆæŸ¥è©¢ï¼Œçµæœç‚ºï¼šsuccess</code></pre><p>å¯ä»¥çœ‹å‡ºé ç¨‹ç·šç¨‹ <span style="color:#ef7060;--tt-darkmode-color: #EF7060">Thread-0</span> åŸ·è¡Œå®Œä¹‹å¾Œå°±é€²å…¥ç­‰å¾…ï¼Œæ­¤æ™‚ä¸»ç·šç¨‹èª¿ç”¨ï¼Œç„¶å¾Œä¹Ÿé€²å…¥ç­‰å¾…ã€‚</p><p>ç­‰ä¸»ç·šç¨‹ endQuery ç­‰å¾…æ™‚ï¼Œå°±æ»¿è¶³äº†å…©å€‹ç·šç¨‹åŒæ™‚ç­‰å¾…ï¼Œç„¶å¾ŒåŸ·è¡Œå°±çµæŸäº†ã€‚</p><h1 class=pgc-h-arrow-right><strong>åŸºæ–¼ Future å¯¦ç¾</strong></h1><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">Future ç°¡ä»‹</span></span></strong></h1><p>Futureæ¨¡å¼å¯ä»¥é€™æ¨£ä¾†æè¿°ï¼šæˆ‘æœ‰ä¸€å€‹ä»»å‹™ï¼Œæäº¤çµ¦äº†Futureï¼ŒFutureæ›¿æˆ‘å®Œæˆé€™å€‹ä»»å‹™ã€‚æœŸé–“æˆ‘è‡ªå·±å¯ä»¥å»åšä»»ä½•æƒ³åšçš„äº‹æƒ…ã€‚ä¸€æ®µæ™‚é–“ä¹‹å¾Œï¼Œæˆ‘å°±ä¾¿å¯ä»¥å¾Futureé‚£å…’å–å‡ºçµæœã€‚å°±ç›¸ç•¶æ–¼ä¸‹äº†ä¸€å¼µè¨‚è²¨å–®ï¼Œä¸€æ®µæ™‚é–“å¾Œå¯ä»¥æ‹¿è‘—æè¨‚å–®ä¾†æè²¨ï¼Œé€™æœŸé–“å¯ä»¥å¹¹åˆ¥çš„ä»»ä½•äº‹æƒ…ã€‚å…¶ä¸­Future æ¥å£å°±æ˜¯è¨‚è²¨å–®ï¼ŒçœŸæ­£è™•ç†è¨‚å–®çš„æ˜¯Executoré¡ï¼Œå®ƒæ ¹æ“šFutureæ¥å£çš„è¦æ±‚ä¾†ç”Ÿç”¢ç”¢å“ã€‚</p><p>Futureæ¥å£æä¾›æ–¹æ³•ä¾†æª¢æ¸¬ä»»å‹™æ˜¯å¦è¢«åŸ·è¡Œå®Œï¼Œç­‰å¾…ä»»å‹™åŸ·è¡Œå®Œç²å¾—çµæœï¼Œä¹Ÿå¯ä»¥è¨­ç½®ä»»å‹™åŸ·è¡Œçš„è¶…æ™‚æ™‚é–“ã€‚é€™å€‹è¨­ç½®è¶…æ™‚çš„æ–¹æ³•å°±æ˜¯å¯¦ç¾Javaç¨‹åºåŸ·è¡Œè¶…æ™‚çš„é—œéµã€‚</p><p>è©³ç´°ä»‹ç´¹ï¼š</p><blockquote class=pgc-blockquote-abstract><p><span style="background-color:#fff9f9;--tt-darkmode-bgcolor: #151515">JCIP-26-Executor Future FutureTask</span></p></blockquote><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">java ä»£ç¢¼å¯¦ç¾</span></span></strong></h1><p>æ¡ç”¨ Future è¿”å›å’Œä»¥å‰çš„å¯¦ç¾å·®ç•°è¼ƒå¤§ï¼Œæˆ‘å€‘ç›´æ¥è¦†å¯«ä»¥å‰çš„æ–¹æ³•å³å¯ã€‚</p><pre><code>importÂ com.github.houbb.log.integration.core.Log;importÂ com.github.houbb.log.integration.core.LogFactory;importÂ java.util.concurrent.*;/**Â *Â FutureÂ å¯¦ç¾Â *Â @authorÂ binbin.houÂ *Â @sinceÂ 1.0.0Â */publicÂ classÂ FutureQueryÂ extendsÂ AbstractQueryÂ {Â Â Â Â privateÂ staticÂ finalÂ LogÂ logÂ =Â LogFactory.getLog(FutureQuery.class);Â Â Â Â privateÂ finalÂ ExecutorServiceÂ executorServiceÂ =Â Executors.newSingleThreadExecutor();Â Â Â Â @OverrideÂ Â Â Â publicÂ voidÂ asyncToSync()Â {Â Â Â Â Â Â Â Â //1.Â é–‹å§‹èª¿ç”¨Â Â Â Â Â Â Â Â super.startQuery();Â Â Â Â Â Â Â Â //2.Â é ç¨‹èª¿ç”¨Â Â Â Â Â Â Â Â Future&lt;String&gt;Â stringFutureÂ =Â remoteCallFuture();Â Â Â Â Â Â Â Â //3.Â å®ŒæˆçµæœÂ Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â StringÂ resultÂ =Â stringFuture.get(10,Â TimeUnit.SECONDS);Â Â Â Â Â Â Â Â Â Â Â Â log.info("èª¿ç”¨çµæœï¼š{}",Â result);Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ |Â TimeoutExceptionÂ |Â ExecutionExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â }Â Â Â Â /**Â Â Â Â Â *Â é ç¨‹èª¿ç”¨Â Â Â Â Â *Â @returnÂ FutureÂ ä¿¡æ¯Â Â Â Â Â */Â Â Â Â privateÂ Future&lt;String&gt;Â remoteCallFuture()Â {Â Â Â Â Â Â Â Â FutureTask&lt;String&gt;Â futureTaskÂ =Â newÂ FutureTask&lt;&gt;(newÂ Callable&lt;String&gt;()Â {Â Â Â Â Â Â Â Â Â Â Â Â @OverrideÂ Â Â Â Â Â Â Â Â Â Â Â publicÂ StringÂ call()Â throwsÂ ExceptionÂ {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log.info("é–‹å§‹ç•°æ­¥èª¿ç”¨");Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TimeUnit.SECONDS.sleep(5);Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log.info("å®Œæˆç•°æ­¥èª¿ç”¨");Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ "success";Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â });Â Â Â Â Â Â Â Â executorService.submit(futureTask);Â Â Â Â Â Â Â Â //Â é—œé–‰ç·šç¨‹æ± Â Â Â Â Â Â Â Â executorService.shutdown();Â Â Â Â Â Â Â Â returnÂ futureTask;Â Â Â Â }Â Â Â Â publicÂ staticÂ voidÂ main(String[]Â args)Â {Â Â Â Â Â Â Â Â FutureQueryÂ queryÂ =Â newÂ FutureQuery();Â Â Â Â Â Â Â Â query.asyncToSync();Â Â Â Â }}</code></pre><p>é ç¨‹èª¿ç”¨åŸ·è¡Œæ™‚ï¼Œæ˜¯ä¸€å€‹ FutureTaskï¼Œç„¶å¾Œæäº¤åˆ°ç·šç¨‹æ± å»åŸ·è¡Œã€‚</p><p>ç²å–çµæœçš„æ™‚å€™ï¼Œ<span style="color:#ef7060;--tt-darkmode-color: #EF7060">stringFuture.get(10, TimeUnit.SECONDS)</span> å¯ä»¥æŒ‡å®šç²å–çš„è¶…æ™‚æ™‚é–“ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">æ—¥èªŒ</span></span></strong></h1><p>æ¸¬è©¦æ—¥èªŒå¦‚ä¸‹:</p><pre><code>[INFO]Â [2020-10-08Â 12:52:05.175]Â [main]Â [c.g.h.s.t.d.AbstractQuery.startQuery]Â -Â é–‹å§‹æŸ¥è©¢...[INFO]Â [2020-10-08Â 12:52:05.177]Â [pool-1-thread-1]Â [c.g.h.s.t.d.FutureQuery.call]Â -Â é–‹å§‹ç•°æ­¥èª¿ç”¨[INFO]Â [2020-10-08Â 12:52:10.181]Â [pool-1-thread-1]Â [c.g.h.s.t.d.FutureQuery.call]Â -Â å®Œæˆç•°æ­¥èª¿ç”¨[INFO]Â [2020-10-08Â 12:52:10.185]Â [main]Â [c.g.h.s.t.d.FutureQuery.asyncToSync]Â -Â èª¿ç”¨çµæœï¼šsuccess</code></pre><h1 class=pgc-h-arrow-right><strong>Spring EventListener</strong></h1><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">spring äº‹ä»¶ç›£è½å™¨æ¨¡å¼</span></span></strong></h1><p>å°æ–¼ä¸€ä»¶äº‹æƒ…å®Œæˆçš„çµæœèª¿ç”¨ï¼Œä½¿ç”¨è§€å¯Ÿè€…æ¨¡å¼æ˜¯éå¸¸é©åˆçš„ã€‚</p><p>spring ç‚ºæˆ‘å€‘æä¾›äº†æ¯”è¼ƒå¼·å¤§çš„ç›£è½æ©Ÿåˆ¶ï¼Œæ­¤è™•æ¼”ç¤ºä¸‹çµåˆ spring ä½¿ç”¨çš„ä¾‹å­ã€‚</p><p>ps: é€™å€‹ä¾‹å­æ˜¯2å¹´å‰çš„è‡ªå·±å¯«çš„ä¾‹å­äº†ï¼Œæ­¤è™•ç‚ºäº†æ•´å€‹ç³»åˆ—çš„å®Œæ•´æ€§ï¼Œç›´æ¥æ¬éä¾†ä½œç‚ºè£œå……ã€‚</p><h1 class=pgc-h-arrow-right><strong><span style="color:#fff;--tt-darkmode-color: #FFFFFF"><span style="background-color:#ef7060;--tt-darkmode-bgcolor: #EF7060">ä»£ç¢¼å¯¦ç¾</span></span></strong></h1><ul><li>BookingCreatedEvent.java</li></ul><p>å®šç¾©ä¸€å€‹å‚³è¼¸å±¬æ€§çš„å°è±¡ã€‚</p><pre><code>publicÂ classÂ BookingCreatedEventÂ extendsÂ ApplicationEventÂ {Â Â Â Â privateÂ staticÂ finalÂ longÂ serialVersionUIDÂ =Â -1387078212317348344L;Â Â Â Â privateÂ StringÂ info;Â Â Â Â publicÂ BookingCreatedEvent(ObjectÂ source)Â {Â Â Â Â Â Â Â Â super(source);Â Â Â Â }Â Â Â Â publicÂ BookingCreatedEvent(ObjectÂ source,Â StringÂ info)Â {Â Â Â Â Â Â Â Â super(source);Â Â Â Â Â Â Â Â this.infoÂ =Â info;Â Â Â Â }Â Â Â Â publicÂ StringÂ getInfo()Â {Â Â Â Â Â Â Â Â returnÂ info;Â Â Â Â }}</code></pre><ul><li>BookingService.java</li></ul><p>èªªæ˜ï¼šç•¶ <span style="color:#ef7060;--tt-darkmode-color: #EF7060">this.context.publishEvent(bookingCreatedEvent);</span> è§¸ç™¼æ™‚ï¼Œ æœƒè¢« <span style="color:#ef7060;--tt-darkmode-color: #EF7060">@EventListener</span> æŒ‡å®šçš„æ–¹æ³•ç›£è½åˆ°ã€‚</p><pre><code>importÂ org.springframework.beans.factory.annotation.Autowired;importÂ org.springframework.context.ApplicationContext;importÂ org.springframework.context.event.EventListener;importÂ org.springframework.stereotype.Service;importÂ java.util.concurrent.TimeUnit;@ServicepublicÂ classÂ BookingServiceÂ {Â Â Â Â @AutowiredÂ Â Â Â privateÂ ApplicationContextÂ context;Â Â Â Â privateÂ volatileÂ BookingCreatedEventÂ bookingCreatedEvent;Â Â Â Â /**Â Â Â Â Â *Â ç•°æ­¥è½‰åŒæ­¥æŸ¥è©¢Â Â Â Â Â *Â @paramÂ infoÂ Â Â Â Â *Â @returnÂ Â Â Â Â */Â Â Â Â publicÂ StringÂ asyncQuery(finalÂ StringÂ info)Â {Â Â Â Â Â Â Â Â query(info);Â Â Â Â Â Â Â Â newÂ Thread(newÂ Runnable()Â {Â Â Â Â Â Â Â Â Â Â Â Â @OverrideÂ Â Â Â Â Â Â Â Â Â Â Â publicÂ voidÂ run()Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â remoteCallback(info);Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â }).start();Â Â Â Â Â Â Â Â while(bookingCreatedEventÂ ==Â null)Â {Â Â Â Â Â Â Â Â Â Â Â Â //..Â ç©ºå¾ªç’°Â Â Â Â Â Â Â Â Â Â Â Â //Â çŸ­æš«ç­‰å¾…ã€‚Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TimeUnit.MILLISECONDS.sleep(1);Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //...Â Â Â Â Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â Â Â Â Â //2.Â ä½¿ç”¨å…©å€‹å–®ç¨çš„Â event...Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â finalÂ StringÂ resultÂ =Â bookingCreatedEvent.getInfo();Â Â Â Â Â Â Â Â bookingCreatedEventÂ =Â null;Â Â Â Â Â Â Â Â returnÂ result;Â Â Â Â }Â Â Â Â @EventListenerÂ Â Â Â publicÂ voidÂ onApplicationEvent(BookingCreatedEventÂ bookingCreatedEvent)Â {Â Â Â Â Â Â Â Â System.out.println("ç›£è½åˆ°é ç¨‹çš„ä¿¡æ¯:Â "Â +Â bookingCreatedEvent.getInfo());Â Â Â Â Â Â Â Â this.bookingCreatedEventÂ =Â bookingCreatedEvent;Â Â Â Â Â Â Â Â System.out.println("ç›£è½åˆ°é ç¨‹æ¶ˆæ¯å¾Œ:Â "Â +Â this.bookingCreatedEvent.getInfo());Â Â Â Â }Â Â Â Â /**Â Â Â Â Â *Â åŸ·è¡ŒæŸ¥è©¢Â Â Â Â Â *Â @paramÂ infoÂ Â Â Â Â */Â Â Â Â publicÂ voidÂ query(finalÂ StringÂ info)Â {Â Â Â Â Â Â Â Â System.out.println("é–‹å§‹æŸ¥è©¢:Â "Â +Â info);Â Â Â Â }Â Â Â Â /**Â Â Â Â Â *Â é ç¨‹å›èª¿Â Â Â Â Â *Â @paramÂ infoÂ Â Â Â Â */Â Â Â Â publicÂ voidÂ remoteCallback(finalÂ StringÂ info)Â {Â Â Â Â Â Â Â Â System.out.println("é ç¨‹å›èª¿é–‹å§‹:Â "Â +Â info);Â Â Â Â Â Â Â Â tryÂ {Â Â Â Â Â Â Â Â Â Â Â Â TimeUnit.SECONDS.sleep(2);Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â Â //Â é‡ç™¼çµæœäº‹ä»¶Â Â Â Â Â Â Â Â StringÂ resultÂ =Â infoÂ +Â "-result";Â Â Â Â Â Â Â Â BookingCreatedEventÂ bookingCreatedEventÂ =Â newÂ BookingCreatedEvent(this,Â result);Â Â Â Â Â Â Â Â //è§¸ç™¼eventÂ Â Â Â Â Â Â Â this.context.publishEvent(bookingCreatedEvent);Â Â Â Â }}</code></pre><ul><li>æ¸¬è©¦æ–¹æ³•</li></ul><pre><code>@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(classesÂ =Â SpringConfig.class)publicÂ classÂ BookServiceTestÂ {Â Â Â Â @AutowiredÂ Â Â Â privateÂ BookingServiceÂ bookingService;Â Â Â Â @TestÂ Â Â Â publicÂ voidÂ asyncQueryTest()Â {Â Â Â Â Â Â Â Â bookingService.asyncQuery("1234");Â Â Â Â }}</code></pre><ul><li>æ—¥èªŒ</li></ul><pre><code>2018-08-10Â 18:27:05.958Â Â INFOÂ Â [main]Â com.github.houbb.spring.lean.core.ioc.event.BookingService:84Â -Â é–‹å§‹æŸ¥è©¢:12342018-08-10Â 18:27:05.959Â Â INFOÂ Â [Thread-2]Â com.github.houbb.spring.lean.core.ioc.event.BookingService:93Â -Â é ç¨‹å›èª¿é–‹å§‹:1234æ¥æ”¶åˆ°ä¿¡æ¯:Â 1234-result2018-08-10Â 18:27:07.964Â Â INFOÂ Â [Thread-2]Â com.github.houbb.spring.lean.core.ioc.event.BookingService:73Â -Â ç›£è½åˆ°é ç¨‹çš„ä¿¡æ¯:Â 1234-result2018-08-10Â 18:27:07.964Â Â INFOÂ Â [Thread-2]Â com.github.houbb.spring.lean.core.ioc.event.BookingService:75Â -Â ç›£è½åˆ°é ç¨‹æ¶ˆæ¯å¾Œ:Â 1234-result2018-08-10Â 18:27:07.964Â Â INFOÂ Â [Thread-2]Â com.github.houbb.spring.lean.core.ioc.event.BookingService:106Â -Â å·²ç¶“è§¸ç™¼event2018-08-10Â 18:27:07.964Â Â INFOÂ Â [main]Â com.github.houbb.spring.lean.core.ioc.event.BookingService:67Â -Â æŸ¥è©¢çµæœ:Â 1234-result2018-08-10Â 18:27:07.968Â Â INFOÂ Â [Thread-1]Â org.springframework.context.support.GenericApplicationContext:993Â -Â ClosingÂ org.springframework.context.support.GenericApplicationContext@5cee5251:Â startupÂ dateÂ [FriÂ AugÂ 10Â 18:27:05Â CSTÂ 2018];Â rootÂ ofÂ contextÂ hierarchy</code></pre><h1 class=pgc-h-arrow-right><strong>å°çµ</strong></h1><p>æœ¬æ–‡å…±è¨ˆä»‹ç´¹äº† 7 ç¨®ç•°æ­¥è½‰åŒæ­¥çš„æ–¹å¼ï¼Œå¯¦éš›ä¸Šæ€æƒ³éƒ½æ˜¯ä¸€æ¨£çš„ã€‚</p><p>åœ¨ç•°æ­¥åŸ·è¡Œå®Œæˆå‰ç­‰å¾…ï¼ŒåŸ·è¡Œå®Œæˆå¾Œå–šé†’ç­‰å¾…å³å¯ã€‚</p><p>ç•¶ç„¶æˆ‘å¯«æœ¬æ–‡é™¤äº†ç¸½çµä»¥ä¸Šå¹¾ç¨®æ–¹å¼ä»¥å¤–ï¼Œé‚„æƒ³ç‚ºå¾ŒçºŒå¯«ä¸€å€‹ç•°æ­¥è½‰åŒæ­¥çš„å·¥å…·æä¾›åŸºç¤ã€‚</p><p>ä¸‹ä¸€ç¯€æˆ‘å€‘å°‡ä¸€èµ·å­¸ç¿’ä¸‹å¦‚ä½•å°‡é€™å€‹åŠŸèƒ½å°è£ç‚ºä¸€å€‹åŒæ­¥è½‰æ›æ¡†æ¶ï¼Œæ„Ÿèˆˆè¶£çš„å¯ä»¥é—œæ³¨ä¸€ä¸‹ï¼Œä¾¿æ–¼å¯¦æ™‚æ¥æ”¶æœ€æ–°å…§å®¹ã€‚</p><p>è¦ºå¾—æœ¬æ–‡å°ä½ æœ‰å¹«åŠ©çš„è©±ï¼Œæ­¡è¿é»è´Šè©•è«–æ”¶è—è½‰ç™¼ä¸€æ³¢ã€‚ä½ çš„é¼“å‹µï¼Œæ˜¯æˆ‘æœ€å¤§çš„å‹•åŠ›~</p><p>ä¸çŸ¥é“ä½ æœ‰å“ªäº›æ”¶ç©«å‘¢ï¼Ÿæˆ–è€…æœ‰å…¶ä»–æ›´å¤šçš„æƒ³æ³•ï¼Œæ­¡è¿ç•™è¨€å€å’Œæˆ‘ä¸€èµ·è¨è«–ï¼ŒæœŸå¾…èˆ‡ä½ çš„æ€è€ƒç›¸é‡ã€‚</p><h1 class=pgc-h-arrow-right><strong>ä»£ç¢¼åœ°å€</strong></h1><p>ç‚ºäº†ä¾¿æ–¼å­¸ç¿’ï¼Œæ–‡ä¸­çš„æ‰€æœ‰ä¾‹å­éƒ½å·²ç¶“é–‹æºï¼š</p><p>å¯¦ç¾ 1-6ï¼š</p><blockquote class=pgc-blockquote-abstract><p><span style="background-color:#fff9f9;--tt-darkmode-bgcolor: #151515">https://github.com/houbb/sync/tree/master/sync-test/src/main/java/com/github/houbb/sync/test/demo</span></p></blockquote><blockquote class=pgc-blockquote-abstract><p><span style="background-color:#fff9f9;--tt-darkmode-bgcolor: #151515">https://github.com/houbb/spring-framework-learn/tree/master/spring-learn-core/spring-core-ioc/src/main/java/com/github/houbb/spring/lean/core/ioc/event</span></p></blockquote></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>java</a></li><li><a>æ‰‹å¯«</a></li><li><a>ç•°æ­¥æŸ¥</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/69818103.html alt=javaç›¸é—œçŸ¥è­˜(10)ç¸½çµ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/84649e6ba0f8442a8b10584403bf6635 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/69818103.html title=javaç›¸é—œçŸ¥è­˜(10)ç¸½çµ>javaç›¸é—œçŸ¥è­˜(10)ç¸½çµ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/02729303.html alt=javaå¯¦æˆ°é …ç›®å¸¸ç”¨é¡ï¼ŒDateã€Calendarã€BigDecimalã€Mathã€UUID class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d69c7c9d8b85444da9360e334ba6555d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/02729303.html title=javaå¯¦æˆ°é …ç›®å¸¸ç”¨é¡ï¼ŒDateã€Calendarã€BigDecimalã€Mathã€UUID>javaå¯¦æˆ°é …ç›®å¸¸ç”¨é¡ï¼ŒDateã€Calendarã€BigDecimalã€Mathã€UUID</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5f8b26e0.html alt=å¤šæ…‹çš„æœ¬è³ªï¼Œjavaå‹•æ…‹ç¶å®š class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/50ac000493fbc8532b5e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5f8b26e0.html title=å¤šæ…‹çš„æœ¬è³ªï¼Œjavaå‹•æ…‹ç¶å®š>å¤šæ…‹çš„æœ¬è³ªï¼Œjavaå‹•æ…‹ç¶å®š</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2ea7884b.html alt=javaç¨‹åºå“¡æ³¨æ„ï¼šå°‘æœ‰äººçŸ¥çš„å“ˆå¸Œè¡çªè§£æ±ºç­–ç•¥ï¼Œå­¸åˆ°å°±æ˜¯è³ºåˆ° class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/54d45b20ef6a4a3f960411db61474538 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2ea7884b.html title=javaç¨‹åºå“¡æ³¨æ„ï¼šå°‘æœ‰äººçŸ¥çš„å“ˆå¸Œè¡çªè§£æ±ºç­–ç•¥ï¼Œå­¸åˆ°å°±æ˜¯è³ºåˆ°>javaç¨‹åºå“¡æ³¨æ„ï¼šå°‘æœ‰äººçŸ¥çš„å“ˆå¸Œè¡çªè§£æ±ºç­–ç•¥ï¼Œå­¸åˆ°å°±æ˜¯è³ºåˆ°</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/19cbd4c3.html alt="java å¸¸ç”¨çš„æ­£å‰‡è¡¨é”å¼" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1540129072390e6c4c05126 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/19cbd4c3.html title="java å¸¸ç”¨çš„æ­£å‰‡è¡¨é”å¼">java å¸¸ç”¨çš„æ­£å‰‡è¡¨é”å¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a81470d4.html alt=javaå¸¸ç”¨æ­£å‰‡è¡¨é”å¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/c811c3c14e4a4fa4825845b2868ee645 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a81470d4.html title=javaå¸¸ç”¨æ­£å‰‡è¡¨é”å¼>javaå¸¸ç”¨æ­£å‰‡è¡¨é”å¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d5b99796.html alt=javaæ­£å‰‡è¡¨é”å¼æ‹¬è™Ÿçš„ä½¿ç”¨ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/88ce74502881405281b2e2e5ae84f5d7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d5b99796.html title=javaæ­£å‰‡è¡¨é”å¼æ‹¬è™Ÿçš„ä½¿ç”¨>javaæ­£å‰‡è¡¨é”å¼æ‹¬è™Ÿçš„ä½¿ç”¨</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/03619879.html alt="java foreach  å°ç•°å¸¸çš„è™•ç†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/66551f46-dfc4-46b3-8cb2-b3551d77e648 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/03619879.html title="java foreach  å°ç•°å¸¸çš„è™•ç†">java foreach å°ç•°å¸¸çš„è™•ç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c67e6cfe.html alt=javaåå°„æ©Ÿåˆ¶çš„è¬›è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9ad2c92f100a4d2e8213dcf70d4781c0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c67e6cfe.html title=javaåå°„æ©Ÿåˆ¶çš„è¬›è§£>javaåå°„æ©Ÿåˆ¶çš„è¬›è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/feaf6fcd.html alt=æ‰‹å¯«å£ç´™ï½œä½ å¾é€™é‚Šèµ°å‘é‚£é‚Šï¼Œä½ é¿é–‹äº†æˆ‘çš„ä¸€ç”Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1535341020756dc1a9b3f3f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/feaf6fcd.html title=æ‰‹å¯«å£ç´™ï½œä½ å¾é€™é‚Šèµ°å‘é‚£é‚Šï¼Œä½ é¿é–‹äº†æˆ‘çš„ä¸€ç”Ÿ>æ‰‹å¯«å£ç´™ï½œä½ å¾é€™é‚Šèµ°å‘é‚£é‚Šï¼Œä½ é¿é–‹äº†æˆ‘çš„ä¸€ç”Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ff2ba73c.html alt=javaä½µç™¼ç·¨ç¨‹-å­¸ç¿’æ–¹æ³•ã€é€²ç¨‹å’Œç·šç¨‹çš„å€åˆ¥ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/96ffe13dbf2b45109664e14541532812 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ff2ba73c.html title=javaä½µç™¼ç·¨ç¨‹-å­¸ç¿’æ–¹æ³•ã€é€²ç¨‹å’Œç·šç¨‹çš„å€åˆ¥>javaä½µç™¼ç·¨ç¨‹-å­¸ç¿’æ–¹æ³•ã€é€²ç¨‹å’Œç·šç¨‹çš„å€åˆ¥</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b7ce9ac1.html alt=javaä½µç™¼ç·¨ç¨‹ä¹‹é€²ç¨‹ç‹€æ…‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/0779ab7cadfe428f8d74d66161aa48b4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b7ce9ac1.html title=javaä½µç™¼ç·¨ç¨‹ä¹‹é€²ç¨‹ç‹€æ…‹>javaä½µç™¼ç·¨ç¨‹ä¹‹é€²ç¨‹ç‹€æ…‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d62f6365.html alt=javaä½µç™¼ç·¨ç¨‹ä¹‹é€²ç¨‹èˆ‡ç·šç¨‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a1b777a6b4c24fc390776034329c92d2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d62f6365.html title=javaä½µç™¼ç·¨ç¨‹ä¹‹é€²ç¨‹èˆ‡ç·šç¨‹>javaä½µç™¼ç·¨ç¨‹ä¹‹é€²ç¨‹èˆ‡ç·šç¨‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/16ab9720.html alt=javaç·šç¨‹æ± è™•ç†å¤šä½µç™¼ï¼Œæ‰€æœ‰é€²ç¨‹åŸ·è¡Œå®Œå¾Œå†çµ±ä¸€è™•ç†çµæœ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/b0473c60-cc05-42ed-82b1-497bfe51bfcc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/16ab9720.html title=javaç·šç¨‹æ± è™•ç†å¤šä½µç™¼ï¼Œæ‰€æœ‰é€²ç¨‹åŸ·è¡Œå®Œå¾Œå†çµ±ä¸€è™•ç†çµæœ>javaç·šç¨‹æ± è™•ç†å¤šä½µç™¼ï¼Œæ‰€æœ‰é€²ç¨‹åŸ·è¡Œå®Œå¾Œå†çµ±ä¸€è™•ç†çµæœ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/527c993b.html alt=æ‰‹å‹•é€šéï¼Œjavaé€šéåå°„å’Œè‡ªå®šç¾©è¨»è§£å¯¦ç¾å¾Œè‡ºåƒæ•¸å€¼çš„é©—è­‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1535370707542a7e32b8c63 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/527c993b.html title=æ‰‹å‹•é€šéï¼Œjavaé€šéåå°„å’Œè‡ªå®šç¾©è¨»è§£å¯¦ç¾å¾Œè‡ºåƒæ•¸å€¼çš„é©—è­‰>æ‰‹å‹•é€šéï¼Œjavaé€šéåå°„å’Œè‡ªå®šç¾©è¨»è§£å¯¦ç¾å¾Œè‡ºåƒæ•¸å€¼çš„é©—è­‰</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>