<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 | 极客快訊</title><meta property="og:title" content="家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/d88ffc12f72642aba158be46661a7c07"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/dd498cd3.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/dd498cd3.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/dd498cd3.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/dd498cd3.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/dd498cd3.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/dd498cd3.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/dd498cd3.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/dd498cd3.html><meta property="article:published_time" content="2020-11-14T21:02:19+08:00"><meta property="article:modified_time" content="2020-11-14T21:02:19+08:00"><meta name=Keywords content><meta name=description content="家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/dd498cd3.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>本文作者：Vespa</p><p><strong>對於速度的渴求是我們與生俱來的天性，在這個千兆入戶光纖開始普及，5G移動網絡即將上線的時代，內網千兆鏈路100MB/S左右的傳輸性能，對於NAS等網絡存儲設備的用戶而言已不能滿足日益膨脹的速度需求。</strong></p><p><strong>高端玩家們開始嘗試利用光纖內網、萬兆銅纜、InfiniBand等一些企業級的技術手段提升傳輸性能；但是對於大多數普通玩家而言，技術入門、配置摸索的學習成本就讓人頭痛；設備、和線路改造的資金投入更加無法接受。好在技術的升級往往會跨越設備的壁壘，今天我們就來聊聊微軟為我們帶來的福利，利用Windows 最新SMB3實現簡單易用的多通道帶寬疊模式。</strong></p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/d88ffc12f72642aba158be46661a7c07><p class=pgc-img-caption></p></div><p><strong>對於不想看詳細內容，只關心使用方法的朋友，簡單概括如下：</strong></p><p><strong>1、多通道帶寬疊無需任何專用設備支持，普通集成網卡、傻瓜交換機均可實現，只要客戶機、服務器、交換機上的網口足夠就可以隨意疊加。</strong></p><p><strong>2、多通道帶寬疊基於軟件功能，無需任何專業設置，即插即用，方便穩定。但是需要服務器和客戶機安裝Windows 8、Server 2012以上操作系統，或者內置固件支持此特性。</strong></p><blockquote><p><strong>本文涉及SMB 3和多通道帶寬疊加均已安裝Windows 10系統的PC或者DIY NAS系統為例，對於成品NAS各大廠家的多通道帶寬疊功能目前還在測試階段，群暉已經可以通過SSH命令手動開啟，但是實際使用效果還不穩定，所以這次暫時不做分享。</strong></p></blockquote><p><strong>只要滿足以上兩方面，即可插上網線開始享受帶寬疊加帶來的高速快感。而對於想詳細瞭解這一功能與性能測試的朋友，請繼續看如下介紹和測試：</strong></p><p>技術背景</p><p><strong>本文所分享的多通道帶寬疊功能均基於使用SMB3協議進行的內網數據傳輸，通俗的來說就是Windows下通過共享的網絡驅動器進行的數據交換。對於FTP、NFS這些傳輸協議都是無效的。</strong></p><blockquote><p>SMB協議是微軟與Intel共同開發的網絡文件共享協議，通過該協議可以讓應用程序讀取和寫入文件以及從計算機網絡中的服務器程序請求服務。</p><p>SMB 協議可在其 TCP/IP 協議或其他網絡協議上使用。使用 SMB 協議時，應用程序（或應用程序用戶）可訪問遠程服務器上的文件或其他資源。這讓應用程序可以讀取、創建和更新遠程服務器上的文件。它還可以與任何設置為接收 SMB 客戶端請求的服務器程序通信，這種協議被廣泛的應用在NAS存儲中。</p></blockquote><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/56abd299997548ecbe22fbd09988cdaa><p class=pgc-img-caption></p></div><blockquote></blockquote><p>基於SMB 3的多帶寬疊加早已不是什麼新鮮的技術了，早在Windows 8發佈之初與之配套的SMB3.0規範便已實現，現在的Windows 10已經更新到3.1.1；我在2015年便有分享相關經驗的想法，卻一直拖拖拉拉直到現在才總算完成。對於一直催我更新的值友們這裡先說聲抱歉了。。。。</p><p><strong>目前基於傳統RJ45網絡接口+銅纜網線的有線網絡環境中，目前最常用的方法就是帶寬疊加，將多條獨立的千兆鏈接進行聚合、疊加，以實現總帶寬的擴容。目前常用的有鏈路聚合疊加（Link Aggregation Control Protocol）和SMB3多通道帶寬疊加（SMB 3 Multichannel）兩種方式，我們先看下他們之間的區別。</strong></p><p>鏈路聚合疊加（Link Aggregation Control Protocol）</p><blockquote><p>鏈路聚合（LACP）是基於IEEE802.3ad標準的網絡傳輸協議，指將多個物理端口匯聚在一起，形成一個邏輯端口，以實現出/入流量吞吐量在各端口的負載均衡並增加帶寬。</p></blockquote><p><strong>鏈路聚合最大的優勢在於屬於硬件層面的端口聚合，不侷限於某一種操作系統或者傳輸協議，這對於企業級較為複雜的網絡環境有著不可替代的作用。</strong></p><p>在NAS產品大量湧現的當下，鏈路聚合等相關技術為了眾多廠商的宣傳亮點之一。支持鏈路聚合的NAS產品都具備2個以上的LAN接口，按照廠家的宣傳，通過將網口聚合，可以達到2Gbps以上的傳輸帶寬。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e6c071ee6b86443684c7a971c115e783><p class=pgc-img-caption></p></div><p>從技術本質上來說廠家的描述沒有什麼問題，只不過因為大多數消費者都並非精通網絡技術，所以對於鏈路聚合產生了不切實際的幻想。</p><p>實際使用情況以下圖為例：</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/3bf39a23b8ec4033b377cd62d0293d13><p class=pgc-img-caption></p></div><p>當存儲服務器與交換機均支持LACP相關協議並完成設置後，兩者之間的網絡連接就實現了帶寬聚合。若服務器有兩個網口，則聚合後的總帶寬為2Gbps。兩臺客戶端使用千兆有線鏈路連接交換機同時存取服務器上的數據時，兩者均可達到1Gbps的讀寫速度；此時服務器端網絡總吞吐帶寬也達到了2Gbps。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2a13d6a8716a43aa8dfa28d0bc0f8572><p class=pgc-img-caption></p></div><p>但是如果按照下圖，單客戶端加兩條千兆有線鏈路連接交換機存取服務器上的數據，則有效傳輸帶寬依然為1Gpbs，無法利用疊加後的2Gpbs帶寬。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/31bf347b91c44e3ba256a29c16f50f18><p class=pgc-img-caption></p></div><p><strong>所以這裡需要強調，鏈路聚合是帶寬疊加技術的一種，但是他只對於交換機-交換機、交換機-服務器之間的鏈路進行疊加，無法提升點對點的傳輸帶寬。</strong></p><p>SMB3多通道帶寬疊加（SMB 3 Multichannel）</p><p>多通道帶寬疊是SMB3規範眾多新功能中的一項，以下圖為例：</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/f4bae401e48d455e868dd3b6d55badd6><p class=pgc-img-caption></p></div><p>假設服務器與客戶機均配有多網卡，如啟用SMB多通道模式，系統則會利多通道技術，會對每個會話建立多個TCP/IP連接，這樣就可以充分提高整個鏈路的吞吐而實現物理帶寬的疊加。<strong>不過這種帶寬疊加僅僅支持使用SMB3規範的數據傳輸，對於其他數據傳輸協議均無效。</strong></p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/ef9798164a0345c1bade4e1d0b809330><p class=pgc-img-caption></p></div><p><strong>兩種技術之間的具體區別如下：</strong></p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c4ab33c88fdb4b1e98832716fd9f10f7><p class=pgc-img-caption></p></div><p>對於網絡系統規模較小、應用較為單一的個人、家庭用戶而言，使用SMB3的多通道功能來提升內網傳輸速度，無論在投入的設備成本、學習成本還是實際效果表現來看都遠高於傳統的LACP鏈路聚合技術。唯一對於操作系統方面的限制在Windows10已經廣泛普及的當下也已不再是障礙。</p><p>硬件選購</p><p>實現SMB3規範下的多通道帶寬疊加功能是不需要添加任何專用設備的，不過為了實現帶寬疊加就需要更多的網口來接通更多的傳輸鏈路，所以假如這方面硬件規格不足的朋友還是需要增加一些基礎設備的。</p><p>網卡</p><p><strong>對於帶寬要求不高，且服務器和客戶機上已經集成雙網卡的用戶，其實並不需要在單獨採購網卡。對於像我一樣希望使用更高帶寬的用戶可能需要再選購一塊多端口網卡</strong></p><p>正規渠道的多端口千兆網卡價格都很貴。淘寶上有拆機的二手網卡，價格低廉，但存在假貨的風險，所以建議瞭解清楚情況後再下手。我最終通過HP代理購入了2塊NC364T 四端口千兆網卡。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a744d7184659465dab37915a12274ac0><p class=pgc-img-caption></p></div><p>交換機我選用NETGEAR GS316 16口千兆交換機，非網關傻瓜交換機，做工優良，價格便宜。假如對於帶寬要求不朋友也可以使用更加實惠的8口交換機，甚至路由器附帶的LAN接口。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5fc48a18419848a0bc616a10f04eadef><p class=pgc-img-caption></p></div><p><strong>美國網件（NETGEAR）GS316 16口全千兆非網管交換機 中小型企業商用以太網交換機429元</strong>京東</p><p>去購買</p><p>NETGEAR GS316採用網口平鋪佈局，體型扁平且小巧，便於在我狹小的書房中安裝與佈線；而16個千兆接口也讓我足夠使用盡情折騰。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8fd3c36b030145faa92a90146cf6bf27><p class=pgc-img-caption></p></div><p>功能配置</p><p>實現SMB3的多通道功能非常簡單，只需滿足以下條件即可</p><p>1、服務器與客戶端基於Windows8以上操作系統，或者支持SMB 3；</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e30abf93cd5b4042b26fa057d0a9fd6e><p class=pgc-img-caption></p></div><p>不同Windows系統組合之間所能夠支持的最高的SMB版本</p><p>2、服務器和客戶端的所有網線都在同一網關下的內網中，最好都接於同一臺服務器。</p><p>當以上條件條件都滿足，且兩者間存在一條以上網絡鏈接，便可自動實現帶寬疊加功能，無需進行任何相關係統參數配置。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/db48c68d086249aab3a0f8304a49523e><p class=pgc-img-caption></p></div><p>實際使用時由於存在多個網絡端口，服務器和客戶機會存在多個IP地址，但用戶無需考慮這些，直接使用服務器主機名或者服務器任意IP地址進行文件瀏覽和數據傳輸，都可享受多通道功能帶來的網速疊加體驗。</p><p>性能測試</p><p>測試環境</p><p><strong>服務器與客戶端相關硬件規格</strong></p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/8bece9fa599342a592b6e24a85d4f077><p class=pgc-img-caption></p></div><p>服務器我使用主板集成網卡和PCI-E 4端口千兆網卡建立了達到6Gbps的疊加帶寬，主客戶機則一共使用了5個千兆網口，總疊加帶寬為5Gbps。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/370dea01d96d41bba4ca16af0bd46391><p class=pgc-img-caption></p></div><p><strong>服務器與客戶端所用硬盤測試性能如下：</strong></p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5428464060664389b7345764dece824c><p class=pgc-img-caption></p></div><p>客戶機所用三星 SM951 256G硬盤因為使用M.2接口使用NVME接口規範，所以讀寫速度對於網絡傳輸負載來說不存在任何瓶頸。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/5da175b37e6d4596854af4dbed2060c8><p class=pgc-img-caption></p></div><p>服務器所用的Sandisk Extreme II 480G屬於較早期產品，所以速度不及支持NVME規範的產品，實際讀取551MB/S、寫入427MB/S對於高帶寬疊加還是存在一定瓶頸，尤其是寫入性能。</p><p>雙鏈路帶寬疊加</p><p>首先測試一下雙鏈路下的帶寬疊加，此狀態下服務器與客戶機只需具備雙網口即可實現。這對於很多用戶來說這是最容易實現也最為有效的提速方式。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5ecc7870d056400faffeae33b46e6985><p class=pgc-img-caption></p></div><p>雙路網絡鏈接總帶寬2Gpbs，理論傳輸速度為256MB/S。客戶機通過SMB協議複製服務器中的數據時，點對點的實際傳輸帶寬輕鬆突破220MB/S傳輸速度。因為傳輸速度均在兩端SSD硬盤的讀寫性能範圍之內，所以傳輸曲線相當平滑，兩條千兆鏈路均處於滿負荷吞吐狀態。</p><p>三鏈路帶寬疊加：</p><p>服務器與客戶機之間增加一條千兆有線鏈路，理論帶寬為3Gbps。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d62ff1bd8e4c4a999da97fc965a6add1><p class=pgc-img-caption></p></div><p>實際傳輸速度338MB/S，曲線平穩，三條千兆鏈路依然處於滿負荷吞吐狀態。可以看出似乎只要在兩端硬盤讀寫性能之內，疊加的帶寬就可以全力釋放出接近與理論帶寬的傳輸性能。</p><p>五鏈路帶寬疊加：</p><p>接下來我不打算依次增加鏈路數量，直接將我客戶機與服務器上網絡端口全部開啟，共計5條千兆鏈路實現了5Gbps的理論數據帶寬，數據帶寬已經達到服務器上SSD硬盤讀寫性能極限；而此時網絡端口的佔用也達到了10個，所以這種模式作為極限狀態測試。我詳細測試客戶機從服務器讀取數據和客戶機向服務器寫入數據兩種傳輸模式下的性能表現。</p><p><strong>服務器向客戶端傳輸數據，此時服務器端硬盤為讀取狀態，客戶端硬盤為寫入狀態。</strong></p><p>此時網絡傳輸帶寬與服務器端的SSD的讀取性能基本相當，傳輸曲線變不如前兩次測試那樣平滑了，不過平均速度依然維持在480MB/S的水平，這對於網絡傳輸算是相當可觀的性能了。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/8d1d4c7058bc40cfb517761719afd3be><p class=pgc-img-caption></p></div><p><strong>客戶端向服務器傳輸數據，此時服務器端硬盤為寫入狀態，客戶端硬盤為讀取狀態。</strong></p><p>網絡傳輸性能超過服務器SSD的寫入性能，傳輸曲線出現比較劇烈的波動，這應該是SSD主控芯片滿負荷運行時產生的。最終平均傳輸速度穩定為410MB/S，這也與之前測試的數據基本吻合。</p><p>而且通過這次測試還可以看出，當總體傳輸出現波動時，每塊網卡同樣隨之波動，而且5快網卡的大致波形基本吻合，這也印證了SMB3網絡多條通道中的負載均衡功能發揮了作用。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/64e9b7d3e0594afba7a8b72f280be417><p class=pgc-img-caption></p></div><p>功能體驗</p><p>鏈路冗餘</p><p>首先以5條千兆鏈路同時工作開始數據傳輸，初始傳輸速度約480MB/S，然後我開始依次拔掉交換機上的網線接口，以模擬網絡出現故障時的狀態，最終我只保留一條網線來保持連接。然後我再依此插回網線，繼續模擬網絡恢復。最終完成測試後的數據傳輸曲線如下：</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/9954a28e9ff64eb389ec738bff48ba10><p class=pgc-img-caption></p></div><p>可以看出當進行帶寬疊加的端口組中，如果有一個或幾個帶寬出現故障時，系統會自動將剩餘端口繼續傳輸數據；而當網絡恢復後系統也會立即將其加入到正在進行的數據傳輸中。整體都是動態進行調整的，一部分端口的故障或者恢復均不會影響整體數據傳輸的連貫性。</p><p>同時我們可以看出，每次端口增加或者減少後，整體的傳輸曲線只會成臺階狀的整體上升、下降，並不會出現劇烈的波動，這也可以驗證出在單客戶端傳輸環境下，負載均衡機制很好的發揮了作用，使網絡傳輸更加穩定。</p><p>多客戶端負載均衡</p><p>我找了兩臺客戶端來進行測試，一臺配備了5個千兆網絡接口，與服務器實現5鏈路聚合；而另一臺僅適用單千兆網口與服務器相連。兩臺客戶端同時與服務器進行數據傳輸時，實際效果如下：</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4442f7230e4a4387a80ede0359de42c2><p class=pgc-img-caption></p></div><p>首先服務器優先滿足了低帶寬客戶端的帶寬需求，使之滿速運行，最終傳輸速度穩定在113MB/S的千兆網絡傳輸極限速度。</p><p>然後再將剩餘4個網絡端口進行聚合，向高帶寬客戶端傳輸數據。由於受到服務器硬盤讀取性能限制，最終傳輸速度穩定在343MB/S。</p><p>而當低帶寬客戶端結束數據傳輸後，高帶寬客戶端也隨即恢復了滿負荷傳輸狀態。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/c9c5bfc370fd4cea86f60924637f5025><p class=pgc-img-caption></p></div><p>使用感受</p><p>穩定性</p><p>基於SMB3規範的帶寬疊加，無需專用設備；無需繁雜的系統設置，搭建的成本相當低廉，而獲得的效果也非常出眾。</p><p>除了點對點完美實現了多寬帶傳輸速度疊加之外，原先基於端口匯聚的線路冗餘、負載均衡都功能也一應俱全。對於小規模網絡使用的個人用戶基本可以捨棄技術和裝備門檻都高很多的端口匯聚了。</p><p>實際使用效果也非常穩定可靠，只要網絡設備穩定，存儲系統性能達標，就可以獲得持續穩定的高速鏈接。我在使用的3年時間裡從未出現過失效或者不穩定情況。</p><p>可用性</p><p>這項應用，使用雙千兆帶寬疊加模式是收益最大、性價比最高的使用模式</p><p><strong>對於狂熱追求高速的玩家來說</strong></p><p>3寬帶以上的網速疊加，可以最大程度上發揮和利用NAS設備上高端SSD倉庫盤的讀寫速度。這對於SSD的基本性能也提出了更高的要求，對於大多數中低端大容量SSD，雖然標稱性能都很可觀，測試成績也很優秀，但是這些很可能只是基於容量有限的緩存的成績，而實際在進行大塊數據讀寫存儲時往往就會出現如下圖的傳輸曲線。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/aef825ac820f47ebb682ce89245a4f37><p class=pgc-img-caption></p></div><p>所以在實際使用前一定要區分清楚廠家標稱的讀寫速度是持續是所謂的“緩存讀寫速度”還是真實的“持續讀寫速度”</p><p><strong>對於追求性價比的普通用戶</strong></p><p>一臺傻瓜型的八口交換機就可以負擔兩臺客戶端與一臺服務器的鏈接，對於設備上已經集成雙網口的用戶來說，基於SMB3.規範的帶寬疊加可以說是白送的福利，而且就算增加一塊千兆網卡花費也相當低廉。</p><p>對於使用普通大容量HDD的存儲系統的用戶來說，得益於單盤容量的不斷增大，平均讀寫速度也早已不再侷限於100MB/S的性能水平了。以我目前正在使用的希捷酷狼 8T HDD為例，讀、寫的最低速度都已經超過100MB/S，平均速度達到了180MB/S，在這樣的性能下使用雙千兆帶寬疊加，可以說是胃腸有效的性能提升手段</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/f8373f3e8e4e437ea4ecc1dd05852445><p class=pgc-img-caption></p></div><p>實際測試性能如下，140MB/S的傳輸速度已經超過單千兆網卡的帶寬限制。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/e23164307b7842a5add617a347f7b594><p class=pgc-img-caption></p></div><p>而且因為機械磁盤存儲載體為旋轉的圓形磁碟，所以雖然硬盤的轉速恆定，但是隨著磁頭從碟片的外圈向內心移動就會持續降低線速度，因此磁盤外圈的傳輸率最高；內圈則傳輸率最低。所以實際傳輸速度與數據存儲的扇區位置有很大的關係，對於存儲在靠近外圈的數據理論上還可以獲得更高的傳輸速度。</p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3486c307747a440c8f9454ab6336b62a><p class=pgc-img-caption></p></div><p>實用性</p><p><strong>對於我現在所用的5千兆帶寬疊加，其實屬於性能嚴重過剩的浪費模式，因為在一般工作和家用環境中很少有軟件需要如此大的網絡傳輸帶寬，而我現在唯一能夠受益的也只有大容量視頻渲染後的存出輸出。</strong></p><p><strong>所以這種模式更多的只是對於極限性能的追求和發燒的折騰，一般用戶完全無需照搬使用。但是由於實現起來非常方便，這也可以看作一種技術的儲備，日後如有用武之地便可立即投入使用。</strong></p><div class=pgc-img><img alt=家庭網絡：乘著SMB3的翅膀，低成本實現內網多通道帶寬疊 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5374d907951f45759fb7da85630d4ba1><p class=pgc-img-caption></p></div></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>網絡</a></li><li><a>乘著</a></li><li><a>SMB3</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/ea1bb612.html alt=光纜——未來網絡主導 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e75c1afe12354a93bad8495ad1057693 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ea1bb612.html title=光纜——未來網絡主導>光纜——未來網絡主導</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bdc59733.html alt="網絡詞名場面是什麼意思 名場面是什麼梗" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bdc59733.html title="網絡詞名場面是什麼意思 名場面是什麼梗">網絡詞名場面是什麼意思 名場面是什麼梗</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a002ca18.html alt=王一博那句年度網絡流行語「不愧是我」的：正版英文翻譯 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/26add5cdc08e4214800b25e21b623eb1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a002ca18.html title=王一博那句年度網絡流行語「不愧是我」的：正版英文翻譯>王一博那句年度網絡流行語「不愧是我」的：正版英文翻譯</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ad6f0929.html alt=谷歌大腦發佈神經網絡的「核磁共振」，並公開相關代碼 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/65c4000bda98898dcdbb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ad6f0929.html title=谷歌大腦發佈神經網絡的「核磁共振」，並公開相關代碼>谷歌大腦發佈神經網絡的「核磁共振」，並公開相關代碼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8dce33e7.html alt=理解生成對抗網絡，一步一步推理得到GANs（一） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/bee194d6fbec4d6f82e82998def3f7a3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8dce33e7.html title=理解生成對抗網絡，一步一步推理得到GANs（一）>理解生成對抗網絡，一步一步推理得到GANs（一）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1fe1c2dd.html alt=瞭解生成對抗網絡（GAN） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/634604de44ad4d17931ccc0bcf3e46ef style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1fe1c2dd.html title=瞭解生成對抗網絡（GAN）>瞭解生成對抗網絡（GAN）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2a9a3956.html alt="100 個網絡基礎知識普及，看完成半個網絡高手！" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/955ea722-be77-4b2d-b87a-64a8a04c8ea8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2a9a3956.html title="100 個網絡基礎知識普及，看完成半個網絡高手！">100 個網絡基礎知識普及，看完成半個網絡高手！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/78c87167.html alt=奧迪A7車載電路與網絡連接之網絡連接 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d34213e3b03545bd8e87ab074b54ca0f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/78c87167.html title=奧迪A7車載電路與網絡連接之網絡連接>奧迪A7車載電路與網絡連接之網絡連接</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8a15db0b.html alt=網絡上共享跨平臺的點對點文件 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/666bf87a9e16425ea1c9adc4f2c10acd style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8a15db0b.html title=網絡上共享跨平臺的點對點文件>網絡上共享跨平臺的點對點文件</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2b6ecb90.html alt=網絡基礎知識術語你知道哪些？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2b6ecb90.html title=網絡基礎知識術語你知道哪些？>網絡基礎知識術語你知道哪些？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6474ccee.html alt=點對點網絡的基本知識分享 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8678a34470a144ad88fc0487f0d8da91 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6474ccee.html title=點對點網絡的基本知識分享>點對點網絡的基本知識分享</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a61e29b6.html alt="幫助信息網絡犯罪活動罪 | 廈門刑事律師--辦案資料" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a61e29b6.html title="幫助信息網絡犯罪活動罪 | 廈門刑事律師--辦案資料">幫助信息網絡犯罪活動罪 | 廈門刑事律師--辦案資料</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ded83afe.html alt=博士論文摘要｜馬下平：“陸態網絡”並址站歸心基線精密解算及GNSS基準站數據處理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/53350006726e50ef72f9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ded83afe.html title=博士論文摘要｜馬下平：“陸態網絡”並址站歸心基線精密解算及GNSS基準站數據處理>博士論文摘要｜馬下平：“陸態網絡”並址站歸心基線精密解算及GNSS基準站數據處理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/65c66d61.html alt=網絡分析儀校準很頭疼，三大要點得記住！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/41dd3f31e88f48688e75d64978b36acf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/65c66d61.html title=網絡分析儀校準很頭疼，三大要點得記住！>網絡分析儀校準很頭疼，三大要點得記住！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2bc1496a.html alt=為了更好的深度神經網絡視覺，只需添加反饋（循環） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/17fccfd7096d44eeb3921bbd0dc29a13 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2bc1496a.html title=為了更好的深度神經網絡視覺，只需添加反饋（循環）>為了更好的深度神經網絡視覺，只需添加反饋（循環）</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>