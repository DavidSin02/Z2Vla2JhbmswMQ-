<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–° | æå®¢å¿«è¨Š</title><meta property="og:title" content="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–° - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/66c40005d5e8c29e8c31"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/dd535810.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/dd535810.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/dd535810.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/dd535810.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/dd535810.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/dd535810.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/dd535810.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/dd535810.html><meta property="article:published_time" content="2020-10-29T21:09:21+08:00"><meta property="article:modified_time" content="2020-10-29T21:09:21+08:00"><meta name=Keywords content><meta name=description content="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/dd535810.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><h1>å‰è¨€</h1><blockquote><p>HashMap<span>åœ¨ </span>Java<span>å’Œ </span>Android<span>é–‹ç™¼ä¸­éå¸¸å¸¸è¦‹è€Œ</span>HashMap 1.8<span>ç›¸å°æ–¼ </span>HashMap 1.7<span>æ›´æ–°å¤š</span><span>ä»Šå¤©ï¼Œæˆ‘å°‡é€šéæºç¢¼åˆ†æ</span>HashMap 1.8<span>ï¼Œå¾è€Œè¬›è§£</span>HashMap 1.8<span>ç›¸å°æ–¼ </span>HashMap 1.7<span> çš„æ›´æ–°å…§å®¹ï¼Œå¸Œæœ›ä½ å€‘æœƒå–œæ­¡ã€‚</span></p></blockquote><p>æœ¬æ–‡åŸºæ–¼ç‰ˆæœ¬ <code>JDK 1.8<span>ï¼Œå³ </span>Java 8<span>é—œæ–¼ç‰ˆæœ¬ </span>JDK 1.7<span>ï¼Œå³ </span>Java 7<span>ï¼Œ</span></code></p><h1>2. æ•¸æ“šçµæ§‹</h1><p>2.1 å…·é«”æè¿°</p><p><code>HashMap<span>æ¡ç”¨çš„æ•¸æ“šçµæ§‹ = æ•¸çµ„ï¼ˆä¸»ï¼‰ + å–®éˆè¡¨ï¼ˆå‰¯ï¼‰ï¼Œå…·é«”æè¿°å¦‚ä¸‹</span></code></p><br><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c40005d5e8c29e8c31></p><hr><h1></h1><p>1. ç°¡ä»‹</p><ul class=list-paddingleft-2><li><p>é¡å®šç¾©</p></li></ul><pre>public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt; implements Map&lt;K,V&gt;, Cloneable, Serializable123</pre><ul class=list-paddingleft-2><li><p>ä¸»è¦ç°¡ä»‹</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c8000464f356ad5bd6></p><p><code>HashMap<span> çš„å¯¦ç¾åœ¨ </span>JDK 1.7<span>å’Œ </span>JDK 1.8<span>å·®åˆ¥è¼ƒå¤§ä»Šå¤©ï¼Œæˆ‘å°‡å°ç…§ </span>JDK 1.7<span>çš„æºç¢¼ï¼Œåœ¨æ­¤åŸºç¤ä¸Šè¬›è§£ </span>JDK 1.8<span> ä¸­ </span></code><code>HashMap<span>çš„æºç¢¼è§£æ</span></code></p><h1></h1><p>2. æ•¸æ“šçµæ§‹ï¼šå¼•å…¥äº† ç´…é»‘æ¨¹</p><p>2.1 ä¸»è¦ä»‹ç´¹</p><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/6c2c0000784d6002fef8></p><p class=pgc-img-caption>ç´…é»‘æ¨¹</p><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/66c50005b18009e52a9b></p><p>2.2 å­˜å„²æµç¨‹</p><blockquote><p>æ³¨ï¼šç‚ºäº†è®“å¤§å®¶æœ‰å€‹æ„Ÿæ€§çš„èªè­˜ï¼Œåªæ˜¯ç°¡å–®çš„ç•«å‡ºå­˜å„²æµç¨‹ï¼Œæ›´åŠ è©³ç´° & å…·é«”çš„å­˜å„²æµç¨‹æœƒåœ¨ä¸‹é¢æºç¢¼åˆ†æä¸­çµ¦å‡º</p></blockquote><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c50005b1813a94a7d6></p><p><strong>2.3 æ•¸çµ„å…ƒç´  & éˆè¡¨ç¯€é»çš„ å¯¦ç¾é¡</strong></p><p><code>HashMap<span>ä¸­çš„æ•¸çµ„å…ƒç´  & éˆè¡¨ç¯€é» æ¡ç”¨ </span>Node<span>é¡ å¯¦ç¾</span><span>èˆ‡ </span>JDK 1.7<span>çš„å°æ¯”ï¼ˆ</span>Entry<span>é¡ï¼‰ï¼Œåƒ…åƒ…åªæ˜¯æ›äº†åå­—</span></code></p><ul class=list-paddingleft-2><li><p>è©²é¡çš„æºç¢¼åˆ†æå¦‚ä¸‹</p><blockquote><p>å…·é«”åˆ†æè«‹çœ‹è¨»é‡‹</p></blockquote></li></ul><pre>/** * Node = HashMapçš„å…§éƒ¨é¡ï¼Œå¯¦ç¾äº†Map.Entryæ¥å£ï¼Œæœ¬è³ªæ˜¯ = ä¸€å€‹æ˜ å°„(éµå€¼å°) * å¯¦ç¾äº†getKey()ã€getValue()ã€equals(Object o)å’ŒhashCode()ç­‰æ–¹æ³• **/  static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; { final int hash; // å“ˆå¸Œå€¼ï¼ŒHashMapæ ¹æ“šè©²å€¼ç¢ºå®šè¨˜éŒ„çš„ä½ç½® final K key; // key V value; // value Node&lt;K,V&gt; next;// éˆè¡¨ä¸‹ä¸€å€‹ç¯€é» // æ§‹é€ æ–¹æ³• Node(int hash, K key, V value, Node&lt;K,V&gt; next) { this.hash = hash; this.key = key; this.value = value; this.next = next; } public final K getKey() { return key; } // è¿”å› èˆ‡ æ­¤é … å°æ‡‰çš„éµ public final V getValue() { return value; } // è¿”å› èˆ‡ æ­¤é … å°æ‡‰çš„å€¼ public final String toString() { return key + "=" + value; }  public final V setValue(V newValue) { V oldValue = value; value = newValue; return oldValue; } /** * hashCodeï¼ˆï¼‰ */ public final int hashCode() {  return Objects.hashCode(key) ^ Objects.hashCode(value); } /** * equalsï¼ˆï¼‰ * ä½œç”¨ï¼šåˆ¤æ–·2å€‹Entryæ˜¯å¦ç›¸ç­‰ï¼Œå¿…é ˆkeyå’Œvalueéƒ½ç›¸ç­‰ï¼Œæ‰è¿”å›true  */ public final boolean equals(Object o) {  if (o == this)  return true;  if (o instanceof Map.Entry) { Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;  if (Objects.equals(key, e.getKey()) &amp;&amp; Objects.equals(value, e.getValue()))  return true; } return false; } }</pre><p><strong>2.4 ç´…é»‘æ¨¹ç¯€é» å¯¦ç¾é¡</strong><br></p><p><code>HashMap<span>ä¸­çš„ç´…é»‘æ¨¹ç¯€é» æ¡ç”¨ </span>TreeNode<span>é¡ å¯¦ç¾</span></code></p><pre>/** * ç´…é»‘æ¨¹ç¯€é» å¯¦ç¾é¡ï¼šç¹¼æ‰¿è‡ªLinkedHashMap.Entry&lt;K,V&gt;é¡ */ static final class TreeNode&lt;K,V&gt; extends LinkedHashMap.Entry&lt;K,V&gt; {  // å±¬æ€§ = çˆ¶ç¯€é»ã€å·¦å­æ¨¹ã€å³å­æ¨¹ã€åˆªé™¤è¼”åŠ©ç¯€é» + é¡è‰² TreeNode&lt;K,V&gt; parent;  TreeNode&lt;K,V&gt; left;  TreeNode&lt;K,V&gt; right; TreeNode&lt;K,V&gt; prev;  boolean red;  // æ§‹é€ å‡½æ•¸ TreeNode(int hash, K key, V val, Node&lt;K,V&gt; next) {  super(hash, key, val, next);  }  // è¿”å›ç•¶å‰ç¯€é»çš„æ ¹ç¯€é»  final TreeNode&lt;K,V&gt; root() {  for (TreeNode&lt;K,V&gt; r = this, p;;) {  if ((p = r.parent) == null)  return r;  r = p;  }  } 12345678910111213141516171819202122232425</pre><hr><h1></h1><p>3. å…·é«”ä½¿ç”¨</p><p>3.1 ä¸»è¦ä½¿ç”¨APIï¼ˆæ–¹æ³•ã€å‡½æ•¸ï¼‰</p><blockquote><p>èˆ‡ <code>JDK 1.7</code> åŸºæœ¬ç›¸åŒ</p></blockquote><pre>V get(Object key); // ç²å¾—æŒ‡å®šéµçš„å€¼V put(K key, V value); // æ·»åŠ éµå€¼å°void putAll(Map&lt;? extends K, ? extends V&gt; m); // å°‡æŒ‡å®šMapä¸­çš„éµå€¼å° è¤‡è£½åˆ° æ­¤Mapä¸­V remove(Object key); // åˆªé™¤è©²éµå€¼å°boolean containsKey(Object key); // åˆ¤æ–·æ˜¯å¦å­˜åœ¨è©²éµçš„éµå€¼å°ï¼›æ˜¯ å‰‡è¿”å›trueboolean containsValue(Object value); // åˆ¤æ–·æ˜¯å¦å­˜åœ¨è©²å€¼çš„éµå€¼å°ï¼›æ˜¯ å‰‡è¿”å›trueSet&lt;K&gt; keySet(); // å–®ç¨æŠ½å–keyåºåˆ—ï¼Œå°‡æ‰€æœ‰keyç”Ÿæˆä¸€å€‹SetCollection&lt;V&gt; values(); // å–®ç¨valueåºåˆ—ï¼Œå°‡æ‰€æœ‰valueç”Ÿæˆä¸€å€‹Collectionvoid clear(); // æ¸…é™¤å“ˆå¸Œè¡¨ä¸­çš„æ‰€æœ‰éµå€¼å°int size(); // è¿”å›å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰ éµå€¼å°çš„æ•¸é‡ = æ•¸çµ„ä¸­çš„éµå€¼å° + éˆè¡¨ä¸­çš„éµå€¼å°boolean isEmpty(); // åˆ¤æ–·HashMapæ˜¯å¦ç‚ºç©ºï¼›size == 0æ™‚ è¡¨ç¤ºç‚º ç©º 123456789101112131415</pre><p><strong>3.2 ä½¿ç”¨æµç¨‹</strong></p><blockquote><p>èˆ‡ <span>JDK 1.7</span>åŸºæœ¬ç›¸åŒ</p></blockquote><ul class=list-paddingleft-2><li><p>åœ¨å…·é«”ä½¿ç”¨æ™‚ï¼Œä¸»è¦æµç¨‹æ˜¯ï¼š</p></li></ul><p>è²æ˜1å€‹ <span>HashMap</span>çš„å°è±¡</p><p>å‘ <span>HashMap</span><br>æ·»åŠ æ•¸æ“šï¼ˆæˆå° æ”¾å…¥ éµ - å€¼å°ï¼‰</p><ol class=list-paddingleft-2><li><p>ç²å– <code>HashMap</code> çš„æŸå€‹æ•¸æ“š</p></li><li><p>ç²å– <code>HashMap</code> çš„å…¨éƒ¨æ•¸æ“šï¼šéæ­·<code>HashMap</code></p></li></ol><ul class=list-paddingleft-2><li><p>ç¤ºä¾‹ä»£ç¢¼</p></li></ul><pre>import java.util.Collection;import java.util.HashMap;import java.util.Iterator;import java.util.Map;import java.util.Set;public class HashMapTest { public static void main(String[] args) { /** * 1. è²æ˜1å€‹ HashMapçš„å°è±¡ */ Map&lt;String, Integer&gt; map = new HashMap&lt;String, Integer&gt;(); /** * 2. å‘HashMapæ·»åŠ æ•¸æ“šï¼ˆæˆå° æ”¾å…¥ éµ - å€¼å°ï¼‰ */ map.put("Android", 1); map.put("Java", 2); map.put("iOS", 3); map.put("æ•¸æ“šæŒ–æ˜", 4); map.put("ç”¢å“ç¶“ç†", 5); /** * 3. ç²å– HashMap çš„æŸå€‹æ•¸æ“š */ System.out.println("key = ç”¢å“ç¶“ç†æ™‚çš„å€¼ç‚ºï¼š" + map.get("ç”¢å“ç¶“ç†")); /** * 4. ç²å– HashMap çš„å…¨éƒ¨æ•¸æ“šï¼šéæ­·HashMap * æ ¸å¿ƒæ€æƒ³ï¼š * æ­¥é©Ÿ1ï¼šç²å¾—key-valueå°ï¼ˆEntryï¼‰ æˆ– key æˆ– valueçš„Seté›†åˆ * æ­¥é©Ÿ2ï¼šéæ­·ä¸Šè¿°Seté›†åˆ(ä½¿ç”¨forå¾ªç’° ã€ è¿­ä»£å™¨ï¼ˆIteratorï¼‰å‡å¯) * æ–¹æ³•å…±æœ‰3ç¨®ï¼šåˆ†åˆ¥é‡å° key-valueå°ï¼ˆEntryï¼‰ æˆ– key æˆ– value */ // æ–¹æ³•1ï¼šç²å¾—key-valueçš„Seté›†åˆ å†éæ­· System.out.println("æ–¹æ³•1"); // 1. ç²å¾—key-valueå°ï¼ˆEntryï¼‰çš„Seté›†åˆ  Set&lt;Map.Entry&lt;String, Integer&gt;&gt; entrySet = map.entrySet(); // 2. éæ­·Seté›†åˆï¼Œå¾è€Œç²å–key-value // 2.1 é€šéforå¾ªç’° for(Map.Entry&lt;String, Integer&gt; entry : entrySet){ System.out.print(entry.getKey()); System.out.println(entry.getValue()); } System.out.println("----------"); // 2.2 é€šéè¿­ä»£å™¨ï¼šå…ˆç²å¾—key-valueå°ï¼ˆEntryï¼‰çš„Iteratorï¼Œå†å¾ªç’°éæ­· Iterator iter1 = entrySet.iterator(); while (iter1.hasNext()) { // éæ­·æ™‚ï¼Œéœ€å…ˆç²å–entryï¼Œå†åˆ†åˆ¥ç²å–keyã€value Map.Entry entry = (Map.Entry) iter1.next(); System.out.print((String) entry.getKey()); System.out.println((Integer) entry.getValue()); } // æ–¹æ³•2ï¼šç²å¾—keyçš„Seté›†åˆ å†éæ­· System.out.println("æ–¹æ³•2"); // 1. ç²å¾—keyçš„Seté›†åˆ Set&lt;String&gt; keySet = map.keySet(); // 2. éæ­·Seté›†åˆï¼Œå¾è€Œç²å–keyï¼Œå†ç²å–value // 2.1 é€šéforå¾ªç’° for(String key : keySet){ System.out.print(key); System.out.println(map.get(key)); } System.out.println("----------"); // 2.2 é€šéè¿­ä»£å™¨ï¼šå…ˆç²å¾—keyçš„Iteratorï¼Œå†å¾ªç’°éæ­· Iterator iter2 = keySet.iterator(); String key = null; while (iter2.hasNext()) { key = (String)iter2.next(); System.out.print(key); System.out.println(map.get(key)); } // æ–¹æ³•3ï¼šç²å¾—valueçš„Seté›†åˆ å†éæ­· System.out.println("æ–¹æ³•3"); // 1. ç²å¾—valueçš„Seté›†åˆ Collection valueSet = map.values(); // 2. éæ­·Seté›†åˆï¼Œå¾è€Œç²å–value // 2.1 ç²å¾—values çš„Iterator Iterator iter3 = valueSet.iterator(); // 2.2 é€šééæ­·ï¼Œç›´æ¥ç²å–value while (iter3.hasNext()) { System.out.println(iter3.next()); } }}// æ³¨ï¼šå°æ–¼éæ­·æ–¹å¼ï¼Œæ¨è–¦ä½¿ç”¨é‡å° key-valueå°ï¼ˆEntryï¼‰çš„æ–¹å¼ï¼šæ•ˆç‡é«˜// åŸå› ï¼š // 1. å°æ–¼ éæ­·keySet ã€valueSetï¼Œå¯¦è³ªä¸Š = éæ­·äº†2æ¬¡ï¼š1 = è½‰ç‚º iterator è¿­ä»£å™¨éæ­·ã€2 = å¾ HashMap ä¸­å–å‡º key çš„ value æ“ä½œï¼ˆé€šé key å€¼ hashCode å’Œ equals ç´¢å¼•ï¼‰ // 2. å°æ–¼ éæ­· entrySet ï¼Œå¯¦è³ª = éæ­·äº†1æ¬¡ = ç²å–å­˜å„²å¯¦é«”Entryï¼ˆå­˜å„²äº†key å’Œ value ï¼‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106</pre><ul class=list-paddingleft-2><li><p>é‹è¡Œçµæœ</p></li></ul><pre>æ–¹æ³•1Java2iOS3æ•¸æ“šæŒ–æ˜4Android1ç”¢å“ç¶“ç†5----------Java2iOS3æ•¸æ“šæŒ–æ˜4Android1ç”¢å“ç¶“ç†5æ–¹æ³•2Java2iOS3æ•¸æ“šæŒ–æ˜4Android1ç”¢å“ç¶“ç†5----------Java2iOS3æ•¸æ“šæŒ–æ˜4Android1ç”¢å“ç¶“ç†5æ–¹æ³•3</pre><p>ä¸‹é¢ï¼Œæˆ‘å€‘æŒ‰ç…§ä¸Šè¿°çš„ä½¿ç”¨éç¨‹ï¼Œå°ä¸€å€‹å€‹æ­¥é©Ÿé€²è¡Œæºç¢¼è§£æ</p><hr><h1></h1><p>4. åŸºç¤çŸ¥è­˜ï¼šHashMapä¸­çš„é‡è¦åƒæ•¸ï¼ˆè®Šé‡ï¼‰</p><ul class=list-paddingleft-2><li><p>åœ¨é€²è¡ŒçœŸæ­£çš„æºç¢¼åˆ†æå‰ï¼Œå…ˆè¬›è§£<code>HashMap</code>ä¸­çš„é‡è¦åƒæ•¸ï¼ˆè®Šé‡ï¼‰</p></li><li><p><code>HashMap</code>ä¸­çš„ä¸»è¦åƒæ•¸ åŒ <code>JDK 1.7</code> ï¼Œå³ï¼šå®¹é‡ã€åŠ è¼‰å› å­ã€æ“´å®¹é–¾å€¼</p></li><li><p>ä½†ç”±æ–¼æ•¸æ“šçµæ§‹ä¸­å¼•å…¥äº† ç´…é»‘æ¨¹ï¼Œæ•…åŠ å…¥äº† èˆ‡ç´…é»‘æ¨¹ç›¸é—œçš„åƒæ•¸ã€‚å…·é«”ä»‹ç´¹å¦‚ä¸‹ï¼š</p></li></ul><pre>/** * ä¸»è¦åƒæ•¸ åŒ JDK 1.7 * å³ï¼šå®¹é‡ã€åŠ è¼‰å› å­ã€æ“´å®¹é–¾å€¼ï¼ˆè¦æ±‚ã€ç¯„åœå‡ç›¸åŒï¼‰ */ // 1. å®¹é‡ï¼ˆcapacityï¼‰ï¼š å¿…é ˆæ˜¯2çš„å†ª &amp; &lt;æœ€å¤§å®¹é‡ï¼ˆ2çš„30æ¬¡æ–¹ï¼‰ static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4; // é»˜èªå®¹é‡ = 16 = 1&lt;&lt;4 = 00001ä¸­çš„1å‘å·¦ç§»4ä½ = 10000 = åé€²åˆ¶çš„2^4=16 static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30; // æœ€å¤§å®¹é‡ = 2çš„30æ¬¡æ–¹ï¼ˆè‹¥å‚³å…¥çš„å®¹é‡éå¤§ï¼Œå°‡è¢«æœ€å¤§å€¼æ›¿æ›ï¼‰ // 2. åŠ è¼‰å› å­(Load factor)ï¼šHashMapåœ¨å…¶å®¹é‡è‡ªå‹•å¢åŠ å‰å¯é”åˆ°å¤šæ»¿çš„ä¸€ç¨®å°ºåº¦ final float loadFactor; // å¯¦éš›åŠ è¼‰å› å­ static final float DEFAULT_LOAD_FACTOR = 0.75f; // é»˜èªåŠ è¼‰å› å­ = 0.75 // 3. æ“´å®¹é–¾å€¼ï¼ˆthresholdï¼‰ï¼šç•¶å“ˆå¸Œè¡¨çš„å¤§å° â‰¥ æ“´å®¹é–¾å€¼æ™‚ï¼Œå°±æœƒæ“´å®¹å“ˆå¸Œè¡¨ï¼ˆå³æ“´å……HashMapçš„å®¹é‡ï¼‰ // a. æ“´å®¹ = å°å“ˆå¸Œè¡¨é€²è¡Œresizeæ“ä½œï¼ˆå³é‡å»ºå…§éƒ¨æ•¸æ“šçµæ§‹ï¼‰ï¼Œå¾è€Œå“ˆå¸Œè¡¨å°‡å…·æœ‰å¤§ç´„å…©å€çš„æ¡¶æ•¸ // b. æ“´å®¹é–¾å€¼ = å®¹é‡ x åŠ è¼‰å› å­ int threshold; // 4. å…¶ä»– transient Node&lt;K,V&gt;[] table; // å­˜å„²æ•¸æ“šçš„Nodeé¡å‹ æ•¸çµ„ï¼Œé•·åº¦ = 2çš„å†ªï¼›æ•¸çµ„çš„æ¯å€‹å…ƒç´  = 1å€‹å–®éˆè¡¨ transient int size;// HashMapçš„å¤§å°ï¼Œå³ HashMapä¸­å­˜å„²çš„éµå€¼å°çš„æ•¸é‡ /** * èˆ‡ç´…é»‘æ¨¹ç›¸é—œçš„åƒæ•¸ */ // 1. æ¡¶çš„æ¨¹åŒ–é–¾å€¼ï¼šå³ éˆè¡¨è½‰æˆç´…é»‘æ¨¹çš„é–¾å€¼ï¼Œåœ¨å­˜å„²æ•¸æ“šæ™‚ï¼Œç•¶éˆè¡¨é•·åº¦ &gt; è©²å€¼æ™‚ï¼Œå‰‡å°‡éˆè¡¨è½‰æ›æˆç´…é»‘æ¨¹ static final int TREEIFY_THRESHOLD = 8; // 2. æ¡¶çš„éˆè¡¨é‚„åŸé–¾å€¼ï¼šå³ ç´…é»‘æ¨¹è½‰ç‚ºéˆè¡¨çš„é–¾å€¼ï¼Œç•¶åœ¨æ“´å®¹ï¼ˆresizeï¼ˆï¼‰ï¼‰æ™‚ï¼ˆæ­¤æ™‚HashMapçš„æ•¸æ“šå­˜å„²ä½ç½®æœƒé‡æ–°è¨ˆç®—ï¼‰ï¼Œåœ¨é‡æ–°è¨ˆç®—å­˜å„²ä½ç½®å¾Œï¼Œç•¶åŸæœ‰çš„ç´…é»‘æ¨¹å…§æ•¸é‡ &lt; 6æ™‚ï¼Œå‰‡å°‡ ç´…é»‘æ¨¹è½‰æ›æˆéˆè¡¨ static final int UNTREEIFY_THRESHOLD = 6; // 3. æœ€å°æ¨¹å½¢åŒ–å®¹é‡é–¾å€¼ï¼šå³ ç•¶å“ˆå¸Œè¡¨ä¸­çš„å®¹é‡ &gt; è©²å€¼æ™‚ï¼Œæ‰å…è¨±æ¨¹å½¢åŒ–éˆè¡¨ ï¼ˆå³ å°‡éˆè¡¨ è½‰æ›æˆç´…é»‘æ¨¹ï¼‰ // å¦å‰‡ï¼Œè‹¥æ¡¶å…§å…ƒç´ å¤ªå¤šæ™‚ï¼Œå‰‡ç›´æ¥æ“´å®¹ï¼Œè€Œä¸æ˜¯æ¨¹å½¢åŒ– // ç‚ºäº†é¿å…é€²è¡Œæ“´å®¹ã€æ¨¹å½¢åŒ–é¸æ“‡çš„è¡çªï¼Œé€™å€‹å€¼ä¸èƒ½å°æ–¼ 4 * TREEIFY_THRESHOLD static final int MIN_TREEIFY_CAPACITY = 64;1234567891011121314151617181920212223242526272829303132333435</pre><ul class=list-paddingleft-2><li><p>æ­¤è™• å†æ¬¡è©³ç´°èªªæ˜ åŠ è¼‰å› å­</p><blockquote><p>åŒ <code>JDK 1.7</code>ï¼Œä½†ç”±æ–¼å…¶é‡è¦æ€§ï¼Œæ•…æ­¤è™•å†æ¬¡èªªæ˜</p></blockquote></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c40005d5e78ac067ca></p><ul class=list-paddingleft-2><li><p>ç¸½çµ æ•¸æ“šçµæ§‹ & åƒæ•¸æ–¹é¢èˆ‡ <code>JDK 1.7</code>çš„å€åˆ¥</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c600059db5d3b92c0b></p><hr><h1></h1><p>5. æºç¢¼åˆ†æ</p><ul class=list-paddingleft-2><li><p>æœ¬æ¬¡çš„æºç¢¼åˆ†æä¸»è¦æ˜¯æ ¹æ“š ä½¿ç”¨æ­¥é©Ÿ é€²è¡Œç›¸é—œå‡½æ•¸çš„è©³ç´°åˆ†æ</p></li><li><p>ä¸»è¦åˆ†æå…§å®¹å¦‚ä¸‹ï¼š</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c50005b18388095faa></p><ul class=list-paddingleft-2><li><p>ä¸‹é¢ï¼Œæˆ‘å°‡å°æ¯å€‹æ­¥é©Ÿå…§å®¹çš„ä¸»è¦æ–¹æ³•é€²è¡Œè©³ç´°åˆ†æ</p></li></ul><p>æ­¥é©Ÿ1ï¼šè²æ˜1å€‹ HashMapçš„å°è±¡</p><blockquote><p>æ­¤è™•ä¸»è¦åˆ†æçš„æ§‹é€ å‡½æ•¸ é¡ä¼¼ <code>JDK 1.7</code></p></blockquote><pre>/** * å‡½æ•¸ä½¿ç”¨åŸå‹ */ Map&lt;String,Integer&gt; map = new HashMap&lt;String,Integer&gt;(); /** * æºç¢¼åˆ†æï¼šä¸»è¦æ˜¯HashMapçš„æ§‹é€ å‡½æ•¸ = 4å€‹ * åƒ…è²¼å‡ºé—œæ–¼HashMapæ§‹é€ å‡½æ•¸çš„æºç¢¼ */public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt; implements Map&lt;K,V&gt;, Cloneable, Serializable{ // çœç•¥ä¸Šç¯€é—¡è¿°çš„åƒæ•¸ /** * æ§‹é€ å‡½æ•¸1ï¼šé»˜èªæ§‹é€ å‡½æ•¸ï¼ˆç„¡åƒï¼‰ * åŠ è¼‰å› å­ &amp; å®¹é‡ = é»˜èª = 0.75ã€16 */ public HashMap() { this.loadFactor = DEFAULT_LOAD_FACTOR; } /** * æ§‹é€ å‡½æ•¸2ï¼šæŒ‡å®šâ€œå®¹é‡å¤§å°â€çš„æ§‹é€ å‡½æ•¸ * åŠ è¼‰å› å­ = é»˜èª = 0.75 ã€å®¹é‡ = æŒ‡å®šå¤§å° */ public HashMap(int initialCapacity) { // å¯¦éš›ä¸Šæ˜¯èª¿ç”¨æŒ‡å®šâ€œå®¹é‡å¤§å°â€å’Œâ€œåŠ è¼‰å› å­â€çš„æ§‹é€ å‡½æ•¸ // åªæ˜¯åœ¨å‚³å…¥çš„åŠ è¼‰å› å­åƒæ•¸ = é»˜èªåŠ è¼‰å› å­ this(initialCapacity, DEFAULT_LOAD_FACTOR); } /** * æ§‹é€ å‡½æ•¸3ï¼šæŒ‡å®šâ€œå®¹é‡å¤§å°â€å’Œâ€œåŠ è¼‰å› å­â€çš„æ§‹é€ å‡½æ•¸ * åŠ è¼‰å› å­ &amp; å®¹é‡ = è‡ªå·±æŒ‡å®š */ public HashMap(int initialCapacity, float loadFactor) { // æŒ‡å®šåˆå§‹å®¹é‡å¿…é ˆéè² ï¼Œå¦å‰‡å ±éŒ¯  if (initialCapacity &lt; 0)  throw new IllegalArgumentException("Illegal initial capacity: " +  initialCapacity); // HashMapçš„æœ€å¤§å®¹é‡åªèƒ½æ˜¯MAXIMUM_CAPACITYï¼Œå“ªæ€•å‚³å…¥çš„ &gt; æœ€å¤§å®¹é‡ if (initialCapacity &gt; MAXIMUM_CAPACITY) initialCapacity = MAXIMUM_CAPACITY; // å¡«å……æ¯”å¿…é ˆç‚ºæ­£  if (loadFactor &lt;= 0 || Float.isNaN(loadFactor))  throw new IllegalArgumentException("Illegal load factor: " +  loadFactor);  // è¨­ç½® åŠ è¼‰å› å­ this.loadFactor = loadFactor; // è¨­ç½® æ“´å®¹é–¾å€¼ // æ³¨ï¼šæ­¤è™•ä¸æ˜¯çœŸæ­£çš„é–¾å€¼ï¼Œåƒ…åƒ…åªæ˜¯å°‡å‚³å…¥çš„å®¹é‡å¤§å°è½‰åŒ–ç‚ºï¼š&gt;å‚³å…¥å®¹é‡å¤§å°çš„æœ€å°çš„2çš„å†ªï¼Œè©²é–¾å€¼å¾Œé¢æœƒé‡æ–°è¨ˆç®— // ä¸‹é¢æœƒè©³ç´°è¬›è§£ -&gt;&gt; åˆ†æ1 this.threshold = tableSizeFor(initialCapacity); } /** * æ§‹é€ å‡½æ•¸4ï¼šåŒ…å«â€œå­Mapâ€çš„æ§‹é€ å‡½æ•¸ * å³ æ§‹é€ å‡ºä¾†çš„HashMapåŒ…å«å‚³å…¥Mapçš„æ˜ å°„é—œä¿‚ * åŠ è¼‰å› å­ &amp; å®¹é‡ = é»˜èª */ public HashMap(Map&lt;? extends K, ? extends V&gt; m) { // è¨­ç½®å®¹é‡å¤§å° &amp; åŠ è¼‰å› å­ = é»˜èª this.loadFactor = DEFAULT_LOAD_FACTOR; // å°‡å‚³å…¥çš„å­Mapä¸­çš„å…¨éƒ¨å…ƒç´ é€å€‹æ·»åŠ åˆ°HashMapä¸­ putMapEntries(m, false); }} /** * åˆ†æ1ï¼štableSizeFor(initialCapacity) * ä½œç”¨ï¼šå°‡å‚³å…¥çš„å®¹é‡å¤§å°è½‰åŒ–ç‚ºï¼š&gt;å‚³å…¥å®¹é‡å¤§å°çš„æœ€å°çš„2çš„å†ª * èˆ‡JDK 1.7å°æ¯”ï¼šé¡ä¼¼æ–¼JDK 1.7 ä¸­ inflateTable()è£¡çš„ roundUpToPowerOf2(toSize) */ static final int tableSizeFor(int cap) { int n = cap - 1; n |= n &gt;&gt;&gt; 1; n |= n &gt;&gt;&gt; 2; n |= n &gt;&gt;&gt; 4; n |= n &gt;&gt;&gt; 8; n |= n &gt;&gt;&gt; 16; return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;}12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394</pre><ul class=list-paddingleft-2><li><p>æ³¨ï¼šï¼ˆåŒ<code>JDK 1.7</code>é¡ä¼¼ï¼‰</p></li></ul><ol class=list-paddingleft-2><li><p>æ­¤è™•åƒ…ç”¨æ–¼æ¥æ”¶åˆå§‹å®¹é‡å¤§å°ï¼ˆ<code>capacity</code>ï¼‰ã€åŠ è¼‰å› å­(<code>Load factor</code>)ï¼Œä½†ä»ç„¡çœŸæ­£åˆå§‹åŒ–å“ˆå¸Œè¡¨ï¼Œå³åˆå§‹åŒ–å­˜å„²æ•¸çµ„<code>table</code></p></li><li><p>æ­¤è™•å…ˆçµ¦å‡ºçµè«–ï¼šçœŸæ­£åˆå§‹åŒ–å“ˆå¸Œè¡¨ï¼ˆåˆå§‹åŒ–å­˜å„²æ•¸çµ„<code>table</code>ï¼‰æ˜¯åœ¨ç¬¬1æ¬¡æ·»åŠ éµå€¼å°æ™‚ï¼Œå³ç¬¬1æ¬¡èª¿ç”¨<code>putï¼ˆï¼‰</code>æ™‚ã€‚ä¸‹é¢æœƒè©³ç´°èªªæ˜</p></li></ol><p>è‡³æ­¤ï¼Œé—œæ–¼<code>HashMap</code>çš„æ§‹é€ å‡½æ•¸è¬›è§£å®Œç•¢ã€‚</p><hr><p>æ­¥é©Ÿ2ï¼šå‘HashMapæ·»åŠ æ•¸æ“šï¼ˆæˆå° æ”¾å…¥ éµ - å€¼å°ï¼‰</p><ul class=list-paddingleft-2><li><p>åœ¨è©²æ­¥é©Ÿä¸­ï¼Œèˆ‡<code>JDK 1.7</code>çš„å·®åˆ¥è¼ƒå¤§ï¼š</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c40005d5e94511f385></p><blockquote><p>ä¸‹é¢æœƒå°ä¸Šè¿°å€åˆ¥é€²è¡Œè©³ç´°è¬›è§£</p></blockquote><ul class=list-paddingleft-2><li><p>æ·»åŠ æ•¸æ“šçš„æµç¨‹å¦‚ä¸‹</p></li></ul><blockquote><p>æ³¨ï¼šç‚ºäº†è®“å¤§å®¶æœ‰å€‹æ„Ÿæ€§çš„èªè­˜ï¼Œåªæ˜¯ç°¡å–®çš„ç•«å‡ºå­˜å„²æµç¨‹ï¼Œæ›´åŠ è©³ç´° & å…·é«”çš„å­˜å„²æµç¨‹æœƒåœ¨ä¸‹é¢æºç¢¼åˆ†æä¸­çµ¦å‡º</p></blockquote><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c50005b1824587d233></p><ul class=list-paddingleft-2><li><p>æºç¢¼åˆ†æ</p></li></ul><pre>/** * å‡½æ•¸ä½¿ç”¨åŸå‹ */ map.put("Android", 1); map.put("Java", 2); map.put("iOS", 3); map.put("æ•¸æ“šæŒ–æ˜", 4); map.put("ç”¢å“ç¶“ç†", 5); /** * æºç¢¼åˆ†æï¼šä¸»è¦åˆ†æHashMapçš„putå‡½æ•¸ */ public V put(K key, V value) { // 1. å°å‚³å…¥æ•¸çµ„çš„éµKeyè¨ˆç®—Hashå€¼ -&gt;&gt;åˆ†æ1 // 2. å†èª¿ç”¨putValï¼ˆï¼‰æ·»åŠ æ•¸æ“šé€²å» -&gt;&gt;åˆ†æ2 return putVal(hash(key), key, value, false, true); }1234567891011121314151617</pre><p>ä¸‹é¢ï¼Œå°‡è©³ç´°è¬›è§£ ä¸Šé¢çš„2å€‹ä¸»è¦åˆ†æé»</p><p>åˆ†æ1ï¼šhashï¼ˆkeyï¼‰</p><pre> /** * åˆ†æ1ï¼šhash(key) * ä½œç”¨ï¼šè¨ˆç®—å‚³å…¥æ•¸æ“šçš„å“ˆå¸Œç¢¼ï¼ˆå“ˆå¸Œå€¼ã€Hashå€¼ï¼‰ * è©²å‡½æ•¸åœ¨JDK 1.7 å’Œ 1.8 ä¸­çš„å¯¦ç¾ä¸åŒï¼Œä½†åŸç†ä¸€æ¨£ = æ“¾å‹•å‡½æ•¸ = ä½¿å¾—æ ¹æ“škeyç”Ÿæˆçš„å“ˆå¸Œç¢¼ï¼ˆhashå€¼ï¼‰åˆ†ä½ˆæ›´åŠ å‡å‹»ã€æ›´å…·å‚™éš¨æ©Ÿæ€§ï¼Œé¿å…å‡ºç¾hashå€¼è¡çªï¼ˆå³æŒ‡ä¸åŒkeyä½†ç”ŸæˆåŒ1å€‹hashå€¼ï¼‰ * JDK 1.7 åšäº†9æ¬¡æ“¾å‹•è™•ç† = 4æ¬¡ä½é‹ç®— + 5æ¬¡ç•°æˆ–é‹ç®— * JDK 1.8 ç°¡åŒ–äº†æ“¾å‹•å‡½æ•¸ = åªåšäº†2æ¬¡æ“¾å‹• = 1æ¬¡ä½é‹ç®— + 1æ¬¡ç•°æˆ–é‹ç®— */ // JDK 1.7å¯¦ç¾ï¼šå°‡ éµkey è½‰æ›æˆ å“ˆå¸Œç¢¼ï¼ˆhashå€¼ï¼‰æ“ä½œ = ä½¿ç”¨hashCode() + 4æ¬¡ä½é‹ç®— + 5æ¬¡ç•°æˆ–é‹ç®—ï¼ˆ9æ¬¡æ“¾å‹•ï¼‰ static final int hash(int h) { h ^= k.hashCode(); h ^= (h &gt;&gt;&gt; 20) ^ (h &gt;&gt;&gt; 12); return h ^ (h &gt;&gt;&gt; 7) ^ (h &gt;&gt;&gt; 4); } // JDK 1.8å¯¦ç¾ï¼šå°‡ éµkey è½‰æ›æˆ å“ˆå¸Œç¢¼ï¼ˆhashå€¼ï¼‰æ“ä½œ = ä½¿ç”¨hashCode() + 1æ¬¡ä½é‹ç®— + 1æ¬¡ç•°æˆ–é‹ç®—ï¼ˆ2æ¬¡æ“¾å‹•ï¼‰ // 1. å–hashCodeå€¼ï¼š h = key.hashCode() // 2. é«˜ä½åƒèˆ‡ä½ä½çš„é‹ç®—ï¼šh ^ (h &gt;&gt;&gt; 16)  static final int hash(Object key) { int h; return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16); // a. ç•¶key = nullæ™‚ï¼Œhashå€¼ = 0ï¼Œæ‰€ä»¥HashMapçš„key å¯ç‚ºnull  // æ³¨ï¼šå°æ¯”HashTableï¼ŒHashTableå°keyç›´æ¥hashCodeï¼ˆï¼‰ï¼Œè‹¥keyç‚ºnullæ™‚ï¼Œæœƒæ‹‹å‡ºç•°å¸¸ï¼Œæ‰€ä»¥HashTableçš„keyä¸å¯ç‚ºnull // b. ç•¶key â‰  nullæ™‚ï¼Œå‰‡é€šéå…ˆè¨ˆç®—å‡º keyçš„ hashCode()ï¼ˆè¨˜ç‚ºhï¼‰ï¼Œç„¶å¾Œ å°å“ˆå¸Œç¢¼é€²è¡Œ æ“¾å‹•è™•ç†ï¼š æŒ‰ä½ ç•°æˆ–ï¼ˆ^ï¼‰ å“ˆå¸Œç¢¼è‡ªèº«å³ç§»16ä½å¾Œçš„äºŒé€²åˆ¶ } /** * è¨ˆç®—å­˜å„²ä½ç½®çš„å‡½æ•¸åˆ†æï¼šindexFor(hash, table.length) * æ³¨ï¼šè©²å‡½æ•¸åƒ…å­˜åœ¨æ–¼JDK 1.7 ï¼ŒJDK 1.8ä¸­å¯¦éš›ä¸Šç„¡è©²å‡½æ•¸ï¼ˆç›´æ¥ç”¨1æ¢èªå¥åˆ¤æ–·å¯«å‡ºï¼‰ï¼Œä½†åŸç†ç›¸åŒ * ç‚ºäº†æ–¹ä¾¿è¬›è§£ï¼Œæ•…æå‰åˆ°æ­¤è¬›è§£ */ static int indexFor(int h, int length) {  return h &amp; (length-1); // å°‡å°å“ˆå¸Œç¢¼æ“¾å‹•è™•ç†å¾Œçš„çµæœ èˆ‡é‹ç®—(&amp;) ï¼ˆæ•¸çµ„é•·åº¦-1ï¼‰ï¼Œæœ€çµ‚å¾—åˆ°å­˜å„²åœ¨æ•¸çµ„tableçš„ä½ç½®ï¼ˆå³æ•¸çµ„ä¸‹æ¨™ã€ç´¢å¼•ï¼‰ }1234567891011121314151617181920212223242526272829303132333435</pre><ul class=list-paddingleft-2><li><p>ç¸½çµ è¨ˆç®—å­˜æ”¾åœ¨æ•¸çµ„ table ä¸­çš„ä½ç½®ï¼ˆå³æ•¸çµ„ä¸‹æ¨™ã€ç´¢å¼•ï¼‰çš„éç¨‹</p></li></ul><ol class=list-paddingleft-2><li><p>æ­¤è™•èˆ‡ <code>JDK 1.7</code>çš„å€åˆ¥åœ¨æ–¼ï¼š<code>hash</code>å€¼çš„æ±‚è§£éç¨‹ä¸­ å“ˆå¸Œç¢¼çš„äºŒæ¬¡è™•ç†æ–¹å¼ï¼ˆæ“¾å‹•è™•ç†ï¼‰</p></li><li><p>æ­¥é©Ÿ1ã€2 = <code>hash</code>å€¼çš„æ±‚è§£éç¨‹</p></li></ol><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/6c2c0000784ee1c19294></p><ul class=list-paddingleft-2><li><p>è¨ˆç®—ç¤ºæ„åœ–</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/66c600059db69a50fddc></p><hr><p>åœ¨ç­è§£ å¦‚ä½•è¨ˆç®—å­˜æ”¾æ•¸çµ„<code>table</code> ä¸­çš„ä½ç½® å¾Œï¼Œæ‰€è¬‚ çŸ¥å…¶ç„¶ è€Œ éœ€çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œä¸‹é¢æˆ‘å°‡è¬›è§£ç‚ºä»€éº¼è¦é€™æ¨£è¨ˆç®—ï¼Œå³ä¸»è¦è§£ç­”ä»¥ä¸‹3å€‹å•é¡Œï¼š</p><p>1. ç‚ºä»€éº¼ä¸ç›´æ¥æ¡ç”¨ç¶“é<code>hashCodeï¼ˆï¼‰</code>è™•ç†çš„å“ˆå¸Œç¢¼ ä½œç‚º å­˜å„²æ•¸çµ„<code>table</code>çš„ä¸‹æ¨™ä½ç½®ï¼Ÿ</p><p>2. ç‚ºä»€éº¼æ¡ç”¨ å“ˆå¸Œç¢¼ èˆ‡é‹ç®—(&) ï¼ˆæ•¸çµ„é•·åº¦-1ï¼‰ è¨ˆç®—æ•¸çµ„ä¸‹æ¨™ï¼Ÿ</p><p>3. ç‚ºä»€éº¼åœ¨è¨ˆç®—æ•¸çµ„ä¸‹æ¨™å‰ï¼Œéœ€å°å“ˆå¸Œç¢¼é€²è¡ŒäºŒæ¬¡è™•ç†ï¼šæ“¾å‹•è™•ç†ï¼Ÿ</p><p>åœ¨å›ç­”é€™3å€‹å•é¡Œå‰ï¼Œè«‹å¤§å®¶è¨˜ä½ä¸€å€‹æ ¸å¿ƒæ€æƒ³ï¼š</p><blockquote><p>æ‰€æœ‰è™•ç†çš„æ ¹æœ¬ç›®çš„ï¼Œéƒ½æ˜¯ç‚ºäº†æé«˜ å­˜å„²<code>key-value</code>çš„æ•¸çµ„ä¸‹æ¨™ä½ç½® çš„éš¨æ©Ÿæ€§ & åˆ†ä½ˆå‡å‹»æ€§ï¼Œå„˜é‡é¿å…å‡ºç¾hashå€¼è¡çªã€‚å³ï¼šå°æ–¼ä¸åŒ<code>key</code>ï¼Œå­˜å„²çš„æ•¸çµ„ä¸‹æ¨™ä½ç½®è¦å„˜å¯èƒ½ä¸ä¸€æ¨£</p></blockquote><p>å•é¡Œ1ï¼šç‚ºä»€éº¼ä¸ç›´æ¥æ¡ç”¨ç¶“éhashCodeï¼ˆï¼‰è™•ç†çš„å“ˆå¸Œç¢¼ ä½œç‚º å­˜å„²æ•¸çµ„tableçš„ä¸‹æ¨™ä½ç½®ï¼Ÿ</p><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c900036919c401d7ea></p><ul class=list-paddingleft-2><li><p>ç‚ºäº†è§£æ±º â€œå“ˆå¸Œç¢¼èˆ‡æ•¸çµ„å¤§å°ç¯„åœä¸åŒ¹é…â€ çš„å•é¡Œï¼Œ<code>HashMap</code>çµ¦å‡ºç­è§£æ±ºæ–¹æ¡ˆï¼šå“ˆå¸Œç¢¼ èˆ‡é‹ç®—ï¼ˆ&ï¼‰ ï¼ˆæ•¸çµ„é•·åº¦-1ï¼‰ï¼Œå³å•é¡Œ3</p></li></ul><p>å•é¡Œ2ï¼šç‚ºä»€éº¼æ¡ç”¨ å“ˆå¸Œç¢¼ èˆ‡é‹ç®—(&) ï¼ˆæ•¸çµ„é•·åº¦-1ï¼‰ è¨ˆç®—æ•¸çµ„ä¸‹æ¨™ï¼Ÿ</p><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c700053e563f1db8b8></p><p>å•é¡Œ3ï¼šç‚ºä»€éº¼åœ¨è¨ˆç®—æ•¸çµ„ä¸‹æ¨™å‰ï¼Œéœ€å°å“ˆå¸Œç¢¼é€²è¡ŒäºŒæ¬¡è™•ç†ï¼šæ“¾å‹•è™•ç†ï¼Ÿ</p><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c90003691a9f82af6b></p><p>è‡³æ­¤ï¼Œé—œæ–¼æ€éº¼è¨ˆç®— <code>key-value</code> å€¼å­˜å„²åœ¨<code>HashMap</code>æ•¸çµ„ä½ç½® & ç‚ºä»€éº¼è¦é€™éº¼è¨ˆç®—ï¼Œè¬›è§£å®Œç•¢ã€‚</p><hr><p>åˆ†æ2ï¼šputVal(hash(key), key, value, false, true);</p><p>æ­¤è™•æœ‰2å€‹ä¸»è¦è¬›è§£é»ï¼š</p><ul class=list-paddingleft-2><li><p>è¨ˆç®—å®Œå­˜å„²ä½ç½®å¾Œï¼Œå…·é«”è©²å¦‚ä½• å­˜æ”¾æ•¸æ“š åˆ°å“ˆå¸Œè¡¨ä¸­</p></li><li><p>å…·é«”å¦‚ä½•æ“´å®¹ï¼Œå³ æ“´å®¹æ©Ÿåˆ¶</p></li></ul><p>ä¸»è¦è¬›è§£é»1ï¼šè¨ˆç®—å®Œå­˜å„²ä½ç½®å¾Œï¼Œå…·é«”è©²å¦‚ä½•å­˜æ”¾æ•¸æ“šåˆ°å“ˆå¸Œè¡¨ä¸­</p><p>ç”±æ–¼æ•¸æ“šçµæ§‹ä¸­åŠ å…¥äº†ç´…é»‘æ¨¹ï¼Œæ‰€ä»¥åœ¨å­˜æ”¾æ•¸æ“šåˆ°å“ˆå¸Œè¡¨ä¸­æ™‚ï¼Œéœ€é€²è¡Œå¤šæ¬¡æ•¸æ“šçµæ§‹çš„åˆ¤æ–·ï¼šæ•¸çµ„ã€ç´…é»‘æ¨¹ã€éˆè¡¨</p><blockquote><p>åªéœ€åˆ¤æ–· æ•¸çµ„ & éˆè¡¨</p></blockquote><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6c2c000078500a45662f></p><pre> /** * åˆ†æ2ï¼šputVal(hash(key), key, value, false, true) */ final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) { Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i; // 1. è‹¥å“ˆå¸Œè¡¨çš„æ•¸çµ„tabç‚ºç©ºï¼Œå‰‡ é€šéresize() å‰µå»º // æ‰€ä»¥ï¼Œåˆå§‹åŒ–å“ˆå¸Œè¡¨çš„æ™‚æ©Ÿ = ç¬¬1æ¬¡èª¿ç”¨putå‡½æ•¸æ™‚ï¼Œå³èª¿ç”¨resize() åˆå§‹åŒ–å‰µå»º // é—œæ–¼resizeï¼ˆï¼‰çš„æºç¢¼åˆ†æå°‡åœ¨ä¸‹é¢è¬›è§£æ“´å®¹æ™‚è©³ç´°åˆ†æï¼Œæ­¤è™•å…ˆè·³é if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; // 2. è¨ˆç®—æ’å…¥å­˜å„²çš„æ•¸çµ„ç´¢å¼•iï¼šæ ¹æ“šéµå€¼keyè¨ˆç®—çš„hashå€¼ å¾—åˆ° // æ­¤è™•çš„æ•¸çµ„ä¸‹æ¨™è¨ˆç®—æ–¹å¼ = i = (n - 1) &amp; hashï¼ŒåŒJDK 1.7ä¸­çš„indexForï¼ˆï¼‰ï¼Œä¸Šé¢å·²è©³ç´°æè¿° // 3. æ’å…¥æ™‚ï¼Œéœ€åˆ¤æ–·æ˜¯å¦å­˜åœ¨Hashè¡çªï¼š // è‹¥ä¸å­˜åœ¨ï¼ˆå³ç•¶å‰table[i] == nullï¼‰ï¼Œå‰‡ç›´æ¥åœ¨è©²æ•¸çµ„ä½ç½®æ–°å»ºç¯€é»ï¼Œæ’å…¥å®Œç•¢ // å¦å‰‡ï¼Œä»£è¡¨å­˜åœ¨Hashè¡çªï¼Œå³ç•¶å‰å­˜å„²ä½ç½®å·²å­˜åœ¨ç¯€é»ï¼Œå‰‡ä¾æ¬¡å¾€ä¸‹åˆ¤æ–·ï¼ša. ç•¶å‰ä½ç½®çš„keyæ˜¯å¦èˆ‡éœ€æ’å…¥çš„keyç›¸åŒã€b. åˆ¤æ–·éœ€æ’å…¥çš„æ•¸æ“šçµæ§‹æ˜¯å¦ç‚ºç´…é»‘æ¨¹ or éˆè¡¨ if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null); // newNode(hash, key, value, null)çš„æºç¢¼ = new Node&lt;&gt;(hash, key, value, next) else { Node&lt;K,V&gt; e; K k; // a. åˆ¤æ–· table[i]çš„å…ƒç´ çš„keyæ˜¯å¦èˆ‡ éœ€æ’å…¥çš„keyä¸€æ¨£ï¼Œè‹¥ç›¸åŒå‰‡ ç›´æ¥ç”¨æ–°value è¦†è“‹ èˆŠvalue // åˆ¤æ–·åŸå‰‡ï¼šequalsï¼ˆï¼‰ if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) e = p; // b. ç¹¼çºŒåˆ¤æ–·ï¼šéœ€æ’å…¥çš„æ•¸æ“šçµæ§‹æ˜¯å¦ç‚ºç´…é»‘æ¨¹ or éˆè¡¨ // è‹¥æ˜¯ç´…é»‘æ¨¹ï¼Œå‰‡ç›´æ¥åœ¨æ¨¹ä¸­æ’å…¥ or æ›´æ–°éµå€¼å° else if (p instanceof TreeNode) e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value); -&gt;&gt;åˆ†æ3 // è‹¥æ˜¯éˆè¡¨,å‰‡åœ¨éˆè¡¨ä¸­æ’å…¥ or æ›´æ–°éµå€¼å° // i. éæ­·table[i]ï¼Œåˆ¤æ–·Keyæ˜¯å¦å·²å­˜åœ¨ï¼šæ¡ç”¨equalsï¼ˆï¼‰ å°æ¯”ç•¶å‰éæ­·ç¯€é»çš„key èˆ‡ éœ€æ’å…¥æ•¸æ“šçš„keyï¼šè‹¥å·²å­˜åœ¨ï¼Œå‰‡ç›´æ¥ç”¨æ–°value è¦†è“‹ èˆŠvalue // ii. éæ­·å®Œç•¢å¾Œä»ç„¡ç™¼ç¾ä¸Šè¿°æƒ…æ³ï¼Œå‰‡ç›´æ¥åœ¨éˆè¡¨å°¾éƒ¨æ’å…¥æ•¸æ“š // æ³¨ï¼šæ–°å¢ç¯€é»å¾Œï¼Œéœ€åˆ¤æ–·éˆè¡¨é•·åº¦æ˜¯å¦&gt;8ï¼ˆ8 = æ¡¶çš„æ¨¹åŒ–é–¾å€¼ï¼‰ï¼šè‹¥æ˜¯ï¼Œå‰‡æŠŠéˆè¡¨è½‰æ›ç‚ºç´…é»‘æ¨¹ else { for (int binCount = 0; ; ++binCount) { // å°æ–¼iiï¼šè‹¥æ•¸çµ„çš„ä¸‹1å€‹ä½ç½®ï¼Œè¡¨ç¤ºå·²åˆ°è¡¨å°¾ä¹Ÿæ²’æœ‰æ‰¾åˆ°keyå€¼ç›¸åŒç¯€é»ï¼Œå‰‡æ–°å»ºç¯€é» = æ’å…¥ç¯€é» // æ³¨ï¼šæ­¤è™•æ˜¯å¾éˆè¡¨å°¾æ’å…¥ï¼Œèˆ‡JDK 1.7ä¸åŒï¼ˆå¾éˆè¡¨é ­æ’å…¥ï¼Œå³æ°¸é éƒ½æ˜¯æ·»åŠ åˆ°æ•¸çµ„çš„ä½ç½®ï¼ŒåŸä¾†æ•¸çµ„ä½ç½®çš„æ•¸æ“šå‰‡å¾€å¾Œç§»ï¼‰ if ((e = p.next) == null) { p.next = newNode(hash, key, value, null); // æ’å…¥ç¯€é»å¾Œï¼Œè‹¥éˆè¡¨ç¯€é»&gt;æ•¸é–¾å€¼ï¼Œå‰‡å°‡éˆè¡¨è½‰æ›ç‚ºç´…é»‘æ¨¹ if (binCount &gt;= TREEIFY_THRESHOLD - 1) treeifyBin(tab, hash); // æ¨¹åŒ–æ“ä½œ break; } // å°æ–¼i if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) break; // æ›´æ–°pæŒ‡å‘ä¸‹ä¸€å€‹ç¯€é»ï¼Œç¹¼çºŒéæ­· p = e; } } // å°iæƒ…æ³çš„å¾ŒçºŒæ“ä½œï¼šç™¼ç¾keyå·²å­˜åœ¨ï¼Œç›´æ¥ç”¨æ–°value è¦†è“‹ èˆŠvalue &amp; è¿”å›èˆŠvalue if (e != null) { V oldValue = e.value; if (!onlyIfAbsent || oldValue == null) e.value = value; afterNodeAccess(e); // æ›¿æ›èˆŠå€¼æ™‚æœƒèª¿ç”¨çš„æ–¹æ³•ï¼ˆé»˜èªå¯¦ç¾ç‚ºç©ºï¼‰ return oldValue; } } ++modCount; // æ’å…¥æˆåŠŸå¾Œï¼Œåˆ¤æ–·å¯¦éš›å­˜åœ¨çš„éµå€¼å°æ•¸é‡size &gt; æœ€å¤§å®¹é‡threshold // è‹¥ &gt; ï¼Œå‰‡é€²è¡Œæ“´å®¹ -&gt;&gt;åˆ†æ4ï¼ˆä½†å–®ç¨è¬›è§£ï¼Œè«‹ç›´æ¥è·³å‡ºè©²ä»£ç¢¼å¡Šï¼‰ if (++size &gt; threshold) resize(); afterNodeInsertion(evict);// æ’å…¥æˆåŠŸæ™‚æœƒèª¿ç”¨çš„æ–¹æ³•ï¼ˆé»˜èªå¯¦ç¾ç‚ºç©ºï¼‰ return null;} /** * åˆ†æ3ï¼šputTreeVal(this, tab, hash, key, value) * ä½œç”¨ï¼šå‘ç´…é»‘æ¨¹æ’å…¥ or æ›´æ–°æ•¸æ“šï¼ˆéµå€¼å°ï¼‰ * éç¨‹ï¼šéæ­·ç´…é»‘æ¨¹åˆ¤æ–·è©²ç¯€é»çš„keyæ˜¯å¦èˆ‡éœ€æ’å…¥çš„key ç›¸åŒï¼š * a. è‹¥ç›¸åŒï¼Œå‰‡æ–°valueè¦†è“‹èˆŠvalue * b. è‹¥ä¸ç›¸åŒï¼Œå‰‡æ’å…¥ */ final TreeNode&lt;K,V&gt; putTreeVal(HashMap&lt;K,V&gt; map, Node&lt;K,V&gt;[] tab, int h, K k, V v) { Class&lt;?&gt; kc = null; boolean searched = false; TreeNode&lt;K,V&gt; root = (parent != null) ? root() : this;  for (TreeNode&lt;K,V&gt; p = root;;) {  int dir, ph; K pk;  if ((ph = p.hash) &gt; h) dir = -1;  else if (ph &lt; h) dir = 1;  else if ((pk = p.key) == k || (k != null &amp;&amp; k.equals(pk))) return p; else if ((kc == null &amp;&amp; (kc = comparableClassFor(k)) == null) || (dir = compareComparables(kc, k, pk)) == 0) {  if (!searched) { TreeNode&lt;K,V&gt; q, ch; searched = true;  if (((ch = p.left) != null &amp;&amp; (q = ch.find(h, k, kc)) != null) || ((ch = p.right) != null &amp;&amp; (q = ch.find(h, k, kc)) != null)) return q; } dir = tieBreakOrder(k, pk); } TreeNode&lt;K,V&gt; xp = p;  if ((p = (dir &lt;= 0) ? p.left : p.right) == null) { Node&lt;K,V&gt; xpn = xp.next; TreeNode&lt;K,V&gt; x = map.newTreeNode(h, k, v, xpn); if (dir &lt;= 0) xp.left = x; else xp.right = x; xp.next = x; x.parent = x.prev = xp; if (xpn != null) ((TreeNode&lt;K,V&gt;)xpn).prev = x; moveRootToFront(tab, balanceInsertion(root, x)); return null; } } }</pre><ul class=list-paddingleft-2><li><p>ç¸½çµ</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c8000464f47a3041c4></p><p>ä¸»è¦è¬›è§£é»2ï¼šæ“´å®¹æ©Ÿåˆ¶ï¼ˆå³ resizeï¼ˆï¼‰å‡½æ•¸æ–¹æ³•ï¼‰</p><ul class=list-paddingleft-2><li><p>æ“´å®¹æµç¨‹å¦‚ä¸‹</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/6c2c0000784fefc81fd8></p><ul class=list-paddingleft-2><li><p>æºç¢¼åˆ†æ</p></li></ul><pre> /** * åˆ†æ4ï¼šresizeï¼ˆï¼‰ * è©²å‡½æ•¸æœ‰2ç¨®ä½¿ç”¨æƒ…æ³ï¼š1.åˆå§‹åŒ–å“ˆå¸Œè¡¨ 2.ç•¶å‰æ•¸çµ„å®¹é‡éå°ï¼Œéœ€æ“´å®¹ */ final Node&lt;K,V&gt;[] resize() { Node&lt;K,V&gt;[] oldTab = table; // æ“´å®¹å‰çš„æ•¸çµ„ï¼ˆç•¶å‰æ•¸çµ„ï¼‰ int oldCap = (oldTab == null) ? 0 : oldTab.length; // æ“´å®¹å‰çš„æ•¸çµ„çš„å®¹é‡ = é•·åº¦ int oldThr = threshold;// æ“´å®¹å‰çš„æ•¸çµ„çš„é–¾å€¼ int newCap, newThr = 0; // é‡å°æƒ…æ³2ï¼šè‹¥æ“´å®¹å‰çš„æ•¸çµ„å®¹é‡è¶…éæœ€å¤§å€¼ï¼Œå‰‡ä¸å†æ“´å…… if (oldCap &gt; 0) { if (oldCap &gt;= MAXIMUM_CAPACITY) { threshold = Integer.MAX_VALUE; return oldTab; } // é‡å°æƒ…æ³2ï¼šè‹¥ç„¡è¶…éæœ€å¤§å€¼ï¼Œå°±æ“´å……ç‚ºåŸä¾†çš„2å€ else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp; oldCap &gt;= DEFAULT_INITIAL_CAPACITY) newThr = oldThr &lt;&lt; 1; // é€šéå³ç§»æ“´å……2å€ } // é‡å°æƒ…æ³1ï¼šåˆå§‹åŒ–å“ˆå¸Œè¡¨ï¼ˆæ¡ç”¨æŒ‡å®š or é»˜èªå€¼ï¼‰ else if (oldThr &gt; 0) // initial capacity was placed in threshold newCap = oldThr; else { // zero initial threshold signifies using defaults newCap = DEFAULT_INITIAL_CAPACITY; newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY); } // è¨ˆç®—æ–°çš„resizeä¸Šé™ if (newThr == 0) { float ft = (float)newCap * loadFactor; newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ? (int)ft : Integer.MAX_VALUE); } threshold = newThr; @SuppressWarnings({"rawtypes","unchecked"}) Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap]; table = newTab; if (oldTab != null) { // æŠŠæ¯å€‹bucketéƒ½ç§»å‹•åˆ°æ–°çš„bucketsä¸­ for (int j = 0; j &lt; oldCap; ++j) { Node&lt;K,V&gt; e; if ((e = oldTab[j]) != null) { oldTab[j] = null; if (e.next == null) newTab[e.hash &amp; (newCap - 1)] = e; else if (e instanceof TreeNode) ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap); else { // éˆè¡¨å„ªåŒ–é‡hashçš„ä»£ç¢¼å¡Š Node&lt;K,V&gt; loHead = null, loTail = null; Node&lt;K,V&gt; hiHead = null, hiTail = null; Node&lt;K,V&gt; next; do { next = e.next; // åŸç´¢å¼• if ((e.hash &amp; oldCap) == 0) { if (loTail == null) loHead = e; else loTail.next = e; loTail = e; } // åŸç´¢å¼• + oldCap else { if (hiTail == null) hiHead = e; else hiTail.next = e; hiTail = e; } } while ((e = next) != null); // åŸç´¢å¼•æ”¾åˆ°bucketè£¡ if (loTail != null) { loTail.next = null; newTab[j] = loHead; } // åŸç´¢å¼•+oldCapæ”¾åˆ°bucketè£¡ if (hiTail != null) { hiTail.next = null; newTab[j + oldCap] = hiHead; } } } } } return newTab;}1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495</pre><ul class=list-paddingleft-2><li><p>æ“´å®¹æµç¨‹ï¼ˆå« èˆ‡ <code>JDK 1.7</code> çš„å°æ¯”ï¼‰</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c8000464f5f18ae0f4></p><p>æ­¤è™•ä¸»è¦è¬›è§£ï¼š <code>JDK 1.8</code>æ“´å®¹æ™‚ï¼Œæ•¸æ“šå­˜å„²ä½ç½®é‡æ–°è¨ˆç®—çš„æ–¹å¼</p><ul class=list-paddingleft-2><li><p>è¨ˆç®—çµè«– & åŸå› è§£æ</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c600059db8588bc1be></p><ul class=list-paddingleft-2><li><p>çµè«–ç¤ºæ„åœ–</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/66c40005d5ece5607bb5></p><ul class=list-paddingleft-2><li><p>æ•¸çµ„ä½ç½®è½‰æ›çš„ç¤ºæ„åœ–</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6c2c00007853b79b150c></p><ul class=list-paddingleft-2><li><p><code>JDK 1.8</code>æ ¹æ“šæ­¤çµè«–ä½œå‡ºçš„æ–°å…ƒç´ å­˜å„²ä½ç½®è¨ˆç®—è¦å‰‡ éå¸¸ç°¡å–®ï¼Œæé«˜äº†æ“´å®¹æ•ˆç‡ï¼Œå…·é«”å¦‚ä¸‹åœ–</p><blockquote>é€™èˆ‡ <code>JDK 1.7</code>åœ¨è¨ˆç®—æ–°å…ƒç´ çš„å­˜å„²ä½ç½®æœ‰å¾ˆå¤§å€åˆ¥ï¼š<code>JDK 1.7</code>åœ¨æ“´å®¹å¾Œï¼Œéƒ½éœ€æŒ‰ç…§åŸä¾†æ–¹æ³•é‡æ–°è¨ˆç®—ï¼Œå³<p><code>hashCodeï¼ˆï¼‰</code>->> æ“¾å‹•è™•ç† ->><code>ï¼ˆh & length-1ï¼‰</code>ï¼‰</p></blockquote></li></ul><p>ç¸½çµ</p><ul class=list-paddingleft-2><li><p>æ·»åŠ æ•¸æ“šçš„æµç¨‹</p></li><li><p>èˆ‡ <code>JDK 1.7</code>çš„å€åˆ¥</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6c2c0000785214ec7ce5></p><ul class=list-paddingleft-2><li></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c8000464f67f07873a></p><p>è‡³æ­¤ï¼Œé—œæ–¼ <code>HashMap</code>çš„æ·»åŠ æ•¸æ“šæºç¢¼åˆ†æ åˆ†æå®Œç•¢ã€‚</p><hr><h1></h1><p>æ­¥é©Ÿ3ï¼šå¾HashMapä¸­ç²å–æ•¸æ“š</p><ul class=list-paddingleft-2><li><p>å‡å¦‚ç†è§£äº†ä¸Šè¿°<code>putï¼ˆï¼‰</code>å‡½æ•¸çš„åŸç†ï¼Œé‚£éº¼<code>getï¼ˆï¼‰</code>å‡½æ•¸éå¸¸å¥½ç†è§£ï¼Œå› ç‚ºäºŒè€…çš„éç¨‹åŸç†å¹¾ä¹ç›¸åŒ</p></li><li><p><code>getï¼ˆï¼‰</code>å‡½æ•¸çš„æµç¨‹å¦‚ä¸‹ï¼š</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/6c2c000078512e4cac62></p><ul class=list-paddingleft-2><li><p>æºç¢¼åˆ†æ</p></li></ul><pre>/** * å‡½æ•¸åŸå‹ * ä½œç”¨ï¼šæ ¹æ“šéµkeyï¼Œå‘HashMapç²å–å°æ‡‰çš„å€¼ */ map.get(key)ï¼› /** * æºç¢¼åˆ†æ */ public V get(Object key) { Node&lt;K,V&gt; e; // 1. è¨ˆç®—éœ€ç²å–æ•¸æ“šçš„hashå€¼ // 2. é€šégetNodeï¼ˆï¼‰ç²å–æ‰€æŸ¥è©¢çš„æ•¸æ“š -&gt;&gt;åˆ†æ1 // 3. ç²å–å¾Œï¼Œåˆ¤æ–·æ•¸æ“šæ˜¯å¦ç‚ºç©º return (e = getNode(hash(key), key)) == null ? null : e.value;}/** * åˆ†æ1ï¼šgetNode(hash(key), key)) */ final Node&lt;K,V&gt; getNode(int hash, Object key) { Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; int n; K k; // 1. è¨ˆç®—å­˜æ”¾åœ¨æ•¸çµ„tableä¸­çš„ä½ç½® if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp; (first = tab[(n - 1) &amp; hash]) != null) { // 4. é€šéè©²å‡½æ•¸ï¼Œä¾æ¬¡åœ¨æ•¸çµ„ã€ç´…é»‘æ¨¹ã€éˆè¡¨ä¸­æŸ¥æ‰¾ï¼ˆé€šéequalsï¼ˆï¼‰åˆ¤æ–·ï¼‰ // a. å…ˆåœ¨æ•¸çµ„ä¸­æ‰¾ï¼Œè‹¥å­˜åœ¨ï¼Œå‰‡ç›´æ¥è¿”å› if (first.hash == hash &amp;&amp; // always check first node ((k = first.key) == key || (key != null &amp;&amp; key.equals(k)))) return first; // b. è‹¥æ•¸çµ„ä¸­æ²’æœ‰ï¼Œå‰‡åˆ°ç´…é»‘æ¨¹ä¸­å°‹æ‰¾ if ((e = first.next) != null) { // åœ¨æ¨¹ä¸­get if (first instanceof TreeNode) return ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key); // c. è‹¥ç´…é»‘æ¨¹ä¸­ä¹Ÿæ²’æœ‰ï¼Œå‰‡é€šééæ­·ï¼Œåˆ°éˆè¡¨ä¸­å°‹æ‰¾ do { if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) return e; } while ((e = e.next) != null); } } return null;}1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950</pre><p>è‡³æ­¤ï¼Œé—œæ–¼ â€œå‘ <code>HashMap</code> ç²å–æ•¸æ“š â€œè¬›è§£å®Œç•¢ã€‚</p><hr><p>æ­¥é©Ÿ4ï¼šå°HashMapçš„å…¶ä»–æ“ä½œ</p><blockquote><p>å³ å°å…¶é¤˜ä½¿ç”¨<code>API</code>ï¼ˆå‡½æ•¸ã€æ–¹æ³•ï¼‰çš„æºç¢¼åˆ†æ</p><p>- <code>HashMap</code>é™¤äº†æ ¸å¿ƒçš„<code>putï¼ˆï¼‰</code>ã€<code>getï¼ˆï¼‰</code>å‡½æ•¸ï¼Œé‚„æœ‰ä»¥ä¸‹ä¸»è¦ä½¿ç”¨çš„å‡½æ•¸æ–¹æ³•</p></blockquote><pre>void clear(); // æ¸…é™¤å“ˆå¸Œè¡¨ä¸­çš„æ‰€æœ‰éµå€¼å°int size(); // è¿”å›å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰ éµå€¼å°çš„æ•¸é‡ = æ•¸çµ„ä¸­çš„éµå€¼å° + éˆè¡¨ä¸­çš„éµå€¼å°boolean isEmpty(); // åˆ¤æ–·HashMapæ˜¯å¦ç‚ºç©ºï¼›size == 0æ™‚ è¡¨ç¤ºç‚º ç©º void putAll(Map&lt;? extends K, ? extends V&gt; m); // å°‡æŒ‡å®šMapä¸­çš„éµå€¼å° è¤‡è£½åˆ° æ­¤Mapä¸­V remove(Object key); // åˆªé™¤è©²éµå€¼å°boolean containsKey(Object key); // åˆ¤æ–·æ˜¯å¦å­˜åœ¨è©²éµçš„éµå€¼å°ï¼›æ˜¯ å‰‡è¿”å›trueboolean containsValue(Object value); // åˆ¤æ–·æ˜¯å¦å­˜åœ¨è©²å€¼çš„éµå€¼å°ï¼›æ˜¯ å‰‡è¿”å›true1234567891011</pre><ul class=list-paddingleft-2><li><p>é—œæ–¼ä¸Šè¿°æ–¹æ³•çš„æºç¢¼çš„åŸç† åŒ <code>JDK 1.7</code>ï¼Œæ­¤è™•ä¸ä½œéå¤šæè¿°</p><blockquote><p>æ„Ÿèˆˆè¶£çš„åŒå­¸å¯ä»¥åƒè€ƒæ–‡ç«  ç¬¬5å°ç¯€ é€²è¡Œé¡æ¯”ã€‚</p></blockquote></li></ul><p>è‡³æ­¤ï¼Œé—œæ–¼ <code>HashMap</code>çš„åº•å±¤åŸç† & ä¸»è¦ä½¿ç”¨<code>API</code>ï¼ˆå‡½æ•¸ã€æ–¹æ³•ï¼‰è¬›è§£å®Œç•¢ã€‚</p><hr><h1></h1><p>6. æºç¢¼ç¸½çµ</p><p>ä¸‹é¢ï¼Œç”¨3å€‹åœ–ç¸½çµæ•´å€‹æºç¢¼å…§å®¹ï¼š</p><blockquote><p>ç¸½çµå…§å®¹ = æ•¸æ“šçµæ§‹ã€ä¸»è¦åƒæ•¸ã€æ·»åŠ  & æŸ¥è©¢æ•¸æ“šæµç¨‹ã€æ“´å®¹æ©Ÿåˆ¶</p></blockquote><ul class=list-paddingleft-2><li><p>æ•¸æ“šçµæ§‹ & ä¸»è¦åƒæ•¸</p></li><li><p>æ·»åŠ  & æŸ¥è©¢æ•¸æ“šæµç¨‹</p></li><li><p>æ“´å®¹æ©Ÿåˆ¶</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c50005b185a373c7e6></p><ul class=list-paddingleft-2><li></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c700053e58208851f2></p><ul class=list-paddingleft-2><li></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/6c2c00007854f33eff3d></p><hr><h1></h1><p>7. èˆ‡ <code>JDK 1.7</code> çš„å€åˆ¥</p><p><code>HashMap</code> çš„å¯¦ç¾åœ¨ <code>JDK 1.7</code> å’Œ <code>JDK 1.8</code> å·®åˆ¥è¼ƒå¤§ï¼Œå…·é«”å€åˆ¥å¦‚ä¸‹</p><blockquote><ol class=list-paddingleft-2><li><p><code>JDK 1.8</code> çš„å„ªåŒ–ç›®çš„ä¸»è¦æ˜¯ï¼šæ¸›å°‘ <code>Hash</code>è¡çª & æé«˜å“ˆå¸Œè¡¨çš„å­˜ã€å–æ•ˆç‡</p></li><li><p>é—œæ–¼ <code>JDK 1.7</code> ä¸­ <code>HashMap</code> çš„æºç¢¼è§£æè«‹çœ‹æ–‡ç« ï¼šJavaï¼šæ‰‹æŠŠæ‰‹å¸¶ä½ æºç¢¼åˆ†æ HashMap 1.7</p></li></ol></blockquote><p><strong>7.1 æ•¸æ“šçµæ§‹</strong></p><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c8000464f75719a4c8></p><p>7.2 ç²å–æ•¸æ“šæ™‚ï¼ˆç²å–æ•¸æ“š é¡ä¼¼ï¼‰</p><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c600059dba17f56073></p><p>7.3 æ“´å®¹æ©Ÿåˆ¶</p><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c40005d5ee8d724415></p><hr><h1></h1><p>8. é¡å¤–è£œå……ï¼šé—œæ–¼HashMapçš„å…¶ä»–å•é¡Œ</p><ul class=list-paddingleft-2><li><p>æœ‰å¹¾å€‹å°å•é¡Œéœ€è¦åœ¨æ­¤è£œå……</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/6c2c00007855d2c3ee07></p><ul class=list-paddingleft-2><li><p>å…·é«”å¦‚ä¸‹</p></li></ul><p>8.1 å“ˆå¸Œè¡¨å¦‚ä½•è§£æ±ºHashè¡çª</p><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c40005d5eff1932cc1></p><p>8.2 ç‚ºä»€éº¼HashMapå…·å‚™ä¸‹è¿°ç‰¹é»ï¼šéµ-å€¼ï¼ˆkey-valueï¼‰éƒ½å…è¨±ç‚ºç©ºã€ç·šç¨‹ä¸å®‰å…¨ã€ä¸ä¿è­‰æœ‰åºã€å­˜å„²ä½ç½®éš¨æ™‚é–“è®ŠåŒ–</p><ul class=list-paddingleft-2><li><p>å…·é«”è§£ç­”å¦‚ä¸‹</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c8000464f8ddda1c6b></p><ul class=list-paddingleft-2><li><p>ä¸‹é¢ä¸»è¦è¬›è§£ <code>HashMap</code> ç·šç¨‹ä¸å®‰å…¨çš„å…¶ä¸­ä¸€å€‹é‡è¦åŸå› ï¼šå¤šç·šç¨‹ä¸‹å®¹æ˜“å‡ºç¾<code>resizeï¼ˆï¼‰</code>æ­»å¾ªç’°</p><p>æœ¬è³ª = ä½µç™¼ åŸ·è¡Œ <code>putï¼ˆï¼‰</code>æ“ä½œå°è‡´è§¸ç™¼ æ“´å®¹è¡Œç‚ºï¼Œå¾è€Œå°è‡´ ç’°å½¢éˆè¡¨ï¼Œä½¿å¾—åœ¨ç²å–æ•¸æ“šéæ­·éˆè¡¨æ™‚å½¢æˆæ­»å¾ªç’°ï¼Œå³<code>Infinite Loop</code></p></li><li><p>å…ˆçœ‹æ“´å®¹çš„æºç¢¼åˆ†æ<code>resizeï¼ˆï¼‰</code></p><blockquote><p>é—œæ–¼resizeï¼ˆï¼‰çš„æºç¢¼åˆ†æå·²åœ¨ä¸Šæ–‡è©³ç´°åˆ†æï¼Œæ­¤è™•åƒ…ä½œé‡é»åˆ†æï¼štransferï¼ˆï¼‰</p></blockquote></li></ul><pre>/** * æºç¢¼åˆ†æï¼šresize(2 * table.length) * ä½œç”¨ï¼šç•¶å®¹é‡ä¸è¶³æ™‚ï¼ˆå®¹é‡ &gt; é–¾å€¼ï¼‰ï¼Œå‰‡æ“´å®¹ï¼ˆæ“´åˆ°2å€ï¼‰ */ void resize(int newCapacity) {  // 1. ä¿å­˜èˆŠæ•¸çµ„ï¼ˆold tableï¼‰ Entry[] oldTable = table;  // 2. ä¿å­˜èˆŠå®¹é‡ï¼ˆold capacity ï¼‰ï¼Œå³æ•¸çµ„é•·åº¦ int oldCapacity = oldTable.length; // 3. è‹¥èˆŠå®¹é‡å·²ç¶“æ˜¯ç³»çµ±é»˜èªæœ€å¤§å®¹é‡äº†ï¼Œé‚£éº¼å°‡é–¾å€¼è¨­ç½®æˆæ•´å‹çš„æœ€å¤§å€¼ï¼Œé€€å‡º  if (oldCapacity == MAXIMUM_CAPACITY) {  threshold = Integer.MAX_VALUE;  return;  }  // 4. æ ¹æ“šæ–°å®¹é‡ï¼ˆ2å€å®¹é‡ï¼‰æ–°å»º1å€‹æ•¸çµ„ï¼Œå³æ–°table  Entry[] newTable = new Entry[newCapacity];  // 5. ï¼ˆé‡é»åˆ†æï¼‰å°‡èˆŠæ•¸çµ„ä¸Šçš„æ•¸æ“šï¼ˆéµå€¼å°ï¼‰è½‰ç§»åˆ°æ–°tableä¸­ï¼Œå¾è€Œå®Œæˆæ“´å®¹ -&gt;&gt;åˆ†æ1.1 transfer(newTable); // 6. æ–°æ•¸çµ„tableå¼•ç”¨åˆ°HashMapçš„tableå±¬æ€§ä¸Š table = newTable;  // 7. é‡æ–°è¨­ç½®é–¾å€¼  threshold = (int)(newCapacity * loadFactor);}/** * åˆ†æ1.1ï¼štransfer(newTable); * ä½œç”¨ï¼šå°‡èˆŠæ•¸çµ„ä¸Šçš„æ•¸æ“šï¼ˆéµå€¼å°ï¼‰è½‰ç§»åˆ°æ–°tableä¸­ï¼Œå¾è€Œå®Œæˆæ“´å®¹ * éç¨‹ï¼šæŒ‰èˆŠéˆè¡¨çš„æ­£åºéæ­·éˆè¡¨ã€åœ¨æ–°éˆè¡¨çš„é ­éƒ¨ä¾æ¬¡æ’å…¥ */ void transfer(Entry[] newTable) { // 1. srcå¼•ç”¨äº†èˆŠæ•¸çµ„ Entry[] src = table; // 2. ç²å–æ–°æ•¸çµ„çš„å¤§å° = ç²å–æ–°å®¹é‡å¤§å°  int newCapacity = newTable.length; // 3. é€šééæ­· èˆŠæ•¸çµ„ï¼Œå°‡èˆŠæ•¸çµ„ä¸Šçš„æ•¸æ“šï¼ˆéµå€¼å°ï¼‰è½‰ç§»åˆ°æ–°æ•¸çµ„ä¸­ for (int j = 0; j &lt; src.length; j++) { // 3.1 å–å¾—èˆŠæ•¸çµ„çš„æ¯å€‹å…ƒç´   Entry&lt;K,V&gt; e = src[j];  if (e != null) { // 3.2 é‡‹æ”¾èˆŠæ•¸çµ„çš„å°è±¡å¼•ç”¨ï¼ˆforå¾ªç’°å¾Œï¼ŒèˆŠæ•¸çµ„ä¸å†å¼•ç”¨ä»»ä½•å°è±¡ï¼‰ src[j] = null; do { // 3.3 éæ­· ä»¥è©²æ•¸çµ„å…ƒç´ ç‚ºé¦– çš„éˆè¡¨ // æ³¨ï¼šè½‰ç§»éˆè¡¨æ™‚ï¼Œå› æ˜¯å–®éˆè¡¨ï¼Œæ•…è¦ä¿å­˜ä¸‹1å€‹çµé»ï¼Œå¦å‰‡è½‰ç§»å¾Œéˆè¡¨æœƒæ–·é–‹ Entry&lt;K,V&gt; next = e.next; // 3.3 é‡æ–°è¨ˆç®—æ¯å€‹å…ƒç´ çš„å­˜å„²ä½ç½® int i = indexFor(e.hash, newCapacity); // 3.4 å°‡å…ƒç´ æ”¾åœ¨æ•¸çµ„ä¸Šï¼šæ¡ç”¨å–®éˆè¡¨çš„é ­æ’å…¥æ–¹å¼ = åœ¨éˆè¡¨é ­ä¸Šå­˜æ”¾æ•¸æ“š = å°‡æ•¸çµ„ä½ç½®çš„åŸæœ‰æ•¸æ“šæ”¾åœ¨å¾Œ1å€‹æŒ‡é‡ã€å°‡éœ€æ”¾å…¥çš„æ•¸æ“šæ”¾åˆ°æ•¸çµ„ä½ç½®ä¸­ // å³ æ“´å®¹å¾Œï¼Œå¯èƒ½å‡ºç¾é€†åºï¼šæŒ‰èˆŠéˆè¡¨çš„æ­£åºéæ­·éˆè¡¨ã€åœ¨æ–°éˆè¡¨çš„é ­éƒ¨ä¾æ¬¡æ’å…¥ e.next = newTable[i]; newTable[i] = e;  // è¨ªå•ä¸‹1å€‹Entryéˆä¸Šçš„å…ƒç´ ï¼Œå¦‚æ­¤ä¸æ–·å¾ªç’°ï¼Œç›´åˆ°éæ­·å®Œè©²éˆè¡¨ä¸Šçš„æ‰€æœ‰ç¯€é» e = next;  } while (e != null); // å¦‚æ­¤ä¸æ–·å¾ªç’°ï¼Œç›´åˆ°éæ­·å®Œæ•¸çµ„ä¸Šçš„æ‰€æœ‰æ•¸æ“šå…ƒç´  } }}</pre><p>å¾ä¸Šé¢å¯çœ‹å‡ºï¼šåœ¨æ“´å®¹<code>resizeï¼ˆï¼‰</code>éç¨‹ä¸­ï¼Œåœ¨å°‡èˆŠæ•¸çµ„ä¸Šçš„æ•¸æ“š è½‰ç§»åˆ° æ–°æ•¸çµ„ä¸Šæ™‚ï¼Œè½‰ç§»æ•¸æ“šæ“ä½œ = æŒ‰èˆŠéˆè¡¨çš„æ­£åºéæ­·éˆè¡¨ã€åœ¨æ–°éˆè¡¨çš„é ­éƒ¨ä¾æ¬¡æ’å…¥ï¼Œå³åœ¨è½‰ç§»æ•¸æ“šã€æ“´å®¹å¾Œï¼Œå®¹æ˜“å‡ºç¾éˆè¡¨é€†åºçš„æƒ…æ³</p><blockquote><p>è¨­é‡æ–°è¨ˆç®—å­˜å„²ä½ç½®å¾Œä¸è®Šï¼Œå³æ“´å®¹å‰ = 1->2->3ï¼Œæ“´å®¹å¾Œ = 3->2->1</p></blockquote><ul class=list-paddingleft-2><li><p>æ­¤æ™‚è‹¥ï¼ˆå¤šç·šç¨‹ï¼‰ä½µç™¼åŸ·è¡Œ <code>putï¼ˆï¼‰</code>æ“ä½œï¼Œä¸€æ—¦å‡ºç¾æ“´å®¹æƒ…æ³ï¼Œå‰‡ å®¹æ˜“å‡ºç¾ ç’°å½¢éˆè¡¨ï¼Œå¾è€Œåœ¨ç²å–æ•¸æ“šã€éæ­·éˆè¡¨æ™‚ å½¢æˆæ­»å¾ªç’°ï¼ˆ<code>Infinite Loop</code>ï¼‰ï¼Œå³ æ­»é–çš„ç‹€æ…‹ï¼Œå…·é«”è«‹çœ‹ä¸‹åœ–ï¼š</p></li></ul><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c8000464f97b483cfd></p><p>æ³¨ï¼šç”±æ–¼ <code>JDK 1.8</code> è½‰ç§»æ•¸æ“šæ“ä½œ = æŒ‰èˆŠéˆè¡¨çš„æ­£åºéæ­·éˆè¡¨ã€åœ¨æ–°éˆè¡¨çš„å°¾éƒ¨ä¾æ¬¡æ’å…¥ï¼Œæ‰€ä»¥ä¸æœƒå‡ºç¾éˆè¡¨ é€†åºã€å€’ç½®çš„æƒ…æ³ï¼Œæ•…ä¸å®¹æ˜“å‡ºç¾ç’°å½¢éˆè¡¨çš„æƒ…æ³ã€‚</p><blockquote><p>ä½† <span>JDK 1.8</span>é‚„æ˜¯ç·šç¨‹ä¸å®‰å…¨ï¼Œå› ç‚º ç„¡åŠ åŒæ­¥é–ä¿è­·</p></blockquote><p>8.3 ç‚ºä»€éº¼ HashMap ä¸­ Stringã€Integer é€™æ¨£çš„åŒ…è£é¡é©åˆä½œç‚º key éµ</p><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c50005b186d4ee703e></p><p>8.4 HashMap ä¸­çš„ <code>key<span>è‹¥ </span>Object</code>é¡å‹ï¼Œ å‰‡éœ€å¯¦ç¾å“ªäº›æ–¹æ³•ï¼Ÿ</p><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/66c90003691b39127b61></p><p>è‡³æ­¤ï¼Œé—œæ–¼<span>HashMap</span>çš„æ‰€æœ‰çŸ¥è­˜è¬›è§£å®Œç•¢ã€‚</p><h1></h1><p>9. ç¸½çµ</p><p>æœ¬æ–‡ä¸»è¦è¬›è§£ <code>Java<span>çš„ </span>HashMap</code>æºç¢¼ & ç›¸é—œçŸ¥è­˜ä¸‹é¢æˆ‘å°‡ç¹¼çºŒå°<span>Java</span><span>ã€ </span><span>Android</span></p><p><img alt="Javaæºç¢¼åˆ†æï¼šé—œæ–¼ HashMap 1.8 çš„é‡å¤§æ›´æ–°" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/66c40005d6c8a8474faa></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Java</a></li><li><a>æºç¢¼</a></li><li><a>é—œæ–¼</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/e275511c.html alt=æºç¢¼åˆ†æï¼šJavaé›†åˆé¡çš„AbstractCollectionæºç¢¼è§£æ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a3aefa7e5d8c491cb86dc9c9e4390671 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e275511c.html title=æºç¢¼åˆ†æï¼šJavaé›†åˆé¡çš„AbstractCollectionæºç¢¼è§£æ>æºç¢¼åˆ†æï¼šJavaé›†åˆé¡çš„AbstractCollectionæºç¢¼è§£æ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/12f4776c.html alt="Java HashMapæºç¢¼åˆ†æ" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4a86461eb8cc4ddb9ddf740c0aa49b00 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/12f4776c.html title="Java HashMapæºç¢¼åˆ†æ">Java HashMapæºç¢¼åˆ†æ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d431eb66.html alt=Javaâ€”â€”HashMapæºç¢¼åˆ†æ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/8ad8e7317b3047f28717cf8c6fb816bb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d431eb66.html title=Javaâ€”â€”HashMapæºç¢¼åˆ†æ>Javaâ€”â€”HashMapæºç¢¼åˆ†æ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0f30725a.html alt=Javaä¸­HashMapæºç¢¼åˆ†æï¼Œçµ•å°ä¹¾è²¨ï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/593f0003cad0b7c22de4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0f30725a.html title=Javaä¸­HashMapæºç¢¼åˆ†æï¼Œçµ•å°ä¹¾è²¨ï¼>Javaä¸­HashMapæºç¢¼åˆ†æï¼Œçµ•å°ä¹¾è²¨ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/22f3351b.html alt=Javaå®¹å™¨ç³»åˆ—-HashMapæºç¢¼åˆ†æ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/10798fbb789b4217a4b19b4f307422b1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/22f3351b.html title=Javaå®¹å™¨ç³»åˆ—-HashMapæºç¢¼åˆ†æ>Javaå®¹å™¨ç³»åˆ—-HashMapæºç¢¼åˆ†æ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6eef481.html alt="Javaæºç¢¼ä¸­>>ï¼Œ>>>çš„å€åˆ¥æ˜¯å•¥ï¼Ÿæˆ‘çµ¦ä½ å¾¹åº•è¬›æ¸…" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b12aaaf792c8469c91e2a514a666a8cf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6eef481.html title="Javaæºç¢¼ä¸­>>ï¼Œ>>>çš„å€åˆ¥æ˜¯å•¥ï¼Ÿæˆ‘çµ¦ä½ å¾¹åº•è¬›æ¸…">Javaæºç¢¼ä¸­>>ï¼Œ>>>çš„å€åˆ¥æ˜¯å•¥ï¼Ÿæˆ‘çµ¦ä½ å¾¹åº•è¬›æ¸…</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3c09a7c2.html alt=ç¶²ç«™æºç¢¼ï¼Œæœå‹™å™¨ï¼ŒåŸŸåä¸‰è€…æ˜¯ä»€éº¼é—œä¿‚ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/S1xQDgS3bmZd8q style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3c09a7c2.html title=ç¶²ç«™æºç¢¼ï¼Œæœå‹™å™¨ï¼ŒåŸŸåä¸‰è€…æ˜¯ä»€éº¼é—œä¿‚ï¼Ÿ>ç¶²ç«™æºç¢¼ï¼Œæœå‹™å™¨ï¼ŒåŸŸåä¸‰è€…æ˜¯ä»€éº¼é—œä¿‚ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/677306ff.html alt=é¢è©¦ç¸½çµï¼šé—œæ–¼MySQLäº‹å‹™çš„10å€‹å•é¡Œå¸¸è¦‹é¢è©¦å•ç­” class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/1669c986-315c-4339-a5a0-a918a47f2e57 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/677306ff.html title=é¢è©¦ç¸½çµï¼šé—œæ–¼MySQLäº‹å‹™çš„10å€‹å•é¡Œå¸¸è¦‹é¢è©¦å•ç­”>é¢è©¦ç¸½çµï¼šé—œæ–¼MySQLäº‹å‹™çš„10å€‹å•é¡Œå¸¸è¦‹é¢è©¦å•ç­”</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/48ba24d7.html alt=æ·±å…¥æ·ºå‡ºï¼šJavaäº‹å‹™åŸç†å’Œæ‡‰ç”¨å…¼JDBCäº‹å‹™è©³è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/3c5e0002a8059c1311aa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/48ba24d7.html title=æ·±å…¥æ·ºå‡ºï¼šJavaäº‹å‹™åŸç†å’Œæ‡‰ç”¨å…¼JDBCäº‹å‹™è©³è§£>æ·±å…¥æ·ºå‡ºï¼šJavaäº‹å‹™åŸç†å’Œæ‡‰ç”¨å…¼JDBCäº‹å‹™è©³è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/813d5912.html alt=é—œæ–¼Facebookåƒç´ ï¼Œé€™äº›ä½ ç­è§£å—ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RM0p5dK51SH9EU style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/813d5912.html title=é—œæ–¼Facebookåƒç´ ï¼Œé€™äº›ä½ ç­è§£å—ï¼Ÿ>é—œæ–¼Facebookåƒç´ ï¼Œé€™äº›ä½ ç­è§£å—ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b8bda645.html alt=ã€ŒJavaã€éš¨æ©Ÿæ•¸è©³è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b471807e699b44c2b1dedc580ea3f3af style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b8bda645.html title=ã€ŒJavaã€éš¨æ©Ÿæ•¸è©³è§£>ã€ŒJavaã€éš¨æ©Ÿæ•¸è©³è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/816b04b7.html alt=å¾JVMå±¤é¢å¸¶ä½ åˆ†æJavaçš„Objecté¡æºç¢¼ç¬¬ä¸€éƒ¨åˆ† class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/816b04b7.html title=å¾JVMå±¤é¢å¸¶ä½ åˆ†æJavaçš„Objecté¡æºç¢¼ç¬¬ä¸€éƒ¨åˆ†>å¾JVMå±¤é¢å¸¶ä½ åˆ†æJavaçš„Objecté¡æºç¢¼ç¬¬ä¸€éƒ¨åˆ†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cf633068.html alt="Java å¤šæ…‹çš„å¯¦ç¾æ©Ÿåˆ¶ï¼Œçœ‹äº†éƒ½èªªå¥½" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9d3b0e55813d46b4982ae7d9b81d1802 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cf633068.html title="Java å¤šæ…‹çš„å¯¦ç¾æ©Ÿåˆ¶ï¼Œçœ‹äº†éƒ½èªªå¥½">Java å¤šæ…‹çš„å¯¦ç¾æ©Ÿåˆ¶ï¼Œçœ‹äº†éƒ½èªªå¥½</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/12498348.html alt="Java ç·¨è­¯æ™‚å¤šæ…‹å’Œé‹è¡Œæ™‚å¤šæ…‹" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1531535784468c357213ffe style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/12498348.html title="Java ç·¨è­¯æ™‚å¤šæ…‹å’Œé‹è¡Œæ™‚å¤šæ…‹">Java ç·¨è­¯æ™‚å¤šæ…‹å’Œé‹è¡Œæ™‚å¤šæ…‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d60e504d.html alt=JavaåŸºç¤ä¹‹å¤šæ…‹ï¼Œå‹•æ…‹ç¶å®šå¤šæ…‹çš„ä»£ç¢¼æ¡ˆä¾‹ï¼Œç°¡å–®å»å¾ˆé‡è¦ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ab338c7287fe4649a96227987579c844 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d60e504d.html title=JavaåŸºç¤ä¹‹å¤šæ…‹ï¼Œå‹•æ…‹ç¶å®šå¤šæ…‹çš„ä»£ç¢¼æ¡ˆä¾‹ï¼Œç°¡å–®å»å¾ˆé‡è¦>JavaåŸºç¤ä¹‹å¤šæ…‹ï¼Œå‹•æ…‹ç¶å®šå¤šæ…‹çš„ä»£ç¢¼æ¡ˆä¾‹ï¼Œç°¡å–®å»å¾ˆé‡è¦</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>