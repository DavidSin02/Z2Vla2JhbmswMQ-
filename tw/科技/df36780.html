<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>åœ¨Pythonä¸­å¯¦ç¾SIFT | æå®¢å¿«è¨Š</title><meta property="og:title" content="åœ¨Pythonä¸­å¯¦ç¾SIFT - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/4d54a888a82a417f9de8881a364524ef"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/df36780.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/df36780.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/df36780.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/df36780.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/df36780.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/df36780.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/df36780.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/df36780.html><meta property="article:published_time" content="2020-10-29T20:51:13+08:00"><meta property="article:modified_time" content="2020-10-29T20:51:13+08:00"><meta name=Keywords content><meta name=description content="åœ¨Pythonä¸­å¯¦ç¾SIFT"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/df36780.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>åœ¨Pythonä¸­å¯¦ç¾SIFT</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><p>é—œæ–¼SIFTæœ‰å¾ˆå¤šå…§å®¹ã€‚æœ‰å¾ˆå¤šå¾ˆå¥½çš„æ•™ç¨‹ï¼Œä½†æ¯å€‹éƒ½ä¼¼ä¹ç¼ºå°‘ä¸€äº›æ±è¥¿ï¼Œç„¡è«–æ˜¯é—œæ–¼ç®—æ³•é‚„æ˜¯å¯¦ç¾çš„ç´°ç¯€ã€‚å› æ­¤ï¼Œç•¶æˆ‘æ±ºå®šç‚ºè‡ªå·±å¯¦æ–½SIFTæ™‚ï¼Œæˆ‘ç™¼ç¾è‡ªå·±å¾ˆé›£å¾è¨±å¤šä¾†æºä¸­æå–å…§å®¹ã€‚æˆ‘å®Œæˆäº†ä¸€éƒ¨åˆ†ä»»å‹™ï¼Œç¾åœ¨åˆ†äº«æˆ‘çš„éç¨‹ä»¥åŠå…¶ä»–æ•™ç¨‹æœªæåŠçš„ä¸€äº›ç´°ç¯€ã€‚</p><p><strong>ä»‹ç´¹</strong></p><p>å°æ–¼åˆå­¸è€…ä¾†èªªï¼ŒSIFTæ˜¯ä»€éº¼ï¼ŸSIFTæ˜¯å°ºåº¦ä¸è®Šç‰¹å¾µè®Šæ›ï¼Œæ˜¯ä¸€ç¨®ç”¨æ–¼æå–æè¿°åœ–åƒçš„å±€éƒ¨æ–‘å¡Šçš„ç‰¹å¾µå‘é‡çš„æ–¹æ³•ã€‚é€™äº›ç‰¹å¾µå‘é‡ä¸åƒ…å…·æœ‰å°ºåº¦ä¸è®Šæ€§ï¼Œè€Œä¸”å°æ–¼å¹³ç§»ï¼Œæ—‹è½‰å’Œå…‰ç…§åº¦ä¹Ÿæ˜¯ä¸è®Šçš„ã€‚å¹¾ä¹æ˜¯æè¿°ç¬¦çš„è–ç›ƒã€‚</p><p>é€™äº›æè¿°ç¬¦å°æ–¼åŒ¹é…å°è±¡æ˜¯åœ–åƒä¹‹é–“çš„è£œä¸éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œè€ƒæ…®å‰µå»ºå…¨æ™¯åœ–ã€‚å‡è¨­æ¯å€‹åœ–åƒéƒ½æœ‰ä¸€äº›é‡ç–Šçš„éƒ¨åˆ†ï¼Œä½ éœ€è¦ä¸€äº›æ–¹æ³•ä¾†å°é½Šå®ƒå€‘ï¼Œé€™æ¨£æˆ‘å€‘å°±å¯ä»¥å°‡å®ƒå€‘æ‹¼æ¥åœ¨ä¸€èµ·ã€‚å¦‚æœæˆ‘å€‘çŸ¥é“æ¯å€‹åœ–åƒä¸­æœ‰ä¸€äº›é»å°æ‡‰ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨å–®æ‡‰æ€§ä¾†æ‰­æ›²å…¶ä¸­ä¸€å€‹åœ–åƒã€‚SIFTä¸åƒ…å¯ä»¥è‡ªå‹•æŸ¥æ‰¾æ¯å€‹åœ–åƒä¸­çš„å°æ‡‰é»ï¼Œé‚„å¯ä»¥è‡ªå‹•æŸ¥æ‰¾æ˜“æ–¼åŒ¹é…çš„é»ã€‚</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å¯¦ç¾SIFT onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/4d54a888a82a417f9de8881a364524ef><p class=pgc-img-caption>å…©å€‹åœ–åƒå…·æœ‰é‡ç–Šå€åŸŸ</p></div><div class=pgc-img><img alt=åœ¨Pythonä¸­å¯¦ç¾SIFT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7705b63956514d88b71dc2e07d36a437><p class=pgc-img-caption>ä½¿ç”¨SIFTç‰¹å¾µé»çš„å–®æ‡‰æ€§è½‰æ›ä¸€å€‹åœ–åƒå¾Œçš„çµæœ</p></div><p><strong>ç®—æ³•æè¿°</strong></p><p>SIFTç®—æ³•æœ‰äº”å€‹ä¸»è¦æ­¥é©Ÿï¼š</p><ol><li>å°ºåº¦ç©ºé–“æ¥µå€¼æª¢æ¸¬</li><li>é—œéµé»æœ¬åœ°åŒ–</li><li>æ¶ˆé™¤é‚Šç·£éŸ¿æ‡‰</li><li>æ–¹å‘åˆ†é…</li><li>æœ¬åœ°æè¿°ç¬¦å‰µå»º</li></ol><p>å°ºåº¦ç©ºé–“æ¥µå€¼æª¢æ¸¬</p><p>å¯ä»¥ä½¿ç”¨æ¨™åº¦æ­¸ä¸€åŒ–çš„æ‹‰æ™®æ‹‰æ–¯é«˜æ–¯ï¼ˆLoGï¼‰æ¿¾æ³¢å™¨ä¾†æª¢æ¸¬ç‰¹å¾µçš„ç‰¹å¾µå°ºåº¦ã€‚é€™å°±æ˜¯LoGéæ¿¾å™¨çš„æ¨£å­ï¼š</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å¯¦ç¾SIFT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/27e9d3b8b67640e3862a3b836294e2b2><p class=pgc-img-caption></p></div><p><strong>è² é¢çš„</strong></p><p>LoGæ¿¾æ³¢å™¨åœ¨ä¸­å¿ƒè™•å…·æœ‰é«˜å³°å€¼ï¼ŒåŒæ™‚è®Šç‚ºç•¥å¾®è² çš„ï¼Œç„¶å¾Œåœ¨è·é›¢ä¸­å¿ƒä¸€å®šè·é›¢è™•ç‚ºé›¶ï¼Œå…¶ç‰¹å¾µåœ¨æ–¼é«˜æ–¯çš„æ¨™æº–åå·®sigmaï¼ˆâˆ‘ï¼ŒÏƒï¼‰ã€‚</p><p>å› æ­¤ï¼ŒLoGæ¿¾æ³¢å™¨ç”±åœ“æˆ–blobæœ€é«˜åº¦æ¿€æ´»ï¼ŒåŠå¾‘èˆ‡sigmaæˆæ¯”ä¾‹ã€‚ç„¶è€Œï¼Œé«˜æ–¯æ˜¯æ¨™æº–åŒ–çš„åˆ†ä½ˆï¼Œå³å¦‚æœä½ å°‡å®ƒæ•´åˆåˆ°æ‰€æœ‰ç©ºé–“ï¼Œå®ƒç¸½å’Œç‚º1ã€‚å› æ­¤ï¼Œå°æ–¼æ›´é«˜çš„sigmaä¸¦å› æ­¤æ›´å¯¬çš„é«˜æ–¯ï¼ŒLoGæ¿¾æ³¢å™¨å°è©²é«˜æ–¯çš„éŸ¿æ‡‰å°‡ä½æ–¼è¼ƒå°çš„sigmaã€‚å› æ­¤ï¼ŒSIFTä½¿ç”¨<strong>æ¨™æº–æ­¸ä¸€åŒ–çš„</strong> LoGæ¿¾æ³¢å™¨ï¼Œå®ƒæ˜¯å¸¸è¦LoGä¹˜ä»¥æ–¹å·®ï¼ˆsigmaå¹³æ–¹ï¼‰ã€‚</p><p>DoGï¼ˆDifference of Gaussianï¼‰è¿‘ä¼¼</p><p>é›–ç„¶è¦æ¨¡æ¨™æº–åŒ–çš„LoGå¾ˆå¥½ï¼Œä½†è¨ˆç®—æˆæœ¬å¾ˆé«˜ï¼Œç‰¹åˆ¥æ˜¯å› ç‚ºæˆ‘å€‘éœ€è¦åœ¨è¨±å¤šä¸åŒçš„å°ºåº¦ä¸Šé€²è¡Œè¨ˆç®—ã€‚ä¸éï¼ŒSIFTçš„ä½œè€…æå‡ºäº†ä¸€ç¨®å·§å¦™çš„æ–¹æ³•ä¾†æœ‰æ•ˆåœ°è¨ˆç®—è¨±å¤šå°ºåº¦çš„LoGã€‚</p><p>äº‹å¯¦è­‰æ˜ï¼Œå…·æœ‰ç›¸ä¼¼æ–¹å·®çš„å…©å€‹é«˜æ–¯çš„å·®ç•°ç”¢ç”Ÿçš„æ¿¾æ³¢å™¨éå¸¸æ¥è¿‘æ–¼å°ºåº¦æ¨™æº–åŒ–çš„LoGï¼š</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å¯¦ç¾SIFT onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/7ff08a5cd79d4805b93c2ff9306fab2a><p class=pgc-img-caption>å…©å€‹é«˜æ–¯çš„å·®ç•°è¿‘ä¼¼æ–¼é«˜æ–¯çš„æ‹‰æ™®æ‹‰æ–¯ç®—å­</p></div><p>DoGï¼ˆDifference of Gaussianï¼‰é‡‘å­—å¡”</p><p>æ—¢ç„¶æˆ‘å€‘æœ‰ä¸€ç¨®æœ‰æ•ˆçš„æ–¹æ³•ä¾†é€¼è¿‘LoGï¼Œæˆ‘å€‘éœ€è¦åœ¨å¤šå€‹å°ºåº¦ä¸Šé€²è¡Œè¨ˆç®—ã€‚SIFTä½¿ç”¨å¤šå€‹Octaveä¾†è¨ˆç®—DoGã€‚å¤§å¤šæ•¸äººæœƒèªç‚ºè¨ˆç®—å…«å€‹åœ–åƒéœ€è¦å…«å€‹Octaveä¾†ä½¿ç”¨ã€‚ç„¶è€Œï¼ŒOctaveå¯¦éš›ä¸Šæ˜¯ä¸€çµ„åœ–åƒï¼Œå…¶ä¸­æœ€å¾Œä¸€å€‹åœ–åƒçš„æ¨¡ç³Šæ˜¯ç¬¬ä¸€å€‹åœ–åƒçš„æ¨¡ç³Šçš„<strong>å…©å€</strong>ã€‚</p><p>è¦å‰µå»ºé€™å€‹Octaveï¼Œæˆ‘å€‘é¦–å…ˆéœ€è¦é¸æ“‡æ¯å€‹Octaveä¸­æƒ³è¦çš„åœ–åƒæ•¸é‡ã€‚é€™ç”±sè¡¨ç¤ºã€‚ç„¶å¾Œé¸æ“‡é«˜æ–¯æ¿¾æ³¢å™¨çš„sigmaç‚º2 ^ï¼ˆ1 / sï¼‰ã€‚ç”±æ–¼æ¨¡ç³Šç´¯ç©ç´¯åŠ ï¼Œç•¶æˆ‘å€‘ä½¿ç”¨æ­¤æ¿¾é¡sæ¬¡æ¨¡ç³ŠåŸå§‹åœ–åƒæ™‚ï¼Œçµæœå°‡å…·æœ‰æ¨¡ç³Š= 2 *åŸå§‹æ¨¡ç³Šã€‚</p><p>æˆ‘å¾ˆå°‘çœ‹åˆ°çš„å…¶ä»–å…§å®¹ä¸­çš„ä¸€å€‹ç´°ç¯€æ˜¯ï¼Œåœ¨æ¯å€‹Octaveä¸­ï¼Œä½ å¯¦éš›ä¸Šéœ€è¦ç”¢ç”Ÿs + 3å€‹åœ–åƒï¼ˆåŒ…æ‹¬åŸå§‹åœ–åƒï¼‰ã€‚é€™æ˜¯å› ç‚ºç•¶æ¸›å»ç›¸é„°ç´šåˆ¥ä»¥ç²å¾—è¿‘ä¼¼çš„LoG Octaveæ™‚ï¼Œæˆ‘å€‘å°‡ç²å¾—æ¯”Gaussian octaveå°‘ä¸€å€‹çš„åœ–åƒï¼š</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å¯¦ç¾SIFT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/41425698049946cf831a239b5d9dad21><p class=pgc-img-caption>ç”¨æ–¼SIFTçš„é«˜æ–¯é‡‘å­—å¡”</p></div><p>ç¾åœ¨æˆ‘å€‘åœ¨DoG Octaveä¸­æœ‰s + 2å€‹åœ–åƒã€‚ä½†æ˜¯ï¼Œç¨å¾Œç•¶æˆ‘å€‘åœ¨DoGä¸­æŸ¥æ‰¾æ¥µå€¼æ™‚ï¼Œæˆ‘å€‘å°‡æŸ¥æ‰¾ç•¶å‰å’Œç›¸é„°ç´šåˆ¥æŒ‡å®šçš„é„°åŸŸçš„æœ€å°å€¼æˆ–æœ€å¤§å€¼ã€‚é¡¯ç„¶ï¼Œé€™å€‹é„°åŸŸä¸èƒ½åœ¨é ‚å±¤æˆ–åº•å±¤ç²å¾—ï¼Œæ‰€ä»¥æˆ‘å€‘æœ‰é€™å…©å€‹é¡å¤–çš„å±¤æ¬¡ï¼Œä»¥ä¾¿åœ¨ç¸®æ”¾ç©ºé–“ä¸­å®šç¾©ä¸€å€‹å®Œæ•´çš„Octaveã€‚</p><p>åœ¨æˆ‘å€‘ç”ŸæˆGaussian octaveä¹‹å¾Œï¼Œæˆ‘å€‘å°‡é ‚ç´šä¸‹é‡‡æ¨£2ä¸¦å°‡å…¶ç”¨ä½œæ–°Octaveçš„åº•å±¤ã€‚é€™äº›Octaveçµ„æˆäº†æˆ‘æ‰€èªªçš„é«˜æ–¯é‡‘å­—å¡”ã€‚</p><p>å±¥è¡Œ</p><p>æœ€å¾Œæˆ‘å€‘å¾—åˆ°äº†ä¸€äº›ä»£ç¢¼ã€‚é¦–å…ˆï¼Œæˆ‘å€‘é¡¯ç„¶éœ€è¦ä¸€å€‹é«˜æ–¯æ¿¾æ³¢å™¨ä¾†å‰µå»ºGaussian octaveï¼š</p><pre>def gaussian_filter(sigma):size = 2*np.ceil(3*sigma)+1x, y = np.mgrid[-size//2 + 1:size//2 + 1, -size//2 + 1:size//2 + 1] g = np.exp(-((x**2 + y**2)/(2.0*sigma**2))) / (2*np.pi*sigma**2)return g/g.sum() </pre><p>é€™å‡è¨­numpyå·²ç¶“ä½œç‚ºnpå°å…¥ï¼ˆå› ç‚ºå®ƒç¸½æ˜¯æ‡‰è©²ï¼‰ã€‚æˆ‘ä¹ŸæŠŠå®ƒæ”¾åœ¨ä¸€å€‹åç‚ºçš„æ–‡ä»¶ä¸­gaussian_filter.pyã€‚æ¥ä¸‹ä¾†ï¼Œç‚ºäº†ç”ŸæˆGaussian octaveï¼Œæˆ‘å€‘åªéœ€è¦é¸æ“‡sigmaä¸¦ç”¨é€™å€‹é«˜æ–¯æ¿¾æ³¢å™¨é‡è¤‡å·ç©ï¼š</p><pre>from scipy.ndimage.filters import convolvefrom gaussian_filter import gaussian_filter  def generate_octave(init_level, s, sigma):octave = [init_level]k = 2**(1/s)kernel = gaussian_filter(k * sigma)  for _in range(s+2):next_level = convolve(octave[-1], kernel)octave.append(next_level) return octave</pre><p>æ­£å¦‚åœ¨æ–‡ä¸­ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯5ã€‚å¦ä¸€å€‹éœ€è¦æ³¨æ„çš„æ˜¯sigmaåƒæ•¸ã€‚æ­¤åƒæ•¸ç”¨æ–¼ç¸®æ”¾kï¼Œä»¥ä¾¿æ¯å€‹DoG octaveä¸­çš„æ¨¡ç³Šä¾†è‡ªsigma - > 2 * sigmaã€‚æˆ‘ç‚ºsigmaä½¿ç”¨å€¼1.6ã€‚ç„¶å¾Œç”Ÿæˆæ•´å€‹é«˜æ–¯é‡‘å­—å¡”ï¼š</p><pre> def generate_gaussian_pyramid(im, num_octave, s, sigma):pyr = [] for _ in range(num_octave):octave = generate_octave(im, s, sigma)pyr.append(octave)im = octave[-3][::2, ::2] return pyr</pre><p>ç”±æ–¼æˆ‘å€‘æ¯å€‹Octaveç”Ÿæˆs + 3å€‹åœ–åƒï¼Œæˆ‘å€‘ä½¿ç”¨ç¬¬ä¸‰å€‹åˆ°æœ€å¾Œä¸€å€‹åœ–åƒä½œç‚ºä¸‹ä¸€å€‹Octaveçš„åŸºç¤ï¼Œå› ç‚ºé‚£æ˜¯ä¸€å€‹æ¨¡ç³Šç‚º2 * sigmaçš„åœ–åƒã€‚</p><p>ç¾åœ¨æˆ‘å€‘æœ‰äº†é«˜æ–¯é‡‘å­—å¡”ï¼Œå‰µå»ºDoGé‡‘å­—å¡”æ˜¯å¾ˆç°¡å–®çš„ï¼š</p><pre> def generate_DoG_octave(gaussian_octave):octave = [] for i in range(1, len(gaussian_octave)):octave.append(gaussian_octave[i] â€” gaussian_octave[i-1]) return np.concatenate([o[:,:,np.newaxis] for o in octave], axis=2ï¼‰ def generate_DoG_pyramid(gaussian_pyramid):pyr = [] for gaussian_octave in gaussian_pyramid:pyr.append(generate_DoG_octave(gaussian_octave)) return pyr</pre><p>ç¾åœ¨æˆ‘å€‘æœ‰å››å€‹DoG octaveï¼Œæ¯å€‹éƒ½æœ‰s + 2ç´šæ¨¡ç³Šã€‚æˆ‘å€‘ç¾åœ¨å¯ä»¥ç¹¼çºŒæª¢æ¸¬å°ºåº¦ç©ºé–“ä¸­çš„æ¥µå€¼ã€‚</p><p>æ¥µå€¼æª¢æ¸¬</p><p>æ¥µå€¼æª¢æ¸¬çš„ç¬¬ä¸€æ­¥æ˜¯æƒææ¯å€‹æ¨™åº¦ç©ºé–“DoG octaveçš„ Då€¼ï¼Œä¸¦å°‡æ¯å€‹3x3x3é„°åŸŸçš„ä¸­å¿ƒä½œç‚ºé—œéµé»ï¼Œå¦‚æœå®ƒæ˜¯é„°åŸŸä¸­çš„æœ€å°å€¼æˆ–æœ€å¤§å€¼ã€‚</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å¯¦ç¾SIFT onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e4070c372c6d452a9e6ae55c1d72e3e0><p class=pgc-img-caption>åˆå§‹å°ºåº¦ç©ºé–“æ¥µå€¼æª¢æ¸¬çš„é„°åŸŸ</p></div><p>é€™å°±æ˜¯ç‚ºä»€éº¼æˆ‘å€‘åœ¨DoG octaveä¸­ç”Ÿæˆs + 2ç´šåˆ¥çš„åŸå› ï¼Œå› ç‚ºæˆ‘å€‘ç„¡æ³•æƒæé ‚éƒ¨æˆ–åº•éƒ¨çš„é»ï¼Œä½†æˆ‘å€‘ä»ç„¶æƒ³è¦åœ¨æ•´å€‹Octaveæ¨¡ç³Šé»ä¸Šç²å¾—é—œéµé»ã€‚</p><p>å±¥è¡Œ</p><p>çµ¦å®šDoG octaveï¼Œæˆ‘å€‘ç²å¾—åˆå§‹å€™é¸é—œéµé»ï¼š</p><pre> def get_candidate_keypoints(D, w=16):candidates = []D[:,:,0] = 0D[:,:,-1] = 0 for i in range(w//2+1, D.shape[0]-w//2â€“1):for j in range(w//2+1, D.shape[1]-w//2â€“1):for k in range(1, D.shape[2]-1):patch = D[i-1:i+2, j-1:j+2, k-1:k+2]if np.argmax(patch) == 13 or np.argmin(patch) == 13:candidates.append([i, j, k]) return candidates</pre><p>é€™æ®µä»£ç¢¼çš„å…§å®¹è§£é‡‹ï¼š</p><p>æˆ‘å°‡é ‚éƒ¨å’Œåº•éƒ¨çš„é¡å¤–ç´šåˆ¥è¨­ç½®ç‚º0ï¼Œå› ç‚ºæˆ‘æœ€åˆåªæ˜¯åœ¨é€™äº›ç´šåˆ¥ä¸­ç²å¾—æ¥µå€¼ã€‚é€™å¯èƒ½æ˜¯å› ç‚ºDoG octaveçš„æ§‹é€ ä¸æ­£ç¢ºï¼Œä½†å»é‹è¡Œå¾—é‚„å¯ä»¥ã€‚</p><ol><li>æˆ‘å€‘æœ‰ä¸€å€‹w / 2çš„å¡«å……ï¼Œè€Œä¸æ˜¯åœ¨æ¯å€‹ç´šåˆ¥ä¸Šä½¿ç”¨ä¸€å€‹å¡«å……é€²è¡Œæƒæï¼Œå…¶ä¸­wæ˜¯å‰µå»ºå±€éƒ¨æè¿°ç¬¦æ™‚ä½¿ç”¨çš„è£œä¸çš„é‚Šé•·ã€‚æ²’æœ‰é€™å€‹ï¼Œå°±æœƒå‡ºéŒ¯èª¤ã€‚</li><li>èª¿ç”¨argmaxæˆ–argminä¸èª¿ç”¨è»¸åƒæ•¸åœ¨å±•å¹³çš„æ•¸çµ„ä¸Šé‹è¡Œã€‚ç”±æ–¼æˆ‘å€‘çš„é„°åŸŸæ˜¯3x3x3æˆ–27å€‹å…ƒç´ é•·ï¼Œç•¶æ¥µå€¼æ˜¯æˆ‘å€‘æª¢æŸ¥çš„åƒç´ æ™‚ï¼Œargmaxæˆ–argminçš„å€¼å°‡æ˜¯13ã€‚</li></ol><p>é€™äº›å€™é¸é—œéµé»æœƒç”¢ç”Ÿè¨±å¤šç³Ÿç³•çš„é¸æ“‡å’Œå™ªè²ï¼Œå› æ­¤åœ¨ä¸‹ä¸€ç¯€ä¸­æˆ‘å€‘å°‡é¸æ“‡å¥½çš„é—œéµé»ä¸¦æ‹‹æ£„éƒ¨åˆ†ä¸å¥½çš„é»ã€‚</p><p>é—œéµé»å®šä½</p><p>æˆ‘å€‘å°‡åŸ·è¡Œä¸‰å€‹æ­¥é©Ÿä¾†ç²å¾—æ›´å¥½çš„é—œéµé»ï¼š</p><ol><li>è¨ˆç®—æ¯å€‹é—œéµé»çš„å­åƒç´ ä½ç½®</li><li>å¦‚æœå­åƒç´ è™•çš„æ¯”ä¾‹ç©ºé–“å€¼ä½æ–¼é–¾å€¼ï¼Œå‰‡ä¸Ÿæ£„è©²é—œéµé»</li><li>ä½¿ç”¨åœç¹æ¯å€‹å­åƒç´ é—œéµé»çš„Hessianæ¶ˆé™¤é‚Šç·£ä¸Šçš„é—œéµé»</li></ol><p>å­åƒç´ å®šä½</p><p>åœ¨è¨±å¤šåœ–åƒä¸­ï¼Œåœ¨åˆ†è¾¨ç‡ä¸å¤ ç²¾ç¢ºçš„æ™‚å€™å¾ˆé›£æ‰¾åˆ°ç©©å®šçš„é—œéµé»ï¼Œå³åœ¨å¤šå€‹æ¢ä»¶ä¸‹åœ¨å¤šå€‹åœ–åƒä¸­çš„ç›¸åŒä½ç½®ã€‚å› æ­¤ï¼ŒSIFTçš„å‰µå»ºè€…ä½¿ç”¨DoG octaveçš„äºŒéšTaylorå±•é–‹ä¾†é€²ä¸€æ­¥å®šä½æ¯å€‹é—œéµé»ã€‚</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å¯¦ç¾SIFT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a23102a79fed48f890482e07047e3844><p class=pgc-img-caption>DoG octaveçš„äºŒéšTaylorå±•é–‹</p></div><p>é€™è£¡ï¼Œxæ˜¯èˆ‡å‚™é¸é—œéµé»çš„åƒç´ ä½ç½®å°æ‡‰çš„ä¸‰ç¶­çŸ¢é‡[xï¼Œyï¼Œsigma]ã€‚å°‡è©²ç­‰å¼çš„å°æ•¸ç›¸å°æ–¼xä¸¦å°‡å…¶è¨­ç½®ç‚ºç­‰æ–¼é›¶ï¼Œå¾—åˆ°é—œéµé»çš„å­åƒç´ åç§»ï¼š</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å¯¦ç¾SIFT onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/99b0dd8272db43a19961885f74056026><p class=pgc-img-caption>å‚™é¸é—œéµé»åç§»ï¼ˆäºŒéšï¼‰</p></div><p>å°‡æ­¤åç§»æ·»åŠ åˆ°åŸå§‹é—œéµé»ä½ç½®ä»¥å¯¦ç¾å­åƒç´ ç²¾åº¦ã€‚</p><p><strong>å¯¦ç¾</strong></p><p>æˆ‘å€‘éœ€è¦åœç¹æ¯å€‹å€™é¸é—œéµé»è¨ˆç®—Jacobianå’ŒHessianä»¥ç²å¾—åç§»é‡ï¼š</p><pre>def localize_keypoint(D, x, y, s):dx = (D[y,x+1,s]-D[y,x-1,s])/2.dy = (D[y+1,x,s]-D[y-1,x,s])/2.ds = (D[y,x,s+1]-D[y,x,s-1])/2. dxx = D[y,x+1,s]-2*D[y,x,s]+D[y,x-1,s] dxy = ((D[y+1,x+1,s]-D[y+1,x-1,s]) â€” (D[y-1,x+1,s]-D[y-1,x-1,s]))/4. dxs = ((D[y,x+1,s+1]-D[y,x-1,s+1]) â€” (D[y,x+1,s-1]-D[y,x-1,s-1]))/4. dyy = D[y+1,x,s]-2*D[y,x,s]+D[y-1,x,s]dys = ((D[y+1,x,s+1]-D[y-1,x,s+1]) â€” (D[y+1,x,s-1]-D[y-1,x,s-1]))/4.dss = D[y,x,s+1]-2*D[y,x,s]+D[y,x,s-1] J = np.array([dx, dy, ds])HD = np.array([ [dxx, dxy, dxs], [dxy, dyy, dys], [dxs, dys, dss]]) offset = -LA.inv(HD).dot(J)return offset, J, HD[:2,:2], x, y, s</pre><p>é¦–å…ˆï¼Œè¨ˆç®—é›…å¯æ¯”è¡Œåˆ—å¼çš„ä¸€éšå°æ•¸ã€‚ç„¶å¾Œï¼Œæˆ‘å€‘è¨ˆç®—Hessiançš„äºŒéšå°æ•¸ã€‚Hessianæ˜¯å°ç¨±çš„ï¼Œæ‰€ä»¥æˆ‘å€‘åªéœ€è¨ˆç®—å…­å€‹å°æ•¸è€Œä¸æ˜¯ä¹å€‹ã€‚æˆ‘å€‘è¿”å›Jå’ŒHå› ç‚ºæˆ‘å€‘ä»¥å¾Œæœƒéœ€è¦å®ƒå€‘ã€‚</p><p>ä½œç‚ºæ—è¨»ï¼Œç•¶åç§»çš„ç¶­åº¦å¤§æ–¼0.5æ™‚ï¼Œé€™æ„å‘³è‘—å®ƒå¯¦éš›ä¸Šæ›´æ¥è¿‘å¦ä¸€å€‹åƒç´ ç´šé—œéµé»ã€‚</p><p><strong>ä¸Ÿæ£„ä½å°æ¯”åº¦é—œéµé»</strong></p><p>ç¾åœ¨å¯ä»¥å°‡æ¯å€‹å­åƒç´ é—œéµé»çš„å°æ¯”åº¦è¨ˆç®—ç‚ºï¼š</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å¯¦ç¾SIFT onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e58678d970304374821c292894431d8a><p class=pgc-img-caption>å­åƒç´ é—œéµé»å°æ¯”åº¦</p></div><p>å“ªå€‹å­åƒç´ åç§»æ·»åŠ åˆ°åƒç´ ç´šä½ç½®ã€‚å¦‚æœçµ•å°å€¼ä½æ–¼é–¾å€¼ï¼Œæˆ‘å€‘å°±æœƒæ‹‹å‡ºé€™ä¸€é»ã€‚æˆ‘å€‘é€™æ¨£åšæ˜¯å› ç‚ºæˆ‘å€‘æƒ³è¦æ¥µç«¯ï¼Œæ¥µç«¯ï¼Œæ¥µç«¯ã€‚</p><p>æ¶ˆé™¤é‚Šç·£éŸ¿æ‡‰</p><p>å°ºåº¦æ¨™æº–åŒ–çš„LoGå°‡åœ¨è§’è½å’Œé‚Šç·£è™•å‰µå»ºé«˜å°æ¯”åº¦éŸ¿æ‡‰ã€‚ä½†æ˜¯ï¼Œé‚Šç·£ä¸Šçš„é—œéµé»æ‡‰è©²è¢«ä¸Ÿæ£„ï¼Œå› ç‚ºå®ƒå€‘çš„æ–¹å‘æ˜¯æ¨¡ç³Šçš„ã€‚ç‚ºæ­¤ï¼Œæˆ‘å€‘ä½¿ç”¨è¨ˆç®—å­åƒç´ åç§»æ™‚è¨ˆç®—çš„Hessianã€‚é€™å€‹éç¨‹éå¸¸é¡ä¼¼æ–¼ä½¿ç”¨Harrisè§’é»æ¢æ¸¬å™¨å°‹æ‰¾è§’é»ã€‚</p><p>æˆ‘å€‘è¿”å›çš„Hessian localize_keypointçš„å½¢å¼å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt=åœ¨Pythonä¸­å¯¦ç¾SIFT onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/390ca2d7b19344338b2c787548646359><p class=pgc-img-caption>Hessianåœ¨è¦æ¨¡ç©ºé–“èˆ‡æ›²ç‡æˆæ¯”ä¾‹</p></div><p>å¦‚æœä½ ç†Ÿæ‚‰Harrisæ¢æ¸¬å™¨ï¼Œå¦‚æœHçš„ç‰¹å¾µå€¼ï¼ˆæ¯”å¦‚Aå’ŒBï¼‰éƒ½å¾ˆâ€‹â€‹å¤§ï¼Œé‚£éº¼é—œéµé»å¾ˆå¯èƒ½æ˜¯ä¸€å€‹è§’ã€‚ç›¸åï¼Œå¦‚æœä¸€å€‹å¤§å¾—å¤šï¼Œé‚£éº¼å®ƒå¾ˆå¯èƒ½æ˜¯é‚Šç·£ã€‚</p><p>å³ä½¿è¨ˆç®—é€™å€‹çŸ©é™£çš„ç‰¹å¾µå€¼æ˜¯å¾ˆä¾¿å®œçš„ï¼Œé‚„æœ‰å¦ä¸€ç¨®æ–¹æ³•å¯ä»¥ç”¨ä¾†ç²å–Hçš„è·Ÿè¹¤å’Œè¡Œåˆ—å¼ã€‚æˆ‘å€‘å°‡æ”¾æ£„åœ¨é€™è£¡è¨è«–ã€‚</p><p>å¯¦ç¾</p><p>æˆ‘å€‘åœ¨ä»¥ä¸‹åŠŸèƒ½ä¸­åŸ·è¡Œä¸Šè¿°æ­¥é©Ÿï¼š</p><pre> def find_keypoints_for_DoG_octave(D, R_th, t_c, w):candidates = get_candidate_keypoints(D, w)keypoints = [] for i, cand in enumerate(candidates):y, x, s = cand[0], cand[1], cand[2]offset, J, H, x, y, s = localize_keypoint(D, x, y, s) contrast = D[y,x,s] + .5*J.dot(offset)if abs(contrast) &lt; t_c: continue w, v = LA.eig(H)r = w[1]/w[0] R = (r+1)**2 / rif R &gt; R_th: continue kp = np.array([x, y, s]) + offsetkeypoints.append(kp) return np.array(keypoints)</pre><p>æˆ‘ä½¿ç”¨ä¾†è‡ªpaperçš„å€¼t_cå’ŒR_thå³åˆ†åˆ¥ç‚º0.03å’Œï¼ˆ10 + 1ï¼‰2/10ã€‚</p><p>ç¾åœ¨è¨ˆç®—æ•´å€‹DoGé‡‘å­—å¡”çš„é—œéµé»æ˜¯å¾®ä¸è¶³é“çš„ï¼š</p><pre> def get_keypoints(DoG_pyr, R_th, t_c, w):kps = [] for D in DoG_pyr:kps.append(find_keypoints_for_DoG_octave(D, R_th, t_c, w)) return kps</pre><p><strong>æ–¹å‘åˆ†é…</strong></p><p>ç²å¾—é—œéµé»åªæ˜¯æˆåŠŸçš„ä¸€åŠã€‚ç¾åœ¨æˆ‘å€‘å¿…é ˆç²å¾—å¯¦éš›çš„æè¿°ç¬¦ã€‚ä½†åœ¨æˆ‘å€‘é€™æ¨£åšä¹‹å‰ï¼Œæˆ‘å€‘éœ€è¦ç¢ºä¿å¦ä¸€ç¨®ä¸è®Šæ€§ï¼šæ—‹è½‰ã€‚</p><p>æˆ‘å€‘æœ‰å¹³ç§»ä¸è®Šæ€§ï¼Œå› ç‚ºæˆ‘å€‘åœ¨åœ–åƒä¸Šå°æ¿¾æ³¢å™¨é€²è¡Œå·ç©ã€‚ç”±æ–¼æˆ‘å€‘ä½¿ç”¨äº†æ¨™åº¦æ­¸ä¸€åŒ–çš„LoGæ¿¾æ³¢å™¨ï¼Œå› æ­¤æˆ‘å€‘ä¹Ÿå…·æœ‰å°ºåº¦ä¸è®Šæ€§ã€‚ç¾åœ¨ç‚ºäº†æ–½åŠ æ—‹è½‰ä¸è®Šæ€§ï¼Œæˆ‘å€‘åœ¨æ¯å€‹é—œéµé»å‘¨åœåˆ†é…ä¸€å€‹èˆ‡å…¶ä¸»è¦æ¢¯åº¦æ–¹å‘ç›¸å°æ‡‰çš„æ–¹å‘ã€‚ç•¶æˆ‘å€‘ä½¿ç”¨æ¢¯åº¦ç›´æ–¹åœ–æè¿°ç¬¦ä¾†æè¿°æ¯å€‹è£œä¸æ™‚ï¼Œé€™æœƒæœ‰é»ç”¨çš„ã€‚</p><p>ç‚ºäº†åˆ†é…æ–¹å‘ï¼Œæˆ‘å€‘åœ¨æ¯å€‹é—œéµé»å‘¨åœæ¡ç”¨ä¸€å€‹è£œä¸ï¼Œå…¶å¤§å°èˆ‡è©²é—œéµé»çš„æ¯”ä¾‹æˆæ­£æ¯”ã€‚ç„¶å¾Œï¼Œæˆ‘å€‘ç‚ºè©²è£œä¸ä¸­çš„æ¯å€‹åƒç´ å‰µå»ºæ¼¸è®Šçš„ç›´æ–¹åœ–ã€‚</p><p>ç›´æ–¹åœ–æ˜¯åœ¨è§’åº¦ä¸Šå‰µå»ºçš„ï¼ˆæ¢¯åº¦åœ¨æ¥µåº§æ¨™ä¸­æŒ‡å®šï¼‰ä¸¦ä¸”å…·æœ‰36å€‹ç®±ï¼ˆæ¯å€‹ç®±å…·æœ‰10åº¦çš„å¯¬åº¦ï¼‰ã€‚ç•¶è¨ˆç®—åƒç´ è™•çš„æ¢¯åº¦çš„å¤§å°å’Œè§’åº¦æ™‚ï¼Œæˆ‘å€‘çš„ç›´æ–¹åœ–ä¸­çš„å°æ‡‰å€é–“å¢é•·äº†ç”±é«˜æ–¯çª—å£åŠ æ¬Šçš„æ¢¯åº¦å¤§å°ã€‚</p><p>ä¸€æ—¦æˆ‘å€‘å¾—åˆ°ç›´æ–¹åœ–ï¼Œæˆ‘å€‘å°±ç‚ºè©²é—œéµé»æŒ‡å®šæœ€å¤§ç›´æ–¹åœ–binçš„æ–¹å‘ã€‚</p><p>å¯¦ç¾</p><pre> def assign_orientation(kps, octave, num_bins=36):new_kps = []bin_width = 360//num_bins for kp in kps:cx, cy, s = int(kp[0]), int(kp[1]), int(kp[2])s = np.clip(s, 0, octave.shape[2]-1)sigma = kp[2]*1.5w = int(2*np.ceil(sigma)+1)kernel = gaussian_filter(sigma)L = octave[â€¦,s]hist = np.zeros(num_bins, dtype=np.float32) for oy in range(-w, w+1):for ox in range(-w, w+1):x, y = cx+ox, cy+oyif x &lt; 0 or x &gt; octave.shape[1]-1: continueelif y &lt; 0 or y &gt; octave.shape[0]-1: continue m, theta = get_grad(L, x, y)weight = kernel[oy+w, ox+w] * mbin = quantize_orientation(theta, num_bins)hist[bin] += weight max_bin = np.argmax(hist)new_kps.append([kp[0], kp[1], kp[2], max_bin])max_val = np.max(hist) for binno, val in enumerate(hist):if binno == max_bin: continueif .8 * max_val &lt;= val:new_kps.append([kp[0], kp[1], kp[2], binno*bin_width]) return np.array(new_kps)</pre><p>é—œæ–¼é€™å€‹å‡½æ•¸æˆ‘æƒ³æåˆ°çš„ä¸€ä»¶äº‹æ˜¯æœ€å¾Œä¸€å€‹å¾ªç’°ã€‚æœ¬æ–‡è¦å®šï¼Œå°æ–¼ä»»ä½•ç›´æ–¹åœ–binï¼Œå…¶å€¼å¤§æ–¼æœ€å¤§å€¼çš„80ï¼…ï¼Œä»¥åœ¨è©²ä½ç½®å‰µå»ºæ–°é—œéµé»ä¸¦é€²è¡Œç¸®æ”¾ä½†å…·æœ‰æ–°æ–¹å‘ã€‚</p><p>æ­¤å¤–ï¼Œæœ¬æ–‡é‚„èªªæ‚¨æ‡‰è©²å°‡æ‹‹ç‰©ç·šæ“¬åˆåˆ°æœ€æ¥è¿‘æœ€å¤§å€¼çš„ä¸‰å€‹ç›´æ–¹åœ–å€¼ï¼Œä½†åœ¨æ­¤å¯¦ç¾ä¸­çœç•¥äº†é€™ä¸€é»ã€‚</p><p>æ­¤ä»£ç¢¼ä¸­é‚„åŒ…å«ä¸€äº›åŠŸèƒ½ã€‚é¦–å…ˆget_grads ï¼Œå®ƒç²å¾—Lä¸­åƒç´ çš„æ¥µåº§æ¨™æ¢¯åº¦ï¼š</p><pre> def cart_to_polar_grad(dx, dy):m = np.sqrt(dx**2 + dy**2)theta = (np.arctan2(dy, dx)+np.pi) * 180/np.pireturn m, theta def get_grad(L, x, y):dy = L[min(L.shape[0]-1, y+1),x] â€” L[max(0, y-1),x]dx = L[y,min(L.shape[1]-1, x+1)] â€” L[y,max(0, x-1)]return cart_to_polar_grad(dx, dy)</pre><p>ç„¶å¾Œæœ‰quantize_orientationï¼Œå®ƒåªæ˜¯å°‡æ¼¸è®Šçš„é€£çºŒè§’åº¦è½‰æ›ç‚ºç›´æ–¹åœ–ç®±ï¼š</p><pre> </pre><p>def quantize_orientation(theta, num_bins):</p><p>bin_width = 360//num_bins</p><p>return int(np.floor(theta)//bin_width)</p><p>å®šä½æè¿°ç¬¦å‰µå»º</p><p><em>æœ€å¾Œ</em>ï¼Œæˆ‘å€‘å¯ä»¥ç‚ºæ¯å€‹é—œéµé»å‰µå»ºå®šä½æè¿°ç¬¦ã€‚å¦‚å‰æ‰€è¿°ï¼Œæˆ‘å€‘ä½¿ç”¨â€œæ¢¯åº¦ç›´æ–¹åœ–â€æ–¹æ³•å¾æ¯å€‹é—œéµé»çš„å‘¨åœå‰µå»ºä¸€å€‹ç‰¹å¾µå‘é‡ã€‚</p><p>å…·é«”ä¾†èªªï¼Œåœ¨æ¯å€‹é—œéµé»å‘¨åœæª¢æŸ¥16x16è£œä¸ã€‚ç„¶å¾Œå°‡è©²è£œä¸åˆ†æˆ16å€‹4x4å­å€åŸŸã€‚ç„¶å¾Œå°‡æ¯å€‹å­å€åŸŸçš„æ¢¯åº¦ï¼ˆåœ¨æ¥µåº§æ¨™ä¸­ï¼‰åˆ†ç®±æˆ8ç®±ç›´æ–¹åœ–ã€‚æœ€å¾Œï¼Œæ‰€æœ‰é€™äº›ç›´æ–¹åœ–è¢«é€£æ¥æˆ4x4x8 = 128å€‹å…ƒç´ çš„é•·ç‰¹å¾µå‘é‡ã€‚</p><p>ç„¶å¾Œå°è©²æœ€çµ‚ç‰¹å¾µå‘é‡é€²è¡Œæ­¸ä¸€åŒ–ï¼Œé–¾å€¼åŒ–å’Œé‡æ–°æ­¸ä¸€åŒ–ä»¥å˜—è©¦ä¸¦ç¢ºä¿å°æ¬¡è¦å…‰ç…§è®ŠåŒ–çš„ä¸è®Šæ€§ã€‚</p><p>å¯¦ç¾</p><pre> def get_local_descriptors(kps, octave, w=16, num_subregion=4, num_bin=8):descs = [] for kp in kps:cx, cy, s = int(kp[0]), int(kp[1]), int(kp[2])s = np.clip(s, 0, octave.shape[2]-1)kernel = gaussian_filter(w/6) # gaussian_filter multiplies sigma by 3 L = octave[â€¦,s] t, l = max(0, cy-w//2), max(0, cx-w//2) b, r = min(L.shape[0], cy+w//2+1), min(L.shape[1], cx+w//2+1) patch = L[t:b, l:r] dx, dy = get_patch_grads(patch) if dx.shape[0] &lt; w+1:if t == 0: kernel = kernel[kernel.shape[0]-dx.shape[0]:]else: kernel = kernel[:dx.shape[0]]if dx.shape[1] &lt; w+1:if l == 0: kernel = kernel[kernel.shape[1]-dx.shape[1]:]else: kernel = kernel[:dx.shape[1]]if dy.shape[0] &lt; w+1:if t == 0: kernel = kernel[kernel.shape[0]-dy.shape[0]:]else: kernel = kernel[:dy.shape[0]]if dy.shape[1] &lt; w+1:if l == 0: kernel = kernel[kernel.shape[1]-dy.shape[1]:]else: kernel = kernel[:dy.shape[1]] m, theta = cart_to_polar_grad(dx, dy)dx, dy = dx*kernel, dy*kernel subregion_w = w//num_subregion featvec = np.zeros(num_bin * num_subregion**2, dtype=np.float32) for i in range(0, subregion_w):for j in range(0, subregion_w):t, l = i*subregion_w, j*subregion_wb, r = min(L.shape[0], (i+1)*subregion_w), min(L.shape[1], (j+1)*subregion_w) hist = get_histogram_for_subregion(m[t:b, l:r].ravel(), theta[t:b, l:r].ravel(), num_bin, kp[3]) featvec[i*subregion_w*num_bin + j*num_bin:i*subregion_w*num_bin + (j+1)*num_bin] = hist.flatten()descs.append(featvec) return np.array(descs)</pre><p>å°ä¸­é–“å½¢ç‹€dxå’Œdyä¸­é–“å½¢ç‹€çš„æª¢æŸ¥æ˜¯ç‚ºäº†é¿å…æˆ‘ä¹‹å‰é‡åˆ°çš„è¶Šç•ŒéŒ¯èª¤ã€‚å¦‚æœå…¶ä¸­ä¸€å€‹/æˆ–å°æ–¼w+1é‚£éº¼ç›¸æ‡‰åœ°åˆ‡æ–·é«˜æ–¯çª—å£ä»¥é¿å…å½¢ç‹€ä¸åŒ¹é…ã€‚</p><p>é¦–å…ˆï¼Œè¨ˆç®—æ•´å€‹è²¼ç‰‡çš„æ¥µæ€§æ¢¯åº¦ã€‚ç„¶å¾Œç‚ºæ¯å€‹å­å€åŸŸå‰µå»ºç›´æ–¹åœ–ã€‚</p><p>è¦è¨ˆç®—è£œä¸ä¸­çš„æ¼¸è®Šï¼š</p><pre> def get_patch_grads(p):r1 = np.zeros_like(p)r1[-1] = p[-1]r1[:-1] = p[1:] r2 = np.zeros_like(p)r2[0] = p[0]r2[1:] = p[:-1] dy = r1-r2 r1[:,-1] = p[:,-1]r1[:,:-1] = p[:,1:]r2[:,0] = p[:,0]r2[:,1:] = p[:,:-1] dx = r1-r2 return dx, dy</pre><p>åªéœ€ç²å–å‰ä¸€å€‹å’Œç•¶å‰åƒç´ ä¹‹é–“çš„å·®ç•°ã€‚é€™æ¯”ä»¥å‰åšé›™é¢è¡ç”Ÿæ›´å®¹æ˜“ã€‚ç„¶å¾Œç‚ºæ¯å€‹å­å€åŸŸå‰µå»ºç›´æ–¹åœ–ï¼š</p><pre> def get_histogram_for_subregion(m, theta, num_bin, reference_angle):hist = np.zeros(num_bin, dtype=np.float32) for mag, angle in zip(m, theta):binno = quantize_orientation(angle-reference_angle, num_bin)hist[binno] += mag hist /= max(1e-6, LA.norm(hist)) hist[hist&gt;0.2] = 0.2 hist /= max(1e-6, LA.norm(hist))return hist</pre><p>é€™æ®µä»£ç¢¼èˆ‡å‰é¢çš„HoGä»£ç¢¼éå¸¸ç›¸ä¼¼ï¼Œä½†æ˜¯æˆ‘å€‘å°ç›´æ–¹åœ–ä¸­çš„æ¯å€‹æ¢ç›®åŸ·è¡Œä¸‰ç·šæ€§æ’å€¼ã€‚é€™å€‹æ’å€¼æ˜¯ç‚ºäº†æä¾›é­¯æ£’æ€§ï¼Œç•¶ä¸€å€‹åƒç´ çš„æ¢¯åº¦å¾ä¸€å€‹ç®±å­åˆ°å¦ä¸€å€‹æˆ–åœ¨ä¸€å€‹å­å€åŸŸçš„é‚Šç·£é€²å…¥ä¸€å€‹ä¸åŒçš„å­å€åŸŸã€‚</p><p>å› æ­¤ï¼Œå°æ–¼xå’Œyæ–¹å‘ï¼Œæ¢ç›®çš„æ¬Šé‡èˆ‡1-(åˆ°å®¹å™¨ä¸­å¿ƒçš„è·é›¢)å’Œ1-(åˆ°å­å€åŸŸä¸­å¿ƒçš„è·é›¢)æˆæ­£æ¯”ã€‚</p><p><strong>æŠŠå®ƒæ”¾åœ¨ä¸€èµ·</strong></p><p>æˆ‘å€‘ç¾åœ¨å¯ä»¥å‰µå»ºä¸€å€‹SIFTå°è±¡ä¾†å°è£æ‰€æœ‰ä¸Šè¿°æ“ä½œï¼š</p><pre> class SIFT(object):def __init__(self, im, s=3, num_octave=4, s0=1.3, sigma=1.6, r_th=10, t_c=0.03, w=16):self.im = convolve(rgb2gray(im), gaussian_filter(s0))self.s = sself.sigma = sigmaself.num_octave = num_octaveself.t_c = t_cself.R_th = (r_th+1)**2 / r_thself.w = w def get_features(self):gaussian_pyr = generate_gaussian_pyramid(self.im, self.num_octave, self.s, self.sigma)DoG_pyr = generate_DoG_pyramid(gaussian_pyr)kp_pyr = get_keypoints(DoG_pyr, self.R_th, self.t_c, self.w)feats = [] for i, DoG_octave in enumerate(DoG_pyr): kp_pyr[i] =assign_orientation(kp_pyr[i], DoG_octave)feats.append(get_local_descriptors(kp_pyr[i], DoG_octave)) self.kp_pyr = kp_pyrself.feats = feats return feats</pre><p>æœ€å¾Œä¸€å€‹å°ç´°ç¯€æ˜¯æˆ‘ç”¨1.3çš„sigmaæ¨¡ç³Šåˆå§‹åœ–åƒã€‚</p><p>çµè«–</p><p>æ–‡ç« è¬›çš„å¯èƒ½ä¸¦ä¸æ˜¯é‚£éº¼æ¸…æ¥šï¼Œä½†æˆ‘å¸Œæœ›ä½ èƒ½å­¸åˆ°ä¸€äº›é—œæ–¼ç†è«–å’Œå¦‚ä½•å¯¦ç¾SIFTçš„çŸ¥è­˜ã€‚</p><p>åªæ˜¯å€‹äººå­¸ç¿’æ–‡ç« ã€‚</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Python</a></li><li><a>ä¸­å¯¦ç¾</a></li><li><a>SIFT</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E5%AD%B8/6791842.html alt="OpenCV-Python SIFTå°ºåº¦ä¸è®Šç‰¹å¾µè®Šæ› | ä¸‰åä¹" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/097cdfdfc9d741b98072398d3cb43908 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/6791842.html title="OpenCV-Python SIFTå°ºåº¦ä¸è®Šç‰¹å¾µè®Šæ› | ä¸‰åä¹">OpenCV-Python SIFTå°ºåº¦ä¸è®Šç‰¹å¾µè®Šæ› | ä¸‰åä¹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/91eece92.html alt="åªéœ€ 45 ç§’ï¼ŒPython çµ¦æ•…å®®ç•«ä¸€çµ„æ‰‹ç¹ªåœ–ï¼" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/df1bd890ffee4a439e9f5142ae42c102 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/91eece92.html title="åªéœ€ 45 ç§’ï¼ŒPython çµ¦æ•…å®®ç•«ä¸€çµ„æ‰‹ç¹ªåœ–ï¼">åªéœ€ 45 ç§’ï¼ŒPython çµ¦æ•…å®®ç•«ä¸€çµ„æ‰‹ç¹ªåœ–ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8aab963e.html alt=Pythonæ‰‹ç¹ªåœ–ç­è§£ä¸€ä¸‹ï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/746c9e6e214b48b2a0215fc9e151cdc8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8aab963e.html title=Pythonæ‰‹ç¹ªåœ–ç­è§£ä¸€ä¸‹ï¼>Pythonæ‰‹ç¹ªåœ–ç­è§£ä¸€ä¸‹ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cfd854c6.html alt=æ•…å®®ä¸‹é›ªäº†ï¼æˆ‘ç”¨Pythonçµ¦å®ƒç•«äº†ä¸€çµ„æ‰‹ç¹ªåœ–ï¼Œåƒ…ç”¨45ç§’ï¼ˆé™„ä»£ç¢¼ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/774d2f0a372f48c589ec84dd3a164dd9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cfd854c6.html title=æ•…å®®ä¸‹é›ªäº†ï¼æˆ‘ç”¨Pythonçµ¦å®ƒç•«äº†ä¸€çµ„æ‰‹ç¹ªåœ–ï¼Œåƒ…ç”¨45ç§’ï¼ˆé™„ä»£ç¢¼ï¼‰>æ•…å®®ä¸‹é›ªäº†ï¼æˆ‘ç”¨Pythonçµ¦å®ƒç•«äº†ä¸€çµ„æ‰‹ç¹ªåœ–ï¼Œåƒ…ç”¨45ç§’ï¼ˆé™„ä»£ç¢¼ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b433c17e.html alt="å››åã€Pythonæ¨¡å¡Šrandom: å½éš¨æ©Ÿæ•¸æ“šç”Ÿæˆèˆ‡éš¨æ©Ÿå…ƒç´ æŠ½å–" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/25f231d6-c1ce-4cf8-8988-5da509a0c26a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b433c17e.html title="å››åã€Pythonæ¨¡å¡Šrandom: å½éš¨æ©Ÿæ•¸æ“šç”Ÿæˆèˆ‡éš¨æ©Ÿå…ƒç´ æŠ½å–">å››åã€Pythonæ¨¡å¡Šrandom: å½éš¨æ©Ÿæ•¸æ“šç”Ÿæˆèˆ‡éš¨æ©Ÿå…ƒç´ æŠ½å–</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/04486eba.html alt=Pythonçˆ¬èŸ²ä½¿ç”¨seleniumçˆ¬å–ç¾¤æˆå“¡ä¿¡æ¯ï¼ˆå…¨è‡ªå‹•å¯¦ç¾è‡ªå‹•ç™»é™¸ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/e11e69f643584941aaa2b71ee6ed3d7f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/04486eba.html title=Pythonçˆ¬èŸ²ä½¿ç”¨seleniumçˆ¬å–ç¾¤æˆå“¡ä¿¡æ¯ï¼ˆå…¨è‡ªå‹•å¯¦ç¾è‡ªå‹•ç™»é™¸ï¼‰>Pythonçˆ¬èŸ²ä½¿ç”¨seleniumçˆ¬å–ç¾¤æˆå“¡ä¿¡æ¯ï¼ˆå…¨è‡ªå‹•å¯¦ç¾è‡ªå‹•ç™»é™¸ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/86b46e6d.html alt=Pythonçˆ¬èŸ²æ•™ç¨‹ï¼Œåˆ©ç”¨Pythonæ¡é›†QQç¾¤æˆå“¡ä¿¡æ¯ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6d6cce76ad48405c9dbb960d4617bcef style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/86b46e6d.html title=Pythonçˆ¬èŸ²æ•™ç¨‹ï¼Œåˆ©ç”¨Pythonæ¡é›†QQç¾¤æˆå“¡ä¿¡æ¯>Pythonçˆ¬èŸ²æ•™ç¨‹ï¼Œåˆ©ç”¨Pythonæ¡é›†QQç¾¤æˆå“¡ä¿¡æ¯</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7739dc7a.html alt=Pythonæ•¸æ“šå¯è¦–åŒ–Matplotlibï¼Œå¦‚ä½•åœ¨ä¸€å‰¯åœ–åƒä¸­é¡¯ç¤ºå¤šçµ„æŸ±å½¢åœ–ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/5d4a0000046e1bea8b90 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7739dc7a.html title=Pythonæ•¸æ“šå¯è¦–åŒ–Matplotlibï¼Œå¦‚ä½•åœ¨ä¸€å‰¯åœ–åƒä¸­é¡¯ç¤ºå¤šçµ„æŸ±å½¢åœ–ï¼Ÿ>Pythonæ•¸æ“šå¯è¦–åŒ–Matplotlibï¼Œå¦‚ä½•åœ¨ä¸€å‰¯åœ–åƒä¸­é¡¯ç¤ºå¤šçµ„æŸ±å½¢åœ–ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/05b8f164.html alt=Pythonä¸­çš„å¤šé€²ç¨‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/49dd44b999924b69bd3396709ecacaf4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/05b8f164.html title=Pythonä¸­çš„å¤šé€²ç¨‹>Pythonä¸­çš„å¤šé€²ç¨‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/389d4437.html alt="Pythonå¸¸ç”¨ç®—æ³•å­¸ç¿’(5) æ¨¹äºŒå‰æ¨¹ï¼ˆåŸç†+ä»£ç¢¼ï¼‰-æœ€å…¨ç¸½çµ" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d3d5fd4ef98c4a8e8dc9095eeef052a6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/389d4437.html title="Pythonå¸¸ç”¨ç®—æ³•å­¸ç¿’(5) æ¨¹äºŒå‰æ¨¹ï¼ˆåŸç†+ä»£ç¢¼ï¼‰-æœ€å…¨ç¸½çµ">Pythonå¸¸ç”¨ç®—æ³•å­¸ç¿’(5) æ¨¹äºŒå‰æ¨¹ï¼ˆåŸç†+ä»£ç¢¼ï¼‰-æœ€å…¨ç¸½çµ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0fa274c2.html alt="ä¸ƒåä¹ã€Python | Leetcode äºŒå‰æ¨¹ç³»åˆ—ï¼ˆä¸Šç¯‡ï¼‰" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a6c9fa6432a3419a8a60bd334f978a11 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0fa274c2.html title="ä¸ƒåä¹ã€Python | Leetcode äºŒå‰æ¨¹ç³»åˆ—ï¼ˆä¸Šç¯‡ï¼‰">ä¸ƒåä¹ã€Python | Leetcode äºŒå‰æ¨¹ç³»åˆ—ï¼ˆä¸Šç¯‡ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f0a927d6.html alt=Pythonä¸­å¦‚ä½•å®šç¾©åªè®€å±¬æ€§ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/60dafb43-a3bb-4456-9f60-3d55ab9e1c4e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f0a927d6.html title=Pythonä¸­å¦‚ä½•å®šç¾©åªè®€å±¬æ€§ï¼Ÿ>Pythonä¸­å¦‚ä½•å®šç¾©åªè®€å±¬æ€§ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/68f62be6.html alt=Pythonæ–‡ä»¶è®€å¯«æ–¹æ³• class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/dca556bb2ffb4013b992ebb4b6a9a296 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/68f62be6.html title=Pythonæ–‡ä»¶è®€å¯«æ–¹æ³•>Pythonæ–‡ä»¶è®€å¯«æ–¹æ³•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4d9fe5d5.html alt=Pythoné–‹ç™¼å¸¸è¦‹å•é¡Œå½™ç¸½ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1525506011510ee699a3e91 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4d9fe5d5.html title=Pythoné–‹ç™¼å¸¸è¦‹å•é¡Œå½™ç¸½>Pythoné–‹ç™¼å¸¸è¦‹å•é¡Œå½™ç¸½</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7dad731d.html alt=å°æ–¼æ–°æ‰‹ä¾†èªªï¼ŒPythonä¸­æœ‰å“ªäº›é›£ä»¥ç†è§£çš„æ¦‚å¿µï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1f4ec4c3a6484cf58453023c44e01d75 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7dad731d.html title=å°æ–¼æ–°æ‰‹ä¾†èªªï¼ŒPythonä¸­æœ‰å“ªäº›é›£ä»¥ç†è§£çš„æ¦‚å¿µï¼Ÿ>å°æ–¼æ–°æ‰‹ä¾†èªªï¼ŒPythonä¸­æœ‰å“ªäº›é›£ä»¥ç†è§£çš„æ¦‚å¿µï¼Ÿ</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>