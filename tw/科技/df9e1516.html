<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>Java知識回顧之堆和棧 | 极客快訊</title><meta property="og:title" content="Java知識回顧之堆和棧 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/b3918ad3587341f085b704da5702c28e"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/df9e1516.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/df9e1516.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/df9e1516.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/df9e1516.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/df9e1516.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/df9e1516.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/df9e1516.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/df9e1516.html><meta property="article:published_time" content="2020-11-14T20:59:56+08:00"><meta property="article:modified_time" content="2020-11-14T20:59:56+08:00"><meta name=Keywords content><meta name=description content="Java知識回顧之堆和棧"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/df9e1516.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Java知識回顧之堆和棧</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>在日常程序開發中，我們都知道Java程序都是運行在Java虛擬機上（JVM）的，程序中所有的方法、變量、常量、實例、靜態存儲都是由JVM在<strong><span style="color:#f04142;--tt-darkmode-color: #F04142">內存</span></strong>中進行分配的。</p><p><strong>一、棧內存</strong></p><p>主要用來存儲線程執行過程中的局部變量（<strong><span style="color:#00abab;--tt-darkmode-color: #00ABAB">能否儲存成員變量？</span></strong>），方法的返回值，以及方法調用上下文(對象的引用)，是一種只能在一端（稱為棧頂）對數據項進行插入和刪除，它遵循<strong>先進後出</strong>的規則來存儲數據。</p><p><span style="color:#ff7528;--tt-darkmode-color: #FF7528">疑問一：網上看了好多說棧數據可以共享。我的理解是：棧是線程私有的內存區域，每個線程都有一個棧，線程執行函數的時候，就會往這個棧裡面壓入一個棧幀，這個棧幀包含局部變量表和操作數棧，它是怎麼做到數據共享的？</span></p><div class=pgc-img><img alt=Java知識回顧之堆和棧 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b3918ad3587341f085b704da5702c28e><p class=pgc-img-caption></p></div><p>通俗一點來講先進後出：比如我們買的羽毛球筒，工廠加工完成後，會一個一個將羽毛球壓到筒中（最後壓進的羽毛球會在最上部）（進棧），最後羽毛球達到我們手中後，我們會從上往下一個一個的取出（最上面的會先被我們給取出）（出棧）。這樣說的話，大家應該能聽的明白一點吧。</p><div class=pgc-img><img alt=Java知識回顧之堆和棧 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1f3c316ad11c486396acfa89b985dac7><p class=pgc-img-caption></p></div><p>我們再用程序運行看下是否如我們上述描述的先進後出：</p><div class=pgc-img><img alt=Java知識回顧之堆和棧 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2074dd7a6f76447db63ae191874c02c4><p class=pgc-img-caption></p></div><p>當我們在一段代碼塊中定義一個變量時，java就在棧中為這個變量分配內存空間，當超過變量的作用域後，就會自動釋放掉為該變量分配的內存空間（棧的作用域），它不會被GC管理。</p><p><strong>棧內存中的數據(局部變量)，沒有默認初始化值，需要給賦值，不然在調用該變量的時候會提示</strong></p><p><strong>Initialize variable的錯誤。</strong></p><p><strong>二、堆內存</strong></p><p>是在JVM啟動時候自動分配的（看上一篇JVM內容），用來存放由new創建的對象和數組，用完後靠垃圾回收機制（GC）不定期自動銷燬。</p><p>虛擬機中只有且只有一個堆，程序中所有線程都共享它，它的存取類型為管道類型，先進先出。</p><p>用例子簡單說下棧和堆的關係（這方面可能理解不是很到位，大家若有意見可以下方評論共同探討）</p><p>public static void main(String[] args) {</p><p>Car car = new Car();</p><p>car.wheel = "4";</p><p>Car car1 = new Car();</p><p>car1.seat = "12";</p><p>}</p><div class=pgc-img><img alt=Java知識回顧之堆和棧 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0b7ff2c548de4961846ba9926141326c><p class=pgc-img-caption></p></div><p>主函數先進棧，會在棧內存中開闢一個空間，存放car變量,同時在堆內存中也開闢一個空間，存放new Car()對象。我們知道內存存儲數據的時候都是通過地址來體現的，所以會給Car這個實體分配一個內存地址：0x0011，把堆這個地址賦給棧中的car（引用變量），car就通過地址指向了Car這個實體。</p><p>在我們日常開發或面試的時候，經常會碰到java中equals和==的區別：</p><div class=pgc-img><img alt=Java知識回顧之堆和棧 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a030aa7cbdd24212a91904ef32d4beb3><p class=pgc-img-caption></p></div><p>從上圖，我們可以看到程序運行的結果：</p><p>1）對於==，int類型（8大基本數據類型）的比較結果輸出為true，String類型的輸出結果為false;</p><p>2）String類型通過equals比較結果為true.</p><p>m == n為true這個結果結果我們應該能容易理解，基本數據類型的變量在棧內存中存儲的是實際的值，而a == b為false，是因為a和b是String類型的變量，是引用類型的變量，為非基本數據類型的變量，它存儲的是對象的堆內存地址。a==b的比較實際上比較的是a和b對應的堆內存地址，它們指向的是不同對象。</p><p>equals操作表示的兩個變量是否是對同一個對象的引用，即堆中的內容是否相同。</p><p><strong><span style="color:#00abab;--tt-darkmode-color: #00ABAB">棧內存中能否儲存成員變量？</span></strong></p><p>不能，因為當對象創建出來，實體存在於堆，對象的成員變量已經在堆上分配空間，但對象裡面的方法是沒有出現的，只出現方法的聲明，方法裡面的局部變量並沒有創建。等到對象調用此方法時，方法中的局部變量才會在棧中創建，所以，方法中的局部變量是在棧內的。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Java</a></li><li><a>知識</a></li><li><a>回顧</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/e01935fe.html alt=全面回顧：從知識工程到知識圖譜 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/0bd3ad5610cd4559b8d67d52178858ed style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e01935fe.html title=全面回顧：從知識工程到知識圖譜>全面回顧：從知識工程到知識圖譜</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8668225c.html alt=從知識工程到知識圖譜全面回顧 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RPUfnTjEp79Eds style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8668225c.html title=從知識工程到知識圖譜全面回顧>從知識工程到知識圖譜全面回顧</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ee2728c4.html alt="Java核心知識 多線程併發 進程調度算法 （三十二）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ee53d84c407e492494d103a3f7a9481c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ee2728c4.html title="Java核心知識 多線程併發 進程調度算法 （三十二）">Java核心知識 多線程併發 進程調度算法 （三十二）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cbd7408a.html alt="Java基礎知識總結 - 超詳細篇(下)" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/0a2c5c74ea004348be7d53c613226e92 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cbd7408a.html title="Java基礎知識總結 - 超詳細篇(下)">Java基礎知識總結 - 超詳細篇(下)</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4db51b45.html alt="尚學堂知識整理：Java boolean與short數據類型" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/6c3e00031bc69dbd5f67 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4db51b45.html title="尚學堂知識整理：Java boolean與short數據類型">尚學堂知識整理：Java boolean與short數據類型</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4f90c140.html alt="Java核心知識 多線程併發 可重入鎖（遞歸鎖）（十二）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2980a986c6734c9aa2bda740becaea21 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4f90c140.html title="Java核心知識 多線程併發 可重入鎖（遞歸鎖）（十二）">Java核心知識 多線程併發 可重入鎖（遞歸鎖）（十二）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a398feda.html alt=「Java基礎知識」J2EE基礎知識，快看看和Java基礎的差別吧 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5ae630290a7243d28f4c0dc08d22b88f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a398feda.html title=「Java基礎知識」J2EE基礎知識，快看看和Java基礎的差別吧>「Java基礎知識」J2EE基礎知識，快看看和Java基礎的差別吧</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e61a22b.html alt=知識回顧，編碼器的工作原理及作用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/154106145268886a09ef0ca style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e61a22b.html title=知識回顧，編碼器的工作原理及作用>知識回顧，編碼器的工作原理及作用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/804ea540.html alt=「行業知識」結構工程師的心結——鋼樑扭轉計算 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/177f1b37fa4b41698a4e78accf7efbb4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/804ea540.html title=「行業知識」結構工程師的心結——鋼樑扭轉計算>「行業知識」結構工程師的心結——鋼樑扭轉計算</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bcc4c942.html alt=「鋼構知識」經典鋼結構設計問答 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bcc4c942.html title=「鋼構知識」經典鋼結構設計問答>「鋼構知識」經典鋼結構設計問答</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7f6e1fd9.html alt=「鋼構知識」經典鋼結構設計問答彙總 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/76195b1e9d934c2e952b060dad0951e6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7f6e1fd9.html title=「鋼構知識」經典鋼結構設計問答彙總>「鋼構知識」經典鋼結構設計問答彙總</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0fc448f5.html alt=各種門窗知識大全，是我見過最全的了 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/15349013240149cf1ef5531 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0fc448f5.html title=各種門窗知識大全，是我見過最全的了>各種門窗知識大全，是我見過最全的了</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f0ff6432.html alt=鋼結構必備知識38問 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f0ff6432.html title=鋼結構必備知識38問>鋼結構必備知識38問</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bb258a5a.html alt=鋼結構必備知識38問，你的晉級之路！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1535975955779bcac330762 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bb258a5a.html title=鋼結構必備知識38問，你的晉級之路！>鋼結構必備知識38問，你的晉級之路！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8bbd5f8a.html alt=長知識！什麼是榫卯結構？為什麼現代建築當中不常見了？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1537941825042b6f495fa56 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8bbd5f8a.html title=長知識！什麼是榫卯結構？為什麼現代建築當中不常見了？>長知識！什麼是榫卯結構？為什麼現代建築當中不常見了？</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>