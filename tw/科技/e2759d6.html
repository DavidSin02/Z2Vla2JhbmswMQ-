<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>白話大數據之 白話進程 | 极客快訊</title><meta property="og:title" content="白話大數據之 白話進程 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/1539400378299185f0dce49"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e2759d6.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e2759d6.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e2759d6.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e2759d6.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e2759d6.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e2759d6.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e2759d6.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e2759d6.html><meta property="article:published_time" content="2020-10-29T21:04:55+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:55+08:00"><meta name=Keywords content><meta name=description content="白話大數據之 白話進程"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/e2759d6.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>白話大數據之 白話進程</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p>這一次我們來聊一下進程。之所以聊進程，是因為進程是計算的靈魂。假如我們買了一臺電腦，我們很少會將它打扮的飄飄亮亮的放在客廳，從來不開機，每次下班回家看到這臺漂亮的電腦就會深吸一口氣然後感嘆真特麼美，生活真幸福。大部分情況下，我們要將它開機，然後讓他幹活，一旦開機，計算機就進入到了進程的世界，一個進程一個進程的處理，直到你要求它關機休息。所以，只要涉及到計算機，無論你是做大數據開發還是web開發，都逃不開操作系統，也就逃不開進程。其實分佈式系統就是網絡+單機操作系統+針對多機處理的算法，那麼，我們有必要看一下進程是什麼。</p><h1>進程是什麼</h1><p>他山之石，我們首先看一下百度百科上進程的定義</p><div class=pgc-img><img alt="白話大數據之 白話進程" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1539400378299185f0dce49><p class=pgc-img-caption>進程-百科定義</p></div><p>定義中提到，進程是程序的執行實體，進程是線程的容器。所以實際上，在現代操作系統中，程序真正執行的實體是線程，進程則是在線程管理上建立起的一個抽象，如果非要給線程一個實體表示，那麼就是在程序運行過程中涉及到的地址空間（內存空間），地址空間中包括程序運行的正文（編譯後），打開的文件，子進程，即將發生的定時器，信號處理程序，賬號信息等。也就是說，<strong>進程是一個程序能夠運行所依賴的各種資源總和的抽象。</strong>清晰了這個概念，我們便容易理解，每個進程因為已經包含了它所依賴的所有資源，那麼其他的進程便跟它沒有關係，所以對於每個進程來說，它都認為自己是操作系統中唯一的進程，<strong>操作系統實現了一種抽象，這種抽象將進程彼此隔離開。</strong></p><h1>進程的生成</h1><p>進程是運行的程序，如麼進程的產生過程就是程序提交到機器上執行的過程。一般而言，程序是用特定的語言編寫的（C，python，R，java等），計算機並不認識這些語言，之所以能夠運行這些程序，是因為程序被解釋成了機器碼形式的指令--計算機能夠識別的語言，計算機通過對這些指令不停的出棧與入棧進行程序的運行。解釋的過程如下圖（圖片來自於網絡）</p><div class=pgc-img><img alt="白話大數據之 白話進程" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1539401568391fa6f082dd4><p class=pgc-img-caption>程序編譯過程</p></div><p>進程在創建之後，操作系統就需要持有一個能夠到達該進程的句柄，也就是說，操作系統要能夠找到這個進程。比如說，我們一般將 WEB 應用發佈到 Tomcat 中，Tomcat 作為一個常駐進程，承擔起 網站服務器 的功能，當我們提交 Web請求的時候，操作系統需要能夠將我們發送的請求內容傳遞給 Tomcat， 傳遞的前提是操作系統必須能夠準確找到 Tomcat 這個進程。所以進程創建成功後會返回一個進程號（PID），這個進程號便唯一表示了這個進程，我們可以通過進程號找到進程。但問題是，因為進程號是隨機分配的，每次分配的都不一樣，也就是說 Tomcat 一旦重啟端口號就會改變，這樣找起來就太麻煩了。所以操作系統又在端口號和進程號之間建立了映射關係，無論進程號怎麼邊， Tomcat 對應的端口號是不變的（可配置）， 當進行信息交互的時候，<strong>只需要找到對應的端口就可以了</strong>。</p><h1>進程間通信</h1><p>上文中我們提到，由於操作系統的寵溺，每個進程都會認為自己是唯一存在的進程，所以它不可能自己找到其他的進程進行交互。進程和進程之間的交互需要依賴其他的工具或者組件，在</p><p>1、本地進程通信</p><p>Unix操作系統中，本地進程之間的交互可以通過管道來傳遞，比如說下面這個命令</p><pre>ps -ef | grep redis</pre><p>這一段代碼就是在查詢 redis 對應的進程號，ps -ef 這個進程的輸出傳遞給 grep redis 進程作為輸入。當然我們也可以將前一個進程的輸入寫到一個文件中，後一個進程讀取這個文件。其實上面的管道本質上也是寫文件，所有的通信本質上都是寫文件，因為網絡是一種分塊文件，管道是一種內存文件，在Unix操作系統中，萬物皆文件。</p><p>另外我們也可以藉助消息中間件，如 Kafka，Rabbit MQ，Zero MQ 等來實現進程的通信，這些中間件可以實現超大吞吐量等特殊場景下的通信，但是其本質與上述並沒有差異。</p><p>2、遠程進程通信</p><p>我們可以將兩個進程之間的通信理解為一個過程調用另一個過程，當主調過程和被調過程在不同的進程空間時，就需要RPC（Remote Procedure Call）——遠程過程調用，RPC是一個概念，各種語言或者框架有自己的實現方法，在面向對象的語言中，有一中實現方法便是RMI（ Remote Method Invocation)——遠程方法調用，其實現原理便是在服務端實現其和客戶端約定好的接口。</p><p>那麼通信過程到底是怎麼實現的呢，就本質上來說（panda真美，這句是被強制寫上的）<strong>，進程通信就是將要傳遞的信息數據從一個進程的緩衝區轉移到另一個進程的緩衝區</strong>。</p><h1>通信模式與進程狀態</h1><p>上文中提到，進程通信的本質就是通信數據在進程緩衝區之間的轉移，當數據到達接收方的緩存區，接收方就及時將信息取走。這裡就引入一個問題，<strong>接收方在等待數據到達的時候幹啥</strong>？</p><p>現在，接收方可以選擇一直傻等，但是計算器受不了啊，你自己等數據不能佔著CPU不放啊，人家其他的進程還要運行呢。所以在等數據的時候，接收方進程會被置入阻塞狀態（睡著了），數據到達後，合作進程回去叫醒他，說，別睡了，你的數據來了。</p><p>那麼什麼是阻塞狀態呢？要回答這個問題，我們先看一下進程共有幾種狀態</p><div class=pgc-img><img alt="白話大數據之 白話進程" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1539407877043cfa87d1cb0><p class=pgc-img-caption></p></div><p>在解釋這些狀態前，我們先要了解CPU是怎麼工作的，如果CPU是單核心，那麼同一時間只能運行一個進程，如果有多個可運行的進程同時到達，操作系統會將這些進程放在一個就緒隊列裡面，CPU從隊列中取出這個進程運行一會兒，一看到點了就放回去，然後取出另一個進程運行一段時間。但是如果運行一個進程時發現它要讀等數據（I/O）——無論時等其他進程的數據還是讀取硬盤文件，這個過程很慢，CPU不願意等，就把它放到阻塞隊列中，說，你慢慢等吧，直到解除條件出發，這個進程被重新放到阻塞隊列中。</p><p>上文中我們提到，進程是資源總和的抽象，在進程創建的時候，就會申請一部分內存資源（物理內存）。但是內存是有限的，當內存被佔用滿之後，就無法提交新的進程了，為了解決這個問題，操作系統對內存做了虛擬化抽象，也就是將一部分硬盤空間（可配置）和物理內存都映射成虛擬內存，新添加的進程可以先放在硬盤映射出的虛擬內存空間中，這時進程處於三種狀態以外的另一種狀態——掛起狀態。現在，進程便擁有了以下五種狀態</p><div class=pgc-img><img alt="白話大數據之 白話進程" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1539405690367c1eafd74bf><p class=pgc-img-caption>進程五態模型</p></div><pre>等待態→掛起等待態：如果當前不存在就緒進程，那麼至少有一個等待態進程將被對換出去成為掛起等待態；操作系統根據當前資源狀況和性能要求，可以決定把等待態進程對換出去成為掛起等待態。掛起等待態→掛起就緒態：引起進程等待的事件發生之後，相應的掛起等待態進程將轉換為掛起就緒態。掛起就緒態→就緒態：當內存中沒有就緒態進程，或者掛起就緒態進程具有比就緒態進程更高的優先級，系統將把掛起就緒態進程轉換成就緒態。就緒態→掛起就緒態：操作系統根據當前資源狀況和性能要求，也可以決定把就緒態進程對換出去成為掛起就緒態。掛起等待態→等待態：當一個進程等待一個事件時，原則上不需要把它調入內存。但是在下面一種情況下，這一狀態變化是可能的。當一個進程退出後，主存已經有了一大塊自由空間,而某個掛起等待態進程具有較高的優先級並且操作系統已經得知導致它阻塞的事件即將結束，此時便發生了這一狀態變化。運行態→掛起就緒態：當一個具有較高優先級的掛起等待態進程的等待事件結束後，它需要搶佔 CPU，，而此時主存空間不夠，從而可能導致正在運行的進程轉化為掛起就緒態。另外處於運行態的進程也可以自己掛起自己。新建態→掛起就緒態：考慮到系統當前資源狀況和性能要求，可以決定新建的進程將被對換出去成為掛起就緒態。參考 https://blog.csdn.net/qwe6112071/article/details/70473905</pre><p>回到模式的討論，上面一直傻等的情況就是<strong>阻塞模式</strong>。這種模式是比較傻的，就因為等個數據，進程就直接被打入冷宮了。聰明點的做法是一會兒過來看一下，數據有沒有到達緩衝區，如果還沒到就去幹其他的事情。也就是<strong>非阻塞模式。</strong>這裡又出現另外一個問題，一會兒來看看數據有沒有到達的是進程，緩衝區是跟著進程走的，那麼如果進程還沒過來看的時候，數據先到達了，它存儲在什麼地方呢？實際上，這種情況下，操作系統會暫時把數據存儲到自己的緩衝區，等讀取進程到達了，再轉移到進程的緩衝區。接收方進程自己一會兒來看一下的模式叫做<strong>同步模式，</strong>這個模式還是有些麻煩，可以不自己過來看，專門委託一個人一會兒看一下，如果到了就通知自己，這時候自己再去取數據，這種模式叫做<strong>異步模式。</strong></p><p>非阻塞的實現方式是在提交請求之後直接返回錯誤碼，而不再等待響應。值得注意的是，不止接收方有這些模式，發送方是同樣的道理，根據發送方要不要等到數據被接收後再返回可以進行模式切分。</p><h1>進程調度</h1><p>上文中提到，CPU是從就緒隊列中取進程分時執行的，那麼先取誰，後取誰，就涉及到進程調度的問題。常見的調度算法如下</p><p>1、先來先服務（FIFO），按照進程到達的時間進行調度</p><p>2、最短作業優先（SJF），優先調度運行時間最短的作業</p><p>3、時間片輪轉，分時運行</p><p>4、最短剩餘作業優先 SRJN (Shortest Remaining Job Next) ,優先調度剩餘時間最短的作業</p><p>針對多核CPU，還有其他的優化調度方法，如多級隊列，多級反饋隊列等。</p><p>值得注意的是，進程到達的時候，CPU根本就不知道它會運行多長時間，所以最短作業優先，最短剩餘作業優先調度方法會對時間進行預測，這些調度方法有時間再詳做闡述。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>白話</a></li><li><a>大數</a></li><li><a>進程</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/b3994691.html alt=世界發展進程中的耀眼篇章 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RCLmM9dF1KnwoT style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b3994691.html title=世界發展進程中的耀眼篇章>世界發展進程中的耀眼篇章</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/09d5d35b.html alt=加速年輕化進程，脈動宣佈吳亦凡為品牌全球代言人 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/09d5d35b.html title=加速年輕化進程，脈動宣佈吳亦凡為品牌全球代言人>加速年輕化進程，脈動宣佈吳亦凡為品牌全球代言人</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/eb1cbd4a.html alt=Java併發編程：進程和線程之由來 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/4f658919-1d85-46bc-bbf1-64aac52f4c80 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/eb1cbd4a.html title=Java併發編程：進程和線程之由來>Java併發編程：進程和線程之由來</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dad48786.html alt=Linux併發服務器模型一、多進程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dad48786.html title=Linux併發服務器模型一、多進程>Linux併發服務器模型一、多進程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/77f5407e.html alt="PHP 線程，進程和併發" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7a700a857098411d884a928d6b5f5e01 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/77f5407e.html title="PHP 線程，進程和併發">PHP 線程，進程和併發</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/05b8f164.html alt=Python中的多進程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/49dd44b999924b69bd3396709ecacaf4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/05b8f164.html title=Python中的多進程>Python中的多進程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b7ce9ac1.html alt=java併發編程之進程狀態 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/0779ab7cadfe428f8d74d66161aa48b4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b7ce9ac1.html title=java併發編程之進程狀態>java併發編程之進程狀態</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d62f6365.html alt=java併發編程之進程與線程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a1b777a6b4c24fc390776034329c92d2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d62f6365.html title=java併發編程之進程與線程>java併發編程之進程與線程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fa5f4d06.html alt="linux fork多進程併發服務器模型之C/C++代碼實戰" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/5794b6eba487410ebcd6838aac6772fc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fa5f4d06.html title="linux fork多進程併發服務器模型之C/C++代碼實戰">linux fork多進程併發服務器模型之C/C++代碼實戰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/01920188.html alt=python乾貨｜python多進程併發 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/153075082008107d9bdbb84 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/01920188.html title=python乾貨｜python多進程併發>python乾貨｜python多進程併發</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d7504b3a.html alt=python併發編程：進程的創建和結束 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d7504b3a.html title=python併發編程：進程的創建和結束>python併發編程：進程的創建和結束</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4c41a9dd.html alt=一文讀懂什麼是進程、線程、協程（建議收藏） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/6ba8b142-925e-418e-b20c-71e8f3c20663 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4c41a9dd.html title=一文讀懂什麼是進程、線程、協程（建議收藏）>一文讀懂什麼是進程、線程、協程（建議收藏）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/75cea72c.html alt=併發基本概念及實現，進程、線程基本概念 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/75cea72c.html title=併發基本概念及實現，進程、線程基本概念>併發基本概念及實現，進程、線程基本概念</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ab6b08d6.html alt=併發最基本要理解的進程、線程、協程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3f756a3627164d4f93883dd7c0e0bac5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ab6b08d6.html title=併發最基本要理解的進程、線程、協程>併發最基本要理解的進程、線程、協程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bca12149.html alt=併發面試必備系列之進程、線程與協程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0d2726ed787347fe9bca8fe09d031981 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bca12149.html title=併發面試必備系列之進程、線程與協程>併發面試必備系列之進程、線程與協程</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>