<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>聊聊Java中的異常及處理 | 极客快訊</title><meta property="og:title" content="聊聊Java中的異常及處理 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/5071dd69a38e408697a9767a6c4bc352"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e619a68c.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e619a68c.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e619a68c.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e619a68c.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e619a68c.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e619a68c.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e619a68c.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e619a68c.html><meta property="article:published_time" content="2020-11-14T21:06:59+08:00"><meta property="article:modified_time" content="2020-11-14T21:06:59+08:00"><meta name=Keywords content><meta name=description content="聊聊Java中的異常及處理"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/e619a68c.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>聊聊Java中的異常及處理</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><h3 class=pgc-h-arrow-right>前言</h3><p>在編程中異常報錯是不可避免的。特別是在學習某個語言初期，看到異常報錯就抓耳撓腮，常常開玩笑說編程1分鐘，改bug1小時。今天就讓我們來看看什麼是異常和怎麼合理的處理異常吧！</p><h3 class=pgc-h-arrow-right>異常與error介紹</h3><p>下面還是先讓我們來看一下基本概念吧！</p><p>​ <strong>異常</strong>指程序運行過程中出現的非正常現象，例如用戶輸入錯誤、除數為零、需要處理的文件不存在、數組下標越界等。異常機制本質就是當程序出現錯誤，程序安全退出的機制。在Java的異常處理機制中，引進了很多用來描述和處理異常的類，稱為異常類。異常類定義中包含了該類異常的信息和對異常進行處理的方法。</p><p>​ Java是採用面向對象的方式來處理異常的。處理過程：</p><ol start=1><li>拋出異常：在執行一個方法時，如果發生異常，則這個方法生成代表該異常的一個對象，停止當前執行路徑，並把異常對象提交給JRE。</li><li>捕獲異常：JRE得到該異常後，尋找相應的代碼來處理該異常。JRE在方法的調用棧中查找，從生成異常的方法開始回溯，直到找到相應的異常處理代碼為止。</li></ol><p>讓我們來看看前面所講到的異常類究竟是個什麼東西!</p><p>其實所有的異常對象都是派生於Throwable類的一個實例。如果內置的異常類不能夠滿足需要，還可以創建自己的異常類。所有異常的根類為java.lang.Throwable。看看它的家族長什麼樣。</p><div class=pgc-img><img alt=聊聊Java中的異常及處理 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5071dd69a38e408697a9767a6c4bc352><p class=pgc-img-caption></p></div><p>Throwable類下面主要是兩大門派。<strong>Error</strong>和<strong>Exception</strong>。</p><ul><li><strong>Error</strong>是程序無法處理的錯誤，表示運行應用程序中較嚴重問題，系統JVM已經處於不可恢復的崩潰狀態中。例如，說內存溢出和線程死鎖等系統問題。</li><li><strong>Exception</strong>是程序本身能夠處理的異常。Exception類是所有異常類的父類，其子類對應了各種各樣可能出現的異常事件。 通常Java的異常可分為：RuntimeException 運行時異常CheckedException 已檢查異常下面我們來研究研究這兩個異常。</li></ul><h3 class=pgc-h-arrow-right>RuntimeException和 CheckedException異同</h3><p>首先我們先來看看什麼是<strong>運行時異常</strong>。</p><p>這類異常通常是由編程錯誤導致的，所以在編寫程序時，並不要求必須使用異常處理機制來處理這類異常,而是經常需要通過增加“邏輯處理來避免這些異常”。</p><p>比如以下常見的幾種異常：</p><p>ArithmeticException異常</p><pre><code> int b=0; System.out.println(1/b); //解決：   if(b!=0){      System.out.println(1/b);   }</code></pre><p>NumberFormatException異常</p><pre><code>String str = "1234abcf";System.out.println(Integer.parseInt(str));//解決： Pattern p = Pattern.compile("^\\d+$");Matcher m = p.matcher(str);if (m.matches()) { // 如果str匹配代表數字的正則表達式,才會轉換    System.out.println(Integer.parseInt(str));}</code></pre><p>ClassCastException異常</p><pre><code>Animal a=new Dog();Cat c=(Cat)a;//解決：    if (a instanceof Cat) {    Cat c = (Cat) a;}</code></pre><p>這裡再補充兩點，方便大家更好的理解java異常的機制和處理過程。</p><ol start=1><li>在方法拋出異常之後，運行時系統將轉為尋找合適的異常處理器(exception handler)。潛在的異常處理器是異常發生時依次存留在調用棧中的方法的集合。當異常處理器所能處理的異常類型與方法拋出的異常類型相符時，即為合適的異常處理器。</li><li>運行時系統從發生異常的方法開始，依次回查調用棧中的方法，直至找到含有合適異常處理器的方法並執行。當運行時系統遍歷調用棧而未找到合適的異常處理器，則運行時系統終止。同時，意味著Java程序的終止。</li></ol><p>上面我們講述了什麼是運行時異常以及一些處理方式，下面就再來看看什麼是<strong>已檢查異常</strong>吧！</p><p>所有不是RuntimeException的異常，統稱為Checked Exception，又被稱為“已檢查異常”，如IOException、SQLException等以及用戶自定義的Exception異常。 這類異常在編譯時就必須做出處理， 否則無法通過編譯。</p><p>通常異常的處理方式有兩種：</p><ol start=1><li>使用“try/catch”捕獲異常</li><li>使用“throws”聲明異常。</li></ol><p>下面就來詳細的聊聊吧!</p><h3 class=pgc-h-arrow-right>異常的處理</h3><p>上面已經提了，異常處理通常有2種方式。先看看捕獲異常吧。</p><p><strong>捕獲異常</strong>是通過3個關鍵詞來實現的：try-catch-finally。用try來執行一段程序，如果出現異常，系統拋出一個異常，可以通過它的類型來捕捉(catch)並處理它，最後一步是通過finally語句為異常處理提供一個統一的出口，finally所指定的代碼都要被執行。</p><p>這個捕獲異常其實也是我們在面試的時候會經常碰到的問題。下面我們分別再來對各個部分做一個簡單的提示吧!</p><ul><li>try</li></ul><p>一個try語句必須帶有至少一個catch語句塊或一個finally語句塊 。當異常處理的代碼執行結束以後，不會再回到try語句去執行尚未執行的代碼。</p><ul><li>catch</li></ul><p>每個try語句塊可以伴隨一個或多個catch語句，用於處理可能產生的不同類型的異常對象。在此介紹一些常用的方法，這些方法均繼承自Throwable類 。</p><ol start=1><li>toString ()方法，顯示異常的類名和產生異常的原因。</li><li>getMessage()方法，只顯示產生異常的原因，但不顯示類名。</li><li>printStackTrace()方法，用來跟蹤異常事件發生時堆棧的內容。</li></ol><p>這裡有一個需要特別注意的地方，那就是catch捕獲異常時的捕獲順序：</p><p>如果異常類之間有繼承關係，在順序安排上就需注意。越是頂層的類，越放在下面，再不然就直接把多餘的catch省略掉。 也就是說先捕獲子類異常再捕獲父類異常。</p><ul><li>finally</li></ul><p>finally語句塊中始終都要執行，除了遇到了System.exit(0)結束程序運行。針對這個特性，所以我們通常在finally中關閉程序塊已打開的資源，比如：關閉文件流、釋放數據庫連接等。</p><p>即使try和catch塊中存在return語句，finally語句也會執行。是在執行完finally語句後再通過return退出。</p><p>在這裡就有一道非常經典的一個面試題。</p><pre><code>public class Test {    public static void main(String[]args) {       System.out.println(new Test().test());;    }    static int test(){       int x = 1;       try{          retun x;       }finally{          System.out.print("jdbk"+ ++x);       }    }}// 問輸出結果？</code></pre><p>先解釋哈這裡存在的玄妙吧!</p><p>看了上面的講述，我們都知道了當try和catch中有return時，finally仍然會執行，所以正常邏輯來說此題的答案應該是“jdbk2 2”,但這裡存在一個陷阱，那就是：</p><p>finally是在return後面的表達式運算後執行的（<strong>此時並沒有返回運算後的值，而是先把要返回的值保 存起來，不管finally中的代碼怎麼樣，返回的值都不會改變，</strong><strong>任然</strong><strong>是之前保存的值</strong>），所以函數返回值是 在finally執行前確定的。因此正確答案應該是：“jdbk2 1”。</p><p>還有一點需要注意的就是：finally中最好不要包含return，否則程序會提前退出，返回值不是try或catch中保存的返回值。</p><p>接下來再來講講<strong>聲明異常</strong>吧，它相對來說就比較簡單了。</p><p>在一些情況下，當前方法並不需要處理髮生的異常，而是向上傳遞給調用它的方法處理。如果一個方法拋出多個已檢查異常，就必須在方法的首部列出所有的異常，之間以逗號隔開。</p><pre><code>public static void readFile(String fileName) throws FileNotFoundException,IOException {}</code></pre><p>需要注意的地方就是：</p><ol start=1><li>在方法重寫中聲明異常時：子類重寫父類方法時，如果父類方法有聲明異常，那麼子類聲明的異常範圍不能超過父類聲明的範圍。</li><li>聲明異常我們一般在server層中。在controller層或則數據訪問層一般是捕獲異常。</li></ol><h3 class=pgc-h-arrow-right>自定義異常</h3><p>我們為什麼要自定義異常？還不是因為在程序中，可能會遇到JDK提供的任何標準異常類都無法充分描述清楚我們想要表達的問題。此時我們就可以創建自己的異常類，即自定義異常類。</p><p>那我們怎麼自定義異常類呢？相信你看了上面的異常類的家族圖應該就猜到了。不錯，自定義異常類只需從Exception類或者它的子類派生一個子類即可。如果你繼承Exception類，則為受檢查異常，必須對其進行處理;如果不想處理，可以讓自定義異常類繼承運行時異常RuntimeException類。通常我們自定義異常類應該包含2個構造器：一個是默認的構造器，另一個是帶有詳細信息的構造器。這裡舉一個例子。</p><pre><code>/**IllegalAgeException：非法年齡異常，繼承Exception類*/class IllegalAgeException extends Exception {    //默認構造器    public IllegalAgeException() {    }    //帶有詳細信息的構造器，信息存儲在message中    public IllegalAgeException(String message) {        super(message);    }}   public void setAge(int age) throws IllegalAgeException {        if (age &lt; 0) {            throw new IllegalAgeException("人的年齡不應該為負數");        }        this.age = age;    }</code></pre><p>最後給大家講述一點使用異常機制的建議：</p><p>1.要避免使用異常處理代替錯誤處理，這樣會降低程序的清晰性，並且效率低下。</p><p>2.處理異常不可以代替簡單測試---只在異常情況下使用異常機制。</p><p>3.不要進行小粒度的異常處理---應該將整個任務包裝在一個try語句塊中。</p><p>4.異常往往在高層處理。</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>Java</a></li><li><a>異常及</a></li><li><a>處理</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/12d49a9e.html alt="一文讀懂 Java 異常處理" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/6c395510d4e245a19bf9cdde6dd9ac2e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/12d49a9e.html title="一文讀懂 Java 異常處理">一文讀懂 Java 異常處理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/10c7d8fd.html alt=神州泰嶽：公司在自然語言處理領域的基礎技術研究和應用落地均走在行業前列 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/10c7d8fd.html title=神州泰嶽：公司在自然語言處理領域的基礎技術研究和應用落地均走在行業前列>神州泰嶽：公司在自然語言處理領域的基礎技術研究和應用落地均走在行業前列</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0be408a4.html alt="MySQL 事務處理" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0be408a4.html title="MySQL 事務處理">MySQL 事務處理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/011d2da0.html alt=MySql併發與事務的處理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/f13d8a1e-5e60-4b48-90bc-3c26e312a208 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/011d2da0.html title=MySql併發與事務的處理>MySql併發與事務的處理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d3c48fcc.html alt=Spring聲明式事務處理的實現原理，來自面試官的窮追拷問 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d3c48fcc.html title=Spring聲明式事務處理的實現原理，來自面試官的窮追拷問>Spring聲明式事務處理的實現原理，來自面試官的窮追拷問</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/efc2a519.html alt=你知道MySQL的事務處理和隔離級別嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/efc2a519.html title=你知道MySQL的事務處理和隔離級別嗎？>你知道MySQL的事務處理和隔離級別嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/48ba24d7.html alt=深入淺出：Java事務原理和應用兼JDBC事務詳解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/3c5e0002a8059c1311aa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/48ba24d7.html title=深入淺出：Java事務原理和應用兼JDBC事務詳解>深入淺出：Java事務原理和應用兼JDBC事務詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b8bda645.html alt=「Java」隨機數詳解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b471807e699b44c2b1dedc580ea3f3af style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b8bda645.html title=「Java」隨機數詳解>「Java」隨機數詳解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/816b04b7.html alt=從JVM層面帶你分析Java的Object類源碼第一部分 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/816b04b7.html title=從JVM層面帶你分析Java的Object類源碼第一部分>從JVM層面帶你分析Java的Object類源碼第一部分</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cf633068.html alt="Java 多態的實現機制，看了都說好" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9d3b0e55813d46b4982ae7d9b81d1802 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cf633068.html title="Java 多態的實現機制，看了都說好">Java 多態的實現機制，看了都說好</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/12498348.html alt="Java 編譯時多態和運行時多態" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1531535784468c357213ffe style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/12498348.html title="Java 編譯時多態和運行時多態">Java 編譯時多態和運行時多態</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d60e504d.html alt=Java基礎之多態，動態綁定多態的代碼案例，簡單卻很重要 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ab338c7287fe4649a96227987579c844 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d60e504d.html title=Java基礎之多態，動態綁定多態的代碼案例，簡單卻很重要>Java基礎之多態，動態綁定多態的代碼案例，簡單卻很重要</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bb876e43.html alt=Java特性之一：多態詳解，學java不求人 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/39a700034bab2e1401a3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bb876e43.html title=Java特性之一：多態詳解，學java不求人>Java特性之一：多態詳解，學java不求人</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/234d55fa.html alt=Java開發課程（十）——面向對象5、多態 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/df3621e51e4242fd90731dd013472f12 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/234d55fa.html title=Java開發課程（十）——面向對象5、多態>Java開發課程（十）——面向對象5、多態</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/96d2083b.html alt=「Java三分鐘」Java三大特性——多態理解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/6a9b8965-0a4c-4cb4-9389-6cbbda0e9d93 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/96d2083b.html title=「Java三分鐘」Java三大特性——多態理解>「Java三分鐘」Java三大特性——多態理解</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>