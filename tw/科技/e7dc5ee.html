<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>ç”¨æ–¼é›»å½±æ¨è–¦çš„æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨-ä¸€ç¨®å¯¦ç”¨çš„æ–¹æ³• | æå®¢å¿«è¨Š</title><meta property="og:title" content="ç”¨æ–¼é›»å½±æ¨è–¦çš„æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨-ä¸€ç¨®å¯¦ç”¨çš„æ–¹æ³• - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/15378625194763ffb073139"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e7dc5ee.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e7dc5ee.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e7dc5ee.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e7dc5ee.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e7dc5ee.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e7dc5ee.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/e7dc5ee.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/e7dc5ee.html><meta property="article:published_time" content="2020-10-29T21:05:26+08:00"><meta property="article:modified_time" content="2020-10-29T21:05:26+08:00"><meta name=Keywords content><meta name=description content="ç”¨æ–¼é›»å½±æ¨è–¦çš„æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨-ä¸€ç¨®å¯¦ç”¨çš„æ–¹æ³•"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/e7dc5ee.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>ç”¨æ–¼é›»å½±æ¨è–¦çš„æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨-ä¸€ç¨®å¯¦ç”¨çš„æ–¹æ³•</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><p>ç”¨æ–¼æ¨è–¦çš„è‡ªå‹•ç·¨ç¢¼å™¨çš„å¤§å¤šæ•¸ç¤ºä¾‹åƒ…è€ƒæ…®ç”¨æˆ¶å’Œç”¨æˆ¶çµ¦å‡ºçš„è©•ç´šã€‚é€™äº›å»ºè­°æ²’æœ‰è€ƒæ…®å…¶ä»–å±¬æ€§ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘è€ƒæ…®100k movielens datasetï¼ˆhttps://grouplens.org/datasets/movielens/100k/ï¼‰ï¼Œå®ƒåŒ…å«å„ç¨®å…¶ä»–å±¬æ€§ï¼Œå¦‚ç”¨æˆ¶çš„æ€§åˆ¥å’Œå¹´é½¡ã€‚é›»å½±é‚„åŒ…å«æµæ´¾ä¿¡æ¯ã€‚è€ƒæ…®åˆ°é€™äº›å±¬æ€§ï¼Œå¯ä»¥å¹«åŠ©æ·±å±¤ç¥ç¶“ç¶²çµ¡æ¨å°å‡º18 - 25æ­²å¹´é½¡æ®µçš„ç”·æ€§ç”¨æˆ¶æ›´å–œæ­¡çœ‹å‹•ä½œç‰‡å’Œææ€–ç‰‡ï¼Œæˆ–è€…åŒä¸€å¹´é½¡æ®µçš„å¥³æ€§ç”¨æˆ¶æ›´å–œæ­¡çœ‹æ„›æƒ…ç‰‡ã€‚</p><p>æˆ‘å€‘å°‡ç›´æ¥æ·±å…¥ç ”ç©¶é€™ç¨®æ–¹æ³•çš„ä»£ç¢¼ï¼Œä¸¦åœ¨æ­¤éç¨‹ä¸­è§£é‡‹ä¸€äº›æ¦‚å¿µã€‚</p><h1>ç¬¬1æ­¥ï¼šæˆ‘å€‘ä½¿ç”¨pytorchæ§‹å»ºç¥ç¶“ç¶²çµ¡ï¼Œå°å…¥Pythonåº«å’Œæ•¸æ“šé›†çš„ä»£ç¢¼å¦‚ä¸‹ï¼š</h1><pre># Importing the librariesimport numpy as npimport pandas as pdimport torchimport torch.nn as nnimport torch.optim as optimimport torch.utils.datafrom torch.autograd import Variable# Importing the datasetprint('Importing Dataset =====&gt;')movies = pd.read_csv('ml-1m/movies.dat', sep = '::', header = None, engine = 'python', encoding = 'latin-1')users = pd.read_csv('ml-1m/users.dat', sep = '::', header = None, engine = 'python', encoding = 'latin-1')ratings = pd.read_csv('ml-1m/ratings.dat', sep = '::', header = None, engine = 'python', encoding = 'latin-1')# Preparing the training set and the test setprint('Reading testing and training datasets =====&gt;')# Training and test set for 100k userstraining_set_df = pd.read_csv('ml-100k/u1.base', delimiter = '\t', header=None)test_set_df = pd.read_csv('ml-100k/u1.test', delimiter = '\t', header=None)</pre><h1>æ­¥é©Ÿ2ï¼šå°‡è¨“ç·´é›†å’Œæ¸¬è©¦é›†è½‰æ›ç‚ºnumpyæ•¸çµ„ï¼Œä¸¦ç²å–ç”¨æˆ¶æ•¸ï¼Œé›»å½±æ•¸å’Œç”¨æˆ¶å±¬æ€§æ•¸ï¼ŒPythonä»£ç¢¼å¦‚ä¸‹ï¼š</h1><pre># Convert training set and test set in numpy arraystraining_set_ar = np.array(training_set_df, dtype = 'int')test_set_ar = np.array(test_set_df, dtype = 'int')# Getting the number of users and moviesnb_users = int(max(max(training_set_ar[:,0]), max(test_set_ar[:,0])))nb_movies = int(max(max(training_set_ar[:,1]), max(test_set_ar[:,1])))nb_userAttributes = 4</pre><p>é€™è£¡æœ‰4å€‹ç”¨æˆ¶å±¬æ€§å°æ‡‰æ–¼ä»¥ä¸‹å…§å®¹ï¼š</p><ul><li>å¦‚æœç”¨æˆ¶æ˜¯å¥³æ€§å‰‡æ¨™è¨˜</li><li>å¦‚æœç”¨æˆ¶æ˜¯ç”·æ€§å‰‡æ¨™è¨˜</li><li>ç”¨æˆ¶å¹´é½¡</li><li>ç”¨æˆ¶è¨»å†Šæœˆä»½</li></ul><h1>ç¬¬3æ­¥ï¼šç²å–æ€§åˆ¥æ¨™èªŒçš„æ•¸çµ„ï¼ŒPythonä»£ç¢¼å¦‚ä¸‹æ‰€ç¤ºï¼š</h1><pre>users['female_user'] = (users[1] == 'F').astype(int)users['male_user'] = (users[1] == 'M').astype(int)</pre><h1>ç¬¬å››æ­¥:ç‚ºæ‰€æœ‰çš„é›»å½±æå–æµæ´¾ï¼ŒPythonå¯¦ç¾å¦‚ä¸‹ï¼š</h1><div class=pgc-img><img alt=ç”¨æ–¼é›»å½±æ¨è–¦çš„æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨-ä¸€ç¨®å¯¦ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15378625194763ffb073139><p class=pgc-img-caption></p></div><pre># extract unique genre valuesprint('Extracting unique genres =====&gt;')genre = movies[2]unique_genre = genre.unique()genre_values = []for movie_genre in unique_genre: mg = movie_genre.split("|") for g in mg: if g not in genre_values: genre_values.append(g) genre_values = sorted(genre_values, key=str.lower)print(genre_values)print(len(genre_values))</pre><h1>æ­¥é©Ÿ5ï¼šåŸºæ–¼æå–çš„æµæ´¾é¡å‹å‰µå»ºé¡å‹å‘é‡ï¼ŒPythonä»£ç¢¼å¦‚ä¸‹ï¼š</h1><div class=pgc-img><img alt=ç”¨æ–¼é›»å½±æ¨è–¦çš„æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨-ä¸€ç¨®å¯¦ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1537862568201862fd982cf><p class=pgc-img-caption></p></div><pre># get genre vectordef get_genre_vector(genre_row_val): mg = genre_row_val.split("|") gen_vec = np.zeros(len(genre_values)) gen_index = 0 for g in genre_values: if g in mg: gen_vec[gen_index] = 1 gen_index += 1return gen_vec# unit tests for above function'''print(get_genre_vector("Action|Adventure|Romance"))print(get_genre_vector("Animation|Children's|Comedy"))print(get_genre_vector("Thriller"))print(get_genre_vector("Animation|Children's|Comedy|Romance"))'''</pre><h1>æ­¥é©Ÿ6ï¼šå°‡é¡å‹å‘é‡æ·»åŠ åˆ°é›»å½±dataframe</h1><div class=pgc-img><img alt=ç”¨æ–¼é›»å½±æ¨è–¦çš„æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨-ä¸€ç¨®å¯¦ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15378626255035ad0869b0c><p class=pgc-img-caption></p></div><pre># Add Genre Vector to movies dataframeprint('Creating Genre vector on movies df ====&gt;')movie_data = movies[2]movie_col = []gen_index = 0for movie_gen in movie_data: gen_vec = get_genre_vector(movie_gen) movie_col.append(gen_vec) gen_index += 1 movies['genre_vector'] = movie_col</pre><h1>æ­¥é©Ÿ7ï¼šå°‡é¡å‹å‘é‡æ·»åŠ åˆ°è¨“ç·´å’Œæ¸¬è©¦datafrmeä¸¦å°‡dataframesè½‰æ›ç‚ºnumpyæ•¸çµ„</h1><div class=pgc-img><img alt=ç”¨æ–¼é›»å½±æ¨è–¦çš„æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨-ä¸€ç¨®å¯¦ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/153786265471461eb8d57f7><p class=pgc-img-caption></p></div><pre>def addgenrevector(data): genre_array = [] movie_id_list = data[1].tolist() for movie_id in movie_id_list: genre_array.append(movies.loc[movies[0] == movie_id]['genre_vector']) data['genre_vector'] = genre_array return data print('Adding Genre Vector to training and testing datasets =====&gt;')training_set_gen_df = addgenrevector(training_set_df)training_set_gen_ar = np.array(training_set_gen_df)test_set_gen_df = addgenrevector(test_set_df)test_set_gen_ar = np.array(test_set_gen_df)</pre><h1>æ­¥é©Ÿ8ï¼šé€™æ˜¯ä»¥ä¸‹åˆ—æ ¼å¼æ’åˆ—æ•¸æ“šçš„æœ€é‡è¦æ­¥é©Ÿ</h1><div class=pgc-img><img alt=ç”¨æ–¼é›»å½±æ¨è–¦çš„æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨-ä¸€ç¨®å¯¦ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/1537861367228d9151198ff><p class=pgc-img-caption>ç”¨æ–¼è¨“ç·´æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨çš„2DçŸ©é™£</p></div><p>æ•¸æ“šæ‡‰è¡¨ç¤ºäºŒç¶­æ•¸çµ„ï¼Œå…¶ä¸­æ¯è¡Œä»£è¡¨ç”¨æˆ¶ã€‚åˆ—åˆ†ç‚ºä»¥ä¸‹å¹¾é¡ï¼š</p><ol><li>å‰nåˆ—æ˜¯æŒ‡ç”¨æˆ¶è©•åƒ¹é›»å½±çš„néƒ¨é›»å½±ã€‚å¦‚æœç”¨æˆ¶æ²’æœ‰ç‚ºé›»å½±è©•ç´šï¼Œå®ƒå°‡åŒ…å«å€¼0</li><li>æ¥ä¸‹ä¾†çš„nåˆ—è¡¨ç¤ºé¡å‹çš„æ•¸é‡ã€‚åœ¨é€™è£¡ï¼Œæˆ‘å€‘æ§‹å»ºäº†ä¸€å€‹ç”¨æˆ¶å¯èƒ½æœƒè§€çœ‹çš„é›»å½±æ¨è–¦ã€‚å› æ­¤ï¼Œueser 1å’ŒGenre 1çš„å–®å…ƒæ ¼è¡¨ç¤ºuser 1å°Genre 1é¡åˆ¥çš„è©•åˆ†è¶…é3æˆ–ä»¥ä¸Šçš„é›»å½±æ•¸é‡ã€‚æˆ‘å€‘å¯ä»¥æ‡‰ç”¨å¤šç¨®è¦å‰‡ï¼Œä½†æ˜¯æˆ‘é¸æ“‡äº†é€™å€‹è¦å‰‡ä¾†ç¢ºå®šç”¨æˆ¶å°ç‰¹å®šé¡å‹çš„å–œå¥½ã€‚</li><li>æœ€å¾Œå¹¾è¡Œè¡¨ç¤ºç”¨æˆ¶å±¬æ€§ï¼Œå¦‚ç”¨æˆ¶æ€§åˆ¥ï¼Œå¹´é½¡ï¼Œè¨»å†Šæœˆæ•¸ç­‰ã€‚</li></ol><p>åœ¨äºŒç¶­æ•¸çµ„ä¸­æ’åˆ—æ•¸æ“šçš„Pythonå‡½æ•¸å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt=ç”¨æ–¼é›»å½±æ¨è–¦çš„æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨-ä¸€ç¨®å¯¦ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1537862684401e00afa0852><p class=pgc-img-caption></p></div><pre>def createmultidimensionalmatrix(data): print(data.shape) gen_data = [] for id_users in range(1, nb_users + 1): id_movies = data[1][data[0] == id_users] id_ratings = data[2][data[0] == id_users] user_genre_list = data['genre_vector'][data[0] == id_users][data[2] &gt;= 3] female_user = float(users['female_user'][users[0] == id_users]) male_user = float(users['male_user'][users[0] == id_users]) user_age = float(users[2][users[0] == id_users]) reg_months = float(users[3][users[0] == id_users]) user_genre_sum = np.zeros(len(genre_values)) for usr_gen_vec in user_genre_list: if len(usr_gen_vec): user_genre_sum = user_genre_sum + np.array(usr_gen_vec) data_reshaped = np.zeros(nb_movies) # Create a matrix with users in rows and ratings for each movie in columns data_reshaped[id_movies - 1] = id_ratings # Add columns of user genre only for good ratings if user_genre_sum[0].shape: data_reshaped = np.append(data_reshaped, user_genre_sum[0]) else: data_reshaped = np.append(data_reshaped, user_genre_sum)  data_reshaped = np.append(data_reshaped, [female_user]) data_reshaped = np.append(data_reshaped, [male_user]) data_reshaped = np.append(data_reshaped, [user_age]) data_reshaped = np.append(data_reshaped, [reg_months]) gen_data.append(list(data_reshaped)) return gen_data  print('Creating 2D matrix ======&gt;') training_gen_data = createmultidimensionalmatrix(training_set_gen_df)test_gen_data = createmultidimensionalmatrix(test_set_gen_df)</pre><h1>æ­¥é©Ÿ9ï¼šå°‡2Dé™£åˆ—è½‰æ›ç‚ºtorch å¼µé‡</h1><pre># Converting the data into Torch tensorsprint('Creating torch tensors ======&gt;')training_set_1 = torch.FloatTensor(training_gen_data)test_set_1 = torch.FloatTensor(test_gen_data)</pre><h1>ç¬¬10æ­¥ï¼šå‰µå»ºç¥ç¶“ç¶²çµ¡ã€‚</h1><p>é€™è£¡æˆ‘ä¸æœƒä»‹ç´¹è‡ªå‹•ç·¨ç¢¼å™¨çš„åŸºç¤çŸ¥è­˜ï¼Œä½†æ˜¯éš»æœƒæåˆ°è‡ªå‹•ç·¨ç¢¼å™¨çš„å…¸å‹ç”¨ä¾‹æ˜¯æ•¸æ“šå£“ç¸®ï¼Œç„¶å¾Œæ˜¯data recreationã€‚ä¸€å€‹å¾ˆå¥½çš„ä¾‹å­æ˜¯åœ–åƒå†ç”Ÿã€‚æˆ‘å€‘å°‡å‰µå»ºçš„ç¥ç¶“ç¶²çµ¡é¡å‹å¦‚ä¸‹åœ–æ‰€ç¤ºï¼š</p><div class=pgc-img><img alt=ç”¨æ–¼é›»å½±æ¨è–¦çš„æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨-ä¸€ç¨®å¯¦ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15378614294384f31f7395b><p class=pgc-img-caption>è‡ªå‹•ç·¨ç¢¼å™¨æ·±åº¦ç¥ç¶“ç¶²çµ¡</p></div><p>è«‹æ³¨æ„ï¼Œæˆ‘å·²ç¶“å˜—è©¦äº†3å±¤ï¼Œ5å±¤å’Œ7å±¤çš„æ·±åº¦ç¥ç¶“ç¶²çµ¡ã€‚æˆ‘é¸æ“‡äº†3å±¤ï¼Œå› ç‚ºè¨ˆç®—éš¨è‘—å±¤æ¬¡å’Œç¥ç¶“å…ƒçš„å¢åŠ å‘ˆæŒ‡æ•¸å¢é•·ã€‚åœ¨æˆ‘å€‘çš„ä¾‹å­ä¸­ï¼Œç”±5å±¤å’Œ7å±¤ç¥ç¶“ç¶²çµ¡æä¾›çš„çµæœåƒ…æ¯”3å±¤ç¶²çµ¡ç¨å¾®å¥½ä¸€é»ã€‚å‰µå»ºç¥ç¶“ç¶²çµ¡çš„Pythonä»£ç¢¼å¦‚ä¸‹ã€‚æˆ‘å€‘ä½¿ç”¨RMS prop å„ªåŒ–å™¨å’Œsigmoidæ¿€æ´»å‡½æ•¸é¸æ“‡å‡æ–¹èª¤å·®æå¤±å‡½æ•¸ã€‚</p><div class=pgc-img><img alt=ç”¨æ–¼é›»å½±æ¨è–¦çš„æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨-ä¸€ç¨®å¯¦ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1537862712632585d952f5e><p class=pgc-img-caption></p></div><pre>class SAE(nn.Module): def __init__(self, ): super(SAE, self).__init__() self.fc1 = nn.Linear(input_columns, 20) self.fc2 = nn.Linear(20, 10) self.fc3 = nn.Linear(10, 20) self.fc4 = nn.Linear(20, input_columns) self.activation = nn.Sigmoid()  def forward(self, x): x = self.activation(self.fc1(x)) x = self.activation(self.fc2(x)) x = self.activation(self.fc3(x)) x = self.fc4(x) return xsae = SAE()criterion = nn.MSELoss()optimizer = optim.RMSprop(sae.parameters(), lr=0.01, weight_decay=0.5)</pre><h1>æ­¥é©Ÿ11ï¼šè¨“ç·´ç¶²çµ¡ä¸¦æ¸¬é‡æå¤±ä»¥è©•ä¼°æ¨¡å‹çš„æ€§èƒ½ã€‚</h1><p>é€™è£¡æˆ‘åªä½¿ç”¨äº†è©•ç´šåˆ—ä¾†è¨ˆç®—æå¤±ï¼Œå› ç‚ºæˆ‘å€‘æœƒæ ¹æ“šç”¨æˆ¶å¯èƒ½çµ¦é›»å½±çš„é æ¸¬è©•ç´šå‘ç”¨æˆ¶æ¨è–¦ç‰¹å®šçš„é›»å½±ã€‚è¨“ç·´å’Œæ¸¬è©¦é›†çš„Pythonä»£ç¢¼å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt=ç”¨æ–¼é›»å½±æ¨è–¦çš„æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨-ä¸€ç¨®å¯¦ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/153786274842801b952edcf><p class=pgc-img-caption></p></div><pre>nb_epoch = 200for epoch in range(1, nb_epoch+1): train_loss = 0 s = 0. for id_user in range(nb_users): input = Variable(training_set_1[id_user]).unsqueeze(0) target = input.clone() #Select only rating related columns to compute loss target_ratings = target[:, :nb_movies] if torch.sum(target.data &gt; 0) &gt; 0: output = sae(input) output_ratings = output[:, :nb_movies] target.require_grad = False output[target == 0] = 0 loss = criterion(output_ratings, target_ratings) mean_corrector = nb_movies/float(torch.sum(target.data &gt; 0) + 1e-10) loss.backward() train_loss += np.sqrt(loss.data[0]*mean_corrector) s += 1. optimizer.step() print('epoch: '+str(epoch)+' loss: '+str(train_loss/s))  # Testing the SAEtest_loss = 0s = 0.for id_user in range(nb_users): input = Variable(training_set_1[id_user]).unsqueeze(0) target = Variable(test_set_1[id_user]).unsqueeze(0) target_ratings = target[:, :nb_movies] if torch.sum(target.data &gt; 0) &gt; 0: output = sae(input) output_ratings = output[:, :nb_movies] target.require_grad = False output[target == 0] = 0 loss = criterion(output_ratings, target_ratings) mean_corrector = nb_movies/float(torch.sum(target.data &gt; 0) + 1e-10) test_loss += np.sqrt(loss.data[0]*mean_corrector) s += 1.print('test loss: '+str(test_loss/s))</pre><p>çµæœï¼šæˆ‘å˜—è©¦ä½¿ç”¨ä¸åŒæ•¸é‡çš„å±¬æ€§å’Œä¸åŒçš„æ¶æ§‹ç”¨æ–¼ç¥ç¶“ç¶²çµ¡ã€‚ç²å¾—çš„çµæœå¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt=ç”¨æ–¼é›»å½±æ¨è–¦çš„æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨-ä¸€ç¨®å¯¦ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1537861470643a42cce0f11><p class=pgc-img-caption>è¨“ç·´çµæœ</p></div><p>æˆ‘å€‘å¯ä»¥èªªç²å¾—çš„æœ€ä½³çµæœæ˜¯ä½¿ç”¨å…·æœ‰3å±¤æ·±åº¦ç¥ç¶“ç¶²çµ¡å’Œ200å€‹epochsçš„é›»å½±è©•ç´šï¼Œé¡å‹è¨ˆæ•¸å’Œç”¨æˆ¶å±¬æ€§ã€‚</p><p>ä½œç‚ºåƒè€ƒï¼Œæˆ‘ä½¿ç”¨çš„5å±¤æ·±åº¦ç¥ç¶“ç¶²çµ¡çš„æ¶æ§‹å¦‚ä¸‹ï¼š</p><div class=pgc-img><img alt=ç”¨æ–¼é›»å½±æ¨è–¦çš„æ·±åº¦è‡ªå‹•ç·¨ç¢¼å™¨-ä¸€ç¨®å¯¦ç”¨çš„æ–¹æ³• onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15378627894095040f97480><p class=pgc-img-caption></p></div><pre>class SAE(nn.Module): def __init__(self, ): super(SAE, self).__init__() self.fc1 = nn.Linear(input_columns, 300) self.fc2 = nn.Linear(300, 100) self.fc22 = nn.Linear(100, 50) self.fc23 = nn.Linear(50, 20) self.fc24 = nn.Linear(20, 10) self.fc3 = nn.Linear(10, 20) self.fc31 = nn.Linear(20, 50) self.fc32 = nn.Linear(50, 100) self.fc33 = nn.Linear(100, 300) self.fc4 = nn.Linear(300, input_columns) self.activation = nn.Sigmoid()  def forward(self, x): x = self.activation(self.fc1(x)) x = self.activation(self.fc2(x)) x = self.activation(self.fc22(x)) x = self.activation(self.fc23(x)) x = self.activation(self.fc24(x)) x = self.activation(self.fc3(x)) x = self.activation(self.fc31(x)) x = self.activation(self.fc32(x)) x = self.activation(self.fc33(x)) x = self.fc4(x) return x</pre></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>é›»å½±</a></li><li><a>æ¨è–¦</a></li><li><a>è‡ªå‹•</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E5%AD%B8/38f5fd6f.html alt=è¦ªå­é›»å½±æ¨è–¦â€”â€”ã€Šå¸ä¼éµæ—¥è¨˜ã€‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1532609339906b61c5cd417 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/38f5fd6f.html title=è¦ªå­é›»å½±æ¨è–¦â€”â€”ã€Šå¸ä¼éµæ—¥è¨˜ã€‹>è¦ªå­é›»å½±æ¨è–¦â€”â€”ã€Šå¸ä¼éµæ—¥è¨˜ã€‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/77c3387c.html alt=é­”å¹»é›»å½±ä¸¨æ¨è–¦åéƒ¨ç¶“å…¸çš„é­”å¹»é›»å½±ï¼Œåœ¨é©šéšªä¸­æ»¿è¶³å¥½å¥‡å¿ƒ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f0f3f485274e4008a56cb3fbd2ff015f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/77c3387c.html title=é­”å¹»é›»å½±ä¸¨æ¨è–¦åéƒ¨ç¶“å…¸çš„é­”å¹»é›»å½±ï¼Œåœ¨é©šéšªä¸­æ»¿è¶³å¥½å¥‡å¿ƒ>é­”å¹»é›»å½±ä¸¨æ¨è–¦åéƒ¨ç¶“å…¸çš„é­”å¹»é›»å½±ï¼Œåœ¨é©šéšªä¸­æ»¿è¶³å¥½å¥‡å¿ƒ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/93bbb68.html alt=å°åº¦é›»å½±çœŸçš„å¾ˆå¥½çœ‹ï¼Œçµ¦ä½ æ¨è–¦å¹¾éƒ¨å°åº¦é›»å½± class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/55cebe7392bc42ff82198bfaf81ef6d2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/93bbb68.html title=å°åº¦é›»å½±çœŸçš„å¾ˆå¥½çœ‹ï¼Œçµ¦ä½ æ¨è–¦å¹¾éƒ¨å°åº¦é›»å½±>å°åº¦é›»å½±çœŸçš„å¾ˆå¥½çœ‹ï¼Œçµ¦ä½ æ¨è–¦å¹¾éƒ¨å°åº¦é›»å½±</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/9fd65dd.html alt=æ¨è–¦ä¹éƒ¨ä½ ä¸çœ‹åˆ°æœ€å¾Œæ ¹æœ¬çŒœä¸åˆ°çµå±€çš„é›»å½±ï¼Œéƒ¨éƒ¨éƒ½æ˜¯ç‡’è…¦ä½³ä½œï¼ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p3.pstatp.com/large/pgc-image/15360532894949f4658e164 style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/9fd65dd.html title=æ¨è–¦ä¹éƒ¨ä½ ä¸çœ‹åˆ°æœ€å¾Œæ ¹æœ¬çŒœä¸åˆ°çµå±€çš„é›»å½±ï¼Œéƒ¨éƒ¨éƒ½æ˜¯ç‡’è…¦ä½³ä½œï¼>æ¨è–¦ä¹éƒ¨ä½ ä¸çœ‹åˆ°æœ€å¾Œæ ¹æœ¬çŒœä¸åˆ°çµå±€çš„é›»å½±ï¼Œéƒ¨éƒ¨éƒ½æ˜¯ç‡’è…¦ä½³ä½œï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e55aaf9b.html alt="è«–æ–‡æ¨è–¦ | è¢ä¿®å­ï¼šèˆªæ”å½±åƒå¯†é›†åŒ¹é…çš„ç ”ç©¶é€²å±•èˆ‡å±•æœ›" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/R6Ieh75DBRtmcY style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e55aaf9b.html title="è«–æ–‡æ¨è–¦ | è¢ä¿®å­ï¼šèˆªæ”å½±åƒå¯†é›†åŒ¹é…çš„ç ”ç©¶é€²å±•èˆ‡å±•æœ›">è«–æ–‡æ¨è–¦ | è¢ä¿®å­ï¼šèˆªæ”å½±åƒå¯†é›†åŒ¹é…çš„ç ”ç©¶é€²å±•èˆ‡å±•æœ›</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4653cf8e.html alt=è«–æ–‡æ¨è–¦ï½œç‹æ¿¤ï¼šåœ‹ç”¢æ©Ÿè¼‰å¤§è¦–å ´ä¸‰ç·šé™£CCDç›¸æ©ŸGNSSåå¿ƒçŸ¢é‡å’ŒIMUè¦–è»¸åå¿ƒè§’æ¨™å®šæŠ€è¡“ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/R6Ieh75DBRtmcY style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4653cf8e.html title=è«–æ–‡æ¨è–¦ï½œç‹æ¿¤ï¼šåœ‹ç”¢æ©Ÿè¼‰å¤§è¦–å ´ä¸‰ç·šé™£CCDç›¸æ©ŸGNSSåå¿ƒçŸ¢é‡å’ŒIMUè¦–è»¸åå¿ƒè§’æ¨™å®šæŠ€è¡“>è«–æ–‡æ¨è–¦ï½œç‹æ¿¤ï¼šåœ‹ç”¢æ©Ÿè¼‰å¤§è¦–å ´ä¸‰ç·šé™£CCDç›¸æ©ŸGNSSåå¿ƒçŸ¢é‡å’ŒIMUè¦–è»¸åå¿ƒè§’æ¨™å®šæŠ€è¡“</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e4f896bd.html alt=åéƒ¨éœ‡æ’¼å ´é¢çš„å¥‡å¹»é›»å½±ï¼Œå“ªä¸€éƒ¨æœ€ç²¾å½© class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/9244f4643eed4a128d5b0c6ca6b6625c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e4f896bd.html title=åéƒ¨éœ‡æ’¼å ´é¢çš„å¥‡å¹»é›»å½±ï¼Œå“ªä¸€éƒ¨æœ€ç²¾å½©>åéƒ¨éœ‡æ’¼å ´é¢çš„å¥‡å¹»é›»å½±ï¼Œå“ªä¸€éƒ¨æœ€ç²¾å½©</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6c74bddb.html alt=é«˜åˆ†æˆ°çˆ­é›»å½±ï¼ŒåŠ›è–¦ï¼Œéœ‡æ’¼çš„æˆ°é¬¥å ´æ™¯ï¼Œå„ç¨®æ­¦å™¨è®“äººå¤§é£½çœ¼ç¦ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/0756e2cb09c54e30b2a0798fbf071da7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6c74bddb.html title=é«˜åˆ†æˆ°çˆ­é›»å½±ï¼ŒåŠ›è–¦ï¼Œéœ‡æ’¼çš„æˆ°é¬¥å ´æ™¯ï¼Œå„ç¨®æ­¦å™¨è®“äººå¤§é£½çœ¼ç¦>é«˜åˆ†æˆ°çˆ­é›»å½±ï¼ŒåŠ›è–¦ï¼Œéœ‡æ’¼çš„æˆ°é¬¥å ´æ™¯ï¼Œå„ç¨®æ­¦å™¨è®“äººå¤§é£½çœ¼ç¦</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/43600b7e.html alt=æ¨è–¦10å€‹å€¼å¾—ä¸€å»çš„åœ‹å¤–ç¥å™¨ç¶²ç«™ï¼ç™»éŒ„ç„¡éœ€ä»»ä½•æ‰‹æ®µï¼Œå¯¦ç”¨åˆæœ‰è¶£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8716c57443b84bf39d12f7181c19e5d7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/43600b7e.html title=æ¨è–¦10å€‹å€¼å¾—ä¸€å»çš„åœ‹å¤–ç¥å™¨ç¶²ç«™ï¼ç™»éŒ„ç„¡éœ€ä»»ä½•æ‰‹æ®µï¼Œå¯¦ç”¨åˆæœ‰è¶£>æ¨è–¦10å€‹å€¼å¾—ä¸€å»çš„åœ‹å¤–ç¥å™¨ç¶²ç«™ï¼ç™»éŒ„ç„¡éœ€ä»»ä½•æ‰‹æ®µï¼Œå¯¦ç”¨åˆæœ‰è¶£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/31adec60.html alt=æ–¹å¤§ä¹é‹¼æª¢æ¸¬éƒ¨æ¨å‡ºç”ŸçŸ³ç°è‡ªå‹•å–æ¨£å™¨ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/31adec60.html title=æ–¹å¤§ä¹é‹¼æª¢æ¸¬éƒ¨æ¨å‡ºç”ŸçŸ³ç°è‡ªå‹•å–æ¨£å™¨>æ–¹å¤§ä¹é‹¼æª¢æ¸¬éƒ¨æ¨å‡ºç”ŸçŸ³ç°è‡ªå‹•å–æ¨£å™¨</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/74f03106.html alt=æ–¹å¤§ä¹é‹¼ï¼šçµ¦çŸ³ç°ç²‰è‡ªå‹•å–æ¨£å™¨è…”é«”æ´—â€œé¹½é…¸æµ´â€æ•ˆæœå¥½ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/74f03106.html title=æ–¹å¤§ä¹é‹¼ï¼šçµ¦çŸ³ç°ç²‰è‡ªå‹•å–æ¨£å™¨è…”é«”æ´—â€œé¹½é…¸æµ´â€æ•ˆæœå¥½>æ–¹å¤§ä¹é‹¼ï¼šçµ¦çŸ³ç°ç²‰è‡ªå‹•å–æ¨£å™¨è…”é«”æ´—â€œé¹½é…¸æµ´â€æ•ˆæœå¥½</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c4bdc082.html alt=åŒ–å­¸è€å¸«æ¨è–¦ï¼šæŒ‰å…ƒç´ æ­¸é¡çš„åˆä¸­åŒ–å­¸æ–¹ç¨‹å¼é›†åˆï¼è€ƒå‰è¤‡ç¿’å¥½è³‡æ–™ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/e672e532fceb4bde92dc10ca986250ad style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c4bdc082.html title=åŒ–å­¸è€å¸«æ¨è–¦ï¼šæŒ‰å…ƒç´ æ­¸é¡çš„åˆä¸­åŒ–å­¸æ–¹ç¨‹å¼é›†åˆï¼è€ƒå‰è¤‡ç¿’å¥½è³‡æ–™>åŒ–å­¸è€å¸«æ¨è–¦ï¼šæŒ‰å…ƒç´ æ­¸é¡çš„åˆä¸­åŒ–å­¸æ–¹ç¨‹å¼é›†åˆï¼è€ƒå‰è¤‡ç¿’å¥½è³‡æ–™</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5718fd72.html alt="è«–æ–‡æ¨è–¦ | é–†å»£å³°ï¼šL1ç¯„æ•¸æ¢æ¸¬ç²—å·®å¤±æ•ˆçš„è§€æ¸¬é‡è­˜åˆ¥æ–¹æ³•" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/R6W0QpMHySg0Qb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5718fd72.html title="è«–æ–‡æ¨è–¦ | é–†å»£å³°ï¼šL1ç¯„æ•¸æ¢æ¸¬ç²—å·®å¤±æ•ˆçš„è§€æ¸¬é‡è­˜åˆ¥æ–¹æ³•">è«–æ–‡æ¨è–¦ | é–†å»£å³°ï¼šL1ç¯„æ•¸æ¢æ¸¬ç²—å·®å¤±æ•ˆçš„è§€æ¸¬é‡è­˜åˆ¥æ–¹æ³•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fb1f4f0e.html alt=éŸ“åœ‹ç†±æ’­é›»å½±ï¼šç”·ä¸»ç‚ºå¥³ä¸»é‡è¿”æ‹³æ“Šè‡ºï¼Œä¸ä½†è´äº†æ¯”è³½ï¼Œé‚„æ”¶ç©«æ„›æƒ… class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/cbb597d474244d6482ef869c8dad3851 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fb1f4f0e.html title=éŸ“åœ‹ç†±æ’­é›»å½±ï¼šç”·ä¸»ç‚ºå¥³ä¸»é‡è¿”æ‹³æ“Šè‡ºï¼Œä¸ä½†è´äº†æ¯”è³½ï¼Œé‚„æ”¶ç©«æ„›æƒ…>éŸ“åœ‹ç†±æ’­é›»å½±ï¼šç”·ä¸»ç‚ºå¥³ä¸»é‡è¿”æ‹³æ“Šè‡ºï¼Œä¸ä½†è´äº†æ¯”è³½ï¼Œé‚„æ”¶ç©«æ„›æƒ…</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1fb68281.html alt=æ–°å“æ¨è–¦ï½œä½ è¦çš„ä¸‰é˜²æ¼†æ–°å“ä¾†å•¦ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/0d18e71454334714a9ab8ac0e0e8d019 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1fb68281.html title=æ–°å“æ¨è–¦ï½œä½ è¦çš„ä¸‰é˜²æ¼†æ–°å“ä¾†å•¦>æ–°å“æ¨è–¦ï½œä½ è¦çš„ä¸‰é˜²æ¼†æ–°å“ä¾†å•¦</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>