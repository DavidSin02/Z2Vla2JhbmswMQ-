<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>SpringMVC:æ¥æ”¶åˆ°è«‹æ±‚å¾Œçš„èª¿ç”¨ç´°ç¯€ï¼Œä½ æ˜¯å¦æ¸…æ¥šï¼Ÿ | æå®¢å¿«è¨Š</title><meta property="og:title" content="SpringMVC:æ¥æ”¶åˆ°è«‹æ±‚å¾Œçš„èª¿ç”¨ç´°ç¯€ï¼Œä½ æ˜¯å¦æ¸…æ¥šï¼Ÿ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/3c62f7f39c8a499fb3e7e322ceb2aa76"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ed4819d.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ed4819d.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/ed4819d.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ed4819d.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ed4819d.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/ed4819d.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/ed4819d.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/ed4819d.html><meta property="article:published_time" content="2020-10-29T21:04:55+08:00"><meta property="article:modified_time" content="2020-10-29T21:04:55+08:00"><meta name=Keywords content><meta name=description content="SpringMVC:æ¥æ”¶åˆ°è«‹æ±‚å¾Œçš„èª¿ç”¨ç´°ç¯€ï¼Œä½ æ˜¯å¦æ¸…æ¥šï¼Ÿ"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/ed4819d.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>SpringMVC:æ¥æ”¶åˆ°è«‹æ±‚å¾Œçš„èª¿ç”¨ç´°ç¯€ï¼Œä½ æ˜¯å¦æ¸…æ¥šï¼Ÿ</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><blockquote><p>åˆ†äº«è‡ªå·±åœ¨Javaæ–¹é¢çš„æ‰€æ€æ‰€æƒ³ï¼Œå¸Œæœ›ä½ çœ‹å®Œä¹‹å¾Œèƒ½æœ‰æ›´å¤šæ›´æ·±å…¥çš„ç­è§£</p><p><strong>æœ¬äººå¾®ä¿¡å…¬çœ¾è™Ÿï¼ˆjwfyçš„å­¸ç¿’åˆ†äº«ï¼‰ï¼Œæ­¡è¿é—œæ³¨ï½</strong></p></blockquote><p>æ¥æ”¶åˆ°ä¸€å€‹æ–°çš„è«‹æ±‚ä¹‹å¾Œï¼Œspringå°±æœƒå»æ ¹æ“šè«‹æ±‚çš„URLä¿¡æ¯é¸æ“‡å…·é«”çš„ä»£ç¢¼å¡Šå»åŸ·è¡Œæ“ä½œï¼Œå¦‚åœ–å°±æ˜¯æ¥æ”¶åˆ°ä¸€å€‹æ–°çš„è«‹æ±‚èª¿ç”¨åœ–ï¼Œå¾Tomcaté–‹å§‹ç›´åˆ°æŠŠè«‹æ±‚åˆ†ç™¼åˆ°springä¸­ï¼Œæœ€å¾Œåˆ°äº†doDispatchæ–¹æ³•ã€‚</p><div class=pgc-img><img alt=SpringMVC:æ¥æ”¶åˆ°è«‹æ±‚å¾Œçš„èª¿ç”¨ç´°ç¯€ï¼Œä½ æ˜¯å¦æ¸…æ¥šï¼Ÿ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3c62f7f39c8a499fb3e7e322ceb2aa76><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p>æœ¬ç¯‡å­¸ç¿’ç­†è¨˜ä¸»è¦å°±æ˜¯è¬›ä¸€å€‹æ–°çš„è«‹æ±‚è¢«åˆ†ç™¼åˆ°springä¸­springå¦‚ä½•è™•ç†ï¼Œè‡³æ–¼å¦‚ä½•æƒæåŒ…ä¸­çš„controllerï¼Œå¾—åˆ°URLé…ç½®ä¿¡æ¯å¯ä»¥çœ‹ <a class=pgc-link data-content=mp href="https://www.toutiao.com/i6723360987501560323/?group_id=6723360987501560323" target=_blank>ä½ æ˜¯å¦æ¸…æ¥šSpring MVCä¸­çš„URLæ˜ å°„ç®¡ç†å™¨çš„å·¥ä½œåŸç†</a> ,è€Œæœ¬ç¯‡ä¸»è¦ä»‹ç´¹äº†</p><ul><li>ç²å–åŸ·è¡Œéˆ</li><li>404é é¢è¨­ç½®</li><li>ç²å–é©é…å™¨</li><li>LastModified</li><li>å…§å®¹æ–¹æ³•èª¿ç”¨ï¼ˆinvokeï¼‰</li><li>è¦–åœ–æ¸²æŸ“</li></ul><p>è®“æˆ‘å€‘æ›´åŠ æ¸…æ¥šçš„çŸ¥é“springä¸­ä¸€èˆ¬çš„æ–¹æ³•æ˜¯å¦‚ä½•ç¢ºå®šèª¿ç”¨çš„å…·é«”æ–¹æ³•çš„ï¼Œé©é…ä¸åŒçš„æ¨¡æ¿å¼•æ“ï¼Œé”åˆ°æ¸²æŸ“çš„åœ°æ­¥ï¼Œå†è€…æœ‰æ™‚å€™åˆæ˜¯APIä¸€èˆ¬åªéœ€è¦è¿”å›jsonçµæ§‹çš„æ•¸æ“šï¼Œå…¶èƒŒå¾Œçš„åŸç†æ˜¯å¦‚ä½•å¯¦ç¾çš„ï¼Œä»¥åŠæˆ‘å€‘åœ¨ä½¿ç”¨éç¨‹ä¸­å¦‚ä½•é¿å…å‡ºç¾çš„å„ç¨®å•é¡Œã€‚</p><h1><strong>doDispatch æ–¹æ³•</strong></h1><pre>protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception { HttpServletRequest processedRequest = request; HandlerExecutionChain mappedHandler = null; boolean multipartRequestParsed = false; WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request); try { ModelAndView mv = null; // åˆå§‹åŒ–è¨­ç½®æ¨¡æ¿ç‚ºnull Exception dispatchException = null; // åˆå§‹åŒ–ç•°å¸¸ç‚ºnull try { processedRequest = checkMultipart(request); multipartRequestParsed = (processedRequest != request); // æ–‡ä»¶ä¸Šå‚³çš„ç›¸é—œè¨­ç½®å’Œæ“ä½œ mappedHandler = getHandler(processedRequest); // æ ¹æ“šrequestç²å–å°æ‡‰çš„è«‹æ±‚åŸ·è¡Œéˆ if (mappedHandler == null || mappedHandler.getHandler() == null) { // å¦‚æœæ²’æœ‰å°æ‡‰çš„handlerå°æ–¼ï¼Œå‰‡æ‡‰è©²æ˜¯å®šç¾©ç‚º404ï¼Œé€šénoHandlerFoundç¢ºèª noHandlerFound(processedRequest, response); return; } // é€šéhandlerç²å¾—åˆé©çš„handleré©é…å™¨ HandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler()); String method = request.getMethod(); boolean isGet = "GET".equals(method); if (isGet || "HEAD".equals(method)) { // æ˜¯getæ–¹æ³•æˆ–è€…headæ–¹æ³• long lastModified = ha.getLastModified(request, mappedHandler.getHandler()); // å¦‚æœhandler æ˜¯LastModifiedé¡ï¼Œå‰‡ç²å–å…¶lastModifiedå€¼ï¼Œå¦å‰‡è¿”å›-1 // lastModify æ˜¯springæ·»åŠ äº†ç·©å­˜æ©Ÿåˆ¶ï¼Œç•¶é‡è¤‡è«‹æ±‚åŒæ¨£çš„å…§å®¹ï¼Œè¿”å›403ï¼Œè€Œä¸æœƒè¿”å›çœŸæ­£çš„å…§å®¹ï¼Œå…·é«”å¯çœ‹ä¸‹é¢çš„LastModifiedæ©Ÿåˆ¶é€™ä¸€å°ç¯€ if (logger.isDebugEnabled()) { logger.debug("Last-Modified value for [" + getRequestUri(request) + "] is: " + lastModified); } if (new ServletWebRequest(request, response).checkNotModified(lastModified) &amp;&amp; isGet) { return; } } // å‰ç½®çš„handleré è™•ç†ï¼Œå°±æ˜¯ç²å–åŸ·è¡Œéˆçš„æ””æˆªå™¨ï¼Œå°è«‹æ±‚é€²è¡Œæ””æˆªè™•ç† if (!mappedHandler.applyPreHandle(processedRequest, response)) { // å¦‚æœæ””æˆªå™¨æ””æˆªæˆåŠŸï¼Œè¿”å›falseï¼Œç›´æ¥çµæŸäº† // ç•¶ç„¶åœ¨é€™å…¶ä¸­æ””æˆªå™¨è‚¯å®šéœ€è¦ç‰¹å®šè¿”å›è‡ªèº«çš„å…§å®¹åˆ°responseä¸­ï¼Œä¾¿æ–¼å±•ç¤ºåœ¨é é¢ä¸Š // ä¸éå¾é é¢è§’åº¦å‡ºç™¼ä¸¦æ²’æœ‰éå¸¸å¯¦è³ªæ€§çš„æ””æˆªå™¨è™•ç†ï¼Œé€™é»å­˜ç–‘ï¼Ÿ return; } // çœŸæ­£çš„èª¿ç”¨å„è‡ªçš„åŸ·è¡Œæ–¹æ³•ï¼Œè¿”å›ModelAndViewå¾ŒçºŒåœ¨invokeé€™ä¸€å°ç¯€ç´°èªª mv = ha.handle(processedRequest, response, mappedHandler.getHandler()); if (asyncManager.isConcurrentHandlingStarted()) { return; } applyDefaultViewName(processedRequest, mv); // å¦‚æœmvæ²’æœ‰åŒ…å«æœ‰æ•ˆçš„è¦–åœ–ï¼Œå‰‡å¾dispatchçš„viewNameTranslatorå±¬æ€§ä¸Šç²å–å°æ‡‰çš„é»˜èªè¦–åœ– mappedHandler.applyPostHandle(processedRequest, response, mv); // æ””æˆªå™¨çš„å¾Œç½®è™•ç† } catch (Exception ex) { dispatchException = ex; } catch (Throwable err) { dispatchException = new NestedServletException("Handler dispatch failed", err); }  // åˆ°é€™è£¡äº†å¯èƒ½å­˜åœ¨ç•°å¸¸ï¼Œé¡ä¼¼çš„500è«‹æ±‚è™•ç†å°±æ˜¯åœ¨é€™è£¡å®Œæˆæ“ä½œçš„ // åŒæ™‚åŒ…å«äº†æ•¸æ“šå›å¡«åˆ°responseä¸­çš„æ“ä½œ processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException); } catch (Exception ex) { triggerAfterCompletion(processedRequest, response, mappedHandler, ex); } catch (Throwable err) { triggerAfterCompletion(processedRequest, response, mappedHandler, new NestedServletException("Handler processing failed", err)); } finally { if (asyncManager.isConcurrentHandlingStarted()) { // Instead of postHandle and afterCompletion if (mappedHandler != null) { mappedHandler.applyAfterConcurrentHandlingStarted(processedRequest, response); } } else { // Clean up any resources used by a multipart request. if (multipartRequestParsed) { cleanupMultipart(processedRequest); } } }}</pre><p><strong>ç²å–åŸ·è¡Œéˆ</strong></p><p><strong>AbstractHandlerMapping é¡</strong></p><pre>protected HandlerExecutionChain getHandler(HttpServletRequest request) throws Exception { for (HandlerMapping hm : this.handlerMappings) { // é€™å€‹handlerMappingså°±æ˜¯åœ¨æƒæURLå¾—åˆ°çš„URLå®¹å™¨ä¿¡æ¯ HandlerExecutionChain handler = hm.getHandler(request); if (handler != null) { return handler; } } return null;}</pre><p>å¦‚åœ–æ‰€ç¤ºå°±æ˜¯</p><div class=pgc-img><img alt=SpringMVC:æ¥æ”¶åˆ°è«‹æ±‚å¾Œçš„èª¿ç”¨ç´°ç¯€ï¼Œä½ æ˜¯å¦æ¸…æ¥šï¼Ÿ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/227844fc7e344bf0ab6575bb1619e2c2><p class=pgc-img-caption></p></div><h1><strong>getHandler æ–¹æ³•</strong></h1><p><strong>AbstractHandlerMapping é¡</strong></p><pre>public final HandlerExecutionChain getHandler(HttpServletRequest request) throws Exception { Object handler = getHandlerInternal(request); // èª¿ç”¨å­é¡å¯¦ç¾çš„å…·é«”æ–¹æ³•ï¼Œç²å¾—åŸ·è¡Œéˆå°è±¡ if (handler == null) { handler = getDefaultHandler(); } if (handler == null) { // åˆ°é€™è£¡æ„å‘³è‘—çœŸçš„æ‰¾ä¸åˆ°å¯ç”¨çš„åŸ·è¡Œéˆå°è±¡ return null; }  if (handler instanceof String) { String handlerName = (String) handler; handler = getApplicationContext().getBean(handlerName); } HandlerExecutionChain executionChain = getHandlerExecutionChain(handler, request); // é‡æ–°ç”Ÿæˆä¸€å€‹åŸ·è¡Œéˆå°è±¡ï¼Œå¯èƒ½æœƒå’Œhandleræ˜¯åŒä¸€å€‹å°è±¡  if (CorsUtils.isCorsRequest(request)) { // æŸ¥çœ‹requesté ­éƒ¨ä¿¡æ¯æ˜¯å¦åŒ…å«äº†Originä¿¡æ¯ï¼Œå¦‚æœæœ‰å‰‡åˆ¤æ–·æˆåŠŸ // corsè·¨åŸŸè¨­ç½® CorsConfiguration globalConfig = this.corsConfigSource.getCorsConfiguration(request); // ç²å–å…¨å±€çš„è·¨åŸŸé…ç½® CorsConfiguration handlerConfig = getCorsConfiguration(handler, request); CorsConfiguration config = (globalConfig != null ? globalConfig.combine(handlerConfig) : handlerConfig); // çµåˆç•¶å‰handlerå’Œå…¨å±€é…ç½®çµ„åˆæˆä¸€å€‹æ–°çš„è·¨åŸŸé…ç½® executionChain = getCorsHandlerExecutionChain(request, executionChain, config); // é‡æ–°ç”Ÿæˆå¯ç”¨çš„åŸ·è¡Œéˆå°è±¡ } return executionChain;}</pre><p><strong>AbstractUrlHandlerMappingé¡</strong></p><pre>protected Object getHandlerInternal(HttpServletRequest request) throws Exception { String lookupPath = getUrlPathHelper().getLookupPathForRequest(request); // å¾requestä¸­ç²å–åˆ°URLä¿¡æ¯ Object handler = lookupHandler(lookupPath, request); // å¾—åˆ°åŸ·è¡Œéˆè·¯çš„å°è±¡ï¼Œä¸€èˆ¬ç‚ºHandlerExecutionChain if (handler == null) { // å¦‚æœæ²’æœ‰æ‰¾åˆ°ï¼Œå‰‡åŒ¹é…ä¸€äº›ç‰¹æ®Šçš„è«‹æ±‚ï¼Œå„˜å¯èƒ½çš„åŒ¹é…æ¸…æ¥š Object rawHandler = null; if ("/".equals(lookupPath)) { // æ ¹è·¯å¾‘çš„handler rawHandler = getRootHandler(); } if (rawHandler == null) { // é»˜èªè·¯å¾‘çš„handler rawHandler = getDefaultHandler(); } if (rawHandler != null) { // æ ¹è·¯å¾‘æˆ–è€…é»˜èªè·¯å¾‘ä¸­çš„ä¸€å€‹ä¸ç‚ºnull if (rawHandler instanceof String) { String handlerName = (String) rawHandler; rawHandler = getApplicationContext().getBean(handlerName); } validateHandler(rawHandler, request); handler = buildPathExposingHandler(rawHandler, lookupPath, lookupPath, null); // åŒæ¨£çš„å¥—è·¯å¾—åˆ°æ–°çš„åŸ·è¡Œéˆè·¯å°è±¡ä¿¡æ¯ } } if (handler != null &amp;&amp; logger.isDebugEnabled()) { logger.debug("Mapping [" + lookupPath + "] to " + handler); // æ‰“å€‹æ—¥èªŒï¼Œè¡¨ç¤ºåŒ¹é…åˆ°äº†ç›¸é—œçš„beanä¿¡æ¯ } else if (handler == null &amp;&amp; logger.isTraceEnabled()) { logger.trace("No handler mapping found for [" + lookupPath + "]"); } return handler;}protected Object lookupHandler(String urlPath, HttpServletRequest request) throws Exception { // å¾hanlerMapä¸­ç²å–è©²URLå°æ‡‰çš„controller Object handler = this.handlerMap.get(urlPath); if (handler != null) { //  if (handler instanceof String) { String handlerName = (String) handler; handler = getApplicationContext().getBean(handlerName); } validateHandler(handler, request); return buildPathExposingHandler(handler, urlPath, urlPath, null); } // æ²’æœ‰å®Œå…¨åŒ¹é…ï¼Œæ¡å–æ¨¡ç³ŠåŒ¹é…ï¼Œæ­£å‰‡é‚„æ˜¯ï¼Ÿ // é¡Œå¤–è©±ï¼Œpythonçš„tornadoå’ŒDjangoéƒ½æ˜¯æ¡ç”¨çš„æ­£å‰‡åŒ¹é…çš„ List&lt;String&gt; matchingPatterns = new ArrayList&lt;String&gt;(); for (String registeredPattern : this.handlerMap.keySet()) { if (getPathMatcher().match(registeredPattern, urlPath)) { // getPathMatcher() è¿”å›çš„å°±æ˜¯AntPathMatcherå°è±¡ // åŒæ¨£ä¹Ÿæ˜¯æŒ‰ç…§getPathMatcherçš„åŒ¹é…è¦å‰‡å»åŒ¹é…çš„ matchingPatterns.add(registeredPattern); } else if (useTrailingSlashMatch()) { if (!registeredPattern.endsWith("/") &amp;&amp; getPathMatcher().match(registeredPattern + "/", urlPath)) { matchingPatterns.add(registeredPattern +"/"); } } } // ç¸½ä¹‹æœ€å¾Œæœƒå¾—åˆ°ä¸€å€‹listï¼ŒåŒ…å«äº†åŒ¹é…ä¸­çš„URLä¿¡æ¯ String bestMatch = null; Comparator&lt;String&gt; patternComparator = getPathMatcher().getPatternComparator(urlPath); if (!matchingPatterns.isEmpty()) { Collections.sort(matchingPatterns, patternComparator); // æ¨¡ç³ŠåŒ¹é…çš„é›†åˆä¸ç‚ºç©º,å‰‡æŒ‰ç…§urlPathå®šç¾©çš„æ’åºè¦å‰‡å»é‡æ’åº if (logger.isDebugEnabled()) { logger.debug("Matching patterns for request [" + urlPath + "] are " + matchingPatterns); } bestMatch = matchingPatterns.get(0); // ç¬¬ä¸€å€‹æ˜¯æœ€ä½³çš„åŒ¹é…è·¯å¾‘ } if (bestMatch != null) { // æ¥ä¸‹ä¾†çš„ä¸€åˆ‡éƒ½æ˜¯ä¾ç…§é€™å€‹bestMatchä¸ç‚ºnullï¼Œå¦å‰‡å°±ç›´æ¥è¿”å›nullï¼Œè¡¨ç¤ºæ²’æœ‰åˆé©çš„åŒ¹é…handler handler = this.handlerMap.get(bestMatch); if (handler == null) { // å¦‚æœå®¹å™¨ä¸­ä¸å­˜åœ¨è©²handler if (bestMatch.endsWith("/")) { handler = this.handlerMap.get(bestMatch.substring(0, bestMatch.length() - 1)); } // å°æœ€ä½³çš„URLè·¯å¾‘è™•ç†ä¹‹å¾Œï¼Œé‚„æ˜¯ä¸åœ¨å°æ‡‰çš„handlerï¼Œå‰‡æç¤ºæ²’æœ‰å…·é«”çš„handlerä¿¡æ¯ if (handler == null) { throw new IllegalStateException( "Could not find handler for best pattern match [" + bestMatch + "]"); } } // åŒ…å«äº†å°æ‡‰çš„handlerä¿¡æ¯äº† if (handler instanceof String) { String handlerName = (String) handler; handler = getApplicationContext().getBean(handlerName); // å¦‚æœæ˜¯stringï¼Œå‰‡é€šéspringçš„å®¹å™¨ç²å–å°æ‡‰çš„beanï¼ˆä¸€èˆ¬æ˜¯controllerï¼‰ } validateHandler(handler, request); String pathWithinMapping = getPathMatcher().extractPathWithinPattern(bestMatch, urlPath); //  Map&lt;String, String&gt; uriTemplateVariables = new LinkedHashMap&lt;String, String&gt;(); for (String matchingPattern : matchingPatterns) { if (patternComparator.compare(bestMatch, matchingPattern) == 0) { Map&lt;String, String&gt; vars = getPathMatcher().extractUriTemplateVariables(matchingPattern, urlPath); Map&lt;String, String&gt; decodedVars = getUrlPathHelper().decodePathVariables(request, vars); uriTemplateVariables.putAll(decodedVars); } } if (logger.isDebugEnabled()) { logger.debug("URI Template variables for request [" + urlPath + "] are " + uriTemplateVariables); }  // ç”ŸæˆåŸ·è¡Œéˆè·¯å°è±¡HandlerExecutionChain return buildPathExposingHandler(handler, bestMatch, pathWithinMapping, uriTemplateVariables); } // ä»€éº¼éƒ½æ²’æœ‰ç™¼ç¾ï¼Œè¿”å›null return null;}protected Object buildPathExposingHandler(Object rawHandler, String bestMatchingPattern, String pathWithinMapping, Map&lt;String, String&gt; uriTemplateVariables) { HandlerExecutionChain chain = new HandlerExecutionChain(rawHandler); // å‰µå»ºåŸ·è¡Œéˆè·¯çš„å°è±¡chain chain.addInterceptor(new PathExposingHandlerInterceptor(bestMatchingPattern, pathWithinMapping)); // æ·»åŠ PathExposingHandlerInterceptoræ””æˆªå™¨ if (!CollectionUtils.isEmpty(uriTemplateVariables)) { chain.addInterceptor(new UriTemplateVariablesHandlerInterceptor(uriTemplateVariables)); } return chain;}</pre><p>å¦‚åœ–å°±æ˜¯èª¿ç”¨buildPathExposingHandlerä¹‹å¾Œè¿”å›çš„åŸ·è¡Œéˆå°è±¡chain</p><div class=pgc-img><img alt=SpringMVC:æ¥æ”¶åˆ°è«‹æ±‚å¾Œçš„èª¿ç”¨ç´°ç¯€ï¼Œä½ æ˜¯å¦æ¸…æ¥šï¼Ÿ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/135a93bb7565473188e45f438fccab3a><p class=pgc-img-caption></p></div><h1><strong>404ç‹€æ…‹ç¢¼</strong></h1><p>åœ¨æ²’æ‰¾åˆ°åˆé©çš„handleråŸ·è¡Œéˆçš„æ™‚å€™ï¼Œå°±æœƒé€²å…¥è©²æ–¹æ³•ï¼ˆå…¶å¯¦å°±æ˜¯404äº†ï¼‰</p><pre>protected void noHandlerFound(HttpServletRequest request, HttpServletResponse response) throws Exception { if (pageNotFoundLogger.isWarnEnabled()) { // é¡ä¼¼é€™ç¨®ä»£ç¢¼å…¶å¯¦æ˜¯ç‚ºäº†é©é…ä¸åŒçš„æ—¥èªŒç³»çµ± pageNotFoundLogger.warn("No mapping found for HTTP request with URI [" + getRequestUri(request) + "] in DispatcherServlet with name '" + getServletName() + "'"); } if (this.throwExceptionIfNoHandlerFound) { throw new NoHandlerFoundException(request.getMethod(), getRequestUri(request), new ServletServerHttpRequest(request).getHeaders()); } else { // HttpServletResponse.SC_NOT_FOUND å°±æ˜¯404 // èª¿ç”¨çš„æ˜¯Tomcatæœ¬èº«çš„404è¨­ç½®é é¢è¿”å›çš„ï¼Œå¯ä»¥åœ¨web.xml ä¸­é…ç½®è‡ªå®šç¾©çš„404é é¢ response.sendError(HttpServletResponse.SC_NOT_FOUND); }}</pre><p>å¦‚åœ–å°±æ˜¯æ¡ç”¨äº†jdk14Loggeræ‰“å°å‡ºä¾†çš„æ•¸æ“šï¼Œç•¶ç„¶äº†ç¾å¯¦é …ç›®ä¸­æ›´å¤šçš„æ‡‰ç”¨log4jã€log4j2</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=SpringMVC:æ¥æ”¶åˆ°è«‹æ±‚å¾Œçš„èª¿ç”¨ç´°ç¯€ï¼Œä½ æ˜¯å¦æ¸…æ¥šï¼Ÿ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5d11f176602b442d864f7d0184eba4dd><p class=pgc-img-caption></p></div><h1><strong>ç²å–é©é…å™¨</strong></h1><pre>protected HandlerAdapter getHandlerAdapter(Object handler) throws ServletException { for (HandlerAdapter ha : this.handlerAdapters) { // handlerAdaptersçš„å€¼å°±æ˜¯åœ¨initStrategies()æ–¹æ³•ä¸­ç²å–åˆ°çš„ // é»˜èªçš„é©é…å™¨æ˜¯ä¸‰å€‹  // org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter // org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter // org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter // å¦‚æœç´°çœ‹é©é…å™¨çš„åˆå§‹åŒ–éç¨‹æœƒç™¼ç¾ï¼Œspringæœƒå„ªå…ˆç²å–ç”¨æˆ¶è‡ªå®šç¾©çš„é©é…å™¨ï¼Œå¦‚æœæ²’æœ‰æ‰æœƒé»˜èªä½¿ç”¨é€™ä¸‰å€‹é©é…å™¨ if (ha.supports(handler)) { return ha; } } throw new ServletException("No adapter for handler [" + handler + "]: The DispatcherServlet configuration needs to include a HandlerAdapter that supports this handler"); // å¸¸å‡ºç¾çš„æ²’æœ‰æ‰¾åˆ°é©é…å™¨çš„å ±éŒ¯çš„åœ°æ–¹å°±æ˜¯é€™è£¡ï¼Œéæ­·äº†æ‰€æœ‰çš„é©é…å™¨ä¸¦æ²’æœ‰ç¬¦åˆhandlerçš„é©é…å™¨ï¼Œå‰‡æç¤ºæ²’æœ‰é©é…å™¨}</pre><p>æ¥ä¸‹ä¾†çœ‹çœ‹ä¸‰ç¨®é©é…å™¨åˆ°åº•æ˜¯å¦‚ä½•åˆ¤æ–·å°è±¡æ˜¯ç¬¦åˆè‡ªèº«çš„è¦æ±‚çš„</p><p><strong>HttpRequestHandlerAdapter</strong></p><pre>@Overridepublic boolean supports(Object handler) { return (handler instanceof HttpRequestHandler); // æ˜¯å¦æ˜¯HttpRequestHandlerå°è±¡}</pre><p><strong>SimpleControllerHandlerAdapter</strong></p><pre>@Overridepublic boolean supports(Object handler) { return (handler instanceof Controller); // æ˜¯å¦æ˜¯Controllerå°è±¡}</pre><p><strong>AnnotationMethodHandlerAdapter</strong></p><pre>@Overridepublic boolean supports(Object handler) { return getMethodResolver(handler).hasHandlerMethods(); // ç²å–åˆ°æ–¹æ³•è™•ç†å™¨ï¼Œå†åˆ¤æ–·å…¶æ˜¯å¦ç‚ºç©º}private ServletHandlerMethodResolver getMethodResolver(Object handler) { Class&lt;?&gt; handlerClass = ClassUtils.getUserClass(handler); ServletHandlerMethodResolver resolver = this.methodResolverCache.get(handlerClass); if (resolver == null) { synchronized (this.methodResolverCache) { resolver = this.methodResolverCache.get(handlerClass); if (resolver == null) { resolver = new ServletHandlerMethodResolver(handlerClass); this.methodResolverCache.put(handlerClass, resolver); } } } return resolver;}</pre><h1><strong>LastModified æ©Ÿåˆ¶</strong></h1><p>çµ„åˆæˆç‚ºä¸€å€‹ServletWebRequestå°è±¡å¾Œå°±èª¿ç”¨è©²æ–¹æ³•ï¼Œç¢ºèªlastModified</p><pre>public boolean checkNotModified(String etag, long lastModifiedTimestamp) { HttpServletResponse response = getResponse(); if (this.notModified || !isStatusOK(response)) { // ä¸éœ€è¦modifiedæ©Ÿåˆ¶æˆ–è€… responseç‚ºnullæˆ–è€…ç„¡æ•ˆæ›´æˆ–è€…ç‹€æ…‹ç¢¼ä¸æ˜¯200 return this.notModified; } if (validateIfUnmodifiedSince(lastModifiedTimestamp)) { // å…¶å°è±¡æœƒå­˜å„²è©²è«‹æ±‚çš„æ™‚é–“ï¼Œé©—è­‰æ˜¯å¦ç¬¦åˆlastModifiedçš„æ¢ä»¶ if (this.notModified) { response.setStatus(HttpStatus.PRECONDITION_FAILED.value()); } return this.notModified; } boolean validated = validateIfNoneMatch(etag); // é»˜èªå‚³éä¾†çš„etagæ˜¯nullï¼Œè¿”å›false if (!validated) { validateIfModifiedSince(lastModifiedTimestamp); // çœ‹æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡ä¾†ï¼Œå¦‚æœæ˜¯å°±éœ€è¦åˆ·æ–°å…¶æ™‚é–“ } boolean isHttpGetOrHead = SAFE_METHODS.contains(getRequest().getMethod()); // æ˜¯å¦ç‚ºgetæˆ–è€…headè«‹æ±‚ï¼Œä¸¦ä¸”è®Šæ›´responseçš„é ­ä¿¡æ¯ if (this.notModified) { response.setStatus(isHttpGetOrHead ? HttpStatus.NOT_MODIFIED.value() : HttpStatus.PRECONDITION_FAILED.value()); } if (isHttpGetOrHead) { if(lastModifiedTimestamp &gt; 0 &amp;&amp; isHeaderAbsent(response, LAST_MODIFIED)) { response.setDateHeader(LAST_MODIFIED, lastModifiedTimestamp); } if (StringUtils.hasLength(etag) &amp;&amp; isHeaderAbsent(response, ETAG)) { response.setHeader(ETAG, padEtagIfNecessary(etag)); } } // å¦‚æœç¬¦åˆå…¶æ©Ÿåˆ¶ï¼Œå°±è¿”å›trueï¼Œå¦å‰‡è¿”å›false return this.notModified;}</pre><p><strong>invokeèª¿ç”¨</strong></p><p>åªæ˜¯å–äº†é€™éº¼å€‹åå­—ï¼Œåœ¨ç²å–åˆ°äº†åˆé©çš„åŸ·è¡Œéˆï¼Œæœ‰äº†åˆé©çš„é©é…å™¨ï¼Œæœ‰æ²’æœ‰è¢«æ””æˆªå™¨è™•ç†ï¼Œæœ€å¾Œä¾†åˆ°äº†çœŸæ­£èª¿ç”¨æ–¹æ³•çš„åœ°æ–¹äº†ã€‚</p><p>ä¸Šæ–‡å¯çŸ¥ï¼Œé€™æ˜¯ç”±å„è‡ªçš„é©é…å™¨èª¿ç”¨handleræ–¹æ³•ä¾†ç²å–çœŸæ­£çš„å…§å®¹äº†ã€‚</p><p>åœ¨æ²’çœ‹æºç¢¼å‰ï¼Œå…¶å¯¦æˆ‘å€‘æ‡‰è©²èƒ½å¤ çŒœåˆ°ä¸€äº›ç´°ç¯€ï¼Œä¾‹å¦‚</p><ul><li>ä¸Šé¢èªªçš„beançš„nameæ˜¯\é–‹é ­çš„è¢«SimpleControllerHandlerAdapterå‘½ä¸­ï¼Œå¯æ˜¯åœ¨è©²æ–¹æ³•ä¸­ä¸¦æ²’æœ‰æ˜ç¢ºå®šç¾©åŸ·è¡Œçš„æ–¹æ³•ï¼Œæ‰€ä»¥controlleræ¥å£å¿…é ˆæœ‰ä¸€äº›æ–¹æ³•è¦è¢«å¯¦ç¾ï¼Œç„¶å¾Œç”±é©é…å™¨èª¿ç”¨å¯¦ç¾é¡é”åˆ°ç²å–å…§å®¹çš„ç›®çš„</li><li>æ™®é€šçš„åŠ äº†requestMappingè¢«AnnotationMethodHandlerAdapterå‘½ä¸­ï¼Œå‰‡æ‡‰è©²æ˜¯é€šéåå°„ç²å–æ‰€æœ‰çš„å¯è¡Œçš„æ–¹æ³•ï¼Œç„¶å¾Œä¾æ¬¡ç¯©é¸ï¼Œç›´åˆ°åŒ¹é…ä¸Šäº†åˆé©çš„æ–¹æ³•ï¼Œå†invokeèª¿ç”¨è¿”å›å…¶å…§å®¹</li></ul><p><strong>SimpleControllerHandlerAdapter</strong></p><p>HttpRequestHandlerAdapterå’ŒSimpleControllerHandlerAdapteræ˜¯ä¸€æ¨£çš„ï¼Œå°±åªè§£é‡‹ä¸€ç¨®äº†ã€‚</p><pre>public ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { return ((Controller) handler).handleRequest(request, response); // æœç„¶ä¸å‡ºæˆ‘å€‘æœŸæœ›çš„ï¼Œå°±æ˜¯controlleræ¥å£å¯¦ç¾çš„æ–¹æ³•handleRequestå»å®ŒæˆçœŸæ­£çš„èª¿ç”¨ // å¦‚ä¸‹é¢çš„demoï¼Œå°±æ˜¯èª¿ç”¨è©²æ–¹æ³•ï¼Œä¸éæ­¤æ–¹æ³•æ„å‘³è‘—ä¸€å€‹é¡åªæœ‰ä¸€å€‹URLæ˜ å°„ // ä¸åƒè¨»è§£é‚£æ¨£ä¸€å€‹é¡ä¸­å¯ä»¥åŒ…å«å¤šç¨®URLæ˜ å°„}public class NameController implements Controller { @Override public ModelAndView handleRequest(HttpServletRequest request, HttpServletResponse response) throws Exception { ModelAndView modelAndView=new ModelAndView(); modelAndView.setViewName("/page/404"); return modelAndView; }}</pre><p><strong>AnnotationMethodHandlerAdapter</strong></p><pre>public ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { Class&lt;?&gt; clazz = ClassUtils.getUserClass(handler); Boolean annotatedWithSessionAttributes = this.sessionAnnotatedClassesCache.get(clazz); if (annotatedWithSessionAttributes == null) { annotatedWithSessionAttributes = (AnnotationUtils.findAnnotation(clazz, SessionAttributes.class) != null); this.sessionAnnotatedClassesCache.put(clazz, annotatedWithSessionAttributes); }  if (annotatedWithSessionAttributes) { checkAndPrepare(request, response, this.cacheSecondsForSessionAttributeHandlers, true); } else { checkAndPrepare(request, response, true); } if (this.synchronizeOnSession) { HttpSession session = request.getSession(false); if (session != null) { Object mutex = WebUtils.getSessionMutex(session); synchronized (mutex) { return invokeHandlerMethod(request, response, handler); } } } // å‰é¢å„ç¨®æ“ä½œä¾†åˆ°äº†inVokeMethod return invokeHandlerMethod(request, response, handler);}protected ModelAndView invokeHandlerMethod(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { ServletHandlerMethodResolver methodResolver = getMethodResolver(handler); Method handlerMethod = methodResolver.resolveHandlerMethod(request); // è™•ç†requestï¼Œå¾—åˆ°å°æ‡‰çš„éœ€è¦è¢«åŸ·è¡Œçš„æ–¹æ³• // åœ¨é€™å€‹å‡½æ•¸ä¸­é‚„æœ‰é¡URLè¨»è§£ä¿¡æ¯å’Œæ–¹æ³•è¨»è§£ä¿¡æ¯çš„æ‹¼æ¥åŒ¹é…éç¨‹ // è¿”å›çš„å°è±¡å°±æ˜¯ä¸€å€‹Methodå°è±¡ ServletHandlerMethodInvoker methodInvoker = new ServletHandlerMethodInvoker(methodResolver); ServletWebRequest webRequest = new ServletWebRequest(request, response); ExtendedModelMap implicitModel = new BindingAwareModelMap(); Object result = methodInvoker.invokeHandlerMethod(handlerMethod, handler, webRequest, implicitModel); // é€™å€‹æ˜¯çœŸæ­£çš„èª¿ç”¨éç¨‹ï¼Œå…¶ä¸­é‚„åŒ…å«äº†è«‹æ±‚åƒæ•¸çš„è™•ç†ç­‰å„ç¨®éç¨‹ // è¿”å›çš„çµæœå¯ä»¥æ˜¯å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ˜¯mvï¼Œçœ‹å…·é«”çš„æ–¹æ³•æ˜¯å¦‚ä½•å¯¦ç¾çš„ ModelAndView mav = methodInvoker.getModelAndView(handlerMethod, handler.getClass(), result, implicitModel, webRequest); // ç²å–å…·é«”çš„è¦–åœ–é¡ï¼Œå¦‚æœæ˜¯å…·é«”æ¥­å‹™è¿”å›ï¼Œè¦–åœ–ç‚ºnullï¼Œå…·é«”çš„æ•¸æ“šå·²ç¶“é€šéresponseçš„bodyå›å¡«è¿”å›äº† methodInvoker.updateModelAttributes(handler, (mav != null ? mav.getModel() : null), implicitModel, webRequest); // è¦–åœ–å±¬æ€§æ›´æ–° return mav;}</pre><p class=ql-align-center><br></p><div class=pgc-img><img alt=SpringMVC:æ¥æ”¶åˆ°è«‹æ±‚å¾Œçš„èª¿ç”¨ç´°ç¯€ï¼Œä½ æ˜¯å¦æ¸…æ¥šï¼Ÿ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/2205336a8e1a4cfe8ee0f14626feb2e9><p class=pgc-img-caption></p></div><pre>public ModelAndView getModelAndView(Method handlerMethod, Class&lt;?&gt; handlerType, Object returnValue, ExtendedModelMap implicitModel, ServletWebRequest webRequest) throws Exception { ResponseStatus responseStatus = AnnotatedElementUtils.findMergedAnnotation(handlerMethod, ResponseStatus.class); // æŸ¥çœ‹è©²æ–¹æ³•æ˜¯å¦åŠ äº†ResponseStatusè¨»è§£ï¼Œä¸»è¦æ˜¯ç‚ºäº†æ›¿æ›ç‹€æ…‹ç¢¼ if (responseStatus != null) { HttpStatus statusCode = responseStatus.code(); String reason = responseStatus.reason(); // è©²åŸ·è¡Œæ–¹æ³•å­˜åœ¨è©²ResponseStatusçš„è¨»è§£ï¼Œç²å–ç‹€æ…‹ç¢¼å’ŒåŸå›  // ä¸éè©²å…·é«”ä½¿ç”¨çš„æ™‚å€™ï¼Œåªèƒ½æ˜¯HttpStatusæšèˆ‰é¡ä¸­çš„é¸é …ï¼Œé»˜èªæ˜¯500éŒ¯èª¤ if (!StringUtils.hasText(reason)) { // æ²’æœ‰å…·é«”åŸå› ï¼Œå°±åªè¨­ç½®ç‹€æ…‹ç¢¼ï¼Œå¦å‰‡å°±è¿”å›éŒ¯èª¤ç¢¼ webRequest.getResponse().setStatus(statusCode.value()); } else { webRequest.getResponse().sendError(statusCode.value(), reason); } // è¨­ç½®ç•¶å‰çš„è«‹æ±‚å±¬æ€§ï¼Œåå­—ç‚ºæ¨¡æ¿å’Œç‹€æ…‹ï¼Œå€¼å°±æ˜¯ç‹€æ…‹ç¢¼ webRequest.getRequest().setAttribute(View.RESPONSE_STATUS_ATTRIBUTE, statusCode); this.responseArgumentUsed = true; } // å¦‚æœå­˜åœ¨è‡ªå®šç¾©çš„ModelAndViewè§£æ if (customModelAndViewResolvers != null) { for (ModelAndViewResolver mavResolver : customModelAndViewResolvers) { ModelAndView mav = mavResolver.resolveModelAndView( handlerMethod, handlerType, returnValue, implicitModel, webRequest); // éæ­·è‡ªå®šç¾©ModelAndViewè§£æå™¨ï¼Œé¸æ“‡åˆé©çš„mvï¼Œä¸¦ä¸”ä¸æ˜¯åˆå§‹åŒ–çš„è¦–åœ–é¡ // é€™å€‹æ˜¯ç”±ç”¨æˆ¶è‡ªå®šç¾©çš„å¯¦ç¾é¡ï¼Œä¸¦ä¸”åˆ‡è¨˜è¨˜å¾—é©é…å™¨çš„è¨­ç½®ï¼Œåˆ¥æ²’å¼„å¥½å°è‡´ç„¡åˆé©çš„é©é…å™¨çš„éŒ¯èª¤ // ModelAndView UNRESOLVED = new ModelAndView(); if (mav != ModelAndViewResolver.UNRESOLVED) { return mav; } } }  // è¿”å›çš„é¡å‹æ˜¯HttpEntityã€stringã€ModelAndViewã€Modelã€Viewã€Map if (returnValue instanceof HttpEntity) { // è¿”å›å€¼æ˜¯HttpEntityé¡å‹çš„æ•¸æ“šï¼Œä¸éœ€è¦åˆé©çš„è¦–åœ– // æ›´å¤šçš„æ˜¯è¿”å›jsonæ•¸æ“š handleHttpEntityResponse((HttpEntity&lt;?&gt;) returnValue, webRequest); return null; } else if (AnnotationUtils.findAnnotation(handlerMethod, ResponseBody.class) != null) { // æ–¹æ³•åŒ…å«äº†ResponseBodyè¨»è§£ï¼Œç›´æ¥æŠŠreturnValue å¡å…¥response handleResponseBody(returnValue, webRequest); return null; } else if (returnValue instanceof ModelAndView) { ModelAndView mav = (ModelAndView) returnValue; mav.getModelMap().mergeAttributes(implicitModel); return mav; } else if (returnValue instanceof Model) { return new ModelAndView().addAllObjects(implicitModel).addAllObjects(((Model) returnValue).asMap()); } else if (returnValue instanceof View) { return new ModelAndView((View) returnValue).addAllObjects(implicitModel); } else if (AnnotationUtils.findAnnotation(handlerMethod, ModelAttribute.class) != null) { addReturnValueAsModelAttribute(handlerMethod, handlerType, returnValue, implicitModel); return new ModelAndView().addAllObjects(implicitModel); } else if (returnValue instanceof Map) { return new ModelAndView().addAllObjects(implicitModel).addAllObjects((Map&lt;String, ?&gt;) returnValue); } else if (returnValue instanceof String) { return new ModelAndView((String) returnValue).addAllObjects(implicitModel); } else if (returnValue == null) { // Either returned null or was 'void' return. if (this.responseArgumentUsed || webRequest.isNotModified()) { return null; } else { // Assuming view name translation... return new ModelAndView().addAllObjects(implicitModel); } } else if (!BeanUtils.isSimpleProperty(returnValue.getClass())) { // Assume a single model attribute... addReturnValueAsModelAttribute(handlerMethod, handlerType, returnValue, implicitModel); return new ModelAndView().addAllObjects(implicitModel); } else { throw new IllegalArgumentException("Invalid handler method return value: " + returnValue); } }</pre><p>åœ¨é€™å…¶ä¸­çš„ä»£ç¢¼å¿«customModelAndViewResolversï¼Œæ›´å¤šçš„ç´°ç¯€å¯ä»¥çœ‹çœ‹Spring Controllerå±¤è¨˜éŒ„æ—¥èªŒé…ç½®çš„å¯¦è¸demo</p><h1><strong>è¦–åœ–æ¸²æŸ“</strong></h1><pre>private void processDispatchResult(HttpServletRequest request, HttpServletResponse response, HandlerExecutionChain mappedHandler, ModelAndView mv, Exception exception) throws Exception { boolean errorView = false; if (exception != null) { // æœ‰ç•°å¸¸ï¼Œä¸èƒ½æ­£å¸¸é¡¯ç¤ºè«‹æ±‚å…§å®¹äº† if (exception instanceof ModelAndViewDefiningException) { logger.debug("ModelAndViewDefiningException encountered", exception); mv = ((ModelAndViewDefiningException) exception).getModelAndView(); } else { Object handler = (mappedHandler != null ? mappedHandler.getHandler() : null); mv = processHandlerException(request, response, handler, exception); // ç•°å¸¸è™•ç†è¿”å›çš„mvï¼Œç•°å¸¸mvé…ç½®å­˜æ”¾åœ¨handlerExceptionResolvers errorView = (mv != null); } } // æœ‰å¯ç”¨çš„mv if (mv != null &amp;&amp; !mv.wasCleared()) { render(mv, request, response); // renderå°±æ˜¯æ¸²æŸ“ï¼Œå›å¡«æ•¸æ“šåˆ°responseä¸­å» if (errorView) { // å¦‚æœæœ‰éModelAndViewDefiningExceptionï¼Œå‰‡æ¸…é™¤è«‹æ±‚çš„å±¬æ€§ä¿¡æ¯ WebUtils.clearErrorRequestAttributes(request); } } else { // æ²’æœ‰å¯ç”¨çš„è¦–åœ–ä¿¡æ¯ if (WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) { // Concurrent handling started during a forward return; } if (mappedHandler != null) { mappedHandler.triggerAfterCompletion(request, response, null); }}</pre><p><strong>æ¸²æŸ“render</strong></p><pre>protected void render(ModelAndView mv, HttpServletRequest request, HttpServletResponse response) throws Exception { // Determine locale for request and apply it to the response. Locale locale = this.localeResolver.resolveLocale(request); response.setLocale(locale); View view; if (mv.isReference()) { // mvçš„è¦–åœ–åå­—æ˜¯stringé¡å‹ï¼Œå‰‡éœ€è¦æ‰¾åˆ°çœŸæ­£çš„è¦–åœ– // éœ€è¦ä½¿ç”¨åˆ°localå­—æ®µä¿¡æ¯ view = resolveViewName(mv.getViewName(), mv.getModelInternal(), locale, request); if (view == null) { // æ²’æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„è¦–åœ–ï¼Œå ±éŒ¯æç¤º throw new ServletException("Could not resolve view with name '" + mv.getViewName() + "' in servlet with name '" + getServletName() + "'"); } } else { // å¦å‰‡å°±è¢«èªç‚ºæ˜¯Viewå°è±¡ï¼Œç›´æ¥ç²å–å°±å¯ä»¥äº† view = mv.getView(); if (view == null) { throw new ServletException("ModelAndView [" + mv + "] neither contains a view name nor a " + "View object in servlet with name '" + getServletName() + "'"); } } // Delegate to the View object for rendering. if (logger.isDebugEnabled()) { logger.debug("Rendering view [" + view + "] in DispatcherServlet with name '" + getServletName() + "'"); } try { if (mv.getStatus() != null) { // å¾mvä¸­ç²å–httpç‹€æ…‹ç¢¼ response.setStatus(mv.getStatus().value()); } // ä¾†åˆ°äº†çœŸæ­£çš„æ¸²æŸ“ï¼Œæ‰€æœ‰çš„æ•¸æ“šå·²ç¶“æº–å‚™å°±ç·’ view.render(mv.getModelInternal(), request, response); } catch (Exception ex) { if (logger.isDebugEnabled()) { logger.debug("Error rendering view [" + view + "] in DispatcherServlet with name '" + getServletName() + "'", ex); } throw ex; }}</pre><p>å…¶ä¸­çš„resolve</p><h1><strong>View æ¸²æŸ“</strong></h1><p>Viewæœ¬èº«æ˜¯ä¸€å€‹æ¥å£é¡ï¼Œspringæ ¹æ“šä¸åŒçš„æ¥­å‹™å¯¦ç¾äº†å¤šå€‹ä¸åŒçš„Viewå¯¦é«”é¡ï¼ŒåŒ…å«äº†htmlã€pdfã€Excelç­‰ã€‚</p><p><strong>AbstractView æŠ½è±¡è¦–åœ–é¡</strong></p><pre>public void render(Map&lt;String, ?&gt; model, HttpServletRequest request, HttpServletResponse response) throws Exception { Map&lt;String, Object&gt; mergedModel = createMergedOutputModel(model, request, response); prepareResponse(request, response); renderMergedOutputModel(mergedModel, getRequestToExpose(request), response);}</pre><p>ç”±å„è‡ªçš„å­é¡å»å¯¦ç¾renderMergedOutputModelæ–¹æ³•</p><div class=pgc-img><img alt=SpringMVC:æ¥æ”¶åˆ°è«‹æ±‚å¾Œçš„èª¿ç”¨ç´°ç¯€ï¼Œä½ æ˜¯å¦æ¸…æ¥šï¼Ÿ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/b643785ca8f8407eb0521cdde4f2c4f4><p class=pgc-img-caption></p></div><h1 class=ql-align-center><strong>åŸå‰µæ¨è–¦</strong></h1><p class=ql-align-center><a class=pgc-link data-content=mp href="https://www.toutiao.com/i6714635036563341838/?group_id=6714635036563341838" target=_blank>ã€Œç³»åˆ—æ•™ç¨‹ã€æ‰‹å¯«RPCæ¡†æ¶(1)ï¼Œçœ‹çœ‹100å€‹ç·šç¨‹åŒæ™‚èª¿ç”¨æƒ…æ³å¦‚ä½•</a></p><p class=ql-align-center><a class=pgc-link data-content=mp href="https://www.toutiao.com/i6711984615948550670/?group_id=6711984615948550670" target=_blank>ã€Œé¢è©¦ã€new String("abc")å’Œ"abc"æœ‰ä»€éº¼å€åˆ¥ï¼Ÿåç·¨è­¯çœ‹çœ‹åŸç†å§</a></p><p class=ql-align-center><a class=pgc-link data-content=mp href="https://www.toutiao.com/i6721928402791563783/?group_id=6721928402791563783" target=_blank>é¢è©¦ï¼šä½ æ˜¯å¦ç­è§£Spring BeanPostProcessorçš„åŸç†å’Œå…·é«”ä½¿ç”¨å ´æ™¯</a></p><p class=ql-align-center><a class=pgc-link data-content=mp href="https://www.toutiao.com/i6716039801792889348/?group_id=6716039801792889348" target=_blank>ã€ŒSpringæºç¢¼ã€XMLè§£æBeanDefinitionåŸç†å­¸ç¿’</a></p><p class=ql-align-center><a class=pgc-link data-content=mp href="https://www.toutiao.com/i6722403219303039501/?group_id=6722403219303039501" target=_blank>å¾Tomcatå…¥å£ç­è§£Spring MVCçš„è«‹æ±‚è™•ç†æµç¨‹</a></p><p class=ql-align-center><a class=pgc-link data-content=mp href="https://www.toutiao.com/i6711319178290135566/?group_id=6711319178290135566" target=_blank>ã€ŒSpringæºç¢¼ã€æ·±å…¥å­¸ç¿’äº‹ä»¶é€šçŸ¥æ©Ÿåˆ¶</a></p><p class=ql-align-center><a class=pgc-link data-content=mp href="https://www.toutiao.com/i6723792776560902670/?group_id=6723792776560902670" target=_blank>SpringåŸç†ï¼š10å€‹Spring&SpringBooté«˜éšç”¨æ³•ï¼Œä½ æ˜¯å¦æ¸…æ¥šï¼Ÿ</a></p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>SpringMVC</a></li><li><a>è«‹æ±‚</a></li><li><a>èª¿ç”¨</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/71debf3a.html alt=å¦‚ä½•å¾è«‹æ±‚ã€å‚³è¼¸ã€æ¸²æŸ“3å€‹æ–¹é¢æå‡Webå‰ç«¯æ€§èƒ½ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ec3175fa2700484eac030574b8369e79 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/71debf3a.html title=å¦‚ä½•å¾è«‹æ±‚ã€å‚³è¼¸ã€æ¸²æŸ“3å€‹æ–¹é¢æå‡Webå‰ç«¯æ€§èƒ½>å¦‚ä½•å¾è«‹æ±‚ã€å‚³è¼¸ã€æ¸²æŸ“3å€‹æ–¹é¢æå‡Webå‰ç«¯æ€§èƒ½</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0f8e9216.html alt=å¯«å€‹æ—¥èªŒè«‹æ±‚åˆ‡é¢ï¼Œå‰å¾Œç«¯ç”©é‹æ›´æ–¹ä¾¿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/9ee016d0-a9b0-43a8-95a8-2d6d7b5e7e21 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0f8e9216.html title=å¯«å€‹æ—¥èªŒè«‹æ±‚åˆ‡é¢ï¼Œå‰å¾Œç«¯ç”©é‹æ›´æ–¹ä¾¿>å¯«å€‹æ—¥èªŒè«‹æ±‚åˆ‡é¢ï¼Œå‰å¾Œç«¯ç”©é‹æ›´æ–¹ä¾¿</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1ce29ef6.html alt=VBAä»£ç¢¼ä¸­ï¼Œå¦‚ä½•èª¿ç”¨å…§ç½®å°è©±æ¡†ï¼Œé€²è¡Œäººæ©Ÿå°è©±çš„äº¤æµ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8d3b2fcede384accac9f17404e14d9a6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1ce29ef6.html title=VBAä»£ç¢¼ä¸­ï¼Œå¦‚ä½•èª¿ç”¨å…§ç½®å°è©±æ¡†ï¼Œé€²è¡Œäººæ©Ÿå°è©±çš„äº¤æµ>VBAä»£ç¢¼ä¸­ï¼Œå¦‚ä½•èª¿ç”¨å…§ç½®å°è©±æ¡†ï¼Œé€²è¡Œäººæ©Ÿå°è©±çš„äº¤æµ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8f9be60b.html alt=ä½¿ç”¨OpenFileDialogèª¿ç”¨æ‰“é–‹å°è©±æ¡† class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/b9c74182-1a53-488a-8f6e-e1f7d5d72656 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8f9be60b.html title=ä½¿ç”¨OpenFileDialogèª¿ç”¨æ‰“é–‹å°è©±æ¡†>ä½¿ç”¨OpenFileDialogèª¿ç”¨æ‰“é–‹å°è©±æ¡†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8eb8d179.html alt="å¦‚ä½•åœ¨èª¿ç”¨Marketing Cloud contactå‰µå»ºAPIæ™‚å¢åŠ å°æ“´å±•å­—æ®µæ”¯æŒ" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/09722e849c274476a14efb0ec482d174 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8eb8d179.html title="å¦‚ä½•åœ¨èª¿ç”¨Marketing Cloud contactå‰µå»ºAPIæ™‚å¢åŠ å°æ“´å±•å­—æ®µæ”¯æŒ">å¦‚ä½•åœ¨èª¿ç”¨Marketing Cloud contactå‰µå»ºAPIæ™‚å¢åŠ å°æ“´å±•å­—æ®µæ”¯æŒ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2b39a9d6.html alt=Cï½œå‡½æ•¸èª¿ç”¨èˆ‡åƒæ•¸ï¼ˆå½¢åƒèˆ‡å¯¦åƒï¼‰å‚³éï¼ˆå‚³å€¼èˆ‡å‚³å€ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/31e90001a36edcf8dfa2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2b39a9d6.html title=Cï½œå‡½æ•¸èª¿ç”¨èˆ‡åƒæ•¸ï¼ˆå½¢åƒèˆ‡å¯¦åƒï¼‰å‚³éï¼ˆå‚³å€¼èˆ‡å‚³å€ï¼‰>Cï½œå‡½æ•¸èª¿ç”¨èˆ‡åƒæ•¸ï¼ˆå½¢åƒèˆ‡å¯¦åƒï¼‰å‚³éï¼ˆå‚³å€¼èˆ‡å‚³å€ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4ca8329c.html alt=CORSâ€”â€”è·¨åŸŸè«‹æ±‚é‚£äº›äº‹å…’ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/382fe92652924d74afe3f3ee787c9042 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4ca8329c.html title=CORSâ€”â€”è·¨åŸŸè«‹æ±‚é‚£äº›äº‹å…’>CORSâ€”â€”è·¨åŸŸè«‹æ±‚é‚£äº›äº‹å…’</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/86d72690.html alt="HTTPè«‹æ±‚éç¨‹ï¼ˆä¸‰ï¼‰â€”â€” TCPå››æ¬¡æ®æ‰‹æ–·é–‹é€£æ¥ä»¥åŠç•°å¸¸è™•ç†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1522228359775acd17c0c4a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/86d72690.html title="HTTPè«‹æ±‚éç¨‹ï¼ˆä¸‰ï¼‰â€”â€” TCPå››æ¬¡æ®æ‰‹æ–·é–‹é€£æ¥ä»¥åŠç•°å¸¸è™•ç†">HTTPè«‹æ±‚éç¨‹ï¼ˆä¸‰ï¼‰â€”â€” TCPå››æ¬¡æ®æ‰‹æ–·é–‹é€£æ¥ä»¥åŠç•°å¸¸è™•ç†</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/fa22d056.html alt=æœ±å‡æœ¬è©²æ˜¯æœ±å…ƒç’‹çš„â€œé¦–å¸­è»å¸«â€ï¼Œå»ºç«‹æ˜æœå¾Œçªç„¶æå‡ºï¼šè«‹æ±‚æ­¸é„‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8c3dda383222456f815c37b41ba9e547 style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/fa22d056.html title=æœ±å‡æœ¬è©²æ˜¯æœ±å…ƒç’‹çš„â€œé¦–å¸­è»å¸«â€ï¼Œå»ºç«‹æ˜æœå¾Œçªç„¶æå‡ºï¼šè«‹æ±‚æ­¸é„‰>æœ±å‡æœ¬è©²æ˜¯æœ±å…ƒç’‹çš„â€œé¦–å¸­è»å¸«â€ï¼Œå»ºç«‹æ˜æœå¾Œçªç„¶æå‡ºï¼šè«‹æ±‚æ­¸é„‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bc82ec50.html alt=é ç¨‹æœå‹™èª¿ç”¨ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/e7c9c5e62ce24334ad3374c4150299d2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bc82ec50.html title=é ç¨‹æœå‹™èª¿ç”¨>é ç¨‹æœå‹™èª¿ç”¨</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/91b0a2d.html alt=ç¶²çµ¡è«‹æ±‚OkHttp3å°è£æ”¯æŒç·©å­˜ã€æ—¥èªŒã€æ””æˆªå™¨ã€æ–·é»ä¸‹è¼‰ã€ä¸Šå‚³ç­‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/15342286987793c1faad242 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/91b0a2d.html title=ç¶²çµ¡è«‹æ±‚OkHttp3å°è£æ”¯æŒç·©å­˜ã€æ—¥èªŒã€æ””æˆªå™¨ã€æ–·é»ä¸‹è¼‰ã€ä¸Šå‚³ç­‰>ç¶²çµ¡è«‹æ±‚OkHttp3å°è£æ”¯æŒç·©å­˜ã€æ—¥èªŒã€æ””æˆªå™¨ã€æ–·é»ä¸‹è¼‰ã€ä¸Šå‚³ç­‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/188cbaf.html alt=HTMLèª¿ç”¨æ‰“é–‹æœ¬åœ°æ–‡ä»¶ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/fee4388dfccc4aabac72da72ed00d07a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/188cbaf.html title=HTMLèª¿ç”¨æ‰“é–‹æœ¬åœ°æ–‡ä»¶>HTMLèª¿ç”¨æ‰“é–‹æœ¬åœ°æ–‡ä»¶</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d147c6c.html alt="åœ¨ç¶²é ä¸­é€šéèª¿ç”¨Windows Media Playerä¾†æ¢æ¸¬ç‰¹å®šæ–‡ä»¶" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/dfa68bbd164e43c3afb1e5fae8382c40 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d147c6c.html title="åœ¨ç¶²é ä¸­é€šéèª¿ç”¨Windows Media Playerä¾†æ¢æ¸¬ç‰¹å®šæ–‡ä»¶">åœ¨ç¶²é ä¸­é€šéèª¿ç”¨Windows Media Playerä¾†æ¢æ¸¬ç‰¹å®šæ–‡ä»¶</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c758476.html alt=Cèªè¨€å‡½æ•¸çš„èª¿ç”¨åŸç†ä¸ç†è§£ï¼Ÿæ·±å…¥æ·ºå‡ºé€šä¿—æ˜“æ‡‚ï¼Œä¸€æ–‡è®€æ‡‚å‡½æ•¸æ£§ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/70a95ad5c35849428fddf913b0817059 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c758476.html title=Cèªè¨€å‡½æ•¸çš„èª¿ç”¨åŸç†ä¸ç†è§£ï¼Ÿæ·±å…¥æ·ºå‡ºé€šä¿—æ˜“æ‡‚ï¼Œä¸€æ–‡è®€æ‡‚å‡½æ•¸æ£§>Cèªè¨€å‡½æ•¸çš„èª¿ç”¨åŸç†ä¸ç†è§£ï¼Ÿæ·±å…¥æ·ºå‡ºé€šä¿—æ˜“æ‡‚ï¼Œä¸€æ–‡è®€æ‡‚å‡½æ•¸æ£§</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5cf7cc6.html alt=Linuxç³»çµ±èª¿ç”¨è©³è§£ï¼ˆå¯¦ç¾æ©Ÿåˆ¶åˆ†æï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/89bc567a63c84695b0fbe8982764bbdb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5cf7cc6.html title=Linuxç³»çµ±èª¿ç”¨è©³è§£ï¼ˆå¯¦ç¾æ©Ÿåˆ¶åˆ†æï¼‰>Linuxç³»çµ±èª¿ç”¨è©³è§£ï¼ˆå¯¦ç¾æ©Ÿåˆ¶åˆ†æï¼‰</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>