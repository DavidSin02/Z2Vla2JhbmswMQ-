<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>M3U8 視頻文件 | 极客快訊</title><meta property="og:title" content="M3U8 視頻文件 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p9.pstatp.com/large/pgc-image/59af06196e7a49a2ad3e11bec58c55d1"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0293c9b.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0293c9b.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f0293c9b.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0293c9b.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0293c9b.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f0293c9b.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f0293c9b.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f0293c9b.html><meta property="article:published_time" content="2020-11-14T21:03:09+08:00"><meta property="article:modified_time" content="2020-11-14T21:03:09+08:00"><meta name=Keywords content><meta name=description content="M3U8 視頻文件"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/f0293c9b.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>M3U8 視頻文件</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>這篇文章只是 M3U、M3U8、HLS、TS 相關的一些基礎概念</p><p>"M3U" 和 "M3U8" 文件都是蘋果公司使用的 HTTP Live Streaming（HLS） 協議格式的基礎，這種協議格式可以在 iPhone 和 Macbook 等設備播放。</p><h2 class=pgc-h-arrow-right>HLS 解決方案</h2><p>HLS(HTTP Live Streaming) 是由Apple公司定義的用於實時流傳輸的協議，HLS基於HTTP協議實現，傳輸內容包括兩部分，一是M3U8描述文件，二是TS媒體文件。</p><h3 class=pgc-h-arrow-right>1. HLS的優勢為：自適應碼率流播（adaptive streaming）。</h3><p>效果就是客戶端會根據網絡狀況自動選擇不同碼率的視頻流，條件允許的情況下使用高碼率，網絡繁忙的時候使用低碼率，並且能夠自動在二者之間隨意切換。這對移動設備網絡狀況不穩定的情況下保障流暢播放非常有幫助。實現方法是服務器端提供多碼率視頻流，並且在列表文件中註明，播放器根據播放進度和下載速度進行自動調整。</p><h3 class=pgc-h-arrow-right>2. 為什麼要用 TS 而不是 MP4</h3><p>這是因為兩個 TS 片段可以無縫拼接，播放器能連續播放，而 MP4 文件由於編碼方式的原因，兩段 MP4 不能無縫拼接，播放器連續播放兩個 MP4 文件會出現破音和畫面間斷，影響用戶體驗。而且如果要在一段長達一小時的視頻中跳轉，如果使用單個 MP4 格式的視頻文件，並且也是用 HTTP 協議，那麼需要代理服務器支持 HTTP range request 獲取大文件中的一部分。這樣的話，對於代理服務器的性能來說要求較高。而 HTTP Live Streaming 則只需要根據列表文件中的時間軸找出對應的 TS 片段下載即可，不需要 range request，對代理服務器的要求小很多。所有代理服務器都支持小文件的高效緩存。</p><h3 class=pgc-h-arrow-right>3. 可以使用FFmpeg轉MP4為HLS(M3U8)文件。</h3><h3 class=pgc-h-arrow-right>4. hsl處理方案</h3><div class=pgc-img><img alt="M3U8 視頻文件" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/59af06196e7a49a2ad3e11bec58c55d1><p class=pgc-img-caption></p></div><p>核心，在於對於 m3u8 的文件解析和 通過 XHR 去完成對分片內容二進制文件的獲取，然後使用 MSE 的 appendBuffer 去進行 buffer 的封裝，然後自己完成合流的工作。</p><h2 class=pgc-h-arrow-right>M3U8</h2><p>M3U 文件是記錄了一個索引純文本文件，可以指定一個或多個多媒體文件的位置，其文件擴展名是“M3U”或者“m3u”。打開它時播放軟件並不是播放它，而是根據它的索引找到對應的音視頻文件的網絡地址進行在線播放。M3U文件的作用通常是創建指向在線流媒體的播放列表，創建的文件可以輕鬆訪問流媒體。</p><p>M3U8 是Unicode版本的 M3U ，用UTF-8編碼。</p><p>m3u8 文件實質是一個播放列表（playlist），其可能是一個媒體播放列表（Media Playlist），或者是一個主列表（Master Playlist）。</p><p>當 m3u8 文件作為媒體播放列表（Meida Playlist）時，其內部信息記錄的是一系列媒體片段資源，順序播放該片段資源，即可完整展示多媒體資源。對於點播來說，客戶端只需按順序下載片段資源，依次進行播放即可。而對於直播來說，客戶端需要定時重新請求該 m3u8 文件，看下是否有新的片段數據需要進行下載並播放。</p><p>當 m3u8 作為主播放列表（Master Playlist）時，其內部提供的是同一份媒體資源的多份流列表資源（Variant Strean）。客戶可以根據不同的網絡狀態選取合適碼流的資源，並且最好根據用戶喜好選擇合適的資源內容。</p><p>m3u8 文件要麼是媒體播放列表，要麼是主播放列表。但無論是哪種列表，其有效組成均由兩部分構成：</p><ul><li>以 #EXT 開頭的為標籤信息，作為對媒體資源的進一步描述；</li><li>剩餘的為資源信息，要麼是片段資源（Media Playlist）路徑，要麼是 m3u8 資源（Master Playlist）路徑；</li></ul><h3 class=pgc-h-arrow-right>m3u8文件遵循的條件：</h3><ul><li>m3u8 文件必須以 utf-8 進行編碼，不能使用 Byte Order Mark（BOM）字節序， 不能包含 utf-8 控制字符（U+0000 ~ U_001F 和 U+007F ~ u+009F）。</li><li>3u8 文件的每一行要麼是一個 URI，要麼是空行，要麼就是以 # 開頭的字符串。不能出現空白字符，除了顯示聲明的元素。</li><li>m3u8 文件中以 # 開頭的字符串要麼是註釋，要麼就是標籤。標籤以 #EXT 開頭，大小寫敏感。</li></ul><h3 class=pgc-h-arrow-right>m3u8 標籤</h3><p>標籤用於指定 m3u8 文件的全局參數或在其後面的切片文件/媒體播放列表的一些信息。</p><pre><code>#EXTM3U // 表明該文件是一個 m3u8 文件，必須在文件的第一行#EXT-X-VERSION:3   //  HLS 的協議版本號#EXT-X-ALLOW-CACHE:NO#EXT-X-MEDIA-SEQUENCE:1572999465  // M3U8直播時的直播切換序列，當播放打開M3U8時，以這個標籤的值作為參考，播放對應的序列號的切片#EXT-X-TARGETDURATION:6 // 該標籤指定了媒體文件持續時間的最大值,，播放文件列表中的媒體文件在EXTINF標籤中定義的持續時間必須小於或者等於該標籤指定的持續時間。該標籤在播放列表文件中必須出現一次。#EXT-QQHLS-PIC-WIDTH:0#EXT-QQHLS-PIC-HEIGHT:0#EXT-QQHLS-CK:CRC_16#EXT-QQHLS-BN:8#EXT-QQHLS-SEGMENT-TYPE:0#EXT-QQHLS-SEGMENT_RANGE:1572999448-1572999472#EXT-X-PROGRAM-DATE-TIME:2019-11-06T10:11:57+08:00 // 片段取樣時間#EXT-QQHLS-MACHINEID:56448#EXT-QQHLS-START-TIME:1573006317#EXT-SID:1572999465#EXT-SC:SZ=254364&amp;CK=e633#EXT-BC:SZ=31744&amp;CK=782e#EXT-BC:SZ=31744&amp;CK=256a#EXT-BC:SZ=31744&amp;CK=7b04#EXT-BC:SZ=31744&amp;CK=30dd#EXT-BC:SZ=31744&amp;CK=6d89#EXT-BC:SZ=31744&amp;CK=46d#EXT-BC:SZ=31744&amp;CK=8f4#EXT-BC:SZ=32156&amp;CK=71b5#EXTINF:5.000,100204101-1572999465.ts?cdncode=/18907E7BE0798990/&amp;HLSP2P=1&amp;buname=qqlive&amp;sdtfrom=10002212&amp;vkey=F1FE87B5E6D84B6FEFBB683D7C2558C08C8CF7B6E752E05C689F1117D651C359E4C7460F44AF4CA4D54188D17A34DB8F3D1E1A9B03F5F5509AFFC93EEA5B90B835EB1E096C8EA81447313AD2761912137D4F692E8AEC2D52E0E3ACD02E09272F82A1FC8573388BDE57FBE56A424E01BA// EXTINF為M3U8列表中每一個分片的duration,描述信息#EXT-X-PROGRAM-DATE-TIME:2019-11-06T10:12:02+08:00#EXT-QQHLS-MACHINEID:56448#EXT-QQHLS-START-TIME:1573006322#EXT-SID:1572999466#EXT-SC:SZ=287264&amp;CK=6abc#EXT-BC:SZ=35840&amp;CK=aa34#EXT-BC:SZ=35840&amp;CK=42f1#EXT-BC:SZ=35840&amp;CK=46f#EXT-BC:SZ=35840&amp;CK=3fd#EXT-BC:SZ=35840&amp;CK=75b2#EXT-BC:SZ=35840&amp;CK=af4f#EXT-BC:SZ=35840&amp;CK=52a1#EXT-BC:SZ=36384&amp;CK=86ed#EXTINF:5.000,100204101-1572999466.ts?cdncode=/18907E7BE0798990/&amp;HLSP2P=1&amp;buname=qqlive&amp;sdtfrom=10002212&amp;vkey=F1FE87B5E6D84B6FEFBB683D7C2558C08C8CF7B6E752E05C689F1117D651C359E4C7460F44AF4CA4D54188D17A34DB8F3D1E1A9B03F5F5509AFFC93EEA5B90B835EB1E096C8EA81447313AD2761912137D4F692E8AEC2D52E0E3ACD02E09272F82A1FC8573388BDE57FBE56A424E01BA#EXT-X-PROGRAM-DATE-TIME:2019-11-06T10:12:07+08:00#EXT-QQHLS-MACHINEID:56448#EXT-QQHLS-START-TIME:1573006327#EXT-SID:1572999467#EXT-SC:SZ=289708&amp;CK=749f#EXT-BC:SZ=35840&amp;CK=a209#EXT-BC:SZ=35840&amp;CK=abb9#EXT-BC:SZ=35840&amp;CK=13ab#EXT-BC:SZ=35840&amp;CK=40b7#EXT-BC:SZ=35840&amp;CK=2e10#EXT-BC:SZ=35840&amp;CK=3a00#EXT-BC:SZ=35840&amp;CK=62ae#EXT-BC:SZ=38828&amp;CK=65e5#EXTINF:5.000,100204101-1572999467.ts?cdncode=/18907E7BE0798990/&amp;HLSP2P=1&amp;buname=qqlive&amp;sdtfrom=10002212&amp;vkey=F1FE87B5E6D84B6FEFBB683D7C2558C08C8CF7B6E752E05C689F1117D651C359E4C7460F44AF4CA4D54188D17A34DB8F3D1E1A9B03F5F5509AFFC93EEA5B90B835EB1E096C8EA81447313AD2761912137D4F692E8AEC2D52E0E3ACD02E09272F82A1FC8573388BDE57FBE56A424E01BA#EXT-X-PROGRAM-DATE-TIME:2019-11-06T10:12:11+08:00#EXT-QQHLS-MACHINEID:56448#EXT-QQHLS-START-TIME:1573006331#EXT-SID:1572999468#EXT-SC:SZ=523016&amp;CK=97c#EXT-BC:SZ=64512&amp;CK=a072#EXT-BC:SZ=64512&amp;CK=b80e#EXT-BC:SZ=64512&amp;CK=13ee#EXT-BC:SZ=64512&amp;CK=2c70#EXT-BC:SZ=64512&amp;CK=992c#EXT-BC:SZ=64512&amp;CK=3c51#EXT-BC:SZ=64512&amp;CK=a079#EXT-BC:SZ=71432&amp;CK=a66#EXTINF:5.000,100204101-1572999468.ts?cdncode=/18907E7BE0798990/&amp;HLSP2P=1&amp;buname=qqlive&amp;sdtfrom=10002212&amp;vkey=F1FE87B5E6D84B6FEFBB683D7C2558C08C8CF7B6E752E05C689F1117D651C359E4C7460F44AF4CA4D54188D17A34DB8F3D1E1A9B03F5F5509AFFC93EEA5B90B835EB1E096C8EA81447313AD2761912137D4F692E8AEC2D52E0E3ACD02E09272F82A1FC8573388BDE57FBE56A424E01BA#EXT-X-PROGRAM-DATE-TIME:2019-11-06T10:12:16+08:00#EXT-QQHLS-MACHINEID:56448#EXT-QQHLS-START-TIME:1573006336#EXT-SID:1572999469#EXT-SC:SZ=670032&amp;CK=6479#EXT-BC:SZ=82944&amp;CK=dc72#EXT-BC:SZ=82944&amp;CK=e970#EXT-BC:SZ=82944&amp;CK=4ca4#EXT-BC:SZ=82944&amp;CK=3d1b#EXT-BC:SZ=82944&amp;CK=fa9b#EXT-BC:SZ=82944&amp;CK=e9d3#EXT-BC:SZ=82944&amp;CK=ee0b#EXT-BC:SZ=89424&amp;CK=b998#EXTINF:5.000,100204101-1572999469.ts?cdncode=/18907E7BE0798990/&amp;HLSP2P=1&amp;buname=qqlive&amp;sdtfrom=10002212&amp;vkey=F1FE87B5E6D84B6FEFBB683D7C2558C08C8CF7B6E752E05C689F1117D651C359E4C7460F44AF4CA4D54188D17A34DB8F3D1E1A9B03F5F5509AFFC93EEA5B90B835EB1E096C8EA81447313AD2761912137D4F692E8AEC2D52E0E3ACD02E09272F82A1FC8573388BDE57FBE56A424E01BA#EXT-X-PROGRAM-DATE-TIME:2019-11-06T10:12:21+08:00#EXT-QQHLS-MACHINEID:56448#EXT-QQHLS-START-TIME:1573006341#EXT-SID:1572999470#EXT-SC:SZ=777756&amp;CK=a13c#EXT-BC:SZ=96256&amp;CK=e95e#EXT-BC:SZ=96256&amp;CK=f459#EXT-BC:SZ=96256&amp;CK=33a6#EXT-BC:SZ=96256&amp;CK=bb7c#EXT-BC:SZ=96256&amp;CK=f3e4#EXT-BC:SZ=96256&amp;CK=635d#EXT-BC:SZ=96256&amp;CK=67e9#EXT-BC:SZ=103964&amp;CK=b938#EXTINF:5.000,100204101-1572999470.ts?cdncode=/18907E7BE0798990/&amp;HLSP2P=1&amp;buname=qqlive&amp;sdtfrom=10002212&amp;vkey=F1FE87B5E6D84B6FEFBB683D7C2558C08C8CF7B6E752E05C689F1117D651C359E4C7460F44AF4CA4D54188D17A34DB8F3D1E1A9B03F5F5509AFFC93EEA5B90B835EB1E096C8EA81447313AD2761912137D4F692E8AEC2D52E0E3ACD02E09272F82A1FC8573388BDE57FBE56A424E01BA#EXT-X-PROGRAM-DATE-TIME:2019-11-06T10:12:27+08:00#EXT-QQHLS-MACHINEID:56448#EXT-QQHLS-START-TIME:1573006347#EXT-SID:1572999471#EXT-SC:SZ=479212&amp;CK=c493#EXT-BC:SZ=59392&amp;CK=dec8#EXT-BC:SZ=59392&amp;CK=1ee8#EXT-BC:SZ=59392&amp;CK=b9bf#EXT-BC:SZ=59392&amp;CK=8b9c#EXT-BC:SZ=59392&amp;CK=29fe#EXT-BC:SZ=59392&amp;CK=493#EXT-BC:SZ=59392&amp;CK=ae5f#EXT-BC:SZ=63468&amp;CK=630#EXTINF:5.000,100204101-1572999471.ts?cdncode=/18907E7BE0798990/&amp;HLSP2P=1&amp;buname=qqlive&amp;sdtfrom=10002212&amp;vkey=F1FE87B5E6D84B6FEFBB683D7C2558C08C8CF7B6E752E05C689F1117D651C359E4C7460F44AF4CA4D54188D17A34DB8F3D1E1A9B03F5F5509AFFC93EEA5B90B835EB1E096C8EA81447313AD2761912137D4F692E8AEC2D52E0E3ACD02E09272F82A1FC8573388BDE57FBE56A424E01BA#EXT-X-PROGRAM-DATE-TIME:2019-11-06T10:12:32+08:00#EXT-QQHLS-MACHINEID:56448#EXT-QQHLS-START-TIME:1573006352#EXT-SID:1572999472#EXT-SC:SZ=266396&amp;CK=648#EXT-BC:SZ=32768&amp;CK=a085#EXT-BC:SZ=32768&amp;CK=8233#EXT-BC:SZ=32768&amp;CK=1831#EXT-BC:SZ=32768&amp;CK=4042#EXT-BC:SZ=32768&amp;CK=f0eb#EXT-BC:SZ=32768&amp;CK=cd3a#EXT-BC:SZ=32768&amp;CK=e245#EXT-BC:SZ=37020&amp;CK=f6e3#EXTINF:5.000,100204101-1572999472.ts?cdncode=/18907E7BE0798990/&amp;HLSP2P=1&amp;buname=qqlive&amp;sdtfrom=10002212&amp;vkey=F1FE87B5E6D84B6FEFBB683D7C2558C08C8CF7B6E752E05C689F1117D651C359E4C7460F44AF4CA4D54188D17A34DB8F3D1E1A9B03F5F5509AFFC93EEA5B90B835EB1E096C8EA81447313AD2761912137D4F692E8AEC2D52E0E3ACD02E09272F82A1FC8573388BDE57FBE56A424E01BA複製代碼</code></pre><p>其他的一些常用標籤：</p><ul><li>EXT-X-DISCONTINUITY 該標籤表明其前一個切片與下一個切片之間存在中斷。 EXT-X-DISCONTINUITY 的一個經典使用場景就是在視屏流中插入廣告，由於視屏流與廣告視屏流不是同一份資源，因此在這兩種流切換時使用 EXT-X-DISCONTINUITY 進行指明，客戶端看到該標籤後，就會處理這種切換中斷問題，讓體驗更佳。</li><li>EXT-X-KEY 媒體片段可以進行加密，而該標籤可以指定解密方法。</li><li>EXT-X-PLAYLIST-TYPE ：表明流媒體類型。全局生效。該標籤為可選標籤。 可選值如下：VOD EVENT</li></ul><p>注：VOD 文件通常帶有 EXT-X-ENDLIST 標籤，因為其為點播源，不會改變；而 EVEVT 文件初始化時一般不會有 EXT-X-ENDLIST 標籤，暗示有新的文件會添加到播放列表末尾，因此也需要客戶端定時獲取該 m3u8 文件，以獲取新的媒體片段資源，直到訪問到 EXT-X-ENDLIST 標籤才停止。</p><ul><li>EXT-X-PROGRAM-DATE-TIME 該標籤使用一個絕對日期/時間表明第一個樣本片段的取樣時間。</li><li>EXT-X-MEDIA-SEQUENCE ：表示播放列表第一個 URL 片段文件的序列號，每個媒體片段 URL 都擁有一個唯一的整型序列號。 每個媒體片段序列號按出現順序依次加 1。媒體片段序列號與片段文件名無關。如果該標籤未指定，則默認序列號從 0 開始。</li><li>EXT-X-ENDLIST 若出現 EXT-X-ENDLIST 標籤，則表明M3U8文件不會再產生更多的切片，可以理解為該M3U8已停止更新，並且播放分片到這個標籤後結束。M3U8不僅僅是可以作為直播，也可以作為點播存在，在M3U8文件中保存所有切片信息最後使用 EXT-X-ENDLIST 結尾，這個M3U8即為點播M3U8。 EXT-X-ENDLIST 標籤可能會出現在播放列表文件的任何地方，但是不能出現兩次或以上。</li><li>EXT-X-STREAM-INF EXT-X-STREAM-INF 標籤出現在M3U8時，主要是出現在多級M3U8文件中時，例如M3U8中包含子M3U8列表，或者主M3U8中包含多碼率M3U8時；該標籤後需要跟一些屬性，下面就來逐一說明一下這些屬性：BANDWIDTH ： BANDWIDTH 的值為最高碼率值，當播 放EXT-X-STREAM-INF 下對應的M3U8時佔用的最大碼率（必要參數）。AVERAGE-BANDWIDTH ： AVERAGE-BANDWIDTH 的值為平均碼率值，當播放 EXT-X-STREAM-INF 下對應的M3U8時佔用的平均碼率（可選參數）。CODECS ：CODECS的值用於聲明 EXT-X-STREAM-INF 下面對應M3U8裡面的音視頻編碼、視頻編碼的信息（可選參數）。RESOLUTION ：M3U8中視頻的寬高信息描述（可選參數）。FRAME-RATE ：子M3U8中的視頻幀率（可選參數）。</li></ul><h3 class=pgc-h-arrow-right>客戶端播放M3U8的一些標準：</h3><pre><code>EXT-X-ENDLISTX-DISCONTINUTY</code></pre><h3 class=pgc-h-arrow-right>注意事項</h3><ul><li>有兩種請求 m3u8 播放列表的方法：一是通過 m3u8 的 URI 進行請求，則該文件必須以 .m3u8 或 .m3u 結尾；二是通過 HTTP 進行請求，則請求頭 Content-Type 必須設置為 application/vnd.apple.mpegurl 或者 audio/mpegurl 。</li><li>空行和註釋行在解析時都忽略。</li><li>媒體播放列表（Media Playlist）的流資源總時長就是各切片資源的時長之和。</li></ul><h2 class=pgc-h-arrow-right>TS文件</h2><p>TS（Transport Stream）是一種音視頻封裝格式，全稱MPEG2-TS。MPEG-TS主要應用於實時傳送的節目，比如實時廣播的電視節目。</p><p>TS文件（流）可以分為三層：TS層（Transport Stream）、PES層（Packet Elemental Stream）、ES層（Elementary Stream）。</p><p>ES層就是音視頻數據，PES層是在音視頻數據上加了時間戳等對數據幀的說明信息，TS層是在PES層上加入了數據流識別和傳輸的必要信息。TS文件（碼流）由多個TS Packet組成的。</p><p>TS文件（碼流）的分層結構圖</p><div class=pgc-img><img alt="M3U8 視頻文件" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5d36fe47b294442f92f50e2816b9518f><p class=pgc-img-caption></p></div><h3 class=pgc-h-arrow-right>TS流生成流程</h3><ol start=1><li>將原始音視頻數據壓縮之後，壓縮結果組成一個基本碼流（ES）。</li><li>對ES（基本碼流）進行打包形成PES。</li><li>在PES包中加入時間戳信息(PTS/DTS)。</li><li>將PES包內容分配到一系列固定長度的傳輸包（TS Packet）中。</li><li>在傳輸包中加入定時信息(PCR)。</li><li>在傳輸包中加入節目專用信息(PSI) 。</li><li>連續輸出傳輸包形成具有恆定比特率的MPEG-TS流。</li></ol><h3 class=pgc-h-arrow-right>TS流解析流程</h3><ol start=1><li>複用的MPEG-TS流中解析出TS包；</li><li>從TS包中獲取PAT及對應的PMT；</li><li>從而獲取特定節目的音視頻PID；</li><li>通過PID篩選出特定音視頻相關的TS包，並解析出PES；</li><li>從PES中讀取到PTS/DTS，並從PES中解析出基本碼流ES；</li><li>將ES交給解碼器，獲得壓縮前的原始音視頻數據。</li></ol></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>M3U8</a></li><li><a>視頻</a></li><li><a>文件</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/6639baec.html alt=在線播放視頻網站應該如何選擇服務器 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6639baec.html title=在線播放視頻網站應該如何選擇服務器>在線播放視頻網站應該如何選擇服務器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b91b414b.html alt=講述者│一起活到好事發生的那一天（視頻） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b91b414b.html title=講述者│一起活到好事發生的那一天（視頻）>講述者│一起活到好事發生的那一天（視頻）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/22525cee.html alt=數字音視頻壓縮編碼標準及H.265的編碼優勢 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/558a023201a84604894ebc359d178ed2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/22525cee.html title=數字音視頻壓縮編碼標準及H.265的編碼優勢>數字音視頻壓縮編碼標準及H.265的編碼優勢</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e71fb88c.html alt=和麵、揉麵技巧，視頻詳細講解，10年和麵經驗，全部告訴你 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/8cd49cb368f1488b8c4a65a3fe556d75 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e71fb88c.html title=和麵、揉麵技巧，視頻詳細講解，10年和麵經驗，全部告訴你>和麵、揉麵技巧，視頻詳細講解，10年和麵經驗，全部告訴你</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/438a5238.html alt=環境管理體系程序文件-文件控制程序 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/aaa460951e4e4b358966a6652c1d361f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/438a5238.html title=環境管理體系程序文件-文件控制程序>環境管理體系程序文件-文件控制程序</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e0ffb976.html alt=不合格、糾正措施程序文件（ISO9001程序文件範本） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e0ffb976.html title=不合格、糾正措施程序文件（ISO9001程序文件範本）>不合格、糾正措施程序文件（ISO9001程序文件範本）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/16c259de.html alt=什麼是程序文件？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/16c259de.html title=什麼是程序文件？>什麼是程序文件？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a8c41b36.html alt=今天聊聊程序的文件的概念 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a8c41b36.html title=今天聊聊程序的文件的概念>今天聊聊程序的文件的概念</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9cd79f8d.html alt=程序文件-ISO9001 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/2e673ba29f5545fd8aea4073e1c638c3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9cd79f8d.html title=程序文件-ISO9001>程序文件-ISO9001</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4526bc23.html alt=程序文件沒有用？管理全靠你盯著？也許是你對程序文件有誤解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/25f214b9-177d-4e1e-8ccd-1c3fe7c07fe5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4526bc23.html title=程序文件沒有用？管理全靠你盯著？也許是你對程序文件有誤解>程序文件沒有用？管理全靠你盯著？也許是你對程序文件有誤解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c81e50df.html alt=程序文件流程圖 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/3a0300041dc3570ffec5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c81e50df.html title=程序文件流程圖>程序文件流程圖</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/48fac9bc.html alt=管理體系程序文件之文件控制程序 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/48fac9bc.html title=管理體系程序文件之文件控制程序>管理體系程序文件之文件控制程序</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ffde15b2.html alt=質量管理體系程序文件--文件控制程序 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/c4afea2228a24b0e81d79d622e633652 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ffde15b2.html title=質量管理體系程序文件--文件控制程序>質量管理體系程序文件--文件控制程序</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e68a385b.html alt=如何挑選合適的文件櫃？跟美格利生一起來看看 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9e0a2460d3344937bd8219a679ee2353 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e68a385b.html title=如何挑選合適的文件櫃？跟美格利生一起來看看>如何挑選合適的文件櫃？跟美格利生一起來看看</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/02c33c9e.html alt=文件櫃定製有哪些方面需注意呢 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/966ef4ec8b7749b080bb564832a55c13 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/02c33c9e.html title=文件櫃定製有哪些方面需注意呢>文件櫃定製有哪些方面需注意呢</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>