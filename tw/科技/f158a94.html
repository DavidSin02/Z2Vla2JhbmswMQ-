<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>淺析CPU中斷技術 | 极客快訊</title><meta property="og:title" content="淺析CPU中斷技術 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f158a94.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f158a94.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f158a94.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f158a94.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f158a94.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f158a94.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f158a94.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f158a94.html><meta property="article:published_time" content="2020-10-29T20:50:02+08:00"><meta property="article:modified_time" content="2020-10-29T20:50:02+08:00"><meta name=Keywords content><meta name=description content="淺析CPU中斷技術"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/f158a94.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>淺析CPU中斷技術</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><h1><strong>一、什麼是CPU中斷？</strong></h1><p>　使用計算機的過程中，經常會遇到這麼一種情景：</p><p>1. 你正在看電影</p><p>2. 你的朋友發來一條QQ信息</p><p>3. 你一邊回覆朋友的信息，一邊繼續看電影</p><p>這個過程中，一切是那麼的順其自然。但理論上來說，播放電影的時候，CPU正在一絲不苟的執行著一條又一條的指令，它是如何在維持電影播放的情況下，及時接收並響應你的鍵盤輸入信息呢？</p><p>這就是CPU中斷技術在起作用。</p><p><strong>CPU中斷技術的定義如下：</strong></p><ol><li>計算機處於執行期間</li><li>系統內發生了非尋常或非預期的急需處理事件</li><li>CPU暫時中斷當前正在執行的程序而轉去執行相應的事件處理程序</li><li>處理完畢後返回原來被中斷處繼續執行</li></ol><p>在這裡，“非尋常或非預期的事件”指的就是你回覆朋友的QQ時，用鍵盤鍵入信息。為了及時響應你鍵入的信息，CPU將正在執行的任務“播放電影”暫時中斷，處理完你鍵入的信息後，繼續執行“播放電影”的任務。由於這個“中斷當前任務->響應鍵盤輸入->繼續當前任務”的執行週期非常短（一般都是微秒級），所以一般人感覺不出來。</p><p><strong>舉個現實中的例子：</strong></p><p>你正在看書，突然你的朋友打來電話，於是你放下書本去接電話，電話打完接著看書。</p><p>電話響->放下書本->接電話->繼續看書這一個過程，就類似於CPU中斷的處理過程。</p><h1><strong>二、CPU中斷的作用</strong></h1><p>早期的CPU處理外設的事件(比如接收鍵盤輸入)，往往採用“輪詢”的方式。即CPU像個查崗的一樣輪番對外設順序訪問，比如它先看看鍵盤有沒被按下，有的話就處理，沒的話繼續往下看鼠標有沒有移動，再看看打印機……這種方式使CPU的執行效率很低，且CPU與外設不能同時工作（因為要等待CPU來“巡查”）。</p><p>中斷模式時就是說CPU不主動訪問這些設備，只管處理自己的任務。如果有設備要與CPU聯繫，或要CPU處理一些事情，它會給CPU發一箇中斷請求信號。這時CPU就會放下正在進行的工作而去處理這個外設的請求。處理完中斷後，CPU返回去繼續執行中斷以前的工作。</p><p><strong>中斷模式的作用和優點在於：</strong></p><p><strong></strong>1. 可以使CPU和外設同時工作，使系統可以及時地響應外部事件。</p><p>2. 可允許多個外設同時工作，大大提高了CPU的利用率，也提高了數據輸入、輸出的速度。</p><p>3. 可以使CPU及時處理各種軟硬件故障（比如計算機在運行過程中，出現了難以預料的情況或一些故障，如電源掉電、存儲出錯、運算溢出等等。計算機可以利用中斷系統自行處理，而不必停機或報告工作人員。）</p><h1><strong>三、CPU中斷的類型</strong></h1><p>　在計算機系統中，根據中斷源的不同，通常將中斷分為兩大類：</p><p>1. 硬件中斷</p><p>2. 軟件中斷</p><p><strong>硬件中斷</strong></p><p><strong></strong>硬件中斷又稱外部中斷，主要分為兩種：可屏蔽中斷、非屏蔽中斷。</p><p><strong>可屏蔽中斷：</strong></p><p>1. 常由計算機的外設或一些接口功能產生，如鍵盤、打印機、串行口等</p><p>2. 這種類型的中斷可以在CPU要處理其它緊急操作時，被軟件屏蔽或忽略</p><p><strong>非屏蔽中斷：</strong></p><p>1. 由意外事件導致，如電源斷電、內存校驗錯誤等</p><p>2. 對於這種類型的中斷事件，無法通過軟件進行屏蔽，CPU必須無條件響應</p><p>在x86架構的處理器中，CPU的中斷控制器由兩根引腳(INTR和NMI)接收外部中斷請求信號。其中：</p><p>1. INTR接收可屏蔽中斷請求</p><p>2. NMI接收非屏蔽中斷請求</p><p><strong>典型事例：</strong></p><p>1. 典型的可屏蔽中斷的例子是打印機中斷，CPU對打印機中斷請求的響應可以快一些，也可以慢一些，因為讓打印機稍等待一會也是完全合理的。</p><p>2. 典型的非屏蔽中斷的例子是電源斷電，一旦出現此中斷請求，必須立即無條件地響應，否則進行其他任何工作都是沒有意義的。</p><p><strong>軟件中斷</strong></p><p>軟件中斷又稱內部中斷，是指在程序中調用INTR中斷指令引起的中斷。比如winAPI中，keybd_event和mouse_event兩個函數，就是用來模擬鍵盤和鼠標的輸入（這個僅為筆者本人的猜測）。</p><h1><strong>四、CPU中斷的過程</strong></h1><p><strong>中斷請求</strong></p><p>中斷請求是由中斷源向CPU發出中斷請求信號。外部設備發出中斷請求信號要具備以下兩個條件：</p><p>1. 外部設備的工作已經告一段落。例如輸入設備只有在啟動後，將要輸入的數據送到接口電路的數據寄存器（即準備好要輸入的數據）之後，才可以向CPU發出中斷請求。</p><p>2. 系統允許該外設發出中斷請求。如果系統不允許該外設發出中斷請求，可以將這個外設的請求屏蔽。當這個外設中斷請求被屏蔽，雖然這個外設準備工作已經完成，也不能發出中斷請求。</p><p><strong>中斷響應、處理和返回</strong></p><p><strong></strong>當滿足了中斷的條件後，CPU就會響應中斷，轉入中斷程序處理。具體的工作過程如下：</p><p>1. 關閉中斷信號接收器</p><p>2. 保存現場(context)</p><p>3. 給出中斷入口，轉入相應的中斷服務程序</p><p>4. 處理完成，返回並恢復現場(context)</p><p>5. 開啟中斷信號接收器</p><p><strong>中斷排隊和中斷判優</strong></p><p><strong></strong>1. 中斷申請是隨機的，有時會出現多箇中斷源同時提出中斷申請。</p><p>2. CPU每次只能響應一箇中斷源的請求。</p><p>3. CPU不可能對所有中斷請求一視同仁，它會根據各中斷源工作性質的輕重緩急，預先安排一個優先級順序。當多箇中斷源同時申請中斷時，即按此優先級順序進行排隊，等候CPU處理。</p><p>瞭解了CPU中斷處理的過程，就不難理解下面一種常見的情景：</p><p>正在拷貝文件時，往某個文本框輸入信息，這個文本框會出現短暫的假死，鍵盤輸入的數據不能及時顯示在文本框中，需要等一會兒才能逐漸顯示出來。</p><p>這是因為該中斷操作(往文本框輸入信息)在中斷隊列的優先級比較低，或者CPU認為正在處理的操作(拷貝文件)進行掛起的代價太大，所以只有等到CPU到了一個掛起代價較低的點，才會掛起當前操作，處理本次中斷信息。</p><h1><strong>五、多核CPU對中斷的處理</strong></h1><p>多核CPU的中斷處理和單核有很大不同。多核的各處理器核心之間需要通過中斷方式進行通信，所以CPU芯片內部既有各處理器核心的本地中斷控制器，又有負責仲裁各核之間中斷分配的全局中斷控制器。</p><p>現今的多核處理器在中斷處理和中斷控制方面主要使用的是APIC（Advanced Programmable Interrupt Controllers），即高級編程中斷控制器。它是基於中斷控制器兩個基礎功能單元——本地單元以及I/O單元的分佈式體系結構。在多核系統中，多個本地和I/O APIC單元能夠作為一個整體通過APIC總線互相操作。</p><p><strong>APIC的功能有：</strong></p><p>1. 接受來自處理器中斷引腳的內部或外部I/O APIC的中斷，然後將這些中斷髮送給處理器核心進行處理</p><p>2. 在多核處理器系統中，接收和發送核內中斷消息</p><p>對於外部設備發出的中斷請求，由全局中斷控制器接收請求並決定交給CPU的哪一個核心處理。也可針對APIC編程，讓所有的中斷都被一個固定的CPU處理。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>淺析</a></li><li><a>CPU</a></li><li><a>中斷</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/8f087332.html alt=手機1億像素真的能提升拍照效果嗎？淺析像素、CMOS與畫質的關係 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f5cf31426bc84bb5b7c89e2ef18369b1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8f087332.html title=手機1億像素真的能提升拍照效果嗎？淺析像素、CMOS與畫質的關係>手機1億像素真的能提升拍照效果嗎？淺析像素、CMOS與畫質的關係</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a4b90207.html alt=淺析袁大頭銀元的邊齒形態和齒數的應用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/e873968a07b5482ba0da02ce9e144cc9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a4b90207.html title=淺析袁大頭銀元的邊齒形態和齒數的應用>淺析袁大頭銀元的邊齒形態和齒數的應用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/5d01dc93.html alt=CPU發展簡史：晶圓為什麼是圓的？不是方的？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/e3287db062784341a61139da5db9701b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5d01dc93.html title=CPU發展簡史：晶圓為什麼是圓的？不是方的？>CPU發展簡史：晶圓為什麼是圓的？不是方的？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d29f4e4e.html alt=淺析裝配螺栓鬆動原因及防鬆措施 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1534993351852a9200b291f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d29f4e4e.html title=淺析裝配螺栓鬆動原因及防鬆措施>淺析裝配螺栓鬆動原因及防鬆措施</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f15c3fa3.html alt=CPU顯卡都選好了，電源該怎麼選，教你幾招通俗易懂小竅門 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/8ebabee259c7481bb2a3d8e659fbf3a0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f15c3fa3.html title=CPU顯卡都選好了，電源該怎麼選，教你幾招通俗易懂小竅門>CPU顯卡都選好了，電源該怎麼選，教你幾招通俗易懂小竅門</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cadf04a2.html alt=淺析正則表達式的原理和運用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9fe74f2e095e4f1797edc7a9a0e089e4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cadf04a2.html title=淺析正則表達式的原理和運用>淺析正則表達式的原理和運用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b6297d23.html alt=淺析定量給料機在水泥行業的應用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f6d0d6af7bf2441c8a3c9784452ca0c9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b6297d23.html title=淺析定量給料機在水泥行業的應用>淺析定量給料機在水泥行業的應用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b4c7a094.html alt=AMD系列CPU和主板參數對照表20200524 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4e358b60ba0b47538a09117a67bfab03 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b4c7a094.html title=AMD系列CPU和主板參數對照表20200524>AMD系列CPU和主板參數對照表20200524</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b4568212.html alt="一百多套CPU基本參數及參考價 臺式機新裝先收藏" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/57687a2864914584b2e98ce18dc5f255 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b4568212.html title="一百多套CPU基本參數及參考價 臺式機新裝先收藏">一百多套CPU基本參數及參考價 臺式機新裝先收藏</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/23c87346.html alt=淺析“模型跟蹤控制”-兩個PID控制器組成的控制算法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ba2907deef34450ebaf77defe6ca4c71 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/23c87346.html title=淺析“模型跟蹤控制”-兩個PID控制器組成的控制算法>淺析“模型跟蹤控制”-兩個PID控制器組成的控制算法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/14323873.html alt=淺析VPN光纖接入技術在接入網中的應用 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1522292433987de882f9173 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/14323873.html title=淺析VPN光纖接入技術在接入網中的應用>淺析VPN光纖接入技術在接入網中的應用</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/38177b29.html alt=淺析智慧企業建設之知識工程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5efde817156b4136b6170e3416f14e4b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/38177b29.html title=淺析智慧企業建設之知識工程>淺析智慧企業建設之知識工程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/470d0ef7.html alt=如何充分利用多核CPU，計算很大的List中所有整數的和 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/5f031909ec724f89918149df43f7977c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/470d0ef7.html title=如何充分利用多核CPU，計算很大的List中所有整數的和>如何充分利用多核CPU，計算很大的List中所有整數的和</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/25f7ef8c.html alt=淺析儀器儀表的精度 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/fe59fc3a652245f39c28882e0cd6a188 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/25f7ef8c.html title=淺析儀器儀表的精度>淺析儀器儀表的精度</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/980eeb56.html alt=世嘉土星遊戲機翻新修復：雙CPU雙GPU，同期最強架構 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1e24e8ab164647f5b8714e504a700cd5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/980eeb56.html title=世嘉土星遊戲機翻新修復：雙CPU雙GPU，同期最強架構>世嘉土星遊戲機翻新修復：雙CPU雙GPU，同期最強架構</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>