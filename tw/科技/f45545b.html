<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>基於故障注入的以太坊性能測試系統 | 极客快訊</title><meta property="og:title" content="基於故障注入的以太坊性能測試系統 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/631a2476467f464eb661499961eeaeab"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f45545b.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f45545b.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f45545b.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f45545b.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f45545b.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f45545b.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f45545b.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f45545b.html><meta property="article:published_time" content="2020-10-29T20:52:47+08:00"><meta property="article:modified_time" content="2020-10-29T20:52:47+08:00"><meta name=Keywords content><meta name=description content="基於故障注入的以太坊性能測試系統"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/f45545b.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>基於故障注入的以太坊性能測試系統</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div class=pgc-img><img alt=基於故障注入的以太坊性能測試系統 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/631a2476467f464eb661499961eeaeab><p class=pgc-img-caption>圖 1 系統流程示意圖</p></div><p><br></p><h2 class=pgc-h-arrow-right>1. 項目意義</h2><p>近年來區塊鏈技術廣受關注。區塊鏈的去中心化、不可篡改的特性有效降低了交易成本，使人們得以在無人監管的模式下構建可信交易平臺。因此區塊鏈技術有很高的應用價值。智能合約是一種信息化的計算機協議，無需人來監督執行。區塊鏈去中心化、不可篡改的特性為實施智能合約提供了必要的可信環境。以太坊是首個支持圖靈完備的智能合約編程語言的區塊鏈平臺。以太坊支持私有鏈，私有鏈是一種可以根據個人需求進行部署的區塊鏈，具有可配置、規模小、需要許可等特點。這使得以太坊私有鏈可以更好的滿足企業和個人的使用需求。</p><p>區塊鏈去中心化的特性、複雜的共識流程導致其吞吐量低、交易延遲高、性能較差。目前，支付寶等支付方式的吞吐量早已突破 10000 筆/秒，以太坊公有鏈平均 15 筆/秒，很難滿足當今的數字支付場景。私有鏈是一種良好的解決方案，可以限制用戶規模，降低通信開銷，進而提升性能。由於用戶使用以太坊私有鏈的場景對性能可能有要求，需要進行性能評估。同時，由於分佈式系統的真實部署環境不穩定，可能會面臨各種類型的故障。開發人員需要驗證以太坊私有鏈能否在故障條件下滿足用戶的需求。因此，在實際應用中，應仔細考慮以太坊私有鏈的性能，並模擬真實部署場景進行測試。</p><h2 class=pgc-h-arrow-right>2. 項目內容</h2><p>為了儘可能暴露性能問題，幫助以太坊私有鏈維護人員評估系統的性能與可靠性，本文實現了基於故障注入的以太坊性能測試系統。本文中依次實現了：（1）通過對以太坊私有鏈的性能分析，提出兩個以太坊性能影響因素，Difficulty、Gas Limit；（2）通過對分佈式系統故障與區塊鏈的特性進行分析，提出四種類型的故障，即應用故障、共識故障、智能合約故障、網絡故障。本系統可以獲取以太坊私有鏈的秒級性能指標信息，從而對以太坊的性能進行準確評估。本系統引入故障注入技術，可以在測試環境中注入故障，探究在故障情況下以太坊私有鏈的穩定性。最終，本系統可以對整個以太坊私有鏈進行一個完整的系統的評估。</p><p>本系統的整體架構設計如圖 1 所示。系統整體分成三部分：第一部分為前端展示，用戶通過瀏覽器進行訪問，輸入配置並輸出測試結果；第二部分為測試管理模塊，主體為 Web 服務器，用於解析、存儲用戶輸入的測試配置，根據功能可劃分為測試配置子模塊與結果管理子模塊；第三部分為測試執行模塊，主體為執行測試任務的命令行工具，根據功能可劃分為測試準備子模塊、性能測試子模塊與故障注入子模塊。</p><p>測試配置子模塊。測試配置子模塊負責讀取、驗證並生成測試配置。測試配置信息包括三種配置，即區塊鏈配置、性能測試配置與故障注入配置。區塊鏈配置為以太坊私有鏈啟動配置與創世區塊的配置。性能測試配置包括測試的請求速率、持續時間以及工作負載智能合約。故障配置包括故障類型、參數、開始、持續時間以及每種故障各自的配置。Difficulty 與 Gas Limit 的設置包含在區塊鏈配置中。圖 2 為這兩個參數影響以太坊吞吐量和交易延遲的原理，Difficulty 影響生成區塊的間隔、Gas Limit 影響區塊所能容納的交易數量。</p><div class=pgc-img><img alt=基於故障注入的以太坊性能測試系統 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/e7b0dcab7c77415a901d585a190e8c2b><p class=pgc-img-caption>圖 2 Difficulty 與 Gas Limit 對以太坊性能的影響</p></div><p><br></p><p>結果管理子模塊。結果管理子模塊主要負責處理測試任務執行完成後產生的測試結果數據，並對處理結果進行展示。在測試執行模塊完成測試任務後，會生成包含秒級性能指標的測試結果 JSON 文件。結果管理子模塊會讀取這些文件中的數據，存儲在 MongoDB 數據庫，以便後續查看。測試結果使用 Python 進行數據清洗，並計算吞吐量、延遲等指標的平均值、中位數等。</p><p>測試準備子模塊。測試準備子模塊主要處理開始執行測試任務之前所需的準備工作。模塊首先通過 Docker 啟動以太坊節點，並搭建 Docker Subnet 使節點之間可以互相識別。模塊通過文件夾掛載的形式傳遞節點的啟動命令、配置文件等信息。測試鏈搭建完成後，系統還會進行智能合約部署以及故障初始化等步驟。在本模塊所有步驟完成後，即可開始性能測試。測試結束後，容器自動銷燬，不保留區塊數據，減少存儲空間佔用。</p><p>性能測試子模塊。性能測試子模塊在測試準備子模塊執行結束後開始運行，主要負責按照設定的負載發送交易請求，收集並處理返回數據。本模塊使用 NodeJS 中的 Promise 機制實現大量性能測試交易請求並行處理。模塊以線程控制器為控制中心，通過向預先啟動好的線程發送開始測試的消息，所有線程將開始向每個以太坊節點發送交易請求，每個節點對應一個線程。線程使用以太坊團隊官方提供的 web3.js 作為與以太坊客戶端交互的 API。最終，每個線程會記錄每個節點的返回結果的數據，統一傳給主線程進行數據處理。主線程會計算出每秒的性能指標，得出最終的測試結果。</p><p>故障注入子模塊。故障注入子模塊負責在性能測試執行過程中注入故障，主要由故障控制器與四類故障注入的實現組成。故障注入子模塊首先會通過測試準備模塊對待注入的故障進行初始化。隨著性能測試的開始，故障計時器開始計時，當到達設定的時間時觸發故障注入事件。本模塊一共實現了四種類型的故障，分別是應用、共識、智能合約與網絡故障。除共識故障外，每種故障有可以配置參數以表示故障的嚴重程度。應用故障為流量波動故障，該故障由控制每個線程的請求速率實現。共識故障為節點的退出與加入，通過對 Docker 容器進行暫停和重啟實現。智能合約故障則實現了一個低性能的智能合約，通過將一半的正常請求轉化為低性能智能合約請求實現。網絡故障則通過 Docker 的混沌工程工具 Pumba 實現，可以對處於局域網中 Docker 容器注入網絡丟包和延遲。</p><h2 class=pgc-h-arrow-right>3. 項目效益</h2><p>為驗證性能影響因素與故障對以太坊私有鏈的性能與穩定性的影響，本文設計了兩組實驗：性能影響因素驗證實驗與故障注入驗證實驗。性能影響因素實驗分別設計了兩組 Difficulty 與 Gas Limit 值，探究以太坊私有鏈在不同請求速率下的性能表現。故障注入實驗針對每種故障設計了 3 組參數（除共識故障），在以太坊私有鏈穩定運行一段時間後注入故障，持續一段時間後恢復，探究其在故障注入後與恢復後的性能指標變化。</p><div class=pgc-img><img alt=基於故障注入的以太坊性能測試系統 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/109dc8ce163e40009a6f053ba9476759><p class=pgc-img-caption>(1) Difficulty 與 Gas Limit 驗證實驗結果</p></div><p><br></p><div class=pgc-img><img alt=基於故障注入的以太坊性能測試系統 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/a6ac5d7a84bb4c8ca1d38e11750e70b2><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於故障注入的以太坊性能測試系統 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/84cf3294b219459fbc353b8f37dfe305><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於故障注入的以太坊性能測試系統 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/add7478d388747f5b5d7b20637c84d04><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=基於故障注入的以太坊性能測試系統 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/8521cb7aa16a402f99c8bb2830bab54c><p class=pgc-img-caption></p></div><p>(2) 四類故障注入驗證實驗結果</p><p>圖 3 兩組實驗結果</p><p>圖 3-1 為性能影響因素驗證實驗的實驗結果。其中左右兩側分別為 Difficulty、Gas Limit 驗證實驗的吞吐量與延遲指標圖。每個圖 x 軸為性能影響因素，y 軸為性能測試請求速率，z 軸為性能指標。圖中可以看出這兩個影響因素對性能指標的影響呈相反趨勢。隨著 Difficulty 升高或 Gas Limit 降低，吞吐量越低，交易延遲越高，性能也越差。圖 3-2 為四類故障注入驗證實驗的實驗結果。其中從左到由分別為應用、共識、智能合約、網絡故障的吞吐量指標。每個圖分為四個階段，即啟動、穩定、注入、恢復。圖中可以看出這四類故障的注入均對以太坊私有鏈的吞吐量產生了顯著的影響，且不同參數的故障對性能影響程度有一定差異。在故障恢復後吞吐量均不能迅速恢復到穩定運行時的水平。</p><p>根據實驗結果，我們可以認為，本系統可以對以太坊私有鏈進行充分的性能測試，並可以通過故障注入等手段在測試環境下模擬真實的部署場景。本文識別的兩個性能影響因素與四類故障對以太坊私有鏈均有明顯的性能影響。</p><h2 class=pgc-h-arrow-right>4. 致謝</h2><p>本文由南京大學軟件學院智能軟件工程實驗室 2018 級碩士王新宇撰寫</p><p>感謝國家自然科學基金（61932012）和國家重點研發計劃：信息產品及科技服務集成化眾測服務平臺研發與應用 (2018YFB1403400)的支持</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>故障注入</a></li><li><a>測試</a></li><li><a>系統</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/96cce29.html alt=系統架構師之——測試評審方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/84a587df5a124777a10d126b233c7d9a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/96cce29.html title=系統架構師之——測試評審方法>系統架構師之——測試評審方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/031eafc4.html alt=電廠直流系統調試方案 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/5e8200036f19e04c25bf style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/031eafc4.html title=電廠直流系統調試方案>電廠直流系統調試方案</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fc3b4b2c.html alt=一文讀懂智能客服：發展歷程、系統搭建、市場推廣 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/RbYMTZ55OrJUgU style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fc3b4b2c.html title=一文讀懂智能客服：發展歷程、系統搭建、市場推廣>一文讀懂智能客服：發展歷程、系統搭建、市場推廣</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/51410370.html alt=生活垃圾焚燒發電及蒸汽系統優化改造項目公告 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RcblrbTDBokV23 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/51410370.html title=生活垃圾焚燒發電及蒸汽系統優化改造項目公告>生活垃圾焚燒發電及蒸汽系統優化改造項目公告</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b4913b56.html alt=電驅動橋系統或加快電氣化進程，多個案例共同說明問題 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1539571595921bc5b27eff6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b4913b56.html title=電驅動橋系統或加快電氣化進程，多個案例共同說明問題>電驅動橋系統或加快電氣化進程，多個案例共同說明問題</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6d1c2a0c.html alt=塑料扯斷伸長率的概念及測試要點 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/6fe0ba07-c929-4046-9216-7f6d5eaa1716 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6d1c2a0c.html title=塑料扯斷伸長率的概念及測試要點>塑料扯斷伸長率的概念及測試要點</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ebbbc375.html alt=時間繼電器測試儀的使用方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/1205bf787f1f4de6a5f1e73e7737887b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ebbbc375.html title=時間繼電器測試儀的使用方法>時間繼電器測試儀的使用方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9a7b7719.html alt=基於混沌系統的偽隨機數發生器設計 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9a7b7719.html title=基於混沌系統的偽隨機數發生器設計>基於混沌系統的偽隨機數發生器設計</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/99558abe.html alt=win10系統打印機打印不了顯示已暫停的解決方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/10d0de369d4746c7a0c220ff59bd2470 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/99558abe.html title=win10系統打印機打印不了顯示已暫停的解決方法>win10系統打印機打印不了顯示已暫停的解決方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2564328d.html alt=虛設投資交易系統吸引投資 成都破獲一特大團夥詐騙案 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2564328d.html title=虛設投資交易系統吸引投資 成都破獲一特大團夥詐騙案>虛設投資交易系統吸引投資 成都破獲一特大團夥詐騙案</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e4b6c065.html alt=全球定位系統（GPS），不只是導航 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/S7sY2h8G8GOmul style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e4b6c065.html title=全球定位系統（GPS），不只是導航>全球定位系統（GPS），不只是導航</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f75e014c.html alt=謹記！短線王者交易系統，學會極大概率提高買入與賣出的時機！掌握終身獲益無窮！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RL8KN4P57T39Db style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f75e014c.html title=謹記！短線王者交易系統，學會極大概率提高買入與賣出的時機！掌握終身獲益無窮！>謹記！短線王者交易系統，學會極大概率提高買入與賣出的時機！掌握終身獲益無窮！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0ad4f2c9.html alt="焦爐系統停電 —— 應急操作" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8ca2e135770644bfb97620aad1b362c0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0ad4f2c9.html title="焦爐系統停電 —— 應急操作">焦爐系統停電 —— 應急操作</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/75270289.html alt=win10系統如何使用返回桌面快捷鍵 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/822a8f5c52e1461a94e116d0e24871f0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/75270289.html title=win10系統如何使用返回桌面快捷鍵>win10系統如何使用返回桌面快捷鍵</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a435b80f.html alt=從操作系統（Windows）的角度討論中斷和異常機制 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/95371ea9a81e4e32b3cf7591d4dbbc83 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a435b80f.html title=從操作系統（Windows）的角度討論中斷和異常機制>從操作系統（Windows）的角度討論中斷和異常機制</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>