<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>C++哈希表是如何解決衝突的? | 极客快訊</title><meta property="og:title" content="C++哈希表是如何解決衝突的? - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/5ac4410086e640ea82846bde1dd72c65"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f5131775.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f5131775.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f5131775.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f5131775.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f5131775.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f5131775.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f5131775.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f5131775.html><meta property="article:published_time" content="2020-11-14T21:07:43+08:00"><meta property="article:modified_time" content="2020-11-14T21:07:43+08:00"><meta name=Keywords content><meta name=description content="C++哈希表是如何解決衝突的?"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/f5131775.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>C++哈希表是如何解決衝突的?</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>開放尋址是其中一種緩解散列衝突的編程技術，當使用開放尋址作為衝突解決技術時，鍵值對存儲在表（數組）中，而不是像單獨鏈表那樣的數據結構中。這意味著我們需要時刻留意哈希表的尺寸以及當前表中已有的元素數量。因為一旦哈希表中有太多元素，也將很難找到可用的位置來存放我們新插入的元素，因此這裡我們需要引入一個重要的術語，<strong>負載係數(Load Factor)</strong></p><h1 class=pgc-h-arrow-right>負載係數</h1><p><br></p><div class=pgc-img><img alt=C++哈希表是如何解決衝突的? onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5ac4410086e640ea82846bde1dd72c65><p class=pgc-img-caption></p></div><p><br>其實就是表中已有元素個數和表尺寸的比例，我們要密切關注這個係數的是因為哈希表的O(1)恆定時間行為假設負載因子k保持一定的固定值，這意味著一旦k>閾值，我們就需要增加表的大小（理想情況下是指數增長，例如，兩倍）<br></p><div class=pgc-img><img alt=C++哈希表是如何解決衝突的? onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/0b09e078be05428181a6a2837a30c810><p class=pgc-img-caption></p></div><p><br>在上圖中，你會看到有兩種緩解衝突的方法，即單獨鏈表和<strong>線性探測(Linear Probing)</strong>,在開放尋址(線性探測)技術看來，一旦達到某個閥值，它的時間複雜度就會呈現指數級惡化的趨勢</p><p><br></p><p>當我們想要將鍵值對插入哈希表時，我們對鍵進行哈希處理並獲得該鍵值對所屬位置的原始位置。如果我們的鍵被散列到的位置被佔用(此時出現了衝突)，對於開放尋址來說，同一個位置中不允許有兩個鍵的，這不是數組的工作方式，我們要做的是使用一個探測序列函數(Probing Seque Function) 這裡簡稱p(x)，因為我們已從散列函數獲取了衝突點的所在位置，現在我們使用p(x)進行探測直到在沿途發現一個空閒的位置為止</p><h1 class=pgc-h-arrow-right>探測函數</h1><p>您可以提出無限數量的探測序列，這裡僅提及一些常見的探測函數：</p><ul><li><strong>線性探測(Linear Probing)</strong>：p(x)= kx + b其中a，b是常數</li><li><strong>二次探測(Quaratic Probing)</strong>:p(x)= ax ^ 2 + bx + c，其中a，b，c是常數</li><li><strong>雙重散列(Double Hashing)</strong>:p(k，x)= x * h(k），其中h(k)是輔助s散列函數</li><li><strong>偽隨機數發生器(Pseudo Random Number Generator)</strong>: p(k，x)= x*RNG(h(k),x）其中RNG是以H（k）作為種子的隨機數生成器函數</li></ul><p>本篇僅介紹線性探測函數進行線性探測，因此給定輸入參數x,當我們進行探測時，我們通常會將變量x初始化為0或1作為一個起點,如果我們找不到空閒的位置，會依次將x增加1,對以上所有這些探測函數都是一樣的</p><h1 class=pgc-h-arrow-right>開放尋址的通用算法</h1><p>接下來，這是一個通用的開放尋址插入算法，假設我們有一個表的尺寸為n,開放尋址算法首先會初始化變量x=1,因為x是一個變量，我們要用它來探測，每當我們未能到達閒置的位置時，都需要遞增x，然後我們通過散列函數獲得keyHash,而實際上我們首先要查看錶的索引，當表索引被佔用意味著它不為空，那麼新索引就是我們散列的<strong>最初位置(keyHash所指向的起始索引)</strong>加上探測函數的總和再於表尺寸N取模運算得到整數，由於我們總是回到表裡，在循環中要遞增x。下一次當我們在不同的位置探測時，在while循環中，最終我們會找到一個空閒的位置</p><pre><code>x=1keyHash=h(k)index=keyHashwhile table[index]!=NULL:      index=(keyHash+p(k,x)) mod N      x=x+1insert(k,v,index) </code></pre><h1 class=pgc-h-arrow-right>死循環地獄（Chaos with Cycle）</h1><p>由於我們知道負載係數被控制在一定的範圍內，所以這裡有個問題，就是開放尋址中的探測函數存在缺陷--<strong>死循環地獄</strong>,以表尺寸N為模的大多數隨機選擇的探測序列將產生比表大小N更短的循環。當您嘗試插入一個鍵-值對並且循環中的所有存儲桶都被佔用時，這將成為災難性問題，因為您將陷入無限循環,這在一些老外談及哈希表的相關文章中有一個非常有趣的暱稱叫<strong>死循環地獄(Chaos with Cycle)</strong></p><p>為了生動說明什麼叫<strong>死循環地獄</strong>,我們這裡看一個例子，這裡有一個尺寸為12的哈希表，並且使用開放尋址插入了一些鍵值對，，該哈希表已經部分填充。 佔用的單元格填充有鍵值對（Ki，Vi）和帶有空令牌Φ的空單元格，如下圖所示</p><div class=pgc-img><img alt=C++哈希表是如何解決衝突的? onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/7aef56f5762e4a4e9f30e82944086778><p class=pgc-img-caption></p></div><p><br></p><p>假設我們使用探測序列函數p(x)=4x，並且在表中插入一個新的鍵值對，並且該鍵值對的散列值為8,即h(x)=8這意味著我們會在索引8的位置插入該鍵值對，但是該位置已被佔用，因為這裡已經有簡直對(k5,v5)，所以我們該怎麼辦呢？接下來，我們需要進行探測，所以我們計算： index=h(k)+p(1)=8+4 mod 12=0</p><p>此時，如下圖，此時探測函數會跳轉到索引為0的位置，糟糕的是索引1的位置也被佔用了，因為(k1,v1)已經存在.</p><p><br></p><div class=pgc-img><img alt=C++哈希表是如何解決衝突的? onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/305d3cd44d6a4bb3b1fddb6e214f12ab><p class=pgc-img-caption></p></div><ul><li>當x=2時，即index=h(k)+p(2)=(8+8) mod 12=4，探測函數會跳躍到索引4的位置，同樣這裡也是被佔用的，如此類推</li><li>當x=3時,即index=h(k)+p(3)=(8+12) mod 12=8,p(x)跳躍到索引8的位置,該位置被佔用</li><li>當x=4時,即index=h(k)+p(4)=(8+16) mod 12=0,p(x)跳躍到索引0的位置,該位置被佔用</li><li>當x=5時,即index=h(k)+p(5)=(8+20) mod 12=4,p(x)跳躍到索引4的位置,該位置被佔用<br>.....</li></ul><p>這樣儘管我們具有探測函數，但這種特定的情況下它一直在一個死循環裡面一直做一些毫無意義的事情。</p><p>由這個例子我們可知探測函數存在缺陷，他們產生的週期短於表的尺寸，因此，我們要如何處理產生小於表大小的週期的探測功能？一般來說，一致的看法是我們不處理這個問題，相反，我們通過將探測函數的範圍限制在那些產生長度為N的循環的函數上來避免這個問題，我們選擇的那些產生的週期正好為N的探測函數，並且這些探測函數確實存在。</p><p>線性探測、二次探測和雙重散列等技術都受到<strong>死循環地獄</strong>問題的影響，這就是為什麼與這些方法一起使用的探測函數非常特殊的原因。這是一個很大的話題，將是接下來幾篇文章會重點講述這些，我們目前需要做的是重新定義非常具體的探測函數，這些函數會產生一個循環長度為表尺寸N，並且避免無法插入元素或陷入無限循環</p><p>注意，開放尋址對使用的哈希函數和探測函數非常敏感。如果使用單獨的鏈接作為衝突解決方法，則不必擔心此問題。</p><h1 class=pgc-h-arrow-right>小結</h1><p>我們本篇用一個反例生動地介紹了開放尋址插入算法的底層是由探測函數和散列函數相互作用的結果，同時我們也介紹了一些探測函數的固有缺陷，就是<strong>死循環地獄</strong>,下一篇我們會詳細討論線性探測函數的原理，敬請期待。</p><p><br>鏈接：https://www.jianshu.com/p/b8c47701dd07</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>C++</a></li><li><a>哈希</a></li><li><a>表是</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/7d23b4d2.html alt=中國的第一份元素週期表是怎麼來的？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b412283a73a64e9aab0ca179d95ed889 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7d23b4d2.html title=中國的第一份元素週期表是怎麼來的？>中國的第一份元素週期表是怎麼來的？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/26327cd2.html alt=C++｜自定義偽隨機數和標準庫中的隨機數 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/26327cd2.html title=C++｜自定義偽隨機數和標準庫中的隨機數>C++｜自定義偽隨機數和標準庫中的隨機數</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0cdba029.html alt=C++｜徹底弄清偽隨機數與隨機數 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0cdba029.html title=C++｜徹底弄清偽隨機數與隨機數>C++｜徹底弄清偽隨機數與隨機數</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cb808de3.html alt=C++中的多態（動態多態）究竟是如何實現 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/30cae7ea5f5647deba7c518ed4e1a91b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cb808de3.html title=C++中的多態（動態多態）究竟是如何實現>C++中的多態（動態多態）究竟是如何實現</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/00674040.html alt=CC++語言16｜通過繼承、虛函數、指針來實現動態多態 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/00674040.html title=CC++語言16｜通過繼承、虛函數、指針來實現動態多態>CC++語言16｜通過繼承、虛函數、指針來實現動態多態</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2ea7884b.html alt=java程序員注意：少有人知的哈希衝突解決策略，學到就是賺到 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/54d45b20ef6a4a3f960411db61474538 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2ea7884b.html title=java程序員注意：少有人知的哈希衝突解決策略，學到就是賺到>java程序員注意：少有人知的哈希衝突解決策略，學到就是賺到</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c835605d.html alt=互聯網公司面試經，你不得不知道的哈希 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/80891c3b3b5d4f04b84078744a653aeb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c835605d.html title=互聯網公司面試經，你不得不知道的哈希>互聯網公司面試經，你不得不知道的哈希</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/37396ded.html alt=數據結構系列：哈希表？這涉及的是“加密/區塊鏈”等技術的核心 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/3609570de59a49a9be5667dd9a637f65 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/37396ded.html title=數據結構系列：哈希表？這涉及的是“加密/區塊鏈”等技術的核心>數據結構系列：哈希表？這涉及的是“加密/區塊鏈”等技術的核心</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/01b66ad2.html alt="漫畫 | 什麼是散列表（哈希表）？" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/e8a38bd3470c4c06befa051c4adbf665 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/01b66ad2.html title="漫畫 | 什麼是散列表（哈希表）？">漫畫 | 什麼是散列表（哈希表）？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b312402f.html alt=程序員面試中常見的哈希表，到底是什麼？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/35e957fe50484e03a497b640373bc5ec style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b312402f.html title=程序員面試中常見的哈希表，到底是什麼？>程序員面試中常見的哈希表，到底是什麼？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/92675aff.html alt=關於哈希表，你該瞭解這些 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8d18861a74ac4577abd03b0064a1016b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/92675aff.html title=關於哈希表，你該瞭解這些>關於哈希表，你該瞭解這些</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/21474a0e.html alt=一張圖搞定對哈希表的理解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4a49c66caf9044e7b086f48696b04283 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/21474a0e.html title=一張圖搞定對哈希表的理解>一張圖搞定對哈希表的理解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e03941dc.html alt=數據結構一(哈希表)想進大廠的必備知識點 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/86ad7a2f62cc48f98bbe53b42ca4bf9a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e03941dc.html title=數據結構一(哈希表)想進大廠的必備知識點>數據結構一(哈希表)想進大廠的必備知識點</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7267cf45.html alt=CC++語言19｜靜態成員（對象共享數據成員及其成員函數） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7267cf45.html title=CC++語言19｜靜態成員（對象共享數據成員及其成員函數）>CC++語言19｜靜態成員（對象共享數據成員及其成員函數）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f82b787b.html alt=流式編碼體驗：C++智能成員列表拉取 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d058f34e27f64b069d334ca6aa6cb793 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f82b787b.html title=流式編碼體驗：C++智能成員列表拉取>流式編碼體驗：C++智能成員列表拉取</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>