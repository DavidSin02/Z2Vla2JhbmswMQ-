<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>1ç¾å…ƒè¨“ç·´BERTï¼Œæ•™ä½ å¦‚ä½•è–…è°·æ­ŒTPUç¾Šæ¯›ï½œé™„Colabä»£ç¢¼ | æå®¢å¿«è¨Š</title><meta property="og:title" content="1ç¾å…ƒè¨“ç·´BERTï¼Œæ•™ä½ å¦‚ä½•è–…è°·æ­ŒTPUç¾Šæ¯›ï½œé™„Colabä»£ç¢¼ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/7e7fa9a848e043528bbbdc2b5acd77ca"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f5602a09.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f5602a09.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f5602a09.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f5602a09.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f5602a09.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f5602a09.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f5602a09.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f5602a09.html><meta property="article:published_time" content="2020-10-29T21:12:41+08:00"><meta property="article:modified_time" content="2020-10-29T21:12:41+08:00"><meta name=Keywords content><meta name=description content="1ç¾å…ƒè¨“ç·´BERTï¼Œæ•™ä½ å¦‚ä½•è–…è°·æ­ŒTPUç¾Šæ¯›ï½œé™„Colabä»£ç¢¼"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/f5602a09.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>1ç¾å…ƒè¨“ç·´BERTï¼Œæ•™ä½ å¦‚ä½•è–…è°·æ­ŒTPUç¾Šæ¯›ï½œé™„Colabä»£ç¢¼</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>ç§‘æŠ€</a></span></div><div class=post-content><div><blockquote><p>æ›‰æŸ¥ ç™¼è‡ª å‡¹éå¯º</p><p>é‡å­ä½ å‡ºå“ | å…¬çœ¾è™Ÿ QbitAI</p></blockquote><p class=ql-align-center><br></p><div class=pgc-img><img alt=1ç¾å…ƒè¨“ç·´BERTï¼Œæ•™ä½ å¦‚ä½•è–…è°·æ­ŒTPUç¾Šæ¯›ï½œé™„Colabä»£ç¢¼ onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7e7fa9a848e043528bbbdc2b5acd77ca><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p>BERTæ˜¯è°·æ­Œå»å¹´æ¨å‡ºçš„NLPæ¨¡å‹ï¼Œä¸€ç¶“æ¨å‡ºå°±åœ¨å„é …æ¸¬è©¦ä¸­ç¢¾å£“ç«¶çˆ­å°æ‰‹ï¼Œè€Œä¸”BERTæ˜¯é–‹æºçš„ã€‚åªå¯æƒœè¨“ç·´BERTçš„åƒ¹æ ¼å¯¦åœ¨å¤ªé«˜ï¼Œè®“äººæœ›è€Œå»æ­¥ã€‚</p><p>ä¹‹å‰éœ€è¦ç”¨64å€‹TPUè¨“ç·´4å¤©æ‰èƒ½å®Œæˆï¼Œå¾Œä¾†è°·æ­Œç”¨ä¸¦è¡Œè¨ˆç®—å„ªåŒ–äº†åˆ°åªéœ€ä¸€å€‹å¤šå°æ™‚ï¼Œä½†æ˜¯éœ€è¦çš„TPUæ•¸é‡é™¡å¢ï¼Œé”åˆ°äº†é©šäººçš„1024å€‹ã€‚</p><p>é‚£éº¼ç¸½å…±è¦å¤šå°‘éŒ¢å‘¢ï¼Ÿè°·æ­Œé›²TPUçš„ä½¿ç”¨åƒ¹æ ¼æ˜¯æ¯å€‹æ¯å°æ™‚6.5ç¾å…ƒï¼Œè¨“ç·´å®Œæˆè¨“ç·´å®Œæ•´å€‹æ¨¡å‹éœ€è¦è¿‘4è¬ç¾å…ƒï¼Œç°¡ç›´å°±æ˜¯å¤©åƒ¹ã€‚</p><p>ç¾åœ¨ï¼Œæœ‰å€‹ç¾Šæ¯›å‘Šè¨´ä½ ï¼Œåœ¨åŸ¹é¤ŠåŸºä¸Šæœ‰äººæ‰¾åˆ°äº†è–…è°·æ­Œç¾Šæ¯›çš„è¾¦æ³•ï¼Œåªéœ€1ç¾å…ƒå°±èƒ½è¨“ç·´BERTï¼Œæ¨¡å‹é‚„èƒ½ç•™å­˜åœ¨ä½ çš„è°·æ­Œé›²ç›¤ä¸­ï¼Œç•™ä½œä»¥å¾Œä½¿ç”¨ã€‚</p><p><strong>æº–å‚™å·¥ä½œ</strong></p><p>ç‚ºäº†è–…è°·æ­Œçš„ç¾Šæ¯›ï¼Œæ‚¨éœ€è¦ä¸€å€‹Googleé›²å­˜å„²ï¼ˆGoogle Cloud Storageï¼‰ç©ºé–“ã€‚æŒ‰ç…§Googleé›²TPUå¿«é€Ÿå…¥é–€æŒ‡å—ï¼Œå‰µå»ºGoogleé›²å¹³è‡ºï¼ˆGoogle Cloud Platformï¼‰å¸³æˆ¶å’ŒGoogleé›²å­˜å„²è³¬æˆ¶ã€‚æ–°çš„è°·æ­Œé›²å¹³è‡ºç”¨æˆ¶å¯ç²å¾—300ç¾å…ƒçš„å…è²»è´ˆé€é‡‘é¡ã€‚</p><p class=ql-align-center><br></p><div class=pgc-img><img alt=1ç¾å…ƒè¨“ç·´BERTï¼Œæ•™ä½ å¦‚ä½•è–…è°·æ­ŒTPUç¾Šæ¯›ï½œé™„Colabä»£ç¢¼ onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ad9854f2e94c43b691b97771651cbe19><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p>åœ¨TPUv2ä¸Šé è¨“ç·´BERT-Baseæ¨¡å‹å¤§ç´„éœ€è¦54å°æ™‚.Google Colabä¸¦éè¨­è¨ˆç”¨æ–¼åŸ·è¡Œé•·æ™‚é–“é‹è¡Œçš„ä½œæ¥­ï¼Œå®ƒæœƒæ¯8å°æ™‚å·¦å³ä¸­æ–·ä¸€æ¬¡è¨“ç·´éç¨‹ã€‚å°æ–¼ä¸é–“æ–·çš„è¨“ç·´ï¼Œè«‹è€ƒæ…®ä½¿ç”¨ä»˜è²»çš„ä¸é–“æ–·ä½¿ç”¨TPUv2çš„æ–¹æ³•ã€‚</p><p>ä¹Ÿå°±æ˜¯èªªï¼Œä½¿ç”¨Colab TPUï¼Œä½ å¯ä»¥åœ¨ä»¥1ç¾å…ƒçš„åƒ¹æ ¼åœ¨è°·é›²ç›¤ä¸Šå­˜å„²æ¨¡å‹å’Œæ•¸æ“šï¼Œä»¥å¹¾ä¹å¯å¿½ç•¥æˆæœ¬å¾é ­é–‹å§‹é è¨“ç·´BERTæ¨¡å‹ã€‚</p><p>ä»¥ä¸‹æ˜¯æ•´å€‹éç¨‹çš„ä»£ç¢¼ä¸‹é¢çš„ä»£ç¢¼ï¼Œå¯ä»¥åœ¨Colab Jupyterç’°å¢ƒä¸­é‹è¡Œã€‚</p><h1><strong>è¨­ç½®è¨“ç·´ç’°å¢ƒ</strong></h1><p>é¦–å…ˆï¼Œå®‰è£è¨“ç·´æ¨¡å‹æ‰€éœ€çš„åŒ….Jupyterå…è¨±ä½¿ç”¨ç›´æ¥å¾ç­†è¨˜æœ¬åŸ·è¡Œçš„bashå‘½ä»¤ 'ï¼'ï¼š</p><pre>!pip install sentencepiece!git clone https://github.com/google-research/bert</pre><p>å°å…¥åŒ…ä¸¦åœ¨è°·æ­Œé›²ä¸­æˆæ¬Šï¼š</p><pre>import osimport sysimport jsonimport nltkimport randomimport loggingimport tensorflow as tfimport sentencepiece as spmfrom glob import globfrom google.colab import auth, drivefrom tensorflow.keras.utils import Progbarsys.path.append("bert")from bert import modeling, optimization, tokenizationfrom bert.run_pretraining import input_fn_builder, model_fn_builderauth.authenticate_user()# configure logginglog = logging.getLogger('tensorflow')log.setLevel(logging.INFO)# create formatter and add it to the handlersformatter = logging.Formatter('%(asctime)s : %(message)s')sh = logging.StreamHandler()sh.setLevel(logging.INFO)sh.setFormatter(formatter)log.handlers = [sh]if 'COLAB_TPU_ADDR' in os.environ: log.info("Using TPU runtime") USE_TPU = True TPU_ADDRESS = 'grpc://' + os.environ['COLAB_TPU_ADDR'] with tf.Session(TPU_ADDRESS) as session: log.info('TPU address is ' + TPU_ADDRESS) # Upload credentials to TPU. with open('/content/adc.json', 'r') as f: auth_info = json.load(f) tf.contrib.cloud.configure_gcs(session, credentials=auth_info)else: log.warning('Not connected to TPU runtime') USE_TPU = False</pre><h1><strong>ä¸‹è¼‰åŸå§‹æ–‡æœ¬æ•¸æ“š</strong></h1><p>æ¥ä¸‹ä¾†å¾ç¶²çµ¡ä¸Šç²å–æ–‡æœ¬æ•¸æ“šèªæ–™åº«ã€‚åœ¨æœ¬æ¬¡å¯¦é©—ä¸­ï¼Œæˆ‘å€‘ä½¿ç”¨OpenSubtitlesæ•¸æ“šé›†ï¼Œè©²æ•¸æ“šé›†åŒ…æ‹¬65ç¨®èªè¨€ã€‚</p><p>èˆ‡æ›´å¸¸ç”¨çš„æ–‡æœ¬æ•¸æ“šé›†ï¼ˆå¦‚ç¶­åŸºç™¾ç§‘ï¼‰ä¸åŒï¼Œå®ƒä¸éœ€è¦ä»»ä½•è¤‡é›œçš„é è™•ç†ï¼Œæä¾›é æ ¼å¼åŒ–ï¼Œä¸€è¡Œä¸€å€‹å¥å­ã€‚</p><pre>AVAILABLE = {'af','ar','bg','bn','br','bs','ca','cs', 'da','de','el','en','eo','es','et','eu', 'fa','fi','fr','gl','he','hi','hr','hu', 'hy','id','is','it','ja','ka','kk','ko', 'lt','lv','mk','ml','ms','nl','no','pl', 'pt','pt_br','ro','ru','si','sk','sl','sq', 'sr','sv','ta','te','th','tl','tr','uk', 'ur','vi','ze_en','ze_zh','zh','zh_cn', 'zh_en','zh_tw','zh_zh'}LANG_CODE = "en" #@param {type:"string"}assert LANG_CODE in AVAILABLE, "Invalid language code selected"!wget http://opus.nlpl.eu/download.php?f=OpenSubtitles/v2016/mono/OpenSubtitles.raw.'$LANG_CODE'.gz -O dataset.txt.gz!gzip -d dataset.txt.gz!tail dataset.txt</pre><p>ä½ å¯ä»¥é€šéè¨­ç½®ä»£ç¢¼éš¨æ„é¸æ“‡ä½ éœ€è¦çš„èªè¨€ã€‚å‡ºæ–¼æ¼”ç¤ºç›®çš„ï¼Œä»£ç¢¼åªé»˜èªä½¿ç”¨æ•´å€‹èªæ–™åº«çš„ä¸€å°éƒ¨åˆ†ã€‚åœ¨å¯¦éš›è¨“ç·´æ¨¡å‹æ™‚ï¼Œè«‹å‹™å¿…å–æ¶ˆé¸ä¸­DEMO_MODEè¤‡é¸æ¡†ï¼Œä½¿ç”¨å¤§100å€çš„æ•¸æ“šé›†ã€‚</p><p>ç•¶ç„¶ï¼Œ100Mæ•¸æ“šè¶³ä»¥è¨“ç·´å‡ºç›¸ç•¶ä¸éŒ¯çš„BERTåŸºç¤æ¨¡å‹ã€‚</p><pre>DEMO_MODE = True #@param {type:"boolean"}if DEMO_MODE: CORPUS_SIZE = 1000000else: CORPUS_SIZE = 100000000 #@param {type: "integer"}!(head -n $CORPUS_SIZE dataset.txt) &gt; subdataset.txt!mv subdataset.txt dataset.txt</pre><h1><strong>é è™•ç†æ–‡æœ¬æ•¸æ“š</strong></h1><p>æˆ‘å€‘ä¸‹è¼‰çš„åŸå§‹æ–‡æœ¬æ•¸æ“šåŒ…å«æ¨™é»ç¬¦è™Ÿï¼Œå¤§å¯«å­—æ¯å’ŒéUTFç¬¦è™Ÿï¼Œæˆ‘å€‘å°‡åœ¨ç¹¼çºŒä¸‹ä¸€æ­¥ä¹‹å‰å°‡å…¶åˆªé™¤ã€‚åœ¨æ¨ç†æœŸé–“ï¼Œæˆ‘å€‘å°‡å°æ–°æ•¸æ“šæ‡‰ç”¨ç›¸åŒçš„éç¨‹ã€‚</p><p>å¦‚æœä½ éœ€è¦ä¸åŒçš„é è™•ç†æ–¹å¼ï¼ˆä¾‹å¦‚åœ¨æ¨ç†æœŸé–“é æœŸæœƒå‡ºç¾å¤§å¯«å­—æ¯æˆ–æ¨™é»ç¬¦è™Ÿï¼‰ï¼Œè«‹ä¿®æ”¹ä»¥ä¸‹ä»£ç¢¼ä»¥æ»¿è¶³ä½ çš„éœ€æ±‚ã€‚</p><pre>regex_tokenizer = nltk.RegexpTokenizer("\w+")def normalize_text(text): # lowercase text text = str(text).lower() # remove non-UTF text = text.encode("utf-8", "ignore").decode() # remove punktuation symbols text = " ".join(regex_tokenizer.tokenize(text)) return textdef count_lines(filename): count = 0 with open(filename) as fi: for line in fi: count += 1 return count</pre><p>ç¾åœ¨è®“æˆ‘å€‘é è™•ç†æ•´å€‹æ•¸æ“šé›†ï¼š</p><pre>RAW_DATA_FPATH = "dataset.txt" #@param {type: "string"}PRC_DATA_FPATH = "proc_dataset.txt" #@param {type: "string"}# apply normalization to the dataset# this will take a minute or twototal_lines = count_lines(RAW_DATA_FPATH)bar = Progbar(total_lines)with open(RAW_DATA_FPATH,encoding="utf-8") as fi: with open(PRC_DATA_FPATH, "w",encoding="utf-8") as fo: for l in fi: fo.write(normalize_text(l)+"\n") bar.add(1)</pre><h1><strong>æ§‹å»ºè©å½™è¡¨</strong></h1><p>ä¸‹ä¸€æ­¥ï¼Œæˆ‘å€‘å°‡è¨“ç·´æ¨¡å‹å­¸ç¿’ä¸€å€‹æ–°çš„è©å½™è¡¨ï¼Œç”¨æ–¼è¡¨ç¤ºæˆ‘å€‘çš„æ•¸æ“šé›†ã€‚</p><p>BERTæ–‡ä»¶ä½¿ç”¨WordPieceåˆ†è©å™¨ï¼Œåœ¨é–‹æºä¸­ä¸å¯ç”¨ã€‚æˆ‘å€‘å°‡åœ¨å–®å­—æ¨¡å¼ä¸‹ä½¿ç”¨SentencePieceåˆ†è©å™¨ã€‚é›–ç„¶å®ƒèˆ‡BERTä¸ç›´æ¥å…¼å®¹ï¼Œä½†æ˜¯é€šéä¸€å€‹å°çš„è™•ç†æ–¹æ³•ï¼Œå¯ä»¥ä½¿å®ƒå·¥ä½œã€‚</p><p>SentencePieceéœ€è¦ç›¸ç•¶å¤šçš„é‹è¡Œå…§å­˜ï¼Œå› æ­¤åœ¨Colabä¸­çš„é‹è¡Œå®Œæ•´æ•¸æ“šé›†æœƒå°è‡´å…§æ ¸å´©æ½°ã€‚</p><p>ç‚ºé¿å…é€™ç¨®æƒ…æ³ï¼Œæˆ‘å€‘å°‡éš¨æ©Ÿå°æ•¸æ“šé›†çš„ä¸€å°éƒ¨åˆ†é€²è¡Œå­æ¡æ¨£ï¼Œæ§‹å»ºè©å½™è¡¨ã€‚å¦ä¸€å€‹é¸æ“‡æ˜¯ä½¿ç”¨æ›´å¤§å…§å­˜çš„æ©Ÿå™¨ä¾†åŸ·è¡Œæ­¤æ­¥é©Ÿã€‚</p><p>æ­¤å¤–ï¼ŒSentencePieceé»˜èªæƒ…æ³ä¸‹å°‡BOSå’ŒEOSæ§åˆ¶ç¬¦è™Ÿæ·»åŠ åˆ°è©å½™è¡¨ä¸­ã€‚æˆ‘å€‘é€šéå°‡å…¶ç´¢å¼•è¨­ç½®ç‚º-1ä¾†ç¦ç”¨å®ƒå€‘ã€‚</p><p>VOC_SIZEçš„å…¸å‹å€¼ä»‹æ–¼32000å’Œ128000ä¹‹é–“ã€‚å¦‚æœæƒ³è¦æ›´æ–°è©å½™è¡¨ï¼Œä¸¦åœ¨é è¨“ç·´éšæ®µçµæŸå¾Œå°æ¨¡å‹é€²è¡Œå¾®èª¿ï¼Œæˆ‘å€‘æœƒä¿ç•™NUM_PLACEHOLDERSå€‹ä»¤ç‰Œã€‚</p><pre>MODEL_PREFIX = "tokenizer" #@param {type: "string"}VOC_SIZE = 32000 #@param {type:"integer"}SUBSAMPLE_SIZE = 12800000 #@param {type:"integer"}NUM_PLACEHOLDERS = 256 #@param {type:"integer"}SPM_COMMAND = ('--input={} --model_prefix={} ' '--vocab_size={} --input_sentence_size={} ' '--shuffle_input_sentence=true '  '--bos_id=-1 --eos_id=-1').format( PRC_DATA_FPATH, MODEL_PREFIX,  VOC_SIZE - NUM_PLACEHOLDERS, SUBSAMPLE_SIZE)spm.SentencePieceTrainer.Train(SPM_COMMAND)</pre><p>ç¾åœ¨ï¼Œè®“æˆ‘å€‘çœ‹çœ‹å¦‚ä½•è®“SentencePieceåœ¨BERTæ¨¡å‹ä¸Šå·¥ä½œã€‚</p><p>ä¸‹é¢æ˜¯ä½¿ç”¨ä¾†è‡ªå®˜æ–¹çš„é è¨“ç·´è‹±èªBERTåŸºç¤æ¨¡å‹çš„WordPieceè©å½™è¡¨æ¨™è¨˜çš„èªå¥ã€‚</p><pre>&gt;&gt;&gt; wordpiece.tokenize("Colorless geothermal substations are generating furiously")['color', '##less', 'geo', '##thermal', 'sub', '##station', '##s', 'are', 'generating', 'furiously']</pre><p>WordPieceæ¨™è¨˜å™¨åœ¨â€œ##â€çš„å–®è©ä¸­é–“é ç½®äº†å‡ºç¾çš„å­å­—ã€‚åœ¨å–®è©é–‹é ­å‡ºç¾çš„å­è©ä¸è®Šã€‚å¦‚æœå­è©å‡ºç¾åœ¨å–®è©çš„é–‹é ­å’Œä¸­é–“ï¼Œå‰‡å…©å€‹ç‰ˆæœ¬ï¼ˆå¸¶å’Œä¸å¸¶â€ ##'ï¼‰éƒ½æœƒæ·»åŠ åˆ°è©å½™è¡¨ä¸­ã€‚</p><p>SentencePieceå‰µå»ºäº†å…©å€‹æ–‡ä»¶ï¼štokenizer.modelå’Œtokenizer.vocabè®“æˆ‘å€‘ä¾†çœ‹çœ‹å®ƒå­¸åˆ°çš„è©å½™ï¼š</p><pre>def read_sentencepiece_vocab(filepath): voc = [] with open(filepath, encoding='utf-8') as fi: for line in fi: voc.append(line.split("\t")[0]) # skip the first &lt;unk&gt; token voc = voc[1:] return vocsnt_vocab = read_sentencepiece_vocab("{}.vocab".format(MODEL_PREFIX))print("Learnt vocab size: {}".format(len(snt_vocab)))print("Sample tokens: {}".format(random.sample(snt_vocab, 10)))</pre><p>é‹è¡Œçµæœï¼š</p><pre>Learnt vocab size: 31743 Sample tokens: ['â–cafe', 'â–slippery', 'xious', 'â–resonate', 'â–terrier', 'â–feat', 'â–frequencies', 'ainty', 'â–punning', 'modern']</pre><p>SentencePieceèˆ‡WordPieceçš„é‹è¡Œçµæœå®Œå…¨ç›¸åå¾æ–‡æª”ä¸­å¯ä»¥çœ‹å‡ºï¼šSentencePieceé¦–å…ˆä½¿ç”¨å…ƒç¬¦è™Ÿâ€œ_â€å°‡ç©ºæ ¼è½‰ç¾©ç‚ºç©ºæ ¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li><br></li></ul><pre>Hello_Worldã€‚</pre><p>ç„¶å¾Œæ–‡æœ¬è¢«åˆ†æ®µç‚ºå°å¡Šï¼š</p><ul><li><br></li></ul><pre>[Hello] [_Wor] [ld] [.]</pre><p>åœ¨ç©ºæ ¼ä¹‹å¾Œå‡ºç¾çš„å­è©ï¼ˆä¹Ÿæ˜¯å¤§å¤šæ•¸è©é–‹é ­çš„å­è©ï¼‰å‰é¢åŠ ä¸Šâ€œ_â€ï¼Œè€Œå…¶ä»–å­è©ä¸è®Šã€‚é€™æ’é™¤äº†åƒ…å‡ºç¾åœ¨å¥å­é–‹é ­è€Œä¸æ˜¯å…¶ä»–åœ°æ–¹çš„å­è©ã€‚ç„¶è€Œï¼Œé€™äº›æ¡ˆä»¶æ‡‰è©²éå¸¸ç½•è¦‹ã€‚</p><p>å› æ­¤ï¼Œç‚ºäº†ç²å¾—é¡ä¼¼æ–¼WordPieceçš„è©å½™è¡¨ï¼Œæˆ‘å€‘éœ€è¦åŸ·è¡Œä¸€å€‹ç°¡å–®çš„è½‰æ›ï¼Œå¾åŒ…å«å®ƒçš„æ¨™è¨˜ä¸­åˆªé™¤â€œ_â€ï¼Œä¸¦å°‡â€œ##â€æ·»åŠ åˆ°ä¸åŒ…å«å®ƒçš„æ¨™è¨˜ä¸­ã€‚</p><p>æˆ‘å€‘é‚„æ·»åŠ äº†ä¸€äº›BERTæ¶æ§‹æ‰€éœ€çš„ç‰¹æ®Šæ§åˆ¶ç¬¦è™Ÿã€‚æŒ‰ç…§æ…£ä¾‹ï¼Œæˆ‘å€‘æŠŠå®ƒå€‘æ”¾åœ¨è©å½™çš„é–‹é ­ã€‚</p><p>å¦å¤–ï¼Œæˆ‘å€‘åœ¨è©å½™è¡¨ä¸­æ·»åŠ äº†ä¸€äº›ä½”ä½ç¬¦æ¨™è¨˜ã€‚</p><p>å¦‚æœä½ å¸Œæœ›ä½¿ç”¨æ–°çš„ç”¨æ–¼ç‰¹å®šä»»å‹™çš„ä»¤ç‰Œä¾†æ›´æ–°é å…ˆè¨“ç·´çš„æ¨¡å‹ï¼Œé‚£éº¼é€™äº›æ–¹æ³•æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚</p><p>åœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œä½”ä½ç¬¦æ¨™è¨˜è¢«æ›¿æ›ç‚ºæ–°çš„ä»¤ç‰Œï¼Œé‡æ–°ç”Ÿæˆé è¨“ç·´æ•¸æ“šï¼Œä¸¦ä¸”å°æ–°æ•¸æ“šé€²è¡Œå¾®èª¿ã€‚</p><pre>def parse_sentencepiece_token(token): if token.startswith("â–"): return token[1:] else: return "##" + tokenbert_vocab = list(map(parse_sentencepiece_token, snt_vocab))ctrl_symbols = ["[PAD]","[UNK]","[CLS]","[SEP]","[MASK]"]bert_vocab = ctrl_symbols + bert_vocabbert_vocab += ["[UNUSED_{}]".format(i) for i in range(VOC_SIZE - len(bert_vocab))]print(len(bert_vocab))</pre><p>æœ€å¾Œï¼Œæˆ‘å€‘å°‡ç²å¾—çš„è©å½™è¡¨å¯«å…¥æ–‡ä»¶ã€‚</p><pre>VOC_FNAME = "vocab.txt" #@param {type:"string"}with open(VOC_FNAME, "w") as fo: for token in bert_vocab: fo.write(token+"\n")</pre><p>ç¾åœ¨ï¼Œè®“æˆ‘å€‘çœ‹çœ‹æ–°è©å½™åœ¨å¯¦è¸ä¸­æ˜¯å¦‚ä½•é‹ä½œçš„ï¼š</p><pre>&gt;&gt;&gt; testcase = "Colorless geothermal substations are generating furiously"&gt;&gt;&gt; bert_tokenizer = tokenization.FullTokenizer(VOC_FNAME)&gt;&gt;&gt; bert_tokenizer.tokenize(testcase)['color',  '##less',  'geo',  '##ther',  '##mal',  'sub',  '##station',  '##s',  'are',  'generat',  '##ing',  'furious',  '##ly']</pre><h1><strong>å‰µå»ºåˆ†ç‰‡é è¨“ç·´æ•¸æ“šï¼ˆç”Ÿæˆé è¨“ç·´æ•¸æ“šï¼‰</strong></h1><p>é€šéæ‰‹é ­çš„è©å½™è¡¨ï¼Œæˆ‘å€‘å¯ä»¥ç‚ºBERTæ¨¡å‹ç”Ÿæˆé è¨“ç·´æ•¸æ“šã€‚</p><p>ç”±æ–¼æˆ‘å€‘çš„æ•¸æ“šé›†å¯èƒ½éå¸¸å¤§ï¼Œæˆ‘å€‘å°‡å…¶æ‹†åˆ†ç‚ºç¢ç‰‡ï¼š</p><pre>mkdir ./shardssplit -a 4 -l 256000 -d $PRC_DATA_FPATH ./shards/shard_</pre><p>ç¾åœ¨ï¼Œå°æ–¼æ¯å€‹éƒ¨åˆ†ï¼Œæˆ‘å€‘éœ€è¦å¾BERTå€‰åº«èª¿ç”¨create_pretraining_data.pyè…³æœ¬ï¼Œéœ€è¦ä½¿ç”¨xargsçš„å‘½ä»¤ã€‚</p><p>åœ¨é–‹å§‹ç”Ÿæˆä¹‹å‰ï¼Œæˆ‘å€‘éœ€è¦è¨­ç½®ä¸€äº›åƒæ•¸å‚³éçµ¦è…³æœ¬ã€‚ä½ å¯ä»¥å¾è‡ªè¿°æ–‡ä»¶ä¸­æ‰¾åˆ°æœ‰é—œå®ƒå€‘å«ç¾©çš„æ›´å¤šä¿¡æ¯ã€‚</p><pre>MAX_SEQ_LENGTH = 128 #@param {type:"integer"}MASKED_LM_PROB = 0.15 #@paramMAX_PREDICTIONS = 20 #@param {type:"integer"}DO_LOWER_CASE = True #@param {type:"boolean"}PRETRAINING_DIR = "pretraining_data" #@param {type:"string"}# controls how many parallel processes xargs can createPROCESSES = 2 #@param {type:"integer"}</pre><p>é‹è¡Œæ­¤æ“ä½œå¯èƒ½éœ€è¦ç›¸ç•¶é•·çš„æ™‚é–“ï¼Œå…·é«”å–æ±ºæ–¼æ•¸æ“šé›†çš„å¤§å°ã€‚</p><pre>XARGS_CMD = ("ls ./shards/ | " "xargs -n 1 -P {} -I{} " "python3 bert/create_pretraining_data.py " "--input_file=./shards/{} " "--output_file={}/{}.tfrecord " "--vocab_file={} " "--do_lower_case={} " "--max_predictions_per_seq={} " "--max_seq_length={} " "--masked_lm_prob={} " "--random_seed=34 " "--dupe_factor=5")XARGS_CMD = XARGS_CMD.format(PROCESSES, '{}', '{}', PRETRAINING_DIR, '{}',  VOC_FNAME, DO_LOWER_CASE,  MAX_PREDICTIONS, MAX_SEQ_LENGTH, MASKED_LM_PROB)tf.gfile.MkDir(PRETRAINING_DIR)!$XARGS_CMD</pre><h1><strong>ç‚ºæ•¸æ“šå’Œæ¨¡å‹è¨­ç½®GCSå­˜å„²ï¼Œå°‡æ•¸æ“šå’Œæ¨¡å‹å­˜å„²åˆ°é›²ç«¯</strong></h1><p>ç‚ºäº†ä¿ç•™ä¾†ä¹‹ä¸æ˜“çš„è¨“ç·´æ¨¡å‹ï¼Œæˆ‘å€‘æœƒå°‡å…¶ä¿ç•™åœ¨è°·æ­Œé›²å­˜å„²ä¸­ã€‚</p><p>åœ¨è°·æ­Œé›²å­˜å„²ä¸­å‰µå»ºå…©å€‹ç›®éŒ„ï¼Œä¸€å€‹ç”¨æ–¼æ•¸æ“šï¼Œä¸€å€‹ç”¨æ–¼æ¨¡å‹ã€‚åœ¨æ¨¡å‹ç›®éŒ„ä¸­ï¼Œæˆ‘å€‘å°‡æ”¾ç½®æ¨¡å‹è©å½™è¡¨å’Œé…ç½®æ–‡ä»¶ã€‚</p><p>åœ¨ç¹¼çºŒæ“ä½œä¹‹å‰ï¼Œè«‹é…ç½®BUCKET_NAMEè®Šé‡ï¼Œå¦å‰‡å°‡ç„¡æ³•è¨“ç·´æ¨¡å‹ã€‚</p><pre>BUCKET_NAME = "bert_resourses" #@param {type:"string"}MODEL_DIR = "bert_model" #@param {type:"string"}tf.gfile.MkDir(MODEL_DIR)if not BUCKET_NAME: log.warning("WARNING: BUCKET_NAME is not set. " "You will not be able to train the model.")</pre><p>ä¸‹é¢æ˜¯BERTåŸºçš„è¶…åƒæ•¸é…ç½®ç¤ºä¾‹ï¼š</p><pre># use this for BERT-basebert_base_config = { "attention_probs_dropout_prob": 0.1,  "directionality": "bidi",  "hidden_act": "gelu",  "hidden_dropout_prob": 0.1,  "hidden_size": 768,  "initializer_range": 0.02,  "intermediate_size": 3072,  "max_position_embeddings": 512,  "num_attention_heads": 12,  "num_hidden_layers": 12,  "pooler_fc_size": 768,  "pooler_num_attention_heads": 12,  "pooler_num_fc_layers": 3,  "pooler_size_per_head": 128,  "pooler_type": "first_token_transform",  "type_vocab_size": 2,  "vocab_size": VOC_SIZE}with open("{}/bert_config.json".format(MODEL_DIR), "w") as fo: json.dump(bert_base_config, fo, indent=2)with open("{}/{}".format(MODEL_DIR, VOC_FNAME), "w") as fo: for token in bert_vocab: fo.write(token+"\n")</pre><p>ç¾åœ¨ï¼Œæˆ‘å€‘å·²æº–å‚™å¥½å°‡æ¨¡å‹å’Œæ•¸æ“šå­˜å„²åˆ°è°·æ­Œé›²ç•¶ä¸­ï¼š</p><pre>if BUCKET_NAME: !gsutil -m cp -r $MODEL_DIR $PRETRAINING_DIR gs://$BUCKET_NAME</pre><h1><strong>åœ¨é›²TPUä¸Šè¨“ç·´æ¨¡å‹</strong></h1><p>æ³¨æ„ï¼Œä¹‹å‰æ­¥é©Ÿä¸­çš„æŸäº›åƒæ•¸åœ¨æ­¤è™•ä¸ç”¨æ”¹è®Šã€‚è«‹ç¢ºä¿åœ¨æ•´å€‹å¯¦é©—ä¸­è¨­ç½®çš„åƒæ•¸å®Œå…¨ç›¸åŒã€‚</p><pre>BUCKET_NAME = "bert_resourses" #@param {type:"string"}MODEL_DIR = "bert_model" #@param {type:"string"}PRETRAINING_DIR = "pretraining_data" #@param {type:"string"}VOC_FNAME = "vocab.txt" #@param {type:"string"}# Input data pipeline configTRAIN_BATCH_SIZE = 128 #@param {type:"integer"}MAX_PREDICTIONS = 20 #@param {type:"integer"}MAX_SEQ_LENGTH = 128 #@param {type:"integer"}MASKED_LM_PROB = 0.15 #@param# Training procedure configEVAL_BATCH_SIZE = 64LEARNING_RATE = 2e-5TRAIN_STEPS = 1000000 #@param {type:"integer"}SAVE_CHECKPOINTS_STEPS = 2500 #@param {type:"integer"}NUM_TPU_CORES = 8if BUCKET_NAME: BUCKET_PATH = "gs://{}".format(BUCKET_NAME)else: BUCKET_PATH = "."BERT_GCS_DIR = "{}/{}".format(BUCKET_PATH, MODEL_DIR)DATA_GCS_DIR = "{}/{}".format(BUCKET_PATH, PRETRAINING_DIR)VOCAB_FILE = os.path.join(BERT_GCS_DIR, VOC_FNAME)CONFIG_FILE = os.path.join(BERT_GCS_DIR, "bert_config.json")INIT_CHECKPOINT = tf.train.latest_checkpoint(BERT_GCS_DIR)bert_config = modeling.BertConfig.from_json_file(CONFIG_FILE)input_files = tf.gfile.Glob(os.path.join(DATA_GCS_DIR,'*tfrecord'))log.info("Using checkpoint: {}".format(INIT_CHECKPOINT))log.info("Using {} data shards".format(len(input_files)))</pre><p>æº–å‚™è¨“ç·´é‹è¡Œé…ç½®ï¼Œå»ºç«‹è©•ä¼°å™¨å’Œè¼¸å…¥å‡½æ•¸ï¼Œå•Ÿå‹•BERTï¼</p><pre>model_fn = model_fn_builder( bert_config=bert_config, init_checkpoint=INIT_CHECKPOINT, learning_rate=LEARNING_RATE, num_train_steps=TRAIN_STEPS, num_warmup_steps=10, use_tpu=USE_TPU, use_one_hot_embeddings=True)tpu_cluster_resolver = tf.contrib.cluster_resolver.TPUClusterResolver(TPU_ADDRESS)run_config = tf.contrib.tpu.RunConfig( cluster=tpu_cluster_resolver, model_dir=BERT_GCS_DIR, save_checkpoints_steps=SAVE_CHECKPOINTS_STEPS, tpu_config=tf.contrib.tpu.TPUConfig( iterations_per_loop=SAVE_CHECKPOINTS_STEPS, num_shards=NUM_TPU_CORES, per_host_input_for_training=tf.contrib.tpu.InputPipelineConfig.PER_HOST_V2))estimator = tf.contrib.tpu.TPUEstimator( use_tpu=USE_TPU, model_fn=model_fn, config=run_config, train_batch_size=TRAIN_BATCH_SIZE, eval_batch_size=EVAL_BATCH_SIZE)train_input_fn = input_fn_builder( input_files=input_files, max_seq_length=MAX_SEQ_LENGTH, max_predictions_per_seq=MAX_PREDICTIONS, is_training=True)</pre><p>åŸ·è¡Œï¼</p><pre>estimator.train(input_fn=train_input_fn, max_steps=TRAIN_STEPS)</pre><p>æœ€å¾Œï¼Œä½¿ç”¨é»˜èªåƒæ•¸è¨“ç·´æ¨¡å‹éœ€è¦100è¬æ­¥ï¼Œç´„54å°æ™‚çš„é‹è¡Œæ™‚é–“ã€‚å¦‚æœå…§æ ¸ç”±æ–¼æŸç¨®åŸå› é‡æ–°å•Ÿå‹•ï¼Œå¯ä»¥å¾æ–·é»è™•ç¹¼çºŒè¨“ç·´ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯æ˜¯åœ¨é›²TPUä¸Šå¾é ­é–‹å§‹é è¨“ç·´BERTçš„æŒ‡å—ã€‚</p><h1><strong>ä¸‹ä¸€æ­¥</strong></h1><p>å¥½çš„ï¼Œæˆ‘å€‘å·²ç¶“è¨“ç·´å¥½äº†æ¨¡å‹ï¼Œæ¥ä¸‹ä¾†å¯ä»¥åšä»€éº¼ï¼Ÿ</p><p>å¦‚åœ–1æ‰€ç¤ºï¼Œä½¿ç”¨é è¨“ç·´çš„æ¨¡å‹ä½œç‚ºé€šç”¨çš„è‡ªç„¶èªè¨€ç†è§£æ¨¡å¡Š;</p><p>2ï¼Œé‡å°æŸäº›ç‰¹å®šçš„åˆ†é¡ä»»å‹™å¾®èª¿æ¨¡å‹;</p><p>3ï¼Œä½¿ç”¨BERTä½œç‚ºæ§‹å»ºå¡Šï¼Œå»å‰µå»ºå¦ä¸€å€‹æ·±åº¦å­¸ç¿’æ¨¡å‹ã€‚</p><h1><strong>å‚³é€é–€</strong></h1><p>åŸæ–‡åœ°å€ï¼š</p><p>https ï¼š//towardsdatascience.com/pre-training-bert-from-scratch-with-cloud-tpu-6e2f71028379</p><p>Colabä»£ç¢¼ï¼š</p><p>https ï¼š//colab.research.google.com/drive/1nVn6AFpQSzXBt8_ywfx6XR8ZfQXlKGAz</p><p>â€” å®Œ â€”</p><p>èª æ‘¯æ‹›è˜</p><p>é‡å­ä½æ­£åœ¨æ‹›å‹Ÿç·¨è¼¯/è¨˜è€…ï¼Œå·¥ä½œåœ°é»åœ¨åŒ—äº¬ä¸­é—œæ‘ã€‚æœŸå¾…æœ‰æ‰æ°£ã€æœ‰ç†±æƒ…çš„åŒå­¸åŠ å…¥æˆ‘å€‘ï¼ç›¸é—œç´°ç¯€ï¼Œè«‹åœ¨é‡å­ä½å…¬çœ¾è™Ÿ(QbitAI)å°è©±ç•Œé¢ï¼Œå›è¦†â€œæ‹›è˜â€å…©å€‹å­—ã€‚</p><p>é‡å­ä½ QbitAI Â· é ­æ¢è™Ÿç°½ç´„ä½œè€…</p><p>Õ¾'á´—' Õ« è¿½è¹¤AIæŠ€è¡“å’Œç”¢å“æ–°å‹•æ…‹</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>è¨“ç·´</a></li><li><a>BERT</a></li><li><a>TPU</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/6ff19cd8.html alt=ä¸­å°å­¸ä½œæ–‡è¨“ç·´ä¹‹æå¯«å°ˆé¡Œï¼ˆä¹ï¼‰å ´é¢æå¯« class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/75eab302c96d43e8a680908253f96bcc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6ff19cd8.html title=ä¸­å°å­¸ä½œæ–‡è¨“ç·´ä¹‹æå¯«å°ˆé¡Œï¼ˆä¹ï¼‰å ´é¢æå¯«>ä¸­å°å­¸ä½œæ–‡è¨“ç·´ä¹‹æå¯«å°ˆé¡Œï¼ˆä¹ï¼‰å ´é¢æå¯«</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0926be43.html alt="ç­‹è†œæ”¾é¬†ç·´ç¿’ - æŒ‰æ‘©æ»¾è¼ªè¨“ç·´æ–¹æ³•" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d8d39047a8ef48fdbc8ca96ec24e1957 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0926be43.html title="ç­‹è†œæ”¾é¬†ç·´ç¿’ - æŒ‰æ‘©æ»¾è¼ªè¨“ç·´æ–¹æ³•">ç­‹è†œæ”¾é¬†ç·´ç¿’ - æŒ‰æ‘©æ»¾è¼ªè¨“ç·´æ–¹æ³•</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/12065250.html alt=TPU/EVAç„¡æ»·é˜»ç‡ƒé›»çºœæ–™ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/86add7f3948e464f89663e7caefdd334 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/12065250.html title=TPU/EVAç„¡æ»·é˜»ç‡ƒé›»çºœæ–™>TPU/EVAç„¡æ»·é˜»ç‡ƒé›»çºœæ–™</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0ac4e6b0.html alt="â€œè¨“ç·´ä¸­å¿ƒâ€åŸºæœ¬æ“ä½œ æ–°æ‰‹å…¥é–€å¯å¿«é€Ÿä¸Šæ‰‹ï¼" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/986b0004185ef13341b4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0ac4e6b0.html title="â€œè¨“ç·´ä¸­å¿ƒâ€åŸºæœ¬æ“ä½œ æ–°æ‰‹å…¥é–€å¯å¿«é€Ÿä¸Šæ‰‹ï¼">â€œè¨“ç·´ä¸­å¿ƒâ€åŸºæœ¬æ“ä½œ æ–°æ‰‹å…¥é–€å¯å¿«é€Ÿä¸Šæ‰‹ï¼</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/91e57ca2.html alt=é—œæ–¼TPUæ³¨å¡‘å·¥è—â€¦â€¦ä½ çŸ¥é“å¤šå°‘ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/d9a14480-8fd7-424f-8783-b3612a585088 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/91e57ca2.html title=é—œæ–¼TPUæ³¨å¡‘å·¥è—â€¦â€¦ä½ çŸ¥é“å¤šå°‘>é—œæ–¼TPUæ³¨å¡‘å·¥è—â€¦â€¦ä½ çŸ¥é“å¤šå°‘</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/df3191d7.html alt="ç†±èº«è¨“ç·´ï¼Œæº–å‚™é–‹å§‹ ï¼Œä¸€æ‹›ä¸€å¼å–šé†’èº«é«”" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8341520cbad340d9aabf407c2800fd62 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/df3191d7.html title="ç†±èº«è¨“ç·´ï¼Œæº–å‚™é–‹å§‹ ï¼Œä¸€æ‹›ä¸€å¼å–šé†’èº«é«”">ç†±èº«è¨“ç·´ï¼Œæº–å‚™é–‹å§‹ ï¼Œä¸€æ‹›ä¸€å¼å–šé†’èº«é«”</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/29d7e5af.html alt=é—œæ–¼TPUæ³¨å¡‘å·¥è—â€¦â€¦ä½ çŸ¥é“å¤šå°‘ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7b4645e056d444a4bbc2d2796028cd61 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/29d7e5af.html title=é—œæ–¼TPUæ³¨å¡‘å·¥è—â€¦â€¦ä½ çŸ¥é“å¤šå°‘ï¼Ÿ>é—œæ–¼TPUæ³¨å¡‘å·¥è—â€¦â€¦ä½ çŸ¥é“å¤šå°‘ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8e59046e.html alt=è…¦å¤–å‚·ç—…äººçš„æ—¥å¸¸ç”Ÿæ´»èƒ½åŠ›è¨“ç·´ï¼šåœ¨åºŠä¸Šæ€éº¼å‘å·¦å³ç§»å‹•ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/4aed0000b4ee529b04aa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8e59046e.html title=è…¦å¤–å‚·ç—…äººçš„æ—¥å¸¸ç”Ÿæ´»èƒ½åŠ›è¨“ç·´ï¼šåœ¨åºŠä¸Šæ€éº¼å‘å·¦å³ç§»å‹•ï¼Ÿ>è…¦å¤–å‚·ç—…äººçš„æ—¥å¸¸ç”Ÿæ´»èƒ½åŠ›è¨“ç·´ï¼šåœ¨åºŠä¸Šæ€éº¼å‘å·¦å³ç§»å‹•ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dfb3b071.html alt="é«”èƒ½è¨“ç·´é«˜æ•ˆç‡ƒè„‚è¨ˆåŠƒï¼š9å€‹å‹•ä½œå¿«é€Ÿæå‡ç‡ƒè„‚è³ªé‡ çªç ´æ¸›è„‚ç“¶é ¸æœŸ" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/615a00057863e9e221d1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dfb3b071.html title="é«”èƒ½è¨“ç·´é«˜æ•ˆç‡ƒè„‚è¨ˆåŠƒï¼š9å€‹å‹•ä½œå¿«é€Ÿæå‡ç‡ƒè„‚è³ªé‡ çªç ´æ¸›è„‚ç“¶é ¸æœŸ">é«”èƒ½è¨“ç·´é«˜æ•ˆç‡ƒè„‚è¨ˆåŠƒï¼š9å€‹å‹•ä½œå¿«é€Ÿæå‡ç‡ƒè„‚è³ªé‡ çªç ´æ¸›è„‚ç“¶é ¸æœŸ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7a11c4af.html alt=åœ–è§£BERTï¼ˆNLPä¸­çš„é·ç§»å­¸ç¿’ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/b29b82aef73748bd9fc0a049212fba09 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7a11c4af.html title=åœ–è§£BERTï¼ˆNLPä¸­çš„é·ç§»å­¸ç¿’ï¼‰>åœ–è§£BERTï¼ˆNLPä¸­çš„é·ç§»å­¸ç¿’ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9dab4f31.html alt=å¾ä¸‰å€‹ç¶­åº¦è¨“ç·´å£æ‰ï¼Œå°±èƒ½å¿«é€Ÿæé«˜ä½ çš„èªè¨€è¡¨é”èƒ½åŠ› class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/4934eb76-719f-4562-86e9-2377677bf1d5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9dab4f31.html title=å¾ä¸‰å€‹ç¶­åº¦è¨“ç·´å£æ‰ï¼Œå°±èƒ½å¿«é€Ÿæé«˜ä½ çš„èªè¨€è¡¨é”èƒ½åŠ›>å¾ä¸‰å€‹ç¶­åº¦è¨“ç·´å£æ‰ï¼Œå°±èƒ½å¿«é€Ÿæé«˜ä½ çš„èªè¨€è¡¨é”èƒ½åŠ›</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3765806c.html alt=èªè¨€è½å¾Œçš„å°æœ‹å‹ï¼Œè¨“ç·´3å‘¨å¾Œæœ‰å“ªäº›è®ŠåŒ–ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/11cb61802ed147b89b8ae2d1ec4f39e2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3765806c.html title=èªè¨€è½å¾Œçš„å°æœ‹å‹ï¼Œè¨“ç·´3å‘¨å¾Œæœ‰å“ªäº›è®ŠåŒ–ï¼Ÿ>èªè¨€è½å¾Œçš„å°æœ‹å‹ï¼Œè¨“ç·´3å‘¨å¾Œæœ‰å“ªäº›è®ŠåŒ–ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/09fa199a.html alt=å‰äº¤å‰éŸŒå¸¶é‡å»ºè¡“å¾Œåº·å¾©è¨“ç·´ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/R6QlwLm392mk0I style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/09fa199a.html title=å‰äº¤å‰éŸŒå¸¶é‡å»ºè¡“å¾Œåº·å¾©è¨“ç·´>å‰äº¤å‰éŸŒå¸¶é‡å»ºè¡“å¾Œåº·å¾©è¨“ç·´</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7a405265.html alt=å¥èº«åŠ›é‡è¨“ç·´èƒ½å¹«åˆ°æˆ‘å€‘æ¸›è‚¥å—ï¼Ÿ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1530020814773cb5fbf0aba style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7a405265.html title=å¥èº«åŠ›é‡è¨“ç·´èƒ½å¹«åˆ°æˆ‘å€‘æ¸›è‚¥å—ï¼Ÿ>å¥èº«åŠ›é‡è¨“ç·´èƒ½å¹«åˆ°æˆ‘å€‘æ¸›è‚¥å—ï¼Ÿ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f1f18f63.html alt=å¼·åŒ–é«”èƒ½è¨“ç·´ï¼Œæå‡é•·è·‘èƒ½åŠ› class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/15277794267744db16eb29c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f1f18f63.html title=å¼·åŒ–é«”èƒ½è¨“ç·´ï¼Œæå‡é•·è·‘èƒ½åŠ›>å¼·åŒ–é«”èƒ½è¨“ç·´ï¼Œæå‡é•·è·‘èƒ½åŠ›</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>