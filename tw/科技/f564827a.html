<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>吳恩達深度學習筆記(108)-序列模型介紹(Sequence Models) | 极客快訊</title><meta property="og:title" content="吳恩達深度學習筆記(108)-序列模型介紹(Sequence Models) - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/dfa0587764f14afb8ccfd7a33796cd74"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f564827a.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f564827a.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f564827a.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f564827a.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f564827a.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f564827a.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f564827a.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f564827a.html><meta property="article:published_time" content="2020-11-14T21:03:07+08:00"><meta property="article:modified_time" content="2020-11-14T21:03:07+08:00"><meta name=Keywords content><meta name=description content="吳恩達深度學習筆記(108)-序列模型介紹(Sequence Models)"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/f564827a.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>吳恩達深度學習筆記(108)-序列模型介紹(Sequence Models)</h1></header><date class="post-meta meta-date">2020-11-14</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><h1>循環序列模型（Recurrent Neural Networks）</h1><p>為什麼選擇序列模型？（Why Sequence Models?）</p><p>叢此筆記開始，你將學會序列模型，它是深度學習中最令人激動的內容之一。</p><p>循環神經網絡（RNN）之類的模型在語音識別、自然語言處理和其他領域中引起變革。在本節課中，你將學會如何自行創建這些模型。我們先看一些例子，這些例子都有效使用了序列模型。</p><div class=pgc-img><img alt="吳恩達深度學習筆記(108)-序列模型介紹(Sequence Models)" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/dfa0587764f14afb8ccfd7a33796cd74><p class=pgc-img-caption></p></div><p>在進行<strong>語音識別</strong>時，給定了一個輸入音頻片段 x，並要求輸出對應的文字記錄 y。</p><p>這個例子裡輸入和輸出數據都是序列模型，因為 x是一個按時播放的音頻片段，輸出 y是一系列單詞。所以之後將要學到的一些序列模型，如循環神經網絡等等在語音識別方面是非常有用的。</p><p><strong>音樂生成問題</strong>是使用序列數據的另一個例子，在這個例子中，只有<strong>輸出數據 y是序列</strong>，而輸入數據可以是空集，也可以是個單一的整數，這個數可能指代你想要生成的音樂風格，也可能是你想要生成的那首曲子的頭幾個音符。輸入的 x可以是空的，或者就是個數字，然後輸出序列y。</p><p>在處理<strong>情感分類</strong>時，輸入數據x是序列，你會得到類似這樣的輸入：“There is nothing to like in this movie.”，你認為這句評論對應幾星？</p><p>系列模型在<strong>DNA序列分析</strong>中也十分有用，你的DNA可以用A、C、G、T四個字母來表示。所以給定一段DNA序列，你能夠標記出哪部分是匹配某種蛋白質的嗎？</p><p>在<strong>機器翻譯</strong>過程中，你會得到這樣的輸入句：“Voulez-vou chante avecmoi?”（法語：要和我一起唱麼？），然後要求你輸出另一種語言的翻譯結果。</p><p>在進行<strong>視頻行為識別</strong>時，你可能會得到一系列視頻幀，然後要求你識別其中的行為。</p><p>在進行<strong>命名實體識別</strong>時，可能會給定一個句子要你識別出句中的人名。</p><p>所以這些問題都可以被稱作使用標籤數據 (x,y)作為訓練集的監督學習。但從這一系列例子中你可以看出序列問題有很多不同類型。</p><p>有些問題裡，輸入數據 x和輸出數據y都是序列，但就算在那種情況下，x和y有時也會不一樣長。或者像上圖編號1所示和上圖編號2的x和y有相同的數據長度。在另一些問題裡，只有 x或者只有y是序列。</p><p>所以上面是我們學到適用於不同情況的序列模型，下面我們會定義一些定義序列問題要用到的符號。</p><h1>數學符號（Notation）</h1><p>本節先從定義符號開始一步步構建序列模型。</p><p>比如說你想要建立一個序列模型，它的輸入語句是這樣的：“Harry Potter and Herminoe Granger invented a new spell.”，(這些人名都是出自於J.K.Rowling筆下的系列小說Harry Potter)。</p><p>假如你想要建立一個能夠自動識別句中人名位置的序列模型，那麼這就是一個命名實體識別問題，這常用於搜索引擎，比如說索引過去24小時內所有新聞報道提及的人名，用這種方式就能夠恰當地進行索引。命名實體識別系統可以用來查找不同類型的文本中的人名、公司名、時間、地點、國家名和貨幣名等等。</p><div class=pgc-img><img alt="吳恩達深度學習筆記(108)-序列模型介紹(Sequence Models)" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/902e852e709148f99ef7a31ee228cc32><p class=pgc-img-caption></p></div><p>現在給定這樣的輸入數據x，假如你想要一個序列模型輸出y，使得輸入的每個單詞都對應一個輸出值，同時這個y能夠表明輸入的單詞是否是人名的一部分。</p><p>技術上來說這也許不是最好的輸出形式，還有更加複雜的輸出形式，它不僅能夠表明輸入詞是否是人名的一部分，它還能夠告訴你這個人名在這個句子裡從哪裡開始到哪裡結束。比如Harry Potter（上圖編號1所示）、Hermione Granger（上圖標號2所示）。</p><p>更簡單的那種輸出形式:</p><p>這個輸入數據是9個單詞組成的序列，所以最終我們會有9個特徵集和來表示這9個單詞，並按序列中的位置進行索引，x^(&lt;1>)、x^(&lt;2>)、x^(&lt;3>)等等一直到x^(&lt;9>)來索引不同的位置，我將用x^(&lt;t>)來索引這個序列的中間位置。t意味著它們是時序序列，但不論是否是時序序列，我們都將用t來索引序列中的位置。</p><p>輸出數據也是一樣，我們還是用y^(&lt;1>)、y^(&lt;2>)、y^(&lt;3>)等等一直到y^(&lt;9>)來表示輸出數據。同時我們用T_x來表示輸入序列的長度，這個例子中輸入是9個單詞，所以T_x=9。我們用T_y來表示輸出序列的長度。在這個例子裡T_x=T_y，上面你知道T_x和T_y可以有不同的值。</p><p>你應該記得我們之前用的符號，我們用x^((i))來表示第i個訓練樣本，所以為了指代第t個元素，或者說是訓練樣本i的序列中第t個元素用x^((i)&lt;t>)這個符號來表示。如果T_x是序列長度，那麼你的訓練集裡不同的訓練樣本就會有不同的長度，所以T_x^((i))就代表第i個訓練樣本的輸入序列長度。同樣y^((i)&lt;t>)代表第i個訓練樣本中第t個元素，T_y^((i))就是第i個訓練樣本的輸出序列的長度。</p><p>所以在這個例子中，T_x^((i))=9，但如果另一個樣本是由15個單詞組成的句子，那麼對於這個訓練樣本，T_x^((i))=15。</p><p>既然我們這個例子是<strong>NLP，也就是自然語言處理</strong>，這是我們初次涉足自然語言處理，一件我們需要事先決定的事是<strong>怎樣表示一個序列裡單獨的單詞，你會怎樣表示像Harry這樣的單詞，x^(&lt;1>)實際應該是什麼？</strong></p><p>接下來我們討論一下<strong>怎樣表示一個句子裡單個的詞</strong>。</p><p>想要表示一個句子裡的單詞，第一件事是做<strong>一張詞表，有時也稱為詞典</strong>，意思是列一列你的表示方法中用到的單詞。這個詞表（下圖所示）中的第一個詞是a，也就是說詞典中的第一個單詞是a，第二個單詞是Aaron，然後更下面一些是單詞and，再後面你會找到Harry，然後找到Potter，這樣一直到最後，詞典裡最後一個單詞可能是Zulu。</p><div class=pgc-img><img alt="吳恩達深度學習筆記(108)-序列模型介紹(Sequence Models)" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/beeaf581be8f4fe29c36ae1332b23c75><p class=pgc-img-caption></p></div><p>因此a是第一個單詞，Aaron是第二個單詞，在這個詞典裡，and出現在367這個位置上，Harry是在4075這個位置，Potter在6830，詞典裡的最後一個單詞Zulu可能是第10,000個單詞。</p><p>所以在這個例子中我<strong>用了10,000個單詞大小的詞典</strong>，這對現代自然語言處理應用來說太小了。對於商業應用來說，或者對於一般規模的商業應用來說30,000到50,000詞大小的詞典比較常見，但是100,000詞的也不是沒有，而且有些大型互聯網公司會用百萬詞，甚至更大的詞典。許多商業應用用的詞典可能是30,000詞，也可能是50,000詞。不過我將用10,000詞大小的詞典做說明，因為這是一個很好用的整數。</p><p>如果你選定了10,000詞的詞典，構建這個詞典的一個方法是<strong>遍歷你的訓練集，並且找到前10,000個常用詞，你也可以去瀏覽一些網絡詞典，它能告訴你英語裡最常用的10,000個單詞，接下來你可以用one-hot表示法來表示詞典裡的每個單詞</strong>。</p><div class=pgc-img><img alt="吳恩達深度學習筆記(108)-序列模型介紹(Sequence Models)" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/2c228c9412384a2eb0387bb5b759e2cd><p class=pgc-img-caption></p></div><p>舉個例子，在這裡x^(&lt;1>)表示Harry這個單詞，它就是一個第4075行是1，其餘值都是0的向量（上圖編號1所示），因為那是Harry在這個詞典裡的位置。</p><p>同樣x^(&lt;2>)是個第6830行是1，其餘位置都是0的向量（上圖編號2所示）。</p><p>and在詞典裡排第367，所以x^(&lt;3>)就是第367行是1，其餘值都是0的向量（上圖編號3所示）。如果你的詞典大小是10,000的話，那麼這裡的每個向量都是10,000維的。</p><p>因為a是字典第一個單詞，x^(&lt;7>)對應a，那麼這個向量的第一個位置為1，其餘位置都是0的向量（上圖編號4所示）。</p><p>所以這種表示方法中，x^(&lt;t>)指代句子裡的任意詞，它就是個<strong>one-hot向量</strong>，因為它只有一個值是1，其餘值都是0，所以你會有9個one-hot向量來表示這個句中的9個單詞，目的是<strong>用這樣的表示方式表示X，用序列模型在X和目標輸出Y之間學習建立一個映射</strong>。我會把它當作監督學習的問題，我確信會給定帶有(x,y)標籤的數據。</p><p>那麼還剩下最後一件事，我們將在之後的筆記中討論，如果你遇到了一個不在你詞表中的單詞，答案就是創建一個新的標記，也就是一個叫做<strong>Unknow Word的偽單詞，用&lt;UNK>作為標記，來表示不在詞表中的單詞</strong>，我們之後會討論更多有關這個的內容。</p><p>總結一下本節課的內容，我們描述了一套符號用來表述你的訓練集裡的序列數據x和y，在下節課我們開始講述循環神經網絡中如何構建X到Y的映射</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>吳恩達</a></li><li><a>學習</a></li><li><a>筆記</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/efabb5bb.html alt=吳恩達深度學習筆記(106)-風格遷移網絡講解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/01def15aa8654252990f709965d5b769 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/efabb5bb.html title=吳恩達深度學習筆記(106)-風格遷移網絡講解>吳恩達深度學習筆記(106)-風格遷移網絡講解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3605c009.html alt="吳恩達深度學習筆記(67)-遷移學習（Transfer learning)" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/f00ccb946c7a451aa25adba4b28799e5 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3605c009.html title="吳恩達深度學習筆記(67)-遷移學習（Transfer learning)">吳恩達深度學習筆記(67)-遷移學習（Transfer learning)</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9819f021.html alt="吳恩達深度學習筆記(89)-遷移學習（Transfer Learning）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d934f6fbf66144dca95cbb6ce8223d62 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9819f021.html title="吳恩達深度學習筆記(89)-遷移學習（Transfer Learning）">吳恩達深度學習筆記(89)-遷移學習（Transfer Learning）</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/31a4d4f2.html alt="吳恩達深度學習筆記(38)-優化算法(Optimization algorithms)" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/c34f86938ddb484298ca8e0a20494ff2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/31a4d4f2.html title="吳恩達深度學習筆記(38)-優化算法(Optimization algorithms)">吳恩達深度學習筆記(38)-優化算法(Optimization algorithms)</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/72a9b3c.html alt=吳恩達深度學習筆記(28)-網絡訓練驗證測試數據集的組成介紹 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b64cd54d8477428589d89e078a3e37b4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/72a9b3c.html title=吳恩達深度學習筆記(28)-網絡訓練驗證測試數據集的組成介紹>吳恩達深度學習筆記(28)-網絡訓練驗證測試數據集的組成介紹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/2b4ff01.html alt="吳恩達深度學習筆記(132) | 序列模型 | 改進集束搜索" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/62cda93c07d14841930e00586835064e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/2b4ff01.html title="吳恩達深度學習筆記(132) | 序列模型 | 改進集束搜索">吳恩達深度學習筆記(132) | 序列模型 | 改進集束搜索</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dc2af9c9.html alt=機器學習筆記(七)——初識邏輯迴歸、不同方法推導梯度公式 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/13adbab9c7f94c7fa81d49a98861b051 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dc2af9c9.html title=機器學習筆記(七)——初識邏輯迴歸、不同方法推導梯度公式>機器學習筆記(七)——初識邏輯迴歸、不同方法推導梯度公式</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/a1bc38f3.html alt=HTMLCSS學習筆記（六）——元素類型 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/bdb5988349894ce9bf568c6418f85b7d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/a1bc38f3.html title=HTMLCSS學習筆記（六）——元素類型>HTMLCSS學習筆記（六）——元素類型</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c9091681.html alt="MySQL 學習筆記" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c9091681.html title="MySQL 學習筆記">MySQL 學習筆記</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/112d1b5f.html alt=一造學習筆記—管理篇（2）：工程造價管理的組織和內容 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/9e65b076-038f-4720-96ff-182898f42dee style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/112d1b5f.html title=一造學習筆記—管理篇（2）：工程造價管理的組織和內容>一造學習筆記—管理篇（2）：工程造價管理的組織和內容</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0a02618e.html alt=某教程學習筆記（一）：17、php漏洞 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/6d21bdb33b0a49e8b6eaa2c2a725a1d8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0a02618e.html title=某教程學習筆記（一）：17、php漏洞>某教程學習筆記（一）：17、php漏洞</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b37aac89.html alt=【學習筆記】Android開發之kotlin語言（一） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ee3f9c8348ae4de58a5f62922d2042e1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b37aac89.html title=【學習筆記】Android開發之kotlin語言（一）>【學習筆記】Android開發之kotlin語言（一）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b33d00d0.html alt=CV學習筆記（十二）：圖像金字塔 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/74c73f94d57a4f5d8f2e5183e78c8e67 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b33d00d0.html title=CV學習筆記（十二）：圖像金字塔>CV學習筆記（十二）：圖像金字塔</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7f69ae29.html alt="Python 3 學習筆記：Excel 基礎操作（二）" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a777a023a91a465fb317de8de7e4cd37 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7f69ae29.html title="Python 3 學習筆記：Excel 基礎操作（二）">Python 3 學習筆記：Excel 基礎操作（二）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b75ffe84.html alt=學習《建築材料第9節》的筆記 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b75ffe84.html title=學習《建築材料第9節》的筆記>學習《建築材料第9節》的筆記</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>