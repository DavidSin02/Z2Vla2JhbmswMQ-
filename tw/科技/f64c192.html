<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器 | 极客快訊</title><meta property="og:title" content="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/a3808f77065d4bf7a1343b50c5ae8db4"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f64c192.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f64c192.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f64c192.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f64c192.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f64c192.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f64c192.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f64c192.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f64c192.html><meta property="article:published_time" content="2020-10-29T20:51:13+08:00"><meta property="article:modified_time" content="2020-10-29T20:51:13+08:00"><meta name=Keywords content><meta name=description content="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/f64c192.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/a3808f77065d4bf7a1343b50c5ae8db4><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p><strong>大數據文摘出品</strong></p><p class=ql-align-justify><strong>來源：Medium</strong></p><p class=ql-align-justify><strong>編譯：李雷、笪潔瓊、Aileen、ZoeY</strong></p><p class=ql-align-justify>今天是大年初三，按照傳統習俗，從這天開始，就要開始走親訪友了。這時候的商場、飯館也都是“人聲鼎沸”，畢竟走親戚串門必不可少要帶點禮品、聚餐喝茶。</p><p class=ql-align-justify>熱鬧歸熱鬧，這個時候最難的問題可能就是怎樣從小區、商場、菜市場的人山人海里準確定位，找到一個“車位”。</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/eb190b2894154f449894e9159555e339><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>別慌！</p><p class=ql-align-justify>一位名叫Adam Geitgey的軟件工程師、AI軟件工程博主也被“停車難”的問題困擾已久。<strong>為了讓自己能給迅速定位空車位，他用實例分割模型Mask R-CNN和python寫了一個搶佔停車位的小程序。</strong></p><p class=ql-align-justify>以下是作者以第一人稱給出的教程，enjoy。</p><p class=ql-align-justify>我住在一個大都市，但就像大多數城市一樣，在這裡很難找到停車位。停車場總是停得滿滿的，即使你自己有私人車位，朋友來訪的時候也很麻煩，因為他們找不到停車位。</p><p class=ql-align-justify>我的解決方法是：</p><p class=ql-align-justify><strong>用攝像頭對著窗外拍攝，並利用深度學習算法讓我的電腦在發現新的停車位時給我發短信。</strong></p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/5f14d1fb76124335a283ba1c526e832c><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>這可能聽起來相當複雜，但是用深度學習來構建這個應用，實際上非常快速和簡單。有各種現有的實用工具 - 我們只需找到這些工具並且將它們組合在一起。</p><p class=ql-align-justify>現在，讓我們花幾分鐘時間用Python和深度學習建立一個高精度的停車位通知系統吧！</p><p><strong>分解問題</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>當我們想要通過機器學習解決一個複雜的問題時，<strong>第一步是將問題分解為簡單任務的列表。</strong>然後，對於每個簡單任務，我們可以從機器學習工具箱中找尋不同的工具來解決。</p><p class=ql-align-justify><strong>通過將這些簡單問題的解決方案串起來形成框架（例如下面的思維導圖），我們將實現一個可以執行復雜操作的系統。</strong></p><p class=ql-align-justify>以下就是我如何將檢測公共停車位的問題分解並形成流程：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/0431f7c89a564319b252b6a20b774075><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify></p><p class=ql-align-justify>機器學習模型流程的輸入是來自對著窗外的普通網絡攝像頭的視頻：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/361d1bd025bb4bf483d146b26e953693><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-center>我的攝像頭拍下的視頻類似上圖</p><p class=ql-align-justify></p><p class=ql-align-justify>我們將每一幀視頻送入模型裡，一次一幀。</p><p class=ql-align-justify>流程的第一步是檢測視頻幀中所有可能的停車位。顯然，我們需要知道圖像的哪些部分是停車位才能檢測到哪些停車位是空的。</p><p class=ql-align-justify>第二步是識別每幀視頻中所有的汽車，這樣我們可以跟蹤每輛車在幀與幀之間的位移。</p><p class=ql-align-justify>第三步是確定哪些停車位上目前有汽車，哪些沒有。這需要綜合第一步和第二步的結果。</p><p class=ql-align-justify>最後一步是在停車位空出來的時候發送通知。這是基於視頻幀之間的汽車位置的變化。</p><p class=ql-align-justify>我們可以使用各種技術以多種不同方式完成這些步驟。構建流程的方法不是唯一的，不同的方法沒有對錯，但有不同的優點和缺點。現在讓我們來看看每一步吧！</p><p><strong>檢測圖像中的停車位</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>以下是相機拍到的圖像：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4716e58a6d284636b18fd92a310fd9ae><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>我們需要能夠掃描該圖像並返回可以停車的區域列表，如下所示：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/712ea61fd40d407fb760326aa17cc18a><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-center>街區上可用的停車位</p><p class=ql-align-justify><br></p><p class=ql-align-justify>有一種偷懶的方法是手動將每個停車位的位置編入到程序中，而不是自動檢測停車位。但是如果我們移動相機或想要檢測不同街道上的停車位時，我們必須再次手動輸入停車位的位置。這太不爽了，所以讓我們找到一種自動檢測停車位的方法。</p><p class=ql-align-justify>一個想法是尋找停車計費表並假設每個計費表旁邊都有一個停車位：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/3ee71d8406a744dcad7d628be01b0970><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-center>在圖片中檢測的停車計費表</p><p class=ql-align-justify><br></p><p class=ql-align-justify>但這種方法存在一定的問題。首先，並非每個停車位都有停車咪表 – 實際上，我們最感興趣的是找到免費停車位！其次，停車咪表的位置並不能確切地告訴我們停車位的具體位置，只能讓我們離車位更接近一點。</p><p class=ql-align-justify>另一個想法是建立一個物體檢測模型，尋找在道路上繪製的停車位斜線標記，如下所示：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/ff4146b479654c6d964c9af5726c0868><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>留意那些微小的黃色標記，這些是在道路上繪製每個停車位的邊界。</p><p class=ql-align-justify>但這種做法也很痛苦。首先，我所在城市的停車位斜線標記非常小，從遠處很難看清，電腦也難以察覺。第二，街道上到處都是各種不相關的線條和標記，所以要區分哪些線條是停車位，哪些線條是車道分隔線或人行橫道是很困難的。</p><p class=ql-align-justify>每當遇到一個看似困難的問題時，請先花幾分鐘時間看看是否能夠採用不同的方式來避免某些技術難點並解決問題。到底什麼是停車位呢？停車位就是車輛停留很長一段時間的地方。因此也許我們根本不需要檢測停車位。為什麼我們不能只檢測那些長時間不動的車並假設它們停在停車位上？</p><p class=ql-align-justify>換句話說，真正的停車位只是容納了非移動中的車輛的區域：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/5f7b9bfea9a8461fa8d6db1f7193f4f4><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>這裡每輛車的邊框實際上都是一個停車位！如果我們能夠檢測到靜止的汽車，就不需要真的去檢測停車位。</p><p class=ql-align-justify>因此，如果我們能夠檢測到汽車並找出哪些汽車在視頻的每幀之間沒有移動，我們就可以推斷停車位的位置。這就變得很容易了！</p><p><strong>檢測圖像中的汽車</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>檢測視頻每幀中的汽車是一個標準的對象檢測問題。我們可以使用許多種機器學習方法來檢測圖像中的對象。以下是一些從過去到現在最常見的對象檢測算法：</p><ul><li class=ql-align-justify>訓練一個HOG（梯度方向直方圖）物體探測器滑過（掃描）我們的圖像以找到所有的汽車。這種比較古老的非深度學習方法運行起來相對較快，但它對於朝向不同方向的汽車不能很好地處理。</li><li class=ql-align-justify>訓練CNN（卷積神經網絡）物體探測器閱覽（掃描）我們的圖像，直到我們找到所有的汽車。這種方法雖然準確，但效率不高，因為我們必須使用CNN算法多次掃描同一圖像才能找到其中的所有汽車。雖然它可以很容易地找到朝向不同方向的汽車，但它需要比基於HOG的物體探測器更多的訓練數據。</li><li class=ql-align-justify>使用更新的深度學習方法，如Mask R-CNN，快速R-CNN或YOLO，將CNN的準確性與巧妙設計和效率技巧相結合，可以大大加快檢測過程。即使有大量訓練數據來訓練模型，這種方法的速度也相對較快（在GPU上）。</li></ul><p class=ql-align-justify><br></p><p class=ql-align-justify>一般來說，我們希望選擇最簡單的解決方案，以最少的訓練數據完成工作，而不是最新、最花哨的算法。但在這種特殊情況下，Mask R-CNN對我們來說是一個比較合理的選擇，儘管它相當花哨新潮。</p><p class=ql-align-justify>Mask R-CNN架構的設計理念是在不使用滑動窗口方法的情況下以高計算效率的方式檢測整幅圖像上的對象。換句話說，它運行得相當快。使用最新GPU，我們可以以每秒幾幀的速度檢測高分辨率視頻中的對象。那對於這個項目來說應該沒問題。</p><p class=ql-align-justify>此外，Mask R-CNN對每個檢測到的對象給出了大量信息。大多數對象檢測算法僅返回每個對象的邊界。但Mask R-CNN不僅會給我們每個對象的位置，還會給我們一個對象輪廓（或概述），如下所示：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/7215e07492ba4f83b6e6235344b94f91><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>為了訓練Mask R-CNN，我們需要大量的包含我們想要檢測的對象的圖片。我們可以去拍攝汽車照片並檢測這些照片中的所有汽車，但這需要幾天的工作。幸運的是，汽車是許多人想要檢測的常見物體，因此已經有不少汽車圖像的公共數據集。</p><p class=ql-align-justify>其中一個名為COCO (Common Objects in Context）的流行數據集，其中包含標註了對象輪廓的圖像。在此數據集中，有超過12,000張做了標註的汽車圖像。以下是COCO數據集中的其中一張：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/d38e0c24616a4b55bd442ae9aadf1c2f><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-center>COCO數據集中的圖像，其中已經標出了對象。</p><p class=ql-align-justify><br></p><p class=ql-align-justify>這個數據集非常適合訓練Mask R-CNN模型。</p><p class=ql-align-justify>等等，還有更好的事！由於太多人使用COCO數據集構建對象檢測模型，很多人已經完成並共享了他們的結果。因此，我們可以從預先訓練好的模型開始，而無需訓練我們自己的模型，這種模型可以即插即用。對於這個項目，我們將使用來自Matterport的大型開源Mask R-CNN實現項目，它自帶預先訓練的模型。</p><p class=ql-align-justify></p><p class=ql-align-justify>旁註：不要害怕訓練一個定製的Mask R-CNN目標探測器！註釋數據是很費時，但並不難。</p><p class=ql-align-justify>如果我們在攝像頭拍攝的圖像上運行預先培訓過的模型，就會得到如下的結果：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/384977d808bb4fd9a7042546df112b27><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>在我們的圖像上，識別出了COCO數據集中的默認對象-汽車、人、交通燈和一棵樹。</p><p class=ql-align-justify></p><p class=ql-align-justify>我們不僅能識別汽車，還能識別交通燈和人。幽默的是，其中一棵樹被識別成一個“盆栽植物”。</p><p class=ql-align-justify>對於圖像中檢測到的每一個物體，我們從Mask R-CNN模型中都會得到以下四個數據：</p><p class=ql-align-justify>1.檢測到的對象類型（以整數形式表示）。經過預先訓練的COCO模型知道如何檢測80種不同的常見物體，如汽車和卡車。這是80種的常見物體的完整清單https://gist.github.com/ageitgey/b143ee809bf08e4927dd59bace44db0d。</p><p class=ql-align-justify>2.目標檢測的置信度得分。數值越高，模型就越確定它正確地識別了對象。</p><p class=ql-align-justify>3.圖像中對象的邊界框，以X/Y像素位置表示。</p><p class=ql-align-justify>4.位圖圖層告訴我們邊界框中的哪些像素是對象的一部分，哪些不是。通過圖層數據，我們還可以計算出對象的輪廓。</p><p class=ql-align-justify>下面是使用Matterport’s Mask R-CNN中的預培訓模型和OpenCV共同實現汽車邊界框檢測的Python代碼：</p><p class=ql-align-justify>當您運行該代碼時，會看到圖像上每輛被檢測到的汽車周圍都有一個邊框，如下所示：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/fef81fb3df884628869425a38b10486c><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-center>被檢測到的每輛汽車周圍都有一個綠色的邊框。</p><p class=ql-align-justify>您還可以在控制檯中查看每個被檢測到的汽車的像素座標，如下所示：</p><pre class=ql-align-justify>Cars found in frame of video:Car: [492 871 551 961]Car: [450 819 509 913]Car: [411 774 470 856]</pre><p class=ql-align-justify><br></p><p class=ql-align-justify>有了這些數據，我們已經成功地在圖像中檢測到了汽車。可以進行下一步了！</p><p><strong>檢測空車位</strong></p><p class=ql-align-justify></p><p class=ql-align-justify>我們知道圖像中每輛車的像素位置。通過連續查看多幀視頻，我們可以很容易地確定哪些車輛沒有移動，並假設這些區域是停車位。但我們如何檢測汽車何時離開停車位呢？</p><p class=ql-align-justify>主要問題是，我們的圖像中汽車的邊界框有部分重疊：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/b012113f7ff34949b8aa7a4ce8f6994b><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify>即使對於不同停車位的汽車，每輛車的邊界框也有一點重疊。</p><p class=ql-align-justify>因此，如果我們假設每一個邊界框中的都代表一個停車位，那麼即使停車位是空的，這個邊界框也可能有一部分被汽車佔據。我們需要一種方法來測量兩個對象重疊的程度，以便檢查“大部分是空的”的邊框。</p><p class=ql-align-justify>我們將使用交併比（Intersection Over Union ，IoU）方法。用兩個對象重疊的像素數量除以兩個對象覆蓋的像素總數量，如下所示：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/21e7c3683a6c460fa2c42959c888323a><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>IoU可以告訴我們汽車邊界框與停車位邊界框的重疊程度。有了這個指標，我們就可以很容易地確定一輛車是否在停車位。如果IoU測量值很低，比如0.15，這意味著這輛車並沒有佔用太多的停車位。但是如果測量值很高，比如0.6，這意味著汽車佔據了大部分的停車位，那麼我們可以確定停車位被佔用了。</p><p class=ql-align-justify>由於IoU在計算機視覺中是一種常見的度量方法，所以通常您使用的庫已經有相關實踐。事實上，Matterport Mask R-CNN庫中就有這樣的函數mrcnn.utils.compute_overlaps()，我們可以直接調用這個函數。</p><p class=ql-align-justify>假設在圖像中有一個表示停車區域的邊界框列表，那麼檢查被檢測到的車輛是否在這些邊界框中，就如同添加一行或兩行代碼一樣簡單。</p><p class=ql-align-justify>結果如下：</p><pre class=ql-align-justify>[ [1. 0.07040032 0. 0.] [0.07040032 1. 0.07673165 0.] [0. 0. 0.02332112 0.]]</pre><p class=ql-align-justify><br></p><p class=ql-align-justify>在這個二維數組中，每一行表示一個停車位的邊界框。相應的，每列表示該停車位與被檢測到的汽車有多少重疊。1.0分意味著汽車完全佔據了停車位，而0.02分這樣的低分意味著汽車只是接觸了停車位邊界框，但並沒有佔據很多區域。</p><p class=ql-align-justify>為了找到空置的停車位，我們只需要檢查這個數組中的每一行。如果所有的數字都是零或者非常小的數字，就意味著沒有東西佔據了這個空間，因此它就是空閒的！</p><p class=ql-align-justify>但請記住，物體檢測並不總是與實時視頻完美結合。儘管Mask R-CNN非常準確，但偶爾它會在一幀視頻中錯過一兩輛車。因此，在將停車位標記為空閒之前，我們應該確保它在一段時間內都是空閒的，可能是5或10幀連續視頻。這將防止僅僅在一幀視頻上出現暫時性的物體檢測問題而誤導系統將停車位判定為空閒。但當我們看到至少有一個停車位在連續幾幀視頻圖像中都被判定為空閒，我們就可以發送短信了！</p><p><strong>發送短信</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>最後一步是當我們注意到一個停車位在連續幾幀視頻圖像中都被判定為空閒時，就發送一條短信提醒。</p><p class=ql-align-justify>使用 Twilio從Python發送短消息非常簡單。Twilio是一個流行的接口，它可以讓您用幾行代碼從任何編程語言發送短消息。當然，如果您喜歡使用其他的短信服務提供者，也是可以的。我和Twilio沒有利害關係。只是第一個就想到了它。</p><p class=ql-align-justify>Twilio：</p><p class=ql-align-justify>https://www.twilio.com</p><p class=ql-align-justify>要使用Twilio，需要註冊試用帳戶，創建Twilio電話號碼並獲取您的帳戶憑據。然後，您需要安裝Twilio Python客戶端的庫：</p><pre class=ql-align-justify>pip3 install twilio</pre><p class=ql-align-justify><br></p><p class=ql-align-justify>安裝後，使用下面的代碼（需要將關鍵信息替換成您的賬戶信息），就可以從Python發送短信了：</p><pre class=ql-align-justify>from twilio.rest import Client  # Twilio account details twilio_account_sid = 'Your Twilio SID here' twilio_auth_token = 'Your Twilio Auth Token here' twilio_source_phone_number = 'Your Twilio phone number here'  # Create a Twilio client object instance client = Client(twilio_account_sid, twilio_auth_token)  # Send an SMS message = client.messages.create( body="This is my SMS message!", from_=twilio_source_phone_number, to="Destination phone number here" )</pre><p class=ql-align-justify><br></p><p class=ql-align-justify>直接將代碼插入到我們的腳本里，就可以添加發送短信的功能了。但我們需要注意的是，如果一個停車位一直是空閒的，就不需要在每一幀視頻都給自己發送短信了。因此，我們需要有一個標誌來標記我們是否已經發送了一條短信，並確保在經過一定時間或檢測到其他停車位空閒之前，我們不會再發送另一條短信息。</p><p><strong>打包組裝</strong></p><p class=ql-align-justify><br></p><p class=ql-align-justify>我們將流程中的每個步驟寫成了一個單獨的Python腳本。以下是完整的代碼：</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="走親訪友不慌！教你怎樣用Mask R-CNN和Python做一個搶車位神器" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/4121747f5cf747a0879f5d35ea43686f><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>此部分代碼太長，感興趣的同學可以在下面的網址中找到：</p><p class=ql-align-justify>https://medium.com/@ageitgey/snagging-parking-spaces-with-mask-r-cnn-and-python-955f2231c400</p><p>要運行此代碼，您需要首先安裝Python 3.6+, Matterport Mask R-CNN和OpenCV。</p><p class=ql-align-justify>Matterport Mask R-CNN：</p><p class=ql-align-justify>https://github.com/matterport/Mask_RCNN</p><p class=ql-align-justify>OpenCV：</p><p class=ql-align-justify>https://pypi.org/project/opencv-python/</p><p class=ql-align-justify>我有意讓代碼儘可能簡明扼要。例如，它只是假設在第一幀視頻中出現的任何汽車都是已停放的汽車。試試修改代碼，看看您能不能提高它的可靠性。</p><p class=ql-align-justify>不用擔心修改此代碼就不能適應不同的場景。只需更改模型搜尋的對象ID，就可以將代碼完全轉換為其他內容。例如，假設您在滑雪場工作。通過一些調整，您可以將此腳本轉換為一個自動檢測滑雪板從斜坡上跳下的系統，並記錄炫酷的滑雪板跳躍軌跡。或者，如果您在一個遊戲保護區工作，您可以把這個腳本變成一個用來計數在野外能看到多少斑馬的系統。</p><p class=ql-align-justify>唯一的限制就是你的想象力。</p><p class=ql-align-justify>一起來試試吧!</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>走親</a></li><li><a>訪友</a></li><li><a>怎樣</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/72139afe.html alt=怎樣對臍橙樹進行扭枝（彎枝）促花？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/fe6ea8ad111f421c9673e3f61072fa1f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/72139afe.html title=怎樣對臍橙樹進行扭枝（彎枝）促花？>怎樣對臍橙樹進行扭枝（彎枝）促花？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/11a109e5.html alt=網站搭建怎樣選擇好的服務器? class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/11a109e5.html title=網站搭建怎樣選擇好的服務器?>網站搭建怎樣選擇好的服務器?</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/831dd688.html alt=葛洪健康快車：怎樣按壓耳朵調治失眠？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/5e7600044965a1a66955 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/831dd688.html title=葛洪健康快車：怎樣按壓耳朵調治失眠？>葛洪健康快車：怎樣按壓耳朵調治失眠？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6d997d2f.html alt=寫作時怎樣去描寫一個場面 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6d997d2f.html title=寫作時怎樣去描寫一個場面>寫作時怎樣去描寫一個場面</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cc683c38.html alt=怎樣進行場面描寫？中小學生高分作文技巧，作文快速提分 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7559326b0b254462970a98290ef15e9f style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cc683c38.html title=怎樣進行場面描寫？中小學生高分作文技巧，作文快速提分>怎樣進行場面描寫？中小學生高分作文技巧，作文快速提分</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/32a99b12.html alt=怎樣跳纖？【看完就知道了】 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/f5acf09fdf9a4abfbdb64f901c2cf353 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/32a99b12.html title=怎樣跳纖？【看完就知道了】>怎樣跳纖？【看完就知道了】</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/67fef4c6.html alt=2019年高考，怎樣設置院校梯度才合理？衝、穩、保、墊，很關鍵！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/f8d17716-f3b8-4c6d-8eb7-f482334ad491 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/67fef4c6.html title=2019年高考，怎樣設置院校梯度才合理？衝、穩、保、墊，很關鍵！>2019年高考，怎樣設置院校梯度才合理？衝、穩、保、墊，很關鍵！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c91ca5ec.html alt=怎樣使毛巾變軟方法全解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/f6634e91151441ea87c6899cdfa41fa8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c91ca5ec.html title=怎樣使毛巾變軟方法全解>怎樣使毛巾變軟方法全解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fcd685fe.html alt=怎樣使毛巾變軟？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/dfic-imagehandler/b8d30e5f-7499-4568-98e5-9705c7902745 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fcd685fe.html title=怎樣使毛巾變軟？>怎樣使毛巾變軟？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/124667e5.html alt=柿子硬邦邦的不好吃，那要怎樣快速變軟呢？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/852e738130844657b1e9c470c1e4d8c1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/124667e5.html title=柿子硬邦邦的不好吃，那要怎樣快速變軟呢？>柿子硬邦邦的不好吃，那要怎樣快速變軟呢？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3542a850.html alt=大白鯧魚怎樣做好吃？蒸煎燜炸你一定吃過，鹹水煮吃過嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/2f7dcd00-bb73-4ad4-85b2-de3e2bf49ba6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3542a850.html title=大白鯧魚怎樣做好吃？蒸煎燜炸你一定吃過，鹹水煮吃過嗎？>大白鯧魚怎樣做好吃？蒸煎燜炸你一定吃過，鹹水煮吃過嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e9f0815a.html alt=汽車知識分享：怎樣讓小白快速瞭解汽車部件（中篇） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/7a3677e5c6a9474a829a501f80de2d81 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e9f0815a.html title=汽車知識分享：怎樣讓小白快速瞭解汽車部件（中篇）>汽車知識分享：怎樣讓小白快速瞭解汽車部件（中篇）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4e122b46.html alt="案例分享 | 75噸鋼筋是怎樣摳出來的？" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/6fa8cedb68e5442eac827ab3e0215299 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4e122b46.html title="案例分享 | 75噸鋼筋是怎樣摳出來的？">案例分享 | 75噸鋼筋是怎樣摳出來的？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d1a4c573.html alt=怎樣看懂電路圖？看懂電路圖你需要知道的5點電路常識，純經驗！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/362cc95908ef4cb88814038b612fd6cb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d1a4c573.html title=怎樣看懂電路圖？看懂電路圖你需要知道的5點電路常識，純經驗！>怎樣看懂電路圖？看懂電路圖你需要知道的5點電路常識，純經驗！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d8d3d9c9.html alt=鄭永年：西方自由主義經歷著怎樣的衰敗？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/39fa653eb60a4d229a2399d2e86ac991 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d8d3d9c9.html title=鄭永年：西方自由主義經歷著怎樣的衰敗？>鄭永年：西方自由主義經歷著怎樣的衰敗？</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>