<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>對 ResNet 本質的一些思考 | 极客快訊</title><meta property="og:title" content="對 ResNet 本質的一些思考 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/ba6acae0844a4e54a0d27835501368cb"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f7fbf79.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f7fbf79.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f7fbf79.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f7fbf79.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f7fbf79.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f7fbf79.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/f7fbf79.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/f7fbf79.html><meta property="article:published_time" content="2020-10-29T20:59:02+08:00"><meta property="article:modified_time" content="2020-10-29T20:59:02+08:00"><meta name=Keywords content><meta name=description content="對 ResNet 本質的一些思考"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/f7fbf79.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>對 ResNet 本質的一些思考</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p class=ql-align-center><br></p><div class=pgc-img><img alt="對 ResNet 本質的一些思考" onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/ba6acae0844a4e54a0d27835501368cb><p class=pgc-img-caption></p></div><p><strong>【新智元導讀】</strong>本文作者重新審視了ResNet之所以工作的原因，得出結論: ResNet 本質上就幹了一件事：降低數據中信息的冗餘度。</p><p class=ql-align-justify><br></p><p class=ql-align-justify>最近在總結完成語義分割任務的輕量級神經網絡時，看到了 MobileNet V2 中對於 ReLU 層的思考，於是我也回過頭重新審視 ResNet 之所以 work 的本質原因。以下是一些個人的見解，如有錯誤，還望及時指正。</p><p class=ql-align-justify>在談及 ResNet 之前，我們先聊聊故事的背景。</p><p class=ql-align-justify>我們知道，在神經網絡中，非線性激活層可以為模型引入了非線性，讓模型具有更強的擬合能力。如果只是單純的線性操作層的疊加，則完全可以等價為一個線性層，這就浪費了深度神經網絡的一身好本領。</p><p class=ql-align-justify>所謂針無兩頭尖，那麼非線性激活層會帶來一些什麼問題呢？我們以 <strong>ReLU</strong> 為例來進行說明，其他非線性激活層亦同理。</p><p class=ql-align-justify>首先，最直觀的，從實驗中我們可以注意到一個事實：<strong>ReLU 會造成的低維數據的坍塌（collapse）</strong>。顧名思義，即是說，低維度的 feature 在通過 ReLU 的時候，這個 feature 會像塌方了一樣，有一部分被毀掉了，或者說失去了。能恢復嗎？能，但是基本無法百分百還原了。</p><p class=ql-align-justify>具體表現出來就是：若是我們對一個 feature，先通過一個給定的變換規則 T，將它映射到它的 embedding space 中，再在該 embedding space 中，利用一個 ReLU 去處理該 feature，最後再把這個 feature 以同樣的變換規則（逆方向）給映射回原始空間，我們會發現，這時，這個 feature 已經變得連親媽都不認得了。如圖↓</p><p class=ql-align-center><br></p><div class=pgc-img><img alt="對 ResNet 本質的一些思考" onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/3579245a8f3b429d8802c78c1a3be431><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-center>圖片來自《MobileNetV2: Inverted Residuals and Linear Bottlenecks》</p><p class=ql-align-justify>ReLU 這個東西，其實就是一個濾波器，只不過這個濾波器的作用域不是信號處理中的頻域，而是特徵域。那麼濾波器又有什麼作用呢？維度壓縮，俗話說就是降維啦：如果我們有 m 個 feature 被送入 ReLU 層，過濾剩下 n 個（n&lt;m），這不就是相當於對 feature 的維度進行了壓縮，使其從 m 維變為 n 維嘛。</p><p class=ql-align-justify>那麼，為什麼低維數據流經非線性激活層會發生坍塌（信息丟失），而高維數據就不會呢？</p><p class=ql-align-justify>打個簡單但不嚴謹的比方：大家都有過年搶高鐵票的經驗吧？幾個人（維度低）幫你搶一張票，肯定沒有一群人（維度高）幫你搶一張票，成功的概率高啊。幾個人裡面，大概率全軍覆沒，沒一個能幫上你忙的。而一群人裡面，大概率總有那麼一個手速驚人的單身青年，幫你搶到你心心念唸的回家票。</p><p class=ql-align-justify>在數據上也是一個道理，維度低的 feature，分佈到 ReLU 的激活帶上的概率小，因此經過後信息丟失嚴重，甚至可能完全丟失。而維度高的 feature，分佈到 ReLU 的激活帶上的概率大，雖然可能也會有信息的部分丟失，但是無傷大雅，大部分的信息仍然得以保留。所謂留得青山在，不愁沒柴燒嘛。更何況被 ReLU 截殺的信息，可能只是一些無用遊民（冗餘信息）。</p><p class=ql-align-justify><strong>那麼數據的坍塌，是個很嚴重的事嗎？</strong></p><p class=ql-align-justify>那事兒可大了。如果把神經網絡比作一個人的話，你這就是給它的某個部位的血管裡，丟了個血栓。</p><p class=ql-align-justify>當信息無法流過 ReLU 時，該神經元的輸出就會變為 0。而在反向傳播的過程中，ReLU 對 0 值的梯度為 0，即發生了梯度消失，這將導致神經元的權重無法再通過梯度下降法進行更新，這種現象被稱為特徵退化。所以這個神經元相當於死掉了，喪失了學習能力。我們說，一旦神經元的輸出陷入 0 值，就無法恢復了。</p><p class=ql-align-justify></p><p class=ql-align-center><br></p><div class=pgc-img><img alt="對 ResNet 本質的一些思考" onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/405e3c218dc742a3baec5de8fb40e8d7><p class=pgc-img-caption></p></div><p class=ql-align-center><br></p><p class=ql-align-justify><br></p><p class=ql-align-justify>那麼，我們應該<strong>怎麼去規避數據的坍塌呢</strong>？非線性激活層到底是個什麼樣的東西？</p><p class=ql-align-justify>其實，對於一個數據，利用非線性激活層對其進行激活，其實是從該數據的信息中提取出其潛在的稀疏性，但是這種提取的結果是否正確，就要分情況討論了。</p><p class=ql-align-justify>對於一個 M 維的數據，我們可以將其看成是在 M 維空間中的一個 M 維流形（manifold）。而其中的有用信息，就是在該 M 維空間中的一個子空間（子空間的維度記為 N 維，N&lt;=M）中的一個 N 維流形。非線性激活層相當於壓縮了這個 M 維空間的維度（還記得前面提過的維度壓縮嗎？）。若是該 M 維空間中的 M 維流形本來就不含有冗餘信息（M=N），那麼再對其進行維度壓縮，必然導致信息的丟失。</p><p class=ql-align-justify>而維度低的數據其實就是這麼一種情況：其信息的冗餘度高的可能性本來就低，如果強行對其進行非線性激活（維度壓縮），則很有可能丟失掉有用信息，甚至丟失掉全部信息（輸出為全 0）。</p><p class=ql-align-justify>與非線性激活層不同的是，線性激活層並不壓縮特徵空間的維度。於是，我們得到了一條<strong>使用激活層的原則</strong>：</p><ol><li class=ql-align-justify>對含有冗餘信息的數據使用非線性激活（如 ReLU），對不含冗餘信息的數據使用線性激活（如一些線性變換）。</li><li class=ql-align-justify>兩種類型的激活交替靈活使用，以同時兼顧非線性和信息的完整性。</li><li class=ql-align-justify>由於冗餘信息和非冗餘信息所攜帶的有用信息是一樣多的，因此在設計網絡時，對內存消耗大的結構最好是用在非冗餘信息上。</li></ol><p class=ql-align-justify><br></p><p class=ql-align-justify>根據以上的原則設計出來的結構，聰明的你想到了什麼？ResNet。不得不讚嘆 Kaiming He 的天才，ResNet 這東西，描述起來固然簡單，但是對它的理解每深一層，就會愈發發現它的精妙及優雅，從數學上解釋起來非常簡潔，非常令人信服，而且直切傳統痛點。</p><p class=ql-align-justify>ResNet 本質上就幹了一件事：<strong>降低數據中信息的冗餘度</strong>。</p><p class=ql-align-justify>具體說來，就是對非冗餘信息採用了線性激活（通過 skip connection 獲得無冗餘的 identity 部分），然後對冗餘信息採用了非線性激活（通過 ReLU 對 identity 之外的其餘部分進行信息提取 / 過濾，提取出的有用信息即是殘差）。</p><p class=ql-align-justify>其中，<strong>提取 identity 這一步，就是 ResNet 思想的核心</strong>。</p><p class=ql-align-justify>從本文的觀點來看，因為從數據中拿掉了非冗餘信息的 identity 部分，會導致餘下部分的信息冗餘度變高。這就像從接近飽和的溶液中移走了一部分溶質，會使得剩下的溶液的飽和度降低，一個道理。</p><p class=ql-align-justify>在這裡也引用一下其他的一些觀點，方便大家可以從一個更全面的角度去看這個問題：</p><p class=ql-align-justify>從特徵複用的觀點來看，提取 identity 部分，可以讓網絡不用再去學習一個 identity mapping（雖然是一樣的東西，但是畢竟又要從頭學起，講真，換你來試試，這其實真的不容易學到），而是直接學習 residual。這就輕鬆愉快多了：站在巨人的肩膀上，做一點微小的工作什麼的...</p><p class=ql-align-justify>既然說了 ResNet 解決的痛點，也順便多說幾句它帶來的好處：</p><ol><li class=ql-align-justify>由於 identity 之外的其餘部分的信息冗餘度較高，因此在對其使用 ReLU 進行非線性激活時，丟失的有用信息也會較少，ReLU 層輸出為 0 的可能性也會較低。這就降低了在反向傳播時 ReLU 的梯度消失的概率，從而便於網絡的加深，以大大地發揮深度網絡的潛能。</li><li class=ql-align-justify>特徵複用能加快模型的學習速度，因為參數的優化收斂得快（從 identity 的基礎上直接學習殘差，總比從頭學習全部來得快）。</li></ol><p class=ql-align-justify><br></p><p class=ql-align-justify>最後是兩個小 tips：</p><ol><li class=ql-align-justify>如果一個信息可以完整地流過一個非線性激活層，則這個非線性激活層對於這個信息而言，相當於僅僅作了一個線性激活。</li><li class=ql-align-justify>解決由非線性激活導致的反向傳播梯度消失的竅門，就是要提高進行非線性激活的信息的冗餘度。</li></ol><p class=ql-align-justify><br></p><p class=ql-align-justify>如果您覺得本文對您有所幫助，請高抬貴手點個贊～</p><p class=ql-align-justify>接下來會填之前語義軟分割的坑和圖神經網絡的坑，還有一些雜七雜八的：如姿態估計網絡啦、deepSLAM 啦、視覺跟蹤網絡啦、VQA 啦... 最近光忙著看 paper 和寫筆記了，有空再整理後發上來。</p><p class=ql-align-justify>以上。</p><p class=ql-align-justify>本文經授權轉載自知乎，作者黃二二</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>ResNet</a></li><li><a>本質</a></li><li><a>思考</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/5f8b26e0.html alt=多態的本質，java動態綁定 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/50ac000493fbc8532b5e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/5f8b26e0.html title=多態的本質，java動態綁定>多態的本質，java動態綁定</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b180767b.html alt=激光和無線電波產生的原理本質上有區別嗎？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2e965d5e74f44420b87ba3688e1d4034 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b180767b.html title=激光和無線電波產生的原理本質上有區別嗎？>激光和無線電波產生的原理本質上有區別嗎？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7919f757.html alt=為什麼女性地位持續走高?本質原因是什麼? class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/9c13e5dc2be9438183c1f5821ce26da2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7919f757.html title=為什麼女性地位持續走高?本質原因是什麼?>為什麼女性地位持續走高?本質原因是什麼?</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/245fba1b.html alt=乾貨：高速走線長度的一些思考 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/2e8d546c8b3845a3b03667484df1e2c4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/245fba1b.html title=乾貨：高速走線長度的一些思考>乾貨：高速走線長度的一些思考</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c847638b.html alt="關於時空物理的思考 #F30" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1e59bcebadcb47b48ddc506eaffd04eb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c847638b.html title="關於時空物理的思考 #F30">關於時空物理的思考 #F30</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ebd6229a.html alt=流變的本質：亞里士多德做了哪些釋義？以揭示現象世界的時間密鑰 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/8553252df21a4c8d8a7c1bf0473300d9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ebd6229a.html title=流變的本質：亞里士多德做了哪些釋義？以揭示現象世界的時間密鑰>流變的本質：亞里士多德做了哪些釋義？以揭示現象世界的時間密鑰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/eae111ad.html alt=鋰電平均電壓的本質是什麼？如何提高？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/aeef666d68724b838565011a3bc15992 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/eae111ad.html title=鋰電平均電壓的本質是什麼？如何提高？>鋰電平均電壓的本質是什麼？如何提高？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/027e449e.html alt=地震反演思考之二 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/d4440647c3ef4439961c5bca2f0b1c29 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/027e449e.html title=地震反演思考之二>地震反演思考之二</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c5efcd7c.html alt=美的本質：美是引起人類生命主體精神有益性的整體和諧與統一。 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c5efcd7c.html title=美的本質：美是引起人類生命主體精神有益性的整體和諧與統一。>美的本質：美是引起人類生命主體精神有益性的整體和諧與統一。</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/6ac1ddd7.html alt=長絲土工布跟短絲土工布本質就不一樣 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/747b180bd02c430fbac7b90b4e46f777 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/6ac1ddd7.html title=長絲土工布跟短絲土工布本質就不一樣>長絲土工布跟短絲土工布本質就不一樣</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c86a79d7.html alt=終身學習本質上就是修煉我們的心智模型 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/4035ee2a8dd940918f8fde04a5f66bf0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c86a79d7.html title=終身學習本質上就是修煉我們的心智模型>終身學習本質上就是修煉我們的心智模型</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/be29118d.html alt=行為心理學：女人言語和行為的不一致本質上是認知失調 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/76392e54933d47d78dd41d829e18fc79 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/be29118d.html title=行為心理學：女人言語和行為的不一致本質上是認知失調>行為心理學：女人言語和行為的不一致本質上是認知失調</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/57179f35.html alt="今日直播：量化投資的本質與未來 | 北大博雅講壇第194期" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/R6Du4xN4vSbhWa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/57179f35.html title="今日直播：量化投資的本質與未來 | 北大博雅講壇第194期">今日直播：量化投資的本質與未來 | 北大博雅講壇第194期</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/b2fdbb6d.html alt=我的中醫思考 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a221dcd2f44e4c22b89c2518b3177663 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/b2fdbb6d.html title=我的中醫思考>我的中醫思考</a></li><hr><li><a href=../../tw/%E7%A7%91%E5%AD%B8/dba1a35f.html alt="木糖醇和糖 本質都一樣丨每日健康問答" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/Rhc79OU8bYoMmQ style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E5%AD%B8/dba1a35f.html title="木糖醇和糖 本質都一樣丨每日健康問答">木糖醇和糖 本質都一樣丨每日健康問答</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>