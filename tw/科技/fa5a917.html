<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>易語言遠控組件代碼分析 | 极客快訊</title><meta property="og:title" content="易語言遠控組件代碼分析 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p1.pstatp.com/large/pgc-image/1528400017458843414c996"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fa5a917.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fa5a917.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/fa5a917.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fa5a917.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fa5a917.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/fa5a917.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/fa5a917.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fa5a917.html><meta property="article:published_time" content="2020-10-29T21:06:59+08:00"><meta property="article:modified_time" content="2020-10-29T21:06:59+08:00"><meta name=Keywords content><meta name=description content="易語言遠控組件代碼分析"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/fa5a917.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>易語言遠控組件代碼分析</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><div><p><strong>《易語言遠程控制技術教程》</strong></p><p><strong>前 言</strong></p><p>利用遠程控制技術對企業管理，可加快我國經濟建設的需要。易語言以其易學易用功能完善的功能，從而為企業管理中的遠程控制提供了基礎的編程條件。</p><p>本教程從一個基本面說明了遠程控制技術的編程環節，可能大家比較感興趣的是雙向通訊技術、自動上線技術、網絡通訊協議、內存壓縮圖片技術、TELNET超級終端等技術，本教程均提供了例程。高級的遠程控制技術應用請大家繼續學習WINSOCK，API應用，端口映射技術等。</p><p>對於破壞國家正常經濟秩序的黑客行為，本書是嚴厲批評的。由於黑客技術的發展，遠程控制被少數人利用，對國民生產產生了不良的後果。本教程不得不接觸到遠程控制這個方面，但僅以討論的形式為大家介紹，並不進行細緻的介紹，以讓大家對此類黑客技術有所提防。</p><p>由於本教程中，某程序可能即包含了服務器組件，也包含了客戶組件，因此如果用外部流行的"服務端/客戶端"提法很容易混淆，因此本書將主動進行控制管理的一方稱為："主控方"，編寫的程序為："主控端"；將被動接受控制的一方稱為："受控方"，編寫的程序為："受控端"。</p><p>本教材個人可打印一份細看，各兄弟網站可自由轉載而不用事先打招呼。版權所有，不得批量印刷即可。</p><p>作者還要說的話：本教程用了我兩個月的時間寫完，前期收集例程及寫例程用了我更多的時間，特別辛苦。遠程控制是把雙刃劍，可以好好利用，也可能造成不好的影響。還好作者回頭再看本教材後，感覺對於企業內部管理應用還是非常不錯的，可以提高中國中小企業的管理水平，但不可能製作成類似於灰鴿子那樣的破壞功能，本書沒有提供這樣的技術，也請大家自重，不要寫破壞性的程序。</p><p>本書使用到大量的例程，足有200MB，還好，書中我基本都提供了下載鏈接，如果書中沒有列出的例程，請大家跟貼指出來，我會補上。我覺得最好的學習方法是先將這些例程收集全了，再一個一個打開看看，基本上就能明白了。</p><p><strong>目 錄</strong></p><p><strong>本書引用例程</strong></p><p><strong>第一課．遠程控制原理</strong></p><p><strong>1．企業管理的需要</strong></p><p>利用易語言的遠程控制技術，可以對企業中的電腦進行非常方便的管理。典型的類似軟件如：QQ的遠程協助功能，微軟的NETMEETING，PCANYWHERE，還有一些網吧等單位利用遠程管理，自動更新客戶機的桌面遊戲鏈接，遊戲文件大文件的自動更新。有的企業可以遠程管理員工的桌面，及時發佈企業重要信息，大文件的傳輸，遠程維修客戶電腦等。</p><p><strong>2．介紹相關管理工具</strong></p><p>在企業管理中，實際上已有一些軟件了，如：騰訊的QQ，還有CC，以及一些有名的遠程管理軟件PCANYWHERE；黑客使用遠程控制較有名的是：冰河、灰鴿子，任我行等。</p><p>企業內部使用的還有一些如：局域網尋呼機，內部聊天工具，易鴿子，聊天室等。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528400017458843414c996><p class=pgc-img-caption></p></div><p>PCANYWHERE</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15284000175890d1ed7d265><p class=pgc-img-caption></p></div><p>冰河</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1528400017750b2a02dd1f2><p class=pgc-img-caption></p></div><p>灰鴿子</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528400017894857a66d3a5><p class=pgc-img-caption></p></div><p>局域網尋呼機</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528400018035a232a28851><p class=pgc-img-caption></p></div><p>易鴿子</p><p><strong>3．組件簡介</strong></p><p>易語言中數據報組件採用了UDP原理的協議。</p><p>還有采用簡單TCP/IP協議的組件，如：服務器/客戶組件。</p><p>保密通訊支持庫將TCP/IP協議及安全套接字層/RSA加密技術，兩用戶之間通訊較好及穩定。</p><p>而遠程服務支持庫採用了TCP/IP協議，並且封裝了多線程池，支持多用戶、多任務、多線程、大文件的數據傳輸。</p><p><strong>第二課．組件選擇</strong></p><p>下面對易語言中幾種遠程管理的組件對比介紹</p><p><strong>1．數據報</strong></p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/15284000181390126802fe0><p class=pgc-img-caption></p></div><p>數據報是一種不可靠、小數據量的網絡數據交互方式。如果傳遞的數據量過大，有可能會失敗，最好不要超過 127 字節。如需要大數據量或者可靠數據傳送方式，請使用基於連接的其它網絡組件。</p><p>數據報組件轉輸的協議是UDP，也就是說，他的發送量非常小，介紹中說最好不要超過127字節，但在網絡穩定的情況下，可以發送200字節不成問題。</p><p>同時它也是一種不需要握手過程的通訊協議，即：它可以廣播發送，這個優勢可以利用到局域網中向所有用戶發送消息，廣播發送的速度也非常快，無需等待。</p><p>也可以利用這個組件的廣播機制，進行快速的連接服務端。即程序中同時使用數據報和"服務器/客戶"組件，這樣通過數據報通知已下線的客戶連接服務器。</p><p>同時，如果設計得好的話，可以讓這個組件自己推舉服務器，即查到IP地址中哪一臺電腦的IP值最大，找到最大號的，這臺就作為服務器使用，或啟動"服務器/客戶"組件，改由"服務器/客戶"組件進行服務。</p><p><strong>2．服務器/客戶組件</strong></p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1528400018236087a01ab8d><p class=pgc-img-caption></p></div><p>服務器組件是基於連接的網絡數據交換的服務方組件，用作在指定端口監視來自客戶方的數據。</p><p>需要採用一臺電腦作為服務器使用，其他電腦作為客戶機，使用上較為方便，一次最大可發送4380個字節，超過這個字節數，必須使用分包的辦法，在接收的用戶處再還原包。</p><p>由於可擴展性非常差，即不支持多用戶，多線程，大文件傳輸入，在用戶數量多，數據量大的情況下會產生紊亂，不建議大家用於商業程序中。</p><p><strong>3．網絡通訊支持庫</strong></p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528400018331aa04321bce><p class=pgc-img-caption></p></div><p>是服務器/客戶組件的升級版。包括了監聽等功能。</p><p>同上，不建議大家用於商業程序中。</p><p><strong>4．保密通訊支持庫</strong></p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15284000184539e6109df16><p class=pgc-img-caption></p></div><p>本支持庫實現在網絡上保密通訊的目的。由於一些機密數據在網上傳輸過程中可能會被一些別有用心的人截獲破壞，以致對數據的擁有者造成經濟上或者是物質上的損失，這樣就要求數據在網絡上傳輸的過程中不會被他人利用破壞。本支持庫的設計和實現就是為了完成在網絡上保密通訊的目的，注意本支持庫僅僅是完成對數據在傳輸的過程中的保護。理論上，在用戶的私鑰不公開的情況下，該通訊方式是絕對安全的，即使算法的設計者也不能做出任何破壞。本支持庫使用也非常簡單，在客戶端和服務程序連接前，設置好相應密鑰，在實際的使用過程中，用戶不必關心加密解密的過程，正常發送和接收數據就可以了。為了完全理解該支持庫，建議使用者查閱有關"安全套接字層(SSL)"的原理，本支持庫就是對該原理的實現。</p><p>這是一個較好的用於商業的組件，每次最大發送：20480個字節，再大的文件需要自定義分包協議傳輸，保密性能好。</p><p>但存在的問題是，多用戶機制，及多線程不支持。因此只能作為點對點傳輸的工具編程，即當用戶需要傳送時，手工建立兩個用戶的連接，再進行傳輸，建議一些保密要求極為嚴格的商業程序使用本支持庫。如軍方、政府。</p><p><strong>5．遠程服務支持庫</strong></p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1528400018593a1d669eb56><p class=pgc-img-caption></p></div><p>該支持庫提供對服務器端程序和客戶端程序的支持。客戶端發出請求，服務器端接受到客戶端的請求後，就會執行事先設置好的觸發函數，在觸發函數的方法中就可以分析用戶端的請求，然後計算出結果發回給相應的客戶端。該支持庫的服務器模型支持多用戶多任務，內部採用多個線程池協調同步共同完成任務數據的發送接收。本支持庫一般可以使用在網絡服務中間件，遠程調用服務器，分佈式計算等等程序的開發過程中。</p><p>這個支持庫是本書重點推薦的一個支持庫。支持多用戶，多任務，多線程，大文件傳送。支持庫內部已將多用戶計劃任務作為線程池保護起來，直接傳輸完成為止。</p><p>應用上極為廣泛，如：遠程監視控制，遠程數據服務等。</p><p>這是個多線程的，使用了4個線程池。</p><p>建議你使用同步連接模式，這樣，客戶的每一次請求處理完成後才順序執行下一個請求，會有一個順序性。如果你使用異步傳輸模式 快速的發向服務器 實際上每個發送來的信息都作為一個請求放到了請求列隊中。</p><p>異步連接模式：服務端不會按照發送來的順序返回信息，造成不便。</p><p>接受 - 處理 - 返回</p><p>就這樣一個流程，每個發送的請求都單獨處理。</p><p>你發的又不是數據流，如果你不停的發，服務器就會不停的接收直到請求文本發送結束服務器才處理這個請求。</p><p>如果你快速的發很多數據造成服務器來不及時處理。緩存大量的請求信息 會造成問題。</p><p>但是呢，線程數量是能自己控制的，你改成99999，就看你的機器處理能力了。</p><p>如果你一定要大量的發送請求信息，處理過程很複雜服務器不能及時處理，就會讓服務器跨掉。實際上這樣的話，服務器的性能達到極限，你還要考慮帶寬是否充足哦。</p><p>同步連接 - 處理客戶端主動的請求信息，主動的查詢。</p><p>在有明確查詢目的時候使用。</p><p>異步連接 - 被動等待服務器的信息並做出反應，被動的接收然後響應服務器。在不確定什麼時間查詢，需要服務器主動聯繫客戶端的時候使用。</p><p>"服務器.發送文本"第1個參數問題：</p><p>如果你給的是文本型，就默認是請求代碼</p><p>如果你給的整數型，就默認是客戶句柄</p><p><strong>而"到數值"方法返回的是雙精度小數型，因此必須用整數型，可以用"取整（）" 命令，或整數型的變量。</strong></p><p><strong>用以下代碼試試：</strong></p><p><strong>服務器.發送文本 (取整(到數值(列表框1.取項目文本 (列表框1.現行選中項)))</strong></p><p><strong>千萬不能用"到數值（）"這樣的單一命令放在第一個參數中，因為"到數值（）"返回的是雙精度小數型。因此還要用"到整數（到數值（……））"這樣的命令方式。</strong></p><p><strong>6．網絡傳送支持庫</strong></p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528400018679f6c59db093><p class=pgc-img-caption></p></div><p>本支持庫實現對多種協議斷點續傳下載與FTP上傳的支持，並提供了豐富的設置方式。當前版本支持HTTP，FTP，MMS多線程下載及斷點續傳，以及對RTSP協議的單線程下載及斷點續傳。用戶可以根據各自的主機及網絡情況進行設置,本支持庫可以運行在linux下.詳細情況參見例程,注意：當前版本使用了映射文件模式，並且是一次全部映射的方法。所以最大傳送不超過一次映射文件的長度。</p><p>這個支持庫主要是應用於FTP，需要FTP服務器。易語言中有現成的例程，在遠程控制中，用於客戶端的自動上線功能。</p><p><strong>7．網絡通訊支持庫二</strong></p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528400018795464c931231><p class=pgc-img-caption></p></div><p>本支持庫實現了對原始套接字和ARP協議的支持。通過原始套接字，我們可以更加自如地控制多種協議，而且能夠對網絡底層的傳輸機制進行控制；ARP（地址解析協議），就是將網絡層（IP層，也就是相當於ISO OSI 的第三層）地址解析為數據連接層（MAC層，也就是相當於ISO OSI的第二層）的MAC地址。</p><p>這個支持庫使用較為自由，但必須要熟悉相關的網絡通訊協議，如果你對其中的協議都瞭解了，使用這個支持庫就簡單了。</p><p><strong>8．表1：網絡通訊類支持庫組件功能對比表</strong></p><p>表1：網絡通訊類支持庫組件功能對比表</p><p><strong>9．網絡傳送大文件丟包的原因</strong></p><p><strong>不外乎以下幾個原因：</strong></p><p>1．單用戶分包問題：小量字節發送以上組件完全沒有問題，但如果通訊內容超過了最大發送的範圍，就只能通過分包傳送解決。正確的方法是：分包時就要制定一個轉送的協議，簡單地就是在每個包前面加個標記和序號，有的還加上MD5碼以檢查是否傳送完整，整個多少包的信息等，然後在服務端組織收包的工作。</p><p>有的用戶傳送時只與一個用戶通訊，並通過延時解決交叉傳送互相影響的問題，不太科學。延時相對就時間長，時間長不一定不好，就看你能不能有信心等下去了。</p><p>2．多用戶分包問題：第二個原因是用戶多，即使分包了，也不一定能正常轉送完整，還要回過頭來進行檢查是否丟包，如果有丟包就要回頭重新傳，最後合併為一個文件。併發的用戶亂傳包，你受得了嗎？需要寫程序實現多用戶多線程序操作，工作量不小。最好組件能自己建立線程池，自己組織收包的工作。</p><p>3．支持庫有BUG，如：有人說發一個包，接收方卻收到兩個包。還有支持庫運行時間長了，會有各種問題，開一天，開一個星期，開一個月長時間的測試看看。</p><p>總結：實際上，易語言核心支持庫中的三個組件只能學習用，或發一些簡單的指令什麼的可完全勝任，簡單的製作個QQ登錄什麼的，到此為止吧。網絡通訊支持庫也只是個沒有組件界面的簡單升級版而已，浪費編程人員很多時間。如果要實戰，那麼單用戶大文件傳送請直接考慮保密通訊支持庫，多用戶大文件傳送請直接考慮遠程服務支持庫。不要多想了，立即行動吧。</p><p><strong>第三課．組件構成</strong></p><p><strong>1．用例圖1：通訊類（易鴿子，局域網尋呼機，方舟千里眼）</strong></p><p><strong>2．用例圖2：聊天室類</strong></p><p><strong>3．用例圖3：遠程控制</strong></p><p><strong>4．用例圖4：遠程數據服務（數據庫）</strong></p><p><strong>5．採用單對組件</strong></p><p>基本上編程人員在確定自己選用哪一種組件後，就固定在程序中只使用這種組件，編程上就較為簡單。但一些受單一組件限制的功能就無法解決，複雜一些的功能可能也難以應用，如：服務端必須先上線再讓客戶機上線，服務端上線後不允許掉線，服務端掉線後，客戶端必須重啟等。這樣在單一組件的模式下，總是很難完成一些"自動化"的任務。</p><p>如果用時鐘總是去償試連接，可能造成網絡資源的佔用。</p><p>有時就會產生反向連接的狀態，即客戶端使用的是服務器組件，而服務端使用的是客戶組件，這在一些黑客軟件中採用比較多，但</p><p><strong>6．採用多種組件</strong></p><p>在這裡是將組件的類型擴大化了，實際上，採用了這樣一種策略，即自動上線即採用了數據報，也採用了服務端/客戶反向連接，以及遠程服務反向連接，和FTP網絡地址的方式。最終的通訊還是使用遠程服務支持庫來實現。即自動連接是由不同組件完成的，連接後的操作權交由遠程服務來完成。</p><p>特別注意的是，這裡用數據報進行了廣播形式的激活，這種方法速度非常快，在局域網內非常有效，而用英特網的IP地址的方法將服務端的IP地址告訴客戶機的方法非常適合英特網用戶使用。</p><p><strong>7．組件搭配</strong></p><p>如果限定了在只在局域網內進行遠程服務，那麼採用：數據報激活+服務器/客戶反向激活+遠程服務支持庫提供服務比較好。</p><p>如果是在英特網的廣域網上使用，可以採用FTP，及網頁上存放服務端IP地址的方式，或遠程序服務支持庫反向激活的方式進行激活，激活後的權限交由遠程程序支持庫操作比較好。</p><p><strong>8．表2：有易語言源碼的遠程控制軟件對比</strong></p><p><strong>9．實用例程簡介</strong></p><p><strong>非雪之戀遠程控制</strong></p><p>這是一個極簡單的遠程序控制系統，採用了常見的"服務器/客戶"反向連接的方式。</p><p>一些常用的命令列在界面中，操作簡單方便。</p><p><strong>方舟千里眼</strong></p><p>採用了兩對"服務器/客戶"組件互相連接，以及用數據報發佈廣播自動上線功能。</p><p>特點是採用"服務器/客戶"實現了遠程監控，及九畫面監控牆的功能。</p><p>有類似於QQ聊天的窗口。自動上線找用戶，非常方便。</p><p><strong>諾亞遠程控制</strong></p><p>類似於灰鴿子的界面，採用了常見的"服務器/客戶"反向連接的方式。實現了簡單指令集的功能。較為簡單。</p><p><strong>蝶蝶不休遠程控制</strong></p><p>採用了常見的"服務器/客戶"正向連接的方式。</p><p>可學習的地方是對進程及鍵盤鼠標的監視功能。</p><p><strong>好人好遠程協助</strong></p><p>採用了常見的"服務器/客戶"正向連接的方式。</p><p>是參加易語言大獎賽未得獎的作品，主要是寫得太亂了。</p><p>對遠程註冊表、進程管理、鼠標控制都有較好的支持。</p><p><strong>yok9金立遠程控制</strong></p><p>採用遠程服務支持庫，並行同步發送數據。</p><p>主控端可生成受控端EXE文件。最重要的是對TELNET超級終端的支持。以及遠程進程方面可以學習。還帶一個漂亮的皮膚。</p><p><strong>雲霄遠程精靈</strong></p><p>採用遠程服務支持庫，並行異步發送數據。</p><p>功能較為全面，如：聊天工具也有，也可以查看受控端剪輯板，生成受控端EXE文件，遠程註冊表，進程管理、鼠標控制等。</p><p><strong>第四課．通訊協議</strong></p><p><strong>1．指令簡介</strong></p><p>按形式分，可分為：</p><p>簡單指令、複合指令、複雜指令</p><p>按內容分，可分為以下：</p><p>1）文本指令/多文本指令</p><p>2）指令文本+字節集</p><p>3）指令文本+字節集+指令文本</p><p>4）指令文本+字節集+間隔符號+字節集+間隔符號</p><p><strong>2．指令應用</strong></p><p>1）簡單指令：文本指令/多文本指令</p><p>發送一些簡單的指令，如讓客戶機電腦重啟，開啟光驅等。</p><p>如果帶有參數，後面可跟著其他指令文本，中間用分隔符分隔。</p><p>主要用於單個指令。例如：</p><p>打開光驅</p><p>也可用於組合指令，或帶有參數的。例如：</p><p>"鼠標移動|30|20"</p><p>例程：參見"諾亞遠程"中的說明文檔（諾亞指令集）。</p><p>2）指令文本+字節集</p><p>主要用於傳輸入文件，如數據庫，配置文件，圖片文件等。前面的指令文本可用複合指令，可包含文件名的信息等。</p><p>大文件傳輸入時，在用遠程服務支持庫時可以直接採用這種方式。</p><p>在分包的情況下，也可以這樣傳送，但在指令文本處標記當前是哪一個包號，甚至將單個字節集的MD5碼也放在指令文本中發送，以進行驗證數據完整性。也可以將整個字節集的MD5碼進行數據完整性驗證。</p><p>主要用於大文件整包發送。例如：</p><p>"保存文件|"+文件名+"|"+文件字節集</p><p>或分包發送時代用。例如：</p><p>"保存文件|"+文件名+"|包1|共10|"+MD5碼+"|"+文件字節集</p><p>3）指令文本+字節集+指令文本</p><p>這裡主要用於對傳送字節有限制時，要將傳送的文件的前後加上標記，這樣用戶端接收到之後，就可以還原文件了。必要時，需要將整個字節集的MD5碼放在指令文本中，以進行驗證數據的完整性。</p><p>主要用於大文件分包發送時的指令。例如：</p><p>"圖片開始"+圖片字節集+"圖片結束"</p><p>"文件開始"+文件字節集+"文件結束"</p><p>例程：指令文本+字節集+指令文本：請參見諾亞遠程中的傳送接收圖片部分。</p><p>4）指令文本+字節集+間隔符號+字節集+間隔符號</p><p>這裡主要是多文件傳送，如一個數據庫還帶有索引及備註庫，這樣最好是一次性地傳送過去。</p><p>或其他特別的場合用上。</p><p><strong>第五課．用戶連接</strong></p><p><strong>1．連接方式</strong></p><p>正向連接：就是管理員使用的組件是服務器組件，用戶端使用的是客戶組件。這時，客戶組件需要知道服務器組件的IP地址，同時需要服務器組件先上線，以取得握手。</p><p>反向連接：這是黑客一般使用的，即用戶端使用的是服務器組件，而管理員使用的是客戶組件，這樣管理員可以非常方便地與用戶連接。</p><p>一般來說，原理就是這樣，採用何種連接方式都是可以的，主要在於編程人員怎樣克服困難了。</p><p>如正向連接時必須服務器先上線，這個可以克服的，服務器後上線時，可以將IP地址放在網上或某臺電腦上，用戶可以定時去取，以自動激活上線。或用數據報廣播讓客戶端上線。</p><p>如反向連接時，不知被控端的IP地址，主控端需要掃描網絡，以知道哪臺被控端電腦上線了，這時可以通過被控端用戶發送EMIAL或FTP消息通知主控端管理員有人上線了。</p><p>如反向連接時，不能直接廣播，可以用循環命令，依次向受控端嘗試連接。</p><p><strong>2．登錄口令</strong></p><p>為安全起見，有時通訊組件的端口可能會被檢查人員查到，或正好遇到某個端口號與其他軟件重複，因此在握手連接時，需要加上用戶名和口令，以示區別。</p><p><strong>3．身份驗證，MAC和硬盤碼</strong></p><p>每臺電腦的IP地址及用戶名都是可以換的，而且換起來非常方便。為安全管理，IP地址應該綁定一些硬件才行，這樣網卡的MAC地址是比較固定的，如果可能，也可以與硬盤碼、硬盤序列號、CPU序列號、BOIS序列號綁字在一起。同時要注意，如果綁定時取不到硬件號，一定要做好容錯處理，可以默認一個固定的序列號。</p><p><strong>第六課．遠程監視</strong></p><p><strong>1．"服務器/客戶"組件通訊模式</strong></p><p>"服務器/客戶"組件只能用於發送小於4380字節的通訊，因此對於超過4380字節的大圖片，操作上就需要分包傳輸了。</p><p>例程參見：諾亞遠程中的圖片傳輸部分。</p><p><strong>2．內存壓縮圖片</strong></p><p>使用"快照（）"命令，所取得的字節集是BMP格式，非常大，如果直接傳，將大量佔用網絡資源。因此要壓縮成JPG圖片格式，傳統的，要將BMP保存到硬盤上，形成BMP文件，再轉換為JPG格式，才可以傳送，這樣是十分麻煩的。因此有沒有辦法直接在內存中壓縮為JPG格式呢？可以的，請使用凌晨孤星發的"使用GDI+在內存轉換圖像格式"例程，在論壇上可以搜索到的。</p><p>例程參見：使用GDI+在內存轉換圖像格式.RAR</p><p><strong>3．"遠程服務支持庫"</strong></p><p>由於遠程服務支持庫支持大文件傳輸，因此不用分包傳圖片，而且還支持多用戶 ，多任務，多線程，是進行遠程桌面監視的好工具。</p><p>例程參見：\第2課_基本組件例程\河童-遠程桌面\主控端-遠程.e</p><p>例程參見：\第2課_基本組件例程\河童-遠程桌面\受控端-遠程.e</p><p><strong>第七課．自動上線</strong></p><p><strong>1．數據報廣播自動上線</strong></p><p>局域網內可採用"數據報"的廣播功能，實現自動上線。</p><p>下述命令中的第一個參數為空，即是廣播發送。</p><p>對象．發送數據 （［文本型 接收主機地址］，整數型 接收主機端口號，通用型 欲發送數據）</p><p><strong>2．多對"服務器/客戶"組件反向掃描上線</strong></p><p>即用戶端使用的是"服務器"組件，而主控端使用的是"客戶"組件，通過對IP地址的順序連接，實現自動上線。</p><p>缺點：掃描時間非常長，有時電腦像死機一樣。</p><p>減少連接時間的辦法是採用多線程，ARP技術實現快速掃描在線客戶，然後再對在線客戶連接，實現自動上線。</p><p><strong>3．服務IP地址自動搜尋自動上線</strong></p><p>可建立FTP，將服務器的IP地址放在上面，受控端自動查找，每間隔一段時間自動連接。</p><p>或將服務IP地址放在網頁上，由受控端讀取，自動連接。</p><p><strong>4．將IP地址直接綁定在受控端</strong></p><p>將主控端的IP地址直接寫在受控端，生成EXE可執行文件，供受控端使用。</p><p><strong>5．推舉服務器</strong></p><p>推舉網內最大的一個或最小的一個IP地址為服務器。此服務器如果下線，就根據規則再推舉一個為服務器。</p><p><strong>第八課．客戶端功能</strong></p><p><strong>1．發送指令</strong></p><p>如：鳴叫，鼠標，信息框</p><p>黑屏、鎖定、重啟、關機、光驅、</p><p>啟動運行、定時運行、關閉運行</p><p>在客戶端一般要實現的功能就是發送指令。由受控端接收指令後運行指令。</p><p>或簡單地彈出信息框；</p><p>有時指令帶有參數。</p><p>參見表2中大多數例程。</p><p><strong>2．對話聊天</strong></p><p>即實現類似於QQ聊天的功能，實現對話通訊的功能。</p><p>參見表2中具有聊天功能的例程。</p><p>比較好的一個聊天工具例程是"方舟千里眼"，特點是：不使用專用服務器，而可以直接聊天。</p><p>此外，比較專業的還有EQQ，竹林聊天室等。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528400018965c4fbe380e7><p class=pgc-img-caption></p></div><p><strong>3．監視屏幕</strong></p><p>即實現類似於QQ的遠程協助功能。</p><p>"服務器/客戶"組件可以實現抓取遠程屏幕的功能。</p><p>使用分包發送可傳送大圖片。參見"河童遠程桌面"例程。</p><p>也可直接使用遠程服務支持庫，支持多任務，多線程，大圖片傳送。參見"遠程桌面-你的桌面我作主-王軍"例程，特點是：可放大縮小。</p><p>比較好的是"方舟千里眼"，特點是：九畫面監視牆，可放大縮小。</p><p>提高傳輸圖像的技術，可以採用內存中抓圖，內存中壓縮圖片為JPG圖片，內存中轉送顯示在主控端。如論壇上的例程："使用GDI+在內存轉換圖像格式-凌晨孤星"</p><p>加快圖像轉輸速度的方法還有：不必要每次都傳送一張大的全屏圖片，而是對前後兩張抓圖間隔一些點後進行對比，只將不同的畫面傳過去，相同的就不傳了。因為電腦相對於播放電影來說，屏幕不是經常改變的。例如：將屏幕分成6*8這樣的48小塊，每小塊中取一些點進行對比，這樣就知道哪些範圍是改過的，哪些沒有改過，對於改過的，就取出範圍，抓圖後傳送，這樣就節約了轉輸的數據量。</p><p>還有將真彩色轉換為256色或16色轉輸，這樣也會使轉輸量小一些。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/152840001913179399deb0e><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15284000193156d13f553d1><p class=pgc-img-caption></p></div><p><strong>4．遙控功能</strong></p><p>即實現類似於QQ的遠程協助功能中的控制功能。</p><p>實現鼠標和鍵盤的控制。</p><p>參見"遠程桌面V1.0-你的桌面我作主-王軍"例程，特點是：還可輸入文字。</p><p>比較好的是"方舟千里眼"，特點是：帶有對方屏幕上的鼠標指針。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15284000194152f3ff3a900><p class=pgc-img-caption></p></div><p><strong>5．瞭解信息及修改信息</strong></p><p>瞭解對方電腦內的信息。如：</p><p>文件目錄信息，電腦系統信息，註冊表，內存剪貼板</p><p>瞭解目錄信息可以幫助我們查看是否有此可執行文件，或資料是否傳輸到位；上傳下載文件等。</p><p>瞭解電腦系統信息，可以幫助我們為受控端的程序查錯。</p><p>瞭解內存剪貼板的內容是為了瞭解用戶操作的步驟。</p><p>瞭解鍵盤輸入記錄，是黑客需要知道一些遊戲的口令等。</p><p>瞭解註冊表是為了修正客戶註冊表中的問題。</p><p>參見表2中相關軟件源代碼。</p><p>少少-少圖</p><p><strong>5．TELNET超級終端</strong></p><p>TELNET超級終端，即象在自己的電腦中操作DOS控制檯一樣。</p><p>表2中"yok9金立遠程控制"軟件提供了TELNET的功能，非常值得大家學習。</p><p>主要是採用了通道技術，因此反應非常快，象在操作自己的電腦一樣。</p><p>大家也可以使用模擬DOS的技術，取得DOS的反饋信息來實現這個效果。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528400019533462660e70f><p class=pgc-img-caption></p></div><p><strong>6．文件傳輸</strong></p><p>即實現類似於QQ中的文件傳輸功能，甚至還可以遠程更新程序，遠程運行程序，資料傳送，FTP下載等。</p><p>大文件轉輸一般採用遠程服務支持庫，優勢是多用戶，多線程，多任務，大文件。而採用"服務器/客戶"這樣的模式，不是不可以，就是當用戶多時，就會非常混亂，特別是網絡非常繁忙的時候。</p><p>下面是一個採用"服務器/客戶"組件發送及接收的代碼，可以看到如何收包還原為一個完整數據包的。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15284000196664748423322><p class=pgc-img-caption></p></div><p><strong>7．鼠標鍵盤錄製</strong></p><p>可參見參賽作品"丁坤屏捕"，論壇例程"近在眼前－鍵盤&鼠標錄製、回放例程(正規方法並帶記錄保存)"</p><p><strong>8．隱藏進程</strong></p><p>有時為了不讓用戶意外終止受控端的運行，需要將受控端的進程隱藏起來。</p><p>隱藏進程：參見表2中相關例程。</p><p><strong>9．開機啟動運行</strong></p><p>一般使用了寫註冊表的形式實現開機時啟動運行：</p><p>寫註冊項 (#本地機器, "SOFTWARE\Microsoft\Windows\CurrentVersion\Run\你的受控端程序名", 取運行目錄 () ＋ "\" ＋ 取執行文件名 ())</p><p>刪除命令是：</p><p>刪除註冊項 (#本地機器, "SOFTWARE\Microsoft\Windows\CurrentVersion\Run\你的受控端程序名")</p><p>看看下面是"韓非-非雪之戀遠程控制系統"中的代碼，比較厲害：</p><p>註冊系統進程 (取當前進程 (), 1)</p><p>隱藏系統進程 ()</p><p>複製文件 (取當前目錄 () ＋ "\" ＋ "soft.exe", 系統目錄 ＋ "\.exe")</p><p>複製文件 (取當前目錄 () ＋ "\" ＋ "soft.exe", "C:\windows\dll.exe")</p><p>寫註冊項 (#本地機器, "Software\Microsoft\Windows\CurrentVersion\Run\ ", 系統目錄 ＋ "\.exe")</p><p>寫註冊項 (#本地機器, "Software\Microsoft\Windows\CurrentVersion\Run\ ", "c:\windows\dll.exe")</p><p>寫註冊項 (#本地機器, "Software\Microsoft\Windows\CurrentVersion\RunOnce\ ", 系統目錄 ＋ "\.exe")</p><p>寫註冊項 (#本地機器, "Software\Microsoft\Windows\CurrentVersion\RunOnce\ ", "c:\windows\dll.exe")</p><p>寫註冊項 (#本地機器, "Software\Microsoft\Windows\CurrentVersion\RunOnceEx\ ", 系統目錄 ＋ "\.exe")</p><p>寫註冊項 (#本地機器, "Software\Microsoft\Windows\CurrentVersion\RunServices\ ", 系統目錄 ＋ "\.exe")</p><p>寫註冊項 (#本地機器, "Software\Microsoft\Windows\CurrentVersion\RunServicesOnce\ ", 系統目錄 ＋ "\.exe")</p><p><strong>10．正常關機</strong></p><p>有時，客戶端被設置不能用戶關閉，而是存於系統托盤中的，這時如果關機時，將不能自動關機，比較麻煩。</p><p>請大家參看下面的代碼，實現關機正常化：</p><p>"關閉程序最小化托盤(可以正常關機).e"</p><p>http://bbs.dywt.com.cn/dispbbs.asp?BoardID=124&ID=123693&replyID=&skin</p><p>前段時間寫個程序需要點關閉按鈕自動最小化托盤，結果程序如果不退出的話，關機都關不了，於是在論壇搜索截獲關機消息，就找到了老近的一個例程，改造一下，這個程序關電腦時候就不會關不了啦，今天看到有新手問這個問題，特放上來。</p><p><strong>11．多用戶識別</strong></p><p>"讓服務器控件真正分辨多客戶，不用客戶發送標識.e"</p><p>http://bbs.dywt.com.cn/dispbbs.asp?BoardID=124&ID=38916&replyID=&skin</p><p>基本原理： 一，取出客戶句柄 要實現區分多客戶，就要知道數據到達的是哪個客戶，我們可以利用客戶句柄來實現，但易的服務器控件不提供客戶句柄，這裡我們借用ELib＋＋的截獲消息來實現，這個很簡單，就用 截獲消息 () 二、用自己的發送函數。這個實際上是調用Winsock API函數的send函數來實現 具體實現方法請看我上傳的示例，示例中提供了按句柄取出客戶地址的子程序，可以讓你在數據到達事件中取出客戶地址。</p><p><strong>12．不重複運行</strong></p><p>有時，打開兩個帶有"數據報"組件的程序，會造成端口被佔用，發送不正常，因此需要確定，一臺電腦只能運行一個服務端，或客戶端。防止重複運行的例子已非常多了，大家自己在論壇上找吧。</p><p><strong>13．系統服務權限</strong></p><p>請參看"yok9金立遠程控制-遠程服務"的受控端，將自身寫到系統服務中。</p><p><strong>14．其他功能</strong></p><p>還可以讓客戶端進行以下的行為，取得最大的利益。雖然沒有造成破壞，但也會影響網絡速度，不建議大家這樣做。</p><p>自動點擊廣告：點擊某個廣告頁面，增加點擊量。</p><p>彈出通知或廣告：企業中彈出一些通知，或更換牆紙功能，網吧中更換廣告功能。</p><p>刷新網頁：可以刷新某個網頁，使得網頁刷新數增加。</p><p>洪水攻擊：不斷刷某個網址，造成此網站擁堵。不建議大家這樣做。</p><p><strong>第九課．服務端功能</strong></p><p><strong>1．安全性保證</strong></p><p>1．主控端要設置管理員密碼，以保證主控端的安全性。</p><p>2．連接時，設置口令，以防止非法用戶連接進入。</p><p>3．受控端的安全性：客戶端的IP地址是非常方便的更改的，因此需要收集用戶的網卡MAC地址，進行綁定驗證。或其他硬件信息，如：硬盤序列號，硬盤序列號，BIOS序列號等。在主控端可用一個小型數據庫存儲進行比對。</p><p>編程時要注意：這些信息取不出來時的容錯處理。</p><p>易語言的嚮導可以自動生成密碼登錄界面，採用MD5比對口令，非常安全，建議大家使用。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1528400019818e1d2879d83><p class=pgc-img-caption></p></div><p>下面是硬件信息的收集，以和IP地址進行綁定，防止用戶改成其他組別的用戶，而造成企業機密的損失。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/152840001997485e36ead8b><p class=pgc-img-caption></p></div><p><strong>2．用戶列表信息</strong></p><p>一個好的用戶列表，不僅可以非常清楚地知道哪些用戶上線，還可以知道更多的信息。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1528400020139e4177a3c0b><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/152840002042342e1dc568a><p class=pgc-img-caption></p></div><p>請大家對比一下，用戶列表展開前與展開後的佈局，不會影響其他操作。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15284000205453a9ec63ed2><p class=pgc-img-caption></p></div><p><strong>3．數據庫操作</strong></p><p>通過遠程轉輸數據，可以對主控端的一個數據庫進行讀寫操作，實現類似於網絡數據庫的功能，這樣就可用速度較快的SQLITE數據庫，代替複雜的MYSQL數據庫了。</p><p>參見例程："遠程服務支持庫-網絡版數據庫管理軟件"。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1528400020663bc71a7a68c><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15284000208302a27e64b03><p class=pgc-img-caption></p></div><p><strong>4．自動生成EXE</strong></p><p>原理就是，在生成的受控端中，資源有一些字節集可以被找到修改。</p><p>參見表2中例程："yok9金立遠程控制"和"雲霄遠程精靈"。</p><p>下面是"yok9金立遠程控制"受控端的部分代碼：</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/152840002094636ba0d1be7><p class=pgc-img-caption></p></div><p>下面是將受控端編譯後，放在主控端的資源裡：</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/152840002101921f87615ec><p class=pgc-img-caption></p></div><p>下面是可以點擊"配置客戶端"生成客戶端EXE可執行文件：</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/15284000212376b0f530276><p class=pgc-img-caption></p></div><p>下面是生成EXE的代碼，實際上是替換了內容：</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15284000213745193d58629><p class=pgc-img-caption></p></div><p>再看看另一個"雲霄遠程精靈"例程：</p><p>受控端要編譯後放在資源中：</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528400021457fb768082c7><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p9.pstatp.com/large/pgc-image/15284000216926ecf52dfaf><p class=pgc-img-caption></p></div><p>部分生成EXE可執行文件的代碼如下，大家可以看到實際是替換了受控端中的一些信息：</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528400021848aac0385d84><p class=pgc-img-caption></p></div><p><strong>5．跨網遠程</strong></p><p>需要將局域網址電腦的IP地址在路由器上影射端口，就可以實現局域網外的遠程製作了。</p><p><strong>第十課．捆綁與免殺</strong></p><p><strong>1．捆綁</strong></p><p>將一個程序與受控端捆綁，或一張圖片和一個受控端捆綁為一個EXE可執行文件，由用戶運行後，就可以同時運行受控端程序了。</p><p><strong>2．免殺</strong></p><p>受控端免除需準備兩個工具：</p><p>winrar.exe(大家都有吧)</p><p>加殼工具(網上多的是)</p><p>在我們要免殺的受控端exe文件上點擊鼠標右鍵→WINRAR→添加到壓縮文件...→創建自解壓格式文件(現在大家知道了吧，文件以經是exe的了)→高級選項→在解壓後運行（這裡寫入EXE的文件名）[還有其它選項可以更完善]→OK完成。</p><p>現在你要的受控端以經被加RAR殼保護成EXE了，但還沒完，再用加殼工具加一下殼，最終完成。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15284000220108dbd63e38d><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/152840002218871e0d2476d><p class=pgc-img-caption></p></div><p><strong>第十一課．打造超小受控端</strong></p><p><strong>1．請使用斬月工具，去掉易語言的核心支持庫。</strong></p><p>請在易語言俱樂部論壇搜索"斬月工具"或"斬月計劃"</p><p>超級大BUG的ZCL庫。</p><p>http://bbs.dywt.com.cn/dispbbs.asp?BoardID=124&ID=113916&replyID=&skin</p><p>GBB113的"易.塵土 界面庫"</p><p>http://bbs.dywt.com.cn/dispbbs.asp?BoardID=124&ID=122596&replyID=&skin</p><p><strong>2．儘量使用API，這樣不帶有大量的支持庫，體積就小了。</strong></p><p>易語言自帶AIP助手，還有一些API的資料，大家平時要多學習。</p><p>API-0168.聯接互聯網.e</p><p>API截圖 凝瑞遠程控制.e</p><p>API取本機所有IP,子網掩碼.e</p><p>API操作超級列表框圖片組.e</p><p>API創建快捷方式</p><p>API實現托盤圖標氣泡提示</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1528400022348fcc561f1ce><p class=pgc-img-caption></p></div><p><strong>第十二課 一個實例的分析</strong></p><p><strong>1．設計文檔</strong></p><p>本次使用"萬事通桌面按鈕"進行實例講解：</p><p><strong>激活客戶端過程</strong></p><p><strong>客戶端上線過程</strong></p><p><strong>2．開機口令</strong></p><p>開機時有管理員口令，採用了"通用密碼嚮導"改進而成。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1528400022456211498f947><p class=pgc-img-caption></p></div><p><strong>3．用戶列表/選擇用戶</strong></p><p>特點是：可以綁定用戶的MAC等硬件信息到一個數據庫中，防止本部門用戶非法使用其他部門的功能。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/15284000226553e8513c59b><p class=pgc-img-caption></p></div><p><strong>4．發送指令</strong></p><p>將配置文件發送到受控端，實現企業特殊功能。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p1.pstatp.com/large/pgc-image/1528400022854fdb0fe00bd><p class=pgc-img-caption></p></div><p><strong>5．激活用戶</strong></p><p>特點：分別採用數據報、反向連接進行激活用戶，並且使用了ARP多線程技術，將局域網內開機的用戶列表出來。激活採用了"數據報"廣播功能，或"服務器/客戶"組件的反向激活功能，除此外，其他都是用了遠程服務支持庫實現功能的。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/1528400023056cd7ce4f428><p class=pgc-img-caption></p></div><p><strong>6．發送文件</strong></p><p>特點是，發送後可以立即顯示內容，或運行某個內容。</p><div class=pgc-img><img alt=易語言遠控組件代碼分析 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/152840002322250c8d4cc6a><p class=pgc-img-caption></p></div><p>�</p><p>尋呼機</p><p>通訊</p><p>上線</p><p>聊天</p><p>下線</p><p>聊天</p><p>下線</p><p>啟動</p><p>服務器</p><p>聊天室</p><p>列表</p><p>踢出</p><p>客戶端</p><p>管理員</p><p>用戶</p><p>上線</p><p>改名</p><p>客戶端</p><p>客戶端</p><p>客戶端</p><p>客戶端</p><p>交互</p><p>聊天</p><p>下線</p><p>上線</p><p>用戶</p><p>管理員</p><p>客戶端</p><p>發命令</p><p>列表</p><p>啟動</p><p>服務器</p><p>遠程控制</p><p>客戶端</p><p>客戶端</p><p>傳數據</p><p>顯示</p><p>下線</p><p>上線</p><p>用戶</p><p>管理員</p><p>客戶端</p><p>數據庫</p><p>列表</p><p>啟動</p><p>服務器</p><p>遠程數據服務</p><p>發送按鈕配置文件</p><p>發送通過驗證信息</p><p>顯示通過驗證</p><p>激活按鈕顯示</p><p>主動連接主控端</p><p>發送刷新配置請求</p><p>點擊單個/全體激活</p><p>發送服務端IP地址</p><p>保存服務端IP地址</p><p>受控端/客戶端</p><p>主控端/服務端</p><p>收到數據,通過驗證</p><p>可存硬件信息到數據庫</p><p>檢查有無服務端IP地址,如無等待,如有連接</p><p>主動連接主控端</p><p>發送刷新配置請求</p><p>收到數據,檢查驗證後</p><p>發送按鈕配置文件</p><p>顯示通過驗證</p><p>激活按鈕顯示</p><p>若主控端連接不成功</p><p>檢查自身硬件是否改變,如通過驗證,可繼續顯示以前的按鈕.</p><p>PAGE</p><p>45</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>語言遠</a></li><li><a>控組件</a></li><li><a>代碼</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/c9ad6a3e.html alt=（1-2我們的第一段PHP代碼）php基礎php學習基礎實例代碼操作教程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/b707f4e4acce41bda439262a966603f8 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c9ad6a3e.html title=（1-2我們的第一段PHP代碼）php基礎php學習基礎實例代碼操作教程>（1-2我們的第一段PHP代碼）php基礎php學習基礎實例代碼操作教程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/389d4437.html alt="Python常用算法學習(5) 樹二叉樹（原理+代碼）-最全總結" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/d3d5fd4ef98c4a8e8dc9095eeef052a6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/389d4437.html title="Python常用算法學習(5) 樹二叉樹（原理+代碼）-最全總結">Python常用算法學習(5) 樹二叉樹（原理+代碼）-最全總結</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f4e78a26.html alt=二叉樹的算法代碼，一篇文章全搞定！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f4e78a26.html title=二叉樹的算法代碼，一篇文章全搞定！>二叉樹的算法代碼，一篇文章全搞定！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/873415c9.html alt=錯誤代碼大全2，時刻掌握計算機的故障原因！ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/152937668211718b8850640 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/873415c9.html title=錯誤代碼大全2，時刻掌握計算機的故障原因！>錯誤代碼大全2，時刻掌握計算機的故障原因！</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/45c8b4b0.html alt=關於“神祕代碼”的含義 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/c040bb33daee4d30bc48cb70d5bf8ee1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/45c8b4b0.html title=關於“神祕代碼”的含義>關於“神祕代碼”的含義</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8d4cfc67.html alt=VBA代碼自動讓一個空閒工作薄關閉 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/49f19f02a01b4aa28fab830611f1ae2d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8d4cfc67.html title=VBA代碼自動讓一個空閒工作薄關閉>VBA代碼自動讓一個空閒工作薄關閉</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/55fe58a0.html alt=對不起，我的VBA代碼將暫停運行，並於10秒後自動關閉主程序 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/84e4fd546fe349bebfed630910a1b643 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/55fe58a0.html title=對不起，我的VBA代碼將暫停運行，並於10秒後自動關閉主程序>對不起，我的VBA代碼將暫停運行，並於10秒後自動關閉主程序</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c733e892.html alt=「軟件工程」代碼質量綜合指南：最佳實踐和工具 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/236ba3959c874246b78fcd77527eeceb style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c733e892.html title=「軟件工程」代碼質量綜合指南：最佳實踐和工具>「軟件工程」代碼質量綜合指南：最佳實踐和工具</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0a63befb.html alt=志高空調故障代碼—室內機與主機通訊故障 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/2458a1e3f357436b89196b74341218e1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0a63befb.html title=志高空調故障代碼—室內機與主機通訊故障>志高空調故障代碼—室內機與主機通訊故障</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/83b0c7a4.html alt=VBA代碼利用Listview控件來顯示你的工作表任務 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7127f7ca7e064dd8b8a4283b5246d4d9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/83b0c7a4.html title=VBA代碼利用Listview控件來顯示你的工作表任務>VBA代碼利用Listview控件來顯示你的工作表任務</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1085ff4a.html alt=利用VBA代碼自定義設置我的菜單 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/04d2083257c844a8a10542a635548b26 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1085ff4a.html title=利用VBA代碼自定義設置我的菜單>利用VBA代碼自定義設置我的菜單</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b95dde80.html alt=Linux技巧：在代碼中設置終端字符顯示顏色和移動光標位置 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/9bde2c83315847498e4b848f524e429c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b95dde80.html title=Linux技巧：在代碼中設置終端字符顯示顏色和移動光標位置>Linux技巧：在代碼中設置終端字符顯示顏色和移動光標位置</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ce238bab.html alt=代碼：C語言中的移位 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/37ce0000d799b4e516fa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ce238bab.html title=代碼：C語言中的移位>代碼：C語言中的移位</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/7b70c367.html alt="代碼規範—使用 TypeScript 裝飾器" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/4b5097e2-c4fd-4d37-9c54-707760739775 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/7b70c367.html title="代碼規範—使用 TypeScript 裝飾器">代碼規範—使用 TypeScript 裝飾器</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c7ea0871.html alt=excel一段代碼把幾百個相同結構的表，都快速複製粘貼到一個總表 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/152941053192715db370c77 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c7ea0871.html title=excel一段代碼把幾百個相同結構的表，都快速複製粘貼到一個總表>excel一段代碼把幾百個相同結構的表，都快速複製粘貼到一個總表</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>