<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>「VBA」歸去來兮－－漫談遞歸 | 极客快訊</title><meta property="og:title" content="「VBA」歸去來兮－－漫談遞歸 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="https://p3.pstatp.com/large/pgc-image/9c4e4950424047b89b6efb0ae51b1441"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fcbf7f3.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fcbf7f3.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/fcbf7f3.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fcbf7f3.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fcbf7f3.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/fcbf7f3.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e7%a7%91%e6%8a%80/fcbf7f3.html><link rel=canonical href=https://geekbank.cf/tw/%e7%a7%91%e6%8a%80/fcbf7f3.html><meta property="article:published_time" content="2020-10-29T21:05:31+08:00"><meta property="article:modified_time" content="2020-10-29T21:05:31+08:00"><meta name=Keywords content><meta name=description content="「VBA」歸去來兮－－漫談遞歸"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E7%A7%91%E6%8A%80/fcbf7f3.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>「VBA」歸去來兮－－漫談遞歸</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E7%A7%91%E6%8A%80.html>科技</a></span></div><div class=post-content><p>轉眼又到520，同事們都勸我該找個對象了，說得好像我不想找似的</p><div class=pgc-img><img alt=「VBA」歸去來兮－－漫談遞歸 onerror=errorimg.call(this); src=https://p3.pstatp.com/large/pgc-image/9c4e4950424047b89b6efb0ae51b1441><p class=pgc-img-caption></p></div><p>。</p><p>言歸正傳，我是星光，今天從論壇裡搬來qee用大神的原創神貼……來吧，瞭解下什麼是遞歸▼</p><p><strong>……</strong></p><p><strong>0．先禮後兵（代前言）</strong></p><p>禮者，理也；兵者，實戰也。本文以此來循序探討遞歸，卻未必是漸進的，儘管我盡力想做到，如果你看到了無法理解的某些詞句，可以先跳過去，作者鼓勵你把它做為關鍵詞在IE上搜索，以使這些概念更清晰和全面。本文大體上從遞歸的一般理論到相關知識。但既謂之漫談，也不拘泥於此。</p><p>我們開始吧。</p><p><strong>1．何謂遞歸？</strong></p><p>通常看到的定義是：當過程（函數）（本文後面將省略上面括號裡的內容）直接或間接調用了自己時，則發生了遞歸。</p><p>直接：入口àAà入口</p><p>間接：入口àAàBà入口</p><p>請原諒我無法用文字把上面的圖畫得象環型那樣直觀，第一個是直接調用，即過程A調用了自身，第二個是間接調用，即過程A調用了B，B又調用了A自身。</p><p>令：C為AàB，則上面的間接調用模式變為</p><p>入口àCà入口</p><p>這其實就是直接調用的模式。可以認為，C之所以被分解為兩個過程A和B，只是程序為了在步驟上更清晰而已（我們通常不都是這樣寫代碼嗎）！筆者首先想告訴你的，不要去節外生枝地管什麼直接間接而生澀地記住一個看似周全的定義，本人對“概念”的一貫態度是，能夠識別即可， <strong>遞歸就是指過程自己調用自己！</strong></p><p><strong>2．遞歸是算法嗎？</strong></p><p>就算是吧。反正大家都這麼叫了，存在即合理嘛。程序=數據結構+算法，它總不會是數據結構吧。</p><p>如同所有的事物一樣，算法從不同的角度也可以有不同的分類，這種從不同角度進行的分類往往並不是排斥的，清楚這一點，可以使你在看到各種算法的稱謂時不會因迷茫而人云亦云。算法分類按照處理的任務，有我們常說的排序算法、查找算法；按照指導思想，有分而治之算法、窮舉算法。而所謂遞歸算法，是指在過程中使用了“自己調用自己”的算法，它是按什麼分類的呢？留下這個問題，在後面慢慢體會吧，呵呵。</p><p><strong>3．遞歸是必需掌握的嗎？</strong></p><p>不然！程序結構的三元素是順序、選擇、循環，用這三種結構可以完成任何功能的代碼。不用我多說吧，所有的程序設計教科書都是這樣說的，很多早期的語言甚至不支持遞歸。讓我們回頭看一下前面的遞歸模式，它是不是和“循環”結構很象？是的，所有可用遞歸完成的代碼也都可以用循環來完成，反之亦然。二者的轉換方法我們會在後面探討。</p><p><strong>4．遞歸的效率問題</strong></p><p>搜一下網絡資源，說什麼的都有，一時本人也沒了主章。這個問題的結論留到本文的最後來下。</p><p>先說下我的觀點：因為遞歸過程中，存在著大量的進退棧操作，這種進退棧會吃掉大量的系統資源，同時很多是無謂的操作，因此無論是資源還是時間的效率都比等價的循環要低。以菲波利數列為例，遞歸的時間複雜度是O(nlogn)，循環是O(n)，顯然，當n>2時，即有nlogn>n。在遞歸技術早期，編譯系統是把整個過程都壓棧的，隨著這項技術逐步研究深入，只需要對局部變量做棧處理，相對有了很大優化。但，總體上效率低的結論不會變。</p><p>也許你已經在質疑了：遞歸已經被你說得一無是處，又那麼生澀難懂，還有必要學它嗎？！不然，它實在很有用，適用於它的舞臺容後道來。</p><p><strong>5．遞歸難嗎？</strong></p><p>難者不會，會者不難。</p><p>嘿嘿，等於沒說。客觀地說，初次接觸遞歸對大多數人，都會有一個從難到易的適應過程。甚至看過並且“理解”了一些遞歸的代碼，仍不敢言易，原因何在呢？</p><p>來看一個用遞歸求解迷宮的思路，迷宮有一個入口和一個出口，從入口進入後，如果遇到了分支，則每一個分支又相當於一個入口…這樣就形成了一個遞歸，由此解題的思路是從入口處派入一支尋路的隊伍，當遇到分支時，支隊長把這個隊伍分成若干個小分隊，如此下去，總會有一支分隊找到出口，然後再逐級報告它的上一級，這樣便會得出迷宮的行走路線。在這裡，尋路的開始階段你不會知道需要一支由多少人組成的尋路隊伍，遞歸就是這樣！它假定你有足夠的資源來支付未知不確定的帳單。這和我們正常的思維是不同的，程序是我們讓計算機執行我們意圖的語言指令，但在日產生活中，我們有使用遞歸思想讓自己或別人去做事的習慣嗎？現實中如果真的遇到了迷宮問題，有人會這樣做嗎？</p><p>另一方面，我們需要知道我們的思路和代碼是否正確，為什麼正確？這就是正確性的證明問題，但遺憾的是，人的思維深度是有限的，兩層或三層的遞歸也許在你的大腦中可以想象出它的完整過程，更多層以後，遞歸正確性的證明只能使用抽象的方法，但我們通常缺少這種訓練。</p><p>回到前面的迷宮問題，仔細地看看（想想）遞歸的思路，你會發現，如果資源能夠得到保證的話，這種思路確實使問題變得簡單了！而且一旦你形成了這種思維習慣，你會發現原本很多複雜的問題都變得如此簡單！</p><p>到這兒，如果你突然覺得遞歸簡單了，那我也不得不告訴你，別高興得太早，學會一門技術不會這麼簡單。</p><p><strong>6．神奇的“黑匣子”</strong></p><p>從現在起，稍稍放慢一下閱讀的速度，呵呵。</p><p>“黑匣子”是一種抽象的程序設計思想，是面象對象的程序設計思想之一，但事實上，這種思想在面象對象的程序設計理論提出之前早已被廣泛應用。它在邏輯上把一個複雜的任務劃分為若干相對簡單的子任務，然後把子任務當成是“黑匣子”來考慮，即調用程序中只需要為子程序（任務）起一個可以識別的名子（然後通過這個名子進行調用）、需要傳遞的參數，然後坐享應該得到的結果，而不再去考慮子任務的內部實現細節（對子任務的實現另行獨立考慮）。這樣的結果是使程序結構更清晰，可讀性也更強（這對複雜的任務非常重要）。這樣，我們只需要要知道，當使用下句代碼時：</p><p>MySubNamen</p><p>我們可以確信得到期望的運行結果，而不必去想MySubName的運行過程，這就是“黑匣子”的神奇。這一思想對理解遞歸至關重要，因為在遞歸中，MySubName同時也是調用程序自己的名子。</p><p>如果您覺得還有不清楚，不要緊，在稍後的實例中還會作出解釋。</p><p><strong>7．第一個經典：階乘</strong></p><p>所以說經典，是因為幾乎所有介紹遞歸的文章都會提到它，也許階乘是我們能想到的最簡明的事例。先來看一下常規思路（循環）的算法程序：</p><p>Function Nx1(n)</p><p>Dim i%</p><p>Nx1 = 1</p><p>For i = 1 To n</p><p>Nx1 = Nx1 * i</p><p>Next i</p><p>End Function</p><p>再來看一下用遞歸的寫法：</p><p>函數名：Nx2，參數：n，功能：返回n的階乘。</p><p>Function Nx2(n)</p><p>If n = 1 Then Nx2 = 1: Exit Function</p><p>Nx2 = n * Nx2(n - 1)</p><p>End Function</p><p>第二句代碼的含義是n的階乘等於n乘以n-1的階乘，別忘了我們說過的“黑匣子”—這裡既是Nx2！所以不要去想Nx2(n-1)是怎麼樣的計算過程啦。經典吧哈？這段代碼的經典還在於：它包含了一般遞歸程序的所有要素。來描述一下：</p><p>（1）遞歸程序至少要有一個出口條件，已使得程序能夠停止下來。這個出口條件又被稱為“基狀態”，在“基狀態”下，結果可以直接被表述。如上例的第一句“Ifn=1ThenNx2=1:ExitFunction”。</p><p>（2）遞歸程序要有遞歸部分，我們設參數n通常表示問題的複雜度，n=1表示“基狀態”，遞歸部分需要完成的是：</p><p>a．將複雜度為n的問題轉化為低複雜度n-1，使它向複雜度為1的“基狀態”問題逼近。</p><p>b．完成上述轉換中n層和n-1層的銜接處理。這種銜接可以是數學關係，如本例“n*”，也可以不是。</p><p>程序員要做的就是將可用遞歸解決的問題按照上述邏輯部分歸納出來，這需要在實戰中增長經驗。對初次接觸的朋友需要補充的是，上面兩部分劃分只是抽象的表述，這意味著實際遞歸問題的複雜度通常不是用一個參數表示，“基狀態”也可以不是數字1，低複雜度n-1的參數不是比低複雜度n的參數小，甚至不是數字關係。</p><p>（3）由於大多數遞歸程序是使用參數來描述複雜度，並且在遞歸部分需要降低複雜度，所以一般情況下，遞歸程序是作為子程序被調用，而不能獨立運行。在調用遞歸程序的程序中需要初始化複雜度參數，即所謂“種子”。</p><p>我不排除你可以構思出一些不使用參數並且可以自啟動的遞歸程序，但那隻屬於例外，而且也違背遞歸的本意。</p><p>（4）遞歸程序與循環程序相比，顯得簡潔，正如你所看到的。而且你一旦熟悉了這種模式，它更易讀，這在複雜的問題上會表現地更明顯。</p><p>本節的最後，也不得不說說，對這個經典程序的有關批評的聲音，因為階乘的定義從來就是：n!=1ⅹ2ⅹ…ⅹn。所以使用循環的方法更容易被理解和接受，而且也說不上繁瑣！算法是為了實用的，而不是為了“經典”，在這裡我們沒有看到使用遞歸的任何必要性和優勢，很多通過這個實例接觸遞歸的人從此形成了對遞歸根深蒂固的評價：一個花架子而已！並永遠忽略了遞歸。這就是很多高手不研究遞歸的原因吧。下一個經典將改變您的這種認識。</p><p><strong>8．第二個經典：漢諾塔</strong></p><p>也許您已經想到了，真正令人信服的遞歸經典，是漢諾塔問題，請參考遞歸（基礎教程）（彭希仁）2，3兩樓。為了本文的完整，我需要重複一下。</p><p>問題：有A、B、C共3根針，其中A針從上到下按從小到大的順序串上了N個金片。要求把金片全部移動到C針上去，可以藉助B針，但每次只能移動一片，且移動過程中任何一根針的金片都保持從小到大的順序。</p><p>使用遞歸的解題思路是：注意到要把n片金片從A移到C，只要把上面的（n－1）個金片搬到B針上，然後把最底下的金片就可以直接從A移到C。這樣問題就可轉化為把（n－1）個金片從B搬到C針上（金片n搬到C後就不必移動了）。直至使問題轉化為搬動1個金片的問題。</p><p>下面是按照上面思路寫出的VBA代碼：</p><p>在遞歸外部增加了一個數組arr1用來保存求解過程，變量q是求解需要的步驟數量。</p><p>Dim arr1, arr2, q</p><p>Private Sub Hanoi1(ByVal N%, ByVal A$, ByVal B$, ByVal C$)</p><p>'“A → C” 來代表把金片從A針移動到C針,即1階漢諾塔問題的解</p><p>If N = 1 Then</p><p>q = q + 1: arr1(q) = A & "→" & C '把金片n從A移動到C</p><p>Else</p><p>Hanoi1 N - 1, A, C, B 'n-1個金片從A到B，以C為過渡</p><p>q = q + 1: arr1(q) = A & "→" & C '把金片n從A移動到C</p><p>Hanoi1 N - 1, B, A, C 'n-1個金片從B到C，以A為過渡</p><p>End If</p><p>End Sub</p><p>一個看似如此複雜的問題，就這樣解決了，竟然只需要寥寥幾行代碼!</p><p>有人說漢諾塔問題是不得不使用遞歸的典型，的確如此，在相當長的時間內，它是唯一的思路。我知道你要說那個美國營養師的解法，但那個思路相比遞歸的解法，要難懂得多，而且，我相信那是對遞歸的結果進行再歸納才形成的（呵呵，你別想說服我，我堅持）。</p><p>不錯，我們可以使用循環來完成上述功能，但這種轉換隻是形式上的，它的思想仍然是遞歸的思想。思路和代碼形式的不統一，對程序員實在是很大的痛苦，因為轉換後幾乎已經沒有了可讀性，不要說再需要維護和修改了。</p><p>看來是需要說說遞歸的好了，當計算機硬件的超快速發展使內存和速度都不再成為障礙的時候，可以如此簡明高效地解決問題，我們還要拒絕遞歸嗎？</p><p>編譯系統開發人員對遞歸的優化研究也從未停止過，而且已經成果不菲，對這方面的討論已超出本文的範圍，有興趣的朋友可以參考有關著述，如果我們可以更天真一點去想象的話，也許有一天，編譯系統會使遞歸的代碼效率和使用冗長代碼寫出的循環代碼相比，一點也不遜色！</p><p><strong>9．歸納的步驟</strong></p><p>從眾多的個性問題抽象出一般的表述，即謂歸納，雖然歸納不是遞歸獨有的方法，但沒有哪種算法象遞歸這樣依賴這種思想。遞歸設計的全部過程就是將可用遞歸方法解決的問題歸納成通用的、一般的遞歸模式並據此寫出相應的代碼。我們無法說到每一個問題，萬紫千紅的美妙需要您在未來的探索路上慢慢體味。本文幫您解決三方面的問題，一是歸納出遞歸的基本特徵，這在第一個經典中已經完成；二是給您一些常見問題的演示，這部分放在後面完成；三就是本節要告訴您的完成這個過程的一般步驟，這些步驟可以保證您正確地做事。</p><p>（1）判斷問題是否屬於遞歸問題，如果問題可以劃分為多次相似的操作即為遞歸問題。</p><p>（2）確定任務的目標和需要的參數。任務是指重複的相似操作，如果目標是產生一個確定的計算結果，通常使用Function構造，如果是產生一系列結果或對特定目標的操作，一般使用Sub來完成。參數包括對問題複雜度進行表達的變量，也包括在兩級遞歸中需要傳遞的數值。</p><p>（3）確定遞歸程序的內部變量和外部變量。對需要輸出一組結果的，為使結果不受遞歸過程的影響，通常使用外部變量或外部對象。</p><p>需要說明的，對變量是使用參數還是使用外部變量或者其它可以保存數據的外部對象（如工作表），應以代碼的清晰易讀為原則。應儘量避免使用Static類型的變量或函數，雖然它可以使原本需要外部的變量巧妙地轉化為內部變量，但通常情況下理解Static要麻煩地多，這不符合使用遞歸的出發點。</p><p>（4）選定“基狀態”（或出口），並確定在“基狀態”下應完成的任務。對可用數值參數表示複雜度的問題，“基狀態”應選擇某個參數的極值（最大值或最小值）。需要注意的是，“基狀態”並不一定只是一種狀態，有時是多種可能的狀態。與“基狀態”對應的一端即是後面啟動遞歸的“種子”。</p><p>（5）確定本遞歸層應完成的工作和與相鄰層的銜接工作，以及以何種方式降低複雜度並引發遞歸過程。</p><p>（6）在調用程序中初始化“種子”值，並保證有關環境變量設定為應有狀態，調用遞歸程序。</p><p>看到這兒，有些朋友已經開始頭大了吧。其實你不要太在意現在理解或記住了多少，這些步驟在實際應用中可能會有一些細小的差異。我的建議是慢慢地培養遵循這些步驟的習慣在學習遞歸的初期是必要，或者你可以對照上述步驟去分析你手頭的遞歸例子。</p><p><strong>10．循環轉化為遞歸</strong></p><p>循環結構內部執行的都是相同的任務，所以它一定可以使用遞歸的結構完成。來看一段簡單的代碼：</p><p>Sub abc1</p><p>Dim i%</p><p>For i = 1 To 10</p><p>Cells(i, 3) = Cells(i, 1) + Cells(i, 2)</p><p>Next i</p><p>End Sub</p><p>上面這段代碼完成的任務是從第1行到第10行，計算第1列與第2列的和寫入第3列。對照前面提到的步驟分析如下：</p><p>（1）參數為行i,取過程名稱為abc2</p><p>Sub abc2(ByVal i As Integer)</p><p>（2）出口i>11（種子為1）</p><p>If i > 10 Then Exit Sub</p><p>（3）本層次要完成的任務為</p><p>Cells(i, 3) = Cells(i, 1) + Cells(i, 2)</p><p>和相鄰層沒有銜接關係，也不需要做其它工作，直接引發下層，過程結束</p><p>abc2 i + 1</p><p>end sub</p><p>將上面得到的代碼連起來：</p><p>Sub abc2(ByVal i As Integer)</p><p>If i > 10 Then Exit Sub</p><p>Cells(i, 3) = Cells(i, 1) + Cells(i, 2)</p><p>abc2 i + 1</p><p>End Sub</p><p>（4）在調用過程中用初始值啟動遞歸過程。</p><p>Sub cabc</p><p>abc2 1</p><p>End Sub</p><p>對兩層以上的循環，可以先將最內層的循環作為一個遞歸過程，將它外層的循環當做調用過程，然後逐層進行遞歸化，也可以將各層循環看作參數，按照一層循環的方法進行轉化。下面是使用後一種方法對兩層循環轉化的例子：</p><p>循環程序：</p><p>Sub abc3</p><p>Dim i%, j%</p><p>For i = 1 To 3</p><p>For j = 1 To 5</p><p>Cells(i, j) = i * j</p><p>Next j</p><p>Next i</p><p>End Sub</p><p>轉化的遞歸程序（分析步驟同上）：</p><p>Sub abc4(ByVal i As Integer, ByVal j As Integer)</p><p>If i > 3 Then Exit Sub</p><p>Cells(i, j) = i * j</p><p>If j = 5 Then</p><p>abc4 i + 1, 1</p><p>Else</p><p>abc4 i, j + 1</p><p>End If</p><p>End Sub</p><p>Sub callabc4</p><p>abc4 1, 1</p><p>End Sub</p><p>也許上面的轉化，包括後面要說的遞歸轉化為循環，除了給前面說過的結論以實證外，並不一定有太多的現實意義，但起碼讓我們知道，想到了其中的一種方式，同時還有另一種方式的存在，如果你有興趣從各自的立場去理解這兩種方式的話，可以加深對它們的理解。也正因如此，我們通常並不侷限於使用一種方式，是選擇遞歸還是循環抑或兩者共用，應統籌考慮程序的可讀性和效率。接下來要探討遞歸轉化為循環的方法，在此之前，先來了解一個重要的相關知識。</p><p><strong>11．棧</strong></p><p>提到棧，總讓人想到彙編等低級語言（請不要和數據結構中的“棧”相混淆，後面我們還要說到），它是指在內存中開闢的一端固定一端活動的存儲空間，固定端稱為棧底，活動端稱為棧頂，CPU中有一個叫SP的指針寄存器，始終指向棧頂，數據在棧中的存儲遵循後進先出的原則，棧的作用之一就是在發生子程序調用時進行數據的現場保護，調用前，系統會將調用地址、局部變量等壓入棧中，調用完成後再從棧中彈出這些數據以使程序繼續向下運行。在VBA和其它的高級語言中，棧的操作是由編譯系統自動完成的，並不需要程序員的額外干涉。前面已經說過，遞歸的過程其實就是棧的工作過程，雖然本文前面給出了一個“黑匣子”理論去理解遞歸，但多數朋友一定還掛著問號吧，至少那樣理解感覺上有點強詞奪理的樣子，抽象地有點讓人不放心，正因為這樣，“正面”地從棧的工作過程去跟蹤和理解遞歸的工作過程對學習遞歸是有必要的。來看一下“階乘”的例子：</p><p>Function Nx2(n)</p><p>If n = 1 Then Nx2 = 1: Exit Function</p><p>Nx2 = n * Nx2(n - 1)</p><p>End Function</p><p>假定n=3，即要計算Nx2(3)</p><p>開始時，棧中數據為：空</p><p>第1步：</p><p>n=3 因不符合第一行代碼的出口條件，第二行代碼需要遞歸，所以將n(3)進棧，調用Nx2(n - 1)即Nx2(2)</p><p>此時棧中數據為：3</p><p>第2步：</p><p>n=2 因不符合第一行代碼的出口條件，第二行代碼需要遞歸，所以將n(2)進棧，調用Nx2(n - 1) 即Nx2(1)</p><p>此時棧中數據為：3，2</p><p>第3步：</p><p>n=1 因符合第一行代碼的出口條件，返回Nx2(1)的值1</p><p>此時棧中數據為：3，2</p><p>第4步：</p><p>n=2 從棧中彈出數據2，與返回的Nx2(1)的值1相乘，返回Nx2(2)的值2</p><p>此時棧中數據為：3</p><p>第5步：</p><p>n=3 從棧中彈出數據3，與返回的Nx2(2)的值2相乘，返回Nx2(3)的值6</p><p>此時棧中數據為：空遞歸過程完成。上面1-3步通常稱為遞推過程（有點向下級推卸責任的味道），4-5稱為迴歸過程（回收下屬的勞動成果）。</p><p>可惜我不會做Flash，無法給出最直觀的示意，麻煩您多看幾遍吧，應該還是可以理解的。</p><p>現在來說說數據結構中的“棧”，它是指按照棧的特點構造的“鏈表”式數據，在VBA中，實現“棧”的簡單方法是使用一個數組變量和一個單獨的整型變量，數組用來存儲數據，數組的下界即棧底，上界為棧頂，單獨的變量用作“指針寄存器”，記錄棧頂的位置，進棧時，棧頂值增加1，彈出數據時，棧頂值減少1.</p><p>歸去來兮！往而返，返而復，是為遞歸~</p><p>^^^^</p><p>作者：qee用</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>VBA</a></li><li><a>歸去</a></li><li><a>漫談</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/02383d22.html alt="Exce VBA End屬性獲取指定行非空單元格首尾列號" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/a062a0358f8e4b709c2466c9e80723e4 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/02383d22.html title="Exce VBA End屬性獲取指定行非空單元格首尾列號">Exce VBA End屬性獲取指定行非空單元格首尾列號</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0239556d.html alt="Excel VBA 選取單元格的最後一行的非空單元格" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/15305845143550cb4caf9f1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0239556d.html title="Excel VBA 選取單元格的最後一行的非空單元格">Excel VBA 選取單元格的最後一行的非空單元格</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ea3fc78f.html alt="Excel VBA常用技巧之 獲得指定行、列中的最後一個非空單元格" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/153002213814407d602e8a6 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ea3fc78f.html title="Excel VBA常用技巧之 獲得指定行、列中的最後一個非空單元格">Excel VBA常用技巧之 獲得指定行、列中的最後一個非空單元格</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/acad58e1.html alt=VBA中end(xlup)到底是什麼？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/ccb14acc8eee45dda7153388dd7ae9d2 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/acad58e1.html title=VBA中end(xlup)到底是什麼？>VBA中end(xlup)到底是什麼？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/930cf4fe.html alt=VBA簡單入門09：End屬性獲取最後的單元格信息 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/152671302655007248d1162 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/930cf4fe.html title=VBA簡單入門09：End屬性獲取最後的單元格信息>VBA簡單入門09：End屬性獲取最後的單元格信息</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/176e773a.html alt=利用VBA獲得指定行、列中的最後一個非空單元格 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/cd75610110744dcdb9e641919a5d4a51 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/176e773a.html title=利用VBA獲得指定行、列中的最後一個非空單元格>利用VBA獲得指定行、列中的最後一個非空單元格</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8d4cfc67.html alt=VBA代碼自動讓一個空閒工作薄關閉 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/49f19f02a01b4aa28fab830611f1ae2d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8d4cfc67.html title=VBA代碼自動讓一個空閒工作薄關閉>VBA代碼自動讓一個空閒工作薄關閉</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/55fe58a0.html alt=對不起，我的VBA代碼將暫停運行，並於10秒後自動關閉主程序 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/84e4fd546fe349bebfed630910a1b643 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/55fe58a0.html title=對不起，我的VBA代碼將暫停運行，並於10秒後自動關閉主程序>對不起，我的VBA代碼將暫停運行，並於10秒後自動關閉主程序</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1ce8c5db.html alt=夏至日裡，漫談夏至 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/684b1bf9c255433fa50d40420a72f9dc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1ce8c5db.html title=夏至日裡，漫談夏至>夏至日裡，漫談夏至</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/83b0c7a4.html alt=VBA代碼利用Listview控件來顯示你的工作表任務 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7127f7ca7e064dd8b8a4283b5246d4d9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/83b0c7a4.html title=VBA代碼利用Listview控件來顯示你的工作表任務>VBA代碼利用Listview控件來顯示你的工作表任務</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/1085ff4a.html alt=利用VBA代碼自定義設置我的菜單 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/04d2083257c844a8a10542a635548b26 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/1085ff4a.html title=利用VBA代碼自定義設置我的菜單>利用VBA代碼自定義設置我的菜單</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/158f4daf.html alt=漫談寬幅快速的分弓 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1535290032011a043cc156a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/158f4daf.html title=漫談寬幅快速的分弓>漫談寬幅快速的分弓</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/289a0294.html alt=VBA｜選區字符統計並顯示到狀態欄 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/4ae20001d9162686bb27 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/289a0294.html title=VBA｜選區字符統計並顯示到狀態欄>VBA｜選區字符統計並顯示到狀態欄</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/69d38eea.html alt="Excel VBA(14) – 創建工作表名稱列表" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/da9a756fd707481097a723c8c337dd80 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/69d38eea.html title="Excel VBA(14) – 創建工作表名稱列表">Excel VBA(14) – 創建工作表名稱列表</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/80da9d1e.html alt=用「VBA」快速批量提取多個工作表名稱？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/04194bb2d6934b489b7512abe432fa2c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/80da9d1e.html title=用「VBA」快速批量提取多個工作表名稱？>用「VBA」快速批量提取多個工作表名稱？</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>