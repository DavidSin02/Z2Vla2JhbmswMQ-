<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>åŸºæ–¼RocketMQåˆ†ä½ˆå¼äº‹å‹™ - å®Œæ•´ç¤ºä¾‹ | æå®¢å¿«è¨Š</title><meta property="og:title" content="åŸºæ–¼RocketMQåˆ†ä½ˆå¼äº‹å‹™ - å®Œæ•´ç¤ºä¾‹ - æå®¢å¿«è¨Š"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="http://p1.pstatp.com/large/pgc-image/388a9665bf45413eb391e47c6d10ca12"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e9%81%8a%e6%88%b2/3ff1309.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e9%81%8a%e6%88%b2/3ff1309.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e9%81%8a%e6%88%b2/3ff1309.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e9%81%8a%e6%88%b2/3ff1309.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e9%81%8a%e6%88%b2/3ff1309.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e9%81%8a%e6%88%b2/3ff1309.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e9%81%8a%e6%88%b2/3ff1309.html><link rel=canonical href=https://geekbank.cf/tw/%e9%81%8a%e6%88%b2/3ff1309.html><meta property="article:published_time" content="2020-10-29T20:46:29+08:00"><meta property="article:modified_time" content="2020-10-29T20:46:29+08:00"><meta name=Keywords content><meta name=description content="åŸºæ–¼RocketMQåˆ†ä½ˆå¼äº‹å‹™ - å®Œæ•´ç¤ºä¾‹"><meta name=author content="æå®¢å¿«è¨Š"><meta property="og:url" content="/tw/%E9%81%8A%E6%88%B2/3ff1309.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>ğŸ¤“ æå®¢å¿«è¨Š Geek Bank</a></h1><p class=description>ç‚ºä½ å¸¶ä¾†æœ€å…¨çš„ç§‘æŠ€çŸ¥è­˜ ğŸ§¡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>çŒœä½ å–œæ­¡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=ç§‘æŠ€>ç§‘æŠ€</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=éŠæˆ²>éŠæˆ²</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=ç§‘å­¸>ç§‘å­¸</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>åŸºæ–¼RocketMQåˆ†ä½ˆå¼äº‹å‹™ - å®Œæ•´ç¤ºä¾‹</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E9%81%8A%E6%88%B2.html>éŠæˆ²</a></span></div><div class=post-content><h1 class=pgc-h-arrow-right>å‰è¨€</h1><p>ä¹‹å‰æˆ‘å€‘èªªåˆ°ï¼Œåˆ†ä½ˆå¼äº‹å‹™æ˜¯ä¸€å€‹è¤‡é›œçš„æŠ€è¡“å•é¡Œã€‚æ²’æœ‰é€šç”¨çš„è§£æ±ºæ–¹æ¡ˆï¼Œä¹Ÿç¼ºä¹ç°¡å–®é«˜æ•ˆçš„æ‰‹æ®µã€‚</p><p>ä¸éï¼Œå¦‚æœæˆ‘å€‘çš„ç³»çµ±ä¸è¿½æ±‚å¼·ä¸€è‡´æ€§ï¼Œé‚£éº¼æœ€å¸¸ç”¨çš„é‚„æ˜¯æœ€çµ‚ä¸€è‡´æ€§æ–¹æ¡ˆã€‚ä»Šå¤©ï¼Œæˆ‘å€‘å°±åŸºæ–¼ RocketMQä¾†å¯¦ç¾æ¶ˆæ¯æœ€çµ‚ä¸€è‡´æ€§æ–¹æ¡ˆçš„åˆ†ä½ˆå¼äº‹å‹™ã€‚</p><p>æœ¬æ–‡ä»£ç¢¼ä¸åªæ˜¯ç°¡å–®çš„demoï¼Œè€ƒæ…®åˆ°ä¸€äº›ç•°å¸¸æƒ…æ³ã€å†ªç­‰æ€§æ¶ˆè²»å’Œæ­»ä¿¡éšŠåˆ—ç­‰æƒ…æ³ï¼Œå„˜é‡å‘å¯é æ¥­å‹™å ´æ™¯é æ”ã€‚</p><p>å¦å¤–ï¼Œåœ¨æœ€å¾Œé‚„æœ‰ã€ŠRocketMQæŠ€è¡“å…§å¹•ã€‹ä¸€æ›¸ä¸­ï¼Œé—œæ–¼åˆ†ä½ˆå¼äº‹å‹™ç¤ºä¾‹ä»£ç¢¼çš„éŒ¯èª¤æµç¨‹åˆ†æï¼Œæ‰€ä»¥ç¯‡å¹…è¼ƒé•·ï¼Œå¸Œæœ›å¤§å®¶è€å¿ƒè§€çœ‹ã€‚</p><h1 class=pgc-h-arrow-right>ä¸€ã€äº‹å‹™æ¶ˆæ¯</h1><p>åœ¨é€™è£¡ï¼Œç­†è€…ä¸æƒ³ä½¿ç”¨å¤§é‡çš„æ–‡å­—è´…è¿° RocketMQäº‹å‹™æ¶ˆæ¯çš„åŸç†ï¼Œæˆ‘å€‘åªéœ€è¦ææ˜ç™½å…©å€‹æ¦‚å¿µã€‚</p><ul><li>Half Messageï¼ŒåŠæ¶ˆæ¯</li></ul><p>æš«æ™‚ä¸èƒ½è¢« Consumeræ¶ˆè²»çš„æ¶ˆæ¯ã€‚Producerå·²ç¶“æŠŠæ¶ˆæ¯ç™¼é€åˆ° Brokerç«¯ï¼Œä½†æ˜¯æ­¤æ¶ˆæ¯çš„ç‹€æ…‹è¢«æ¨™è¨˜ç‚ºä¸èƒ½æŠ•éï¼Œè™•æ–¼é€™ç¨®ç‹€æ…‹ä¸‹çš„æ¶ˆæ¯ç¨±ç‚ºåŠæ¶ˆæ¯ã€‚äº‹å¯¦ä¸Šï¼Œè©²ç‹€æ…‹ä¸‹çš„æ¶ˆæ¯æœƒè¢«æ”¾åœ¨ä¸€å€‹å«åš RMQ_SYS_TRANS_HALF_TOPICçš„ä¸»é¡Œä¸‹ã€‚</p><p>ç•¶ Producerç«¯å°å®ƒäºŒæ¬¡ç¢ºèªå¾Œï¼Œä¹Ÿå°±æ˜¯ Commitä¹‹å¾Œï¼ŒConsumerç«¯æ‰å¯ä»¥æ¶ˆè²»åˆ°ï¼›é‚£éº¼å¦‚æœæ˜¯Rollbackï¼Œè©²æ¶ˆæ¯å‰‡æœƒè¢«åˆªé™¤ï¼Œæ°¸é ä¸æœƒè¢«æ¶ˆè²»åˆ°ã€‚</p><ul><li>äº‹å‹™ç‹€æ…‹å›æŸ¥</li></ul><p>æˆ‘å€‘æƒ³ï¼Œå¯èƒ½æœƒå› ç‚ºç¶²çµ¡åŸå› ã€æ‡‰ç”¨å•é¡Œç­‰ï¼Œå°è‡´Producerç«¯ä¸€ç›´æ²’æœ‰å°é€™å€‹åŠæ¶ˆæ¯é€²è¡Œç¢ºèªï¼Œé‚£éº¼é€™æ™‚å€™ Brokeræœå‹™å™¨æœƒå®šæ™‚æƒæé€™äº›åŠæ¶ˆæ¯ï¼Œä¸»å‹•æ‰¾Producerç«¯æŸ¥è©¢è©²æ¶ˆæ¯çš„ç‹€æ…‹ã€‚</p><p>ç•¶ç„¶ï¼Œä»€éº¼æ™‚å€™å»æƒæï¼ŒåŒ…å«æƒæå¹¾æ¬¡ï¼Œæˆ‘å€‘éƒ½å¯ä»¥é…ç½®ï¼Œåœ¨å¾Œæ–‡æˆ‘å€‘å†ç´°èªªã€‚</p><p>ç°¡è€Œè¨€ä¹‹ï¼ŒRocketMQäº‹å‹™æ¶ˆæ¯çš„å¯¦ç¾åŸç†å°±æ˜¯åŸºæ–¼å…©éšæ®µæäº¤å’Œäº‹å‹™ç‹€æ…‹å›æŸ¥ï¼Œä¾†æ±ºå®šæ¶ˆæ¯æœ€çµ‚æ˜¯æäº¤é‚„æ˜¯å›æ»¾çš„ã€‚</p><p>åœ¨æœ¬æ–‡ï¼Œæˆ‘å€‘çš„ä»£ç¢¼å°±ä»¥ è¨‚å–®æœå‹™ã€ç©åˆ†æœå‹™ ç‚ºä¾‹ã€‚çµåˆä¸Šæ–‡ä¾†çœ‹ï¼Œæ•´é«”æµç¨‹å¦‚ä¸‹ï¼š</p><p><br></p><div class=pgc-img><img alt="åŸºæ–¼RocketMQåˆ†ä½ˆå¼äº‹å‹™ - å®Œæ•´ç¤ºä¾‹" onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/388a9665bf45413eb391e47c6d10ca12><p class=pgc-img-caption></p></div><p><br></p><h1 class=pgc-h-arrow-right>äºŒã€è¨‚å–®æœå‹™</h1><p>åœ¨è¨‚å–®æœå‹™ä¸­ï¼Œæˆ‘å€‘æ¥æ”¶å‰ç«¯çš„è«‹æ±‚å‰µå»ºè¨‚å–®ï¼Œä¿å­˜ç›¸é—œæ•¸æ“šåˆ°æœ¬åœ°æ•¸æ“šåº«ã€‚</p><h1 class=pgc-h-arrow-right>1ã€äº‹å‹™æ—¥èªŒè¡¨</h1><p>åœ¨è¨‚å–®æœå‹™ä¸­ï¼Œé™¤äº†æœ‰ä¸€å¼µè¨‚å–®è¡¨ä¹‹å¤–ï¼Œé‚„éœ€è¦ä¸€å€‹äº‹å‹™æ—¥èªŒè¡¨ã€‚ å®ƒçš„å®šç¾©å¦‚ä¸‹ï¼š</p><pre><code>CREATE TABLE `transaction_log` (  `id` varchar(32) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL COMMENT 'äº‹å‹™ID',  `business` varchar(32) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL COMMENT 'æ¥­å‹™æ¨™è­˜',  `foreign_key` varchar(32) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL COMMENT 'å°æ‡‰æ¥­å‹™è¡¨ä¸­çš„ä¸»éµ',  PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;</code></pre><p>é€™å¼µè¡¨å°ˆé–€ä½œç”¨æ–¼äº‹å‹™ç‹€æ…‹å›æŸ¥ã€‚ç•¶æäº¤æ¥­å‹™æ•¸æ“šæ™‚ï¼Œæ­¤è¡¨ä¹Ÿæ’å…¥ä¸€æ¢æ•¸æ“šï¼Œå®ƒå€‘å…±è™•ä¸€å€‹æœ¬åœ°äº‹å‹™ä¸­ã€‚é€šéäº‹å‹™IDæŸ¥è©¢è©²è¡¨ï¼Œå¦‚æœè¿”å›è¨˜éŒ„ï¼Œå‰‡è­‰æ˜æœ¬åœ°äº‹å‹™å·²æäº¤ï¼›å¦‚æœæœªè¿”å›è¨˜éŒ„ï¼Œå‰‡æœ¬åœ°äº‹å‹™å¯èƒ½æ˜¯æœªçŸ¥ç‹€æ…‹æˆ–è€…æ˜¯å›æ»¾ç‹€æ…‹ã€‚</p><h1 class=pgc-h-arrow-right>2ã€TransactionMQProducer</h1><p>æˆ‘å€‘çŸ¥é“ï¼Œé€šé RocketMQç™¼é€æ¶ˆæ¯ï¼Œéœ€å…ˆå‰µå»ºä¸€å€‹æ¶ˆæ¯ç™¼é€è€…ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœç™¼é€äº‹å‹™æ¶ˆæ¯ï¼Œåœ¨é€™è£¡æˆ‘å€‘çš„å‰µå»ºçš„å¯¦ä¾‹å¿…é ˆæ˜¯ TransactionMQProducerã€‚</p><pre><code>@Componentpublic class TransactionProducer {	    private String producerGroup = "order_trans_group";    private TransactionMQProducer producer;    //ç”¨æ–¼åŸ·è¡Œæœ¬åœ°äº‹å‹™å’Œäº‹å‹™ç‹€æ…‹å›æŸ¥çš„ç›£è½å™¨    @Autowired    OrderTransactionListener orderTransactionListener;    //åŸ·è¡Œä»»å‹™çš„ç·šç¨‹æ±     ThreadPoolExecutor executor = new ThreadPoolExecutor(5, 10, 60,            TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(50));                @PostConstruct    public void init(){        producer = new TransactionMQProducer(producerGroup);        producer.setNamesrvAddr("127.0.0.1:9876");        producer.setSendMsgTimeout(Integer.MAX_VALUE);        producer.setExecutorService(executor);        producer.setTransactionListener(orderTransactionListener);        this.start();    }    private void start(){        try {            this.producer.start();        } catch (MQClientException e) {            e.printStackTrace();        }    }    //äº‹å‹™æ¶ˆæ¯ç™¼é€     public TransactionSendResult send(String data, String topic) throws MQClientException {        Message message = new Message(topic,data.getBytes());        return this.producer.sendMessageInTransaction(message, null);    }}</code></pre><p>ä¸Šé¢çš„ä»£ç¢¼ä¸­ï¼Œä¸»è¦å°±æ˜¯å‰µå»ºäº‹å‹™æ¶ˆæ¯çš„ç™¼é€è€…ã€‚åœ¨é€™è£¡ï¼Œæˆ‘å€‘é‡é»é—œæ³¨ OrderTransactionListenerï¼Œå®ƒè² è²¬åŸ·è¡Œæœ¬åœ°äº‹å‹™å’Œäº‹å‹™ç‹€æ…‹å›æŸ¥ã€‚</p><h1 class=pgc-h-arrow-right>3ã€OrderTransactionListener</h1><pre><code>@Componentpublic class OrderTransactionListener implements TransactionListener {    @Autowired    OrderService orderService;    @Autowired    TransactionLogService transactionLogService;    Logger logger = LoggerFactory.getLogger(this.getClass());    @Override    public LocalTransactionState executeLocalTransaction(Message message, Object o) {        logger.info("é–‹å§‹åŸ·è¡Œæœ¬åœ°äº‹å‹™....");        LocalTransactionState state;        try{            String body = new String(message.getBody());            OrderDTO order = JSONObject.parseObject(body, OrderDTO.class);            orderService.createOrder(order,message.getTransactionId());            state = LocalTransactionState.COMMIT_MESSAGE;            logger.info("æœ¬åœ°äº‹å‹™å·²æäº¤ã€‚{}",message.getTransactionId());        }catch (Exception e){            logger.info("åŸ·è¡Œæœ¬åœ°äº‹å‹™å¤±æ•—ã€‚{}",e);            state = LocalTransactionState.ROLLBACK_MESSAGE;        }        return state;    }    @Override    public LocalTransactionState checkLocalTransaction(MessageExt messageExt) {        logger.info("é–‹å§‹å›æŸ¥æœ¬åœ°äº‹å‹™ç‹€æ…‹ã€‚{}",messageExt.getTransactionId());        LocalTransactionState state;        String transactionId = messageExt.getTransactionId();        if (transactionLogService.get(transactionId)&gt;0){            state = LocalTransactionState.COMMIT_MESSAGE;        }else {            state = LocalTransactionState.UNKNOW;        }        logger.info("çµæŸæœ¬åœ°äº‹å‹™ç‹€æ…‹æŸ¥è©¢ï¼š{}",state);        return state;    }}</code></pre><p>åœ¨é€šé producer.sendMessageInTransactionç™¼é€äº‹å‹™æ¶ˆæ¯å¾Œï¼Œå¦‚æœæ¶ˆæ¯ç™¼é€æˆåŠŸï¼Œå°±æœƒèª¿ç”¨åˆ°é€™è£¡çš„executeLocalTransactionæ–¹æ³•ï¼Œä¾†åŸ·è¡Œæœ¬åœ°äº‹å‹™ã€‚åœ¨é€™è£¡ï¼Œå®ƒæœƒå®Œæˆè¨‚å–®æ•¸æ“šå’Œäº‹å‹™æ—¥èªŒçš„æ’å…¥ã€‚</p><p>è©²æ–¹æ³•è¿”å›å€¼ LocalTransactionState ä»£è¡¨æœ¬åœ°äº‹å‹™ç‹€æ…‹ï¼Œå®ƒæ˜¯ä¸€å€‹æšèˆ‰é¡ã€‚</p><pre><code>public enum LocalTransactionState {    //æäº¤äº‹å‹™æ¶ˆæ¯ï¼Œæ¶ˆè²»è€…å¯ä»¥çœ‹åˆ°æ­¤æ¶ˆæ¯    COMMIT_MESSAGE,    //å›æ»¾äº‹å‹™æ¶ˆæ¯ï¼Œæ¶ˆè²»è€…ä¸æœƒçœ‹åˆ°æ­¤æ¶ˆæ¯    ROLLBACK_MESSAGE,    //äº‹å‹™æœªçŸ¥ç‹€æ…‹ï¼Œéœ€è¦èª¿ç”¨äº‹å‹™ç‹€æ…‹å›æŸ¥ï¼Œç¢ºå®šæ­¤æ¶ˆæ¯æ˜¯æäº¤é‚„æ˜¯å›æ»¾    UNKNOW;}</code></pre><p>é‚£éº¼ï¼Œ checkLocalTransaction æ–¹æ³•å°±æ˜¯ç”¨æ–¼äº‹å‹™ç‹€æ…‹æŸ¥è©¢ã€‚åœ¨é€™è£¡ï¼Œæˆ‘å€‘é€šéäº‹å‹™IDæŸ¥è©¢transaction_logé€™å¼µè¡¨ï¼Œå¦‚æœå¯ä»¥æŸ¥è©¢åˆ°çµæœï¼Œå°±æäº¤äº‹å‹™æ¶ˆæ¯ï¼›å¦‚æœæ²’æœ‰æŸ¥è©¢åˆ°ï¼Œå°±è¿”å›æœªçŸ¥ç‹€æ…‹ã€‚</p><p>æ³¨æ„ï¼Œé€™è£¡é‚„æ¶‰åŠåˆ°å¦å¤–ä¸€å€‹å•é¡Œã€‚å¦‚æœæ˜¯è¿”å›æœªçŸ¥ç‹€æ…‹ï¼ŒRocketMQ Brokeræœå‹™å™¨æœƒä»¥1åˆ†é˜çš„é–“éš”æ™‚é–“ä¸æ–·å›æŸ¥ï¼Œç›´è‡³é”åˆ°äº‹å‹™å›æŸ¥æœ€å¤§æª¢æ¸¬æ•¸ï¼Œå¦‚æœè¶…éé€™å€‹æ•¸å­—é‚„æœªæŸ¥è©¢åˆ°äº‹å‹™ç‹€æ…‹ï¼Œå‰‡å›æ»¾æ­¤æ¶ˆæ¯ã€‚</p><p>ç•¶ç„¶ï¼Œäº‹å‹™å›æŸ¥çš„é »ç‡å’Œæœ€å¤§æ¬¡æ•¸ï¼Œæˆ‘å€‘éƒ½å¯ä»¥é…ç½®ã€‚åœ¨ Broker ç«¯ï¼Œå¯ä»¥é€šéé€™æ¨£ä¾†é…ç½®å®ƒï¼š</p><pre><code>brokerConfig.setTransactionCheckInterval(10000); //å›æŸ¥é »ç‡10ç§’ä¸€æ¬¡brokerConfig.setTransactionCheckMax(3);  //æœ€å¤§æª¢æ¸¬æ¬¡æ•¸ç‚º3</code></pre><h1 class=pgc-h-arrow-right>4ã€æ¥­å‹™å¯¦ç¾é¡</h1><pre><code>@Servicepublic class OrderServiceImpl implements OrderService {    @Autowired    OrderMapper orderMapper;    @Autowired    TransactionLogMapper transactionLogMapper;    @Autowired    TransactionProducer producer;    Snowflake snowflake = new Snowflake(1,1);    Logger logger = LoggerFactory.getLogger(this.getClass());    //åŸ·è¡Œæœ¬åœ°äº‹å‹™æ™‚èª¿ç”¨ï¼Œå°‡è¨‚å–®æ•¸æ“šå’Œäº‹å‹™æ—¥èªŒå¯«å…¥æœ¬åœ°æ•¸æ“šåº«    @Transactional    @Override    public void createOrder(OrderDTO orderDTO,String transactionId){        //1.å‰µå»ºè¨‚å–®        Order order = new Order();        BeanUtils.copyProperties(orderDTO,order);        orderMapper.createOrder(order);        //2.å¯«å…¥äº‹å‹™æ—¥èªŒ        TransactionLog log = new TransactionLog();        log.setId(transactionId);        log.setBusiness("order");        log.setForeignKey(String.valueOf(order.getId()));        transactionLogMapper.insert(log);        logger.info("è¨‚å–®å‰µå»ºå®Œæˆã€‚{}",orderDTO);    }    //å‰ç«¯èª¿ç”¨ï¼Œåªç”¨æ–¼å‘RocketMQç™¼é€äº‹å‹™æ¶ˆæ¯    @Override    public void createOrder(OrderDTO order) throws MQClientException {        order.setId(snowflake.nextId());        order.setOrderNo(snowflake.nextIdStr());        producer.send(JSON.toJSONString(order),"order");    }}</code></pre><p>åœ¨è¨‚å–®æ¥­å‹™æœå‹™é¡ä¸­ï¼Œæˆ‘å€‘æœ‰å…©å€‹æ–¹æ³•ã€‚ä¸€å€‹ç”¨æ–¼å‘RocketMQç™¼é€äº‹å‹™æ¶ˆæ¯ï¼Œä¸€å€‹ç”¨æ–¼çœŸæ­£çš„æ¥­å‹™æ•¸æ“šè½åº«ã€‚</p><p>è‡³æ–¼ç‚ºä»€éº¼é€™æ¨£åšï¼Œå…¶å¯¦æœ‰ä¸€äº›åŸå› çš„ï¼Œæˆ‘å€‘å¾Œé¢å†èªªã€‚</p><h1 class=pgc-h-arrow-right>5ã€èª¿ç”¨</h1><pre><code>@RestControllerpublic class OrderController {    @Autowired    OrderService orderService;    Logger logger = LoggerFactory.getLogger(this.getClass());    @PostMapping("/create_order")    public void createOrder(@RequestBody OrderDTO order) throws MQClientException {        logger.info("æ¥æ”¶åˆ°è¨‚å–®æ•¸æ“šï¼š{}",order.getCommodityCode());        orderService.createOrder(order);    }}</code></pre><h1 class=pgc-h-arrow-right>6ã€ç¸½çµ</h1><p>ç›®å‰å·²ç¶“å®Œæˆäº†è¨‚å–®æœå‹™çš„æ¥­å‹™é‚è¼¯ã€‚æˆ‘å€‘ç¸½çµæµç¨‹å¦‚ä¸‹ï¼š</p><p><br></p><div class=pgc-img><img alt="åŸºæ–¼RocketMQåˆ†ä½ˆå¼äº‹å‹™ - å®Œæ•´ç¤ºä¾‹" onerror=errorimg.call(this); src=http://p9.pstatp.com/large/pgc-image/b3b5d78bc2924cbd8d410df5f6827807><p class=pgc-img-caption></p></div><p><br></p><p>è€ƒæ…®åˆ°ç•°å¸¸æƒ…æ³ï¼Œé€™è£¡çš„è¦é»å¦‚ä¸‹ï¼š</p><ul><li>ç¬¬ä¸€æ¬¡èª¿ç”¨createOrderï¼Œç™¼é€äº‹å‹™æ¶ˆæ¯ã€‚å¦‚æœç™¼é€å¤±æ•—ï¼Œå°è‡´å ±éŒ¯ï¼Œå‰‡å°‡ç•°å¸¸è¿”å›ï¼Œæ­¤æ™‚ä¸æœƒæ¶‰åŠåˆ°ä»»ä½•æ•¸æ“šå®‰å…¨ã€‚</li><li>å¦‚æœäº‹å‹™æ¶ˆæ¯ç™¼é€æˆåŠŸï¼Œä½†åœ¨åŸ·è¡Œæœ¬åœ°äº‹å‹™æ™‚ç™¼ç”Ÿç•°å¸¸ï¼Œé‚£éº¼è¨‚å–®æ•¸æ“šå’Œäº‹å‹™æ—¥èªŒéƒ½ä¸æœƒè¢«ä¿å­˜ï¼Œå› ç‚ºå®ƒå€‘æ˜¯ä¸€å€‹æœ¬åœ°äº‹å‹™ä¸­ã€‚</li><li>å¦‚æœåŸ·è¡Œå®Œæœ¬åœ°äº‹å‹™ï¼Œä½†æœªèƒ½åŠæ™‚çš„è¿”å›æœ¬åœ°äº‹å‹™ç‹€æ…‹æˆ–è€…è¿”å›äº†æœªçŸ¥ç‹€æ…‹ã€‚é‚£éº¼ï¼Œæœƒç”±Brokerå®šæ™‚å›æŸ¥äº‹å‹™ç‹€æ…‹ï¼Œç„¶å¾Œæ ¹æ“šäº‹å‹™æ—¥èªŒè¡¨ï¼Œå°±å¯ä»¥åˆ¤æ–·è¨‚å–®æ˜¯å¦å·²å®Œæˆï¼Œä¸¦å¯«å…¥åˆ°æ•¸æ“šåº«ã€‚</li></ul><p>åŸºæ–¼é€™äº›è¦ç´ ï¼Œæˆ‘å€‘å¯ä»¥èªªï¼Œå·²ç¶“ä¿è­‰äº†è¨‚å–®æœå‹™å’Œäº‹å‹™æ¶ˆæ¯çš„ä¸€è‡´æ€§ã€‚é‚£éº¼ï¼Œæ¥ä¸‹ä¾†å°±æ˜¯ç©åˆ†æœå‹™å¦‚ä½•æ­£ç¢ºçš„æ¶ˆè²»è¨‚å–®æ•¸æ“šä¸¦å®Œæˆç›¸æ‡‰çš„æ¥­å‹™æ“ä½œã€‚</p><h1 class=pgc-h-arrow-right>ä¸‰ã€ç©åˆ†æœå‹™</h1><p>åœ¨ç©åˆ†æœå‹™ä¸­ï¼Œä¸»è¦å°±æ˜¯æ¶ˆè²»è¨‚å–®æ•¸æ“šï¼Œç„¶å¾Œæ ¹æ“šè¨‚å–®å…§å®¹ï¼Œçµ¦ç›¸æ‡‰ç”¨æˆ¶å¢åŠ ç©åˆ†ã€‚</p><h1 class=pgc-h-arrow-right>1ã€ç©åˆ†è¨˜éŒ„è¡¨</h1><pre><code>CREATE TABLE `t_points` (  `id` bigint(16) NOT NULL COMMENT 'ä¸»éµ',  `user_id` bigint(16) NOT NULL COMMENT 'ç”¨æˆ¶id',  `order_no` bigint(16) NOT NULL COMMENT 'è¨‚å–®ç·¨è™Ÿ',  `points` int(4) NOT NULL COMMENT 'ç©åˆ†',  `remarks` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL COMMENT 'å‚™è¨»',  PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;</code></pre><p>åœ¨é€™è£¡ï¼Œæˆ‘å€‘é‡é»é—œæ³¨order_noå­—æ®µï¼Œå®ƒæ˜¯å¯¦ç¾å†ªç­‰æ¶ˆè²»çš„ä¸€ç¨®é¸æ“‡ã€‚</p><h1 class=pgc-h-arrow-right>2ã€æ¶ˆè²»è€…å•Ÿå‹•</h1><pre><code>@Componentpublic class Consumer {    String consumerGroup = "consumer-group";    DefaultMQPushConsumer consumer;    @Autowired    OrderListener orderListener;        @PostConstruct    public void init() throws MQClientException {        consumer = new DefaultMQPushConsumer(consumerGroup);        consumer.setNamesrvAddr("127.0.0.1:9876");        consumer.subscribe("order","*");        consumer.registerMessageListener(orderListener);        consumer.start();    }}</code></pre><p>å•Ÿå‹•ä¸€å€‹æ¶ˆè²»è€…æ¯”è¼ƒç°¡å–®ï¼Œæˆ‘å€‘æŒ‡å®šè¦æ¶ˆè²»çš„ topic å’Œç›£è½å™¨å°±å¥½äº†ã€‚</p><h1 class=pgc-h-arrow-right>3ã€æ¶ˆè²»è€…ç›£è½å™¨</h1><pre><code>@Componentpublic class OrderListener implements MessageListenerConcurrently {    @Autowired    PointsService pointsService;    Logger logger = LoggerFactory.getLogger(this.getClass());    @Override    public ConsumeConcurrentlyStatus consumeMessage(List&lt;MessageExt&gt; list, ConsumeConcurrentlyContext context) {        logger.info("æ¶ˆè²»è€…ç·šç¨‹ç›£è½åˆ°æ¶ˆæ¯ã€‚");        try{            for (MessageExt message:list) {                logger.info("é–‹å§‹è™•ç†è¨‚å–®æ•¸æ“šï¼Œæº–å‚™å¢åŠ ç©åˆ†....");                OrderDTO order  = JSONObject.parseObject(message.getBody(), OrderDTO.class);                pointsService.increasePoints(order);            }            return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;        }catch (Exception e){            logger.error("è™•ç†æ¶ˆè²»è€…æ•¸æ“šç™¼ç”Ÿç•°å¸¸ã€‚{}",e);            return ConsumeConcurrentlyStatus.RECONSUME_LATER;        }    }}</code></pre><p>ç›£è½åˆ°æ¶ˆæ¯ä¹‹å¾Œï¼Œèª¿ç”¨æ¥­å‹™æœå‹™é¡è™•ç†å³å¯ã€‚è™•ç†å®Œæˆå‰‡è¿”å›CONSUME_SUCCESSä»¥æäº¤ï¼Œè™•ç†å¤±æ•—å‰‡è¿”å›RECONSUME_LATERä¾†é‡è©¦ã€‚</p><h1 class=pgc-h-arrow-right>4ã€å¢åŠ ç©åˆ†</h1><p>åœ¨é€™è£¡ï¼Œä¸»è¦å°±æ˜¯å°ç©åˆ†æ•¸æ“šå…¥åº«ã€‚ä½†æ³¨æ„ï¼Œå…¥åº«ä¹‹å‰éœ€è¦å…ˆåšåˆ¤æ–·ï¼Œä¾†é”åˆ°å†ªç­‰æ€§æ¶ˆè²»ã€‚</p><pre><code>@Servicepublic class PointsServiceImpl implements PointsService {    @Autowired    PointsMapper pointsMapper;    Snowflake snowflake = new Snowflake(1,1);    Logger logger = LoggerFactory.getLogger(this.getClass());    @Override    public void increasePoints(OrderDTO order) {		        //å…¥åº«ä¹‹å‰å…ˆæŸ¥è©¢ï¼Œå¯¦ç¾å†ªç­‰        if (pointsMapper.getByOrderNo(order.getOrderNo())&gt;0){            logger.info("ç©åˆ†æ·»åŠ å®Œæˆï¼Œè¨‚å–®å·²è™•ç†ã€‚{}",order.getOrderNo());        }else{            Points points = new Points();            points.setId(snowflake.nextId());            points.setUserId(order.getUserId());            points.setOrderNo(order.getOrderNo());            Double amount = order.getAmount();            points.setPoints(amount.intValue()*10);            points.setRemarks("å•†å“æ¶ˆè²»å…±ã€"+order.getAmount()+"ã€‘å…ƒï¼Œç²å¾—ç©åˆ†"+points.getPoints());            pointsMapper.insert(points);            logger.info("å·²ç‚ºè¨‚å–®è™Ÿç¢¼{}å¢åŠ ç©åˆ†ã€‚",points.getOrderNo());        }    }}</code></pre><h1 class=pgc-h-arrow-right>5ã€å†ªç­‰æ€§æ¶ˆè²»</h1><p>å¯¦ç¾å†ªç­‰æ€§æ¶ˆè²»çš„æ–¹å¼æœ‰å¾ˆå¤šç¨®ï¼Œå…·é«”æ€éº¼åšï¼Œæ ¹æ“šè‡ªå·±çš„æƒ…æ³ä¾†çœ‹ã€‚</p><p>æ¯”å¦‚ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘å€‘ç›´æ¥å°‡è¨‚å–®è™Ÿå’Œç©åˆ†è¨˜éŒ„ç¶å®šåœ¨åŒä¸€å€‹è¡¨ä¸­ï¼Œåœ¨å¢åŠ ç©åˆ†ä¹‹å‰ï¼Œå°±å¯ä»¥å…ˆæŸ¥è©¢æ­¤è¨‚å–®æ˜¯å¦å·²è™•ç†éã€‚</p><p>æˆ–è€…ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥é¡å¤–å‰µå»ºä¸€å¼µè¡¨ï¼Œä¾†è¨˜éŒ„è¨‚å–®çš„è™•ç†æƒ…æ³ã€‚</p><p>å†è€…ï¼Œä¹Ÿå¯ä»¥å°‡é€™äº›ä¿¡æ¯ç›´æ¥æ”¾åˆ°redisç·©å­˜è£¡ï¼Œåœ¨å…¥åº«ä¹‹å‰å…ˆæŸ¥è©¢ç·©å­˜ã€‚</p><p>ä¸ç®¡ä»¥å“ªç¨®æ–¹å¼ä¾†åšï¼Œç¸½çš„æ€è·¯å°±æ˜¯åœ¨åŸ·è¡Œæ¥­å‹™å‰ï¼Œå¿…é ˆå…ˆæŸ¥è©¢è©²æ¶ˆæ¯æ˜¯å¦è¢«è™•ç†éã€‚é‚£éº¼é€™è£¡å°±æ¶‰åŠåˆ°ä¸€å€‹æ•¸æ“šä¸»éµå•é¡Œï¼Œåœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œæˆ‘å€‘ä»¥è¨‚å–®è™Ÿç‚ºä¸»éµï¼Œä¹Ÿå¯ä»¥ç”¨äº‹å‹™IDä½œä¸»éµï¼Œå¦‚æœæ˜¯æ™®é€šæ¶ˆæ¯çš„è©±ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥å‰µå»ºå”¯ä¸€çš„æ¶ˆæ¯IDä½œç‚ºä¸»éµã€‚</p><h1 class=pgc-h-arrow-right>6ã€æ¶ˆè²»ç•°å¸¸</h1><p>æˆ‘å€‘çŸ¥é“ï¼Œç•¶æ¶ˆè²»è€…è™•ç†å¤±æ•—å¾Œæœƒè¿”å› RECONSUME_LATER ï¼Œè®“æ¶ˆæ¯ä¾†é‡è©¦ï¼Œé»˜èªæœ€å¤šé‡è©¦16æ¬¡ã€‚</p><p>é‚£ï¼Œå¦‚æœçœŸçš„ç”±æ–¼ç‰¹æ®ŠåŸå› ï¼Œæ¶ˆæ¯ä¸€ç›´ä¸èƒ½è¢«æ­£ç¢ºè™•ç†ï¼Œé‚£æ€éº¼è¾¦ ï¼Ÿ</p><p>æˆ‘å€‘è€ƒæ…®å…©ç¨®æ–¹å¼ä¾†è§£æ±ºé€™å€‹å•é¡Œã€‚</p><p>ç¬¬ä¸€ï¼Œåœ¨ä»£ç¢¼ä¸­è¨­ç½®æ¶ˆæ¯é‡è©¦æ¬¡æ•¸ï¼Œå¦‚æœé”åˆ°æŒ‡å®šæ¬¡æ•¸ï¼Œå°±ç™¼éƒµä»¶æˆ–è€…çŸ­ä¿¡é€šçŸ¥æ¥­å‹™æ–¹äººå·¥ä»‹å…¥è™•ç†ã€‚</p><pre><code>@Componentpublic class OrderListener implements MessageListenerConcurrently {    Logger logger = LoggerFactory.getLogger(this.getClass());    @Override    public ConsumeConcurrentlyStatus consumeMessage(List&lt;MessageExt&gt; list, ConsumeConcurrentlyContext context) {        logger.info("æ¶ˆè²»è€…ç·šç¨‹ç›£è½åˆ°æ¶ˆæ¯ã€‚");        for (MessageExt message:list) {            if (!processor(message)){                return ConsumeConcurrentlyStatus.RECONSUME_LATER;            }        }        return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;    }    /**     * æ¶ˆæ¯è™•ç†ï¼Œç¬¬3æ¬¡è™•ç†å¤±æ•—å¾Œï¼Œç™¼é€éƒµä»¶é€šçŸ¥äººå·¥ä»‹å…¥     * @param message     * @return     */    private boolean processor(MessageExt message){        String body = new String(message.getBody());        try {            logger.info("æ¶ˆæ¯è™•ç†....{}",body);            int k = 1/0;            return true;        }catch (Exception e){            if(message.getReconsumeTimes()&gt;=3){                logger.error("æ¶ˆæ¯é‡è©¦å·²é”æœ€å¤§æ¬¡æ•¸ï¼Œå°‡é€šçŸ¥æ¥­å‹™äººå“¡æ’æŸ¥å•é¡Œã€‚{}",message.getMsgId());                sendMail(message);                return true;            }            return false;        }    }}</code></pre><p>ç¬¬äºŒï¼Œç­‰å¾…æ¶ˆæ¯é‡è©¦æœ€å¤§æ¬¡æ•¸å¾Œï¼Œé€²å…¥æ­»ä¿¡éšŠåˆ—ã€‚</p><p>æ¶ˆæ¯é‡è©¦æœ€å¤§æ¬¡æ•¸é»˜èªæ˜¯16æ¬¡ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥åœ¨æ¶ˆè²»è€…ç«¯è¨­ç½®é€™å€‹æ¬¡æ•¸ã€‚</p><pre><code>consumer.setMaxReconsumeTimes(3);//è¨­ç½®æ¶ˆæ¯é‡è©¦æœ€å¤§æ¬¡æ•¸</code></pre><p>æ­»ä¿¡éšŠåˆ—çš„ä¸»é¡Œåç¨±æ˜¯ %DLQ% + æ¶ˆè²»è€…çµ„åç¨±ï¼Œæ¯”å¦‚åœ¨è¨‚å–®æ•¸æ“šä¸­ï¼Œæˆ‘å€‘è¨­ç½®äº†æ¶ˆè²»è€…çµ„åï¼š</p><p>String consumerGroup = "order-consumer-group";</p><p>é‚£éº¼é€™å€‹æ¶ˆè²»è€…ï¼Œå°æ‡‰çš„æ­»ä¿¡éšŠåˆ—ä¸»é¡Œåç¨±å°±æ˜¯%DLQ%order-consumer-group</p><p><br></p><div class=pgc-img><img alt="åŸºæ–¼RocketMQåˆ†ä½ˆå¼äº‹å‹™ - å®Œæ•´ç¤ºä¾‹" onerror=errorimg.call(this); src=http://p3.pstatp.com/large/pgc-image/4fe687e23ea642e2b6a43ccc5513ef89><p class=pgc-img-caption></p></div><p><br></p><p>å¦‚ä¸Šåœ–ï¼Œæˆ‘å€‘é‚„éœ€è¦é»æ“ŠTOPICé…ç½®ï¼Œä¾†ä¿®æ”¹è£¡é¢çš„ perm å±¬æ€§ï¼Œæ”¹ç‚º 6 å³å¯ã€‚</p><p><br></p><div class=pgc-img><img alt="åŸºæ–¼RocketMQåˆ†ä½ˆå¼äº‹å‹™ - å®Œæ•´ç¤ºä¾‹" onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/5ae23a50311f4aee807e009315c46e30><p class=pgc-img-caption></p></div><p><br></p><p>æœ€å¾Œå°±å¯ä»¥é€šéç¨‹åºä»£ç¢¼ç›£è½é€™å€‹ä¸»é¡Œï¼Œä¾†é€šçŸ¥äººå·¥ä»‹å…¥è™•ç†æˆ–è€…ç›´æ¥åœ¨æ§åˆ¶æª¯æŸ¥çœ‹è™•ç†äº†ã€‚é€šéå†ªç­‰æ€§æ¶ˆè²»å’Œå°æ­»ä¿¡æ¶ˆæ¯çš„è™•ç†ï¼ŒåŸºæœ¬ä¸Šå°±èƒ½ä¿è­‰æ¶ˆæ¯ä¸€å®šæœƒè¢«è™•ç†ã€‚</p><h1 class=pgc-h-arrow-right>å››ã€ã€ŠRocketMQæŠ€è¡“å…§å¹•ã€‹ä¸­çš„ä»£ç¢¼ç¤ºä¾‹</h1><p>ç­†è€…æ‰‹è£¡æœ‰ä¸€æœ¬æ›¸ã€ŠRocketMQæŠ€è¡“å…§å¹•ã€‹ï¼Œåœ¨ 9.4 ç« ç¯€æœ‰ä¸€æ®µåˆ†ä½ˆå¼äº‹å‹™çš„ä»£ç¢¼ã€‚</p><p>ä¸éï¼Œç­†è€…åœ¨çœ‹äº†ä¹‹å¾Œï¼Œæ„Ÿè¦ºå®ƒè£¡é¢çš„æµç¨‹æ˜¯æœ‰å•é¡Œçš„ï¼Œæœƒé€ æˆæœ¬åœ°äº‹å‹™çš„ä¸ä¸€è‡´ï¼Œä¸‹é¢æˆ‘å€‘å°±ä¾†åˆ†æä¸€ä¸‹ã€‚</p><p>åœ¨é€™è£¡ï¼Œæˆ‘å€‘ä¸»è¦æ˜¯é—œæ³¨æ›¸ä¸­è¨‚å–®æ¥­å‹™æœå‹™é¡å’Œäº‹å‹™ç›£è½å™¨çš„æµç¨‹ã€‚</p><p>åœ¨æ›¸ä¸­ï¼Œè¨‚å–®ä¸‹å–®å½ä»£ç¢¼å¦‚ä¸‹ï¼š</p><pre><code>public Map createOrder(){    Map result = new HashMap();    //åŸ·è¡Œä¸‹è¨‚å–®ç›¸é—œçš„æ¥­å‹™æµç¨‹ï¼Œä¾‹å¦‚æ“ä½œæœ¬åœ°æ•¸æ“šåº«è½åº«ç›¸é—œä»£ç¢¼    //ç”Ÿæˆäº‹å‹™æ¶ˆæ¯å”¯ä¸€æ¥­å‹™æ¨™è­˜ï¼Œå°‡è©²æ¥­å‹™æ¨™è­˜çµ„è£åˆ°å¾…ç™¼é€çš„æ¶ˆæ¯é«”ä¸­ï¼Œæ–¹ä¾¿æ¶ˆæ¯ç«¯é€²è¡Œå†ªç­‰æ¶ˆè²»ã€‚    //èª¿ç”¨æ¶ˆæ¯å®¢æˆ¶ç«¯APIï¼Œç™¼é€äº‹å‹™prepareæ¶ˆæ¯ã€‚    //è¿”å›çµæœï¼Œæäº¤äº‹å‹™    return result;}</code></pre><p>ä¸Šè¿°æ˜¯ç¬¬ä¸€æ­¥ï¼Œç™¼é€äº‹å‹™æ¶ˆæ¯ï¼Œæ¥ä¸‹ä¾†éœ€è¦å¯¦ç¾TransactionListenerï¼Œå¯¦ç¾åŸ·è¡Œæœ¬åœ°äº‹å‹™èˆ‡æœ¬åœ°äº‹å‹™å›æŸ¥ã€‚</p><pre><code>public class OrderTransactionListenerImpl implements TransactionListener {    @Override    public LocalTransactionState executeLocalTransaction(Message message, Object o) {        //å¾æ¶ˆæ¯é«”ä¸­ç²å–æ¥­å‹™å”¯ä¸€ID        String bizUniNo = message.getUserProperty("bizUniNo");        //å°‡bizUniNoå…¥åº«ï¼Œè¡¨åï¼št_message_transactionï¼Œè¡¨çµæ§‹ bizUniNoï¼ˆä¸»éµï¼‰ï¼Œæ¥­å‹™é¡å‹ã€‚        return LocalTransactionState.UNKNOW;    }    @Override    public LocalTransactionState checkLocalTransaction(MessageExt message) {        //å¾æ¶ˆæ¯é«”ä¸­ç²å–æ¥­å‹™å”¯ä¸€ID        String bizUniNo = message.getUserProperty("bizUniNo");        //å¦‚æœæœ¬åœ°äº‹å‹™è¡¨(t_message_transaction)å­˜åœ¨è¨˜éŒ„ï¼Œå‰‡èªç‚ºæäº¤ï¼›å¦‚æœä¸å­˜åœ¨è¿”å›æœªçŸ¥ã€‚        //å¦‚æœå¤šæ¬¡å›æŸ¥é‚„æ˜¯æœªæŸ¥åˆ°æ¶ˆæ¯ï¼Œå‰‡å›æ»¾ã€‚        if (query(bizUniNo)&gt;0){            return LocalTransactionState.COMMIT_MESSAGE;        }else{            return LocalTransactionState.UNKNOW;        }    }    //æŸ¥è©¢æ•¸æ“šåº«æ˜¯å¦å­˜åœ¨è¨˜éŒ„    public int query(String bizUniNo){        //select count(1) from t_message_transaction where biz_uni_no = #{bizUniNo}        return 1;    }}</code></pre><p>ä¸Šé¢çš„ä»£ç¢¼æ˜¯ç­†è€…åœ¨é€™æœ¬æ›¸è£¡ï¼ŒæŠ„éŒ„å‡ºä¾†çš„ï¼Œå¦‚æœæ˜¯æŒ‰ç…§é€™ç¨®åšæ³•ï¼Œ å¯¦éš›ä¸Šæ˜¯æœ‰å•é¡Œçš„ï¼Œæˆ‘å€‘ä¾†åˆ†æä¸€ä¸‹ã€‚</p><h1 class=pgc-h-arrow-right>1ã€ä¸‹å–®ç•°å¸¸</h1><p>æˆ‘å€‘çœ‹ä¸Šé¢çš„è¨‚å–®ä¸‹å–®çš„å½ä»£ç¢¼ï¼Œè£¡é¢åŒ…å«å…©å€‹æ“ä½œï¼šè¨‚å–®å…¥åº«å’Œäº‹å‹™æ¶ˆæ¯ç™¼é€ã€‚</p><p>é‚£éº¼æˆ‘å€‘ç¹¼çºŒæ€è€ƒï¼š</p><ul><li>å¦‚æœè¨‚å–®å…¥åº«çš„æ™‚å€™ç™¼ç”Ÿç•°å¸¸ï¼Œé€™å€‹æ²’å•é¡Œï¼Œå› ç‚ºäº‹å‹™æ¶ˆæ¯ä¹Ÿä¸æœƒç™¼é€ï¼›</li><li>å¦‚æœè¨‚å–®å…¥åº«åŸ·è¡Œå®Œç•¢ï¼Œä½†ç™¼é€äº‹å‹™æ¶ˆæ¯å ±éŒ¯ã€‚é€™å€‹ä¹Ÿæ²’å•é¡Œï¼Œè¨‚å–®æ•¸æ“šæœƒå›æ»¾ï¼›</li><li>å¦‚æœè¨‚å–®å…¥åº«åŸ·è¡Œå®Œç•¢ï¼Œç™¼é€äº‹å‹™æ¶ˆæ¯ä¹Ÿæ²’æœ‰å ±éŒ¯ã€‚ä½†è¿”å›çš„ä¸æ˜¯SEND_OKç‹€æ…‹ï¼Œé€™å€‹æ˜¯æœ‰å•é¡Œçš„ã€‚</li></ul><p>å› ç‚ºåªæœ‰ç™¼é€äº‹å‹™æ¶ˆæ¯æˆåŠŸï¼Œä¸¦ä¸”ç™¼é€ç‹€æ…‹ç‚ºSEND_OKï¼Œæ‰æœƒåŸ·è¡Œç›£è½å™¨ä¸­çš„æœ¬åœ°äº‹å‹™ï¼Œå‘t_message_transactionè¡¨å¯«å…¥äº‹å‹™æ—¥èªŒã€‚</p><p>é‚£éº¼å°±æœƒé€ æˆä¸€å€‹ç¾å ´ï¼šæœ¬åœ°è¨‚å–®æ•¸æ“šå·²ç¶“å…¥åº«ï¼Œä½†æ˜¯ç”±æ–¼æ²’æœ‰è¿”å›SEND_OKç‹€æ…‹ï¼Œå°è‡´ä¸æœƒåŸ·è¡Œæœ¬åœ°äº‹å‹™ä¸­çš„äº‹å‹™æ—¥èªŒã€‚é‚£éº¼é€™æ¢äº‹å‹™æ¶ˆæ¯æ—©æ™šæœƒè¢«å›æ»¾ï¼Œæœ€å¾Œçš„å•é¡Œå°±æ˜¯ç”¨æˆ¶ä¸‹å–®æˆåŠŸï¼Œä½†æ²’æœ‰å¢åŠ ç©åˆ†ã€‚</p><h1 class=pgc-h-arrow-right>2ã€æœ¬åœ°äº‹å‹™åŸ·è¡Œç•°å¸¸</h1><p>äº‹å¯¦ä¸Šï¼Œç¬¬ä¸€å€‹å•é¡Œä¹Ÿå¯ä»¥è¦é¿ã€‚é‚£å°±æ˜¯åœ¨ç™¼é€å®Œäº‹å‹™æ¶ˆæ¯å¾Œï¼Œå†åˆ¤æ–·ä¸‹ç™¼é€ç‹€æ…‹æ˜¯ä¸æ˜¯SEND_OKï¼Œå¦‚æœä¸æ˜¯çš„è©±ï¼Œå°±é€šéæ‹‹ç•°å¸¸çš„æ–¹å¼ä¾†å›æ»¾è¨‚å–®æ•¸æ“šã€‚</p><p>ä½†æ˜¯ï¼Œé‚„æœ‰ç¬¬äºŒå€‹å•é¡Œï¼š</p><p>å¦‚æœè¨‚å–®æ•¸æ“šå’Œäº‹å‹™æ¶ˆæ¯ç™¼é€éƒ½æ²’æœ‰å•é¡Œï¼Œä½†æ˜¯åœ¨åŸ·è¡Œæœ¬åœ°äº‹å‹™æ™‚ï¼Œå¯«å…¥äº‹å‹™æ—¥èªŒæ™‚ç™¼ç”Ÿç•°å¸¸æ€éº¼è¾¦ ï¼Ÿ</p><p>å¦‚æœæ˜¯é€™æ¨£ï¼Œä¹Ÿæœƒå°è‡´æœ¬åœ°è¨‚å–®æ•¸æ“šå·²ç¶“å…¥åº«ï¼Œä½†æ˜¯äº‹å‹™æ—¥èªŒæ²’æœ‰å¯«å…¥ï¼Œåœ¨äº‹å‹™ç‹€æ…‹å›æŸ¥çš„æ™‚å€™ä¸€ç›´æŸ¥è©¢ä¸åˆ°æ­¤è¨˜éŒ„ï¼Œæœ€å¾Œåªèƒ½å›æ»¾äº‹å‹™æ¶ˆæ¯ã€‚æœ€å¾Œçš„ç¾è±¡åŒæ¨£æ˜¯ç”¨æˆ¶ä¸‹å–®æˆåŠŸï¼Œä½†æ²’æœ‰å¢åŠ ç©åˆ†ã€‚</p><p>ä½†æ˜¯åœ¨æ›¸ä¸­ï¼Œä½œè€…æœ‰é€™æ¨£ä¸€æ®µè©±ï¼š</p><blockquote><p>executeLocalTransactionï¼Œè©²æ–¹æ³•ä¸»è¦è¨­ç½®æœ¬åœ°äº‹å‹™ç‹€æ…‹ï¼Œèˆ‡æ¥­å‹™ä»£ç¢¼åœ¨ä¸€å€‹äº‹å‹™ä¸­ã€‚ä¾‹å¦‚åœ¨OrderService#createOrderä¸­ï¼Œåªè¦æœ¬åœ°äº‹å‹™æäº¤æˆåŠŸï¼Œè©²æ–¹æ³•ä¹Ÿæœƒæäº¤æˆåŠŸã€‚æ•…åœ¨é€™è£¡ï¼Œä¸»è¦æ˜¯å‘t_message_transactionæ·»åŠ ä¸€æ¢è¨˜éŒ„ï¼Œåœ¨äº‹å‹™å›æŸ¥æ™‚ï¼Œå¦‚æœå­˜åœ¨è¨˜éŒ„ï¼Œå°±èªç‚ºè©²æ¶ˆæ¯éœ€è¦æäº¤ã€‚</p></blockquote><p>ä½œè€…é€™æ®µè©±çš„æ„æ€ï¼Œæˆ‘ç†è§£æ˜¯èªªä»–å€‘éƒ½è™•æ–¼ä¸€å€‹æœ¬åœ°äº‹å‹™ä¸­ã€‚å¦‚æœcreateOrderæ–¹æ³•åŸ·è¡ŒæˆåŠŸï¼Œå‰‡executeLocalTransactionæ–¹æ³•ä¹ŸæœƒåŸ·è¡ŒæˆåŠŸï¼›å¦‚æœä»»ä½•ä¸€æ–¹å‡ºéŒ¯ï¼Œéƒ½æœƒå›æ»¾äº‹å‹™ã€‚</p><p>ä½†æ˜¯ï¼Œæˆ‘å€‘å¾æºç¢¼ä¸­åˆ†æçš„è©±ï¼Œå¦‚æœæœ¬åœ°äº‹å‹™åŸ·è¡Œå ±éŒ¯ï¼Œè¨‚å–®æ•¸æ“šæ˜¯ä¸æœƒå›æ»¾çš„ã€‚</p><h1 class=pgc-h-arrow-right>3ã€æºç¢¼åˆ†æ</h1><p>é¦–å…ˆï¼Œæˆ‘å€‘è¦çŸ¥é“ï¼ŒexecuteLocalTransactionæ–¹æ³•å’ŒcreateOrderæ–¹æ³•ç¢ºå¯¦åœ¨ä¸€å€‹äº‹å‹™è£¡ã€‚</p><p>é€™æ˜¯å› ç‚ºexecuteLocalTransactionæ–¹æ³•ï¼Œæ˜¯åœ¨ç™¼é€äº‹å‹™æ¶ˆæ¯ä¹‹å¾Œï¼ŒåŒæ­¥èª¿ç”¨åˆ°çš„ï¼Œæ‰€ä»¥å®ƒå€‘åœ¨ä¸€å€‹äº‹å‹™è£¡ã€‚</p><p>æˆ‘å€‘ä¾†çœ‹æºç¢¼ä¸­ï¼Œäº‹å‹™æ¶ˆæ¯ç™¼é€çš„éç¨‹ï¼š</p><pre><code>public TransactionSendResult sendMessageInTransaction(Message msg,                         LocalTransactionExecuter localTransactionExecuter,                         Object arg)throws MQClientException {	    //ç™¼é€äº‹å‹™æ¶ˆæ¯è¿”å›çµæœ    SendResult sendResult = null;    //å¦‚æœç™¼é€æ¶ˆæ¯å¤±æ•—ï¼Œæ‹‹å‡ºç•°å¸¸    try {    	sendResult = this.send(msg);    } catch (Exception var11) {    	throw new MQClientException("send message Exception", var11);    }    //åˆå§‹åŒ–æœ¬åœ°äº‹å‹™ç‹€æ…‹ï¼šæœªçŸ¥ç‹€æ…‹    LocalTransactionState localTransactionState = LocalTransactionState.UNKNOW;    Throwable localException = null;    switch(sendResult.getSendStatus()) {    //å¦‚æœç™¼é€äº‹å‹™æ¶ˆæ¯ç‹€æ…‹ç‚ºsend_ok    case SEND_OK:        try {            //åŸ·è¡Œæœ¬åœ°äº‹å‹™æ–¹æ³•            if (transactionListener != null) {                this.log.debug("Used new transaction API");                localTransactionState = transactionListener.executeLocalTransaction(msg, arg);            }        } catch (Throwable var10) {            this.log.info("executeLocalTransactionBranch exception", var10);            this.log.info(msg.toString());            localException = var10;        }        break;	//å¦‚æœç™¼é€äº‹å‹™ç‹€æ…‹ä¸æ˜¯send_ok,è©²äº‹å‹™æ¶ˆæ¯æœƒè¢«å›æ»¾	case FLUSH_DISK_TIMEOUT:	case FLUSH_SLAVE_TIMEOUT:	case SLAVE_NOT_AVAILABLE:	    localTransactionState = LocalTransactionState.ROLLBACK_MESSAGE;	}	//çµæŸäº‹å‹™ï¼Œå°±æ˜¯æ ¹æ“šæœ¬åœ°äº‹å‹™ç‹€æ…‹ï¼ŒåŸ·è¡Œæäº¤ã€å›æ»¾æˆ–æš«ä¸è™•ç†äº‹å‹™	try {	    this.endTransaction(sendResult, localTransactionState, localException);	} catch (Exception var9) {	    this.log.warn("", var9);	}    TransactionSendResult transactionSendResult = new TransactionSendResult();    transactionSendResult.setSendStatus(sendResult.getSendStatus());    transactionSendResult.setMessageQueue(sendResult.getMessageQueue());    transactionSendResult.setMsgId(sendResult.getMsgId());    transactionSendResult.setQueueOffset(sendResult.getQueueOffset());    transactionSendResult.setTransactionId(sendResult.getTransactionId());    transactionSendResult.setLocalTransactionState(localTransactionState);    return transactionSendResult;}</code></pre><p>ä¸Šé¢çš„ä»£ç¢¼ï¼Œå°±æ˜¯ç™¼é€äº‹å‹™æ¶ˆæ¯çš„éç¨‹ã€‚æˆ‘å€‘é‡é»ä¾†çœ‹ï¼Œå¦‚æœäº‹å‹™æ¶ˆæ¯ç™¼é€æˆåŠŸï¼Œä¸¦ä¸”è¿”å›ç‹€æ…‹ç‚ºSEND_OKï¼Œé‚£éº¼å°±å»åŸ·è¡Œç›£è½å™¨ä¸­çš„executeLocalTransactionæ–¹æ³•ï¼Œé€™èªªæ˜å®ƒå€‘åœ¨ä¸€å€‹äº‹å‹™ä¸­ã€‚</p><p>ä½†æ˜¯ï¼Œåœ¨åŸ·è¡Œéç¨‹ä¸­ï¼Œå®ƒæ‰‹å‹•æ•ç²äº† Throwable ç•°å¸¸ã€‚é€™å°±èªªæ˜ï¼Œå³ä¾¿åŸ·è¡Œæœ¬åœ°äº‹å‹™å¤±æ•—ï¼Œä¹Ÿä¸æœƒè§¸ç™¼å›æ»¾çš„ã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘å€‘å·²ç¶“éå¸¸æ˜ç¢ºäº†ï¼Œå¦‚æœæŒ‰ç…§æ›¸è£¡çš„æµç¨‹ä¾†å¯«ä»£ç¢¼ï¼Œé€™å¡Šå°±æœƒæˆç‚ºä¸€å€‹éš±æ‚£é»ã€‚</p><p>å¦‚æœæƒ³è¦é¿é€™å€‹å•é¡Œï¼Œæˆ‘å€‘åªèƒ½ä¿®æ”¹rocket-clientä¸­çš„ä»£ç¢¼ï¼Œæ¯”å¦‚ï¼š</p><pre><code>try {    //åŸ·è¡Œæœ¬åœ°äº‹å‹™æ–¹æ³•    if (transactionListener != null) {        this.log.debug("Used new transaction API");        localTransactionState = transactionListener.executeLocalTransaction(msg, arg);    }} catch (Throwable var10) {    this.log.info("executeLocalTransactionBranch exception", var10);    this.log.info(msg.toString());    localException = var10;    throw new MQClientException(e.getMessage(),e);}   </code></pre><p>ç­†è€…é€šéä¿®æ”¹æºç¢¼ï¼Œä¸¦æ¸¬è©¦äº†ä¸€ä¸‹ï¼Œé€šéé€™ç¨®æ‰‹å‹•æ‹‹å‡ºç•°å¸¸çš„æ–¹å¼ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚é€™æ¨£çš„è©±å¦‚æœåŸ·è¡Œæœ¬åœ°äº‹å‹™çš„æ™‚å€™å‡ºéŒ¯ï¼Œä¹Ÿæœƒå›æ»¾è¨‚å–®æ•¸æ“šã€‚</p><p>åˆ°é€™è£¡ï¼Œå°±èƒ½å›ç­”ç­†è€…æœ¬æ–‡2.4ç« ç¯€è£¡çš„ä¸€å€‹å•é¡Œï¼š</p><p>ç‚ºä»€éº¼åœ¨è¨‚å–®æ¥­å‹™æœå‹™é¡ä¸­ï¼Œéœ€è¦æœ‰å…©å€‹æ–¹æ³•ã€‚ä¸€å€‹ç”¨æ–¼å‘RocketMQç™¼é€äº‹å‹™æ¶ˆæ¯ï¼Œä¸€å€‹ç”¨æ–¼çœŸæ­£çš„æ¥­å‹™æ•¸æ“šè½åº«ã€‚</p><h1 class=pgc-h-arrow-right>ç¸½çµ</h1><p>æœ¬æ–‡é‡é»é—¡è¿°äº†åŸºæ–¼RocketMQä¾†å¯¦ç¾æœ€çµ‚ä¸€è‡´æ€§çš„åˆ†ä½ˆå¼äº‹å‹™æ¡ˆä¾‹ã€‚</p><p>å¦å¤–ï¼Œä¹Ÿåˆ†äº«äº†é—œæ–¼ã€ŠRocketMQæŠ€è¡“å…§å¹•ã€‹ä¸€æ›¸ä¸­ï¼Œåˆ†ä½ˆå¼äº‹å‹™ç¤ºä¾‹ä»£ç¢¼ï¼Œå¯èƒ½å‡ºç¾çš„ç•°å¸¸å•é¡Œã€‚é—œæ–¼é€™ä¸€é»ï¼Œä¹Ÿå¸Œæœ›æœ‹å‹å€‘å¦‚æœæœ‰ä¸åŒçœ‹æ³•ï¼Œç©æ¥µç•™è¨€ï¼Œå…±åŒäº¤æµã€‚</p><p class=pgc-end-literature><br>ä½œè€…ï¼šæ¸…å¹½ä¹‹åœ°<br>éˆæ¥ï¼šhttps://juejin.im/post/5e737d155188254943200ed0<br></p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>ç¤ºä¾‹</a></li><li><a>RocketMQ</a></li><li><a>äº‹å‹™</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=æœç´¢>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>ğŸ”</button></form></section><section class=widget><h3 class=widget-title>æœ€æ–°æ–‡ç«  âš¡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/15b0178.html alt=ä¸€å®šèƒ½çœ‹æ‡‚çš„RocketMQäº‹å‹™æ¶ˆæ¯æºç¢¼ä»‹ç´¹(ä¹¾è²¨) class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/9893da5524c1439f8a11cb24322c57a9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/15b0178.html title=ä¸€å®šèƒ½çœ‹æ‡‚çš„RocketMQäº‹å‹™æ¶ˆæ¯æºç¢¼ä»‹ç´¹(ä¹¾è²¨)>ä¸€å®šèƒ½çœ‹æ‡‚çš„RocketMQäº‹å‹™æ¶ˆæ¯æºç¢¼ä»‹ç´¹(ä¹¾è²¨)</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/720ab20.html alt=MySQLäº‹å‹™ç®¡ç†çš„ä»‹ç´¹ï¼ˆé™„ç¤ºä¾‹ï¼‰ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/720ab20.html title=MySQLäº‹å‹™ç®¡ç†çš„ä»‹ç´¹ï¼ˆé™„ç¤ºä¾‹ï¼‰>MySQLäº‹å‹™ç®¡ç†çš„ä»‹ç´¹ï¼ˆé™„ç¤ºä¾‹ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0be408a4.html alt="MySQL äº‹å‹™è™•ç†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0be408a4.html title="MySQL äº‹å‹™è™•ç†">MySQL äº‹å‹™è™•ç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8a538d3c.html alt=MySQLâ€”â€”äº‹å‹™(Transaction)è©³è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/29d4c92c9c2344838eb72ef948cf08fa style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8a538d3c.html title=MySQLâ€”â€”äº‹å‹™(Transaction)è©³è§£>MySQLâ€”â€”äº‹å‹™(Transaction)è©³è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3269d080.html alt=MySQLæ•¸æ“šåº«çš„äº‹å‹™ç®¡ç† class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/152203544367254a708f807 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3269d080.html title=MySQLæ•¸æ“šåº«çš„äº‹å‹™ç®¡ç†>MySQLæ•¸æ“šåº«çš„äº‹å‹™ç®¡ç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8293e598.html alt=MySQläº‹å‹™æœ€å…¨è©³è§£ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/c61163c863114226b14bb3760da19e4d style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8293e598.html title=MySQläº‹å‹™æœ€å…¨è©³è§£>MySQläº‹å‹™æœ€å…¨è©³è§£</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/011d2da0.html alt=MySqlä½µç™¼èˆ‡äº‹å‹™çš„è™•ç† class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/dfic-imagehandler/f13d8a1e-5e60-4b48-90bc-3c26e312a208 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/011d2da0.html title=MySqlä½µç™¼èˆ‡äº‹å‹™çš„è™•ç†>MySqlä½µç™¼èˆ‡äº‹å‹™çš„è™•ç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/4ab1dd0d.html alt=Mysqläº‹å‹™ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/4ab1dd0d.html title=Mysqläº‹å‹™>Mysqläº‹å‹™</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cb944fe7.html alt=Mysqläº‹å‹™è©³è§£(ä¸€æ–‡è®€æ‡‚æ•¸æ“šåº«äº‹å‹™) class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/cb7ba6cbda8c44438d9d3d7c57bd25b9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cb944fe7.html title=Mysqläº‹å‹™è©³è§£(ä¸€æ–‡è®€æ‡‚æ•¸æ“šåº«äº‹å‹™)>Mysqläº‹å‹™è©³è§£(ä¸€æ–‡è®€æ‡‚æ•¸æ“šåº«äº‹å‹™)</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/e9d6f488.html alt="SQL Serverä¸­çš„äº‹å‹™ï¼ˆé™„æœ‰å¯¦ä¾‹ï¼‰" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/21e047bd6e3c41fba0beac7ef3f1ce4e style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/e9d6f488.html title="SQL Serverä¸­çš„äº‹å‹™ï¼ˆé™„æœ‰å¯¦ä¾‹ï¼‰">SQL Serverä¸­çš„äº‹å‹™ï¼ˆé™„æœ‰å¯¦ä¾‹ï¼‰</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/bb071e7e.html alt="SQL äº‹å‹™æ©Ÿåˆ¶-transaction" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3231427d97bf4a04b148360fea032241 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/bb071e7e.html title="SQL äº‹å‹™æ©Ÿåˆ¶-transaction">SQL äº‹å‹™æ©Ÿåˆ¶-transaction</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/44c014a1.html alt=SpringBootäº‹å‹™è©³ç´°ç°¡ä»‹ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/44c014a1.html title=SpringBootäº‹å‹™è©³ç´°ç°¡ä»‹>SpringBootäº‹å‹™è©³ç´°ç°¡ä»‹</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/24b98634.html alt=SqlServerä½¿ç”¨äº‹å‹™æ³¨æ„äº‹é …ï¼Œé«˜ç´šç¨‹åºå“¡å¿…èƒŒ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/24b98634.html title=SqlServerä½¿ç”¨äº‹å‹™æ³¨æ„äº‹é …ï¼Œé«˜ç´šç¨‹åºå“¡å¿…èƒŒ>SqlServerä½¿ç”¨äº‹å‹™æ³¨æ„äº‹é …ï¼Œé«˜ç´šç¨‹åºå“¡å¿…èƒŒ</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/090306a0.html alt="[Spring] æ·±å…¥ç­è§£äº‹å‹™åŸç†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/a8c6dbd7c51741f5a76262e8e2c7a670 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/090306a0.html title="[Spring] æ·±å…¥ç­è§£äº‹å‹™åŸç†">[Spring] æ·±å…¥ç­è§£äº‹å‹™åŸç†</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fb2bc471.html alt="ã€Œè­¯ã€ Spring çš„åˆ†ä½ˆå¼äº‹å‹™å¯¦ç¾â€”ä½¿ç”¨å’Œä¸ä½¿ç”¨ XAâ€”ç¬¬äºŒéƒ¨åˆ†" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fb2bc471.html title="ã€Œè­¯ã€ Spring çš„åˆ†ä½ˆå¼äº‹å‹™å¯¦ç¾â€”ä½¿ç”¨å’Œä¸ä½¿ç”¨ XAâ€”ç¬¬äºŒéƒ¨åˆ†">ã€Œè­¯ã€ Spring çš„åˆ†ä½ˆå¼äº‹å‹™å¯¦ç¾â€”ä½¿ç”¨å’Œä¸ä½¿ç”¨ XAâ€”ç¬¬äºŒéƒ¨åˆ†</a></li><hr></ul></section><section class=widget><h3 class=widget-title>å…¶ä»–</h3><ul class=widget-list><li><a href=TOS.html>ä½¿ç”¨æ¢æ¬¾</a></li><li><a href=CommentPolicy.html>ç•™è¨€æ”¿ç­–</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>è¯çµ¡æˆ‘å€‘</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>æå®¢å¿«è¨Š</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>