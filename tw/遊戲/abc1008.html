<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>遺傳算法和超參數 | 极客快訊</title><meta property="og:title" content="遺傳算法和超參數 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="http://p3.pstatp.com/large/pgc-image/1535181061510088ebc8f85"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e9%81%8a%e6%88%b2/abc1008.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e9%81%8a%e6%88%b2/abc1008.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e9%81%8a%e6%88%b2/abc1008.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e9%81%8a%e6%88%b2/abc1008.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e9%81%8a%e6%88%b2/abc1008.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e9%81%8a%e6%88%b2/abc1008.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e9%81%8a%e6%88%b2/abc1008.html><link rel=canonical href=https://geekbank.cf/tw/%e9%81%8a%e6%88%b2/abc1008.html><meta property="article:published_time" content="2020-10-29T20:46:33+08:00"><meta property="article:modified_time" content="2020-10-29T20:46:33+08:00"><meta name=Keywords content><meta name=description content="遺傳算法和超參數"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E9%81%8A%E6%88%B2/abc1008.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>遺傳算法和超參數</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E9%81%8A%E6%88%B2.html>遊戲</a></span></div><div class=post-content><div><div class=pgc-img><img alt=遺傳算法和超參數 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/pgc-image/1535181061510088ebc8f85><p class=pgc-img-caption></p></div><h1>遺傳算法是什麼?</h1><p>遺傳算法是優化問題的一種解決方案，例如，如果你需要找到最佳的參數集來最小化損失函數。遺傳算法是進化算法的一部分。這個想法受到自然和自然選擇的啟發。</p><p>在自然界中，進化至少需要三個條件:</p><ul><li>遺傳——生物體必須能夠將某些特定的特徵遺傳給後代;</li><li>變異——種群內的生物必須具有不同的特徵;</li><li>競爭——產生的後代數量超過了生存能力。</li></ul><p>現在想象一下，你在一個特定的編程環境中編碼了一些對象，而不是生物體。例如，如果你有一個機器學習（ML）模型的種群，它會如何工作?</p><ol><li>首先生成ML模型的初始種群，隨機選擇超參數。</li><li>計算每個模型的損失函數，例如，對數損失。</li><li>然後選擇一些誤差最小的模型。</li><li>現在您需要創建後代，因此您需要基於上一代最好的模型創建一組新的機器學習（ML）模型，並稍微更改它們的超參數。您的新種群將從以前的種群中的模型和新生成的模型中以一定比例包含，例如，50/50。</li><li>計算損失函數，對模型進行排序，然後再重複整個過程。</li></ol><p>遺傳算法並不完美，您仍然需要指定您的損失函數、您的種群大小、具有變化參數的後代比例等等。</p><h1>TPOT</h1><p>可能是對遺傳超參數調優最友好的庫。</p><p>GitHub:https://github.com/EpistasisLab/tpot</p><p>以下是我從TPOT中提取最佳超參數的方法，Python代碼如下：</p><blockquote><p>#Search for best hyperparameters for XGBoost</p><p>from xgboost import XGBClassifier</p><p>from tpot import TPOTClassifier, TPOTRegressor</p><p>from deap.gp import Primitive</p><p>#Define your hyperparameters</p><p>params = {'max_depth': np.arange(1,200,1),</p><p>'learning_rate': np.arange(0.0001,0.1,0.0001),</p><p>'n_estimators': np.arange(1,200,1),</p><p>'nthread':[6],</p><p>'gamma':np.arange(0.00001,0.1,0.00001),</p><p>'subsample':np.arange(0.1,2,0.1),</p><p>'reg_lambda': np.arange(0.1,200,1),</p><p>'reg_alpha': np.arange(1,200,1),</p><p>'min_child_weight': np.arange(1,200,1),</p><p>'gamma': np.arange(0.1,2,0.1),</p><p>'colsample_bytree': np.arange(0.1,2,0.1),</p><p>'colsample_bylevel': np.arange(0.1,2,0.1)</p><p>}</p><p>#Run TPOT</p><p>tpot_classifier = TPOTClassifier(generations=20, population_size=500, offspring_size=250,</p><p>verbosity=2, early_stop=8,</p><p>config_dict={'xgboost.XGBClassifier': params}, cv = 10, scoring = 'accuracy')</p><p>tpot_classifier.fit(X, Y)</p><p>#Extract best parameters</p><p>args = {}</p><p>for arg in tpot_classifier._optimized_pipeline:</p><p>if type(arg) != Primitive:</p><p>try:</p><p>if arg.value.split('__')[1].split('=')[0] in ['max_depth', 'n_estimators', 'nthread','min_child_weigh']:</p><p>args[arg.value.split('__')[1].split('=')[0]] = int(arg.value.split('__')[1].split('=')[1])</p><p>else:</p><p>args[arg.value.split('__')[1].split('=')[0]] = float(arg.value.split('__')[1].split('=')[1])</p><p>except:</p><p>pass</p><p>params = args</p><p>#Now you can use XGBoost with best hyperparameters</p><p>xgbxgb == XGBClassifierXGBClas (**params)</p></blockquote><h1>如何調整神經網絡？</h1><p>在神經網絡的情況下，您還可以使用遺傳算法，它們的工作速度比基於網格搜索的方法快得多。</p><p>我找到了這個GitHub存儲庫 - 使用遺傳算法演化神經網絡（https://github.com/harvitronix/neural-network-genetic-algorithm），並且非常喜歡這種方法。</p><p>用法示例：</p><blockquote><p>from evolution import NeuroEvolution</p><p>params = {</p><p>"epochs": [10, 20, 35],</p><p>"batch_size": [10, 20, 40],</p><p>"n_layers": [1, 2, 3, 4],</p><p>"n_neurons": [20, 40, 60],</p><p>"dropout": [0.1, 0.2, 0.5],</p><p>"optimizers": ["nadam", "adam"],</p><p>"activations": ["relu", "sigmoid"],</p><p>"last_layer_activations": ["sigmoid"],</p><p>"losses": ["binary_crossentropy"],</p><p>"metrics": ["accuracy"]</p><p>}</p></blockquote><p>....</p><blockquote><p># x_train, y_train, x_test, y_test - prepared data</p><p>search = NeuroEvolution(generations = 10, population = 10, params=params)</p><p>search.evolve(x_train, y_train, x_test, y_test)</p><p>100%|██████████| 10/10 [05:37&lt;00:00, 29.58s/it]</p><p>100%|██████████| 10/10 [03:55&lt;00:00, 25.55s/it]</p><p>100%|██████████| 10/10 [02:05&lt;00:00, 15.05s/it]</p><p>100%|██████████| 10/10 [01:37&lt;00:00, 14.03s/it]</p><p>100%|██████████| 10/10 [02:49&lt;00:00, 22.53s/it]</p><p>100%|██████████| 10/10 [02:37&lt;00:00, 23.14s/it]</p><p>100%|██████████| 10/10 [02:36&lt;00:00, 21.37s/it]</p><p>100%|██████████| 10/10 [01:57&lt;00:00, 18.56s/it]</p><p>100%|██████████| 10/10 [02:42&lt;00:00, 25.29s/it]</p><p>"best accuracy: 0.79, best params: {'epochs': 35, 'batch_size': 40, 'n_layers': 2, 'n_neurons': 20, 'dropout': 0.1, 'optimizers': 'nadam', 'activations': 'relu', 'last_layer_activations': 'sigmoid', 'losses': 'binary_crossentropy', 'metrics': 'accuracy'}"</p><p># or you can call it with</p><p>search.best_params</p></blockquote><p>它還可以搜索最佳數量的圖層和神經元，以及您定義的超參數的位置。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>遺傳</a></li><li><a>參數</a></li><li><a>算法</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E9%81%8A%E6%88%B2/3192eea.html alt=俺爸俺媽和俺——是遺傳算法？「AI儒家談」從進化算法說開 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p9.pstatp.com/large/pgc-image/ba8d2959b19647b5b829c2b72605c113 style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/3192eea.html title=俺爸俺媽和俺——是遺傳算法？「AI儒家談」從進化算法說開>俺爸俺媽和俺——是遺傳算法？「AI儒家談」從進化算法說開</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/fa7911e.html alt=三分鐘學會遺傳算法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p3.pstatp.com/large/dfic-imagehandler/77327867-8f42-46ff-951d-f833dc5e8032 style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/fa7911e.html title=三分鐘學會遺傳算法>三分鐘學會遺傳算法</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/33cca76.html alt="學習筆記：遺傳算法(Python) #1 遺傳算法簡介" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p3.pstatp.com/large/pgc-image/94a779ec533f4b7ba260de3c7b04ce8c style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/33cca76.html title="學習筆記：遺傳算法(Python) #1 遺傳算法簡介">學習筆記：遺傳算法(Python) #1 遺傳算法簡介</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/d0418e7.html alt=理解人工智能的遺傳算法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p3.pstatp.com/large/pgc-image/15361404054583f46c54972 style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/d0418e7.html title=理解人工智能的遺傳算法>理解人工智能的遺傳算法</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/fdf46c8.html alt=遺傳算法-理解與實戰 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p3.pstatp.com/large/dfic-imagehandler/d816218a-77fb-426d-b163-aff1377d0a51 style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/fdf46c8.html title=遺傳算法-理解與實戰>遺傳算法-理解與實戰</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/5c16da4.html alt=遺傳算法基本操作 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p3.pstatp.com/large/pgc-image/1540342523497fd07077d5b style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/5c16da4.html title=遺傳算法基本操作>遺傳算法基本操作</a></li><hr><li><a href=../../tw/%E9%81%8A%E6%88%B2/5a7929f.html alt=遺傳算法：組合優化算法，按照進化論的方式啟發搜索尋優解 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=http://p1.pstatp.com/large/dfic-imagehandler/a56b19b5-17af-4bef-be7d-66728c6a6e1a style=border-radius:25px></a>
<a href=../../tw/%E9%81%8A%E6%88%B2/5a7929f.html title=遺傳算法：組合優化算法，按照進化論的方式啟發搜索尋優解>遺傳算法：組合優化算法，按照進化論的方式啟發搜索尋優解</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/25bebf48.html alt=關於齒輪的參數及計算公式大全 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/54cfb37ea965443daf82a218b503ddbc style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/25bebf48.html title=關於齒輪的參數及計算公式大全>關於齒輪的參數及計算公式大全</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ed4abe39.html alt=算法小專欄：散列表（二） class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/a831970b0ccf4e4cbe591777ebd3f2a3 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ed4abe39.html title=算法小專欄：散列表（二）>算法小專欄：散列表（二）</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/0e83a16d.html alt=聚四氟乙烯材料如何合理選取切削參數？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/0e83a16d.html title=聚四氟乙烯材料如何合理選取切削參數？>聚四氟乙烯材料如何合理選取切削參數？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/38aea254.html alt=七大查找算法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/15393515221731c57aa8da1 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/38aea254.html title=七大查找算法>七大查找算法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/51e4e55b.html alt=掌握算法-散列 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/7fe8d19cb78241e999d77102bee7e16c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/51e4e55b.html title=掌握算法-散列>掌握算法-散列</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/3d825106.html alt=記不住先收藏！結構設計參數中易踩的85個坑 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/12418666dc2f40db9e2a39a0903494e9 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3d825106.html title=記不住先收藏！結構設計參數中易踩的85個坑>記不住先收藏！結構設計參數中易踩的85個坑</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d30ee216.html alt=功率電感：參數圖文對比與選型 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/dc7193bbd2b542d2ada80995bab5a82c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d30ee216.html title=功率電感：參數圖文對比與選型>功率電感：參數圖文對比與選型</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/b06da4c5.html alt=圖解功率MOS管的參數 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/1940284f671c4b559a1db4ef0e83976c style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/b06da4c5.html title=圖解功率MOS管的參數>圖解功率MOS管的參數</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>