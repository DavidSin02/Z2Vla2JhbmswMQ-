<!doctype html><html lang=tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><link rel=dns-prefetch href=https://i.geekbank.cf/><title>數據庫的江湖情仇：事務篇 | 极客快訊</title><meta property="og:title" content="數據庫的江湖情仇：事務篇 - 极客快訊"><meta property="og:type" content="article"><meta property="og:locale" content="tw"><meta property="og:image" content="http://p3.pstatp.com/large/pgc-image/e45e5353f3144ed79948e8fdc33ae0b8"><link rel=alternate hreflang=x-default href=https://geekbank.cf/tw/%e9%81%8a%e6%88%b2/ea25593.html><link rel=alternate hreflang=zh-tw href=https://geekbank.cf/tw/%e9%81%8a%e6%88%b2/ea25593.html><link rel=alternate hreflang=zh-cn href=https://geekbank.cf/cn/%e9%81%8a%e6%88%b2/ea25593.html><link rel=alternate hreflang=zh-hk href=https://geekbank.cf/tw/%e9%81%8a%e6%88%b2/ea25593.html><link rel=alternate hreflang=zh-mo href=https://geekbank.cf/tw/%e9%81%8a%e6%88%b2/ea25593.html><link rel=alternate hreflang=zh-my href=https://geekbank.cf/cn/%e9%81%8a%e6%88%b2/ea25593.html><link rel=alternate hreflang=zh-sg href=https://geekbank.cf/cn/%e9%81%8a%e6%88%b2/ea25593.html><link rel=canonical href=https://geekbank.cf/tw/%e9%81%8a%e6%88%b2/ea25593.html><meta property="article:published_time" content="2020-10-29T20:46:28+08:00"><meta property="article:modified_time" content="2020-10-29T20:46:28+08:00"><meta name=Keywords content><meta name=description content="數據庫的江湖情仇：事務篇"><meta name=author content="极客快訊"><meta property="og:url" content="/tw/%E9%81%8A%E6%88%B2/ea25593.html"><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffc40d"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=https://geekbank.cf/css/normalize.css><link rel=stylesheet href=https://geekbank.cf/css/style.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script type=text/javascript src=https://geekbank.cf/js/jqthumb.min.js></script><script data-ad-client=ca-pub-3525055026201463 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><h1><a id=logo href>🤓 极客快訊 Geek Bank</a></h1><p class=description>為你帶來最全的科技知識 🧡</p></div><div><nav id=nav-menu class=clearfix><a class=current href>猜你喜歡</a>
<a href=../../tw/categories/%E7%A7%91%E6%8A%80.html title=科技>科技</a>
<a href=../../tw/categories/%E9%81%8A%E6%88%B2.html title=遊戲>遊戲</a>
<a href=../../tw/categories/%E7%A7%91%E5%AD%B8.html title=科學>科學</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>數據庫的江湖情仇：事務篇</h1></header><date class="post-meta meta-date">2020-10-29</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=tw/categories/%E9%81%8A%E6%88%B2.html>遊戲</a></span></div><div class=post-content><div><p>2015年左右，因為工作需要用MongoDB、CouchBase這兩種文檔型數據庫，時不時到這兩個數據庫官網上查資料、報BUG。時常可以在MongoDB官網上看到這樣一些新聞，“某某企業成功將MySQL替換成MongoDB，性能大幅提升”，“某某公司將Oracle替換成MongoDB，節約成本若干”……</p><p>而在CouchBase官網上，又會時不時看到這樣的新聞：“A公司將MongoDB替換成CouchBase，性能提升顯著”、“B公司將MongoDB替換為CouchBase，性能大大提升。”……</p><div class=pgc-img><img alt=數據庫的江湖情仇：事務篇 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/pgc-image/e45e5353f3144ed79948e8fdc33ae0b8><p class=pgc-img-caption></p></div><p>這樣的廣告詞往往讓數據架構人員無所事從，看到了上面的新聞，如果你是數據架構人員，你要如何選擇數據庫呢？</p><div class=pgc-img><img alt=數據庫的江湖情仇：事務篇 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/40058e384b044797a9f9e46356361817><p class=pgc-img-caption></p></div><p>是用關係型的MySQL/Oracle，還是“更好”的MongoDB，還是“更更好”的CouchBase？或者，還有“更更更好”數據庫可供選擇，要不要嚐個鮮？</p><p>我相信放在官網中的新聞，一定不會弄虛做假。但隱藏了很多關鍵信息後，這樣的新聞就略有點不負責了。</p><p>要知道2015年時，MongoDB才剛剛支持一個Document內的事務。簡單點說，還不支持跨行事務。如果你輕信了這樣的新聞，貿然將需要跨行的、複雜事務的應用，建立在了MongoDB之上，你可以去準備你的簡歷了。</p><p>CouchBase也一樣，它是CouchDB和Memcached的組合。CouchDB是文檔型數據庫，Memcached作為存儲引擎，合起來就是CouchBase。其實相當於把數據放在Memcached中的MongoDB。</p><p>它之所以比MongoDB更快，是因為它的數據都是在內存中。如果MongoDB的內存也很大，所有數據也都緩存在內存中，誰更快還不好說。</p><p>而且，一旦CouchBase數據量超過主機內存，發生真正的物理I/O，其性能下降是十分明顯的，往往要慢於MongoDB。</p><p>不明白這些數據庫的內在本質，貿然的選擇某個數據庫。個人準備簡歷這只是小事，對企業造成的損壞將難以估量。之前我寫過一篇《Digg啟示錄》，為大家總結美國知識分享類網站Digg，為追求橫向擴展，而盲目的替換底層數據庫，導致問題重重，應用頻繁出錯，網頁時常打不開，致使公司在重要的發展窗口期痛失契機，最後50萬美元被收購的下場（高峰時期，Digg曾估值5億美元）。</p><p>如果你面對繁多的數據庫，有點眼花撩亂，沒關係有美創專業的數據庫團隊在，美創可以為您的數據提供從架構選型、到運維、到安全……等全方位的服務。</p><p><strong>廣告就到這裡，今天為大家繼續梳理數據架構選型中的坑，這一期我們討論OLTP的“事務”。</strong></p><p>很多人對這個詞已經陌生，NoSQL大行其道之後，事務好像已經是可有可無的東西了。實際上不然，NoSQL的領頭羊MongoDB一直在默默的發展事務功能，到4.0以上版本（現在最新版是4.3），已經基本上實現傳統關係型數據庫的事務功能了。</p><p>事務對OLAP型應用來說的確是可有可無，但對OLTP來說，絕對是必須的。</p><p><strong>事務的概念是從哪裡來的呢？這可以一直追溯到上世紀70年代，關係型數據庫剛剛誕生的時期。</strong></p><p>1970前後，已經功成名就的數據庫圈大佬——E.F.Codd，有感於層次、網狀數據庫的不便，提出了創世級的關係模型，從此開啟了關係數據庫時代。</p><div class=pgc-img><img alt=數據庫的江湖情仇：事務篇 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/6215a860253d404f890d62e93fbc75c9><p class=pgc-img-caption></p></div><p class=ql-align-center>（E.F.Cood，關係型數據庫之父，圖靈獎得主）</p><p>但是在整個70年代，關係型的發展都不是太好，E.F.Codd老爺子忙於推廣他的關係模型。無暇他顧。</p><p>這時候比E.F.Codd小20歲的數據庫新秀：James Gray（暱稱Jim）登場了。</p><div class=pgc-img><img alt=數據庫的江湖情仇：事務篇 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/pgc-image/5df6c0a621c64eb085d0a7da0ef21c21><p class=pgc-img-caption></p></div><p class=ql-align-center>（青年時期的Jim）</p><p>Jim是IBM SYSTEM R的開發人員。SYSTEM R是IBM的關係型數據庫的嘗試。Jim在開發SYSTEM R時，不斷在思考一個問題：</p><div class=pgc-img><img alt=數據庫的江湖情仇：事務篇 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/75614f66930b4337bbd1ece640ef5ebf><p class=pgc-img-caption></p></div><p><strong>“如何能多、快、好、省的保證數據庫的一致性”。</strong></p><p>Jim老爺子想出來的大招就是：</p><p>把數據庫中相關的操作看作一個統一的原子操作，這些相關的操作要麼都成功、要麼都失敗。這就是事務了，事務的概念，就從這裡誕生了。</p><p>只要保證每個事務都是一致的，數據庫就是一致的。</p><p><strong>這樣，問題“保證數據庫的一致性”，就變為“保證事務一致性”。</strong></p><p>你看，問題的範圍大大縮小了。這就是頂級架構師的思維。</p><p><strong>說到如何“多、快、好、省”的保證事務一致性？</strong></p><p>這個問題並不簡單，數據庫的操作是多重併發的，事務是互相重疊且相關的，在一段時間內，我可能更新了你要查詢的行，你要刪除他正在更新的行……在這種互相交織在一起的情況是十分普遍的。</p><p>Jim老爺子後來研究了一輩子事務這東西，終於在1994年獲得了圖靈獎。圖靈獎可以計算機界的諾貝爾獎，而有關數據庫的圖靈獎，一共有4次。其中，就有一次就是和事務相關的，足以說明事務很複雜、很重要。</p><div class=pgc-img><img alt=數據庫的江湖情仇：事務篇 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/pgc-image/25daf49bd20347a4a212729e07ac2b45><p class=pgc-img-caption></p></div><p class=ql-align-center>（James Gray的演講）</p><p>Jim老爺子後來把他的研究成果還寫成了一本書，叫《事務處理：概念與技術》。如果你想開發一個能保證事務一致性的數據庫，建議你讀一讀。</p><p>簡要說一下老爺子的思想，當時已經有了兩階段提交協議，但它是針對分佈式的，因此比較鬆散，用它來實現事務的原子性太慢了。</p><p>Jim另闢捷徑，提出了一個DO-UNDO-REDO協議，來張老爺子的書《事務處理：概念與技術》中的圖說明一下吧：</p><div class=pgc-img><img alt=數據庫的江湖情仇：事務篇 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/1f2e7661ae1446539f1700c3baaa976c><p class=pgc-img-caption></p></div><p>搞過Oracle、DB2、SQLServer的人一看這圖，一定就能心領神會。</p><p>我摘錄一下書中對此圖的解釋：</p><p><strong>DO</strong>，就是操作，比如一些UPDATE、INSERT或DELETE的SQL。它讓數據庫從舊的狀態變為新的狀態。它同時會產生日誌。</p><p><strong>UNDO</strong>，利用日誌，將新狀態變回舊的狀態。</p><p><strong>REDO</strong>，利用日誌，從舊狀態轉移到新狀態。</p><p>這個圖其實和DB2、SQLServer中的事務機制完全一樣，他們的UNDO日誌和REDO日誌就是合在一起的。比如：在SQLServer中就叫事務日誌，回滾、恢復都靠事務日誌。</p><p>之所以DB2、SQLServer中的事務機制，和Jim老爺子書中的圖一模一樣，因為這兩個數據庫都和Jim老爺子有直接的聯繫：</p><p>DB2可以說是脫胎於IBM的關係型數據庫嘗試產品：SYSTEM R。Jim老爺子當年是SYSTEM R的主力開發。</p><p>SQLServer更不必說，Jim老爺不想離開生活慣了的洛杉磯去西雅圖，Bill.Gets專門在洛杉磯建了一個研究院，由老爺子做院長，領導開發了SQLSever數據庫。</p><p>額外說一下，我曾看到過一個問題：程序員為什麼愛發博客。最高票的回答是：因為解決了一個牛B的問題，身邊卻沒有人懂。</p><p>在上世紀70年代，還沒有博客這玩意，郵件組還要再過幾年才流行。Jim在SYSTEM R中解決了一系列複雜的事務、一致性等問題，但是，無人能欣賞，這種寂寞高手的感覺，高處不勝寒。</p><p>怎麼辦，Jim一邊開發著SYSTEM R，思考著複雜的事務問題，一邊抽空寫博客，對了，當時還沒有博客，那就寫論文吧。1976年時，Jim寫了篇重要的論文：<strong>《共享數據庫的一致性和鎖的粒度（Granularity of Locks and Degrees of Consistency in a Shared Data Base）》。</strong>就是在這篇論文中，Jim首次提出了“事務”和一致性的概念。</p><p>老爺子論文寫的不亦樂乎，沒想到旁邊有個“偷拳”的傢伙——埃裡森。小埃當時已經看了E.F.Codd在IBM時的論文，搞了個關係型數據庫Oracle。IBM是當時當之無愧的大哥，跟著大哥走還會有錯？</p><p>小埃偷拳偷的不亦樂乎的時候，Jim又發表了他的關於事務的論文，所以，如你所見，Oracle中的事務也是DO-UNDO-REDO協議了。</p><p>只不過，Oracle把UNDO和REDO分開了，UNDO有專門的UNDO段。這後來又影響了MySQL、國產的達夢數據庫，他們的UNDO都是分離的，UNDO在UNDO段中。</p><p>雖然UNDO和REDO合在一起，才是正宗Jim老爺的思想。但分離式的設計也不差，很難說誰比誰更強。</p><p>從事務的角度上來說，Oracle、DB2、SQLServer、達夢，這些數據庫事務的設計各有千秋。</p><p>從成熟度上來說，當然是Oracle、DB2的成熟度更高、性能更好，但SQLServer、達夢數據庫也不錯，性能上、功能上，也完全可以滿足我們的需要。</p><p><strong>但數據庫的江湖上，除了DO-UNDO-REDO派之外，還有另外一大流派。</strong>因為使用了完全不同的事務實現協議，有些操作的性能表現和DO-UNDO-REDO派有著明顯的差異。</p><p><strong>這另外一大派，是由另一圖靈獎得主、開宗立派的宗師級大師，邁克爾.斯通布雷克（Michael Stonebraker）開創的多版本派。</strong></p><div class=pgc-img><img alt=數據庫的江湖情仇：事務篇 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/6e1fe230e2e943008d168f9ba59194f0><p class=pgc-img-caption></p></div><p class=ql-align-center>（圖靈獎，頒獎儀式上的Michael Stonebraker）</p><p>在數據庫界風起雲湧的70年代，Michael按耐不住寂寞，出手搞了一個關係型的數據庫：Ingres。Ingres衍生出很多數據庫，PostgreSQL就是其中之一。</p><p>Michael老爺子認可Jim的事務概念，但對於如何實現事務，他採用了和Jim不一樣的方法，他沒有完全採用DO-UNDO-REDO協議，REDO仍然是需要的。Redo中的後映像是為了恢復。UNDO呢，它是前映像數據，為了把數據恢復修改之前。</p><p>把數據恢復到修改之前，或者提供前映像讀，未必就一定需要UNDO日誌（或UNDO 段）。也可以使用多版本的機制。</p><p>下面以Update為例，比較一下多版本派和UNDO派在事務流程中的不同，從中總結一下這兩種流派的優、缺點。</p><div class=pgc-img><img alt=數據庫的江湖情仇：事務篇 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/8febc8a4c5e54e88b67b858064c9cf0d><p class=pgc-img-caption></p></div><p>（圖為Update前的表數據，左邊是多版本派，右邊是UNDO派）</p><p>對於多版本派的表來說，每一行數據都會增加些版本信息，事務號、提交標誌就是這些版本信息的一部分。有些多版本派的數據庫，會用一個事務開始的時間戳代表事務號，而不是用特定的一個數字。這在NoSQL/NewSQL數據庫中很常見。</p><p>對於UNDO派的數據庫來說呢，會有一個UNDO日誌。Oracle/MySQL是有一個專門的UNDO段。DB2/SQLServer的UNDO和REDO都是放一起的。</p><p>下面，用戶發出了更新操作，數據庫收到了一條Update命令：</p><p>Update test set col=’BBB’ where id=4</p><p>數據庫在執行這條SQL時，相關事務和表數據的處理流程如下：</p><div class=pgc-img><img alt=數據庫的江湖情仇：事務篇 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/pgc-image/79e122cf1b8142939007919732251e78><p class=pgc-img-caption></p></div><p>（如上圖所示，左邊為多版本，右邊為UNDO派）</p><p>多版本派，會首先將ID為4的行復制到新位置，然後設置新行的事務號為1899，提交標誌為N，代表事務未提交，再修改要Update的列值為“BBB”。如果其他Session查詢到ID為4的行，直接根據提交標記，即可判斷出此事務未提交，那麼，就再向前查尋ID值為4、事務號最大的、提交標記為是的行，就是滿足一致性要求的行了。</p><p>UNDO派則先將前映像寫入UNDO區域，再在原行中修改要修改的列。這一派系我就不詳細介紹了，相信讀者對這一派系瞭解會更多。</p><p>通過對比，我想讀者朋友就發現了，如果表有十列，那怕只更新一列，多版本派也要將整行復制到新位置處。而UNDO派呢，只需要將被修改列的原值複製到UNDO日誌中即可。這麼一比，在Update操作方面，UNDO派是有優勢的。</p><p>當然，作為圖靈獎得主，Michael老爺開創的多版本派肯定是有自己特長的。</p><div class=pgc-img><img alt=數據庫的江湖情仇：事務篇 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/adc0b8bb0a674bef85ab5e8b8ad6990f><p class=pgc-img-caption></p></div><p>各位多版本派的粉絲，先放下40米大刀，不要急，下面我們來比一下插入操作：</p><div class=pgc-img><img alt=數據庫的江湖情仇：事務篇 onerror=errorimg.call(this); src=http://p1.pstatp.com/large/pgc-image/07d11eb7ed0a4724b556538755d7b6ac><p class=pgc-img-caption></p></div><p>多版本派的Insert操作十分簡單，直接在表中插入新行即可。</p><p>相對來說，UNDO派的Insert，就略為複雜了。要將新行的位置信息寫入UNDO日誌，將來回滾的時候，好根據這個位置找到新行在哪兒。</p><p>雖然UNDO派只複雜了那麼一點點，但對於追求短、平、快的OLTP應用來說，一次SQL調用可能也就幾毫秒、十幾毫秒。額外的操作UNDO，已經是不小的操作了。</p><p>看到了吧，Michael老爺子的多版本派成功扳回一局。</p><p>對於刪除操作，我就不再放圖了。UNDO派，要把原行整行數據複製到UNDO日誌中去。多版本派對於刪除操作的處理多有不同。最基本、最簡單的，就是刪除時也把整行復制到新位置，加上刪除標誌。</p><p>這符合多版本派的一貫思想，就是不修改原行，每DML一次，只複製、修改新行。</p><p>很多NoSQL數據庫就是這樣做的，但成熟的關係型、多版本派數據庫，如PostgreSQL，並不會這樣簡單粗爆。它是在原行處設置一些事務標誌，在刪除行的時候，只需標記行被刪除就可以了，避免了將被刪除行復制到新位置。具體細節，我們就不再這裡展開討論了。總之PostgreSQL的刪除和插入一樣，都是十分節省資源的。</p><p>UNDO派脫胎於閉源的、商業的SYSTEM R，因此它廣範應用於關係的、閉源的、商業的數據庫。這個我們前面提到了，如Oracle、DB2、達夢，還有開源的MySQL。</p><p>多版本派，源於Ingres，這個數據庫是開源的，而且，多版派的實現也相對更為簡單，不需維護一塊專門的UNDO空間。因此多版本派也廣泛應用於開源的、或NoSQL/NewSQL等非關係型的數據庫。</p><p>雖然在關係型中，有名的好像也只有PostgreSQL。但是幾乎所有支持事務的NoSQL/NewSQL數據庫，都屬於多版本派。</p><p><strong>好了，現在我們可以總結一下了。這兩大派的數據庫誰更適用哪種場景呢？</strong></p><p><strong>簡單總結一下</strong></p><p><strong>暗黑料理界又出新品!</strong></p><p>◎ 多版本派的Insert/Delete不需要複製原行數據，因此簡單而快速，但Update負擔會重，特別是針對列較多但每次Update只更新少量列的情況。</p><p>（注：多版本派的Delete不需要複製原行數據，只是針對PostgreSQL，多數多版本派的NoSQL/NewSQL，Delete時還是要複製原行數據到新位置的。）</p><p>◎ UNDO派，它的優勢在於平衡，無論什麼DML，都少不了操作UNDO的步驟，性能表現都差不多。</p><p>結合應用來說，比如你有一個日誌型的OLTP應用。每秒有大量的併發Session，向數據庫中插入大量數據（這和OLAP中少量Session插入大量數據還不樣，OLAP的我們以後再說），但這些數據從不Update，或者說很少Update。那麼，多版本派的數據庫就十分適合了，比如PostgreSQL。</p><p>如果對事務的要求沒那麼高，那麼一些NoSQL/NewSQL的數據庫也可以考慮。比如，事務不多的事情下，可以考慮MongoDB。因為完全的支持ACID的、跨多個表（MongoDB中叫集合）的事務，MongoDB也是剛支持不久，以成熟度來論，相比PostgreSQL會差一些。</p><p>如果不需要跨表、跨行的事務，甚至不需要事務，選擇面就更多了，像HBase、Cassandra等的插入性能都是不錯的。</p><p>如果有一個OLTP交易型的應用，有大量的查詢，和A轉帳給B這樣的交易操作，也就是Update A的餘額、再Update B的餘額。UNDO派的數據庫就比較適合了。畢竟，Update操作時UNDO派更節省資源。</p><p>但是，有時候應用的界限並不是那麼清楚。比如一套大型的應用中，即有日誌型的功能，又有交易型的功能，而且數據還是混在一起的。這種情況下，總不能將數據寫兩份，分別放在不同數據庫中吧（極端情況下，也可以這樣做）。</p><p>這要如何選擇呢？就要看那種功能更重要了。日誌型功能更重要，就選多版本派的數據庫。交易型功能更重要，就選UNDO派數據庫。如果都重要，我建議優選UNDO派的、成熟的數據庫。因為UNDO派各種操作性能更加平衡，不會出現忽快忽慢的情況。</p><p><strong>要說，不同宗派之間，還容易選擇。但是同一宗派內部呢？</strong></p><p>同一宗派內部，我們也不好在公開場合說誰優誰劣，TPCC的性能測試數據，每家都十分優秀。</p><p>大家使用的基本思想是一樣的，好壞取決於開發者的編程能力，能去開發數據庫的，都是像下面這樣的好程序員：</p><div class=pgc-img><img alt=數據庫的江湖情仇：事務篇 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/pgc-image/0ffc91908efc4358a5f96833dd8210b4><p class=pgc-img-caption></p></div><p class=ql-align-center>（ 見過我的人都說，我也是一名標準的好程序員:) ）</p><p>所以，同一宗派內部，在不考慮錢的情況下，選擇成熟度高的數據庫。要考慮錢的情況下，國產的數據庫，和開源數據庫的確是一個不錯的選擇。現在國產數據庫、和像MySQL/PostgreSQL這樣的歷史悠久的開源數據庫，成熟度也已經十分好了。</p><p>除去事務的影響，不同的數據存儲、組織模式、鎖級別等，都會帶來一些性能差別。比如：Oracle的表是堆表，堆表是無序的。MySQL InnoDB的表是索引組織表，索引組織表是要按索引排序的。排序操作會額外帶來一些性能損耗，但會提升按主鍵查詢時的性能，等等。這些非事務性的，我們後面再總結。</p><p>好了，篇幅已經不短了，這一期，我們只說事務。後續，留待下一期吧。</p><p><strong>話說UNDO派、多版派，就像少林、武當兩大派一樣，統領江湖幾十載，江湖上一片風平浪靜。各個應用廠商按需選擇，一時江湖上倒也相安無事。</strong></p><div class=pgc-img><img alt=數據庫的江湖情仇：事務篇 onerror=errorimg.call(this); src=http://p9.pstatp.com/large/pgc-image/1ee70a6f901d478fa8e3ad29ab8e790e><p class=pgc-img-caption></p></div><div class=pgc-img><img alt=數據庫的江湖情仇：事務篇 onerror=errorimg.call(this); src=http://p3.pstatp.com/large/pgc-image/1088dcdc42c34b25bfeadcd0f68a3937><p class=pgc-img-caption></p></div><p>進入二十一世紀一零年代，UNDO派開山宗師Jim某一日正在洞府中打坐修行，忽然一陣心旗搖動，Jim掐指一算，自知大限將至，遂揚帆出海，小舟從此逝、江海寄餘生。</p><p>（注：2007年年初，Jim架遊艇出海，將老母親骨灰撒入大海，然後失蹤。海岸警衛隊、志願者、學術界朋友紛紛加入搜索，甚至動用衛星和若干先進技術，搜索幾天後仍一無所獲。但很多人仍沒有放棄搜索，直到五年又四個月後（2012年5月16），才宣佈他的死亡。）</p><p>多版本派開山宗師Michael，也年壽已高，不問江湖世事。江湖中兩位大佬一死一老，對江湖的控制力大大減弱。正在這時，一本叫做NoSQL的武功祕籍，在江湖上又掀起血雨腥風。</p><p>至於NoSQL重出江湖之後，數據庫界又有什麼樣的風雲變幻，且聽下回分解。</p><p><strong><em>關於美創</em></strong></p><p><strong>杭州美創科技有限公司</strong>，敏感數據保護和數據安全領域的拓荒者和領導者，由國內多名數據庫資深專家攜手於2005年成立，產品及服務覆蓋數據安全、數據管理、容災備份、智能運維等四大領域，廣泛應用於醫療、教育、金融、政府、人社、電力能源、物流交通、企業等眾多行業。多年來，憑藉卓越的技術創新與良好的用戶口碑，美創多次入圍全國網絡安全50強，並參與多項國家及行業標準的編寫，引領數據安全領域的規範發展。目前，美創科技已全面推動全國市場化發展戰略，相繼在北京、廣州、武漢、南京、成都、上海等地設立分公司，致力於為更多的客戶提供專業的安全解決方案。</p></div></div><div class="post-meta meta-tags"><ul class=clearfix><li><a>數據庫</a></li><li><a>情仇</a></li><li><a>事務篇</a></li></ul></div></article></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=搜索>
<input type=hidden name=sitesearch value=geekbank.cf>
<button type=submit>🔍</button></form></section><section class=widget><h3 class=widget-title>最新文章 ⚡</h3><ul class=widget-list><li><a href=../../tw/%E7%A7%91%E6%8A%80/3269d080.html alt=MySQL數據庫的事務管理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/152203544367254a708f807 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/3269d080.html title=MySQL數據庫的事務管理>MySQL數據庫的事務管理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/dc1a27dd.html alt="詳解Oracle 數據庫啟動過程" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/pgc-image/1538236609349861be8e044 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/dc1a27dd.html title="詳解Oracle 數據庫啟動過程">詳解Oracle 數據庫啟動過程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ad3f3a1e.html alt="數據庫技術：MySQL 基礎和 SQL 入門，單表、約束和事務" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/107897c16ae7461caa62dd375b631afe style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ad3f3a1e.html title="數據庫技術：MySQL 基礎和 SQL 入門，單表、約束和事務">數據庫技術：MySQL 基礎和 SQL 入門，單表、約束和事務</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8ff1c7a8.html alt=解讀數據庫：深入分析MySQL中事務以及MVCC的實現原理 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p9.pstatp.com/large/dfic-imagehandler/8f370516-d41a-4803-84ba-2c01e4637c8b style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8ff1c7a8.html title=解讀數據庫：深入分析MySQL中事務以及MVCC的實現原理>解讀數據庫：深入分析MySQL中事務以及MVCC的實現原理</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/18681b55.html alt=PHP鏈接數據庫操作教程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/3b10e2d3b35043f8ae9cb1823878b66a style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/18681b55.html title=PHP鏈接數據庫操作教程>PHP鏈接數據庫操作教程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/f3e06bc8.html alt=熱血傳奇的第二個數據庫，怪物數據庫參數值解析教程 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/875b193ef0954c6286e409e03cff93de style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/f3e06bc8.html title=熱血傳奇的第二個數據庫，怪物數據庫參數值解析教程>熱血傳奇的第二個數據庫，怪物數據庫參數值解析教程</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d47d6214.html alt=記一次生產環境數據庫連接超時自動回收問題及解決方法 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ceb8e16a0c0648fc9359e41485d1a3d0 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d47d6214.html title=記一次生產環境數據庫連接超時自動回收問題及解決方法>記一次生產環境數據庫連接超時自動回收問題及解決方法</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/fafaed1a.html alt=潮汕僑批數據庫如何運作？怎樣使用？這篇文章告訴你 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/810e00032cf230d0faa7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/fafaed1a.html title=潮汕僑批數據庫如何運作？怎樣使用？這篇文章告訴你>潮汕僑批數據庫如何運作？怎樣使用？這篇文章告訴你</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/9bbdeed9.html alt="MySQL 數據庫、表、字段的命名建議規範" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/ed974f814051426eb120a107abc94df7 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/9bbdeed9.html title="MySQL 數據庫、表、字段的命名建議規範">MySQL 數據庫、表、字段的命名建議規範</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/ae0a02c6.html alt=MySQL數據庫+命令大全，人手一份的實操攻略來啦 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/RTDWEx38S8Abbo style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/ae0a02c6.html title=MySQL數據庫+命令大全，人手一份的實操攻略來啦>MySQL數據庫+命令大全，人手一份的實操攻略來啦</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/cdc0bad8.html alt=Oracle數據庫-查詢所有表名、字段名、字段名說明的簡介 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/cdc0bad8.html title=Oracle數據庫-查詢所有表名、字段名、字段名說明的簡介>Oracle數據庫-查詢所有表名、字段名、字段名說明的簡介</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/332cb941.html alt=數據庫SQL最常用語句 class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/332cb941.html title=數據庫SQL最常用語句>數據庫SQL最常用語句</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/8ca809f3.html alt="SQL SERVER數據庫中用select語句複製表結構創建新表" class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/8ca809f3.html title="SQL SERVER數據庫中用select語句複製表結構創建新表">SQL SERVER數據庫中用select語句複製表結構創建新表</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/d6b4ad6d.html alt=你知道如何更新緩存嗎？如何保證緩存和數據庫雙寫一致性？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p1.pstatp.com/large/pgc-image/c7adc4a4b9b745c0ae541bf87a51dd85 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/d6b4ad6d.html title=你知道如何更新緩存嗎？如何保證緩存和數據庫雙寫一致性？>你知道如何更新緩存嗎？如何保證緩存和數據庫雙寫一致性？</a></li><hr><li><a href=../../tw/%E7%A7%91%E6%8A%80/c53d08ba.html alt=如何保證數據庫和緩存的雙寫一致性？ class="image featured" style=display:block;margin-left:auto;margin-right:auto;width:100%><img src=https://p3.pstatp.com/large/pgc-image/4b019f823cd84b72a0ac1d7b7d54e259 style=border-radius:25px></a>
<a href=../../tw/%E7%A7%91%E6%8A%80/c53d08ba.html title=如何保證數據庫和緩存的雙寫一致性？>如何保證數據庫和緩存的雙寫一致性？</a></li><hr></ul></section><section class=widget><h3 class=widget-title>其他</h3><ul class=widget-list><li><a href=TOS.html>使用條款</a></li><li><a href=CommentPolicy.html>留言政策</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>DMCA</a></li><li><a href=mailto:gdnews@tuta.io rel=nofollow>聯絡我們</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href>极客快訊</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src=https://kknews.cf/js/totop.js async></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e508ed9e4e698bb"></script></body></html>